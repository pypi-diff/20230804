# Comparing `tmp/assemblyline_service_utilities-4.4.1.dev7-py3-none-any.whl.zip` & `tmp/assemblyline_service_utilities-4.4.1.dev8-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,35 +1,35 @@
-Zip file size: 321838 bytes, number of entries: 33
--rw-r--r--  2.0 unx       11 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/VERSION
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/__init__.py
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/__init__.py
--rw-r--r--  2.0 unx   147736 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/dynamic_service_helper.py
--rw-r--r--  2.0 unx     5376 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/icap.py
--rw-r--r--  2.0 unx     2221 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/keytool_parse.py
--rw-r--r--  2.0 unx     3037 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/safelist_helper.py
--rw-r--r--  2.0 unx     1520 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/section_reducer.py
--rw-r--r--  2.0 unx     4193 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/tag_helper.py
--rw-r--r--  2.0 unx    11102 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/tag_reducer.py
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/balbuzard/__init__.py
--rw-r--r--  2.0 unx    25162 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/balbuzard/balbuzard.py
--rw-r--r--  2.0 unx    29194 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/balbuzard/bbcrack.py
--rw-r--r--  2.0 unx    34126 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/balbuzard/patterns.py
--rw-r--r--  2.0 unx        1 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/extractor/__init__.py
--rw-r--r--  2.0 unx     3091 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/extractor/base64.py
--rw-r--r--  2.0 unx     1413 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/extractor/pe_file.py
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/pestudio/__init__.py
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/pestudio/xml/__init__.py
--rw-r--r--  2.0 unx   196476 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/pestudio/xml/features.xml
--rw-r--r--  2.0 unx   350312 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/pestudio/xml/functions.xml
--rw-r--r--  2.0 unx    20008 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/pestudio/xml/languages.xml
--rw-r--r--  2.0 unx    40129 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/pestudio/xml/resources.xml
--rw-r--r--  2.0 unx  1255658 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/pestudio/xml/signatures.xml
--rw-r--r--  2.0 unx   102459 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/common/pestudio/xml/strings.xml
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/testing/__init__.py
--rw-r--r--  2.0 unx    19710 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/testing/helper.py
--rw-r--r--  2.0 unx     1108 b- defN 23-Jun-14 15:17 assemblyline_service_utilities/testing/regenerate_results.py
--rw-r--r--  2.0 unx     1395 b- defN 23-Jun-14 15:17 assemblyline_service_utilities-4.4.1.dev7.dist-info/LICENCE.md
--rw-r--r--  2.0 unx     1129 b- defN 23-Jun-14 15:17 assemblyline_service_utilities-4.4.1.dev7.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jun-14 15:17 assemblyline_service_utilities-4.4.1.dev7.dist-info/WHEEL
--rw-r--r--  2.0 unx       31 b- defN 23-Jun-14 15:17 assemblyline_service_utilities-4.4.1.dev7.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     3696 b- defN 23-Jun-14 15:17 assemblyline_service_utilities-4.4.1.dev7.dist-info/RECORD
-33 files, 2260386 bytes uncompressed, 315552 bytes compressed:  86.1%
+Zip file size: 321942 bytes, number of entries: 33
+-rw-r--r--  2.0 unx       11 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/VERSION
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/__init__.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/__init__.py
+-rw-r--r--  2.0 unx   148224 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/dynamic_service_helper.py
+-rw-r--r--  2.0 unx     5376 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/icap.py
+-rw-r--r--  2.0 unx     2221 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/keytool_parse.py
+-rw-r--r--  2.0 unx     3037 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/safelist_helper.py
+-rw-r--r--  2.0 unx     1520 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/section_reducer.py
+-rw-r--r--  2.0 unx     4193 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/tag_helper.py
+-rw-r--r--  2.0 unx    11102 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/tag_reducer.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/balbuzard/__init__.py
+-rw-r--r--  2.0 unx    25162 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/balbuzard/balbuzard.py
+-rw-r--r--  2.0 unx    29194 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/balbuzard/bbcrack.py
+-rw-r--r--  2.0 unx    34146 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/balbuzard/patterns.py
+-rw-r--r--  2.0 unx        1 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/extractor/__init__.py
+-rw-r--r--  2.0 unx     3091 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/extractor/base64.py
+-rw-r--r--  2.0 unx     1413 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/extractor/pe_file.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/pestudio/__init__.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/pestudio/xml/__init__.py
+-rw-r--r--  2.0 unx   196476 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/pestudio/xml/features.xml
+-rw-r--r--  2.0 unx   350312 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/pestudio/xml/functions.xml
+-rw-r--r--  2.0 unx    20008 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/pestudio/xml/languages.xml
+-rw-r--r--  2.0 unx    40129 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/pestudio/xml/resources.xml
+-rw-r--r--  2.0 unx  1255658 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/pestudio/xml/signatures.xml
+-rw-r--r--  2.0 unx   102459 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/common/pestudio/xml/strings.xml
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/testing/__init__.py
+-rw-r--r--  2.0 unx    19710 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/testing/helper.py
+-rw-r--r--  2.0 unx     1108 b- defN 23-Jun-16 14:50 assemblyline_service_utilities/testing/regenerate_results.py
+-rw-r--r--  2.0 unx     1395 b- defN 23-Jun-16 14:50 assemblyline_service_utilities-4.4.1.dev8.dist-info/LICENCE.md
+-rw-r--r--  2.0 unx     1129 b- defN 23-Jun-16 14:50 assemblyline_service_utilities-4.4.1.dev8.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-16 14:50 assemblyline_service_utilities-4.4.1.dev8.dist-info/WHEEL
+-rw-r--r--  2.0 unx       31 b- defN 23-Jun-16 14:50 assemblyline_service_utilities-4.4.1.dev8.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3696 b- defN 23-Jun-16 14:50 assemblyline_service_utilities-4.4.1.dev8.dist-info/RECORD
+33 files, 2260894 bytes uncompressed, 315656 bytes compressed:  86.1%
```

## zipnote {}

```diff
@@ -78,23 +78,23 @@
 
 Filename: assemblyline_service_utilities/testing/helper.py
 Comment: 
 
 Filename: assemblyline_service_utilities/testing/regenerate_results.py
 Comment: 
 
-Filename: assemblyline_service_utilities-4.4.1.dev7.dist-info/LICENCE.md
+Filename: assemblyline_service_utilities-4.4.1.dev8.dist-info/LICENCE.md
 Comment: 
 
-Filename: assemblyline_service_utilities-4.4.1.dev7.dist-info/METADATA
+Filename: assemblyline_service_utilities-4.4.1.dev8.dist-info/METADATA
 Comment: 
 
-Filename: assemblyline_service_utilities-4.4.1.dev7.dist-info/WHEEL
+Filename: assemblyline_service_utilities-4.4.1.dev8.dist-info/WHEEL
 Comment: 
 
-Filename: assemblyline_service_utilities-4.4.1.dev7.dist-info/top_level.txt
+Filename: assemblyline_service_utilities-4.4.1.dev8.dist-info/top_level.txt
 Comment: 
 
-Filename: assemblyline_service_utilities-4.4.1.dev7.dist-info/RECORD
+Filename: assemblyline_service_utilities-4.4.1.dev8.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## assemblyline_service_utilities/VERSION

```diff
@@ -1 +1 @@
-4.4.1.dev7
+4.4.1.dev8
```

## assemblyline_service_utilities/common/dynamic_service_helper.py

```diff
@@ -3476,25 +3476,35 @@
                         dns_query["request"] = text
                 elif name == "QueryResults":
                     ip = findall(IPV4_REGEX, text)
                     for item in ip:
                         dns_query["answers"].append({"data": item, "type": "A"})
                 elif name == "Image":
                     dns_query["image"] = text
+
             if any(dns_query[key] is None for key in dns_query.keys()):
                 continue
+            # If Sysmon was unable to get the QueryResults from the DNS event, populate the missing fields
+            elif dns_query["answers"] == []:
+                for query in network["dns"][:]:
+                    if query["request"] == dns_query["request"]:
+                        for key in dns_query.keys():
+                            if key not in query:
+                                query[key] = dns_query[key]
+                        break
             elif any(
                 query["request"] == dns_query["request"]
                 for query in network.get("dns", [])
             ):
                 # Replace record since we have more info from Sysmon
                 for query in network["dns"][:]:
                     if query["request"] == dns_query["request"]:
                         network["dns"].remove(query)
                         network["dns"].append(dns_query)
+                        break
             else:
                 if "dns" not in network:
                     network["dns"] = []
                 network["dns"].append(dns_query)
 
 
 def extract_iocs_from_text_blob(
```

## assemblyline_service_utilities/common/balbuzard/patterns.py

```diff
@@ -33,17 +33,18 @@
 # OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 # OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
 from os import path
 from xml.etree import ElementTree
 
 import regex as re
-from assemblyline_service_utilities.common.balbuzard.balbuzard import Pattern, Pattern_re
 from fuzzywuzzy import process
 
+from assemblyline_service_utilities.common.balbuzard.balbuzard import Pattern, Pattern_re
+
 
 def get_xml_strings():
 
     pest_minlen = 6
 
     api = {}
     blacklist = {}
@@ -207,15 +208,15 @@
     PAT_IP = rb'\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b'
     PAT_REGIS = rb'(?i)\b[- _A-Z0-9.\\]{0,25}' \
                 rb'(?:controlset001|controlset002|currentcontrolset|currentversion|HKCC|HKCR|HKCU|HKDD|' \
                 rb'hkey_classes_root|hkey_current_config|hkey_current_user|hkey_dyn_data|hkey_local_machine|' \
                 rb'HKLM|hkey_performance_data|hkey_users|HKPD|internet settings|\\sam|\\software|\\system|' \
                 rb'\\userinit)' \
                 rb'\\[-_A-Z0-9.\\ ]{1,200}\b'
-    PAT_URL = rb'(?i)(?:ftp|http|https)://' \
+    PAT_URL = rb'(?i)(?:ftp|http|https)://(?:[A-Z0-9.-_:]*@)?' \
               rb'[A-Z0-9.-]{1,}\.(?:XN--[A-Z0-9]{4,18}|[a-z]{2,12}|[0-9]{1,3})' \
               rb'(?::[0-9]{1,5})?' \
               rb'(?:/[A-Z0-9/\-\.&%\$#=~\?_+]{3,200}){0,1}'
     PAT_ANYHTTP = rb'(?i)http://' \
                   rb'[A-Z0-9.-]{6,}\.' \
                   rb'(?:XN--[A-Z0-9]{4,18}|[a-z]{2,12}|[0-9]{1,3})' \
                   rb'(?::[0-9]{1,5})?' \
```

## Comparing `assemblyline_service_utilities-4.4.1.dev7.dist-info/LICENCE.md` & `assemblyline_service_utilities-4.4.1.dev8.dist-info/LICENCE.md`

 * *Files identical despite different names*

## Comparing `assemblyline_service_utilities-4.4.1.dev7.dist-info/METADATA` & `assemblyline_service_utilities-4.4.1.dev8.dist-info/METADATA`

 * *Files 5% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: assemblyline-service-utilities
-Version: 4.4.1.dev7
+Version: 4.4.1.dev8
 Summary: Assemblyline 4 - Service Utilities
 Home-page: https://github.com/CybercentreCanada/assemblyline-service-utilities/
 Author: CCCS Assemblyline development team
 Author-email: assemblyline@cyber.gc.ca
 License: MIT
 Keywords: assemblyline automated malware analysis gc canada cse-cst cse cst cyber cccs
 Platform: UNKNOWN
```

## Comparing `assemblyline_service_utilities-4.4.1.dev7.dist-info/RECORD` & `assemblyline_service_utilities-4.4.1.dev8.dist-info/RECORD`

 * *Files 3% similar despite different names*

```diff
@@ -1,33 +1,33 @@
-assemblyline_service_utilities/VERSION,sha256=t8AFkL7bRRZtH-pMohqRkyOaDG-kH0-qlsvWKQdeJOo,11
+assemblyline_service_utilities/VERSION,sha256=MMSBc85XDqriW8FChNTjCYTGWocndnZT35BbzftrimU,11
 assemblyline_service_utilities/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 assemblyline_service_utilities/common/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-assemblyline_service_utilities/common/dynamic_service_helper.py,sha256=pIseRD4SiXFomVcbg1xEWJkQhQWrL34-V9rZfU7CN4E,147736
+assemblyline_service_utilities/common/dynamic_service_helper.py,sha256=ttnRJsiBygjn0DpmA9uI53s9U9r91Lv2z8A9ksX_ijA,148224
 assemblyline_service_utilities/common/icap.py,sha256=phT3CT5uII3Qm90Nzi4O-eDkQ2jmr3zHcVVra4sqYSc,5376
 assemblyline_service_utilities/common/keytool_parse.py,sha256=QhY93SCIIRscO21TD7L-MYuBl0-PICuLCirfdzBIdpw,2221
 assemblyline_service_utilities/common/safelist_helper.py,sha256=21JUJZYe3mwvVBhE3BTCGT9pyz40OBU7tOtdThrjwsE,3037
 assemblyline_service_utilities/common/section_reducer.py,sha256=0FLOcfwxjosHSP87-QvAFfMU6OkwcolvlUP8le8ZmUs,1520
 assemblyline_service_utilities/common/tag_helper.py,sha256=p5_OBoxJJfbcGACq-N7Hj2vD1F11oFMkMuXgQN8Z8NE,4193
 assemblyline_service_utilities/common/tag_reducer.py,sha256=3CZuve5l0u1Ur98ZB0anpO2UeCYLBaKdIF3PMq2VA6I,11102
 assemblyline_service_utilities/common/balbuzard/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 assemblyline_service_utilities/common/balbuzard/balbuzard.py,sha256=CvmFD3oEUYW8Jmd68GaN42zGBQedUJYcbXl5HyrwFt8,25162
 assemblyline_service_utilities/common/balbuzard/bbcrack.py,sha256=JWt5h0s-WIX1fjUCxt15QKnoJYZn4a8pEMB6vcIBhJY,29194
-assemblyline_service_utilities/common/balbuzard/patterns.py,sha256=A_UVKu-92YTgVwtn-_rmxslpiKvVSf3WZIJDSX2uSxc,34126
+assemblyline_service_utilities/common/balbuzard/patterns.py,sha256=7SHp0QI8f3UYj45fLL6G5jDaCcpSnstChyTBSklvzpQ,34146
 assemblyline_service_utilities/common/extractor/__init__.py,sha256=AbpHGcgLb-kRsJGnwFEktk7uzpZOCcBY74-YBdrKVGs,1
 assemblyline_service_utilities/common/extractor/base64.py,sha256=Y3bZHTUOga2WikKd8mbGl9TxAFznwxYQrQRYqLSlOVE,3091
 assemblyline_service_utilities/common/extractor/pe_file.py,sha256=97HNyMVtmKT7tJGBs9hwkjjYEsVOV00ju2rLtde5h6A,1413
 assemblyline_service_utilities/common/pestudio/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 assemblyline_service_utilities/common/pestudio/xml/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 assemblyline_service_utilities/common/pestudio/xml/features.xml,sha256=q883UJxIq20mk88pxYnv2nKeG5dFiq-mhYH7D45i9lE,196476
 assemblyline_service_utilities/common/pestudio/xml/functions.xml,sha256=QnbWwvvKeugnIU4XFYh8jeuP-eGl_h4z5KKihvpnCNU,350312
 assemblyline_service_utilities/common/pestudio/xml/languages.xml,sha256=NLWwcGIVTWOQh7vvzP5yYPAstJJMsRXzNAv54Kly42M,20008
 assemblyline_service_utilities/common/pestudio/xml/resources.xml,sha256=bYP-AVbq_Dlhgj_gNC2o0LSqc0AdlJHxJ8-G8Ih0MIc,40129
 assemblyline_service_utilities/common/pestudio/xml/signatures.xml,sha256=r5FLFgmWejRdqPdoPQCFTt31Tllc64o81geaN1SbwS4,1255658
 assemblyline_service_utilities/common/pestudio/xml/strings.xml,sha256=kRU8WbCcU1RckM6oCFeUVMdpOxZjJDDTMIIor8k2ru0,102459
 assemblyline_service_utilities/testing/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 assemblyline_service_utilities/testing/helper.py,sha256=ibssz3nxJShS8gfTqNvNEoUR5QTHDzq2vWuZgtKGP7M,19710
 assemblyline_service_utilities/testing/regenerate_results.py,sha256=61xQGlJHdivOhW852LwgOcCuMVD3zmzXteMAN1aJBBM,1108
-assemblyline_service_utilities-4.4.1.dev7.dist-info/LICENCE.md,sha256=YwhOHb9LGmjAOP3eUr9KNkaHF3Prd52ixN4QS-rwoSo,1395
-assemblyline_service_utilities-4.4.1.dev7.dist-info/METADATA,sha256=a_vUUjakTS3FfYQpBkZ6k375OU8QqF38vxtXh6DMRgE,1129
-assemblyline_service_utilities-4.4.1.dev7.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-assemblyline_service_utilities-4.4.1.dev7.dist-info/top_level.txt,sha256=415tQykpaWGFgKSqCZWqGlVkt29UqRk1hSBAvP05m7k,31
-assemblyline_service_utilities-4.4.1.dev7.dist-info/RECORD,,
+assemblyline_service_utilities-4.4.1.dev8.dist-info/LICENCE.md,sha256=YwhOHb9LGmjAOP3eUr9KNkaHF3Prd52ixN4QS-rwoSo,1395
+assemblyline_service_utilities-4.4.1.dev8.dist-info/METADATA,sha256=tAr1-fTpeP8wuojLIIMxnDdcuS-fcMacUEHQR2hDdNg,1129
+assemblyline_service_utilities-4.4.1.dev8.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+assemblyline_service_utilities-4.4.1.dev8.dist-info/top_level.txt,sha256=415tQykpaWGFgKSqCZWqGlVkt29UqRk1hSBAvP05m7k,31
+assemblyline_service_utilities-4.4.1.dev8.dist-info/RECORD,,
```

