# Comparing `tmp/navi_pro-7.3.1-py3-none-any.whl.zip` & `tmp/navi_pro-7.3.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,65 +1,65 @@
-Zip file size: 110290 bytes, number of entries: 63
--rw-r--r--  2.0 unx       27 b- defN 23-Jul-26 22:24 navi/__init__.py
--rw-r--r--  2.0 unx      219 b- defN 23-Jul-26 22:24 navi/cli.py
--rw-r--r--  2.0 unx     1799 b- defN 23-Jul-26 22:24 navi/plugins/__init__.py
--rw-r--r--  2.0 unx     5783 b- defN 23-Jul-26 22:24 navi/plugins/access.py
--rw-r--r--  2.0 unx     2035 b- defN 23-Jul-26 22:24 navi/plugins/add.py
--rw-r--r--  2.0 unx     1250 b- defN 23-Jul-26 22:24 navi/plugins/add_by_file.py
--rw-r--r--  2.0 unx     1760 b- defN 23-Jul-26 22:24 navi/plugins/agent_export.py
--rw-r--r--  2.0 unx     2278 b- defN 23-Jul-26 22:24 navi/plugins/agent_group_export.py
--rw-r--r--  2.0 unx     7500 b- defN 23-Jul-26 22:24 navi/plugins/agents.py
--rw-r--r--  2.0 unx     3184 b- defN 23-Jul-26 22:24 navi/plugins/agroup.py
--rw-r--r--  2.0 unx     1104 b- defN 23-Jul-26 22:24 navi/plugins/api.py
--rw-r--r--  2.0 unx     5881 b- defN 23-Jul-26 22:24 navi/plugins/api_wrapper.py
--rw-r--r--  2.0 unx     1410 b- defN 23-Jul-26 22:24 navi/plugins/attribute.py
--rw-r--r--  2.0 unx     7165 b- defN 23-Jul-26 22:24 navi/plugins/automation.py
--rw-r--r--  2.0 unx      700 b- defN 23-Jul-26 22:24 navi/plugins/cancel.py
--rw-r--r--  2.0 unx     2364 b- defN 23-Jul-26 22:24 navi/plugins/compliance_export_csv.py
--rw-r--r--  2.0 unx     2176 b- defN 23-Jul-26 22:24 navi/plugins/cve_compare.py
--rw-r--r--  2.0 unx     8443 b- defN 23-Jul-26 22:24 navi/plugins/database.py
--rw-r--r--  2.0 unx     9303 b- defN 23-Jul-26 22:24 navi/plugins/dbconfig.py
--rw-r--r--  2.0 unx     2879 b- defN 23-Jul-26 22:24 navi/plugins/delete.py
--rw-r--r--  2.0 unx     7045 b- defN 23-Jul-26 22:24 navi/plugins/deploy.py
--rw-r--r--  2.0 unx    29240 b- defN 23-Jul-26 22:24 navi/plugins/display.py
--rw-r--r--  2.0 unx     1795 b- defN 23-Jul-26 22:24 navi/plugins/epss.py
--rw-r--r--  2.0 unx      175 b- defN 23-Jul-26 22:24 navi/plugins/error_msg.py
--rw-r--r--  2.0 unx     1147 b- defN 23-Jul-26 22:24 navi/plugins/exclusions.py
--rw-r--r--  2.0 unx     6490 b- defN 23-Jul-26 22:24 navi/plugins/export.py
--rw-r--r--  2.0 unx    13223 b- defN 23-Jul-26 22:24 navi/plugins/find.py
--rw-r--r--  2.0 unx     8385 b- defN 23-Jul-26 22:24 navi/plugins/fixed_export.py
--rw-r--r--  2.0 unx    23454 b- defN 23-Jul-26 22:24 navi/plugins/ip.py
--rw-r--r--  2.0 unx     1382 b- defN 23-Jul-26 22:24 navi/plugins/keys.py
--rw-r--r--  2.0 unx      268 b- defN 23-Jul-26 22:24 navi/plugins/licensed_count.py
--rw-r--r--  2.0 unx     2568 b- defN 23-Jul-26 22:24 navi/plugins/lumin.py
--rw-r--r--  2.0 unx     2584 b- defN 23-Jul-26 22:24 navi/plugins/migrate.py
--rw-r--r--  2.0 unx     5987 b- defN 23-Jul-26 22:24 navi/plugins/network.py
--rw-r--r--  2.0 unx     2803 b- defN 23-Jul-26 22:24 navi/plugins/push.py
--rw-r--r--  2.0 unx     1131 b- defN 23-Jul-26 22:24 navi/plugins/query_export.py
--rw-r--r--  2.0 unx     2002 b- defN 23-Jul-26 22:24 navi/plugins/query_export_32K.py
--rw-r--r--  2.0 unx     1615 b- defN 23-Jul-26 22:24 navi/plugins/rules.py
--rw-r--r--  2.0 unx    21707 b- defN 23-Jul-26 22:24 navi/plugins/scan.py
--rw-r--r--  2.0 unx    11818 b- defN 23-Jul-26 22:24 navi/plugins/scan_efficentcy.py
--rw-r--r--  2.0 unx    19158 b- defN 23-Jul-26 22:24 navi/plugins/scan_evaluation.py
--rw-r--r--  2.0 unx      250 b- defN 23-Jul-26 22:24 navi/plugins/sgroup.py
--rw-r--r--  2.0 unx     1393 b- defN 23-Jul-26 22:24 navi/plugins/sla.py
--rw-r--r--  2.0 unx      781 b- defN 23-Jul-26 22:24 navi/plugins/ssh.py
--rw-r--r--  2.0 unx    24987 b- defN 23-Jul-26 22:24 navi/plugins/tag.py
--rw-r--r--  2.0 unx     2677 b- defN 23-Jul-26 22:24 navi/plugins/tag_helper.py
--rw-r--r--  2.0 unx     3980 b- defN 23-Jul-26 22:24 navi/plugins/tagrule.py
--rw-r--r--  2.0 unx     6826 b- defN 23-Jul-26 22:24 navi/plugins/target_group.py
--rw-r--r--  2.0 unx     9992 b- defN 23-Jul-26 22:24 navi/plugins/th_asset_export.py
--rw-r--r--  2.0 unx     8152 b- defN 23-Jul-26 22:24 navi/plugins/th_compliance_export.py
--rw-r--r--  2.0 unx    14000 b- defN 23-Jul-26 22:24 navi/plugins/th_vuln_export.py
--rw-r--r--  2.0 unx     5796 b- defN 23-Jul-26 22:24 navi/plugins/update.py
--rw-r--r--  2.0 unx     4088 b- defN 23-Jul-26 22:24 navi/plugins/user.py
--rw-r--r--  2.0 unx     1165 b- defN 23-Jul-26 22:24 navi/plugins/user_export.py
--rw-r--r--  2.0 unx     2247 b- defN 23-Jul-26 22:24 navi/plugins/usergroup.py
--rw-r--r--  2.0 unx     9915 b- defN 23-Jul-26 22:24 navi/plugins/was.py
--rw-r--r--  2.0 unx    10467 b- defN 23-Jul-26 22:24 navi/plugins/was_export.py
--rw-r--r--  2.0 unx    35149 b- defN 23-Jul-26 22:24 navi_pro-7.3.1.dist-info/LICENSE
--rw-r--r--  2.0 unx     3376 b- defN 23-Jul-26 22:24 navi_pro-7.3.1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jul-26 22:24 navi_pro-7.3.1.dist-info/WHEEL
--rw-r--r--  2.0 unx       39 b- defN 23-Jul-26 22:24 navi_pro-7.3.1.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        5 b- defN 23-Jul-26 22:24 navi_pro-7.3.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     5111 b- defN 23-Jul-26 22:24 navi_pro-7.3.1.dist-info/RECORD
-63 files, 381725 bytes uncompressed, 102322 bytes compressed:  73.2%
+Zip file size: 110574 bytes, number of entries: 63
+-rw-r--r--  2.0 unx       27 b- defN 23-Aug-04 21:55 navi/__init__.py
+-rw-r--r--  2.0 unx      219 b- defN 23-Aug-04 21:55 navi/cli.py
+-rw-r--r--  2.0 unx     1799 b- defN 23-Aug-04 21:55 navi/plugins/__init__.py
+-rw-r--r--  2.0 unx     5783 b- defN 23-Aug-04 21:55 navi/plugins/access.py
+-rw-r--r--  2.0 unx     2035 b- defN 23-Aug-04 21:55 navi/plugins/add.py
+-rw-r--r--  2.0 unx     1250 b- defN 23-Aug-04 21:55 navi/plugins/add_by_file.py
+-rw-r--r--  2.0 unx     1760 b- defN 23-Aug-04 21:55 navi/plugins/agent_export.py
+-rw-r--r--  2.0 unx     2278 b- defN 23-Aug-04 21:55 navi/plugins/agent_group_export.py
+-rw-r--r--  2.0 unx     7500 b- defN 23-Aug-04 21:55 navi/plugins/agents.py
+-rw-r--r--  2.0 unx     3184 b- defN 23-Aug-04 21:55 navi/plugins/agroup.py
+-rw-r--r--  2.0 unx     1104 b- defN 23-Aug-04 21:55 navi/plugins/api.py
+-rw-r--r--  2.0 unx     5881 b- defN 23-Aug-04 21:55 navi/plugins/api_wrapper.py
+-rw-r--r--  2.0 unx     1410 b- defN 23-Aug-04 21:55 navi/plugins/attribute.py
+-rw-r--r--  2.0 unx     7165 b- defN 23-Aug-04 21:55 navi/plugins/automation.py
+-rw-r--r--  2.0 unx      700 b- defN 23-Aug-04 21:55 navi/plugins/cancel.py
+-rw-r--r--  2.0 unx     2364 b- defN 23-Aug-04 21:55 navi/plugins/compliance_export_csv.py
+-rw-r--r--  2.0 unx     2176 b- defN 23-Aug-04 21:55 navi/plugins/cve_compare.py
+-rw-r--r--  2.0 unx     8597 b- defN 23-Aug-04 21:55 navi/plugins/database.py
+-rw-r--r--  2.0 unx     9303 b- defN 23-Aug-04 21:55 navi/plugins/dbconfig.py
+-rw-r--r--  2.0 unx     2879 b- defN 23-Aug-04 21:55 navi/plugins/delete.py
+-rw-r--r--  2.0 unx     7045 b- defN 23-Aug-04 21:55 navi/plugins/deploy.py
+-rw-r--r--  2.0 unx    27152 b- defN 23-Aug-04 21:55 navi/plugins/display.py
+-rw-r--r--  2.0 unx     1795 b- defN 23-Aug-04 21:55 navi/plugins/epss.py
+-rw-r--r--  2.0 unx      175 b- defN 23-Aug-04 21:55 navi/plugins/error_msg.py
+-rw-r--r--  2.0 unx     1147 b- defN 23-Aug-04 21:55 navi/plugins/exclusions.py
+-rw-r--r--  2.0 unx     6490 b- defN 23-Aug-04 21:55 navi/plugins/export.py
+-rw-r--r--  2.0 unx    13487 b- defN 23-Aug-04 21:55 navi/plugins/find.py
+-rw-r--r--  2.0 unx     8385 b- defN 23-Aug-04 21:55 navi/plugins/fixed_export.py
+-rw-r--r--  2.0 unx    25296 b- defN 23-Aug-04 21:55 navi/plugins/ip.py
+-rw-r--r--  2.0 unx     1382 b- defN 23-Aug-04 21:55 navi/plugins/keys.py
+-rw-r--r--  2.0 unx      268 b- defN 23-Aug-04 21:55 navi/plugins/licensed_count.py
+-rw-r--r--  2.0 unx     2568 b- defN 23-Aug-04 21:55 navi/plugins/lumin.py
+-rw-r--r--  2.0 unx     2584 b- defN 23-Aug-04 21:55 navi/plugins/migrate.py
+-rw-r--r--  2.0 unx     5987 b- defN 23-Aug-04 21:55 navi/plugins/network.py
+-rw-r--r--  2.0 unx     3101 b- defN 23-Aug-04 21:55 navi/plugins/push.py
+-rw-r--r--  2.0 unx     1131 b- defN 23-Aug-04 21:55 navi/plugins/query_export.py
+-rw-r--r--  2.0 unx     2002 b- defN 23-Aug-04 21:55 navi/plugins/query_export_32K.py
+-rw-r--r--  2.0 unx     1615 b- defN 23-Aug-04 21:55 navi/plugins/rules.py
+-rw-r--r--  2.0 unx    21707 b- defN 23-Aug-04 21:55 navi/plugins/scan.py
+-rw-r--r--  2.0 unx    11818 b- defN 23-Aug-04 21:55 navi/plugins/scan_efficentcy.py
+-rw-r--r--  2.0 unx    19158 b- defN 23-Aug-04 21:55 navi/plugins/scan_evaluation.py
+-rw-r--r--  2.0 unx      250 b- defN 23-Aug-04 21:55 navi/plugins/sgroup.py
+-rw-r--r--  2.0 unx     1393 b- defN 23-Aug-04 21:55 navi/plugins/sla.py
+-rw-r--r--  2.0 unx      781 b- defN 23-Aug-04 21:55 navi/plugins/ssh.py
+-rw-r--r--  2.0 unx    24987 b- defN 23-Aug-04 21:55 navi/plugins/tag.py
+-rw-r--r--  2.0 unx     2677 b- defN 23-Aug-04 21:55 navi/plugins/tag_helper.py
+-rw-r--r--  2.0 unx     3980 b- defN 23-Aug-04 21:55 navi/plugins/tagrule.py
+-rw-r--r--  2.0 unx     6826 b- defN 23-Aug-04 21:55 navi/plugins/target_group.py
+-rw-r--r--  2.0 unx    10001 b- defN 23-Aug-04 21:55 navi/plugins/th_asset_export.py
+-rw-r--r--  2.0 unx     8152 b- defN 23-Aug-04 21:55 navi/plugins/th_compliance_export.py
+-rw-r--r--  2.0 unx    14000 b- defN 23-Aug-04 21:55 navi/plugins/th_vuln_export.py
+-rw-r--r--  2.0 unx     5796 b- defN 23-Aug-04 21:55 navi/plugins/update.py
+-rw-r--r--  2.0 unx     4088 b- defN 23-Aug-04 21:55 navi/plugins/user.py
+-rw-r--r--  2.0 unx     1165 b- defN 23-Aug-04 21:55 navi/plugins/user_export.py
+-rw-r--r--  2.0 unx     2247 b- defN 23-Aug-04 21:55 navi/plugins/usergroup.py
+-rw-r--r--  2.0 unx     9915 b- defN 23-Aug-04 21:55 navi/plugins/was.py
+-rw-r--r--  2.0 unx    10467 b- defN 23-Aug-04 21:55 navi/plugins/was_export.py
+-rw-r--r--  2.0 unx    35149 b- defN 23-Aug-04 21:55 navi_pro-7.3.9.dist-info/LICENSE
+-rw-r--r--  2.0 unx     3376 b- defN 23-Aug-04 21:55 navi_pro-7.3.9.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Aug-04 21:55 navi_pro-7.3.9.dist-info/WHEEL
+-rw-r--r--  2.0 unx       39 b- defN 23-Aug-04 21:55 navi_pro-7.3.9.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        5 b- defN 23-Aug-04 21:55 navi_pro-7.3.9.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     5112 b- defN 23-Aug-04 21:55 navi_pro-7.3.9.dist-info/RECORD
+63 files, 382205 bytes uncompressed, 102606 bytes compressed:  73.2%
```

## zipnote {}

```diff
@@ -165,26 +165,26 @@
 
 Filename: navi/plugins/was.py
 Comment: 
 
 Filename: navi/plugins/was_export.py
 Comment: 
 
-Filename: navi_pro-7.3.1.dist-info/LICENSE
+Filename: navi_pro-7.3.9.dist-info/LICENSE
 Comment: 
 
-Filename: navi_pro-7.3.1.dist-info/METADATA
+Filename: navi_pro-7.3.9.dist-info/METADATA
 Comment: 
 
-Filename: navi_pro-7.3.1.dist-info/WHEEL
+Filename: navi_pro-7.3.9.dist-info/WHEEL
 Comment: 
 
-Filename: navi_pro-7.3.1.dist-info/entry_points.txt
+Filename: navi_pro-7.3.9.dist-info/entry_points.txt
 Comment: 
 
-Filename: navi_pro-7.3.1.dist-info/top_level.txt
+Filename: navi_pro-7.3.9.dist-info/top_level.txt
 Comment: 
 
-Filename: navi_pro-7.3.1.dist-info/RECORD
+Filename: navi_pro-7.3.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## navi/plugins/api_wrapper.py

```diff
@@ -4,15 +4,15 @@
 from json import JSONDecodeError
 from .database import new_db_connection
 from tenable.io import TenableIO
 import time
 
 
 def navi_version():
-    return "navi-7.2.4"
+    return "navi-7.3.9"
 
 
 def tenb_connection():
     try:
         database = r"navi.db"
         conn = new_db_connection(database)
         with conn:
```

## navi/plugins/database.py

```diff
@@ -20,31 +20,35 @@
         c.execute('pragma journal_mode=wal;')
         c.execute(table_information)
     except Error as e:
         click.echo(e)
 
 
 def db_query(statement):
-    # start = time.time()
-    database = r"navi.db"
-    query_conn = new_db_connection(database)
-    with query_conn:
-        cur = query_conn.cursor()
-        cur.execute('pragma journal_mode=wal;')
-        cur.execute('pragma cache_size=-10000;')
-        cur.execute('PRAGMA synchronous = OFF')
-        cur.execute('pragma threads=4')
-        cur.execute(statement)
-
-        data = cur.fetchall()
-        # end = time.time()
-        # total = end - start
-    query_conn.close()
-    # click.echo("Sql Query took: {} seconds".format(total))
-    return data
+    try:
+        # start = time.time()
+        database = r"navi.db"
+        query_conn = new_db_connection(database)
+        with query_conn:
+            cur = query_conn.cursor()
+            cur.execute('pragma journal_mode=wal;')
+            cur.execute('pragma cache_size=-10000;')
+            cur.execute('PRAGMA synchronous = OFF')
+            cur.execute('pragma threads=4')
+            cur.execute(statement)
+
+            data = cur.fetchall()
+            # end = time.time()
+            # total = end - start
+        query_conn.close()
+        # click.echo("Sql Query took: {} seconds".format(total))
+        return data
+    except Error as e:
+        click.echo("\nRun navi update...Got a DB issue\n\nHere is the error:\n{}\n\n".format(e))
+        exit()
 
 
 def get_last_update_id():
     database = r"navi.db"
     conn = new_db_connection(database)
     try:
         with conn:
@@ -238,15 +242,14 @@
     VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)'''
     cur2 = conn.cursor()
     cur2.execute('pragma journal_mode=wal;')
     cur2.execute(sql2, plugins)
 
 
 def insert_epss(conn2, epss_data):
-    print("Should be inserting {}".format(epss_data))
     sql_epss = '''INSERT or IGNORE into epss(
                             cve,
                             epss_value,
                             percentile) VALUES(?,?,?)'''
     epss_cur = conn2.cursor()
     epss_cur.execute('pragma journal_mode=wal;')
     epss_cur.execute(sql_epss, epss_data)
```

## navi/plugins/display.py

```diff
@@ -151,46 +151,22 @@
                 click.echo("{:36} {:65} {:6} {}".format(ipv4, fqdn, exposure_score, acr))
             click.echo()
         except TypeError:
             click.echo("\nThe Tag has no assets or the tag hasn't finished being processed by T.io\n")
     else:
         try:
             click.echo("\nBelow are the assets found in the last 30 days")
-            click.echo("\n{:16} {:65} {:40} {:6} {}".format("IP Address", "FQDN", "UUID", "AES", "Sources"))
+            click.echo("\n{:16} {:65} {:40} {:6}".format("IP Address", "FQDN", "UUID", "AES"))
             click.echo("-" * 150)
+            asset_data = db_query("select ip_address, fqdn, uuid, aes from assets;")
+            for asset in asset_data:
 
-            count = 0
-            for asset in tio.workbenches.assets():
-                count += 1
-                sources = ""
-                try:
-                    exposure_score = str(asset["exposure_score"])
-                except KeyError:
-                    exposure_score = "- -"
-
-                try:
-                    uuid = asset["id"]
-                except IndexError:
-                    uuid = " - - - - - - - "
-                try:
-                    fqdn = asset["fqdn"][0]
-                except IndexError:
-                    fqdn = " - - - - - - - "
-
-                try:
-                    ipv4 = asset["ipv4"][0]
-                except IndexError:
-                    ipv4 = " - - - - - - - "
+                click.echo("{:16} {:65} {:40} {:6} ".format(asset[0], asset[1], asset[2], asset[3]))
 
-                for source in asset["sources"]:
-                    sources += ", {}".format(str(source['name']))
-
-                click.echo("{:16} {:65} {:40} {:6} {}".format(ipv4, fqdn, uuid, exposure_score, sources[1:]))
-
-            click.echo("\nTotal: {}".format(count))
+            click.echo("\nTotal: {}\n\n".format(len(asset_data)))
         except AttributeError:
             click.echo("\nCheck your permissions or your API keys\n")
 
 
 @display.command(help="Display Scan Policies")
 def policies():
     try:
@@ -209,19 +185,20 @@
 def connectors():
     try:
         resp = tio.get('settings/connectors')
         data = resp.json()
 
         click.echo("\n{:11s} {:40s} {:40s} {:30s} {}".format("Type", "Connector Name", "Connector ID", "Last Sync", "Schedule"))
         click.echo("-" * 150)
-
+        schedule = "None"
         for conn in data["connectors"]:
-            schedule = str(conn['schedule']['value']) + " " + str(conn['schedule']['units'])
-
             try:
+                schedule = str(conn['schedule']['value']) + " " + str(conn['schedule']['units'])
+
+
                 last_sync = conn['last_sync_time']
             except KeyError:
                 last_sync = "Hasn't synced"
 
             click.echo("{:11s} {:40s} {:40s} {:30s} {}".format(str(conn['type']), str(conn['name']), str(conn['id']),
                                                                last_sync, schedule))
         click.echo()
@@ -394,45 +371,14 @@
             category_uuid = cats['uuid']
             click.echo("{:31s} {}".format(str(category_name), str(category_uuid)))
         click.echo()
     except AttributeError:
         click.echo("\nCheck your permissions or your API keys\n")
 
 
-@display.command(help="Display Assets discovered by the Tenable Cloud Connectors")
-def cloud():
-    try:
-        click.echo("\n{:13s} {:15s} {:50s} {:40} {}".format("Source", "IP", "FQDN", "UUID", "First seen"))
-        click.echo("-" * 150)
-
-        for cloud_assets in tio.workbenches.assets(('sources', 'set-has', 'AWS'), ('sources', 'set-has', 'GCP'),
-                                                   ('sources', 'set-has', 'AZURE'), filter_type="or", age=90):
-            for source in cloud_assets['sources']:
-                if source['name'] != 'NESSUS_SCAN':
-
-                    try:
-                        asset_ip = cloud_assets['ipv4'][0]
-                    except IndexError:
-                        asset_ip = "No Ip found"
-
-                    uuid = cloud_assets['id']
-
-                    try:
-                        asset_fqdn = cloud_assets['fqdn'][0]
-                    except IndexError:
-                        asset_fqdn = "NO FQDN found"
-
-                    click.echo("{:13s} {:15s} {:50s} {:40s} {}".format(str(source['name']), str(asset_ip),
-                                                                       str(asset_fqdn), str(uuid),
-                                                                       str(source['first_seen'])))
-        click.echo()
-    except AttributeError:
-        click.echo("\nCheck your permissions or your API keys\n")
-
-
 @display.command(help="Display Network Information including scanner counts")
 def networks():
     try:
         click.echo("\n{:45s} {:16} {}".format("Network Name", "# of Scanners", "UUID"))
         click.echo("-" * 150)
 
         for network in tio.networks.list():
```

## navi/plugins/find.py

```diff
@@ -58,26 +58,33 @@
     if len(cve_id) < 10:
         click.echo("\nThis is likely not a CVE...Try again...\n")
 
     elif "CVE" not in cve_id:
         click.echo("\nYou must have 'CVE' in your CVE string. EX: CVE-1111-2222\n")
 
     else:
-        click.echo("\n{:8s} {:16s} {:46s} {:40s} {}".format("Plugin", "IP Address", "FQDN", "UUID", "Network UUID"))
+        click.echo("\n{:8s} {:>8} {:16s} {:40s} {:38s} {}".format("Plugin", "EPSS", "IP Address", "FQDN", "UUID", "Network UUID"))
         click.echo("-" * 150)
 
         plugin_data = db_query("SELECT asset_ip, asset_uuid, fqdn, plugin_id, network from vulns LEFT JOIN "
                                "assets ON asset_uuid = uuid where cves LIKE '%" + cve_id + "%';")
 
         for row in plugin_data:
             try:
                 fqdn = row[2]
             except:
                 fqdn = " "
-            click.echo("{:8s} {:16s} {:46s} {:40s} {}".format(row[3], row[0], textwrap.shorten(fqdn, 46), row[1], row[4]))
+
+            try:
+                epss_data_raw = db_query("select epss_value from epss where cve='{}'".format(cve_id))
+                epss_data = str(epss_data_raw[0][0])
+            except:
+                epss_data = 'No EPSS'
+
+            click.echo("{:8s} {:>8} {:16s} {:40s} {:38s} {} ".format(row[3], epss_data, row[0], textwrap.shorten(fqdn, 40), row[1], row[4]))
 
         click.echo()
 
 
 @find.command(help="Find Assets that have an exploitable vulnerability")
 def exploit():
```

## navi/plugins/ip.py

```diff
@@ -1,12 +1,12 @@
 import click
 import textwrap
 from sqlite3 import Error
 from .api_wrapper import tenb_connection, request_data
-from .database import db_query
+from .database import db_query, new_db_connection
 
 tio = tenb_connection()
 
 
 def plugin_by_ip(ipaddr, plugin):
     try:
         if len(ipaddr) < 17:
@@ -31,14 +31,36 @@
             click.echo("-" * 60)
             click.echo(plug[0])
 
             if plug[1] != ' ':
                 click.echo("CVEs attached to this plugin")
                 click.echo("-" * 80)
                 click.echo("{}\n".format(plug[1]))
+
+                total = 0
+                epss_list = []
+                try:
+                    for cve in eval(plug[1]):
+                        database = r"navi.db"
+                        conn = new_db_connection(database)
+                        with conn:
+                            cur = conn.cursor()
+
+                            cur.execute("select epss_value from epss where cve='{}'".format(cve))
+                            epss_value = cur.fetchall()
+                            epss_list.append(eval(epss_value[0][0]))
+                            total += total + eval(epss_value[0][0])
+
+                    average = total/len(epss_list)
+                    top = max(epss_list)
+                    click.echo("{:>15} {:>15} {:>15}".format("EPSS Average", "EPSS Max", "EPSS Total"))
+                    click.echo("-" * 80)
+                    click.echo("{:>15} {:>15} {:>15}".format(average, top, total))
+                except:
+                    pass
         click.echo()
     except IndexError:
         click.echo("No information found for this plugin")
 
 
 def vulns_by_uuid(uuid):
     try:
@@ -83,25 +105,49 @@
             click.echo("{:10s} {:90s} {:25s} {:6s} {:6s} {}".format(plugin_id, plugin_name, plugin_family, port, protocol, severity))
         click.echo("")
     except Error as e:
         click.echo(e)
 
 
 def cves_by_uuid(uuid):
+
     try:
         data = db_query("select plugin_id, cves from vulns where asset_uuid='{}' and cves !=' ';".format(uuid))
 
-        click.echo("\n{:10s} {}".format("Plugin", "CVEs"))
+        click.echo("\n{:10s} {:60} {:>15} {:>15} {:>15}".format("Plugin", "CVEs", "Avg EPSS", "Total EPSS", "Top EPSS"))
         click.echo("-"*150)
 
         for vulns in data:
             plugin_id = vulns[0]
             cves = vulns[1]
-            click.echo("{:10s} {}".format(plugin_id, textwrap.shorten(cves, 140)))
-        click.echo("")
+            try:
+                total = 0
+                epss_list = []
+
+                for cve in eval(cves):
+                    database = r"navi.db"
+                    conn = new_db_connection(database)
+                    with conn:
+                        cur = conn.cursor()
+
+                        cur.execute("select epss_value from epss where cve='{}'".format(cve))
+                        epss_value = cur.fetchall()
+                        epss_list.append(eval(epss_value[0][0]))
+                        total += total + eval(epss_value[0][0])
+
+                average = total/len(epss_list)
+                top = max(epss_list)
+                click.echo("{:10s} {:60} {:15} {:15} {:15}".format(plugin_id, textwrap.shorten(cves, 140), average, total, top))
+            except:
+                average = "No EPSS"
+                total = "No EPSS"
+                top = "No EPSS"
+                click.echo("{:10s} {:60} {:>15} {:>15} {:>15}".format(plugin_id, textwrap.shorten(cves, 140), average, total, top))
+
+
     except IndexError:
         click.echo("Something went wrong")
 
 
 @click.command(help="Get Asset details based on IP or UUID")
 @click.argument('ipaddr')
 @click.option('--plugin', default='', help='Find Details on a particular plugin ID')
@@ -531,17 +577,15 @@
 
             for assets in data:
                 click.echo("\nAsset UUID: {}".format(assets[0]))
                 click.echo("Asset IP: {}".format(ipaddr))
                 click.echo("-" * 26)
                 cves_by_uuid(assets[0])
         else:
-            data = db_query("select uuid from assets where uuid='{}'".format(ipaddr))
             click.echo("\nAsset UUID: {}".format(ipaddr))
-            click.echo("Asset IP: {}".format(data[0]))
             click.echo("-" * 26)
             cves_by_uuid(ipaddr)
 
     if info:
         if len(ipaddr) < 17:
             intial_data = db_query("SELECT asset_uuid from vulns where asset_ip='{}';".format(ipaddr))
             data = set(intial_data)
```

## navi/plugins/push.py

```diff
@@ -1,9 +1,13 @@
-import pexpect
-from pexpect import pxssh
+try:
+    import pexpect
+    from pexpect import pxssh
+except ImportError:
+    #print("\nInformation: Navi push will not work on this system!\n")
+    pass
 import click
 from .database import db_query
 
 
 PROMPT = ['#', '>>> ', '> ', '\$ ']
 
 
@@ -48,35 +52,38 @@
         print(e)
 
 
 def scp(user, host, password, filename):
     ssh_new_key_string = 'Are you sure you want to continue connecting'
     scp_login_string = 'scp {} {}@{}:/'.format(filename, user, host)
 
-    shell = pexpect.spawn(scp_login_string, timeout=300)
-
-    return_code = shell.expect([pexpect.TIMEOUT, ssh_new_key_string, '[P|p]assword:'])
-
-    if return_code == 0:
-        print("error connecting")
-        exit()
+    try:
+        shell = pexpect.spawn(scp_login_string, timeout=300)
 
-    if return_code == 1:
-        shell.sendline('yes')
-        second_return_code = shell.expect([pexpect.TIMEOUT, '[P|p]assword:'])
+        return_code = shell.expect([pexpect.TIMEOUT, ssh_new_key_string, '[P|p]assword:'])
 
-        if second_return_code == 0:
+        if return_code == 0:
             print("error connecting")
-            return
+            exit()
 
-    shell.sendline(password)
-    shell.expect(pexpect.EOF)
-    response = shell.before
-    print(response.decode('utf-8'))
-    print()
+        if return_code == 1:
+            shell.sendline('yes')
+            second_return_code = shell.expect([pexpect.TIMEOUT, '[P|p]assword:'])
+
+            if second_return_code == 0:
+                print("error connecting")
+                return
+
+        shell.sendline(password)
+        shell.expect(pexpect.EOF)
+        response = shell.before
+        print(response.decode('utf-8'))
+        print()
+    except:
+        print("\nThis Feature has been disabled.  You're system doesn't allow for pexpect.spawn\n")
 
 
 @click.command(help="Push a command to a linux target")
 @click.option('--command', default=None, help="Command you want to run in double-quotes")
 @click.option('--target', required=True, help="Target IP receiving the command")
 @click.option('--file', default=None, help="Push a file to a target")
 def push(command, target, file):
```

## navi/plugins/th_asset_export.py

```diff
@@ -226,20 +226,20 @@
     urls = []
 
     # Set the payload to the maximum number of assets to be pulled at once
     day = 86400
     new_limit = day * int(days)
     day_limit = time.time() - new_limit
     if category is None:
-        pay_load = {"chunk_size": 1000, "filters": {"updated_at": int(day_limit)}}
+        pay_load = {"chunk_size": 1000, "filters": {"last_assessed": int(day_limit)}}
     else:
         if value is None:
-            pay_load = {"chunk_size": 1000, "filters": {"updated_at": int(day_limit)}}
+            pay_load = {"chunk_size": 1000, "filters": {"last_assessed": int(day_limit)}}
         else:
-            pay_load = {"chunk_size": 1000, "filters": {"updated_at": int(day_limit), "tag.{}".format(category): value}}
+            pay_load = {"chunk_size": 1000, "filters": {"last_assessed": int(day_limit), "tag.{}".format(category): value}}
     try:
 
         if ex_uuid == '0':
             # request an export of the data
             export = request_data('POST', '/assets/export', payload=pay_load)
 
             # grab the export UUID
```

## Comparing `navi_pro-7.3.1.dist-info/LICENSE` & `navi_pro-7.3.9.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `navi_pro-7.3.1.dist-info/METADATA` & `navi_pro-7.3.9.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: navi-pro
-Version: 7.3.1
+Version: 7.3.9
 Summary: A command-line interface to Tenable.io
 Home-page: https://github.com/packetchaos/Navi
 Author: Casey Reid
 Author-email: itprofguru@gmail.com
 License: GNUv3
 Keywords: tenable tenable_io navi tio,lumin,navi pro,tio cli,tenable io cli,automation
 Platform: UNKNOWN
```

## Comparing `navi_pro-7.3.1.dist-info/RECORD` & `navi_pro-7.3.9.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -5,59 +5,59 @@
 navi/plugins/add.py,sha256=mut7GKSMBy6q4F7_p4xIq7DNAw_Vy_uCWDTlEfmQP7I,2035
 navi/plugins/add_by_file.py,sha256=RmLDSL3YthV_F2uxpCFzj9i1Zt2hQQmiA-GyamEWvRc,1250
 navi/plugins/agent_export.py,sha256=ax7QmSl9T72UXYSIKXaB0idfYamOywNr_xKiMa57QRg,1760
 navi/plugins/agent_group_export.py,sha256=3jpRR9UXp3iSHRyZI5xKZyBpe0HYleXgeTXzzGTMUaE,2278
 navi/plugins/agents.py,sha256=2RxTW62Ae64RW5-Wnnm-i2mMf_ZCdfSjeNtJD3scmd8,7500
 navi/plugins/agroup.py,sha256=9zI8rx3jAd2bG1rkbKQPvV11vdqWfRFklHpm_j0W09Y,3184
 navi/plugins/api.py,sha256=flrMefREoaRkhvgM2KFmAyWrFfjulmxxFRcMJQBi5UA,1104
-navi/plugins/api_wrapper.py,sha256=V7luGISGr8PV-G7p5gtTH81MupF6wOvPW41NUOj3MR8,5881
+navi/plugins/api_wrapper.py,sha256=-6WPD_HouyjJn03I6pRTNVSZD1JNgPxUbyFbRy6a-jU,5881
 navi/plugins/attribute.py,sha256=2BrWHqTLdMOWql6DpT2vI0TUfwD8WgXDl0Ej0AtIwAU,1410
 navi/plugins/automation.py,sha256=ene5b9wbsI7o84Yi4t6ed2XFAgwXxLIxG-Dwocc7mrg,7165
 navi/plugins/cancel.py,sha256=s8Hdm8F5SSf_ODLx1JkMFnUuTGt6hW4GTrmqI8xr2Pc,700
 navi/plugins/compliance_export_csv.py,sha256=Nvd1JqsJehoDiKuTf_YPZR9-Dr-x1ya574HSeB2qU0w,2364
 navi/plugins/cve_compare.py,sha256=kGzMX9a_x7q0flugOLTXEWIeM3YLUf9T5JIm-r-VqtY,2176
-navi/plugins/database.py,sha256=CwHT9z_ORkvzxmPd0G_oe1g4nEdZYWA6BGvpQiXcEp0,8443
+navi/plugins/database.py,sha256=hWZGXM1u1oQiGOAgZqpkVELfoQ5T5JG8sHZ1QijljAQ,8597
 navi/plugins/dbconfig.py,sha256=OtGKmsuwrAErGCwUWyPukRyurbRaIuEqYFBA4HHAmio,9303
 navi/plugins/delete.py,sha256=sjv97CEnIiYbQGVUlCl2MtmASgnzCGSlbS7MoJwDfA4,2879
 navi/plugins/deploy.py,sha256=TN23v65b-o8VdqsePjkZ71yhrAQqYpG-IvN_cAuKQus,7045
-navi/plugins/display.py,sha256=1KCCFkaP_OzkF_2QHCIn4JZRaOzRCq3NSb4GK9Cv2Ns,29240
+navi/plugins/display.py,sha256=znJM2Z5sDiMcn3ZP-0KNPrFzTDZXN0PgfGkxycaMzH4,27152
 navi/plugins/epss.py,sha256=iCFBwXPzmYRLbSSH-F_1e8ZJt4JgGtBAqxENX2gHoYk,1795
 navi/plugins/error_msg.py,sha256=1U9HYU9_hxtL02Ck15jm01-yHBZuB5pKF506ksnksfY,175
 navi/plugins/exclusions.py,sha256=zdxOWrA7RDaM_eZ9E86zo9n7efXA76iAe0w_TZ_Y_bg,1147
 navi/plugins/export.py,sha256=TTgsbA0C60Ipl9QiwFFvaBxT0XISTbl3EZBsrfS507A,6490
-navi/plugins/find.py,sha256=ZCZnwAp_HzpUALRNZV9s-p4w6yPTOTsIjeSJPnmBcZk,13223
+navi/plugins/find.py,sha256=UG6B_PaG1eYVmWBeufvfUb0qlo-BohYxw_RKBfzSBHY,13487
 navi/plugins/fixed_export.py,sha256=FnAwBo8DCH-4_AfxQmTTiogvpwlaraoWUOdBj2-f0_I,8385
-navi/plugins/ip.py,sha256=y4xlY1PGvKBY1QI-3_hJEdeSGCeeI52XlkeZpQ8Ygkc,23454
+navi/plugins/ip.py,sha256=QelvrhITGLPRVK0870whZ3edoOgqOykdm2IIvb4Jseg,25296
 navi/plugins/keys.py,sha256=qji_aCXWYG-hoAGtj2XrtMpPSPmDTF0K0jpqJ3ti_rk,1382
 navi/plugins/licensed_count.py,sha256=MxzevWTjWK9OI4KaqXBeU52SwUA-8WFI_q0QDGiHlXs,268
 navi/plugins/lumin.py,sha256=u8HSIgW1wyzI0Dv8f4zXqkEO8R09gd0PFaZQJWK0h2M,2568
 navi/plugins/migrate.py,sha256=u0y51M11Dp0RQcaSS2Lk9673HhnYPCW3Nq3TjZvnp0M,2584
 navi/plugins/network.py,sha256=c-NDE-JAhPQK_Zn9huRXCdjCpWhP_cIppj-OxBlN2qc,5987
-navi/plugins/push.py,sha256=aiFcRrAgz0_6SB58dYjV4WWznvYRJc92oKrgaRDz25c,2803
+navi/plugins/push.py,sha256=5ceoFMth9IAd5aggQ87P4PXjvCPZ_bosPsjmlnx-cF4,3101
 navi/plugins/query_export.py,sha256=X8gyyg8zekWWcxKDIYQCq_U05mWxbzRKXBFhNo4Yv0c,1131
 navi/plugins/query_export_32K.py,sha256=Em44kLC8aNPVlrFpzkYh0F68p2jOx4opxflwCDHaiRE,2002
 navi/plugins/rules.py,sha256=PtsQiy6OGMBMpvCypINk6pfPENTihZM4kupD2REnays,1615
 navi/plugins/scan.py,sha256=gDw_9X8Pi77aMyGf53bM1biS4-Uvc_pF6LgXinE6q30,21707
 navi/plugins/scan_efficentcy.py,sha256=uSqHMd-acq8B-oTj0MhinCZlDP9HLr8Uh9c0BlMso8Q,11818
 navi/plugins/scan_evaluation.py,sha256=vIyVrAaKGXpFp-ZhLtc0I8IkUFE0p7uutDggBEGr8Ng,19158
 navi/plugins/sgroup.py,sha256=KjGXhfgVnQMM5Ji4VMtMyPI42dCxS8x1QyOtGxW7K58,250
 navi/plugins/sla.py,sha256=Ynx4osvBFv1t_iSQHjXPzthBgksfupEBdfCvtiWs_dw,1393
 navi/plugins/ssh.py,sha256=YltqFoe5eAgkLAxbzmi0aE98NeMrccI7GdJyp74Sp6M,781
 navi/plugins/tag.py,sha256=mU49JJm84vgvpXaL0f3Rki0gPr2l5d5BhvNQqVNncv0,24987
 navi/plugins/tag_helper.py,sha256=48bPTEBzfNU0MCKh3L4MciWgpUBpHws4GEH_PzVojhg,2677
 navi/plugins/tagrule.py,sha256=DlR2BJMv_TBID_KIjRNRzX2oW-BTWH_rtn6I3by2ytA,3980
 navi/plugins/target_group.py,sha256=4sMJTlJk9J2WV9B-jc4Dsc8oGwF0a3luc4huI-Tgpac,6826
-navi/plugins/th_asset_export.py,sha256=RlmcOhEHPdjZxxQ_BK7Hnk9zq9IW1gyAdMcA036hEw8,9992
+navi/plugins/th_asset_export.py,sha256=GWNXPpKrSOKy8hy62QvYFlsX4ZtxEkFbGPBbrkCQ0qI,10001
 navi/plugins/th_compliance_export.py,sha256=UhwOwqrbVpO7RQQkQJ09P74VX1pXlKpJZjEBIqSR4GU,8152
 navi/plugins/th_vuln_export.py,sha256=H_hmjEVH8YicGeFmh7bpEHwXlQdXc6LsSN43Mou-wWE,14000
 navi/plugins/update.py,sha256=-I88VKG7VKzh7phQldDIWSq-_T3Z1QOdsiyUEjOb3FQ,5796
 navi/plugins/user.py,sha256=wOJSpilgETvbBa612YQWjGa_B842szw6LdNnv0Nbg6k,4088
 navi/plugins/user_export.py,sha256=aep0lEtcqg1nDaGBlP_UMRGiKBOtb_6BXCqbZGY8Bkc,1165
 navi/plugins/usergroup.py,sha256=3URKQolIgjOcRh6zYQtK8227zavCd_11Ar5N4wY5yiU,2247
 navi/plugins/was.py,sha256=ve9XC6Z1COSWN37Mc3q3mQfydZ8E8JTSuyhIT_AnHR4,9915
 navi/plugins/was_export.py,sha256=vdKIWFa0AUMwjPvdu89UsBZYcf5VbgRAnbcLn58oP4s,10467
-navi_pro-7.3.1.dist-info/LICENSE,sha256=OXLcl0T2SZ8Pmy2_dmlvKuetivmyPd5m1q-Gyd-zaYY,35149
-navi_pro-7.3.1.dist-info/METADATA,sha256=XcGjDOSap72T76joG9-NdfzBGnRKS4KaHWfUg8kUnKg,3376
-navi_pro-7.3.1.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
-navi_pro-7.3.1.dist-info/entry_points.txt,sha256=bLGukOkT_hHrmt9ksf6Y6l2HO30mn_BlFGfBhl6BKpg,39
-navi_pro-7.3.1.dist-info/top_level.txt,sha256=xXzJ0CXt7AQbWOk2RckcuXcLLQtbDJrWxlp4ckfFMSY,5
-navi_pro-7.3.1.dist-info/RECORD,,
+navi_pro-7.3.9.dist-info/LICENSE,sha256=OXLcl0T2SZ8Pmy2_dmlvKuetivmyPd5m1q-Gyd-zaYY,35149
+navi_pro-7.3.9.dist-info/METADATA,sha256=7BKR4BNBlcvtzo9orbwy7ntPSXzaAFvPzS81nWvVr-U,3376
+navi_pro-7.3.9.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
+navi_pro-7.3.9.dist-info/entry_points.txt,sha256=bLGukOkT_hHrmt9ksf6Y6l2HO30mn_BlFGfBhl6BKpg,39
+navi_pro-7.3.9.dist-info/top_level.txt,sha256=xXzJ0CXt7AQbWOk2RckcuXcLLQtbDJrWxlp4ckfFMSY,5
+navi_pro-7.3.9.dist-info/RECORD,,
```

