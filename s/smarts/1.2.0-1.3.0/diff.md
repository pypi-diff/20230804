# Comparing `tmp/smarts-1.2.0-py3-none-any.whl.zip` & `tmp/smarts-1.3.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,10 +1,10 @@
-Zip file size: 4939769 bytes, number of entries: 366
+Zip file size: 4939772 bytes, number of entries: 366
 -rw-rw-r--  2.0 unx     1624 b- defN 23-Mar-13 14:44 cli/__init__.py
--rw-rw-r--  2.0 unx     3984 b- defN 23-Aug-03 20:57 cli/benchmark.py
+-rw-rw-r--  2.0 unx     3816 b- defN 23-Aug-03 23:54 cli/benchmark.py
 -rw-rw-r--  2.0 unx     1806 b- defN 23-Mar-24 15:12 cli/cli.py
 -rw-rw-r--  2.0 unx     1580 b- defN 23-Mar-16 18:33 cli/diagnostic.py
 -rw-rw-r--  2.0 unx     1925 b- defN 23-Jul-05 17:14 cli/envision.py
 -rw-rw-r--  2.0 unx     3035 b- defN 23-Mar-16 18:33 cli/run.py
 -rw-rw-r--  2.0 unx     3956 b- defN 23-Mar-16 18:33 cli/studio.py
 -rw-rw-r--  2.0 unx     3634 b- defN 23-Jul-05 17:14 cli/waymo.py
 -rw-rw-r--  2.0 unx     3797 b- defN 23-Jul-05 17:14 cli/zoo.py
@@ -21,121 +21,123 @@
 -rw-rw-r--  2.0 unx    17915 b- defN 23-Jul-05 17:14 envision/web/dist/main.js.LICENSE.txt
 -rw-rw-r--  2.0 unx 15225864 b- defN 23-Jul-05 17:14 envision/web/dist/main.js.map
 -rw-rw-r--  2.0 unx        0 b- defN 23-Aug-03 20:57 examples/rl/__init__.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Aug-03 20:57 examples/rl/drive/__init__.py
 -rw-rw-r--  2.0 unx     1220 b- defN 23-Aug-03 20:57 examples/rl/drive/inference/__init__.py
 -rw-rw-r--  2.0 unx       69 b- defN 23-Aug-03 20:57 examples/rl/drive/inference/setup.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Aug-03 20:57 examples/rl/drive/inference/contrib_policy/__init__.py
--rw-rw-r--  2.0 unx     8504 b- defN 23-Aug-03 20:57 examples/rl/drive/inference/contrib_policy/filter_obs.py
--rw-rw-r--  2.0 unx     2114 b- defN 23-Aug-03 20:57 examples/rl/drive/inference/contrib_policy/format_action.py
--rw-rw-r--  2.0 unx     2079 b- defN 23-Aug-03 20:57 examples/rl/drive/inference/contrib_policy/frame_stack.py
--rw-rw-r--  2.0 unx      594 b- defN 23-Aug-03 20:57 examples/rl/drive/inference/contrib_policy/make_dict.py
--rw-rw-r--  2.0 unx     2000 b- defN 23-Aug-03 20:57 examples/rl/drive/inference/contrib_policy/network.py
+-rw-rw-r--  2.0 unx     8517 b- defN 23-Aug-03 23:54 examples/rl/drive/inference/contrib_policy/filter_obs.py
+-rw-rw-r--  2.0 unx     2127 b- defN 23-Aug-03 23:54 examples/rl/drive/inference/contrib_policy/format_action.py
+-rw-rw-r--  2.0 unx     2092 b- defN 23-Aug-03 23:54 examples/rl/drive/inference/contrib_policy/frame_stack.py
+-rw-rw-r--  2.0 unx      607 b- defN 23-Aug-03 23:54 examples/rl/drive/inference/contrib_policy/make_dict.py
+-rw-rw-r--  2.0 unx     2013 b- defN 23-Aug-03 23:54 examples/rl/drive/inference/contrib_policy/network.py
 -rw-rw-r--  2.0 unx     2275 b- defN 23-Aug-03 20:57 examples/rl/drive/inference/contrib_policy/policy.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Aug-03 20:57 examples/rl/drive/train/__init__.py
--rw-rw-r--  2.0 unx     1049 b- defN 23-Aug-03 20:57 examples/rl/drive/train/env.py
--rw-rw-r--  2.0 unx     2081 b- defN 23-Aug-03 20:57 examples/rl/drive/train/preprocess.py
+-rw-rw-r--  2.0 unx      938 b- defN 23-Aug-03 23:54 examples/rl/drive/train/env.py
+-rw-rw-r--  2.0 unx     2194 b- defN 23-Aug-03 23:54 examples/rl/drive/train/preprocess.py
 -rw-rw-r--  2.0 unx     3329 b- defN 23-Aug-03 20:57 examples/rl/drive/train/reward.py
--rw-rw-r--  2.0 unx     7186 b- defN 23-Aug-03 20:57 examples/rl/drive/train/run.py
+-rw-rw-r--  2.0 unx     7199 b- defN 23-Aug-03 23:54 examples/rl/drive/train/run.py
 -rw-rw-r--  2.0 unx      417 b- defN 23-Aug-03 20:57 examples/rl/drive/train/utils.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Aug-03 20:57 examples/rl/platoon/__init__.py
 -rw-rw-r--  2.0 unx     1212 b- defN 23-Aug-03 20:57 examples/rl/platoon/inference/__init__.py
 -rw-rw-r--  2.0 unx       69 b- defN 23-Aug-03 20:57 examples/rl/platoon/inference/setup.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Aug-03 20:57 examples/rl/platoon/inference/contrib_policy/__init__.py
--rw-rw-r--  2.0 unx     8504 b- defN 23-Aug-03 20:57 examples/rl/platoon/inference/contrib_policy/filter_obs.py
--rw-rw-r--  2.0 unx     1310 b- defN 23-Aug-03 20:57 examples/rl/platoon/inference/contrib_policy/format_action.py
--rw-rw-r--  2.0 unx     2079 b- defN 23-Aug-03 20:57 examples/rl/platoon/inference/contrib_policy/frame_stack.py
--rw-rw-r--  2.0 unx      594 b- defN 23-Aug-03 20:57 examples/rl/platoon/inference/contrib_policy/make_dict.py
--rw-rw-r--  2.0 unx     2000 b- defN 23-Aug-03 20:57 examples/rl/platoon/inference/contrib_policy/network.py
+-rw-rw-r--  2.0 unx     8517 b- defN 23-Aug-03 23:54 examples/rl/platoon/inference/contrib_policy/filter_obs.py
+-rw-rw-r--  2.0 unx     1323 b- defN 23-Aug-03 23:54 examples/rl/platoon/inference/contrib_policy/format_action.py
+-rw-rw-r--  2.0 unx     2092 b- defN 23-Aug-03 23:54 examples/rl/platoon/inference/contrib_policy/frame_stack.py
+-rw-rw-r--  2.0 unx      607 b- defN 23-Aug-03 23:54 examples/rl/platoon/inference/contrib_policy/make_dict.py
+-rw-rw-r--  2.0 unx     2013 b- defN 23-Aug-03 23:54 examples/rl/platoon/inference/contrib_policy/network.py
 -rw-rw-r--  2.0 unx     2203 b- defN 23-Aug-03 20:57 examples/rl/platoon/inference/contrib_policy/policy.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Aug-03 20:57 examples/rl/platoon/train/__init__.py
--rw-rw-r--  2.0 unx     1049 b- defN 23-Aug-03 20:57 examples/rl/platoon/train/env.py
--rw-rw-r--  2.0 unx     1855 b- defN 23-Aug-03 20:57 examples/rl/platoon/train/preprocess.py
+-rw-rw-r--  2.0 unx      938 b- defN 23-Aug-03 23:54 examples/rl/platoon/train/env.py
+-rw-rw-r--  2.0 unx     1968 b- defN 23-Aug-03 23:54 examples/rl/platoon/train/preprocess.py
 -rw-rw-r--  2.0 unx     7348 b- defN 23-Aug-03 20:57 examples/rl/platoon/train/reward.py
--rw-rw-r--  2.0 unx     7187 b- defN 23-Aug-03 20:57 examples/rl/platoon/train/run.py
+-rw-rw-r--  2.0 unx     7200 b- defN 23-Aug-03 23:54 examples/rl/platoon/train/run.py
 -rw-rw-r--  2.0 unx      417 b- defN 23-Aug-03 20:57 examples/rl/platoon/train/utils.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Aug-03 20:57 examples/rl/rllib/__init__.py
--rw-rw-r--  2.0 unx     9355 b- defN 23-Aug-03 20:57 examples/rl/rllib/rllib.py
--rw-rw-r--  2.0 unx     3600 b- defN 23-Aug-03 20:57 examples/rl/rllib/rllib_agent.py
+-rw-rw-r--  2.0 unx     2175 b- defN 23-Aug-03 23:54 examples/rl/rllib/configs.py
+-rw-rw-r--  2.0 unx     7364 b- defN 23-Aug-03 23:54 examples/rl/rllib/pg_example.py
+-rw-rw-r--  2.0 unx    10661 b- defN 23-Aug-03 23:54 examples/rl/rllib/pg_pbt_example.py
+-rw-rw-r--  2.0 unx     4296 b- defN 23-Aug-03 23:54 examples/rl/rllib/rllib_agent.py
 -rw-rw-r--  2.0 unx     1263 b- defN 23-Jul-27 20:07 smarts/__init__.py
 -rw-rw-r--  2.0 unx      184 b- defN 23-Jul-31 21:27 smarts/engine.ini
 -rw-rw-r--  2.0 unx     4290 b- defN 23-Jul-05 17:14 smarts/benchmark/__init__.py
--rw-rw-r--  2.0 unx     1416 b- defN 23-Aug-03 20:57 smarts/benchmark/benchmark_listing.yaml
+-rw-rw-r--  2.0 unx     1413 b- defN 23-Aug-03 23:54 smarts/benchmark/benchmark_listing.yaml
 -rw-rw-r--  2.0 unx     1478 b- defN 23-Jul-05 17:14 smarts/benchmark/driving_smarts/__init__.py
 -rw-rw-r--  2.0 unx     1246 b- defN 23-Apr-24 14:19 smarts/benchmark/driving_smarts/v2022/__init__.py
 -rw-rw-r--  2.0 unx     1581 b- defN 23-Apr-24 14:19 smarts/benchmark/driving_smarts/v2022/config.yaml
 -rw-rw-r--  2.0 unx     1246 b- defN 23-Apr-24 14:19 smarts/benchmark/driving_smarts/v2023/__init__.py
--rw-rw-r--  2.0 unx      742 b- defN 23-Aug-03 20:57 smarts/benchmark/driving_smarts/v2023/config_1.yaml
--rw-rw-r--  2.0 unx      668 b- defN 23-Aug-03 20:57 smarts/benchmark/driving_smarts/v2023/config_2.yaml
--rw-rw-r--  2.0 unx     1081 b- defN 23-Aug-03 20:57 smarts/benchmark/driving_smarts/v2023/config_3.yaml
+-rw-rw-r--  2.0 unx      685 b- defN 23-Aug-03 23:54 smarts/benchmark/driving_smarts/v2023/config_1.yaml
+-rw-rw-r--  2.0 unx      611 b- defN 23-Aug-03 23:54 smarts/benchmark/driving_smarts/v2023/config_2.yaml
+-rw-rw-r--  2.0 unx     1024 b- defN 23-Aug-03 23:54 smarts/benchmark/driving_smarts/v2023/config_3.yaml
 -rw-rw-r--  2.0 unx     5516 b- defN 23-Jul-05 17:14 smarts/benchmark/driving_smarts/v2023/metric_formula_drive.py
 -rw-rw-r--  2.0 unx     5550 b- defN 23-Jul-05 17:14 smarts/benchmark/driving_smarts/v2023/metric_formula_platoon.py
 -rw-rw-r--  2.0 unx     1147 b- defN 23-Mar-16 18:33 smarts/benchmark/entrypoints/__init__.py
--rw-rw-r--  2.0 unx     8567 b- defN 23-Aug-03 20:57 smarts/benchmark/entrypoints/benchmark_runner_v0.py
+-rw-rw-r--  2.0 unx     9602 b- defN 23-Aug-03 23:54 smarts/benchmark/entrypoints/benchmark_runner_v0.py
 -rw-rw-r--  2.0 unx     3316 b- defN 23-Jul-05 17:14 smarts/core/__init__.py
 -rw-rw-r--  2.0 unx     2506 b- defN 23-May-02 13:40 smarts/core/actor.py
 -rw-rw-r--  2.0 unx     7931 b- defN 23-Jul-05 17:14 smarts/core/actor_capture_manager.py
 -rw-rw-r--  2.0 unx     2557 b- defN 23-Jul-05 17:14 smarts/core/agent.py
 -rw-rw-r--  2.0 unx     1657 b- defN 23-Mar-13 14:44 smarts/core/agent_buffer.py
 -rw-rw-r--  2.0 unx    20066 b- defN 23-Aug-03 20:57 smarts/core/agent_interface.py
 -rw-rw-r--  2.0 unx    29582 b- defN 23-Jul-05 17:14 smarts/core/agent_manager.py
 -rw-rw-r--  2.0 unx    11173 b- defN 23-May-03 22:38 smarts/core/agents_provider.py
--rw-rw-r--  2.0 unx    46467 b- defN 23-Aug-03 20:57 smarts/core/argoverse_map.py
+-rw-rw-r--  2.0 unx    46438 b- defN 23-Aug-03 23:54 smarts/core/argoverse_map.py
 -rw-rw-r--  2.0 unx     6391 b- defN 23-Jul-05 17:14 smarts/core/bezier_motion_planner.py
 -rw-rw-r--  2.0 unx    36003 b- defN 23-Jul-05 17:14 smarts/core/bubble_manager.py
 -rw-rw-r--  2.0 unx     1725 b- defN 23-Mar-13 14:44 smarts/core/buffer_agent.py
 -rw-rw-r--  2.0 unx    33174 b- defN 23-Jul-05 17:14 smarts/core/chassis.py
 -rw-rw-r--  2.0 unx     2927 b- defN 23-Jul-05 17:14 smarts/core/colors.py
 -rw-rw-r--  2.0 unx     1577 b- defN 23-Jul-05 17:14 smarts/core/condition_state.py
--rw-rw-r--  2.0 unx     5219 b- defN 23-Aug-03 20:57 smarts/core/configuration.py
--rw-rw-r--  2.0 unx    16755 b- defN 23-Aug-03 20:57 smarts/core/coordinates.py
+-rw-rw-r--  2.0 unx     5369 b- defN 23-Aug-03 23:54 smarts/core/configuration.py
+-rw-rw-r--  2.0 unx    16789 b- defN 23-Aug-03 23:54 smarts/core/coordinates.py
 -rw-rw-r--  2.0 unx     1744 b- defN 23-Apr-26 14:19 smarts/core/data_model.py
 -rw-rw-r--  2.0 unx     6133 b- defN 23-Jul-05 17:14 smarts/core/default_map_builder.py
 -rw-rw-r--  2.0 unx     2527 b- defN 23-Jul-05 17:14 smarts/core/events.py
 -rw-rw-r--  2.0 unx     5100 b- defN 23-Apr-24 16:19 smarts/core/external_provider.py
--rw-rw-r--  2.0 unx     5606 b- defN 23-Aug-03 20:57 smarts/core/id_actor_capture_manager.py
--rw-rw-r--  2.0 unx    38743 b- defN 23-Aug-03 20:57 smarts/core/lanepoints.py
+-rw-rw-r--  2.0 unx     5716 b- defN 23-Aug-03 23:54 smarts/core/id_actor_capture_manager.py
+-rw-rw-r--  2.0 unx    35365 b- defN 23-Aug-03 23:54 smarts/core/lanepoints.py
 -rw-rw-r--  2.0 unx     5647 b- defN 23-Apr-24 16:19 smarts/core/lidar.py
 -rw-rw-r--  2.0 unx     1895 b- defN 23-Mar-13 14:44 smarts/core/lidar_sensor_params.py
 -rw-rw-r--  2.0 unx     1875 b- defN 23-Mar-16 18:33 smarts/core/local_agent.py
 -rw-rw-r--  2.0 unx     1635 b- defN 23-Jul-05 17:14 smarts/core/local_agent_buffer.py
 -rw-rw-r--  2.0 unx    83039 b- defN 23-Jul-05 17:14 smarts/core/local_traffic_provider.py
 -rw-rw-r--  2.0 unx     1258 b- defN 23-Mar-13 14:44 smarts/core/masks.py
 -rw-rw-r--  2.0 unx    10143 b- defN 23-Jul-05 17:14 smarts/core/observations.py
--rw-rw-r--  2.0 unx    78063 b- defN 23-Aug-03 20:57 smarts/core/opendrive_road_network.py
+-rw-rw-r--  2.0 unx    78012 b- defN 23-Aug-03 23:54 smarts/core/opendrive_road_network.py
 -rw-rw-r--  2.0 unx    15380 b- defN 23-Jul-05 17:14 smarts/core/plan.py
 -rw-rw-r--  2.0 unx    14782 b- defN 23-Jul-05 17:14 smarts/core/provider.py
 -rw-rw-r--  2.0 unx     5444 b- defN 23-Jul-05 17:14 smarts/core/renderer_base.py
 -rw-rw-r--  2.0 unx    40732 b- defN 23-Aug-03 20:57 smarts/core/road_map.py
 -rw-rw-r--  2.0 unx    10471 b- defN 23-Jul-05 17:14 smarts/core/route_cache.py
 -rw-rw-r--  2.0 unx    42852 b- defN 23-Jul-05 17:14 smarts/core/scenario.py
 -rw-rw-r--  2.0 unx    27327 b- defN 23-Jul-05 17:14 smarts/core/sensor.py
 -rw-rw-r--  2.0 unx    11990 b- defN 23-Jul-05 17:14 smarts/core/sensor_manager.py
 -rw-rw-r--  2.0 unx     5801 b- defN 23-Mar-13 14:44 smarts/core/shape.py
 -rw-rw-r--  2.0 unx     5192 b- defN 23-May-03 22:39 smarts/core/signal_provider.py
 -rw-rw-r--  2.0 unx     2365 b- defN 23-Jul-05 17:14 smarts/core/signals.py
 -rw-rw-r--  2.0 unx     5450 b- defN 23-Jul-05 17:14 smarts/core/simulation_frame.py
 -rw-rw-r--  2.0 unx     1611 b- defN 23-Apr-24 16:19 smarts/core/simulation_local_constants.py
--rw-rw-r--  2.0 unx    71224 b- defN 23-Aug-03 20:57 smarts/core/smarts.py
--rw-rw-r--  2.0 unx    65691 b- defN 23-Aug-03 20:57 smarts/core/sumo_road_network.py
+-rw-rw-r--  2.0 unx    71256 b- defN 23-Aug-03 23:54 smarts/core/smarts.py
+-rw-rw-r--  2.0 unx    65640 b- defN 23-Aug-03 23:54 smarts/core/sumo_road_network.py
 -rw-rw-r--  2.0 unx    43102 b- defN 23-Jul-05 17:14 smarts/core/sumo_traffic_simulation.py
 -rw-rw-r--  2.0 unx    10244 b- defN 23-Jul-05 17:14 smarts/core/tire_models.py
 -rw-rw-r--  2.0 unx    21061 b- defN 23-Jul-05 17:14 smarts/core/traffic_history.py
 -rw-rw-r--  2.0 unx    11459 b- defN 23-Jul-05 17:14 smarts/core/traffic_history_provider.py
 -rw-rw-r--  2.0 unx     2679 b- defN 23-Apr-24 14:19 smarts/core/traffic_provider.py
 -rw-rw-r--  2.0 unx    15624 b- defN 23-Aug-03 20:57 smarts/core/trap_manager.py
 -rw-rw-r--  2.0 unx    22849 b- defN 23-Aug-03 20:57 smarts/core/vehicle.py
 -rw-rw-r--  2.0 unx    30570 b- defN 23-Jul-05 17:14 smarts/core/vehicle_index.py
--rw-rw-r--  2.0 unx     6752 b- defN 23-Aug-03 20:57 smarts/core/vehicle_state.py
--rw-rw-r--  2.0 unx    82063 b- defN 23-Aug-03 20:57 smarts/core/waymo_map.py
+-rw-rw-r--  2.0 unx     6681 b- defN 23-Aug-03 23:54 smarts/core/vehicle_state.py
+-rw-rw-r--  2.0 unx    82012 b- defN 23-Aug-03 23:54 smarts/core/waymo_map.py
 -rw-rw-r--  2.0 unx     8326 b- defN 23-Aug-03 20:57 smarts/core/controllers/__init__.py
 -rw-rw-r--  2.0 unx     4724 b- defN 23-Jul-05 17:14 smarts/core/controllers/action_space_type.py
 -rw-rw-r--  2.0 unx     2454 b- defN 23-Apr-24 16:19 smarts/core/controllers/actuator_dynamic_controller.py
 -rw-rw-r--  2.0 unx     4795 b- defN 23-Apr-24 14:19 smarts/core/controllers/direct_controller.py
--rw-rw-r--  2.0 unx    19466 b- defN 23-Aug-03 20:57 smarts/core/controllers/lane_following_controller.py
+-rw-rw-r--  2.0 unx    19952 b- defN 23-Aug-03 23:54 smarts/core/controllers/lane_following_controller.py
 -rw-rw-r--  2.0 unx     3300 b- defN 23-Apr-24 14:19 smarts/core/controllers/motion_planner_controller.py
 -rw-rw-r--  2.0 unx     5094 b- defN 23-Jul-05 17:14 smarts/core/controllers/trajectory_interpolation_controller.py
 -rw-rw-r--  2.0 unx    24002 b- defN 23-Mar-13 14:44 smarts/core/controllers/trajectory_tracking_controller.py
 -rw-rw-r--  2.0 unx     1131 b- defN 23-Mar-13 14:44 smarts/core/glsl/__init__.py
 -rw-rw-r--  2.0 unx      423 b- defN 23-Mar-16 18:33 smarts/core/glsl/dashed_line_shader.frag
 -rw-rw-r--  2.0 unx      280 b- defN 23-Mar-16 18:33 smarts/core/glsl/dashed_line_shader.vert
 -rw-rw-r--  2.0 unx      152 b- defN 22-Aug-22 22:40 smarts/core/glsl/unlit_shader.frag
@@ -171,15 +173,15 @@
 -rw-rw-r--  2.0 unx     2693 b- defN 23-May-02 15:49 smarts/core/utils/id.py
 -rw-rw-r--  2.0 unx     1682 b- defN 23-Apr-24 16:19 smarts/core/utils/import_utils.py
 -rw-rw-r--  2.0 unx     1722 b- defN 23-Mar-13 14:44 smarts/core/utils/key_wrapper.py
 -rw-rw-r--  2.0 unx     3235 b- defN 23-Jul-05 17:14 smarts/core/utils/kinematics.py
 -rw-rw-r--  2.0 unx     7276 b- defN 23-Jul-05 17:14 smarts/core/utils/logging.py
 -rw-rw-r--  2.0 unx    21640 b- defN 23-Jul-05 17:14 smarts/core/utils/math.py
 -rw-rw-r--  2.0 unx     1507 b- defN 23-Mar-13 14:44 smarts/core/utils/networking.py
--rw-rw-r--  2.0 unx     2614 b- defN 23-Aug-03 20:57 smarts/core/utils/pybullet.py
+-rw-rw-r--  2.0 unx     2602 b- defN 23-Aug-03 23:54 smarts/core/utils/pybullet.py
 -rw-rw-r--  2.0 unx     3519 b- defN 23-Mar-16 18:33 smarts/core/utils/resources.py
 -rw-rw-r--  2.0 unx     1694 b- defN 23-Mar-16 18:33 smarts/core/utils/string.py
 -rw-rw-r--  2.0 unx     8611 b- defN 23-Jul-05 17:14 smarts/core/utils/sumo.py
 -rw-rw-r--  2.0 unx    11197 b- defN 23-Jul-05 17:14 smarts/core/utils/type_operations.py
 -rw-rw-r--  2.0 unx     1147 b- defN 23-Mar-13 14:44 smarts/core/utils/adapters/__init__.py
 -rw-rw-r--  2.0 unx    10243 b- defN 23-May-02 13:40 smarts/core/utils/adapters/ego_centric_adapters.py
 -rw-rw-r--  2.0 unx     1268 b- defN 23-Mar-13 14:44 smarts/core/utils/invalid/__init__.py
@@ -232,52 +234,50 @@
 -rw-rw-r--  2.0 unx     1525 b- defN 23-Mar-16 18:33 smarts/diagnostic/n_sumo_actors/1_actors/scenario.py
 -rw-rw-r--  2.0 unx     6404 b- defN 23-Mar-16 18:33 smarts/diagnostic/n_sumo_actors/200_actors/map.net.xml
 -rw-rw-r--  2.0 unx     1581 b- defN 23-Mar-16 18:33 smarts/diagnostic/n_sumo_actors/200_actors/scenario.py
 -rw-rw-r--  2.0 unx     6391 b- defN 23-Mar-16 18:33 smarts/diagnostic/n_sumo_actors/20_actors/map.net.xml
 -rw-rw-r--  2.0 unx     1580 b- defN 23-Mar-16 18:33 smarts/diagnostic/n_sumo_actors/20_actors/scenario.py
 -rw-rw-r--  2.0 unx     6391 b- defN 23-Mar-16 18:33 smarts/diagnostic/n_sumo_actors/50_actors/map.net.xml
 -rw-rw-r--  2.0 unx     1581 b- defN 23-Mar-16 18:33 smarts/diagnostic/n_sumo_actors/50_actors/scenario.py
--rw-rw-r--  2.0 unx     1302 b- defN 23-Aug-03 20:57 smarts/env/__init__.py
--rw-rw-r--  2.0 unx    10534 b- defN 23-Aug-03 20:57 smarts/env/custom_observations.py
--rw-rw-r--  2.0 unx    12514 b- defN 23-Aug-03 20:57 smarts/env/hiway_env.py
--rw-rw-r--  2.0 unx     9556 b- defN 23-Aug-03 20:57 smarts/env/rllib_hiway_env.py
+-rw-rw-r--  2.0 unx     1177 b- defN 23-Aug-03 23:54 smarts/env/__init__.py
+-rw-rw-r--  2.0 unx    13189 b- defN 23-Aug-03 23:54 smarts/env/custom_observations.py
+-rw-rw-r--  2.0 unx    12246 b- defN 23-Aug-03 23:54 smarts/env/rllib_hiway_env.py
 -rw-rw-r--  2.0 unx     2114 b- defN 23-Apr-24 14:19 smarts/env/gymnasium/__init__.py
 -rw-rw-r--  2.0 unx    13189 b- defN 23-Jul-05 17:14 smarts/env/gymnasium/driving_smarts_2022_env.py
 -rw-rw-r--  2.0 unx     7639 b- defN 23-Jul-05 17:14 smarts/env/gymnasium/driving_smarts_2023_env.py
--rw-rw-r--  2.0 unx    23718 b- defN 23-Aug-03 20:57 smarts/env/gymnasium/hiway_env_v1.py
+-rw-rw-r--  2.0 unx    23724 b- defN 23-Aug-03 23:54 smarts/env/gymnasium/hiway_env_v1.py
 -rw-rw-r--  2.0 unx     7987 b- defN 23-Jul-05 17:14 smarts/env/gymnasium/platoon_env.py
 -rw-rw-r--  2.0 unx     1147 b- defN 23-Mar-16 18:33 smarts/env/gymnasium/wrappers/__init__.py
--rw-rw-r--  2.0 unx     2013 b- defN 23-Aug-03 20:57 smarts/env/gymnasium/wrappers/api_reversion.py
 -rw-rw-r--  2.0 unx     2532 b- defN 23-Jul-05 17:14 smarts/env/gymnasium/wrappers/episode_logger.py
 -rw-rw-r--  2.0 unx     3732 b- defN 23-May-02 13:40 smarts/env/gymnasium/wrappers/limit_relative_target_pose.py
 -rw-rw-r--  2.0 unx    12145 b- defN 23-Aug-03 20:57 smarts/env/gymnasium/wrappers/parallel_env.py
--rw-rw-r--  2.0 unx     2917 b- defN 23-Aug-03 20:57 smarts/env/gymnasium/wrappers/single_agent.py
+-rw-rw-r--  2.0 unx     2971 b- defN 23-Aug-03 23:54 smarts/env/gymnasium/wrappers/single_agent.py
 -rw-rw-r--  2.0 unx     1131 b- defN 23-Mar-16 18:33 smarts/env/gymnasium/wrappers/metric/__init__.py
 -rw-rw-r--  2.0 unx    26768 b- defN 23-Jul-05 17:14 smarts/env/gymnasium/wrappers/metric/costs.py
 -rw-rw-r--  2.0 unx     7971 b- defN 23-Jul-05 17:14 smarts/env/gymnasium/wrappers/metric/formula.py
 -rw-rw-r--  2.0 unx    22813 b- defN 23-Jul-05 17:14 smarts/env/gymnasium/wrappers/metric/metrics.py
 -rw-rw-r--  2.0 unx     4441 b- defN 23-Jul-05 17:14 smarts/env/gymnasium/wrappers/metric/params.py
 -rw-rw-r--  2.0 unx     2199 b- defN 23-Jul-05 17:14 smarts/env/gymnasium/wrappers/metric/types.py
 -rw-rw-r--  2.0 unx     6477 b- defN 23-Jul-31 21:27 smarts/env/gymnasium/wrappers/metric/utils.py
 -rw-rw-r--  2.0 unx     1130 b- defN 23-Mar-16 18:33 smarts/env/utils/__init__.py
--rw-rw-r--  2.0 unx     9581 b- defN 23-Aug-03 20:57 smarts/env/utils/action_conversion.py
--rw-rw-r--  2.0 unx    40535 b- defN 23-Aug-03 20:57 smarts/env/utils/observation_conversion.py
+-rw-rw-r--  2.0 unx     9693 b- defN 23-Aug-03 23:54 smarts/env/utils/action_conversion.py
+-rw-rw-r--  2.0 unx    41098 b- defN 23-Aug-03 23:54 smarts/env/utils/observation_conversion.py
 -rw-rw-r--  2.0 unx     3060 b- defN 23-Jul-20 13:45 smarts/env/utils/record.py
 -rw-rw-r--  2.0 unx     1968 b- defN 23-Apr-24 14:19 smarts/env/utils/scenario.py
 -rw-rw-r--  2.0 unx     1147 b- defN 23-Mar-13 14:44 smarts/env/wrappers/__init__.py
--rw-rw-r--  2.0 unx     3180 b- defN 23-Aug-03 20:57 smarts/env/wrappers/gif_recorder.py
--rw-rw-r--  2.0 unx     6496 b- defN 23-Aug-03 20:57 smarts/env/wrappers/record_video.py
--rw-rw-r--  2.0 unx     3861 b- defN 23-Aug-03 20:57 smarts/env/wrappers/recorder_wrapper.py
+-rw-rw-r--  2.0 unx     3193 b- defN 23-Aug-03 23:54 smarts/env/wrappers/gif_recorder.py
+-rw-rw-r--  2.0 unx     6521 b- defN 23-Aug-03 23:54 smarts/env/wrappers/record_video.py
+-rw-rw-r--  2.0 unx     3858 b- defN 23-Aug-03 23:54 smarts/env/wrappers/recorder_wrapper.py
 -rw-rw-r--  2.0 unx     1130 b- defN 23-Mar-13 14:44 smarts/env/wrappers/utils/__init__.py
 -rw-rw-r--  2.0 unx     3694 b- defN 23-Mar-13 14:44 smarts/env/wrappers/utils/rendering.py
 -rw-rw-r--  2.0 unx     1147 b- defN 23-May-02 13:40 smarts/p3d/__init__.py
 -rw-rw-r--  2.0 unx    24635 b- defN 23-Jul-05 17:14 smarts/p3d/renderer.py
 -rw-rw-r--  2.0 unx     1147 b- defN 23-Apr-24 16:19 smarts/ray/__init__.py
 -rw-rw-r--  2.0 unx     1147 b- defN 23-Apr-24 16:19 smarts/ray/sensors/__init__.py
--rw-rw-r--  2.0 unx     7900 b- defN 23-Aug-03 20:57 smarts/ray/sensors/ray_sensor_resolver.py
+-rw-rw-r--  2.0 unx     8096 b- defN 23-Aug-03 23:54 smarts/ray/sensors/ray_sensor_resolver.py
 -rw-rw-r--  2.0 unx     1737 b- defN 23-Mar-13 14:44 smarts/ros/__init__.py
 -rw-rw-r--  2.0 unx     3148 b- defN 23-Mar-13 14:44 smarts/ros/__main__.py
 -rw-rw-r--  2.0 unx     3159 b- defN 23-Mar-13 14:44 smarts/ros/logging.py
 -rw-rw-r--  2.0 unx     1131 b- defN 23-Mar-13 14:44 smarts/ros/src/__init__.py
 -rw-rw-r--  2.0 unx     7181 b- defN 23-Mar-13 14:44 smarts/ros/src/smarts_ros/CMakeLists.txt
 -rw-rw-r--  2.0 unx     1131 b- defN 23-Mar-13 14:44 smarts/ros/src/smarts_ros/__init__.py
 -rw-rw-r--  2.0 unx     2797 b- defN 23-Mar-16 18:33 smarts/ros/src/smarts_ros/package.xml
@@ -306,15 +306,15 @@
 -rw-rw-r--  2.0 unx     1931 b- defN 23-Mar-16 18:33 smarts/sstudio/sumo2mesh.py
 -rw-rw-r--  2.0 unx     1932 b- defN 23-Jul-05 17:14 smarts/sstudio/types/__init__.py
 -rw-rw-r--  2.0 unx     6966 b- defN 23-Jul-05 17:14 smarts/sstudio/types/bubble.py
 -rw-rw-r--  2.0 unx     1806 b- defN 23-Jul-05 17:14 smarts/sstudio/types/bubble_limits.py
 -rw-rw-r--  2.0 unx    22310 b- defN 23-Jul-05 17:14 smarts/sstudio/types/condition.py
 -rw-rw-r--  2.0 unx     1200 b- defN 23-Jul-05 17:14 smarts/sstudio/types/constants.py
 -rw-rw-r--  2.0 unx     4609 b- defN 23-Jul-05 17:14 smarts/sstudio/types/dataset.py
--rw-rw-r--  2.0 unx     2477 b- defN 23-Aug-03 20:57 smarts/sstudio/types/distribution.py
+-rw-rw-r--  2.0 unx     1982 b- defN 23-Aug-03 23:54 smarts/sstudio/types/distribution.py
 -rw-rw-r--  2.0 unx     3265 b- defN 23-Jul-05 17:14 smarts/sstudio/types/entry_tactic.py
 -rw-rw-r--  2.0 unx     2956 b- defN 23-Jul-05 17:14 smarts/sstudio/types/map_spec.py
 -rw-rw-r--  2.0 unx     5368 b- defN 23-Jul-05 17:14 smarts/sstudio/types/mission.py
 -rw-rw-r--  2.0 unx     4375 b- defN 23-Jul-05 17:14 smarts/sstudio/types/route.py
 -rw-rw-r--  2.0 unx     6464 b- defN 23-Jul-05 17:14 smarts/sstudio/types/scenario.py
 -rw-rw-r--  2.0 unx     2685 b- defN 23-Jul-05 17:14 smarts/sstudio/types/standard_metadata.py
 -rw-rw-r--  2.0 unx     4995 b- defN 23-Jul-05 17:14 smarts/sstudio/types/traffic.py
@@ -328,20 +328,20 @@
 -rw-rw-r--  2.0 unx     6562 b- defN 23-Mar-24 15:12 smarts/waymo/gen_sumo_map.py
 -rw-rw-r--  2.0 unx    12312 b- defN 23-Jul-05 17:14 smarts/waymo/waymo_utils.py
 -rw-rw-r--  2.0 unx      697 b- defN 23-May-17 02:54 smarts/waymo/waymo_open_dataset/__init__.py
 -rw-rw-r--  2.0 unx      891 b- defN 23-Jul-05 17:14 smarts/waymo/waymo_open_dataset/protos/__init__.py
 -rw-rw-r--  2.0 unx    12361 b- defN 23-Mar-24 15:12 smarts/waymo/waymo_open_dataset/protos/map_pb2.py
 -rw-rw-r--  2.0 unx     5668 b- defN 23-Mar-24 15:12 smarts/waymo/waymo_open_dataset/protos/scenario_pb2.py
 -rw-rw-r--  2.0 unx     2360 b- defN 23-Mar-16 18:33 smarts/zoo/__init__.py
--rw-rw-r--  2.0 unx     5440 b- defN 23-Aug-03 20:57 smarts/zoo/agent_spec.py
+-rw-rw-r--  2.0 unx     5440 b- defN 23-Aug-03 23:54 smarts/zoo/agent_spec.py
 -rw-rw-r--  2.0 unx     3338 b- defN 23-Aug-03 20:57 smarts/zoo/registry.py
 -rw-rw-r--  2.0 unx        0 b- defN 22-Aug-22 22:40 zoo/__init__.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Mar-13 14:44 zoo/evaluation/__init__.py
 -rw-rw-r--  2.0 unx     1267 b- defN 23-Jul-05 17:14 zoo/evaluation/egoless_example.py
--rw-rw-r--  2.0 unx     2023 b- defN 23-Aug-03 20:57 zoo/evaluation/npc_ego_example.py
+-rw-rw-r--  2.0 unx     2036 b- defN 23-Aug-03 23:54 zoo/evaluation/npc_ego_example.py
 -rw-rw-r--  2.0 unx     6830 b- defN 23-Mar-13 14:44 zoo/evaluation/run_evaluation.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Mar-13 14:44 zoo/evaluation/metrics/__init__.py
 -rw-rw-r--  2.0 unx     3107 b- defN 23-Mar-13 14:44 zoo/evaluation/metrics/data_extraction.py
 -rw-rw-r--  2.0 unx     5123 b- defN 23-Mar-13 14:44 zoo/evaluation/metrics/evaluation_report.py
 -rw-rw-r--  2.0 unx     4376 b- defN 23-Mar-13 14:44 zoo/evaluation/metrics/rank_report.py
 -rw-rw-r--  2.0 unx     2275 b- defN 23-Mar-13 14:44 zoo/evaluation/metrics/run_evaluation.py
 -rw-rw-r--  2.0 unx     3339 b- defN 23-Mar-13 14:44 zoo/evaluation/metrics/utils.py
@@ -353,16 +353,16 @@
 -rw-rw-r--  2.0 unx     2917 b- defN 23-May-03 13:57 zoo/policies/chase_via_points_agent.py
 -rw-rw-r--  2.0 unx     2432 b- defN 23-Mar-16 18:33 zoo/policies/human_in_the_loop.py
 -rw-rw-r--  2.0 unx      117 b- defN 23-Feb-13 20:22 zoo/policies/keep_lane_agent.py
 -rw-rw-r--  2.0 unx      197 b- defN 23-Mar-13 14:44 zoo/policies/keep_left_with_speed_agent.py
 -rw-rw-r--  2.0 unx     1153 b- defN 23-Feb-13 20:22 zoo/policies/non_interactive_agent.py
 -rw-rw-r--  2.0 unx     2312 b- defN 23-Jul-05 17:14 zoo/policies/replay_agent.py
 -rw-rw-r--  2.0 unx     2264 b- defN 23-Mar-13 14:44 zoo/policies/waypoint_tracking_agent.py
--rw-rw-r--  2.0 unx     1109 b- defN 23-Aug-03 23:53 smarts-1.2.0.dist-info/LICENSE
--rw-rw-r--  2.0 unx    11501 b- defN 23-Aug-03 23:53 smarts-1.2.0.dist-info/METADATA
--rw-rw-r--  2.0 unx       50 b- defN 23-Aug-03 23:53 smarts-1.2.0.dist-info/NOTICE
--rw-rw-r--  2.0 unx       92 b- defN 23-Aug-03 23:53 smarts-1.2.0.dist-info/WHEEL
--rw-rw-r--  2.0 unx       37 b- defN 23-Aug-03 23:53 smarts-1.2.0.dist-info/entry_points.txt
--rw-rw-r--  2.0 unx       33 b- defN 23-Aug-03 23:53 smarts-1.2.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx        1 b- defN 22-Nov-02 17:57 smarts-1.2.0.dist-info/zip-safe
--rw-rw-r--  2.0 unx    34406 b- defN 23-Aug-03 23:53 smarts-1.2.0.dist-info/RECORD
-366 files, 22552113 bytes uncompressed, 4884729 bytes compressed:  78.3%
+-rw-rw-r--  2.0 unx     1109 b- defN 23-Aug-03 23:55 smarts-1.3.0.dist-info/LICENSE
+-rw-rw-r--  2.0 unx    11895 b- defN 23-Aug-03 23:55 smarts-1.3.0.dist-info/METADATA
+-rw-rw-r--  2.0 unx       50 b- defN 23-Aug-03 23:55 smarts-1.3.0.dist-info/NOTICE
+-rw-rw-r--  2.0 unx       92 b- defN 23-Aug-03 23:55 smarts-1.3.0.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       37 b- defN 23-Aug-03 23:55 smarts-1.3.0.dist-info/entry_points.txt
+-rw-rw-r--  2.0 unx       33 b- defN 23-Aug-03 23:55 smarts-1.3.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx        1 b- defN 22-Nov-02 17:57 smarts-1.3.0.dist-info/zip-safe
+-rw-rw-r--  2.0 unx    34404 b- defN 23-Aug-03 23:55 smarts-1.3.0.dist-info/RECORD
+366 files, 22553245 bytes uncompressed, 4884734 bytes compressed:  78.3%
```

## zipnote {}

```diff
@@ -159,15 +159,21 @@
 
 Filename: examples/rl/platoon/train/utils.py
 Comment: 
 
 Filename: examples/rl/rllib/__init__.py
 Comment: 
 
-Filename: examples/rl/rllib/rllib.py
+Filename: examples/rl/rllib/configs.py
+Comment: 
+
+Filename: examples/rl/rllib/pg_example.py
+Comment: 
+
+Filename: examples/rl/rllib/pg_pbt_example.py
 Comment: 
 
 Filename: examples/rl/rllib/rllib_agent.py
 Comment: 
 
 Filename: smarts/__init__.py
 Comment: 
@@ -711,17 +717,14 @@
 
 Filename: smarts/env/__init__.py
 Comment: 
 
 Filename: smarts/env/custom_observations.py
 Comment: 
 
-Filename: smarts/env/hiway_env.py
-Comment: 
-
 Filename: smarts/env/rllib_hiway_env.py
 Comment: 
 
 Filename: smarts/env/gymnasium/__init__.py
 Comment: 
 
 Filename: smarts/env/gymnasium/driving_smarts_2022_env.py
@@ -735,17 +738,14 @@
 
 Filename: smarts/env/gymnasium/platoon_env.py
 Comment: 
 
 Filename: smarts/env/gymnasium/wrappers/__init__.py
 Comment: 
 
-Filename: smarts/env/gymnasium/wrappers/api_reversion.py
-Comment: 
-
 Filename: smarts/env/gymnasium/wrappers/episode_logger.py
 Comment: 
 
 Filename: smarts/env/gymnasium/wrappers/limit_relative_target_pose.py
 Comment: 
 
 Filename: smarts/env/gymnasium/wrappers/parallel_env.py
@@ -1068,32 +1068,32 @@
 
 Filename: zoo/policies/replay_agent.py
 Comment: 
 
 Filename: zoo/policies/waypoint_tracking_agent.py
 Comment: 
 
-Filename: smarts-1.2.0.dist-info/LICENSE
+Filename: smarts-1.3.0.dist-info/LICENSE
 Comment: 
 
-Filename: smarts-1.2.0.dist-info/METADATA
+Filename: smarts-1.3.0.dist-info/METADATA
 Comment: 
 
-Filename: smarts-1.2.0.dist-info/NOTICE
+Filename: smarts-1.3.0.dist-info/NOTICE
 Comment: 
 
-Filename: smarts-1.2.0.dist-info/WHEEL
+Filename: smarts-1.3.0.dist-info/WHEEL
 Comment: 
 
-Filename: smarts-1.2.0.dist-info/entry_points.txt
+Filename: smarts-1.3.0.dist-info/entry_points.txt
 Comment: 
 
-Filename: smarts-1.2.0.dist-info/top_level.txt
+Filename: smarts-1.3.0.dist-info/top_level.txt
 Comment: 
 
-Filename: smarts-1.2.0.dist-info/zip-safe
+Filename: smarts-1.3.0.dist-info/zip-safe
 Comment: 
 
-Filename: smarts-1.2.0.dist-info/RECORD
+Filename: smarts-1.3.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## cli/benchmark.py

```diff
@@ -34,35 +34,28 @@
 
 @click.command(
     "run",
 )
 @click.argument("benchmark_id", nargs=1, metavar="<benchmark_id>")
 @click.argument("agent_locator", nargs=1, metavar="<agent_locator>")
 @click.option(
-    "--debug-log",
-    is_flag=True,
-    default=False,
-    help="Log the benchmark in ``stdout``.",
-)
-@click.option(
     "--benchmark-listing",
     type=str,
     default=None,
     help="Directs to a different listing file.",
 )
 @click.option(
     "--auto-install",
     is_flag=True,
     default=False,
     help="Attempt to auto install requirements.",
 )
 def run(
     benchmark_id: str,
     agent_locator: str,
-    debug_log: bool,
     benchmark_listing: Optional[str],
     auto_install: bool,
 ):
     """This runs a given benchmark.
 
     Use `scl benchmark list` to see the available benchmarks.
 
@@ -79,15 +72,14 @@
     run_benchmark(
         benchmark_name=benchmark_id,
         benchmark_version=float(benchmark_version) if benchmark_version else None,
         agent_locator=agent_locator,
         benchmark_listing=Path(benchmark_listing)
         if benchmark_listing is not None
         else BENCHMARK_LISTING_FILE,
-        debug_log=debug_log,
         auto_install=auto_install,
     )
 
 
 @click.command("list")
 @click.option(
     "--benchmark-listing",
```

## examples/rl/drive/inference/contrib_policy/filter_obs.py

```diff
@@ -1,11 +1,11 @@
 import math
 from typing import Any, Dict, Sequence, Tuple
 
-import gym
+import gymnasium as gym
 import numpy as np
 
 from smarts.core.agent_interface import RGB
 from smarts.core.colors import Colors, SceneColors
 
 
 class FilterObs:
```

## examples/rl/drive/inference/contrib_policy/format_action.py

```diff
@@ -1,10 +1,10 @@
 from typing import Callable, Tuple
 
-import gym
+import gymnasium as gym
 import numpy as np
 
 from smarts.core.controllers import ActionSpaceType
 
 
 class FormatAction:
     def __init__(self, action_space_type: ActionSpaceType):
```

## examples/rl/drive/inference/contrib_policy/frame_stack.py

```diff
@@ -1,11 +1,11 @@
 import copy
 from collections import deque
 
-import gym
+import gymnasium as gym
 import numpy as np
 
 
 class FrameStack:
     """Stacks num_stack (default=3) consecutive frames, in a moving-window
     fashion, and returns the stacked_frames.
```

## examples/rl/drive/inference/contrib_policy/make_dict.py

```diff
@@ -1,10 +1,10 @@
 from typing import Dict
 
-import gym
+import gymnasium as gym
 import numpy as np
 
 
 class MakeDict:
     """Converts gym.spaces.Box to gym.spaces.Dict."""
 
     def __init__(self, input_space: gym.Space):
```

## examples/rl/drive/inference/contrib_policy/network.py

```diff
@@ -1,8 +1,8 @@
-import gym
+import gymnasium as gym
 import torch as th
 import torch.nn as nn
 from stable_baselines3.common.preprocessing import get_flattened_obs_dim
 from stable_baselines3.common.torch_layers import BaseFeaturesExtractor, NatureCNN
 from stable_baselines3.common.type_aliases import TensorDict
```

## examples/rl/drive/train/env.py

```diff
@@ -10,25 +10,23 @@
 
 
 def make_env(env_id, scenario, agent_spec: AgentSpec, config, seed):
     from preprocess import Preprocess
     from reward import Reward
     from stable_baselines3.common.monitor import Monitor
 
-    from smarts.env.gymnasium.wrappers.api_reversion import Api021Reversion
     from smarts.env.gymnasium.wrappers.single_agent import SingleAgent
 
     env = gym.make(
         env_id,
         scenario=scenario,
         agent_interface=agent_spec.interface,
         seed=seed,
         sumo_headless=not config.sumo_gui,  # If False, enables sumo-gui display.
         headless=not config.head,  # If False, enables Envision display.
     )
     env = Reward(env=env, crop=agent_spec.agent_params["crop"])
     env = SingleAgent(env=env)
-    env = Api021Reversion(env=env)
     env = Preprocess(env=env, agent_spec=agent_spec)
     env = Monitor(env)
 
     return env
```

## examples/rl/drive/train/preprocess.py

```diff
@@ -1,8 +1,8 @@
-import gym
+import gymnasium as gym
 from contrib_policy.filter_obs import FilterObs
 from contrib_policy.format_action import FormatAction
 from contrib_policy.frame_stack import FrameStack
 from contrib_policy.make_dict import MakeDict
 
 from smarts.zoo.agent_spec import AgentSpec
 
@@ -39,20 +39,20 @@
         return obs
 
     def step(self, action):
         """Uses the :meth:`step` of the :attr:`env` that can be overwritten to change the returned data."""
         formatted_action = self._format_action.format(
             action=action, prev_heading=self._prev_heading
         )
-        obs, reward, done, info = self.env.step(formatted_action)
+        obs, reward, terminated, truncated, info = self.env.step(formatted_action)
         self._prev_heading = obs["ego_vehicle_state"]["heading"]
         obs = self._process(obs)
-        return obs, reward, done, info
+        return obs, reward, terminated, truncated, info
 
-    def reset(self):
+    def reset(self, *, seed=None, options=None):
         """Uses the :meth:`reset` of the :attr:`env` that can be overwritten to change the returned data."""
 
         self._frame_stack.reset()
-        obs = self.env.reset()
+        obs, info = self.env.reset(seed=seed, options=options)
         self._prev_heading = obs["ego_vehicle_state"]["heading"]
         obs = self._process(obs)
-        return obs
+        return obs, info
```

## examples/rl/drive/train/run.py

```diff
@@ -8,15 +8,15 @@
 sys.path.insert(0, str(Path(__file__).resolve().parents[1]))
 import argparse
 import warnings
 from datetime import datetime
 from itertools import cycle, islice
 from typing import Any, Dict
 
-import gym
+import gymnasium as gym
 
 # Load inference module to register agent
 import inference
 import stable_baselines3 as sb3lib
 import torch as th
 import yaml
 from contrib_policy import network
```

## examples/rl/platoon/inference/contrib_policy/filter_obs.py

```diff
@@ -1,11 +1,11 @@
 import math
 from typing import Any, Dict, Sequence, Tuple
 
-import gym
+import gymnasium as gym
 import numpy as np
 
 from smarts.core.agent_interface import RGB
 from smarts.core.colors import Colors, SceneColors
 
 
 class FilterObs:
```

## examples/rl/platoon/inference/contrib_policy/format_action.py

```diff
@@ -1,10 +1,10 @@
 from typing import Callable, Tuple
 
-import gym
+import gymnasium as gym
 import numpy as np
 
 from smarts.core.controllers import ActionSpaceType
 
 
 class FormatAction:
     def __init__(self, action_space_type: ActionSpaceType):
```

## examples/rl/platoon/inference/contrib_policy/frame_stack.py

```diff
@@ -1,11 +1,11 @@
 import copy
 from collections import deque
 
-import gym
+import gymnasium as gym
 import numpy as np
 
 
 class FrameStack:
     """Stacks num_stack (default=3) consecutive frames, in a moving-window
     fashion, and returns the stacked_frames.
```

## examples/rl/platoon/inference/contrib_policy/make_dict.py

```diff
@@ -1,10 +1,10 @@
 from typing import Dict
 
-import gym
+import gymnasium as gym
 import numpy as np
 
 
 class MakeDict:
     """Converts gym.spaces.Box to gym.spaces.Dict."""
 
     def __init__(self, input_space: gym.Space):
```

## examples/rl/platoon/inference/contrib_policy/network.py

```diff
@@ -1,8 +1,8 @@
-import gym
+import gymnasium as gym
 import torch as th
 import torch.nn as nn
 from stable_baselines3.common.preprocessing import get_flattened_obs_dim
 from stable_baselines3.common.torch_layers import BaseFeaturesExtractor, NatureCNN
 from stable_baselines3.common.type_aliases import TensorDict
```

## examples/rl/platoon/train/env.py

```diff
@@ -10,25 +10,23 @@
 
 
 def make_env(env_id, scenario, agent_spec: AgentSpec, config, seed):
     from preprocess import Preprocess
     from reward import Reward
     from stable_baselines3.common.monitor import Monitor
 
-    from smarts.env.gymnasium.wrappers.api_reversion import Api021Reversion
     from smarts.env.gymnasium.wrappers.single_agent import SingleAgent
 
     env = gym.make(
         env_id,
         scenario=scenario,
         agent_interface=agent_spec.interface,
         seed=seed,
         sumo_headless=not config.sumo_gui,  # If False, enables sumo-gui display.
         headless=not config.head,  # If False, enables Envision display.
     )
     env = Reward(env=env, crop=agent_spec.agent_params["crop"])
     env = SingleAgent(env=env)
-    env = Api021Reversion(env=env)
     env = Preprocess(env=env, agent_spec=agent_spec)
     env = Monitor(env)
 
     return env
```

## examples/rl/platoon/train/preprocess.py

```diff
@@ -1,8 +1,8 @@
-import gym
+import gymnasium as gym
 from contrib_policy.filter_obs import FilterObs
 from contrib_policy.format_action import FormatAction
 from contrib_policy.frame_stack import FrameStack
 from contrib_policy.make_dict import MakeDict
 
 from smarts.zoo.agent_spec import AgentSpec
 
@@ -36,18 +36,18 @@
         obs = self._make_dict.make(obs)
 
         return obs
 
     def step(self, action):
         """Uses the :meth:`step` of the :attr:`env` that can be overwritten to change the returned data."""
         formatted_action = self._format_action.format(action)
-        obs, reward, done, info = self.env.step(formatted_action)
+        obs, reward, terminated, truncated, info = self.env.step(formatted_action)
         obs = self._process(obs)
-        return obs, reward, done, info
+        return obs, reward, terminated, truncated, info
 
-    def reset(self):
+    def reset(self, *, seed=None, options=None):
         """Uses the :meth:`reset` of the :attr:`env` that can be overwritten to change the returned data."""
 
         self._frame_stack.reset()
-        obs = self.env.reset()
+        obs, info = self.env.reset(seed=seed, options=options)
         obs = self._process(obs)
-        return obs
+        return obs, info
```

## examples/rl/platoon/train/run.py

```diff
@@ -9,15 +9,15 @@
 
 import argparse
 import warnings
 from datetime import datetime
 from itertools import cycle, islice
 from typing import Any, Dict
 
-import gym
+import gymnasium as gym
 
 # Load inference module to register agent
 import inference
 import stable_baselines3 as sb3lib
 import torch as th
 import yaml
 from contrib_policy import network
```

## examples/rl/rllib/rllib_agent.py

```diff
@@ -1,11 +1,12 @@
 from pathlib import Path
 
-import gym
+import gymnasium as gym
 import numpy as np
+from ray.rllib.utils.typing import ModelConfigDict
 
 # ray[rllib] is not the part of main dependency of the SMARTS package. It needs to be installed separately
 # as a part of the smarts[train] dependency using the command "pip install -e .[train]. The following try block checks
 # whether ray[rllib] was installed by user and raises an Exception warning the user to install it if not so.
 try:
     from ray.rllib.models import ModelCatalog
     from ray.rllib.models.tf.fcnet import FullyConnectedNetwork
@@ -37,42 +38,60 @@
         "speed": gym.spaces.Box(low=-1e10, high=1e10, shape=(1,)),
         "steering": gym.spaces.Box(low=-1e10, high=1e10, shape=(1,)),
         "ego_lane_dist": gym.spaces.Box(low=-1e10, high=1e10, shape=(3,)),
         "ego_ttc": gym.spaces.Box(low=-1e10, high=1e10, shape=(3,)),
     }
 )
 
+# The FullyConnectedNetwork expects a flattened space.
+FLATTENED_OBSERVATION_SPACE = gym.spaces.utils.flatten_space(OBSERVATION_SPACE)
 
-def observation_adapter(env_observation):
-    return lane_ttc_observation_adapter.transform(env_observation)
 
+def observation_adapter(agent_observation, /):
+    return gym.spaces.utils.flatten(
+        OBSERVATION_SPACE, lane_ttc_observation_adapter.transform(agent_observation)
+    )
 
-def action_adapter(model_action):
-    throttle, brake, steering = model_action
-    return np.array([throttle, brake, steering * np.pi * 0.25])
+
+def action_adapter(agent_action, /):
+    throttle, brake, steering = agent_action
+    return np.array([throttle, brake, steering * np.pi * 0.25], dtype=np.float32)
 
 
 class TrainingModel(FullyConnectedNetwork):
     NAME = "FullyConnectedNetwork"
 
+    def __init__(
+        self,
+        obs_space,
+        action_space,
+        num_outputs: int,
+        model_config: ModelConfigDict,
+        name: str,
+    ):
+        super().__init__(obs_space, action_space, num_outputs, model_config, name)
+
+    def forward(self, input_dict, state, seq_lens):
+        return super().forward(input_dict, state, seq_lens)
+
 
 ModelCatalog.register_custom_model(TrainingModel.NAME, TrainingModel)
 
 
 class RLLibTFSavedModelAgent(Agent):
-    def __init__(self, path_to_model, observation_space):
+    def __init__(self, path_to_model, observation_space, policy_name="default_policy"):
         path_to_model = str(path_to_model)  # might be a str or a Path, normalize to str
         self._prep = ModelCatalog.get_preprocessor_for_space(observation_space)
         self._sess = tf.compat.v1.Session(graph=tf.Graph())
         tf.compat.v1.saved_model.load(
             self._sess, export_dir=path_to_model, tags=["serve"]
         )
-        self._output_node = self._sess.graph.get_tensor_by_name("default_policy/add:0")
+        self._output_node = self._sess.graph.get_tensor_by_name(f"policy_name/add:0")
         self._input_node = self._sess.graph.get_tensor_by_name(
-            "default_policy/observation:0"
+            f"{policy_name}/observation:0"
         )
 
     def __del__(self):
         self._sess.close()
 
     def act(self, obs):
         obs = self._prep.transform(obs)
@@ -83,16 +102,16 @@
 
 
 rllib_agent = {
     "agent_spec": AgentSpec(
         interface=AgentInterface.from_type(AgentType.Standard, max_episode_steps=500),
         agent_params={
             "path_to_model": Path(__file__).resolve().parent / "model",
-            "observation_space": OBSERVATION_SPACE,
+            "observation_space": FLATTENED_OBSERVATION_SPACE,
         },
         agent_builder=RLLibTFSavedModelAgent,
         observation_adapter=observation_adapter,
         action_adapter=action_adapter,
     ),
-    "observation_space": OBSERVATION_SPACE,
+    "observation_space": FLATTENED_OBSERVATION_SPACE,
     "action_space": ACTION_SPACE,
 }
```

## smarts/benchmark/benchmark_listing.yaml

```diff
@@ -4,35 +4,35 @@
 
   driving_smarts_2022:
     name: "Driving SMARTS 2022"
     versions:
       -
         version: 0.0
         entrypoint: "smarts.benchmark.entrypoints.benchmark_runner_v0.benchmark_from_configs"
-        requirements: ["ray<=2.2.0,>2.0"]
+        requirements: ["ray<2.6.0,>2.0"]
         params: 
           benchmark_config: ${{smarts.benchmark.driving_smarts.v2022}}/config.yaml
 
   driving_smarts_2023_1:
     name: "Driving SMARTS 2023.1"
     versions:
       -
         version: 0.0
         entrypoint: "smarts.benchmark.entrypoints.benchmark_runner_v0.benchmark_from_configs"
-        requirements: ["ray<=2.2.0,>2.0"]
+        requirements: ["ray<2.6.0,>2.0"]
         params: 
           benchmark_config: ${{smarts.benchmark.driving_smarts.v2023}}/config_1.yaml
 
   driving_smarts_2023_2:
     name: "Driving SMARTS 2023.2"
     versions:
       -
         version: 0.0
         entrypoint: "smarts.benchmark.entrypoints.benchmark_runner_v0.benchmark_from_configs"
-        requirements: ["ray<=2.2.0,>2.0"]
+        requirements: ["ray<2.6.0,>2.0"]
         params: 
           benchmark_config: ${{smarts.benchmark.driving_smarts.v2023}}/config_2.yaml
 
   driving_smarts_2023_3:
     name: "Driving SMARTS 2023.3"
     versions:
       -
```

## smarts/benchmark/driving_smarts/v2023/config_1.yaml

```diff
@@ -2,23 +2,19 @@
 benchmark:
   name: "Driving SMARTS 2023.1"
   message: |
     For context see: 
         - https://smarts-project.github.io/competition/2023_driving_smarts/
         - https://codalab.lisn.upsaclay.fr/competitions/
   eval_episodes: 50
-  debug:
-    serial: True
   shared_env_kwargs:
     seed: 42
     headless: True
   envs:
     standard:
       loc: "smarts.env:driving-smarts-v2023"
       scenarios:
         - scenarios/sumo/straight/cruise_2lane_agents_1
         - scenarios/sumo/straight/cutin_2lane_agents_1
         - scenarios/sumo/straight/merge_exit_sumo_t_agents_1
         - scenarios/sumo/straight/overtake_2lane_agents_1
-      kwargs:
-        seed: 42
       metric_formula: smarts/benchmark/driving_smarts/v2023/metric_formula_drive.py
```

## smarts/benchmark/driving_smarts/v2023/config_2.yaml

```diff
@@ -2,21 +2,17 @@
 benchmark:
   name: "Driving SMARTS 2023.2"
   message: |
     For context see: 
         - https://smarts-project.github.io/competition/2023_driving_smarts/
         - https://codalab.lisn.upsaclay.fr/competitions/
   eval_episodes: 50
-  debug:
-    serial: True
   shared_env_kwargs:
     seed: 42
     headless: True
   envs:
     turns:
       loc: "smarts.env:driving-smarts-v2023"
       scenarios:
         - scenarios/sumo/intersections/1_to_3lane_left_turn_sumo_c_agents_1
         - scenarios/sumo/intersections/1_to_3lane_left_turn_middle_lane_c_agents_1
-      kwargs:
-        seed: 42
       metric_formula: smarts/benchmark/driving_smarts/v2023/metric_formula_drive.py
```

## smarts/benchmark/driving_smarts/v2023/config_3.yaml

```diff
@@ -2,16 +2,14 @@
 benchmark:
   name: "Driving SMARTS 2023.3"
   message: |
     For context see: 
         - https://smarts-project.github.io/competition/2023_driving_smarts/
         - https://codalab.lisn.upsaclay.fr/competitions/
   eval_episodes: 50
-  debug:
-    serial: True
   shared_env_kwargs:
     seed: 42
     headless: True
   envs:
     platoon:
       loc: "smarts.env:platoon-v0"
       scenarios:
@@ -19,10 +17,8 @@
         - scenarios/sumo/vehicle_following/straight_2lane_sumo_t_agents_1
         - scenarios/sumo/vehicle_following/straight_3lanes_sumo_agents_1
         - scenarios/sumo/vehicle_following/straight_3lanes_sumo_t_agents_1
         - scenarios/sumo/vehicle_following/straight_3lanes_sumo_t_agents_2
         - scenarios/sumo/vehicle_following/merge_exit_sumo_agents_1
         - scenarios/sumo/vehicle_following/merge_exit_sumo_t_agents_1
         - scenarios/sumo/vehicle_following/merge_exit_sumo_t_agents_2
-      kwargs:
-        seed: 42
       metric_formula: smarts/benchmark/driving_smarts/v2023/metric_formula_platoon.py
```

## smarts/benchmark/entrypoints/benchmark_runner_v0.py

```diff
@@ -19,21 +19,22 @@
 # LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 # OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 # THE SOFTWARE.
 import json
 import logging
 import os
 from pathlib import Path
-from typing import Dict
+from typing import Any, Dict, Generator, Tuple
 
 import gymnasium as gym
 import psutil
 import ray
 
 from smarts.benchmark.driving_smarts import load_config
+from smarts.core import config
 from smarts.core.utils.import_utils import import_module_from_file
 from smarts.core.utils.logging import suppress_output
 from smarts.env.gymnasium.wrappers.metric.formula import FormulaBase, Score
 from smarts.env.gymnasium.wrappers.metric.metrics import Metrics
 from smarts.env.gymnasium.wrappers.metric.types import Record
 from smarts.zoo import registry as agent_registry
 
@@ -86,21 +87,54 @@
                 obs, info = env.reset()
     finally:
         records = env.records()
         env.close()
     return name, records
 
 
-def _parallel_task_iterator(env_args, benchmark_args, agent_locator, log_workers):
-    num_cpus = max(1, min(len(os.sched_getaffinity(0)), psutil.cpu_count(False) or 4))
+def _parallel_task_iterator(env_args, benchmark_args, agent_locator, *args, **_):
+    requested_cpus: int = config()(
+        "ray",
+        "num_cpus",
+        None,
+        int,
+    )
+    num_gpus = config()(
+        "ray",
+        "num_gpus",
+        0,
+        float,
+    )
+    num_cpus = (
+        requested_cpus
+        if requested_cpus is not None
+        else max(
+            0, min(len(os.sched_getaffinity(0)), psutil.cpu_count(logical=False) or 4)
+        )
+    )
+    log_to_driver = config()(
+        "ray",
+        "log_to_driver",
+        False,
+        bool,
+    )
+
+    if num_cpus == 0 and num_gpus == 0:
+        print(
+            f"Resource count `[benchmark] {num_cpus=}` and `[benchmark] {num_gpus=}` is collectively 0. "
+            "Using the serial runner instead."
+        )
+        for o in _serial_task_iterator(env_args, benchmark_args, agent_locator):
+            yield o
+            return
 
     with suppress_output(stdout=True):
-        ray.init(num_cpus=num_cpus, log_to_driver=log_workers)
+        ray.init(num_cpus=num_cpus, num_gpus=num_gpus, log_to_driver=log_to_driver)
     try:
-        max_queued_tasks = 20
+        max_queued_tasks = num_cpus
         unfinished_refs = []
         for name, env_config in env_args.items():
             if len(unfinished_refs) >= max_queued_tasks:
                 ready_refs, unfinished_refs = ray.wait(unfinished_refs, num_returns=1)
                 for name, records in ray.get(ready_refs):
                     yield name, records
             print(f"\nEvaluating {name}...")
@@ -115,28 +149,30 @@
             )
         for name, records in ray.get(unfinished_refs):
             yield name, records
     finally:
         ray.shutdown()
 
 
-def _serial_task_iterator(env_args, benchmark_args, agent_locator, *args, **_):
+def _serial_task_iterator(
+    env_args, benchmark_args, agent_locator, *args, **_
+) -> Generator[Tuple[Any, Any], Any, None]:
     for name, env_config in env_args.items():
         print(f"\nEvaluating {name}...")
         name, records = _eval_worker_local(
             name=name,
             env_config=env_config,
             episodes=benchmark_args["eval_episodes"],
             agent_locator=agent_locator,
             error_tolerant=ERROR_TOLERANT,
         )
         yield name, records
 
 
-def benchmark(benchmark_args, agent_locator, log_workers=False):
+def benchmark(benchmark_args, agent_locator) -> Tuple[Dict, Dict]:
     """Runs the benchmark using the following:
     Args:
         benchmark_args(dict): Arguments configuring the benchmark.
         agent_locator(str): Locator string for the registered agent.
         debug_log(bool): Whether the benchmark should log to `stdout`.
     """
     print(f"\n\n<-- Starting `{benchmark_args['name']}` benchmark -->\n")
@@ -147,53 +183,56 @@
     debug = benchmark_args.get("debug", {})
     iterator = _serial_task_iterator if debug.get("serial") else _parallel_task_iterator
 
     root_dir = Path(__file__).resolve().parents[3]
     metric_formula_default = (
         root_dir / "smarts" / "env" / "gymnasium" / "wrappers" / "metric" / "formula.py"
     )
+    weighted_scores, agent_scores = {}, {}
     for env_name, env_config in benchmark_args["envs"].items():
         metric_formula = (
             root_dir / x
             if (x := env_config.get("metric_formula", None)) != None
             else metric_formula_default
         )
 
         env_args = {}
         for scenario in env_config["scenarios"]:
             kwargs = dict(benchmark_args.get("shared_env_kwargs", {}))
             kwargs.update(env_config.get("kwargs", {}))
             env_args[f"{env_name}-{scenario}"] = dict(
-                env=env_config["loc"],
+                env=env_config.get("loc") or env_config["locator"],
                 scenario=str(root_dir / scenario),
                 kwargs=kwargs,
                 metric_formula=metric_formula,
             )
 
         records_cumulative: Dict[str, Dict[str, Record]] = {}
         for _, records in iterator(
             env_args=env_args,
             benchmark_args=benchmark_args,
             agent_locator=agent_locator,
-            log_workers=log_workers,
         ):
             records_cumulative.update(records)
 
-        score = _get_weighted_score(
+        weighted_score = _get_weighted_score(
             records=records_cumulative, metric_formula=metric_formula
         )
+        weighted_scores[env_name] = weighted_score
         print("\n\nOverall Weighted Score:\n")
-        print(json.dumps(score, indent=2))
-        score = _get_agent_score(
+        print(json.dumps(weighted_score, indent=2))
+        agent_score = _get_agent_score(
             records=records_cumulative, metric_formula=metric_formula
         )
+        agent_scores[env_name] = agent_score
         print("\n\nIndividual Agent Score:\n")
-        print(json.dumps(score, indent=2))
+        print(json.dumps(agent_score, indent=2))
 
     print("\n<-- Evaluation complete -->\n")
+    return weighted_scores, agent_scores
 
 
 def _get_weighted_score(
     records: Dict[str, Dict[str, Record]], metric_formula: Path
 ) -> Score:
     import_module_from_file("custom_formula", metric_formula)
     from custom_formula import Formula
@@ -212,22 +251,21 @@
 
     from smarts.env.gymnasium.wrappers.metric.formula import agent_scores
 
     score = agent_scores(records=records, func=costs_to_score)
     return score
 
 
-def benchmark_from_configs(benchmark_config, agent_locator, debug_log=False):
+def benchmark_from_configs(benchmark_config, agent_locator):
     """Runs a benchmark given the following.
 
     Args:
         benchmark_config (str): The file path to the benchmark configuration.
         agent_locator (str): Locator string for the registered agent.
         debug_log (bool): Whether the benchmark should log to `stdout`.
     """
     benchmark_args = load_config(benchmark_config)
 
     benchmark(
         benchmark_args=benchmark_args["benchmark"],
         agent_locator=agent_locator,
-        log_workers=debug_log,
     )
```

## smarts/core/argoverse_map.py

```diff
@@ -976,15 +976,15 @@
             road_ids = [road.road_id for road in route.roads]
         if road_ids:
             return self._waypoint_paths_along_route(pose.point, lookahead, road_ids)
 
         # No route provided, so generate paths based on the closest lanepoints
         waypoint_paths = []
         closest_lps: List[LanePoint] = self._lanepoints.closest_lanepoints(
-            pose, within_radius=within_radius, maximum_count=15
+            pose, maximum_count=15
         )
         closest_lane: RoadMap.Lane = closest_lps[0].lane
 
         # First, see if we are in a junction and need to do something special
         if closest_lane.in_junction:
             # Get the set of all nearby junction lanes with similar heading
             junction_lanes: Set[RoadMap.Lane] = set()
```

## smarts/core/configuration.py

```diff
@@ -111,17 +111,19 @@
         if cast is bool:
             # This is necessary because bool("false") == True.
             cast = _convert_truthy
         if setting is not None:
             return cast(setting)
         try:
             value = self._config[section][option]
-        except (configparser.NoSectionError, KeyError):
+        except (configparser.NoSectionError, KeyError) as exc:
             if default is _UNSET:
-                raise
+                raise EnvironmentError(
+                    f"Setting `${env_variable}` cannot be found in environment or configuration."
+                ) from exc
             return default
         return cast(value)
 
     def __call__(
         self,
         section: str,
         option: str,
```

## smarts/core/coordinates.py

```diff
@@ -307,14 +307,15 @@
 
     def __post_init__(self):
         if not isinstance(self.position, np.ndarray):
             self.position = np.array(self.position, dtype=np.float64)
         assert len(self.position) <= 3
         if len(self.position) < 3:
             self.position = np.resize(self.position, 3)
+            self.position[-1] = 0
         assert len(self.orientation) == 4
         if not isinstance(self.orientation, np.ndarray):
             self.orientation = np.array(self.orientation, dtype=np.float64)
 
     def __eq__(self, other: Any) -> bool:
         if not isinstance(other, Pose):
             return False
```

## smarts/core/id_actor_capture_manager.py

```diff
@@ -69,15 +69,16 @@
                 vehicle.state if vehicle is not None else None,
                 entry_tactic.condition.requires,
             )
             condition_result = entry_tactic.condition.evaluate(**condition_kwargs)
             if condition_result == ConditionState.EXPIRED:
                 self._log.warning(
                     f"Actor aquisition skipped for `{agent_id}` scheduled to start between "
-                    + f"`Condition `{entry_tactic.condition}` has expired with no vehicle."
+                    + f"`Condition `{entry_tactic.condition}` has expired with no vehicle. "
+                    + f"Missing actor: `{entry_tactic.actor_id}`"
                 )
                 used_actors.append(actor_id)
                 sim.agent_manager.teardown_ego_agents({agent_id})
                 continue
             if not condition_result:
                 continue
             vehicle: Optional[Vehicle] = self._take_existing_vehicle(
@@ -117,17 +118,17 @@
                 sim,
                 vehicle.state if vehicle is not None else None,
                 entry_tactic.condition.requires,
             )
             condition_result = entry_tactic.condition.evaluate(**condition_kwargs)
             if condition_result == ConditionState.EXPIRED:
                 self._log.warning(
-                    f"Actor aquisition skipped for `{agent_id}` scheduled to start with"
+                    f"Actor acquisition skipped for `{agent_id}` scheduled to start with"
                     + f"`Condition:{entry_tactic.condition}` because simulation skipped to "
-                    f"`simulation time: {sim.elapsed_sim_time}`"
+                    f"`simulation time: {sim.elapsed_sim_time}`. Missing actor: `{entry_tactic.actor_id}`"
                 )
                 cancelled_agents.add(agent_id)
                 continue
             self._actor_for_agent[entry_tactic.actor_id] = (agent_id, mission)
         if len(cancelled_agents) > 0:
             sim.agent_manager.teardown_ego_agents(cancelled_agents)
```

## smarts/core/lanepoints.py

```diff
@@ -24,23 +24,18 @@
 import queue
 from collections import defaultdict
 from dataclasses import dataclass
 from functools import lru_cache
 from typing import List, NamedTuple, Sequence, Tuple
 
 import numpy as np
-from scipy.spatial import KDTree
 
 from smarts.core.coordinates import Heading, Point, Pose
 from smarts.core.road_map import RoadMap
-from smarts.core.utils.math import (
-    fast_quaternion_from_angle,
-    squared_dist,
-    vec_to_radians,
-)
+from smarts.core.utils.math import fast_quaternion_from_angle, vec_to_radians
 
 
 @dataclass(frozen=True)
 class LanePoint:
     """A point on a lane."""
 
     lane: RoadMap.Lane
@@ -72,30 +67,32 @@
     def __init__(self, shape_lps: List[LinkedLanePoint], spacing: float):
         # XXX: for a big map, may not want to cache ALL of the potential LanePoints
         #      nor waste time here finding all of them.
         #      Lanepoints might be generated on demand based upon edges and look-ahead.
         self._linked_lanepoints = LanePoints._interpolate_shape_lanepoints(
             shape_lps, spacing
         )
-        self._lanepoints_kd_tree = LanePoints._build_kd_tree(self._linked_lanepoints)
+        self._lp_points = np.array(
+            [l_lp.lp.pose.point.as_np_array[:2] for l_lp in self._linked_lanepoints]
+        )
 
         self._lanepoints_by_lane_id = defaultdict(list)
         self._lanepoints_by_edge_id = defaultdict(list)
         for linked_lp in self._linked_lanepoints:
             lp_edge_id = linked_lp.lp.lane.road.road_id
             self._lanepoints_by_lane_id[linked_lp.lp.lane.lane_id].append(linked_lp)
             self._lanepoints_by_edge_id[lp_edge_id].append(linked_lp)
 
-        self._lanepoints_kd_tree_by_lane_id = {
-            lane_id: LanePoints._build_kd_tree(l_lps)
+        self._lp_points_by_lane_id = {
+            lane_id: np.array([l_lp.lp.pose.point.as_np_array[:2] for l_lp in l_lps])
             for lane_id, l_lps in self._lanepoints_by_lane_id.items()
         }
 
-        self._lanepoints_kd_tree_by_edge_id = {
-            edge_id: LanePoints._build_kd_tree(l_lps)
+        self._lp_points_by_edge_id = {
+            edge_id: np.array([l_lp.lp.pose.point.as_np_array[:2] for l_lp in l_lps])
             for edge_id, l_lps in self._lanepoints_by_edge_id.items()
         }
 
     @classmethod
     def from_sumo(
         cls,
         sumo_road_network,
@@ -176,15 +173,15 @@
 
                 # Add a lane-point for the last point of the current lane
                 lane_width, _ = curr_lanepoint.lp.lane.width_at_offset(0)
                 last_linked_lanepoint = LinkedLanePoint(
                     lp=LanePoint(
                         lane=curr_lanepoint.lp.lane,
                         pose=Pose(
-                            position=lane_shape[-1],
+                            position=lane_shape[-1][:2],
                             orientation=curr_lanepoint.lp.pose.orientation,
                         ),
                         lane_width=lane_width,
                     ),
                     nexts=[],
                     is_inferred=False,
                 )
@@ -607,21 +604,14 @@
                         lane, lanepoint_by_lane_memo
                     )
                     shape_lps += new_lps
 
         return cls(shape_lps, spacing)
 
     @staticmethod
-    def _build_kd_tree(linked_lps: Sequence[LinkedLanePoint]) -> KDTree:
-        return KDTree(
-            np.array([l_lp.lp.pose.point.as_np_array[:2] for l_lp in linked_lps]),
-            leafsize=50,
-        )
-
-    @staticmethod
     def _interpolate_shape_lanepoints(
         shape_lanepoints: Sequence[LinkedLanePoint], spacing: float
     ) -> List[LinkedLanePoint]:
         # memoize interpolated lane-points on the shape lane-point at start of
         # the line we are interpolating
         interp_memo = {}
 
@@ -756,159 +746,78 @@
             curr_lanepoint.nexts.append(linked_lanepoint)
             curr_lanepoint = linked_lanepoint
             newly_created_lanepoints.append(linked_lanepoint)
             dist_into_lane_seg += spacing
         return curr_lanepoint
 
     @staticmethod
-    def _closest_linked_lp_in_kd_tree_batched(
-        points: Sequence[Point],
-        linked_lps,
-        tree: KDTree,
+    def _closest_linked_lp_to_point(
+        point: Point,
+        linked_lps: List[LinkedLanePoint],
+        points: np.ndarray,
         k: int = 1,
         filter_composites: bool = False,
-    ):
-        p2ds = np.array([p.as_np_array[:2] for p in points])
-        _, closest_indices = tree.query(p2ds, k=min(k, len(linked_lps)))
-        closest_indices = np.atleast_2d(closest_indices)
+    ) -> List[LinkedLanePoint]:
+        x = point.as_np_array[:2]
+        dists = np.sqrt(np.sum((points - x) ** 2, axis=1))
+        closest_indices = np.argsort(dists)[:k]
+
         if filter_composites:
             result = [
-                [
-                    linked_lps[idx]
-                    for idx in idxs
-                    if not linked_lps[idx].lp.lane.is_composite
-                ]
-                for idxs in closest_indices
+                linked_lps[idx]
+                for idx in closest_indices
+                if not linked_lps[idx].lp.lane.is_composite
             ]
             if result:
                 return result
-        # if filtering, only return lane-points in composite lanes if we didn't hit any in simple lanes...
-        return [[linked_lps[idx] for idx in idxs] for idxs in closest_indices]
 
-    @staticmethod
-    def _closest_linked_lp_in_kd_tree_with_pose_batched(
-        poses,
-        lanepoints,
-        tree,
-        within_radius: float,
-        k: int = 10,
-        filter_composites: bool = False,
-    ):
-        linked_lanepoints = LanePoints._closest_linked_lp_in_kd_tree_batched(
-            [pose.point for pose in poses],
-            lanepoints,
-            tree,
-            k=k,
-            filter_composites=filter_composites,
-        )
-
-        linked_lanepoints = [
-            sorted(
-                l_lps,
-                key=lambda _llp: squared_dist(
-                    poses[idx].as_position2d(), _llp.lp.pose.as_position2d()
-                ),
-            )
-            for idx, l_lps in enumerate(linked_lanepoints)
-        ]
-        # exclude those outside radius except closest
-        if within_radius is not None:
-            radius_sq = within_radius * within_radius
-            linked_lanepoints = [
-                [
-                    _llp
-                    for i, _llp in enumerate(_llps)
-                    if squared_dist(
-                        poses[idx].as_position2d(), _llp.lp.pose.as_position2d()
-                    )
-                    <= radius_sq
-                    or i == 0
-                ]
-                for idx, _llps in enumerate(linked_lanepoints)
-            ]
-        # Get the nearest point for the points where the radius check failed
-        unfound_lanepoints = [
-            (i, poses[i])
-            for i, group in enumerate(linked_lanepoints)
-            if len(group) == 0
-        ]
-        if len(unfound_lanepoints) > 0:
-            remaining_linked_lps = LanePoints._closest_linked_lp_in_kd_tree_batched(
-                [pose.point for _, pose in unfound_lanepoints],
-                lanepoints,
-                tree=tree,
-                k=k,
-                filter_composites=filter_composites,
-            )
-            # Replace the empty lanepoint locations
-            for (i, _), lps in [
-                g for g in zip(unfound_lanepoints, remaining_linked_lps)
-            ]:
-                linked_lanepoints[i] = [lps]
-
-        return [
-            sorted(
-                l_lps,
-                key=lambda _llp: squared_dist(
-                    poses[idx].as_position2d(), _llp.lp.pose.as_position2d()
-                )
-                + abs(poses[idx].heading.relative_to(_llp.lp.pose.heading)),
-            )
-            for idx, l_lps in enumerate(linked_lanepoints)
-        ]
+        # if filtering, only return lane-points in composite lanes if we didn't hit any in simple lanes...
+        return [linked_lps[idx] for idx in closest_indices]
 
     def closest_lanepoints(
         self,
         pose: Pose,
-        within_radius: float = 10,
         maximum_count: int = 10,
     ) -> List[LanePoint]:
         """Get the lane-points closest to the given pose.
         Args:
             pose:
                 The pose to look around for lane-points.
-            within_radius:
-                The radius which lane-points can be found from the given pose.
             maximum_count:
                 The maximum number of lane-points that should be found.
         """
-        lanepoints = self._linked_lanepoints
-        kd_tree = self._lanepoints_kd_tree
-        linked_lanepoints = LanePoints._closest_linked_lp_in_kd_tree_with_pose_batched(
-            [pose],
-            lanepoints,
-            kd_tree,
-            within_radius=within_radius,
+        linked_lanepoints = LanePoints._closest_linked_lp_to_point(
+            pose.point,
+            self._linked_lanepoints,
+            self._lp_points,
             k=maximum_count,
             filter_composites=True,
         )
-        return [l_lps.lp for l_lps in linked_lanepoints[0]]
-
-    def closest_lanepoint_on_lane_to_point(self, point, lane_id: str) -> LanePoint:
-        """Returns the closest lane-point on the given lane to the given world coordinate."""
-        return self.closest_linked_lanepoint_on_lane_to_point(point, lane_id).lp
+        return [llp.lp for llp in linked_lanepoints]
 
     def closest_linked_lanepoint_on_lane_to_point(
         self, point: Point, lane_id: str
     ) -> LinkedLanePoint:
         """Returns the closest linked lane-point on the given lane."""
-        lane_kd_tree = self._lanepoints_kd_tree_by_lane_id[lane_id]
-        return LanePoints._closest_linked_lp_in_kd_tree_batched(
-            [point], self._lanepoints_by_lane_id[lane_id], lane_kd_tree, k=1
-        )[0][0]
+        return LanePoints._closest_linked_lp_to_point(
+            point,
+            self._lanepoints_by_lane_id[lane_id],
+            self._lp_points_by_lane_id[lane_id],
+            k=1,
+        )[0]
 
     def closest_linked_lanepoint_on_road(
         self, point: Point, road_id: str
     ) -> LinkedLanePoint:
         """Returns the closest linked lane-point on the given road."""
-        return LanePoints._closest_linked_lp_in_kd_tree_batched(
-            [point],
+        return LanePoints._closest_linked_lp_to_point(
+            point,
             self._lanepoints_by_edge_id[road_id],
-            self._lanepoints_kd_tree_by_edge_id[road_id],
-        )[0][0]
+            self._lp_points_by_edge_id[road_id],
+        )[0]
 
     @lru_cache(maxsize=32)
     def paths_starting_at_lanepoint(
         self, lanepoint: LinkedLanePoint, lookahead: int, route_edge_ids: tuple
     ) -> List[List[LinkedLanePoint]]:
         """Returns all full branches from the given lane-point up to the length of the look-ahead.
         Branches will be filtered at the lane level if they or their outgoing lanes do not belong
```

## smarts/core/opendrive_road_network.py

```diff
@@ -1664,17 +1664,15 @@
         route: Optional[RoadMap.Route] = None,
     ) -> List[List[Waypoint]]:
         road_ids = []
         if route and route.roads:
             road_ids = [road.road_id for road in route.roads]
         if road_ids:
             return self._waypoint_paths_along_route(pose.point, lookahead, road_ids)
-        closest_lps = self._lanepoints.closest_lanepoints(
-            pose, within_radius=within_radius
-        )
+        closest_lps = self._lanepoints.closest_lanepoints(pose)
         closest_lane = closest_lps[0].lane
         waypoint_paths = []
         for lane in closest_lane.road.lanes:
             waypoint_paths += lane._waypoint_paths_at(pose.point, lookahead)
         return sorted(waypoint_paths, key=lambda p: p[0].lane_index)
 
     def _waypoint_paths_along_route(
```

## smarts/core/smarts.py

```diff
@@ -18,17 +18,27 @@
 # OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 # THE SOFTWARE.
 import importlib.resources as pkg_resources
 import logging
 import os
 import re
 import warnings
-from dataclasses import replace
 from functools import cached_property
-from typing import Any, Dict, Iterable, List, Optional, Sequence, Set, Tuple, Union
+from typing import (
+    Any,
+    Dict,
+    Final,
+    Iterable,
+    List,
+    Optional,
+    Sequence,
+    Set,
+    Tuple,
+    Union,
+)
 
 import numpy as np
 
 from envision import types as envision_types
 from envision.client import Client as EnvisionClient
 from smarts import VERSION
 from smarts.core.actor_capture_manager import ActorCaptureManager
@@ -81,15 +91,15 @@
 
 logging.basicConfig(
     format="%(asctime)s.%(msecs)03d %(levelname)s: {%(module)s} %(message)s",
     datefmt="%Y-%m-%d,%H:%M:%S",
     level=logging.ERROR,
 )
 
-MAX_PYBULLET_FREQ = 240
+MAX_PYBULLET_FREQ: Final[int] = 240
 
 
 class SMARTSNotSetupError(Exception):
     """Represents a case where SMARTS cannot operate because it is not set up yet."""
 
     pass
```

## smarts/core/sumo_road_network.py

```diff
@@ -992,17 +992,15 @@
                 if road_ids:
                     return self._waypoint_paths_along_route(
                         pose.point, lookahead, road_ids
                     )
 
         # No route provided, so generate paths based on the closest lanepoints
         waypoint_paths = []
-        closest_lps: List[LanePoint] = self._lanepoints.closest_lanepoints(
-            pose, within_radius=within_radius
-        )
+        closest_lps: List[LanePoint] = self._lanepoints.closest_lanepoints(pose)
 
         # First, see if we are in a junction and need to do something special
         junction_paths = self._resolve_in_junction(pose, closest_lps)
         if junction_paths:
             for lanes in junction_paths:
                 road_ids = [lane.road.road_id for lane in lanes]
                 start_lane = lanes[0]
```

## smarts/core/vehicle_state.py

```diff
@@ -19,15 +19,14 @@
 # LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 # OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 # THE SOFTWARE.
 from dataclasses import dataclass
 from typing import NamedTuple, Optional, Tuple
 
 import numpy as np
-from scipy.spatial.distance import cdist
 from shapely.affinity import rotate as shapely_rotate
 from shapely.geometry import Polygon
 from shapely.geometry import box as shapely_box
 
 from .actor import ActorState
 from .colors import SceneColors
 from .coordinates import Dimensions, Heading, Pose
@@ -180,13 +179,11 @@
         return other_states
 
     other_positions = [state.pose.position for state in other_states]
     if not other_positions:
         return []
 
     # calculate euclidean distances
-    distances = cdist(
-        other_positions, [vehicle_state.pose.position], metric="euclidean"
-    ).reshape(-1)
+    distances = np.linalg.norm(other_positions - vehicle_state.pose.position, axis=1)
 
     indices = np.argwhere(distances <= radius).flatten()
     return [other_states[i] for i in indices]
```

## smarts/core/waymo_map.py

```diff
@@ -4637,493 +4637,490 @@
 000121c0: 6e74 5f70 6174 6873 5f61 6c6f 6e67 5f72  nt_paths_along_r
 000121d0: 6f75 7465 2870 6f73 652e 706f 696e 742c  oute(pose.point,
 000121e0: 206c 6f6f 6b61 6865 6164 2c20 726f 6164   lookahead, road
 000121f0: 5f69 6473 290a 2020 2020 2020 2020 636c  _ids).        cl
 00012200: 6f73 6573 745f 6c70 7320 3d20 7365 6c66  osest_lps = self
 00012210: 2e5f 6c61 6e65 706f 696e 7473 2e63 6c6f  ._lanepoints.clo
 00012220: 7365 7374 5f6c 616e 6570 6f69 6e74 7328  sest_lanepoints(
-00012230: 0a20 2020 2020 2020 2020 2020 2070 6f73  .            pos
-00012240: 652c 2077 6974 6869 6e5f 7261 6469 7573  e, within_radius
-00012250: 3d77 6974 6869 6e5f 7261 6469 7573 0a20  =within_radius. 
-00012260: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00012270: 2063 6c6f 7365 7374 5f6c 616e 6520 3d20   closest_lane = 
-00012280: 636c 6f73 6573 745f 6c70 735b 305d 2e6c  closest_lps[0].l
-00012290: 616e 650a 2020 2020 2020 2020 7761 7970  ane.        wayp
-000122a0: 6f69 6e74 5f70 6174 6873 203d 205b 5d0a  oint_paths = [].
-000122b0: 2020 2020 2020 2020 666f 7220 6c61 6e65          for lane
-000122c0: 2069 6e20 636c 6f73 6573 745f 6c61 6e65   in closest_lane
-000122d0: 2e72 6f61 642e 6c61 6e65 733a 0a20 2020  .road.lanes:.   
-000122e0: 2020 2020 2020 2020 2077 6179 706f 696e           waypoin
-000122f0: 745f 7061 7468 7320 2b3d 206c 616e 652e  t_paths += lane.
-00012300: 5f77 6179 706f 696e 745f 7061 7468 735f  _waypoint_paths_
-00012310: 6174 2870 6f73 652e 706f 696e 742c 206c  at(pose.point, l
-00012320: 6f6f 6b61 6865 6164 290a 2020 2020 2020  ookahead).      
-00012330: 2020 7265 7475 726e 2073 6f72 7465 6428    return sorted(
-00012340: 7761 7970 6f69 6e74 5f70 6174 6873 2c20  waypoint_paths, 
-00012350: 6b65 793d 6c61 6d62 6461 2070 3a20 705b  key=lambda p: p[
-00012360: 305d 2e6c 616e 655f 696e 6465 7829 0a0a  0].lane_index)..
-00012370: 2020 2020 6465 6620 5f77 6179 706f 696e      def _waypoin
-00012380: 745f 7061 7468 735f 616c 6f6e 675f 726f  t_paths_along_ro
-00012390: 7574 6528 0a20 2020 2020 2020 2073 656c  ute(.        sel
-000123a0: 662c 2070 6f69 6e74 3a20 506f 696e 742c  f, point: Point,
-000123b0: 206c 6f6f 6b61 6865 6164 3a20 696e 742c   lookahead: int,
-000123c0: 2072 6f75 7465 3a20 5365 7175 656e 6365   route: Sequence
-000123d0: 5b73 7472 5d0a 2020 2020 2920 2d3e 204c  [str].    ) -> L
-000123e0: 6973 745b 4c69 7374 5b57 6179 706f 696e  ist[List[Waypoin
-000123f0: 745d 5d3a 0a20 2020 2020 2020 2022 2222  t]]:.        """
-00012400: 6669 6e64 7320 7468 6520 636c 6f73 6573  finds the closes
-00012410: 7420 6c61 6e65 2074 6f20 7665 6869 636c  t lane to vehicl
-00012420: 6527 7320 706f 7369 7469 6f6e 2074 6861  e's position tha
-00012430: 7420 6973 206f 6e20 6974 7320 726f 7574  t is on its rout
-00012440: 652c 0a20 2020 2020 2020 2074 6865 6e20  e,.        then 
-00012450: 6765 7473 2077 6179 706f 696e 7420 7061  gets waypoint pa
-00012460: 7468 7320 6672 6f6d 2061 6c6c 206c 616e  ths from all lan
-00012470: 6573 2069 6e20 6974 7320 726f 6164 2074  es in its road t
-00012480: 6865 7265 2e22 2222 0a20 2020 2020 2020  here.""".       
-00012490: 2061 7373 6572 7420 6c65 6e28 726f 7574   assert len(rout
-000124a0: 6529 203e 2030 2c20 6622 4578 7065 6374  e) > 0, f"Expect
-000124b0: 6564 2061 7420 6c65 6173 7420 3120 726f  ed at least 1 ro
-000124c0: 6164 2069 6e20 7468 6520 726f 7574 652c  ad in the route,
-000124d0: 2067 6f74 3a20 7b72 6f75 7465 7d22 0a20   got: {route}". 
-000124e0: 2020 2020 2020 2063 6c6f 7365 7374 5f6c         closest_l
-000124f0: 6c70 5f6f 6e5f 6561 6368 5f72 6f75 7465  lp_on_each_route
-00012500: 5f72 6f61 6420 3d20 5b0a 2020 2020 2020  _road = [.      
-00012510: 2020 2020 2020 7365 6c66 2e5f 6c61 6e65        self._lane
-00012520: 706f 696e 7473 2e63 6c6f 7365 7374 5f6c  points.closest_l
-00012530: 696e 6b65 645f 6c61 6e65 706f 696e 745f  inked_lanepoint_
-00012540: 6f6e 5f72 6f61 6428 706f 696e 742c 2072  on_road(point, r
-00012550: 6f61 6429 0a20 2020 2020 2020 2020 2020  oad).           
-00012560: 2066 6f72 2072 6f61 6420 696e 2072 6f75   for road in rou
-00012570: 7465 0a20 2020 2020 2020 205d 0a20 2020  te.        ].   
-00012580: 2020 2020 2063 6c6f 7365 7374 5f6c 696e       closest_lin
-00012590: 6b65 645f 6c70 203d 206d 696e 280a 2020  ked_lp = min(.  
-000125a0: 2020 2020 2020 2020 2020 636c 6f73 6573            closes
-000125b0: 745f 6c6c 705f 6f6e 5f65 6163 685f 726f  t_llp_on_each_ro
-000125c0: 7574 655f 726f 6164 2c0a 2020 2020 2020  ute_road,.      
-000125d0: 2020 2020 2020 6b65 793d 6c61 6d62 6461        key=lambda
-000125e0: 206c 5f6c 703a 206e 702e 6c69 6e61 6c67   l_lp: np.linalg
-000125f0: 2e6e 6f72 6d28 0a20 2020 2020 2020 2020  .norm(.         
-00012600: 2020 2020 2020 2076 6563 5f32 6428 6c5f         vec_2d(l_
-00012610: 6c70 2e6c 702e 706f 7365 2e70 6f73 6974  lp.lp.pose.posit
-00012620: 696f 6e29 202d 2076 6563 5f32 6428 706f  ion) - vec_2d(po
-00012630: 696e 7429 0a20 2020 2020 2020 2020 2020  int).           
-00012640: 2029 2c0a 2020 2020 2020 2020 290a 2020   ),.        ).  
-00012650: 2020 2020 2020 636c 6f73 6573 745f 6c61        closest_la
-00012660: 6e65 203d 2063 6c6f 7365 7374 5f6c 696e  ne = closest_lin
-00012670: 6b65 645f 6c70 2e6c 702e 6c61 6e65 0a20  ked_lp.lp.lane. 
-00012680: 2020 2020 2020 2077 6179 706f 696e 745f         waypoint_
-00012690: 7061 7468 7320 3d20 5b5d 0a20 2020 2020  paths = [].     
-000126a0: 2020 2066 6f72 206c 616e 6520 696e 2063     for lane in c
-000126b0: 6c6f 7365 7374 5f6c 616e 652e 726f 6164  losest_lane.road
-000126c0: 2e6c 616e 6573 3a0a 2020 2020 2020 2020  .lanes:.        
-000126d0: 2020 2020 7761 7970 6f69 6e74 5f70 6174      waypoint_pat
-000126e0: 6873 202b 3d20 6c61 6e65 2e5f 7761 7970  hs += lane._wayp
-000126f0: 6f69 6e74 5f70 6174 6873 5f61 7428 706f  oint_paths_at(po
-00012700: 696e 742c 206c 6f6f 6b61 6865 6164 2c20  int, lookahead, 
-00012710: 726f 7574 6529 0a0a 2020 2020 2020 2020  route)..        
-00012720: 7265 7475 726e 2073 6f72 7465 6428 7761  return sorted(wa
-00012730: 7970 6f69 6e74 5f70 6174 6873 2c20 6b65  ypoint_paths, ke
-00012740: 793d 6c65 6e2c 2072 6576 6572 7365 3d54  y=len, reverse=T
-00012750: 7275 6529 0a0a 2020 2020 4073 7461 7469  rue)..    @stati
-00012760: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
-00012770: 5f65 7175 616c 6c79 5f73 7061 6365 645f  _equally_spaced_
-00012780: 7061 7468 280a 2020 2020 2020 2020 7061  path(.        pa
-00012790: 7468 3a20 5365 7175 656e 6365 5b4c 696e  th: Sequence[Lin
-000127a0: 6b65 644c 616e 6550 6f69 6e74 5d2c 0a20  kedLanePoint],. 
-000127b0: 2020 2020 2020 2070 6f69 6e74 3a20 506f         point: Po
-000127c0: 696e 742c 0a20 2020 2020 2020 206c 705f  int,.        lp_
-000127d0: 7370 6163 696e 673a 2066 6c6f 6174 2c0a  spacing: float,.
-000127e0: 2020 2020 2920 2d3e 204c 6973 745b 5761      ) -> List[Wa
-000127f0: 7970 6f69 6e74 5d3a 0a20 2020 2020 2020  ypoint]:.       
-00012800: 2022 2222 6769 7665 6e20 6120 6c69 7374   """given a list
-00012810: 206f 6620 4c61 6e65 506f 696e 7473 2073   of LanePoints s
-00012820: 7461 7274 696e 6720 6e65 6172 2070 6f69  tarting near poi
-00012830: 6e74 2c20 7265 7475 726e 2063 6f72 7265  nt, return corre
-00012840: 7370 6f6e 6469 6e67 0a20 2020 2020 2020  sponding.       
-00012850: 2057 6179 706f 696e 7473 2074 6861 7420   Waypoints that 
-00012860: 6d61 7920 6e6f 7420 6265 2065 7665 6e6c  may not be evenl
-00012870: 7920 7370 6163 6564 2028 6475 6520 746f  y spaced (due to
-00012880: 206c 616e 6520 6368 616e 6765 2920 6275   lane change) bu
-00012890: 7420 7374 6172 7420 6174 2070 6f69 6e74  t start at point
-000128a0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-000128b0: 2020 2020 2020 2063 6f6e 7469 6e75 6f75         continuou
-000128c0: 735f 7661 7269 6162 6c65 7320 3d20 5b0a  s_variables = [.
-000128d0: 2020 2020 2020 2020 2020 2020 2270 6f73              "pos
-000128e0: 6974 696f 6e73 5f78 222c 0a20 2020 2020  itions_x",.     
-000128f0: 2020 2020 2020 2022 706f 7369 7469 6f6e         "position
-00012900: 735f 7922 2c0a 2020 2020 2020 2020 2020  s_y",.          
-00012910: 2020 2268 6561 6469 6e67 7322 2c0a 2020    "headings",.  
-00012920: 2020 2020 2020 2020 2020 226c 616e 655f            "lane_
-00012930: 7769 6474 6822 2c0a 2020 2020 2020 2020  width",.        
-00012940: 2020 2020 2273 7065 6564 5f6c 696d 6974      "speed_limit
-00012950: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-00012960: 6c61 6e65 5f6f 6666 7365 7422 2c0a 2020  lane_offset",.  
-00012970: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00012980: 6469 7363 7265 7465 5f76 6172 6961 626c  discrete_variabl
-00012990: 6573 203d 205b 226c 616e 655f 6964 222c  es = ["lane_id",
-000129a0: 2022 6c61 6e65 5f69 6e64 6578 225d 0a0a   "lane_index"]..
-000129b0: 2020 2020 2020 2020 7265 665f 6c61 6e65          ref_lane
-000129c0: 706f 696e 7473 5f63 6f6f 7264 696e 6174  points_coordinat
-000129d0: 6573 203d 207b 0a20 2020 2020 2020 2020  es = {.         
-000129e0: 2020 2070 6172 616d 6574 6572 3a20 5b5d     parameter: []
-000129f0: 2066 6f72 2070 6172 616d 6574 6572 2069   for parameter i
-00012a00: 6e20 2863 6f6e 7469 6e75 6f75 735f 7661  n (continuous_va
-00012a10: 7269 6162 6c65 7320 2b20 6469 7363 7265  riables + discre
-00012a20: 7465 5f76 6172 6961 626c 6573 290a 2020  te_variables).  
-00012a30: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00012a40: 666f 7220 6964 782c 206c 616e 6570 6f69  for idx, lanepoi
-00012a50: 6e74 2069 6e20 656e 756d 6572 6174 6528  nt in enumerate(
-00012a60: 7061 7468 293a 0a20 2020 2020 2020 2020  path):.         
-00012a70: 2020 2069 6620 6c61 6e65 706f 696e 742e     if lanepoint.
-00012a80: 6973 5f69 6e66 6572 7265 6420 616e 6420  is_inferred and 
-00012a90: 3020 3c20 6964 7820 3c20 6c65 6e28 7061  0 < idx < len(pa
-00012aa0: 7468 2920 2d20 313a 0a20 2020 2020 2020  th) - 1:.       
-00012ab0: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-00012ac0: 650a 0a20 2020 2020 2020 2020 2020 2072  e..            r
-00012ad0: 6566 5f6c 616e 6570 6f69 6e74 735f 636f  ef_lanepoints_co
-00012ae0: 6f72 6469 6e61 7465 735b 2270 6f73 6974  ordinates["posit
-00012af0: 696f 6e73 5f78 225d 2e61 7070 656e 6428  ions_x"].append(
-00012b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012b10: 206c 616e 6570 6f69 6e74 2e6c 702e 706f   lanepoint.lp.po
-00012b20: 7365 2e70 6f73 6974 696f 6e5b 305d 0a20  se.position[0]. 
-00012b30: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00012b40: 2020 2020 2020 2020 2072 6566 5f6c 616e           ref_lan
-00012b50: 6570 6f69 6e74 735f 636f 6f72 6469 6e61  epoints_coordina
-00012b60: 7465 735b 2270 6f73 6974 696f 6e73 5f79  tes["positions_y
-00012b70: 225d 2e61 7070 656e 6428 0a20 2020 2020  "].append(.     
-00012b80: 2020 2020 2020 2020 2020 206c 616e 6570             lanep
-00012b90: 6f69 6e74 2e6c 702e 706f 7365 2e70 6f73  oint.lp.pose.pos
-00012ba0: 6974 696f 6e5b 315d 0a20 2020 2020 2020  ition[1].       
-00012bb0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00012bc0: 2020 2072 6566 5f6c 616e 6570 6f69 6e74     ref_lanepoint
-00012bd0: 735f 636f 6f72 6469 6e61 7465 735b 2268  s_coordinates["h
-00012be0: 6561 6469 6e67 7322 5d2e 6170 7065 6e64  eadings"].append
-00012bf0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00012c00: 2020 6c61 6e65 706f 696e 742e 6c70 2e70    lanepoint.lp.p
-00012c10: 6f73 652e 6865 6164 696e 672e 6173 5f62  ose.heading.as_b
-00012c20: 756c 6c65 740a 2020 2020 2020 2020 2020  ullet.          
-00012c30: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00012c40: 7265 665f 6c61 6e65 706f 696e 7473 5f63  ref_lanepoints_c
-00012c50: 6f6f 7264 696e 6174 6573 5b22 6c61 6e65  oordinates["lane
-00012c60: 5f69 6422 5d2e 6170 7065 6e64 286c 616e  _id"].append(lan
-00012c70: 6570 6f69 6e74 2e6c 702e 6c61 6e65 2e6c  epoint.lp.lane.l
-00012c80: 616e 655f 6964 290a 2020 2020 2020 2020  ane_id).        
-00012c90: 2020 2020 7265 665f 6c61 6e65 706f 696e      ref_lanepoin
-00012ca0: 7473 5f63 6f6f 7264 696e 6174 6573 5b22  ts_coordinates["
-00012cb0: 6c61 6e65 5f69 6e64 6578 225d 2e61 7070  lane_index"].app
-00012cc0: 656e 6428 6c61 6e65 706f 696e 742e 6c70  end(lanepoint.lp
-00012cd0: 2e6c 616e 652e 696e 6465 7829 0a0a 2020  .lane.index)..  
-00012ce0: 2020 2020 2020 2020 2020 7265 665f 6c61            ref_la
-00012cf0: 6e65 706f 696e 7473 5f63 6f6f 7264 696e  nepoints_coordin
-00012d00: 6174 6573 5b22 6c61 6e65 5f77 6964 7468  ates["lane_width
-00012d10: 225d 2e61 7070 656e 6428 6c61 6e65 706f  "].append(lanepo
-00012d20: 696e 742e 6c70 2e6c 616e 655f 7769 6474  int.lp.lane_widt
-00012d30: 6829 0a0a 2020 2020 2020 2020 2020 2020  h)..            
-00012d40: 7265 665f 6c61 6e65 706f 696e 7473 5f63  ref_lanepoints_c
-00012d50: 6f6f 7264 696e 6174 6573 5b22 6c61 6e65  oordinates["lane
-00012d60: 5f6f 6666 7365 7422 5d2e 6170 7065 6e64  _offset"].append
-00012d70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00012d80: 2020 6c61 6e65 706f 696e 742e 6c70 2e6c    lanepoint.lp.l
-00012d90: 616e 652e 6f66 6673 6574 5f61 6c6f 6e67  ane.offset_along
-00012da0: 5f6c 616e 6528 6c61 6e65 706f 696e 742e  _lane(lanepoint.
-00012db0: 6c70 2e70 6f73 652e 706f 696e 7429 0a20  lp.pose.point). 
-00012dc0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00012dd0: 2020 2020 2020 2020 2020 7265 665f 6c61            ref_la
-00012de0: 6e65 706f 696e 7473 5f63 6f6f 7264 696e  nepoints_coordin
-00012df0: 6174 6573 5b22 7370 6565 645f 6c69 6d69  ates["speed_limi
-00012e00: 7422 5d2e 6170 7065 6e64 280a 2020 2020  t"].append(.    
-00012e10: 2020 2020 2020 2020 2020 2020 6c61 6e65              lane
-00012e20: 706f 696e 742e 6c70 2e6c 616e 652e 7370  point.lp.lane.sp
-00012e30: 6565 645f 6c69 6d69 740a 2020 2020 2020  eed_limit.      
-00012e40: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00012e50: 2072 6566 5f6c 616e 6570 6f69 6e74 735f   ref_lanepoints_
-00012e60: 636f 6f72 6469 6e61 7465 735b 2268 6561  coordinates["hea
-00012e70: 6469 6e67 7322 5d20 3d20 696e 706c 6163  dings"] = inplac
-00012e80: 655f 756e 7772 6170 280a 2020 2020 2020  e_unwrap(.      
-00012e90: 2020 2020 2020 7265 665f 6c61 6e65 706f        ref_lanepo
-00012ea0: 696e 7473 5f63 6f6f 7264 696e 6174 6573  ints_coordinates
-00012eb0: 5b22 6865 6164 696e 6773 225d 0a20 2020  ["headings"].   
-00012ec0: 2020 2020 2029 0a20 2020 2020 2020 2066       ).        f
-00012ed0: 6972 7374 5f6c 705f 6865 6164 696e 6720  irst_lp_heading 
-00012ee0: 3d20 7265 665f 6c61 6e65 706f 696e 7473  = ref_lanepoints
-00012ef0: 5f63 6f6f 7264 696e 6174 6573 5b22 6865  _coordinates["he
-00012f00: 6164 696e 6773 225d 5b30 5d0a 2020 2020  adings"][0].    
-00012f10: 2020 2020 6c70 5f70 6f73 6974 696f 6e20      lp_position 
-00012f20: 3d20 7061 7468 5b30 5d2e 6c70 2e70 6f73  = path[0].lp.pos
-00012f30: 652e 706f 696e 742e 6173 5f6e 705f 6172  e.point.as_np_ar
-00012f40: 7261 795b 3a32 5d0a 2020 2020 2020 2020  ray[:2].        
-00012f50: 7665 6869 636c 655f 706f 7320 3d20 706f  vehicle_pos = po
-00012f60: 696e 742e 6173 5f6e 705f 6172 7261 795b  int.as_np_array[
-00012f70: 3a32 5d0a 2020 2020 2020 2020 6865 6164  :2].        head
-00012f80: 696e 675f 7665 6320 3d20 7261 6469 616e  ing_vec = radian
-00012f90: 735f 746f 5f76 6563 2866 6972 7374 5f6c  s_to_vec(first_l
-00012fa0: 705f 6865 6164 696e 6729 0a20 2020 2020  p_heading).     
-00012fb0: 2020 2070 726f 6a65 6374 6564 5f64 6973     projected_dis
-00012fc0: 7461 6e74 5f6c 705f 7665 6869 636c 6520  tant_lp_vehicle 
-00012fd0: 3d20 6e70 2e69 6e6e 6572 280a 2020 2020  = np.inner(.    
-00012fe0: 2020 2020 2020 2020 2876 6568 6963 6c65          (vehicle
-00012ff0: 5f70 6f73 202d 206c 705f 706f 7369 7469  _pos - lp_positi
-00013000: 6f6e 292c 2068 6561 6469 6e67 5f76 6563  on), heading_vec
-00013010: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00013020: 2020 2020 7265 665f 6c61 6e65 706f 696e      ref_lanepoin
-00013030: 7473 5f63 6f6f 7264 696e 6174 6573 5b22  ts_coordinates["
-00013040: 706f 7369 7469 6f6e 735f 7822 5d5b 305d  positions_x"][0]
-00013050: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00013060: 206c 705f 706f 7369 7469 6f6e 5b30 5d20   lp_position[0] 
-00013070: 2b20 7072 6f6a 6563 7465 645f 6469 7374  + projected_dist
-00013080: 616e 745f 6c70 5f76 6568 6963 6c65 202a  ant_lp_vehicle *
-00013090: 2068 6561 6469 6e67 5f76 6563 5b30 5d0a   heading_vec[0].
-000130a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000130b0: 2020 7265 665f 6c61 6e65 706f 696e 7473    ref_lanepoints
-000130c0: 5f63 6f6f 7264 696e 6174 6573 5b22 706f  _coordinates["po
-000130d0: 7369 7469 6f6e 735f 7922 5d5b 305d 203d  sitions_y"][0] =
-000130e0: 2028 0a20 2020 2020 2020 2020 2020 206c   (.            l
-000130f0: 705f 706f 7369 7469 6f6e 5b31 5d20 2b20  p_position[1] + 
-00013100: 7072 6f6a 6563 7465 645f 6469 7374 616e  projected_distan
-00013110: 745f 6c70 5f76 6568 6963 6c65 202a 2068  t_lp_vehicle * h
-00013120: 6561 6469 6e67 5f76 6563 5b31 5d0a 2020  eading_vec[1].  
-00013130: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00013140: 2063 756d 756c 6174 6976 655f 7061 7468   cumulative_path
-00013150: 5f64 6973 7420 3d20 6e70 2e63 756d 7375  _dist = np.cumsu
-00013160: 6d28 0a20 2020 2020 2020 2020 2020 206e  m(.            n
-00013170: 702e 7371 7274 280a 2020 2020 2020 2020  p.sqrt(.        
-00013180: 2020 2020 2020 2020 6e70 2e65 6469 6666          np.ediff
-00013190: 3164 2872 6566 5f6c 616e 6570 6f69 6e74  1d(ref_lanepoint
-000131a0: 735f 636f 6f72 6469 6e61 7465 735b 2270  s_coordinates["p
-000131b0: 6f73 6974 696f 6e73 5f78 225d 2c20 746f  ositions_x"], to
-000131c0: 5f62 6567 696e 3d30 2920 2a2a 2032 0a20  _begin=0) ** 2. 
-000131d0: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-000131e0: 206e 702e 6564 6966 6631 6428 7265 665f   np.ediff1d(ref_
-000131f0: 6c61 6e65 706f 696e 7473 5f63 6f6f 7264  lanepoints_coord
-00013200: 696e 6174 6573 5b22 706f 7369 7469 6f6e  inates["position
-00013210: 735f 7922 5d2c 2074 6f5f 6265 6769 6e3d  s_y"], to_begin=
-00013220: 3029 202a 2a20 320a 2020 2020 2020 2020  0) ** 2.        
-00013230: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
-00013240: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-00013250: 6375 6d75 6c61 7469 7665 5f70 6174 685f  cumulative_path_
-00013260: 6469 7374 2920 3c3d 206c 705f 7370 6163  dist) <= lp_spac
-00013270: 696e 673a 0a20 2020 2020 2020 2020 2020  ing:.           
-00013280: 206c 7020 3d20 7061 7468 5b30 5d2e 6c70   lp = path[0].lp
-00013290: 0a0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-000132a0: 7475 726e 205b 0a20 2020 2020 2020 2020  turn [.         
-000132b0: 2020 2020 2020 2057 6179 706f 696e 7428         Waypoint(
-000132c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000132d0: 2020 2020 2070 6f73 3d6c 702e 706f 7365       pos=lp.pose
-000132e0: 2e70 6f73 6974 696f 6e5b 3a32 5d2c 0a20  .position[:2],. 
-000132f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013300: 2020 2068 6561 6469 6e67 3d6c 702e 706f     heading=lp.po
-00013310: 7365 2e68 6561 6469 6e67 2c0a 2020 2020  se.heading,.    
-00013320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013330: 6c61 6e65 5f77 6964 7468 3d6c 702e 6c61  lane_width=lp.la
-00013340: 6e65 2e77 6964 7468 5f61 745f 6f66 6673  ne.width_at_offs
-00013350: 6574 2830 295b 305d 2c0a 2020 2020 2020  et(0)[0],.      
-00013360: 2020 2020 2020 2020 2020 2020 2020 7370                sp
-00013370: 6565 645f 6c69 6d69 743d 6c70 2e6c 616e  eed_limit=lp.lan
-00013380: 652e 7370 6565 645f 6c69 6d69 742c 0a20  e.speed_limit,. 
-00013390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133a0: 2020 206c 616e 655f 6964 3d6c 702e 6c61     lane_id=lp.la
-000133b0: 6e65 2e6c 616e 655f 6964 2c0a 2020 2020  ne.lane_id,.    
-000133c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133d0: 6c61 6e65 5f69 6e64 6578 3d6c 702e 6c61  lane_index=lp.la
-000133e0: 6e65 2e69 6e64 6578 2c0a 2020 2020 2020  ne.index,.      
-000133f0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
-00013400: 6e65 5f6f 6666 7365 743d 6c70 2e6c 616e  ne_offset=lp.lan
-00013410: 652e 6f66 6673 6574 5f61 6c6f 6e67 5f6c  e.offset_along_l
-00013420: 616e 6528 6c70 2e70 6f73 652e 706f 696e  ane(lp.pose.poin
-00013430: 7429 2c0a 2020 2020 2020 2020 2020 2020  t),.            
-00013440: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00013450: 2020 5d0a 0a20 2020 2020 2020 2065 7665    ]..        eve
-00013460: 6e6c 795f 7370 6163 6564 5f63 756d 756c  nly_spaced_cumul
-00013470: 6174 6976 655f 7061 7468 5f64 6973 7420  ative_path_dist 
-00013480: 3d20 6e70 2e6c 696e 7370 6163 6528 0a20  = np.linspace(. 
-00013490: 2020 2020 2020 2020 2020 2030 2c20 6375             0, cu
-000134a0: 6d75 6c61 7469 7665 5f70 6174 685f 6469  mulative_path_di
-000134b0: 7374 5b2d 315d 2c20 6c65 6e28 7061 7468  st[-1], len(path
-000134c0: 290a 2020 2020 2020 2020 290a 0a20 2020  ).        )..   
-000134d0: 2020 2020 2065 7665 6e6c 795f 7370 6163       evenly_spac
-000134e0: 6564 5f63 6f6f 7264 696e 6174 6573 203d  ed_coordinates =
-000134f0: 207b 7d0a 2020 2020 2020 2020 666f 7220   {}.        for 
-00013500: 7661 7269 6162 6c65 2069 6e20 636f 6e74  variable in cont
-00013510: 696e 756f 7573 5f76 6172 6961 626c 6573  inuous_variables
-00013520: 3a0a 2020 2020 2020 2020 2020 2020 6576  :.            ev
-00013530: 656e 6c79 5f73 7061 6365 645f 636f 6f72  enly_spaced_coor
-00013540: 6469 6e61 7465 735b 7661 7269 6162 6c65  dinates[variable
-00013550: 5d20 3d20 6e70 2e69 6e74 6572 7028 0a20  ] = np.interp(. 
-00013560: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00013570: 7665 6e6c 795f 7370 6163 6564 5f63 756d  venly_spaced_cum
-00013580: 756c 6174 6976 655f 7061 7468 5f64 6973  ulative_path_dis
-00013590: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-000135a0: 2020 2063 756d 756c 6174 6976 655f 7061     cumulative_pa
-000135b0: 7468 5f64 6973 742c 0a20 2020 2020 2020  th_dist,.       
-000135c0: 2020 2020 2020 2020 2072 6566 5f6c 616e           ref_lan
-000135d0: 6570 6f69 6e74 735f 636f 6f72 6469 6e61  epoints_coordina
-000135e0: 7465 735b 7661 7269 6162 6c65 5d2c 0a20  tes[variable],. 
-000135f0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00013600: 2020 2020 2020 666f 7220 7661 7269 6162        for variab
-00013610: 6c65 2069 6e20 6469 7363 7265 7465 5f76  le in discrete_v
-00013620: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
-00013630: 2020 2020 2020 7265 665f 636f 6f72 6469        ref_coordi
-00013640: 6e61 7465 7320 3d20 7265 665f 6c61 6e65  nates = ref_lane
-00013650: 706f 696e 7473 5f63 6f6f 7264 696e 6174  points_coordinat
-00013660: 6573 5b76 6172 6961 626c 655d 0a20 2020  es[variable].   
-00013670: 2020 2020 2020 2020 2065 7665 6e6c 795f           evenly_
-00013680: 7370 6163 6564 5f63 6f6f 7264 696e 6174  spaced_coordinat
-00013690: 6573 5b76 6172 6961 626c 655d 203d 205b  es[variable] = [
-000136a0: 5d0a 2020 2020 2020 2020 2020 2020 6a64  ].            jd
-000136b0: 7820 3d20 300a 2020 2020 2020 2020 2020  x = 0.          
-000136c0: 2020 666f 7220 6964 7820 696e 2072 616e    for idx in ran
-000136d0: 6765 286c 656e 2870 6174 6829 293a 0a20  ge(len(path)):. 
-000136e0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-000136f0: 6869 6c65 2028 0a20 2020 2020 2020 2020  hile (.         
-00013700: 2020 2020 2020 2020 2020 206a 6478 202b             jdx +
-00013710: 2031 203c 206c 656e 2863 756d 756c 6174   1 < len(cumulat
-00013720: 6976 655f 7061 7468 5f64 6973 7429 0a20  ive_path_dist). 
-00013730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013740: 2020 2061 6e64 2065 7665 6e6c 795f 7370     and evenly_sp
-00013750: 6163 6564 5f63 756d 756c 6174 6976 655f  aced_cumulative_
-00013760: 7061 7468 5f64 6973 745b 6964 785d 0a20  path_dist[idx]. 
+00012230: 706f 7365 290a 2020 2020 2020 2020 636c  pose).        cl
+00012240: 6f73 6573 745f 6c61 6e65 203d 2063 6c6f  osest_lane = clo
+00012250: 7365 7374 5f6c 7073 5b30 5d2e 6c61 6e65  sest_lps[0].lane
+00012260: 0a20 2020 2020 2020 2077 6179 706f 696e  .        waypoin
+00012270: 745f 7061 7468 7320 3d20 5b5d 0a20 2020  t_paths = [].   
+00012280: 2020 2020 2066 6f72 206c 616e 6520 696e       for lane in
+00012290: 2063 6c6f 7365 7374 5f6c 616e 652e 726f   closest_lane.ro
+000122a0: 6164 2e6c 616e 6573 3a0a 2020 2020 2020  ad.lanes:.      
+000122b0: 2020 2020 2020 7761 7970 6f69 6e74 5f70        waypoint_p
+000122c0: 6174 6873 202b 3d20 6c61 6e65 2e5f 7761  aths += lane._wa
+000122d0: 7970 6f69 6e74 5f70 6174 6873 5f61 7428  ypoint_paths_at(
+000122e0: 706f 7365 2e70 6f69 6e74 2c20 6c6f 6f6b  pose.point, look
+000122f0: 6168 6561 6429 0a20 2020 2020 2020 2072  ahead).        r
+00012300: 6574 7572 6e20 736f 7274 6564 2877 6179  eturn sorted(way
+00012310: 706f 696e 745f 7061 7468 732c 206b 6579  point_paths, key
+00012320: 3d6c 616d 6264 6120 703a 2070 5b30 5d2e  =lambda p: p[0].
+00012330: 6c61 6e65 5f69 6e64 6578 290a 0a20 2020  lane_index)..   
+00012340: 2064 6566 205f 7761 7970 6f69 6e74 5f70   def _waypoint_p
+00012350: 6174 6873 5f61 6c6f 6e67 5f72 6f75 7465  aths_along_route
+00012360: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+00012370: 706f 696e 743a 2050 6f69 6e74 2c20 6c6f  point: Point, lo
+00012380: 6f6b 6168 6561 643a 2069 6e74 2c20 726f  okahead: int, ro
+00012390: 7574 653a 2053 6571 7565 6e63 655b 7374  ute: Sequence[st
+000123a0: 725d 0a20 2020 2029 202d 3e20 4c69 7374  r].    ) -> List
+000123b0: 5b4c 6973 745b 5761 7970 6f69 6e74 5d5d  [List[Waypoint]]
+000123c0: 3a0a 2020 2020 2020 2020 2222 2266 696e  :.        """fin
+000123d0: 6473 2074 6865 2063 6c6f 7365 7374 206c  ds the closest l
+000123e0: 616e 6520 746f 2076 6568 6963 6c65 2773  ane to vehicle's
+000123f0: 2070 6f73 6974 696f 6e20 7468 6174 2069   position that i
+00012400: 7320 6f6e 2069 7473 2072 6f75 7465 2c0a  s on its route,.
+00012410: 2020 2020 2020 2020 7468 656e 2067 6574          then get
+00012420: 7320 7761 7970 6f69 6e74 2070 6174 6873  s waypoint paths
+00012430: 2066 726f 6d20 616c 6c20 6c61 6e65 7320   from all lanes 
+00012440: 696e 2069 7473 2072 6f61 6420 7468 6572  in its road ther
+00012450: 652e 2222 220a 2020 2020 2020 2020 6173  e.""".        as
+00012460: 7365 7274 206c 656e 2872 6f75 7465 2920  sert len(route) 
+00012470: 3e20 302c 2066 2245 7870 6563 7465 6420  > 0, f"Expected 
+00012480: 6174 206c 6561 7374 2031 2072 6f61 6420  at least 1 road 
+00012490: 696e 2074 6865 2072 6f75 7465 2c20 676f  in the route, go
+000124a0: 743a 207b 726f 7574 657d 220a 2020 2020  t: {route}".    
+000124b0: 2020 2020 636c 6f73 6573 745f 6c6c 705f      closest_llp_
+000124c0: 6f6e 5f65 6163 685f 726f 7574 655f 726f  on_each_route_ro
+000124d0: 6164 203d 205b 0a20 2020 2020 2020 2020  ad = [.         
+000124e0: 2020 2073 656c 662e 5f6c 616e 6570 6f69     self._lanepoi
+000124f0: 6e74 732e 636c 6f73 6573 745f 6c69 6e6b  nts.closest_link
+00012500: 6564 5f6c 616e 6570 6f69 6e74 5f6f 6e5f  ed_lanepoint_on_
+00012510: 726f 6164 2870 6f69 6e74 2c20 726f 6164  road(point, road
+00012520: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+00012530: 7220 726f 6164 2069 6e20 726f 7574 650a  r road in route.
+00012540: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00012550: 2020 636c 6f73 6573 745f 6c69 6e6b 6564    closest_linked
+00012560: 5f6c 7020 3d20 6d69 6e28 0a20 2020 2020  _lp = min(.     
+00012570: 2020 2020 2020 2063 6c6f 7365 7374 5f6c         closest_l
+00012580: 6c70 5f6f 6e5f 6561 6368 5f72 6f75 7465  lp_on_each_route
+00012590: 5f72 6f61 642c 0a20 2020 2020 2020 2020  _road,.         
+000125a0: 2020 206b 6579 3d6c 616d 6264 6120 6c5f     key=lambda l_
+000125b0: 6c70 3a20 6e70 2e6c 696e 616c 672e 6e6f  lp: np.linalg.no
+000125c0: 726d 280a 2020 2020 2020 2020 2020 2020  rm(.            
+000125d0: 2020 2020 7665 635f 3264 286c 5f6c 702e      vec_2d(l_lp.
+000125e0: 6c70 2e70 6f73 652e 706f 7369 7469 6f6e  lp.pose.position
+000125f0: 2920 2d20 7665 635f 3264 2870 6f69 6e74  ) - vec_2d(point
+00012600: 290a 2020 2020 2020 2020 2020 2020 292c  ).            ),
+00012610: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00012620: 2020 2063 6c6f 7365 7374 5f6c 616e 6520     closest_lane 
+00012630: 3d20 636c 6f73 6573 745f 6c69 6e6b 6564  = closest_linked
+00012640: 5f6c 702e 6c70 2e6c 616e 650a 2020 2020  _lp.lp.lane.    
+00012650: 2020 2020 7761 7970 6f69 6e74 5f70 6174      waypoint_pat
+00012660: 6873 203d 205b 5d0a 2020 2020 2020 2020  hs = [].        
+00012670: 666f 7220 6c61 6e65 2069 6e20 636c 6f73  for lane in clos
+00012680: 6573 745f 6c61 6e65 2e72 6f61 642e 6c61  est_lane.road.la
+00012690: 6e65 733a 0a20 2020 2020 2020 2020 2020  nes:.           
+000126a0: 2077 6179 706f 696e 745f 7061 7468 7320   waypoint_paths 
+000126b0: 2b3d 206c 616e 652e 5f77 6179 706f 696e  += lane._waypoin
+000126c0: 745f 7061 7468 735f 6174 2870 6f69 6e74  t_paths_at(point
+000126d0: 2c20 6c6f 6f6b 6168 6561 642c 2072 6f75  , lookahead, rou
+000126e0: 7465 290a 0a20 2020 2020 2020 2072 6574  te)..        ret
+000126f0: 7572 6e20 736f 7274 6564 2877 6179 706f  urn sorted(waypo
+00012700: 696e 745f 7061 7468 732c 206b 6579 3d6c  int_paths, key=l
+00012710: 656e 2c20 7265 7665 7273 653d 5472 7565  en, reverse=True
+00012720: 290a 0a20 2020 2040 7374 6174 6963 6d65  )..    @staticme
+00012730: 7468 6f64 0a20 2020 2064 6566 205f 6571  thod.    def _eq
+00012740: 7561 6c6c 795f 7370 6163 6564 5f70 6174  ually_spaced_pat
+00012750: 6828 0a20 2020 2020 2020 2070 6174 683a  h(.        path:
+00012760: 2053 6571 7565 6e63 655b 4c69 6e6b 6564   Sequence[Linked
+00012770: 4c61 6e65 506f 696e 745d 2c0a 2020 2020  LanePoint],.    
+00012780: 2020 2020 706f 696e 743a 2050 6f69 6e74      point: Point
+00012790: 2c0a 2020 2020 2020 2020 6c70 5f73 7061  ,.        lp_spa
+000127a0: 6369 6e67 3a20 666c 6f61 742c 0a20 2020  cing: float,.   
+000127b0: 2029 202d 3e20 4c69 7374 5b57 6179 706f   ) -> List[Waypo
+000127c0: 696e 745d 3a0a 2020 2020 2020 2020 2222  int]:.        ""
+000127d0: 2267 6976 656e 2061 206c 6973 7420 6f66  "given a list of
+000127e0: 204c 616e 6550 6f69 6e74 7320 7374 6172   LanePoints star
+000127f0: 7469 6e67 206e 6561 7220 706f 696e 742c  ting near point,
+00012800: 2072 6574 7572 6e20 636f 7272 6573 706f   return correspo
+00012810: 6e64 696e 670a 2020 2020 2020 2020 5761  nding.        Wa
+00012820: 7970 6f69 6e74 7320 7468 6174 206d 6179  ypoints that may
+00012830: 206e 6f74 2062 6520 6576 656e 6c79 2073   not be evenly s
+00012840: 7061 6365 6420 2864 7565 2074 6f20 6c61  paced (due to la
+00012850: 6e65 2063 6861 6e67 6529 2062 7574 2073  ne change) but s
+00012860: 7461 7274 2061 7420 706f 696e 742e 0a20  tart at point.. 
+00012870: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00012880: 2020 2020 636f 6e74 696e 756f 7573 5f76      continuous_v
+00012890: 6172 6961 626c 6573 203d 205b 0a20 2020  ariables = [.   
+000128a0: 2020 2020 2020 2020 2022 706f 7369 7469           "positi
+000128b0: 6f6e 735f 7822 2c0a 2020 2020 2020 2020  ons_x",.        
+000128c0: 2020 2020 2270 6f73 6974 696f 6e73 5f79      "positions_y
+000128d0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+000128e0: 6865 6164 696e 6773 222c 0a20 2020 2020  headings",.     
+000128f0: 2020 2020 2020 2022 6c61 6e65 5f77 6964         "lane_wid
+00012900: 7468 222c 0a20 2020 2020 2020 2020 2020  th",.           
+00012910: 2022 7370 6565 645f 6c69 6d69 7422 2c0a   "speed_limit",.
+00012920: 2020 2020 2020 2020 2020 2020 226c 616e              "lan
+00012930: 655f 6f66 6673 6574 222c 0a20 2020 2020  e_offset",.     
+00012940: 2020 205d 0a20 2020 2020 2020 2064 6973     ].        dis
+00012950: 6372 6574 655f 7661 7269 6162 6c65 7320  crete_variables 
+00012960: 3d20 5b22 6c61 6e65 5f69 6422 2c20 226c  = ["lane_id", "l
+00012970: 616e 655f 696e 6465 7822 5d0a 0a20 2020  ane_index"]..   
+00012980: 2020 2020 2072 6566 5f6c 616e 6570 6f69       ref_lanepoi
+00012990: 6e74 735f 636f 6f72 6469 6e61 7465 7320  nts_coordinates 
+000129a0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+000129b0: 7061 7261 6d65 7465 723a 205b 5d20 666f  parameter: [] fo
+000129c0: 7220 7061 7261 6d65 7465 7220 696e 2028  r parameter in (
+000129d0: 636f 6e74 696e 756f 7573 5f76 6172 6961  continuous_varia
+000129e0: 626c 6573 202b 2064 6973 6372 6574 655f  bles + discrete_
+000129f0: 7661 7269 6162 6c65 7329 0a20 2020 2020  variables).     
+00012a00: 2020 207d 0a20 2020 2020 2020 2066 6f72     }.        for
+00012a10: 2069 6478 2c20 6c61 6e65 706f 696e 7420   idx, lanepoint 
+00012a20: 696e 2065 6e75 6d65 7261 7465 2870 6174  in enumerate(pat
+00012a30: 6829 3a0a 2020 2020 2020 2020 2020 2020  h):.            
+00012a40: 6966 206c 616e 6570 6f69 6e74 2e69 735f  if lanepoint.is_
+00012a50: 696e 6665 7272 6564 2061 6e64 2030 203c  inferred and 0 <
+00012a60: 2069 6478 203c 206c 656e 2870 6174 6829   idx < len(path)
+00012a70: 202d 2031 3a0a 2020 2020 2020 2020 2020   - 1:.          
+00012a80: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+00012a90: 2020 2020 2020 2020 2020 2020 7265 665f              ref_
+00012aa0: 6c61 6e65 706f 696e 7473 5f63 6f6f 7264  lanepoints_coord
+00012ab0: 696e 6174 6573 5b22 706f 7369 7469 6f6e  inates["position
+00012ac0: 735f 7822 5d2e 6170 7065 6e64 280a 2020  s_x"].append(.  
+00012ad0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+00012ae0: 6e65 706f 696e 742e 6c70 2e70 6f73 652e  nepoint.lp.pose.
+00012af0: 706f 7369 7469 6f6e 5b30 5d0a 2020 2020  position[0].    
+00012b00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00012b10: 2020 2020 2020 7265 665f 6c61 6e65 706f        ref_lanepo
+00012b20: 696e 7473 5f63 6f6f 7264 696e 6174 6573  ints_coordinates
+00012b30: 5b22 706f 7369 7469 6f6e 735f 7922 5d2e  ["positions_y"].
+00012b40: 6170 7065 6e64 280a 2020 2020 2020 2020  append(.        
+00012b50: 2020 2020 2020 2020 6c61 6e65 706f 696e          lanepoin
+00012b60: 742e 6c70 2e70 6f73 652e 706f 7369 7469  t.lp.pose.positi
+00012b70: 6f6e 5b31 5d0a 2020 2020 2020 2020 2020  on[1].          
+00012b80: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00012b90: 7265 665f 6c61 6e65 706f 696e 7473 5f63  ref_lanepoints_c
+00012ba0: 6f6f 7264 696e 6174 6573 5b22 6865 6164  oordinates["head
+00012bb0: 696e 6773 225d 2e61 7070 656e 6428 0a20  ings"].append(. 
+00012bc0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00012bd0: 616e 6570 6f69 6e74 2e6c 702e 706f 7365  anepoint.lp.pose
+00012be0: 2e68 6561 6469 6e67 2e61 735f 6275 6c6c  .heading.as_bull
+00012bf0: 6574 0a20 2020 2020 2020 2020 2020 2029  et.            )
+00012c00: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
+00012c10: 5f6c 616e 6570 6f69 6e74 735f 636f 6f72  _lanepoints_coor
+00012c20: 6469 6e61 7465 735b 226c 616e 655f 6964  dinates["lane_id
+00012c30: 225d 2e61 7070 656e 6428 6c61 6e65 706f  "].append(lanepo
+00012c40: 696e 742e 6c70 2e6c 616e 652e 6c61 6e65  int.lp.lane.lane
+00012c50: 5f69 6429 0a20 2020 2020 2020 2020 2020  _id).           
+00012c60: 2072 6566 5f6c 616e 6570 6f69 6e74 735f   ref_lanepoints_
+00012c70: 636f 6f72 6469 6e61 7465 735b 226c 616e  coordinates["lan
+00012c80: 655f 696e 6465 7822 5d2e 6170 7065 6e64  e_index"].append
+00012c90: 286c 616e 6570 6f69 6e74 2e6c 702e 6c61  (lanepoint.lp.la
+00012ca0: 6e65 2e69 6e64 6578 290a 0a20 2020 2020  ne.index)..     
+00012cb0: 2020 2020 2020 2072 6566 5f6c 616e 6570         ref_lanep
+00012cc0: 6f69 6e74 735f 636f 6f72 6469 6e61 7465  oints_coordinate
+00012cd0: 735b 226c 616e 655f 7769 6474 6822 5d2e  s["lane_width"].
+00012ce0: 6170 7065 6e64 286c 616e 6570 6f69 6e74  append(lanepoint
+00012cf0: 2e6c 702e 6c61 6e65 5f77 6964 7468 290a  .lp.lane_width).
+00012d00: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
+00012d10: 5f6c 616e 6570 6f69 6e74 735f 636f 6f72  _lanepoints_coor
+00012d20: 6469 6e61 7465 735b 226c 616e 655f 6f66  dinates["lane_of
+00012d30: 6673 6574 225d 2e61 7070 656e 6428 0a20  fset"].append(. 
+00012d40: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00012d50: 616e 6570 6f69 6e74 2e6c 702e 6c61 6e65  anepoint.lp.lane
+00012d60: 2e6f 6666 7365 745f 616c 6f6e 675f 6c61  .offset_along_la
+00012d70: 6e65 286c 616e 6570 6f69 6e74 2e6c 702e  ne(lanepoint.lp.
+00012d80: 706f 7365 2e70 6f69 6e74 290a 2020 2020  pose.point).    
+00012d90: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00012da0: 2020 2020 2020 2072 6566 5f6c 616e 6570         ref_lanep
+00012db0: 6f69 6e74 735f 636f 6f72 6469 6e61 7465  oints_coordinate
+00012dc0: 735b 2273 7065 6564 5f6c 696d 6974 225d  s["speed_limit"]
+00012dd0: 2e61 7070 656e 6428 0a20 2020 2020 2020  .append(.       
+00012de0: 2020 2020 2020 2020 206c 616e 6570 6f69           lanepoi
+00012df0: 6e74 2e6c 702e 6c61 6e65 2e73 7065 6564  nt.lp.lane.speed
+00012e00: 5f6c 696d 6974 0a20 2020 2020 2020 2020  _limit.         
+00012e10: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
+00012e20: 665f 6c61 6e65 706f 696e 7473 5f63 6f6f  f_lanepoints_coo
+00012e30: 7264 696e 6174 6573 5b22 6865 6164 696e  rdinates["headin
+00012e40: 6773 225d 203d 2069 6e70 6c61 6365 5f75  gs"] = inplace_u
+00012e50: 6e77 7261 7028 0a20 2020 2020 2020 2020  nwrap(.         
+00012e60: 2020 2072 6566 5f6c 616e 6570 6f69 6e74     ref_lanepoint
+00012e70: 735f 636f 6f72 6469 6e61 7465 735b 2268  s_coordinates["h
+00012e80: 6561 6469 6e67 7322 5d0a 2020 2020 2020  eadings"].      
+00012e90: 2020 290a 2020 2020 2020 2020 6669 7273    ).        firs
+00012ea0: 745f 6c70 5f68 6561 6469 6e67 203d 2072  t_lp_heading = r
+00012eb0: 6566 5f6c 616e 6570 6f69 6e74 735f 636f  ef_lanepoints_co
+00012ec0: 6f72 6469 6e61 7465 735b 2268 6561 6469  ordinates["headi
+00012ed0: 6e67 7322 5d5b 305d 0a20 2020 2020 2020  ngs"][0].       
+00012ee0: 206c 705f 706f 7369 7469 6f6e 203d 2070   lp_position = p
+00012ef0: 6174 685b 305d 2e6c 702e 706f 7365 2e70  ath[0].lp.pose.p
+00012f00: 6f69 6e74 2e61 735f 6e70 5f61 7272 6179  oint.as_np_array
+00012f10: 5b3a 325d 0a20 2020 2020 2020 2076 6568  [:2].        veh
+00012f20: 6963 6c65 5f70 6f73 203d 2070 6f69 6e74  icle_pos = point
+00012f30: 2e61 735f 6e70 5f61 7272 6179 5b3a 325d  .as_np_array[:2]
+00012f40: 0a20 2020 2020 2020 2068 6561 6469 6e67  .        heading
+00012f50: 5f76 6563 203d 2072 6164 6961 6e73 5f74  _vec = radians_t
+00012f60: 6f5f 7665 6328 6669 7273 745f 6c70 5f68  o_vec(first_lp_h
+00012f70: 6561 6469 6e67 290a 2020 2020 2020 2020  eading).        
+00012f80: 7072 6f6a 6563 7465 645f 6469 7374 616e  projected_distan
+00012f90: 745f 6c70 5f76 6568 6963 6c65 203d 206e  t_lp_vehicle = n
+00012fa0: 702e 696e 6e65 7228 0a20 2020 2020 2020  p.inner(.       
+00012fb0: 2020 2020 2028 7665 6869 636c 655f 706f       (vehicle_po
+00012fc0: 7320 2d20 6c70 5f70 6f73 6974 696f 6e29  s - lp_position)
+00012fd0: 2c20 6865 6164 696e 675f 7665 630a 2020  , heading_vec.  
+00012fe0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00012ff0: 2072 6566 5f6c 616e 6570 6f69 6e74 735f   ref_lanepoints_
+00013000: 636f 6f72 6469 6e61 7465 735b 2270 6f73  coordinates["pos
+00013010: 6974 696f 6e73 5f78 225d 5b30 5d20 3d20  itions_x"][0] = 
+00013020: 280a 2020 2020 2020 2020 2020 2020 6c70  (.            lp
+00013030: 5f70 6f73 6974 696f 6e5b 305d 202b 2070  _position[0] + p
+00013040: 726f 6a65 6374 6564 5f64 6973 7461 6e74  rojected_distant
+00013050: 5f6c 705f 7665 6869 636c 6520 2a20 6865  _lp_vehicle * he
+00013060: 6164 696e 675f 7665 635b 305d 0a20 2020  ading_vec[0].   
+00013070: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+00013080: 6566 5f6c 616e 6570 6f69 6e74 735f 636f  ef_lanepoints_co
+00013090: 6f72 6469 6e61 7465 735b 2270 6f73 6974  ordinates["posit
+000130a0: 696f 6e73 5f79 225d 5b30 5d20 3d20 280a  ions_y"][0] = (.
+000130b0: 2020 2020 2020 2020 2020 2020 6c70 5f70              lp_p
+000130c0: 6f73 6974 696f 6e5b 315d 202b 2070 726f  osition[1] + pro
+000130d0: 6a65 6374 6564 5f64 6973 7461 6e74 5f6c  jected_distant_l
+000130e0: 705f 7665 6869 636c 6520 2a20 6865 6164  p_vehicle * head
+000130f0: 696e 675f 7665 635b 315d 0a20 2020 2020  ing_vec[1].     
+00013100: 2020 2029 0a0a 2020 2020 2020 2020 6375     )..        cu
+00013110: 6d75 6c61 7469 7665 5f70 6174 685f 6469  mulative_path_di
+00013120: 7374 203d 206e 702e 6375 6d73 756d 280a  st = np.cumsum(.
+00013130: 2020 2020 2020 2020 2020 2020 6e70 2e73              np.s
+00013140: 7172 7428 0a20 2020 2020 2020 2020 2020  qrt(.           
+00013150: 2020 2020 206e 702e 6564 6966 6631 6428       np.ediff1d(
+00013160: 7265 665f 6c61 6e65 706f 696e 7473 5f63  ref_lanepoints_c
+00013170: 6f6f 7264 696e 6174 6573 5b22 706f 7369  oordinates["posi
+00013180: 7469 6f6e 735f 7822 5d2c 2074 6f5f 6265  tions_x"], to_be
+00013190: 6769 6e3d 3029 202a 2a20 320a 2020 2020  gin=0) ** 2.    
+000131a0: 2020 2020 2020 2020 2020 2020 2b20 6e70              + np
+000131b0: 2e65 6469 6666 3164 2872 6566 5f6c 616e  .ediff1d(ref_lan
+000131c0: 6570 6f69 6e74 735f 636f 6f72 6469 6e61  epoints_coordina
+000131d0: 7465 735b 2270 6f73 6974 696f 6e73 5f79  tes["positions_y
+000131e0: 225d 2c20 746f 5f62 6567 696e 3d30 2920  "], to_begin=0) 
+000131f0: 2a2a 2032 0a20 2020 2020 2020 2020 2020  ** 2.           
+00013200: 2029 0a20 2020 2020 2020 2029 0a0a 2020   ).        )..  
+00013210: 2020 2020 2020 6966 206c 656e 2863 756d        if len(cum
+00013220: 756c 6174 6976 655f 7061 7468 5f64 6973  ulative_path_dis
+00013230: 7429 203c 3d20 6c70 5f73 7061 6369 6e67  t) <= lp_spacing
+00013240: 3a0a 2020 2020 2020 2020 2020 2020 6c70  :.            lp
+00013250: 203d 2070 6174 685b 305d 2e6c 700a 0a20   = path[0].lp.. 
+00013260: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00013270: 6e20 5b0a 2020 2020 2020 2020 2020 2020  n [.            
+00013280: 2020 2020 5761 7970 6f69 6e74 280a 2020      Waypoint(.  
+00013290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000132a0: 2020 706f 733d 6c70 2e70 6f73 652e 706f    pos=lp.pose.po
+000132b0: 7369 7469 6f6e 5b3a 325d 2c0a 2020 2020  sition[:2],.    
+000132c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000132d0: 6865 6164 696e 673d 6c70 2e70 6f73 652e  heading=lp.pose.
+000132e0: 6865 6164 696e 672c 0a20 2020 2020 2020  heading,.       
+000132f0: 2020 2020 2020 2020 2020 2020 206c 616e               lan
+00013300: 655f 7769 6474 683d 6c70 2e6c 616e 652e  e_width=lp.lane.
+00013310: 7769 6474 685f 6174 5f6f 6666 7365 7428  width_at_offset(
+00013320: 3029 5b30 5d2c 0a20 2020 2020 2020 2020  0)[0],.         
+00013330: 2020 2020 2020 2020 2020 2073 7065 6564             speed
+00013340: 5f6c 696d 6974 3d6c 702e 6c61 6e65 2e73  _limit=lp.lane.s
+00013350: 7065 6564 5f6c 696d 6974 2c0a 2020 2020  peed_limit,.    
+00013360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013370: 6c61 6e65 5f69 643d 6c70 2e6c 616e 652e  lane_id=lp.lane.
+00013380: 6c61 6e65 5f69 642c 0a20 2020 2020 2020  lane_id,.       
+00013390: 2020 2020 2020 2020 2020 2020 206c 616e               lan
+000133a0: 655f 696e 6465 783d 6c70 2e6c 616e 652e  e_index=lp.lane.
+000133b0: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
+000133c0: 2020 2020 2020 2020 2020 206c 616e 655f             lane_
+000133d0: 6f66 6673 6574 3d6c 702e 6c61 6e65 2e6f  offset=lp.lane.o
+000133e0: 6666 7365 745f 616c 6f6e 675f 6c61 6e65  ffset_along_lane
+000133f0: 286c 702e 706f 7365 2e70 6f69 6e74 292c  (lp.pose.point),
+00013400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013410: 2029 0a20 2020 2020 2020 2020 2020 205d   ).            ]
+00013420: 0a0a 2020 2020 2020 2020 6576 656e 6c79  ..        evenly
+00013430: 5f73 7061 6365 645f 6375 6d75 6c61 7469  _spaced_cumulati
+00013440: 7665 5f70 6174 685f 6469 7374 203d 206e  ve_path_dist = n
+00013450: 702e 6c69 6e73 7061 6365 280a 2020 2020  p.linspace(.    
+00013460: 2020 2020 2020 2020 302c 2063 756d 756c          0, cumul
+00013470: 6174 6976 655f 7061 7468 5f64 6973 745b  ative_path_dist[
+00013480: 2d31 5d2c 206c 656e 2870 6174 6829 0a20  -1], len(path). 
+00013490: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+000134a0: 2020 6576 656e 6c79 5f73 7061 6365 645f    evenly_spaced_
+000134b0: 636f 6f72 6469 6e61 7465 7320 3d20 7b7d  coordinates = {}
+000134c0: 0a20 2020 2020 2020 2066 6f72 2076 6172  .        for var
+000134d0: 6961 626c 6520 696e 2063 6f6e 7469 6e75  iable in continu
+000134e0: 6f75 735f 7661 7269 6162 6c65 733a 0a20  ous_variables:. 
+000134f0: 2020 2020 2020 2020 2020 2065 7665 6e6c             evenl
+00013500: 795f 7370 6163 6564 5f63 6f6f 7264 696e  y_spaced_coordin
+00013510: 6174 6573 5b76 6172 6961 626c 655d 203d  ates[variable] =
+00013520: 206e 702e 696e 7465 7270 280a 2020 2020   np.interp(.    
+00013530: 2020 2020 2020 2020 2020 2020 6576 656e              even
+00013540: 6c79 5f73 7061 6365 645f 6375 6d75 6c61  ly_spaced_cumula
+00013550: 7469 7665 5f70 6174 685f 6469 7374 2c0a  tive_path_dist,.
+00013560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013570: 6375 6d75 6c61 7469 7665 5f70 6174 685f  cumulative_path_
+00013580: 6469 7374 2c0a 2020 2020 2020 2020 2020  dist,.          
+00013590: 2020 2020 2020 7265 665f 6c61 6e65 706f        ref_lanepo
+000135a0: 696e 7473 5f63 6f6f 7264 696e 6174 6573  ints_coordinates
+000135b0: 5b76 6172 6961 626c 655d 2c0a 2020 2020  [variable],.    
+000135c0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000135d0: 2020 2066 6f72 2076 6172 6961 626c 6520     for variable 
+000135e0: 696e 2064 6973 6372 6574 655f 7661 7269  in discrete_vari
+000135f0: 6162 6c65 733a 0a20 2020 2020 2020 2020  ables:.         
+00013600: 2020 2072 6566 5f63 6f6f 7264 696e 6174     ref_coordinat
+00013610: 6573 203d 2072 6566 5f6c 616e 6570 6f69  es = ref_lanepoi
+00013620: 6e74 735f 636f 6f72 6469 6e61 7465 735b  nts_coordinates[
+00013630: 7661 7269 6162 6c65 5d0a 2020 2020 2020  variable].      
+00013640: 2020 2020 2020 6576 656e 6c79 5f73 7061        evenly_spa
+00013650: 6365 645f 636f 6f72 6469 6e61 7465 735b  ced_coordinates[
+00013660: 7661 7269 6162 6c65 5d20 3d20 5b5d 0a20  variable] = []. 
+00013670: 2020 2020 2020 2020 2020 206a 6478 203d             jdx =
+00013680: 2030 0a20 2020 2020 2020 2020 2020 2066   0.            f
+00013690: 6f72 2069 6478 2069 6e20 7261 6e67 6528  or idx in range(
+000136a0: 6c65 6e28 7061 7468 2929 3a0a 2020 2020  len(path)):.    
+000136b0: 2020 2020 2020 2020 2020 2020 7768 696c              whil
+000136c0: 6520 280a 2020 2020 2020 2020 2020 2020  e (.            
+000136d0: 2020 2020 2020 2020 6a64 7820 2b20 3120          jdx + 1 
+000136e0: 3c20 6c65 6e28 6375 6d75 6c61 7469 7665  < len(cumulative
+000136f0: 5f70 6174 685f 6469 7374 290a 2020 2020  _path_dist).    
+00013700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013710: 616e 6420 6576 656e 6c79 5f73 7061 6365  and evenly_space
+00013720: 645f 6375 6d75 6c61 7469 7665 5f70 6174  d_cumulative_pat
+00013730: 685f 6469 7374 5b69 6478 5d0a 2020 2020  h_dist[idx].    
+00013740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013750: 3e20 6375 6d75 6c61 7469 7665 5f70 6174  > cumulative_pat
+00013760: 685f 6469 7374 5b6a 6478 202b 2031 5d0a  h_dist[jdx + 1].
 00013770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013780: 2020 203e 2063 756d 756c 6174 6976 655f     > cumulative_
-00013790: 7061 7468 5f64 6973 745b 6a64 7820 2b20  path_dist[jdx + 
-000137a0: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
-000137b0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-000137c0: 2020 2020 2020 2020 2020 6a64 7820 2b3d            jdx +=
-000137d0: 2031 0a0a 2020 2020 2020 2020 2020 2020   1..            
-000137e0: 2020 2020 6576 656e 6c79 5f73 7061 6365      evenly_space
-000137f0: 645f 636f 6f72 6469 6e61 7465 735b 7661  d_coordinates[va
-00013800: 7269 6162 6c65 5d2e 6170 7065 6e64 2872  riable].append(r
-00013810: 6566 5f63 6f6f 7264 696e 6174 6573 5b6a  ef_coordinates[j
-00013820: 6478 5d29 0a20 2020 2020 2020 2020 2020  dx]).           
-00013830: 2065 7665 6e6c 795f 7370 6163 6564 5f63   evenly_spaced_c
-00013840: 6f6f 7264 696e 6174 6573 5b76 6172 6961  oordinates[varia
-00013850: 626c 655d 2e61 7070 656e 6428 7265 665f  ble].append(ref_
-00013860: 636f 6f72 6469 6e61 7465 735b 2d31 5d29  coordinates[-1])
-00013870: 0a0a 2020 2020 2020 2020 7761 7970 6f69  ..        waypoi
-00013880: 6e74 5f70 6174 6820 3d20 5b5d 0a20 2020  nt_path = [].   
-00013890: 2020 2020 2066 6f72 2069 6478 2069 6e20       for idx in 
-000138a0: 7261 6e67 6528 6c65 6e28 7061 7468 2929  range(len(path))
-000138b0: 3a0a 2020 2020 2020 2020 2020 2020 7761  :.            wa
-000138c0: 7970 6f69 6e74 5f70 6174 682e 6170 7065  ypoint_path.appe
-000138d0: 6e64 280a 2020 2020 2020 2020 2020 2020  nd(.            
-000138e0: 2020 2020 5761 7970 6f69 6e74 280a 2020      Waypoint(.  
-000138f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013900: 2020 706f 733d 6e70 2e61 7272 6179 280a    pos=np.array(.
-00013910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013920: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-00013930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013940: 2020 2020 2020 6576 656e 6c79 5f73 7061        evenly_spa
-00013950: 6365 645f 636f 6f72 6469 6e61 7465 735b  ced_coordinates[
-00013960: 2270 6f73 6974 696f 6e73 5f78 225d 5b69  "positions_x"][i
-00013970: 6478 5d2c 0a20 2020 2020 2020 2020 2020  dx],.           
-00013980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013990: 2065 7665 6e6c 795f 7370 6163 6564 5f63   evenly_spaced_c
-000139a0: 6f6f 7264 696e 6174 6573 5b22 706f 7369  oordinates["posi
-000139b0: 7469 6f6e 735f 7922 5d5b 6964 785d 2c0a  tions_y"][idx],.
+00013780: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00013790: 2020 2020 2020 206a 6478 202b 3d20 310a         jdx += 1.
+000137a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000137b0: 2065 7665 6e6c 795f 7370 6163 6564 5f63   evenly_spaced_c
+000137c0: 6f6f 7264 696e 6174 6573 5b76 6172 6961  oordinates[varia
+000137d0: 626c 655d 2e61 7070 656e 6428 7265 665f  ble].append(ref_
+000137e0: 636f 6f72 6469 6e61 7465 735b 6a64 785d  coordinates[jdx]
+000137f0: 290a 2020 2020 2020 2020 2020 2020 6576  ).            ev
+00013800: 656e 6c79 5f73 7061 6365 645f 636f 6f72  enly_spaced_coor
+00013810: 6469 6e61 7465 735b 7661 7269 6162 6c65  dinates[variable
+00013820: 5d2e 6170 7065 6e64 2872 6566 5f63 6f6f  ].append(ref_coo
+00013830: 7264 696e 6174 6573 5b2d 315d 290a 0a20  rdinates[-1]).. 
+00013840: 2020 2020 2020 2077 6179 706f 696e 745f         waypoint_
+00013850: 7061 7468 203d 205b 5d0a 2020 2020 2020  path = [].      
+00013860: 2020 666f 7220 6964 7820 696e 2072 616e    for idx in ran
+00013870: 6765 286c 656e 2870 6174 6829 293a 0a20  ge(len(path)):. 
+00013880: 2020 2020 2020 2020 2020 2077 6179 706f             waypo
+00013890: 696e 745f 7061 7468 2e61 7070 656e 6428  int_path.append(
+000138a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000138b0: 2057 6179 706f 696e 7428 0a20 2020 2020   Waypoint(.     
+000138c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000138d0: 6f73 3d6e 702e 6172 7261 7928 0a20 2020  os=np.array(.   
+000138e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138f0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
+00013900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013910: 2020 2065 7665 6e6c 795f 7370 6163 6564     evenly_spaced
+00013920: 5f63 6f6f 7264 696e 6174 6573 5b22 706f  _coordinates["po
+00013930: 7369 7469 6f6e 735f 7822 5d5b 6964 785d  sitions_x"][idx]
+00013940: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013950: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+00013960: 656e 6c79 5f73 7061 6365 645f 636f 6f72  enly_spaced_coor
+00013970: 6469 6e61 7465 735b 2270 6f73 6974 696f  dinates["positio
+00013980: 6e73 5f79 225d 5b69 6478 5d2c 0a20 2020  ns_y"][idx],.   
+00013990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000139a0: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+000139b0: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
 000139c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139d0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-000139e0: 2020 2020 2020 2020 2020 2020 2020 292c                ),
-000139f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013a00: 2020 2020 2068 6561 6469 6e67 3d48 6561       heading=Hea
-00013a10: 6469 6e67 2865 7665 6e6c 795f 7370 6163  ding(evenly_spac
-00013a20: 6564 5f63 6f6f 7264 696e 6174 6573 5b22  ed_coordinates["
-00013a30: 6865 6164 696e 6773 225d 5b69 6478 5d29  headings"][idx])
-00013a40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013a50: 2020 2020 2020 6c61 6e65 5f77 6964 7468        lane_width
-00013a60: 3d65 7665 6e6c 795f 7370 6163 6564 5f63  =evenly_spaced_c
-00013a70: 6f6f 7264 696e 6174 6573 5b22 6c61 6e65  oordinates["lane
-00013a80: 5f77 6964 7468 225d 5b69 6478 5d2c 0a20  _width"][idx],. 
-00013a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013aa0: 2020 2073 7065 6564 5f6c 696d 6974 3d65     speed_limit=e
-00013ab0: 7665 6e6c 795f 7370 6163 6564 5f63 6f6f  venly_spaced_coo
-00013ac0: 7264 696e 6174 6573 5b22 7370 6565 645f  rdinates["speed_
-00013ad0: 6c69 6d69 7422 5d5b 6964 785d 2c0a 2020  limit"][idx],.  
-00013ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013af0: 2020 6c61 6e65 5f69 643d 6576 656e 6c79    lane_id=evenly
-00013b00: 5f73 7061 6365 645f 636f 6f72 6469 6e61  _spaced_coordina
-00013b10: 7465 735b 226c 616e 655f 6964 225d 5b69  tes["lane_id"][i
-00013b20: 6478 5d2c 0a20 2020 2020 2020 2020 2020  dx],.           
-00013b30: 2020 2020 2020 2020 206c 616e 655f 696e           lane_in
-00013b40: 6465 783d 6576 656e 6c79 5f73 7061 6365  dex=evenly_space
-00013b50: 645f 636f 6f72 6469 6e61 7465 735b 226c  d_coordinates["l
-00013b60: 616e 655f 696e 6465 7822 5d5b 6964 785d  ane_index"][idx]
-00013b70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013b80: 2020 2020 2020 6c61 6e65 5f6f 6666 7365        lane_offse
-00013b90: 743d 6576 656e 6c79 5f73 7061 6365 645f  t=evenly_spaced_
-00013ba0: 636f 6f72 6469 6e61 7465 735b 226c 616e  coordinates["lan
-00013bb0: 655f 6f66 6673 6574 225d 5b69 6478 5d2c  e_offset"][idx],
-00013bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013bd0: 2029 0a20 2020 2020 2020 2020 2020 2029   ).            )
-00013be0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00013bf0: 2077 6179 706f 696e 745f 7061 7468 0a0a   waypoint_path..
-00013c00: 2020 2020 6465 6620 5f77 6179 706f 696e      def _waypoin
-00013c10: 7473 5f73 7461 7274 696e 675f 6174 5f6c  ts_starting_at_l
-00013c20: 616e 6570 6f69 6e74 280a 2020 2020 2020  anepoint(.      
-00013c30: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00013c40: 6c61 6e65 706f 696e 743a 204c 696e 6b65  lanepoint: Linke
-00013c50: 644c 616e 6550 6f69 6e74 2c0a 2020 2020  dLanePoint,.    
-00013c60: 2020 2020 6c6f 6f6b 6168 6561 643a 2069      lookahead: i
-00013c70: 6e74 2c0a 2020 2020 2020 2020 6669 6c74  nt,.        filt
-00013c80: 6572 5f72 6f61 645f 6964 733a 2074 7570  er_road_ids: tup
-00013c90: 6c65 2c0a 2020 2020 2020 2020 706f 696e  le,.        poin
-00013ca0: 743a 2050 6f69 6e74 2c0a 2020 2020 2920  t: Point,.    ) 
-00013cb0: 2d3e 204c 6973 745b 4c69 7374 5b57 6179  -> List[List[Way
-00013cc0: 706f 696e 745d 5d3a 0a20 2020 2020 2020  point]]:.       
-00013cd0: 2022 2222 636f 6d70 7574 6573 2065 7175   """computes equ
-00013ce0: 616c 6c79 2d73 7061 6365 6420 5761 7970  ally-spaced Wayp
-00013cf0: 6f69 6e74 7320 666f 7220 616c 6c20 6c61  oints for all la
-00013d00: 6e65 2070 6174 6873 2073 7461 7274 696e  ne paths startin
-00013d10: 6720 6174 206c 616e 6570 6f69 6e74 0a20  g at lanepoint. 
-00013d20: 2020 2020 2020 2075 7020 746f 206c 6f6f         up to loo
-00013d30: 6b61 6865 6164 2077 6179 706f 696e 7473  kahead waypoints
-00013d40: 2061 6865 6164 2c20 636f 6e73 7472 6169   ahead, constrai
-00013d50: 6e65 6420 746f 2066 696c 7465 725f 726f  ned to filter_ro
-00013d60: 6164 5f69 6473 2069 6620 7370 6563 6966  ad_ids if specif
-00013d70: 6965 642e 2222 220a 0a20 2020 2020 2020  ied."""..       
-00013d80: 2023 2054 6865 2066 6f6c 6c6f 7769 6e67   # The following
-00013d90: 2061 6374 7320 736f 7274 206f 6620 6c69   acts sort of li
-00013da0: 6b65 206c 7275 5f63 6163 6865 2831 292c  ke lru_cache(1),
-00013db0: 2062 7574 2069 7420 616c 6c6f 7773 0a20   but it allows. 
-00013dc0: 2020 2020 2020 2023 2066 6f72 206c 6f6f         # for loo
-00013dd0: 6b61 6865 6164 2074 6f20 6265 203c 3d20  kahead to be <= 
-00013de0: 746f 2074 6865 2063 6163 6865 6420 7661  to the cached va
-00013df0: 6c75 652e 2e2e 0a20 2020 2020 2020 2063  lue....        c
-00013e00: 6163 6865 5f70 6174 6873 203d 2073 656c  ache_paths = sel
-00013e10: 662e 5f77 6179 706f 696e 7473 5f63 6163  f._waypoints_cac
-00013e20: 6865 2e71 7565 7279 280a 2020 2020 2020  he.query(.      
-00013e30: 2020 2020 2020 6c6f 6f6b 6168 6561 642c        lookahead,
-00013e40: 2070 6f69 6e74 2c20 6669 6c74 6572 5f72   point, filter_r
-00013e50: 6f61 645f 6964 732c 206c 616e 6570 6f69  oad_ids, lanepoi
-00013e60: 6e74 0a20 2020 2020 2020 2029 0a20 2020  nt.        ).   
-00013e70: 2020 2020 2069 6620 6361 6368 655f 7061       if cache_pa
-00013e80: 7468 733a 0a20 2020 2020 2020 2020 2020  ths:.           
-00013e90: 2072 6574 7572 6e20 6361 6368 655f 7061   return cache_pa
-00013ea0: 7468 730a 0a20 2020 2020 2020 206c 616e  ths..        lan
-00013eb0: 6570 6f69 6e74 5f70 6174 6873 203d 2073  epoint_paths = s
-00013ec0: 656c 662e 5f6c 616e 6570 6f69 6e74 732e  elf._lanepoints.
-00013ed0: 7061 7468 735f 7374 6172 7469 6e67 5f61  paths_starting_a
-00013ee0: 745f 6c61 6e65 706f 696e 7428 0a20 2020  t_lanepoint(.   
-00013ef0: 2020 2020 2020 2020 206c 616e 6570 6f69           lanepoi
-00013f00: 6e74 2c20 6c6f 6f6b 6168 6561 642c 2066  nt, lookahead, f
-00013f10: 696c 7465 725f 726f 6164 5f69 6473 0a20  ilter_road_ids. 
-00013f20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00013f30: 2072 6573 756c 7420 3d20 5b0a 2020 2020   result = [.    
-00013f40: 2020 2020 2020 2020 5761 796d 6f4d 6170          WaymoMap
-00013f50: 2e5f 6571 7561 6c6c 795f 7370 6163 6564  ._equally_spaced
-00013f60: 5f70 6174 6828 0a20 2020 2020 2020 2020  _path(.         
-00013f70: 2020 2020 2020 2070 6174 682c 0a20 2020         path,.   
-00013f80: 2020 2020 2020 2020 2020 2020 2070 6f69               poi
-00013f90: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-00013fa0: 2020 2020 7365 6c66 2e5f 6d61 705f 7370      self._map_sp
-00013fb0: 6563 2e6c 616e 6570 6f69 6e74 5f73 7061  ec.lanepoint_spa
-00013fc0: 6369 6e67 2c0a 2020 2020 2020 2020 2020  cing,.          
-00013fd0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00013fe0: 666f 7220 7061 7468 2069 6e20 6c61 6e65  for path in lane
-00013ff0: 706f 696e 745f 7061 7468 730a 2020 2020  point_paths.    
-00014000: 2020 2020 5d0a 0a20 2020 2020 2020 2073      ]..        s
-00014010: 656c 662e 5f77 6179 706f 696e 7473 5f63  elf._waypoints_c
-00014020: 6163 6865 2e75 7064 6174 6528 0a20 2020  ache.update(.   
-00014030: 2020 2020 2020 2020 206c 6f6f 6b61 6865           lookahe
-00014040: 6164 2c20 706f 696e 742c 2066 696c 7465  ad, point, filte
-00014050: 725f 726f 6164 5f69 6473 2c20 6c61 6e65  r_road_ids, lane
-00014060: 706f 696e 742c 2072 6573 756c 740a 2020  point, result.  
-00014070: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00014080: 2072 6574 7572 6e20 7265 7375 6c74 0a     return result.
+000139d0: 2020 6865 6164 696e 673d 4865 6164 696e    heading=Headin
+000139e0: 6728 6576 656e 6c79 5f73 7061 6365 645f  g(evenly_spaced_
+000139f0: 636f 6f72 6469 6e61 7465 735b 2268 6561  coordinates["hea
+00013a00: 6469 6e67 7322 5d5b 6964 785d 292c 0a20  dings"][idx]),. 
+00013a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a20: 2020 206c 616e 655f 7769 6474 683d 6576     lane_width=ev
+00013a30: 656e 6c79 5f73 7061 6365 645f 636f 6f72  enly_spaced_coor
+00013a40: 6469 6e61 7465 735b 226c 616e 655f 7769  dinates["lane_wi
+00013a50: 6474 6822 5d5b 6964 785d 2c0a 2020 2020  dth"][idx],.    
+00013a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a70: 7370 6565 645f 6c69 6d69 743d 6576 656e  speed_limit=even
+00013a80: 6c79 5f73 7061 6365 645f 636f 6f72 6469  ly_spaced_coordi
+00013a90: 6e61 7465 735b 2273 7065 6564 5f6c 696d  nates["speed_lim
+00013aa0: 6974 225d 5b69 6478 5d2c 0a20 2020 2020  it"][idx],.     
+00013ab0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00013ac0: 616e 655f 6964 3d65 7665 6e6c 795f 7370  ane_id=evenly_sp
+00013ad0: 6163 6564 5f63 6f6f 7264 696e 6174 6573  aced_coordinates
+00013ae0: 5b22 6c61 6e65 5f69 6422 5d5b 6964 785d  ["lane_id"][idx]
+00013af0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013b00: 2020 2020 2020 6c61 6e65 5f69 6e64 6578        lane_index
+00013b10: 3d65 7665 6e6c 795f 7370 6163 6564 5f63  =evenly_spaced_c
+00013b20: 6f6f 7264 696e 6174 6573 5b22 6c61 6e65  oordinates["lane
+00013b30: 5f69 6e64 6578 225d 5b69 6478 5d2c 0a20  _index"][idx],. 
+00013b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013b50: 2020 206c 616e 655f 6f66 6673 6574 3d65     lane_offset=e
+00013b60: 7665 6e6c 795f 7370 6163 6564 5f63 6f6f  venly_spaced_coo
+00013b70: 7264 696e 6174 6573 5b22 6c61 6e65 5f6f  rdinates["lane_o
+00013b80: 6666 7365 7422 5d5b 6964 785d 2c0a 2020  ffset"][idx],.  
+00013b90: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00013ba0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00013bb0: 2020 2020 2020 2072 6574 7572 6e20 7761         return wa
+00013bc0: 7970 6f69 6e74 5f70 6174 680a 0a20 2020  ypoint_path..   
+00013bd0: 2064 6566 205f 7761 7970 6f69 6e74 735f   def _waypoints_
+00013be0: 7374 6172 7469 6e67 5f61 745f 6c61 6e65  starting_at_lane
+00013bf0: 706f 696e 7428 0a20 2020 2020 2020 2073  point(.        s
+00013c00: 656c 662c 0a20 2020 2020 2020 206c 616e  elf,.        lan
+00013c10: 6570 6f69 6e74 3a20 4c69 6e6b 6564 4c61  epoint: LinkedLa
+00013c20: 6e65 506f 696e 742c 0a20 2020 2020 2020  nePoint,.       
+00013c30: 206c 6f6f 6b61 6865 6164 3a20 696e 742c   lookahead: int,
+00013c40: 0a20 2020 2020 2020 2066 696c 7465 725f  .        filter_
+00013c50: 726f 6164 5f69 6473 3a20 7475 706c 652c  road_ids: tuple,
+00013c60: 0a20 2020 2020 2020 2070 6f69 6e74 3a20  .        point: 
+00013c70: 506f 696e 742c 0a20 2020 2029 202d 3e20  Point,.    ) -> 
+00013c80: 4c69 7374 5b4c 6973 745b 5761 7970 6f69  List[List[Waypoi
+00013c90: 6e74 5d5d 3a0a 2020 2020 2020 2020 2222  nt]]:.        ""
+00013ca0: 2263 6f6d 7075 7465 7320 6571 7561 6c6c  "computes equall
+00013cb0: 792d 7370 6163 6564 2057 6179 706f 696e  y-spaced Waypoin
+00013cc0: 7473 2066 6f72 2061 6c6c 206c 616e 6520  ts for all lane 
+00013cd0: 7061 7468 7320 7374 6172 7469 6e67 2061  paths starting a
+00013ce0: 7420 6c61 6e65 706f 696e 740a 2020 2020  t lanepoint.    
+00013cf0: 2020 2020 7570 2074 6f20 6c6f 6f6b 6168      up to lookah
+00013d00: 6561 6420 7761 7970 6f69 6e74 7320 6168  ead waypoints ah
+00013d10: 6561 642c 2063 6f6e 7374 7261 696e 6564  ead, constrained
+00013d20: 2074 6f20 6669 6c74 6572 5f72 6f61 645f   to filter_road_
+00013d30: 6964 7320 6966 2073 7065 6369 6669 6564  ids if specified
+00013d40: 2e22 2222 0a0a 2020 2020 2020 2020 2320  ."""..        # 
+00013d50: 5468 6520 666f 6c6c 6f77 696e 6720 6163  The following ac
+00013d60: 7473 2073 6f72 7420 6f66 206c 696b 6520  ts sort of like 
+00013d70: 6c72 755f 6361 6368 6528 3129 2c20 6275  lru_cache(1), bu
+00013d80: 7420 6974 2061 6c6c 6f77 730a 2020 2020  t it allows.    
+00013d90: 2020 2020 2320 666f 7220 6c6f 6f6b 6168      # for lookah
+00013da0: 6561 6420 746f 2062 6520 3c3d 2074 6f20  ead to be <= to 
+00013db0: 7468 6520 6361 6368 6564 2076 616c 7565  the cached value
+00013dc0: 2e2e 2e0a 2020 2020 2020 2020 6361 6368  ....        cach
+00013dd0: 655f 7061 7468 7320 3d20 7365 6c66 2e5f  e_paths = self._
+00013de0: 7761 7970 6f69 6e74 735f 6361 6368 652e  waypoints_cache.
+00013df0: 7175 6572 7928 0a20 2020 2020 2020 2020  query(.         
+00013e00: 2020 206c 6f6f 6b61 6865 6164 2c20 706f     lookahead, po
+00013e10: 696e 742c 2066 696c 7465 725f 726f 6164  int, filter_road
+00013e20: 5f69 6473 2c20 6c61 6e65 706f 696e 740a  _ids, lanepoint.
+00013e30: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00013e40: 2020 6966 2063 6163 6865 5f70 6174 6873    if cache_paths
+00013e50: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00013e60: 7475 726e 2063 6163 6865 5f70 6174 6873  turn cache_paths
+00013e70: 0a0a 2020 2020 2020 2020 6c61 6e65 706f  ..        lanepo
+00013e80: 696e 745f 7061 7468 7320 3d20 7365 6c66  int_paths = self
+00013e90: 2e5f 6c61 6e65 706f 696e 7473 2e70 6174  ._lanepoints.pat
+00013ea0: 6873 5f73 7461 7274 696e 675f 6174 5f6c  hs_starting_at_l
+00013eb0: 616e 6570 6f69 6e74 280a 2020 2020 2020  anepoint(.      
+00013ec0: 2020 2020 2020 6c61 6e65 706f 696e 742c        lanepoint,
+00013ed0: 206c 6f6f 6b61 6865 6164 2c20 6669 6c74   lookahead, filt
+00013ee0: 6572 5f72 6f61 645f 6964 730a 2020 2020  er_road_ids.    
+00013ef0: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+00013f00: 7375 6c74 203d 205b 0a20 2020 2020 2020  sult = [.       
+00013f10: 2020 2020 2057 6179 6d6f 4d61 702e 5f65       WaymoMap._e
+00013f20: 7175 616c 6c79 5f73 7061 6365 645f 7061  qually_spaced_pa
+00013f30: 7468 280a 2020 2020 2020 2020 2020 2020  th(.            
+00013f40: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
+00013f50: 2020 2020 2020 2020 2020 706f 696e 742c            point,
+00013f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013f70: 2073 656c 662e 5f6d 6170 5f73 7065 632e   self._map_spec.
+00013f80: 6c61 6e65 706f 696e 745f 7370 6163 696e  lanepoint_spacin
+00013f90: 672c 0a20 2020 2020 2020 2020 2020 2029  g,.            )
+00013fa0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00013fb0: 2070 6174 6820 696e 206c 616e 6570 6f69   path in lanepoi
+00013fc0: 6e74 5f70 6174 6873 0a20 2020 2020 2020  nt_paths.       
+00013fd0: 205d 0a0a 2020 2020 2020 2020 7365 6c66   ]..        self
+00013fe0: 2e5f 7761 7970 6f69 6e74 735f 6361 6368  ._waypoints_cach
+00013ff0: 652e 7570 6461 7465 280a 2020 2020 2020  e.update(.      
+00014000: 2020 2020 2020 6c6f 6f6b 6168 6561 642c        lookahead,
+00014010: 2070 6f69 6e74 2c20 6669 6c74 6572 5f72   point, filter_r
+00014020: 6f61 645f 6964 732c 206c 616e 6570 6f69  oad_ids, lanepoi
+00014030: 6e74 2c20 7265 7375 6c74 0a20 2020 2020  nt, result.     
+00014040: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
+00014050: 7475 726e 2072 6573 756c 740a            turn result.
```

## smarts/core/controllers/lane_following_controller.py

```diff
@@ -16,15 +16,14 @@
 # AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 # LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 # OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 # THE SOFTWARE.
 import math
 
 import numpy as np
-from scipy import signal
 
 from smarts.core.chassis import AckermannChassis
 from smarts.core.controllers.trajectory_tracking_controller import (
     TrajectoryTrackingController,
 )
 from smarts.core.utils.math import lerp, low_pass_filter, min_angles_difference_signed
 
@@ -241,21 +240,14 @@
             sim, state, vehicle, desired_poles, target_speed
         )
         # LOOK AHEAD CONTROLLER
         controller_lat_error = wp_path[look_ahead_wp_num].signed_lateral_error(
             vehicle_look_ahead_pt
         )
 
-        abs_heading_error = min(
-            abs((vehicle.heading % (2 * math.pi)) - reference_heading),
-            abs(
-                2 * math.pi - abs((vehicle.heading % (2 * math.pi)) - reference_heading)
-            ),
-        )
-
         curvature_radius = TrajectoryTrackingController.curvature_calculation(
             trajectory
         )
         brake_norm = 0
         if raw_throttle < 0:
             brake_norm = np.clip(-raw_throttle, 0, 1)
             throttle_norm = 0
@@ -373,14 +365,39 @@
         relative_distant_lane = [
             np.linalg.norm(wp_paths[idx][0].pos - vehicle_position[0:2])
             for idx in range(len(wp_paths))
         ]
         return np.argmin(relative_distant_lane)
 
     @staticmethod
+    def place_poles(A: np.ndarray, B: np.ndarray, poles: np.ndarray) -> np.ndarray:
+        """Given a linear system described by ẋ = Ax + Bu, compute the gain matrix K
+        such that the closed loop eigenvalues of A - BK are in the desired pole locations.
+
+        References:
+         - https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.place_poles.html
+         - https://en.wikipedia.org/wiki/Ackermann%27s_formula
+        """
+
+        # Controllability matrix
+        C = np.hstack(
+            [B] + [np.linalg.matrix_power(A, i) @ B for i in range(1, A.shape[0])]
+        )
+
+        # Desired characteristic polynomial of A - BK
+        poly = np.real(np.poly(poles))
+
+        # Solve using Ackermann's formula
+        n = np.size(poly)
+        p = poly[n - 1] * np.linalg.matrix_power(A, 0)
+        for i in np.arange(1, n):
+            p = p + poly[n - i - 1] * np.linalg.matrix_power(A, i)
+        return np.linalg.solve(C, p)[-1][:]
+
+    @staticmethod
     def calculate_lateral_gains(sim, state, vehicle, desired_poles, target_speed):
         """Update the state lateral gains"""
         # Only calculate gains if the target_speed is updated.
         # TODO: Replace this w/ an isclose(...) check
         if state.target_speed == target_speed:
             return
 
@@ -416,26 +433,23 @@
                 [
                     [0],
                     [0],
                     [half_vehicle_len * road_stiffness / vehicle_inertia_z],
                     [road_stiffness / (vehicle_mass * target_speed)],
                 ]
             )
-            fsf1 = signal.place_poles(
-                state_matrix, input_matrix, desired_poles, method="KNV0"
+            K = LaneFollowingController.place_poles(
+                state_matrix, input_matrix, desired_poles
             )
-            # 0.01 and 0.015 denote the max and min gains for heading controller
-            # This is done to ensure that the linearization error will not affect
-            # the stability of the controller.
-            state.heading_error_gain = np.clip(fsf1.gain_matrix[0][1], 0.02, 0.04)
-            # 3.4 and 4.1 denote the max and min gains for lateral error controller
-            # As for heading, this is done to ensure that the linearization error
-            # will not affect the stability and performance of the controller.
-            state.lateral_error_gain = np.clip(fsf1.gain_matrix[0][0], 3.4, 4.1)
 
+            # These constants are the min/max gains for the lateral error controller
+            # and the heading controller, respectively. This is done to ensure that
+            # the linearization error will not affect the stability of the controller.
+            state.lateral_error_gain = np.clip(K[0], 3.4, 4.1)
+            state.heading_error_gain = np.clip(K[1], 0.02, 0.04)
         else:
             # 0.01 and 0.36 are initial values for heading and lateral gains
             # This is only done to ensure that the vehicle starts to move for
             # the first time step where speed=0
             state.heading_error_gain = 0.01
             state.lateral_error_gain = 0.36
```

### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

## smarts/core/utils/pybullet.py

```diff
@@ -21,15 +21,15 @@
 import inspect
 
 from smarts.core.utils.logging import suppress_output
 
 # XXX: Importing pybullet logs an annoying build version tag. There's no "friendly"
 #      way to fix this since they simply use print(...). Disabling logging at the
 #      time of import is our hack.
-with suppress_output(stderr=False):
+with suppress_output():
     from pybullet import *
     from pybullet_utils import bullet_client
 
 
 class SafeBulletClient(bullet_client.BulletClient):
     """A wrapper for pybullet to manage different clients."""
```

## smarts/env/__init__.py

```diff
@@ -14,16 +14,9 @@
 # IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 # FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
 # AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 # LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 # OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 # THE SOFTWARE.
 
-from gym.envs.registration import register
-
-register(
-    id="hiway-v0",
-    entry_point="smarts.env.hiway_env:HiWayEnv",
-)
-
 # Do NOT remove.
 import smarts.env.gymnasium
```

## smarts/env/custom_observations.py

```diff
@@ -14,21 +14,22 @@
 # IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 # FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
 # AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 # LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 # OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 # THE SOFTWARE.
 from dataclasses import dataclass
-from typing import Callable, Dict
+from typing import Callable, Dict, List, Union
 
 import gymnasium as gym
 import numpy as np
 
 from smarts.core.coordinates import Heading
-from smarts.core.observations import Observation
+from smarts.core.observations import EgoVehicleObservation, Observation
+from smarts.core.road_map import Waypoint
 from smarts.core.utils.math import squared_dist, vec_2d, vec_to_radians
 
 
 @dataclass
 class Adapter:
     """An adapter for pairing an action/observation transformation method with its gym
     space representation.
@@ -139,15 +140,25 @@
         "steering": gym.spaces.Box(low=-1e10, high=1e10, shape=(1,)),
         "ego_lane_dist": gym.spaces.Box(low=-1e10, high=1e10, shape=(3,)),
         "ego_ttc": gym.spaces.Box(low=-1e10, high=1e10, shape=(3,)),
     }
 )
 
 
-def lane_ttc(obs: Observation) -> Dict[str, np.ndarray]:
+@dataclass
+class _VehicleState:
+    speed: np.ndarray
+    position: np.ndarray
+    lane_index: int
+    heading: float
+    lane_id: str
+    steering: float
+
+
+def lane_ttc(obs: Union[Observation, Dict]) -> Dict[str, np.ndarray]:
     """Computes time-to-collision (TTC) and distance-to-collision (DTC) using
     the given agent's observation. TTC and DTC are numpy arrays of shape (3,)
     with values for the right lane (at index [0]), current lane (at index [1]),
     and left lane (at index [2]).
 
     Args:
         obs (Observation): Agent observation.
@@ -158,26 +169,85 @@
         + distance_from_center: Distance to lane center. Shape=(1,).
         + angle_error: Ego heading relative to the closest waypoint. Shape=(1,).
         + speed: Ego speed. Shape=(1,).
         + steering: Ego steering. Shape=(1,).
         + :spelling:ignore:`ego_ttc`: Time to collision in each lane. Shape=(3,).
         + ego_lane_dist: Closest cars’ distance to ego in each lane. Shape=(3,).
     """
-    ego = obs.ego_vehicle_state
-    waypoint_paths = obs.waypoint_paths
-    wps = [path[0] for path in waypoint_paths]
+
+    if isinstance(obs, Observation):
+        ego = obs.ego_vehicle_state
+        waypoint_paths = obs.waypoint_paths
+        wps = [path[0] for path in waypoint_paths]
+        neighborhood_vehicle_states = obs.neighborhood_vehicle_states
+
+    elif isinstance(obs, dict):
+        waypoint_paths = obs["waypoint_paths"]
+        waypoint_paths = [
+            [
+                Waypoint(
+                    position[:2],
+                    Heading(heading),
+                    lane_id,
+                    lane_width,
+                    speed_limit,
+                    lane_index,
+                    np.nan,
+                )
+                for position, heading, lane_id, lane_width, speed_limit, lane_index in zip(
+                    waypoint_paths["position"][i],
+                    waypoint_paths["heading"][i],
+                    waypoint_paths["lane_id"][i],
+                    waypoint_paths["lane_width"][i],
+                    waypoint_paths["speed_limit"][i],
+                    waypoint_paths["lane_index"][i],
+                )
+            ]
+            for i in range(4)
+        ]
+        wps = [path[0] for path in waypoint_paths]
+
+        evs = obs["ego_vehicle_state"]
+        ego = _VehicleState(
+            speed=evs["speed"],
+            position=evs["position"],
+            lane_index=evs["lane_index"],
+            heading=Heading(evs["heading"]),
+            lane_id=evs["lane_id"],
+            steering=evs["steering"],
+        )
+        neighborhood_vehicle_states_dict = obs["neighborhood_vehicle_states"]
+        neighborhood_vehicle_states = [
+            _VehicleState(
+                position=position,
+                heading=heading,
+                speed=speed,
+                lane_id=lane_id,
+                lane_index=lane_index,
+                steering=np.nan,
+            )
+            for position, heading, speed, lane_id, lane_index in zip(
+                neighborhood_vehicle_states_dict["position"],
+                neighborhood_vehicle_states_dict["heading"],
+                neighborhood_vehicle_states_dict["speed"],
+                neighborhood_vehicle_states_dict["lane_id"],
+                neighborhood_vehicle_states_dict["lane_index"],
+            )
+        ]
+    else:
+        raise NotImplementedError("Cannot generate using given observations")
 
     # distance of vehicle from center of lane
     closest_wp = min(wps, key=lambda wp: wp.dist_to(ego.position))
     signed_dist_from_center = closest_wp.signed_lateral_error(ego.position)
-    lane_hwidth = closest_wp.lane_width * 0.5
-    norm_dist_from_center = signed_dist_from_center / lane_hwidth
-
-    ego_ttc, ego_lane_dist = _ego_ttc_lane_dist(obs, closest_wp.lane_index)
-
+    lane_half_width = closest_wp.lane_width * 0.5
+    norm_dist_from_center = signed_dist_from_center / lane_half_width
+    ego_ttc, ego_lane_dist = _ego_ttc_lane_dist(
+        ego, neighborhood_vehicle_states, waypoint_paths, closest_wp.lane_index
+    )
     return {
         "distance_from_center": np.array([norm_dist_from_center]),
         "angle_error": np.array([closest_wp.relative_heading(ego.heading)]),
         "speed": np.array([ego.speed]),
         "steering": np.array([ego.steering]),
         "ego_ttc": np.array(ego_ttc),
         "ego_lane_dist": np.array(ego_lane_dist),
@@ -185,24 +255,33 @@
 
 
 lane_ttc_observation_adapter = Adapter(
     space=_LANE_TTC_OBSERVATION_SPACE, transform=lane_ttc
 )
 
 
-def _ego_ttc_lane_dist(obs: Observation, ego_lane_index: int):
-    ttc_by_p, lane_dist_by_p = _ttc_by_path(obs)
+def _ego_ttc_lane_dist(
+    ego_state: _VehicleState,
+    neighborhood_vehicle_states,
+    waypoint_paths,
+    ego_lane_index: int,
+):
+    ttc_by_p, lane_dist_by_p = _ttc_by_path(
+        ego_state, neighborhood_vehicle_states, waypoint_paths
+    )
 
     return _ego_ttc_calc(ego_lane_index, ttc_by_p, lane_dist_by_p)
 
 
-def _ttc_by_path(obs: Observation):
-    ego = obs.ego_vehicle_state
-    waypoint_paths = obs.waypoint_paths
-    neighborhood_vehicle_states = obs.neighborhood_vehicle_states
+def _ttc_by_path(
+    ego: _VehicleState,
+    neighborhood_vehicle_states,
+    waypoint_paths: List[List[Waypoint]],
+):
+    neighborhood_vehicle_states = neighborhood_vehicle_states
 
     # first sum up the distance between waypoints along a path
     # ie. [(wp1, path1, 0),
     #      (wp2, path1, 0 + dist(wp1, wp2)),
     #      (wp3, path1, 0 + dist(wp1, wp2) + dist(wp2, wp3))]
 
     wps_with_lane_dist = []
```

## smarts/env/rllib_hiway_env.py

```diff
@@ -16,23 +16,30 @@
 # AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 # LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 # OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 # THE SOFTWARE.
 import logging
 import warnings
 from pathlib import Path
+from typing import Dict
 
 from ray.rllib.env.multi_agent_env import MultiAgentEnv
 
 import smarts
 from envision import types as envision_types
 from envision.client import Client as Envision
 from smarts.core.local_traffic_provider import LocalTrafficProvider
 from smarts.core.scenario import Scenario
 from smarts.core.smarts import SMARTS
+from smarts.env.utils.action_conversion import ActionOptions, ActionSpacesFormatter
+from smarts.env.utils.observation_conversion import (
+    ObservationOptions,
+    ObservationSpacesFormatter,
+)
+from smarts.zoo.agent_spec import AgentSpec
 
 
 class RLlibHiWayEnv(MultiAgentEnv):
     """This environment serves as a format to run multiple environments in
     parallel. This environment requires a specific configuration.
 
     Args:
@@ -60,28 +67,62 @@
 
             sumo_port: Specifies sumo port. Defaults to None.
 
             fixed_timestep_sec: Step length for all components of the simulation. Defaults to 0.1 .
     """
 
     def __init__(self, config):
-        self._log = logging.getLogger(self.__class__.__name__)
+        super().__init__()
+
+        self._agent_specs: Dict[str, AgentSpec] = config["agent_specs"]
+        agent_interfaces = {
+            a_id: spec.interface for a_id, spec in self._agent_specs.items()
+        }
+
+        ## ---- Required environment attributes ----
+        ## See ray/rllib/env/multi_agent_env.py
+        self._agent_ids.update(id_ for id_ in self._agent_specs)
+
+        action_options = ActionOptions.multi_agent
+        self._action_formatter = ActionSpacesFormatter(
+            agent_interfaces=agent_interfaces, action_options=action_options
+        )
+        self.action_space = self._action_formatter.space
+        assert self.action_space is not None
+
+        observation_options = ObservationOptions.multi_agent
+        self._observations_formatter = ObservationSpacesFormatter(
+            agent_interfaces=agent_interfaces, observation_options=observation_options
+        )
+        self.observation_space = self._observations_formatter.space
+        assert self.observation_space is not None
+
+        self._action_space_in_preferred_format = (
+            self._check_if_action_space_maps_agent_id_to_sub_space()
+        )
+        self._obs_space_in_preferred_format = (
+            self._check_if_obs_space_maps_agent_id_to_sub_space()
+        )
+        assert self._action_space_in_preferred_format is True
+        ## ---- /Required environment attributes ----
+
+        self._log = logging.getLogger(name=self.__class__.__name__)
         seed = int(config.get("seed", 42))
 
         # See https://docs.ray.io/en/latest/rllib-env.html#configuring-environments
         # for context. We combine worker_index and vector_index through the Cantor pairing
         # function (https://en.wikipedia.org/wiki/Pairing_function) into a unique integer
         # and then add that to seed to both differentiate environment instances and
         # preserve determinism.
         a = config.worker_index
         b = config.vector_index
         c = (a + b) * (a + b + 1) // 2 + b
-        smarts.core.seed(seed + c)
+        self._seed = seed + c
+        smarts.core.seed(self._seed + c)
 
-        self._agent_specs = config["agent_specs"]
         self._scenarios = [
             str(Path(scenario).resolve()) for scenario in config["scenarios"]
         ]
         self._scenarios_iterator = Scenario.scenario_variations(
             self._scenarios,
             list(self._agent_specs.keys()),
         )
@@ -120,81 +161,112 @@
             for agent_id, action in agent_actions.items()
         }
 
         assert isinstance(agent_actions, dict) and all(
             isinstance(key, str) for key in agent_actions.keys()
         ), "Expected Dict[str, any]"
 
-        observations, rewards, dones, extras = self._smarts.step(agent_actions)
+        formatted_actions = self._action_formatter.format(agent_actions)
+        env_observations, rewards, dones, extras = self._smarts.step(formatted_actions)
+        env_observations = self._observations_formatter.format(env_observations)
 
         # Agent termination: RLlib expects that we return a "last observation"
         # on the step that an agent transitions to "done". All subsequent calls
         # to env.step(..) will no longer contain actions from the "done" agent.
         #
         # The way we implement this behavior here is to rely on the presence of
         # agent actions to filter out all environment observations/rewards/infos
         # to only agents who are actively sending in actions.
         observations = {
             agent_id: obs
-            for agent_id, obs in observations.items()
-            if agent_id in agent_actions
+            for agent_id, obs in env_observations.items()
+            if agent_id in formatted_actions
         }
         rewards = {
             agent_id: reward
             for agent_id, reward in rewards.items()
-            if agent_id in agent_actions
+            if agent_id in formatted_actions
         }
         scores = {
             agent_id: score
             for agent_id, score in extras["scores"].items()
-            if agent_id in agent_actions
+            if agent_id in formatted_actions
         }
 
-        infos = {key: {"score": value} for key, value in scores.items()}
+        infos = {
+            agent_id: {
+                "score": value,
+                "reward": rewards[agent_id],
+                "speed": observations[agent_id]["ego_vehicle_state"]["speed"],
+            }
+            for agent_id, value in scores.items()
+        }
 
         # Ensure all contain the same agent_ids as keys
         assert (
             agent_actions.keys()
             == observations.keys()
             == rewards.keys()
             == infos.keys()
         )
         for agent_id in agent_actions:
             agent_spec = self._agent_specs[agent_id]
-            observation = observations[agent_id]
+            observation = env_observations[agent_id]
             reward = rewards[agent_id]
             info = infos[agent_id]
 
             observations[agent_id] = agent_spec.observation_adapter(observation)
             rewards[agent_id] = agent_spec.reward_adapter(observation, reward)
             infos[agent_id] = agent_spec.info_adapter(observation, reward, info)
 
         for done in dones.values():
             self._dones_registered += 1 if done else 0
         dones["__all__"] = self._dones_registered >= len(self._agent_specs)
 
-        return observations, rewards, dones, infos
+        return (
+            observations,
+            rewards,
+            dones,
+            dones,
+            infos,
+        )
 
-    def reset(self):
+    def reset(self, *, seed=None, options=None):
         """Environment reset."""
+        if seed not in (None, 0):
+            smarts.core.seed(self._seed + (seed or 0))
+
         scenario = next(self._scenarios_iterator)
 
         self._dones_registered = 0
         if self._smarts is None:
             self._smarts = self._build_smarts()
-            self._smarts.setup(scenario)
+            self._smarts.setup(scenario=scenario)
 
-        env_observations = self._smarts.reset(scenario)
+        env_observations = self._smarts.reset(scenario=scenario)
 
+        env_observations = self._observations_formatter.format(
+            observations=env_observations
+        )
         observations = {
             agent_id: self._agent_specs[agent_id].observation_adapter(obs)
             for agent_id, obs in env_observations.items()
         }
+        info = {
+            agent_id: {
+                "score": 0,
+                "reward": 0,
+                "env_obs": agent_obs,
+                "done": False,
+                "map_source": self._smarts.scenario.road_map.source,
+            }
+            for agent_id, agent_obs in observations.items()
+        }
 
-        return observations
+        return observations, info
 
     def close(self):
         """Environment close."""
         if self._smarts is not None:
             self._smarts.destroy()
 
     def _build_smarts(self):
```

## smarts/env/gymnasium/hiway_env_v1.py

```diff
@@ -35,15 +35,15 @@
     SupportsFloat,
     Tuple,
     Union,
 )
 
 import gymnasium as gym
 import numpy as np
-from gym import spaces
+from gymnasium import spaces
 from gymnasium.core import ActType, ObsType
 from gymnasium.envs.registration import EnvSpec
 
 from envision import types as envision_types
 from envision.client import Client as Envision
 from envision.data_formatter import EnvisionDataFormatterArgs
 from smarts.core import current_seed
```

## smarts/env/gymnasium/wrappers/single_agent.py

```diff
@@ -65,15 +65,15 @@
             obs[self._agent_id],
             reward[self._agent_id],
             terminated[self._agent_id],
             truncated[self._agent_id],
             info[self._agent_id],
         )
 
-    def reset(self) -> Tuple[Any, Any]:
+    def reset(self, *, seed=None, options=None) -> Tuple[Any, Any]:
         """Resets a single-agent SMARTS environment.
 
         Returns:
             Tuple[Any, Any]: Agent's observation and info
         """
-        obs, info = self.env.reset()
+        obs, info = self.env.reset(seed=seed, options=options)
         return obs[self._agent_id], info[self._agent_id]
```

## smarts/env/utils/action_conversion.py

```diff
@@ -242,17 +242,18 @@
         out_actions = {}
         formatting_groups = _get_formats()
         for agent_id, action in actions.items():
             agent_interface = self._agent_interfaces[agent_id]
             format_ = formatting_groups[agent_interface.action]
             space: gym.Space = self.space[agent_id]
             assert space is format_.space
+            dtype = action.dtype if isinstance(action, np.ndarray) else None
             assert space.contains(
                 action
-            ), f"Action {action} does not match space {space}!"
+            ), f"Action {action} of type `{type(action)}` & {dtype} does not match space {space}!"
             formatted_action = format_.formatting_func(action)
             out_actions[agent_id] = formatted_action
 
         if self._action_options == ActionOptions.full:
             assert actions.keys() == self.space.spaces.keys()
 
         return out_actions
```

## smarts/env/utils/observation_conversion.py

```diff
@@ -70,15 +70,16 @@
 
 def _format_id(lane_id: str, max_length, type_):
     lane_name = lane_id
     if len(lane_name) > max_length:
         warnings.warn(
             f"`{type_}` named `{lane_name}` is more than "
             f"`{max_length}` characters long. It will be truncated "
-            "and may cause unintended issues with navigation and lane identification."
+            "and may cause unintended issues with navigation and lane identification.",
+            category=UserWarning,
         )
     return lane_name[:max_length]
 
 
 def _format_mission(mission: Mission):
     if hasattr(mission.goal, "position"):
         goal_pos = np.array(mission.goal.position, dtype=np.float64)
@@ -189,33 +190,35 @@
     pad_shp = 0 if des_shp - rcv_shp < 0 else des_shp - rcv_shp
 
     if rcv_shp == 0:
         return {
             "box": np.zeros((des_shp, 3), dtype=np.float32),
             "heading": np.zeros((des_shp,), dtype=np.float32),
             "id": [""] * des_shp,
+            "interest": np.zeros((des_shp,), dtype=np.int8),
+            "lane_id": [""] * des_shp,
             "lane_index": np.zeros((des_shp,), dtype=np.int8),
             "position": np.zeros((des_shp, 3), dtype=np.float64),
             "speed": np.zeros((des_shp,), dtype=np.float32),
-            "interest": np.zeros((des_shp,), dtype=np.int8),
         }
 
     neighborhood_vehicle_states = [
         (
             nghb.bounding_box.as_lwh,
             nghb.heading,
             _format_id(nghb.id, _ID_NAME_LIMIT, "vehicle id"),
             nghb.lane_index,
             nghb.position,
             nghb.speed,
+            _format_id(nghb.lane_id, _WAYPOINT_NAME_LIMIT, "lane id"),
             nghb.interest,
         )
         for nghb in neighborhood_vehicle_states[:des_shp]
     ]
-    box, heading, vehicle_id, lane_index, pos, speed, interest = zip(
+    box, heading, vehicle_id, lane_index, pos, speed, lane_id, interest = zip(
         *neighborhood_vehicle_states
     )
 
     box = np.array(box, dtype=np.float32)
     heading = np.array(heading, dtype=np.float32)
     lane_index = np.array(lane_index, dtype=np.int8)
     pos = np.array(pos, dtype=np.float64)
@@ -225,25 +228,27 @@
     # fmt: off
     box = np.pad(box, ((0,pad_shp),(0,0)), mode='constant', constant_values=0)
     heading = np.pad(heading, ((0,pad_shp)), mode='constant', constant_values=0)
     vehicle_id = tuple(vehicle_id + ("",) * pad_shp)
     lane_index = np.pad(lane_index, ((0,pad_shp)), mode='constant', constant_values=0)
     pos = np.pad(pos, ((0,pad_shp),(0,0)), mode='constant', constant_values=0)
     speed = np.pad(speed, ((0,pad_shp)), mode='constant', constant_values=0)
+    lane_id = tuple(lane_id + ("",) * pad_shp)
     interest = np.pad(interest, ((0,pad_shp)), mode="constant", constant_values=False)
     # fmt: on
 
     return {
         "box": box,
         "heading": heading,
         "id": vehicle_id,
+        "interest": interest,
+        "lane_id": lane_id,
         "lane_index": lane_index,
         "position": pos,
         "speed": speed,
-        "interest": interest,
     }
 
 
 def _format_lidar(
     lidar_point_cloud: Optional[
         Tuple[List[np.ndarray], List[bool], List[Tuple[np.ndarray, np.ndarray]]]
     ]
@@ -1018,14 +1023,20 @@
                     vehicle. shape=(10,3). dtype=np.float32.
                 "heading":
                     Heading of neighbor vehicles in radians [-pi, pi]. Defaults to
                     np.array([0]) per vehicle. shape=(10,). dtype=np.float32.
                 "id":
                     The vehicle ids of neighbor vehicles. Defaults to str("") per vehicle.
                     shape=(10,Text(50))
+                "interest":
+                    If the vehicles are of interest. Defaults to np.array([False]) per vehicle.
+                    shape=(10,). dtype=np.int8
+                "lane_id":
+                    The ID of the lane that the vehicle is on. Defaults to str("") per vehicle.
+                    shape=(10,Text(50))
                 "lane_index":
                     Lane number of neighbor vehicles. Defaults to np.array([0]) per
                     vehicle. shape=(10,). dtype=np.int8.
                 "position":
                     Coordinate of the center of neighbor vehicles' bounding box's bottom
                     plane. Defaults to np.array([0,0,0]) per vehicle. shape=(10,3).
                     dtype=np.float64.
```

## smarts/env/wrappers/gif_recorder.py

```diff
@@ -18,15 +18,15 @@
 # AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 # LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 # OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 # THE SOFTWARE.
 import logging
 import sys
 
-import gym
+import gymnasium as gym
 import numpy as np
 
 try:
     from moviepy.editor import ImageClip, ImageSequenceClip
 except (ImportError, ModuleNotFoundError):
     logging.warning(sys.exc_info())
     logging.warning(
```

## smarts/env/wrappers/record_video.py

```diff
@@ -30,17 +30,17 @@
 #
 # THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 #
 # pytype: disable=annotation-type-mismatch
 import os
 from typing import Callable
 
-import gym
-from gym import logger
-from gym.wrappers.monitoring import video_recorder
+import gymnasium as gym
+from gymnasium import logger
+from gymnasium.wrappers.monitoring import video_recorder
 
 
 def capped_cubic_video_schedule(episode_id, cap=1000):
     """A utility to schedule frequency fall-off."""
     if episode_id < cap:
         return int(round(episode_id ** (1.0 / 3))) ** 3 == episode_id
     else:
```

## smarts/env/wrappers/recorder_wrapper.py

```diff
@@ -18,16 +18,15 @@
 # AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 # LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 # OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 # THE SOFTWARE.
 import os
 from pathlib import Path
 
-import gym
-import gym.envs
+import gymnasium as gym
 
 from smarts.env.wrappers.gif_recorder import GifRecorder
 
 
 class RecorderWrapper(gym.Wrapper):
     """
     A Wrapper that interacts the gym environment with the GifRecorder to record video step by step.
```

## smarts/ray/sensors/ray_sensor_resolver.py

```diff
@@ -44,21 +44,27 @@
     Args:
         process_count_override (Optional[int]): An override for how many workers should be used.
     """
 
     def __init__(self, process_count_override: Optional[int] = None) -> None:
         conf: Config = config()
         self._num_observation_workers = (
-            conf("core", "observation_workers", default=8, cast=int)
+            conf(
+                "ray",
+                "num_cpus",
+                default=conf("core", "observation_workers", default=8, cast=int),
+                cast=int,
+            )
             if process_count_override == None
             else max(1, process_count_override)
         )
         if not ray.is_initialized():
             ray.init(
                 num_cpus=self._num_observation_workers,
+                num_gpus=conf("ray", "num_gpus", default=None, cast=int),
                 log_to_driver=conf("ray", "log_to_driver", default=False, cast=bool),
             )
         self._sim_local_constants: SimulationLocalConstants = None
         self._current_workers = []
 
     def get_ray_worker_actors(self, count: int):
         """Get the current "ray" worker actors.
```

## smarts/sstudio/types/distribution.py

```diff
@@ -51,28 +51,7 @@
     def __post_init__(self):
         if self.b < self.a:
             self.a, self.b = self.b, self.a
 
     def sample(self):
         """Get the next sample."""
         return random.uniform(self.a, self.b)
-
-
-@dataclass
-class TruncatedDistribution:
-    """A truncated normal distribution, by default, location=0, scale=1"""
-
-    a: float
-    b: float
-    loc: float = 0
-    scale: float = 1
-
-    def __post_init__(self):
-        assert self.a != self.b
-        if self.b < self.a:
-            self.a, self.b = self.b, self.a
-
-    def sample(self):
-        """Get the next sample"""
-        from scipy.stats import truncnorm
-
-        return truncnorm.rvs(self.a, self.b, loc=self.loc, scale=self.scale)
```

## smarts/zoo/agent_spec.py

```diff
@@ -39,15 +39,15 @@
         agent_spec = AgentSpec(
             interface=AgentInterface.from_type(AgentType.Laner),
             agent_params={"agent_function": lambda _: "keep_lane"},
             agent_builder=Agent.from_function,
         )
 
         env = gym.make(
-            "smarts.env:hiway-v0",
+            "smarts.env:hiway-v1",
             scenarios=["scenarios/sumo/loop"],
             agent_specs={agent_id: agent_spec},
         )
 
         agent = agent_spec.build_agent()
 
     Refer to the Agent documentation.
```

## zoo/evaluation/npc_ego_example.py

```diff
@@ -1,12 +1,12 @@
 import argparse
 import logging
 from importlib import import_module
 
-import gym
+import gymnasium as gym
 
 from smarts.core.utils.episodes import episodes
 
 logging.basicConfig(level=logging.INFO)
 
 
 def import_agent_specs_from(scenario_path):
```

## Comparing `examples/rl/rllib/rllib.py` & `examples/rl/rllib/pg_pbt_example.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,286 +1,308 @@
-import argparse
 import logging
-import multiprocessing
-import random
+import warnings
 from pathlib import Path
-from typing import Dict
+from pprint import pprint as print
+from typing import Dict, List, Literal, Optional, Union
 
 import numpy as np
+from ray.tune.experiment import Trial
 
 # ray[rllib] is not the part of main dependency of the SMARTS package. It needs to be installed separately
 # as a part of the smarts[train] dependency using the command "pip install -e .[train]. The following try block checks
 # whether ray[rllib] was installed by user and raises an Exception warning the user to install it if not so.
 try:
     from ray import tune
-    from ray.rllib.agents.callbacks import DefaultCallbacks
+    from ray.rllib.algorithms.algorithm import AlgorithmConfig
+    from ray.rllib.algorithms.callbacks import DefaultCallbacks
+    from ray.rllib.algorithms.pg import PGConfig
     from ray.rllib.env.base_env import BaseEnv
-    from ray.rllib.evaluation.episode import MultiAgentEpisode
+    from ray.rllib.evaluation.episode import Episode
+    from ray.rllib.evaluation.episode_v2 import EpisodeV2
     from ray.rllib.evaluation.rollout_worker import RolloutWorker
     from ray.rllib.policy.policy import Policy
     from ray.rllib.utils.typing import PolicyID
+    from ray.tune.callback import Callback
+    from ray.tune.registry import register_env
     from ray.tune.schedulers import PopulationBasedTraining
 except Exception as e:
     from smarts.core.utils.custom_exceptions import RayException
 
     raise RayException.required_to("rllib.py")
 
 import smarts
 from smarts.core.utils.file import copy_tree
 from smarts.env.rllib_hiway_env import RLlibHiWayEnv
-from smarts.sstudio.scenario_construction import build_scenario
+from smarts.sstudio.scenario_construction import build_scenarios
 
 if __name__ == "__main__":
+    from configs import gen_parser
     from rllib_agent import TrainingModel, rllib_agent
 else:
+    from .configs import gen_parser
     from .rllib_agent import TrainingModel, rllib_agent
 
 logging.basicConfig(level=logging.INFO)
-
+register_env("rllib_hiway-v0", RLlibHiWayEnv)
 
 # Add custom metrics to your tensorboard using these callbacks
-# See: https://ray.readthedocs.io/en/latest/rllib-training.html#callbacks-and-custom-metrics
-class Callbacks(DefaultCallbacks):
+# See: https://docs.ray.io/en/latest/rllib/rllib-examples.html#training-workflows
+class AlgorithmCallbacks(DefaultCallbacks):
     @staticmethod
     def on_episode_start(
         worker: RolloutWorker,
         base_env: BaseEnv,
         policies: Dict[PolicyID, Policy],
-        episode: MultiAgentEpisode,
+        episode: Union[Episode, EpisodeV2],
         env_index: int,
         **kwargs,
     ):
-
-        episode.user_data["ego_speed"] = []
+        episode.user_data["ego_reward"] = []
 
     @staticmethod
     def on_episode_step(
         worker: RolloutWorker,
         base_env: BaseEnv,
-        episode: MultiAgentEpisode,
+        episode: Union[Episode, EpisodeV2],
         env_index: int,
         **kwargs,
     ):
-
-        single_agent_id = list(episode._agent_to_last_obs)[0]
-        obs = episode.last_raw_obs_for(single_agent_id)
-        episode.user_data["ego_speed"].append(obs["speed"])
+        single_agent_id = list(episode.get_agents())[0]
+        infos = episode._last_infos.get(single_agent_id)
+        if infos is not None:
+            episode.user_data["ego_reward"].append(infos["reward"])
 
     @staticmethod
     def on_episode_end(
         worker: RolloutWorker,
         base_env: BaseEnv,
         policies: Dict[PolicyID, Policy],
-        episode: MultiAgentEpisode,
+        episode: Union[Episode, EpisodeV2],
         env_index: int,
         **kwargs,
     ):
 
-        mean_ego_speed = np.mean(episode.user_data["ego_speed"])
+        mean_ego_reward = np.mean(episode.user_data["ego_reward"])
         print(
             f"ep. {episode.episode_id:<12} ended;"
             f" length={episode.length:<6}"
-            f" mean_ego_speed={mean_ego_speed:.2f}"
+            f" mean_ego_reward={mean_ego_reward:.2f}"
         )
-        episode.custom_metrics["mean_ego_speed"] = mean_ego_speed
+        episode.custom_metrics["mean_ego_reward"] = mean_ego_reward
+
+
+class ExperimentCallback(Callback):
+    def on_trial_error(self, iteration: int, trials: List[Trial], trial: Trial, **info):
+        failed_trial = trial
+        print(f"Trial has failed after {failed_trial.num_failures} failures.")
+        return super().on_trial_error(iteration, trials, trial, **info)
 
 
 def explore(config):
     # ensure we collect enough timesteps to do sgd
-    if config["train_batch_size"] < config["rollout_fragment_length"] * 2:
-        config["train_batch_size"] = config["rollout_fragment_length"] * 2
+    rollout_fragment_length = config["rollout_fragment_length"]
+    if (
+        not isinstance(rollout_fragment_length, str)
+        and config["train_batch_size"] < rollout_fragment_length * 2
+    ):
+        config["train_batch_size"] = int(rollout_fragment_length * 2)
     return config
 
 
 def main(
-    scenario,
+    scenarios,
     envision,
     time_total_s,
     rollout_fragment_length,
     train_batch_size,
     seed,
     num_samples,
     num_agents,
     num_workers,
     resume_training,
     result_dir,
-    checkpoint_num,
+    checkpoint_freq: int,
+    log_level: Literal["DEBUG", "INFO", "WARN", "ERROR"],
     save_model_path,
 ):
     assert train_batch_size > 0, f"{train_batch_size.__name__} cannot be less than 1."
-    if rollout_fragment_length > train_batch_size:
+    if isinstance(rollout_fragment_length, str) and rollout_fragment_length != "auto":
+        rollout_fragment_length = int(rollout_fragment_length)
+    if (
+        isinstance(rollout_fragment_length, int)
+        and rollout_fragment_length > train_batch_size
+    ):
         rollout_fragment_length = train_batch_size
 
+    rllib_policies = {
+        f"AGENT-{i}": (
+            None,
+            rllib_agent["observation_space"],
+            rllib_agent["action_space"],
+            {"model": {"custom_model": TrainingModel.NAME}},
+        )
+        for i in range(num_agents)
+    }
+    agent_specs = {f"AGENT-{i}": rllib_agent["agent_spec"] for i in range(num_agents)}
+
+    smarts.core.seed(seed)
+    assert len(set(rllib_policies.keys()).difference(agent_specs)) == 0
+    algo_config: AlgorithmConfig = (
+        PGConfig()
+        .environment(
+            env=RLlibHiWayEnv,
+            env_config={
+                "seed": seed,
+                "scenarios": [
+                    str(Path(scenario).expanduser().resolve().absolute())
+                    for scenario in scenarios
+                ],
+                "headless": not envision,
+                "agent_specs": agent_specs,
+                "observation_options": "multi_agent",
+            },
+            disable_env_checking=True,
+        )
+        .framework(framework="tf2", eager_tracing=True)
+        .rollouts(
+            rollout_fragment_length=rollout_fragment_length,
+            num_rollout_workers=num_workers,
+            num_envs_per_worker=1,
+            enable_tf1_exec_eagerly=True,
+        )
+        .training(
+            lr_schedule=[(0, 1e-3), (1e3, 5e-4), (1e5, 1e-4), (1e7, 5e-5), (1e8, 1e-5)],
+            train_batch_size=train_batch_size,
+        )
+        .multi_agent(
+            policies=rllib_policies,
+            policy_mapping_fn=lambda agent_id, episode, worker, **kwargs: f"{agent_id}",
+        )
+        .callbacks(callbacks_class=AlgorithmCallbacks)
+        .debugging(log_level=log_level)
+    )
+
+    experiment_name = "rllib_example_multi"
+    result_dir = Path(result_dir).expanduser().resolve().absolute()
+    experiment_dir = result_dir / experiment_name
+
+    print(f"======= Checkpointing at {str(result_dir)} =======")
+    # Note that PBT modifies the hyperparameters during the run. This perturbation can be applied
+    # to nearly anything passed to `Tuner(param_space=<config>)`.
     pbt = PopulationBasedTraining(
         time_attr="time_total_s",
         metric="episode_reward_mean",
         mode="max",
-        perturbation_interval=300,
+        perturbation_interval=20,
         resample_probability=0.25,
         # Specifies the mutations of these hyperparams
-        # See: `ray.rllib.agents.trainer.COMMON_CONFIG` for common hyperparams
         hyperparam_mutations={
             "lr": [1e-3, 5e-4, 1e-4, 5e-5, 1e-5],
-            "rollout_fragment_length": lambda: rollout_fragment_length,
             "train_batch_size": lambda: train_batch_size,
         },
         # Specifies additional mutations after hyperparam_mutations is applied
         custom_explore_fn=explore,
     )
 
-    # XXX: There is a bug in Ray where we can only export a trained model if
-    #      the policy it's attached to is named 'default_policy'.
-    #      See: https://github.com/ray-project/ray/issues/5339
-    rllib_policies = {
-        "default_policy": (
-            None,
-            rllib_agent["observation_space"],
-            rllib_agent["action_space"],
-            {"model": {"custom_model": TrainingModel.NAME}},
-        )
-    }
-
-    smarts.core.seed(seed)
-    tune_config = {
-        "env": RLlibHiWayEnv,
-        "log_level": "WARN",
-        "num_workers": num_workers,
-        "env_config": {
-            "seed": tune.sample_from(lambda spec: random.randint(0, 300)),
-            "scenarios": [str(Path(scenario).expanduser().resolve().absolute())],
-            "headless": not envision,
-            "agent_specs": {
-                f"AGENT-{i}": rllib_agent["agent_spec"] for i in range(num_agents)
-            },
-        },
-        "multiagent": {"policies": rllib_policies},
-        "callbacks": Callbacks,
-    }
-
-    experiment_name = "rllib_example_multi"
-    result_dir = Path(result_dir).expanduser().resolve().absolute()
-    if checkpoint_num:
-        checkpoint = str(
-            result_dir / f"checkpoint_{checkpoint_num}" / f"checkpoint-{checkpoint_num}"
-        )
-    else:
-        checkpoint = None
+    from ray import air
 
-    print(f"Checkpointing at {str(result_dir)}")
-    analysis = tune.run(
-        "PG",
+    run_config = air.RunConfig(
         name=experiment_name,
         stop={"time_total_s": time_total_s},
-        checkpoint_freq=1,
-        checkpoint_at_end=True,
-        local_dir=str(result_dir),
-        resume=resume_training,
-        restore=checkpoint,
-        max_failures=3,
+        callbacks=[ExperimentCallback()],
+        storage_path=str(result_dir),
+        checkpoint_config=air.CheckpointConfig(
+            num_to_keep=3,
+            checkpoint_frequency=checkpoint_freq,
+            checkpoint_at_end=True,
+        ),
+        failure_config=air.FailureConfig(
+            max_failures=3,
+            fail_fast=False,
+        ),
+    )
+    tune_config = tune.TuneConfig(
         num_samples=num_samples,
-        export_formats=["model", "checkpoint"],
-        config=tune_config,
         scheduler=pbt,
+        max_concurrent_trials=4,
     )
+    trainable = "PG"
+    if resume_training:
+        tuner = tune.Tuner.restore(
+            str(experiment_dir),
+            trainable=trainable,
+            param_space=algo_config,
+        )
+    else:
+        tuner = tune.Tuner(
+            trainable=trainable,
+            param_space=algo_config,
+            tune_config=tune_config,
+            run_config=run_config,
+        )
+
+    results = tuner.fit()
+    # Get the best result based on a particular metric.
+    best_result = results.get_best_result(metric="episode_reward_mean", mode="max")
 
-    print(analysis.dataframe().head())
+    # Get the best checkpoint corresponding to the best result.
+    best_checkpoint = best_result.checkpoint
 
-    best_logdir = Path(analysis.get_best_logdir("episode_reward_max", mode="max"))
-    model_path = best_logdir / "model"
+    best_logdir = Path(best_result.log_dir)
+    model_path = best_logdir
 
     copy_tree(str(model_path), save_model_path, overwrite=True)
     print(f"Wrote model to: {save_model_path}")
 
 
 if __name__ == "__main__":
-    parser = argparse.ArgumentParser("rllib-example")
-    parser.add_argument(
-        "--scenario",
-        type=str,
-        default=str(Path(__file__).resolve().parents[3] / "scenarios/sumo/loop"),
-        help="Scenario to run (see scenarios/ for some samples you can use)",
-    )
-    parser.add_argument(
-        "--envision",
-        action="store_true",
-        help="Run simulation with Envision display.",
+    default_result_dir = str(
+        Path(__file__).resolve().parent / "results" / "tune_pg_results"
     )
+    parser = gen_parser("rllib-example", default_result_dir)
     parser.add_argument(
         "--num_samples",
         type=int,
-        default=1,
-        help="Number of times to sample from hyperparameter space",
-    )
-    parser.add_argument(
-        "--rollout_fragment_length",
-        type=int,
-        default=200,
-        help="Episodes are divided into fragments of this many steps for each rollout. In this example this will be ensured to be `1=<rollout_fragment_length<=train_batch_size`",
-    )
-    parser.add_argument(
-        "--train_batch_size",
-        type=int,
-        default=2000,
-        help="The training batch size. This value must be > 0.",
-    )
-    parser.add_argument(
-        "--time_total_s",
-        type=int,
-        default=1 * 60 * 60,  # 1 hour
-        help="Total time in seconds to run the simulation for. This is a rough end time as it will be checked per training batch.",
+        default=2,
+        help="Number of times to sample from hyperparameter space.",
     )
     parser.add_argument(
-        "--seed",
-        type=int,
-        default=42,
-        help="The base random seed to use, intended to be mixed with --num_samples",
-    )
-    parser.add_argument(
-        "--num_agents", type=int, default=2, help="Number of agents (one per policy)"
-    )
-    parser.add_argument(
-        "--num_workers",
-        type=int,
-        default=(multiprocessing.cpu_count() // 2 + 1),
-        help="Number of workers (defaults to use all system cores)",
-    )
-    parser.add_argument(
-        "--resume_training",
-        default=False,
-        action="store_true",
-        help="Resume the last trained example",
-    )
-    parser.add_argument(
-        "--result_dir",
+        "--save_model_path",
         type=str,
-        default=str(Path(__file__).resolve().parent / "results"),
-        help="Directory containing results",
+        default=str(Path(__file__).expanduser().resolve().parent / "model"),
+        help="Destination path of where to copy the model when training is over",
     )
     parser.add_argument(
-        "--checkpoint_num", type=int, default=None, help="Checkpoint number"
-    )
-
-    save_model_path = str(Path(__file__).expanduser().resolve().parent / "model")
-    parser.add_argument(
-        "--save_model_path",
+        "--rollout_fragment_length",
         type=str,
-        default=save_model_path,
-        help="Destination path of where to copy the model when training is over",
+        default="auto",
+        help="Episodes are divided into fragments of this many steps for each rollout. In this example this will be ensured to be `1=<rollout_fragment_length<=train_batch_size`",
     )
     args = parser.parse_args()
-    build_scenario(scenario=args.scenario, clean=False, seed=42)
+    if not args.scenarios:
+        args.scenarios = [
+            str(Path(__file__).absolute().parents[3] / "scenarios" / "sumo" / "loop"),
+        ]
+    if args.num_samples < 2:
+        warnings.warn(
+            f"It is recommended to specify number_samples to be at least 2 to make use of PBT trial cloning.",
+            category=UserWarning,
+        )
+
+    build_scenarios(scenarios=args.scenarios, clean=False, seed=args.seed)
 
     main(
-        scenario=args.scenario,
+        scenarios=args.scenarios,
         envision=args.envision,
         time_total_s=args.time_total_s,
         rollout_fragment_length=args.rollout_fragment_length,
         train_batch_size=args.train_batch_size,
         seed=args.seed,
         num_samples=args.num_samples,
         num_agents=args.num_agents,
         num_workers=args.num_workers,
         resume_training=args.resume_training,
         result_dir=args.result_dir,
-        checkpoint_num=args.checkpoint_num,
+        checkpoint_freq=max(args.checkpoint_freq, 1),
+        log_level=args.log_level,
         save_model_path=args.save_model_path,
     )
```

## Comparing `smarts-1.2.0.dist-info/LICENSE` & `smarts-1.3.0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `smarts-1.2.0.dist-info/METADATA` & `smarts-1.3.0.dist-info/METADATA`

 * *Files 6% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: smarts
-Version: 1.2.0
+Version: 1.3.0
 Summary: UNKNOWN
 Home-page: https://github.com/huawei-noah/SMARTS
 License: MIT
 Platform: UNKNOWN
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Programming Language :: Python
 Classifier: Programming Language :: Python :: 3 :: Only
@@ -19,51 +19,48 @@
 Requires-Dist: psutil (>=5.4.8)
 Requires-Dist: shapely (>=2.0.0)
 Requires-Dist: tableprint (>=0.9.1)
 Requires-Dist: trimesh (==3.9.29)
 Requires-Dist: yattag (>=1.14.0)
 Requires-Dist: PyYAML (>=3.13)
 Requires-Dist: twisted (>=21.7.0)
-Requires-Dist: gymnasium (==0.27.0)
 Requires-Dist: pybullet (<4.0,>=3)
-Requires-Dist: gym (<=0.19.0,>=0.17.3)
 Requires-Dist: cloudpickle (<=2.1.0,>=1.3.0)
-Requires-Dist: scipy
 Provides-Extra: all
 Requires-Dist: av2 (>=0.2.1) ; extra == 'all'
 Requires-Dist: Rtree (>=0.9.7) ; extra == 'all'
 Requires-Dist: Panda3D (==1.10.9) ; extra == 'all'
 Requires-Dist: panda3d-gltf (==0.13) ; extra == 'all'
 Requires-Dist: black[jupyter] (==22.6.0) ; extra == 'all'
 Requires-Dist: ipython (<8.13.0,>=7.8.0) ; extra == 'all'
 Requires-Dist: grpcio-tools (==1.32.0) ; extra == 'all'
 Requires-Dist: isort (==5.7.0) ; extra == 'all'
 Requires-Dist: pre-commit (==2.16.0) ; extra == 'all'
 Requires-Dist: pylint (>=2.12.2) ; extra == 'all'
 Requires-Dist: pytype (==2023.04.18) ; extra == 'all'
 Requires-Dist: py-cpuinfo (==9.0.0) ; extra == 'all'
 Requires-Dist: mdutils (==1.4.0) ; extra == 'all'
-Requires-Dist: gym (<=0.19.0,>=0.17.3) ; extra == 'all'
 Requires-Dist: matplotlib (>=3.2.2) ; extra == 'all'
 Requires-Dist: myst-parser (>=0.18.1) ; extra == 'all'
 Requires-Dist: sphinx (>=5.3.0) ; extra == 'all'
 Requires-Dist: sphinxcontrib-apidoc (>=0.3.0) ; extra == 'all'
 Requires-Dist: sphinxcontrib-spelling (>=8.0.0) ; extra == 'all'
 Requires-Dist: sphinx-click (>=4.4.0) ; extra == 'all'
 Requires-Dist: sphinx-rtd-theme (>=1.1.1) ; extra == 'all'
 Requires-Dist: tornado (>=5.1.1) ; extra == 'all'
 Requires-Dist: websocket-client (>=1.2.1) ; extra == 'all'
 Requires-Dist: ijson (>=3.1.4) ; extra == 'all'
 Requires-Dist: pynput (>=1.7.4) ; extra == 'all'
 Requires-Dist: moviepy (==1.0.3) ; extra == 'all'
+Requires-Dist: gymnasium (>=0.26.3) ; extra == 'all'
 Requires-Dist: opendrive2lanelet (>=1.2.1) ; extra == 'all'
-Requires-Dist: grpcio (==1.32.0) ; extra == 'all'
 Requires-Dist: opencv-python (==4.1.2.30) ; extra == 'all'
 Requires-Dist: opencv-python-headless (==4.1.2.30) ; extra == 'all'
-Requires-Dist: ray[rllib] (==1.4.0) ; extra == 'all'
+Requires-Dist: ray[rllib] (~=2.5.0) ; extra == 'all'
+Requires-Dist: tensorflow-probability ; extra == 'all'
 Requires-Dist: catkin-pkg ; extra == 'all'
 Requires-Dist: rospkg ; extra == 'all'
 Requires-Dist: eclipse-sumo (>=1.12.0) ; extra == 'all'
 Requires-Dist: pytest (>=6.2.5) ; extra == 'all'
 Requires-Dist: pytest-benchmark (>=3.4.1) ; extra == 'all'
 Requires-Dist: pytest-cov (>=3.0.0) ; extra == 'all'
 Requires-Dist: pytest-xdist (>=2.4.0) ; extra == 'all'
@@ -89,42 +86,42 @@
 Requires-Dist: isort (==5.7.0) ; extra == 'dev'
 Requires-Dist: pre-commit (==2.16.0) ; extra == 'dev'
 Requires-Dist: pylint (>=2.12.2) ; extra == 'dev'
 Requires-Dist: pytype (==2023.04.18) ; extra == 'dev'
 Provides-Extra: diagnostic
 Requires-Dist: py-cpuinfo (==9.0.0) ; extra == 'diagnostic'
 Requires-Dist: mdutils (==1.4.0) ; extra == 'diagnostic'
-Requires-Dist: gym (<=0.19.0,>=0.17.3) ; extra == 'diagnostic'
 Requires-Dist: matplotlib (>=3.2.2) ; extra == 'diagnostic'
 Provides-Extra: doc
 Requires-Dist: myst-parser (>=0.18.1) ; extra == 'doc'
 Requires-Dist: sphinx (>=5.3.0) ; extra == 'doc'
 Requires-Dist: sphinxcontrib-apidoc (>=0.3.0) ; extra == 'doc'
 Requires-Dist: sphinxcontrib-spelling (>=8.0.0) ; extra == 'doc'
 Requires-Dist: sphinx-click (>=4.4.0) ; extra == 'doc'
 Requires-Dist: sphinx-rtd-theme (>=1.1.1) ; extra == 'doc'
 Provides-Extra: envision
 Requires-Dist: tornado (>=5.1.1) ; extra == 'envision'
 Requires-Dist: websocket-client (>=1.2.1) ; extra == 'envision'
 Requires-Dist: ijson (>=3.1.4) ; extra == 'envision'
 Provides-Extra: extras
 Requires-Dist: pynput (>=1.7.4) ; extra == 'extras'
-Provides-Extra: gym
-Requires-Dist: moviepy (==1.0.3) ; extra == 'gym'
+Provides-Extra: gif_recorder
+Requires-Dist: moviepy (==1.0.3) ; extra == 'gif_recorder'
+Provides-Extra: gymnasium
+Requires-Dist: gymnasium (>=0.26.3) ; extra == 'gymnasium'
 Provides-Extra: opendrive
 Requires-Dist: opendrive2lanelet (>=1.2.1) ; extra == 'opendrive'
 Requires-Dist: Rtree (>=0.9.7) ; extra == 'opendrive'
 Provides-Extra: ray
-Requires-Dist: ray (~=2.2.0) ; extra == 'ray'
-Provides-Extra: remote_agent
-Requires-Dist: grpcio (==1.32.0) ; extra == 'remote_agent'
+Requires-Dist: ray (~=2.5.0) ; extra == 'ray'
 Provides-Extra: rllib
 Requires-Dist: opencv-python (==4.1.2.30) ; extra == 'rllib'
 Requires-Dist: opencv-python-headless (==4.1.2.30) ; extra == 'rllib'
-Requires-Dist: ray[rllib] (==1.4.0) ; extra == 'rllib'
+Requires-Dist: ray[rllib] (~=2.5.0) ; extra == 'rllib'
+Requires-Dist: tensorflow-probability ; extra == 'rllib'
 Provides-Extra: ros
 Requires-Dist: catkin-pkg ; extra == 'ros'
 Requires-Dist: rospkg ; extra == 'ros'
 Provides-Extra: sumo
 Requires-Dist: eclipse-sumo (>=1.12.0) ; extra == 'sumo'
 Requires-Dist: Rtree (>=0.9.7) ; extra == 'sumo'
 Provides-Extra: test
@@ -150,14 +147,16 @@
 Requires-Dist: Rtree (>=0.9.7) ; extra == 'waymo'
 
 # SMARTS
 [![SMARTS CI Base Tests Linux](https://github.com/huawei-noah/SMARTS/actions/workflows/ci-base-tests-linux.yml/badge.svg?branch=master)](https://github.com/huawei-noah/SMARTS/actions/workflows/ci-base-tests-linux.yml?query=branch%3Amaster) 
 [![SMARTS CI Format](https://github.com/huawei-noah/SMARTS/actions/workflows/ci-format.yml/badge.svg?branch=master)](https://github.com/huawei-noah/SMARTS/actions/workflows/ci-format.yml?query=branch%3Amaster)
 [![Documentation Status](https://readthedocs.org/projects/smarts/badge/?version=latest)](https://smarts.readthedocs.io/en/latest/?badge=latest)
 ![Code style](https://img.shields.io/badge/code%20style-black-000000.svg) 
+[![Pyversion](https://img.shields.io/pypi/pyversions/smarts.svg)](https://badge.fury.io/py/smarts)
+[![PyPI version](https://badge.fury.io/py/smarts.svg)](https://badge.fury.io/py/smarts)
 [![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
 
 SMARTS (Scalable Multi-Agent Reinforcement Learning Training School) is a simulation platform for multi-agent reinforcement learning (RL) and research on autonomous driving. Its focus is on realistic and diverse interactions. It is part of the [XingTian](https://github.com/huawei-noah/xingtian/) suite of RL platforms from Huawei Noah's Ark Lab.
 
 Check out the paper at [SMARTS: Scalable Multi-Agent Reinforcement Learning Training School for Autonomous Driving](https://arxiv.org/abs/2010.09776).
 
 ![](docs/_static/smarts_envision.gif)
@@ -191,14 +190,16 @@
    + script: [control/parallel_environment.py](examples/control/parallel_environment.py)
    + Multiple SMARTS environments in parallel
    + ActionSpaceType: LaneWithContinuousSpeed
 
 ### RL Model
 1. [Drive](examples/rl/drive). See [Driving SMARTS 2023.1 & 2023.2](https://smarts.readthedocs.io/en/latest/benchmarks/driving_smarts_2023_1.html) for more info.
 1. [VehicleFollowing](examples/rl/platoon). See [Driving SMARTS 2023.3](https://smarts.readthedocs.io/en/latest/benchmarks/driving_smarts_2023_3.html) for more info.
+1. [PG](examples/rl/rllib/pg_example.py). See [RLlib](https://smarts.readthedocs.io/en/latest/ecosystem/rllib.html) for more info.
+1. [PG Population Based Training](examples/rl/rllib/pg_pbt_example.py). See [RLlib](https://smarts.readthedocs.io/en/latest/ecosystem/rllib.html) for more info.
 
 ### RL Environment
 1. [ULTRA](https://github.com/smarts-project/smarts-project.rl/blob/master/ultra) provides a gym-based environment built upon SMARTS to tackle intersection navigation, specifically the unprotected left turn.
 
 # Issues, Bugs, Feature Requests 
 1. First, read how to communicate issues, report bugs, and request features [here](./docs/resources/contributing.rst#communication).
 1. Next, raise them using appropriate tags at [https://github.com/huawei-noah/SMARTS/issues](https://github.com/huawei-noah/SMARTS/issues).
```

## Comparing `smarts-1.2.0.dist-info/RECORD` & `smarts-1.3.0.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 cli/__init__.py,sha256=6SZFl4SzfJ84Zas58OBWPSdB1d2stYQJMZr95JYZzII,1624
-cli/benchmark.py,sha256=4vx0i6LuyGI0UyS0HKI4bzZotBkepPwRLz1_4NnP_kE,3984
+cli/benchmark.py,sha256=hDbJvpsbMx4aqTqlvt6CDWOxUmNtTPgCa9lraywfivo,3816
 cli/cli.py,sha256=wb4JKXadzhFsx7BXL0ZpZnGPVsvM4nw7dlgI2XVa6Gw,1806
 cli/diagnostic.py,sha256=jwaziSkdxTJYUMKbb82xxZzl_Mto-sGkYqX6kakbIo0,1580
 cli/envision.py,sha256=UPPA0Cr8vADX8l0MPzBBzRr5HP9YWljH7dfATCD1voQ,1925
 cli/run.py,sha256=G-2xSdAf7HNW1iIYNNj2r0H7e2vNueRX9tAE4PUKdBo,3035
 cli/studio.py,sha256=O_SKRrKZ7e1vdp_53BjafO_5003SEPqGLuMgI-6wpAE,3956
 cli/waymo.py,sha256=R-ZEuCzDcuaHXVgquPzCJhIsISBAn79w8HhFo4Sr3k8,3634
 cli/zoo.py,sha256=tIACGMU2PyKbargr_17vMhyw_1rTCXNsw-jrqQ6oO8I,3797
@@ -20,121 +20,123 @@
 envision/web/dist/main.js.LICENSE.txt,sha256=IOld7PKp1rs0Z3bxfCgv30-3KOXK2It_ou66sHO9AIQ,17915
 envision/web/dist/main.js.map,sha256=Ei3U9FuJs9M_sHvLV8xVxNJEXL1a-IzYuKn75W2alRE,15225864
 examples/rl/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 examples/rl/drive/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 examples/rl/drive/inference/__init__.py,sha256=yEnO6uNEGIZH195xA4smZJYX0aeZbKf7Kpc90_7HfHg,1220
 examples/rl/drive/inference/setup.py,sha256=73sjw0aMgTBIPNdXjBTpd7ObNy_QiPDhY7R74ZbRKR4,69
 examples/rl/drive/inference/contrib_policy/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-examples/rl/drive/inference/contrib_policy/filter_obs.py,sha256=CugzcWNcQ4xbQNucO5DJiMU9am3KiAciiJckaT9Qbk0,8504
-examples/rl/drive/inference/contrib_policy/format_action.py,sha256=_-XxsJdQLfaXSkVngh4I7NB3ZIzDK7cib_PBKhoovOE,2114
-examples/rl/drive/inference/contrib_policy/frame_stack.py,sha256=PliNd1vRMssX-M55aZlvqZjXPGry7tDWXRfZRS1fvOk,2079
-examples/rl/drive/inference/contrib_policy/make_dict.py,sha256=lj09XBYtpyd8cUwGjOOLGfhaH0mEM1rcREF5TEHMRHE,594
-examples/rl/drive/inference/contrib_policy/network.py,sha256=oK84Z1ah-SclOKAy5hczfyxCEAz3MNaUch6UtNvu6fE,2000
+examples/rl/drive/inference/contrib_policy/filter_obs.py,sha256=0yrwzxecNjm4R8KdBz0cs_DBrwSiZUg15SCi1R1Vwl8,8517
+examples/rl/drive/inference/contrib_policy/format_action.py,sha256=W2bFz7_lcvrV2qreKbvxAycULbQdfU3ntZWn3XwC9jM,2127
+examples/rl/drive/inference/contrib_policy/frame_stack.py,sha256=xinuGtA2r6CSyg-07Ll_Mi5WG0VWm6_JHXePwMrtb40,2092
+examples/rl/drive/inference/contrib_policy/make_dict.py,sha256=558_0z80KaRHzWiS0QEawdyHBiloKmIeOSdjdxEHdEw,607
+examples/rl/drive/inference/contrib_policy/network.py,sha256=LmxPuaxYQUNXL08ChnVxZgTtAzo1nZ2wcvuYGu8SRCU,2013
 examples/rl/drive/inference/contrib_policy/policy.py,sha256=nDulzIIvy1mnDIk_-QkB2CUarg8RI7dOCmIvirZOwd8,2275
 examples/rl/drive/train/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-examples/rl/drive/train/env.py,sha256=L4NpHT76U-HzV6NJMTdkKA_BBR-_liL91eHoeuHTn0E,1049
-examples/rl/drive/train/preprocess.py,sha256=XMFfVOkonULnOqArQU6_GnYSqhKIvCCguyB5pbDRpu0,2081
+examples/rl/drive/train/env.py,sha256=rcu24CGBY9lD-ngt5jEzKZN4pa-i1GMVdZp0PgD9_J4,938
+examples/rl/drive/train/preprocess.py,sha256=mghru2eQfnloBVrkTyasBs_rdohQbsFaG1WP1m8r0Lg,2194
 examples/rl/drive/train/reward.py,sha256=0urwXZWCoZlf9InadFSBkAPjGZO2rXfn3Ax8SqLd5fQ,3329
-examples/rl/drive/train/run.py,sha256=kVLtzD4ZiO9idWjgU3ZaLc-3fuaXdO16UPH4NR41ySg,7186
+examples/rl/drive/train/run.py,sha256=miZ0U_8Q1b8rnS6xYU4g37UTm5uK9oZR1dO91r5MhWw,7199
 examples/rl/drive/train/utils.py,sha256=5VCfKLitOD3nzvDQhtTEk9LOZQfiFLOSFDyDv5mRBTc,417
 examples/rl/platoon/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 examples/rl/platoon/inference/__init__.py,sha256=eg-U_C4C9Qm7RaOh-GaCJwTCCDrC2f5O5JRF0KE9tPc,1212
 examples/rl/platoon/inference/setup.py,sha256=73sjw0aMgTBIPNdXjBTpd7ObNy_QiPDhY7R74ZbRKR4,69
 examples/rl/platoon/inference/contrib_policy/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-examples/rl/platoon/inference/contrib_policy/filter_obs.py,sha256=CugzcWNcQ4xbQNucO5DJiMU9am3KiAciiJckaT9Qbk0,8504
-examples/rl/platoon/inference/contrib_policy/format_action.py,sha256=atpI47brZjrH6Y9xvyZ0Jg6Ch0-xd446Ti3mGkwpeXk,1310
-examples/rl/platoon/inference/contrib_policy/frame_stack.py,sha256=PliNd1vRMssX-M55aZlvqZjXPGry7tDWXRfZRS1fvOk,2079
-examples/rl/platoon/inference/contrib_policy/make_dict.py,sha256=lj09XBYtpyd8cUwGjOOLGfhaH0mEM1rcREF5TEHMRHE,594
-examples/rl/platoon/inference/contrib_policy/network.py,sha256=oK84Z1ah-SclOKAy5hczfyxCEAz3MNaUch6UtNvu6fE,2000
+examples/rl/platoon/inference/contrib_policy/filter_obs.py,sha256=0yrwzxecNjm4R8KdBz0cs_DBrwSiZUg15SCi1R1Vwl8,8517
+examples/rl/platoon/inference/contrib_policy/format_action.py,sha256=ZKokThVxD85uwbD4n5VfoJp9nRWnTbYUhrP87l9-57Y,1323
+examples/rl/platoon/inference/contrib_policy/frame_stack.py,sha256=xinuGtA2r6CSyg-07Ll_Mi5WG0VWm6_JHXePwMrtb40,2092
+examples/rl/platoon/inference/contrib_policy/make_dict.py,sha256=558_0z80KaRHzWiS0QEawdyHBiloKmIeOSdjdxEHdEw,607
+examples/rl/platoon/inference/contrib_policy/network.py,sha256=LmxPuaxYQUNXL08ChnVxZgTtAzo1nZ2wcvuYGu8SRCU,2013
 examples/rl/platoon/inference/contrib_policy/policy.py,sha256=QorBcd1-0g-DnxNKLCMX9Z6J8d99v3gAIF2usiuN7pA,2203
 examples/rl/platoon/train/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-examples/rl/platoon/train/env.py,sha256=L4NpHT76U-HzV6NJMTdkKA_BBR-_liL91eHoeuHTn0E,1049
-examples/rl/platoon/train/preprocess.py,sha256=mpF4jgstVqKl1BKFCsseUoC30FseqNDY1oTTbZD1CuA,1855
+examples/rl/platoon/train/env.py,sha256=rcu24CGBY9lD-ngt5jEzKZN4pa-i1GMVdZp0PgD9_J4,938
+examples/rl/platoon/train/preprocess.py,sha256=IPmndoDNIDgDu8m9BrMSFoCheALY1tOxr-oiBbGzy94,1968
 examples/rl/platoon/train/reward.py,sha256=1U9SRrp1XV0kZUuk2ChpJmUqMyYrqhITxj2QMcegH6o,7348
-examples/rl/platoon/train/run.py,sha256=AyOZwwORR5enVKfQfMeW02r7m3bvPiZuZ1dCrzTroDM,7187
+examples/rl/platoon/train/run.py,sha256=GUMqVPOtQvNB_bfKc5OXEO1wGq2JilY88AX98KqXDFQ,7200
 examples/rl/platoon/train/utils.py,sha256=5VCfKLitOD3nzvDQhtTEk9LOZQfiFLOSFDyDv5mRBTc,417
 examples/rl/rllib/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-examples/rl/rllib/rllib.py,sha256=-BnYlm2lURDmGjXMUyyqIq3sd8ozmG7y23dhWH3iRrU,9355
-examples/rl/rllib/rllib_agent.py,sha256=WYebmRxgk_N0vSIrPyqzVoM4ZVUB5xKiZ8HePj_ZGTg,3600
+examples/rl/rllib/configs.py,sha256=roRrqZzJYfyg0isuJuMO2U4ec-0SmdGKihRqB1MIVZ8,2175
+examples/rl/rllib/pg_example.py,sha256=fwkz5edXySdJ_3u7Nujuo9e2l6p2Q8-Aao8A8lYCws4,7364
+examples/rl/rllib/pg_pbt_example.py,sha256=73HDYPg0MinUgkhq691Z4iulWGYibcqaIinxXrYXVdk,10661
+examples/rl/rllib/rllib_agent.py,sha256=0Uh39xOkz_nfpSU_ZmYnP1Eck9drj1oucXPLIZEthDc,4296
 smarts/__init__.py,sha256=qMfXjYMP-frMhAcaxHcvWkSd5TO48iuq2UazZ0QR-p0,1263
 smarts/engine.ini,sha256=B-ubhZ9wznukU6EMStX7oBLcleUGDf8XkddAN8ySxA4,184
 smarts/benchmark/__init__.py,sha256=RRkNIXtaO6qBsEVkXbyV_k_8ri-KzYG2Sptg0yuJIEY,4290
-smarts/benchmark/benchmark_listing.yaml,sha256=8ywpyD_4fI_N3SI9HGmzPT6bGn7N2mVPhjKf9qFKTyA,1416
+smarts/benchmark/benchmark_listing.yaml,sha256=c2GrsRpKcBybUM2mZFbZQSrlucVUonUtUCXaJo1z5Vs,1413
 smarts/benchmark/driving_smarts/__init__.py,sha256=9wfX9ED84xFHGR7hNbrejxpV3_yrOYD5MLxEC0El26U,1478
 smarts/benchmark/driving_smarts/v2022/__init__.py,sha256=Kim69RujDXea6RuhKhZA-pjqnD6xhnADLsGgCuVuWwk,1246
 smarts/benchmark/driving_smarts/v2022/config.yaml,sha256=mfK0SgVUy44KZs89bb13VH7FnaptXa8x6QI0uuxxpfc,1581
 smarts/benchmark/driving_smarts/v2023/__init__.py,sha256=Kim69RujDXea6RuhKhZA-pjqnD6xhnADLsGgCuVuWwk,1246
-smarts/benchmark/driving_smarts/v2023/config_1.yaml,sha256=t0uETLOJ5el77DMRRvIR7zRbsM1CWgTMi0pSN6yxQ5k,742
-smarts/benchmark/driving_smarts/v2023/config_2.yaml,sha256=p7SjRaAmAZwAft4A3PPz37XzX0wUUVleLCih6JA2_8g,668
-smarts/benchmark/driving_smarts/v2023/config_3.yaml,sha256=cVy9WT9-HVPQT3elE92ji8ke6XITi5gcnGb1k7CCCbs,1081
+smarts/benchmark/driving_smarts/v2023/config_1.yaml,sha256=bmqtoXotoiPcd1gWYqqn1mqLq7WlGiMpl1bg5SZGdFo,685
+smarts/benchmark/driving_smarts/v2023/config_2.yaml,sha256=Wd2NOaWE9ILOk1_55rBSIyhKHPGVn-erKCGxEP8r4LQ,611
+smarts/benchmark/driving_smarts/v2023/config_3.yaml,sha256=LMQVsI_j7HUnxY_Meqh_TwdOYvqCL5MkslFRi97rnQA,1024
 smarts/benchmark/driving_smarts/v2023/metric_formula_drive.py,sha256=RNmYU0QCq9DvDDQg5yKe-LsG9v8r44x-WvOy2ODgj5o,5516
 smarts/benchmark/driving_smarts/v2023/metric_formula_platoon.py,sha256=UvcBfYqp9S91isgqWqNZ0sm-uC7dHgZ_KLhQKxvn1Es,5550
 smarts/benchmark/entrypoints/__init__.py,sha256=lUcmoNNSuyiX6b9nmu7F0A-Q2p4RubUcgtnV77kmc54,1147
-smarts/benchmark/entrypoints/benchmark_runner_v0.py,sha256=ds8MGZGcr4vIyCWFewwMd2ZC5oore6n0Ogk9aPRTQpY,8567
+smarts/benchmark/entrypoints/benchmark_runner_v0.py,sha256=93cSXHsauduDWN1kOnDeXr4NYh9IYW2Pbcre5PtfMJI,9602
 smarts/core/__init__.py,sha256=QS2nRkBfIkaAJAPtJR2ZRt2El-vzivs2BDdbDujNJYo,3316
 smarts/core/actor.py,sha256=1OGQnaPiBkDfv2jMAvtTO5h_riLbOUlSZia3uL7uCqw,2506
 smarts/core/actor_capture_manager.py,sha256=OPnBaxhdUW40bDykXcG56Ez3nUg66wbZYkuBIGwmSJ8,7931
 smarts/core/agent.py,sha256=mM7SAqhI8XzHTVuhIogwsVnpnolrIxOkn4sLzBL7f5k,2557
 smarts/core/agent_buffer.py,sha256=wGyNFlGhhx1LkDob09Syi2ppP-Zqu00rTiXxv0VKWf0,1657
 smarts/core/agent_interface.py,sha256=RpNdRfG3_AK7rQqS6T2JaDA6QMVZTXt9P8VHT-Z7Znw,20066
 smarts/core/agent_manager.py,sha256=UTX3xsvsSvPrkB3yS0vksmOU-Haq9RzlcKbnrpKQ3yE,29582
 smarts/core/agents_provider.py,sha256=a72dC3EwII2E8o2ZRDRy5xHxkX3kZB0GvYUZsgdET9w,11173
-smarts/core/argoverse_map.py,sha256=E9_0WgtafW9rXIwEgpQtcDfEE0W3QKg43hWAdKFZgfA,46467
+smarts/core/argoverse_map.py,sha256=H48me1hggTcbS_3X4ru9xnpG_KMWGhhOK2Qm5l7OQM0,46438
 smarts/core/bezier_motion_planner.py,sha256=efWVprpC9GjP9Md9LNe-XlBOi-NVJ6KBgTrpdb4dtFQ,6391
 smarts/core/bubble_manager.py,sha256=l5N2rWhCJ_AKxqYWGU9h0g-vEPQwunU2_VKoyzaYOo4,36003
 smarts/core/buffer_agent.py,sha256=8Fuy7wqyptuaGEnglp0GFDqj0FwpEjm5gB2MJ-4cw2s,1725
 smarts/core/chassis.py,sha256=YAkCVeX0LFZ952YCnteOG5fwrlsOc-BFrDJz5PY1bj8,33174
 smarts/core/colors.py,sha256=oCEQLBt8RtklTioIYSA5zwdecOsK3LZUsTy12p7CwnU,2927
 smarts/core/condition_state.py,sha256=k9CzySfRfJ5J9TZAnmoWisV9-kyXweKOrTjRG5cgP3A,1577
-smarts/core/configuration.py,sha256=W2mlcnRdo1cGVcEL0-vllDCUZb6954LB_d-SXY8ylLo,5219
-smarts/core/coordinates.py,sha256=r1vM_X_IrB9PtEKaxVobqhfeguIuoKxCHEIC8mZLKIM,16755
+smarts/core/configuration.py,sha256=Ow3o2rfIiBBJ24cruDlzK2BCeJm4xJOqdMOJFeRXW7k,5369
+smarts/core/coordinates.py,sha256=Y05POjinzm_OiKQ1vrvVEdFih3BJYEzIyIKWZTZhVOs,16789
 smarts/core/data_model.py,sha256=4QQ1s3t248MziFqG9ruRk82fKYU1Od3k4nyrCG7xCrw,1744
 smarts/core/default_map_builder.py,sha256=n9YPPGqrh7QLMhyCplCMkAVpLQYqdqwizuX8ShvSvsA,6133
 smarts/core/events.py,sha256=QE6Rw5N87RkHny2qHB3OC7ZgQonOEneJbSS_uFrqYBs,2527
 smarts/core/external_provider.py,sha256=LtmYnC77RCQW6HrJCeMBOZRXTp7xqSBBu9VU4K8oJ3c,5100
-smarts/core/id_actor_capture_manager.py,sha256=IZ0mYOtmFOpSQMAPtB4jN7ugZcUYmN0vd91fTV-nFkM,5606
-smarts/core/lanepoints.py,sha256=C6VCDSipXJSu_IkynoUPqsLQ4EhurMtkfPvGrqA5KSI,38743
+smarts/core/id_actor_capture_manager.py,sha256=crEMYAFEKtEC_XgR5_dmEg0mAOKpRd6KkZEBqEW4QBE,5716
+smarts/core/lanepoints.py,sha256=8Q0Zxmkmb9swfLRak9Fp73_J_7enRLrPcQfD07QOuic,35365
 smarts/core/lidar.py,sha256=-9Il4nRba8lJAPBHMKaeS6prIQkEgR2j-6wNAY416D4,5647
 smarts/core/lidar_sensor_params.py,sha256=bVUMZC7u22Pf2waE2UsvwdNg73SaTQKS_70pckYoGpI,1895
 smarts/core/local_agent.py,sha256=4I5OJX-5qqXHl703VakunangMjjjrMOjJf5gIlhJVFo,1875
 smarts/core/local_agent_buffer.py,sha256=kRqui0zIHubBKK0u5PU5VxfO2HnZh5rCmIXo7qHUYyQ,1635
 smarts/core/local_traffic_provider.py,sha256=pHckikKeF3XpvkKyZaVqsSytzufpmaaMaIuVIDOVqQA,83039
 smarts/core/masks.py,sha256=79-CAfC4yvM_ksu3uDvD6FgExMveocB0rIjb_Wx4y_Y,1258
 smarts/core/observations.py,sha256=rnxXYGjZEmk3WqvqsAHE_BU1sm1zLZFskXNRSJF-4B8,10143
-smarts/core/opendrive_road_network.py,sha256=a1feH8_cosnhMB2e0R_mOWsJXAuCNHWyEu2OIuAlyLs,78063
+smarts/core/opendrive_road_network.py,sha256=3MemneF2X6PHzUkMa5JnZBYUP1LQe3PMm_vpbY2qT8U,78012
 smarts/core/plan.py,sha256=TD7XNKQQpmjiHXhMX63JR021hqjX2YPBJPOiw9qfxHk,15380
 smarts/core/provider.py,sha256=jSNADbpmwr7VuUTFQqwqQaePI6gCdOQ6b_8Ne9QWnTY,14782
 smarts/core/renderer_base.py,sha256=42C_5U6MmMQ-yad3ivdwfugsExHrYkd2MI97NH7LQ1s,5444
 smarts/core/road_map.py,sha256=4hv2qZ9sn2TKIbJl33xzPM86JfxqtAwIZJNPZku36Gg,40732
 smarts/core/route_cache.py,sha256=pI7P-AawJlbwNBJ8bNiKwLL8bQtYg9NP62EflNGwCHs,10471
 smarts/core/scenario.py,sha256=ytuyN6KWqgBX9lTJMenpTWmoa9r8i6sk28uu5EFQH2M,42852
 smarts/core/sensor.py,sha256=pQKDc5S3h_lPdc_WOwzuQYOFqkw3yH02zf3VViY5VqU,27327
 smarts/core/sensor_manager.py,sha256=5RDDIgAUTLDiOF74ITMO_49SMTu0EE9LPFaoPARbqrc,11990
 smarts/core/shape.py,sha256=tQVjLG40v0bb6yf3KSaANoOqT2be-HGQ3KuWapnwyd4,5801
 smarts/core/signal_provider.py,sha256=dLZBNd001YEGX4KLWGZadwijRps-rLzgefdYn-T4X3I,5192
 smarts/core/signals.py,sha256=9Hzj7eAWhde_rReAlMOKPNlXRjkQlhO68CzmplierzM,2365
 smarts/core/simulation_frame.py,sha256=5GEMf26SHN3EZI6yV6FwqdojCDMLUGjQ6Q2O15EnUbk,5450
 smarts/core/simulation_local_constants.py,sha256=FP8Tvsh9j0lhRw_umNDBzYD8MtX7qcGLWXyOzlvxMuI,1611
-smarts/core/smarts.py,sha256=zh-KiB10LE421bqxqbbcNpVj4xT--u1bUvYpE8r0Ps0,71224
-smarts/core/sumo_road_network.py,sha256=uaB6oS1qxKTNrRstn_ZP8eZV8X4mpvtagCWzf7udQtY,65691
+smarts/core/smarts.py,sha256=3W_S_ODA1GEcidOmlBjxIwCs02qP6XYdxI3xMvuK2uc,71256
+smarts/core/sumo_road_network.py,sha256=fMm3nCffzknhaqIX0M7hTpSlZSiE-rLZNzy8gUzHDgQ,65640
 smarts/core/sumo_traffic_simulation.py,sha256=9XTikAJa7UGiKHDHsFFZPZu3xuszKD7OcwVab4Yg-kA,43102
 smarts/core/tire_models.py,sha256=FGuFxDyW3yYGdvdgu2LGpLWQxnd4mCYKcfBbtII35Dg,10244
 smarts/core/traffic_history.py,sha256=n1XRATKJgSiX4mlp5LD8gRDBom-RbI91ab1YLMIgb84,21061
 smarts/core/traffic_history_provider.py,sha256=wa-3nqLqWlt163Tdw_ObHHLEj9liORrwkoR6B_ckp4Y,11459
 smarts/core/traffic_provider.py,sha256=BKuaOOw5ILQI4RFpqnTSx-daZPU56mp4iUhrrLC2koE,2679
 smarts/core/trap_manager.py,sha256=hMB-0iuke8S9ssi6imfrOzZrIju-JUlA0hbu1qwqEq4,15624
 smarts/core/vehicle.py,sha256=5lkTEZ7hvEl7hPtfOfsPk6uhIh6iIJmNUU1yM1DnOb0,22849
 smarts/core/vehicle_index.py,sha256=LGP_joQH4ebD9XgqdFFJClHc4b3mY1AoCD-dEjFkGp0,30570
-smarts/core/vehicle_state.py,sha256=FHz5xdbC8GCqsHfS0DMmjBNEuNo0ykvfLEbPW8UY9Uo,6752
-smarts/core/waymo_map.py,sha256=Mnk1FmPitK8yszkMcexpHLN8Za_iXxc6bxG2cb3eVgk,82063
+smarts/core/vehicle_state.py,sha256=hEdNQFSvygo6rvKhrQ_0DVPocVJB26dKPAXA8njl0Xc,6681
+smarts/core/waymo_map.py,sha256=YhOp7otiKVdTsn4_ufaRVYRYc-EaOYQpmEbwH55Kchc,82012
 smarts/core/controllers/__init__.py,sha256=6MOaW_l6_I0vfRKgiGikJMIfjAZ7gPwmw2eYvXy01Gg,8326
 smarts/core/controllers/action_space_type.py,sha256=2EB9ttD9xGtMcZmj8-T8E-yglW0zGBJj9bhcWX9vyCQ,4724
 smarts/core/controllers/actuator_dynamic_controller.py,sha256=lx-Q6Bt_3QhAOFXv0z22GtvwG-itx19assbp25jKMxs,2454
 smarts/core/controllers/direct_controller.py,sha256=kC8hSLf4_H_nEqmj48SgnHeCS-Ul-HyiI3gYb4UsGwA,4795
-smarts/core/controllers/lane_following_controller.py,sha256=q09avwVamJBOMhNe4HkxrY8uckXVmQP9U6N2EQd6fIM,19466
+smarts/core/controllers/lane_following_controller.py,sha256=tUDTLTu-OS2sy0HzeCZhl23hcnKCtioDbwqwJPqpni8,19952
 smarts/core/controllers/motion_planner_controller.py,sha256=NLU_EXlbqfGvO7e5hRCeHroAozJFavQ4MTJan76is0A,3300
 smarts/core/controllers/trajectory_interpolation_controller.py,sha256=CitJ4Ahc_nPanfEsnbkSAeNZ2NFP7YEfIVV1m8pqd4k,5094
 smarts/core/controllers/trajectory_tracking_controller.py,sha256=g3R0BhZvH1EQ2j3D5nAAsxtgBDlKjvye2JKLrUFwRxg,24002
 smarts/core/glsl/__init__.py,sha256=LmQrRRN5vEpMrmkd0L226XqivjCBteoMHlpZF4ZP8rA,1131
 smarts/core/glsl/dashed_line_shader.frag,sha256=1tYcNzKw-3XMypOo3wLhTQBBcTPhsRC_-8hrcoA5WYw,423
 smarts/core/glsl/dashed_line_shader.vert,sha256=hm27ap5LNc3XYOctrV3t0rVLcjW8mvYJpdK0npSjR9s,280
 smarts/core/glsl/unlit_shader.frag,sha256=IGBw2VmrN94204AWifgFvC_LO4QR5UKjslaA0PC0iX4,152
@@ -170,15 +172,15 @@
 smarts/core/utils/id.py,sha256=ReUIsBRPwyYsK3LFlqsenaKDMOmL7sCS38HfHs04XRE,2693
 smarts/core/utils/import_utils.py,sha256=qwYIMasUeQ3Os3MLa4beQorQZnrGWLuewNSoSy7DU_g,1682
 smarts/core/utils/key_wrapper.py,sha256=TdFTyLskT3VRH5mrux_Duxl3Way7OXpvADwsaDT_Brw,1722
 smarts/core/utils/kinematics.py,sha256=J-w8qPpuSirZNdG2cAeTKnjGNc9GM8BV4V_xy-6ikHM,3235
 smarts/core/utils/logging.py,sha256=NhB4hSRpnOvPYMS3ZLem_ad2Zse8FG5gSyOnBLy0s9E,7276
 smarts/core/utils/math.py,sha256=QvJw9R_zGGUO6UqGGxCY8r538F4d0zo9dQILz6AqdO0,21640
 smarts/core/utils/networking.py,sha256=VAplG02IYwGG1ZNeFZgr__cLotfPrdOxixyOxjB3E6I,1507
-smarts/core/utils/pybullet.py,sha256=9pcCr3CGaQbodssol0jk9d8INDVEzCwiAXHmrtWPikA,2614
+smarts/core/utils/pybullet.py,sha256=DviA2UWZLnbhgAYFLHqpPXFfrPNvdOrjIeKg2VdnsQ4,2602
 smarts/core/utils/resources.py,sha256=e7WltMzh5YRyOC8ERaADsBQX63xPUMqQJi3vNdi_Jb8,3519
 smarts/core/utils/string.py,sha256=mKEFc57iZPWgXZ4QeDi_EIk504RguB_RN3_EkD68-bY,1694
 smarts/core/utils/sumo.py,sha256=jl8Vt3znXIrJT4R0u0uXZE8O7LZfDxShBKdTM84hHww,8611
 smarts/core/utils/type_operations.py,sha256=lhUK0r99bTYI2cS5c_ohcb3rqnBKO_3UHJHHhAHn44s,11197
 smarts/core/utils/adapters/__init__.py,sha256=xTgV639PRp-WvRU_Jd6pW6JMdgnMF2gwYJaEfHhzYUU,1147
 smarts/core/utils/adapters/ego_centric_adapters.py,sha256=URCCYbaCec8u4pA1MfPWo12L2U_JDV5NnmgPFNnWCV8,10243
 smarts/core/utils/invalid/__init__.py,sha256=sxmobm8o694-qyUx8Qn7GvD90-nD3WO194aBFSTTZhc,1268
@@ -231,52 +233,50 @@
 smarts/diagnostic/n_sumo_actors/1_actors/scenario.py,sha256=hChR-rrxy2ska-9TAntbEBe1Fw8AYzecMIDHX4D1CbA,1525
 smarts/diagnostic/n_sumo_actors/200_actors/map.net.xml,sha256=_w6_Qv3UMjDdLo4jy7XRD3FlszdtLBXGNtlqtAOBEsI,6404
 smarts/diagnostic/n_sumo_actors/200_actors/scenario.py,sha256=Lhw6_UQS780d2ttqNLe_H1xHuNJJun7FFtta8smnKCs,1581
 smarts/diagnostic/n_sumo_actors/20_actors/map.net.xml,sha256=G9_toKrxCuUCVaVnTJPWp5RqywFpZ-WTVByUzj-GwJY,6391
 smarts/diagnostic/n_sumo_actors/20_actors/scenario.py,sha256=AaNfFRqBsE8O7H5BfZi21AABdMKdWaCSZItttoY4EWw,1580
 smarts/diagnostic/n_sumo_actors/50_actors/map.net.xml,sha256=G9_toKrxCuUCVaVnTJPWp5RqywFpZ-WTVByUzj-GwJY,6391
 smarts/diagnostic/n_sumo_actors/50_actors/scenario.py,sha256=nwcjBUnYNy98fOoc8n29k7fU-VdGo1zZ5t0GSQPw-uM,1581
-smarts/env/__init__.py,sha256=foLd3BV6Bb-CJhSPr7Pl3rmk4bjugr6vfmCgpLWK23M,1302
-smarts/env/custom_observations.py,sha256=J4y10deJv0I-EFUGSOMk5SHk0nQG0djdjyTGRHkjIcM,10534
-smarts/env/hiway_env.py,sha256=9GzxAZDS6p23BCNHg8bAUmqrNXBI0H_aTLuI7lC1yi8,12514
-smarts/env/rllib_hiway_env.py,sha256=VHeiWzTPKmT8IQ0-4mdg4bMLiAXUstnb3XiGAt4JN80,9556
+smarts/env/__init__.py,sha256=aLBeM-DuBqM11pqprkXehRnXrk87qJK4elOTIQzBGko,1177
+smarts/env/custom_observations.py,sha256=w1voL-TCP1ZAbf3f3Mfvr0wDxv4qKwdv3D945f-IA84,13189
+smarts/env/rllib_hiway_env.py,sha256=IZSJL5usaNNk8WXlBAF3UdT7FZ-0fe0jZWHzmklCYys,12246
 smarts/env/gymnasium/__init__.py,sha256=SlTQsRycrmFgBIVi00unflQmr2rx3s4coX5j2px8UTo,2114
 smarts/env/gymnasium/driving_smarts_2022_env.py,sha256=ZZgiijWg2rIzpj7pEqtaLEd8V9UxP55ZK2V_H6vL--4,13189
 smarts/env/gymnasium/driving_smarts_2023_env.py,sha256=4F8vbCt3UJZnxjzU5Rcf4-2c1JX7juLfhk7OwTlY_iM,7639
-smarts/env/gymnasium/hiway_env_v1.py,sha256=yEtd16hsraw3pn0MYoyYW4nxMtVtfE_Kh_Hrd71VGtA,23718
+smarts/env/gymnasium/hiway_env_v1.py,sha256=3SfcFIk3CqgBTwcDDlqX67mdQ8HgFqda6hmNPsAMQL0,23724
 smarts/env/gymnasium/platoon_env.py,sha256=oJ2LCnN_rG3b-ZHkQoiMzpKtB9warrzo_FXcf6Vbu2s,7987
 smarts/env/gymnasium/wrappers/__init__.py,sha256=v3Anijpyrq5IGxduFvvSwaZr_IJ_W6LrfcohbqPJVVg,1147
-smarts/env/gymnasium/wrappers/api_reversion.py,sha256=0-M-4yw-aBNrUqUvQO0nVimhWN5B-RLd0XWhUUFld-8,2013
 smarts/env/gymnasium/wrappers/episode_logger.py,sha256=DjV_t9u0On0218da0LAPFY4dUB5E1xLCuhha4O7h1-M,2532
 smarts/env/gymnasium/wrappers/limit_relative_target_pose.py,sha256=actyJbJJ3wUAQ72nYoC2Ywidkq5bOENFJcsOTzFas7w,3732
 smarts/env/gymnasium/wrappers/parallel_env.py,sha256=pmeTnbT1sBqeKD8AUmcqhEEvmsB5UG8PWRWbAVKpvso,12145
-smarts/env/gymnasium/wrappers/single_agent.py,sha256=zHun7Oih3j7ql7n11Kb4LuuGBwExdRCBeMRoyM9w4FM,2917
+smarts/env/gymnasium/wrappers/single_agent.py,sha256=eVgaZJbwTqDc7B28NjHjgnWCsD1_W2jd_DwdFvVPwoA,2971
 smarts/env/gymnasium/wrappers/metric/__init__.py,sha256=mvtBOool9vklrq2HQJKKo82AIzYL3t-_zgrfjlVYlT0,1131
 smarts/env/gymnasium/wrappers/metric/costs.py,sha256=ym3Rg1Tl22DVX621Dix7x16Hj3t91j3IgKZU0V6HEeM,26768
 smarts/env/gymnasium/wrappers/metric/formula.py,sha256=IRLAq9WqAn58JYobot1qJ_5mMX0BYs8fzCUEZ1z6OnQ,7971
 smarts/env/gymnasium/wrappers/metric/metrics.py,sha256=fcKRCtMbptlHtjxCQSzZLvhB_dMM3Hd35s4N2L9qVrE,22813
 smarts/env/gymnasium/wrappers/metric/params.py,sha256=LtIs7h_JyGZSqeCsnlnUrKuZVKXlPmXj4h3C9DdwNIs,4441
 smarts/env/gymnasium/wrappers/metric/types.py,sha256=mIMikjLP0hsU4QxXQrfkx3MDaBbhrLE4Ou7njxB-y2s,2199
 smarts/env/gymnasium/wrappers/metric/utils.py,sha256=H4QBhFVn2RIoxGlKNX-klpp_V3kKWMd6DF_DKf1Tp1o,6477
 smarts/env/utils/__init__.py,sha256=9e-ToxZQIMbpppSwuvKxdPr6ho5fidVedupELJOeW30,1130
-smarts/env/utils/action_conversion.py,sha256=cARxB6ZaTy0Dhtx80Emcn3t5pKCnVrP2vO8MmFqRdsc,9581
-smarts/env/utils/observation_conversion.py,sha256=MykCbmWFUagBoTwRMh8TPoOlweLl_JDh8I8ihhqlwr8,40535
+smarts/env/utils/action_conversion.py,sha256=xp2fDOHhuLcsH59NuoqdI8mFUEb9__0bOyVO0G-nNpI,9693
+smarts/env/utils/observation_conversion.py,sha256=6zywy9eGVgPbpKHHdhsw6F7CyDlXePoMiu4NJpcGeBA,41098
 smarts/env/utils/record.py,sha256=SQdQ55DYsa9I0HnvTygVA9CxZ9n0XZUAgnbVPyAdCV8,3060
 smarts/env/utils/scenario.py,sha256=r1STlT6XBxAe__UY41an5x4lkV6kfE-uisVFOxu_VRU,1968
 smarts/env/wrappers/__init__.py,sha256=xTgV639PRp-WvRU_Jd6pW6JMdgnMF2gwYJaEfHhzYUU,1147
-smarts/env/wrappers/gif_recorder.py,sha256=Ku5TiZ9_iQH3D8kbbUQCfk7FNCkfkfV7gXEpg_6wmWU,3180
-smarts/env/wrappers/record_video.py,sha256=3K35UW-Im9rWsGSFEXPV_I_YJrCSkHowjjr3hTyUqGw,6496
-smarts/env/wrappers/recorder_wrapper.py,sha256=oZKCcX3oNR258N8_3rASSBmiW0fQetUgZ9cGzMTExlE,3861
+smarts/env/wrappers/gif_recorder.py,sha256=l2RN7eI5OQjxxHg-lDctmZnhyUcE9BpEFOmJORfWJaM,3193
+smarts/env/wrappers/record_video.py,sha256=OCR7_pzJj7ZH1-0ZsCoYgGzeXSyIQsveGQSSBcuNi_Q,6521
+smarts/env/wrappers/recorder_wrapper.py,sha256=O1nR8Cl2xX43NgB7yIa5_OwFqmWK2PZwt1mnfd28S7Q,3858
 smarts/env/wrappers/utils/__init__.py,sha256=9e-ToxZQIMbpppSwuvKxdPr6ho5fidVedupELJOeW30,1130
 smarts/env/wrappers/utils/rendering.py,sha256=u21Ho7AUi7yVP2GMnbYzWDz-gshRuZaGc3CvjHbFnWQ,3694
 smarts/p3d/__init__.py,sha256=lUcmoNNSuyiX6b9nmu7F0A-Q2p4RubUcgtnV77kmc54,1147
 smarts/p3d/renderer.py,sha256=1Z7RBKKOP4ghqJlzwvmqUCFYsXYhaRjrgCLHD2ufhVY,24635
 smarts/ray/__init__.py,sha256=lUcmoNNSuyiX6b9nmu7F0A-Q2p4RubUcgtnV77kmc54,1147
 smarts/ray/sensors/__init__.py,sha256=lUcmoNNSuyiX6b9nmu7F0A-Q2p4RubUcgtnV77kmc54,1147
-smarts/ray/sensors/ray_sensor_resolver.py,sha256=vaoANLhUfaTNUjMAbpQ4xgvW1XjdVSlZs4EjSUkGKc8,7900
+smarts/ray/sensors/ray_sensor_resolver.py,sha256=Ri__toFXMzgXMQR3m7pQ2WPR_WOUmC1xhuNaNcUZdDM,8096
 smarts/ros/__init__.py,sha256=2hUHV3E2XirQ3lOcApatWciwbwCn_FxFpqmN16IcCzM,1737
 smarts/ros/__main__.py,sha256=FLPR-GHtJCYC7XO6QPpr6Wnvryp7IjNfDWpGthsgMT8,3148
 smarts/ros/logging.py,sha256=Cn-ouDr1mdK1snpO0fSKcqvufpA6VVGAcZGfA1OFPpc,3159
 smarts/ros/src/__init__.py,sha256=7cLsTx2nkMH4zxM8wN1kg44p5xTJzakOrSx27YYDx9w,1131
 smarts/ros/src/smarts_ros/CMakeLists.txt,sha256=fclqPq6zkmRVPrUj6beXKAPXeqJ-xcPq7D_wGD7Surc,7181
 smarts/ros/src/smarts_ros/__init__.py,sha256=7cLsTx2nkMH4zxM8wN1kg44p5xTJzakOrSx27YYDx9w,1131
 smarts/ros/src/smarts_ros/package.xml,sha256=XDuIBBJcycIqnYPVMHGhpwGaua7hqDv_MVB6KWmSAyY,2797
@@ -305,15 +305,15 @@
 smarts/sstudio/sumo2mesh.py,sha256=hWUVC90I10FHRA_KZW4udCIu9p-SojCXWDPTA0Sa_qE,1931
 smarts/sstudio/types/__init__.py,sha256=ep2rAg0XsbdZpTrhuFrfgXOmYwGmVzyeXq7neMGodZU,1932
 smarts/sstudio/types/bubble.py,sha256=DVPTYlT_b7RU_FSF9_XsFhFwm8WixH8ZoLxM0jF7FzQ,6966
 smarts/sstudio/types/bubble_limits.py,sha256=AwdAnHKXCCp1vHWZDtJgzkxQJZZsTpqa2z2XCRFQj54,1806
 smarts/sstudio/types/condition.py,sha256=Uaq5cIG2aE9G5Q2o2mKNzGWA1XUJSWhK8Bjb281-nx4,22310
 smarts/sstudio/types/constants.py,sha256=fVtRspVSqDYWNC2jXb9q5BsNyRLJP3Rayh5UaGaiE1U,1200
 smarts/sstudio/types/dataset.py,sha256=4TouE8315_vc1pLahkQWQPHmek7uzq518BMbVG0jWEY,4609
-smarts/sstudio/types/distribution.py,sha256=owgTxpK5Qwh2r5EzvsabwhNrlmRtqHrsg4XQUrdS70A,2477
+smarts/sstudio/types/distribution.py,sha256=9WdRp58SZUfkxkxXN5k6hqAXswlUqSA2_-peDBv9So4,1982
 smarts/sstudio/types/entry_tactic.py,sha256=wYTfYuTC8Bj44n69ZMD56VPRs9V80zki4b0zNDSlwY4,3265
 smarts/sstudio/types/map_spec.py,sha256=Em4RBfz5DKlX9LZTRud7q2EucbK2Kf5U0zS2sYjqqmM,2956
 smarts/sstudio/types/mission.py,sha256=XPkD6kkHtqkcmCr5mRGmr9u-8n7B-p7pWuMpBGMRXvg,5368
 smarts/sstudio/types/route.py,sha256=f2zZvChvWwOEFu7D1z_DwWbdW3JU6juMrC-p9o-dhhk,4375
 smarts/sstudio/types/scenario.py,sha256=ccdQU8za9J-AeBsSVdXGUWixcGnZisAvx-rNFEPxC-w,6464
 smarts/sstudio/types/standard_metadata.py,sha256=PPC-gaMZNFzS9nrd6DATwEo58m45wisCuATBDJ1RMdE,2685
 smarts/sstudio/types/traffic.py,sha256=WCGXJFGS5mftHi2RnOsN1czwW8EWD2jBd3IJt0WMBFY,4995
@@ -327,20 +327,20 @@
 smarts/waymo/gen_sumo_map.py,sha256=E7t93UCa1j0i8pBeUY-PperiwhTzVbSj-pBZ9QL840U,6562
 smarts/waymo/waymo_utils.py,sha256=V0jQhCAaLmo2v2nLN8GNMs4ytkaNOC_fIDxKLR8u8lE,12312
 smarts/waymo/waymo_open_dataset/__init__.py,sha256=Eev3isXEZ7ezT5k06GoZNJJXTAsDjfvqGXCEp2pV7PM,697
 smarts/waymo/waymo_open_dataset/protos/__init__.py,sha256=-Vkb3sBOi-qUoPSKxd48XLoo6Sq0eAlMXlZUZC1GZ5I,891
 smarts/waymo/waymo_open_dataset/protos/map_pb2.py,sha256=x_3BlOSvGGVeRFKp3X2OhP27vMdbz7DtnKcVSYuee80,12361
 smarts/waymo/waymo_open_dataset/protos/scenario_pb2.py,sha256=GCsjNteE7DI8dc90tQvmjaX6dI27iQ0vg8mFr4BqlWA,5668
 smarts/zoo/__init__.py,sha256=gb105xjAtZGkuxgSRoQJ_tCcXV_XrkW-RJN0bxNBJU4,2360
-smarts/zoo/agent_spec.py,sha256=CjZe9nBhrnA1BUb14pUNgN6iqqEtEPCEbl91L5HigMM,5440
+smarts/zoo/agent_spec.py,sha256=hX5OeyLuhBYsUdmCjlN5Z-Z0K355wLOPSdzzold9Hww,5440
 smarts/zoo/registry.py,sha256=Ksh2XCuykyumeXB35wTmKuyevr7SvuyHw4-rqnt3gkw,3338
 zoo/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 zoo/evaluation/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 zoo/evaluation/egoless_example.py,sha256=pq6XqGRuIHFj5o91gO9L3FT4lMJ0PQy6nWO34Uk0wWI,1267
-zoo/evaluation/npc_ego_example.py,sha256=LDzGQrYhiLNcersHHvRWbTrnUX6_D6E1OEYt3UB3Z3I,2023
+zoo/evaluation/npc_ego_example.py,sha256=gF_QiJzW1HxtkSlsm8eyURk4JhMJ1FdiXVffVlarauM,2036
 zoo/evaluation/run_evaluation.py,sha256=QE7Kq2qXgZnwKB7XnRgi3_11VjMy7Q6YDhh88upzTDQ,6830
 zoo/evaluation/metrics/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 zoo/evaluation/metrics/data_extraction.py,sha256=wqiX_V5VXsoCKdZ82C0syRCedJkNvxgW1yrPgfABIIg,3107
 zoo/evaluation/metrics/evaluation_report.py,sha256=CNOHjckKBw87YPHWlfHzbNtWhvVKy37lveWVW46xG6c,5123
 zoo/evaluation/metrics/rank_report.py,sha256=N8IMJTC2JAzxPfa1Vsy5k3faMWttgLz9jmjEHBmv_EM,4376
 zoo/evaluation/metrics/run_evaluation.py,sha256=_39K6SHxqg6ULmuVJEy_jd2hGPqdCuKbfY5L2Ycx6So,2275
 zoo/evaluation/metrics/utils.py,sha256=3gkfkioRkHwXWRvG5j5XtEpn9HeTimOYLAkY7kJtn_U,3339
@@ -352,15 +352,15 @@
 zoo/policies/chase_via_points_agent.py,sha256=RtYaSS073kR4Z6ZiOEED0o3oYHS8sjTOvQcDn8R7-_c,2917
 zoo/policies/human_in_the_loop.py,sha256=DuP2YL7HE9pWZ4LCBpY5da6jii_2vGSWVIKdyfB4Zog,2432
 zoo/policies/keep_lane_agent.py,sha256=jCgT4k6FWn4h5r9cpYJjMD8CEKL-Ca7HbCVHVnlIe_k,117
 zoo/policies/keep_left_with_speed_agent.py,sha256=OWGLwHD7fwYxO1XA1imAIblTRCb3V8QGtE5VYZVEvi0,197
 zoo/policies/non_interactive_agent.py,sha256=l8efKRPH_YrqFbb2Sopc5rr5X-7oL6iuOMqXuBlOm8E,1153
 zoo/policies/replay_agent.py,sha256=0AgGiKqpUtO67T-_m57A9F6joyUZxtmGwcjj6YvI4QE,2312
 zoo/policies/waypoint_tracking_agent.py,sha256=B_M7zlSc91FRHiPJBlN7XmEZbQ55wfEzJlF_0uoDMfg,2264
-smarts-1.2.0.dist-info/LICENSE,sha256=EkOOOAGzROnPyCBxxDSnZGNIBd2AqTQBWjP29Bn0nFQ,1109
-smarts-1.2.0.dist-info/METADATA,sha256=q-x9kFL4CuoPHcLdrkTyTQBQOiaJTA3mvYgjA-cEO-s,11501
-smarts-1.2.0.dist-info/NOTICE,sha256=63H3mrd6YP7DuIqzv-Q2-M4uAV5v4U8Ixw0Bz0CY_HE,50
-smarts-1.2.0.dist-info/WHEEL,sha256=AtBG6SXL3KF_v0NxLf0ehyVOh0cold-JbJYXNGorC6Q,92
-smarts-1.2.0.dist-info/entry_points.txt,sha256=M2zTVeSmWrrZTygZQ8BW7G_4oTu4fO8eGv8CnRPyLxA,37
-smarts-1.2.0.dist-info/top_level.txt,sha256=neS7sT3iIJqekvJo-D6wLWM8wq_zjwAwSHyMsrtU9D8,33
-smarts-1.2.0.dist-info/zip-safe,sha256=AbpHGcgLb-kRsJGnwFEktk7uzpZOCcBY74-YBdrKVGs,1
-smarts-1.2.0.dist-info/RECORD,,
+smarts-1.3.0.dist-info/LICENSE,sha256=EkOOOAGzROnPyCBxxDSnZGNIBd2AqTQBWjP29Bn0nFQ,1109
+smarts-1.3.0.dist-info/METADATA,sha256=c7XWZnH3ciYp5XKf2wL4DYxJES670my9a5MihTBABRw,11895
+smarts-1.3.0.dist-info/NOTICE,sha256=63H3mrd6YP7DuIqzv-Q2-M4uAV5v4U8Ixw0Bz0CY_HE,50
+smarts-1.3.0.dist-info/WHEEL,sha256=AtBG6SXL3KF_v0NxLf0ehyVOh0cold-JbJYXNGorC6Q,92
+smarts-1.3.0.dist-info/entry_points.txt,sha256=M2zTVeSmWrrZTygZQ8BW7G_4oTu4fO8eGv8CnRPyLxA,37
+smarts-1.3.0.dist-info/top_level.txt,sha256=neS7sT3iIJqekvJo-D6wLWM8wq_zjwAwSHyMsrtU9D8,33
+smarts-1.3.0.dist-info/zip-safe,sha256=AbpHGcgLb-kRsJGnwFEktk7uzpZOCcBY74-YBdrKVGs,1
+smarts-1.3.0.dist-info/RECORD,,
```

