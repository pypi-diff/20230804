# Comparing `tmp/volmdlr-0.9.0.tar.gz` & `tmp/volmdlr-0.9.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "volmdlr-0.9.0.tar", last modified: Mon Mar  6 13:04:37 2023, max compression
+gzip compressed data, was "volmdlr-0.9.1.tar", last modified: Fri Mar 10 18:02:18 2023, max compression
```

## Comparing `volmdlr-0.9.0.tar` & `volmdlr-0.9.1.tar`

### file list

```diff
@@ -1,56 +1,56 @@
-drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-06 13:04:37.306463 volmdlr-0.9.0/
--rw-r--r--   0 root         (0) root         (0)    35141 2023-03-06 12:57:46.000000 volmdlr-0.9.0/LICENSE
--rw-r--r--   0 root         (0) root         (0)      159 2023-03-06 12:57:46.000000 volmdlr-0.9.0/MANIFEST.in
--rw-r--r--   0 root         (0) root         (0)     5638 2023-03-06 13:04:37.306463 volmdlr-0.9.0/PKG-INFO
--rw-r--r--   0 root         (0) root         (0)     5049 2023-03-06 12:57:46.000000 volmdlr-0.9.0/README.md
--rw-r--r--   0 root         (0) root         (0)       51 2023-03-06 12:57:46.000000 volmdlr-0.9.0/pyproject.toml
--rw-r--r--   0 root         (0) root         (0)       38 2023-03-06 13:04:37.306463 volmdlr-0.9.0/setup.cfg
--rw-r--r--   0 root         (0) root         (0)     4774 2023-03-06 12:57:46.000000 volmdlr-0.9.0/setup.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-06 13:04:37.302462 volmdlr-0.9.0/volmdlr/
--rw-r--r--   0 root         (0) root         (0)      735 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/__init__.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-06 13:04:37.298462 volmdlr-0.9.0/volmdlr/assets/
-drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-06 13:04:37.302462 volmdlr-0.9.0/volmdlr/assets/js/
--rw-r--r--   0 root         (0) root         (0)  2683768 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/assets/js/babylon.js
--rw-r--r--   0 root         (0) root         (0)   128581 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/assets/js/babylonjs.loaders.min.js
--rw-r--r--   0 root         (0) root         (0)     6519 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/assets/js/earcut.min.js
--rw-r--r--   0 root         (0) root         (0)    41188 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/assets/js/pep.js
-drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-06 13:04:37.302462 volmdlr-0.9.0/volmdlr/assets/logos/
--rw-r--r--   0 root         (0) root         (0)    42707 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/assets/logos/volmdlr.jpg
--rw-r--r--   0 root         (0) root         (0)   357731 2023-03-06 12:59:39.000000 volmdlr-0.9.0/volmdlr/bspline_compiled.c
--rw-r--r--   0 root         (0) root         (0)    14927 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/cloud.py
--rw-r--r--   0 root         (0) root         (0)    66855 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/core.py
--rw-r--r--   0 root         (0) root         (0)   134905 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/core_compiled.pyx
--rw-r--r--   0 root         (0) root         (0)     7837 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/display.py
--rw-r--r--   0 root         (0) root         (0)   233949 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/edges.py
--rw-r--r--   0 root         (0) root         (0)   431365 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/faces.py
--rw-r--r--   0 root         (0) root         (0)     7568 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/geometry.py
--rw-r--r--   0 root         (0) root         (0)    25812 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/gmsh_vm.py
--rw-r--r--   0 root         (0) root         (0)     8276 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/grid.py
--rw-r--r--   0 root         (0) root         (0)    40108 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/mesh.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-06 13:04:37.306463 volmdlr-0.9.0/volmdlr/models/
--rwxr-xr-x   0 root         (0) root         (0)      171 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/models/__init__.py
--rw-r--r--   0 root         (0) root         (0)    15237 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/models/bspline_curves.py
--rw-r--r--   0 root         (0) root         (0)   102913 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/models/bspline_surfaces.py
--rw-r--r--   0 root         (0) root         (0)     1910 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/models/casing.py
--rw-r--r--   0 root         (0) root         (0)      531 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/models/conical_surfaces.py
--rw-r--r--   0 root         (0) root         (0)     4039 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/models/contours.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-06 13:04:37.306463 volmdlr-0.9.0/volmdlr/models/workflows/
--rwxr-xr-x   0 root         (0) root         (0)      116 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/models/workflows/__init__.py
--rwxr-xr-x   0 root         (0) root         (0)      794 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/models/workflows/core.py
--rw-r--r--   0 root         (0) root         (0)     8725 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/primitives.py
--rw-r--r--   0 root         (0) root         (0)    19605 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/primitives2d.py
--rw-r--r--   0 root         (0) root         (0)    76987 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/primitives3d.py
--rw-r--r--   0 root         (0) root         (0)    39202 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/step.py
--rw-r--r--   0 root         (0) root         (0)    13572 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/stl.py
--rw-r--r--   0 root         (0) root         (0)    16532 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/templates.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-06 13:04:37.306463 volmdlr-0.9.0/volmdlr/utils/
--rw-r--r--   0 root         (0) root         (0)        0 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/utils/__init__.py
--rw-r--r--   0 root         (0) root         (0)     5216 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/utils/intersections.py
--rw-r--r--   0 root         (0) root         (0)     5929 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/utils/parametric.py
--rw-r--r--   0 root         (0) root         (0)   244533 2023-03-06 12:57:46.000000 volmdlr-0.9.0/volmdlr/wires.py
-drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-06 13:04:37.302462 volmdlr-0.9.0/volmdlr.egg-info/
--rw-r--r--   0 root         (0) root         (0)     5638 2023-03-06 13:04:37.000000 volmdlr-0.9.0/volmdlr.egg-info/PKG-INFO
--rw-r--r--   0 root         (0) root         (0)     1075 2023-03-06 13:04:37.000000 volmdlr-0.9.0/volmdlr.egg-info/SOURCES.txt
--rw-r--r--   0 root         (0) root         (0)        1 2023-03-06 13:04:37.000000 volmdlr-0.9.0/volmdlr.egg-info/dependency_links.txt
--rw-r--r--   0 root         (0) root         (0)      160 2023-03-06 13:04:37.000000 volmdlr-0.9.0/volmdlr.egg-info/requires.txt
--rw-r--r--   0 root         (0) root         (0)        8 2023-03-06 13:04:37.000000 volmdlr-0.9.0/volmdlr.egg-info/top_level.txt
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-10 18:02:18.947615 volmdlr-0.9.1/
+-rw-r--r--   0 root         (0) root         (0)    35141 2023-03-10 17:55:41.000000 volmdlr-0.9.1/LICENSE
+-rw-r--r--   0 root         (0) root         (0)      135 2023-03-10 17:55:41.000000 volmdlr-0.9.1/MANIFEST.in
+-rw-r--r--   0 root         (0) root         (0)     5638 2023-03-10 18:02:18.947615 volmdlr-0.9.1/PKG-INFO
+-rw-r--r--   0 root         (0) root         (0)     5049 2023-03-10 17:55:41.000000 volmdlr-0.9.1/README.md
+-rw-r--r--   0 root         (0) root         (0)       51 2023-03-10 17:55:41.000000 volmdlr-0.9.1/pyproject.toml
+-rw-r--r--   0 root         (0) root         (0)       38 2023-03-10 18:02:18.947615 volmdlr-0.9.1/setup.cfg
+-rw-r--r--   0 root         (0) root         (0)     4774 2023-03-10 17:55:41.000000 volmdlr-0.9.1/setup.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-10 18:02:18.943615 volmdlr-0.9.1/volmdlr/
+-rw-r--r--   0 root         (0) root         (0)      735 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/__init__.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-10 18:02:18.939615 volmdlr-0.9.1/volmdlr/assets/
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-10 18:02:18.947615 volmdlr-0.9.1/volmdlr/assets/js/
+-rw-r--r--   0 root         (0) root         (0)  2683768 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/assets/js/babylon.js
+-rw-r--r--   0 root         (0) root         (0)   128581 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/assets/js/babylonjs.loaders.min.js
+-rw-r--r--   0 root         (0) root         (0)     6519 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/assets/js/earcut.min.js
+-rw-r--r--   0 root         (0) root         (0)    41188 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/assets/js/pep.js
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-10 18:02:18.947615 volmdlr-0.9.1/volmdlr/assets/logos/
+-rw-r--r--   0 root         (0) root         (0)    42707 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/assets/logos/volmdlr.jpg
+-rw-r--r--   0 root         (0) root         (0)     9946 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/bspline_compiled.pyx
+-rw-r--r--   0 root         (0) root         (0)    14927 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/cloud.py
+-rw-r--r--   0 root         (0) root         (0)    66855 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/core.py
+-rw-r--r--   0 root         (0) root         (0)   134905 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/core_compiled.pyx
+-rw-r--r--   0 root         (0) root         (0)     7837 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/display.py
+-rw-r--r--   0 root         (0) root         (0)   234627 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/edges.py
+-rw-r--r--   0 root         (0) root         (0)   430067 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/faces.py
+-rw-r--r--   0 root         (0) root         (0)     7559 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/geometry.py
+-rw-r--r--   0 root         (0) root         (0)    25812 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/gmsh_vm.py
+-rw-r--r--   0 root         (0) root         (0)     8276 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/grid.py
+-rw-r--r--   0 root         (0) root         (0)    40108 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/mesh.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-10 18:02:18.947615 volmdlr-0.9.1/volmdlr/models/
+-rwxr-xr-x   0 root         (0) root         (0)      171 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/models/__init__.py
+-rw-r--r--   0 root         (0) root         (0)    15237 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/models/bspline_curves.py
+-rw-r--r--   0 root         (0) root         (0)   102913 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/models/bspline_surfaces.py
+-rw-r--r--   0 root         (0) root         (0)     1910 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/models/casing.py
+-rw-r--r--   0 root         (0) root         (0)      531 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/models/conical_surfaces.py
+-rw-r--r--   0 root         (0) root         (0)     4039 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/models/contours.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-10 18:02:18.947615 volmdlr-0.9.1/volmdlr/models/workflows/
+-rwxr-xr-x   0 root         (0) root         (0)      116 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/models/workflows/__init__.py
+-rwxr-xr-x   0 root         (0) root         (0)      794 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/models/workflows/core.py
+-rw-r--r--   0 root         (0) root         (0)     8711 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/primitives.py
+-rw-r--r--   0 root         (0) root         (0)    19589 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/primitives2d.py
+-rw-r--r--   0 root         (0) root         (0)    77088 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/primitives3d.py
+-rw-r--r--   0 root         (0) root         (0)    39202 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/step.py
+-rw-r--r--   0 root         (0) root         (0)    13558 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/stl.py
+-rw-r--r--   0 root         (0) root         (0)    16333 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/templates.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-10 18:02:18.947615 volmdlr-0.9.1/volmdlr/utils/
+-rw-r--r--   0 root         (0) root         (0)        0 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/utils/__init__.py
+-rw-r--r--   0 root         (0) root         (0)     5216 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/utils/intersections.py
+-rw-r--r--   0 root         (0) root         (0)     5929 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/utils/parametric.py
+-rw-r--r--   0 root         (0) root         (0)   244500 2023-03-10 17:55:41.000000 volmdlr-0.9.1/volmdlr/wires.py
+drwxr-xr-x   0 root         (0) root         (0)        0 2023-03-10 18:02:18.943615 volmdlr-0.9.1/volmdlr.egg-info/
+-rw-r--r--   0 root         (0) root         (0)     5638 2023-03-10 18:02:18.000000 volmdlr-0.9.1/volmdlr.egg-info/PKG-INFO
+-rw-r--r--   0 root         (0) root         (0)     1077 2023-03-10 18:02:18.000000 volmdlr-0.9.1/volmdlr.egg-info/SOURCES.txt
+-rw-r--r--   0 root         (0) root         (0)        1 2023-03-10 18:02:18.000000 volmdlr-0.9.1/volmdlr.egg-info/dependency_links.txt
+-rw-r--r--   0 root         (0) root         (0)      160 2023-03-10 18:02:18.000000 volmdlr-0.9.1/volmdlr.egg-info/requires.txt
+-rw-r--r--   0 root         (0) root         (0)        8 2023-03-10 18:02:18.000000 volmdlr-0.9.1/volmdlr.egg-info/top_level.txt
```

### Comparing `volmdlr-0.9.0/LICENSE` & `volmdlr-0.9.1/LICENSE`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/PKG-INFO` & `volmdlr-0.9.1/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: volmdlr
-Version: 0.9.0
+Version: 0.9.1
 Summary:  A volume modeler computation-oriented. Include rendering bindings.
 Home-page: https://github.com/Dessia-tech/volmdlr
 Author: DessiA Technologies
 Author-email: root@dessia.tech
 License: Creative Commons Attribution-Share Alike license
 Keywords: volume,modeler,CAD
 Platform: UNKNOWN
```

#### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: volmdlr Version: 0.9.0 Summary: A volume modeler
+Metadata-Version: 2.1 Name: volmdlr Version: 0.9.1 Summary: A volume modeler
 computation-oriented. Include rendering bindings. Home-page: https://
 github.com/Dessia-tech/volmdlr Author: DessiA Technologies Author-email:
 root@dessia.tech License: Creative Commons Attribution-Share Alike license
 Keywords: volume,modeler,CAD Platform: UNKNOWN Classifier: Topic :: Scientific/
 Engineering Classifier: Topic :: Multimedia :: Graphics :: 3D Modeling
 Classifier: Development Status :: 5 - Production/Stable Requires-Python: >=3.7
 Description-Content-Type: text/markdown License-File: LICENSE
```

### Comparing `volmdlr-0.9.0/README.md` & `volmdlr-0.9.1/README.md`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/setup.py` & `volmdlr-0.9.1/setup.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/__init__.py` & `volmdlr-0.9.1/volmdlr/__init__.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/assets/js/babylon.js` & `volmdlr-0.9.1/volmdlr/assets/js/babylon.js`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/assets/js/babylonjs.loaders.min.js` & `volmdlr-0.9.1/volmdlr/assets/js/babylonjs.loaders.min.js`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/assets/js/earcut.min.js` & `volmdlr-0.9.1/volmdlr/assets/js/earcut.min.js`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/assets/js/pep.js` & `volmdlr-0.9.1/volmdlr/assets/js/pep.js`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/assets/logos/volmdlr.jpg` & `volmdlr-0.9.1/volmdlr/assets/logos/volmdlr.jpg`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/cloud.py` & `volmdlr-0.9.1/volmdlr/cloud.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/core.py` & `volmdlr-0.9.1/volmdlr/core.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/core_compiled.pyx` & `volmdlr-0.9.1/volmdlr/core_compiled.pyx`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/display.py` & `volmdlr-0.9.1/volmdlr/display.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/edges.py` & `volmdlr-0.9.1/volmdlr/edges.py`

 * *Files 0% similar despite different names*

```diff
@@ -3600,11023 +3600,11066 @@
 0000e0f0: 3129 290a 2020 2020 2020 2020 2020 2020  1)).            
 0000e100: 2020 2020 2020 2020 2020 2020 202d 2073               - s
 0000e110: 756d 2869 202a 206a 2066 6f72 2069 2c20  um(i * j for i, 
 0000e120: 6a20 696e 207a 6970 2879 2c20 7831 2929  j in zip(y, x1))
 0000e130: 290a 0a20 2020 2064 6566 2073 7472 6169  )..    def strai
 0000e140: 6768 745f 6c69 6e65 5f63 656e 7465 725f  ght_line_center_
 0000e150: 6f66 5f6d 6173 7328 7365 6c66 293a 0a20  of_mass(self):. 
-0000e160: 2020 2020 2020 2070 6f6c 7967 6f6e 5f70         polygon_p
-0000e170: 6f69 6e74 7320 3d20 7365 6c66 2e64 6973  oints = self.dis
-0000e180: 6372 6574 697a 6174 696f 6e5f 706f 696e  cretization_poin
-0000e190: 7473 286e 756d 6265 725f 706f 696e 7473  ts(number_points
-0000e1a0: 3d31 3030 290a 2020 2020 2020 2020 636f  =100).        co
-0000e1b0: 6720 3d20 766f 6c6d 646c 722e 4f32 440a  g = volmdlr.O2D.
-0000e1c0: 2020 2020 2020 2020 666f 7220 706f 696e          for poin
-0000e1d0: 7420 696e 2070 6f6c 7967 6f6e 5f70 6f69  t in polygon_poi
-0000e1e0: 6e74 733a 0a20 2020 2020 2020 2020 2020  nts:.           
-0000e1f0: 2063 6f67 202b 3d20 706f 696e 740a 2020   cog += point.  
-0000e200: 2020 2020 2020 636f 6720 3d20 636f 6720        cog = cog 
-0000e210: 2f20 6c65 6e28 706f 6c79 676f 6e5f 706f  / len(polygon_po
-0000e220: 696e 7473 290a 2020 2020 2020 2020 7265  ints).        re
-0000e230: 7475 726e 2063 6f67 0a0a 2020 2020 6465  turn cog..    de
-0000e240: 6620 706c 6f74 2873 656c 662c 2061 783d  f plot(self, ax=
-0000e250: 4e6f 6e65 2c20 636f 6c6f 723d 276b 272c  None, color='k',
-0000e260: 2061 6c70 6861 3d31 2c20 706c 6f74 5f70   alpha=1, plot_p
-0000e270: 6f69 6e74 733d 4661 6c73 6529 3a0a 2020  oints=False):.  
-0000e280: 2020 2020 2020 6966 2061 7820 6973 204e        if ax is N
-0000e290: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0000e2a0: 205f 2c20 6178 203d 2070 6c74 2e73 7562   _, ax = plt.sub
-0000e2b0: 706c 6f74 7328 290a 0a20 2020 2020 2020  plots()..       
-0000e2c0: 2070 6f69 6e74 7320 3d20 7365 6c66 2e70   points = self.p
-0000e2d0: 6f69 6e74 730a 0a20 2020 2020 2020 2078  oints..        x
-0000e2e0: 5f70 6f69 6e74 7320 3d20 5b70 2e78 2066  _points = [p.x f
-0000e2f0: 6f72 2070 2069 6e20 706f 696e 7473 5d0a  or p in points].
-0000e300: 2020 2020 2020 2020 795f 706f 696e 7473          y_points
-0000e310: 203d 205b 702e 7920 666f 7220 7020 696e   = [p.y for p in
-0000e320: 2070 6f69 6e74 735d 0a20 2020 2020 2020   points].       
-0000e330: 2061 782e 706c 6f74 2878 5f70 6f69 6e74   ax.plot(x_point
-0000e340: 732c 2079 5f70 6f69 6e74 732c 2063 6f6c  s, y_points, col
-0000e350: 6f72 3d63 6f6c 6f72 2c20 616c 7068 613d  or=color, alpha=
-0000e360: 616c 7068 6129 0a20 2020 2020 2020 2069  alpha).        i
-0000e370: 6620 706c 6f74 5f70 6f69 6e74 733a 0a20  f plot_points:. 
-0000e380: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-0000e390: 6f69 6e74 2069 6e20 706f 696e 7473 3a0a  oint in points:.
-0000e3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e3b0: 706f 696e 742e 706c 6f74 2861 782c 2063  point.plot(ax, c
-0000e3c0: 6f6c 6f72 3d63 6f6c 6f72 290a 2020 2020  olor=color).    
-0000e3d0: 2020 2020 7265 7475 726e 2061 780a 0a20      return ax.. 
-0000e3e0: 2020 2064 6566 2074 6f5f 3364 2873 656c     def to_3d(sel
-0000e3f0: 662c 2070 6c61 6e65 5f6f 7269 6769 6e2c  f, plane_origin,
-0000e400: 2078 312c 2078 3229 3a0a 2020 2020 2020   x1, x2):.      
-0000e410: 2020 636f 6e74 726f 6c5f 706f 696e 7473    control_points
-0000e420: 3344 203d 205b 702e 746f 5f33 6428 706c  3D = [p.to_3d(pl
-0000e430: 616e 655f 6f72 6967 696e 2c20 7831 2c20  ane_origin, x1, 
-0000e440: 7832 2920 666f 7220 7020 696e 0a20 2020  x2) for p in.   
-0000e450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e460: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
-0000e470: 6e74 726f 6c5f 706f 696e 7473 5d0a 2020  ntrol_points].  
-0000e480: 2020 2020 2020 7265 7475 726e 2042 5370        return BSp
-0000e490: 6c69 6e65 4375 7276 6533 4428 7365 6c66  lineCurve3D(self
-0000e4a0: 2e64 6567 7265 652c 2063 6f6e 7472 6f6c  .degree, control
-0000e4b0: 5f70 6f69 6e74 7333 442c 0a20 2020 2020  _points3D,.     
-0000e4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e4d0: 2020 2020 2020 2020 2073 656c 662e 6b6e           self.kn
-0000e4e0: 6f74 5f6d 756c 7469 706c 6963 6974 6965  ot_multiplicitie
-0000e4f0: 732c 2073 656c 662e 6b6e 6f74 732c 0a20  s, self.knots,. 
-0000e500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e510: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000e520: 662e 7765 6967 6874 732c 2073 656c 662e  f.weights, self.
-0000e530: 7065 7269 6f64 6963 290a 0a20 2020 2064  periodic)..    d
-0000e540: 6566 2074 6f5f 7374 6570 2873 656c 662c  ef to_step(self,
-0000e550: 2063 7572 7265 6e74 5f69 642c 2073 7572   current_id, sur
-0000e560: 6661 6365 5f69 643d 4e6f 6e65 293a 0a20  face_id=None):. 
-0000e570: 2020 2020 2020 2070 6f69 6e74 735f 6964         points_id
-0000e580: 7320 3d20 5b5d 0a20 2020 2020 2020 2063  s = [].        c
-0000e590: 6f6e 7465 6e74 203d 2027 270a 2020 2020  ontent = ''.    
-0000e5a0: 2020 2020 706f 696e 745f 6964 203d 2063      point_id = c
-0000e5b0: 7572 7265 6e74 5f69 640a 2020 2020 2020  urrent_id.      
-0000e5c0: 2020 666f 7220 706f 696e 7420 696e 2073    for point in s
-0000e5d0: 656c 662e 636f 6e74 726f 6c5f 706f 696e  elf.control_poin
-0000e5e0: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-0000e5f0: 706f 696e 745f 636f 6e74 656e 742c 2070  point_content, p
-0000e600: 6f69 6e74 5f69 6420 3d20 706f 696e 742e  oint_id = point.
-0000e610: 746f 5f73 7465 7028 706f 696e 745f 6964  to_step(point_id
-0000e620: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000e630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e650: 2020 2020 2020 7665 7274 6578 3d46 616c        vertex=Fal
-0000e660: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
-0000e670: 636f 6e74 656e 7420 2b3d 2070 6f69 6e74  content += point
-0000e680: 5f63 6f6e 7465 6e74 0a20 2020 2020 2020  _content.       
-0000e690: 2020 2020 2070 6f69 6e74 735f 6964 732e       points_ids.
-0000e6a0: 6170 7065 6e64 2870 6f69 6e74 5f69 6429  append(point_id)
-0000e6b0: 0a20 2020 2020 2020 2020 2020 2070 6f69  .            poi
-0000e6c0: 6e74 5f69 6420 2b3d 2031 0a0a 2020 2020  nt_id += 1..    
-0000e6d0: 2020 2020 636f 6e74 656e 7420 2b3d 2022      content += "
-0000e6e0: 237b 7d20 3d20 425f 5350 4c49 4e45 5f43  #{} = B_SPLINE_C
-0000e6f0: 5552 5645 5f57 4954 485f 4b4e 4f54 5328  URVE_WITH_KNOTS(
-0000e700: 277b 7d27 2c7b 7d2c 287b 7d29 2c22 205c  '{}',{},({})," \
-0000e710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e720: 2020 2020 222e 554e 5350 4543 4946 4945      ".UNSPECIFIE
-0000e730: 442e 2c2e 462e 2c2e 462e 2c7b 7d2c 7b7d  D.,.F.,.F.,{},{}
-0000e740: 2c22 205c 0a20 2020 2020 2020 2020 2020  ," \.           
-0000e750: 2020 2020 2020 2020 222e 554e 5350 4543          ".UNSPEC
-0000e760: 4946 4945 442e 293b 5c6e 222e 666f 726d  IFIED.);\n".form
-0000e770: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-0000e780: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-0000e790: 5f69 642c 2073 656c 662e 6e61 6d65 2c20  _id, self.name, 
-0000e7a0: 7365 6c66 2e64 6567 7265 652c 0a20 2020  self.degree,.   
-0000e7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e7c0: 2020 2020 766f 6c6d 646c 722e 636f 7265      volmdlr.core
-0000e7d0: 2e73 7465 705f 6964 735f 746f 5f73 7472  .step_ids_to_str
-0000e7e0: 2870 6f69 6e74 735f 6964 7329 2c0a 2020  (points_ids),.  
-0000e7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e800: 2020 2020 2074 7570 6c65 2873 656c 662e       tuple(self.
-0000e810: 6b6e 6f74 5f6d 756c 7469 706c 6963 6974  knot_multiplicit
-0000e820: 6965 7329 2c0a 2020 2020 2020 2020 2020  ies),.          
-0000e830: 2020 2020 2020 2020 2020 2020 2074 7570               tup
-0000e840: 6c65 2873 656c 662e 6b6e 6f74 7329 290a  le(self.knots)).
-0000e850: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-0000e860: 6f6e 7465 6e74 2c20 706f 696e 745f 6964  ontent, point_id
-0000e870: 202b 2031 0a0a 2020 2020 6465 6620 726f   + 1..    def ro
-0000e880: 7461 7469 6f6e 2873 656c 662c 2063 656e  tation(self, cen
-0000e890: 7465 723a 2076 6f6c 6d64 6c72 2e50 6f69  ter: volmdlr.Poi
-0000e8a0: 6e74 3244 2c20 616e 676c 653a 2066 6c6f  nt2D, angle: flo
-0000e8b0: 6174 293a 0a20 2020 2020 2020 2022 2222  at):.        """
-0000e8c0: 0a20 2020 2020 2020 2042 5370 6c69 6e65  .        BSpline
-0000e8d0: 4375 7276 6532 4420 726f 7461 7469 6f6e  Curve2D rotation
-0000e8e0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0000e8f0: 6d20 6365 6e74 6572 3a20 726f 7461 7469  m center: rotati
-0000e900: 6f6e 2063 656e 7465 720a 2020 2020 2020  on center.      
-0000e910: 2020 3a70 6172 616d 2061 6e67 6c65 3a20    :param angle: 
-0000e920: 616e 676c 6520 726f 7461 7469 6f6e 0a20  angle rotation. 
-0000e930: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-0000e940: 6120 6e65 7720 726f 7461 7465 6420 4c69  a new rotated Li
-0000e950: 6e65 3244 0a20 2020 2020 2020 2022 2222  ne2D.        """
-0000e960: 0a20 2020 2020 2020 2063 6f6e 7472 6f6c  .        control
-0000e970: 5f70 6f69 6e74 7320 3d20 5b70 6f69 6e74  _points = [point
-0000e980: 2e72 6f74 6174 696f 6e28 6365 6e74 6572  .rotation(center
-0000e990: 2c20 616e 676c 6529 0a20 2020 2020 2020  , angle).       
-0000e9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e9b0: 2020 2066 6f72 2070 6f69 6e74 2069 6e20     for point in 
-0000e9c0: 7365 6c66 2e63 6f6e 7472 6f6c 5f70 6f69  self.control_poi
-0000e9d0: 6e74 735d 0a20 2020 2020 2020 2072 6574  nts].        ret
-0000e9e0: 7572 6e20 4253 706c 696e 6543 7572 7665  urn BSplineCurve
-0000e9f0: 3244 2873 656c 662e 6465 6772 6565 2c20  2D(self.degree, 
-0000ea00: 636f 6e74 726f 6c5f 706f 696e 7473 2c0a  control_points,.
-0000ea10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea20: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000ea30: 6c66 2e6b 6e6f 745f 6d75 6c74 6970 6c69  lf.knot_multipli
-0000ea40: 6369 7469 6573 2c20 7365 6c66 2e6b 6e6f  cities, self.kno
-0000ea50: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-0000ea60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea70: 2020 7365 6c66 2e77 6569 6768 7473 2c20    self.weights, 
-0000ea80: 7365 6c66 2e70 6572 696f 6469 6329 0a0a  self.periodic)..
-0000ea90: 2020 2020 6465 6620 726f 7461 7469 6f6e      def rotation
-0000eaa0: 5f69 6e70 6c61 6365 2873 656c 662c 2063  _inplace(self, c
-0000eab0: 656e 7465 723a 2076 6f6c 6d64 6c72 2e50  enter: volmdlr.P
-0000eac0: 6f69 6e74 3244 2c20 616e 676c 653a 2066  oint2D, angle: f
-0000ead0: 6c6f 6174 293a 0a20 2020 2020 2020 2022  loat):.        "
-0000eae0: 2222 0a20 2020 2020 2020 2042 5370 6c69  "".        BSpli
-0000eaf0: 6e65 4375 7276 6532 4420 726f 7461 7469  neCurve2D rotati
-0000eb00: 6f6e 2e20 4f62 6a65 6374 2069 7320 7570  on. Object is up
-0000eb10: 6461 7465 6420 696e 706c 6163 652e 0a0a  dated inplace...
-0000eb20: 2020 2020 2020 2020 3a70 6172 616d 2063          :param c
-0000eb30: 656e 7465 723a 2072 6f74 6174 696f 6e20  enter: rotation 
-0000eb40: 6365 6e74 6572 0a20 2020 2020 2020 203a  center.        :
-0000eb50: 7061 7261 6d20 616e 676c 653a 2072 6f74  param angle: rot
-0000eb60: 6174 696f 6e20 616e 676c 650a 2020 2020  ation angle.    
-0000eb70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000eb80: 7761 726e 696e 6773 2e77 6172 6e28 2227  warnings.warn("'
-0000eb90: 696e 706c 6163 6527 206d 6574 686f 6473  inplace' methods
-0000eba0: 2061 7265 2064 6570 7265 6361 7465 642e   are deprecated.
-0000ebb0: 2055 7365 2061 206e 6f74 2069 6e70 6c61   Use a not inpla
-0000ebc0: 6365 206d 6574 686f 6420 696e 7374 6561  ce method instea
-0000ebd0: 642e 222c 2044 6570 7265 6361 7469 6f6e  d.", Deprecation
-0000ebe0: 5761 726e 696e 6729 0a0a 2020 2020 2020  Warning)..      
-0000ebf0: 2020 666f 7220 706f 696e 7420 696e 2073    for point in s
-0000ec00: 656c 662e 636f 6e74 726f 6c5f 706f 696e  elf.control_poin
-0000ec10: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-0000ec20: 706f 696e 742e 726f 7461 7469 6f6e 5f69  point.rotation_i
-0000ec30: 6e70 6c61 6365 2863 656e 7465 722c 2061  nplace(center, a
-0000ec40: 6e67 6c65 290a 0a20 2020 2064 6566 206c  ngle)..    def l
-0000ec50: 696e 655f 6372 6f73 7369 6e67 7328 7365  ine_crossings(se
-0000ec60: 6c66 2c20 6c69 6e65 3264 3a20 4c69 6e65  lf, line2d: Line
-0000ec70: 3244 293a 0a20 2020 2020 2020 2070 6f6c  2D):.        pol
-0000ec80: 7967 6f6e 5f70 6f69 6e74 7320 3d20 7365  ygon_points = se
-0000ec90: 6c66 2e64 6973 6372 6574 697a 6174 696f  lf.discretizatio
-0000eca0: 6e5f 706f 696e 7473 286e 756d 6265 725f  n_points(number_
-0000ecb0: 706f 696e 7473 3d35 3029 0a20 2020 2020  points=50).     
-0000ecc0: 2020 2063 726f 7373 696e 6773 203d 205b     crossings = [
-0000ecd0: 5d0a 2020 2020 2020 2020 666f 7220 7031  ].        for p1
-0000ece0: 2c20 7032 2069 6e20 7a69 7028 706f 6c79  , p2 in zip(poly
-0000ecf0: 676f 6e5f 706f 696e 7473 5b3a 2d31 5d2c  gon_points[:-1],
-0000ed00: 2070 6f6c 7967 6f6e 5f70 6f69 6e74 735b   polygon_points[
-0000ed10: 313a 5d29 3a0a 2020 2020 2020 2020 2020  1:]):.          
-0000ed20: 2020 6c69 6e65 7365 676d 656e 7420 3d20    linesegment = 
-0000ed30: 4c69 6e65 5365 676d 656e 7432 4428 7031  LineSegment2D(p1
-0000ed40: 2c20 7032 290a 2020 2020 2020 2020 2020  , p2).          
-0000ed50: 2020 6372 6f73 7369 6e67 732e 6578 7465    crossings.exte
-0000ed60: 6e64 286c 696e 6573 6567 6d65 6e74 2e6c  nd(linesegment.l
-0000ed70: 696e 655f 6372 6f73 7369 6e67 7328 6c69  ine_crossings(li
-0000ed80: 6e65 3264 2929 0a20 2020 2020 2020 2072  ne2d)).        r
-0000ed90: 6574 7572 6e20 6372 6f73 7369 6e67 730a  eturn crossings.
-0000eda0: 0a20 2020 2064 6566 2074 6f5f 7769 7265  .    def to_wire
-0000edb0: 2873 656c 662c 206e 3a20 696e 7429 3a0a  (self, n: int):.
-0000edc0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000edd0: 2020 2020 436f 6e76 6572 7420 6120 4273      Convert a Bs
-0000ede0: 706c 696e 6520 6375 7276 6520 746f 2061  pline curve to a
-0000edf0: 2077 6972 6532 6420 6465 6669 6e65 6420   wire2d defined 
-0000ee00: 7769 7468 2027 6e27 206c 696e 655f 7365  with 'n' line_se
-0000ee10: 676d 656e 7473 2e0a 0a20 2020 2020 2020  gments...       
-0000ee20: 2022 2222 0a0a 2020 2020 2020 2020 7520   """..        u 
-0000ee30: 3d20 6e70 792e 6c69 6e73 7061 6365 2830  = npy.linspace(0
-0000ee40: 2c20 312c 206e 756d 3d6e 202b 2031 292e  , 1, num=n + 1).
-0000ee50: 746f 6c69 7374 2829 0a20 2020 2020 2020  tolist().       
-0000ee60: 2070 6f69 6e74 7320 3d20 5b5d 0a20 2020   points = [].   
-0000ee70: 2020 2020 2066 6f72 2075 3020 696e 2075       for u0 in u
-0000ee80: 3a0a 2020 2020 2020 2020 2020 2020 7020  :.            p 
-0000ee90: 3d20 7365 6c66 2e63 7572 7665 2e65 7661  = self.curve.eva
-0000eea0: 6c75 6174 655f 7369 6e67 6c65 2875 3029  luate_single(u0)
-0000eeb0: 0a20 2020 2020 2020 2020 2020 2070 6f69  .            poi
-0000eec0: 6e74 732e 6170 7065 6e64 2876 6f6c 6d64  nts.append(volmd
-0000eed0: 6c72 2e50 6f69 6e74 3244 2870 5b30 5d2c  lr.Point2D(p[0],
-0000eee0: 2070 5b31 5d29 290a 0a20 2020 2020 2020   p[1]))..       
-0000eef0: 2072 6574 7572 6e20 766f 6c6d 646c 722e   return volmdlr.
-0000ef00: 7769 7265 732e 5769 7265 3244 2e66 726f  wires.Wire2D.fro
-0000ef10: 6d5f 706f 696e 7473 2870 6f69 6e74 7329  m_points(points)
-0000ef20: 0a0a 2020 2020 6465 6620 7265 7665 7273  ..    def revers
-0000ef30: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-0000ef40: 2022 2222 0a20 2020 2020 2020 2052 6576   """.        Rev
-0000ef50: 6572 7365 2074 6865 2042 7370 6c69 6e65  erse the Bspline
-0000ef60: 2773 2064 6972 6563 7469 6f6e 2062 7920  's direction by 
-0000ef70: 7265 7665 7273 696e 6720 6974 7320 7374  reversing its st
-0000ef80: 6172 7420 616e 6420 656e 6420 706f 696e  art and end poin
-0000ef90: 7473 2e0a 0a20 2020 2020 2020 2022 2222  ts...        """
-0000efa0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000efb0: 2073 656c 662e 5f5f 636c 6173 735f 5f28   self.__class__(
-0000efc0: 6465 6772 6565 3d73 656c 662e 6465 6772  degree=self.degr
-0000efd0: 6565 2c0a 2020 2020 2020 2020 2020 2020  ee,.            
-0000efe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eff0: 2020 636f 6e74 726f 6c5f 706f 696e 7473    control_points
-0000f000: 3d73 656c 662e 636f 6e74 726f 6c5f 706f  =self.control_po
-0000f010: 696e 7473 5b3a 3a2d 315d 2c0a 2020 2020  ints[::-1],.    
-0000f020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f030: 2020 2020 2020 2020 2020 6b6e 6f74 5f6d            knot_m
-0000f040: 756c 7469 706c 6963 6974 6965 733d 7365  ultiplicities=se
-0000f050: 6c66 2e6b 6e6f 745f 6d75 6c74 6970 6c69  lf.knot_multipli
-0000f060: 6369 7469 6573 5b3a 3a2d 315d 2c0a 2020  cities[::-1],.  
+0000e160: 2020 2020 2020 2022 2222 5374 7261 6967         """Straig
+0000e170: 6874 206c 696e 6520 6365 6e74 6572 206f  ht line center o
+0000e180: 6620 6d61 7373 2e22 2222 0a20 2020 2020  f mass.""".     
+0000e190: 2020 2070 6f6c 7967 6f6e 5f70 6f69 6e74     polygon_point
+0000e1a0: 7320 3d20 7365 6c66 2e64 6973 6372 6574  s = self.discret
+0000e1b0: 697a 6174 696f 6e5f 706f 696e 7473 286e  ization_points(n
+0000e1c0: 756d 6265 725f 706f 696e 7473 3d31 3030  umber_points=100
+0000e1d0: 290a 2020 2020 2020 2020 636f 6720 3d20  ).        cog = 
+0000e1e0: 766f 6c6d 646c 722e 4f32 440a 2020 2020  volmdlr.O2D.    
+0000e1f0: 2020 2020 666f 7220 706f 696e 7420 696e      for point in
+0000e200: 2070 6f6c 7967 6f6e 5f70 6f69 6e74 733a   polygon_points:
+0000e210: 0a20 2020 2020 2020 2020 2020 2063 6f67  .            cog
+0000e220: 202b 3d20 706f 696e 740a 2020 2020 2020   += point.      
+0000e230: 2020 636f 6720 3d20 636f 6720 2f20 6c65    cog = cog / le
+0000e240: 6e28 706f 6c79 676f 6e5f 706f 696e 7473  n(polygon_points
+0000e250: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0000e260: 2063 6f67 0a0a 2020 2020 6465 6620 706c   cog..    def pl
+0000e270: 6f74 2873 656c 662c 2061 783d 4e6f 6e65  ot(self, ax=None
+0000e280: 2c20 636f 6c6f 723d 276b 272c 2061 6c70  , color='k', alp
+0000e290: 6861 3d31 2c20 706c 6f74 5f70 6f69 6e74  ha=1, plot_point
+0000e2a0: 733d 4661 6c73 6529 3a0a 2020 2020 2020  s=False):.      
+0000e2b0: 2020 6966 2061 7820 6973 204e 6f6e 653a    if ax is None:
+0000e2c0: 0a20 2020 2020 2020 2020 2020 205f 2c20  .            _, 
+0000e2d0: 6178 203d 2070 6c74 2e73 7562 706c 6f74  ax = plt.subplot
+0000e2e0: 7328 290a 0a20 2020 2020 2020 2070 6f69  s()..        poi
+0000e2f0: 6e74 7320 3d20 7365 6c66 2e70 6f69 6e74  nts = self.point
+0000e300: 730a 0a20 2020 2020 2020 2078 5f70 6f69  s..        x_poi
+0000e310: 6e74 7320 3d20 5b70 2e78 2066 6f72 2070  nts = [p.x for p
+0000e320: 2069 6e20 706f 696e 7473 5d0a 2020 2020   in points].    
+0000e330: 2020 2020 795f 706f 696e 7473 203d 205b      y_points = [
+0000e340: 702e 7920 666f 7220 7020 696e 2070 6f69  p.y for p in poi
+0000e350: 6e74 735d 0a20 2020 2020 2020 2061 782e  nts].        ax.
+0000e360: 706c 6f74 2878 5f70 6f69 6e74 732c 2079  plot(x_points, y
+0000e370: 5f70 6f69 6e74 732c 2063 6f6c 6f72 3d63  _points, color=c
+0000e380: 6f6c 6f72 2c20 616c 7068 613d 616c 7068  olor, alpha=alph
+0000e390: 6129 0a20 2020 2020 2020 2069 6620 706c  a).        if pl
+0000e3a0: 6f74 5f70 6f69 6e74 733a 0a20 2020 2020  ot_points:.     
+0000e3b0: 2020 2020 2020 2066 6f72 2070 6f69 6e74         for point
+0000e3c0: 2069 6e20 706f 696e 7473 3a0a 2020 2020   in points:.    
+0000e3d0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+0000e3e0: 742e 706c 6f74 2861 782c 2063 6f6c 6f72  t.plot(ax, color
+0000e3f0: 3d63 6f6c 6f72 290a 2020 2020 2020 2020  =color).        
+0000e400: 7265 7475 726e 2061 780a 0a20 2020 2064  return ax..    d
+0000e410: 6566 2074 6f5f 3364 2873 656c 662c 2070  ef to_3d(self, p
+0000e420: 6c61 6e65 5f6f 7269 6769 6e2c 2078 312c  lane_origin, x1,
+0000e430: 2078 3229 3a0a 2020 2020 2020 2020 636f   x2):.        co
+0000e440: 6e74 726f 6c5f 706f 696e 7473 3344 203d  ntrol_points3D =
+0000e450: 205b 702e 746f 5f33 6428 706c 616e 655f   [p.to_3d(plane_
+0000e460: 6f72 6967 696e 2c20 7831 2c20 7832 2920  origin, x1, x2) 
+0000e470: 666f 7220 7020 696e 0a20 2020 2020 2020  for p in.       
+0000e480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e490: 2020 2020 2073 656c 662e 636f 6e74 726f       self.contro
+0000e4a0: 6c5f 706f 696e 7473 5d0a 2020 2020 2020  l_points].      
+0000e4b0: 2020 7265 7475 726e 2042 5370 6c69 6e65    return BSpline
+0000e4c0: 4375 7276 6533 4428 7365 6c66 2e64 6567  Curve3D(self.deg
+0000e4d0: 7265 652c 2063 6f6e 7472 6f6c 5f70 6f69  ree, control_poi
+0000e4e0: 6e74 7333 442c 0a20 2020 2020 2020 2020  nts3D,.         
+0000e4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e500: 2020 2020 2073 656c 662e 6b6e 6f74 5f6d       self.knot_m
+0000e510: 756c 7469 706c 6963 6974 6965 732c 2073  ultiplicities, s
+0000e520: 656c 662e 6b6e 6f74 732c 0a20 2020 2020  elf.knots,.     
+0000e530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e540: 2020 2020 2020 2020 2073 656c 662e 7765           self.we
+0000e550: 6967 6874 732c 2073 656c 662e 7065 7269  ights, self.peri
+0000e560: 6f64 6963 290a 0a20 2020 2064 6566 2074  odic)..    def t
+0000e570: 6f5f 7374 6570 2873 656c 662c 2063 7572  o_step(self, cur
+0000e580: 7265 6e74 5f69 642c 2073 7572 6661 6365  rent_id, surface
+0000e590: 5f69 643d 4e6f 6e65 293a 0a20 2020 2020  _id=None):.     
+0000e5a0: 2020 2022 2222 4578 706f 7274 7320 746f     """Exports to
+0000e5b0: 2053 5445 5020 666f 726d 6174 2e22 2222   STEP format."""
+0000e5c0: 0a20 2020 2020 2020 2070 6f69 6e74 735f  .        points_
+0000e5d0: 6964 7320 3d20 5b5d 0a20 2020 2020 2020  ids = [].       
+0000e5e0: 2063 6f6e 7465 6e74 203d 2027 270a 2020   content = ''.  
+0000e5f0: 2020 2020 2020 706f 696e 745f 6964 203d        point_id =
+0000e600: 2063 7572 7265 6e74 5f69 640a 2020 2020   current_id.    
+0000e610: 2020 2020 666f 7220 706f 696e 7420 696e      for point in
+0000e620: 2073 656c 662e 636f 6e74 726f 6c5f 706f   self.control_po
+0000e630: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
+0000e640: 2020 706f 696e 745f 636f 6e74 656e 742c    point_content,
+0000e650: 2070 6f69 6e74 5f69 6420 3d20 706f 696e   point_id = poin
+0000e660: 742e 746f 5f73 7465 7028 706f 696e 745f  t.to_step(point_
+0000e670: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
+0000e680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e6a0: 2020 2020 2020 2020 7665 7274 6578 3d46          vertex=F
+0000e6b0: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
+0000e6c0: 2020 636f 6e74 656e 7420 2b3d 2070 6f69    content += poi
+0000e6d0: 6e74 5f63 6f6e 7465 6e74 0a20 2020 2020  nt_content.     
+0000e6e0: 2020 2020 2020 2070 6f69 6e74 735f 6964         points_id
+0000e6f0: 732e 6170 7065 6e64 2870 6f69 6e74 5f69  s.append(point_i
+0000e700: 6429 0a20 2020 2020 2020 2020 2020 2070  d).            p
+0000e710: 6f69 6e74 5f69 6420 2b3d 2031 0a0a 2020  oint_id += 1..  
+0000e720: 2020 2020 2020 636f 6e74 656e 7420 2b3d        content +=
+0000e730: 2022 237b 7d20 3d20 425f 5350 4c49 4e45   "#{} = B_SPLINE
+0000e740: 5f43 5552 5645 5f57 4954 485f 4b4e 4f54  _CURVE_WITH_KNOT
+0000e750: 5328 277b 7d27 2c7b 7d2c 287b 7d29 2c22  S('{}',{},({}),"
+0000e760: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+0000e770: 2020 2020 2020 222e 554e 5350 4543 4946        ".UNSPECIF
+0000e780: 4945 442e 2c2e 462e 2c2e 462e 2c7b 7d2c  IED.,.F.,.F.,{},
+0000e790: 7b7d 2c22 205c 0a20 2020 2020 2020 2020  {}," \.         
+0000e7a0: 2020 2020 2020 2020 2020 222e 554e 5350            ".UNSP
+0000e7b0: 4543 4946 4945 442e 293b 5c6e 222e 666f  ECIFIED.);\n".fo
+0000e7c0: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
+0000e7d0: 2020 2020 2020 2020 2020 2020 2070 6f69               poi
+0000e7e0: 6e74 5f69 642c 2073 656c 662e 6e61 6d65  nt_id, self.name
+0000e7f0: 2c20 7365 6c66 2e64 6567 7265 652c 0a20  , self.degree,. 
+0000e800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e810: 2020 2020 2020 766f 6c6d 646c 722e 636f        volmdlr.co
+0000e820: 7265 2e73 7465 705f 6964 735f 746f 5f73  re.step_ids_to_s
+0000e830: 7472 2870 6f69 6e74 735f 6964 7329 2c0a  tr(points_ids),.
+0000e840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e850: 2020 2020 2020 2074 7570 6c65 2873 656c         tuple(sel
+0000e860: 662e 6b6e 6f74 5f6d 756c 7469 706c 6963  f.knot_multiplic
+0000e870: 6974 6965 7329 2c0a 2020 2020 2020 2020  ities),.        
+0000e880: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0000e890: 7570 6c65 2873 656c 662e 6b6e 6f74 7329  uple(self.knots)
+0000e8a0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0000e8b0: 2063 6f6e 7465 6e74 2c20 706f 696e 745f   content, point_
+0000e8c0: 6964 202b 2031 0a0a 2020 2020 6465 6620  id + 1..    def 
+0000e8d0: 726f 7461 7469 6f6e 2873 656c 662c 2063  rotation(self, c
+0000e8e0: 656e 7465 723a 2076 6f6c 6d64 6c72 2e50  enter: volmdlr.P
+0000e8f0: 6f69 6e74 3244 2c20 616e 676c 653a 2066  oint2D, angle: f
+0000e900: 6c6f 6174 293a 0a20 2020 2020 2020 2022  loat):.        "
+0000e910: 2222 0a20 2020 2020 2020 2042 5370 6c69  "".        BSpli
+0000e920: 6e65 4375 7276 6532 4420 726f 7461 7469  neCurve2D rotati
+0000e930: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
+0000e940: 7261 6d20 6365 6e74 6572 3a20 726f 7461  ram center: rota
+0000e950: 7469 6f6e 2063 656e 7465 720a 2020 2020  tion center.    
+0000e960: 2020 2020 3a70 6172 616d 2061 6e67 6c65      :param angle
+0000e970: 3a20 616e 676c 6520 726f 7461 7469 6f6e  : angle rotation
+0000e980: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+0000e990: 3a20 6120 6e65 7720 726f 7461 7465 6420  : a new rotated 
+0000e9a0: 4c69 6e65 3244 0a20 2020 2020 2020 2022  Line2D.        "
+0000e9b0: 2222 0a20 2020 2020 2020 2063 6f6e 7472  "".        contr
+0000e9c0: 6f6c 5f70 6f69 6e74 7320 3d20 5b70 6f69  ol_points = [poi
+0000e9d0: 6e74 2e72 6f74 6174 696f 6e28 6365 6e74  nt.rotation(cent
+0000e9e0: 6572 2c20 616e 676c 6529 0a20 2020 2020  er, angle).     
+0000e9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ea00: 2020 2020 2066 6f72 2070 6f69 6e74 2069       for point i
+0000ea10: 6e20 7365 6c66 2e63 6f6e 7472 6f6c 5f70  n self.control_p
+0000ea20: 6f69 6e74 735d 0a20 2020 2020 2020 2072  oints].        r
+0000ea30: 6574 7572 6e20 4253 706c 696e 6543 7572  eturn BSplineCur
+0000ea40: 7665 3244 2873 656c 662e 6465 6772 6565  ve2D(self.degree
+0000ea50: 2c20 636f 6e74 726f 6c5f 706f 696e 7473  , control_points
+0000ea60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ea80: 7365 6c66 2e6b 6e6f 745f 6d75 6c74 6970  self.knot_multip
+0000ea90: 6c69 6369 7469 6573 2c20 7365 6c66 2e6b  licities, self.k
+0000eaa0: 6e6f 7473 2c0a 2020 2020 2020 2020 2020  nots,.          
+0000eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eac0: 2020 2020 7365 6c66 2e77 6569 6768 7473      self.weights
+0000ead0: 2c20 7365 6c66 2e70 6572 696f 6469 6329  , self.periodic)
+0000eae0: 0a0a 2020 2020 6465 6620 726f 7461 7469  ..    def rotati
+0000eaf0: 6f6e 5f69 6e70 6c61 6365 2873 656c 662c  on_inplace(self,
+0000eb00: 2063 656e 7465 723a 2076 6f6c 6d64 6c72   center: volmdlr
+0000eb10: 2e50 6f69 6e74 3244 2c20 616e 676c 653a  .Point2D, angle:
+0000eb20: 2066 6c6f 6174 293a 0a20 2020 2020 2020   float):.       
+0000eb30: 2022 2222 0a20 2020 2020 2020 2042 5370   """.        BSp
+0000eb40: 6c69 6e65 4375 7276 6532 4420 726f 7461  lineCurve2D rota
+0000eb50: 7469 6f6e 2e20 4f62 6a65 6374 2069 7320  tion. Object is 
+0000eb60: 7570 6461 7465 6420 696e 706c 6163 652e  updated inplace.
+0000eb70: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000eb80: 2063 656e 7465 723a 2072 6f74 6174 696f   center: rotatio
+0000eb90: 6e20 6365 6e74 6572 0a20 2020 2020 2020  n center.       
+0000eba0: 203a 7061 7261 6d20 616e 676c 653a 2072   :param angle: r
+0000ebb0: 6f74 6174 696f 6e20 616e 676c 650a 2020  otation angle.  
+0000ebc0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000ebd0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+0000ebe0: 2227 696e 706c 6163 6527 206d 6574 686f  "'inplace' metho
+0000ebf0: 6473 2061 7265 2064 6570 7265 6361 7465  ds are deprecate
+0000ec00: 642e 2055 7365 2061 206e 6f74 2069 6e70  d. Use a not inp
+0000ec10: 6c61 6365 206d 6574 686f 6420 696e 7374  lace method inst
+0000ec20: 6561 642e 222c 2044 6570 7265 6361 7469  ead.", Deprecati
+0000ec30: 6f6e 5761 726e 696e 6729 0a0a 2020 2020  onWarning)..    
+0000ec40: 2020 2020 666f 7220 706f 696e 7420 696e      for point in
+0000ec50: 2073 656c 662e 636f 6e74 726f 6c5f 706f   self.control_po
+0000ec60: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
+0000ec70: 2020 706f 696e 742e 726f 7461 7469 6f6e    point.rotation
+0000ec80: 5f69 6e70 6c61 6365 2863 656e 7465 722c  _inplace(center,
+0000ec90: 2061 6e67 6c65 290a 0a20 2020 2064 6566   angle)..    def
+0000eca0: 206c 696e 655f 6372 6f73 7369 6e67 7328   line_crossings(
+0000ecb0: 7365 6c66 2c20 6c69 6e65 3264 3a20 4c69  self, line2d: Li
+0000ecc0: 6e65 3244 293a 0a20 2020 2020 2020 2070  ne2D):.        p
+0000ecd0: 6f6c 7967 6f6e 5f70 6f69 6e74 7320 3d20  olygon_points = 
+0000ece0: 7365 6c66 2e64 6973 6372 6574 697a 6174  self.discretizat
+0000ecf0: 696f 6e5f 706f 696e 7473 286e 756d 6265  ion_points(numbe
+0000ed00: 725f 706f 696e 7473 3d35 3029 0a20 2020  r_points=50).   
+0000ed10: 2020 2020 2063 726f 7373 696e 6773 203d       crossings =
+0000ed20: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
+0000ed30: 7031 2c20 7032 2069 6e20 7a69 7028 706f  p1, p2 in zip(po
+0000ed40: 6c79 676f 6e5f 706f 696e 7473 5b3a 2d31  lygon_points[:-1
+0000ed50: 5d2c 2070 6f6c 7967 6f6e 5f70 6f69 6e74  ], polygon_point
+0000ed60: 735b 313a 5d29 3a0a 2020 2020 2020 2020  s[1:]):.        
+0000ed70: 2020 2020 6c69 6e65 7365 676d 656e 7420      linesegment 
+0000ed80: 3d20 4c69 6e65 5365 676d 656e 7432 4428  = LineSegment2D(
+0000ed90: 7031 2c20 7032 290a 2020 2020 2020 2020  p1, p2).        
+0000eda0: 2020 2020 6372 6f73 7369 6e67 732e 6578      crossings.ex
+0000edb0: 7465 6e64 286c 696e 6573 6567 6d65 6e74  tend(linesegment
+0000edc0: 2e6c 696e 655f 6372 6f73 7369 6e67 7328  .line_crossings(
+0000edd0: 6c69 6e65 3264 2929 0a20 2020 2020 2020  line2d)).       
+0000ede0: 2072 6574 7572 6e20 6372 6f73 7369 6e67   return crossing
+0000edf0: 730a 0a20 2020 2064 6566 2074 6f5f 7769  s..    def to_wi
+0000ee00: 7265 2873 656c 662c 206e 3a20 696e 7429  re(self, n: int)
+0000ee10: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000ee20: 2020 2020 2020 436f 6e76 6572 7420 6120        Convert a 
+0000ee30: 4273 706c 696e 6520 6375 7276 6520 746f  Bspline curve to
+0000ee40: 2061 2077 6972 6532 6420 6465 6669 6e65   a wire2d define
+0000ee50: 6420 7769 7468 2027 6e27 206c 696e 655f  d with 'n' line_
+0000ee60: 7365 676d 656e 7473 2e0a 0a20 2020 2020  segments...     
+0000ee70: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0000ee80: 7520 3d20 6e70 792e 6c69 6e73 7061 6365  u = npy.linspace
+0000ee90: 2830 2c20 312c 206e 756d 3d6e 202b 2031  (0, 1, num=n + 1
+0000eea0: 292e 746f 6c69 7374 2829 0a20 2020 2020  ).tolist().     
+0000eeb0: 2020 2070 6f69 6e74 7320 3d20 5b5d 0a20     points = []. 
+0000eec0: 2020 2020 2020 2066 6f72 2075 3020 696e         for u0 in
+0000eed0: 2075 3a0a 2020 2020 2020 2020 2020 2020   u:.            
+0000eee0: 7020 3d20 7365 6c66 2e63 7572 7665 2e65  p = self.curve.e
+0000eef0: 7661 6c75 6174 655f 7369 6e67 6c65 2875  valuate_single(u
+0000ef00: 3029 0a20 2020 2020 2020 2020 2020 2070  0).            p
+0000ef10: 6f69 6e74 732e 6170 7065 6e64 2876 6f6c  oints.append(vol
+0000ef20: 6d64 6c72 2e50 6f69 6e74 3244 2870 5b30  mdlr.Point2D(p[0
+0000ef30: 5d2c 2070 5b31 5d29 290a 0a20 2020 2020  ], p[1]))..     
+0000ef40: 2020 2072 6574 7572 6e20 766f 6c6d 646c     return volmdl
+0000ef50: 722e 7769 7265 732e 5769 7265 3244 2e66  r.wires.Wire2D.f
+0000ef60: 726f 6d5f 706f 696e 7473 2870 6f69 6e74  rom_points(point
+0000ef70: 7329 0a0a 2020 2020 6465 6620 7265 7665  s)..    def reve
+0000ef80: 7273 6528 7365 6c66 293a 0a20 2020 2020  rse(self):.     
+0000ef90: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+0000efa0: 6576 6572 7365 2074 6865 2042 7370 6c69  everse the Bspli
+0000efb0: 6e65 2773 2064 6972 6563 7469 6f6e 2062  ne's direction b
+0000efc0: 7920 7265 7665 7273 696e 6720 6974 7320  y reversing its 
+0000efd0: 7374 6172 7420 616e 6420 656e 6420 706f  start and end po
+0000efe0: 696e 7473 2e0a 0a20 2020 2020 2020 2022  ints...        "
+0000eff0: 2222 0a0a 2020 2020 2020 2020 7265 7475  ""..        retu
+0000f000: 726e 2073 656c 662e 5f5f 636c 6173 735f  rn self.__class_
+0000f010: 5f28 6465 6772 6565 3d73 656c 662e 6465  _(degree=self.de
+0000f020: 6772 6565 2c0a 2020 2020 2020 2020 2020  gree,.          
+0000f030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f040: 2020 2020 636f 6e74 726f 6c5f 706f 696e      control_poin
+0000f050: 7473 3d73 656c 662e 636f 6e74 726f 6c5f  ts=self.control_
+0000f060: 706f 696e 7473 5b3a 3a2d 315d 2c0a 2020  points[::-1],.  
 0000f070: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000f080: 2020 2020 2020 2020 2020 2020 6b6e 6f74              knot
-0000f090: 733d 7365 6c66 2e6b 6e6f 7473 5b3a 3a2d  s=self.knots[::-
-0000f0a0: 315d 2c0a 2020 2020 2020 2020 2020 2020  1],.            
-0000f0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f0c0: 2020 7765 6967 6874 733d 7365 6c66 2e77    weights=self.w
-0000f0d0: 6569 6768 7473 2c0a 2020 2020 2020 2020  eights,.        
-0000f0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f0f0: 2020 2020 2020 7065 7269 6f64 6963 3d73        periodic=s
-0000f100: 656c 662e 7065 7269 6f64 6963 290a 0a20  elf.periodic).. 
-0000f110: 2020 2064 6566 2070 6f69 6e74 5f64 6973     def point_dis
-0000f120: 7461 6e63 6528 7365 6c66 2c20 706f 696e  tance(self, poin
-0000f130: 7429 3a0a 2020 2020 2020 2020 6469 7374  t):.        dist
-0000f140: 616e 6365 203d 206d 6174 682e 696e 660a  ance = math.inf.
-0000f150: 2020 2020 2020 2020 706f 6c79 676f 6e5f          polygon_
-0000f160: 706f 696e 7473 203d 2073 656c 662e 706f  points = self.po
-0000f170: 696e 7473 0a20 2020 2020 2020 2066 6f72  ints.        for
-0000f180: 2070 312c 2070 3220 696e 207a 6970 2870   p1, p2 in zip(p
-0000f190: 6f6c 7967 6f6e 5f70 6f69 6e74 735b 3a2d  olygon_points[:-
-0000f1a0: 315d 2c20 706f 6c79 676f 6e5f 706f 696e  1], polygon_poin
-0000f1b0: 7473 5b31 3a5d 293a 0a20 2020 2020 2020  ts[1:]):.       
-0000f1c0: 2020 2020 206c 696e 6520 3d20 4c69 6e65       line = Line
-0000f1d0: 5365 676d 656e 7432 4428 7031 2c20 7032  Segment2D(p1, p2
-0000f1e0: 290a 2020 2020 2020 2020 2020 2020 6469  ).            di
-0000f1f0: 7374 203d 206c 696e 652e 706f 696e 745f  st = line.point_
-0000f200: 6469 7374 616e 6365 2870 6f69 6e74 290a  distance(point).
-0000f210: 2020 2020 2020 2020 2020 2020 6966 2064              if d
-0000f220: 6973 7420 3c20 6469 7374 616e 6365 3a0a  ist < distance:.
-0000f230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f240: 6469 7374 616e 6365 203d 2064 6973 740a  distance = dist.
-0000f250: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-0000f260: 6973 7461 6e63 650a 0a20 2020 2064 6566  istance..    def
-0000f270: 206e 6561 7265 7374 5f70 6f69 6e74 5f74   nearest_point_t
-0000f280: 6f28 7365 6c66 2c20 706f 696e 7429 3a0a  o(self, point):.
-0000f290: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000f2a0: 2020 2020 4669 6e64 206f 7574 2074 6865      Find out the
-0000f2b0: 206e 6561 7265 7374 2070 6f69 6e74 206f   nearest point o
-0000f2c0: 6e20 7468 6520 6c69 6e65 7365 676d 656e  n the linesegmen
-0000f2d0: 7420 746f 2070 6f69 6e74 2e0a 0a20 2020  t to point...   
-0000f2e0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0000f2f0: 2020 706f 696e 7473 203d 2073 656c 662e    points = self.
-0000f300: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
-0000f310: 6f69 6e74 7328 6e75 6d62 6572 5f70 6f69  oints(number_poi
-0000f320: 6e74 733d 3530 3029 0a20 2020 2020 2020  nts=500).       
-0000f330: 2072 6574 7572 6e20 706f 696e 742e 6e65   return point.ne
-0000f340: 6172 6573 745f 706f 696e 7428 706f 696e  arest_point(poin
-0000f350: 7473 290a 0a20 2020 2064 6566 206c 696e  ts)..    def lin
-0000f360: 6573 6567 6d65 6e74 5f69 6e74 6572 7365  esegment_interse
-0000f370: 6374 696f 6e73 2873 656c 662c 206c 696e  ctions(self, lin
-0000f380: 6573 6567 6d65 6e74 3264 293a 0a20 2020  esegment2d):.   
-0000f390: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000f3a0: 2043 616c 6375 6c61 7465 7320 696e 7465   Calculates inte
-0000f3b0: 7273 6563 7469 6f6e 7320 6265 7477 6565  rsections betwee
-0000f3c0: 6e20 6120 4253 706c 696e 6543 7572 7665  n a BSplineCurve
-0000f3d0: 3244 2061 6e64 2061 204c 696e 6553 6567  2D and a LineSeg
-0000f3e0: 6d65 6e74 3244 2e0a 0a20 2020 2020 2020  ment2D...       
-0000f3f0: 203a 7061 7261 6d20 6c69 6e65 7365 676d   :param linesegm
-0000f400: 656e 7432 643a 206c 696e 6573 6567 6d65  ent2d: linesegme
-0000f410: 6e74 2074 6f20 7665 7269 6679 2069 6e74  nt to verify int
-0000f420: 6572 7365 6374 696f 6e73 2e0a 2020 2020  ersections..    
-0000f430: 2020 2020 3a72 6574 7572 6e3a 206c 6973      :return: lis
-0000f440: 7420 7769 7468 2074 6865 2069 6e74 6572  t with the inter
-0000f450: 7365 6374 696f 6e73 2070 6f69 6e74 732e  sections points.
-0000f460: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000f470: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-0000f480: 2e62 6f75 6e64 696e 675f 7265 6374 616e  .bounding_rectan
-0000f490: 676c 652e 625f 7265 6374 616e 676c 655f  gle.b_rectangle_
-0000f4a0: 696e 7465 7273 6563 7469 6f6e 286c 696e  intersection(lin
-0000f4b0: 6573 6567 6d65 6e74 3264 2e62 6f75 6e64  esegment2d.bound
-0000f4c0: 696e 675f 7265 6374 616e 676c 6529 3a0a  ing_rectangle):.
-0000f4d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000f4e0: 726e 205b 5d0a 2020 2020 2020 2020 696e  rn [].        in
-0000f4f0: 7465 7273 6563 7469 6f6e 735f 706f 696e  tersections_poin
-0000f500: 7473 203d 2073 656c 662e 6765 745f 6c69  ts = self.get_li
-0000f510: 6e65 7365 676d 656e 745f 696e 7465 7273  nesegment_inters
-0000f520: 6563 7469 6f6e 7328 6c69 6e65 7365 676d  ections(linesegm
-0000f530: 656e 7432 6429 0a20 2020 2020 2020 2072  ent2d).        r
-0000f540: 6574 7572 6e20 696e 7465 7273 6563 7469  eturn intersecti
-0000f550: 6f6e 735f 706f 696e 7473 0a0a 2020 2020  ons_points..    
-0000f560: 6465 6620 6178 6961 6c5f 7379 6d6d 6574  def axial_symmet
-0000f570: 7279 2873 656c 662c 206c 696e 6529 3a0a  ry(self, line):.
-0000f580: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000f590: 2020 2020 4669 6e64 7320 6f75 7420 7468      Finds out th
-0000f5a0: 6520 7379 6d6d 6574 7269 6320 6273 706c  e symmetric bspl
-0000f5b0: 696e 6563 7572 7665 3264 2061 6363 6f72  inecurve2d accor
-0000f5c0: 6469 6e67 2074 6f20 6120 6c69 6e65 2e0a  ding to a line..
-0000f5d0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-0000f5e0: 2020 2020 2020 706f 696e 7473 5f73 796d        points_sym
-0000f5f0: 6d65 7472 7920 3d20 5b70 6f69 6e74 2e61  metry = [point.a
-0000f600: 7869 616c 5f73 796d 6d65 7472 7928 6c69  xial_symmetry(li
-0000f610: 6e65 2920 666f 7220 706f 696e 7420 696e  ne) for point in
-0000f620: 2073 656c 662e 636f 6e74 726f 6c5f 706f   self.control_po
-0000f630: 696e 7473 5d0a 0a20 2020 2020 2020 2072  ints]..        r
-0000f640: 6574 7572 6e20 7365 6c66 2e5f 5f63 6c61  eturn self.__cla
-0000f650: 7373 5f5f 2864 6567 7265 653d 7365 6c66  ss__(degree=self
-0000f660: 2e64 6567 7265 652c 0a20 2020 2020 2020  .degree,.       
-0000f670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f680: 2020 2020 2020 2063 6f6e 7472 6f6c 5f70         control_p
-0000f690: 6f69 6e74 733d 706f 696e 7473 5f73 796d  oints=points_sym
-0000f6a0: 6d65 7472 792c 0a20 2020 2020 2020 2020  metry,.         
-0000f6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f6c0: 2020 2020 206b 6e6f 745f 6d75 6c74 6970       knot_multip
-0000f6d0: 6c69 6369 7469 6573 3d73 656c 662e 6b6e  licities=self.kn
-0000f6e0: 6f74 5f6d 756c 7469 706c 6963 6974 6965  ot_multiplicitie
-0000f6f0: 735b 3a3a 2d31 5d2c 0a20 2020 2020 2020  s[::-1],.       
+0000f090: 5f6d 756c 7469 706c 6963 6974 6965 733d  _multiplicities=
+0000f0a0: 7365 6c66 2e6b 6e6f 745f 6d75 6c74 6970  self.knot_multip
+0000f0b0: 6c69 6369 7469 6573 5b3a 3a2d 315d 2c0a  licities[::-1],.
+0000f0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f0d0: 2020 2020 2020 2020 2020 2020 2020 6b6e                kn
+0000f0e0: 6f74 733d 7365 6c66 2e6b 6e6f 7473 5b3a  ots=self.knots[:
+0000f0f0: 3a2d 315d 2c0a 2020 2020 2020 2020 2020  :-1],.          
+0000f100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f110: 2020 2020 7765 6967 6874 733d 7365 6c66      weights=self
+0000f120: 2e77 6569 6768 7473 2c0a 2020 2020 2020  .weights,.      
+0000f130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f140: 2020 2020 2020 2020 7065 7269 6f64 6963          periodic
+0000f150: 3d73 656c 662e 7065 7269 6f64 6963 290a  =self.periodic).
+0000f160: 0a20 2020 2064 6566 2070 6f69 6e74 5f64  .    def point_d
+0000f170: 6973 7461 6e63 6528 7365 6c66 2c20 706f  istance(self, po
+0000f180: 696e 7429 3a0a 2020 2020 2020 2020 2222  int):.        ""
+0000f190: 2252 6574 7572 6e73 2074 6865 206d 696e  "Returns the min
+0000f1a0: 696d 616c 2064 6973 7461 6e63 6520 746f  imal distance to
+0000f1b0: 2061 2070 6f69 6e74 2e22 2222 0a20 2020   a point.""".   
+0000f1c0: 2020 2020 2064 6973 7461 6e63 6520 3d20       distance = 
+0000f1d0: 6d61 7468 2e69 6e66 0a20 2020 2020 2020  math.inf.       
+0000f1e0: 2070 6f6c 7967 6f6e 5f70 6f69 6e74 7320   polygon_points 
+0000f1f0: 3d20 7365 6c66 2e70 6f69 6e74 730a 2020  = self.points.  
+0000f200: 2020 2020 2020 666f 7220 7031 2c20 7032        for p1, p2
+0000f210: 2069 6e20 7a69 7028 706f 6c79 676f 6e5f   in zip(polygon_
+0000f220: 706f 696e 7473 5b3a 2d31 5d2c 2070 6f6c  points[:-1], pol
+0000f230: 7967 6f6e 5f70 6f69 6e74 735b 313a 5d29  ygon_points[1:])
+0000f240: 3a0a 2020 2020 2020 2020 2020 2020 6c69  :.            li
+0000f250: 6e65 203d 204c 696e 6553 6567 6d65 6e74  ne = LineSegment
+0000f260: 3244 2870 312c 2070 3229 0a20 2020 2020  2D(p1, p2).     
+0000f270: 2020 2020 2020 2064 6973 7420 3d20 6c69         dist = li
+0000f280: 6e65 2e70 6f69 6e74 5f64 6973 7461 6e63  ne.point_distanc
+0000f290: 6528 706f 696e 7429 0a20 2020 2020 2020  e(point).       
+0000f2a0: 2020 2020 2069 6620 6469 7374 203c 2064       if dist < d
+0000f2b0: 6973 7461 6e63 653a 0a20 2020 2020 2020  istance:.       
+0000f2c0: 2020 2020 2020 2020 2064 6973 7461 6e63           distanc
+0000f2d0: 6520 3d20 6469 7374 0a20 2020 2020 2020  e = dist.       
+0000f2e0: 2072 6574 7572 6e20 6469 7374 616e 6365   return distance
+0000f2f0: 0a0a 2020 2020 6465 6620 6e65 6172 6573  ..    def neares
+0000f300: 745f 706f 696e 745f 746f 2873 656c 662c  t_point_to(self,
+0000f310: 2070 6f69 6e74 293a 0a20 2020 2020 2020   point):.       
+0000f320: 2022 2222 0a20 2020 2020 2020 2046 696e   """.        Fin
+0000f330: 6420 6f75 7420 7468 6520 6e65 6172 6573  d out the neares
+0000f340: 7420 706f 696e 7420 6f6e 2074 6865 206c  t point on the l
+0000f350: 696e 6573 6567 6d65 6e74 2074 6f20 706f  inesegment to po
+0000f360: 696e 742e 0a0a 2020 2020 2020 2020 2222  int...        ""
+0000f370: 220a 0a20 2020 2020 2020 2070 6f69 6e74  "..        point
+0000f380: 7320 3d20 7365 6c66 2e64 6973 6372 6574  s = self.discret
+0000f390: 697a 6174 696f 6e5f 706f 696e 7473 286e  ization_points(n
+0000f3a0: 756d 6265 725f 706f 696e 7473 3d35 3030  umber_points=500
+0000f3b0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0000f3c0: 2070 6f69 6e74 2e6e 6561 7265 7374 5f70   point.nearest_p
+0000f3d0: 6f69 6e74 2870 6f69 6e74 7329 0a0a 2020  oint(points)..  
+0000f3e0: 2020 6465 6620 6c69 6e65 7365 676d 656e    def linesegmen
+0000f3f0: 745f 696e 7465 7273 6563 7469 6f6e 7328  t_intersections(
+0000f400: 7365 6c66 2c20 6c69 6e65 7365 676d 656e  self, linesegmen
+0000f410: 7432 6429 3a0a 2020 2020 2020 2020 2222  t2d):.        ""
+0000f420: 220a 2020 2020 2020 2020 4361 6c63 756c  ".        Calcul
+0000f430: 6174 6573 2069 6e74 6572 7365 6374 696f  ates intersectio
+0000f440: 6e73 2062 6574 7765 656e 2061 2042 5370  ns between a BSp
+0000f450: 6c69 6e65 4375 7276 6532 4420 616e 6420  lineCurve2D and 
+0000f460: 6120 4c69 6e65 5365 676d 656e 7432 442e  a LineSegment2D.
+0000f470: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000f480: 206c 696e 6573 6567 6d65 6e74 3264 3a20   linesegment2d: 
+0000f490: 6c69 6e65 7365 676d 656e 7420 746f 2076  linesegment to v
+0000f4a0: 6572 6966 7920 696e 7465 7273 6563 7469  erify intersecti
+0000f4b0: 6f6e 732e 0a20 2020 2020 2020 203a 7265  ons..        :re
+0000f4c0: 7475 726e 3a20 6c69 7374 2077 6974 6820  turn: list with 
+0000f4d0: 7468 6520 696e 7465 7273 6563 7469 6f6e  the intersection
+0000f4e0: 7320 706f 696e 7473 2e0a 2020 2020 2020  s points..      
+0000f4f0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+0000f500: 206e 6f74 2073 656c 662e 626f 756e 6469   not self.boundi
+0000f510: 6e67 5f72 6563 7461 6e67 6c65 2e62 5f72  ng_rectangle.b_r
+0000f520: 6563 7461 6e67 6c65 5f69 6e74 6572 7365  ectangle_interse
+0000f530: 6374 696f 6e28 6c69 6e65 7365 676d 656e  ction(linesegmen
+0000f540: 7432 642e 626f 756e 6469 6e67 5f72 6563  t2d.bounding_rec
+0000f550: 7461 6e67 6c65 293a 0a20 2020 2020 2020  tangle):.       
+0000f560: 2020 2020 2072 6574 7572 6e20 5b5d 0a20       return []. 
+0000f570: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
+0000f580: 696f 6e73 5f70 6f69 6e74 7320 3d20 7365  ions_points = se
+0000f590: 6c66 2e67 6574 5f6c 696e 6573 6567 6d65  lf.get_linesegme
+0000f5a0: 6e74 5f69 6e74 6572 7365 6374 696f 6e73  nt_intersections
+0000f5b0: 286c 696e 6573 6567 6d65 6e74 3264 290a  (linesegment2d).
+0000f5c0: 2020 2020 2020 2020 7265 7475 726e 2069          return i
+0000f5d0: 6e74 6572 7365 6374 696f 6e73 5f70 6f69  ntersections_poi
+0000f5e0: 6e74 730a 0a20 2020 2064 6566 2061 7869  nts..    def axi
+0000f5f0: 616c 5f73 796d 6d65 7472 7928 7365 6c66  al_symmetry(self
+0000f600: 2c20 6c69 6e65 293a 0a20 2020 2020 2020  , line):.       
+0000f610: 2022 2222 0a20 2020 2020 2020 2046 696e   """.        Fin
+0000f620: 6473 206f 7574 2074 6865 2073 796d 6d65  ds out the symme
+0000f630: 7472 6963 2062 7370 6c69 6e65 6375 7276  tric bsplinecurv
+0000f640: 6532 6420 6163 636f 7264 696e 6720 746f  e2d according to
+0000f650: 2061 206c 696e 652e 0a0a 2020 2020 2020   a line...      
+0000f660: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
+0000f670: 6f69 6e74 735f 7379 6d6d 6574 7279 203d  oints_symmetry =
+0000f680: 205b 706f 696e 742e 6178 6961 6c5f 7379   [point.axial_sy
+0000f690: 6d6d 6574 7279 286c 696e 6529 2066 6f72  mmetry(line) for
+0000f6a0: 2070 6f69 6e74 2069 6e20 7365 6c66 2e63   point in self.c
+0000f6b0: 6f6e 7472 6f6c 5f70 6f69 6e74 735d 0a0a  ontrol_points]..
+0000f6c0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000f6d0: 656c 662e 5f5f 636c 6173 735f 5f28 6465  elf.__class__(de
+0000f6e0: 6772 6565 3d73 656c 662e 6465 6772 6565  gree=self.degree
+0000f6f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 0000f700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f710: 2020 2020 2020 206b 6e6f 7473 3d73 656c         knots=sel
-0000f720: 662e 6b6e 6f74 735b 3a3a 2d31 5d2c 0a20  f.knots[::-1],. 
+0000f710: 636f 6e74 726f 6c5f 706f 696e 7473 3d70  control_points=p
+0000f720: 6f69 6e74 735f 7379 6d6d 6574 7279 2c0a  oints_symmetry,.
 0000f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f740: 2020 2020 2020 2020 2020 2020 2077 6569               wei
-0000f750: 6768 7473 3d73 656c 662e 7765 6967 6874  ghts=self.weight
-0000f760: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0000f770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f780: 2070 6572 696f 6469 633d 7365 6c66 2e70   periodic=self.p
-0000f790: 6572 696f 6469 6329 0a0a 0a63 6c61 7373  eriodic)...class
-0000f7a0: 2042 657a 6965 7243 7572 7665 3244 2842   BezierCurve2D(B
-0000f7b0: 5370 6c69 6e65 4375 7276 6532 4429 3a0a  SplineCurve2D):.
-0000f7c0: 2020 2020 2222 220a 2020 2020 4120 636c      """.    A cl
-0000f7d0: 6173 7320 666f 7220 3220 6469 6d65 6e73  ass for 2 dimens
-0000f7e0: 696f 6e61 6c20 4265 7a69 6572 2063 7572  ional Bezier cur
-0000f7f0: 7665 732e 0a0a 2020 2020 3a70 6172 616d  ves...    :param
-0000f800: 2064 6567 7265 653a 2054 6865 2064 6567   degree: The deg
-0000f810: 7265 6520 6f66 2074 6865 2042 657a 6965  ree of the Bezie
-0000f820: 7220 6375 7276 650a 2020 2020 3a74 7970  r curve.    :typ
-0000f830: 6520 6465 6772 6565 3a20 696e 740a 2020  e degree: int.  
-0000f840: 2020 3a70 6172 616d 2063 6f6e 7472 6f6c    :param control
-0000f850: 5f70 6f69 6e74 733a 2041 206c 6973 7420  _points: A list 
-0000f860: 6f66 2032 2064 696d 656e 7369 6f6e 616c  of 2 dimensional
-0000f870: 2070 6f69 6e74 730a 2020 2020 3a74 7970   points.    :typ
-0000f880: 6520 636f 6e74 726f 6c5f 706f 696e 7473  e control_points
-0000f890: 3a20 4c69 7374 5b3a 636c 6173 733a 6076  : List[:class:`v
-0000f8a0: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 605d  olmdlr.Point2D`]
-0000f8b0: 0a20 2020 203a 7061 7261 6d20 6e61 6d65  .    :param name
-0000f8c0: 3a20 5468 6520 6e61 6d65 206f 6620 7468  : The name of th
-0000f8d0: 6520 422d 7370 6c69 6e65 2063 7572 7665  e B-spline curve
-0000f8e0: 2e20 4465 6661 756c 7420 7661 6c75 6520  . Default value 
-0000f8f0: 6973 2027 270a 2020 2020 3a74 7970 6520  is ''.    :type 
-0000f900: 6e61 6d65 3a20 7374 722c 206f 7074 696f  name: str, optio
-0000f910: 6e61 6c0a 2020 2020 2222 220a 0a20 2020  nal.    """..   
-0000f920: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-0000f930: 6c66 2c20 6465 6772 6565 3a20 696e 742c  lf, degree: int,
-0000f940: 2063 6f6e 7472 6f6c 5f70 6f69 6e74 733a   control_points:
-0000f950: 204c 6973 745b 766f 6c6d 646c 722e 506f   List[volmdlr.Po
-0000f960: 696e 7432 445d 2c0a 2020 2020 2020 2020  int2D],.        
-0000f970: 2020 2020 2020 2020 206e 616d 653a 2073           name: s
-0000f980: 7472 203d 2027 2729 3a0a 2020 2020 2020  tr = ''):.      
-0000f990: 2020 6b6e 6f74 7665 6374 6f72 203d 2075    knotvector = u
-0000f9a0: 7469 6c69 7469 6573 2e67 656e 6572 6174  tilities.generat
-0000f9b0: 655f 6b6e 6f74 5f76 6563 746f 7228 6465  e_knot_vector(de
-0000f9c0: 6772 6565 2c0a 2020 2020 2020 2020 2020  gree,.          
-0000f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f9f0: 2020 2020 2020 2020 2020 6c65 6e28 636f            len(co
-0000fa00: 6e74 726f 6c5f 706f 696e 7473 2929 0a20  ntrol_points)). 
-0000fa10: 2020 2020 2020 206b 6e6f 745f 6d75 6c74         knot_mult
-0000fa20: 6970 6c69 6369 7479 203d 205b 315d 202a  iplicity = [1] *
-0000fa30: 206c 656e 286b 6e6f 7476 6563 746f 7229   len(knotvector)
-0000fa40: 0a0a 2020 2020 2020 2020 4253 706c 696e  ..        BSplin
-0000fa50: 6543 7572 7665 3244 2e5f 5f69 6e69 745f  eCurve2D.__init_
-0000fa60: 5f28 7365 6c66 2c20 6465 6772 6565 2c20  _(self, degree, 
-0000fa70: 636f 6e74 726f 6c5f 706f 696e 7473 2c0a  control_points,.
-0000fa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f740: 2020 2020 2020 2020 2020 2020 2020 6b6e                kn
+0000f750: 6f74 5f6d 756c 7469 706c 6963 6974 6965  ot_multiplicitie
+0000f760: 733d 7365 6c66 2e6b 6e6f 745f 6d75 6c74  s=self.knot_mult
+0000f770: 6970 6c69 6369 7469 6573 5b3a 3a2d 315d  iplicities[::-1]
+0000f780: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f7a0: 6b6e 6f74 733d 7365 6c66 2e6b 6e6f 7473  knots=self.knots
+0000f7b0: 5b3a 3a2d 315d 2c0a 2020 2020 2020 2020  [::-1],.        
+0000f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f7d0: 2020 2020 2020 7765 6967 6874 733d 7365        weights=se
+0000f7e0: 6c66 2e77 6569 6768 7473 2c0a 2020 2020  lf.weights,.    
+0000f7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f800: 2020 2020 2020 2020 2020 7065 7269 6f64            period
+0000f810: 6963 3d73 656c 662e 7065 7269 6f64 6963  ic=self.periodic
+0000f820: 290a 0a0a 636c 6173 7320 4265 7a69 6572  )...class Bezier
+0000f830: 4375 7276 6532 4428 4253 706c 696e 6543  Curve2D(BSplineC
+0000f840: 7572 7665 3244 293a 0a20 2020 2022 2222  urve2D):.    """
+0000f850: 0a20 2020 2041 2063 6c61 7373 2066 6f72  .    A class for
+0000f860: 2032 2064 696d 656e 7369 6f6e 616c 2042   2 dimensional B
+0000f870: 657a 6965 7220 6375 7276 6573 2e0a 0a20  ezier curves... 
+0000f880: 2020 203a 7061 7261 6d20 6465 6772 6565     :param degree
+0000f890: 3a20 5468 6520 6465 6772 6565 206f 6620  : The degree of 
+0000f8a0: 7468 6520 4265 7a69 6572 2063 7572 7665  the Bezier curve
+0000f8b0: 0a20 2020 203a 7479 7065 2064 6567 7265  .    :type degre
+0000f8c0: 653a 2069 6e74 0a20 2020 203a 7061 7261  e: int.    :para
+0000f8d0: 6d20 636f 6e74 726f 6c5f 706f 696e 7473  m control_points
+0000f8e0: 3a20 4120 6c69 7374 206f 6620 3220 6469  : A list of 2 di
+0000f8f0: 6d65 6e73 696f 6e61 6c20 706f 696e 7473  mensional points
+0000f900: 0a20 2020 203a 7479 7065 2063 6f6e 7472  .    :type contr
+0000f910: 6f6c 5f70 6f69 6e74 733a 204c 6973 745b  ol_points: List[
+0000f920: 3a63 6c61 7373 3a60 766f 6c6d 646c 722e  :class:`volmdlr.
+0000f930: 506f 696e 7432 4460 5d0a 2020 2020 3a70  Point2D`].    :p
+0000f940: 6172 616d 206e 616d 653a 2054 6865 206e  aram name: The n
+0000f950: 616d 6520 6f66 2074 6865 2042 2d73 706c  ame of the B-spl
+0000f960: 696e 6520 6375 7276 652e 2044 6566 6175  ine curve. Defau
+0000f970: 6c74 2076 616c 7565 2069 7320 2727 0a20  lt value is ''. 
+0000f980: 2020 203a 7479 7065 206e 616d 653a 2073     :type name: s
+0000f990: 7472 2c20 6f70 7469 6f6e 616c 0a20 2020  tr, optional.   
+0000f9a0: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
+0000f9b0: 696e 6974 5f5f 2873 656c 662c 2064 6567  init__(self, deg
+0000f9c0: 7265 653a 2069 6e74 2c20 636f 6e74 726f  ree: int, contro
+0000f9d0: 6c5f 706f 696e 7473 3a20 4c69 7374 5b76  l_points: List[v
+0000f9e0: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 5d2c  olmdlr.Point2D],
+0000f9f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fa00: 2020 6e61 6d65 3a20 7374 7220 3d20 2727    name: str = ''
+0000fa10: 293a 0a20 2020 2020 2020 206b 6e6f 7476  ):.        knotv
+0000fa20: 6563 746f 7220 3d20 7574 696c 6974 6965  ector = utilitie
+0000fa30: 732e 6765 6e65 7261 7465 5f6b 6e6f 745f  s.generate_knot_
+0000fa40: 7665 6374 6f72 2864 6567 7265 652c 0a20  vector(degree,. 
+0000fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa80: 2020 206c 656e 2863 6f6e 7472 6f6c 5f70     len(control_p
+0000fa90: 6f69 6e74 7329 290a 2020 2020 2020 2020  oints)).        
 0000faa0: 6b6e 6f74 5f6d 756c 7469 706c 6963 6974  knot_multiplicit
-0000fab0: 792c 206b 6e6f 7476 6563 746f 722c 0a20  y, knotvector,. 
-0000fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fad0: 2020 2020 2020 2020 2020 2020 2020 204e                 N
-0000fae0: 6f6e 652c 2046 616c 7365 2c20 6e61 6d65  one, False, name
-0000faf0: 290a 0a0a 636c 6173 7320 4c69 6e65 5365  )...class LineSe
-0000fb00: 676d 656e 7432 4428 4c69 6e65 5365 676d  gment2D(LineSegm
-0000fb10: 656e 7429 3a0a 2020 2020 2222 220a 2020  ent):.    """.  
-0000fb20: 2020 4465 6669 6e65 2061 206c 696e 6520    Define a line 
-0000fb30: 7365 676d 656e 7420 6c69 6d69 7465 6420  segment limited 
-0000fb40: 6279 2074 776f 2070 6f69 6e74 732e 0a0a  by two points...
-0000fb50: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
-0000fb60: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-0000fb70: 7374 6172 743a 2076 6f6c 6d64 6c72 2e50  start: volmdlr.P
-0000fb80: 6f69 6e74 3244 2c20 656e 643a 2076 6f6c  oint2D, end: vol
-0000fb90: 6d64 6c72 2e50 6f69 6e74 3244 2c20 2a2c  mdlr.Point2D, *,
-0000fba0: 206e 616d 653a 2073 7472 203d 2027 2729   name: str = '')
-0000fbb0: 3a0a 2020 2020 2020 2020 6966 2073 7461  :.        if sta
-0000fbc0: 7274 203d 3d20 656e 643a 0a20 2020 2020  rt == end:.     
-0000fbd0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-0000fbe0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-0000fbf0: 0a20 2020 2020 2020 2023 2073 656c 662e  .        # self.
-0000fc00: 706f 696e 7473 203d 205b 7374 6172 742c  points = [start,
-0000fc10: 2065 6e64 5d0a 2020 2020 2020 2020 7365   end].        se
-0000fc20: 6c66 2e5f 626f 756e 6469 6e67 5f72 6563  lf._bounding_rec
-0000fc30: 7461 6e67 6c65 203d 204e 6f6e 650a 2020  tangle = None.  
-0000fc40: 2020 2020 2020 4c69 6e65 5365 676d 656e        LineSegmen
-0000fc50: 742e 5f5f 696e 6974 5f5f 2873 656c 662c  t.__init__(self,
-0000fc60: 2073 7461 7274 2c20 656e 642c 206e 616d   start, end, nam
-0000fc70: 653d 6e61 6d65 290a 0a20 2020 2064 6566  e=name)..    def
-0000fc80: 205f 5f68 6173 685f 5f28 7365 6c66 293a   __hash__(self):
-0000fc90: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000fca0: 7365 6c66 2e5f 6461 7461 5f68 6173 6828  self._data_hash(
-0000fcb0: 290a 0a20 2020 2064 6566 205f 6461 7461  )..    def _data
-0000fcc0: 5f68 6173 6828 7365 6c66 293a 0a20 2020  _hash(self):.   
-0000fcd0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000fce0: 2e73 7461 7274 2e5f 6461 7461 5f68 6173  .start._data_has
-0000fcf0: 6828 2920 2b20 7365 6c66 2e65 6e64 2e5f  h() + self.end._
-0000fd00: 6461 7461 5f68 6173 6828 290a 0a20 2020  data_hash()..   
-0000fd10: 2064 6566 205f 6461 7461 5f65 7128 7365   def _data_eq(se
-0000fd20: 6c66 2c20 6f74 6865 725f 6f62 6a65 6374  lf, other_object
-0000fd30: 293a 0a20 2020 2020 2020 2069 6620 7365  ):.        if se
-0000fd40: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
-0000fd50: 616d 655f 5f20 213d 206f 7468 6572 5f6f  ame__ != other_o
-0000fd60: 626a 6563 742e 5f5f 636c 6173 735f 5f2e  bject.__class__.
-0000fd70: 5f5f 6e61 6d65 5f5f 3a0a 2020 2020 2020  __name__:.      
-0000fd80: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
-0000fd90: 7365 0a20 2020 2020 2020 2072 6574 7572  se.        retur
-0000fda0: 6e20 7365 6c66 2e73 7461 7274 203d 3d20  n self.start == 
-0000fdb0: 6f74 6865 725f 6f62 6a65 6374 2e73 7461  other_object.sta
-0000fdc0: 7274 2061 6e64 2073 656c 662e 656e 6420  rt and self.end 
-0000fdd0: 3d3d 206f 7468 6572 5f6f 626a 6563 742e  == other_object.
-0000fde0: 656e 640a 0a20 2020 2064 6566 205f 5f65  end..    def __e
-0000fdf0: 715f 5f28 7365 6c66 2c20 6f74 6865 725f  q__(self, other_
-0000fe00: 6f62 6a65 6374 293a 0a20 2020 2020 2020  object):.       
-0000fe10: 2069 6620 7365 6c66 2e5f 5f63 6c61 7373   if self.__class
-0000fe20: 5f5f 2e5f 5f6e 616d 655f 5f20 213d 206f  __.__name__ != o
-0000fe30: 7468 6572 5f6f 626a 6563 742e 5f5f 636c  ther_object.__cl
-0000fe40: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 3a0a  ass__.__name__:.
-0000fe50: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000fe60: 726e 2046 616c 7365 0a20 2020 2020 2020  rn False.       
-0000fe70: 2072 6574 7572 6e20 7365 6c66 2e73 7461   return self.sta
-0000fe80: 7274 203d 3d20 6f74 6865 725f 6f62 6a65  rt == other_obje
-0000fe90: 6374 2e73 7461 7274 2061 6e64 2073 656c  ct.start and sel
-0000fea0: 662e 656e 6420 3d3d 206f 7468 6572 5f6f  f.end == other_o
-0000feb0: 626a 6563 742e 656e 640a 0a20 2020 2064  bject.end..    d
-0000fec0: 6566 2064 6972 6563 7469 6f6e 5f69 6e64  ef direction_ind
-0000fed0: 6570 656e 6465 6e74 5f65 7128 7365 6c66  ependent_eq(self
-0000fee0: 2c20 6c69 6e65 7365 676d 656e 7432 293a  , linesegment2):
-0000fef0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000ff00: 2020 2020 2056 6572 6966 6965 7320 6966       Verifies if
-0000ff10: 2074 776f 206c 696e 6520 7365 676d 656e   two line segmen
-0000ff20: 7473 2061 7265 2074 6865 2073 616d 652c  ts are the same,
-0000ff30: 206e 6f74 2063 6f6e 7369 6465 7269 6e67   not considering
-0000ff40: 2069 7473 2064 6972 6563 7469 6f6e 2e0a   its direction..
-0000ff50: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000ff60: 2020 2020 2069 6620 7365 6c66 203d 3d20       if self == 
-0000ff70: 6c69 6e65 7365 676d 656e 7432 3a0a 2020  linesegment2:.  
-0000ff80: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000ff90: 2054 7275 650a 2020 2020 2020 2020 7265   True.        re
-0000ffa0: 7475 726e 2073 656c 662e 7374 6172 7420  turn self.start 
-0000ffb0: 3d3d 206c 696e 6573 6567 6d65 6e74 322e  == linesegment2.
-0000ffc0: 656e 6420 616e 6420 7365 6c66 2e65 6e64  end and self.end
-0000ffd0: 203d 3d20 6c69 6e65 7365 676d 656e 7432   == linesegment2
-0000ffe0: 2e73 7461 7274 0a0a 2020 2020 6465 6620  .start..    def 
-0000fff0: 746f 5f64 6963 7428 7365 6c66 2c20 2a61  to_dict(self, *a
-00010000: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00010010: 2020 2020 2020 2020 7265 7475 726e 207b          return {
-00010020: 276f 626a 6563 745f 636c 6173 7327 3a20  'object_class': 
-00010030: 2776 6f6c 6d64 6c72 2e65 6467 6573 2e4c  'volmdlr.edges.L
-00010040: 696e 6553 6567 6d65 6e74 3244 272c 0a20  ineSegment2D',. 
-00010050: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00010060: 6e61 6d65 273a 2073 656c 662e 6e61 6d65  name': self.name
-00010070: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00010080: 2020 2773 7461 7274 273a 2073 656c 662e    'start': self.
-00010090: 7374 6172 742e 746f 5f64 6963 7428 292c  start.to_dict(),
-000100a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000100b0: 2027 656e 6427 3a20 7365 6c66 2e65 6e64   'end': self.end
-000100c0: 2e74 6f5f 6469 6374 2829 0a20 2020 2020  .to_dict().     
-000100d0: 2020 2020 2020 2020 2020 207d 0a0a 2020             }..  
-000100e0: 2020 2320 6465 6620 6d69 6464 6c65 5f70    # def middle_p
-000100f0: 6f69 6e74 2873 656c 6629 3a0a 2020 2020  oint(self):.    
-00010100: 2320 2020 2020 7265 7475 726e 2030 2e35  #     return 0.5
-00010110: 202a 2028 7365 6c66 2e73 7461 7274 202b   * (self.start +
-00010120: 2073 656c 662e 656e 6429 0a20 2020 2023   self.end).    #
-00010130: 0a20 2020 2023 2064 6566 2070 6f69 6e74  .    # def point
-00010140: 5f61 745f 6162 7363 6973 7361 2873 656c  _at_abscissa(sel
-00010150: 662c 2061 6273 6369 7373 6129 3a0a 2020  f, abscissa):.  
-00010160: 2020 2320 2020 2020 7265 7475 726e 2073    #     return s
-00010170: 656c 662e 7374 6172 7420 2b20 7365 6c66  elf.start + self
-00010180: 2e75 6e69 745f 6469 7265 6374 696f 6e5f  .unit_direction_
-00010190: 7665 6374 6f72 2829 202a 2061 6273 6369  vector() * absci
-000101a0: 7373 610a 0a20 2020 2064 6566 2070 6f69  ssa..    def poi
-000101b0: 6e74 5f62 656c 6f6e 6773 2873 656c 662c  nt_belongs(self,
-000101c0: 2070 6f69 6e74 2c20 6162 735f 746f 6c3d   point, abs_tol=
-000101d0: 3165 2d36 293a 0a20 2020 2020 2020 2070  1e-6):.        p
-000101e0: 6f69 6e74 5f64 6973 7461 6e63 6520 3d20  oint_distance = 
-000101f0: 7365 6c66 2e70 6f69 6e74 5f64 6973 7461  self.point_dista
-00010200: 6e63 6528 706f 696e 7429 0a20 2020 2020  nce(point).     
-00010210: 2020 2069 6620 6d61 7468 2e69 7363 6c6f     if math.isclo
-00010220: 7365 2870 6f69 6e74 5f64 6973 7461 6e63  se(point_distanc
-00010230: 652c 2030 2c20 6162 735f 746f 6c3d 6162  e, 0, abs_tol=ab
-00010240: 735f 746f 6c29 3a0a 2020 2020 2020 2020  s_tol):.        
-00010250: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
-00010260: 2020 2020 2020 2020 7265 7475 726e 2046          return F
-00010270: 616c 7365 0a0a 2020 2020 4070 726f 7065  alse..    @prope
-00010280: 7274 790a 2020 2020 6465 6620 626f 756e  rty.    def boun
-00010290: 6469 6e67 5f72 6563 7461 6e67 6c65 2873  ding_rectangle(s
-000102a0: 656c 6629 3a0a 2020 2020 2020 2020 6966  elf):.        if
-000102b0: 206e 6f74 2073 656c 662e 5f62 6f75 6e64   not self._bound
-000102c0: 696e 675f 7265 6374 616e 676c 653a 0a20  ing_rectangle:. 
-000102d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000102e0: 5f62 6f75 6e64 696e 675f 7265 6374 616e  _bounding_rectan
-000102f0: 676c 6520 3d20 766f 6c6d 646c 722e 636f  gle = volmdlr.co
-00010300: 7265 2e42 6f75 6e64 696e 6752 6563 7461  re.BoundingRecta
-00010310: 6e67 6c65 280a 2020 2020 2020 2020 2020  ngle(.          
-00010320: 2020 2020 2020 6d69 6e28 7365 6c66 2e73        min(self.s
-00010330: 7461 7274 2e78 2c20 7365 6c66 2e65 6e64  tart.x, self.end
-00010340: 2e78 292c 206d 6178 2873 656c 662e 7374  .x), max(self.st
-00010350: 6172 742e 782c 2073 656c 662e 656e 642e  art.x, self.end.
-00010360: 7829 2c0a 2020 2020 2020 2020 2020 2020  x),.            
-00010370: 2020 2020 6d69 6e28 7365 6c66 2e73 7461      min(self.sta
-00010380: 7274 2e79 2c20 7365 6c66 2e65 6e64 2e79  rt.y, self.end.y
-00010390: 292c 206d 6178 2873 656c 662e 7374 6172  ), max(self.star
-000103a0: 742e 792c 2073 656c 662e 656e 642e 7929  t.y, self.end.y)
-000103b0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000103c0: 2073 656c 662e 5f62 6f75 6e64 696e 675f   self._bounding_
-000103d0: 7265 6374 616e 676c 650a 0a20 2020 2064  rectangle..    d
-000103e0: 6566 2073 7472 6169 6768 745f 6c69 6e65  ef straight_line
-000103f0: 5f61 7265 6128 7365 6c66 293a 0a20 2020  _area(self):.   
-00010400: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00010410: 2043 616c 6375 6c61 7465 7320 7468 6520   Calculates the 
-00010420: 6172 6561 206f 6620 7468 6520 4c69 6e65  area of the Line
-00010430: 5365 676d 656e 7432 442c 2077 6974 6820  Segment2D, with 
-00010440: 6c69 6e65 2064 7261 776e 2066 726f 6d20  line drawn from 
-00010450: 7374 6172 7420 746f 2065 6e64 2e0a 0a20  start to end... 
-00010460: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-00010470: 7374 7261 6967 6874 5f6c 696e 655f 6172  straight_line_ar
-00010480: 6561 2e0a 2020 2020 2020 2020 2222 220a  ea..        """.
-00010490: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
-000104a0: 2e0a 0a20 2020 2064 6566 2073 7472 6169  ...    def strai
-000104b0: 6768 745f 6c69 6e65 5f73 6563 6f6e 645f  ght_line_second_
-000104c0: 6d6f 6d65 6e74 5f61 7265 6128 7365 6c66  moment_area(self
-000104d0: 2c20 706f 696e 743a 2076 6f6c 6d64 6c72  , point: volmdlr
-000104e0: 2e50 6f69 6e74 3244 293a 0a20 2020 2020  .Point2D):.     
-000104f0: 2020 2072 6574 7572 6e20 302c 2030 2c20     return 0, 0, 
-00010500: 300a 0a20 2020 2064 6566 2073 7472 6169  0..    def strai
-00010510: 6768 745f 6c69 6e65 5f63 656e 7465 725f  ght_line_center_
-00010520: 6f66 5f6d 6173 7328 7365 6c66 293a 0a20  of_mass(self):. 
-00010530: 2020 2020 2020 2072 6574 7572 6e20 302e         return 0.
-00010540: 3520 2a20 2873 656c 662e 7374 6172 7420  5 * (self.start 
-00010550: 2b20 7365 6c66 2e65 6e64 290a 0a20 2020  + self.end)..   
-00010560: 2064 6566 2073 7472 6169 6768 745f 6c69   def straight_li
-00010570: 6e65 5f70 6f69 6e74 5f62 656c 6f6e 6773  ne_point_belongs
-00010580: 2873 656c 662c 2070 6f69 6e74 293a 0a20  (self, point):. 
-00010590: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000105a0: 2020 2043 6c6f 7369 6e67 2073 7472 6169     Closing strai
-000105b0: 6768 7420 6c69 6e65 2070 6f69 6e74 2062  ght line point b
-000105c0: 656c 6f6e 6773 2076 6572 6966 6963 6174  elongs verificat
-000105d0: 696f 6e2e 0a0a 2020 2020 2020 2020 5665  ion...        Ve
-000105e0: 7269 6669 6573 2069 6620 6120 706f 696e  rifies if a poin
-000105f0: 7420 6265 6c6f 6e67 7320 746f 2074 6865  t belongs to the
-00010600: 2073 7572 6661 6365 2063 7265 6174 6564   surface created
-00010610: 2062 7920 636c 6f73 696e 6720 7468 6520   by closing the 
-00010620: 6564 6765 2077 6974 6820 610a 2020 2020  edge with a.    
-00010630: 2020 2020 6c69 6e65 2062 6574 7765 656e      line between
-00010640: 2069 7473 2073 7461 7274 2061 6e64 2065   its start and e
-00010650: 6e64 2070 6f69 6e74 732e 0a0a 2020 2020  nd points...    
-00010660: 2020 2020 3a70 6172 616d 2070 6f69 6e74      :param point
-00010670: 3a20 506f 696e 7420 746f 2062 6520 7665  : Point to be ve
-00010680: 7269 6669 6564 2e0a 2020 2020 2020 2020  rified..        
-00010690: 3a72 6574 7572 6e3a 2052 6574 7572 6e20  :return: Return 
-000106a0: 5472 7565 2069 6620 7468 6520 706f 696e  True if the poin
-000106b0: 7420 6265 6c6f 6e67 7320 746f 2074 6869  t belongs to thi
-000106c0: 7320 7375 7266 6163 652c 206f 7220 4661  s surface, or Fa
-000106d0: 6c73 6520 6f74 6865 7277 6973 652e 0a20  lse otherwise.. 
-000106e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000106f0: 2020 2072 6574 7572 6e20 7365 6c66 2e70     return self.p
-00010700: 6f69 6e74 5f62 656c 6f6e 6773 2870 6f69  oint_belongs(poi
-00010710: 6e74 290a 0a20 2020 2064 6566 2070 6f69  nt)..    def poi
-00010720: 6e74 5f64 6973 7461 6e63 6528 7365 6c66  nt_distance(self
-00010730: 2c20 706f 696e 742c 2072 6574 7572 6e5f  , point, return_
-00010740: 6f74 6865 725f 706f 696e 743d 4661 6c73  other_point=Fals
-00010750: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
-00010760: 2020 2020 2020 2020 436f 6d70 7574 6573          Computes
-00010770: 2074 6865 2064 6973 7461 6e63 6520 6f66   the distance of
-00010780: 2061 2070 6f69 6e74 2074 6f20 7365 676d   a point to segm
-00010790: 656e 7420 6f66 206c 696e 652e 0a0a 2020  ent of line...  
-000107a0: 2020 2020 2020 3a70 6172 616d 2070 6f69        :param poi
-000107b0: 6e74 3a20 706f 696e 7420 746f 2063 616c  nt: point to cal
-000107c0: 6375 6c61 7465 2064 6973 7461 6e63 652e  culate distance.
-000107d0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000107e0: 7265 7475 726e 5f6f 7468 6572 5f70 6f69  return_other_poi
-000107f0: 6e74 733a 2042 6f6f 6c65 616e 2076 6172  nts: Boolean var
-00010800: 6961 626c 6520 746f 2072 6574 7572 6e20  iable to return 
-00010810: 6c69 6e65 7365 676d 656e 7427 7320 636f  linesegment's co
-00010820: 7272 6573 706f 6e64 696e 6720 706f 696e  rresponding poin
-00010830: 7420 6f72 206e 6f74 2e0a 2020 2020 2020  t or not..      
-00010840: 2020 2222 220a 2020 2020 2020 2020 6469    """.        di
-00010850: 7374 616e 6365 2c20 706f 696e 7420 3d20  stance, point = 
-00010860: 766f 6c6d 646c 722e 4c69 6e65 5365 676d  volmdlr.LineSegm
-00010870: 656e 7432 4450 6f69 6e74 4469 7374 616e  ent2DPointDistan
-00010880: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-00010890: 5b28 7365 6c66 2e73 7461 7274 2e78 2c20  [(self.start.x, 
-000108a0: 7365 6c66 2e73 7461 7274 2e79 292c 2028  self.start.y), (
-000108b0: 7365 6c66 2e65 6e64 2e78 2c20 7365 6c66  self.end.x, self
-000108c0: 2e65 6e64 2e79 295d 2c0a 2020 2020 2020  .end.y)],.      
-000108d0: 2020 2020 2020 2870 6f69 6e74 2e78 2c20        (point.x, 
-000108e0: 706f 696e 742e 7929 290a 2020 2020 2020  point.y)).      
-000108f0: 2020 6966 2072 6574 7572 6e5f 6f74 6865    if return_othe
-00010900: 725f 706f 696e 743a 0a20 2020 2020 2020  r_point:.       
-00010910: 2020 2020 2072 6574 7572 6e20 6469 7374       return dist
-00010920: 616e 6365 2c20 766f 6c6d 646c 722e 506f  ance, volmdlr.Po
-00010930: 696e 7432 4428 2a70 6f69 6e74 290a 2020  int2D(*point).  
-00010940: 2020 2020 2020 7265 7475 726e 2064 6973        return dis
-00010950: 7461 6e63 650a 0a20 2020 2064 6566 2070  tance..    def p
-00010960: 6f69 6e74 5f70 726f 6a65 6374 696f 6e28  oint_projection(
-00010970: 7365 6c66 2c20 706f 696e 7429 3a0a 2020  self, point):.  
-00010980: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00010990: 2020 4966 2074 6865 2070 726f 6a65 6374    If the project
-000109a0: 696f 6e20 6661 6c6c 7320 6f75 7473 6964  ion falls outsid
-000109b0: 6520 7468 6520 4c69 6e65 5365 676d 656e  e the LineSegmen
-000109c0: 7432 442c 2072 6574 7572 6e73 204e 6f6e  t2D, returns Non
-000109d0: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
-000109e0: 2020 2020 2020 2070 6f69 6e74 2c20 6375         point, cu
-000109f0: 7276 5f61 6273 203d 204c 696e 6532 442e  rv_abs = Line2D.
-00010a00: 706f 696e 745f 7072 6f6a 6563 7469 6f6e  point_projection
-00010a10: 284c 696e 6532 4428 7365 6c66 2e73 7461  (Line2D(self.sta
-00010a20: 7274 2c20 7365 6c66 2e65 6e64 292c 0a20  rt, self.end),. 
-00010a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a60: 2070 6f69 6e74 290a 2020 2020 2020 2020   point).        
-00010a70: 2320 7072 696e 7428 2763 7572 765f 6162  # print('curv_ab
-00010a80: 7320 3a27 2c20 6375 7276 5f61 6273 2c20  s :', curv_abs, 
-00010a90: 276c 656e 6774 6820 3a27 2c20 7365 6c66  'length :', self
-00010aa0: 2e6c 656e 6774 6828 2929 0a20 2020 2020  .length()).     
-00010ab0: 2020 2069 6620 6375 7276 5f61 6273 203c     if curv_abs <
-00010ac0: 2030 206f 7220 6375 7276 5f61 6273 203e   0 or curv_abs >
-00010ad0: 2073 656c 662e 6c65 6e67 7468 2829 3a0a   self.length():.
-00010ae0: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-00010af0: 6273 2863 7572 765f 6162 7329 203c 2031  bs(curv_abs) < 1
-00010b00: 652d 3620 6f72 206d 6174 682e 6973 636c  e-6 or math.iscl
-00010b10: 6f73 6528 6375 7276 5f61 6273 2c20 7365  ose(curv_abs, se
-00010b20: 6c66 2e6c 656e 6774 6828 292c 0a20 2020  lf.length(),.   
-00010b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b60: 2061 6273 5f74 6f6c 3d31 652d 3629 3a0a   abs_tol=1e-6):.
-00010b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b80: 7265 7475 726e 2070 6f69 6e74 2c20 6375  return point, cu
-00010b90: 7276 5f61 6273 0a20 2020 2020 2020 2020  rv_abs.         
-00010ba0: 2020 2072 6574 7572 6e20 4e6f 6e65 2c20     return None, 
-00010bb0: 6375 7276 5f61 6273 0a20 2020 2020 2020  curv_abs.       
-00010bc0: 2072 6574 7572 6e20 706f 696e 742c 2063   return point, c
-00010bd0: 7572 765f 6162 730a 0a20 2020 2064 6566  urv_abs..    def
-00010be0: 206c 696e 655f 696e 7465 7273 6563 7469   line_intersecti
-00010bf0: 6f6e 7328 7365 6c66 2c20 6c69 6e65 3a20  ons(self, line: 
-00010c00: 4c69 6e65 3244 293a 0a20 2020 2020 2020  Line2D):.       
-00010c10: 2069 6620 7365 6c66 2e64 6972 6563 7469   if self.directi
-00010c20: 6f6e 5f76 6563 746f 7228 292e 6973 5f63  on_vector().is_c
-00010c30: 6f6c 696e 6561 725f 746f 286c 696e 652e  olinear_to(line.
-00010c40: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
-00010c50: 2829 293a 0a20 2020 2020 2020 2020 2020  ()):.           
-00010c60: 2072 6574 7572 6e20 5b5d 0a20 2020 2020   return [].     
-00010c70: 2020 2070 6f69 6e74 203d 2076 6f6c 6d64     point = volmd
-00010c80: 6c72 2e50 6f69 6e74 3244 2e6c 696e 655f  lr.Point2D.line_
-00010c90: 696e 7465 7273 6563 7469 6f6e 2873 656c  intersection(sel
-00010ca0: 662c 206c 696e 6529 0a20 2020 2020 2020  f, line).       
-00010cb0: 2069 6620 706f 696e 7420 6973 206e 6f74   if point is not
-00010cc0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00010cd0: 2020 2070 6f69 6e74 5f70 726f 6a65 6374     point_project
-00010ce0: 696f 6e31 2c20 5f20 3d20 7365 6c66 2e70  ion1, _ = self.p
-00010cf0: 6f69 6e74 5f70 726f 6a65 6374 696f 6e28  oint_projection(
-00010d00: 706f 696e 7429 0a20 2020 2020 2020 2020  point).         
-00010d10: 2020 2069 6e74 6572 7365 6374 696f 6e73     intersections
-00010d20: 203d 205b 706f 696e 745f 7072 6f6a 6563   = [point_projec
-00010d30: 7469 6f6e 315d 0a20 2020 2020 2020 2020  tion1].         
-00010d40: 2020 2069 6620 706f 696e 745f 7072 6f6a     if point_proj
-00010d50: 6563 7469 6f6e 3120 6973 204e 6f6e 653a  ection1 is None:
-00010d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010d70: 2069 6e74 6572 7365 6374 696f 6e73 203d   intersections =
-00010d80: 205b 5d0a 0a20 2020 2020 2020 2020 2020   []..           
-00010d90: 2065 6c69 6620 6c69 6e65 2e5f 5f63 6c61   elif line.__cla
-00010da0: 7373 5f5f 2e5f 5f6e 616d 655f 5f20 3d3d  ss__.__name__ ==
-00010db0: 2027 4c69 6e65 5365 676d 656e 7432 4427   'LineSegment2D'
-00010dc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00010dd0: 2020 706f 696e 745f 7072 6f6a 6563 7469    point_projecti
-00010de0: 6f6e 322c 205f 203d 206c 696e 652e 706f  on2, _ = line.po
-00010df0: 696e 745f 7072 6f6a 6563 7469 6f6e 2870  int_projection(p
-00010e00: 6f69 6e74 290a 2020 2020 2020 2020 2020  oint).          
-00010e10: 2020 2020 2020 6966 2070 6f69 6e74 5f70        if point_p
-00010e20: 726f 6a65 6374 696f 6e32 2069 7320 4e6f  rojection2 is No
-00010e30: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00010e40: 2020 2020 2020 2020 696e 7465 7273 6563          intersec
-00010e50: 7469 6f6e 7320 3d20 5b5d 0a0a 2020 2020  tions = []..    
-00010e60: 2020 2020 2020 2020 7265 7475 726e 2069          return i
-00010e70: 6e74 6572 7365 6374 696f 6e73 0a20 2020  ntersections.   
-00010e80: 2020 2020 2069 6620 6c69 6e65 2e70 6f69       if line.poi
-00010e90: 6e74 5f62 656c 6f6e 6773 2873 656c 662e  nt_belongs(self.
-00010ea0: 7374 6172 7429 3a0a 2020 2020 2020 2020  start):.        
-00010eb0: 2020 2020 7265 7475 726e 205b 7365 6c66      return [self
-00010ec0: 2e73 7461 7274 5d0a 2020 2020 2020 2020  .start].        
-00010ed0: 6966 206c 696e 652e 706f 696e 745f 6265  if line.point_be
-00010ee0: 6c6f 6e67 7328 7365 6c66 2e65 6e64 293a  longs(self.end):
-00010ef0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00010f00: 7572 6e20 5b73 656c 662e 656e 645d 0a20  urn [self.end]. 
-00010f10: 2020 2020 2020 2072 6574 7572 6e20 5b5d         return []
-00010f20: 0a0a 2020 2020 6465 6620 6c69 6e65 7365  ..    def linese
-00010f30: 676d 656e 745f 696e 7465 7273 6563 7469  gment_intersecti
-00010f40: 6f6e 7328 7365 6c66 2c20 6c69 6e65 7365  ons(self, linese
-00010f50: 676d 656e 7432 643a 2027 4c69 6e65 5365  gment2d: 'LineSe
-00010f60: 676d 656e 7432 4427 293a 0a20 2020 2020  gment2D'):.     
-00010f70: 2020 2022 2222 0a20 2020 2020 2020 2054     """.        T
-00010f80: 6f75 6368 696e 6720 6c69 6e65 7365 676d  ouching linesegm
-00010f90: 656e 7473 2064 6f65 7320 6e6f 7420 696e  ents does not in
-00010fa0: 7465 7273 6563 742e 0a20 2020 2020 2020  tersect..       
-00010fb0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-00010fc0: 6e6f 7420 7365 6c66 2e62 6f75 6e64 696e  not self.boundin
-00010fd0: 675f 7265 6374 616e 676c 652e 625f 7265  g_rectangle.b_re
-00010fe0: 6374 616e 676c 655f 696e 7465 7273 6563  ctangle_intersec
-00010ff0: 7469 6f6e 286c 696e 6573 6567 6d65 6e74  tion(linesegment
-00011000: 3264 2e62 6f75 6e64 696e 675f 7265 6374  2d.bounding_rect
-00011010: 616e 676c 6529 3a0a 2020 2020 2020 2020  angle):.        
-00011020: 2020 2020 7265 7475 726e 205b 5d0a 2020      return [].  
-00011030: 2020 2020 2020 706f 696e 7420 3d20 766f        point = vo
-00011040: 6c6d 646c 722e 506f 696e 7432 442e 6c69  lmdlr.Point2D.li
-00011050: 6e65 5f69 6e74 6572 7365 6374 696f 6e28  ne_intersection(
-00011060: 7365 6c66 2c20 6c69 6e65 7365 676d 656e  self, linesegmen
-00011070: 7432 6429 0a20 2020 2020 2020 2023 2054  t2d).        # T
-00011080: 4f44 4f3a 204d 6179 2062 6520 7468 6573  ODO: May be thes
-00011090: 6520 636f 6d6d 656e 7465 6420 636f 6e64  e commented cond
-000110a0: 6974 696f 6e73 2073 686f 756c 6420 6265  itions should be
-000110b0: 2075 7365 6420 666f 7220 6c69 6e65 7365   used for linese
-000110c0: 676d 656e 745f 6372 6f73 7369 6e67 730a  gment_crossings.
-000110d0: 2020 2020 2020 2020 6966 2070 6f69 6e74          if point
-000110e0: 3a20 2023 2061 6e64 2028 706f 696e 7420  :  # and (point 
-000110f0: 213d 2073 656c 662e 7374 6172 7429 2061  != self.start) a
-00011100: 6e64 2028 706f 696e 7420 213d 2073 656c  nd (point != sel
-00011110: 662e 656e 6429 3a0a 2020 2020 2020 2020  f.end):.        
-00011120: 2020 2020 706f 696e 745f 7072 6f6a 6563      point_projec
-00011130: 7469 6f6e 312c 205f 203d 2073 656c 662e  tion1, _ = self.
-00011140: 706f 696e 745f 7072 6f6a 6563 7469 6f6e  point_projection
-00011150: 2870 6f69 6e74 290a 2020 2020 2020 2020  (point).        
-00011160: 2020 2020 6966 2070 6f69 6e74 5f70 726f      if point_pro
-00011170: 6a65 6374 696f 6e31 2069 7320 4e6f 6e65  jection1 is None
-00011180: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00011190: 2020 7265 7475 726e 205b 5d0a 0a20 2020    return []..   
-000111a0: 2020 2020 2020 2020 2070 6f69 6e74 5f70           point_p
-000111b0: 726f 6a65 6374 696f 6e32 2c20 5f20 3d20  rojection2, _ = 
-000111c0: 6c69 6e65 7365 676d 656e 7432 642e 706f  linesegment2d.po
-000111d0: 696e 745f 7072 6f6a 6563 7469 6f6e 2870  int_projection(p
-000111e0: 6f69 6e74 290a 2020 2020 2020 2020 2020  oint).          
-000111f0: 2020 6966 2070 6f69 6e74 5f70 726f 6a65    if point_proje
-00011200: 6374 696f 6e32 2069 7320 4e6f 6e65 3a0a  ction2 is None:.
-00011210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011220: 7265 7475 726e 205b 5d0a 0a20 2020 2020  return []..     
-00011230: 2020 2020 2020 2072 6574 7572 6e20 5b70         return [p
-00011240: 6f69 6e74 5f70 726f 6a65 6374 696f 6e31  oint_projection1
-00011250: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
-00011260: 205b 5d0a 0a20 2020 2064 6566 206c 696e   []..    def lin
-00011270: 655f 6372 6f73 7369 6e67 7328 7365 6c66  e_crossings(self
-00011280: 2c20 6c69 6e65 3a20 274c 696e 6532 4427  , line: 'Line2D'
-00011290: 293a 0a20 2020 2020 2020 2069 6620 7365  ):.        if se
-000112a0: 6c66 2e64 6972 6563 7469 6f6e 5f76 6563  lf.direction_vec
-000112b0: 746f 7228 292e 6973 5f63 6f6c 696e 6561  tor().is_colinea
-000112c0: 725f 746f 286c 696e 652e 6469 7265 6374  r_to(line.direct
-000112d0: 696f 6e5f 7665 6374 6f72 2829 293a 0a20  ion_vector()):. 
-000112e0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000112f0: 6e20 5b5d 0a20 2020 2020 2020 206c 696e  n [].        lin
-00011300: 655f 696e 7465 7273 6563 7469 6f6e 203d  e_intersection =
-00011310: 2073 656c 662e 6c69 6e65 5f69 6e74 6572   self.line_inter
-00011320: 7365 6374 696f 6e73 286c 696e 6529 0a20  sections(line). 
-00011330: 2020 2020 2020 2069 6620 6c69 6e65 5f69         if line_i
-00011340: 6e74 6572 7365 6374 696f 6e20 616e 6420  ntersection and 
-00011350: 286c 696e 655f 696e 7465 7273 6563 7469  (line_intersecti
-00011360: 6f6e 5b30 5d20 3d3d 2073 656c 662e 656e  on[0] == self.en
-00011370: 6420 6f72 206c 696e 655f 696e 7465 7273  d or line_inters
-00011380: 6563 7469 6f6e 5b30 5d20 3d3d 2073 656c  ection[0] == sel
-00011390: 662e 7374 6172 7429 3a0a 2020 2020 2020  f.start):.      
-000113a0: 2020 2020 2020 7265 7475 726e 205b 5d0a        return [].
-000113b0: 2020 2020 2020 2020 7265 7475 726e 206c          return l
-000113c0: 696e 655f 696e 7465 7273 6563 7469 6f6e  ine_intersection
-000113d0: 0a0a 2020 2020 6465 6620 6c69 6e65 7365  ..    def linese
-000113e0: 676d 656e 745f 6372 6f73 7369 6e67 7328  gment_crossings(
-000113f0: 7365 6c66 2c20 6c69 6e65 7365 676d 656e  self, linesegmen
-00011400: 743a 2027 4c69 6e65 5365 676d 656e 7432  t: 'LineSegment2
-00011410: 4427 293a 0a20 2020 2020 2020 2022 2222  D'):.        """
-00011420: 0a20 2020 2020 2020 2047 6976 6573 2074  .        Gives t
-00011430: 6865 2063 726f 7373 696e 6773 2077 6974  he crossings wit
-00011440: 6820 6120 6c69 6e65 7365 676d 656e 742e  h a linesegment.
-00011450: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00011460: 2020 2020 2069 6620 7365 6c66 2e64 6972       if self.dir
-00011470: 6563 7469 6f6e 5f76 6563 746f 7228 292e  ection_vector().
-00011480: 6973 5f63 6f6c 696e 6561 725f 746f 280a  is_colinear_to(.
-00011490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114a0: 6c69 6e65 7365 676d 656e 742e 6469 7265  linesegment.dire
-000114b0: 6374 696f 6e5f 7665 6374 6f72 2829 293a  ction_vector()):
-000114c0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000114d0: 7572 6e20 5b5d 0a20 2020 2020 2020 2072  urn [].        r
-000114e0: 6574 7572 6e20 7365 6c66 2e6c 696e 6573  eturn self.lines
-000114f0: 6567 6d65 6e74 5f69 6e74 6572 7365 6374  egment_intersect
-00011500: 696f 6e73 286c 696e 6573 6567 6d65 6e74  ions(linesegment
-00011510: 290a 0a20 2020 2064 6566 2070 6c6f 7428  )..    def plot(
-00011520: 7365 6c66 2c20 6178 3d4e 6f6e 652c 2063  self, ax=None, c
-00011530: 6f6c 6f72 3d27 6b27 2c20 616c 7068 613d  olor='k', alpha=
-00011540: 312c 2061 7272 6f77 3d46 616c 7365 2c20  1, arrow=False, 
-00011550: 7769 6474 683d 4e6f 6e65 2c0a 2020 2020  width=None,.    
-00011560: 2020 2020 2020 2020 2070 6c6f 745f 706f           plot_po
-00011570: 696e 7473 3d46 616c 7365 293a 0a20 2020  ints=False):.   
-00011580: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00011590: 2050 6c6f 7473 2074 6865 204c 696e 6573   Plots the Lines
-000115a0: 6567 6d65 6e74 3244 2e0a 2020 2020 2020  egment2D..      
-000115b0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-000115c0: 2061 7820 6973 204e 6f6e 653a 0a20 2020   ax is None:.   
-000115d0: 2020 2020 2020 2020 205f 2c20 6178 203d           _, ax =
-000115e0: 2070 6c74 2e73 7562 706c 6f74 7328 290a   plt.subplots().
-000115f0: 0a20 2020 2020 2020 2070 312c 2070 3220  .        p1, p2 
-00011600: 3d20 7365 6c66 2e73 7461 7274 2c20 7365  = self.start, se
-00011610: 6c66 2e65 6e64 0a20 2020 2020 2020 2069  lf.end.        i
-00011620: 6620 6172 726f 773a 0a20 2020 2020 2020  f arrow:.       
-00011630: 2020 2020 2069 6620 706c 6f74 5f70 6f69       if plot_poi
-00011640: 6e74 733a 0a20 2020 2020 2020 2020 2020  nts:.           
-00011650: 2020 2020 2061 782e 706c 6f74 285b 7031       ax.plot([p1
-00011660: 5b30 5d2c 2070 325b 305d 5d2c 205b 7031  [0], p2[0]], [p1
-00011670: 5b31 5d2c 2070 325b 315d 5d2c 2063 6f6c  [1], p2[1]], col
-00011680: 6f72 3d63 6f6c 6f72 2c0a 2020 2020 2020  or=color,.      
-00011690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000116a0: 2020 616c 7068 613d 616c 7068 612c 2073    alpha=alpha, s
-000116b0: 7479 6c65 3d27 6f2d 2729 0a20 2020 2020  tyle='o-').     
-000116c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000116d0: 2020 2020 2020 2020 2020 2020 2061 782e               ax.
-000116e0: 706c 6f74 285b 7031 5b30 5d2c 2070 325b  plot([p1[0], p2[
-000116f0: 305d 5d2c 205b 7031 5b31 5d2c 2070 325b  0]], [p1[1], p2[
-00011700: 315d 5d2c 2063 6f6c 6f72 3d63 6f6c 6f72  1]], color=color
-00011710: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00011720: 2020 2020 2020 2020 2020 616c 7068 613d            alpha=
-00011730: 616c 7068 6129 0a0a 2020 2020 2020 2020  alpha)..        
-00011740: 2020 2020 6c65 6e67 7468 203d 2028 2870      length = ((p
-00011750: 315b 305d 202d 2070 325b 305d 2920 2a2a  1[0] - p2[0]) **
-00011760: 2032 202b 2028 7031 5b31 5d20 2d20 7032   2 + (p1[1] - p2
-00011770: 5b31 5d29 202a 2a20 3229 202a 2a20 302e  [1]) ** 2) ** 0.
-00011780: 350a 2020 2020 2020 2020 2020 2020 6966  5.            if
-00011790: 2077 6964 7468 2069 7320 4e6f 6e65 3a0a   width is None:.
-000117a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000117b0: 7769 6474 6820 3d20 6c65 6e67 7468 202f  width = length /
-000117c0: 2031 3030 302e 0a20 2020 2020 2020 2020   1000..         
-000117d0: 2020 2020 2020 2068 6561 645f 6c65 6e67         head_leng
-000117e0: 7468 203d 206c 656e 6774 6820 2f20 3230  th = length / 20
-000117f0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011800: 2020 6865 6164 5f77 6964 7468 203d 2068    head_width = h
-00011810: 6561 645f 6c65 6e67 7468 202f 2032 2e0a  ead_length / 2..
-00011820: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00011830: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00011840: 2020 6865 6164 5f77 6964 7468 203d 2032    head_width = 2
-00011850: 202a 2077 6964 7468 0a20 2020 2020 2020   * width.       
-00011860: 2020 2020 2020 2020 2068 6561 645f 6c65           head_le
-00011870: 6e67 7468 203d 2068 6561 645f 7769 6474  ngth = head_widt
-00011880: 680a 2020 2020 2020 2020 2020 2020 6178  h.            ax
-00011890: 2e61 7272 6f77 2870 315b 305d 2c20 7031  .arrow(p1[0], p1
-000118a0: 5b31 5d2c 0a20 2020 2020 2020 2020 2020  [1],.           
-000118b0: 2020 2020 2020 2020 2020 2870 325b 305d            (p2[0]
-000118c0: 202d 2070 315b 305d 2920 2f20 6c65 6e67   - p1[0]) / leng
-000118d0: 7468 202a 2028 6c65 6e67 7468 202d 2068  th * (length - h
-000118e0: 6561 645f 6c65 6e67 7468 292c 0a20 2020  ead_length),.   
-000118f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011900: 2020 2870 325b 315d 202d 2070 315b 315d    (p2[1] - p1[1]
-00011910: 2920 2f20 6c65 6e67 7468 202a 2028 6c65  ) / length * (le
-00011920: 6e67 7468 202d 2068 6561 645f 6c65 6e67  ngth - head_leng
-00011930: 7468 292c 0a20 2020 2020 2020 2020 2020  th),.           
-00011940: 2020 2020 2020 2020 2020 6865 6164 5f77            head_w
-00011950: 6964 7468 3d68 6561 645f 7769 6474 682c  idth=head_width,
-00011960: 2066 633d 2762 272c 206c 696e 6577 6964   fc='b', linewid
-00011970: 7468 3d30 2c0a 2020 2020 2020 2020 2020  th=0,.          
-00011980: 2020 2020 2020 2020 2020 2068 6561 645f             head_
-00011990: 6c65 6e67 7468 3d68 6561 645f 6c65 6e67  length=head_leng
-000119a0: 7468 2c20 7769 6474 683d 7769 6474 682c  th, width=width,
-000119b0: 2061 6c70 6861 3d30 2e33 290a 2020 2020   alpha=0.3).    
-000119c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000119d0: 2020 2020 2020 6966 2077 6964 7468 2069        if width i
-000119e0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-000119f0: 2020 2020 2020 2020 7769 6474 6820 3d20          width = 
-00011a00: 310a 2020 2020 2020 2020 2020 2020 6966  1.            if
-00011a10: 2070 6c6f 745f 706f 696e 7473 3a0a 2020   plot_points:.  
-00011a20: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00011a30: 2e70 6c6f 7428 5b70 315b 305d 2c20 7032  .plot([p1[0], p2
-00011a40: 5b30 5d5d 2c20 5b70 315b 315d 2c20 7032  [0]], [p1[1], p2
-00011a50: 5b31 5d5d 2c20 636f 6c6f 723d 636f 6c6f  [1]], color=colo
-00011a60: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-00011a70: 2020 2020 2020 2020 2020 206d 6172 6b65             marke
-00011a80: 723d 276f 272c 206c 696e 6577 6964 7468  r='o', linewidth
-00011a90: 3d77 6964 7468 2c20 616c 7068 613d 616c  =width, alpha=al
-00011aa0: 7068 6129 0a20 2020 2020 2020 2020 2020  pha).           
-00011ab0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00011ac0: 2020 2020 2020 2061 782e 706c 6f74 285b         ax.plot([
-00011ad0: 7031 5b30 5d2c 2070 325b 305d 5d2c 205b  p1[0], p2[0]], [
-00011ae0: 7031 5b31 5d2c 2070 325b 315d 5d2c 2063  p1[1], p2[1]], c
-00011af0: 6f6c 6f72 3d63 6f6c 6f72 2c0a 2020 2020  olor=color,.    
-00011b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011b10: 2020 2020 6c69 6e65 7769 6474 683d 7769      linewidth=wi
-00011b20: 6474 682c 2061 6c70 6861 3d61 6c70 6861  dth, alpha=alpha
-00011b30: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00011b40: 2061 780a 0a20 2020 2064 6566 2074 6f5f   ax..    def to_
-00011b50: 3364 2873 656c 662c 2070 6c61 6e65 5f6f  3d(self, plane_o
-00011b60: 7269 6769 6e2c 2078 312c 2078 3229 3a0a  rigin, x1, x2):.
-00011b70: 2020 2020 2020 2020 7374 6172 7420 3d20          start = 
-00011b80: 7365 6c66 2e73 7461 7274 2e74 6f5f 3364  self.start.to_3d
-00011b90: 2870 6c61 6e65 5f6f 7269 6769 6e2c 2078  (plane_origin, x
-00011ba0: 312c 2078 3229 0a20 2020 2020 2020 2065  1, x2).        e
-00011bb0: 6e64 203d 2073 656c 662e 656e 642e 746f  nd = self.end.to
-00011bc0: 5f33 6428 706c 616e 655f 6f72 6967 696e  _3d(plane_origin
-00011bd0: 2c20 7831 2c20 7832 290a 2020 2020 2020  , x1, x2).      
-00011be0: 2020 7265 7475 726e 204c 696e 6553 6567    return LineSeg
-00011bf0: 6d65 6e74 3344 2873 7461 7274 2c20 656e  ment3D(start, en
-00011c00: 642c 206e 616d 653d 7365 6c66 2e6e 616d  d, name=self.nam
-00011c10: 6529 0a0a 2020 2020 6465 6620 7265 7665  e)..    def reve
-00011c20: 7273 6528 7365 6c66 293a 0a20 2020 2020  rse(self):.     
-00011c30: 2020 2072 6574 7572 6e20 4c69 6e65 5365     return LineSe
-00011c40: 676d 656e 7432 4428 7365 6c66 2e65 6e64  gment2D(self.end
-00011c50: 2e63 6f70 7928 292c 2073 656c 662e 7374  .copy(), self.st
-00011c60: 6172 742e 636f 7079 2829 290a 0a20 2020  art.copy())..   
-00011c70: 2064 6566 2074 6f5f 6c69 6e65 2873 656c   def to_line(sel
-00011c80: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00011c90: 726e 204c 696e 6532 4428 7365 6c66 2e73  rn Line2D(self.s
-00011ca0: 7461 7274 2c20 7365 6c66 2e65 6e64 290a  tart, self.end).
-00011cb0: 0a20 2020 2064 6566 2072 6f74 6174 696f  .    def rotatio
-00011cc0: 6e28 7365 6c66 2c20 6365 6e74 6572 3a20  n(self, center: 
-00011cd0: 766f 6c6d 646c 722e 506f 696e 7432 442c  volmdlr.Point2D,
-00011ce0: 2061 6e67 6c65 3a20 666c 6f61 7429 3a0a   angle: float):.
-00011cf0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00011d00: 2020 2020 4c69 6e65 5365 676d 656e 7432      LineSegment2
-00011d10: 4420 726f 7461 7469 6f6e 2e0a 0a20 2020  D rotation...   
-00011d20: 2020 2020 203a 7061 7261 6d20 6365 6e74       :param cent
-00011d30: 6572 3a20 726f 7461 7469 6f6e 2063 656e  er: rotation cen
-00011d40: 7465 720a 2020 2020 2020 2020 3a70 6172  ter.        :par
-00011d50: 616d 2061 6e67 6c65 3a20 616e 676c 6520  am angle: angle 
-00011d60: 726f 7461 7469 6f6e 0a20 2020 2020 2020  rotation.       
-00011d70: 203a 7265 7475 726e 3a20 6120 6e65 7720   :return: a new 
-00011d80: 726f 7461 7465 6420 4c69 6e65 5365 676d  rotated LineSegm
-00011d90: 656e 7432 440a 2020 2020 2020 2020 2222  ent2D.        ""
-00011da0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00011db0: 204c 696e 6553 6567 6d65 6e74 3244 2873   LineSegment2D(s
-00011dc0: 656c 662e 7374 6172 742e 726f 7461 7469  elf.start.rotati
-00011dd0: 6f6e 2863 656e 7465 722c 2061 6e67 6c65  on(center, angle
-00011de0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00011df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011e00: 7365 6c66 2e65 6e64 2e72 6f74 6174 696f  self.end.rotatio
-00011e10: 6e28 6365 6e74 6572 2c20 616e 676c 6529  n(center, angle)
-00011e20: 290a 0a20 2020 2064 6566 2072 6f74 6174  )..    def rotat
-00011e30: 696f 6e5f 696e 706c 6163 6528 7365 6c66  ion_inplace(self
-00011e40: 2c20 6365 6e74 6572 3a20 766f 6c6d 646c  , center: volmdl
-00011e50: 722e 506f 696e 7432 442c 2061 6e67 6c65  r.Point2D, angle
-00011e60: 3a20 666c 6f61 7429 3a0a 2020 2020 2020  : float):.      
-00011e70: 2020 2222 220a 2020 2020 2020 2020 4c69    """.        Li
-00011e80: 6e65 5365 676d 656e 7432 4420 726f 7461  neSegment2D rota
-00011e90: 7469 6f6e 2e20 4f62 6a65 6374 2069 7320  tion. Object is 
-00011ea0: 7570 6461 7465 6420 696e 706c 6163 652e  updated inplace.
-00011eb0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00011ec0: 2063 656e 7465 723a 2072 6f74 6174 696f   center: rotatio
-00011ed0: 6e20 6365 6e74 6572 2e0a 2020 2020 2020  n center..      
-00011ee0: 2020 3a70 6172 616d 2061 6e67 6c65 3a20    :param angle: 
-00011ef0: 726f 7461 7469 6f6e 2061 6e67 6c65 2e0a  rotation angle..
-00011f00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00011f10: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00011f20: 6e28 2227 696e 706c 6163 6527 206d 6574  n("'inplace' met
-00011f30: 686f 6473 2061 7265 2064 6570 7265 6361  hods are depreca
-00011f40: 7465 642e 2055 7365 2061 206e 6f74 2069  ted. Use a not i
-00011f50: 6e70 6c61 6365 206d 6574 686f 6420 696e  nplace method in
-00011f60: 7374 6561 642e 222c 2044 6570 7265 6361  stead.", Depreca
-00011f70: 7469 6f6e 5761 726e 696e 6729 0a0a 2020  tionWarning)..  
-00011f80: 2020 2020 2020 666f 7220 706f 696e 7420        for point 
-00011f90: 696e 205b 7365 6c66 2e73 7461 7274 2c20  in [self.start, 
-00011fa0: 7365 6c66 2e65 6e64 5d3a 0a20 2020 2020  self.end]:.     
-00011fb0: 2020 2020 2020 2070 6f69 6e74 2e72 6f74         point.rot
-00011fc0: 6174 696f 6e5f 696e 706c 6163 6528 6365  ation_inplace(ce
-00011fd0: 6e74 6572 2c20 616e 676c 6529 0a0a 2020  nter, angle)..  
-00011fe0: 2020 6465 6620 7472 616e 736c 6174 696f    def translatio
-00011ff0: 6e28 7365 6c66 2c20 6f66 6673 6574 3a20  n(self, offset: 
-00012000: 766f 6c6d 646c 722e 5665 6374 6f72 3244  volmdlr.Vector2D
-00012010: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00012020: 2020 2020 2020 204c 696e 6553 6567 6d65         LineSegme
-00012030: 6e74 3244 2074 7261 6e73 6c61 7469 6f6e  nt2D translation
-00012040: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00012050: 6d20 6f66 6673 6574 3a20 7472 616e 736c  m offset: transl
-00012060: 6174 696f 6e20 7665 6374 6f72 2e0a 2020  ation vector..  
-00012070: 2020 2020 2020 3a72 6574 7572 6e3a 2041        :return: A
-00012080: 206e 6577 2074 7261 6e73 6c61 7465 6420   new translated 
-00012090: 4c69 6e65 5365 676d 656e 7432 442e 0a20  LineSegment2D.. 
-000120a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000120b0: 2020 2072 6574 7572 6e20 4c69 6e65 5365     return LineSe
-000120c0: 676d 656e 7432 4428 7365 6c66 2e73 7461  gment2D(self.sta
-000120d0: 7274 2e74 7261 6e73 6c61 7469 6f6e 286f  rt.translation(o
-000120e0: 6666 7365 7429 2c0a 2020 2020 2020 2020  ffset),.        
-000120f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012100: 2020 2020 2073 656c 662e 656e 642e 7472       self.end.tr
-00012110: 616e 736c 6174 696f 6e28 6f66 6673 6574  anslation(offset
-00012120: 2929 0a0a 2020 2020 6465 6620 7472 616e  ))..    def tran
-00012130: 736c 6174 696f 6e5f 696e 706c 6163 6528  slation_inplace(
-00012140: 7365 6c66 2c20 6f66 6673 6574 3a20 766f  self, offset: vo
-00012150: 6c6d 646c 722e 5665 6374 6f72 3244 293a  lmdlr.Vector2D):
-00012160: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00012170: 2020 2020 204c 696e 6553 6567 6d65 6e74       LineSegment
-00012180: 3244 2074 7261 6e73 6c61 7469 6f6e 2e20  2D translation. 
-00012190: 4f62 6a65 6374 2069 7320 7570 6461 7465  Object is update
-000121a0: 6420 696e 706c 6163 652e 0a0a 2020 2020  d inplace...    
-000121b0: 2020 2020 3a70 6172 616d 206f 6666 7365      :param offse
-000121c0: 743a 2074 7261 6e73 6c61 7469 6f6e 2076  t: translation v
-000121d0: 6563 746f 722e 0a20 2020 2020 2020 2022  ector..        "
-000121e0: 2222 0a20 2020 2020 2020 2077 6172 6e69  "".        warni
-000121f0: 6e67 732e 7761 726e 2822 2769 6e70 6c61  ngs.warn("'inpla
-00012200: 6365 2720 6d65 7468 6f64 7320 6172 6520  ce' methods are 
-00012210: 6465 7072 6563 6174 6564 2e20 5573 6520  deprecated. Use 
-00012220: 6120 6e6f 7420 696e 706c 6163 6520 6d65  a not inplace me
-00012230: 7468 6f64 2069 6e73 7465 6164 2e22 2c20  thod instead.", 
-00012240: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
-00012250: 6e67 290a 0a20 2020 2020 2020 2066 6f72  ng)..        for
-00012260: 2070 6f69 6e74 2069 6e20 5b73 656c 662e   point in [self.
-00012270: 7374 6172 742c 2073 656c 662e 656e 645d  start, self.end]
-00012280: 3a0a 2020 2020 2020 2020 2020 2020 706f  :.            po
-00012290: 696e 742e 7472 616e 736c 6174 696f 6e5f  int.translation_
-000122a0: 696e 706c 6163 6528 6f66 6673 6574 290a  inplace(offset).
-000122b0: 0a20 2020 2064 6566 2066 7261 6d65 5f6d  .    def frame_m
-000122c0: 6170 7069 6e67 2873 656c 662c 2066 7261  apping(self, fra
-000122d0: 6d65 3a20 766f 6c6d 646c 722e 4672 616d  me: volmdlr.Fram
-000122e0: 6532 442c 2073 6964 653a 2073 7472 293a  e2D, side: str):
-000122f0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00012300: 2020 2020 2043 6861 6e67 6573 2076 6563       Changes vec
-00012310: 746f 7220 6672 616d 655f 6d61 7070 696e  tor frame_mappin
-00012320: 6720 616e 6420 7265 7475 726e 2061 206e  g and return a n
-00012330: 6577 204c 696e 6553 6567 6d65 6e74 3244  ew LineSegment2D
-00012340: 2e0a 0a20 2020 2020 2020 2073 6964 6520  ...        side 
-00012350: 3d20 276f 6c64 2720 6f72 2027 6e65 7727  = 'old' or 'new'
-00012360: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00012370: 2020 2020 2020 6966 2073 6964 6520 3d3d        if side ==
-00012380: 2027 6f6c 6427 3a0a 2020 2020 2020 2020   'old':.        
-00012390: 2020 2020 6e65 775f 7374 6172 7420 3d20      new_start = 
-000123a0: 6672 616d 652e 6c6f 6361 6c5f 746f 5f67  frame.local_to_g
-000123b0: 6c6f 6261 6c5f 636f 6f72 6469 6e61 7465  lobal_coordinate
-000123c0: 7328 7365 6c66 2e73 7461 7274 290a 2020  s(self.start).  
-000123d0: 2020 2020 2020 2020 2020 6e65 775f 656e            new_en
-000123e0: 6420 3d20 6672 616d 652e 6c6f 6361 6c5f  d = frame.local_
-000123f0: 746f 5f67 6c6f 6261 6c5f 636f 6f72 6469  to_global_coordi
-00012400: 6e61 7465 7328 7365 6c66 2e65 6e64 290a  nates(self.end).
-00012410: 2020 2020 2020 2020 656c 6966 2073 6964          elif sid
-00012420: 6520 3d3d 2027 6e65 7727 3a0a 2020 2020  e == 'new':.    
-00012430: 2020 2020 2020 2020 6e65 775f 7374 6172          new_star
-00012440: 7420 3d20 6672 616d 652e 676c 6f62 616c  t = frame.global
-00012450: 5f74 6f5f 6c6f 6361 6c5f 636f 6f72 6469  _to_local_coordi
-00012460: 6e61 7465 7328 7365 6c66 2e73 7461 7274  nates(self.start
-00012470: 290a 2020 2020 2020 2020 2020 2020 6e65  ).            ne
-00012480: 775f 656e 6420 3d20 6672 616d 652e 676c  w_end = frame.gl
-00012490: 6f62 616c 5f74 6f5f 6c6f 6361 6c5f 636f  obal_to_local_co
-000124a0: 6f72 6469 6e61 7465 7328 7365 6c66 2e65  ordinates(self.e
-000124b0: 6e64 290a 2020 2020 2020 2020 656c 7365  nd).        else
-000124c0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-000124d0: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
-000124e0: 506c 6561 7365 2045 6e74 6572 2061 2076  Please Enter a v
-000124f0: 616c 6964 2073 6964 653a 206f 6c64 206f  alid side: old o
-00012500: 7220 6e65 7727 290a 2020 2020 2020 2020  r new').        
-00012510: 7265 7475 726e 204c 696e 6553 6567 6d65  return LineSegme
-00012520: 6e74 3244 286e 6577 5f73 7461 7274 2c20  nt2D(new_start, 
-00012530: 6e65 775f 656e 6429 0a0a 2020 2020 6465  new_end)..    de
-00012540: 6620 6672 616d 655f 6d61 7070 696e 675f  f frame_mapping_
-00012550: 696e 706c 6163 6528 7365 6c66 2c20 6672  inplace(self, fr
-00012560: 616d 653a 2076 6f6c 6d64 6c72 2e46 7261  ame: volmdlr.Fra
-00012570: 6d65 3244 2c20 7369 6465 3a20 7374 7229  me2D, side: str)
-00012580: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00012590: 2020 2020 2020 4368 616e 6765 7320 7665        Changes ve
-000125a0: 6374 6f72 2066 7261 6d65 5f6d 6170 7069  ctor frame_mappi
-000125b0: 6e67 2061 6e64 2074 6865 206f 626a 6563  ng and the objec
-000125c0: 7420 6973 2075 7064 6174 6564 2069 6e70  t is updated inp
-000125d0: 6c61 6365 2e0a 0a20 2020 2020 2020 203a  lace...        :
-000125e0: 7061 7261 6d20 6672 616d 653a 2066 7261  param frame: fra
-000125f0: 6d65 2074 6f20 6578 6563 7574 6520 7468  me to execute th
-00012600: 6520 6672 616d 6520 6d61 7070 696e 672e  e frame mapping.
-00012610: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00012620: 7369 6465 3a20 276f 6c64 2720 6f72 2027  side: 'old' or '
-00012630: 6e65 7727 2e0a 2020 2020 2020 2020 2222  new'..        ""
-00012640: 220a 2020 2020 2020 2020 7761 726e 696e  ".        warnin
-00012650: 6773 2e77 6172 6e28 2227 696e 706c 6163  gs.warn("'inplac
-00012660: 6527 206d 6574 686f 6473 2061 7265 2064  e' methods are d
-00012670: 6570 7265 6361 7465 642e 2055 7365 2061  eprecated. Use a
-00012680: 206e 6f74 2069 6e70 6c61 6365 206d 6574   not inplace met
-00012690: 686f 6420 696e 7374 6561 642e 222c 2044  hod instead.", D
-000126a0: 6570 7265 6361 7469 6f6e 5761 726e 696e  eprecationWarnin
-000126b0: 6729 0a0a 2020 2020 2020 2020 6966 2073  g)..        if s
-000126c0: 6964 6520 3d3d 2027 6f6c 6427 3a0a 2020  ide == 'old':.  
-000126d0: 2020 2020 2020 2020 2020 6e65 775f 7374            new_st
-000126e0: 6172 7420 3d20 6672 616d 652e 6c6f 6361  art = frame.loca
-000126f0: 6c5f 746f 5f67 6c6f 6261 6c5f 636f 6f72  l_to_global_coor
-00012700: 6469 6e61 7465 7328 7365 6c66 2e73 7461  dinates(self.sta
-00012710: 7274 290a 2020 2020 2020 2020 2020 2020  rt).            
-00012720: 6e65 775f 656e 6420 3d20 6672 616d 652e  new_end = frame.
-00012730: 6c6f 6361 6c5f 746f 5f67 6c6f 6261 6c5f  local_to_global_
-00012740: 636f 6f72 6469 6e61 7465 7328 7365 6c66  coordinates(self
-00012750: 2e65 6e64 290a 2020 2020 2020 2020 656c  .end).        el
-00012760: 6966 2073 6964 6520 3d3d 2027 6e65 7727  if side == 'new'
-00012770: 3a0a 2020 2020 2020 2020 2020 2020 6e65  :.            ne
-00012780: 775f 7374 6172 7420 3d20 6672 616d 652e  w_start = frame.
-00012790: 676c 6f62 616c 5f74 6f5f 6c6f 6361 6c5f  global_to_local_
-000127a0: 636f 6f72 6469 6e61 7465 7328 7365 6c66  coordinates(self
-000127b0: 2e73 7461 7274 290a 2020 2020 2020 2020  .start).        
-000127c0: 2020 2020 6e65 775f 656e 6420 3d20 6672      new_end = fr
-000127d0: 616d 652e 676c 6f62 616c 5f74 6f5f 6c6f  ame.global_to_lo
-000127e0: 6361 6c5f 636f 6f72 6469 6e61 7465 7328  cal_coordinates(
-000127f0: 7365 6c66 2e65 6e64 290a 2020 2020 2020  self.end).      
-00012800: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00012810: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00012820: 7272 6f72 2827 506c 6561 7365 2045 6e74  rror('Please Ent
-00012830: 6572 2061 2076 616c 6964 2073 6964 653a  er a valid side:
-00012840: 206f 6c64 206f 7220 6e65 7727 290a 2020   old or new').  
-00012850: 2020 2020 2020 7365 6c66 2e73 7461 7274        self.start
-00012860: 203d 206e 6577 5f73 7461 7274 0a20 2020   = new_start.   
-00012870: 2020 2020 2073 656c 662e 656e 6420 3d20       self.end = 
-00012880: 6e65 775f 656e 640a 0a20 2020 2064 6566  new_end..    def
-00012890: 2070 6c6f 745f 6461 7461 2873 656c 662c   plot_data(self,
-000128a0: 2065 6467 655f 7374 796c 653a 2070 6c6f   edge_style: plo
-000128b0: 745f 6461 7461 2e45 6467 6553 7479 6c65  t_data.EdgeStyle
-000128c0: 203d 204e 6f6e 6529 3a0a 2020 2020 2020   = None):.      
-000128d0: 2020 2222 220a 2020 2020 2020 2020 506c    """.        Pl
-000128e0: 6f74 2064 6174 6120 6d65 7468 6f64 2066  ot data method f
-000128f0: 6f72 2061 204c 696e 6553 6567 6d65 6e74  or a LineSegment
-00012900: 3244 2e0a 0a20 2020 2020 2020 203a 7061  2D...        :pa
-00012910: 7261 6d20 6564 6765 5f73 7479 6c65 3a20  ram edge_style: 
-00012920: 6564 6765 2073 7479 6c65 2e0a 2020 2020  edge style..    
-00012930: 2020 2020 3a72 6574 7572 6e3a 2070 6c6f      :return: plo
-00012940: 745f 6461 7461 2e4c 696e 6553 6567 6d65  t_data.LineSegme
-00012950: 6e74 3244 206f 626a 6563 742e 0a20 2020  nt2D object..   
-00012960: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00012970: 2072 6574 7572 6e20 706c 6f74 5f64 6174   return plot_dat
-00012980: 612e 4c69 6e65 5365 676d 656e 7432 4428  a.LineSegment2D(
-00012990: 5b73 656c 662e 7374 6172 742e 782c 2073  [self.start.x, s
-000129a0: 656c 662e 7374 6172 742e 795d 2c0a 2020  elf.start.y],.  
-000129b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000129c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000129d0: 2020 2020 205b 7365 6c66 2e65 6e64 2e78       [self.end.x
-000129e0: 2c20 7365 6c66 2e65 6e64 2e79 5d2c 0a20  , self.end.y],. 
-000129f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a10: 2020 2020 2020 6564 6765 5f73 7479 6c65        edge_style
-00012a20: 3d65 6467 655f 7374 796c 6529 0a0a 2020  =edge_style)..  
-00012a30: 2020 6465 6620 6372 6561 7465 5f74 616e    def create_tan
-00012a40: 6765 6e74 5f63 6972 636c 6528 7365 6c66  gent_circle(self
-00012a50: 2c20 706f 696e 742c 206f 7468 6572 5f6c  , point, other_l
-00012a60: 696e 6529 3a0a 2020 2020 2020 2020 6369  ine):.        ci
-00012a70: 7263 6c65 312c 2063 6972 636c 6532 203d  rcle1, circle2 =
-00012a80: 204c 696e 6532 442e 6372 6561 7465 5f74   Line2D.create_t
-00012a90: 616e 6765 6e74 5f63 6972 636c 6528 6f74  angent_circle(ot
-00012aa0: 6865 725f 6c69 6e65 2c20 706f 696e 742c  her_line, point,
-00012ab0: 2073 656c 6629 0a20 2020 2020 2020 2069   self).        i
-00012ac0: 6620 6369 7263 6c65 3120 6973 206e 6f74  f circle1 is not
-00012ad0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00012ae0: 2020 205f 2c20 6375 7276 5f61 6273 3120     _, curv_abs1 
-00012af0: 3d20 4c69 6e65 3244 2e70 6f69 6e74 5f70  = Line2D.point_p
-00012b00: 726f 6a65 6374 696f 6e28 7365 6c66 2c20  rojection(self, 
-00012b10: 6369 7263 6c65 312e 6365 6e74 6572 290a  circle1.center).
-00012b20: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00012b30: 7572 765f 6162 7331 203c 2030 2e20 6f72  urv_abs1 < 0. or
-00012b40: 2063 7572 765f 6162 7331 203e 2073 656c   curv_abs1 > sel
-00012b50: 662e 6c65 6e67 7468 2829 3a0a 2020 2020  f.length():.    
-00012b60: 2020 2020 2020 2020 2020 2020 6369 7263              circ
-00012b70: 6c65 3120 3d20 4e6f 6e65 0a20 2020 2020  le1 = None.     
-00012b80: 2020 2069 6620 6369 7263 6c65 3220 6973     if circle2 is
-00012b90: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00012ba0: 2020 2020 2020 205f 2c20 6375 7276 5f61         _, curv_a
-00012bb0: 6273 3220 3d20 4c69 6e65 3244 2e70 6f69  bs2 = Line2D.poi
-00012bc0: 6e74 5f70 726f 6a65 6374 696f 6e28 7365  nt_projection(se
-00012bd0: 6c66 2c20 6369 7263 6c65 322e 6365 6e74  lf, circle2.cent
-00012be0: 6572 290a 2020 2020 2020 2020 2020 2020  er).            
-00012bf0: 6966 2063 7572 765f 6162 7332 203c 2030  if curv_abs2 < 0
-00012c00: 2e20 6f72 2063 7572 765f 6162 7332 203e  . or curv_abs2 >
-00012c10: 2073 656c 662e 6c65 6e67 7468 2829 3a0a   self.length():.
-00012c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c30: 6369 7263 6c65 3220 3d20 4e6f 6e65 0a20  circle2 = None. 
-00012c40: 2020 2020 2020 2072 6574 7572 6e20 6369         return ci
-00012c50: 7263 6c65 312c 2063 6972 636c 6532 0a0a  rcle1, circle2..
-00012c60: 2020 2020 6465 6620 696e 6669 6e69 7465      def infinite
-00012c70: 5f70 7269 6d69 7469 7665 2873 656c 662c  _primitive(self,
-00012c80: 206f 6666 7365 7429 3a0a 2020 2020 2020   offset):.      
-00012c90: 2020 6e20 3d20 2d73 656c 662e 756e 6974    n = -self.unit
-00012ca0: 5f6e 6f72 6d61 6c5f 7665 6374 6f72 2829  _normal_vector()
-00012cb0: 0a20 2020 2020 2020 206f 6666 7365 745f  .        offset_
-00012cc0: 706f 696e 745f 3120 3d20 7365 6c66 2e73  point_1 = self.s
-00012cd0: 7461 7274 202b 206f 6666 7365 7420 2a20  tart + offset * 
-00012ce0: 6e0a 2020 2020 2020 2020 6f66 6673 6574  n.        offset
-00012cf0: 5f70 6f69 6e74 5f32 203d 2073 656c 662e  _point_2 = self.
-00012d00: 656e 6420 2b20 6f66 6673 6574 202a 206e  end + offset * n
-00012d10: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00012d20: 204c 696e 6532 4428 6f66 6673 6574 5f70   Line2D(offset_p
-00012d30: 6f69 6e74 5f31 2c20 6f66 6673 6574 5f70  oint_1, offset_p
-00012d40: 6f69 6e74 5f32 290a 0a20 2020 2064 6566  oint_2)..    def
-00012d50: 2074 6f5f 7769 7265 2873 656c 662c 206e   to_wire(self, n
-00012d60: 3a20 696e 7429 3a0a 2020 2020 2020 2020  : int):.        
-00012d70: 2222 220a 2020 2020 2020 2020 436f 6e76  """.        Conv
-00012d80: 6572 7420 6120 6c69 6e65 7365 676d 656e  ert a linesegmen
-00012d90: 7432 6420 746f 2061 2077 6972 6532 6420  t2d to a wire2d 
-00012da0: 6465 6669 6e65 6420 7769 7468 2027 6e27  defined with 'n'
-00012db0: 206c 696e 655f 7365 676d 656e 7473 2e0a   line_segments..
-00012dc0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00012dd0: 2020 2020 2020 706f 696e 7473 203d 2073        points = s
-00012de0: 656c 662e 6469 7363 7265 7469 7a61 7469  elf.discretizati
-00012df0: 6f6e 5f70 6f69 6e74 7328 6e75 6d62 6572  on_points(number
-00012e00: 5f70 6f69 6e74 733d 6e20 2b20 3129 0a20  _points=n + 1). 
-00012e10: 2020 2020 2020 2072 6574 7572 6e20 766f         return vo
-00012e20: 6c6d 646c 722e 7769 7265 732e 5769 7265  lmdlr.wires.Wire
-00012e30: 3244 2e66 726f 6d5f 706f 696e 7473 2870  2D.from_points(p
-00012e40: 6f69 6e74 7329 0a0a 2020 2020 6465 6620  oints)..    def 
-00012e50: 6e65 6172 6573 745f 706f 696e 745f 746f  nearest_point_to
-00012e60: 2873 656c 662c 2070 6f69 6e74 293a 0a20  (self, point):. 
-00012e70: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00012e80: 2020 2046 696e 6420 6f75 7420 7468 6520     Find out the 
-00012e90: 6e65 6172 6573 7420 706f 696e 7420 6f6e  nearest point on
-00012ea0: 2074 6865 206c 696e 6573 6567 6d65 6e74   the linesegment
-00012eb0: 2074 6f20 706f 696e 742e 0a0a 2020 2020   to point...    
-00012ec0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-00012ed0: 2070 6f69 6e74 7320 3d20 7365 6c66 2e64   points = self.d
-00012ee0: 6973 6372 6574 697a 6174 696f 6e5f 706f  iscretization_po
-00012ef0: 696e 7473 286e 756d 6265 725f 706f 696e  ints(number_poin
-00012f00: 7473 3d35 3030 290a 2020 2020 2020 2020  ts=500).        
-00012f10: 7265 7475 726e 2070 6f69 6e74 2e6e 6561  return point.nea
-00012f20: 7265 7374 5f70 6f69 6e74 2870 6f69 6e74  rest_point(point
-00012f30: 7329 0a0a 2020 2020 6465 6620 6178 6961  s)..    def axia
-00012f40: 6c5f 7379 6d6d 6574 7279 2873 656c 662c  l_symmetry(self,
-00012f50: 206c 696e 6529 3a0a 2020 2020 2020 2020   line):.        
-00012f60: 2222 220a 2020 2020 2020 2020 4669 6e64  """.        Find
-00012f70: 7320 6f75 7420 7468 6520 7379 6d6d 6574  s out the symmet
-00012f80: 7269 6320 6c69 6e65 7365 676d 656e 7432  ric linesegment2
-00012f90: 6420 6163 636f 7264 696e 6720 746f 2061  d according to a
-00012fa0: 206c 696e 652e 0a20 2020 2020 2020 2022   line..        "
-00012fb0: 2222 0a0a 2020 2020 2020 2020 706f 696e  ""..        poin
-00012fc0: 7473 5f73 796d 6d65 7472 7920 3d20 5b70  ts_symmetry = [p
-00012fd0: 6f69 6e74 2e61 7869 616c 5f73 796d 6d65  oint.axial_symme
-00012fe0: 7472 7928 6c69 6e65 2920 666f 7220 706f  try(line) for po
-00012ff0: 696e 7420 696e 205b 7365 6c66 2e73 7461  int in [self.sta
-00013000: 7274 2c20 7365 6c66 2e65 6e64 5d5d 0a0a  rt, self.end]]..
-00013010: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00013020: 656c 662e 5f5f 636c 6173 735f 5f28 706f  elf.__class__(po
-00013030: 696e 7473 5f73 796d 6d65 7472 795b 305d  ints_symmetry[0]
-00013040: 2c20 706f 696e 7473 5f73 796d 6d65 7472  , points_symmetr
-00013050: 795b 315d 290a 0a0a 636c 6173 7320 4172  y[1])...class Ar
-00013060: 6328 4564 6765 293a 0a20 2020 2022 2222  c(Edge):.    """
-00013070: 0a20 2020 2041 6273 7472 6163 7420 636c  .    Abstract cl
-00013080: 6173 7320 7265 7072 6573 656e 7469 6e67  ass representing
-00013090: 2061 6e20 6172 632e 0a0a 2020 2020 3a70   an arc...    :p
-000130a0: 6172 616d 2073 7461 7274 3a20 5468 6520  aram start: The 
-000130b0: 7374 6172 7469 6e67 2070 6f69 6e74 0a20  starting point. 
-000130c0: 2020 203a 7479 7065 2073 7461 7274 3a20     :type start: 
-000130d0: 556e 696f 6e5b 3a63 6c61 7373 3a60 766f  Union[:class:`vo
-000130e0: 6c6d 646c 722e 506f 696e 7432 4460 2c20  lmdlr.Point2D`, 
-000130f0: 3a63 6c61 7373 3a60 766f 6c6d 646c 722e  :class:`volmdlr.
-00013100: 506f 696e 7433 4460 5d0a 2020 2020 3a70  Point3D`].    :p
-00013110: 6172 616d 2065 6e64 3a20 5468 6520 6669  aram end: The fi
-00013120: 6e69 7368 2070 6f69 6e74 0a20 2020 203a  nish point.    :
-00013130: 7479 7065 2065 6e64 3a20 556e 696f 6e5b  type end: Union[
-00013140: 3a63 6c61 7373 3a60 766f 6c6d 646c 722e  :class:`volmdlr.
-00013150: 506f 696e 7432 4460 2c20 3a63 6c61 7373  Point2D`, :class
-00013160: 3a60 766f 6c6d 646c 722e 506f 696e 7433  :`volmdlr.Point3
-00013170: 4460 5d0a 2020 2020 3a70 6172 616d 2069  D`].    :param i
-00013180: 6e74 6572 696f 723a 2041 6e20 696e 7465  nterior: An inte
-00013190: 7269 6f72 2070 6f69 6e74 0a20 2020 203a  rior point.    :
-000131a0: 7479 7065 2069 6e74 6572 696f 723a 2055  type interior: U
-000131b0: 6e69 6f6e 5b3a 636c 6173 733a 6076 6f6c  nion[:class:`vol
-000131c0: 6d64 6c72 2e50 6f69 6e74 3244 602c 203a  mdlr.Point2D`, :
-000131d0: 636c 6173 733a 6076 6f6c 6d64 6c72 2e50  class:`volmdlr.P
-000131e0: 6f69 6e74 3344 605d 0a20 2020 203a 7061  oint3D`].    :pa
-000131f0: 7261 6d20 6e61 6d65 3a20 5468 6520 6e61  ram name: The na
-00013200: 6d65 206f 6620 7468 6520 6172 632e 2044  me of the arc. D
-00013210: 6566 6175 6c74 2076 616c 7565 2069 7320  efault value is 
-00013220: 616e 2065 6d70 7479 2073 7472 696e 670a  an empty string.
-00013230: 2020 2020 3a74 7970 6520 6e61 6d65 3a20      :type name: 
-00013240: 7374 722c 206f 7074 696f 6e61 6c0a 2020  str, optional.  
-00013250: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
-00013260: 5f69 6e69 745f 5f28 7365 6c66 2c20 7374  _init__(self, st
-00013270: 6172 742c 0a20 2020 2020 2020 2020 2020  art,.           
-00013280: 2020 2020 2020 656e 642c 0a20 2020 2020        end,.     
-00013290: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-000132a0: 7269 6f72 2c0a 2020 2020 2020 2020 2020  rior,.          
-000132b0: 2020 2020 2020 206e 616d 653a 2073 7472         name: str
-000132c0: 203d 2027 2729 3a0a 2020 2020 2020 2020   = ''):.        
-000132d0: 4564 6765 2e5f 5f69 6e69 745f 5f28 7365  Edge.__init__(se
-000132e0: 6c66 2c20 7374 6172 743d 7374 6172 742c  lf, start=start,
-000132f0: 2065 6e64 3d65 6e64 2c20 6e61 6d65 3d6e   end=end, name=n
-00013300: 616d 6529 0a20 2020 2020 2020 2073 656c  ame).        sel
-00013310: 662e 696e 7465 7269 6f72 203d 2069 6e74  f.interior = int
-00013320: 6572 696f 720a 2020 2020 2020 2020 7365  erior.        se
-00013330: 6c66 2e5f 7574 645f 636c 6f63 6b77 6973  lf._utd_clockwis
-00013340: 655f 616e 645f 7472 6967 6f77 6973 655f  e_and_trigowise_
-00013350: 7061 7468 7320 3d20 4661 6c73 650a 2020  paths = False.  
-00013360: 2020 2020 2020 7365 6c66 2e5f 636c 6f63        self._cloc
-00013370: 6b77 6973 655f 616e 645f 7472 6967 6f77  kwise_and_trigow
-00013380: 6973 655f 7061 7468 7320 3d20 4e6f 6e65  ise_paths = None
-00013390: 0a20 2020 2020 2020 2073 656c 662e 5f72  .        self._r
-000133a0: 6164 6975 7320 3d20 4e6f 6e65 0a0a 2020  adius = None..  
-000133b0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-000133c0: 6465 6620 6365 6e74 6572 2873 656c 6629  def center(self)
-000133d0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000133e0: 2020 2020 2020 4765 7473 2074 6865 2061        Gets the a
-000133f0: 7263 2773 2063 656e 7465 722e 0a0a 2020  rc's center...  
-00013400: 2020 2020 2020 3a72 6574 7572 6e3a 2054        :return: T
-00013410: 6865 2063 656e 7465 7220 6f66 2074 6865  he center of the
-00013420: 2061 7263 2e0a 2020 2020 2020 2020 2222   arc..        ""
-00013430: 220a 2020 2020 2020 2020 7261 6973 6520  ".        raise 
-00013440: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00013450: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00013460: 2027 7468 6520 7072 6f70 6572 7479 206d   'the property m
-00013470: 6574 686f 6420 6365 6e74 6572 206d 7573  ethod center mus
-00013480: 7420 6265 206f 7665 726c 6f61 6465 6420  t be overloaded 
-00013490: 6279 2073 7562 636c 6173 7369 6e67 270a  by subclassing'.
-000134a0: 2020 2020 2020 2020 2020 2020 2763 6c61              'cla
-000134b0: 7373 2069 6620 6e6f 7420 6120 6769 7665  ss if not a give
-000134c0: 6e20 7061 7261 6d65 7465 7227 290a 0a20  n parameter').. 
-000134d0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-000134e0: 2064 6566 2061 6e67 6c65 2873 656c 6629   def angle(self)
-000134f0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00013500: 2020 2020 2020 4765 7473 2074 6865 2061        Gets the a
-00013510: 6e67 6c65 206f 6620 7468 6520 6172 632e  ngle of the arc.
-00013520: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00013530: 6e3a 2054 6865 2061 6e67 6c65 206f 6620  n: The angle of 
-00013540: 7468 6520 6172 632e 0a20 2020 2020 2020  the arc..       
-00013550: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-00013560: 7572 6e20 4e6f 7449 6d70 6c65 6d65 6e74  urn NotImplement
-00013570: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
-00013580: 2020 2020 2027 7468 6520 7072 6f70 6572       'the proper
-00013590: 7479 206d 6574 686f 6420 616e 676c 6520  ty method angle 
-000135a0: 6d75 7374 2062 6520 6f76 6572 6c6f 6164  must be overload
-000135b0: 6564 2062 7920 7375 6263 6c61 7373 696e  ed by subclassin
-000135c0: 6727 0a20 2020 2020 2020 2020 2020 2027  g'.            '
-000135d0: 636c 6173 7320 6966 206e 6f74 2061 2067  class if not a g
-000135e0: 6976 656e 2070 6172 616d 6574 6572 2729  iven parameter')
-000135f0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00013600: 2020 2020 6465 6620 6973 5f74 7269 676f      def is_trigo
-00013610: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00013620: 2222 220a 2020 2020 2020 2020 5665 7269  """.        Veri
-00013630: 6669 6573 2069 6620 6172 6320 6973 2074  fies if arc is t
-00013640: 7269 676f 6e6f 6d65 7472 6963 2077 6973  rigonometric wis
-00013650: 6520 6f72 2063 6c6f 636b 7769 7365 2e0a  e or clockwise..
-00013660: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00013670: 3a20 5472 7565 2069 6620 7472 6967 6f6e  : True if trigon
-00013680: 6f6d 6574 7269 6320 7769 7365 206f 7220  ometric wise or 
-00013690: 4661 6c73 6520 6f74 6865 7277 6973 652e  False otherwise.
-000136a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000136b0: 2020 2020 2072 6574 7572 6e20 4e6f 7449       return NotI
-000136c0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-000136d0: 0a20 2020 2020 2020 2020 2020 2027 7468  .            'th
-000136e0: 6520 7072 6f70 6572 7479 206d 6574 686f  e property metho
-000136f0: 6420 6973 5f74 7269 676f 206d 7573 7420  d is_trigo must 
-00013700: 6265 206f 7665 726c 6f61 6465 6420 6279  be overloaded by
-00013710: 2073 7562 636c 6173 7369 6e67 270a 2020   subclassing'.  
-00013720: 2020 2020 2020 2020 2020 2763 6c61 7373            'class
-00013730: 2069 6620 6e6f 7420 6120 6769 7665 6e20   if not a given 
-00013740: 7061 7261 6d65 7465 7227 290a 0a20 2020  parameter')..   
-00013750: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00013760: 6566 2072 6164 6975 7328 7365 6c66 293a  ef radius(self):
-00013770: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00013780: 7365 6c66 2e5f 7261 6469 7573 3a0a 2020  self._radius:.  
-00013790: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-000137a0: 7261 6469 7573 203d 2028 7365 6c66 2e73  radius = (self.s
-000137b0: 7461 7274 202d 2073 656c 662e 6365 6e74  tart - self.cent
-000137c0: 6572 292e 6e6f 726d 2829 0a20 2020 2020  er).norm().     
-000137d0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-000137e0: 7261 6469 7573 0a0a 2020 2020 6465 6620  radius..    def 
-000137f0: 6c65 6e67 7468 2873 656c 6629 3a0a 2020  length(self):.  
-00013800: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00013810: 2020 4361 6c63 756c 6174 6573 2074 6865    Calculates the
-00013820: 206c 656e 6774 6820 6f66 2074 6865 2041   length of the A
-00013830: 7263 2c20 7769 7468 2069 7473 2072 6164  rc, with its rad
-00013840: 6975 7320 616e 6420 6974 2061 7263 2061  ius and it arc a
-00013850: 6e67 6c65 2e0a 0a20 2020 2020 2020 203a  ngle...        :
-00013860: 7265 7475 726e 3a20 7468 6520 6c65 6e67  return: the leng
-00013870: 7468 2066 6f20 7468 6520 4172 632e 0a20  th fo the Arc.. 
-00013880: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00013890: 2020 2072 6574 7572 6e20 7365 6c66 2e72     return self.r
-000138a0: 6164 6975 7320 2a20 6162 7328 7365 6c66  adius * abs(self
-000138b0: 2e61 6e67 6c65 290a 0a20 2020 2064 6566  .angle)..    def
-000138c0: 2070 6f69 6e74 5f61 745f 6162 7363 6973   point_at_abscis
-000138d0: 7361 2873 656c 662c 2061 6273 6369 7373  sa(self, absciss
-000138e0: 6129 3a0a 2020 2020 2020 2020 2222 220a  a):.        """.
-000138f0: 2020 2020 2020 2020 4361 6c63 756c 6174          Calculat
-00013900: 6573 2061 2070 6f69 6e74 2069 6e20 7468  es a point in th
-00013910: 6520 4172 6320 6174 2061 2067 6976 656e  e Arc at a given
-00013920: 2061 6273 6369 7373 612e 0a0a 2020 2020   abscissa...    
-00013930: 2020 2020 3a70 6172 616d 2061 6273 6369      :param absci
-00013940: 7373 613a 2061 6273 6369 7373 6120 7768  ssa: abscissa wh
-00013950: 6572 6520 696e 2074 6865 2063 7572 7665  ere in the curve
-00013960: 2074 6865 2070 6f69 6e74 2073 686f 756c   the point shoul
-00013970: 6420 6265 2063 616c 6375 6c61 7465 642e  d be calculated.
-00013980: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00013990: 3a20 436f 7272 6573 706f 6e64 696e 6720  : Corresponding 
-000139a0: 706f 696e 742e 0a20 2020 2020 2020 2022  point..        "
-000139b0: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
-000139c0: 6c66 2e69 735f 7472 6967 6f3a 0a20 2020  lf.is_trigo:.   
-000139d0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000139e0: 7365 6c66 2e73 7461 7274 2e72 6f74 6174  self.start.rotat
-000139f0: 696f 6e28 7365 6c66 2e63 656e 7465 722c  ion(self.center,
-00013a00: 2061 6273 6369 7373 6120 2f20 7365 6c66   abscissa / self
-00013a10: 2e72 6164 6975 7329 0a20 2020 2020 2020  .radius).       
-00013a20: 2072 6574 7572 6e20 7365 6c66 2e73 7461   return self.sta
-00013a30: 7274 2e72 6f74 6174 696f 6e28 7365 6c66  rt.rotation(self
-00013a40: 2e63 656e 7465 722c 202d 6162 7363 6973  .center, -abscis
-00013a50: 7361 202f 2073 656c 662e 7261 6469 7573  sa / self.radius
-00013a60: 290a 0a20 2020 2040 7374 6174 6963 6d65  )..    @staticme
-00013a70: 7468 6f64 0a20 2020 2064 6566 2067 6574  thod.    def get
-00013a80: 5f63 6c6f 636b 7769 7365 5f61 6e64 5f74  _clockwise_and_t
-00013a90: 7269 676f 7769 7365 5f70 6174 6873 2872  rigowise_paths(r
-00013aa0: 6164 6975 735f 312c 2072 6164 6975 735f  adius_1, radius_
-00013ab0: 322c 2072 6164 6975 735f 6929 3a0a 2020  2, radius_i):.  
-00013ac0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00013ad0: 2020 4765 7420 6172 6320 7061 7468 7320    Get arc paths 
-00013ae0: 6672 6f6d 2072 6164 6975 732e 0a0a 2020  from radius...  
-00013af0: 2020 2020 2020 3a70 6172 616d 2072 6164        :param rad
-00013b00: 6975 735f 313a 2072 6164 6975 7320 6672  ius_1: radius fr
-00013b10: 6f6d 2063 656e 7465 7220 746f 2073 7461  om center to sta
-00013b20: 7274 2070 6f69 6e74 2e0a 2020 2020 2020  rt point..      
-00013b30: 2020 3a70 6172 616d 2072 6164 6975 735f    :param radius_
-00013b40: 323a 2072 6164 6975 7320 666f 726d 2063  2: radius form c
-00013b50: 656e 7465 7220 746f 2065 6e64 2070 6f69  enter to end poi
-00013b60: 6e74 2e0a 2020 2020 2020 2020 3a70 6172  nt..        :par
-00013b70: 616d 2072 6164 6975 735f 693a 2072 6164  am radius_i: rad
-00013b80: 6975 7320 6672 6f6d 2063 656e 7465 7220  ius from center 
-00013b90: 746f 2069 6e74 6572 696f 7220 706f 696e  to interior poin
-00013ba0: 742e 0a20 2020 2020 2020 203a 7265 7475  t..        :retu
-00013bb0: 726e 3a20 7468 6520 636c 6f63 6b77 6973  rn: the clockwis
-00013bc0: 6520 616e 6420 7472 6967 6f77 6973 6520  e and trigowise 
-00013bd0: 7061 7468 732e 0a20 2020 2020 2020 2022  paths..        "
-00013be0: 2222 0a20 2020 2020 2020 2061 6e67 6c65  "".        angle
-00013bf0: 3120 3d20 6d61 7468 2e61 7461 6e32 2872  1 = math.atan2(r
-00013c00: 6164 6975 735f 312e 792c 2072 6164 6975  adius_1.y, radiu
-00013c10: 735f 312e 7829 0a20 2020 2020 2020 2061  s_1.x).        a
-00013c20: 6e67 6c65 6920 3d20 6d61 7468 2e61 7461  nglei = math.ata
-00013c30: 6e32 2872 6164 6975 735f 692e 792c 2072  n2(radius_i.y, r
-00013c40: 6164 6975 735f 692e 7829 0a20 2020 2020  adius_i.x).     
-00013c50: 2020 2061 6e67 6c65 3220 3d20 6d61 7468     angle2 = math
-00013c60: 2e61 7461 6e32 2872 6164 6975 735f 322e  .atan2(radius_2.
-00013c70: 792c 2072 6164 6975 735f 322e 7829 0a0a  y, radius_2.x)..
-00013c80: 2020 2020 2020 2020 2320 476f 696e 6720          # Going 
-00013c90: 7472 6967 6f2f 636c 6f63 6b20 7769 7365  trigo/clock wise
-00013ca0: 2066 726f 6d20 7374 6172 7420 746f 2069   from start to i
-00013cb0: 6e74 6572 696f 720a 2020 2020 2020 2020  nterior.        
-00013cc0: 6966 2061 6e67 6c65 6920 3c20 616e 676c  if anglei < angl
-00013cd0: 6531 3a0a 2020 2020 2020 2020 2020 2020  e1:.            
-00013ce0: 7472 6967 6f77 6973 655f 7061 7468 203d  trigowise_path =
-00013cf0: 2028 616e 676c 6569 202b 2076 6f6c 6d64   (anglei + volmd
-00013d00: 6c72 2e54 574f 5f50 4929 202d 2061 6e67  lr.TWO_PI) - ang
-00013d10: 6c65 310a 2020 2020 2020 2020 2020 2020  le1.            
-00013d20: 636c 6f63 6b77 6973 655f 7061 7468 203d  clockwise_path =
-00013d30: 2061 6e67 6c65 3120 2d20 616e 676c 6569   angle1 - anglei
-00013d40: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00013d50: 2020 2020 2020 2020 2020 2074 7269 676f             trigo
-00013d60: 7769 7365 5f70 6174 6820 3d20 616e 676c  wise_path = angl
-00013d70: 6569 202d 2061 6e67 6c65 310a 2020 2020  ei - angle1.    
-00013d80: 2020 2020 2020 2020 636c 6f63 6b77 6973          clockwis
-00013d90: 655f 7061 7468 203d 2061 6e67 6c65 3120  e_path = angle1 
-00013da0: 2d20 616e 676c 6569 202b 2076 6f6c 6d64  - anglei + volmd
-00013db0: 6c72 2e54 574f 5f50 490a 0a20 2020 2020  lr.TWO_PI..     
-00013dc0: 2020 2023 2047 6f69 6e67 2074 7269 676f     # Going trigo
-00013dd0: 2077 6973 6520 6672 6f6d 2069 6e74 6572   wise from inter
-00013de0: 696f 7220 746f 2069 6e74 6572 696f 720a  ior to interior.
-00013df0: 2020 2020 2020 2020 6966 2061 6e67 6c65          if angle
-00013e00: 3220 3c20 616e 676c 6569 3a0a 2020 2020  2 < anglei:.    
-00013e10: 2020 2020 2020 2020 7472 6967 6f77 6973          trigowis
-00013e20: 655f 7061 7468 202b 3d20 2861 6e67 6c65  e_path += (angle
-00013e30: 3220 2b20 766f 6c6d 646c 722e 5457 4f5f  2 + volmdlr.TWO_
-00013e40: 5049 2920 2d20 616e 676c 6569 0a20 2020  PI) - anglei.   
-00013e50: 2020 2020 2020 2020 2063 6c6f 636b 7769           clockwi
-00013e60: 7365 5f70 6174 6820 2b3d 2061 6e67 6c65  se_path += angle
-00013e70: 6920 2d20 616e 676c 6532 0a20 2020 2020  i - angle2.     
-00013e80: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00013e90: 2020 2020 2074 7269 676f 7769 7365 5f70       trigowise_p
-00013ea0: 6174 6820 2b3d 2061 6e67 6c65 3220 2d20  ath += angle2 - 
-00013eb0: 616e 676c 6569 0a20 2020 2020 2020 2020  anglei.         
-00013ec0: 2020 2063 6c6f 636b 7769 7365 5f70 6174     clockwise_pat
-00013ed0: 6820 2b3d 2061 6e67 6c65 6920 2d20 616e  h += anglei - an
-00013ee0: 676c 6532 202b 2076 6f6c 6d64 6c72 2e54  gle2 + volmdlr.T
-00013ef0: 574f 5f50 490a 2020 2020 2020 2020 7265  WO_PI.        re
-00013f00: 7475 726e 2063 6c6f 636b 7769 7365 5f70  turn clockwise_p
-00013f10: 6174 682c 2074 7269 676f 7769 7365 5f70  ath, trigowise_p
-00013f20: 6174 680a 0a20 2020 2064 6566 206d 6964  ath..    def mid
-00013f30: 646c 655f 706f 696e 7428 7365 6c66 293a  dle_point(self):
-00013f40: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00013f50: 2020 2020 2047 6574 2070 6f69 6e74 2069       Get point i
-00013f60: 6e20 7468 6520 6d69 6464 6c65 206f 6620  n the middle of 
-00013f70: 4172 632e 0a20 2020 2020 2020 2022 2222  Arc..        """
-00013f80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00013f90: 7365 6c66 2e70 6f69 6e74 5f61 745f 6162  self.point_at_ab
-00013fa0: 7363 6973 7361 2830 2e35 202a 2073 656c  scissa(0.5 * sel
-00013fb0: 662e 6c65 6e67 7468 2829 290a 0a20 2020  f.length())..   
-00013fc0: 2064 6566 2070 6f69 6e74 5f64 6973 7461   def point_dista
-00013fd0: 6e63 6528 7365 6c66 2c20 706f 696e 7429  nce(self, point)
-00013fe0: 3a0a 2020 2020 2020 2020 706f 696e 7473  :.        points
-00013ff0: 203d 2073 656c 662e 6469 7363 7265 7469   = self.discreti
-00014000: 7a61 7469 6f6e 5f70 6f69 6e74 7328 616e  zation_points(an
-00014010: 676c 655f 7265 736f 6c75 7469 6f6e 3d31  gle_resolution=1
-00014020: 3030 290a 2020 2020 2020 2020 7265 7475  00).        retu
-00014030: 726e 2070 6f69 6e74 2e70 6f69 6e74 5f64  rn point.point_d
-00014040: 6973 7461 6e63 6528 706f 696e 742e 6e65  istance(point.ne
-00014050: 6172 6573 745f 706f 696e 7428 706f 696e  arest_point(poin
-00014060: 7473 2929 0a0a 2020 2020 6465 6620 6469  ts))..    def di
-00014070: 7363 7265 7469 7a61 7469 6f6e 5f70 6f69  scretization_poi
-00014080: 6e74 7328 7365 6c66 2c20 2a2c 206e 756d  nts(self, *, num
-00014090: 6265 725f 706f 696e 7473 3a20 696e 7420  ber_points: int 
-000140a0: 3d20 4e6f 6e65 2c20 616e 676c 655f 7265  = None, angle_re
-000140b0: 736f 6c75 7469 6f6e 3a20 696e 7420 3d20  solution: int = 
-000140c0: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
-000140d0: 2222 0a20 2020 2020 2020 2044 6973 6372  "".        Discr
-000140e0: 6574 697a 6520 6120 4564 6765 2074 6f20  etize a Edge to 
-000140f0: 6861 7665 2022 6e22 2070 6f69 6e74 732e  have "n" points.
-00014100: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00014110: 206e 756d 6265 725f 706f 696e 7473 3a20   number_points: 
-00014120: 7468 6520 6e75 6d62 6572 206f 6620 706f  the number of po
-00014130: 696e 7473 2028 696e 636c 7564 696e 6720  ints (including 
-00014140: 7374 6172 7420 616e 6420 656e 6420 706f  start and end po
-00014150: 696e 7473 290a 2020 2020 2020 2020 2020  ints).          
-00014160: 2020 2069 6620 756e 7365 742c 206f 6e6c     if unset, onl
-00014170: 7920 7374 6172 7420 616e 6420 656e 6420  y start and end 
-00014180: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
-00014190: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000141a0: 616e 676c 655f 7265 736f 6c75 7469 6f6e  angle_resolution
-000141b0: 3a20 6966 2073 6574 2c20 7468 6520 7361  : if set, the sa
-000141c0: 6d70 6c69 6e67 2077 696c 6c20 6265 2061  mpling will be a
-000141d0: 6461 7074 6564 2074 6f20 6861 7665 2061  dapted to have a
-000141e0: 2063 6f6e 7472 6f6c 6c65 6420 616e 6775   controlled angu
-000141f0: 6c61 7220 6469 7374 616e 6365 2e20 5573  lar distance. Us
-00014200: 6566 756c 0a20 2020 2020 2020 2020 2020  eful.           
-00014210: 2074 6f20 6d65 7368 2061 6e20 6172 630a   to mesh an arc.
-00014220: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00014230: 2061 206c 6973 7420 6f66 2073 616d 706c   a list of sampl
-00014240: 6564 2070 6f69 6e74 730a 2020 2020 2020  ed points.      
-00014250: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00014260: 206e 6f74 206e 756d 6265 725f 706f 696e   not number_poin
-00014270: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-00014280: 6966 206e 6f74 2061 6e67 6c65 5f72 6573  if not angle_res
-00014290: 6f6c 7574 696f 6e3a 0a20 2020 2020 2020  olution:.       
-000142a0: 2020 2020 2020 2020 206e 756d 6265 725f           number_
-000142b0: 706f 696e 7473 203d 2032 0a20 2020 2020  points = 2.     
-000142c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000142d0: 2020 2020 2020 2020 2020 2020 206e 756d               num
-000142e0: 6265 725f 706f 696e 7473 203d 206d 6174  ber_points = mat
-000142f0: 682e 6365 696c 2873 656c 662e 616e 676c  h.ceil(self.angl
-00014300: 6520 2a20 616e 676c 655f 7265 736f 6c75  e * angle_resolu
-00014310: 7469 6f6e 2920 2b20 320a 0a20 2020 2020  tion) + 2..     
-00014320: 2020 2073 7465 7020 3d20 7365 6c66 2e6c     step = self.l
-00014330: 656e 6774 6828 2920 2f20 286e 756d 6265  ength() / (numbe
-00014340: 725f 706f 696e 7473 202d 2031 290a 2020  r_points - 1).  
-00014350: 2020 2020 2020 7265 7475 726e 205b 7365        return [se
-00014360: 6c66 2e70 6f69 6e74 5f61 745f 6162 7363  lf.point_at_absc
-00014370: 6973 7361 2869 202a 2073 7465 7029 0a20  issa(i * step). 
-00014380: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00014390: 6f72 2069 2069 6e20 7261 6e67 6528 6e75  or i in range(nu
-000143a0: 6d62 6572 5f70 6f69 6e74 7329 5d0a 0a20  mber_points)].. 
-000143b0: 2020 2064 6566 2070 6f6c 7967 6f6e 5f70     def polygon_p
-000143c0: 6f69 6e74 7328 7365 6c66 2c20 6469 7363  oints(self, disc
-000143d0: 7265 7469 7a61 7469 6f6e 5f72 6573 6f6c  retization_resol
-000143e0: 7574 696f 6e3a 2069 6e74 293a 0a20 2020  ution: int):.   
-000143f0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00014400: 726e 2827 706f 6c79 676f 6e5f 706f 696e  rn('polygon_poin
-00014410: 7473 2069 7320 6465 7072 6563 6174 6564  ts is deprecated
-00014420: 2c5c 0a20 2020 2020 2020 2070 6c65 6173  ,\.        pleas
-00014430: 6520 7573 6520 6469 7363 7265 7469 7a61  e use discretiza
-00014440: 7469 6f6e 5f70 6f69 6e74 7320 696e 7374  tion_points inst
-00014450: 6561 6427 2c0a 2020 2020 2020 2020 2020  ead',.          
-00014460: 2020 2020 2020 2020 2020 2020 4465 7072              Depr
-00014470: 6563 6174 696f 6e57 6172 6e69 6e67 290a  ecationWarning).
-00014480: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00014490: 656c 662e 6469 7363 7265 7469 7a61 7469  elf.discretizati
-000144a0: 6f6e 5f70 6f69 6e74 7328 6e75 6d62 6572  on_points(number
-000144b0: 5f70 6f69 6e74 733d 6469 7363 7265 7469  _points=discreti
+0000fab0: 7920 3d20 5b31 5d20 2a20 6c65 6e28 6b6e  y = [1] * len(kn
+0000fac0: 6f74 7665 6374 6f72 290a 0a20 2020 2020  otvector)..     
+0000fad0: 2020 2042 5370 6c69 6e65 4375 7276 6532     BSplineCurve2
+0000fae0: 442e 5f5f 696e 6974 5f5f 2873 656c 662c  D.__init__(self,
+0000faf0: 2064 6567 7265 652c 2063 6f6e 7472 6f6c   degree, control
+0000fb00: 5f70 6f69 6e74 732c 0a20 2020 2020 2020  _points,.       
+0000fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fb20: 2020 2020 2020 2020 206b 6e6f 745f 6d75           knot_mu
+0000fb30: 6c74 6970 6c69 6369 7479 2c20 6b6e 6f74  ltiplicity, knot
+0000fb40: 7665 6374 6f72 2c0a 2020 2020 2020 2020  vector,.        
+0000fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fb60: 2020 2020 2020 2020 4e6f 6e65 2c20 4661          None, Fa
+0000fb70: 6c73 652c 206e 616d 6529 0a0a 0a63 6c61  lse, name)...cla
+0000fb80: 7373 204c 696e 6553 6567 6d65 6e74 3244  ss LineSegment2D
+0000fb90: 284c 696e 6553 6567 6d65 6e74 293a 0a20  (LineSegment):. 
+0000fba0: 2020 2022 2222 0a20 2020 2044 6566 696e     """.    Defin
+0000fbb0: 6520 6120 6c69 6e65 2073 6567 6d65 6e74  e a line segment
+0000fbc0: 206c 696d 6974 6564 2062 7920 7477 6f20   limited by two 
+0000fbd0: 706f 696e 7473 2e0a 0a20 2020 2022 2222  points...    """
+0000fbe0: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+0000fbf0: 5f5f 2873 656c 662c 2073 7461 7274 3a20  __(self, start: 
+0000fc00: 766f 6c6d 646c 722e 506f 696e 7432 442c  volmdlr.Point2D,
+0000fc10: 2065 6e64 3a20 766f 6c6d 646c 722e 506f   end: volmdlr.Po
+0000fc20: 696e 7432 442c 202a 2c20 6e61 6d65 3a20  int2D, *, name: 
+0000fc30: 7374 7220 3d20 2727 293a 0a20 2020 2020  str = ''):.     
+0000fc40: 2020 2069 6620 7374 6172 7420 3d3d 2065     if start == e
+0000fc50: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
+0000fc60: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+0000fc70: 6e74 6564 4572 726f 720a 2020 2020 2020  ntedError.      
+0000fc80: 2020 2320 7365 6c66 2e70 6f69 6e74 7320    # self.points 
+0000fc90: 3d20 5b73 7461 7274 2c20 656e 645d 0a20  = [start, end]. 
+0000fca0: 2020 2020 2020 2073 656c 662e 5f62 6f75         self._bou
+0000fcb0: 6e64 696e 675f 7265 6374 616e 676c 6520  nding_rectangle 
+0000fcc0: 3d20 4e6f 6e65 0a20 2020 2020 2020 204c  = None.        L
+0000fcd0: 696e 6553 6567 6d65 6e74 2e5f 5f69 6e69  ineSegment.__ini
+0000fce0: 745f 5f28 7365 6c66 2c20 7374 6172 742c  t__(self, start,
+0000fcf0: 2065 6e64 2c20 6e61 6d65 3d6e 616d 6529   end, name=name)
+0000fd00: 0a0a 2020 2020 6465 6620 5f5f 6861 7368  ..    def __hash
+0000fd10: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+0000fd20: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+0000fd30: 6174 615f 6861 7368 2829 0a0a 2020 2020  ata_hash()..    
+0000fd40: 6465 6620 5f64 6174 615f 6861 7368 2873  def _data_hash(s
+0000fd50: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+0000fd60: 7475 726e 2073 656c 662e 7374 6172 742e  turn self.start.
+0000fd70: 5f64 6174 615f 6861 7368 2829 202b 2073  _data_hash() + s
+0000fd80: 656c 662e 656e 642e 5f64 6174 615f 6861  elf.end._data_ha
+0000fd90: 7368 2829 0a0a 2020 2020 6465 6620 5f64  sh()..    def _d
+0000fda0: 6174 615f 6571 2873 656c 662c 206f 7468  ata_eq(self, oth
+0000fdb0: 6572 5f6f 626a 6563 7429 3a0a 2020 2020  er_object):.    
+0000fdc0: 2020 2020 6966 2073 656c 662e 5f5f 636c      if self.__cl
+0000fdd0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2021  ass__.__name__ !
+0000fde0: 3d20 6f74 6865 725f 6f62 6a65 6374 2e5f  = other_object._
+0000fdf0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+0000fe00: 5f3a 0a20 2020 2020 2020 2020 2020 2072  _:.            r
+0000fe10: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
+0000fe20: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000fe30: 7374 6172 7420 3d3d 206f 7468 6572 5f6f  start == other_o
+0000fe40: 626a 6563 742e 7374 6172 7420 616e 6420  bject.start and 
+0000fe50: 7365 6c66 2e65 6e64 203d 3d20 6f74 6865  self.end == othe
+0000fe60: 725f 6f62 6a65 6374 2e65 6e64 0a0a 2020  r_object.end..  
+0000fe70: 2020 6465 6620 5f5f 6571 5f5f 2873 656c    def __eq__(sel
+0000fe80: 662c 206f 7468 6572 5f6f 626a 6563 7429  f, other_object)
+0000fe90: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
+0000fea0: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
+0000feb0: 6d65 5f5f 2021 3d20 6f74 6865 725f 6f62  me__ != other_ob
+0000fec0: 6a65 6374 2e5f 5f63 6c61 7373 5f5f 2e5f  ject.__class__._
+0000fed0: 5f6e 616d 655f 5f3a 0a20 2020 2020 2020  _name__:.       
+0000fee0: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
+0000fef0: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
+0000ff00: 2073 656c 662e 7374 6172 7420 3d3d 206f   self.start == o
+0000ff10: 7468 6572 5f6f 626a 6563 742e 7374 6172  ther_object.star
+0000ff20: 7420 616e 6420 7365 6c66 2e65 6e64 203d  t and self.end =
+0000ff30: 3d20 6f74 6865 725f 6f62 6a65 6374 2e65  = other_object.e
+0000ff40: 6e64 0a0a 2020 2020 6465 6620 6469 7265  nd..    def dire
+0000ff50: 6374 696f 6e5f 696e 6465 7065 6e64 656e  ction_independen
+0000ff60: 745f 6571 2873 656c 662c 206c 696e 6573  t_eq(self, lines
+0000ff70: 6567 6d65 6e74 3229 3a0a 2020 2020 2020  egment2):.      
+0000ff80: 2020 2222 220a 2020 2020 2020 2020 5665    """.        Ve
+0000ff90: 7269 6669 6573 2069 6620 7477 6f20 6c69  rifies if two li
+0000ffa0: 6e65 2073 6567 6d65 6e74 7320 6172 6520  ne segments are 
+0000ffb0: 7468 6520 7361 6d65 2c20 6e6f 7420 636f  the same, not co
+0000ffc0: 6e73 6964 6572 696e 6720 6974 7320 6469  nsidering its di
+0000ffd0: 7265 6374 696f 6e2e 0a0a 2020 2020 2020  rection...      
+0000ffe0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+0000fff0: 2073 656c 6620 3d3d 206c 696e 6573 6567   self == lineseg
+00010000: 6d65 6e74 323a 0a20 2020 2020 2020 2020  ment2:.         
+00010010: 2020 2072 6574 7572 6e20 5472 7565 0a20     return True. 
+00010020: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00010030: 6c66 2e73 7461 7274 203d 3d20 6c69 6e65  lf.start == line
+00010040: 7365 676d 656e 7432 2e65 6e64 2061 6e64  segment2.end and
+00010050: 2073 656c 662e 656e 6420 3d3d 206c 696e   self.end == lin
+00010060: 6573 6567 6d65 6e74 322e 7374 6172 740a  esegment2.start.
+00010070: 0a20 2020 2064 6566 2074 6f5f 6469 6374  .    def to_dict
+00010080: 2873 656c 662c 202a 6172 6773 2c20 2a2a  (self, *args, **
+00010090: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+000100a0: 2072 6574 7572 6e20 7b27 6f62 6a65 6374   return {'object
+000100b0: 5f63 6c61 7373 273a 2027 766f 6c6d 646c  _class': 'volmdl
+000100c0: 722e 6564 6765 732e 4c69 6e65 5365 676d  r.edges.LineSegm
+000100d0: 656e 7432 4427 2c0a 2020 2020 2020 2020  ent2D',.        
+000100e0: 2020 2020 2020 2020 276e 616d 6527 3a20          'name': 
+000100f0: 7365 6c66 2e6e 616d 652c 0a20 2020 2020  self.name,.     
+00010100: 2020 2020 2020 2020 2020 2027 7374 6172             'star
+00010110: 7427 3a20 7365 6c66 2e73 7461 7274 2e74  t': self.start.t
+00010120: 6f5f 6469 6374 2829 2c0a 2020 2020 2020  o_dict(),.      
+00010130: 2020 2020 2020 2020 2020 2765 6e64 273a            'end':
+00010140: 2073 656c 662e 656e 642e 746f 5f64 6963   self.end.to_dic
+00010150: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
+00010160: 2020 2020 7d0a 0a20 2020 2023 2064 6566      }..    # def
+00010170: 206d 6964 646c 655f 706f 696e 7428 7365   middle_point(se
+00010180: 6c66 293a 0a20 2020 2023 2020 2020 2072  lf):.    #     r
+00010190: 6574 7572 6e20 302e 3520 2a20 2873 656c  eturn 0.5 * (sel
+000101a0: 662e 7374 6172 7420 2b20 7365 6c66 2e65  f.start + self.e
+000101b0: 6e64 290a 2020 2020 230a 2020 2020 2320  nd).    #.    # 
+000101c0: 6465 6620 706f 696e 745f 6174 5f61 6273  def point_at_abs
+000101d0: 6369 7373 6128 7365 6c66 2c20 6162 7363  cissa(self, absc
+000101e0: 6973 7361 293a 0a20 2020 2023 2020 2020  issa):.    #    
+000101f0: 2072 6574 7572 6e20 7365 6c66 2e73 7461   return self.sta
+00010200: 7274 202b 2073 656c 662e 756e 6974 5f64  rt + self.unit_d
+00010210: 6972 6563 7469 6f6e 5f76 6563 746f 7228  irection_vector(
+00010220: 2920 2a20 6162 7363 6973 7361 0a0a 2020  ) * abscissa..  
+00010230: 2020 6465 6620 706f 696e 745f 6265 6c6f    def point_belo
+00010240: 6e67 7328 7365 6c66 2c20 706f 696e 742c  ngs(self, point,
+00010250: 2061 6273 5f74 6f6c 3d31 652d 3629 3a0a   abs_tol=1e-6):.
+00010260: 2020 2020 2020 2020 706f 696e 745f 6469          point_di
+00010270: 7374 616e 6365 203d 2073 656c 662e 706f  stance = self.po
+00010280: 696e 745f 6469 7374 616e 6365 2870 6f69  int_distance(poi
+00010290: 6e74 290a 2020 2020 2020 2020 6966 206d  nt).        if m
+000102a0: 6174 682e 6973 636c 6f73 6528 706f 696e  ath.isclose(poin
+000102b0: 745f 6469 7374 616e 6365 2c20 302c 2061  t_distance, 0, a
+000102c0: 6273 5f74 6f6c 3d61 6273 5f74 6f6c 293a  bs_tol=abs_tol):
+000102d0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000102e0: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
+000102f0: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
+00010300: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00010310: 2064 6566 2062 6f75 6e64 696e 675f 7265   def bounding_re
+00010320: 6374 616e 676c 6528 7365 6c66 293a 0a20  ctangle(self):. 
+00010330: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+00010340: 6c66 2e5f 626f 756e 6469 6e67 5f72 6563  lf._bounding_rec
+00010350: 7461 6e67 6c65 3a0a 2020 2020 2020 2020  tangle:.        
+00010360: 2020 2020 7365 6c66 2e5f 626f 756e 6469      self._boundi
+00010370: 6e67 5f72 6563 7461 6e67 6c65 203d 2076  ng_rectangle = v
+00010380: 6f6c 6d64 6c72 2e63 6f72 652e 426f 756e  olmdlr.core.Boun
+00010390: 6469 6e67 5265 6374 616e 676c 6528 0a20  dingRectangle(. 
+000103a0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000103b0: 696e 2873 656c 662e 7374 6172 742e 782c  in(self.start.x,
+000103c0: 2073 656c 662e 656e 642e 7829 2c20 6d61   self.end.x), ma
+000103d0: 7828 7365 6c66 2e73 7461 7274 2e78 2c20  x(self.start.x, 
+000103e0: 7365 6c66 2e65 6e64 2e78 292c 0a20 2020  self.end.x),.   
+000103f0: 2020 2020 2020 2020 2020 2020 206d 696e               min
+00010400: 2873 656c 662e 7374 6172 742e 792c 2073  (self.start.y, s
+00010410: 656c 662e 656e 642e 7929 2c20 6d61 7828  elf.end.y), max(
+00010420: 7365 6c66 2e73 7461 7274 2e79 2c20 7365  self.start.y, se
+00010430: 6c66 2e65 6e64 2e79 2929 0a20 2020 2020  lf.end.y)).     
+00010440: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00010450: 626f 756e 6469 6e67 5f72 6563 7461 6e67  bounding_rectang
+00010460: 6c65 0a0a 2020 2020 6465 6620 7374 7261  le..    def stra
+00010470: 6967 6874 5f6c 696e 655f 6172 6561 2873  ight_line_area(s
+00010480: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00010490: 220a 2020 2020 2020 2020 4361 6c63 756c  ".        Calcul
+000104a0: 6174 6573 2074 6865 2061 7265 6120 6f66  ates the area of
+000104b0: 2074 6865 204c 696e 6553 6567 6d65 6e74   the LineSegment
+000104c0: 3244 2c20 7769 7468 206c 696e 6520 6472  2D, with line dr
+000104d0: 6177 6e20 6672 6f6d 2073 7461 7274 2074  awn from start t
+000104e0: 6f20 656e 642e 0a0a 2020 2020 2020 2020  o end...        
+000104f0: 3a72 6574 7572 6e3a 2073 7472 6169 6768  :return: straigh
+00010500: 745f 6c69 6e65 5f61 7265 612e 0a20 2020  t_line_area..   
+00010510: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00010520: 2072 6574 7572 6e20 302e 0a0a 2020 2020   return 0...    
+00010530: 6465 6620 7374 7261 6967 6874 5f6c 696e  def straight_lin
+00010540: 655f 7365 636f 6e64 5f6d 6f6d 656e 745f  e_second_moment_
+00010550: 6172 6561 2873 656c 662c 2070 6f69 6e74  area(self, point
+00010560: 3a20 766f 6c6d 646c 722e 506f 696e 7432  : volmdlr.Point2
+00010570: 4429 3a0a 2020 2020 2020 2020 7265 7475  D):.        retu
+00010580: 726e 2030 2c20 302c 2030 0a0a 2020 2020  rn 0, 0, 0..    
+00010590: 6465 6620 7374 7261 6967 6874 5f6c 696e  def straight_lin
+000105a0: 655f 6365 6e74 6572 5f6f 665f 6d61 7373  e_center_of_mass
+000105b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000105c0: 2222 2253 7472 6169 6768 7420 6c69 6e65  """Straight line
+000105d0: 2063 656e 7465 7220 6f66 206d 6173 732e   center of mass.
+000105e0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+000105f0: 726e 2030 2e35 202a 2028 7365 6c66 2e73  rn 0.5 * (self.s
+00010600: 7461 7274 202b 2073 656c 662e 656e 6429  tart + self.end)
+00010610: 0a0a 2020 2020 6465 6620 7374 7261 6967  ..    def straig
+00010620: 6874 5f6c 696e 655f 706f 696e 745f 6265  ht_line_point_be
+00010630: 6c6f 6e67 7328 7365 6c66 2c20 706f 696e  longs(self, poin
+00010640: 7429 3a0a 2020 2020 2020 2020 2222 220a  t):.        """.
+00010650: 2020 2020 2020 2020 436c 6f73 696e 6720          Closing 
+00010660: 7374 7261 6967 6874 206c 696e 6520 706f  straight line po
+00010670: 696e 7420 6265 6c6f 6e67 7320 7665 7269  int belongs veri
+00010680: 6669 6361 7469 6f6e 2e0a 0a20 2020 2020  fication...     
+00010690: 2020 2056 6572 6966 6965 7320 6966 2061     Verifies if a
+000106a0: 2070 6f69 6e74 2062 656c 6f6e 6773 2074   point belongs t
+000106b0: 6f20 7468 6520 7375 7266 6163 6520 6372  o the surface cr
+000106c0: 6561 7465 6420 6279 2063 6c6f 7369 6e67  eated by closing
+000106d0: 2074 6865 2065 6467 6520 7769 7468 2061   the edge with a
+000106e0: 0a20 2020 2020 2020 206c 696e 6520 6265  .        line be
+000106f0: 7477 6565 6e20 6974 7320 7374 6172 7420  tween its start 
+00010700: 616e 6420 656e 6420 706f 696e 7473 2e0a  and end points..
+00010710: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00010720: 706f 696e 743a 2050 6f69 6e74 2074 6f20  point: Point to 
+00010730: 6265 2076 6572 6966 6965 642e 0a20 2020  be verified..   
+00010740: 2020 2020 203a 7265 7475 726e 3a20 5265       :return: Re
+00010750: 7475 726e 2054 7275 6520 6966 2074 6865  turn True if the
+00010760: 2070 6f69 6e74 2062 656c 6f6e 6773 2074   point belongs t
+00010770: 6f20 7468 6973 2073 7572 6661 6365 2c20  o this surface, 
+00010780: 6f72 2046 616c 7365 206f 7468 6572 7769  or False otherwi
+00010790: 7365 2e0a 2020 2020 2020 2020 2222 220a  se..        """.
+000107a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000107b0: 656c 662e 706f 696e 745f 6265 6c6f 6e67  elf.point_belong
+000107c0: 7328 706f 696e 7429 0a0a 2020 2020 6465  s(point)..    de
+000107d0: 6620 706f 696e 745f 6469 7374 616e 6365  f point_distance
+000107e0: 2873 656c 662c 2070 6f69 6e74 2c20 7265  (self, point, re
+000107f0: 7475 726e 5f6f 7468 6572 5f70 6f69 6e74  turn_other_point
+00010800: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
+00010810: 2022 2222 0a20 2020 2020 2020 2043 6f6d   """.        Com
+00010820: 7075 7465 7320 7468 6520 6469 7374 616e  putes the distan
+00010830: 6365 206f 6620 6120 706f 696e 7420 746f  ce of a point to
+00010840: 2073 6567 6d65 6e74 206f 6620 6c69 6e65   segment of line
+00010850: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00010860: 6d20 706f 696e 743a 2070 6f69 6e74 2074  m point: point t
+00010870: 6f20 6361 6c63 756c 6174 6520 6469 7374  o calculate dist
+00010880: 616e 6365 2e0a 2020 2020 2020 2020 3a70  ance..        :p
+00010890: 6172 616d 2072 6574 7572 6e5f 6f74 6865  aram return_othe
+000108a0: 725f 706f 696e 7473 3a20 426f 6f6c 6561  r_points: Boolea
+000108b0: 6e20 7661 7269 6162 6c65 2074 6f20 7265  n variable to re
+000108c0: 7475 726e 206c 696e 6573 6567 6d65 6e74  turn linesegment
+000108d0: 2773 2063 6f72 7265 7370 6f6e 6469 6e67  's corresponding
+000108e0: 2070 6f69 6e74 206f 7220 6e6f 742e 0a20   point or not.. 
+000108f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00010900: 2020 2064 6973 7461 6e63 652c 2070 6f69     distance, poi
+00010910: 6e74 203d 2076 6f6c 6d64 6c72 2e4c 696e  nt = volmdlr.Lin
+00010920: 6553 6567 6d65 6e74 3244 506f 696e 7444  eSegment2DPointD
+00010930: 6973 7461 6e63 6528 0a20 2020 2020 2020  istance(.       
+00010940: 2020 2020 205b 2873 656c 662e 7374 6172       [(self.star
+00010950: 742e 782c 2073 656c 662e 7374 6172 742e  t.x, self.start.
+00010960: 7929 2c20 2873 656c 662e 656e 642e 782c  y), (self.end.x,
+00010970: 2073 656c 662e 656e 642e 7929 5d2c 0a20   self.end.y)],. 
+00010980: 2020 2020 2020 2020 2020 2028 706f 696e             (poin
+00010990: 742e 782c 2070 6f69 6e74 2e79 2929 0a20  t.x, point.y)). 
+000109a0: 2020 2020 2020 2069 6620 7265 7475 726e         if return
+000109b0: 5f6f 7468 6572 5f70 6f69 6e74 3a0a 2020  _other_point:.  
+000109c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000109d0: 2064 6973 7461 6e63 652c 2076 6f6c 6d64   distance, volmd
+000109e0: 6c72 2e50 6f69 6e74 3244 282a 706f 696e  lr.Point2D(*poin
+000109f0: 7429 0a20 2020 2020 2020 2072 6574 7572  t).        retur
+00010a00: 6e20 6469 7374 616e 6365 0a0a 2020 2020  n distance..    
+00010a10: 6465 6620 706f 696e 745f 7072 6f6a 6563  def point_projec
+00010a20: 7469 6f6e 2873 656c 662c 2070 6f69 6e74  tion(self, point
+00010a30: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00010a40: 2020 2020 2020 2049 6620 7468 6520 7072         If the pr
+00010a50: 6f6a 6563 7469 6f6e 2066 616c 6c73 206f  ojection falls o
+00010a60: 7574 7369 6465 2074 6865 204c 696e 6553  utside the LineS
+00010a70: 6567 6d65 6e74 3244 2c20 7265 7475 726e  egment2D, return
+00010a80: 7320 4e6f 6e65 2e0a 2020 2020 2020 2020  s None..        
+00010a90: 2222 220a 2020 2020 2020 2020 706f 696e  """.        poin
+00010aa0: 742c 2063 7572 765f 6162 7320 3d20 4c69  t, curv_abs = Li
+00010ab0: 6e65 3244 2e70 6f69 6e74 5f70 726f 6a65  ne2D.point_proje
+00010ac0: 6374 696f 6e28 4c69 6e65 3244 2873 656c  ction(Line2D(sel
+00010ad0: 662e 7374 6172 742c 2073 656c 662e 656e  f.start, self.en
+00010ae0: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
+00010af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b10: 2020 2020 2020 706f 696e 7429 0a20 2020        point).   
+00010b20: 2020 2020 2023 2070 7269 6e74 2827 6375       # print('cu
+00010b30: 7276 5f61 6273 203a 272c 2063 7572 765f  rv_abs :', curv_
+00010b40: 6162 732c 2027 6c65 6e67 7468 203a 272c  abs, 'length :',
+00010b50: 2073 656c 662e 6c65 6e67 7468 2829 290a   self.length()).
+00010b60: 2020 2020 2020 2020 6966 2063 7572 765f          if curv_
+00010b70: 6162 7320 3c20 3020 6f72 2063 7572 765f  abs < 0 or curv_
+00010b80: 6162 7320 3e20 7365 6c66 2e6c 656e 6774  abs > self.lengt
+00010b90: 6828 293a 0a20 2020 2020 2020 2020 2020  h():.           
+00010ba0: 2069 6620 6162 7328 6375 7276 5f61 6273   if abs(curv_abs
+00010bb0: 2920 3c20 3165 2d36 206f 7220 6d61 7468  ) < 1e-6 or math
+00010bc0: 2e69 7363 6c6f 7365 2863 7572 765f 6162  .isclose(curv_ab
+00010bd0: 732c 2073 656c 662e 6c65 6e67 7468 2829  s, self.length()
+00010be0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00010bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c10: 2020 2020 2020 6162 735f 746f 6c3d 3165        abs_tol=1e
+00010c20: 2d36 293a 0a20 2020 2020 2020 2020 2020  -6):.           
+00010c30: 2020 2020 2072 6574 7572 6e20 706f 696e       return poin
+00010c40: 742c 2063 7572 765f 6162 730a 2020 2020  t, curv_abs.    
+00010c50: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+00010c60: 6f6e 652c 2063 7572 765f 6162 730a 2020  one, curv_abs.  
+00010c70: 2020 2020 2020 7265 7475 726e 2070 6f69        return poi
+00010c80: 6e74 2c20 6375 7276 5f61 6273 0a0a 2020  nt, curv_abs..  
+00010c90: 2020 6465 6620 6c69 6e65 5f69 6e74 6572    def line_inter
+00010ca0: 7365 6374 696f 6e73 2873 656c 662c 206c  sections(self, l
+00010cb0: 696e 653a 204c 696e 6532 4429 3a0a 2020  ine: Line2D):.  
+00010cc0: 2020 2020 2020 6966 2073 656c 662e 6469        if self.di
+00010cd0: 7265 6374 696f 6e5f 7665 6374 6f72 2829  rection_vector()
+00010ce0: 2e69 735f 636f 6c69 6e65 6172 5f74 6f28  .is_colinear_to(
+00010cf0: 6c69 6e65 2e64 6972 6563 7469 6f6e 5f76  line.direction_v
+00010d00: 6563 746f 7228 2929 3a0a 2020 2020 2020  ector()):.      
+00010d10: 2020 2020 2020 7265 7475 726e 205b 5d0a        return [].
+00010d20: 2020 2020 2020 2020 706f 696e 7420 3d20          point = 
+00010d30: 766f 6c6d 646c 722e 506f 696e 7432 442e  volmdlr.Point2D.
+00010d40: 6c69 6e65 5f69 6e74 6572 7365 6374 696f  line_intersectio
+00010d50: 6e28 7365 6c66 2c20 6c69 6e65 290a 2020  n(self, line).  
+00010d60: 2020 2020 2020 6966 2070 6f69 6e74 2069        if point i
+00010d70: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00010d80: 2020 2020 2020 2020 706f 696e 745f 7072          point_pr
+00010d90: 6f6a 6563 7469 6f6e 312c 205f 203d 2073  ojection1, _ = s
+00010da0: 656c 662e 706f 696e 745f 7072 6f6a 6563  elf.point_projec
+00010db0: 7469 6f6e 2870 6f69 6e74 290a 2020 2020  tion(point).    
+00010dc0: 2020 2020 2020 2020 696e 7465 7273 6563          intersec
+00010dd0: 7469 6f6e 7320 3d20 5b70 6f69 6e74 5f70  tions = [point_p
+00010de0: 726f 6a65 6374 696f 6e31 5d0a 2020 2020  rojection1].    
+00010df0: 2020 2020 2020 2020 6966 2070 6f69 6e74          if point
+00010e00: 5f70 726f 6a65 6374 696f 6e31 2069 7320  _projection1 is 
+00010e10: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00010e20: 2020 2020 2020 696e 7465 7273 6563 7469        intersecti
+00010e30: 6f6e 7320 3d20 5b5d 0a0a 2020 2020 2020  ons = []..      
+00010e40: 2020 2020 2020 656c 6966 206c 696e 652e        elif line.
+00010e50: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
+00010e60: 5f5f 203d 3d20 274c 696e 6553 6567 6d65  __ == 'LineSegme
+00010e70: 6e74 3244 273a 0a20 2020 2020 2020 2020  nt2D':.         
+00010e80: 2020 2020 2020 2070 6f69 6e74 5f70 726f         point_pro
+00010e90: 6a65 6374 696f 6e32 2c20 5f20 3d20 6c69  jection2, _ = li
+00010ea0: 6e65 2e70 6f69 6e74 5f70 726f 6a65 6374  ne.point_project
+00010eb0: 696f 6e28 706f 696e 7429 0a20 2020 2020  ion(point).     
+00010ec0: 2020 2020 2020 2020 2020 2069 6620 706f             if po
+00010ed0: 696e 745f 7072 6f6a 6563 7469 6f6e 3220  int_projection2 
+00010ee0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00010ef0: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+00010f00: 6572 7365 6374 696f 6e73 203d 205b 5d0a  ersections = [].
+00010f10: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00010f20: 7572 6e20 696e 7465 7273 6563 7469 6f6e  urn intersection
+00010f30: 730a 2020 2020 2020 2020 6966 206c 696e  s.        if lin
+00010f40: 652e 706f 696e 745f 6265 6c6f 6e67 7328  e.point_belongs(
+00010f50: 7365 6c66 2e73 7461 7274 293a 0a20 2020  self.start):.   
+00010f60: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00010f70: 5b73 656c 662e 7374 6172 745d 0a20 2020  [self.start].   
+00010f80: 2020 2020 2069 6620 6c69 6e65 2e70 6f69       if line.poi
+00010f90: 6e74 5f62 656c 6f6e 6773 2873 656c 662e  nt_belongs(self.
+00010fa0: 656e 6429 3a0a 2020 2020 2020 2020 2020  end):.          
+00010fb0: 2020 7265 7475 726e 205b 7365 6c66 2e65    return [self.e
+00010fc0: 6e64 5d0a 2020 2020 2020 2020 7265 7475  nd].        retu
+00010fd0: 726e 205b 5d0a 0a20 2020 2064 6566 206c  rn []..    def l
+00010fe0: 696e 6573 6567 6d65 6e74 5f69 6e74 6572  inesegment_inter
+00010ff0: 7365 6374 696f 6e73 2873 656c 662c 206c  sections(self, l
+00011000: 696e 6573 6567 6d65 6e74 3264 3a20 274c  inesegment2d: 'L
+00011010: 696e 6553 6567 6d65 6e74 3244 2729 3a0a  ineSegment2D'):.
+00011020: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00011030: 2020 2020 546f 7563 6869 6e67 206c 696e      Touching lin
+00011040: 6573 6567 6d65 6e74 7320 646f 6573 206e  esegments does n
+00011050: 6f74 2069 6e74 6572 7365 6374 2e0a 2020  ot intersect..  
+00011060: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00011070: 2020 6966 206e 6f74 2073 656c 662e 626f    if not self.bo
+00011080: 756e 6469 6e67 5f72 6563 7461 6e67 6c65  unding_rectangle
+00011090: 2e62 5f72 6563 7461 6e67 6c65 5f69 6e74  .b_rectangle_int
+000110a0: 6572 7365 6374 696f 6e28 6c69 6e65 7365  ersection(linese
+000110b0: 676d 656e 7432 642e 626f 756e 6469 6e67  gment2d.bounding
+000110c0: 5f72 6563 7461 6e67 6c65 293a 0a20 2020  _rectangle):.   
+000110d0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000110e0: 5b5d 0a20 2020 2020 2020 2070 6f69 6e74  [].        point
+000110f0: 203d 2076 6f6c 6d64 6c72 2e50 6f69 6e74   = volmdlr.Point
+00011100: 3244 2e6c 696e 655f 696e 7465 7273 6563  2D.line_intersec
+00011110: 7469 6f6e 2873 656c 662c 206c 696e 6573  tion(self, lines
+00011120: 6567 6d65 6e74 3264 290a 2020 2020 2020  egment2d).      
+00011130: 2020 2320 544f 444f 3a20 4d61 7920 6265    # TODO: May be
+00011140: 2074 6865 7365 2063 6f6d 6d65 6e74 6564   these commented
+00011150: 2063 6f6e 6469 7469 6f6e 7320 7368 6f75   conditions shou
+00011160: 6c64 2062 6520 7573 6564 2066 6f72 206c  ld be used for l
+00011170: 696e 6573 6567 6d65 6e74 5f63 726f 7373  inesegment_cross
+00011180: 696e 6773 0a20 2020 2020 2020 2069 6620  ings.        if 
+00011190: 706f 696e 743a 2020 2320 616e 6420 2870  point:  # and (p
+000111a0: 6f69 6e74 2021 3d20 7365 6c66 2e73 7461  oint != self.sta
+000111b0: 7274 2920 616e 6420 2870 6f69 6e74 2021  rt) and (point !
+000111c0: 3d20 7365 6c66 2e65 6e64 293a 0a20 2020  = self.end):.   
+000111d0: 2020 2020 2020 2020 2070 6f69 6e74 5f70           point_p
+000111e0: 726f 6a65 6374 696f 6e31 2c20 5f20 3d20  rojection1, _ = 
+000111f0: 7365 6c66 2e70 6f69 6e74 5f70 726f 6a65  self.point_proje
+00011200: 6374 696f 6e28 706f 696e 7429 0a20 2020  ction(point).   
+00011210: 2020 2020 2020 2020 2069 6620 706f 696e           if poin
+00011220: 745f 7072 6f6a 6563 7469 6f6e 3120 6973  t_projection1 is
+00011230: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00011240: 2020 2020 2020 2072 6574 7572 6e20 5b5d         return []
+00011250: 0a0a 2020 2020 2020 2020 2020 2020 706f  ..            po
+00011260: 696e 745f 7072 6f6a 6563 7469 6f6e 322c  int_projection2,
+00011270: 205f 203d 206c 696e 6573 6567 6d65 6e74   _ = linesegment
+00011280: 3264 2e70 6f69 6e74 5f70 726f 6a65 6374  2d.point_project
+00011290: 696f 6e28 706f 696e 7429 0a20 2020 2020  ion(point).     
+000112a0: 2020 2020 2020 2069 6620 706f 696e 745f         if point_
+000112b0: 7072 6f6a 6563 7469 6f6e 3220 6973 204e  projection2 is N
+000112c0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000112d0: 2020 2020 2072 6574 7572 6e20 5b5d 0a0a       return []..
+000112e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000112f0: 726e 205b 706f 696e 745f 7072 6f6a 6563  rn [point_projec
+00011300: 7469 6f6e 315d 0a20 2020 2020 2020 2072  tion1].        r
+00011310: 6574 7572 6e20 5b5d 0a0a 2020 2020 6465  eturn []..    de
+00011320: 6620 6c69 6e65 5f63 726f 7373 696e 6773  f line_crossings
+00011330: 2873 656c 662c 206c 696e 653a 2027 4c69  (self, line: 'Li
+00011340: 6e65 3244 2729 3a0a 2020 2020 2020 2020  ne2D'):.        
+00011350: 6966 2073 656c 662e 6469 7265 6374 696f  if self.directio
+00011360: 6e5f 7665 6374 6f72 2829 2e69 735f 636f  n_vector().is_co
+00011370: 6c69 6e65 6172 5f74 6f28 6c69 6e65 2e64  linear_to(line.d
+00011380: 6972 6563 7469 6f6e 5f76 6563 746f 7228  irection_vector(
+00011390: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+000113a0: 7265 7475 726e 205b 5d0a 2020 2020 2020  return [].      
+000113b0: 2020 6c69 6e65 5f69 6e74 6572 7365 6374    line_intersect
+000113c0: 696f 6e20 3d20 7365 6c66 2e6c 696e 655f  ion = self.line_
+000113d0: 696e 7465 7273 6563 7469 6f6e 7328 6c69  intersections(li
+000113e0: 6e65 290a 2020 2020 2020 2020 6966 206c  ne).        if l
+000113f0: 696e 655f 696e 7465 7273 6563 7469 6f6e  ine_intersection
+00011400: 2061 6e64 2028 6c69 6e65 5f69 6e74 6572   and (line_inter
+00011410: 7365 6374 696f 6e5b 305d 203d 3d20 7365  section[0] == se
+00011420: 6c66 2e65 6e64 206f 7220 6c69 6e65 5f69  lf.end or line_i
+00011430: 6e74 6572 7365 6374 696f 6e5b 305d 203d  ntersection[0] =
+00011440: 3d20 7365 6c66 2e73 7461 7274 293a 0a20  = self.start):. 
+00011450: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00011460: 6e20 5b5d 0a20 2020 2020 2020 2072 6574  n [].        ret
+00011470: 7572 6e20 6c69 6e65 5f69 6e74 6572 7365  urn line_interse
+00011480: 6374 696f 6e0a 0a20 2020 2064 6566 206c  ction..    def l
+00011490: 696e 6573 6567 6d65 6e74 5f63 726f 7373  inesegment_cross
+000114a0: 696e 6773 2873 656c 662c 206c 696e 6573  ings(self, lines
+000114b0: 6567 6d65 6e74 3a20 274c 696e 6553 6567  egment: 'LineSeg
+000114c0: 6d65 6e74 3244 2729 3a0a 2020 2020 2020  ment2D'):.      
+000114d0: 2020 2222 220a 2020 2020 2020 2020 4769    """.        Gi
+000114e0: 7665 7320 7468 6520 6372 6f73 7369 6e67  ves the crossing
+000114f0: 7320 7769 7468 2061 206c 696e 6573 6567  s with a lineseg
+00011500: 6d65 6e74 2e0a 2020 2020 2020 2020 2222  ment..        ""
+00011510: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
+00011520: 662e 6469 7265 6374 696f 6e5f 7665 6374  f.direction_vect
+00011530: 6f72 2829 2e69 735f 636f 6c69 6e65 6172  or().is_colinear
+00011540: 5f74 6f28 0a20 2020 2020 2020 2020 2020  _to(.           
+00011550: 2020 2020 206c 696e 6573 6567 6d65 6e74       linesegment
+00011560: 2e64 6972 6563 7469 6f6e 5f76 6563 746f  .direction_vecto
+00011570: 7228 2929 3a0a 2020 2020 2020 2020 2020  r()):.          
+00011580: 2020 7265 7475 726e 205b 5d0a 2020 2020    return [].    
+00011590: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000115a0: 6c69 6e65 7365 676d 656e 745f 696e 7465  linesegment_inte
+000115b0: 7273 6563 7469 6f6e 7328 6c69 6e65 7365  rsections(linese
+000115c0: 676d 656e 7429 0a0a 2020 2020 6465 6620  gment)..    def 
+000115d0: 706c 6f74 2873 656c 662c 2061 783d 4e6f  plot(self, ax=No
+000115e0: 6e65 2c20 636f 6c6f 723d 276b 272c 2061  ne, color='k', a
+000115f0: 6c70 6861 3d31 2c20 6172 726f 773d 4661  lpha=1, arrow=Fa
+00011600: 6c73 652c 2077 6964 7468 3d4e 6f6e 652c  lse, width=None,
+00011610: 0a20 2020 2020 2020 2020 2020 2020 706c  .             pl
+00011620: 6f74 5f70 6f69 6e74 733d 4661 6c73 6529  ot_points=False)
+00011630: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00011640: 2020 2020 2020 506c 6f74 7320 7468 6520        Plots the 
+00011650: 4c69 6e65 7365 676d 656e 7432 442e 0a20  Linesegment2D.. 
+00011660: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00011670: 2020 2069 6620 6178 2069 7320 4e6f 6e65     if ax is None
+00011680: 3a0a 2020 2020 2020 2020 2020 2020 5f2c  :.            _,
+00011690: 2061 7820 3d20 706c 742e 7375 6270 6c6f   ax = plt.subplo
+000116a0: 7473 2829 0a0a 2020 2020 2020 2020 7031  ts()..        p1
+000116b0: 2c20 7032 203d 2073 656c 662e 7374 6172  , p2 = self.star
+000116c0: 742c 2073 656c 662e 656e 640a 2020 2020  t, self.end.    
+000116d0: 2020 2020 6966 2061 7272 6f77 3a0a 2020      if arrow:.  
+000116e0: 2020 2020 2020 2020 2020 6966 2070 6c6f            if plo
+000116f0: 745f 706f 696e 7473 3a0a 2020 2020 2020  t_points:.      
+00011700: 2020 2020 2020 2020 2020 6178 2e70 6c6f            ax.plo
+00011710: 7428 5b70 315b 305d 2c20 7032 5b30 5d5d  t([p1[0], p2[0]]
+00011720: 2c20 5b70 315b 315d 2c20 7032 5b31 5d5d  , [p1[1], p2[1]]
+00011730: 2c20 636f 6c6f 723d 636f 6c6f 722c 0a20  , color=color,. 
+00011740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011750: 2020 2020 2020 2061 6c70 6861 3d61 6c70         alpha=alp
+00011760: 6861 2c20 7374 796c 653d 276f 2d27 290a  ha, style='o-').
+00011770: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00011780: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00011790: 2020 6178 2e70 6c6f 7428 5b70 315b 305d    ax.plot([p1[0]
+000117a0: 2c20 7032 5b30 5d5d 2c20 5b70 315b 315d  , p2[0]], [p1[1]
+000117b0: 2c20 7032 5b31 5d5d 2c20 636f 6c6f 723d  , p2[1]], color=
+000117c0: 636f 6c6f 722c 0a20 2020 2020 2020 2020  color,.         
+000117d0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000117e0: 6c70 6861 3d61 6c70 6861 290a 0a20 2020  lpha=alpha)..   
+000117f0: 2020 2020 2020 2020 206c 656e 6774 6820           length 
+00011800: 3d20 2828 7031 5b30 5d20 2d20 7032 5b30  = ((p1[0] - p2[0
+00011810: 5d29 202a 2a20 3220 2b20 2870 315b 315d  ]) ** 2 + (p1[1]
+00011820: 202d 2070 325b 315d 2920 2a2a 2032 2920   - p2[1]) ** 2) 
+00011830: 2a2a 2030 2e35 0a20 2020 2020 2020 2020  ** 0.5.         
+00011840: 2020 2069 6620 7769 6474 6820 6973 204e     if width is N
+00011850: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00011860: 2020 2020 2077 6964 7468 203d 206c 656e       width = len
+00011870: 6774 6820 2f20 3130 3030 2e0a 2020 2020  gth / 1000..    
+00011880: 2020 2020 2020 2020 2020 2020 6865 6164              head
+00011890: 5f6c 656e 6774 6820 3d20 6c65 6e67 7468  _length = length
+000118a0: 202f 2032 302e 0a20 2020 2020 2020 2020   / 20..         
+000118b0: 2020 2020 2020 2068 6561 645f 7769 6474         head_widt
+000118c0: 6820 3d20 6865 6164 5f6c 656e 6774 6820  h = head_length 
+000118d0: 2f20 322e 0a20 2020 2020 2020 2020 2020  / 2..           
+000118e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000118f0: 2020 2020 2020 2068 6561 645f 7769 6474         head_widt
+00011900: 6820 3d20 3220 2a20 7769 6474 680a 2020  h = 2 * width.  
+00011910: 2020 2020 2020 2020 2020 2020 2020 6865                he
+00011920: 6164 5f6c 656e 6774 6820 3d20 6865 6164  ad_length = head
+00011930: 5f77 6964 7468 0a20 2020 2020 2020 2020  _width.         
+00011940: 2020 2061 782e 6172 726f 7728 7031 5b30     ax.arrow(p1[0
+00011950: 5d2c 2070 315b 315d 2c0a 2020 2020 2020  ], p1[1],.      
+00011960: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00011970: 7032 5b30 5d20 2d20 7031 5b30 5d29 202f  p2[0] - p1[0]) /
+00011980: 206c 656e 6774 6820 2a20 286c 656e 6774   length * (lengt
+00011990: 6820 2d20 6865 6164 5f6c 656e 6774 6829  h - head_length)
+000119a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000119b0: 2020 2020 2020 2028 7032 5b31 5d20 2d20         (p2[1] - 
+000119c0: 7031 5b31 5d29 202f 206c 656e 6774 6820  p1[1]) / length 
+000119d0: 2a20 286c 656e 6774 6820 2d20 6865 6164  * (length - head
+000119e0: 5f6c 656e 6774 6829 2c0a 2020 2020 2020  _length),.      
+000119f0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+00011a00: 6561 645f 7769 6474 683d 6865 6164 5f77  ead_width=head_w
+00011a10: 6964 7468 2c20 6663 3d27 6227 2c20 6c69  idth, fc='b', li
+00011a20: 6e65 7769 6474 683d 302c 0a20 2020 2020  newidth=0,.     
+00011a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011a40: 6865 6164 5f6c 656e 6774 683d 6865 6164  head_length=head
+00011a50: 5f6c 656e 6774 682c 2077 6964 7468 3d77  _length, width=w
+00011a60: 6964 7468 2c20 616c 7068 613d 302e 3329  idth, alpha=0.3)
+00011a70: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00011a80: 2020 2020 2020 2020 2020 2069 6620 7769             if wi
+00011a90: 6474 6820 6973 204e 6f6e 653a 0a20 2020  dth is None:.   
+00011aa0: 2020 2020 2020 2020 2020 2020 2077 6964               wid
+00011ab0: 7468 203d 2031 0a20 2020 2020 2020 2020  th = 1.         
+00011ac0: 2020 2069 6620 706c 6f74 5f70 6f69 6e74     if plot_point
+00011ad0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00011ae0: 2020 2061 782e 706c 6f74 285b 7031 5b30     ax.plot([p1[0
+00011af0: 5d2c 2070 325b 305d 5d2c 205b 7031 5b31  ], p2[0]], [p1[1
+00011b00: 5d2c 2070 325b 315d 5d2c 2063 6f6c 6f72  ], p2[1]], color
+00011b10: 3d63 6f6c 6f72 2c0a 2020 2020 2020 2020  =color,.        
+00011b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b30: 6d61 726b 6572 3d27 6f27 2c20 6c69 6e65  marker='o', line
+00011b40: 7769 6474 683d 7769 6474 682c 2061 6c70  width=width, alp
+00011b50: 6861 3d61 6c70 6861 290a 2020 2020 2020  ha=alpha).      
+00011b60: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00011b70: 2020 2020 2020 2020 2020 2020 6178 2e70              ax.p
+00011b80: 6c6f 7428 5b70 315b 305d 2c20 7032 5b30  lot([p1[0], p2[0
+00011b90: 5d5d 2c20 5b70 315b 315d 2c20 7032 5b31  ]], [p1[1], p2[1
+00011ba0: 5d5d 2c20 636f 6c6f 723d 636f 6c6f 722c  ]], color=color,
+00011bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011bc0: 2020 2020 2020 2020 206c 696e 6577 6964           linewid
+00011bd0: 7468 3d77 6964 7468 2c20 616c 7068 613d  th=width, alpha=
+00011be0: 616c 7068 6129 0a20 2020 2020 2020 2072  alpha).        r
+00011bf0: 6574 7572 6e20 6178 0a0a 2020 2020 6465  eturn ax..    de
+00011c00: 6620 746f 5f33 6428 7365 6c66 2c20 706c  f to_3d(self, pl
+00011c10: 616e 655f 6f72 6967 696e 2c20 7831 2c20  ane_origin, x1, 
+00011c20: 7832 293a 0a20 2020 2020 2020 2073 7461  x2):.        sta
+00011c30: 7274 203d 2073 656c 662e 7374 6172 742e  rt = self.start.
+00011c40: 746f 5f33 6428 706c 616e 655f 6f72 6967  to_3d(plane_orig
+00011c50: 696e 2c20 7831 2c20 7832 290a 2020 2020  in, x1, x2).    
+00011c60: 2020 2020 656e 6420 3d20 7365 6c66 2e65      end = self.e
+00011c70: 6e64 2e74 6f5f 3364 2870 6c61 6e65 5f6f  nd.to_3d(plane_o
+00011c80: 7269 6769 6e2c 2078 312c 2078 3229 0a20  rigin, x1, x2). 
+00011c90: 2020 2020 2020 2072 6574 7572 6e20 4c69         return Li
+00011ca0: 6e65 5365 676d 656e 7433 4428 7374 6172  neSegment3D(star
+00011cb0: 742c 2065 6e64 2c20 6e61 6d65 3d73 656c  t, end, name=sel
+00011cc0: 662e 6e61 6d65 290a 0a20 2020 2064 6566  f.name)..    def
+00011cd0: 2072 6576 6572 7365 2873 656c 6629 3a0a   reverse(self):.
+00011ce0: 2020 2020 2020 2020 7265 7475 726e 204c          return L
+00011cf0: 696e 6553 6567 6d65 6e74 3244 2873 656c  ineSegment2D(sel
+00011d00: 662e 656e 642e 636f 7079 2829 2c20 7365  f.end.copy(), se
+00011d10: 6c66 2e73 7461 7274 2e63 6f70 7928 2929  lf.start.copy())
+00011d20: 0a0a 2020 2020 6465 6620 746f 5f6c 696e  ..    def to_lin
+00011d30: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+00011d40: 2072 6574 7572 6e20 4c69 6e65 3244 2873   return Line2D(s
+00011d50: 656c 662e 7374 6172 742c 2073 656c 662e  elf.start, self.
+00011d60: 656e 6429 0a0a 2020 2020 6465 6620 726f  end)..    def ro
+00011d70: 7461 7469 6f6e 2873 656c 662c 2063 656e  tation(self, cen
+00011d80: 7465 723a 2076 6f6c 6d64 6c72 2e50 6f69  ter: volmdlr.Poi
+00011d90: 6e74 3244 2c20 616e 676c 653a 2066 6c6f  nt2D, angle: flo
+00011da0: 6174 293a 0a20 2020 2020 2020 2022 2222  at):.        """
+00011db0: 0a20 2020 2020 2020 204c 696e 6553 6567  .        LineSeg
+00011dc0: 6d65 6e74 3244 2072 6f74 6174 696f 6e2e  ment2D rotation.
+00011dd0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00011de0: 2063 656e 7465 723a 2072 6f74 6174 696f   center: rotatio
+00011df0: 6e20 6365 6e74 6572 0a20 2020 2020 2020  n center.       
+00011e00: 203a 7061 7261 6d20 616e 676c 653a 2061   :param angle: a
+00011e10: 6e67 6c65 2072 6f74 6174 696f 6e0a 2020  ngle rotation.  
+00011e20: 2020 2020 2020 3a72 6574 7572 6e3a 2061        :return: a
+00011e30: 206e 6577 2072 6f74 6174 6564 204c 696e   new rotated Lin
+00011e40: 6553 6567 6d65 6e74 3244 0a20 2020 2020  eSegment2D.     
+00011e50: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00011e60: 6574 7572 6e20 4c69 6e65 5365 676d 656e  eturn LineSegmen
+00011e70: 7432 4428 7365 6c66 2e73 7461 7274 2e72  t2D(self.start.r
+00011e80: 6f74 6174 696f 6e28 6365 6e74 6572 2c20  otation(center, 
+00011e90: 616e 676c 6529 2c0a 2020 2020 2020 2020  angle),.        
+00011ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011eb0: 2020 2020 2073 656c 662e 656e 642e 726f       self.end.ro
+00011ec0: 7461 7469 6f6e 2863 656e 7465 722c 2061  tation(center, a
+00011ed0: 6e67 6c65 2929 0a0a 2020 2020 6465 6620  ngle))..    def 
+00011ee0: 726f 7461 7469 6f6e 5f69 6e70 6c61 6365  rotation_inplace
+00011ef0: 2873 656c 662c 2063 656e 7465 723a 2076  (self, center: v
+00011f00: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 2c20  olmdlr.Point2D, 
+00011f10: 616e 676c 653a 2066 6c6f 6174 293a 0a20  angle: float):. 
+00011f20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00011f30: 2020 204c 696e 6553 6567 6d65 6e74 3244     LineSegment2D
+00011f40: 2072 6f74 6174 696f 6e2e 204f 626a 6563   rotation. Objec
+00011f50: 7420 6973 2075 7064 6174 6564 2069 6e70  t is updated inp
+00011f60: 6c61 6365 2e0a 0a20 2020 2020 2020 203a  lace...        :
+00011f70: 7061 7261 6d20 6365 6e74 6572 3a20 726f  param center: ro
+00011f80: 7461 7469 6f6e 2063 656e 7465 722e 0a20  tation center.. 
+00011f90: 2020 2020 2020 203a 7061 7261 6d20 616e         :param an
+00011fa0: 676c 653a 2072 6f74 6174 696f 6e20 616e  gle: rotation an
+00011fb0: 676c 652e 0a20 2020 2020 2020 2022 2222  gle..        """
+00011fc0: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
+00011fd0: 732e 7761 726e 2822 2769 6e70 6c61 6365  s.warn("'inplace
+00011fe0: 2720 6d65 7468 6f64 7320 6172 6520 6465  ' methods are de
+00011ff0: 7072 6563 6174 6564 2e20 5573 6520 6120  precated. Use a 
+00012000: 6e6f 7420 696e 706c 6163 6520 6d65 7468  not inplace meth
+00012010: 6f64 2069 6e73 7465 6164 2e22 2c20 4465  od instead.", De
+00012020: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
+00012030: 290a 0a20 2020 2020 2020 2066 6f72 2070  )..        for p
+00012040: 6f69 6e74 2069 6e20 5b73 656c 662e 7374  oint in [self.st
+00012050: 6172 742c 2073 656c 662e 656e 645d 3a0a  art, self.end]:.
+00012060: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+00012070: 742e 726f 7461 7469 6f6e 5f69 6e70 6c61  t.rotation_inpla
+00012080: 6365 2863 656e 7465 722c 2061 6e67 6c65  ce(center, angle
+00012090: 290a 0a20 2020 2064 6566 2074 7261 6e73  )..    def trans
+000120a0: 6c61 7469 6f6e 2873 656c 662c 206f 6666  lation(self, off
+000120b0: 7365 743a 2076 6f6c 6d64 6c72 2e56 6563  set: volmdlr.Vec
+000120c0: 746f 7232 4429 3a0a 2020 2020 2020 2020  tor2D):.        
+000120d0: 2222 220a 2020 2020 2020 2020 4c69 6e65  """.        Line
+000120e0: 5365 676d 656e 7432 4420 7472 616e 736c  Segment2D transl
+000120f0: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+00012100: 3a70 6172 616d 206f 6666 7365 743a 2074  :param offset: t
+00012110: 7261 6e73 6c61 7469 6f6e 2076 6563 746f  ranslation vecto
+00012120: 722e 0a20 2020 2020 2020 203a 7265 7475  r..        :retu
+00012130: 726e 3a20 4120 6e65 7720 7472 616e 736c  rn: A new transl
+00012140: 6174 6564 204c 696e 6553 6567 6d65 6e74  ated LineSegment
+00012150: 3244 2e0a 2020 2020 2020 2020 2222 220a  2D..        """.
+00012160: 2020 2020 2020 2020 7265 7475 726e 204c          return L
+00012170: 696e 6553 6567 6d65 6e74 3244 2873 656c  ineSegment2D(sel
+00012180: 662e 7374 6172 742e 7472 616e 736c 6174  f.start.translat
+00012190: 696f 6e28 6f66 6673 6574 292c 0a20 2020  ion(offset),.   
+000121a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121b0: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+000121c0: 6e64 2e74 7261 6e73 6c61 7469 6f6e 286f  nd.translation(o
+000121d0: 6666 7365 7429 290a 0a20 2020 2064 6566  ffset))..    def
+000121e0: 2074 7261 6e73 6c61 7469 6f6e 5f69 6e70   translation_inp
+000121f0: 6c61 6365 2873 656c 662c 206f 6666 7365  lace(self, offse
+00012200: 743a 2076 6f6c 6d64 6c72 2e56 6563 746f  t: volmdlr.Vecto
+00012210: 7232 4429 3a0a 2020 2020 2020 2020 2222  r2D):.        ""
+00012220: 220a 2020 2020 2020 2020 4c69 6e65 5365  ".        LineSe
+00012230: 676d 656e 7432 4420 7472 616e 736c 6174  gment2D translat
+00012240: 696f 6e2e 204f 626a 6563 7420 6973 2075  ion. Object is u
+00012250: 7064 6174 6564 2069 6e70 6c61 6365 2e0a  pdated inplace..
+00012260: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00012270: 6f66 6673 6574 3a20 7472 616e 736c 6174  offset: translat
+00012280: 696f 6e20 7665 6374 6f72 2e0a 2020 2020  ion vector..    
+00012290: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000122a0: 7761 726e 696e 6773 2e77 6172 6e28 2227  warnings.warn("'
+000122b0: 696e 706c 6163 6527 206d 6574 686f 6473  inplace' methods
+000122c0: 2061 7265 2064 6570 7265 6361 7465 642e   are deprecated.
+000122d0: 2055 7365 2061 206e 6f74 2069 6e70 6c61   Use a not inpla
+000122e0: 6365 206d 6574 686f 6420 696e 7374 6561  ce method instea
+000122f0: 642e 222c 2044 6570 7265 6361 7469 6f6e  d.", Deprecation
+00012300: 5761 726e 696e 6729 0a0a 2020 2020 2020  Warning)..      
+00012310: 2020 666f 7220 706f 696e 7420 696e 205b    for point in [
+00012320: 7365 6c66 2e73 7461 7274 2c20 7365 6c66  self.start, self
+00012330: 2e65 6e64 5d3a 0a20 2020 2020 2020 2020  .end]:.         
+00012340: 2020 2070 6f69 6e74 2e74 7261 6e73 6c61     point.transla
+00012350: 7469 6f6e 5f69 6e70 6c61 6365 286f 6666  tion_inplace(off
+00012360: 7365 7429 0a0a 2020 2020 6465 6620 6672  set)..    def fr
+00012370: 616d 655f 6d61 7070 696e 6728 7365 6c66  ame_mapping(self
+00012380: 2c20 6672 616d 653a 2076 6f6c 6d64 6c72  , frame: volmdlr
+00012390: 2e46 7261 6d65 3244 2c20 7369 6465 3a20  .Frame2D, side: 
+000123a0: 7374 7229 3a0a 2020 2020 2020 2020 2222  str):.        ""
+000123b0: 220a 2020 2020 2020 2020 4368 616e 6765  ".        Change
+000123c0: 7320 7665 6374 6f72 2066 7261 6d65 5f6d  s vector frame_m
+000123d0: 6170 7069 6e67 2061 6e64 2072 6574 7572  apping and retur
+000123e0: 6e20 6120 6e65 7720 4c69 6e65 5365 676d  n a new LineSegm
+000123f0: 656e 7432 442e 0a0a 2020 2020 2020 2020  ent2D...        
+00012400: 7369 6465 203d 2027 6f6c 6427 206f 7220  side = 'old' or 
+00012410: 276e 6577 272e 0a20 2020 2020 2020 2022  'new'..        "
+00012420: 2222 0a20 2020 2020 2020 2069 6620 7369  "".        if si
+00012430: 6465 203d 3d20 276f 6c64 273a 0a20 2020  de == 'old':.   
+00012440: 2020 2020 2020 2020 206e 6577 5f73 7461           new_sta
+00012450: 7274 203d 2066 7261 6d65 2e6c 6f63 616c  rt = frame.local
+00012460: 5f74 6f5f 676c 6f62 616c 5f63 6f6f 7264  _to_global_coord
+00012470: 696e 6174 6573 2873 656c 662e 7374 6172  inates(self.star
+00012480: 7429 0a20 2020 2020 2020 2020 2020 206e  t).            n
+00012490: 6577 5f65 6e64 203d 2066 7261 6d65 2e6c  ew_end = frame.l
+000124a0: 6f63 616c 5f74 6f5f 676c 6f62 616c 5f63  ocal_to_global_c
+000124b0: 6f6f 7264 696e 6174 6573 2873 656c 662e  oordinates(self.
+000124c0: 656e 6429 0a20 2020 2020 2020 2065 6c69  end).        eli
+000124d0: 6620 7369 6465 203d 3d20 276e 6577 273a  f side == 'new':
+000124e0: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+000124f0: 5f73 7461 7274 203d 2066 7261 6d65 2e67  _start = frame.g
+00012500: 6c6f 6261 6c5f 746f 5f6c 6f63 616c 5f63  lobal_to_local_c
+00012510: 6f6f 7264 696e 6174 6573 2873 656c 662e  oordinates(self.
+00012520: 7374 6172 7429 0a20 2020 2020 2020 2020  start).         
+00012530: 2020 206e 6577 5f65 6e64 203d 2066 7261     new_end = fra
+00012540: 6d65 2e67 6c6f 6261 6c5f 746f 5f6c 6f63  me.global_to_loc
+00012550: 616c 5f63 6f6f 7264 696e 6174 6573 2873  al_coordinates(s
+00012560: 656c 662e 656e 6429 0a20 2020 2020 2020  elf.end).       
+00012570: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00012580: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00012590: 726f 7228 2750 6c65 6173 6520 456e 7465  ror('Please Ente
+000125a0: 7220 6120 7661 6c69 6420 7369 6465 3a20  r a valid side: 
+000125b0: 6f6c 6420 6f72 206e 6577 2729 0a20 2020  old or new').   
+000125c0: 2020 2020 2072 6574 7572 6e20 4c69 6e65       return Line
+000125d0: 5365 676d 656e 7432 4428 6e65 775f 7374  Segment2D(new_st
+000125e0: 6172 742c 206e 6577 5f65 6e64 290a 0a20  art, new_end).. 
+000125f0: 2020 2064 6566 2066 7261 6d65 5f6d 6170     def frame_map
+00012600: 7069 6e67 5f69 6e70 6c61 6365 2873 656c  ping_inplace(sel
+00012610: 662c 2066 7261 6d65 3a20 766f 6c6d 646c  f, frame: volmdl
+00012620: 722e 4672 616d 6532 442c 2073 6964 653a  r.Frame2D, side:
+00012630: 2073 7472 293a 0a20 2020 2020 2020 2022   str):.        "
+00012640: 2222 0a20 2020 2020 2020 2043 6861 6e67  "".        Chang
+00012650: 6573 2076 6563 746f 7220 6672 616d 655f  es vector frame_
+00012660: 6d61 7070 696e 6720 616e 6420 7468 6520  mapping and the 
+00012670: 6f62 6a65 6374 2069 7320 7570 6461 7465  object is update
+00012680: 6420 696e 706c 6163 652e 0a0a 2020 2020  d inplace...    
+00012690: 2020 2020 3a70 6172 616d 2066 7261 6d65      :param frame
+000126a0: 3a20 6672 616d 6520 746f 2065 7865 6375  : frame to execu
+000126b0: 7465 2074 6865 2066 7261 6d65 206d 6170  te the frame map
+000126c0: 7069 6e67 2e0a 2020 2020 2020 2020 3a70  ping..        :p
+000126d0: 6172 616d 2073 6964 653a 2027 6f6c 6427  aram side: 'old'
+000126e0: 206f 7220 276e 6577 272e 0a20 2020 2020   or 'new'..     
+000126f0: 2020 2022 2222 0a20 2020 2020 2020 2077     """.        w
+00012700: 6172 6e69 6e67 732e 7761 726e 2822 2769  arnings.warn("'i
+00012710: 6e70 6c61 6365 2720 6d65 7468 6f64 7320  nplace' methods 
+00012720: 6172 6520 6465 7072 6563 6174 6564 2e20  are deprecated. 
+00012730: 5573 6520 6120 6e6f 7420 696e 706c 6163  Use a not inplac
+00012740: 6520 6d65 7468 6f64 2069 6e73 7465 6164  e method instead
+00012750: 2e22 2c20 4465 7072 6563 6174 696f 6e57  .", DeprecationW
+00012760: 6172 6e69 6e67 290a 0a20 2020 2020 2020  arning)..       
+00012770: 2069 6620 7369 6465 203d 3d20 276f 6c64   if side == 'old
+00012780: 273a 0a20 2020 2020 2020 2020 2020 206e  ':.            n
+00012790: 6577 5f73 7461 7274 203d 2066 7261 6d65  ew_start = frame
+000127a0: 2e6c 6f63 616c 5f74 6f5f 676c 6f62 616c  .local_to_global
+000127b0: 5f63 6f6f 7264 696e 6174 6573 2873 656c  _coordinates(sel
+000127c0: 662e 7374 6172 7429 0a20 2020 2020 2020  f.start).       
+000127d0: 2020 2020 206e 6577 5f65 6e64 203d 2066       new_end = f
+000127e0: 7261 6d65 2e6c 6f63 616c 5f74 6f5f 676c  rame.local_to_gl
+000127f0: 6f62 616c 5f63 6f6f 7264 696e 6174 6573  obal_coordinates
+00012800: 2873 656c 662e 656e 6429 0a20 2020 2020  (self.end).     
+00012810: 2020 2065 6c69 6620 7369 6465 203d 3d20     elif side == 
+00012820: 276e 6577 273a 0a20 2020 2020 2020 2020  'new':.         
+00012830: 2020 206e 6577 5f73 7461 7274 203d 2066     new_start = f
+00012840: 7261 6d65 2e67 6c6f 6261 6c5f 746f 5f6c  rame.global_to_l
+00012850: 6f63 616c 5f63 6f6f 7264 696e 6174 6573  ocal_coordinates
+00012860: 2873 656c 662e 7374 6172 7429 0a20 2020  (self.start).   
+00012870: 2020 2020 2020 2020 206e 6577 5f65 6e64           new_end
+00012880: 203d 2066 7261 6d65 2e67 6c6f 6261 6c5f   = frame.global_
+00012890: 746f 5f6c 6f63 616c 5f63 6f6f 7264 696e  to_local_coordin
+000128a0: 6174 6573 2873 656c 662e 656e 6429 0a20  ates(self.end). 
+000128b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000128c0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000128d0: 616c 7565 4572 726f 7228 2750 6c65 6173  alueError('Pleas
+000128e0: 6520 456e 7465 7220 6120 7661 6c69 6420  e Enter a valid 
+000128f0: 7369 6465 3a20 6f6c 6420 6f72 206e 6577  side: old or new
+00012900: 2729 0a20 2020 2020 2020 2073 656c 662e  ').        self.
+00012910: 7374 6172 7420 3d20 6e65 775f 7374 6172  start = new_star
+00012920: 740a 2020 2020 2020 2020 7365 6c66 2e65  t.        self.e
+00012930: 6e64 203d 206e 6577 5f65 6e64 0a0a 2020  nd = new_end..  
+00012940: 2020 6465 6620 706c 6f74 5f64 6174 6128    def plot_data(
+00012950: 7365 6c66 2c20 6564 6765 5f73 7479 6c65  self, edge_style
+00012960: 3a20 706c 6f74 5f64 6174 612e 4564 6765  : plot_data.Edge
+00012970: 5374 796c 6520 3d20 4e6f 6e65 293a 0a20  Style = None):. 
+00012980: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00012990: 2020 2050 6c6f 7420 6461 7461 206d 6574     Plot data met
+000129a0: 686f 6420 666f 7220 6120 4c69 6e65 5365  hod for a LineSe
+000129b0: 676d 656e 7432 442e 0a0a 2020 2020 2020  gment2D...      
+000129c0: 2020 3a70 6172 616d 2065 6467 655f 7374    :param edge_st
+000129d0: 796c 653a 2065 6467 6520 7374 796c 652e  yle: edge style.
+000129e0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+000129f0: 3a20 706c 6f74 5f64 6174 612e 4c69 6e65  : plot_data.Line
+00012a00: 5365 676d 656e 7432 4420 6f62 6a65 6374  Segment2D object
+00012a10: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00012a20: 2020 2020 2020 7265 7475 726e 2070 6c6f        return plo
+00012a30: 745f 6461 7461 2e4c 696e 6553 6567 6d65  t_data.LineSegme
+00012a40: 6e74 3244 285b 7365 6c66 2e73 7461 7274  nt2D([self.start
+00012a50: 2e78 2c20 7365 6c66 2e73 7461 7274 2e79  .x, self.start.y
+00012a60: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00012a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012a80: 2020 2020 2020 2020 2020 5b73 656c 662e            [self.
+00012a90: 656e 642e 782c 2073 656c 662e 656e 642e  end.x, self.end.
+00012aa0: 795d 2c0a 2020 2020 2020 2020 2020 2020  y],.            
+00012ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012ac0: 2020 2020 2020 2020 2020 2065 6467 655f             edge_
+00012ad0: 7374 796c 653d 6564 6765 5f73 7479 6c65  style=edge_style
+00012ae0: 290a 0a20 2020 2064 6566 2063 7265 6174  )..    def creat
+00012af0: 655f 7461 6e67 656e 745f 6369 7263 6c65  e_tangent_circle
+00012b00: 2873 656c 662c 2070 6f69 6e74 2c20 6f74  (self, point, ot
+00012b10: 6865 725f 6c69 6e65 293a 0a20 2020 2020  her_line):.     
+00012b20: 2020 2063 6972 636c 6531 2c20 6369 7263     circle1, circ
+00012b30: 6c65 3220 3d20 4c69 6e65 3244 2e63 7265  le2 = Line2D.cre
+00012b40: 6174 655f 7461 6e67 656e 745f 6369 7263  ate_tangent_circ
+00012b50: 6c65 286f 7468 6572 5f6c 696e 652c 2070  le(other_line, p
+00012b60: 6f69 6e74 2c20 7365 6c66 290a 2020 2020  oint, self).    
+00012b70: 2020 2020 6966 2063 6972 636c 6531 2069      if circle1 i
+00012b80: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00012b90: 2020 2020 2020 2020 5f2c 2063 7572 765f          _, curv_
+00012ba0: 6162 7331 203d 204c 696e 6532 442e 706f  abs1 = Line2D.po
+00012bb0: 696e 745f 7072 6f6a 6563 7469 6f6e 2873  int_projection(s
+00012bc0: 656c 662c 2063 6972 636c 6531 2e63 656e  elf, circle1.cen
+00012bd0: 7465 7229 0a20 2020 2020 2020 2020 2020  ter).           
+00012be0: 2069 6620 6375 7276 5f61 6273 3120 3c20   if curv_abs1 < 
+00012bf0: 302e 206f 7220 6375 7276 5f61 6273 3120  0. or curv_abs1 
+00012c00: 3e20 7365 6c66 2e6c 656e 6774 6828 293a  > self.length():
+00012c10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012c20: 2063 6972 636c 6531 203d 204e 6f6e 650a   circle1 = None.
+00012c30: 2020 2020 2020 2020 6966 2063 6972 636c          if circl
+00012c40: 6532 2069 7320 6e6f 7420 4e6f 6e65 3a0a  e2 is not None:.
+00012c50: 2020 2020 2020 2020 2020 2020 5f2c 2063              _, c
+00012c60: 7572 765f 6162 7332 203d 204c 696e 6532  urv_abs2 = Line2
+00012c70: 442e 706f 696e 745f 7072 6f6a 6563 7469  D.point_projecti
+00012c80: 6f6e 2873 656c 662c 2063 6972 636c 6532  on(self, circle2
+00012c90: 2e63 656e 7465 7229 0a20 2020 2020 2020  .center).       
+00012ca0: 2020 2020 2069 6620 6375 7276 5f61 6273       if curv_abs
+00012cb0: 3220 3c20 302e 206f 7220 6375 7276 5f61  2 < 0. or curv_a
+00012cc0: 6273 3220 3e20 7365 6c66 2e6c 656e 6774  bs2 > self.lengt
+00012cd0: 6828 293a 0a20 2020 2020 2020 2020 2020  h():.           
+00012ce0: 2020 2020 2063 6972 636c 6532 203d 204e       circle2 = N
+00012cf0: 6f6e 650a 2020 2020 2020 2020 7265 7475  one.        retu
+00012d00: 726e 2063 6972 636c 6531 2c20 6369 7263  rn circle1, circ
+00012d10: 6c65 320a 0a20 2020 2064 6566 2069 6e66  le2..    def inf
+00012d20: 696e 6974 655f 7072 696d 6974 6976 6528  inite_primitive(
+00012d30: 7365 6c66 2c20 6f66 6673 6574 293a 0a20  self, offset):. 
+00012d40: 2020 2020 2020 206e 203d 202d 7365 6c66         n = -self
+00012d50: 2e75 6e69 745f 6e6f 726d 616c 5f76 6563  .unit_normal_vec
+00012d60: 746f 7228 290a 2020 2020 2020 2020 6f66  tor().        of
+00012d70: 6673 6574 5f70 6f69 6e74 5f31 203d 2073  fset_point_1 = s
+00012d80: 656c 662e 7374 6172 7420 2b20 6f66 6673  elf.start + offs
+00012d90: 6574 202a 206e 0a20 2020 2020 2020 206f  et * n.        o
+00012da0: 6666 7365 745f 706f 696e 745f 3220 3d20  ffset_point_2 = 
+00012db0: 7365 6c66 2e65 6e64 202b 206f 6666 7365  self.end + offse
+00012dc0: 7420 2a20 6e0a 0a20 2020 2020 2020 2072  t * n..        r
+00012dd0: 6574 7572 6e20 4c69 6e65 3244 286f 6666  eturn Line2D(off
+00012de0: 7365 745f 706f 696e 745f 312c 206f 6666  set_point_1, off
+00012df0: 7365 745f 706f 696e 745f 3229 0a0a 2020  set_point_2)..  
+00012e00: 2020 6465 6620 746f 5f77 6972 6528 7365    def to_wire(se
+00012e10: 6c66 2c20 6e3a 2069 6e74 293a 0a20 2020  lf, n: int):.   
+00012e20: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00012e30: 2043 6f6e 7665 7274 2061 206c 696e 6573   Convert a lines
+00012e40: 6567 6d65 6e74 3264 2074 6f20 6120 7769  egment2d to a wi
+00012e50: 7265 3264 2064 6566 696e 6564 2077 6974  re2d defined wit
+00012e60: 6820 276e 2720 6c69 6e65 5f73 6567 6d65  h 'n' line_segme
+00012e70: 6e74 732e 0a0a 2020 2020 2020 2020 2222  nts...        ""
+00012e80: 220a 0a20 2020 2020 2020 2070 6f69 6e74  "..        point
+00012e90: 7320 3d20 7365 6c66 2e64 6973 6372 6574  s = self.discret
+00012ea0: 697a 6174 696f 6e5f 706f 696e 7473 286e  ization_points(n
+00012eb0: 756d 6265 725f 706f 696e 7473 3d6e 202b  umber_points=n +
+00012ec0: 2031 290a 2020 2020 2020 2020 7265 7475   1).        retu
+00012ed0: 726e 2076 6f6c 6d64 6c72 2e77 6972 6573  rn volmdlr.wires
+00012ee0: 2e57 6972 6532 442e 6672 6f6d 5f70 6f69  .Wire2D.from_poi
+00012ef0: 6e74 7328 706f 696e 7473 290a 0a20 2020  nts(points)..   
+00012f00: 2064 6566 206e 6561 7265 7374 5f70 6f69   def nearest_poi
+00012f10: 6e74 5f74 6f28 7365 6c66 2c20 706f 696e  nt_to(self, poin
+00012f20: 7429 3a0a 2020 2020 2020 2020 2222 220a  t):.        """.
+00012f30: 2020 2020 2020 2020 4669 6e64 206f 7574          Find out
+00012f40: 2074 6865 206e 6561 7265 7374 2070 6f69   the nearest poi
+00012f50: 6e74 206f 6e20 7468 6520 6c69 6e65 7365  nt on the linese
+00012f60: 676d 656e 7420 746f 2070 6f69 6e74 2e0a  gment to point..
+00012f70: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00012f80: 2020 2020 2020 706f 696e 7473 203d 2073        points = s
+00012f90: 656c 662e 6469 7363 7265 7469 7a61 7469  elf.discretizati
+00012fa0: 6f6e 5f70 6f69 6e74 7328 6e75 6d62 6572  on_points(number
+00012fb0: 5f70 6f69 6e74 733d 3530 3029 0a20 2020  _points=500).   
+00012fc0: 2020 2020 2072 6574 7572 6e20 706f 696e       return poin
+00012fd0: 742e 6e65 6172 6573 745f 706f 696e 7428  t.nearest_point(
+00012fe0: 706f 696e 7473 290a 0a20 2020 2064 6566  points)..    def
+00012ff0: 2061 7869 616c 5f73 796d 6d65 7472 7928   axial_symmetry(
+00013000: 7365 6c66 2c20 6c69 6e65 293a 0a20 2020  self, line):.   
+00013010: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00013020: 2046 696e 6473 206f 7574 2074 6865 2073   Finds out the s
+00013030: 796d 6d65 7472 6963 206c 696e 6573 6567  ymmetric lineseg
+00013040: 6d65 6e74 3264 2061 6363 6f72 6469 6e67  ment2d according
+00013050: 2074 6f20 6120 6c69 6e65 2e0a 2020 2020   to a line..    
+00013060: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00013070: 2070 6f69 6e74 735f 7379 6d6d 6574 7279   points_symmetry
+00013080: 203d 205b 706f 696e 742e 6178 6961 6c5f   = [point.axial_
+00013090: 7379 6d6d 6574 7279 286c 696e 6529 2066  symmetry(line) f
+000130a0: 6f72 2070 6f69 6e74 2069 6e20 5b73 656c  or point in [sel
+000130b0: 662e 7374 6172 742c 2073 656c 662e 656e  f.start, self.en
+000130c0: 645d 5d0a 0a20 2020 2020 2020 2072 6574  d]]..        ret
+000130d0: 7572 6e20 7365 6c66 2e5f 5f63 6c61 7373  urn self.__class
+000130e0: 5f5f 2870 6f69 6e74 735f 7379 6d6d 6574  __(points_symmet
+000130f0: 7279 5b30 5d2c 2070 6f69 6e74 735f 7379  ry[0], points_sy
+00013100: 6d6d 6574 7279 5b31 5d29 0a0a 0a63 6c61  mmetry[1])...cla
+00013110: 7373 2041 7263 2845 6467 6529 3a0a 2020  ss Arc(Edge):.  
+00013120: 2020 2222 220a 2020 2020 4162 7374 7261    """.    Abstra
+00013130: 6374 2063 6c61 7373 2072 6570 7265 7365  ct class represe
+00013140: 6e74 696e 6720 616e 2061 7263 2e0a 0a20  nting an arc... 
+00013150: 2020 203a 7061 7261 6d20 7374 6172 743a     :param start:
+00013160: 2054 6865 2073 7461 7274 696e 6720 706f   The starting po
+00013170: 696e 740a 2020 2020 3a74 7970 6520 7374  int.    :type st
+00013180: 6172 743a 2055 6e69 6f6e 5b3a 636c 6173  art: Union[:clas
+00013190: 733a 6076 6f6c 6d64 6c72 2e50 6f69 6e74  s:`volmdlr.Point
+000131a0: 3244 602c 203a 636c 6173 733a 6076 6f6c  2D`, :class:`vol
+000131b0: 6d64 6c72 2e50 6f69 6e74 3344 605d 0a20  mdlr.Point3D`]. 
+000131c0: 2020 203a 7061 7261 6d20 656e 643a 2054     :param end: T
+000131d0: 6865 2066 696e 6973 6820 706f 696e 740a  he finish point.
+000131e0: 2020 2020 3a74 7970 6520 656e 643a 2055      :type end: U
+000131f0: 6e69 6f6e 5b3a 636c 6173 733a 6076 6f6c  nion[:class:`vol
+00013200: 6d64 6c72 2e50 6f69 6e74 3244 602c 203a  mdlr.Point2D`, :
+00013210: 636c 6173 733a 6076 6f6c 6d64 6c72 2e50  class:`volmdlr.P
+00013220: 6f69 6e74 3344 605d 0a20 2020 203a 7061  oint3D`].    :pa
+00013230: 7261 6d20 696e 7465 7269 6f72 3a20 416e  ram interior: An
+00013240: 2069 6e74 6572 696f 7220 706f 696e 740a   interior point.
+00013250: 2020 2020 3a74 7970 6520 696e 7465 7269      :type interi
+00013260: 6f72 3a20 556e 696f 6e5b 3a63 6c61 7373  or: Union[:class
+00013270: 3a60 766f 6c6d 646c 722e 506f 696e 7432  :`volmdlr.Point2
+00013280: 4460 2c20 3a63 6c61 7373 3a60 766f 6c6d  D`, :class:`volm
+00013290: 646c 722e 506f 696e 7433 4460 5d0a 2020  dlr.Point3D`].  
+000132a0: 2020 3a70 6172 616d 206e 616d 653a 2054    :param name: T
+000132b0: 6865 206e 616d 6520 6f66 2074 6865 2061  he name of the a
+000132c0: 7263 2e20 4465 6661 756c 7420 7661 6c75  rc. Default valu
+000132d0: 6520 6973 2061 6e20 656d 7074 7920 7374  e is an empty st
+000132e0: 7269 6e67 0a20 2020 203a 7479 7065 206e  ring.    :type n
+000132f0: 616d 653a 2073 7472 2c20 6f70 7469 6f6e  ame: str, option
+00013300: 616c 0a20 2020 2022 2222 0a0a 2020 2020  al.    """..    
+00013310: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00013320: 662c 2073 7461 7274 2c0a 2020 2020 2020  f, start,.      
+00013330: 2020 2020 2020 2020 2020 2065 6e64 2c0a             end,.
+00013340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013350: 2069 6e74 6572 696f 722c 0a20 2020 2020   interior,.     
+00013360: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00013370: 3a20 7374 7220 3d20 2727 293a 0a20 2020  : str = ''):.   
+00013380: 2020 2020 2045 6467 652e 5f5f 696e 6974       Edge.__init
+00013390: 5f5f 2873 656c 662c 2073 7461 7274 3d73  __(self, start=s
+000133a0: 7461 7274 2c20 656e 643d 656e 642c 206e  tart, end=end, n
+000133b0: 616d 653d 6e61 6d65 290a 2020 2020 2020  ame=name).      
+000133c0: 2020 7365 6c66 2e69 6e74 6572 696f 7220    self.interior 
+000133d0: 3d20 696e 7465 7269 6f72 0a20 2020 2020  = interior.     
+000133e0: 2020 2073 656c 662e 5f75 7464 5f63 6c6f     self._utd_clo
+000133f0: 636b 7769 7365 5f61 6e64 5f74 7269 676f  ckwise_and_trigo
+00013400: 7769 7365 5f70 6174 6873 203d 2046 616c  wise_paths = Fal
+00013410: 7365 0a20 2020 2020 2020 2073 656c 662e  se.        self.
+00013420: 5f63 6c6f 636b 7769 7365 5f61 6e64 5f74  _clockwise_and_t
+00013430: 7269 676f 7769 7365 5f70 6174 6873 203d  rigowise_paths =
+00013440: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
+00013450: 6c66 2e5f 7261 6469 7573 203d 204e 6f6e  lf._radius = Non
+00013460: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
+00013470: 0a20 2020 2064 6566 2063 656e 7465 7228  .    def center(
+00013480: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00013490: 2222 0a20 2020 2020 2020 2047 6574 7320  "".        Gets 
+000134a0: 7468 6520 6172 6327 7320 6365 6e74 6572  the arc's center
+000134b0: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
+000134c0: 726e 3a20 5468 6520 6365 6e74 6572 206f  rn: The center o
+000134d0: 6620 7468 6520 6172 632e 0a20 2020 2020  f the arc..     
+000134e0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+000134f0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+00013500: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+00013510: 2020 2020 2020 2774 6865 2070 726f 7065        'the prope
+00013520: 7274 7920 6d65 7468 6f64 2063 656e 7465  rty method cente
+00013530: 7220 6d75 7374 2062 6520 6f76 6572 6c6f  r must be overlo
+00013540: 6164 6564 2062 7920 7375 6263 6c61 7373  aded by subclass
+00013550: 696e 6727 0a20 2020 2020 2020 2020 2020  ing'.           
+00013560: 2027 636c 6173 7320 6966 206e 6f74 2061   'class if not a
+00013570: 2067 6976 656e 2070 6172 616d 6574 6572   given parameter
+00013580: 2729 0a0a 2020 2020 4070 726f 7065 7274  ')..    @propert
+00013590: 790a 2020 2020 6465 6620 616e 676c 6528  y.    def angle(
+000135a0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+000135b0: 2222 0a20 2020 2020 2020 2047 6574 7320  "".        Gets 
+000135c0: 7468 6520 616e 676c 6520 6f66 2074 6865  the angle of the
+000135d0: 2061 7263 2e0a 0a20 2020 2020 2020 203a   arc...        :
+000135e0: 7265 7475 726e 3a20 5468 6520 616e 676c  return: The angl
+000135f0: 6520 6f66 2074 6865 2061 7263 2e0a 2020  e of the arc..  
+00013600: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00013610: 2020 7265 7475 726e 204e 6f74 496d 706c    return NotImpl
+00013620: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+00013630: 2020 2020 2020 2020 2020 2774 6865 2070            'the p
+00013640: 726f 7065 7274 7920 6d65 7468 6f64 2061  roperty method a
+00013650: 6e67 6c65 206d 7573 7420 6265 206f 7665  ngle must be ove
+00013660: 726c 6f61 6465 6420 6279 2073 7562 636c  rloaded by subcl
+00013670: 6173 7369 6e67 270a 2020 2020 2020 2020  assing'.        
+00013680: 2020 2020 2763 6c61 7373 2069 6620 6e6f      'class if no
+00013690: 7420 6120 6769 7665 6e20 7061 7261 6d65  t a given parame
+000136a0: 7465 7227 290a 0a20 2020 2040 7072 6f70  ter')..    @prop
+000136b0: 6572 7479 0a20 2020 2064 6566 2069 735f  erty.    def is_
+000136c0: 7472 6967 6f28 7365 6c66 293a 0a20 2020  trigo(self):.   
+000136d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000136e0: 2056 6572 6966 6965 7320 6966 2061 7263   Verifies if arc
+000136f0: 2069 7320 7472 6967 6f6e 6f6d 6574 7269   is trigonometri
+00013700: 6320 7769 7365 206f 7220 636c 6f63 6b77  c wise or clockw
+00013710: 6973 652e 0a0a 2020 2020 2020 2020 3a72  ise...        :r
+00013720: 6574 7572 6e3a 2054 7275 6520 6966 2074  eturn: True if t
+00013730: 7269 676f 6e6f 6d65 7472 6963 2077 6973  rigonometric wis
+00013740: 6520 6f72 2046 616c 7365 206f 7468 6572  e or False other
+00013750: 7769 7365 2e0a 2020 2020 2020 2020 2222  wise..        ""
+00013760: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00013770: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+00013780: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00013790: 2020 2774 6865 2070 726f 7065 7274 7920    'the property 
+000137a0: 6d65 7468 6f64 2069 735f 7472 6967 6f20  method is_trigo 
+000137b0: 6d75 7374 2062 6520 6f76 6572 6c6f 6164  must be overload
+000137c0: 6564 2062 7920 7375 6263 6c61 7373 696e  ed by subclassin
+000137d0: 6727 0a20 2020 2020 2020 2020 2020 2027  g'.            '
+000137e0: 636c 6173 7320 6966 206e 6f74 2061 2067  class if not a g
+000137f0: 6976 656e 2070 6172 616d 6574 6572 2729  iven parameter')
+00013800: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00013810: 2020 2020 6465 6620 7261 6469 7573 2873      def radius(s
+00013820: 656c 6629 3a0a 2020 2020 2020 2020 6966  elf):.        if
+00013830: 206e 6f74 2073 656c 662e 5f72 6164 6975   not self._radiu
+00013840: 733a 0a20 2020 2020 2020 2020 2020 2073  s:.            s
+00013850: 656c 662e 5f72 6164 6975 7320 3d20 2873  elf._radius = (s
+00013860: 656c 662e 7374 6172 7420 2d20 7365 6c66  elf.start - self
+00013870: 2e63 656e 7465 7229 2e6e 6f72 6d28 290a  .center).norm().
+00013880: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00013890: 656c 662e 5f72 6164 6975 730a 0a20 2020  elf._radius..   
+000138a0: 2064 6566 206c 656e 6774 6828 7365 6c66   def length(self
+000138b0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+000138c0: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
+000138d0: 7320 7468 6520 6c65 6e67 7468 206f 6620  s the length of 
+000138e0: 7468 6520 4172 632c 2077 6974 6820 6974  the Arc, with it
+000138f0: 7320 7261 6469 7573 2061 6e64 2069 7420  s radius and it 
+00013900: 6172 6320 616e 676c 652e 0a0a 2020 2020  arc angle...    
+00013910: 2020 2020 3a72 6574 7572 6e3a 2074 6865      :return: the
+00013920: 206c 656e 6774 6820 666f 2074 6865 2041   length fo the A
+00013930: 7263 2e0a 2020 2020 2020 2020 2222 220a  rc..        """.
+00013940: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00013950: 656c 662e 7261 6469 7573 202a 2061 6273  elf.radius * abs
+00013960: 2873 656c 662e 616e 676c 6529 0a0a 2020  (self.angle)..  
+00013970: 2020 6465 6620 706f 696e 745f 6174 5f61    def point_at_a
+00013980: 6273 6369 7373 6128 7365 6c66 2c20 6162  bscissa(self, ab
+00013990: 7363 6973 7361 293a 0a20 2020 2020 2020  scissa):.       
+000139a0: 2022 2222 0a20 2020 2020 2020 2043 616c   """.        Cal
+000139b0: 6375 6c61 7465 7320 6120 706f 696e 7420  culates a point 
+000139c0: 696e 2074 6865 2041 7263 2061 7420 6120  in the Arc at a 
+000139d0: 6769 7665 6e20 6162 7363 6973 7361 2e0a  given abscissa..
+000139e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000139f0: 6162 7363 6973 7361 3a20 6162 7363 6973  abscissa: abscis
+00013a00: 7361 2077 6865 7265 2069 6e20 7468 6520  sa where in the 
+00013a10: 6375 7276 6520 7468 6520 706f 696e 7420  curve the point 
+00013a20: 7368 6f75 6c64 2062 6520 6361 6c63 756c  should be calcul
+00013a30: 6174 6564 2e0a 2020 2020 2020 2020 3a72  ated..        :r
+00013a40: 6574 7572 6e3a 2043 6f72 7265 7370 6f6e  eturn: Correspon
+00013a50: 6469 6e67 2070 6f69 6e74 2e0a 2020 2020  ding point..    
+00013a60: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00013a70: 6966 2073 656c 662e 6973 5f74 7269 676f  if self.is_trigo
+00013a80: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00013a90: 7475 726e 2073 656c 662e 7374 6172 742e  turn self.start.
+00013aa0: 726f 7461 7469 6f6e 2873 656c 662e 6365  rotation(self.ce
+00013ab0: 6e74 6572 2c20 6162 7363 6973 7361 202f  nter, abscissa /
+00013ac0: 2073 656c 662e 7261 6469 7573 290a 2020   self.radius).  
+00013ad0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00013ae0: 662e 7374 6172 742e 726f 7461 7469 6f6e  f.start.rotation
+00013af0: 2873 656c 662e 6365 6e74 6572 2c20 2d61  (self.center, -a
+00013b00: 6273 6369 7373 6120 2f20 7365 6c66 2e72  bscissa / self.r
+00013b10: 6164 6975 7329 0a0a 2020 2020 4073 7461  adius)..    @sta
+00013b20: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
+00013b30: 6620 6765 745f 636c 6f63 6b77 6973 655f  f get_clockwise_
+00013b40: 616e 645f 7472 6967 6f77 6973 655f 7061  and_trigowise_pa
+00013b50: 7468 7328 7261 6469 7573 5f31 2c20 7261  ths(radius_1, ra
+00013b60: 6469 7573 5f32 2c20 7261 6469 7573 5f69  dius_2, radius_i
+00013b70: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00013b80: 2020 2020 2020 2047 6574 2061 7263 2070         Get arc p
+00013b90: 6174 6873 2066 726f 6d20 7261 6469 7573  aths from radius
+00013ba0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00013bb0: 6d20 7261 6469 7573 5f31 3a20 7261 6469  m radius_1: radi
+00013bc0: 7573 2066 726f 6d20 6365 6e74 6572 2074  us from center t
+00013bd0: 6f20 7374 6172 7420 706f 696e 742e 0a20  o start point.. 
+00013be0: 2020 2020 2020 203a 7061 7261 6d20 7261         :param ra
+00013bf0: 6469 7573 5f32 3a20 7261 6469 7573 2066  dius_2: radius f
+00013c00: 6f72 6d20 6365 6e74 6572 2074 6f20 656e  orm center to en
+00013c10: 6420 706f 696e 742e 0a20 2020 2020 2020  d point..       
+00013c20: 203a 7061 7261 6d20 7261 6469 7573 5f69   :param radius_i
+00013c30: 3a20 7261 6469 7573 2066 726f 6d20 6365  : radius from ce
+00013c40: 6e74 6572 2074 6f20 696e 7465 7269 6f72  nter to interior
+00013c50: 2070 6f69 6e74 2e0a 2020 2020 2020 2020   point..        
+00013c60: 3a72 6574 7572 6e3a 2074 6865 2063 6c6f  :return: the clo
+00013c70: 636b 7769 7365 2061 6e64 2074 7269 676f  ckwise and trigo
+00013c80: 7769 7365 2070 6174 6873 2e0a 2020 2020  wise paths..    
+00013c90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00013ca0: 616e 676c 6531 203d 206d 6174 682e 6174  angle1 = math.at
+00013cb0: 616e 3228 7261 6469 7573 5f31 2e79 2c20  an2(radius_1.y, 
+00013cc0: 7261 6469 7573 5f31 2e78 290a 2020 2020  radius_1.x).    
+00013cd0: 2020 2020 616e 676c 6569 203d 206d 6174      anglei = mat
+00013ce0: 682e 6174 616e 3228 7261 6469 7573 5f69  h.atan2(radius_i
+00013cf0: 2e79 2c20 7261 6469 7573 5f69 2e78 290a  .y, radius_i.x).
+00013d00: 2020 2020 2020 2020 616e 676c 6532 203d          angle2 =
+00013d10: 206d 6174 682e 6174 616e 3228 7261 6469   math.atan2(radi
+00013d20: 7573 5f32 2e79 2c20 7261 6469 7573 5f32  us_2.y, radius_2
+00013d30: 2e78 290a 0a20 2020 2020 2020 2023 2047  .x)..        # G
+00013d40: 6f69 6e67 2074 7269 676f 2f63 6c6f 636b  oing trigo/clock
+00013d50: 2077 6973 6520 6672 6f6d 2073 7461 7274   wise from start
+00013d60: 2074 6f20 696e 7465 7269 6f72 0a20 2020   to interior.   
+00013d70: 2020 2020 2069 6620 616e 676c 6569 203c       if anglei <
+00013d80: 2061 6e67 6c65 313a 0a20 2020 2020 2020   angle1:.       
+00013d90: 2020 2020 2074 7269 676f 7769 7365 5f70       trigowise_p
+00013da0: 6174 6820 3d20 2861 6e67 6c65 6920 2b20  ath = (anglei + 
+00013db0: 766f 6c6d 646c 722e 5457 4f5f 5049 2920  volmdlr.TWO_PI) 
+00013dc0: 2d20 616e 676c 6531 0a20 2020 2020 2020  - angle1.       
+00013dd0: 2020 2020 2063 6c6f 636b 7769 7365 5f70       clockwise_p
+00013de0: 6174 6820 3d20 616e 676c 6531 202d 2061  ath = angle1 - a
+00013df0: 6e67 6c65 690a 2020 2020 2020 2020 656c  nglei.        el
+00013e00: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00013e10: 7472 6967 6f77 6973 655f 7061 7468 203d  trigowise_path =
+00013e20: 2061 6e67 6c65 6920 2d20 616e 676c 6531   anglei - angle1
+00013e30: 0a20 2020 2020 2020 2020 2020 2063 6c6f  .            clo
+00013e40: 636b 7769 7365 5f70 6174 6820 3d20 616e  ckwise_path = an
+00013e50: 676c 6531 202d 2061 6e67 6c65 6920 2b20  gle1 - anglei + 
+00013e60: 766f 6c6d 646c 722e 5457 4f5f 5049 0a0a  volmdlr.TWO_PI..
+00013e70: 2020 2020 2020 2020 2320 476f 696e 6720          # Going 
+00013e80: 7472 6967 6f20 7769 7365 2066 726f 6d20  trigo wise from 
+00013e90: 696e 7465 7269 6f72 2074 6f20 696e 7465  interior to inte
+00013ea0: 7269 6f72 0a20 2020 2020 2020 2069 6620  rior.        if 
+00013eb0: 616e 676c 6532 203c 2061 6e67 6c65 693a  angle2 < anglei:
+00013ec0: 0a20 2020 2020 2020 2020 2020 2074 7269  .            tri
+00013ed0: 676f 7769 7365 5f70 6174 6820 2b3d 2028  gowise_path += (
+00013ee0: 616e 676c 6532 202b 2076 6f6c 6d64 6c72  angle2 + volmdlr
+00013ef0: 2e54 574f 5f50 4929 202d 2061 6e67 6c65  .TWO_PI) - angle
+00013f00: 690a 2020 2020 2020 2020 2020 2020 636c  i.            cl
+00013f10: 6f63 6b77 6973 655f 7061 7468 202b 3d20  ockwise_path += 
+00013f20: 616e 676c 6569 202d 2061 6e67 6c65 320a  anglei - angle2.
+00013f30: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00013f40: 2020 2020 2020 2020 2020 7472 6967 6f77            trigow
+00013f50: 6973 655f 7061 7468 202b 3d20 616e 676c  ise_path += angl
+00013f60: 6532 202d 2061 6e67 6c65 690a 2020 2020  e2 - anglei.    
+00013f70: 2020 2020 2020 2020 636c 6f63 6b77 6973          clockwis
+00013f80: 655f 7061 7468 202b 3d20 616e 676c 6569  e_path += anglei
+00013f90: 202d 2061 6e67 6c65 3220 2b20 766f 6c6d   - angle2 + volm
+00013fa0: 646c 722e 5457 4f5f 5049 0a20 2020 2020  dlr.TWO_PI.     
+00013fb0: 2020 2072 6574 7572 6e20 636c 6f63 6b77     return clockw
+00013fc0: 6973 655f 7061 7468 2c20 7472 6967 6f77  ise_path, trigow
+00013fd0: 6973 655f 7061 7468 0a0a 2020 2020 6465  ise_path..    de
+00013fe0: 6620 6d69 6464 6c65 5f70 6f69 6e74 2873  f middle_point(s
+00013ff0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00014000: 220a 2020 2020 2020 2020 4765 7420 706f  ".        Get po
+00014010: 696e 7420 696e 2074 6865 206d 6964 646c  int in the middl
+00014020: 6520 6f66 2041 7263 2e0a 2020 2020 2020  e of Arc..      
+00014030: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00014040: 7475 726e 2073 656c 662e 706f 696e 745f  turn self.point_
+00014050: 6174 5f61 6273 6369 7373 6128 302e 3520  at_abscissa(0.5 
+00014060: 2a20 7365 6c66 2e6c 656e 6774 6828 2929  * self.length())
+00014070: 0a0a 2020 2020 6465 6620 706f 696e 745f  ..    def point_
+00014080: 6469 7374 616e 6365 2873 656c 662c 2070  distance(self, p
+00014090: 6f69 6e74 293a 0a20 2020 2020 2020 2022  oint):.        "
+000140a0: 2222 5265 7475 726e 7320 7468 6520 6d69  ""Returns the mi
+000140b0: 6e69 6d61 6c20 6469 7374 616e 6365 2074  nimal distance t
+000140c0: 6f20 6120 706f 696e 742e 2222 220a 2020  o a point.""".  
+000140d0: 2020 2020 2020 706f 696e 7473 203d 2073        points = s
+000140e0: 656c 662e 6469 7363 7265 7469 7a61 7469  elf.discretizati
+000140f0: 6f6e 5f70 6f69 6e74 7328 616e 676c 655f  on_points(angle_
+00014100: 7265 736f 6c75 7469 6f6e 3d31 3030 290a  resolution=100).
+00014110: 2020 2020 2020 2020 7265 7475 726e 2070          return p
+00014120: 6f69 6e74 2e70 6f69 6e74 5f64 6973 7461  oint.point_dista
+00014130: 6e63 6528 706f 696e 742e 6e65 6172 6573  nce(point.neares
+00014140: 745f 706f 696e 7428 706f 696e 7473 2929  t_point(points))
+00014150: 0a0a 2020 2020 6465 6620 6469 7363 7265  ..    def discre
+00014160: 7469 7a61 7469 6f6e 5f70 6f69 6e74 7328  tization_points(
+00014170: 7365 6c66 2c20 2a2c 206e 756d 6265 725f  self, *, number_
+00014180: 706f 696e 7473 3a20 696e 7420 3d20 4e6f  points: int = No
+00014190: 6e65 2c20 616e 676c 655f 7265 736f 6c75  ne, angle_resolu
+000141a0: 7469 6f6e 3a20 696e 7420 3d20 4e6f 6e65  tion: int = None
+000141b0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+000141c0: 2020 2020 2020 2044 6973 6372 6574 697a         Discretiz
+000141d0: 6520 6120 4564 6765 2074 6f20 6861 7665  e a Edge to have
+000141e0: 2022 6e22 2070 6f69 6e74 732e 0a0a 2020   "n" points...  
+000141f0: 2020 2020 2020 3a70 6172 616d 206e 756d        :param num
+00014200: 6265 725f 706f 696e 7473 3a20 7468 6520  ber_points: the 
+00014210: 6e75 6d62 6572 206f 6620 706f 696e 7473  number of points
+00014220: 2028 696e 636c 7564 696e 6720 7374 6172   (including star
+00014230: 7420 616e 6420 656e 6420 706f 696e 7473  t and end points
+00014240: 290a 2020 2020 2020 2020 2020 2020 2069  ).             i
+00014250: 6620 756e 7365 742c 206f 6e6c 7920 7374  f unset, only st
+00014260: 6172 7420 616e 6420 656e 6420 7769 6c6c  art and end will
+00014270: 2062 6520 7265 7475 726e 6564 0a20 2020   be returned.   
+00014280: 2020 2020 203a 7061 7261 6d20 616e 676c       :param angl
+00014290: 655f 7265 736f 6c75 7469 6f6e 3a20 6966  e_resolution: if
+000142a0: 2073 6574 2c20 7468 6520 7361 6d70 6c69   set, the sampli
+000142b0: 6e67 2077 696c 6c20 6265 2061 6461 7074  ng will be adapt
+000142c0: 6564 2074 6f20 6861 7665 2061 2063 6f6e  ed to have a con
+000142d0: 7472 6f6c 6c65 6420 616e 6775 6c61 7220  trolled angular 
+000142e0: 6469 7374 616e 6365 2e20 5573 6566 756c  distance. Useful
+000142f0: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
+00014300: 6d65 7368 2061 6e20 6172 630a 2020 2020  mesh an arc.    
+00014310: 2020 2020 3a72 6574 7572 6e3a 2061 206c      :return: a l
+00014320: 6973 7420 6f66 2073 616d 706c 6564 2070  ist of sampled p
+00014330: 6f69 6e74 730a 2020 2020 2020 2020 2222  oints.        ""
+00014340: 220a 2020 2020 2020 2020 6966 206e 6f74  ".        if not
+00014350: 206e 756d 6265 725f 706f 696e 7473 3a0a   number_points:.
+00014360: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00014370: 6f74 2061 6e67 6c65 5f72 6573 6f6c 7574  ot angle_resolut
+00014380: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
+00014390: 2020 2020 206e 756d 6265 725f 706f 696e       number_poin
+000143a0: 7473 203d 2032 0a20 2020 2020 2020 2020  ts = 2.         
+000143b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000143c0: 2020 2020 2020 2020 206e 756d 6265 725f           number_
+000143d0: 706f 696e 7473 203d 206d 6174 682e 6365  points = math.ce
+000143e0: 696c 2873 656c 662e 616e 676c 6520 2a20  il(self.angle * 
+000143f0: 616e 676c 655f 7265 736f 6c75 7469 6f6e  angle_resolution
+00014400: 2920 2b20 320a 0a20 2020 2020 2020 2073  ) + 2..        s
+00014410: 7465 7020 3d20 7365 6c66 2e6c 656e 6774  tep = self.lengt
+00014420: 6828 2920 2f20 286e 756d 6265 725f 706f  h() / (number_po
+00014430: 696e 7473 202d 2031 290a 2020 2020 2020  ints - 1).      
+00014440: 2020 7265 7475 726e 205b 7365 6c66 2e70    return [self.p
+00014450: 6f69 6e74 5f61 745f 6162 7363 6973 7361  oint_at_abscissa
+00014460: 2869 202a 2073 7465 7029 0a20 2020 2020  (i * step).     
+00014470: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00014480: 2069 6e20 7261 6e67 6528 6e75 6d62 6572   in range(number
+00014490: 5f70 6f69 6e74 7329 5d0a 0a20 2020 2064  _points)]..    d
+000144a0: 6566 2070 6f6c 7967 6f6e 5f70 6f69 6e74  ef polygon_point
+000144b0: 7328 7365 6c66 2c20 6469 7363 7265 7469  s(self, discreti
 000144c0: 7a61 7469 6f6e 5f72 6573 6f6c 7574 696f  zation_resolutio
-000144d0: 6e29 0a0a 2020 2020 6465 6620 6765 745f  n)..    def get_
-000144e0: 6765 6f5f 6c69 6e65 7328 7365 6c66 2c20  geo_lines(self, 
-000144f0: 7461 673a 2069 6e74 2c20 7374 6172 745f  tag: int, start_
-00014500: 706f 696e 745f 7461 673a 2069 6e74 2c20  point_tag: int, 
-00014510: 6365 6e74 6572 5f70 6f69 6e74 5f74 6167  center_point_tag
-00014520: 3a20 696e 742c 2065 6e64 5f70 6f69 6e74  : int, end_point
-00014530: 5f74 6167 3a20 696e 7429 3a0a 2020 2020  _tag: int):.    
-00014540: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00014550: 4765 7473 2074 6865 206c 696e 6573 2074  Gets the lines t
-00014560: 6861 7420 6465 6669 6e65 2061 6e20 4172  hat define an Ar
-00014570: 6320 696e 2061 202e 6765 6f20 6669 6c65  c in a .geo file
-00014580: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00014590: 6d20 7461 673a 2054 6865 206c 696e 6573  m tag: The lines
-000145a0: 6567 6d65 6e74 2069 6e64 6578 0a20 2020  egment index.   
-000145b0: 2020 2020 203a 7479 7065 2074 6167 3a20       :type tag: 
-000145c0: 696e 740a 2020 2020 2020 2020 3a70 6172  int.        :par
-000145d0: 616d 2073 7461 7274 5f70 6f69 6e74 5f74  am start_point_t
-000145e0: 6167 3a20 5468 6520 6c69 6e65 7365 676d  ag: The linesegm
-000145f0: 656e 7427 2073 7461 7274 2070 6f69 6e74  ent' start point
-00014600: 2069 6e64 6578 0a20 2020 2020 2020 203a   index.        :
-00014610: 7479 7065 2073 7461 7274 5f70 6f69 6e74  type start_point
-00014620: 5f74 6167 3a20 696e 740a 2020 2020 2020  _tag: int.      
-00014630: 2020 3a70 6172 616d 2063 656e 7465 725f    :param center_
-00014640: 706f 696e 745f 7461 673a 2054 6865 206c  point_tag: The l
-00014650: 696e 6573 6567 6d65 6e74 2720 6365 6e74  inesegment' cent
-00014660: 6572 2070 6f69 6e74 2069 6e64 6578 0a20  er point index. 
-00014670: 2020 2020 2020 203a 7479 7065 2063 656e         :type cen
-00014680: 7465 725f 706f 696e 745f 7461 673a 2069  ter_point_tag: i
-00014690: 6e74 0a20 2020 2020 2020 203a 7061 7261  nt.        :para
-000146a0: 6d20 656e 645f 706f 696e 745f 7461 673a  m end_point_tag:
-000146b0: 2054 6865 206c 696e 6573 6567 6d65 6e74   The linesegment
-000146c0: 2720 656e 6420 706f 696e 7420 696e 6465  ' end point inde
-000146d0: 780a 2020 2020 2020 2020 3a74 7970 6520  x.        :type 
-000146e0: 656e 645f 706f 696e 745f 7461 673a 2069  end_point_tag: i
-000146f0: 6e74 0a0a 2020 2020 2020 2020 3a72 6574  nt..        :ret
-00014700: 7572 6e3a 2041 206c 696e 650a 2020 2020  urn: A line.    
-00014710: 2020 2020 3a72 7479 7065 3a20 7374 720a      :rtype: str.
-00014720: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00014730: 2020 2020 2072 6574 7572 6e20 2743 6972       return 'Cir
-00014740: 636c 6528 2720 2b20 7374 7228 7461 6729  cle(' + str(tag)
-00014750: 202b 2027 2920 3d20 7b27 202b 2073 7472   + ') = {' + str
-00014760: 2873 7461 7274 5f70 6f69 6e74 5f74 6167  (start_point_tag
-00014770: 2920 2b20 272c 2027 202b 205c 0a20 2020  ) + ', ' + \.   
-00014780: 2020 2020 2020 2020 2073 7472 2863 656e           str(cen
-00014790: 7465 725f 706f 696e 745f 7461 6729 202b  ter_point_tag) +
-000147a0: 2027 2c20 2720 2b20 7374 7228 656e 645f   ', ' + str(end_
-000147b0: 706f 696e 745f 7461 6729 202b 2027 7d3b  point_tag) + '};
-000147c0: 270a 0a20 2020 2064 6566 2067 6574 5f67  '..    def get_g
-000147d0: 656f 5f70 6f69 6e74 7328 7365 6c66 293a  eo_points(self):
-000147e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000147f0: 5b73 656c 662e 7374 6172 742c 2073 656c  [self.start, sel
-00014800: 662e 6365 6e74 6572 2c20 7365 6c66 2e65  f.center, self.e
-00014810: 6e64 5d0a 0a0a 636c 6173 7320 4172 6332  nd]...class Arc2
-00014820: 4428 4172 6329 3a0a 2020 2020 2222 220a  D(Arc):.    """.
-00014830: 2020 2020 436c 6173 7320 746f 2064 7261      Class to dra
-00014840: 7720 4172 6332 442e 0a0a 2020 2020 616e  w Arc2D...    an
-00014850: 676c 653a 2074 6865 2061 6e67 6c65 206d  gle: the angle m
-00014860: 6561 7375 7265 2061 6c77 6179 7320 3e3d  easure always >=
-00014870: 2030 0a20 2020 2022 2222 0a0a 2020 2020   0.    """..    
-00014880: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-00014890: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
-000148a0: 2020 2020 7374 6172 743a 2076 6f6c 6d64      start: volmd
-000148b0: 6c72 2e50 6f69 6e74 3244 2c0a 2020 2020  lr.Point2D,.    
-000148c0: 2020 2020 2020 2020 2020 2020 2069 6e74               int
-000148d0: 6572 696f 723a 2076 6f6c 6d64 6c72 2e50  erior: volmdlr.P
-000148e0: 6f69 6e74 3244 2c0a 2020 2020 2020 2020  oint2D,.        
-000148f0: 2020 2020 2020 2020 2065 6e64 3a20 766f           end: vo
-00014900: 6c6d 646c 722e 506f 696e 7432 442c 0a20  lmdlr.Point2D,. 
-00014910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014920: 6e61 6d65 3a20 7374 7220 3d20 2727 293a  name: str = ''):
-00014930: 0a20 2020 2020 2020 2073 656c 662e 5f63  .        self._c
-00014940: 656e 7465 7220 3d20 4e6f 6e65 0a20 2020  enter = None.   
-00014950: 2020 2020 2073 656c 662e 5f69 735f 7472       self._is_tr
-00014960: 6967 6f20 3d20 4e6f 6e65 0a20 2020 2020  igo = None.     
-00014970: 2020 2073 656c 662e 5f61 6e67 6c65 203d     self._angle =
-00014980: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
-00014990: 6c66 2e5f 626f 756e 6469 6e67 5f72 6563  lf._bounding_rec
-000149a0: 7461 6e67 6c65 203d 204e 6f6e 650a 2020  tangle = None.  
-000149b0: 2020 2020 2020 4172 632e 5f5f 696e 6974        Arc.__init
-000149c0: 5f5f 2873 656c 662c 2073 7461 7274 3d73  __(self, start=s
-000149d0: 7461 7274 2c20 656e 643d 656e 642c 2069  tart, end=end, i
-000149e0: 6e74 6572 696f 723d 696e 7465 7269 6f72  nterior=interior
-000149f0: 2c20 6e61 6d65 3d6e 616d 6529 0a20 2020  , name=name).   
-00014a00: 2020 2020 2073 7461 7274 5f74 6f5f 6365       start_to_ce
-00014a10: 6e74 6572 203d 2073 7461 7274 202d 2073  nter = start - s
-00014a20: 656c 662e 6365 6e74 6572 0a20 2020 2020  elf.center.     
-00014a30: 2020 2065 6e64 5f74 6f5f 6365 6e74 6572     end_to_center
-00014a40: 203d 2065 6e64 202d 2073 656c 662e 6365   = end - self.ce
-00014a50: 6e74 6572 0a20 2020 2020 2020 2061 6e67  nter.        ang
-00014a60: 6c65 3120 3d20 6d61 7468 2e61 7461 6e32  le1 = math.atan2
-00014a70: 2873 7461 7274 5f74 6f5f 6365 6e74 6572  (start_to_center
-00014a80: 2e79 2c20 7374 6172 745f 746f 5f63 656e  .y, start_to_cen
-00014a90: 7465 722e 7829 0a20 2020 2020 2020 2061  ter.x).        a
-00014aa0: 6e67 6c65 3220 3d20 6d61 7468 2e61 7461  ngle2 = math.ata
-00014ab0: 6e32 2865 6e64 5f74 6f5f 6365 6e74 6572  n2(end_to_center
-00014ac0: 2e79 2c20 656e 645f 746f 5f63 656e 7465  .y, end_to_cente
-00014ad0: 722e 7829 0a20 2020 2020 2020 2069 6620  r.x).        if 
-00014ae0: 7365 6c66 2e69 735f 7472 6967 6f3a 0a20  self.is_trigo:. 
-00014af0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00014b00: 616e 676c 6531 203d 2061 6e67 6c65 310a  angle1 = angle1.
-00014b10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00014b20: 2e61 6e67 6c65 3220 3d20 616e 676c 6532  .angle2 = angle2
-00014b30: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00014b40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00014b50: 616e 676c 6531 203d 2061 6e67 6c65 320a  angle1 = angle2.
-00014b60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00014b70: 2e61 6e67 6c65 3220 3d20 616e 676c 6531  .angle2 = angle1
-00014b80: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00014b90: 2020 2020 6465 6620 6365 6e74 6572 2873      def center(s
-00014ba0: 656c 6629 3a0a 2020 2020 2020 2020 6966  elf):.        if
-00014bb0: 206e 6f74 2073 656c 662e 5f63 656e 7465   not self._cente
-00014bc0: 723a 0a20 2020 2020 2020 2020 2020 2073  r:.            s
-00014bd0: 656c 662e 5f63 656e 7465 7220 3d20 7365  elf._center = se
-00014be0: 6c66 2e67 6574 5f63 656e 7465 7228 290a  lf.get_center().
-00014bf0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00014c00: 656c 662e 5f63 656e 7465 720a 0a20 2020  elf._center..   
-00014c10: 2064 6566 2067 6574 5f63 656e 7465 7228   def get_center(
-00014c20: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00014c30: 2222 0a20 2020 2020 2020 2043 616c 6375  "".        Calcu
-00014c40: 6c61 7465 7320 7468 6520 6365 6e74 6572  lates the center
-00014c50: 206f 6620 7468 6520 4172 632e 0a0a 2020   of the Arc...  
-00014c60: 2020 2020 2020 3a72 6574 7572 6e3a 2061        :return: a
-00014c70: 7363 2773 2063 656e 7465 722e 0a20 2020  sc's center..   
-00014c80: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00014c90: 2078 692c 2079 6920 3d20 7365 6c66 2e69   xi, yi = self.i
-00014ca0: 6e74 6572 696f 722e 782c 2073 656c 662e  nterior.x, self.
-00014cb0: 696e 7465 7269 6f72 2e79 0a20 2020 2020  interior.y.     
-00014cc0: 2020 2078 652c 2079 6520 3d20 7365 6c66     xe, ye = self
-00014cd0: 2e65 6e64 2e78 2c20 7365 6c66 2e65 6e64  .end.x, self.end
-00014ce0: 2e79 0a20 2020 2020 2020 2078 732c 2079  .y.        xs, y
-00014cf0: 7320 3d20 7365 6c66 2e73 7461 7274 2e78  s = self.start.x
-00014d00: 2c20 7365 6c66 2e73 7461 7274 2e79 0a20  , self.start.y. 
-00014d10: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00014d20: 2020 2020 2020 2020 6d61 7472 6978 5f61          matrix_a
-00014d30: 203d 2076 6f6c 6d64 6c72 2e4d 6174 7269   = volmdlr.Matri
-00014d40: 7832 3228 3220 2a20 2878 7320 2d20 7869  x22(2 * (xs - xi
-00014d50: 292c 2032 202a 2028 7973 202d 2079 6929  ), 2 * (ys - yi)
-00014d60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d80: 2020 2020 2020 2020 2020 3220 2a20 2878            2 * (x
-00014d90: 7320 2d20 7865 292c 2032 202a 2028 7973  s - xe), 2 * (ys
-00014da0: 202d 2079 6529 290a 2020 2020 2020 2020   - ye)).        
-00014db0: 2020 2020 625f 7665 6374 6f72 203d 202d      b_vector = -
-00014dc0: 2076 6f6c 6d64 6c72 2e56 6563 746f 7232   volmdlr.Vector2
-00014dd0: 4428 7869 202a 2a20 3220 2b20 7969 202a  D(xi ** 2 + yi *
-00014de0: 2a20 3220 2d20 7873 202a 2a20 3220 2d20  * 2 - xs ** 2 - 
-00014df0: 7973 202a 2a20 322c 0a20 2020 2020 2020  ys ** 2,.       
-00014e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e20: 2020 2078 6520 2a2a 2032 202b 2079 6520     xe ** 2 + ye 
-00014e30: 2a2a 2032 202d 2078 7320 2a2a 2032 202d  ** 2 - xs ** 2 -
-00014e40: 2079 7320 2a2a 2032 290a 2020 2020 2020   ys ** 2).      
-00014e50: 2020 2020 2020 696e 765f 6d61 7472 6978        inv_matrix
-00014e60: 5f61 203d 206d 6174 7269 785f 612e 696e  _a = matrix_a.in
-00014e70: 7665 7273 6528 290a 2020 2020 2020 2020  verse().        
-00014e80: 2020 2020 7820 3d20 696e 765f 6d61 7472      x = inv_matr
-00014e90: 6978 5f61 2e76 6563 746f 725f 6d75 6c74  ix_a.vector_mult
-00014ea0: 6970 6c69 6361 7469 6f6e 2862 5f76 6563  iplication(b_vec
-00014eb0: 746f 7229 0a20 2020 2020 2020 2020 2020  tor).           
-00014ec0: 2063 656e 7465 7220 3d20 766f 6c6d 646c   center = volmdl
-00014ed0: 722e 506f 696e 7432 4428 782e 782c 2078  r.Point2D(x.x, x
-00014ee0: 2e79 290a 2020 2020 2020 2020 6578 6365  .y).        exce
-00014ef0: 7074 2056 616c 7565 4572 726f 723a 0a20  pt ValueError:. 
-00014f00: 2020 2020 2020 2020 2020 206d 6174 7269             matri
-00014f10: 785f 6120 3d20 6e70 792e 6172 7261 7928  x_a = npy.array(
-00014f20: 5b5b 3220 2a20 2878 7320 2d20 7869 292c  [[2 * (xs - xi),
-00014f30: 2032 202a 2028 7973 202d 2079 6929 5d2c   2 * (ys - yi)],
-00014f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f60: 2020 205b 3220 2a20 2878 7320 2d20 7865     [2 * (xs - xe
-00014f70: 292c 2032 202a 2028 7973 202d 2079 6529  ), 2 * (ys - ye)
-00014f80: 5d5d 290a 2020 2020 2020 2020 2020 2020  ]]).            
-00014f90: 625f 7665 6374 6f72 203d 202d 206e 7079  b_vector = - npy
-00014fa0: 2e61 7272 6179 285b 7869 202a 2a20 3220  .array([xi ** 2 
-00014fb0: 2b20 7969 202a 2a20 3220 2d20 7873 202a  + yi ** 2 - xs *
-00014fc0: 2a20 3220 2d20 7973 202a 2a20 322c 0a20  * 2 - ys ** 2,. 
-00014fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ff0: 2020 2078 6520 2a2a 2032 202b 2079 6520     xe ** 2 + ye 
-00015000: 2a2a 2032 202d 2078 7320 2a2a 2032 202d  ** 2 - xs ** 2 -
-00015010: 2079 7320 2a2a 2032 5d29 0a20 2020 2020   ys ** 2]).     
-00015020: 2020 2020 2020 2063 656e 7465 7220 3d20         center = 
-00015030: 766f 6c6d 646c 722e 506f 696e 7432 4428  volmdlr.Point2D(
-00015040: 2a6e 7079 2e6c 696e 616c 672e 736f 6c76  *npy.linalg.solv
-00015050: 6528 6d61 7472 6978 5f61 2c20 625f 7665  e(matrix_a, b_ve
-00015060: 6374 6f72 2929 0a20 2020 2020 2020 2072  ctor)).        r
-00015070: 6574 7572 6e20 6365 6e74 6572 0a0a 2020  eturn center..  
-00015080: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00015090: 6465 6620 6973 5f74 7269 676f 2873 656c  def is_trigo(sel
-000150a0: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-000150b0: 2020 2020 2020 2020 4769 7665 7320 6966          Gives if
-000150c0: 2074 6865 2065 6467 6520 676f 6573 2069   the edge goes i
-000150d0: 6e20 7468 6520 7472 6967 6f20 6469 7265  n the trigo dire
-000150e0: 6374 696f 6e2e 0a20 2020 2020 2020 2022  ction..        "
-000150f0: 2222 0a20 2020 2020 2020 2069 6620 6e6f  "".        if no
-00015100: 7420 7365 6c66 2e5f 6973 5f74 7269 676f  t self._is_trigo
-00015110: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00015120: 6c66 2e5f 6973 5f74 7269 676f 203d 2073  lf._is_trigo = s
-00015130: 656c 662e 6765 745f 6172 635f 6469 7265  elf.get_arc_dire
-00015140: 6374 696f 6e28 290a 2020 2020 2020 2020  ction().        
-00015150: 7265 7475 726e 2073 656c 662e 5f69 735f  return self._is_
-00015160: 7472 6967 6f0a 0a20 2020 2040 7072 6f70  trigo..    @prop
-00015170: 6572 7479 0a20 2020 2064 6566 2063 6c6f  erty.    def clo
-00015180: 636b 7769 7365 5f61 6e64 5f74 7269 676f  ckwise_and_trigo
-00015190: 7769 7365 5f70 6174 6873 2873 656c 6629  wise_paths(self)
-000151a0: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
-000151b0: 2073 656c 662e 5f63 6c6f 636b 7769 7365   self._clockwise
-000151c0: 5f61 6e64 5f74 7269 676f 7769 7365 5f70  _and_trigowise_p
-000151d0: 6174 6873 3a0a 2020 2020 2020 2020 2020  aths:.          
-000151e0: 2020 7261 6469 7573 5f31 203d 2073 656c    radius_1 = sel
-000151f0: 662e 7374 6172 7420 2d20 7365 6c66 2e63  f.start - self.c
-00015200: 656e 7465 720a 2020 2020 2020 2020 2020  enter.          
-00015210: 2020 7261 6469 7573 5f32 203d 2073 656c    radius_2 = sel
-00015220: 662e 656e 6420 2d20 7365 6c66 2e63 656e  f.end - self.cen
-00015230: 7465 720a 2020 2020 2020 2020 2020 2020  ter.            
-00015240: 7261 6469 7573 5f69 203d 2073 656c 662e  radius_i = self.
-00015250: 696e 7465 7269 6f72 202d 2073 656c 662e  interior - self.
-00015260: 6365 6e74 6572 0a20 2020 2020 2020 2020  center.         
-00015270: 2020 2073 656c 662e 5f63 6c6f 636b 7769     self._clockwi
-00015280: 7365 5f61 6e64 5f74 7269 676f 7769 7365  se_and_trigowise
-00015290: 5f70 6174 6873 203d 5c0a 2020 2020 2020  _paths =\.      
-000152a0: 2020 2020 2020 2020 2020 7365 6c66 2e67            self.g
-000152b0: 6574 5f63 6c6f 636b 7769 7365 5f61 6e64  et_clockwise_and
-000152c0: 5f74 7269 676f 7769 7365 5f70 6174 6873  _trigowise_paths
-000152d0: 2872 6164 6975 735f 312c 0a20 2020 2020  (radius_1,.     
-000152e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000152f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015310: 2020 7261 6469 7573 5f32 2c0a 2020 2020    radius_2,.    
-00015320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015350: 2020 2072 6164 6975 735f 6929 0a20 2020     radius_i).   
-00015360: 2020 2020 2020 2020 2073 656c 662e 5f75           self._u
-00015370: 7464 5f63 6c6f 636b 7769 7365 5f61 6e64  td_clockwise_and
-00015380: 5f74 7269 676f 7769 7365 5f70 6174 6873  _trigowise_paths
-00015390: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
-000153a0: 7265 7475 726e 2073 656c 662e 5f63 6c6f  return self._clo
-000153b0: 636b 7769 7365 5f61 6e64 5f74 7269 676f  ckwise_and_trigo
-000153c0: 7769 7365 5f70 6174 6873 0a0a 2020 2020  wise_paths..    
-000153d0: 6465 6620 6765 745f 6172 635f 6469 7265  def get_arc_dire
-000153e0: 6374 696f 6e28 7365 6c66 293a 0a20 2020  ction(self):.   
-000153f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00015400: 2047 6574 7320 6172 6320 6469 7265 6374   Gets arc direct
-00015410: 696f 6e3a 2063 6c6f 636b 7769 7365 206f  ion: clockwise o
-00015420: 7220 7472 6967 6f6e 6f6d 6574 7269 632e  r trigonometric.
-00015430: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00015440: 6e3a 2054 7275 6520 6966 2063 6c6f 636b  n: True if clock
-00015450: 7769 7365 2e20 7472 6967 6f77 6973 6520  wise. trigowise 
-00015460: 6966 2046 616c 7365 2e0a 2020 2020 2020  if False..      
-00015470: 2020 2222 220a 2020 2020 2020 2020 636c    """.        cl
-00015480: 6f63 6b77 6973 655f 7061 7468 2c20 7472  ockwise_path, tr
-00015490: 6967 6f77 6973 655f 7061 7468 203d 5c0a  igowise_path =\.
-000154a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000154b0: 2e63 6c6f 636b 7769 7365 5f61 6e64 5f74  .clockwise_and_t
-000154c0: 7269 676f 7769 7365 5f70 6174 6873 0a20  rigowise_paths. 
-000154d0: 2020 2020 2020 2069 6620 636c 6f63 6b77         if clockw
-000154e0: 6973 655f 7061 7468 203e 2074 7269 676f  ise_path > trigo
-000154f0: 7769 7365 5f70 6174 683a 0a20 2020 2020  wise_path:.     
-00015500: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-00015510: 7565 0a20 2020 2020 2020 2072 6574 7572  ue.        retur
-00015520: 6e20 4661 6c73 650a 0a20 2020 2040 7072  n False..    @pr
-00015530: 6f70 6572 7479 0a20 2020 2064 6566 2061  operty.    def a
-00015540: 6e67 6c65 2873 656c 6629 3a0a 2020 2020  ngle(self):.    
-00015550: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00015560: 5265 7475 726e 7320 7468 6520 616e 676c  Returns the angl
-00015570: 6520 696e 2072 6164 6961 6e73 206f 6620  e in radians of 
-00015580: 7468 6520 6172 632e 0a20 2020 2020 2020  the arc..       
-00015590: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-000155a0: 6e6f 7420 7365 6c66 2e5f 616e 676c 653a  not self._angle:
-000155b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000155c0: 662e 5f61 6e67 6c65 203d 2073 656c 662e  f._angle = self.
-000155d0: 6765 745f 616e 676c 6528 290a 2020 2020  get_angle().    
-000155e0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000155f0: 5f61 6e67 6c65 0a0a 2020 2020 6465 6620  _angle..    def 
-00015600: 6765 745f 616e 676c 6528 7365 6c66 293a  get_angle(self):
-00015610: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00015620: 2020 2020 2047 6574 7320 6172 6320 616e       Gets arc an
-00015630: 676c 652e 0a0a 2020 2020 2020 2020 2222  gle...        ""
-00015640: 220a 2020 2020 2020 2020 636c 6f63 6b77  ".        clockw
-00015650: 6973 655f 7061 7468 2c20 7472 6967 6f77  ise_path, trigow
-00015660: 6973 655f 7061 7468 203d 205c 0a20 2020  ise_path = \.   
-00015670: 2020 2020 2020 2020 2073 656c 662e 636c           self.cl
-00015680: 6f63 6b77 6973 655f 616e 645f 7472 6967  ockwise_and_trig
-00015690: 6f77 6973 655f 7061 7468 730a 2020 2020  owise_paths.    
-000156a0: 2020 2020 6966 2073 656c 662e 6973 5f74      if self.is_t
-000156b0: 7269 676f 3a0a 2020 2020 2020 2020 2020  rigo:.          
-000156c0: 2020 7265 7475 726e 2074 7269 676f 7769    return trigowi
-000156d0: 7365 5f70 6174 680a 2020 2020 2020 2020  se_path.        
-000156e0: 7265 7475 726e 2063 6c6f 636b 7769 7365  return clockwise
-000156f0: 5f70 6174 680a 0a20 2020 2064 6566 205f  _path..    def _
-00015700: 6765 745f 706f 696e 7473 2873 656c 6629  get_points(self)
-00015710: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00015720: 205b 7365 6c66 2e73 7461 7274 2c20 7365   [self.start, se
-00015730: 6c66 2e69 6e74 6572 696f 722c 2073 656c  lf.interior, sel
-00015740: 662e 656e 645d 0a0a 2020 2020 706f 696e  f.end]..    poin
-00015750: 7473 203d 2070 726f 7065 7274 7928 5f67  ts = property(_g
-00015760: 6574 5f70 6f69 6e74 7329 0a0a 2020 2020  et_points)..    
-00015770: 6465 6620 706f 696e 745f 6469 7374 616e  def point_distan
-00015780: 6365 2873 656c 662c 2070 6f69 6e74 293a  ce(self, point):
-00015790: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000157a0: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
-000157b0: 2064 6973 7461 6e63 6520 6265 7477 6565   distance betwee
-000157c0: 6e20 6120 706f 696e 7420 616e 6420 7468  n a point and th
-000157d0: 6520 6564 6765 2e0a 2020 2020 2020 2020  e edge..        
-000157e0: 2222 220a 2020 2020 2020 2020 7665 6374  """.        vect
-000157f0: 6f72 5f73 7461 7274 203d 2073 656c 662e  or_start = self.
-00015800: 7374 6172 7420 2d20 7365 6c66 2e63 656e  start - self.cen
-00015810: 7465 720a 2020 2020 2020 2020 7665 6374  ter.        vect
-00015820: 6f72 5f70 6f69 6e74 203d 2070 6f69 6e74  or_point = point
-00015830: 202d 2073 656c 662e 6365 6e74 6572 0a20   - self.center. 
-00015840: 2020 2020 2020 2076 6563 746f 725f 656e         vector_en
-00015850: 6420 3d20 7365 6c66 2e65 6e64 202d 2073  d = self.end - s
-00015860: 656c 662e 6365 6e74 6572 0a20 2020 2020  elf.center.     
-00015870: 2020 2069 6620 7365 6c66 2e69 735f 7472     if self.is_tr
-00015880: 6967 6f3a 0a20 2020 2020 2020 2020 2020  igo:.           
-00015890: 2076 6563 746f 725f 7374 6172 742c 2076   vector_start, v
-000158a0: 6563 746f 725f 656e 6420 3d20 7665 6374  ector_end = vect
-000158b0: 6f72 5f65 6e64 2c20 7665 6374 6f72 5f73  or_end, vector_s
-000158c0: 7461 7274 0a20 2020 2020 2020 2061 7263  tart.        arc
-000158d0: 5f61 6e67 6c65 203d 2076 6f6c 6d64 6c72  _angle = volmdlr
-000158e0: 2e67 656f 6d65 7472 792e 636c 6f63 6b77  .geometry.clockw
-000158f0: 6973 655f 616e 676c 6528 7665 6374 6f72  ise_angle(vector
-00015900: 5f73 7461 7274 2c20 7665 6374 6f72 5f65  _start, vector_e
-00015910: 6e64 290a 2020 2020 2020 2020 706f 696e  nd).        poin
-00015920: 745f 616e 676c 6520 3d20 766f 6c6d 646c  t_angle = volmdl
-00015930: 722e 6765 6f6d 6574 7279 2e63 6c6f 636b  r.geometry.clock
-00015940: 7769 7365 5f61 6e67 6c65 2876 6563 746f  wise_angle(vecto
-00015950: 725f 7374 6172 742c 2076 6563 746f 725f  r_start, vector_
-00015960: 706f 696e 7429 0a20 2020 2020 2020 2069  point).        i
-00015970: 6620 706f 696e 745f 616e 676c 6520 3c3d  f point_angle <=
-00015980: 2061 7263 5f61 6e67 6c65 3a0a 2020 2020   arc_angle:.    
-00015990: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-000159a0: 6273 280a 2020 2020 2020 2020 2020 2020  bs(.            
-000159b0: 2020 2020 4c69 6e65 5365 676d 656e 7432      LineSegment2
-000159c0: 4428 706f 696e 742c 2073 656c 662e 6365  D(point, self.ce
-000159d0: 6e74 6572 292e 6c65 6e67 7468 2829 202d  nter).length() -
-000159e0: 2073 656c 662e 7261 6469 7573 290a 2020   self.radius).  
-000159f0: 2020 2020 2020 7265 7475 726e 206d 696e        return min
-00015a00: 284c 696e 6553 6567 6d65 6e74 3244 2870  (LineSegment2D(p
-00015a10: 6f69 6e74 2c20 7365 6c66 2e73 7461 7274  oint, self.start
-00015a20: 292e 6c65 6e67 7468 2829 2c20 4c69 6e65  ).length(), Line
-00015a30: 5365 676d 656e 7432 4428 706f 696e 742c  Segment2D(point,
-00015a40: 2073 656c 662e 656e 6429 2e6c 656e 6774   self.end).lengt
-00015a50: 6828 2929 0a0a 2020 2020 6465 6620 706f  h())..    def po
-00015a60: 696e 745f 6265 6c6f 6e67 7328 7365 6c66  int_belongs(self
-00015a70: 2c20 706f 696e 7432 642c 2061 6273 5f74  , point2d, abs_t
-00015a80: 6f6c 3d31 652d 3130 293a 0a20 2020 2020  ol=1e-10):.     
-00015a90: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-00015aa0: 6865 636b 2069 6620 6120 506f 696e 7432  heck if a Point2
-00015ab0: 4420 6265 6c6f 6e67 7320 746f 2074 6865  D belongs to the
-00015ac0: 2041 7263 3244 2e0a 0a20 2020 2020 2020   Arc2D...       
-00015ad0: 2022 2222 0a20 2020 2020 2020 2064 6973   """.        dis
-00015ae0: 7461 6e63 655f 706f 696e 745f 746f 5f63  tance_point_to_c
-00015af0: 656e 7465 7220 3d20 706f 696e 7432 642e  enter = point2d.
-00015b00: 706f 696e 745f 6469 7374 616e 6365 2873  point_distance(s
-00015b10: 656c 662e 6365 6e74 6572 290a 2020 2020  elf.center).    
-00015b20: 2020 2020 6966 206e 6f74 206d 6174 682e      if not math.
-00015b30: 6973 636c 6f73 6528 6469 7374 616e 6365  isclose(distance
-00015b40: 5f70 6f69 6e74 5f74 6f5f 6365 6e74 6572  _point_to_center
-00015b50: 2c20 7365 6c66 2e72 6164 6975 732c 2061  , self.radius, a
-00015b60: 6273 5f74 6f6c 3d61 6273 5f74 6f6c 293a  bs_tol=abs_tol):
-00015b70: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00015b80: 7572 6e20 4661 6c73 650a 2020 2020 2020  urn False.      
-00015b90: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00015ba0: 2020 2070 6f69 6e74 5f61 6273 6369 7373     point_absciss
-00015bb0: 6120 3d20 7365 6c66 2e61 6273 6369 7373  a = self.absciss
-00015bc0: 6128 706f 696e 7432 6429 0a20 2020 2020  a(point2d).     
-00015bd0: 2020 2065 7863 6570 7420 5661 6c75 6545     except ValueE
-00015be0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
-00015bf0: 2020 7265 7475 726e 2046 616c 7365 0a20    return False. 
-00015c00: 2020 2020 2020 2069 6620 7365 6c66 2e6c         if self.l
-00015c10: 656e 6774 6828 2920 3e3d 2070 6f69 6e74  ength() >= point
-00015c20: 5f61 6273 6369 7373 6120 3e3d 2030 3a0a  _abscissa >= 0:.
-00015c30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00015c40: 726e 2054 7275 650a 2020 2020 2020 2020  rn True.        
-00015c50: 7265 7475 726e 2046 616c 7365 0a0a 2020  return False..  
-00015c60: 2020 6465 6620 746f 5f66 756c 6c5f 6172    def to_full_ar
-00015c70: 635f 3264 2873 656c 6629 3a0a 2020 2020  c_2d(self):.    
-00015c80: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00015c90: 436f 6e76 6572 7420 746f 2061 2066 756c  Convert to a ful
-00015ca0: 6c20 6172 6332 642e 0a20 2020 2020 2020  l arc2d..       
-00015cb0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-00015cc0: 7572 6e20 4675 6c6c 4172 6332 4428 6365  urn FullArc2D(ce
-00015cd0: 6e74 6572 3d73 656c 662e 6365 6e74 6572  nter=self.center
-00015ce0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015cf0: 2020 2020 2020 2020 2020 2073 7461 7274             start
-00015d00: 5f65 6e64 3d73 656c 662e 706f 696e 745f  _end=self.point_
-00015d10: 6174 5f61 6273 6369 7373 6128 3029 2c0a  at_abscissa(0),.
-00015d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d30: 2020 2020 2020 2020 206e 616d 653d 7365           name=se
-00015d40: 6c66 2e6e 616d 6529 0a0a 2020 2020 6465  lf.name)..    de
-00015d50: 6620 6c69 6e65 5f69 6e74 6572 7365 6374  f line_intersect
-00015d60: 696f 6e73 2873 656c 662c 206c 696e 6532  ions(self, line2
-00015d70: 643a 204c 696e 6532 4429 3a0a 2020 2020  d: Line2D):.    
-00015d80: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00015d90: 4361 6c63 756c 6174 6573 2074 6865 2069  Calculates the i
-00015da0: 6e74 6572 7365 6374 696f 6e20 6265 7477  ntersection betw
-00015db0: 6565 6e20 6120 6c69 6e65 2061 6e64 2061  een a line and a
-00015dc0: 6e20 4172 6332 442e 0a0a 2020 2020 2020  n Arc2D...      
-00015dd0: 2020 3a70 6172 616d 206c 696e 6532 643a    :param line2d:
-00015de0: 204c 696e 6532 4420 746f 2076 6572 6966   Line2D to verif
-00015df0: 7920 696e 7465 7273 6563 7469 6f6e 732e  y intersections.
-00015e00: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00015e10: 3a20 6120 6c69 7374 2077 6974 6820 696e  : a list with in
-00015e20: 7465 7273 6563 7469 6f6e 7320 706f 696e  tersections poin
-00015e30: 7473 2e0a 2020 2020 2020 2020 2222 220a  ts..        """.
-00015e40: 2020 2020 2020 2020 2320 6369 7263 6c65          # circle
-00015e50: 203d 2073 656c 662e 746f 5f63 6972 636c   = self.to_circl
-00015e60: 6528 290a 2020 2020 2020 2020 2320 6369  e().        # ci
-00015e70: 7263 6c65 5f69 6e74 6572 7365 6374 696f  rcle_intersectio
-00015e80: 6e5f 706f 696e 7473 203d 2063 6972 636c  n_points = circl
-00015e90: 652e 6c69 6e65 5f69 6e74 6572 7365 6374  e.line_intersect
-00015ea0: 696f 6e73 286c 696e 6532 6429 0a20 2020  ions(line2d).   
-00015eb0: 2020 2020 2066 756c 6c5f 6172 635f 3264       full_arc_2d
-00015ec0: 203d 2073 656c 662e 746f 5f66 756c 6c5f   = self.to_full_
-00015ed0: 6172 635f 3264 2829 0a20 2020 2020 2020  arc_2d().       
-00015ee0: 2066 6132 645f 696e 7465 7273 6563 7469   fa2d_intersecti
-00015ef0: 6f6e 5f70 6f69 6e74 7320 3d20 6675 6c6c  on_points = full
-00015f00: 5f61 7263 5f32 642e 6c69 6e65 5f69 6e74  _arc_2d.line_int
-00015f10: 6572 7365 6374 696f 6e73 286c 696e 6532  ersections(line2
-00015f20: 6429 0a20 2020 2020 2020 2069 6e74 6572  d).        inter
-00015f30: 7365 6374 696f 6e5f 706f 696e 7473 203d  section_points =
-00015f40: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
-00015f50: 7074 2069 6e20 6661 3264 5f69 6e74 6572  pt in fa2d_inter
-00015f60: 7365 6374 696f 6e5f 706f 696e 7473 3a0a  section_points:.
-00015f70: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00015f80: 656c 662e 706f 696e 745f 6265 6c6f 6e67  elf.point_belong
-00015f90: 7328 7074 293a 0a20 2020 2020 2020 2020  s(pt):.         
-00015fa0: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
-00015fb0: 696f 6e5f 706f 696e 7473 2e61 7070 656e  ion_points.appen
-00015fc0: 6428 7074 290a 2020 2020 2020 2020 7265  d(pt).        re
-00015fd0: 7475 726e 2069 6e74 6572 7365 6374 696f  turn intersectio
-00015fe0: 6e5f 706f 696e 7473 0a0a 2020 2020 6465  n_points..    de
-00015ff0: 6620 6c69 6e65 7365 676d 656e 745f 696e  f linesegment_in
-00016000: 7465 7273 6563 7469 6f6e 7328 7365 6c66  tersections(self
-00016010: 2c20 6c69 6e65 7365 676d 656e 7432 643a  , linesegment2d:
-00016020: 204c 696e 6553 6567 6d65 6e74 3244 293a   LineSegment2D):
-00016030: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00016040: 2020 2020 2043 616c 6375 6c61 7465 7320       Calculates 
-00016050: 7468 6520 696e 7465 7273 6563 7469 6f6e  the intersection
-00016060: 2062 6574 7765 656e 2061 204c 696e 6553   between a LineS
-00016070: 6567 6d65 6e74 3244 2061 6e64 2061 6e20  egment2D and an 
-00016080: 4172 6332 442e 0a0a 2020 2020 2020 2020  Arc2D...        
-00016090: 3a70 6172 616d 206c 696e 6532 643a 204c  :param line2d: L
-000160a0: 696e 6553 6567 6d65 6e74 3244 2074 6f20  ineSegment2D to 
-000160b0: 7665 7269 6679 2069 6e74 6572 7365 6374  verify intersect
-000160c0: 696f 6e73 2e0a 2020 2020 2020 2020 3a72  ions..        :r
-000160d0: 6574 7572 6e3a 2061 206c 6973 7420 7769  eturn: a list wi
-000160e0: 7468 2069 6e74 6572 7365 6374 696f 6e73  th intersections
-000160f0: 2070 6f69 6e74 732e 0a20 2020 2020 2020   points..       
-00016100: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-00016110: 6e6f 7420 7365 6c66 2e62 6f75 6e64 696e  not self.boundin
-00016120: 675f 7265 6374 616e 676c 652e 625f 7265  g_rectangle.b_re
-00016130: 6374 616e 676c 655f 696e 7465 7273 6563  ctangle_intersec
-00016140: 7469 6f6e 286c 696e 6573 6567 6d65 6e74  tion(linesegment
-00016150: 3264 2e62 6f75 6e64 696e 675f 7265 6374  2d.bounding_rect
-00016160: 616e 676c 6529 3a0a 2020 2020 2020 2020  angle):.        
-00016170: 2020 2020 7265 7475 726e 205b 5d0a 2020      return [].  
-00016180: 2020 2020 2020 6675 6c6c 5f61 7263 5f32        full_arc_2
-00016190: 6420 3d20 7365 6c66 2e74 6f5f 6675 6c6c  d = self.to_full
-000161a0: 5f61 7263 5f32 6428 290a 2020 2020 2020  _arc_2d().      
-000161b0: 2020 6661 3264 5f69 6e74 6572 7365 6374    fa2d_intersect
-000161c0: 696f 6e5f 706f 696e 7473 203d 2066 756c  ion_points = ful
-000161d0: 6c5f 6172 635f 3264 2e6c 696e 6573 6567  l_arc_2d.lineseg
-000161e0: 6d65 6e74 5f69 6e74 6572 7365 6374 696f  ment_intersectio
-000161f0: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-00016200: 6c69 6e65 7365 676d 656e 7432 6429 0a20  linesegment2d). 
-00016210: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
-00016220: 696f 6e5f 706f 696e 7473 203d 205b 5d0a  ion_points = [].
-00016230: 2020 2020 2020 2020 666f 7220 7074 2069          for pt i
-00016240: 6e20 6661 3264 5f69 6e74 6572 7365 6374  n fa2d_intersect
-00016250: 696f 6e5f 706f 696e 7473 3a0a 2020 2020  ion_points:.    
-00016260: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00016270: 706f 696e 745f 6265 6c6f 6e67 7328 7074  point_belongs(pt
-00016280: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00016290: 2020 2069 6e74 6572 7365 6374 696f 6e5f     intersection_
-000162a0: 706f 696e 7473 2e61 7070 656e 6428 7074  points.append(pt
-000162b0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000162c0: 2069 6e74 6572 7365 6374 696f 6e5f 706f   intersection_po
-000162d0: 696e 7473 0a0a 2020 2020 6465 6620 6162  ints..    def ab
-000162e0: 7363 6973 7361 2873 656c 662c 2070 6f69  scissa(self, poi
-000162f0: 6e74 3264 3a20 766f 6c6d 646c 722e 506f  nt2d: volmdlr.Po
-00016300: 696e 7432 442c 2074 6f6c 3d31 652d 3929  int2D, tol=1e-9)
-00016310: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00016320: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
-00016330: 6520 6162 7363 6973 7361 206f 6620 6120  e abscissa of a 
-00016340: 6769 7665 6e20 706f 696e 7432 642e 0a20  given point2d.. 
-00016350: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00016360: 2020 2069 6620 706f 696e 7432 642e 706f     if point2d.po
-00016370: 696e 745f 6469 7374 616e 6365 2873 656c  int_distance(sel
-00016380: 662e 7374 6172 7429 203c 2074 6f6c 3a0a  f.start) < tol:.
-00016390: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000163a0: 726e 2030 0a20 2020 2020 2020 2069 6620  rn 0.        if 
-000163b0: 706f 696e 7432 642e 706f 696e 745f 6469  point2d.point_di
-000163c0: 7374 616e 6365 2873 656c 662e 656e 6429  stance(self.end)
-000163d0: 203c 2074 6f6c 3a0a 2020 2020 2020 2020   < tol:.        
-000163e0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000163f0: 6c65 6e67 7468 2829 0a0a 2020 2020 2020  length()..      
-00016400: 2020 7020 3d20 706f 696e 7432 6420 2d20    p = point2d - 
-00016410: 7365 6c66 2e63 656e 7465 720a 2020 2020  self.center.    
-00016420: 2020 2020 7520 3d20 7365 6c66 2e73 7461      u = self.sta
-00016430: 7274 202d 2073 656c 662e 6365 6e74 6572  rt - self.center
-00016440: 0a20 2020 2020 2020 2075 2e6e 6f72 6d61  .        u.norma
-00016450: 6c69 7a65 2829 0a20 2020 2020 2020 2069  lize().        i
-00016460: 6620 7365 6c66 2e69 735f 7472 6967 6f3a  f self.is_trigo:
-00016470: 0a20 2020 2020 2020 2020 2020 2076 203d  .            v =
-00016480: 2075 2e6e 6f72 6d61 6c5f 7665 6374 6f72   u.normal_vector
-00016490: 2829 0a20 2020 2020 2020 2065 6c73 653a  ().        else:
-000164a0: 0a20 2020 2020 2020 2020 2020 2076 203d  .            v =
-000164b0: 202d 752e 6e6f 726d 616c 5f76 6563 746f   -u.normal_vecto
-000164c0: 7228 290a 0a20 2020 2020 2020 2078 2c20  r()..        x, 
-000164d0: 7920 3d20 702e 646f 7428 7529 2c20 702e  y = p.dot(u), p.
-000164e0: 646f 7428 7629 0a20 2020 2020 2020 2074  dot(v).        t
-000164f0: 6865 7461 203d 206d 6174 682e 6174 616e  heta = math.atan
-00016500: 3228 792c 2078 290a 2020 2020 2020 2020  2(y, x).        
-00016510: 6966 2074 6865 7461 203c 202d 746f 6c20  if theta < -tol 
-00016520: 6f72 2074 6865 7461 203e 2073 656c 662e  or theta > self.
-00016530: 616e 676c 6520 2b20 746f 6c3a 0a20 2020  angle + tol:.   
-00016540: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00016550: 616c 7565 4572 726f 7228 2750 6f69 6e74  alueError('Point
-00016560: 206e 6f74 2069 6e20 6172 6327 290a 0a20   not in arc').. 
-00016570: 2020 2020 2020 2069 6620 7468 6574 6120         if theta 
-00016580: 3c20 303a 0a20 2020 2020 2020 2020 2020  < 0:.           
-00016590: 2072 6574 7572 6e20 302e 0a20 2020 2020   return 0..     
-000165a0: 2020 2069 6620 7468 6574 6120 3e20 7365     if theta > se
-000165b0: 6c66 2e61 6e67 6c65 3a0a 2020 2020 2020  lf.angle:.      
-000165c0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000165d0: 662e 616e 676c 6520 2a20 7365 6c66 2e72  f.angle * self.r
-000165e0: 6164 6975 730a 0a20 2020 2020 2020 2072  adius..        r
-000165f0: 6574 7572 6e20 7365 6c66 2e72 6164 6975  eturn self.radiu
-00016600: 7320 2a20 7468 6574 610a 0a20 2020 2064  s * theta..    d
-00016610: 6566 2064 6972 6563 7469 6f6e 5f76 6563  ef direction_vec
-00016620: 746f 7228 7365 6c66 2c20 6162 7363 6973  tor(self, abscis
-00016630: 7361 3a20 666c 6f61 7429 3a0a 2020 2020  sa: float):.    
-00016640: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00016650: 4765 7420 6469 7265 6374 696f 6e20 7665  Get direction ve
-00016660: 6374 6f72 206f 6620 7468 6520 4172 6332  ctor of the Arc2
-00016670: 442e 0a0a 2020 2020 2020 2020 3a70 6172  D...        :par
-00016680: 616d 2061 6273 6369 7373 613a 2064 6566  am abscissa: def
-00016690: 696e 6573 2077 6865 7265 2069 6e20 7468  ines where in th
-000166a0: 6520 4172 6332 4420 7468 650a 2020 2020  e Arc2D the.    
-000166b0: 2020 2020 6469 7265 6374 696f 6e20 7665      direction ve
-000166c0: 6374 6f72 2069 7320 746f 2062 6520 6361  ctor is to be ca
-000166d0: 6c63 756c 6174 6564 0a20 2020 2020 2020  lculated.       
-000166e0: 203a 7265 7475 726e 3a20 5468 6520 6469   :return: The di
-000166f0: 7265 6374 696f 6e20 7665 6374 6f72 206f  rection vector o
-00016700: 6620 7468 6520 4172 6332 440a 2020 2020  f the Arc2D.    
-00016710: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00016720: 7265 7475 726e 202d 7365 6c66 2e6e 6f72  return -self.nor
-00016730: 6d61 6c5f 7665 6374 6f72 2861 6273 6369  mal_vector(absci
-00016740: 7373 613d 6162 7363 6973 7361 292e 6e6f  ssa=abscissa).no
-00016750: 726d 616c 5f76 6563 746f 7228 290a 0a20  rmal_vector().. 
-00016760: 2020 2064 6566 2075 6e69 745f 6469 7265     def unit_dire
-00016770: 6374 696f 6e5f 7665 6374 6f72 2873 656c  ction_vector(sel
-00016780: 662c 2061 6273 6369 7373 613a 2066 6c6f  f, abscissa: flo
-00016790: 6174 293a 0a20 2020 2020 2020 2022 2222  at):.        """
-000167a0: 0a20 2020 2020 2020 2047 6574 2075 6e69  .        Get uni
-000167b0: 7420 6469 7265 6374 696f 6e20 7665 6374  t direction vect
-000167c0: 6f72 206f 6620 7468 6520 4172 6332 442e  or of the Arc2D.
-000167d0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000167e0: 2061 6273 6369 7373 613a 2064 6566 696e   abscissa: defin
-000167f0: 6573 2077 6865 7265 2069 6e20 7468 6520  es where in the 
-00016800: 4172 6332 4420 7468 650a 2020 2020 2020  Arc2D the.      
-00016810: 2020 756e 6974 2064 6972 6563 7469 6f6e    unit direction
-00016820: 2076 6563 746f 7220 6973 2074 6f20 6265   vector is to be
-00016830: 2063 616c 6375 6c61 7465 640a 0a20 2020   calculated..   
-00016840: 2020 2020 203a 7265 7475 726e 3a20 5468       :return: Th
-00016850: 6520 756e 6974 2064 6972 6563 7469 6f6e  e unit direction
-00016860: 2076 6563 746f 7220 6f66 2074 6865 2041   vector of the A
-00016870: 7263 3244 0a20 2020 2020 2020 2022 2222  rc2D.        """
-00016880: 0a20 2020 2020 2020 2064 6972 6563 7469  .        directi
-00016890: 6f6e 5f76 6563 746f 7220 3d20 7365 6c66  on_vector = self
-000168a0: 2e64 6972 6563 7469 6f6e 5f76 6563 746f  .direction_vecto
-000168b0: 7228 6162 7363 6973 7361 290a 2020 2020  r(abscissa).    
-000168c0: 2020 2020 6469 7265 6374 696f 6e5f 7665      direction_ve
-000168d0: 6374 6f72 2e6e 6f72 6d61 6c69 7a65 2829  ctor.normalize()
-000168e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000168f0: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
-00016900: 0a0a 2020 2020 6465 6620 6e6f 726d 616c  ..    def normal
-00016910: 5f76 6563 746f 7228 7365 6c66 2c20 6162  _vector(self, ab
-00016920: 7363 6973 7361 3a20 666c 6f61 7429 3a0a  scissa: float):.
-00016930: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00016940: 2020 2020 4765 7420 7468 6520 6e6f 726d      Get the norm
-00016950: 616c 2076 6563 746f 7220 6f66 2074 6865  al vector of the
-00016960: 2041 7263 3244 2e0a 0a20 2020 2020 2020   Arc2D...       
-00016970: 203a 7061 7261 6d20 6162 7363 6973 7361   :param abscissa
-00016980: 3a20 6465 6669 6e65 7320 7768 6572 6520  : defines where 
-00016990: 696e 2074 6865 2041 7263 3244 2074 6865  in the Arc2D the
-000169a0: 0a20 2020 2020 2020 206e 6f72 6d61 6c20  .        normal 
-000169b0: 7665 6374 6f72 2069 7320 746f 2062 6520  vector is to be 
-000169c0: 6361 6c63 756c 6174 6564 0a20 2020 2020  calculated.     
-000169d0: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
-000169e0: 6e6f 726d 616c 2076 6563 746f 7220 6f66  normal vector of
-000169f0: 2074 6865 2041 7263 3244 0a20 2020 2020   the Arc2D.     
-00016a00: 2020 2022 2222 0a20 2020 2020 2020 2070     """.        p
-00016a10: 6f69 6e74 203d 2073 656c 662e 706f 696e  oint = self.poin
-00016a20: 745f 6174 5f61 6273 6369 7373 6128 6162  t_at_abscissa(ab
-00016a30: 7363 6973 7361 290a 2020 2020 2020 2020  scissa).        
-00016a40: 2320 6966 2073 656c 662e 6973 5f74 7269  # if self.is_tri
-00016a50: 676f 3a0a 2020 2020 2020 2020 6e6f 726d  go:.        norm
-00016a60: 616c 5f76 6563 746f 7220 3d20 7365 6c66  al_vector = self
-00016a70: 2e63 656e 7465 7220 2d20 706f 696e 740a  .center - point.
-00016a80: 2020 2020 2020 2020 2320 656c 7365 3a0a          # else:.
-00016a90: 2020 2020 2020 2020 2320 2020 2020 6e6f          #     no
-00016aa0: 726d 616c 5f76 6563 746f 7220 3d20 706f  rmal_vector = po
-00016ab0: 696e 7420 2d20 7365 6c66 2e63 656e 7465  int - self.cente
-00016ac0: 720a 2020 2020 2020 2020 7265 7475 726e  r.        return
-00016ad0: 206e 6f72 6d61 6c5f 7665 6374 6f72 0a0a   normal_vector..
-00016ae0: 2020 2020 6465 6620 756e 6974 5f6e 6f72      def unit_nor
-00016af0: 6d61 6c5f 7665 6374 6f72 2873 656c 662c  mal_vector(self,
-00016b00: 2061 6273 6369 7373 613a 2066 6c6f 6174   abscissa: float
-00016b10: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00016b20: 2020 2020 2020 2047 6574 2074 6865 2075         Get the u
-00016b30: 6e69 7420 6e6f 726d 616c 2076 6563 746f  nit normal vecto
-00016b40: 7220 6f66 2074 6865 2041 7263 3244 2e0a  r of the Arc2D..
-00016b50: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00016b60: 6162 7363 6973 7361 3a20 6465 6669 6e65  abscissa: define
-00016b70: 7320 7768 6572 6520 696e 2074 6865 2041  s where in the A
-00016b80: 7263 3244 2074 6865 0a20 2020 2020 2020  rc2D the.       
-00016b90: 2075 6e69 7420 6e6f 726d 616c 2076 6563   unit normal vec
-00016ba0: 746f 7220 6973 2074 6f20 6265 2063 616c  tor is to be cal
-00016bb0: 6375 6c61 7465 640a 2020 2020 2020 2020  culated.        
-00016bc0: 3a72 6574 7572 6e3a 2054 6865 2075 6e69  :return: The uni
-00016bd0: 7420 6e6f 726d 616c 2076 6563 746f 7220  t normal vector 
-00016be0: 6f66 2074 6865 2041 7263 3244 0a20 2020  of the Arc2D.   
-00016bf0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00016c00: 206e 6f72 6d61 6c5f 7665 6374 6f72 203d   normal_vector =
-00016c10: 2073 656c 662e 6e6f 726d 616c 5f76 6563   self.normal_vec
-00016c20: 746f 7228 6162 7363 6973 7361 290a 2020  tor(abscissa).  
-00016c30: 2020 2020 2020 6e6f 726d 616c 5f76 6563        normal_vec
-00016c40: 746f 722e 6e6f 726d 616c 697a 6528 290a  tor.normalize().
-00016c50: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-00016c60: 6f72 6d61 6c5f 7665 6374 6f72 0a0a 2020  ormal_vector..  
-00016c70: 2020 6465 6620 6172 6561 2873 656c 6629    def area(self)
-00016c80: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00016c90: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
-00016ca0: 2074 6865 2061 7265 6120 6f66 2074 6865   the area of the
-00016cb0: 2041 7263 3244 2e0a 0a20 2020 2020 2020   Arc2D...       
-00016cc0: 203a 7265 7475 726e 3a20 7468 6520 6172   :return: the ar
-00016cd0: 6561 206f 6620 7468 6520 4172 6332 442e  ea of the Arc2D.
-00016ce0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00016cf0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00016d00: 2e72 6164 6975 7320 2a2a 2032 202a 2073  .radius ** 2 * s
-00016d10: 656c 662e 616e 676c 6520 2f20 320a 0a20  elf.angle / 2.. 
-00016d20: 2020 2064 6566 2063 656e 7465 725f 6f66     def center_of
-00016d30: 5f6d 6173 7328 7365 6c66 293a 0a20 2020  _mass(self):.   
-00016d40: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00016d50: 2043 616c 6375 6c61 7465 7320 7468 6520   Calculates the 
-00016d60: 6365 6e74 6572 206f 6620 6d61 7373 206f  center of mass o
-00016d70: 6620 7468 6520 4172 6332 442e 0a0a 2020  f the Arc2D...  
-00016d80: 2020 2020 2020 3a72 6574 7572 6e3a 2063        :return: c
-00016d90: 656e 7465 7220 6f66 206d 6173 7320 706f  enter of mass po
-00016da0: 696e 742e 0a20 2020 2020 2020 2022 2222  int..        """
-00016db0: 0a20 2020 2020 2020 2023 2020 2020 2020  .        #      
-00016dc0: 2020 753d 7365 6c66 2e6d 6964 646c 652e    u=self.middle.
-00016dd0: 7665 6374 6f72 2d73 656c 662e 6365 6e74  vector-self.cent
-00016de0: 6572 2e76 6563 746f 720a 2020 2020 2020  er.vector.      
-00016df0: 2020 7520 3d20 7365 6c66 2e6d 6964 646c    u = self.middl
-00016e00: 655f 706f 696e 7428 2920 2d20 7365 6c66  e_point() - self
-00016e10: 2e63 656e 7465 720a 2020 2020 2020 2020  .center.        
-00016e20: 752e 6e6f 726d 616c 697a 6528 290a 2020  u.normalize().  
-00016e30: 2020 2020 2020 2320 616c 7068 6120 3d20        # alpha = 
-00016e40: 6162 7328 7365 6c66 2e61 6e67 6c65 290a  abs(self.angle).
-00016e50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00016e60: 656c 662e 6365 6e74 6572 202b 2034 202f  elf.center + 4 /
-00016e70: 2028 3320 2a20 7365 6c66 2e61 6e67 6c65   (3 * self.angle
-00016e80: 2920 2a20 7365 6c66 2e72 6164 6975 7320  ) * self.radius 
-00016e90: 2a20 6d61 7468 2e73 696e 280a 2020 2020  * math.sin(.    
-00016ea0: 2020 2020 2020 2020 7365 6c66 2e61 6e67          self.ang
-00016eb0: 6c65 202a 2030 2e35 2920 2a20 750a 0a20  le * 0.5) * u.. 
-00016ec0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00016ed0: 2064 6566 2062 6f75 6e64 696e 675f 7265   def bounding_re
-00016ee0: 6374 616e 676c 6528 7365 6c66 293a 0a20  ctangle(self):. 
-00016ef0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00016f00: 6c66 2e5f 626f 756e 6469 6e67 5f72 6563  lf._bounding_rec
-00016f10: 7461 6e67 6c65 3a0a 2020 2020 2020 2020  tangle:.        
-00016f20: 2020 2020 6469 7363 7265 7469 7a61 7469      discretizati
-00016f30: 6f6e 5f70 6f69 6e74 7320 3d20 7365 6c66  on_points = self
-00016f40: 2e64 6973 6372 6574 697a 6174 696f 6e5f  .discretization_
-00016f50: 706f 696e 7473 286e 756d 6265 725f 706f  points(number_po
-00016f60: 696e 7473 3d32 3029 0a20 2020 2020 2020  ints=20).       
-00016f70: 2020 2020 2078 5f76 616c 7565 732c 2079       x_values, y
-00016f80: 5f76 616c 7565 7320 3d20 5b5d 2c20 5b5d  _values = [], []
-00016f90: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00016fa0: 2070 6f69 6e74 2069 6e20 6469 7363 7265   point in discre
-00016fb0: 7469 7a61 7469 6f6e 5f70 6f69 6e74 733a  tization_points:
-00016fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016fd0: 2078 5f76 616c 7565 732e 6170 7065 6e64   x_values.append
-00016fe0: 2870 6f69 6e74 2e78 290a 2020 2020 2020  (point.x).      
-00016ff0: 2020 2020 2020 2020 2020 795f 7661 6c75            y_valu
-00017000: 6573 2e61 7070 656e 6428 706f 696e 742e  es.append(point.
-00017010: 7929 0a20 2020 2020 2020 2020 2020 2073  y).            s
-00017020: 656c 662e 5f62 6f75 6e64 696e 675f 7265  elf._bounding_re
-00017030: 6374 616e 676c 6520 3d20 766f 6c6d 646c  ctangle = volmdl
-00017040: 722e 636f 7265 2e42 6f75 6e64 696e 6752  r.core.BoundingR
-00017050: 6563 7461 6e67 6c65 286d 696e 2878 5f76  ectangle(min(x_v
-00017060: 616c 7565 7329 2c20 6d61 7828 785f 7661  alues), max(x_va
-00017070: 6c75 6573 292c 0a20 2020 2020 2020 2020  lues),.         
-00017080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000170a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000170b0: 2020 2020 2020 2020 2020 2020 206d 696e               min
-000170c0: 2879 5f76 616c 7565 7329 2c20 6d61 7828  (y_values), max(
-000170d0: 795f 7661 6c75 6573 2929 0a20 2020 2020  y_values)).     
-000170e0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-000170f0: 626f 756e 6469 6e67 5f72 6563 7461 6e67  bounding_rectang
-00017100: 6c65 0a0a 2020 2020 6465 6620 7374 7261  le..    def stra
-00017110: 6967 6874 5f6c 696e 655f 6172 6561 2873  ight_line_area(s
-00017120: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00017130: 220a 2020 2020 2020 2020 4361 6c63 756c  ".        Calcul
-00017140: 6174 6573 2074 6865 2061 7265 6120 6f66  ates the area of
-00017150: 2074 6865 2061 7263 3264 2c20 7769 7468   the arc2d, with
-00017160: 206c 696e 6520 6472 6177 6e20 6672 6f6d   line drawn from
-00017170: 2073 7461 7274 2074 6f20 656e 642e 0a0a   start to end...
-00017180: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00017190: 2073 7472 6169 6768 745f 6c69 6e65 5f61   straight_line_a
-000171a0: 7265 612e 0a20 2020 2020 2020 2022 2222  rea..        """
-000171b0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-000171c0: 2e61 6e67 6c65 203e 3d20 6d61 7468 2e70  .angle >= math.p
-000171d0: 693a 0a20 2020 2020 2020 2020 2020 2061  i:.            a
-000171e0: 6e67 6c65 203d 2076 6f6c 6d64 6c72 2e54  ngle = volmdlr.T
-000171f0: 574f 5f50 4920 2d20 7365 6c66 2e61 6e67  WO_PI - self.ang
-00017200: 6c65 0a20 2020 2020 2020 2020 2020 2061  le.            a
-00017210: 7265 6120 3d20 6d61 7468 2e70 6920 2a20  rea = math.pi * 
-00017220: 7365 6c66 2e72 6164 6975 7320 2a2a 2032  self.radius ** 2
-00017230: 202d 2030 2e35 202a 2073 656c 662e 7261   - 0.5 * self.ra
-00017240: 6469 7573 202a 2a20 3220 2a20 280a 2020  dius ** 2 * (.  
-00017250: 2020 2020 2020 2020 2020 2020 2020 616e                an
-00017260: 676c 6520 2d20 6d61 7468 2e73 696e 2861  gle - math.sin(a
-00017270: 6e67 6c65 2929 0a20 2020 2020 2020 2065  ngle)).        e
-00017280: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00017290: 2061 6e67 6c65 203d 2073 656c 662e 616e   angle = self.an
-000172a0: 676c 650a 2020 2020 2020 2020 2020 2020  gle.            
-000172b0: 6172 6561 203d 2030 2e35 202a 2073 656c  area = 0.5 * sel
-000172c0: 662e 7261 6469 7573 202a 2a20 3220 2a20  f.radius ** 2 * 
-000172d0: 2861 6e67 6c65 202d 206d 6174 682e 7369  (angle - math.si
-000172e0: 6e28 616e 676c 6529 290a 0a20 2020 2020  n(angle))..     
-000172f0: 2020 2069 6620 7365 6c66 2e69 735f 7472     if self.is_tr
-00017300: 6967 6f3a 0a20 2020 2020 2020 2020 2020  igo:.           
-00017310: 2072 6574 7572 6e20 6172 6561 0a20 2020   return area.   
-00017320: 2020 2020 2072 6574 7572 6e20 2d61 7265       return -are
-00017330: 610a 0a20 2020 2064 6566 2073 7472 6169  a..    def strai
-00017340: 6768 745f 6c69 6e65 5f73 6563 6f6e 645f  ght_line_second_
-00017350: 6d6f 6d65 6e74 5f61 7265 6128 7365 6c66  moment_area(self
-00017360: 2c20 706f 696e 743a 2076 6f6c 6d64 6c72  , point: volmdlr
-00017370: 2e50 6f69 6e74 3244 293a 0a0a 2020 2020  .Point2D):..    
-00017380: 2020 2020 6966 2073 656c 662e 616e 676c      if self.angl
-00017390: 6532 203c 2073 656c 662e 616e 676c 6531  e2 < self.angle1
-000173a0: 3a0a 2020 2020 2020 2020 2020 2020 616e  :.            an
-000173b0: 676c 6532 203d 2073 656c 662e 616e 676c  gle2 = self.angl
-000173c0: 6532 202b 2076 6f6c 6d64 6c72 2e54 574f  e2 + volmdlr.TWO
-000173d0: 5f50 490a 0a20 2020 2020 2020 2065 6c73  _PI..        els
-000173e0: 653a 0a20 2020 2020 2020 2020 2020 2061  e:.            a
-000173f0: 6e67 6c65 3220 3d20 7365 6c66 2e61 6e67  ngle2 = self.ang
-00017400: 6c65 320a 2020 2020 2020 2020 616e 676c  le2.        angl
-00017410: 6531 203d 2073 656c 662e 616e 676c 6531  e1 = self.angle1
-00017420: 0a0a 2020 2020 2020 2020 2320 4675 6c6c  ..        # Full
-00017430: 2061 7263 2073 6563 7469 6f6e 0a20 2020   arc section.   
-00017440: 2020 2020 2049 7831 203d 2073 656c 662e       Ix1 = self.
-00017450: 7261 6469 7573 202a 2a20 3420 2f20 3820  radius ** 4 / 8 
-00017460: 2a20 2861 6e67 6c65 3220 2d20 616e 676c  * (angle2 - angl
-00017470: 6531 202b 2030 2e35 202a 2028 0a20 2020  e1 + 0.5 * (.   
-00017480: 2020 2020 2020 2020 206d 6174 682e 7369           math.si
-00017490: 6e28 3220 2a20 616e 676c 6531 2920 2d20  n(2 * angle1) - 
-000174a0: 6d61 7468 2e73 696e 2832 202a 2061 6e67  math.sin(2 * ang
-000174b0: 6c65 3229 2929 0a20 2020 2020 2020 2049  le2))).        I
-000174c0: 7931 203d 2073 656c 662e 7261 6469 7573  y1 = self.radius
-000174d0: 202a 2a20 3420 2f20 3820 2a20 2861 6e67   ** 4 / 8 * (ang
-000174e0: 6c65 3220 2d20 616e 676c 6531 202b 2030  le2 - angle1 + 0
-000174f0: 2e35 202a 2028 0a20 2020 2020 2020 2020  .5 * (.         
-00017500: 2020 206d 6174 682e 7369 6e28 3220 2a20     math.sin(2 * 
-00017510: 616e 676c 6532 2920 2d20 6d61 7468 2e73  angle2) - math.s
-00017520: 696e 2832 202a 2061 6e67 6c65 3129 2929  in(2 * angle1)))
-00017530: 0a20 2020 2020 2020 2049 7879 3120 3d20  .        Ixy1 = 
-00017540: 7365 6c66 2e72 6164 6975 7320 2a2a 2034  self.radius ** 4
-00017550: 202f 2038 202a 2028 0a20 2020 2020 2020   / 8 * (.       
-00017560: 2020 2020 206d 6174 682e 636f 7328 616e       math.cos(an
-00017570: 676c 6531 2920 2a2a 2032 202d 206d 6174  gle1) ** 2 - mat
-00017580: 682e 636f 7328 616e 676c 6532 2920 2a2a  h.cos(angle2) **
-00017590: 2032 290a 0a20 2020 2020 2020 2023 2054   2)..        # T
-000175a0: 7269 616e 676c 650a 2020 2020 2020 2020  riangle.        
-000175b0: 7869 2c20 7969 203d 2073 656c 662e 7374  xi, yi = self.st
-000175c0: 6172 7420 2d20 7365 6c66 2e63 656e 7465  art - self.cente
-000175d0: 720a 2020 2020 2020 2020 786a 2c20 796a  r.        xj, yj
-000175e0: 203d 2073 656c 662e 656e 6420 2d20 7365   = self.end - se
-000175f0: 6c66 2e63 656e 7465 720a 2020 2020 2020  lf.center.      
-00017600: 2020 4978 3220 3d20 2879 6920 2a2a 2032    Ix2 = (yi ** 2
-00017610: 202b 2079 6920 2a20 796a 202b 2079 6a20   + yi * yj + yj 
-00017620: 2a2a 2032 2920 2a20 2878 6920 2a20 796a  ** 2) * (xi * yj
-00017630: 202d 2078 6a20 2a20 7969 2920 2f20 3132   - xj * yi) / 12
-00017640: 2e0a 2020 2020 2020 2020 4979 3220 3d20  ..        Iy2 = 
-00017650: 2878 6920 2a2a 2032 202b 2078 6920 2a20  (xi ** 2 + xi * 
-00017660: 786a 202b 2078 6a20 2a2a 2032 2920 2a20  xj + xj ** 2) * 
-00017670: 2878 6920 2a20 796a 202d 2078 6a20 2a20  (xi * yj - xj * 
-00017680: 7969 2920 2f20 3132 2e0a 2020 2020 2020  yi) / 12..      
-00017690: 2020 4978 7932 203d 2028 7869 202a 2079    Ixy2 = (xi * y
-000176a0: 6a20 2b20 3220 2a20 7869 202a 2079 6920  j + 2 * xi * yi 
-000176b0: 2b20 3220 2a20 786a 202a 2079 6a20 2b20  + 2 * xj * yj + 
-000176c0: 786a 202a 2079 6929 202a 2028 0a20 2020  xj * yi) * (.   
-000176d0: 2020 2020 2020 2020 2078 6920 2a20 796a           xi * yj
-000176e0: 202d 2078 6a20 2a20 7969 2920 2f20 3234   - xj * yi) / 24
-000176f0: 2e0a 2020 2020 2020 2020 6966 2049 7832  ..        if Ix2
-00017700: 203c 2030 2e3a 0a20 2020 2020 2020 2020   < 0.:.         
-00017710: 2020 2049 7832 2c20 4979 322c 2049 7879     Ix2, Iy2, Ixy
-00017720: 3220 3d20 2d49 7832 2c20 2d49 7932 2c20  2 = -Ix2, -Iy2, 
-00017730: 2d49 7879 320a 2020 2020 2020 2020 6966  -Ixy2.        if
-00017740: 2073 656c 662e 616e 676c 6520 3c20 6d61   self.angle < ma
-00017750: 7468 2e70 693a 0a20 2020 2020 2020 2020  th.pi:.         
-00017760: 2020 2069 6620 7365 6c66 2e69 735f 7472     if self.is_tr
-00017770: 6967 6f3a 0a20 2020 2020 2020 2020 2020  igo:.           
-00017780: 2020 2020 2049 7820 3d20 4978 3120 2d20       Ix = Ix1 - 
-00017790: 4978 320a 2020 2020 2020 2020 2020 2020  Ix2.            
-000177a0: 2020 2020 4979 203d 2049 7931 202d 2049      Iy = Iy1 - I
-000177b0: 7932 0a20 2020 2020 2020 2020 2020 2020  y2.             
-000177c0: 2020 2049 7879 203d 2049 7879 3120 2d20     Ixy = Ixy1 - 
-000177d0: 4978 7932 0a20 2020 2020 2020 2020 2020  Ixy2.           
-000177e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000177f0: 2020 2020 2020 2049 7820 3d20 4978 3220         Ix = Ix2 
-00017800: 2d20 4978 310a 2020 2020 2020 2020 2020  - Ix1.          
-00017810: 2020 2020 2020 4979 203d 2049 7932 202d        Iy = Iy2 -
-00017820: 2049 7931 0a20 2020 2020 2020 2020 2020   Iy1.           
-00017830: 2020 2020 2049 7879 203d 2049 7879 3220       Ixy = Ixy2 
-00017840: 2d20 4978 7931 0a20 2020 2020 2020 2065  - Ixy1.        e
-00017850: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00017860: 2023 2070 7269 6e74 2827 4978 7931 3227   # print('Ixy12'
-00017870: 2c20 4978 7931 2c20 4978 7932 290a 2020  , Ixy1, Ixy2).  
-00017880: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00017890: 662e 6973 5f74 7269 676f 3a0a 2020 2020  f.is_trigo:.    
-000178a0: 2020 2020 2020 2020 2020 2020 4978 203d              Ix =
-000178b0: 2049 7831 202b 2049 7832 0a20 2020 2020   Ix1 + Ix2.     
-000178c0: 2020 2020 2020 2020 2020 2049 7920 3d20             Iy = 
-000178d0: 4979 3120 2b20 4979 320a 2020 2020 2020  Iy1 + Iy2.      
-000178e0: 2020 2020 2020 2020 2020 4978 7920 3d20            Ixy = 
-000178f0: 4978 7931 202b 2049 7879 320a 2020 2020  Ixy1 + Ixy2.    
-00017900: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00017910: 2020 2020 2020 2020 2020 2020 2020 4978                Ix
-00017920: 203d 202d 4978 3220 2d20 4978 310a 2020   = -Ix2 - Ix1.  
-00017930: 2020 2020 2020 2020 2020 2020 2020 4979                Iy
-00017940: 203d 202d 4979 3220 2d20 4979 310a 2020   = -Iy2 - Iy1.  
-00017950: 2020 2020 2020 2020 2020 2020 2020 4978                Ix
-00017960: 7920 3d20 2d49 7879 3220 2d20 4978 7931  y = -Ixy2 - Ixy1
-00017970: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00017980: 2076 6f6c 6d64 6c72 2e67 656f 6d65 7472   volmdlr.geometr
-00017990: 792e 6875 7967 656e 7332 6428 4978 2c20  y.huygens2d(Ix, 
-000179a0: 4979 2c20 4978 792c 0a20 2020 2020 2020  Iy, Ixy,.       
-000179b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000179c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000179d0: 2020 2073 656c 662e 7374 7261 6967 6874     self.straight
-000179e0: 5f6c 696e 655f 6172 6561 2829 2c0a 2020  _line_area(),.  
-000179f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a10: 2020 2020 2020 2020 7365 6c66 2e63 656e          self.cen
-00017a20: 7465 722c 0a20 2020 2020 2020 2020 2020  ter,.           
-00017a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a40: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00017a50: 6f69 6e74 290a 0a20 2020 2064 6566 2073  oint)..    def s
-00017a60: 7472 6169 6768 745f 6c69 6e65 5f63 656e  traight_line_cen
-00017a70: 7465 725f 6f66 5f6d 6173 7328 7365 6c66  ter_of_mass(self
-00017a80: 293a 0a20 2020 2020 2020 2069 6620 7365  ):.        if se
-00017a90: 6c66 2e61 6e67 6c65 203d 3d20 6d61 7468  lf.angle == math
-00017aa0: 2e70 693a 0a20 2020 2020 2020 2020 2020  .pi:.           
-00017ab0: 2072 6574 7572 6e20 7365 6c66 2e63 656e   return self.cen
-00017ac0: 7465 725f 6f66 5f6d 6173 7328 290a 0a20  ter_of_mass().. 
-00017ad0: 2020 2020 2020 2075 203d 2073 656c 662e         u = self.
-00017ae0: 6d69 6464 6c65 5f70 6f69 6e74 2829 202d  middle_point() -
-00017af0: 2073 656c 662e 6365 6e74 6572 0a20 2020   self.center.   
-00017b00: 2020 2020 2075 2e6e 6f72 6d61 6c69 7a65       u.normalize
-00017b10: 2829 0a20 2020 2020 2020 2069 6620 7365  ().        if se
-00017b20: 6c66 2e61 6e67 6c65 203e 3d20 6d61 7468  lf.angle >= math
-00017b30: 2e70 693a 0a20 2020 2020 2020 2020 2020  .pi:.           
-00017b40: 2075 203d 202d 750a 2020 2020 2020 2020   u = -u.        
-00017b50: 6269 7373 6563 203d 204c 696e 6532 4428  bissec = Line2D(
-00017b60: 7365 6c66 2e63 656e 7465 722c 2073 656c  self.center, sel
-00017b70: 662e 6365 6e74 6572 202b 2075 290a 2020  f.center + u).  
-00017b80: 2020 2020 2020 7374 7269 6e67 203d 204c        string = L
-00017b90: 696e 6532 4428 7365 6c66 2e73 7461 7274  ine2D(self.start
-00017ba0: 2c20 7365 6c66 2e65 6e64 290a 2020 2020  , self.end).    
-00017bb0: 2020 2020 7020 3d20 766f 6c6d 646c 722e      p = volmdlr.
-00017bc0: 506f 696e 7432 442e 6c69 6e65 5f69 6e74  Point2D.line_int
-00017bd0: 6572 7365 6374 696f 6e28 6269 7373 6563  ersection(bissec
-00017be0: 2c20 7374 7269 6e67 290a 2020 2020 2020  , string).      
-00017bf0: 2020 6120 3d20 702e 706f 696e 745f 6469    a = p.point_di
-00017c00: 7374 616e 6365 2873 656c 662e 7374 6172  stance(self.star
-00017c10: 7429 0a20 2020 2020 2020 2068 6569 6768  t).        heigh
-00017c20: 7420 3d20 702e 706f 696e 745f 6469 7374  t = p.point_dist
-00017c30: 616e 6365 2873 656c 662e 6365 6e74 6572  ance(self.center
-00017c40: 290a 2020 2020 2020 2020 7472 6961 6e67  ).        triang
-00017c50: 6c65 5f61 7265 6120 3d20 6865 6967 6874  le_area = height
-00017c60: 202a 2061 0a20 2020 2020 2020 2023 2061   * a.        # a
-00017c70: 6c70 6861 203d 2061 6273 2873 656c 662e  lpha = abs(self.
-00017c80: 616e 676c 6529 0a20 2020 2020 2020 2074  angle).        t
-00017c90: 7269 616e 676c 655f 636f 6720 3d20 7365  riangle_cog = se
-00017ca0: 6c66 2e63 656e 7465 7220 2b20 3220 2f20  lf.center + 2 / 
-00017cb0: 332e 202a 2068 6569 6768 7420 2a20 750a  3. * height * u.
-00017cc0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00017cd0: 616e 676c 6520 3c20 6d61 7468 2e70 693a  angle < math.pi:
-00017ce0: 0a20 2020 2020 2020 2020 2020 2063 6f67  .            cog
-00017cf0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00017d00: 2020 2020 2073 656c 662e 6365 6e74 6572       self.center
-00017d10: 5f6f 665f 6d61 7373 2829 202a 2073 656c  _of_mass() * sel
-00017d20: 662e 6172 6561 2829 202d 2074 7269 616e  f.area() - trian
-00017d30: 676c 655f 6172 6561 202a 2074 7269 616e  gle_area * trian
-00017d40: 676c 655f 636f 6729 202f 2061 6273 280a  gle_cog) / abs(.
-00017d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017d60: 7365 6c66 2e73 7472 6169 6768 745f 6c69  self.straight_li
-00017d70: 6e65 5f61 7265 6128 2929 0a20 2020 2020  ne_area()).     
-00017d80: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00017d90: 2020 2020 2063 6f67 203d 2028 0a20 2020       cog = (.   
-00017da0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00017db0: 662e 6365 6e74 6572 5f6f 665f 6d61 7373  f.center_of_mass
-00017dc0: 2829 202a 2073 656c 662e 6172 6561 2829  () * self.area()
-00017dd0: 202b 2074 7269 616e 676c 655f 6172 6561   + triangle_area
-00017de0: 202a 2074 7269 616e 676c 655f 636f 6729   * triangle_cog)
-00017df0: 202f 2061 6273 280a 2020 2020 2020 2020   / abs(.        
-00017e00: 2020 2020 2020 2020 7365 6c66 2e73 7472          self.str
-00017e10: 6169 6768 745f 6c69 6e65 5f61 7265 6128  aight_line_area(
-00017e20: 2929 0a0a 2020 2020 2020 2020 2320 6178  ))..        # ax
-00017e30: 203d 2073 656c 662e 706c 6f74 2829 0a20   = self.plot(). 
-00017e40: 2020 2020 2020 2023 2062 6973 7365 632e         # bissec.
-00017e50: 706c 6f74 2861 783d 6178 2c20 636f 6c6f  plot(ax=ax, colo
-00017e60: 723d 2767 7265 7927 290a 2020 2020 2020  r='grey').      
-00017e70: 2020 2320 7365 6c66 2e63 656e 7465 722e    # self.center.
-00017e80: 706c 6f74 2861 783d 6178 290a 2020 2020  plot(ax=ax).    
-00017e90: 2020 2020 2320 7374 7269 6e67 2e70 6c6f      # string.plo
-00017ea0: 7428 6178 3d61 782c 2063 6f6c 6f72 3d27  t(ax=ax, color='
-00017eb0: 6772 6579 2729 0a20 2020 2020 2020 2023  grey').        #
-00017ec0: 2074 7269 616e 676c 655f 636f 672e 706c   triangle_cog.pl
-00017ed0: 6f74 2861 783d 6178 2c20 636f 6c6f 723d  ot(ax=ax, color=
-00017ee0: 2767 7265 656e 2729 0a20 2020 2020 2020  'green').       
-00017ef0: 2023 2073 656c 662e 6365 6e74 6572 5f6f   # self.center_o
-00017f00: 665f 6d61 7373 2829 2e70 6c6f 7428 6178  f_mass().plot(ax
-00017f10: 3d61 782c 2063 6f6c 6f72 3d27 7265 6427  =ax, color='red'
-00017f20: 290a 2020 2020 2020 2020 230a 2020 2020  ).        #.    
-00017f30: 2020 2020 2320 636f 675f 6c69 6e65 203d      # cog_line =
-00017f40: 204c 696e 6532 4428 766f 6c6d 646c 722e   Line2D(volmdlr.
-00017f50: 4f32 442c 2073 656c 662e 6365 6e74 6572  O2D, self.center
-00017f60: 5f6f 665f 6d61 7373 2829 2a73 656c 662e  _of_mass()*self.
-00017f70: 6172 6561 2829 2d74 7269 616e 676c 655f  area()-triangle_
-00017f80: 6172 6561 2a74 7269 616e 676c 655f 636f  area*triangle_co
-00017f90: 6729 0a20 2020 2020 2020 2023 2063 6f67  g).        # cog
-00017fa0: 5f6c 696e 652e 706c 6f74 2861 783d 6178  _line.plot(ax=ax
-00017fb0: 290a 2020 2020 2020 2020 230a 2020 2020  ).        #.    
-00017fc0: 2020 2020 2320 636f 672e 706c 6f74 2861      # cog.plot(a
-00017fd0: 783d 6178 2c20 636f 6c6f 723d 2762 2729  x=ax, color='b')
-00017fe0: 0a20 2020 2020 2020 2023 2061 782e 7365  .        # ax.se
-00017ff0: 745f 6173 7065 6374 2827 6571 7561 6c27  t_aspect('equal'
-00018000: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00018010: 2063 6f67 0a0a 2020 2020 6465 6620 7374   cog..    def st
-00018020: 7261 6967 6874 5f6c 696e 655f 706f 696e  raight_line_poin
-00018030: 745f 6265 6c6f 6e67 7328 7365 6c66 2c20  t_belongs(self, 
-00018040: 706f 696e 7429 3a0a 2020 2020 2020 2020  point):.        
-00018050: 2222 220a 2020 2020 2020 2020 5665 7269  """.        Veri
-00018060: 6669 6573 2069 6620 6120 706f 696e 7420  fies if a point 
-00018070: 6265 6c6f 6e67 7320 746f 2074 6865 2073  belongs to the s
-00018080: 7572 6661 6365 2063 7265 6174 6564 2062  urface created b
-00018090: 7920 636c 6f73 696e 6720 7468 6520 6564  y closing the ed
-000180a0: 6765 2e0a 0a20 2020 2020 2020 203a 7061  ge...        :pa
-000180b0: 7261 6d20 706f 696e 745f 3264 3a20 506f  ram point_2d: Po
-000180c0: 696e 7420 746f 2062 6520 7665 7269 6669  int to be verifi
-000180d0: 6564 2e0a 2020 2020 2020 2020 3a72 6574  ed..        :ret
-000180e0: 7572 6e3a 2052 6574 7572 6e20 5472 7565  urn: Return True
-000180f0: 2069 6620 7468 6520 706f 696e 7420 6265   if the point be
-00018100: 6c6f 6e67 7320 746f 2074 6869 7320 7375  longs to this su
-00018110: 7266 6163 652c 206f 7220 4661 6c73 6520  rface, or False 
-00018120: 6f74 6865 7277 6973 652e 0a20 2020 2020  otherwise..     
-00018130: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00018140: 6620 7365 6c66 2e70 6f69 6e74 5f62 656c  f self.point_bel
-00018150: 6f6e 6773 2870 6f69 6e74 293a 0a20 2020  ongs(point):.   
-00018160: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00018170: 5472 7565 0a20 2020 2020 2020 2069 6620  True.        if 
-00018180: 7365 6c66 2e73 7461 7274 203d 3d20 7365  self.start == se
-00018190: 6c66 2e65 6e64 3a0a 2020 2020 2020 2020  lf.end:.        
-000181a0: 2020 2020 6966 2070 6f69 6e74 2e70 6f69      if point.poi
-000181b0: 6e74 5f64 6973 7461 6e63 6528 7365 6c66  nt_distance(self
-000181c0: 2e63 656e 7465 7229 203c 3d20 7365 6c66  .center) <= self
-000181d0: 2e72 6164 6975 733a 0a20 2020 2020 2020  .radius:.       
-000181e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000181f0: 5472 7565 0a20 2020 2020 2020 2063 656e  True.        cen
-00018200: 7465 725f 6469 7374 616e 6365 5f70 6f69  ter_distance_poi
-00018210: 6e74 203d 2073 656c 662e 6365 6e74 6572  nt = self.center
-00018220: 2e70 6f69 6e74 5f64 6973 7461 6e63 6528  .point_distance(
-00018230: 706f 696e 7429 0a20 2020 2020 2020 2073  point).        s
-00018240: 7472 6169 6768 745f 6c69 6e65 203d 204c  traight_line = L
-00018250: 696e 6553 6567 6d65 6e74 3244 2873 656c  ineSegment2D(sel
-00018260: 662e 7374 6172 742c 2073 656c 662e 656e  f.start, self.en
-00018270: 6429 0a20 2020 2020 2020 2066 6f72 2065  d).        for e
-00018280: 6467 6520 696e 205b 7365 6c66 2c20 7374  dge in [self, st
-00018290: 7261 6967 6874 5f6c 696e 655d 3a0a 2020  raight_line]:.  
-000182a0: 2020 2020 2020 2020 2020 6c69 6e65 5f70            line_p
-000182b0: 6173 7369 6e67 5f74 726f 7567 685f 706f  assing_trough_po
-000182c0: 696e 7420 3d20 4c69 6e65 3244 2873 656c  int = Line2D(sel
-000182d0: 662e 6365 6e74 6572 2c20 706f 696e 7429  f.center, point)
-000182e0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-000182f0: 6169 6768 745f 6c69 6e65 5f69 6e74 6572  aight_line_inter
-00018300: 7365 6374 696f 6e73 203d 2065 6467 652e  sections = edge.
-00018310: 6c69 6e65 5f69 6e74 6572 7365 6374 696f  line_intersectio
-00018320: 6e73 286c 696e 655f 7061 7373 696e 675f  ns(line_passing_
-00018330: 7472 6f75 6768 5f70 6f69 6e74 290a 2020  trough_point).  
-00018340: 2020 2020 2020 2020 2020 6966 2073 7472            if str
-00018350: 6169 6768 745f 6c69 6e65 5f69 6e74 6572  aight_line_inter
-00018360: 7365 6374 696f 6e73 3a0a 2020 2020 2020  sections:.      
-00018370: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00018380: 662e 6365 6e74 6572 2e70 6f69 6e74 5f64  f.center.point_d
-00018390: 6973 7461 6e63 6528 7374 7261 6967 6874  istance(straight
-000183a0: 5f6c 696e 655f 696e 7465 7273 6563 7469  _line_intersecti
-000183b0: 6f6e 735b 305d 2920 3e20 6365 6e74 6572  ons[0]) > center
-000183c0: 5f64 6973 7461 6e63 655f 706f 696e 743a  _distance_point:
-000183d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000183e0: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-000183f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00018400: 4661 6c73 650a 0a20 2020 2064 6566 2070  False..    def p
-00018410: 6c6f 7428 7365 6c66 2c20 6178 3d4e 6f6e  lot(self, ax=Non
-00018420: 652c 2063 6f6c 6f72 3d27 6b27 2c20 616c  e, color='k', al
-00018430: 7068 613d 312c 2070 6c6f 745f 706f 696e  pha=1, plot_poin
-00018440: 7473 3d46 616c 7365 293a 0a20 2020 2020  ts=False):.     
-00018450: 2020 2069 6620 6178 2069 7320 4e6f 6e65     if ax is None
-00018460: 3a0a 2020 2020 2020 2020 2020 2020 5f2c  :.            _,
-00018470: 2061 7820 3d20 706c 742e 7375 6270 6c6f   ax = plt.subplo
-00018480: 7473 2829 0a0a 2020 2020 2020 2020 6966  ts()..        if
-00018490: 2070 6c6f 745f 706f 696e 7473 3a0a 2020   plot_points:.  
-000184a0: 2020 2020 2020 2020 2020 666f 7220 706f            for po
-000184b0: 696e 7420 696e 205b 7365 6c66 2e63 656e  int in [self.cen
-000184c0: 7465 722c 2073 656c 662e 7374 6172 742c  ter, self.start,
-000184d0: 2073 656c 662e 696e 7465 7269 6f72 2c20   self.interior, 
-000184e0: 7365 6c66 2e65 6e64 5d3a 0a20 2020 2020  self.end]:.     
-000184f0: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-00018500: 2e70 6c6f 7428 6178 3d61 782c 2063 6f6c  .plot(ax=ax, col
-00018510: 6f72 3d63 6f6c 6f72 2c20 616c 7068 613d  or=color, alpha=
-00018520: 616c 7068 6129 0a0a 2020 2020 2020 2020  alpha)..        
-00018530: 6178 2e61 6464 5f70 6174 6368 286d 6174  ax.add_patch(mat
-00018540: 706c 6f74 6c69 622e 7061 7463 6865 732e  plotlib.patches.
-00018550: 4172 6328 2873 656c 662e 6365 6e74 6572  Arc((self.center
-00018560: 2e78 2c20 7365 6c66 2e63 656e 7465 722e  .x, self.center.
-00018570: 7929 2c20 3220 2a20 7365 6c66 2e72 6164  y), 2 * self.rad
-00018580: 6975 732c 0a20 2020 2020 2020 2020 2020  ius,.           
-00018590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185b0: 2032 202a 2073 656c 662e 7261 6469 7573   2 * self.radius
-000185c0: 2c20 616e 676c 653d 302c 0a20 2020 2020  , angle=0,.     
-000185d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185f0: 2020 2020 2020 2074 6865 7461 313d 7365         theta1=se
-00018600: 6c66 2e61 6e67 6c65 3120 2a20 302e 3520  lf.angle1 * 0.5 
-00018610: 2f20 6d61 7468 2e70 6920 2a20 3336 302c  / math.pi * 360,
-00018620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018640: 2020 2020 2020 2020 2020 2020 2074 6865               the
-00018650: 7461 323d 7365 6c66 2e61 6e67 6c65 3220  ta2=self.angle2 
-00018660: 2a20 302e 3520 2f20 6d61 7468 2e70 6920  * 0.5 / math.pi 
-00018670: 2a20 3336 302c 0a20 2020 2020 2020 2020  * 360,.         
-00018680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000186a0: 2020 2063 6f6c 6f72 3d63 6f6c 6f72 2c0a     color=color,.
+000144d0: 6e3a 2069 6e74 293a 0a20 2020 2020 2020  n: int):.       
+000144e0: 2077 6172 6e69 6e67 732e 7761 726e 2827   warnings.warn('
+000144f0: 706f 6c79 676f 6e5f 706f 696e 7473 2069  polygon_points i
+00014500: 7320 6465 7072 6563 6174 6564 2c5c 0a20  s deprecated,\. 
+00014510: 2020 2020 2020 2070 6c65 6173 6520 7573         please us
+00014520: 6520 6469 7363 7265 7469 7a61 7469 6f6e  e discretization
+00014530: 5f70 6f69 6e74 7320 696e 7374 6561 6427  _points instead'
+00014540: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00014550: 2020 2020 2020 2020 4465 7072 6563 6174          Deprecat
+00014560: 696f 6e57 6172 6e69 6e67 290a 2020 2020  ionWarning).    
+00014570: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00014580: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
+00014590: 6f69 6e74 7328 6e75 6d62 6572 5f70 6f69  oints(number_poi
+000145a0: 6e74 733d 6469 7363 7265 7469 7a61 7469  nts=discretizati
+000145b0: 6f6e 5f72 6573 6f6c 7574 696f 6e29 0a0a  on_resolution)..
+000145c0: 2020 2020 6465 6620 6765 745f 6765 6f5f      def get_geo_
+000145d0: 6c69 6e65 7328 7365 6c66 2c20 7461 673a  lines(self, tag:
+000145e0: 2069 6e74 2c20 7374 6172 745f 706f 696e   int, start_poin
+000145f0: 745f 7461 673a 2069 6e74 2c20 6365 6e74  t_tag: int, cent
+00014600: 6572 5f70 6f69 6e74 5f74 6167 3a20 696e  er_point_tag: in
+00014610: 742c 2065 6e64 5f70 6f69 6e74 5f74 6167  t, end_point_tag
+00014620: 3a20 696e 7429 3a0a 2020 2020 2020 2020  : int):.        
+00014630: 2222 220a 2020 2020 2020 2020 4765 7473  """.        Gets
+00014640: 2074 6865 206c 696e 6573 2074 6861 7420   the lines that 
+00014650: 6465 6669 6e65 2061 6e20 4172 6320 696e  define an Arc in
+00014660: 2061 202e 6765 6f20 6669 6c65 2e0a 0a20   a .geo file... 
+00014670: 2020 2020 2020 203a 7061 7261 6d20 7461         :param ta
+00014680: 673a 2054 6865 206c 696e 6573 6567 6d65  g: The linesegme
+00014690: 6e74 2069 6e64 6578 0a20 2020 2020 2020  nt index.       
+000146a0: 203a 7479 7065 2074 6167 3a20 696e 740a   :type tag: int.
+000146b0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+000146c0: 7461 7274 5f70 6f69 6e74 5f74 6167 3a20  tart_point_tag: 
+000146d0: 5468 6520 6c69 6e65 7365 676d 656e 7427  The linesegment'
+000146e0: 2073 7461 7274 2070 6f69 6e74 2069 6e64   start point ind
+000146f0: 6578 0a20 2020 2020 2020 203a 7479 7065  ex.        :type
+00014700: 2073 7461 7274 5f70 6f69 6e74 5f74 6167   start_point_tag
+00014710: 3a20 696e 740a 2020 2020 2020 2020 3a70  : int.        :p
+00014720: 6172 616d 2063 656e 7465 725f 706f 696e  aram center_poin
+00014730: 745f 7461 673a 2054 6865 206c 696e 6573  t_tag: The lines
+00014740: 6567 6d65 6e74 2720 6365 6e74 6572 2070  egment' center p
+00014750: 6f69 6e74 2069 6e64 6578 0a20 2020 2020  oint index.     
+00014760: 2020 203a 7479 7065 2063 656e 7465 725f     :type center_
+00014770: 706f 696e 745f 7461 673a 2069 6e74 0a20  point_tag: int. 
+00014780: 2020 2020 2020 203a 7061 7261 6d20 656e         :param en
+00014790: 645f 706f 696e 745f 7461 673a 2054 6865  d_point_tag: The
+000147a0: 206c 696e 6573 6567 6d65 6e74 2720 656e   linesegment' en
+000147b0: 6420 706f 696e 7420 696e 6465 780a 2020  d point index.  
+000147c0: 2020 2020 2020 3a74 7970 6520 656e 645f        :type end_
+000147d0: 706f 696e 745f 7461 673a 2069 6e74 0a0a  point_tag: int..
+000147e0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+000147f0: 2041 206c 696e 650a 2020 2020 2020 2020   A line.        
+00014800: 3a72 7479 7065 3a20 7374 720a 2020 2020  :rtype: str.    
+00014810: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00014820: 2072 6574 7572 6e20 2743 6972 636c 6528   return 'Circle(
+00014830: 2720 2b20 7374 7228 7461 6729 202b 2027  ' + str(tag) + '
+00014840: 2920 3d20 7b27 202b 2073 7472 2873 7461  ) = {' + str(sta
+00014850: 7274 5f70 6f69 6e74 5f74 6167 2920 2b20  rt_point_tag) + 
+00014860: 272c 2027 202b 205c 0a20 2020 2020 2020  ', ' + \.       
+00014870: 2020 2020 2073 7472 2863 656e 7465 725f       str(center_
+00014880: 706f 696e 745f 7461 6729 202b 2027 2c20  point_tag) + ', 
+00014890: 2720 2b20 7374 7228 656e 645f 706f 696e  ' + str(end_poin
+000148a0: 745f 7461 6729 202b 2027 7d3b 270a 0a20  t_tag) + '};'.. 
+000148b0: 2020 2064 6566 2067 6574 5f67 656f 5f70     def get_geo_p
+000148c0: 6f69 6e74 7328 7365 6c66 293a 0a20 2020  oints(self):.   
+000148d0: 2020 2020 2072 6574 7572 6e20 5b73 656c       return [sel
+000148e0: 662e 7374 6172 742c 2073 656c 662e 6365  f.start, self.ce
+000148f0: 6e74 6572 2c20 7365 6c66 2e65 6e64 5d0a  nter, self.end].
+00014900: 0a0a 636c 6173 7320 4172 6332 4428 4172  ..class Arc2D(Ar
+00014910: 6329 3a0a 2020 2020 2222 220a 2020 2020  c):.    """.    
+00014920: 436c 6173 7320 746f 2064 7261 7720 4172  Class to draw Ar
+00014930: 6332 442e 0a0a 2020 2020 616e 676c 653a  c2D...    angle:
+00014940: 2074 6865 2061 6e67 6c65 206d 6561 7375   the angle measu
+00014950: 7265 2061 6c77 6179 7320 3e3d 2030 0a20  re always >= 0. 
+00014960: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
+00014970: 5f5f 696e 6974 5f5f 2873 656c 662c 0a20  __init__(self,. 
+00014980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014990: 7374 6172 743a 2076 6f6c 6d64 6c72 2e50  start: volmdlr.P
+000149a0: 6f69 6e74 3244 2c0a 2020 2020 2020 2020  oint2D,.        
+000149b0: 2020 2020 2020 2020 2069 6e74 6572 696f           interio
+000149c0: 723a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  r: volmdlr.Point
+000149d0: 3244 2c0a 2020 2020 2020 2020 2020 2020  2D,.            
+000149e0: 2020 2020 2065 6e64 3a20 766f 6c6d 646c       end: volmdl
+000149f0: 722e 506f 696e 7432 442c 0a20 2020 2020  r.Point2D,.     
+00014a00: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00014a10: 3a20 7374 7220 3d20 2727 293a 0a20 2020  : str = ''):.   
+00014a20: 2020 2020 2073 656c 662e 5f63 656e 7465       self._cente
+00014a30: 7220 3d20 4e6f 6e65 0a20 2020 2020 2020  r = None.       
+00014a40: 2073 656c 662e 5f69 735f 7472 6967 6f20   self._is_trigo 
+00014a50: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+00014a60: 656c 662e 5f61 6e67 6c65 203d 204e 6f6e  elf._angle = Non
+00014a70: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+00014a80: 626f 756e 6469 6e67 5f72 6563 7461 6e67  bounding_rectang
+00014a90: 6c65 203d 204e 6f6e 650a 2020 2020 2020  le = None.      
+00014aa0: 2020 4172 632e 5f5f 696e 6974 5f5f 2873    Arc.__init__(s
+00014ab0: 656c 662c 2073 7461 7274 3d73 7461 7274  elf, start=start
+00014ac0: 2c20 656e 643d 656e 642c 2069 6e74 6572  , end=end, inter
+00014ad0: 696f 723d 696e 7465 7269 6f72 2c20 6e61  ior=interior, na
+00014ae0: 6d65 3d6e 616d 6529 0a20 2020 2020 2020  me=name).       
+00014af0: 2073 7461 7274 5f74 6f5f 6365 6e74 6572   start_to_center
+00014b00: 203d 2073 7461 7274 202d 2073 656c 662e   = start - self.
+00014b10: 6365 6e74 6572 0a20 2020 2020 2020 2065  center.        e
+00014b20: 6e64 5f74 6f5f 6365 6e74 6572 203d 2065  nd_to_center = e
+00014b30: 6e64 202d 2073 656c 662e 6365 6e74 6572  nd - self.center
+00014b40: 0a20 2020 2020 2020 2061 6e67 6c65 3120  .        angle1 
+00014b50: 3d20 6d61 7468 2e61 7461 6e32 2873 7461  = math.atan2(sta
+00014b60: 7274 5f74 6f5f 6365 6e74 6572 2e79 2c20  rt_to_center.y, 
+00014b70: 7374 6172 745f 746f 5f63 656e 7465 722e  start_to_center.
+00014b80: 7829 0a20 2020 2020 2020 2061 6e67 6c65  x).        angle
+00014b90: 3220 3d20 6d61 7468 2e61 7461 6e32 2865  2 = math.atan2(e
+00014ba0: 6e64 5f74 6f5f 6365 6e74 6572 2e79 2c20  nd_to_center.y, 
+00014bb0: 656e 645f 746f 5f63 656e 7465 722e 7829  end_to_center.x)
+00014bc0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00014bd0: 2e69 735f 7472 6967 6f3a 0a20 2020 2020  .is_trigo:.     
+00014be0: 2020 2020 2020 2073 656c 662e 616e 676c         self.angl
+00014bf0: 6531 203d 2061 6e67 6c65 310a 2020 2020  e1 = angle1.    
+00014c00: 2020 2020 2020 2020 7365 6c66 2e61 6e67          self.ang
+00014c10: 6c65 3220 3d20 616e 676c 6532 0a20 2020  le2 = angle2.   
+00014c20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00014c30: 2020 2020 2020 2073 656c 662e 616e 676c         self.angl
+00014c40: 6531 203d 2061 6e67 6c65 320a 2020 2020  e1 = angle2.    
+00014c50: 2020 2020 2020 2020 7365 6c66 2e61 6e67          self.ang
+00014c60: 6c65 3220 3d20 616e 676c 6531 0a0a 2020  le2 = angle1..  
+00014c70: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00014c80: 6465 6620 6365 6e74 6572 2873 656c 6629  def center(self)
+00014c90: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
+00014ca0: 2073 656c 662e 5f63 656e 7465 723a 0a20   self._center:. 
+00014cb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00014cc0: 5f63 656e 7465 7220 3d20 7365 6c66 2e67  _center = self.g
+00014cd0: 6574 5f63 656e 7465 7228 290a 2020 2020  et_center().    
+00014ce0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00014cf0: 5f63 656e 7465 720a 0a20 2020 2064 6566  _center..    def
+00014d00: 2067 6574 5f63 656e 7465 7228 7365 6c66   get_center(self
+00014d10: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00014d20: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
+00014d30: 7320 7468 6520 6365 6e74 6572 206f 6620  s the center of 
+00014d40: 7468 6520 4172 632e 0a0a 2020 2020 2020  the Arc...      
+00014d50: 2020 3a72 6574 7572 6e3a 2061 7363 2773    :return: asc's
+00014d60: 2063 656e 7465 722e 0a20 2020 2020 2020   center..       
+00014d70: 2022 2222 0a20 2020 2020 2020 2078 692c   """.        xi,
+00014d80: 2079 6920 3d20 7365 6c66 2e69 6e74 6572   yi = self.inter
+00014d90: 696f 722e 782c 2073 656c 662e 696e 7465  ior.x, self.inte
+00014da0: 7269 6f72 2e79 0a20 2020 2020 2020 2078  rior.y.        x
+00014db0: 652c 2079 6520 3d20 7365 6c66 2e65 6e64  e, ye = self.end
+00014dc0: 2e78 2c20 7365 6c66 2e65 6e64 2e79 0a20  .x, self.end.y. 
+00014dd0: 2020 2020 2020 2078 732c 2079 7320 3d20         xs, ys = 
+00014de0: 7365 6c66 2e73 7461 7274 2e78 2c20 7365  self.start.x, se
+00014df0: 6c66 2e73 7461 7274 2e79 0a20 2020 2020  lf.start.y.     
+00014e00: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00014e10: 2020 2020 6d61 7472 6978 5f61 203d 2076      matrix_a = v
+00014e20: 6f6c 6d64 6c72 2e4d 6174 7269 7832 3228  olmdlr.Matrix22(
+00014e30: 3220 2a20 2878 7320 2d20 7869 292c 2032  2 * (xs - xi), 2
+00014e40: 202a 2028 7973 202d 2079 6929 2c0a 2020   * (ys - yi),.  
+00014e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e70: 2020 2020 2020 3220 2a20 2878 7320 2d20        2 * (xs - 
+00014e80: 7865 292c 2032 202a 2028 7973 202d 2079  xe), 2 * (ys - y
+00014e90: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
+00014ea0: 625f 7665 6374 6f72 203d 202d 2076 6f6c  b_vector = - vol
+00014eb0: 6d64 6c72 2e56 6563 746f 7232 4428 7869  mdlr.Vector2D(xi
+00014ec0: 202a 2a20 3220 2b20 7969 202a 2a20 3220   ** 2 + yi ** 2 
+00014ed0: 2d20 7873 202a 2a20 3220 2d20 7973 202a  - xs ** 2 - ys *
+00014ee0: 2a20 322c 0a20 2020 2020 2020 2020 2020  * 2,.           
+00014ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014f00: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+00014f10: 6520 2a2a 2032 202b 2079 6520 2a2a 2032  e ** 2 + ye ** 2
+00014f20: 202d 2078 7320 2a2a 2032 202d 2079 7320   - xs ** 2 - ys 
+00014f30: 2a2a 2032 290a 2020 2020 2020 2020 2020  ** 2).          
+00014f40: 2020 696e 765f 6d61 7472 6978 5f61 203d    inv_matrix_a =
+00014f50: 206d 6174 7269 785f 612e 696e 7665 7273   matrix_a.invers
+00014f60: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+00014f70: 7820 3d20 696e 765f 6d61 7472 6978 5f61  x = inv_matrix_a
+00014f80: 2e76 6563 746f 725f 6d75 6c74 6970 6c69  .vector_multipli
+00014f90: 6361 7469 6f6e 2862 5f76 6563 746f 7229  cation(b_vector)
+00014fa0: 0a20 2020 2020 2020 2020 2020 2063 656e  .            cen
+00014fb0: 7465 7220 3d20 766f 6c6d 646c 722e 506f  ter = volmdlr.Po
+00014fc0: 696e 7432 4428 782e 782c 2078 2e79 290a  int2D(x.x, x.y).
+00014fd0: 2020 2020 2020 2020 6578 6365 7074 2056          except V
+00014fe0: 616c 7565 4572 726f 723a 0a20 2020 2020  alueError:.     
+00014ff0: 2020 2020 2020 206d 6174 7269 785f 6120         matrix_a 
+00015000: 3d20 6e70 792e 6172 7261 7928 5b5b 3220  = npy.array([[2 
+00015010: 2a20 2878 7320 2d20 7869 292c 2032 202a  * (xs - xi), 2 *
+00015020: 2028 7973 202d 2079 6929 5d2c 0a20 2020   (ys - yi)],.   
+00015030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015040: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00015050: 3220 2a20 2878 7320 2d20 7865 292c 2032  2 * (xs - xe), 2
+00015060: 202a 2028 7973 202d 2079 6529 5d5d 290a   * (ys - ye)]]).
+00015070: 2020 2020 2020 2020 2020 2020 625f 7665              b_ve
+00015080: 6374 6f72 203d 202d 206e 7079 2e61 7272  ctor = - npy.arr
+00015090: 6179 285b 7869 202a 2a20 3220 2b20 7969  ay([xi ** 2 + yi
+000150a0: 202a 2a20 3220 2d20 7873 202a 2a20 3220   ** 2 - xs ** 2 
+000150b0: 2d20 7973 202a 2a20 322c 0a20 2020 2020  - ys ** 2,.     
+000150c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000150d0: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+000150e0: 6520 2a2a 2032 202b 2079 6520 2a2a 2032  e ** 2 + ye ** 2
+000150f0: 202d 2078 7320 2a2a 2032 202d 2079 7320   - xs ** 2 - ys 
+00015100: 2a2a 2032 5d29 0a20 2020 2020 2020 2020  ** 2]).         
+00015110: 2020 2063 656e 7465 7220 3d20 766f 6c6d     center = volm
+00015120: 646c 722e 506f 696e 7432 4428 2a6e 7079  dlr.Point2D(*npy
+00015130: 2e6c 696e 616c 672e 736f 6c76 6528 6d61  .linalg.solve(ma
+00015140: 7472 6978 5f61 2c20 625f 7665 6374 6f72  trix_a, b_vector
+00015150: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
+00015160: 6e20 6365 6e74 6572 0a0a 2020 2020 4070  n center..    @p
+00015170: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00015180: 6973 5f74 7269 676f 2873 656c 6629 3a0a  is_trigo(self):.
+00015190: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000151a0: 2020 2020 4769 7665 7320 6966 2074 6865      Gives if the
+000151b0: 2065 6467 6520 676f 6573 2069 6e20 7468   edge goes in th
+000151c0: 6520 7472 6967 6f20 6469 7265 6374 696f  e trigo directio
+000151d0: 6e2e 0a20 2020 2020 2020 2022 2222 0a20  n..        """. 
+000151e0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+000151f0: 6c66 2e5f 6973 5f74 7269 676f 3a0a 2020  lf._is_trigo:.  
+00015200: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00015210: 6973 5f74 7269 676f 203d 2073 656c 662e  is_trigo = self.
+00015220: 6765 745f 6172 635f 6469 7265 6374 696f  get_arc_directio
+00015230: 6e28 290a 2020 2020 2020 2020 7265 7475  n().        retu
+00015240: 726e 2073 656c 662e 5f69 735f 7472 6967  rn self._is_trig
+00015250: 6f0a 0a20 2020 2040 7072 6f70 6572 7479  o..    @property
+00015260: 0a20 2020 2064 6566 2063 6c6f 636b 7769  .    def clockwi
+00015270: 7365 5f61 6e64 5f74 7269 676f 7769 7365  se_and_trigowise
+00015280: 5f70 6174 6873 2873 656c 6629 3a0a 2020  _paths(self):.  
+00015290: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+000152a0: 662e 5f63 6c6f 636b 7769 7365 5f61 6e64  f._clockwise_and
+000152b0: 5f74 7269 676f 7769 7365 5f70 6174 6873  _trigowise_paths
+000152c0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+000152d0: 6469 7573 5f31 203d 2073 656c 662e 7374  dius_1 = self.st
+000152e0: 6172 7420 2d20 7365 6c66 2e63 656e 7465  art - self.cente
+000152f0: 720a 2020 2020 2020 2020 2020 2020 7261  r.            ra
+00015300: 6469 7573 5f32 203d 2073 656c 662e 656e  dius_2 = self.en
+00015310: 6420 2d20 7365 6c66 2e63 656e 7465 720a  d - self.center.
+00015320: 2020 2020 2020 2020 2020 2020 7261 6469              radi
+00015330: 7573 5f69 203d 2073 656c 662e 696e 7465  us_i = self.inte
+00015340: 7269 6f72 202d 2073 656c 662e 6365 6e74  rior - self.cent
+00015350: 6572 0a20 2020 2020 2020 2020 2020 2073  er.            s
+00015360: 656c 662e 5f63 6c6f 636b 7769 7365 5f61  elf._clockwise_a
+00015370: 6e64 5f74 7269 676f 7769 7365 5f70 6174  nd_trigowise_pat
+00015380: 6873 203d 5c0a 2020 2020 2020 2020 2020  hs =\.          
+00015390: 2020 2020 2020 7365 6c66 2e67 6574 5f63        self.get_c
+000153a0: 6c6f 636b 7769 7365 5f61 6e64 5f74 7269  lockwise_and_tri
+000153b0: 676f 7769 7365 5f70 6174 6873 2872 6164  gowise_paths(rad
+000153c0: 6975 735f 312c 0a20 2020 2020 2020 2020  ius_1,.         
+000153d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000153e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000153f0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00015400: 6469 7573 5f32 2c0a 2020 2020 2020 2020  dius_2,.        
+00015410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015430: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00015440: 6164 6975 735f 6929 0a20 2020 2020 2020  adius_i).       
+00015450: 2020 2020 2073 656c 662e 5f75 7464 5f63       self._utd_c
+00015460: 6c6f 636b 7769 7365 5f61 6e64 5f74 7269  lockwise_and_tri
+00015470: 676f 7769 7365 5f70 6174 6873 203d 2054  gowise_paths = T
+00015480: 7275 650a 2020 2020 2020 2020 7265 7475  rue.        retu
+00015490: 726e 2073 656c 662e 5f63 6c6f 636b 7769  rn self._clockwi
+000154a0: 7365 5f61 6e64 5f74 7269 676f 7769 7365  se_and_trigowise
+000154b0: 5f70 6174 6873 0a0a 2020 2020 6465 6620  _paths..    def 
+000154c0: 6765 745f 6172 635f 6469 7265 6374 696f  get_arc_directio
+000154d0: 6e28 7365 6c66 293a 0a20 2020 2020 2020  n(self):.       
+000154e0: 2022 2222 0a20 2020 2020 2020 2047 6574   """.        Get
+000154f0: 7320 6172 6320 6469 7265 6374 696f 6e3a  s arc direction:
+00015500: 2063 6c6f 636b 7769 7365 206f 7220 7472   clockwise or tr
+00015510: 6967 6f6e 6f6d 6574 7269 632e 0a0a 2020  igonometric...  
+00015520: 2020 2020 2020 3a72 6574 7572 6e3a 2054        :return: T
+00015530: 7275 6520 6966 2063 6c6f 636b 7769 7365  rue if clockwise
+00015540: 2e20 7472 6967 6f77 6973 6520 6966 2046  . trigowise if F
+00015550: 616c 7365 2e0a 2020 2020 2020 2020 2222  alse..        ""
+00015560: 220a 2020 2020 2020 2020 636c 6f63 6b77  ".        clockw
+00015570: 6973 655f 7061 7468 2c20 7472 6967 6f77  ise_path, trigow
+00015580: 6973 655f 7061 7468 203d 5c0a 2020 2020  ise_path =\.    
+00015590: 2020 2020 2020 2020 7365 6c66 2e63 6c6f          self.clo
+000155a0: 636b 7769 7365 5f61 6e64 5f74 7269 676f  ckwise_and_trigo
+000155b0: 7769 7365 5f70 6174 6873 0a20 2020 2020  wise_paths.     
+000155c0: 2020 2069 6620 636c 6f63 6b77 6973 655f     if clockwise_
+000155d0: 7061 7468 203e 2074 7269 676f 7769 7365  path > trigowise
+000155e0: 5f70 6174 683a 0a20 2020 2020 2020 2020  _path:.         
+000155f0: 2020 2072 6574 7572 6e20 5472 7565 0a20     return True. 
+00015600: 2020 2020 2020 2072 6574 7572 6e20 4661         return Fa
+00015610: 6c73 650a 0a20 2020 2040 7072 6f70 6572  lse..    @proper
+00015620: 7479 0a20 2020 2064 6566 2061 6e67 6c65  ty.    def angle
+00015630: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00015640: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+00015650: 726e 7320 7468 6520 616e 676c 6520 696e  rns the angle in
+00015660: 2072 6164 6961 6e73 206f 6620 7468 6520   radians of the 
+00015670: 6172 632e 0a20 2020 2020 2020 2022 2222  arc..        """
+00015680: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00015690: 7365 6c66 2e5f 616e 676c 653a 0a20 2020  self._angle:.   
+000156a0: 2020 2020 2020 2020 2073 656c 662e 5f61           self._a
+000156b0: 6e67 6c65 203d 2073 656c 662e 6765 745f  ngle = self.get_
+000156c0: 616e 676c 6528 290a 2020 2020 2020 2020  angle().        
+000156d0: 7265 7475 726e 2073 656c 662e 5f61 6e67  return self._ang
+000156e0: 6c65 0a0a 2020 2020 6465 6620 6765 745f  le..    def get_
+000156f0: 616e 676c 6528 7365 6c66 293a 0a20 2020  angle(self):.   
+00015700: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00015710: 2047 6574 7320 6172 6320 616e 676c 652e   Gets arc angle.
+00015720: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00015730: 2020 2020 2020 636c 6f63 6b77 6973 655f        clockwise_
+00015740: 7061 7468 2c20 7472 6967 6f77 6973 655f  path, trigowise_
+00015750: 7061 7468 203d 205c 0a20 2020 2020 2020  path = \.       
+00015760: 2020 2020 2073 656c 662e 636c 6f63 6b77       self.clockw
+00015770: 6973 655f 616e 645f 7472 6967 6f77 6973  ise_and_trigowis
+00015780: 655f 7061 7468 730a 2020 2020 2020 2020  e_paths.        
+00015790: 6966 2073 656c 662e 6973 5f74 7269 676f  if self.is_trigo
+000157a0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000157b0: 7475 726e 2074 7269 676f 7769 7365 5f70  turn trigowise_p
+000157c0: 6174 680a 2020 2020 2020 2020 7265 7475  ath.        retu
+000157d0: 726e 2063 6c6f 636b 7769 7365 5f70 6174  rn clockwise_pat
+000157e0: 680a 0a20 2020 2064 6566 205f 6765 745f  h..    def _get_
+000157f0: 706f 696e 7473 2873 656c 6629 3a0a 2020  points(self):.  
+00015800: 2020 2020 2020 7265 7475 726e 205b 7365        return [se
+00015810: 6c66 2e73 7461 7274 2c20 7365 6c66 2e69  lf.start, self.i
+00015820: 6e74 6572 696f 722c 2073 656c 662e 656e  nterior, self.en
+00015830: 645d 0a0a 2020 2020 706f 696e 7473 203d  d]..    points =
+00015840: 2070 726f 7065 7274 7928 5f67 6574 5f70   property(_get_p
+00015850: 6f69 6e74 7329 0a0a 2020 2020 6465 6620  oints)..    def 
+00015860: 706f 696e 745f 6469 7374 616e 6365 2873  point_distance(s
+00015870: 656c 662c 2070 6f69 6e74 293a 0a20 2020  elf, point):.   
+00015880: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00015890: 2052 6574 7572 6e73 2074 6865 2064 6973   Returns the dis
+000158a0: 7461 6e63 6520 6265 7477 6565 6e20 6120  tance between a 
+000158b0: 706f 696e 7420 616e 6420 7468 6520 6564  point and the ed
+000158c0: 6765 2e0a 2020 2020 2020 2020 2222 220a  ge..        """.
+000158d0: 2020 2020 2020 2020 7665 6374 6f72 5f73          vector_s
+000158e0: 7461 7274 203d 2073 656c 662e 7374 6172  tart = self.star
+000158f0: 7420 2d20 7365 6c66 2e63 656e 7465 720a  t - self.center.
+00015900: 2020 2020 2020 2020 7665 6374 6f72 5f70          vector_p
+00015910: 6f69 6e74 203d 2070 6f69 6e74 202d 2073  oint = point - s
+00015920: 656c 662e 6365 6e74 6572 0a20 2020 2020  elf.center.     
+00015930: 2020 2076 6563 746f 725f 656e 6420 3d20     vector_end = 
+00015940: 7365 6c66 2e65 6e64 202d 2073 656c 662e  self.end - self.
+00015950: 6365 6e74 6572 0a20 2020 2020 2020 2069  center.        i
+00015960: 6620 7365 6c66 2e69 735f 7472 6967 6f3a  f self.is_trigo:
+00015970: 0a20 2020 2020 2020 2020 2020 2076 6563  .            vec
+00015980: 746f 725f 7374 6172 742c 2076 6563 746f  tor_start, vecto
+00015990: 725f 656e 6420 3d20 7665 6374 6f72 5f65  r_end = vector_e
+000159a0: 6e64 2c20 7665 6374 6f72 5f73 7461 7274  nd, vector_start
+000159b0: 0a20 2020 2020 2020 2061 7263 5f61 6e67  .        arc_ang
+000159c0: 6c65 203d 2076 6f6c 6d64 6c72 2e67 656f  le = volmdlr.geo
+000159d0: 6d65 7472 792e 636c 6f63 6b77 6973 655f  metry.clockwise_
+000159e0: 616e 676c 6528 7665 6374 6f72 5f73 7461  angle(vector_sta
+000159f0: 7274 2c20 7665 6374 6f72 5f65 6e64 290a  rt, vector_end).
+00015a00: 2020 2020 2020 2020 706f 696e 745f 616e          point_an
+00015a10: 676c 6520 3d20 766f 6c6d 646c 722e 6765  gle = volmdlr.ge
+00015a20: 6f6d 6574 7279 2e63 6c6f 636b 7769 7365  ometry.clockwise
+00015a30: 5f61 6e67 6c65 2876 6563 746f 725f 7374  _angle(vector_st
+00015a40: 6172 742c 2076 6563 746f 725f 706f 696e  art, vector_poin
+00015a50: 7429 0a20 2020 2020 2020 2069 6620 706f  t).        if po
+00015a60: 696e 745f 616e 676c 6520 3c3d 2061 7263  int_angle <= arc
+00015a70: 5f61 6e67 6c65 3a0a 2020 2020 2020 2020  _angle:.        
+00015a80: 2020 2020 7265 7475 726e 2061 6273 280a      return abs(.
+00015a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015aa0: 4c69 6e65 5365 676d 656e 7432 4428 706f  LineSegment2D(po
+00015ab0: 696e 742c 2073 656c 662e 6365 6e74 6572  int, self.center
+00015ac0: 292e 6c65 6e67 7468 2829 202d 2073 656c  ).length() - sel
+00015ad0: 662e 7261 6469 7573 290a 2020 2020 2020  f.radius).      
+00015ae0: 2020 7265 7475 726e 206d 696e 284c 696e    return min(Lin
+00015af0: 6553 6567 6d65 6e74 3244 2870 6f69 6e74  eSegment2D(point
+00015b00: 2c20 7365 6c66 2e73 7461 7274 292e 6c65  , self.start).le
+00015b10: 6e67 7468 2829 2c20 4c69 6e65 5365 676d  ngth(), LineSegm
+00015b20: 656e 7432 4428 706f 696e 742c 2073 656c  ent2D(point, sel
+00015b30: 662e 656e 6429 2e6c 656e 6774 6828 2929  f.end).length())
+00015b40: 0a0a 2020 2020 6465 6620 706f 696e 745f  ..    def point_
+00015b50: 6265 6c6f 6e67 7328 7365 6c66 2c20 706f  belongs(self, po
+00015b60: 696e 7432 642c 2061 6273 5f74 6f6c 3d31  int2d, abs_tol=1
+00015b70: 652d 3130 293a 0a20 2020 2020 2020 2022  e-10):.        "
+00015b80: 2222 0a20 2020 2020 2020 2043 6865 636b  "".        Check
+00015b90: 2069 6620 6120 506f 696e 7432 4420 6265   if a Point2D be
+00015ba0: 6c6f 6e67 7320 746f 2074 6865 2041 7263  longs to the Arc
+00015bb0: 3244 2e0a 0a20 2020 2020 2020 2022 2222  2D...        """
+00015bc0: 0a20 2020 2020 2020 2064 6973 7461 6e63  .        distanc
+00015bd0: 655f 706f 696e 745f 746f 5f63 656e 7465  e_point_to_cente
+00015be0: 7220 3d20 706f 696e 7432 642e 706f 696e  r = point2d.poin
+00015bf0: 745f 6469 7374 616e 6365 2873 656c 662e  t_distance(self.
+00015c00: 6365 6e74 6572 290a 2020 2020 2020 2020  center).        
+00015c10: 6966 206e 6f74 206d 6174 682e 6973 636c  if not math.iscl
+00015c20: 6f73 6528 6469 7374 616e 6365 5f70 6f69  ose(distance_poi
+00015c30: 6e74 5f74 6f5f 6365 6e74 6572 2c20 7365  nt_to_center, se
+00015c40: 6c66 2e72 6164 6975 732c 2061 6273 5f74  lf.radius, abs_t
+00015c50: 6f6c 3d61 6273 5f74 6f6c 293a 0a20 2020  ol=abs_tol):.   
+00015c60: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00015c70: 4661 6c73 650a 2020 2020 2020 2020 7472  False.        tr
+00015c80: 793a 0a20 2020 2020 2020 2020 2020 2070  y:.            p
+00015c90: 6f69 6e74 5f61 6273 6369 7373 6120 3d20  oint_abscissa = 
+00015ca0: 7365 6c66 2e61 6273 6369 7373 6128 706f  self.abscissa(po
+00015cb0: 696e 7432 6429 0a20 2020 2020 2020 2065  int2d).        e
+00015cc0: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
+00015cd0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00015ce0: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
+00015cf0: 2020 2069 6620 7365 6c66 2e6c 656e 6774     if self.lengt
+00015d00: 6828 2920 3e3d 2070 6f69 6e74 5f61 6273  h() >= point_abs
+00015d10: 6369 7373 6120 3e3d 2030 3a0a 2020 2020  cissa >= 0:.    
+00015d20: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+00015d30: 7275 650a 2020 2020 2020 2020 7265 7475  rue.        retu
+00015d40: 726e 2046 616c 7365 0a0a 2020 2020 6465  rn False..    de
+00015d50: 6620 746f 5f66 756c 6c5f 6172 635f 3264  f to_full_arc_2d
+00015d60: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00015d70: 2222 220a 2020 2020 2020 2020 436f 6e76  """.        Conv
+00015d80: 6572 7420 746f 2061 2066 756c 6c20 6172  ert to a full ar
+00015d90: 6332 642e 0a20 2020 2020 2020 2022 2222  c2d..        """
+00015da0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00015db0: 4675 6c6c 4172 6332 4428 6365 6e74 6572  FullArc2D(center
+00015dc0: 3d73 656c 662e 6365 6e74 6572 2c0a 2020  =self.center,.  
+00015dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015de0: 2020 2020 2020 2073 7461 7274 5f65 6e64         start_end
+00015df0: 3d73 656c 662e 706f 696e 745f 6174 5f61  =self.point_at_a
+00015e00: 6273 6369 7373 6128 3029 2c0a 2020 2020  bscissa(0),.    
+00015e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015e20: 2020 2020 206e 616d 653d 7365 6c66 2e6e       name=self.n
+00015e30: 616d 6529 0a0a 2020 2020 6465 6620 6c69  ame)..    def li
+00015e40: 6e65 5f69 6e74 6572 7365 6374 696f 6e73  ne_intersections
+00015e50: 2873 656c 662c 206c 696e 6532 643a 204c  (self, line2d: L
+00015e60: 696e 6532 4429 3a0a 2020 2020 2020 2020  ine2D):.        
+00015e70: 2222 220a 2020 2020 2020 2020 4361 6c63  """.        Calc
+00015e80: 756c 6174 6573 2074 6865 2069 6e74 6572  ulates the inter
+00015e90: 7365 6374 696f 6e20 6265 7477 6565 6e20  section between 
+00015ea0: 6120 6c69 6e65 2061 6e64 2061 6e20 4172  a line and an Ar
+00015eb0: 6332 442e 0a0a 2020 2020 2020 2020 3a70  c2D...        :p
+00015ec0: 6172 616d 206c 696e 6532 643a 204c 696e  aram line2d: Lin
+00015ed0: 6532 4420 746f 2076 6572 6966 7920 696e  e2D to verify in
+00015ee0: 7465 7273 6563 7469 6f6e 732e 0a20 2020  tersections..   
+00015ef0: 2020 2020 203a 7265 7475 726e 3a20 6120       :return: a 
+00015f00: 6c69 7374 2077 6974 6820 696e 7465 7273  list with inters
+00015f10: 6563 7469 6f6e 7320 706f 696e 7473 2e0a  ections points..
+00015f20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00015f30: 2020 2020 2320 6369 7263 6c65 203d 2073      # circle = s
+00015f40: 656c 662e 746f 5f63 6972 636c 6528 290a  elf.to_circle().
+00015f50: 2020 2020 2020 2020 2320 6369 7263 6c65          # circle
+00015f60: 5f69 6e74 6572 7365 6374 696f 6e5f 706f  _intersection_po
+00015f70: 696e 7473 203d 2063 6972 636c 652e 6c69  ints = circle.li
+00015f80: 6e65 5f69 6e74 6572 7365 6374 696f 6e73  ne_intersections
+00015f90: 286c 696e 6532 6429 0a20 2020 2020 2020  (line2d).       
+00015fa0: 2066 756c 6c5f 6172 635f 3264 203d 2073   full_arc_2d = s
+00015fb0: 656c 662e 746f 5f66 756c 6c5f 6172 635f  elf.to_full_arc_
+00015fc0: 3264 2829 0a20 2020 2020 2020 2066 6132  2d().        fa2
+00015fd0: 645f 696e 7465 7273 6563 7469 6f6e 5f70  d_intersection_p
+00015fe0: 6f69 6e74 7320 3d20 6675 6c6c 5f61 7263  oints = full_arc
+00015ff0: 5f32 642e 6c69 6e65 5f69 6e74 6572 7365  _2d.line_interse
+00016000: 6374 696f 6e73 286c 696e 6532 6429 0a20  ctions(line2d). 
+00016010: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
+00016020: 696f 6e5f 706f 696e 7473 203d 205b 5d0a  ion_points = [].
+00016030: 2020 2020 2020 2020 666f 7220 7074 2069          for pt i
+00016040: 6e20 6661 3264 5f69 6e74 6572 7365 6374  n fa2d_intersect
+00016050: 696f 6e5f 706f 696e 7473 3a0a 2020 2020  ion_points:.    
+00016060: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00016070: 706f 696e 745f 6265 6c6f 6e67 7328 7074  point_belongs(pt
+00016080: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00016090: 2020 2069 6e74 6572 7365 6374 696f 6e5f     intersection_
+000160a0: 706f 696e 7473 2e61 7070 656e 6428 7074  points.append(pt
+000160b0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000160c0: 2069 6e74 6572 7365 6374 696f 6e5f 706f   intersection_po
+000160d0: 696e 7473 0a0a 2020 2020 6465 6620 6c69  ints..    def li
+000160e0: 6e65 7365 676d 656e 745f 696e 7465 7273  nesegment_inters
+000160f0: 6563 7469 6f6e 7328 7365 6c66 2c20 6c69  ections(self, li
+00016100: 6e65 7365 676d 656e 7432 643a 204c 696e  nesegment2d: Lin
+00016110: 6553 6567 6d65 6e74 3244 293a 0a20 2020  eSegment2D):.   
+00016120: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00016130: 2043 616c 6375 6c61 7465 7320 7468 6520   Calculates the 
+00016140: 696e 7465 7273 6563 7469 6f6e 2062 6574  intersection bet
+00016150: 7765 656e 2061 204c 696e 6553 6567 6d65  ween a LineSegme
+00016160: 6e74 3244 2061 6e64 2061 6e20 4172 6332  nt2D and an Arc2
+00016170: 442e 0a0a 2020 2020 2020 2020 3a70 6172  D...        :par
+00016180: 616d 206c 696e 6532 643a 204c 696e 6553  am line2d: LineS
+00016190: 6567 6d65 6e74 3244 2074 6f20 7665 7269  egment2D to veri
+000161a0: 6679 2069 6e74 6572 7365 6374 696f 6e73  fy intersections
+000161b0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+000161c0: 6e3a 2061 206c 6973 7420 7769 7468 2069  n: a list with i
+000161d0: 6e74 6572 7365 6374 696f 6e73 2070 6f69  ntersections poi
+000161e0: 6e74 732e 0a20 2020 2020 2020 2022 2222  nts..        """
+000161f0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00016200: 7365 6c66 2e62 6f75 6e64 696e 675f 7265  self.bounding_re
+00016210: 6374 616e 676c 652e 625f 7265 6374 616e  ctangle.b_rectan
+00016220: 676c 655f 696e 7465 7273 6563 7469 6f6e  gle_intersection
+00016230: 286c 696e 6573 6567 6d65 6e74 3264 2e62  (linesegment2d.b
+00016240: 6f75 6e64 696e 675f 7265 6374 616e 676c  ounding_rectangl
+00016250: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00016260: 7265 7475 726e 205b 5d0a 2020 2020 2020  return [].      
+00016270: 2020 6675 6c6c 5f61 7263 5f32 6420 3d20    full_arc_2d = 
+00016280: 7365 6c66 2e74 6f5f 6675 6c6c 5f61 7263  self.to_full_arc
+00016290: 5f32 6428 290a 2020 2020 2020 2020 6661  _2d().        fa
+000162a0: 3264 5f69 6e74 6572 7365 6374 696f 6e5f  2d_intersection_
+000162b0: 706f 696e 7473 203d 2066 756c 6c5f 6172  points = full_ar
+000162c0: 635f 3264 2e6c 696e 6573 6567 6d65 6e74  c_2d.linesegment
+000162d0: 5f69 6e74 6572 7365 6374 696f 6e73 280a  _intersections(.
+000162e0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+000162f0: 7365 676d 656e 7432 6429 0a20 2020 2020  segment2d).     
+00016300: 2020 2069 6e74 6572 7365 6374 696f 6e5f     intersection_
+00016310: 706f 696e 7473 203d 205b 5d0a 2020 2020  points = [].    
+00016320: 2020 2020 666f 7220 7074 2069 6e20 6661      for pt in fa
+00016330: 3264 5f69 6e74 6572 7365 6374 696f 6e5f  2d_intersection_
+00016340: 706f 696e 7473 3a0a 2020 2020 2020 2020  points:.        
+00016350: 2020 2020 6966 2073 656c 662e 706f 696e      if self.poin
+00016360: 745f 6265 6c6f 6e67 7328 7074 293a 0a20  t_belongs(pt):. 
+00016370: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00016380: 6e74 6572 7365 6374 696f 6e5f 706f 696e  ntersection_poin
+00016390: 7473 2e61 7070 656e 6428 7074 290a 2020  ts.append(pt).  
+000163a0: 2020 2020 2020 7265 7475 726e 2069 6e74        return int
+000163b0: 6572 7365 6374 696f 6e5f 706f 696e 7473  ersection_points
+000163c0: 0a0a 2020 2020 6465 6620 6162 7363 6973  ..    def abscis
+000163d0: 7361 2873 656c 662c 2070 6f69 6e74 3264  sa(self, point2d
+000163e0: 3a20 766f 6c6d 646c 722e 506f 696e 7432  : volmdlr.Point2
+000163f0: 442c 2074 6f6c 3d31 652d 3929 3a0a 2020  D, tol=1e-9):.  
+00016400: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00016410: 2020 5265 7475 726e 7320 7468 6520 6162    Returns the ab
+00016420: 7363 6973 7361 206f 6620 6120 6769 7665  scissa of a give
+00016430: 6e20 706f 696e 7432 642e 0a20 2020 2020  n point2d..     
+00016440: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+00016450: 6620 706f 696e 7432 642e 706f 696e 745f  f point2d.point_
+00016460: 6469 7374 616e 6365 2873 656c 662e 7374  distance(self.st
+00016470: 6172 7429 203c 2074 6f6c 3a0a 2020 2020  art) < tol:.    
+00016480: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
+00016490: 0a20 2020 2020 2020 2069 6620 706f 696e  .        if poin
+000164a0: 7432 642e 706f 696e 745f 6469 7374 616e  t2d.point_distan
+000164b0: 6365 2873 656c 662e 656e 6429 203c 2074  ce(self.end) < t
+000164c0: 6f6c 3a0a 2020 2020 2020 2020 2020 2020  ol:.            
+000164d0: 7265 7475 726e 2073 656c 662e 6c65 6e67  return self.leng
+000164e0: 7468 2829 0a0a 2020 2020 2020 2020 7020  th()..        p 
+000164f0: 3d20 706f 696e 7432 6420 2d20 7365 6c66  = point2d - self
+00016500: 2e63 656e 7465 720a 2020 2020 2020 2020  .center.        
+00016510: 7520 3d20 7365 6c66 2e73 7461 7274 202d  u = self.start -
+00016520: 2073 656c 662e 6365 6e74 6572 0a20 2020   self.center.   
+00016530: 2020 2020 2075 2e6e 6f72 6d61 6c69 7a65       u.normalize
+00016540: 2829 0a20 2020 2020 2020 2069 6620 7365  ().        if se
+00016550: 6c66 2e69 735f 7472 6967 6f3a 0a20 2020  lf.is_trigo:.   
+00016560: 2020 2020 2020 2020 2076 203d 2075 2e6e           v = u.n
+00016570: 6f72 6d61 6c5f 7665 6374 6f72 2829 0a20  ormal_vector(). 
+00016580: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00016590: 2020 2020 2020 2020 2076 203d 202d 752e           v = -u.
+000165a0: 6e6f 726d 616c 5f76 6563 746f 7228 290a  normal_vector().
+000165b0: 0a20 2020 2020 2020 2078 2c20 7920 3d20  .        x, y = 
+000165c0: 702e 646f 7428 7529 2c20 702e 646f 7428  p.dot(u), p.dot(
+000165d0: 7629 0a20 2020 2020 2020 2074 6865 7461  v).        theta
+000165e0: 203d 206d 6174 682e 6174 616e 3228 792c   = math.atan2(y,
+000165f0: 2078 290a 2020 2020 2020 2020 6966 2074   x).        if t
+00016600: 6865 7461 203c 202d 746f 6c20 6f72 2074  heta < -tol or t
+00016610: 6865 7461 203e 2073 656c 662e 616e 676c  heta > self.angl
+00016620: 6520 2b20 746f 6c3a 0a20 2020 2020 2020  e + tol:.       
+00016630: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00016640: 4572 726f 7228 2750 6f69 6e74 206e 6f74  Error('Point not
+00016650: 2069 6e20 6172 6327 290a 0a20 2020 2020   in arc')..     
+00016660: 2020 2069 6620 7468 6574 6120 3c20 303a     if theta < 0:
+00016670: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00016680: 7572 6e20 302e 0a20 2020 2020 2020 2069  urn 0..        i
+00016690: 6620 7468 6574 6120 3e20 7365 6c66 2e61  f theta > self.a
+000166a0: 6e67 6c65 3a0a 2020 2020 2020 2020 2020  ngle:.          
+000166b0: 2020 7265 7475 726e 2073 656c 662e 616e    return self.an
+000166c0: 676c 6520 2a20 7365 6c66 2e72 6164 6975  gle * self.radiu
+000166d0: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
+000166e0: 6e20 7365 6c66 2e72 6164 6975 7320 2a20  n self.radius * 
+000166f0: 7468 6574 610a 0a20 2020 2064 6566 2064  theta..    def d
+00016700: 6972 6563 7469 6f6e 5f76 6563 746f 7228  irection_vector(
+00016710: 7365 6c66 2c20 6162 7363 6973 7361 3a20  self, abscissa: 
+00016720: 666c 6f61 7429 3a0a 2020 2020 2020 2020  float):.        
+00016730: 2222 220a 2020 2020 2020 2020 4765 7420  """.        Get 
+00016740: 6469 7265 6374 696f 6e20 7665 6374 6f72  direction vector
+00016750: 206f 6620 7468 6520 4172 6332 442e 0a0a   of the Arc2D...
+00016760: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
+00016770: 6273 6369 7373 613a 2064 6566 696e 6573  bscissa: defines
+00016780: 2077 6865 7265 2069 6e20 7468 6520 4172   where in the Ar
+00016790: 6332 4420 7468 650a 2020 2020 2020 2020  c2D the.        
+000167a0: 6469 7265 6374 696f 6e20 7665 6374 6f72  direction vector
+000167b0: 2069 7320 746f 2062 6520 6361 6c63 756c   is to be calcul
+000167c0: 6174 6564 0a20 2020 2020 2020 203a 7265  ated.        :re
+000167d0: 7475 726e 3a20 5468 6520 6469 7265 6374  turn: The direct
+000167e0: 696f 6e20 7665 6374 6f72 206f 6620 7468  ion vector of th
+000167f0: 6520 4172 6332 440a 2020 2020 2020 2020  e Arc2D.        
+00016800: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+00016810: 726e 202d 7365 6c66 2e6e 6f72 6d61 6c5f  rn -self.normal_
+00016820: 7665 6374 6f72 2861 6273 6369 7373 613d  vector(abscissa=
+00016830: 6162 7363 6973 7361 292e 6e6f 726d 616c  abscissa).normal
+00016840: 5f76 6563 746f 7228 290a 0a20 2020 2064  _vector()..    d
+00016850: 6566 2075 6e69 745f 6469 7265 6374 696f  ef unit_directio
+00016860: 6e5f 7665 6374 6f72 2873 656c 662c 2061  n_vector(self, a
+00016870: 6273 6369 7373 613a 2066 6c6f 6174 293a  bscissa: float):
+00016880: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00016890: 2020 2020 2047 6574 2075 6e69 7420 6469       Get unit di
+000168a0: 7265 6374 696f 6e20 7665 6374 6f72 206f  rection vector o
+000168b0: 6620 7468 6520 4172 6332 442e 0a0a 2020  f the Arc2D...  
+000168c0: 2020 2020 2020 3a70 6172 616d 2061 6273        :param abs
+000168d0: 6369 7373 613a 2064 6566 696e 6573 2077  cissa: defines w
+000168e0: 6865 7265 2069 6e20 7468 6520 4172 6332  here in the Arc2
+000168f0: 4420 7468 650a 2020 2020 2020 2020 756e  D the.        un
+00016900: 6974 2064 6972 6563 7469 6f6e 2076 6563  it direction vec
+00016910: 746f 7220 6973 2074 6f20 6265 2063 616c  tor is to be cal
+00016920: 6375 6c61 7465 640a 0a20 2020 2020 2020  culated..       
+00016930: 203a 7265 7475 726e 3a20 5468 6520 756e   :return: The un
+00016940: 6974 2064 6972 6563 7469 6f6e 2076 6563  it direction vec
+00016950: 746f 7220 6f66 2074 6865 2041 7263 3244  tor of the Arc2D
+00016960: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00016970: 2020 2020 2064 6972 6563 7469 6f6e 5f76       direction_v
+00016980: 6563 746f 7220 3d20 7365 6c66 2e64 6972  ector = self.dir
+00016990: 6563 7469 6f6e 5f76 6563 746f 7228 6162  ection_vector(ab
+000169a0: 7363 6973 7361 290a 2020 2020 2020 2020  scissa).        
+000169b0: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
+000169c0: 2e6e 6f72 6d61 6c69 7a65 2829 0a20 2020  .normalize().   
+000169d0: 2020 2020 2072 6574 7572 6e20 6469 7265       return dire
+000169e0: 6374 696f 6e5f 7665 6374 6f72 0a0a 2020  ction_vector..  
+000169f0: 2020 6465 6620 6e6f 726d 616c 5f76 6563    def normal_vec
+00016a00: 746f 7228 7365 6c66 2c20 6162 7363 6973  tor(self, abscis
+00016a10: 7361 3a20 666c 6f61 7429 3a0a 2020 2020  sa: float):.    
+00016a20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00016a30: 4765 7420 7468 6520 6e6f 726d 616c 2076  Get the normal v
+00016a40: 6563 746f 7220 6f66 2074 6865 2041 7263  ector of the Arc
+00016a50: 3244 2e0a 0a20 2020 2020 2020 203a 7061  2D...        :pa
+00016a60: 7261 6d20 6162 7363 6973 7361 3a20 6465  ram abscissa: de
+00016a70: 6669 6e65 7320 7768 6572 6520 696e 2074  fines where in t
+00016a80: 6865 2041 7263 3244 2074 6865 0a20 2020  he Arc2D the.   
+00016a90: 2020 2020 206e 6f72 6d61 6c20 7665 6374       normal vect
+00016aa0: 6f72 2069 7320 746f 2062 6520 6361 6c63  or is to be calc
+00016ab0: 756c 6174 6564 0a20 2020 2020 2020 203a  ulated.        :
+00016ac0: 7265 7475 726e 3a20 5468 6520 6e6f 726d  return: The norm
+00016ad0: 616c 2076 6563 746f 7220 6f66 2074 6865  al vector of the
+00016ae0: 2041 7263 3244 0a20 2020 2020 2020 2022   Arc2D.        "
+00016af0: 2222 0a20 2020 2020 2020 2070 6f69 6e74  "".        point
+00016b00: 203d 2073 656c 662e 706f 696e 745f 6174   = self.point_at
+00016b10: 5f61 6273 6369 7373 6128 6162 7363 6973  _abscissa(abscis
+00016b20: 7361 290a 2020 2020 2020 2020 2320 6966  sa).        # if
+00016b30: 2073 656c 662e 6973 5f74 7269 676f 3a0a   self.is_trigo:.
+00016b40: 2020 2020 2020 2020 6e6f 726d 616c 5f76          normal_v
+00016b50: 6563 746f 7220 3d20 7365 6c66 2e63 656e  ector = self.cen
+00016b60: 7465 7220 2d20 706f 696e 740a 2020 2020  ter - point.    
+00016b70: 2020 2020 2320 656c 7365 3a0a 2020 2020      # else:.    
+00016b80: 2020 2020 2320 2020 2020 6e6f 726d 616c      #     normal
+00016b90: 5f76 6563 746f 7220 3d20 706f 696e 7420  _vector = point 
+00016ba0: 2d20 7365 6c66 2e63 656e 7465 720a 2020  - self.center.  
+00016bb0: 2020 2020 2020 7265 7475 726e 206e 6f72        return nor
+00016bc0: 6d61 6c5f 7665 6374 6f72 0a0a 2020 2020  mal_vector..    
+00016bd0: 6465 6620 756e 6974 5f6e 6f72 6d61 6c5f  def unit_normal_
+00016be0: 7665 6374 6f72 2873 656c 662c 2061 6273  vector(self, abs
+00016bf0: 6369 7373 613a 2066 6c6f 6174 293a 0a20  cissa: float):. 
+00016c00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00016c10: 2020 2047 6574 2074 6865 2075 6e69 7420     Get the unit 
+00016c20: 6e6f 726d 616c 2076 6563 746f 7220 6f66  normal vector of
+00016c30: 2074 6865 2041 7263 3244 2e0a 0a20 2020   the Arc2D...   
+00016c40: 2020 2020 203a 7061 7261 6d20 6162 7363       :param absc
+00016c50: 6973 7361 3a20 6465 6669 6e65 7320 7768  issa: defines wh
+00016c60: 6572 6520 696e 2074 6865 2041 7263 3244  ere in the Arc2D
+00016c70: 2074 6865 0a20 2020 2020 2020 2075 6e69   the.        uni
+00016c80: 7420 6e6f 726d 616c 2076 6563 746f 7220  t normal vector 
+00016c90: 6973 2074 6f20 6265 2063 616c 6375 6c61  is to be calcula
+00016ca0: 7465 640a 2020 2020 2020 2020 3a72 6574  ted.        :ret
+00016cb0: 7572 6e3a 2054 6865 2075 6e69 7420 6e6f  urn: The unit no
+00016cc0: 726d 616c 2076 6563 746f 7220 6f66 2074  rmal vector of t
+00016cd0: 6865 2041 7263 3244 0a20 2020 2020 2020  he Arc2D.       
+00016ce0: 2022 2222 0a20 2020 2020 2020 206e 6f72   """.        nor
+00016cf0: 6d61 6c5f 7665 6374 6f72 203d 2073 656c  mal_vector = sel
+00016d00: 662e 6e6f 726d 616c 5f76 6563 746f 7228  f.normal_vector(
+00016d10: 6162 7363 6973 7361 290a 2020 2020 2020  abscissa).      
+00016d20: 2020 6e6f 726d 616c 5f76 6563 746f 722e    normal_vector.
+00016d30: 6e6f 726d 616c 697a 6528 290a 2020 2020  normalize().    
+00016d40: 2020 2020 7265 7475 726e 206e 6f72 6d61      return norma
+00016d50: 6c5f 7665 6374 6f72 0a0a 2020 2020 6465  l_vector..    de
+00016d60: 6620 6172 6561 2873 656c 6629 3a0a 2020  f area(self):.  
+00016d70: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00016d80: 2020 4361 6c63 756c 6174 6573 2074 6865    Calculates the
+00016d90: 2061 7265 6120 6f66 2074 6865 2041 7263   area of the Arc
+00016da0: 3244 2e0a 0a20 2020 2020 2020 203a 7265  2D...        :re
+00016db0: 7475 726e 3a20 7468 6520 6172 6561 206f  turn: the area o
+00016dc0: 6620 7468 6520 4172 6332 442e 0a20 2020  f the Arc2D..   
+00016dd0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00016de0: 2072 6574 7572 6e20 7365 6c66 2e72 6164   return self.rad
+00016df0: 6975 7320 2a2a 2032 202a 2073 656c 662e  ius ** 2 * self.
+00016e00: 616e 676c 6520 2f20 320a 0a20 2020 2064  angle / 2..    d
+00016e10: 6566 2063 656e 7465 725f 6f66 5f6d 6173  ef center_of_mas
+00016e20: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+00016e30: 2022 2222 0a20 2020 2020 2020 2043 616c   """.        Cal
+00016e40: 6375 6c61 7465 7320 7468 6520 6365 6e74  culates the cent
+00016e50: 6572 206f 6620 6d61 7373 206f 6620 7468  er of mass of th
+00016e60: 6520 4172 6332 442e 0a0a 2020 2020 2020  e Arc2D...      
+00016e70: 2020 3a72 6574 7572 6e3a 2063 656e 7465    :return: cente
+00016e80: 7220 6f66 206d 6173 7320 706f 696e 742e  r of mass point.
+00016e90: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00016ea0: 2020 2020 2023 2020 2020 2020 2020 753d       #        u=
+00016eb0: 7365 6c66 2e6d 6964 646c 652e 7665 6374  self.middle.vect
+00016ec0: 6f72 2d73 656c 662e 6365 6e74 6572 2e76  or-self.center.v
+00016ed0: 6563 746f 720a 2020 2020 2020 2020 7520  ector.        u 
+00016ee0: 3d20 7365 6c66 2e6d 6964 646c 655f 706f  = self.middle_po
+00016ef0: 696e 7428 2920 2d20 7365 6c66 2e63 656e  int() - self.cen
+00016f00: 7465 720a 2020 2020 2020 2020 752e 6e6f  ter.        u.no
+00016f10: 726d 616c 697a 6528 290a 2020 2020 2020  rmalize().      
+00016f20: 2020 2320 616c 7068 6120 3d20 6162 7328    # alpha = abs(
+00016f30: 7365 6c66 2e61 6e67 6c65 290a 2020 2020  self.angle).    
+00016f40: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00016f50: 6365 6e74 6572 202b 2034 202f 2028 3320  center + 4 / (3 
+00016f60: 2a20 7365 6c66 2e61 6e67 6c65 2920 2a20  * self.angle) * 
+00016f70: 7365 6c66 2e72 6164 6975 7320 2a20 6d61  self.radius * ma
+00016f80: 7468 2e73 696e 280a 2020 2020 2020 2020  th.sin(.        
+00016f90: 2020 2020 7365 6c66 2e61 6e67 6c65 202a      self.angle *
+00016fa0: 2030 2e35 2920 2a20 750a 0a20 2020 2040   0.5) * u..    @
+00016fb0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00016fc0: 2062 6f75 6e64 696e 675f 7265 6374 616e   bounding_rectan
+00016fd0: 676c 6528 7365 6c66 293a 0a20 2020 2020  gle(self):.     
+00016fe0: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
+00016ff0: 626f 756e 6469 6e67 5f72 6563 7461 6e67  bounding_rectang
+00017000: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+00017010: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
+00017020: 6f69 6e74 7320 3d20 7365 6c66 2e64 6973  oints = self.dis
+00017030: 6372 6574 697a 6174 696f 6e5f 706f 696e  cretization_poin
+00017040: 7473 286e 756d 6265 725f 706f 696e 7473  ts(number_points
+00017050: 3d32 3029 0a20 2020 2020 2020 2020 2020  =20).           
+00017060: 2078 5f76 616c 7565 732c 2079 5f76 616c   x_values, y_val
+00017070: 7565 7320 3d20 5b5d 2c20 5b5d 0a20 2020  ues = [], [].   
+00017080: 2020 2020 2020 2020 2066 6f72 2070 6f69           for poi
+00017090: 6e74 2069 6e20 6469 7363 7265 7469 7a61  nt in discretiza
+000170a0: 7469 6f6e 5f70 6f69 6e74 733a 0a20 2020  tion_points:.   
+000170b0: 2020 2020 2020 2020 2020 2020 2078 5f76               x_v
+000170c0: 616c 7565 732e 6170 7065 6e64 2870 6f69  alues.append(poi
+000170d0: 6e74 2e78 290a 2020 2020 2020 2020 2020  nt.x).          
+000170e0: 2020 2020 2020 795f 7661 6c75 6573 2e61        y_values.a
+000170f0: 7070 656e 6428 706f 696e 742e 7929 0a20  ppend(point.y). 
+00017100: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00017110: 5f62 6f75 6e64 696e 675f 7265 6374 616e  _bounding_rectan
+00017120: 676c 6520 3d20 766f 6c6d 646c 722e 636f  gle = volmdlr.co
+00017130: 7265 2e42 6f75 6e64 696e 6752 6563 7461  re.BoundingRecta
+00017140: 6e67 6c65 286d 696e 2878 5f76 616c 7565  ngle(min(x_value
+00017150: 7329 2c20 6d61 7828 785f 7661 6c75 6573  s), max(x_values
+00017160: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00017170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000171a0: 2020 2020 2020 2020 206d 696e 2879 5f76           min(y_v
+000171b0: 616c 7565 7329 2c20 6d61 7828 795f 7661  alues), max(y_va
+000171c0: 6c75 6573 2929 0a20 2020 2020 2020 2072  lues)).        r
+000171d0: 6574 7572 6e20 7365 6c66 2e5f 626f 756e  eturn self._boun
+000171e0: 6469 6e67 5f72 6563 7461 6e67 6c65 0a0a  ding_rectangle..
+000171f0: 2020 2020 6465 6620 7374 7261 6967 6874      def straight
+00017200: 5f6c 696e 655f 6172 6561 2873 656c 6629  _line_area(self)
+00017210: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00017220: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
+00017230: 2074 6865 2061 7265 6120 6f66 2074 6865   the area of the
+00017240: 2061 7263 3264 2c20 7769 7468 206c 696e   arc2d, with lin
+00017250: 6520 6472 6177 6e20 6672 6f6d 2073 7461  e drawn from sta
+00017260: 7274 2074 6f20 656e 642e 0a0a 2020 2020  rt to end...    
+00017270: 2020 2020 3a72 6574 7572 6e3a 2073 7472      :return: str
+00017280: 6169 6768 745f 6c69 6e65 5f61 7265 612e  aight_line_area.
+00017290: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000172a0: 2020 2020 2069 6620 7365 6c66 2e61 6e67       if self.ang
+000172b0: 6c65 203e 3d20 6d61 7468 2e70 693a 0a20  le >= math.pi:. 
+000172c0: 2020 2020 2020 2020 2020 2061 6e67 6c65             angle
+000172d0: 203d 2076 6f6c 6d64 6c72 2e54 574f 5f50   = volmdlr.TWO_P
+000172e0: 4920 2d20 7365 6c66 2e61 6e67 6c65 0a20  I - self.angle. 
+000172f0: 2020 2020 2020 2020 2020 2061 7265 6120             area 
+00017300: 3d20 6d61 7468 2e70 6920 2a20 7365 6c66  = math.pi * self
+00017310: 2e72 6164 6975 7320 2a2a 2032 202d 2030  .radius ** 2 - 0
+00017320: 2e35 202a 2073 656c 662e 7261 6469 7573  .5 * self.radius
+00017330: 202a 2a20 3220 2a20 280a 2020 2020 2020   ** 2 * (.      
+00017340: 2020 2020 2020 2020 2020 616e 676c 6520            angle 
+00017350: 2d20 6d61 7468 2e73 696e 2861 6e67 6c65  - math.sin(angle
+00017360: 2929 0a20 2020 2020 2020 2065 6c73 653a  )).        else:
+00017370: 0a20 2020 2020 2020 2020 2020 2061 6e67  .            ang
+00017380: 6c65 203d 2073 656c 662e 616e 676c 650a  le = self.angle.
+00017390: 2020 2020 2020 2020 2020 2020 6172 6561              area
+000173a0: 203d 2030 2e35 202a 2073 656c 662e 7261   = 0.5 * self.ra
+000173b0: 6469 7573 202a 2a20 3220 2a20 2861 6e67  dius ** 2 * (ang
+000173c0: 6c65 202d 206d 6174 682e 7369 6e28 616e  le - math.sin(an
+000173d0: 676c 6529 290a 0a20 2020 2020 2020 2069  gle))..        i
+000173e0: 6620 7365 6c66 2e69 735f 7472 6967 6f3a  f self.is_trigo:
+000173f0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00017400: 7572 6e20 6172 6561 0a20 2020 2020 2020  urn area.       
+00017410: 2072 6574 7572 6e20 2d61 7265 610a 0a20   return -area.. 
+00017420: 2020 2064 6566 2073 7472 6169 6768 745f     def straight_
+00017430: 6c69 6e65 5f73 6563 6f6e 645f 6d6f 6d65  line_second_mome
+00017440: 6e74 5f61 7265 6128 7365 6c66 2c20 706f  nt_area(self, po
+00017450: 696e 743a 2076 6f6c 6d64 6c72 2e50 6f69  int: volmdlr.Poi
+00017460: 6e74 3244 293a 0a0a 2020 2020 2020 2020  nt2D):..        
+00017470: 6966 2073 656c 662e 616e 676c 6532 203c  if self.angle2 <
+00017480: 2073 656c 662e 616e 676c 6531 3a0a 2020   self.angle1:.  
+00017490: 2020 2020 2020 2020 2020 616e 676c 6532            angle2
+000174a0: 203d 2073 656c 662e 616e 676c 6532 202b   = self.angle2 +
+000174b0: 2076 6f6c 6d64 6c72 2e54 574f 5f50 490a   volmdlr.TWO_PI.
+000174c0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000174d0: 2020 2020 2020 2020 2020 2061 6e67 6c65             angle
+000174e0: 3220 3d20 7365 6c66 2e61 6e67 6c65 320a  2 = self.angle2.
+000174f0: 2020 2020 2020 2020 616e 676c 6531 203d          angle1 =
+00017500: 2073 656c 662e 616e 676c 6531 0a0a 2020   self.angle1..  
+00017510: 2020 2020 2020 2320 4675 6c6c 2061 7263        # Full arc
+00017520: 2073 6563 7469 6f6e 0a20 2020 2020 2020   section.       
+00017530: 2049 7831 203d 2073 656c 662e 7261 6469   Ix1 = self.radi
+00017540: 7573 202a 2a20 3420 2f20 3820 2a20 2861  us ** 4 / 8 * (a
+00017550: 6e67 6c65 3220 2d20 616e 676c 6531 202b  ngle2 - angle1 +
+00017560: 2030 2e35 202a 2028 0a20 2020 2020 2020   0.5 * (.       
+00017570: 2020 2020 206d 6174 682e 7369 6e28 3220       math.sin(2 
+00017580: 2a20 616e 676c 6531 2920 2d20 6d61 7468  * angle1) - math
+00017590: 2e73 696e 2832 202a 2061 6e67 6c65 3229  .sin(2 * angle2)
+000175a0: 2929 0a20 2020 2020 2020 2049 7931 203d  )).        Iy1 =
+000175b0: 2073 656c 662e 7261 6469 7573 202a 2a20   self.radius ** 
+000175c0: 3420 2f20 3820 2a20 2861 6e67 6c65 3220  4 / 8 * (angle2 
+000175d0: 2d20 616e 676c 6531 202b 2030 2e35 202a  - angle1 + 0.5 *
+000175e0: 2028 0a20 2020 2020 2020 2020 2020 206d   (.            m
+000175f0: 6174 682e 7369 6e28 3220 2a20 616e 676c  ath.sin(2 * angl
+00017600: 6532 2920 2d20 6d61 7468 2e73 696e 2832  e2) - math.sin(2
+00017610: 202a 2061 6e67 6c65 3129 2929 0a20 2020   * angle1))).   
+00017620: 2020 2020 2049 7879 3120 3d20 7365 6c66       Ixy1 = self
+00017630: 2e72 6164 6975 7320 2a2a 2034 202f 2038  .radius ** 4 / 8
+00017640: 202a 2028 0a20 2020 2020 2020 2020 2020   * (.           
+00017650: 206d 6174 682e 636f 7328 616e 676c 6531   math.cos(angle1
+00017660: 2920 2a2a 2032 202d 206d 6174 682e 636f  ) ** 2 - math.co
+00017670: 7328 616e 676c 6532 2920 2a2a 2032 290a  s(angle2) ** 2).
+00017680: 0a20 2020 2020 2020 2023 2054 7269 616e  .        # Trian
+00017690: 676c 650a 2020 2020 2020 2020 7869 2c20  gle.        xi, 
+000176a0: 7969 203d 2073 656c 662e 7374 6172 7420  yi = self.start 
+000176b0: 2d20 7365 6c66 2e63 656e 7465 720a 2020  - self.center.  
+000176c0: 2020 2020 2020 786a 2c20 796a 203d 2073        xj, yj = s
+000176d0: 656c 662e 656e 6420 2d20 7365 6c66 2e63  elf.end - self.c
+000176e0: 656e 7465 720a 2020 2020 2020 2020 4978  enter.        Ix
+000176f0: 3220 3d20 2879 6920 2a2a 2032 202b 2079  2 = (yi ** 2 + y
+00017700: 6920 2a20 796a 202b 2079 6a20 2a2a 2032  i * yj + yj ** 2
+00017710: 2920 2a20 2878 6920 2a20 796a 202d 2078  ) * (xi * yj - x
+00017720: 6a20 2a20 7969 2920 2f20 3132 2e0a 2020  j * yi) / 12..  
+00017730: 2020 2020 2020 4979 3220 3d20 2878 6920        Iy2 = (xi 
+00017740: 2a2a 2032 202b 2078 6920 2a20 786a 202b  ** 2 + xi * xj +
+00017750: 2078 6a20 2a2a 2032 2920 2a20 2878 6920   xj ** 2) * (xi 
+00017760: 2a20 796a 202d 2078 6a20 2a20 7969 2920  * yj - xj * yi) 
+00017770: 2f20 3132 2e0a 2020 2020 2020 2020 4978  / 12..        Ix
+00017780: 7932 203d 2028 7869 202a 2079 6a20 2b20  y2 = (xi * yj + 
+00017790: 3220 2a20 7869 202a 2079 6920 2b20 3220  2 * xi * yi + 2 
+000177a0: 2a20 786a 202a 2079 6a20 2b20 786a 202a  * xj * yj + xj *
+000177b0: 2079 6929 202a 2028 0a20 2020 2020 2020   yi) * (.       
+000177c0: 2020 2020 2078 6920 2a20 796a 202d 2078       xi * yj - x
+000177d0: 6a20 2a20 7969 2920 2f20 3234 2e0a 2020  j * yi) / 24..  
+000177e0: 2020 2020 2020 6966 2049 7832 203c 2030        if Ix2 < 0
+000177f0: 2e3a 0a20 2020 2020 2020 2020 2020 2049  .:.            I
+00017800: 7832 2c20 4979 322c 2049 7879 3220 3d20  x2, Iy2, Ixy2 = 
+00017810: 2d49 7832 2c20 2d49 7932 2c20 2d49 7879  -Ix2, -Iy2, -Ixy
+00017820: 320a 2020 2020 2020 2020 6966 2073 656c  2.        if sel
+00017830: 662e 616e 676c 6520 3c20 6d61 7468 2e70  f.angle < math.p
+00017840: 693a 0a20 2020 2020 2020 2020 2020 2069  i:.            i
+00017850: 6620 7365 6c66 2e69 735f 7472 6967 6f3a  f self.is_trigo:
+00017860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017870: 2049 7820 3d20 4978 3120 2d20 4978 320a   Ix = Ix1 - Ix2.
+00017880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017890: 4979 203d 2049 7931 202d 2049 7932 0a20  Iy = Iy1 - Iy2. 
+000178a0: 2020 2020 2020 2020 2020 2020 2020 2049                 I
+000178b0: 7879 203d 2049 7879 3120 2d20 4978 7932  xy = Ixy1 - Ixy2
+000178c0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+000178d0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000178e0: 2020 2049 7820 3d20 4978 3220 2d20 4978     Ix = Ix2 - Ix
+000178f0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+00017900: 2020 4979 203d 2049 7932 202d 2049 7931    Iy = Iy2 - Iy1
+00017910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017920: 2049 7879 203d 2049 7879 3220 2d20 4978   Ixy = Ixy2 - Ix
+00017930: 7931 0a20 2020 2020 2020 2065 6c73 653a  y1.        else:
+00017940: 0a20 2020 2020 2020 2020 2020 2023 2070  .            # p
+00017950: 7269 6e74 2827 4978 7931 3227 2c20 4978  rint('Ixy12', Ix
+00017960: 7931 2c20 4978 7932 290a 2020 2020 2020  y1, Ixy2).      
+00017970: 2020 2020 2020 6966 2073 656c 662e 6973        if self.is
+00017980: 5f74 7269 676f 3a0a 2020 2020 2020 2020  _trigo:.        
+00017990: 2020 2020 2020 2020 4978 203d 2049 7831          Ix = Ix1
+000179a0: 202b 2049 7832 0a20 2020 2020 2020 2020   + Ix2.         
+000179b0: 2020 2020 2020 2049 7920 3d20 4979 3120         Iy = Iy1 
+000179c0: 2b20 4979 320a 2020 2020 2020 2020 2020  + Iy2.          
+000179d0: 2020 2020 2020 4978 7920 3d20 4978 7931        Ixy = Ixy1
+000179e0: 202b 2049 7879 320a 2020 2020 2020 2020   + Ixy2.        
+000179f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00017a00: 2020 2020 2020 2020 2020 4978 203d 202d            Ix = -
+00017a10: 4978 3220 2d20 4978 310a 2020 2020 2020  Ix2 - Ix1.      
+00017a20: 2020 2020 2020 2020 2020 4979 203d 202d            Iy = -
+00017a30: 4979 3220 2d20 4979 310a 2020 2020 2020  Iy2 - Iy1.      
+00017a40: 2020 2020 2020 2020 2020 4978 7920 3d20            Ixy = 
+00017a50: 2d49 7879 3220 2d20 4978 7931 0a0a 2020  -Ixy2 - Ixy1..  
+00017a60: 2020 2020 2020 7265 7475 726e 2076 6f6c        return vol
+00017a70: 6d64 6c72 2e67 656f 6d65 7472 792e 6875  mdlr.geometry.hu
+00017a80: 7967 656e 7332 6428 4978 2c20 4979 2c20  ygens2d(Ix, Iy, 
+00017a90: 4978 792c 0a20 2020 2020 2020 2020 2020  Ixy,.           
+00017aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017ab0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00017ac0: 656c 662e 7374 7261 6967 6874 5f6c 696e  elf.straight_lin
+00017ad0: 655f 6172 6561 2829 2c0a 2020 2020 2020  e_area(),.      
+00017ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017b00: 2020 2020 7365 6c66 2e63 656e 7465 722c      self.center,
+00017b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017b30: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
+00017b40: 290a 0a20 2020 2064 6566 2073 7472 6169  )..    def strai
+00017b50: 6768 745f 6c69 6e65 5f63 656e 7465 725f  ght_line_center_
+00017b60: 6f66 5f6d 6173 7328 7365 6c66 293a 0a20  of_mass(self):. 
+00017b70: 2020 2020 2020 2022 2222 5374 7261 6967         """Straig
+00017b80: 6874 206c 696e 6520 6365 6e74 6572 206f  ht line center o
+00017b90: 6620 6d61 7373 2e22 2222 0a20 2020 2020  f mass.""".     
+00017ba0: 2020 2069 6620 7365 6c66 2e61 6e67 6c65     if self.angle
+00017bb0: 203d 3d20 6d61 7468 2e70 693a 0a20 2020   == math.pi:.   
+00017bc0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00017bd0: 7365 6c66 2e63 656e 7465 725f 6f66 5f6d  self.center_of_m
+00017be0: 6173 7328 290a 0a20 2020 2020 2020 2075  ass()..        u
+00017bf0: 203d 2073 656c 662e 6d69 6464 6c65 5f70   = self.middle_p
+00017c00: 6f69 6e74 2829 202d 2073 656c 662e 6365  oint() - self.ce
+00017c10: 6e74 6572 0a20 2020 2020 2020 2075 2e6e  nter.        u.n
+00017c20: 6f72 6d61 6c69 7a65 2829 0a20 2020 2020  ormalize().     
+00017c30: 2020 2069 6620 7365 6c66 2e61 6e67 6c65     if self.angle
+00017c40: 203e 3d20 6d61 7468 2e70 693a 0a20 2020   >= math.pi:.   
+00017c50: 2020 2020 2020 2020 2075 203d 202d 750a           u = -u.
+00017c60: 2020 2020 2020 2020 6269 7373 6563 203d          bissec =
+00017c70: 204c 696e 6532 4428 7365 6c66 2e63 656e   Line2D(self.cen
+00017c80: 7465 722c 2073 656c 662e 6365 6e74 6572  ter, self.center
+00017c90: 202b 2075 290a 2020 2020 2020 2020 7374   + u).        st
+00017ca0: 7269 6e67 203d 204c 696e 6532 4428 7365  ring = Line2D(se
+00017cb0: 6c66 2e73 7461 7274 2c20 7365 6c66 2e65  lf.start, self.e
+00017cc0: 6e64 290a 2020 2020 2020 2020 7020 3d20  nd).        p = 
+00017cd0: 766f 6c6d 646c 722e 506f 696e 7432 442e  volmdlr.Point2D.
+00017ce0: 6c69 6e65 5f69 6e74 6572 7365 6374 696f  line_intersectio
+00017cf0: 6e28 6269 7373 6563 2c20 7374 7269 6e67  n(bissec, string
+00017d00: 290a 2020 2020 2020 2020 6120 3d20 702e  ).        a = p.
+00017d10: 706f 696e 745f 6469 7374 616e 6365 2873  point_distance(s
+00017d20: 656c 662e 7374 6172 7429 0a20 2020 2020  elf.start).     
+00017d30: 2020 2068 6569 6768 7420 3d20 702e 706f     height = p.po
+00017d40: 696e 745f 6469 7374 616e 6365 2873 656c  int_distance(sel
+00017d50: 662e 6365 6e74 6572 290a 2020 2020 2020  f.center).      
+00017d60: 2020 7472 6961 6e67 6c65 5f61 7265 6120    triangle_area 
+00017d70: 3d20 6865 6967 6874 202a 2061 0a20 2020  = height * a.   
+00017d80: 2020 2020 2023 2061 6c70 6861 203d 2061       # alpha = a
+00017d90: 6273 2873 656c 662e 616e 676c 6529 0a20  bs(self.angle). 
+00017da0: 2020 2020 2020 2074 7269 616e 676c 655f         triangle_
+00017db0: 636f 6720 3d20 7365 6c66 2e63 656e 7465  cog = self.cente
+00017dc0: 7220 2b20 3220 2f20 332e 202a 2068 6569  r + 2 / 3. * hei
+00017dd0: 6768 7420 2a20 750a 2020 2020 2020 2020  ght * u.        
+00017de0: 6966 2073 656c 662e 616e 676c 6520 3c20  if self.angle < 
+00017df0: 6d61 7468 2e70 693a 0a20 2020 2020 2020  math.pi:.       
+00017e00: 2020 2020 2063 6f67 203d 2028 0a20 2020       cog = (.   
+00017e10: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00017e20: 662e 6365 6e74 6572 5f6f 665f 6d61 7373  f.center_of_mass
+00017e30: 2829 202a 2073 656c 662e 6172 6561 2829  () * self.area()
+00017e40: 202d 2074 7269 616e 676c 655f 6172 6561   - triangle_area
+00017e50: 202a 2074 7269 616e 676c 655f 636f 6729   * triangle_cog)
+00017e60: 202f 2061 6273 280a 2020 2020 2020 2020   / abs(.        
+00017e70: 2020 2020 2020 2020 7365 6c66 2e73 7472          self.str
+00017e80: 6169 6768 745f 6c69 6e65 5f61 7265 6128  aight_line_area(
+00017e90: 2929 0a20 2020 2020 2020 2065 6c73 653a  )).        else:
+00017ea0: 0a20 2020 2020 2020 2020 2020 2063 6f67  .            cog
+00017eb0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00017ec0: 2020 2020 2073 656c 662e 6365 6e74 6572       self.center
+00017ed0: 5f6f 665f 6d61 7373 2829 202a 2073 656c  _of_mass() * sel
+00017ee0: 662e 6172 6561 2829 202b 2074 7269 616e  f.area() + trian
+00017ef0: 676c 655f 6172 6561 202a 2074 7269 616e  gle_area * trian
+00017f00: 676c 655f 636f 6729 202f 2061 6273 280a  gle_cog) / abs(.
+00017f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017f20: 7365 6c66 2e73 7472 6169 6768 745f 6c69  self.straight_li
+00017f30: 6e65 5f61 7265 6128 2929 0a0a 2020 2020  ne_area())..    
+00017f40: 2020 2020 2320 6178 203d 2073 656c 662e      # ax = self.
+00017f50: 706c 6f74 2829 0a20 2020 2020 2020 2023  plot().        #
+00017f60: 2062 6973 7365 632e 706c 6f74 2861 783d   bissec.plot(ax=
+00017f70: 6178 2c20 636f 6c6f 723d 2767 7265 7927  ax, color='grey'
+00017f80: 290a 2020 2020 2020 2020 2320 7365 6c66  ).        # self
+00017f90: 2e63 656e 7465 722e 706c 6f74 2861 783d  .center.plot(ax=
+00017fa0: 6178 290a 2020 2020 2020 2020 2320 7374  ax).        # st
+00017fb0: 7269 6e67 2e70 6c6f 7428 6178 3d61 782c  ring.plot(ax=ax,
+00017fc0: 2063 6f6c 6f72 3d27 6772 6579 2729 0a20   color='grey'). 
+00017fd0: 2020 2020 2020 2023 2074 7269 616e 676c         # triangl
+00017fe0: 655f 636f 672e 706c 6f74 2861 783d 6178  e_cog.plot(ax=ax
+00017ff0: 2c20 636f 6c6f 723d 2767 7265 656e 2729  , color='green')
+00018000: 0a20 2020 2020 2020 2023 2073 656c 662e  .        # self.
+00018010: 6365 6e74 6572 5f6f 665f 6d61 7373 2829  center_of_mass()
+00018020: 2e70 6c6f 7428 6178 3d61 782c 2063 6f6c  .plot(ax=ax, col
+00018030: 6f72 3d27 7265 6427 290a 2020 2020 2020  or='red').      
+00018040: 2020 230a 2020 2020 2020 2020 2320 636f    #.        # co
+00018050: 675f 6c69 6e65 203d 204c 696e 6532 4428  g_line = Line2D(
+00018060: 766f 6c6d 646c 722e 4f32 442c 2073 656c  volmdlr.O2D, sel
+00018070: 662e 6365 6e74 6572 5f6f 665f 6d61 7373  f.center_of_mass
+00018080: 2829 2a73 656c 662e 6172 6561 2829 2d74  ()*self.area()-t
+00018090: 7269 616e 676c 655f 6172 6561 2a74 7269  riangle_area*tri
+000180a0: 616e 676c 655f 636f 6729 0a20 2020 2020  angle_cog).     
+000180b0: 2020 2023 2063 6f67 5f6c 696e 652e 706c     # cog_line.pl
+000180c0: 6f74 2861 783d 6178 290a 2020 2020 2020  ot(ax=ax).      
+000180d0: 2020 230a 2020 2020 2020 2020 2320 636f    #.        # co
+000180e0: 672e 706c 6f74 2861 783d 6178 2c20 636f  g.plot(ax=ax, co
+000180f0: 6c6f 723d 2762 2729 0a20 2020 2020 2020  lor='b').       
+00018100: 2023 2061 782e 7365 745f 6173 7065 6374   # ax.set_aspect
+00018110: 2827 6571 7561 6c27 290a 2020 2020 2020  ('equal').      
+00018120: 2020 7265 7475 726e 2063 6f67 0a0a 2020    return cog..  
+00018130: 2020 6465 6620 7374 7261 6967 6874 5f6c    def straight_l
+00018140: 696e 655f 706f 696e 745f 6265 6c6f 6e67  ine_point_belong
+00018150: 7328 7365 6c66 2c20 706f 696e 7429 3a0a  s(self, point):.
+00018160: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00018170: 2020 2020 5665 7269 6669 6573 2069 6620      Verifies if 
+00018180: 6120 706f 696e 7420 6265 6c6f 6e67 7320  a point belongs 
+00018190: 746f 2074 6865 2073 7572 6661 6365 2063  to the surface c
+000181a0: 7265 6174 6564 2062 7920 636c 6f73 696e  reated by closin
+000181b0: 6720 7468 6520 6564 6765 2e0a 0a20 2020  g the edge...   
+000181c0: 2020 2020 203a 7061 7261 6d20 706f 696e       :param poin
+000181d0: 745f 3264 3a20 506f 696e 7420 746f 2062  t_2d: Point to b
+000181e0: 6520 7665 7269 6669 6564 2e0a 2020 2020  e verified..    
+000181f0: 2020 2020 3a72 6574 7572 6e3a 2052 6574      :return: Ret
+00018200: 7572 6e20 5472 7565 2069 6620 7468 6520  urn True if the 
+00018210: 706f 696e 7420 6265 6c6f 6e67 7320 746f  point belongs to
+00018220: 2074 6869 7320 7375 7266 6163 652c 206f   this surface, o
+00018230: 7220 4661 6c73 6520 6f74 6865 7277 6973  r False otherwis
+00018240: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+00018250: 2020 2020 2020 2069 6620 7365 6c66 2e70         if self.p
+00018260: 6f69 6e74 5f62 656c 6f6e 6773 2870 6f69  oint_belongs(poi
+00018270: 6e74 293a 0a20 2020 2020 2020 2020 2020  nt):.           
+00018280: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
+00018290: 2020 2020 2069 6620 7365 6c66 2e73 7461       if self.sta
+000182a0: 7274 203d 3d20 7365 6c66 2e65 6e64 3a0a  rt == self.end:.
+000182b0: 2020 2020 2020 2020 2020 2020 6966 2070              if p
+000182c0: 6f69 6e74 2e70 6f69 6e74 5f64 6973 7461  oint.point_dista
+000182d0: 6e63 6528 7365 6c66 2e63 656e 7465 7229  nce(self.center)
+000182e0: 203c 3d20 7365 6c66 2e72 6164 6975 733a   <= self.radius:
+000182f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018300: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
+00018310: 2020 2020 2063 656e 7465 725f 6469 7374       center_dist
+00018320: 616e 6365 5f70 6f69 6e74 203d 2073 656c  ance_point = sel
+00018330: 662e 6365 6e74 6572 2e70 6f69 6e74 5f64  f.center.point_d
+00018340: 6973 7461 6e63 6528 706f 696e 7429 0a20  istance(point). 
+00018350: 2020 2020 2020 2073 7472 6169 6768 745f         straight_
+00018360: 6c69 6e65 203d 204c 696e 6553 6567 6d65  line = LineSegme
+00018370: 6e74 3244 2873 656c 662e 7374 6172 742c  nt2D(self.start,
+00018380: 2073 656c 662e 656e 6429 0a20 2020 2020   self.end).     
+00018390: 2020 2066 6f72 2065 6467 6520 696e 205b     for edge in [
+000183a0: 7365 6c66 2c20 7374 7261 6967 6874 5f6c  self, straight_l
+000183b0: 696e 655d 3a0a 2020 2020 2020 2020 2020  ine]:.          
+000183c0: 2020 6c69 6e65 5f70 6173 7369 6e67 5f74    line_passing_t
+000183d0: 726f 7567 685f 706f 696e 7420 3d20 4c69  rough_point = Li
+000183e0: 6e65 3244 2873 656c 662e 6365 6e74 6572  ne2D(self.center
+000183f0: 2c20 706f 696e 7429 0a20 2020 2020 2020  , point).       
+00018400: 2020 2020 2073 7472 6169 6768 745f 6c69       straight_li
+00018410: 6e65 5f69 6e74 6572 7365 6374 696f 6e73  ne_intersections
+00018420: 203d 2065 6467 652e 6c69 6e65 5f69 6e74   = edge.line_int
+00018430: 6572 7365 6374 696f 6e73 286c 696e 655f  ersections(line_
+00018440: 7061 7373 696e 675f 7472 6f75 6768 5f70  passing_trough_p
+00018450: 6f69 6e74 290a 2020 2020 2020 2020 2020  oint).          
+00018460: 2020 6966 2073 7472 6169 6768 745f 6c69    if straight_li
+00018470: 6e65 5f69 6e74 6572 7365 6374 696f 6e73  ne_intersections
+00018480: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018490: 2020 6966 2073 656c 662e 6365 6e74 6572    if self.center
+000184a0: 2e70 6f69 6e74 5f64 6973 7461 6e63 6528  .point_distance(
+000184b0: 7374 7261 6967 6874 5f6c 696e 655f 696e  straight_line_in
+000184c0: 7465 7273 6563 7469 6f6e 735b 305d 2920  tersections[0]) 
+000184d0: 3e20 6365 6e74 6572 5f64 6973 7461 6e63  > center_distanc
+000184e0: 655f 706f 696e 743a 0a20 2020 2020 2020  e_point:.       
+000184f0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00018500: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
+00018510: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
+00018520: 2020 2064 6566 2070 6c6f 7428 7365 6c66     def plot(self
+00018530: 2c20 6178 3d4e 6f6e 652c 2063 6f6c 6f72  , ax=None, color
+00018540: 3d27 6b27 2c20 616c 7068 613d 312c 2070  ='k', alpha=1, p
+00018550: 6c6f 745f 706f 696e 7473 3d46 616c 7365  lot_points=False
+00018560: 293a 0a20 2020 2020 2020 2069 6620 6178  ):.        if ax
+00018570: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00018580: 2020 2020 2020 5f2c 2061 7820 3d20 706c        _, ax = pl
+00018590: 742e 7375 6270 6c6f 7473 2829 0a0a 2020  t.subplots()..  
+000185a0: 2020 2020 2020 6966 2070 6c6f 745f 706f        if plot_po
+000185b0: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
+000185c0: 2020 666f 7220 706f 696e 7420 696e 205b    for point in [
+000185d0: 7365 6c66 2e63 656e 7465 722c 2073 656c  self.center, sel
+000185e0: 662e 7374 6172 742c 2073 656c 662e 696e  f.start, self.in
+000185f0: 7465 7269 6f72 2c20 7365 6c66 2e65 6e64  terior, self.end
+00018600: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+00018610: 2020 2070 6f69 6e74 2e70 6c6f 7428 6178     point.plot(ax
+00018620: 3d61 782c 2063 6f6c 6f72 3d63 6f6c 6f72  =ax, color=color
+00018630: 2c20 616c 7068 613d 616c 7068 6129 0a0a  , alpha=alpha)..
+00018640: 2020 2020 2020 2020 6178 2e61 6464 5f70          ax.add_p
+00018650: 6174 6368 286d 6174 706c 6f74 6c69 622e  atch(matplotlib.
+00018660: 7061 7463 6865 732e 4172 6328 2873 656c  patches.Arc((sel
+00018670: 662e 6365 6e74 6572 2e78 2c20 7365 6c66  f.center.x, self
+00018680: 2e63 656e 7465 722e 7929 2c20 3220 2a20  .center.y), 2 * 
+00018690: 7365 6c66 2e72 6164 6975 732c 0a20 2020  self.radius,.   
+000186a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000186b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000186c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000186d0: 2020 2020 2020 2020 2020 2020 616c 7068              alph
-000186e0: 613d 616c 7068 6129 290a 2020 2020 2020  a=alpha)).      
-000186f0: 2020 7265 7475 726e 2061 780a 0a20 2020    return ax..   
-00018700: 2064 6566 2074 6f5f 3364 2873 656c 662c   def to_3d(self,
-00018710: 2070 6c61 6e65 5f6f 7269 6769 6e2c 2078   plane_origin, x
-00018720: 2c20 7929 3a0a 2020 2020 2020 2020 7073  , y):.        ps
-00018730: 203d 2073 656c 662e 7374 6172 742e 746f   = self.start.to
-00018740: 5f33 6428 706c 616e 655f 6f72 6967 696e  _3d(plane_origin
-00018750: 2c20 782c 2079 290a 2020 2020 2020 2020  , x, y).        
-00018760: 7069 203d 2073 656c 662e 696e 7465 7269  pi = self.interi
-00018770: 6f72 2e74 6f5f 3364 2870 6c61 6e65 5f6f  or.to_3d(plane_o
-00018780: 7269 6769 6e2c 2078 2c20 7929 0a20 2020  rigin, x, y).   
-00018790: 2020 2020 2070 6520 3d20 7365 6c66 2e65       pe = self.e
-000187a0: 6e64 2e74 6f5f 3364 2870 6c61 6e65 5f6f  nd.to_3d(plane_o
-000187b0: 7269 6769 6e2c 2078 2c20 7929 0a0a 2020  rigin, x, y)..  
-000187c0: 2020 2020 2020 7265 7475 726e 2041 7263        return Arc
-000187d0: 3344 2870 732c 2070 692c 2070 652c 206e  3D(ps, pi, pe, n
-000187e0: 616d 653d 7365 6c66 2e6e 616d 6529 0a0a  ame=self.name)..
-000187f0: 2020 2020 6465 6620 726f 7461 7469 6f6e      def rotation
-00018800: 2873 656c 662c 2063 656e 7465 723a 2076  (self, center: v
-00018810: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 2c20  olmdlr.Point2D, 
-00018820: 616e 676c 653a 2066 6c6f 6174 293a 0a20  angle: float):. 
-00018830: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00018840: 2020 2041 7263 3244 2072 6f74 6174 696f     Arc2D rotatio
-00018850: 6e2e 0a0a 2020 2020 2020 2020 3a70 6172  n...        :par
-00018860: 616d 2063 656e 7465 723a 2072 6f74 6174  am center: rotat
-00018870: 696f 6e20 6365 6e74 6572 0a20 2020 2020  ion center.     
-00018880: 2020 203a 7061 7261 6d20 616e 676c 653a     :param angle:
-00018890: 2061 6e67 6c65 2072 6f74 6174 696f 6e2e   angle rotation.
-000188a0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-000188b0: 3a20 6120 6e65 7720 726f 7461 7465 6420  : a new rotated 
-000188c0: 4172 6332 442e 0a20 2020 2020 2020 2022  Arc2D..        "
-000188d0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-000188e0: 6e20 4172 6332 4428 2a5b 706f 696e 742e  n Arc2D(*[point.
-000188f0: 726f 7461 7469 6f6e 2863 656e 7465 722c  rotation(center,
-00018900: 2061 6e67 6c65 2c29 2066 6f72 2070 6f69   angle,) for poi
-00018910: 6e74 2069 6e0a 2020 2020 2020 2020 2020  nt in.          
-00018920: 2020 2020 2020 2020 2020 2020 205b 7365               [se
-00018930: 6c66 2e73 7461 7274 2c20 7365 6c66 2e69  lf.start, self.i
-00018940: 6e74 6572 696f 722c 2073 656c 662e 656e  nterior, self.en
-00018950: 645d 5d29 0a0a 2020 2020 6465 6620 726f  d]])..    def ro
-00018960: 7461 7469 6f6e 5f69 6e70 6c61 6365 2873  tation_inplace(s
-00018970: 656c 662c 2063 656e 7465 723a 2076 6f6c  elf, center: vol
-00018980: 6d64 6c72 2e50 6f69 6e74 3244 2c20 616e  mdlr.Point2D, an
-00018990: 676c 653a 2066 6c6f 6174 293a 0a20 2020  gle: float):.   
-000189a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000189b0: 2041 7263 3244 2072 6f74 6174 696f 6e2e   Arc2D rotation.
-000189c0: 204f 626a 6563 7420 6973 2075 7064 6174   Object is updat
-000189d0: 6564 2069 6e70 6c61 6365 2e0a 0a20 2020  ed inplace...   
-000189e0: 2020 2020 203a 7061 7261 6d20 6365 6e74       :param cent
-000189f0: 6572 3a20 726f 7461 7469 6f6e 2063 656e  er: rotation cen
-00018a00: 7465 722e 0a20 2020 2020 2020 203a 7061  ter..        :pa
-00018a10: 7261 6d20 616e 676c 653a 2072 6f74 6174  ram angle: rotat
-00018a20: 696f 6e20 616e 676c 652e 0a20 2020 2020  ion angle..     
-00018a30: 2020 2022 2222 0a20 2020 2020 2020 2077     """.        w
-00018a40: 6172 6e69 6e67 732e 7761 726e 2822 2769  arnings.warn("'i
-00018a50: 6e70 6c61 6365 2720 6d65 7468 6f64 7320  nplace' methods 
-00018a60: 6172 6520 6465 7072 6563 6174 6564 2e20  are deprecated. 
-00018a70: 5573 6520 6120 6e6f 7420 696e 706c 6163  Use a not inplac
-00018a80: 6520 6d65 7468 6f64 2069 6e73 7465 6164  e method instead
-00018a90: 2e22 2c20 4465 7072 6563 6174 696f 6e57  .", DeprecationW
-00018aa0: 6172 6e69 6e67 290a 0a20 2020 2020 2020  arning)..       
-00018ab0: 2073 656c 662e 7374 6172 742e 726f 7461   self.start.rota
-00018ac0: 7469 6f6e 5f69 6e70 6c61 6365 2863 656e  tion_inplace(cen
-00018ad0: 7465 722c 2061 6e67 6c65 290a 2020 2020  ter, angle).    
-00018ae0: 2020 2020 7365 6c66 2e69 6e74 6572 696f      self.interio
-00018af0: 722e 726f 7461 7469 6f6e 5f69 6e70 6c61  r.rotation_inpla
-00018b00: 6365 2863 656e 7465 722c 2061 6e67 6c65  ce(center, angle
-00018b10: 290a 2020 2020 2020 2020 7365 6c66 2e65  ).        self.e
-00018b20: 6e64 2e72 6f74 6174 696f 6e5f 696e 706c  nd.rotation_inpl
-00018b30: 6163 6528 6365 6e74 6572 2c20 616e 676c  ace(center, angl
-00018b40: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
-00018b50: 5f61 6e67 6c65 203d 204e 6f6e 650a 2020  _angle = None.  
-00018b60: 2020 2020 2020 7365 6c66 2e5f 6973 5f74        self._is_t
-00018b70: 7269 676f 203d 204e 6f6e 650a 2020 2020  rigo = None.    
-00018b80: 2020 2020 7365 6c66 2e5f 6365 6e74 6572      self._center
-00018b90: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00018ba0: 7365 6c66 2e5f 636c 6f63 6b77 6973 655f  self._clockwise_
-00018bb0: 616e 645f 7472 6967 6f77 6973 655f 7061  and_trigowise_pa
-00018bc0: 7468 7320 3d20 4e6f 6e65 0a0a 2020 2020  ths = None..    
-00018bd0: 6465 6620 7472 616e 736c 6174 696f 6e28  def translation(
-00018be0: 7365 6c66 2c20 6f66 6673 6574 3a20 766f  self, offset: vo
-00018bf0: 6c6d 646c 722e 5665 6374 6f72 3244 293a  lmdlr.Vector2D):
-00018c00: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00018c10: 2020 2020 2041 7263 3244 2074 7261 6e73       Arc2D trans
-00018c20: 6c61 7469 6f6e 2e0a 0a20 2020 2020 2020  lation...       
-00018c30: 203a 7061 7261 6d20 6f66 6673 6574 3a20   :param offset: 
-00018c40: 7472 616e 736c 6174 696f 6e20 7665 6374  translation vect
-00018c50: 6f72 2e0a 2020 2020 2020 2020 3a72 6574  or..        :ret
-00018c60: 7572 6e3a 2041 206e 6577 2074 7261 6e73  urn: A new trans
-00018c70: 6c61 7465 6420 4172 6332 442e 0a20 2020  lated Arc2D..   
-00018c80: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00018c90: 2072 6574 7572 6e20 4172 6332 4428 2a5b   return Arc2D(*[
-00018ca0: 706f 696e 742e 7472 616e 736c 6174 696f  point.translatio
-00018cb0: 6e28 6f66 6673 6574 2920 666f 7220 706f  n(offset) for po
-00018cc0: 696e 7420 696e 0a20 2020 2020 2020 2020  int in.         
-00018cd0: 2020 2020 2020 2020 2020 2020 2020 5b73                [s
-00018ce0: 656c 662e 7374 6172 742c 2073 656c 662e  elf.start, self.
-00018cf0: 696e 7465 7269 6f72 2c20 7365 6c66 2e65  interior, self.e
-00018d00: 6e64 5d5d 290a 0a20 2020 2064 6566 2074  nd]])..    def t
-00018d10: 7261 6e73 6c61 7469 6f6e 5f69 6e70 6c61  ranslation_inpla
-00018d20: 6365 2873 656c 662c 206f 6666 7365 743a  ce(self, offset:
-00018d30: 2076 6f6c 6d64 6c72 2e56 6563 746f 7232   volmdlr.Vector2
-00018d40: 4429 3a0a 2020 2020 2020 2020 2222 220a  D):.        """.
-00018d50: 2020 2020 2020 2020 4172 6332 4420 7472          Arc2D tr
-00018d60: 616e 736c 6174 696f 6e2e 204f 626a 6563  anslation. Objec
-00018d70: 7420 6973 2075 7064 6174 6564 2069 6e70  t is updated inp
-00018d80: 6c61 6365 2e0a 0a20 2020 2020 2020 203a  lace...        :
-00018d90: 7061 7261 6d20 6f66 6673 6574 3a20 7472  param offset: tr
-00018da0: 616e 736c 6174 696f 6e20 7665 6374 6f72  anslation vector
-00018db0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00018dc0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00018dd0: 6172 6e28 2227 696e 706c 6163 6527 206d  arn("'inplace' m
-00018de0: 6574 686f 6473 2061 7265 2064 6570 7265  ethods are depre
-00018df0: 6361 7465 642e 2055 7365 2061 206e 6f74  cated. Use a not
-00018e00: 2069 6e70 6c61 6365 206d 6574 686f 6420   inplace method 
-00018e10: 696e 7374 6561 642e 222c 2044 6570 7265  instead.", Depre
-00018e20: 6361 7469 6f6e 5761 726e 696e 6729 0a0a  cationWarning)..
-00018e30: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
-00018e40: 7274 2e74 7261 6e73 6c61 7469 6f6e 5f69  rt.translation_i
-00018e50: 6e70 6c61 6365 286f 6666 7365 7429 0a20  nplace(offset). 
-00018e60: 2020 2020 2020 2073 656c 662e 696e 7465         self.inte
-00018e70: 7269 6f72 2e74 7261 6e73 6c61 7469 6f6e  rior.translation
-00018e80: 5f69 6e70 6c61 6365 286f 6666 7365 7429  _inplace(offset)
-00018e90: 0a20 2020 2020 2020 2073 656c 662e 656e  .        self.en
-00018ea0: 642e 7472 616e 736c 6174 696f 6e5f 696e  d.translation_in
-00018eb0: 706c 6163 6528 6f66 6673 6574 290a 2020  place(offset).  
-00018ec0: 2020 2020 2020 7365 6c66 2e5f 616e 676c        self._angl
-00018ed0: 6520 3d20 4e6f 6e65 0a20 2020 2020 2020  e = None.       
-00018ee0: 2073 656c 662e 5f69 735f 7472 6967 6f20   self._is_trigo 
-00018ef0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
-00018f00: 656c 662e 5f63 656e 7465 7220 3d20 4e6f  elf._center = No
-00018f10: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
-00018f20: 5f63 6c6f 636b 7769 7365 5f61 6e64 5f74  _clockwise_and_t
-00018f30: 7269 676f 7769 7365 5f70 6174 6873 203d  rigowise_paths =
-00018f40: 204e 6f6e 650a 0a20 2020 2064 6566 2066   None..    def f
-00018f50: 7261 6d65 5f6d 6170 7069 6e67 2873 656c  rame_mapping(sel
-00018f60: 662c 2066 7261 6d65 3a20 766f 6c6d 646c  f, frame: volmdl
-00018f70: 722e 4672 616d 6532 442c 2073 6964 653a  r.Frame2D, side:
-00018f80: 2073 7472 293a 0a20 2020 2020 2020 2022   str):.        "
-00018f90: 2222 0a20 2020 2020 2020 2043 6861 6e67  "".        Chang
-00018fa0: 6573 2076 6563 746f 7220 6672 616d 655f  es vector frame_
-00018fb0: 6d61 7070 696e 6720 616e 6420 7265 7475  mapping and retu
-00018fc0: 726e 2061 206e 6577 2041 7263 3244 2e0a  rn a new Arc2D..
-00018fd0: 0a20 2020 2020 2020 2073 6964 6520 3d20  .        side = 
-00018fe0: 276f 6c64 2720 6f72 2027 6e65 7727 0a20  'old' or 'new'. 
-00018ff0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00019000: 2020 2072 6574 7572 6e20 4172 6332 4428     return Arc2D(
-00019010: 2a5b 706f 696e 742e 6672 616d 655f 6d61  *[point.frame_ma
-00019020: 7070 696e 6728 6672 616d 652c 2073 6964  pping(frame, sid
-00019030: 6529 2066 6f72 2070 6f69 6e74 2069 6e0a  e) for point in.
-00019040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019050: 2020 2020 2020 205b 7365 6c66 2e73 7461         [self.sta
-00019060: 7274 2c20 7365 6c66 2e69 6e74 6572 696f  rt, self.interio
-00019070: 722c 2073 656c 662e 656e 645d 5d29 0a0a  r, self.end]])..
-00019080: 2020 2020 6465 6620 6672 616d 655f 6d61      def frame_ma
-00019090: 7070 696e 675f 696e 706c 6163 6528 7365  pping_inplace(se
-000190a0: 6c66 2c20 6672 616d 653a 2076 6f6c 6d64  lf, frame: volmd
-000190b0: 6c72 2e46 7261 6d65 3244 2c20 7369 6465  lr.Frame2D, side
-000190c0: 3a20 7374 7229 3a0a 2020 2020 2020 2020  : str):.        
-000190d0: 2222 220a 2020 2020 2020 2020 4368 616e  """.        Chan
-000190e0: 6765 7320 7665 6374 6f72 2066 7261 6d65  ges vector frame
-000190f0: 5f6d 6170 7069 6e67 2061 6e64 2074 6865  _mapping and the
-00019100: 206f 626a 6563 7420 6973 2075 7064 6174   object is updat
-00019110: 6564 2069 6e70 6c61 6365 2e0a 0a20 2020  ed inplace...   
-00019120: 2020 2020 2073 6964 6520 3d20 276f 6c64       side = 'old
-00019130: 2720 6f72 2027 6e65 7727 0a20 2020 2020  ' or 'new'.     
-00019140: 2020 2022 2222 0a20 2020 2020 2020 2077     """.        w
-00019150: 6172 6e69 6e67 732e 7761 726e 2822 2769  arnings.warn("'i
-00019160: 6e70 6c61 6365 2720 6d65 7468 6f64 7320  nplace' methods 
-00019170: 6172 6520 6465 7072 6563 6174 6564 2e20  are deprecated. 
-00019180: 5573 6520 6120 6e6f 7420 696e 706c 6163  Use a not inplac
-00019190: 6520 6d65 7468 6f64 2069 6e73 7465 6164  e method instead
-000191a0: 2e22 2c20 4465 7072 6563 6174 696f 6e57  .", DeprecationW
-000191b0: 6172 6e69 6e67 290a 0a20 2020 2020 2020  arning)..       
-000191c0: 2073 656c 662e 5f5f 696e 6974 5f5f 282a   self.__init__(*
-000191d0: 5b70 6f69 6e74 2e66 7261 6d65 5f6d 6170  [point.frame_map
-000191e0: 7069 6e67 2866 7261 6d65 2c20 7369 6465  ping(frame, side
-000191f0: 2920 666f 7220 706f 696e 7420 696e 0a20  ) for point in. 
-00019200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019210: 2020 2020 2020 205b 7365 6c66 2e73 7461         [self.sta
-00019220: 7274 2c20 7365 6c66 2e69 6e74 6572 696f  rt, self.interio
-00019230: 722c 2073 656c 662e 656e 645d 5d29 0a0a  r, self.end]])..
-00019240: 2020 2020 6465 6620 7365 636f 6e64 5f6d      def second_m
-00019250: 6f6d 656e 745f 6172 6561 2873 656c 662c  oment_area(self,
-00019260: 2070 6f69 6e74 293a 0a20 2020 2020 2020   point):.       
-00019270: 2022 2222 0a20 2020 2020 2020 2053 6563   """.        Sec
-00019280: 6f6e 6420 6d6f 6d65 6e74 2061 7265 6120  ond moment area 
-00019290: 6f66 2070 6172 7420 6f66 2064 6973 6b2e  of part of disk.
-000192a0: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000192b0: 2020 2020 2020 6966 2073 656c 662e 616e        if self.an
-000192c0: 676c 6532 203c 2073 656c 662e 616e 676c  gle2 < self.angl
-000192d0: 6531 3a0a 2020 2020 2020 2020 2020 2020  e1:.            
-000192e0: 616e 676c 6532 203d 2073 656c 662e 616e  angle2 = self.an
-000192f0: 676c 6532 202b 2076 6f6c 6d64 6c72 2e54  gle2 + volmdlr.T
-00019300: 574f 5f50 490a 0a20 2020 2020 2020 2065  WO_PI..        e
-00019310: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00019320: 2061 6e67 6c65 3220 3d20 7365 6c66 2e61   angle2 = self.a
-00019330: 6e67 6c65 320a 2020 2020 2020 2020 616e  ngle2.        an
-00019340: 676c 6531 203d 2073 656c 662e 616e 676c  gle1 = self.angl
-00019350: 6531 0a0a 2020 2020 2020 2020 4978 203d  e1..        Ix =
-00019360: 2073 656c 662e 7261 6469 7573 202a 2a20   self.radius ** 
-00019370: 3420 2f20 3820 2a20 2861 6e67 6c65 3220  4 / 8 * (angle2 
-00019380: 2d20 616e 676c 6531 202b 2030 2e35 202a  - angle1 + 0.5 *
-00019390: 2028 0a20 2020 2020 2020 2020 2020 206d   (.            m
-000193a0: 6174 682e 7369 6e28 3220 2a20 616e 676c  ath.sin(2 * angl
-000193b0: 6531 2920 2d20 6d61 7468 2e73 696e 2832  e1) - math.sin(2
-000193c0: 202a 2061 6e67 6c65 3229 2929 0a20 2020   * angle2))).   
-000193d0: 2020 2020 2049 7920 3d20 7365 6c66 2e72       Iy = self.r
-000193e0: 6164 6975 7320 2a2a 2034 202f 2038 202a  adius ** 4 / 8 *
-000193f0: 2028 616e 676c 6532 202d 2061 6e67 6c65   (angle2 - angle
-00019400: 3120 2b20 302e 3520 2a20 280a 2020 2020  1 + 0.5 * (.    
-00019410: 2020 2020 2020 2020 6d61 7468 2e73 696e          math.sin
-00019420: 2832 202a 2061 6e67 6c65 3229 202d 206d  (2 * angle2) - m
-00019430: 6174 682e 7369 6e28 3220 2a20 616e 676c  ath.sin(2 * angl
-00019440: 6531 2929 290a 2020 2020 2020 2020 4978  e1))).        Ix
-00019450: 7920 3d20 7365 6c66 2e72 6164 6975 7320  y = self.radius 
-00019460: 2a2a 2034 202f 2038 202a 2028 0a20 2020  ** 4 / 8 * (.   
-00019470: 2020 2020 2020 2020 206d 6174 682e 636f           math.co
-00019480: 7328 616e 676c 6531 2920 2a2a 2032 202d  s(angle1) ** 2 -
-00019490: 206d 6174 682e 636f 7328 616e 676c 6532   math.cos(angle2
-000194a0: 2920 2a2a 2032 290a 2020 2020 2020 2020  ) ** 2).        
-000194b0: 2320 4963 203d 206e 7079 2e61 7272 6179  # Ic = npy.array
-000194c0: 285b 5b49 782c 2049 7879 5d2c 205b 4978  ([[Ix, Ixy], [Ix
-000194d0: 792c 2049 795d 5d29 0a0a 2020 2020 2020  y, Iy]])..      
-000194e0: 2020 2320 4d75 7374 2062 6520 636f 6d70    # Must be comp
-000194f0: 7574 6564 2061 7420 6365 6e74 6572 2c20  uted at center, 
-00019500: 736f 2068 7579 6765 6e73 2072 656c 6174  so huygens relat
-00019510: 6564 2074 6f20 6365 6e74 6572 0a20 2020  ed to center.   
-00019520: 2020 2020 2072 6574 7572 6e20 766f 6c6d       return volm
-00019530: 646c 722e 6765 6f6d 6574 7279 2e68 7579  dlr.geometry.huy
-00019540: 6765 6e73 3264 2849 782c 2049 792c 2049  gens2d(Ix, Iy, I
-00019550: 7879 2c20 7365 6c66 2e61 7265 6128 292c  xy, self.area(),
-00019560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019580: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00019590: 6365 6e74 6572 2c20 706f 696e 7429 0a0a  center, point)..
-000195a0: 2020 2020 6465 6620 706c 6f74 5f64 6174      def plot_dat
-000195b0: 6128 7365 6c66 2c20 6564 6765 5f73 7479  a(self, edge_sty
-000195c0: 6c65 3a20 706c 6f74 5f64 6174 612e 4564  le: plot_data.Ed
-000195d0: 6765 5374 796c 6520 3d20 4e6f 6e65 2c0a  geStyle = None,.
-000195e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000195f0: 2020 616e 7469 636c 6f63 6b77 6973 653a    anticlockwise:
-00019600: 2062 6f6f 6c20 3d20 4e6f 6e65 293a 0a20   bool = None):. 
-00019610: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00019620: 2020 2050 6c6f 7420 6461 7461 206d 6574     Plot data met
-00019630: 686f 6420 666f 7220 6120 4172 6332 442e  hod for a Arc2D.
-00019640: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00019650: 2065 6467 655f 7374 796c 653a 2065 6467   edge_style: edg
-00019660: 6520 7374 796c 652e 0a20 2020 2020 2020  e style..       
-00019670: 203a 7265 7475 726e 3a20 706c 6f74 5f64   :return: plot_d
-00019680: 6174 612e 4172 6332 4420 6f62 6a65 6374  ata.Arc2D object
-00019690: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000196a0: 2020 2020 2020 6c69 7374 5f6e 6f64 6520        list_node 
-000196b0: 3d20 7365 6c66 2e64 6973 6372 6574 697a  = self.discretiz
-000196c0: 6174 696f 6e5f 706f 696e 7473 286e 756d  ation_points(num
-000196d0: 6265 725f 706f 696e 7473 3d32 3029 0a20  ber_points=20). 
-000196e0: 2020 2020 2020 2064 6174 6120 3d20 5b5d         data = []
-000196f0: 0a20 2020 2020 2020 2066 6f72 206e 6420  .        for nd 
-00019700: 696e 206c 6973 745f 6e6f 6465 3a0a 2020  in list_node:.  
-00019710: 2020 2020 2020 2020 2020 6461 7461 2e61            data.a
-00019720: 7070 656e 6428 7b27 7827 3a20 6e64 2e78  ppend({'x': nd.x
-00019730: 2c20 2779 273a 206e 642e 797d 290a 2020  , 'y': nd.y}).  
-00019740: 2020 2020 2020 7265 7475 726e 2070 6c6f        return plo
-00019750: 745f 6461 7461 2e41 7263 3244 2863 783d  t_data.Arc2D(cx=
-00019760: 7365 6c66 2e63 656e 7465 722e 782c 0a20  self.center.x,. 
-00019770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019780: 2020 2020 2020 2020 2020 2020 2020 6379                cy
-00019790: 3d73 656c 662e 6365 6e74 6572 2e79 2c0a  =self.center.y,.
-000197a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000197b0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000197c0: 3d73 656c 662e 7261 6469 7573 2c0a 2020  =self.radius,.  
-000197d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000197e0: 2020 2020 2020 2020 2020 2020 2073 7461               sta
-000197f0: 7274 5f61 6e67 6c65 3d73 656c 662e 616e  rt_angle=self.an
-00019800: 676c 6531 2c0a 2020 2020 2020 2020 2020  gle1,.          
-00019810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019820: 2020 2020 2065 6e64 5f61 6e67 6c65 3d73       end_angle=s
-00019830: 656c 662e 616e 676c 6532 2c0a 2020 2020  elf.angle2,.    
-00019840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019850: 2020 2020 2020 2020 2020 2065 6467 655f             edge_
-00019860: 7374 796c 653d 6564 6765 5f73 7479 6c65  style=edge_style
-00019870: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00019880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019890: 2064 6174 613d 6461 7461 2c0a 2020 2020   data=data,.    
-000198a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198b0: 2020 2020 2020 2020 2020 2061 6e74 6963             antic
-000198c0: 6c6f 636b 7769 7365 3d61 6e74 6963 6c6f  lockwise=anticlo
-000198d0: 636b 7769 7365 2c0a 2020 2020 2020 2020  ckwise,.        
-000198e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198f0: 2020 2020 2020 206e 616d 653d 7365 6c66         name=self
-00019900: 2e6e 616d 6529 0a0a 2020 2020 6465 6620  .name)..    def 
-00019910: 636f 7079 2873 656c 662c 202a 6172 6773  copy(self, *args
-00019920: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00019930: 2020 2020 2072 6574 7572 6e20 4172 6332       return Arc2
-00019940: 4428 7365 6c66 2e73 7461 7274 2e63 6f70  D(self.start.cop
-00019950: 7928 292c 0a20 2020 2020 2020 2020 2020  y(),.           
-00019960: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-00019970: 6e74 6572 696f 722e 636f 7079 2829 2c0a  nterior.copy(),.
-00019980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019990: 2020 2020 2073 656c 662e 656e 642e 636f       self.end.co
-000199a0: 7079 2829 290a 0a20 2020 2064 6566 2073  py())..    def s
-000199b0: 706c 6974 2873 656c 662c 2073 706c 6974  plit(self, split
-000199c0: 5f70 6f69 6e74 3a20 766f 6c6d 646c 722e  _point: volmdlr.
-000199d0: 506f 696e 7432 4429 3a0a 2020 2020 2020  Point2D):.      
-000199e0: 2020 6162 7363 6973 7361 203d 2073 656c    abscissa = sel
-000199f0: 662e 6162 7363 6973 7361 2873 706c 6974  f.abscissa(split
-00019a00: 5f70 6f69 6e74 290a 0a20 2020 2020 2020  _point)..       
-00019a10: 2072 6574 7572 6e20 5b41 7263 3244 2873   return [Arc2D(s
-00019a20: 656c 662e 7374 6172 742c 0a20 2020 2020  elf.start,.     
-00019a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019a40: 2073 656c 662e 706f 696e 745f 6174 5f61   self.point_at_a
-00019a50: 6273 6369 7373 6128 302e 3520 2a20 6162  bscissa(0.5 * ab
-00019a60: 7363 6973 7361 292c 0a20 2020 2020 2020  scissa),.       
-00019a70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00019a80: 706c 6974 5f70 6f69 6e74 292c 0a20 2020  plit_point),.   
-00019a90: 2020 2020 2020 2020 2020 2020 2041 7263               Arc
-00019aa0: 3244 2873 706c 6974 5f70 6f69 6e74 2c0a  2D(split_point,.
-00019ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019ac0: 2020 2020 2020 7365 6c66 2e70 6f69 6e74        self.point
-00019ad0: 5f61 745f 6162 7363 6973 7361 2828 7365  _at_abscissa((se
-00019ae0: 6c66 2e61 6273 6369 7373 6128 7365 6c66  lf.abscissa(self
-00019af0: 2e65 6e64 290a 2020 2020 2020 2020 2020  .end).          
-00019b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019b20: 2020 2020 2d20 6162 7363 6973 7361 2920      - abscissa) 
-00019b30: 2a20 302e 3520 2b20 6162 7363 6973 7361  * 0.5 + abscissa
-00019b40: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00019b50: 2020 2020 2020 2020 2073 656c 662e 656e           self.en
-00019b60: 6429 0a20 2020 2020 2020 2020 2020 2020  d).             
-00019b70: 2020 205d 0a0a 2020 2020 6465 6620 6375     ]..    def cu
-00019b80: 745f 6265 7477 6565 6e5f 7477 6f5f 706f  t_between_two_po
-00019b90: 696e 7473 2873 656c 662c 2070 6f69 6e74  ints(self, point
-00019ba0: 312c 2070 6f69 6e74 3229 3a0a 2020 2020  1, point2):.    
-00019bb0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00019bc0: 4375 7473 2041 7263 2062 6574 7765 656e  Cuts Arc between
-00019bd0: 2074 6f20 706f 696e 7473 2c20 616e 6420   to points, and 
-00019be0: 7265 7475 726e 2074 6865 2061 206e 6577  return the a new
-00019bf0: 2061 7263 2062 7765 7477 6565 6e20 7468   arc bwetween th
-00019c00: 6573 6520 7477 6f20 706f 696e 7473 2e0a  ese two points..
-00019c10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00019c20: 2020 2020 2069 6620 2870 6f69 6e74 3120       if (point1 
-00019c30: 3d3d 2073 656c 662e 7374 6172 7420 616e  == self.start an
-00019c40: 6420 706f 696e 7432 203d 3d20 7365 6c66  d point2 == self
-00019c50: 2e65 6e64 2920 6f72 205c 0a20 2020 2020  .end) or \.     
-00019c60: 2020 2020 2020 2020 2020 2028 706f 696e             (poin
-00019c70: 7432 203d 3d20 7365 6c66 2e73 7461 7274  t2 == self.start
-00019c80: 2061 6e64 2070 6f69 6e74 3120 3d3d 2073   and point1 == s
-00019c90: 656c 662e 656e 6429 3a0a 2020 2020 2020  elf.end):.      
-00019ca0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00019cb0: 660a 2020 2020 2020 2020 7261 6973 6520  f.        raise 
-00019cc0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00019cd0: 726f 720a 0a20 2020 2064 6566 2069 6e66  ror..    def inf
-00019ce0: 696e 6974 655f 7072 696d 6974 6976 6528  inite_primitive(
-00019cf0: 7365 6c66 2c20 6f66 6673 6574 293a 0a20  self, offset):. 
-00019d00: 2020 2020 2020 2076 6563 746f 725f 7374         vector_st
-00019d10: 6172 745f 6365 6e74 6572 203d 2073 656c  art_center = sel
-00019d20: 662e 7374 6172 7420 2d20 7365 6c66 2e63  f.start - self.c
-00019d30: 656e 7465 720a 2020 2020 2020 2020 7665  enter.        ve
-00019d40: 6374 6f72 5f73 7461 7274 5f63 656e 7465  ctor_start_cente
-00019d50: 722e 6e6f 726d 616c 697a 6528 290a 2020  r.normalize().  
-00019d60: 2020 2020 2020 7665 6374 6f72 5f65 6e64        vector_end
-00019d70: 5f63 656e 7465 7220 3d20 7365 6c66 2e65  _center = self.e
-00019d80: 6e64 202d 2073 656c 662e 6365 6e74 6572  nd - self.center
-00019d90: 0a20 2020 2020 2020 2076 6563 746f 725f  .        vector_
-00019da0: 656e 645f 6365 6e74 6572 2e6e 6f72 6d61  end_center.norma
-00019db0: 6c69 7a65 2829 0a20 2020 2020 2020 2076  lize().        v
-00019dc0: 6563 746f 725f 696e 7465 7269 6f72 5f63  ector_interior_c
-00019dd0: 656e 7465 7220 3d20 7365 6c66 2e69 6e74  enter = self.int
-00019de0: 6572 696f 7220 2d20 7365 6c66 2e63 656e  erior - self.cen
-00019df0: 7465 720a 2020 2020 2020 2020 7665 6374  ter.        vect
-00019e00: 6f72 5f69 6e74 6572 696f 725f 6365 6e74  or_interior_cent
-00019e10: 6572 2e6e 6f72 6d61 6c69 7a65 2829 0a20  er.normalize(). 
-00019e20: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
-00019e30: 735f 7472 6967 6f3a 0a20 2020 2020 2020  s_trigo:.       
-00019e40: 2020 2020 2072 6164 6975 7320 3d20 7365       radius = se
-00019e50: 6c66 2e72 6164 6975 7320 2b20 6f66 6673  lf.radius + offs
-00019e60: 6574 0a20 2020 2020 2020 2020 2020 2063  et.            c
-00019e70: 656e 7465 7220 3d20 7365 6c66 2e63 656e  enter = self.cen
-00019e80: 7465 720a 0a20 2020 2020 2020 2065 6c73  ter..        els
-00019e90: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00019ea0: 6164 6975 7320 3d20 7365 6c66 2e72 6164  adius = self.rad
-00019eb0: 6975 7320 2d20 6f66 6673 6574 0a20 2020  ius - offset.   
-00019ec0: 2020 2020 2020 2020 2069 6620 7261 6469           if radi
-00019ed0: 7573 203c 2030 3a0a 2020 2020 2020 2020  us < 0:.        
-00019ee0: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-00019ef0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-00019f00: 6365 6e74 6572 203d 2073 656c 662e 6365  center = self.ce
-00019f10: 6e74 6572 0a20 2020 2020 2020 2020 2020  nter.           
-00019f20: 2023 206d 6964 5f70 6f69 6e74 203d 2073   # mid_point = s
-00019f30: 656c 662e 6d69 6464 6c65 5f70 6f69 6e74  elf.middle_point
-00019f40: 2829 0a20 2020 2020 2020 2020 2020 2023  ().            #
-00019f50: 2076 6563 3120 3d20 7365 6c66 2e63 656e   vec1 = self.cen
-00019f60: 7465 7220 2d20 6d69 645f 706f 696e 740a  ter - mid_point.
-00019f70: 2020 2020 2020 2020 2020 2020 2320 7665              # ve
-00019f80: 6331 2e6e 6f72 6d61 6c69 7a65 2829 0a20  c1.normalize(). 
-00019f90: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
-00019fa0: 3120 3d20 3220 2a20 6f66 6673 6574 202a  1 = 2 * offset *
-00019fb0: 206d 6174 682e 7371 7274 2832 2920 2a20   math.sqrt(2) * 
-00019fc0: 7665 6331 0a20 2020 2020 2020 2020 2020  vec1.           
-00019fd0: 2023 2063 656e 7465 7220 3d20 7365 6c66   # center = self
-00019fe0: 2e63 656e 7465 722e 7472 616e 736c 6174  .center.translat
-00019ff0: 696f 6e28 7665 6331 290a 2020 2020 2020  ion(vec1).      
-0001a000: 2020 7374 6172 7420 3d20 6365 6e74 6572    start = center
-0001a010: 202b 2072 6164 6975 7320 2a20 7665 6374   + radius * vect
-0001a020: 6f72 5f73 7461 7274 5f63 656e 7465 720a  or_start_center.
-0001a030: 2020 2020 2020 2020 656e 6420 3d20 6365          end = ce
-0001a040: 6e74 6572 202b 2072 6164 6975 7320 2a20  nter + radius * 
-0001a050: 7665 6374 6f72 5f65 6e64 5f63 656e 7465  vector_end_cente
-0001a060: 720a 2020 2020 2020 2020 696e 7465 7269  r.        interi
-0001a070: 6f72 203d 2063 656e 7465 7220 2b20 7261  or = center + ra
-0001a080: 6469 7573 202a 2076 6563 746f 725f 696e  dius * vector_in
-0001a090: 7465 7269 6f72 5f63 656e 7465 720a 2020  terior_center.  
-0001a0a0: 2020 2020 2020 7265 7475 726e 2041 7263        return Arc
-0001a0b0: 3244 2873 7461 7274 2c20 696e 7465 7269  2D(start, interi
-0001a0c0: 6f72 2c20 656e 6429 0a0a 2020 2020 6465  or, end)..    de
-0001a0d0: 6620 636f 6d70 6c65 6d65 6e74 6172 7928  f complementary(
-0001a0e0: 7365 6c66 293a 0a0a 2020 2020 2020 2020  self):..        
-0001a0f0: 696e 7465 7269 6f72 203d 2073 656c 662e  interior = self.
-0001a100: 6d69 6464 6c65 5f70 6f69 6e74 2829 2e72  middle_point().r
-0001a110: 6f74 6174 696f 6e28 7365 6c66 2e63 656e  otation(self.cen
-0001a120: 7465 722c 206d 6174 682e 7069 290a 2020  ter, math.pi).  
-0001a130: 2020 2020 2020 7265 7475 726e 2041 7263        return Arc
-0001a140: 3244 2873 656c 662e 7374 6172 742c 2069  2D(self.start, i
-0001a150: 6e74 6572 696f 722c 2073 656c 662e 656e  nterior, self.en
-0001a160: 6429 0a0a 2020 2020 6465 6620 746f 5f77  d)..    def to_w
-0001a170: 6972 6528 7365 6c66 2c20 616e 676c 655f  ire(self, angle_
-0001a180: 7265 736f 6c75 7469 6f6e 3a20 666c 6f61  resolution: floa
-0001a190: 7420 3d20 3130 2e29 3a0a 2020 2020 2020  t = 10.):.      
-0001a1a0: 2020 2222 2220 436f 6e76 6572 7420 616e    """ Convert an
-0001a1b0: 2061 7263 2074 6f20 6120 7769 7265 3264   arc to a wire2d
-0001a1c0: 2064 6566 696e 6564 2077 6974 6820 6c69   defined with li
-0001a1d0: 6e65 5f73 6567 6d65 6e74 732e 2022 2222  ne_segments. """
-0001a1e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001a1f0: 766f 6c6d 646c 722e 7769 7265 732e 5769  volmdlr.wires.Wi
-0001a200: 7265 3244 2e66 726f 6d5f 706f 696e 7473  re2D.from_points
-0001a210: 2873 656c 662e 6469 7363 7265 7469 7a61  (self.discretiza
-0001a220: 7469 6f6e 5f70 6f69 6e74 7328 616e 676c  tion_points(angl
-0001a230: 655f 7265 736f 6c75 7469 6f6e 3d61 6e67  e_resolution=ang
-0001a240: 6c65 5f72 6573 6f6c 7574 696f 6e29 290a  le_resolution)).
-0001a250: 0a20 2020 2064 6566 2061 7869 616c 5f73  .    def axial_s
-0001a260: 796d 6d65 7472 7928 7365 6c66 2c20 6c69  ymmetry(self, li
-0001a270: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
-0001a280: 2046 696e 6473 206f 7574 2074 6865 2073   Finds out the s
-0001a290: 796d 6d65 7472 6963 2061 7263 3264 2061  ymmetric arc2d a
-0001a2a0: 6363 6f72 6469 6e67 2074 6f20 6120 6c69  ccording to a li
-0001a2b0: 6e65 2e20 2222 220a 2020 2020 2020 2020  ne. """.        
-0001a2c0: 706f 696e 7473 5f73 796d 6d65 7472 7920  points_symmetry 
-0001a2d0: 3d20 5b70 6f69 6e74 2e61 7869 616c 5f73  = [point.axial_s
-0001a2e0: 796d 6d65 7472 7928 6c69 6e65 2920 666f  ymmetry(line) fo
-0001a2f0: 7220 706f 696e 7420 696e 205b 7365 6c66  r point in [self
-0001a300: 2e73 7461 7274 2c20 7365 6c66 2e69 6e74  .start, self.int
-0001a310: 6572 696f 722c 2073 656c 662e 656e 645d  erior, self.end]
-0001a320: 5d0a 0a20 2020 2020 2020 2072 6574 7572  ]..        retur
-0001a330: 6e20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  n self.__class__
-0001a340: 2873 7461 7274 3d70 6f69 6e74 735f 7379  (start=points_sy
-0001a350: 6d6d 6574 7279 5b30 5d2c 0a20 2020 2020  mmetry[0],.     
-0001a360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a370: 2020 2020 2020 2020 2069 6e74 6572 696f           interio
-0001a380: 723d 706f 696e 7473 5f73 796d 6d65 7472  r=points_symmetr
-0001a390: 795b 315d 2c0a 2020 2020 2020 2020 2020  y[1],.          
-0001a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a3b0: 2020 2020 656e 643d 706f 696e 7473 5f73      end=points_s
-0001a3c0: 796d 6d65 7472 795b 325d 290a 0a20 2020  ymmetry[2])..   
-0001a3d0: 2064 6566 2072 6576 6572 7365 2873 656c   def reverse(sel
-0001a3e0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-0001a3f0: 726e 2073 656c 662e 5f5f 636c 6173 735f  rn self.__class_
-0001a400: 5f28 7365 6c66 2e65 6e64 2e63 6f70 7928  _(self.end.copy(
-0001a410: 292c 2073 656c 662e 696e 7465 7269 6f72  ), self.interior
-0001a420: 2e63 6f70 7928 292c 2073 656c 662e 7374  .copy(), self.st
-0001a430: 6172 742e 636f 7079 2829 2c20 7365 6c66  art.copy(), self
-0001a440: 2e6e 616d 6529 0a0a 0a63 6c61 7373 2046  .name)...class F
-0001a450: 756c 6c41 7263 3244 2841 7263 3244 293a  ullArc2D(Arc2D):
-0001a460: 0a20 2020 2022 2222 2041 6e20 6564 6765  .    """ An edge
-0001a470: 2074 6861 7420 7374 6172 7473 2061 7420   that starts at 
-0001a480: 7374 6172 745f 656e 642c 2065 6e64 7320  start_end, ends 
-0001a490: 6174 2074 6865 2073 616d 6520 706f 696e  at the same poin
-0001a4a0: 7420 6166 7465 7220 6861 7669 6e67 2064  t after having d
-0001a4b0: 6573 6372 6962 6564 2061 2063 6972 636c  escribed a circl
-0001a4c0: 652e 2022 2222 0a0a 2020 2020 6465 6620  e. """..    def 
-0001a4d0: 5f5f 696e 6974 5f5f 2873 656c 662c 2063  __init__(self, c
-0001a4e0: 656e 7465 723a 2076 6f6c 6d64 6c72 2e50  enter: volmdlr.P
-0001a4f0: 6f69 6e74 3244 2c20 7374 6172 745f 656e  oint2D, start_en
-0001a500: 643a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  d: volmdlr.Point
-0001a510: 3244 2c0a 2020 2020 2020 2020 2020 2020  2D,.            
-0001a520: 2020 2020 206e 616d 653a 2073 7472 203d       name: str =
-0001a530: 2027 2729 3a0a 2020 2020 2020 2020 7365   ''):.        se
-0001a540: 6c66 2e5f 5f63 656e 7465 7220 3d20 6365  lf.__center = ce
-0001a550: 6e74 6572 0a20 2020 2020 2020 2073 656c  nter.        sel
-0001a560: 662e 7374 6172 745f 656e 6420 3d20 7374  f.start_end = st
-0001a570: 6172 745f 656e 640a 2020 2020 2020 2020  art_end.        
-0001a580: 696e 7465 7269 6f72 203d 2073 7461 7274  interior = start
-0001a590: 5f65 6e64 2e72 6f74 6174 696f 6e28 6365  _end.rotation(ce
-0001a5a0: 6e74 6572 2c20 6d61 7468 2e70 6929 0a20  nter, math.pi). 
-0001a5b0: 2020 2020 2020 2041 7263 3244 2e5f 5f69         Arc2D.__i
-0001a5c0: 6e69 745f 5f28 7365 6c66 2c20 7374 6172  nit__(self, star
-0001a5d0: 743d 7374 6172 745f 656e 642c 2069 6e74  t=start_end, int
-0001a5e0: 6572 696f 723d 696e 7465 7269 6f72 2c0a  erior=interior,.
-0001a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a600: 2020 2020 2020 2065 6e64 3d73 7461 7274         end=start
-0001a610: 5f65 6e64 2c20 6e61 6d65 3d6e 616d 6529  _end, name=name)
-0001a620: 2020 2320 2121 2120 7468 6973 2069 7320    # !!! this is 
-0001a630: 6461 6e67 6572 6f75 730a 0a20 2020 2040  dangerous..    @
-0001a640: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0001a650: 2069 735f 7472 6967 6f28 7365 6c66 293a   is_trigo(self):
-0001a660: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001a670: 5472 7565 0a0a 2020 2020 4070 726f 7065  True..    @prope
-0001a680: 7274 790a 2020 2020 6465 6620 6365 6e74  rty.    def cent
-0001a690: 6572 2873 656c 6629 3a0a 2020 2020 2020  er(self):.      
-0001a6a0: 2020 7265 7475 726e 2073 656c 662e 5f5f    return self.__
-0001a6b0: 6365 6e74 6572 0a0a 2020 2020 4070 726f  center..    @pro
-0001a6c0: 7065 7274 790a 2020 2020 6465 6620 616e  perty.    def an
-0001a6d0: 676c 6528 7365 6c66 293a 0a20 2020 2020  gle(self):.     
-0001a6e0: 2020 2072 6574 7572 6e20 766f 6c6d 646c     return volmdl
-0001a6f0: 722e 5457 4f5f 5049 0a0a 2020 2020 6465  r.TWO_PI..    de
-0001a700: 6620 746f 5f64 6963 7428 7365 6c66 2c20  f to_dict(self, 
-0001a710: 7573 655f 706f 696e 7465 7273 3a20 626f  use_pointers: bo
-0001a720: 6f6c 203d 2046 616c 7365 2c20 6d65 6d6f  ol = False, memo
-0001a730: 3d4e 6f6e 652c 2070 6174 683a 2073 7472  =None, path: str
-0001a740: 203d 2027 2327 293a 0a20 2020 2020 2020   = '#'):.       
-0001a750: 2064 6963 745f 203d 2073 656c 662e 6261   dict_ = self.ba
-0001a760: 7365 5f64 6963 7428 290a 2020 2020 2020  se_dict().      
-0001a770: 2020 6469 6374 5f5b 2763 656e 7465 7227    dict_['center'
-0001a780: 5d20 3d20 7365 6c66 2e63 656e 7465 722e  ] = self.center.
-0001a790: 746f 5f64 6963 7428 7573 655f 706f 696e  to_dict(use_poin
-0001a7a0: 7465 7273 3d75 7365 5f70 6f69 6e74 6572  ters=use_pointer
-0001a7b0: 732c 206d 656d 6f3d 6d65 6d6f 2c20 7061  s, memo=memo, pa
-0001a7c0: 7468 3d70 6174 6820 2b20 272f 6365 6e74  th=path + '/cent
-0001a7d0: 6572 2729 0a20 2020 2020 2020 2064 6963  er').        dic
-0001a7e0: 745f 5b27 7261 6469 7573 275d 203d 2073  t_['radius'] = s
-0001a7f0: 656c 662e 7261 6469 7573 0a20 2020 2020  elf.radius.     
-0001a800: 2020 2064 6963 745f 5b27 616e 676c 6527     dict_['angle'
-0001a810: 5d20 3d20 7365 6c66 2e61 6e67 6c65 0a20  ] = self.angle. 
-0001a820: 2020 2020 2020 2064 6963 745f 5b27 6973         dict_['is
-0001a830: 5f74 7269 676f 275d 203d 2073 656c 662e  _trigo'] = self.
-0001a840: 6973 5f74 7269 676f 0a20 2020 2020 2020  is_trigo.       
-0001a850: 2064 6963 745f 5b27 7374 6172 745f 656e   dict_['start_en
-0001a860: 6427 5d20 3d20 7365 6c66 2e73 7461 7274  d'] = self.start
-0001a870: 2e74 6f5f 6469 6374 2875 7365 5f70 6f69  .to_dict(use_poi
-0001a880: 6e74 6572 733d 7573 655f 706f 696e 7465  nters=use_pointe
-0001a890: 7273 2c20 6d65 6d6f 3d6d 656d 6f2c 2070  rs, memo=memo, p
-0001a8a0: 6174 683d 7061 7468 202b 2027 2f73 7461  ath=path + '/sta
-0001a8b0: 7274 5f65 6e64 2729 0a20 2020 2020 2020  rt_end').       
-0001a8c0: 2072 6574 7572 6e20 6469 6374 5f0a 0a20   return dict_.. 
-0001a8d0: 2020 2064 6566 2063 6f70 7928 7365 6c66     def copy(self
-0001a8e0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-0001a8f0: 7329 3a0a 2020 2020 2020 2020 7265 7475  s):.        retu
-0001a900: 726e 2046 756c 6c41 7263 3244 2873 656c  rn FullArc2D(sel
-0001a910: 662e 6365 6e74 6572 2e63 6f70 7928 292c  f.center.copy(),
-0001a920: 2073 656c 662e 7374 6172 742e 636f 7079   self.start.copy
-0001a930: 2829 290a 0a20 2020 2040 636c 6173 736d  ())..    @classm
-0001a940: 6574 686f 640a 2020 2020 6465 6620 6469  ethod.    def di
-0001a950: 6374 5f74 6f5f 6f62 6a65 6374 2863 6c73  ct_to_object(cls
-0001a960: 2c20 6469 6374 5f2c 2067 6c6f 6261 6c5f  , dict_, global_
-0001a970: 6469 6374 3d4e 6f6e 652c 2070 6f69 6e74  dict=None, point
-0001a980: 6572 735f 6d65 6d6f 3a20 4469 6374 5b73  ers_memo: Dict[s
-0001a990: 7472 2c20 416e 795d 203d 204e 6f6e 652c  tr, Any] = None,
-0001a9a0: 2070 6174 683a 2073 7472 203d 2027 2327   path: str = '#'
-0001a9b0: 293a 0a20 2020 2020 2020 2063 656e 7465  ):.        cente
-0001a9c0: 7220 3d20 766f 6c6d 646c 722e 506f 696e  r = volmdlr.Poin
-0001a9d0: 7432 442e 6469 6374 5f74 6f5f 6f62 6a65  t2D.dict_to_obje
-0001a9e0: 6374 2864 6963 745f 5b27 6365 6e74 6572  ct(dict_['center
-0001a9f0: 275d 290a 2020 2020 2020 2020 7374 6172  ']).        star
-0001aa00: 745f 656e 6420 3d20 766f 6c6d 646c 722e  t_end = volmdlr.
-0001aa10: 506f 696e 7432 442e 6469 6374 5f74 6f5f  Point2D.dict_to_
-0001aa20: 6f62 6a65 6374 2864 6963 745f 5b27 7374  object(dict_['st
-0001aa30: 6172 745f 656e 6427 5d29 0a0a 2020 2020  art_end'])..    
-0001aa40: 2020 2020 7265 7475 726e 2063 6c73 2863      return cls(c
-0001aa50: 656e 7465 722c 2073 7461 7274 5f65 6e64  enter, start_end
-0001aa60: 2c20 6e61 6d65 3d64 6963 745f 5b27 6e61  , name=dict_['na
-0001aa70: 6d65 275d 290a 0a20 2020 2064 6566 205f  me'])..    def _
-0001aa80: 5f68 6173 685f 5f28 7365 6c66 293a 0a20  _hash__(self):. 
-0001aa90: 2020 2020 2020 2072 6574 7572 6e20 6861         return ha
-0001aaa0: 7368 2873 656c 662e 7261 6469 7573 290a  sh(self.radius).
-0001aab0: 2020 2020 2020 2020 2320 7265 7475 726e          # return
-0001aac0: 2068 6173 6828 7365 6c66 2e63 656e 7465   hash(self.cente
-0001aad0: 7229 202b 2035 2a68 6173 6828 7365 6c66  r) + 5*hash(self
-0001aae0: 2e73 7461 7274 290a 0a20 2020 2064 6566  .start)..    def
-0001aaf0: 205f 5f65 715f 5f28 7365 6c66 2c20 6f74   __eq__(self, ot
-0001ab00: 6865 725f 6172 6329 3a0a 2020 2020 2020  her_arc):.      
-0001ab10: 2020 6966 2073 656c 662e 5f5f 636c 6173    if self.__clas
-0001ab20: 735f 5f2e 5f5f 6e61 6d65 5f5f 2021 3d20  s__.__name__ != 
-0001ab30: 6f74 6865 725f 6172 632e 5f5f 636c 6173  other_arc.__clas
-0001ab40: 735f 5f2e 5f5f 6e61 6d65 5f5f 3a0a 2020  s__.__name__:.  
-0001ab50: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001ab60: 2046 616c 7365 0a20 2020 2020 2020 2072   False.        r
-0001ab70: 6574 7572 6e20 2873 656c 662e 6365 6e74  eturn (self.cent
-0001ab80: 6572 203d 3d20 6f74 6865 725f 6172 632e  er == other_arc.
-0001ab90: 6365 6e74 6572 2920 5c0a 2020 2020 2020  center) \.      
-0001aba0: 2020 2020 2020 616e 6420 2873 656c 662e        and (self.
-0001abb0: 7374 6172 745f 656e 6420 3d3d 206f 7468  start_end == oth
-0001abc0: 6572 5f61 7263 2e73 7461 7274 5f65 6e64  er_arc.start_end
-0001abd0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0001abe0: 0a20 2020 2064 6566 2062 6f75 6e64 696e  .    def boundin
-0001abf0: 675f 7265 6374 616e 676c 6528 7365 6c66  g_rectangle(self
-0001ac00: 293a 0a20 2020 2020 2020 2069 6620 6e6f  ):.        if no
-0001ac10: 7420 7365 6c66 2e5f 626f 756e 6469 6e67  t self._bounding
-0001ac20: 5f72 6563 7461 6e67 6c65 3a0a 2020 2020  _rectangle:.    
-0001ac30: 2020 2020 2020 2020 7365 6c66 2e5f 626f          self._bo
-0001ac40: 756e 6469 6e67 5f72 6563 7461 6e67 6c65  unding_rectangle
-0001ac50: 203d 2076 6f6c 6d64 6c72 2e63 6f72 652e   = volmdlr.core.
-0001ac60: 426f 756e 6469 6e67 5265 6374 616e 676c  BoundingRectangl
-0001ac70: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-0001ac80: 2020 2073 656c 662e 6365 6e74 6572 2e78     self.center.x
-0001ac90: 202d 2073 656c 662e 7261 6469 7573 2c20   - self.radius, 
-0001aca0: 7365 6c66 2e63 656e 7465 722e 7820 2b20  self.center.x + 
-0001acb0: 7365 6c66 2e72 6164 6975 732c 0a20 2020  self.radius,.   
-0001acc0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001acd0: 662e 6365 6e74 6572 2e79 202d 2073 656c  f.center.y - sel
-0001ace0: 662e 7261 6469 7573 2c20 7365 6c66 2e63  f.radius, self.c
-0001acf0: 656e 7465 722e 7920 2b20 7365 6c66 2e72  enter.y + self.r
-0001ad00: 6164 6975 7329 0a20 2020 2020 2020 2072  adius).        r
-0001ad10: 6574 7572 6e20 7365 6c66 2e5f 626f 756e  eturn self._boun
-0001ad20: 6469 6e67 5f72 6563 7461 6e67 6c65 0a0a  ding_rectangle..
-0001ad30: 2020 2020 6465 6620 7374 7261 6967 6874      def straight
-0001ad40: 5f6c 696e 655f 6172 6561 2873 656c 6629  _line_area(self)
-0001ad50: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0001ad60: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
-0001ad70: 2074 6865 2061 7265 6120 6f66 2074 6865   the area of the
-0001ad80: 2066 756c 6c61 7263 2c20 7769 7468 206c   fullarc, with l
-0001ad90: 696e 6520 6472 6177 6e20 6672 6f6d 2073  ine drawn from s
-0001ada0: 7461 7274 2074 6f20 656e 642e 0a0a 2020  tart to end...  
-0001adb0: 2020 2020 2020 3a72 6574 7572 6e3a 2073        :return: s
-0001adc0: 7472 6169 6768 745f 6c69 6e65 5f61 7265  traight_line_are
-0001add0: 612e 0a20 2020 2020 2020 2022 2222 0a20  a..        """. 
-0001ade0: 2020 2020 2020 2061 7265 6120 3d20 7365         area = se
-0001adf0: 6c66 2e61 7265 6128 290a 2020 2020 2020  lf.area().      
-0001ae00: 2020 7265 7475 726e 2061 7265 610a 0a20    return area.. 
-0001ae10: 2020 2064 6566 2063 656e 7465 725f 6f66     def center_of
-0001ae20: 5f6d 6173 7328 7365 6c66 293a 0a20 2020  _mass(self):.   
-0001ae30: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001ae40: 2e63 656e 7465 720a 0a20 2020 2064 6566  .center..    def
-0001ae50: 2073 7472 6169 6768 745f 6c69 6e65 5f63   straight_line_c
-0001ae60: 656e 7465 725f 6f66 5f6d 6173 7328 7365  enter_of_mass(se
-0001ae70: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-0001ae80: 7572 6e20 7365 6c66 2e63 656e 7465 725f  urn self.center_
-0001ae90: 6f66 5f6d 6173 7328 290a 0a20 2020 2064  of_mass()..    d
-0001aea0: 6566 2073 7472 6169 6768 745f 6c69 6e65  ef straight_line
-0001aeb0: 5f70 6f69 6e74 5f62 656c 6f6e 6773 2873  _point_belongs(s
-0001aec0: 656c 662c 2070 6f69 6e74 293a 0a20 2020  elf, point):.   
-0001aed0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001aee0: 2056 6572 6966 6965 7320 6966 2061 2070   Verifies if a p
-0001aef0: 6f69 6e74 2062 656c 6f6e 6773 2074 6f20  oint belongs to 
-0001af00: 7468 6520 7375 7266 6163 6520 6372 6561  the surface crea
-0001af10: 7465 6420 6279 2063 6c6f 7369 6e67 2074  ted by closing t
-0001af20: 6865 2065 6467 652e 0a0a 2020 2020 2020  he edge...      
-0001af30: 2020 3a70 6172 616d 2070 6f69 6e74 3264    :param point2d
-0001af40: 3a20 506f 696e 7420 746f 2062 6520 7665  : Point to be ve
-0001af50: 7269 6669 6564 2e0a 2020 2020 2020 2020  rified..        
-0001af60: 3a72 6574 7572 6e3a 2052 6574 7572 6e20  :return: Return 
-0001af70: 5472 7565 2069 6620 7468 6520 706f 696e  True if the poin
-0001af80: 7420 6265 6c6f 6e67 7320 746f 2074 6869  t belongs to thi
-0001af90: 7320 7375 7266 6163 652c 206f 7220 4661  s surface, or Fa
-0001afa0: 6c73 6520 6f74 6865 7277 6973 652e 0a20  lse otherwise.. 
-0001afb0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001afc0: 2020 2069 6620 706f 696e 742e 706f 696e     if point.poin
-0001afd0: 745f 6469 7374 616e 6365 2873 656c 662e  t_distance(self.
-0001afe0: 6365 6e74 6572 2920 3c3d 2073 656c 662e  center) <= self.
-0001aff0: 7261 6469 7573 3a0a 2020 2020 2020 2020  radius:.        
-0001b000: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
-0001b010: 2020 2020 2020 2020 7265 7475 726e 2046          return F
-0001b020: 616c 7365 0a0a 2020 2020 6465 6620 746f  alse..    def to
-0001b030: 5f33 6428 7365 6c66 2c20 706c 616e 655f  _3d(self, plane_
-0001b040: 6f72 6967 696e 2c20 782c 2079 293a 0a20  origin, x, y):. 
-0001b050: 2020 2020 2020 2063 656e 7465 7220 3d20         center = 
-0001b060: 7365 6c66 2e63 656e 7465 722e 746f 5f33  self.center.to_3
-0001b070: 6428 706c 616e 655f 6f72 6967 696e 2c20  d(plane_origin, 
-0001b080: 782c 2079 290a 2020 2020 2020 2020 7374  x, y).        st
-0001b090: 6172 7420 3d20 7365 6c66 2e73 7461 7274  art = self.start
-0001b0a0: 2e74 6f5f 3364 2870 6c61 6e65 5f6f 7269  .to_3d(plane_ori
-0001b0b0: 6769 6e2c 2078 2c20 7929 0a20 2020 2020  gin, x, y).     
-0001b0c0: 2020 207a 203d 2078 2e63 726f 7373 2879     z = x.cross(y
-0001b0d0: 290a 2020 2020 2020 2020 7a2e 6e6f 726d  ).        z.norm
-0001b0e0: 616c 697a 6528 290a 0a20 2020 2020 2020  alize()..       
-0001b0f0: 2072 6574 7572 6e20 4675 6c6c 4172 6333   return FullArc3
-0001b100: 4428 6365 6e74 6572 2c20 7374 6172 742c  D(center, start,
-0001b110: 207a 290a 0a20 2020 2064 6566 2072 6f74   z)..    def rot
-0001b120: 6174 696f 6e28 7365 6c66 2c20 6365 6e74  ation(self, cent
-0001b130: 6572 3a20 766f 6c6d 646c 722e 506f 696e  er: volmdlr.Poin
-0001b140: 7432 442c 2061 6e67 6c65 3a20 666c 6f61  t2D, angle: floa
-0001b150: 7429 3a0a 2020 2020 2020 2020 6e65 775f  t):.        new_
-0001b160: 6365 6e74 6572 203d 2073 656c 662e 5f63  center = self._c
-0001b170: 656e 7465 722e 726f 7461 7469 6f6e 2863  enter.rotation(c
-0001b180: 656e 7465 722c 2061 6e67 6c65 2c20 5472  enter, angle, Tr
-0001b190: 7565 290a 2020 2020 2020 2020 6e65 775f  ue).        new_
-0001b1a0: 7374 6172 745f 656e 6420 3d20 7365 6c66  start_end = self
-0001b1b0: 2e73 7461 7274 2e72 6f74 6174 696f 6e28  .start.rotation(
-0001b1c0: 6365 6e74 6572 2c20 616e 676c 652c 2054  center, angle, T
-0001b1d0: 7275 6529 0a20 2020 2020 2020 2072 6574  rue).        ret
-0001b1e0: 7572 6e20 4675 6c6c 4172 6332 4428 6e65  urn FullArc2D(ne
-0001b1f0: 775f 6365 6e74 6572 2c20 6e65 775f 7374  w_center, new_st
-0001b200: 6172 745f 656e 6429 0a0a 2020 2020 6465  art_end)..    de
-0001b210: 6620 726f 7461 7469 6f6e 5f69 6e70 6c61  f rotation_inpla
-0001b220: 6365 2873 656c 662c 2063 656e 7465 723a  ce(self, center:
-0001b230: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3244   volmdlr.Point2D
-0001b240: 2c20 616e 676c 653a 2066 6c6f 6174 293a  , angle: float):
-0001b250: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
-0001b260: 732e 7761 726e 2822 2769 6e70 6c61 6365  s.warn("'inplace
-0001b270: 2720 6d65 7468 6f64 7320 6172 6520 6465  ' methods are de
-0001b280: 7072 6563 6174 6564 2e20 5573 6520 6120  precated. Use a 
-0001b290: 6e6f 7420 696e 706c 6163 6520 6d65 7468  not inplace meth
-0001b2a0: 6f64 2069 6e73 7465 6164 2e22 2c20 4465  od instead.", De
-0001b2b0: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
-0001b2c0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0001b2d0: 5f63 656e 7465 722e 726f 7461 7469 6f6e  _center.rotation
-0001b2e0: 2863 656e 7465 722c 2061 6e67 6c65 2c20  (center, angle, 
-0001b2f0: 4661 6c73 6529 0a20 2020 2020 2020 2073  False).        s
-0001b300: 656c 662e 7374 6172 742e 726f 7461 7469  elf.start.rotati
-0001b310: 6f6e 2863 656e 7465 722c 2061 6e67 6c65  on(center, angle
-0001b320: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
-0001b330: 2073 656c 662e 696e 7465 7269 6f72 2e72   self.interior.r
-0001b340: 6f74 6174 696f 6e28 6365 6e74 6572 2c20  otation(center, 
-0001b350: 616e 676c 652c 2046 616c 7365 290a 2020  angle, False).  
-0001b360: 2020 2020 2020 7365 6c66 2e65 6e64 2e72        self.end.r
-0001b370: 6f74 6174 696f 6e28 6365 6e74 6572 2c20  otation(center, 
-0001b380: 616e 676c 652c 2046 616c 7365 290a 0a20  angle, False).. 
-0001b390: 2020 2064 6566 2074 7261 6e73 6c61 7469     def translati
-0001b3a0: 6f6e 2873 656c 662c 206f 6666 7365 743a  on(self, offset:
-0001b3b0: 2076 6f6c 6d64 6c72 2e56 6563 746f 7232   volmdlr.Vector2
-0001b3c0: 4429 3a0a 2020 2020 2020 2020 6e65 775f  D):.        new_
-0001b3d0: 6365 6e74 6572 203d 2073 656c 662e 5f63  center = self._c
-0001b3e0: 656e 7465 722e 7472 616e 736c 6174 696f  enter.translatio
-0001b3f0: 6e28 6f66 6673 6574 290a 2020 2020 2020  n(offset).      
-0001b400: 2020 6e65 775f 7374 6172 745f 656e 6420    new_start_end 
-0001b410: 3d20 7365 6c66 2e73 7461 7274 2e74 7261  = self.start.tra
-0001b420: 6e73 6c61 7469 6f6e 286f 6666 7365 7429  nslation(offset)
-0001b430: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001b440: 4675 6c6c 4172 6332 4428 6e65 775f 6365  FullArc2D(new_ce
-0001b450: 6e74 6572 2c20 6e65 775f 7374 6172 745f  nter, new_start_
-0001b460: 656e 6429 0a0a 2020 2020 6465 6620 7472  end)..    def tr
-0001b470: 616e 736c 6174 696f 6e5f 696e 706c 6163  anslation_inplac
-0001b480: 6528 7365 6c66 2c20 6f66 6673 6574 3a20  e(self, offset: 
-0001b490: 766f 6c6d 646c 722e 5665 6374 6f72 3244  volmdlr.Vector2D
-0001b4a0: 293a 0a20 2020 2020 2020 2077 6172 6e69  ):.        warni
-0001b4b0: 6e67 732e 7761 726e 2822 2769 6e70 6c61  ngs.warn("'inpla
-0001b4c0: 6365 2720 6d65 7468 6f64 7320 6172 6520  ce' methods are 
-0001b4d0: 6465 7072 6563 6174 6564 2e20 5573 6520  deprecated. Use 
-0001b4e0: 6120 6e6f 7420 696e 706c 6163 6520 6d65  a not inplace me
-0001b4f0: 7468 6f64 2069 6e73 7465 6164 2e22 2c20  thod instead.", 
-0001b500: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
-0001b510: 6e67 290a 0a20 2020 2020 2020 2073 656c  ng)..        sel
+000186c0: 2020 2020 2020 2020 2032 202a 2073 656c           2 * sel
+000186d0: 662e 7261 6469 7573 2c20 616e 676c 653d  f.radius, angle=
+000186e0: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+000186f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018700: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00018710: 6865 7461 313d 7365 6c66 2e61 6e67 6c65  heta1=self.angle
+00018720: 3120 2a20 302e 3520 2f20 6d61 7468 2e70  1 * 0.5 / math.p
+00018730: 6920 2a20 3336 302c 0a20 2020 2020 2020  i * 360,.       
+00018740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018760: 2020 2020 2074 6865 7461 323d 7365 6c66       theta2=self
+00018770: 2e61 6e67 6c65 3220 2a20 302e 3520 2f20  .angle2 * 0.5 / 
+00018780: 6d61 7468 2e70 6920 2a20 3336 302c 0a20  math.pi * 360,. 
+00018790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000187a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000187b0: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
+000187c0: 3d63 6f6c 6f72 2c0a 2020 2020 2020 2020  =color,.        
+000187d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000187e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000187f0: 2020 2020 616c 7068 613d 616c 7068 6129      alpha=alpha)
+00018800: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00018810: 2061 780a 0a20 2020 2064 6566 2074 6f5f   ax..    def to_
+00018820: 3364 2873 656c 662c 2070 6c61 6e65 5f6f  3d(self, plane_o
+00018830: 7269 6769 6e2c 2078 2c20 7929 3a0a 2020  rigin, x, y):.  
+00018840: 2020 2020 2020 7073 203d 2073 656c 662e        ps = self.
+00018850: 7374 6172 742e 746f 5f33 6428 706c 616e  start.to_3d(plan
+00018860: 655f 6f72 6967 696e 2c20 782c 2079 290a  e_origin, x, y).
+00018870: 2020 2020 2020 2020 7069 203d 2073 656c          pi = sel
+00018880: 662e 696e 7465 7269 6f72 2e74 6f5f 3364  f.interior.to_3d
+00018890: 2870 6c61 6e65 5f6f 7269 6769 6e2c 2078  (plane_origin, x
+000188a0: 2c20 7929 0a20 2020 2020 2020 2070 6520  , y).        pe 
+000188b0: 3d20 7365 6c66 2e65 6e64 2e74 6f5f 3364  = self.end.to_3d
+000188c0: 2870 6c61 6e65 5f6f 7269 6769 6e2c 2078  (plane_origin, x
+000188d0: 2c20 7929 0a0a 2020 2020 2020 2020 7265  , y)..        re
+000188e0: 7475 726e 2041 7263 3344 2870 732c 2070  turn Arc3D(ps, p
+000188f0: 692c 2070 652c 206e 616d 653d 7365 6c66  i, pe, name=self
+00018900: 2e6e 616d 6529 0a0a 2020 2020 6465 6620  .name)..    def 
+00018910: 726f 7461 7469 6f6e 2873 656c 662c 2063  rotation(self, c
+00018920: 656e 7465 723a 2076 6f6c 6d64 6c72 2e50  enter: volmdlr.P
+00018930: 6f69 6e74 3244 2c20 616e 676c 653a 2066  oint2D, angle: f
+00018940: 6c6f 6174 293a 0a20 2020 2020 2020 2022  loat):.        "
+00018950: 2222 0a20 2020 2020 2020 2041 7263 3244  "".        Arc2D
+00018960: 2072 6f74 6174 696f 6e2e 0a0a 2020 2020   rotation...    
+00018970: 2020 2020 3a70 6172 616d 2063 656e 7465      :param cente
+00018980: 723a 2072 6f74 6174 696f 6e20 6365 6e74  r: rotation cent
+00018990: 6572 0a20 2020 2020 2020 203a 7061 7261  er.        :para
+000189a0: 6d20 616e 676c 653a 2061 6e67 6c65 2072  m angle: angle r
+000189b0: 6f74 6174 696f 6e2e 0a20 2020 2020 2020  otation..       
+000189c0: 203a 7265 7475 726e 3a20 6120 6e65 7720   :return: a new 
+000189d0: 726f 7461 7465 6420 4172 6332 442e 0a20  rotated Arc2D.. 
+000189e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000189f0: 2020 2072 6574 7572 6e20 4172 6332 4428     return Arc2D(
+00018a00: 2a5b 706f 696e 742e 726f 7461 7469 6f6e  *[point.rotation
+00018a10: 2863 656e 7465 722c 2061 6e67 6c65 2c29  (center, angle,)
+00018a20: 2066 6f72 2070 6f69 6e74 2069 6e0a 2020   for point in.  
+00018a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018a40: 2020 2020 205b 7365 6c66 2e73 7461 7274       [self.start
+00018a50: 2c20 7365 6c66 2e69 6e74 6572 696f 722c  , self.interior,
+00018a60: 2073 656c 662e 656e 645d 5d29 0a0a 2020   self.end]])..  
+00018a70: 2020 6465 6620 726f 7461 7469 6f6e 5f69    def rotation_i
+00018a80: 6e70 6c61 6365 2873 656c 662c 2063 656e  nplace(self, cen
+00018a90: 7465 723a 2076 6f6c 6d64 6c72 2e50 6f69  ter: volmdlr.Poi
+00018aa0: 6e74 3244 2c20 616e 676c 653a 2066 6c6f  nt2D, angle: flo
+00018ab0: 6174 293a 0a20 2020 2020 2020 2022 2222  at):.        """
+00018ac0: 0a20 2020 2020 2020 2041 7263 3244 2072  .        Arc2D r
+00018ad0: 6f74 6174 696f 6e2e 204f 626a 6563 7420  otation. Object 
+00018ae0: 6973 2075 7064 6174 6564 2069 6e70 6c61  is updated inpla
+00018af0: 6365 2e0a 0a20 2020 2020 2020 203a 7061  ce...        :pa
+00018b00: 7261 6d20 6365 6e74 6572 3a20 726f 7461  ram center: rota
+00018b10: 7469 6f6e 2063 656e 7465 722e 0a20 2020  tion center..   
+00018b20: 2020 2020 203a 7061 7261 6d20 616e 676c       :param angl
+00018b30: 653a 2072 6f74 6174 696f 6e20 616e 676c  e: rotation angl
+00018b40: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+00018b50: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+00018b60: 7761 726e 2822 2769 6e70 6c61 6365 2720  warn("'inplace' 
+00018b70: 6d65 7468 6f64 7320 6172 6520 6465 7072  methods are depr
+00018b80: 6563 6174 6564 2e20 5573 6520 6120 6e6f  ecated. Use a no
+00018b90: 7420 696e 706c 6163 6520 6d65 7468 6f64  t inplace method
+00018ba0: 2069 6e73 7465 6164 2e22 2c20 4465 7072   instead.", Depr
+00018bb0: 6563 6174 696f 6e57 6172 6e69 6e67 290a  ecationWarning).
+00018bc0: 0a20 2020 2020 2020 2073 656c 662e 7374  .        self.st
+00018bd0: 6172 742e 726f 7461 7469 6f6e 5f69 6e70  art.rotation_inp
+00018be0: 6c61 6365 2863 656e 7465 722c 2061 6e67  lace(center, ang
+00018bf0: 6c65 290a 2020 2020 2020 2020 7365 6c66  le).        self
+00018c00: 2e69 6e74 6572 696f 722e 726f 7461 7469  .interior.rotati
+00018c10: 6f6e 5f69 6e70 6c61 6365 2863 656e 7465  on_inplace(cente
+00018c20: 722c 2061 6e67 6c65 290a 2020 2020 2020  r, angle).      
+00018c30: 2020 7365 6c66 2e65 6e64 2e72 6f74 6174    self.end.rotat
+00018c40: 696f 6e5f 696e 706c 6163 6528 6365 6e74  ion_inplace(cent
+00018c50: 6572 2c20 616e 676c 6529 0a20 2020 2020  er, angle).     
+00018c60: 2020 2073 656c 662e 5f61 6e67 6c65 203d     self._angle =
+00018c70: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
+00018c80: 6c66 2e5f 6973 5f74 7269 676f 203d 204e  lf._is_trigo = N
+00018c90: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
+00018ca0: 2e5f 6365 6e74 6572 203d 204e 6f6e 650a  ._center = None.
+00018cb0: 2020 2020 2020 2020 7365 6c66 2e5f 636c          self._cl
+00018cc0: 6f63 6b77 6973 655f 616e 645f 7472 6967  ockwise_and_trig
+00018cd0: 6f77 6973 655f 7061 7468 7320 3d20 4e6f  owise_paths = No
+00018ce0: 6e65 0a0a 2020 2020 6465 6620 7472 616e  ne..    def tran
+00018cf0: 736c 6174 696f 6e28 7365 6c66 2c20 6f66  slation(self, of
+00018d00: 6673 6574 3a20 766f 6c6d 646c 722e 5665  fset: volmdlr.Ve
+00018d10: 6374 6f72 3244 293a 0a20 2020 2020 2020  ctor2D):.       
+00018d20: 2022 2222 0a20 2020 2020 2020 2041 7263   """.        Arc
+00018d30: 3244 2074 7261 6e73 6c61 7469 6f6e 2e0a  2D translation..
+00018d40: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00018d50: 6f66 6673 6574 3a20 7472 616e 736c 6174  offset: translat
+00018d60: 696f 6e20 7665 6374 6f72 2e0a 2020 2020  ion vector..    
+00018d70: 2020 2020 3a72 6574 7572 6e3a 2041 206e      :return: A n
+00018d80: 6577 2074 7261 6e73 6c61 7465 6420 4172  ew translated Ar
+00018d90: 6332 442e 0a20 2020 2020 2020 2022 2222  c2D..        """
+00018da0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00018db0: 4172 6332 4428 2a5b 706f 696e 742e 7472  Arc2D(*[point.tr
+00018dc0: 616e 736c 6174 696f 6e28 6f66 6673 6574  anslation(offset
+00018dd0: 2920 666f 7220 706f 696e 7420 696e 0a20  ) for point in. 
+00018de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018df0: 2020 2020 2020 5b73 656c 662e 7374 6172        [self.star
+00018e00: 742c 2073 656c 662e 696e 7465 7269 6f72  t, self.interior
+00018e10: 2c20 7365 6c66 2e65 6e64 5d5d 290a 0a20  , self.end]]).. 
+00018e20: 2020 2064 6566 2074 7261 6e73 6c61 7469     def translati
+00018e30: 6f6e 5f69 6e70 6c61 6365 2873 656c 662c  on_inplace(self,
+00018e40: 206f 6666 7365 743a 2076 6f6c 6d64 6c72   offset: volmdlr
+00018e50: 2e56 6563 746f 7232 4429 3a0a 2020 2020  .Vector2D):.    
+00018e60: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00018e70: 4172 6332 4420 7472 616e 736c 6174 696f  Arc2D translatio
+00018e80: 6e2e 204f 626a 6563 7420 6973 2075 7064  n. Object is upd
+00018e90: 6174 6564 2069 6e70 6c61 6365 2e0a 0a20  ated inplace... 
+00018ea0: 2020 2020 2020 203a 7061 7261 6d20 6f66         :param of
+00018eb0: 6673 6574 3a20 7472 616e 736c 6174 696f  fset: translatio
+00018ec0: 6e20 7665 6374 6f72 2e0a 2020 2020 2020  n vector..      
+00018ed0: 2020 2222 220a 2020 2020 2020 2020 7761    """.        wa
+00018ee0: 726e 696e 6773 2e77 6172 6e28 2227 696e  rnings.warn("'in
+00018ef0: 706c 6163 6527 206d 6574 686f 6473 2061  place' methods a
+00018f00: 7265 2064 6570 7265 6361 7465 642e 2055  re deprecated. U
+00018f10: 7365 2061 206e 6f74 2069 6e70 6c61 6365  se a not inplace
+00018f20: 206d 6574 686f 6420 696e 7374 6561 642e   method instead.
+00018f30: 222c 2044 6570 7265 6361 7469 6f6e 5761  ", DeprecationWa
+00018f40: 726e 696e 6729 0a0a 2020 2020 2020 2020  rning)..        
+00018f50: 7365 6c66 2e73 7461 7274 2e74 7261 6e73  self.start.trans
+00018f60: 6c61 7469 6f6e 5f69 6e70 6c61 6365 286f  lation_inplace(o
+00018f70: 6666 7365 7429 0a20 2020 2020 2020 2073  ffset).        s
+00018f80: 656c 662e 696e 7465 7269 6f72 2e74 7261  elf.interior.tra
+00018f90: 6e73 6c61 7469 6f6e 5f69 6e70 6c61 6365  nslation_inplace
+00018fa0: 286f 6666 7365 7429 0a20 2020 2020 2020  (offset).       
+00018fb0: 2073 656c 662e 656e 642e 7472 616e 736c   self.end.transl
+00018fc0: 6174 696f 6e5f 696e 706c 6163 6528 6f66  ation_inplace(of
+00018fd0: 6673 6574 290a 2020 2020 2020 2020 7365  fset).        se
+00018fe0: 6c66 2e5f 616e 676c 6520 3d20 4e6f 6e65  lf._angle = None
+00018ff0: 0a20 2020 2020 2020 2073 656c 662e 5f69  .        self._i
+00019000: 735f 7472 6967 6f20 3d20 4e6f 6e65 0a20  s_trigo = None. 
+00019010: 2020 2020 2020 2073 656c 662e 5f63 656e         self._cen
+00019020: 7465 7220 3d20 4e6f 6e65 0a20 2020 2020  ter = None.     
+00019030: 2020 2073 656c 662e 5f63 6c6f 636b 7769     self._clockwi
+00019040: 7365 5f61 6e64 5f74 7269 676f 7769 7365  se_and_trigowise
+00019050: 5f70 6174 6873 203d 204e 6f6e 650a 0a20  _paths = None.. 
+00019060: 2020 2064 6566 2066 7261 6d65 5f6d 6170     def frame_map
+00019070: 7069 6e67 2873 656c 662c 2066 7261 6d65  ping(self, frame
+00019080: 3a20 766f 6c6d 646c 722e 4672 616d 6532  : volmdlr.Frame2
+00019090: 442c 2073 6964 653a 2073 7472 293a 0a20  D, side: str):. 
+000190a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000190b0: 2020 2043 6861 6e67 6573 2076 6563 746f     Changes vecto
+000190c0: 7220 6672 616d 655f 6d61 7070 696e 6720  r frame_mapping 
+000190d0: 616e 6420 7265 7475 726e 2061 206e 6577  and return a new
+000190e0: 2041 7263 3244 2e0a 0a20 2020 2020 2020   Arc2D...       
+000190f0: 2073 6964 6520 3d20 276f 6c64 2720 6f72   side = 'old' or
+00019100: 2027 6e65 7727 0a20 2020 2020 2020 2022   'new'.        "
+00019110: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00019120: 6e20 4172 6332 4428 2a5b 706f 696e 742e  n Arc2D(*[point.
+00019130: 6672 616d 655f 6d61 7070 696e 6728 6672  frame_mapping(fr
+00019140: 616d 652c 2073 6964 6529 2066 6f72 2070  ame, side) for p
+00019150: 6f69 6e74 2069 6e0a 2020 2020 2020 2020  oint in.        
+00019160: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00019170: 7365 6c66 2e73 7461 7274 2c20 7365 6c66  self.start, self
+00019180: 2e69 6e74 6572 696f 722c 2073 656c 662e  .interior, self.
+00019190: 656e 645d 5d29 0a0a 2020 2020 6465 6620  end]])..    def 
+000191a0: 6672 616d 655f 6d61 7070 696e 675f 696e  frame_mapping_in
+000191b0: 706c 6163 6528 7365 6c66 2c20 6672 616d  place(self, fram
+000191c0: 653a 2076 6f6c 6d64 6c72 2e46 7261 6d65  e: volmdlr.Frame
+000191d0: 3244 2c20 7369 6465 3a20 7374 7229 3a0a  2D, side: str):.
+000191e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000191f0: 2020 2020 4368 616e 6765 7320 7665 6374      Changes vect
+00019200: 6f72 2066 7261 6d65 5f6d 6170 7069 6e67  or frame_mapping
+00019210: 2061 6e64 2074 6865 206f 626a 6563 7420   and the object 
+00019220: 6973 2075 7064 6174 6564 2069 6e70 6c61  is updated inpla
+00019230: 6365 2e0a 0a20 2020 2020 2020 2073 6964  ce...        sid
+00019240: 6520 3d20 276f 6c64 2720 6f72 2027 6e65  e = 'old' or 'ne
+00019250: 7727 0a20 2020 2020 2020 2022 2222 0a20  w'.        """. 
+00019260: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+00019270: 7761 726e 2822 2769 6e70 6c61 6365 2720  warn("'inplace' 
+00019280: 6d65 7468 6f64 7320 6172 6520 6465 7072  methods are depr
+00019290: 6563 6174 6564 2e20 5573 6520 6120 6e6f  ecated. Use a no
+000192a0: 7420 696e 706c 6163 6520 6d65 7468 6f64  t inplace method
+000192b0: 2069 6e73 7465 6164 2e22 2c20 4465 7072   instead.", Depr
+000192c0: 6563 6174 696f 6e57 6172 6e69 6e67 290a  ecationWarning).
+000192d0: 0a20 2020 2020 2020 2073 656c 662e 5f5f  .        self.__
+000192e0: 696e 6974 5f5f 282a 5b70 6f69 6e74 2e66  init__(*[point.f
+000192f0: 7261 6d65 5f6d 6170 7069 6e67 2866 7261  rame_mapping(fra
+00019300: 6d65 2c20 7369 6465 2920 666f 7220 706f  me, side) for po
+00019310: 696e 7420 696e 0a20 2020 2020 2020 2020  int in.         
+00019320: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00019330: 7365 6c66 2e73 7461 7274 2c20 7365 6c66  self.start, self
+00019340: 2e69 6e74 6572 696f 722c 2073 656c 662e  .interior, self.
+00019350: 656e 645d 5d29 0a0a 2020 2020 6465 6620  end]])..    def 
+00019360: 7365 636f 6e64 5f6d 6f6d 656e 745f 6172  second_moment_ar
+00019370: 6561 2873 656c 662c 2070 6f69 6e74 293a  ea(self, point):
+00019380: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00019390: 2020 2020 2053 6563 6f6e 6420 6d6f 6d65       Second mome
+000193a0: 6e74 2061 7265 6120 6f66 2070 6172 7420  nt area of part 
+000193b0: 6f66 2064 6973 6b2e 0a0a 2020 2020 2020  of disk...      
+000193c0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+000193d0: 2073 656c 662e 616e 676c 6532 203c 2073   self.angle2 < s
+000193e0: 656c 662e 616e 676c 6531 3a0a 2020 2020  elf.angle1:.    
+000193f0: 2020 2020 2020 2020 616e 676c 6532 203d          angle2 =
+00019400: 2073 656c 662e 616e 676c 6532 202b 2076   self.angle2 + v
+00019410: 6f6c 6d64 6c72 2e54 574f 5f50 490a 0a20  olmdlr.TWO_PI.. 
+00019420: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00019430: 2020 2020 2020 2020 2061 6e67 6c65 3220           angle2 
+00019440: 3d20 7365 6c66 2e61 6e67 6c65 320a 2020  = self.angle2.  
+00019450: 2020 2020 2020 616e 676c 6531 203d 2073        angle1 = s
+00019460: 656c 662e 616e 676c 6531 0a0a 2020 2020  elf.angle1..    
+00019470: 2020 2020 4978 203d 2073 656c 662e 7261      Ix = self.ra
+00019480: 6469 7573 202a 2a20 3420 2f20 3820 2a20  dius ** 4 / 8 * 
+00019490: 2861 6e67 6c65 3220 2d20 616e 676c 6531  (angle2 - angle1
+000194a0: 202b 2030 2e35 202a 2028 0a20 2020 2020   + 0.5 * (.     
+000194b0: 2020 2020 2020 206d 6174 682e 7369 6e28         math.sin(
+000194c0: 3220 2a20 616e 676c 6531 2920 2d20 6d61  2 * angle1) - ma
+000194d0: 7468 2e73 696e 2832 202a 2061 6e67 6c65  th.sin(2 * angle
+000194e0: 3229 2929 0a20 2020 2020 2020 2049 7920  2))).        Iy 
+000194f0: 3d20 7365 6c66 2e72 6164 6975 7320 2a2a  = self.radius **
+00019500: 2034 202f 2038 202a 2028 616e 676c 6532   4 / 8 * (angle2
+00019510: 202d 2061 6e67 6c65 3120 2b20 302e 3520   - angle1 + 0.5 
+00019520: 2a20 280a 2020 2020 2020 2020 2020 2020  * (.            
+00019530: 6d61 7468 2e73 696e 2832 202a 2061 6e67  math.sin(2 * ang
+00019540: 6c65 3229 202d 206d 6174 682e 7369 6e28  le2) - math.sin(
+00019550: 3220 2a20 616e 676c 6531 2929 290a 2020  2 * angle1))).  
+00019560: 2020 2020 2020 4978 7920 3d20 7365 6c66        Ixy = self
+00019570: 2e72 6164 6975 7320 2a2a 2034 202f 2038  .radius ** 4 / 8
+00019580: 202a 2028 0a20 2020 2020 2020 2020 2020   * (.           
+00019590: 206d 6174 682e 636f 7328 616e 676c 6531   math.cos(angle1
+000195a0: 2920 2a2a 2032 202d 206d 6174 682e 636f  ) ** 2 - math.co
+000195b0: 7328 616e 676c 6532 2920 2a2a 2032 290a  s(angle2) ** 2).
+000195c0: 2020 2020 2020 2020 2320 4963 203d 206e          # Ic = n
+000195d0: 7079 2e61 7272 6179 285b 5b49 782c 2049  py.array([[Ix, I
+000195e0: 7879 5d2c 205b 4978 792c 2049 795d 5d29  xy], [Ixy, Iy]])
+000195f0: 0a0a 2020 2020 2020 2020 2320 4d75 7374  ..        # Must
+00019600: 2062 6520 636f 6d70 7574 6564 2061 7420   be computed at 
+00019610: 6365 6e74 6572 2c20 736f 2068 7579 6765  center, so huyge
+00019620: 6e73 2072 656c 6174 6564 2074 6f20 6365  ns related to ce
+00019630: 6e74 6572 0a20 2020 2020 2020 2072 6574  nter.        ret
+00019640: 7572 6e20 766f 6c6d 646c 722e 6765 6f6d  urn volmdlr.geom
+00019650: 6574 7279 2e68 7579 6765 6e73 3264 2849  etry.huygens2d(I
+00019660: 782c 2049 792c 2049 7879 2c20 7365 6c66  x, Iy, Ixy, self
+00019670: 2e61 7265 6128 292c 0a20 2020 2020 2020  .area(),.       
+00019680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000196a0: 2020 2073 656c 662e 6365 6e74 6572 2c20     self.center, 
+000196b0: 706f 696e 7429 0a0a 2020 2020 6465 6620  point)..    def 
+000196c0: 706c 6f74 5f64 6174 6128 7365 6c66 2c20  plot_data(self, 
+000196d0: 6564 6765 5f73 7479 6c65 3a20 706c 6f74  edge_style: plot
+000196e0: 5f64 6174 612e 4564 6765 5374 796c 6520  _data.EdgeStyle 
+000196f0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00019700: 2020 2020 2020 2020 2020 616e 7469 636c            anticl
+00019710: 6f63 6b77 6973 653a 2062 6f6f 6c20 3d20  ockwise: bool = 
+00019720: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
+00019730: 2222 0a20 2020 2020 2020 2050 6c6f 7420  "".        Plot 
+00019740: 6461 7461 206d 6574 686f 6420 666f 7220  data method for 
+00019750: 6120 4172 6332 442e 0a0a 2020 2020 2020  a Arc2D...      
+00019760: 2020 3a70 6172 616d 2065 6467 655f 7374    :param edge_st
+00019770: 796c 653a 2065 6467 6520 7374 796c 652e  yle: edge style.
+00019780: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00019790: 3a20 706c 6f74 5f64 6174 612e 4172 6332  : plot_data.Arc2
+000197a0: 4420 6f62 6a65 6374 2e0a 2020 2020 2020  D object..      
+000197b0: 2020 2222 220a 2020 2020 2020 2020 6c69    """.        li
+000197c0: 7374 5f6e 6f64 6520 3d20 7365 6c66 2e64  st_node = self.d
+000197d0: 6973 6372 6574 697a 6174 696f 6e5f 706f  iscretization_po
+000197e0: 696e 7473 286e 756d 6265 725f 706f 696e  ints(number_poin
+000197f0: 7473 3d32 3029 0a20 2020 2020 2020 2064  ts=20).        d
+00019800: 6174 6120 3d20 5b5d 0a20 2020 2020 2020  ata = [].       
+00019810: 2066 6f72 206e 6420 696e 206c 6973 745f   for nd in list_
+00019820: 6e6f 6465 3a0a 2020 2020 2020 2020 2020  node:.          
+00019830: 2020 6461 7461 2e61 7070 656e 6428 7b27    data.append({'
+00019840: 7827 3a20 6e64 2e78 2c20 2779 273a 206e  x': nd.x, 'y': n
+00019850: 642e 797d 290a 2020 2020 2020 2020 7265  d.y}).        re
+00019860: 7475 726e 2070 6c6f 745f 6461 7461 2e41  turn plot_data.A
+00019870: 7263 3244 2863 783d 7365 6c66 2e63 656e  rc2D(cx=self.cen
+00019880: 7465 722e 782c 0a20 2020 2020 2020 2020  ter.x,.         
+00019890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000198a0: 2020 2020 2020 6379 3d73 656c 662e 6365        cy=self.ce
+000198b0: 6e74 6572 2e79 2c0a 2020 2020 2020 2020  nter.y,.        
+000198c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000198d0: 2020 2020 2020 2072 3d73 656c 662e 7261         r=self.ra
+000198e0: 6469 7573 2c0a 2020 2020 2020 2020 2020  dius,.          
+000198f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019900: 2020 2020 2073 7461 7274 5f61 6e67 6c65       start_angle
+00019910: 3d73 656c 662e 616e 676c 6531 2c0a 2020  =self.angle1,.  
+00019920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019930: 2020 2020 2020 2020 2020 2020 2065 6e64               end
+00019940: 5f61 6e67 6c65 3d73 656c 662e 616e 676c  _angle=self.angl
+00019950: 6532 2c0a 2020 2020 2020 2020 2020 2020  e2,.            
+00019960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019970: 2020 2065 6467 655f 7374 796c 653d 6564     edge_style=ed
+00019980: 6765 5f73 7479 6c65 2c0a 2020 2020 2020  ge_style,.      
+00019990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000199a0: 2020 2020 2020 2020 2064 6174 613d 6461           data=da
+000199b0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+000199c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000199d0: 2020 2061 6e74 6963 6c6f 636b 7769 7365     anticlockwise
+000199e0: 3d61 6e74 6963 6c6f 636b 7769 7365 2c0a  =anticlockwise,.
+000199f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019a00: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00019a10: 616d 653d 7365 6c66 2e6e 616d 6529 0a0a  ame=self.name)..
+00019a20: 2020 2020 6465 6620 636f 7079 2873 656c      def copy(sel
+00019a30: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00019a40: 6773 293a 0a20 2020 2020 2020 2072 6574  gs):.        ret
+00019a50: 7572 6e20 4172 6332 4428 7365 6c66 2e73  urn Arc2D(self.s
+00019a60: 7461 7274 2e63 6f70 7928 292c 0a20 2020  tart.copy(),.   
+00019a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019a80: 2020 7365 6c66 2e69 6e74 6572 696f 722e    self.interior.
+00019a90: 636f 7079 2829 2c0a 2020 2020 2020 2020  copy(),.        
+00019aa0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00019ab0: 662e 656e 642e 636f 7079 2829 290a 0a20  f.end.copy()).. 
+00019ac0: 2020 2064 6566 2073 706c 6974 2873 656c     def split(sel
+00019ad0: 662c 2073 706c 6974 5f70 6f69 6e74 3a20  f, split_point: 
+00019ae0: 766f 6c6d 646c 722e 506f 696e 7432 4429  volmdlr.Point2D)
+00019af0: 3a0a 2020 2020 2020 2020 6162 7363 6973  :.        abscis
+00019b00: 7361 203d 2073 656c 662e 6162 7363 6973  sa = self.abscis
+00019b10: 7361 2873 706c 6974 5f70 6f69 6e74 290a  sa(split_point).
+00019b20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00019b30: 5b41 7263 3244 2873 656c 662e 7374 6172  [Arc2D(self.star
+00019b40: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+00019b50: 2020 2020 2020 2020 2073 656c 662e 706f           self.po
+00019b60: 696e 745f 6174 5f61 6273 6369 7373 6128  int_at_abscissa(
+00019b70: 302e 3520 2a20 6162 7363 6973 7361 292c  0.5 * abscissa),
+00019b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019b90: 2020 2020 2020 2073 706c 6974 5f70 6f69         split_poi
+00019ba0: 6e74 292c 0a20 2020 2020 2020 2020 2020  nt),.           
+00019bb0: 2020 2020 2041 7263 3244 2873 706c 6974       Arc2D(split
+00019bc0: 5f70 6f69 6e74 2c0a 2020 2020 2020 2020  _point,.        
+00019bd0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00019be0: 6c66 2e70 6f69 6e74 5f61 745f 6162 7363  lf.point_at_absc
+00019bf0: 6973 7361 2828 7365 6c66 2e61 6273 6369  issa((self.absci
+00019c00: 7373 6128 7365 6c66 2e65 6e64 290a 2020  ssa(self.end).  
+00019c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c30: 2020 2020 2020 2020 2020 2020 2d20 6162              - ab
+00019c40: 7363 6973 7361 2920 2a20 302e 3520 2b20  scissa) * 0.5 + 
+00019c50: 6162 7363 6973 7361 292c 0a20 2020 2020  abscissa),.     
+00019c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c70: 2073 656c 662e 656e 6429 0a20 2020 2020   self.end).     
+00019c80: 2020 2020 2020 2020 2020 205d 0a0a 2020             ]..  
+00019c90: 2020 6465 6620 6375 745f 6265 7477 6565    def cut_betwee
+00019ca0: 6e5f 7477 6f5f 706f 696e 7473 2873 656c  n_two_points(sel
+00019cb0: 662c 2070 6f69 6e74 312c 2070 6f69 6e74  f, point1, point
+00019cc0: 3229 3a0a 2020 2020 2020 2020 2222 220a  2):.        """.
+00019cd0: 2020 2020 2020 2020 4375 7473 2041 7263          Cuts Arc
+00019ce0: 2062 6574 7765 656e 2074 6f20 706f 696e   between to poin
+00019cf0: 7473 2c20 616e 6420 7265 7475 726e 2074  ts, and return t
+00019d00: 6865 2061 206e 6577 2061 7263 2062 7765  he a new arc bwe
+00019d10: 7477 6565 6e20 7468 6573 6520 7477 6f20  tween these two 
+00019d20: 706f 696e 7473 2e0a 0a20 2020 2020 2020  points...       
+00019d30: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+00019d40: 2870 6f69 6e74 3120 3d3d 2073 656c 662e  (point1 == self.
+00019d50: 7374 6172 7420 616e 6420 706f 696e 7432  start and point2
+00019d60: 203d 3d20 7365 6c66 2e65 6e64 2920 6f72   == self.end) or
+00019d70: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+00019d80: 2020 2028 706f 696e 7432 203d 3d20 7365     (point2 == se
+00019d90: 6c66 2e73 7461 7274 2061 6e64 2070 6f69  lf.start and poi
+00019da0: 6e74 3120 3d3d 2073 656c 662e 656e 6429  nt1 == self.end)
+00019db0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00019dc0: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
+00019dd0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+00019de0: 6d65 6e74 6564 4572 726f 720a 0a20 2020  mentedError..   
+00019df0: 2064 6566 2069 6e66 696e 6974 655f 7072   def infinite_pr
+00019e00: 696d 6974 6976 6528 7365 6c66 2c20 6f66  imitive(self, of
+00019e10: 6673 6574 293a 0a20 2020 2020 2020 2076  fset):.        v
+00019e20: 6563 746f 725f 7374 6172 745f 6365 6e74  ector_start_cent
+00019e30: 6572 203d 2073 656c 662e 7374 6172 7420  er = self.start 
+00019e40: 2d20 7365 6c66 2e63 656e 7465 720a 2020  - self.center.  
+00019e50: 2020 2020 2020 7665 6374 6f72 5f73 7461        vector_sta
+00019e60: 7274 5f63 656e 7465 722e 6e6f 726d 616c  rt_center.normal
+00019e70: 697a 6528 290a 2020 2020 2020 2020 7665  ize().        ve
+00019e80: 6374 6f72 5f65 6e64 5f63 656e 7465 7220  ctor_end_center 
+00019e90: 3d20 7365 6c66 2e65 6e64 202d 2073 656c  = self.end - sel
+00019ea0: 662e 6365 6e74 6572 0a20 2020 2020 2020  f.center.       
+00019eb0: 2076 6563 746f 725f 656e 645f 6365 6e74   vector_end_cent
+00019ec0: 6572 2e6e 6f72 6d61 6c69 7a65 2829 0a20  er.normalize(). 
+00019ed0: 2020 2020 2020 2076 6563 746f 725f 696e         vector_in
+00019ee0: 7465 7269 6f72 5f63 656e 7465 7220 3d20  terior_center = 
+00019ef0: 7365 6c66 2e69 6e74 6572 696f 7220 2d20  self.interior - 
+00019f00: 7365 6c66 2e63 656e 7465 720a 2020 2020  self.center.    
+00019f10: 2020 2020 7665 6374 6f72 5f69 6e74 6572      vector_inter
+00019f20: 696f 725f 6365 6e74 6572 2e6e 6f72 6d61  ior_center.norma
+00019f30: 6c69 7a65 2829 0a20 2020 2020 2020 2069  lize().        i
+00019f40: 6620 7365 6c66 2e69 735f 7472 6967 6f3a  f self.is_trigo:
+00019f50: 0a20 2020 2020 2020 2020 2020 2072 6164  .            rad
+00019f60: 6975 7320 3d20 7365 6c66 2e72 6164 6975  ius = self.radiu
+00019f70: 7320 2b20 6f66 6673 6574 0a20 2020 2020  s + offset.     
+00019f80: 2020 2020 2020 2063 656e 7465 7220 3d20         center = 
+00019f90: 7365 6c66 2e63 656e 7465 720a 0a20 2020  self.center..   
+00019fa0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00019fb0: 2020 2020 2020 2072 6164 6975 7320 3d20         radius = 
+00019fc0: 7365 6c66 2e72 6164 6975 7320 2d20 6f66  self.radius - of
+00019fd0: 6673 6574 0a20 2020 2020 2020 2020 2020  fset.           
+00019fe0: 2069 6620 7261 6469 7573 203c 2030 3a0a   if radius < 0:.
+00019ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a000: 7265 7475 726e 204e 6f6e 650a 2020 2020  return None.    
+0001a010: 2020 2020 2020 2020 6365 6e74 6572 203d          center =
+0001a020: 2073 656c 662e 6365 6e74 6572 0a20 2020   self.center.   
+0001a030: 2020 2020 2020 2020 2023 206d 6964 5f70           # mid_p
+0001a040: 6f69 6e74 203d 2073 656c 662e 6d69 6464  oint = self.midd
+0001a050: 6c65 5f70 6f69 6e74 2829 0a20 2020 2020  le_point().     
+0001a060: 2020 2020 2020 2023 2076 6563 3120 3d20         # vec1 = 
+0001a070: 7365 6c66 2e63 656e 7465 7220 2d20 6d69  self.center - mi
+0001a080: 645f 706f 696e 740a 2020 2020 2020 2020  d_point.        
+0001a090: 2020 2020 2320 7665 6331 2e6e 6f72 6d61      # vec1.norma
+0001a0a0: 6c69 7a65 2829 0a20 2020 2020 2020 2020  lize().         
+0001a0b0: 2020 2023 2076 6563 3120 3d20 3220 2a20     # vec1 = 2 * 
+0001a0c0: 6f66 6673 6574 202a 206d 6174 682e 7371  offset * math.sq
+0001a0d0: 7274 2832 2920 2a20 7665 6331 0a20 2020  rt(2) * vec1.   
+0001a0e0: 2020 2020 2020 2020 2023 2063 656e 7465           # cente
+0001a0f0: 7220 3d20 7365 6c66 2e63 656e 7465 722e  r = self.center.
+0001a100: 7472 616e 736c 6174 696f 6e28 7665 6331  translation(vec1
+0001a110: 290a 2020 2020 2020 2020 7374 6172 7420  ).        start 
+0001a120: 3d20 6365 6e74 6572 202b 2072 6164 6975  = center + radiu
+0001a130: 7320 2a20 7665 6374 6f72 5f73 7461 7274  s * vector_start
+0001a140: 5f63 656e 7465 720a 2020 2020 2020 2020  _center.        
+0001a150: 656e 6420 3d20 6365 6e74 6572 202b 2072  end = center + r
+0001a160: 6164 6975 7320 2a20 7665 6374 6f72 5f65  adius * vector_e
+0001a170: 6e64 5f63 656e 7465 720a 2020 2020 2020  nd_center.      
+0001a180: 2020 696e 7465 7269 6f72 203d 2063 656e    interior = cen
+0001a190: 7465 7220 2b20 7261 6469 7573 202a 2076  ter + radius * v
+0001a1a0: 6563 746f 725f 696e 7465 7269 6f72 5f63  ector_interior_c
+0001a1b0: 656e 7465 720a 2020 2020 2020 2020 7265  enter.        re
+0001a1c0: 7475 726e 2041 7263 3244 2873 7461 7274  turn Arc2D(start
+0001a1d0: 2c20 696e 7465 7269 6f72 2c20 656e 6429  , interior, end)
+0001a1e0: 0a0a 2020 2020 6465 6620 636f 6d70 6c65  ..    def comple
+0001a1f0: 6d65 6e74 6172 7928 7365 6c66 293a 0a0a  mentary(self):..
+0001a200: 2020 2020 2020 2020 696e 7465 7269 6f72          interior
+0001a210: 203d 2073 656c 662e 6d69 6464 6c65 5f70   = self.middle_p
+0001a220: 6f69 6e74 2829 2e72 6f74 6174 696f 6e28  oint().rotation(
+0001a230: 7365 6c66 2e63 656e 7465 722c 206d 6174  self.center, mat
+0001a240: 682e 7069 290a 2020 2020 2020 2020 7265  h.pi).        re
+0001a250: 7475 726e 2041 7263 3244 2873 656c 662e  turn Arc2D(self.
+0001a260: 7374 6172 742c 2069 6e74 6572 696f 722c  start, interior,
+0001a270: 2073 656c 662e 656e 6429 0a0a 2020 2020   self.end)..    
+0001a280: 6465 6620 746f 5f77 6972 6528 7365 6c66  def to_wire(self
+0001a290: 2c20 616e 676c 655f 7265 736f 6c75 7469  , angle_resoluti
+0001a2a0: 6f6e 3a20 666c 6f61 7420 3d20 3130 2e29  on: float = 10.)
+0001a2b0: 3a0a 2020 2020 2020 2020 2222 2220 436f  :.        """ Co
+0001a2c0: 6e76 6572 7420 616e 2061 7263 2074 6f20  nvert an arc to 
+0001a2d0: 6120 7769 7265 3264 2064 6566 696e 6564  a wire2d defined
+0001a2e0: 2077 6974 6820 6c69 6e65 5f73 6567 6d65   with line_segme
+0001a2f0: 6e74 732e 2022 2222 0a20 2020 2020 2020  nts. """.       
+0001a300: 2072 6574 7572 6e20 766f 6c6d 646c 722e   return volmdlr.
+0001a310: 7769 7265 732e 5769 7265 3244 2e66 726f  wires.Wire2D.fro
+0001a320: 6d5f 706f 696e 7473 2873 656c 662e 6469  m_points(self.di
+0001a330: 7363 7265 7469 7a61 7469 6f6e 5f70 6f69  scretization_poi
+0001a340: 6e74 7328 616e 676c 655f 7265 736f 6c75  nts(angle_resolu
+0001a350: 7469 6f6e 3d61 6e67 6c65 5f72 6573 6f6c  tion=angle_resol
+0001a360: 7574 696f 6e29 290a 0a20 2020 2064 6566  ution))..    def
+0001a370: 2061 7869 616c 5f73 796d 6d65 7472 7928   axial_symmetry(
+0001a380: 7365 6c66 2c20 6c69 6e65 293a 0a20 2020  self, line):.   
+0001a390: 2020 2020 2022 2222 2046 696e 6473 206f       """ Finds o
+0001a3a0: 7574 2074 6865 2073 796d 6d65 7472 6963  ut the symmetric
+0001a3b0: 2061 7263 3264 2061 6363 6f72 6469 6e67   arc2d according
+0001a3c0: 2074 6f20 6120 6c69 6e65 2e20 2222 220a   to a line. """.
+0001a3d0: 2020 2020 2020 2020 706f 696e 7473 5f73          points_s
+0001a3e0: 796d 6d65 7472 7920 3d20 5b70 6f69 6e74  ymmetry = [point
+0001a3f0: 2e61 7869 616c 5f73 796d 6d65 7472 7928  .axial_symmetry(
+0001a400: 6c69 6e65 2920 666f 7220 706f 696e 7420  line) for point 
+0001a410: 696e 205b 7365 6c66 2e73 7461 7274 2c20  in [self.start, 
+0001a420: 7365 6c66 2e69 6e74 6572 696f 722c 2073  self.interior, s
+0001a430: 656c 662e 656e 645d 5d0a 0a20 2020 2020  elf.end]]..     
+0001a440: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0001a450: 5f63 6c61 7373 5f5f 2873 7461 7274 3d70  _class__(start=p
+0001a460: 6f69 6e74 735f 7379 6d6d 6574 7279 5b30  oints_symmetry[0
+0001a470: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0001a480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a490: 2069 6e74 6572 696f 723d 706f 696e 7473   interior=points
+0001a4a0: 5f73 796d 6d65 7472 795b 315d 2c0a 2020  _symmetry[1],.  
+0001a4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a4c0: 2020 2020 2020 2020 2020 2020 656e 643d              end=
+0001a4d0: 706f 696e 7473 5f73 796d 6d65 7472 795b  points_symmetry[
+0001a4e0: 325d 290a 0a20 2020 2064 6566 2072 6576  2])..    def rev
+0001a4f0: 6572 7365 2873 656c 6629 3a0a 2020 2020  erse(self):.    
+0001a500: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001a510: 5f5f 636c 6173 735f 5f28 7365 6c66 2e65  __class__(self.e
+0001a520: 6e64 2e63 6f70 7928 292c 2073 656c 662e  nd.copy(), self.
+0001a530: 696e 7465 7269 6f72 2e63 6f70 7928 292c  interior.copy(),
+0001a540: 2073 656c 662e 7374 6172 742e 636f 7079   self.start.copy
+0001a550: 2829 2c20 7365 6c66 2e6e 616d 6529 0a0a  (), self.name)..
+0001a560: 0a63 6c61 7373 2046 756c 6c41 7263 3244  .class FullArc2D
+0001a570: 2841 7263 3244 293a 0a20 2020 2022 2222  (Arc2D):.    """
+0001a580: 2041 6e20 6564 6765 2074 6861 7420 7374   An edge that st
+0001a590: 6172 7473 2061 7420 7374 6172 745f 656e  arts at start_en
+0001a5a0: 642c 2065 6e64 7320 6174 2074 6865 2073  d, ends at the s
+0001a5b0: 616d 6520 706f 696e 7420 6166 7465 7220  ame point after 
+0001a5c0: 6861 7669 6e67 2064 6573 6372 6962 6564  having described
+0001a5d0: 2061 2063 6972 636c 652e 2022 2222 0a0a   a circle. """..
+0001a5e0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+0001a5f0: 2873 656c 662c 2063 656e 7465 723a 2076  (self, center: v
+0001a600: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 2c20  olmdlr.Point2D, 
+0001a610: 7374 6172 745f 656e 643a 2076 6f6c 6d64  start_end: volmd
+0001a620: 6c72 2e50 6f69 6e74 3244 2c0a 2020 2020  lr.Point2D,.    
+0001a630: 2020 2020 2020 2020 2020 2020 206e 616d               nam
+0001a640: 653a 2073 7472 203d 2027 2729 3a0a 2020  e: str = ''):.  
+0001a650: 2020 2020 2020 7365 6c66 2e5f 5f63 656e        self.__cen
+0001a660: 7465 7220 3d20 6365 6e74 6572 0a20 2020  ter = center.   
+0001a670: 2020 2020 2073 656c 662e 7374 6172 745f       self.start_
+0001a680: 656e 6420 3d20 7374 6172 745f 656e 640a  end = start_end.
+0001a690: 2020 2020 2020 2020 696e 7465 7269 6f72          interior
+0001a6a0: 203d 2073 7461 7274 5f65 6e64 2e72 6f74   = start_end.rot
+0001a6b0: 6174 696f 6e28 6365 6e74 6572 2c20 6d61  ation(center, ma
+0001a6c0: 7468 2e70 6929 0a20 2020 2020 2020 2041  th.pi).        A
+0001a6d0: 7263 3244 2e5f 5f69 6e69 745f 5f28 7365  rc2D.__init__(se
+0001a6e0: 6c66 2c20 7374 6172 743d 7374 6172 745f  lf, start=start_
+0001a6f0: 656e 642c 2069 6e74 6572 696f 723d 696e  end, interior=in
+0001a700: 7465 7269 6f72 2c0a 2020 2020 2020 2020  terior,.        
+0001a710: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001a720: 6e64 3d73 7461 7274 5f65 6e64 2c20 6e61  nd=start_end, na
+0001a730: 6d65 3d6e 616d 6529 2020 2320 2121 2120  me=name)  # !!! 
+0001a740: 7468 6973 2069 7320 6461 6e67 6572 6f75  this is dangerou
+0001a750: 730a 0a20 2020 2040 7072 6f70 6572 7479  s..    @property
+0001a760: 0a20 2020 2064 6566 2069 735f 7472 6967  .    def is_trig
+0001a770: 6f28 7365 6c66 293a 0a20 2020 2020 2020  o(self):.       
+0001a780: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
+0001a790: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0001a7a0: 6465 6620 6365 6e74 6572 2873 656c 6629  def center(self)
+0001a7b0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001a7c0: 2073 656c 662e 5f5f 6365 6e74 6572 0a0a   self.__center..
+0001a7d0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0001a7e0: 2020 6465 6620 616e 676c 6528 7365 6c66    def angle(self
+0001a7f0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0001a800: 6e20 766f 6c6d 646c 722e 5457 4f5f 5049  n volmdlr.TWO_PI
+0001a810: 0a0a 2020 2020 6465 6620 746f 5f64 6963  ..    def to_dic
+0001a820: 7428 7365 6c66 2c20 7573 655f 706f 696e  t(self, use_poin
+0001a830: 7465 7273 3a20 626f 6f6c 203d 2046 616c  ters: bool = Fal
+0001a840: 7365 2c20 6d65 6d6f 3d4e 6f6e 652c 2070  se, memo=None, p
+0001a850: 6174 683a 2073 7472 203d 2027 2327 293a  ath: str = '#'):
+0001a860: 0a20 2020 2020 2020 2064 6963 745f 203d  .        dict_ =
+0001a870: 2073 656c 662e 6261 7365 5f64 6963 7428   self.base_dict(
+0001a880: 290a 2020 2020 2020 2020 6469 6374 5f5b  ).        dict_[
+0001a890: 2763 656e 7465 7227 5d20 3d20 7365 6c66  'center'] = self
+0001a8a0: 2e63 656e 7465 722e 746f 5f64 6963 7428  .center.to_dict(
+0001a8b0: 7573 655f 706f 696e 7465 7273 3d75 7365  use_pointers=use
+0001a8c0: 5f70 6f69 6e74 6572 732c 206d 656d 6f3d  _pointers, memo=
+0001a8d0: 6d65 6d6f 2c20 7061 7468 3d70 6174 6820  memo, path=path 
+0001a8e0: 2b20 272f 6365 6e74 6572 2729 0a20 2020  + '/center').   
+0001a8f0: 2020 2020 2064 6963 745f 5b27 7261 6469       dict_['radi
+0001a900: 7573 275d 203d 2073 656c 662e 7261 6469  us'] = self.radi
+0001a910: 7573 0a20 2020 2020 2020 2064 6963 745f  us.        dict_
+0001a920: 5b27 616e 676c 6527 5d20 3d20 7365 6c66  ['angle'] = self
+0001a930: 2e61 6e67 6c65 0a20 2020 2020 2020 2064  .angle.        d
+0001a940: 6963 745f 5b27 6973 5f74 7269 676f 275d  ict_['is_trigo']
+0001a950: 203d 2073 656c 662e 6973 5f74 7269 676f   = self.is_trigo
+0001a960: 0a20 2020 2020 2020 2064 6963 745f 5b27  .        dict_['
+0001a970: 7374 6172 745f 656e 6427 5d20 3d20 7365  start_end'] = se
+0001a980: 6c66 2e73 7461 7274 2e74 6f5f 6469 6374  lf.start.to_dict
+0001a990: 2875 7365 5f70 6f69 6e74 6572 733d 7573  (use_pointers=us
+0001a9a0: 655f 706f 696e 7465 7273 2c20 6d65 6d6f  e_pointers, memo
+0001a9b0: 3d6d 656d 6f2c 2070 6174 683d 7061 7468  =memo, path=path
+0001a9c0: 202b 2027 2f73 7461 7274 5f65 6e64 2729   + '/start_end')
+0001a9d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001a9e0: 6469 6374 5f0a 0a20 2020 2064 6566 2063  dict_..    def c
+0001a9f0: 6f70 7928 7365 6c66 2c20 2a61 7267 732c  opy(self, *args,
+0001aa00: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+0001aa10: 2020 2020 7265 7475 726e 2046 756c 6c41      return FullA
+0001aa20: 7263 3244 2873 656c 662e 6365 6e74 6572  rc2D(self.center
+0001aa30: 2e63 6f70 7928 292c 2073 656c 662e 7374  .copy(), self.st
+0001aa40: 6172 742e 636f 7079 2829 290a 0a20 2020  art.copy())..   
+0001aa50: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+0001aa60: 2020 6465 6620 6469 6374 5f74 6f5f 6f62    def dict_to_ob
+0001aa70: 6a65 6374 2863 6c73 2c20 6469 6374 5f2c  ject(cls, dict_,
+0001aa80: 2067 6c6f 6261 6c5f 6469 6374 3d4e 6f6e   global_dict=Non
+0001aa90: 652c 2070 6f69 6e74 6572 735f 6d65 6d6f  e, pointers_memo
+0001aaa0: 3a20 4469 6374 5b73 7472 2c20 416e 795d  : Dict[str, Any]
+0001aab0: 203d 204e 6f6e 652c 2070 6174 683a 2073   = None, path: s
+0001aac0: 7472 203d 2027 2327 293a 0a20 2020 2020  tr = '#'):.     
+0001aad0: 2020 2063 656e 7465 7220 3d20 766f 6c6d     center = volm
+0001aae0: 646c 722e 506f 696e 7432 442e 6469 6374  dlr.Point2D.dict
+0001aaf0: 5f74 6f5f 6f62 6a65 6374 2864 6963 745f  _to_object(dict_
+0001ab00: 5b27 6365 6e74 6572 275d 290a 2020 2020  ['center']).    
+0001ab10: 2020 2020 7374 6172 745f 656e 6420 3d20      start_end = 
+0001ab20: 766f 6c6d 646c 722e 506f 696e 7432 442e  volmdlr.Point2D.
+0001ab30: 6469 6374 5f74 6f5f 6f62 6a65 6374 2864  dict_to_object(d
+0001ab40: 6963 745f 5b27 7374 6172 745f 656e 6427  ict_['start_end'
+0001ab50: 5d29 0a0a 2020 2020 2020 2020 7265 7475  ])..        retu
+0001ab60: 726e 2063 6c73 2863 656e 7465 722c 2073  rn cls(center, s
+0001ab70: 7461 7274 5f65 6e64 2c20 6e61 6d65 3d64  tart_end, name=d
+0001ab80: 6963 745f 5b27 6e61 6d65 275d 290a 0a20  ict_['name']).. 
+0001ab90: 2020 2064 6566 205f 5f68 6173 685f 5f28     def __hash__(
+0001aba0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+0001abb0: 6574 7572 6e20 6861 7368 2873 656c 662e  eturn hash(self.
+0001abc0: 7261 6469 7573 290a 2020 2020 2020 2020  radius).        
+0001abd0: 2320 7265 7475 726e 2068 6173 6828 7365  # return hash(se
+0001abe0: 6c66 2e63 656e 7465 7229 202b 2035 2a68  lf.center) + 5*h
+0001abf0: 6173 6828 7365 6c66 2e73 7461 7274 290a  ash(self.start).
+0001ac00: 0a20 2020 2064 6566 205f 5f65 715f 5f28  .    def __eq__(
+0001ac10: 7365 6c66 2c20 6f74 6865 725f 6172 6329  self, other_arc)
+0001ac20: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
+0001ac30: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
+0001ac40: 6d65 5f5f 2021 3d20 6f74 6865 725f 6172  me__ != other_ar
+0001ac50: 632e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  c.__class__.__na
+0001ac60: 6d65 5f5f 3a0a 2020 2020 2020 2020 2020  me__:.          
+0001ac70: 2020 7265 7475 726e 2046 616c 7365 0a20    return False. 
+0001ac80: 2020 2020 2020 2072 6574 7572 6e20 2873         return (s
+0001ac90: 656c 662e 6365 6e74 6572 203d 3d20 6f74  elf.center == ot
+0001aca0: 6865 725f 6172 632e 6365 6e74 6572 2920  her_arc.center) 
+0001acb0: 5c0a 2020 2020 2020 2020 2020 2020 616e  \.            an
+0001acc0: 6420 2873 656c 662e 7374 6172 745f 656e  d (self.start_en
+0001acd0: 6420 3d3d 206f 7468 6572 5f61 7263 2e73  d == other_arc.s
+0001ace0: 7461 7274 5f65 6e64 290a 0a20 2020 2040  tart_end)..    @
+0001acf0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0001ad00: 2062 6f75 6e64 696e 675f 7265 6374 616e   bounding_rectan
+0001ad10: 676c 6528 7365 6c66 293a 0a20 2020 2020  gle(self):.     
+0001ad20: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
+0001ad30: 626f 756e 6469 6e67 5f72 6563 7461 6e67  bounding_rectang
+0001ad40: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+0001ad50: 7365 6c66 2e5f 626f 756e 6469 6e67 5f72  self._bounding_r
+0001ad60: 6563 7461 6e67 6c65 203d 2076 6f6c 6d64  ectangle = volmd
+0001ad70: 6c72 2e63 6f72 652e 426f 756e 6469 6e67  lr.core.Bounding
+0001ad80: 5265 6374 616e 676c 6528 0a20 2020 2020  Rectangle(.     
+0001ad90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001ada0: 6365 6e74 6572 2e78 202d 2073 656c 662e  center.x - self.
+0001adb0: 7261 6469 7573 2c20 7365 6c66 2e63 656e  radius, self.cen
+0001adc0: 7465 722e 7820 2b20 7365 6c66 2e72 6164  ter.x + self.rad
+0001add0: 6975 732c 0a20 2020 2020 2020 2020 2020  ius,.           
+0001ade0: 2020 2020 2073 656c 662e 6365 6e74 6572       self.center
+0001adf0: 2e79 202d 2073 656c 662e 7261 6469 7573  .y - self.radius
+0001ae00: 2c20 7365 6c66 2e63 656e 7465 722e 7920  , self.center.y 
+0001ae10: 2b20 7365 6c66 2e72 6164 6975 7329 0a20  + self.radius). 
+0001ae20: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001ae30: 6c66 2e5f 626f 756e 6469 6e67 5f72 6563  lf._bounding_rec
+0001ae40: 7461 6e67 6c65 0a0a 2020 2020 6465 6620  tangle..    def 
+0001ae50: 7374 7261 6967 6874 5f6c 696e 655f 6172  straight_line_ar
+0001ae60: 6561 2873 656c 6629 3a0a 2020 2020 2020  ea(self):.      
+0001ae70: 2020 2222 220a 2020 2020 2020 2020 4361    """.        Ca
+0001ae80: 6c63 756c 6174 6573 2074 6865 2061 7265  lculates the are
+0001ae90: 6120 6f66 2074 6865 2066 756c 6c61 7263  a of the fullarc
+0001aea0: 2c20 7769 7468 206c 696e 6520 6472 6177  , with line draw
+0001aeb0: 6e20 6672 6f6d 2073 7461 7274 2074 6f20  n from start to 
+0001aec0: 656e 642e 0a0a 2020 2020 2020 2020 3a72  end...        :r
+0001aed0: 6574 7572 6e3a 2073 7472 6169 6768 745f  eturn: straight_
+0001aee0: 6c69 6e65 5f61 7265 612e 0a20 2020 2020  line_area..     
+0001aef0: 2020 2022 2222 0a20 2020 2020 2020 2061     """.        a
+0001af00: 7265 6120 3d20 7365 6c66 2e61 7265 6128  rea = self.area(
+0001af10: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0001af20: 2061 7265 610a 0a20 2020 2064 6566 2063   area..    def c
+0001af30: 656e 7465 725f 6f66 5f6d 6173 7328 7365  enter_of_mass(se
+0001af40: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+0001af50: 7572 6e20 7365 6c66 2e63 656e 7465 720a  urn self.center.
+0001af60: 0a20 2020 2064 6566 2073 7472 6169 6768  .    def straigh
+0001af70: 745f 6c69 6e65 5f63 656e 7465 725f 6f66  t_line_center_of
+0001af80: 5f6d 6173 7328 7365 6c66 293a 0a20 2020  _mass(self):.   
+0001af90: 2020 2020 2022 2222 5374 7261 6967 6874       """Straight
+0001afa0: 206c 696e 6520 6365 6e74 6572 206f 6620   line center of 
+0001afb0: 6d61 7373 2e22 2222 0a20 2020 2020 2020  mass.""".       
+0001afc0: 2072 6574 7572 6e20 7365 6c66 2e63 656e   return self.cen
+0001afd0: 7465 725f 6f66 5f6d 6173 7328 290a 0a20  ter_of_mass().. 
+0001afe0: 2020 2064 6566 2073 7472 6169 6768 745f     def straight_
+0001aff0: 6c69 6e65 5f70 6f69 6e74 5f62 656c 6f6e  line_point_belon
+0001b000: 6773 2873 656c 662c 2070 6f69 6e74 293a  gs(self, point):
+0001b010: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001b020: 2020 2020 2056 6572 6966 6965 7320 6966       Verifies if
+0001b030: 2061 2070 6f69 6e74 2062 656c 6f6e 6773   a point belongs
+0001b040: 2074 6f20 7468 6520 7375 7266 6163 6520   to the surface 
+0001b050: 6372 6561 7465 6420 6279 2063 6c6f 7369  created by closi
+0001b060: 6e67 2074 6865 2065 6467 652e 0a0a 2020  ng the edge...  
+0001b070: 2020 2020 2020 3a70 6172 616d 2070 6f69        :param poi
+0001b080: 6e74 3264 3a20 506f 696e 7420 746f 2062  nt2d: Point to b
+0001b090: 6520 7665 7269 6669 6564 2e0a 2020 2020  e verified..    
+0001b0a0: 2020 2020 3a72 6574 7572 6e3a 2052 6574      :return: Ret
+0001b0b0: 7572 6e20 5472 7565 2069 6620 7468 6520  urn True if the 
+0001b0c0: 706f 696e 7420 6265 6c6f 6e67 7320 746f  point belongs to
+0001b0d0: 2074 6869 7320 7375 7266 6163 652c 206f   this surface, o
+0001b0e0: 7220 4661 6c73 6520 6f74 6865 7277 6973  r False otherwis
+0001b0f0: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+0001b100: 2020 2020 2020 2069 6620 706f 696e 742e         if point.
+0001b110: 706f 696e 745f 6469 7374 616e 6365 2873  point_distance(s
+0001b120: 656c 662e 6365 6e74 6572 2920 3c3d 2073  elf.center) <= s
+0001b130: 656c 662e 7261 6469 7573 3a0a 2020 2020  elf.radius:.    
+0001b140: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+0001b150: 7275 650a 2020 2020 2020 2020 7265 7475  rue.        retu
+0001b160: 726e 2046 616c 7365 0a0a 2020 2020 6465  rn False..    de
+0001b170: 6620 746f 5f33 6428 7365 6c66 2c20 706c  f to_3d(self, pl
+0001b180: 616e 655f 6f72 6967 696e 2c20 782c 2079  ane_origin, x, y
+0001b190: 293a 0a20 2020 2020 2020 2063 656e 7465  ):.        cente
+0001b1a0: 7220 3d20 7365 6c66 2e63 656e 7465 722e  r = self.center.
+0001b1b0: 746f 5f33 6428 706c 616e 655f 6f72 6967  to_3d(plane_orig
+0001b1c0: 696e 2c20 782c 2079 290a 2020 2020 2020  in, x, y).      
+0001b1d0: 2020 7374 6172 7420 3d20 7365 6c66 2e73    start = self.s
+0001b1e0: 7461 7274 2e74 6f5f 3364 2870 6c61 6e65  tart.to_3d(plane
+0001b1f0: 5f6f 7269 6769 6e2c 2078 2c20 7929 0a20  _origin, x, y). 
+0001b200: 2020 2020 2020 207a 203d 2078 2e63 726f         z = x.cro
+0001b210: 7373 2879 290a 2020 2020 2020 2020 7a2e  ss(y).        z.
+0001b220: 6e6f 726d 616c 697a 6528 290a 0a20 2020  normalize()..   
+0001b230: 2020 2020 2072 6574 7572 6e20 4675 6c6c       return Full
+0001b240: 4172 6333 4428 6365 6e74 6572 2c20 7374  Arc3D(center, st
+0001b250: 6172 742c 207a 290a 0a20 2020 2064 6566  art, z)..    def
+0001b260: 2072 6f74 6174 696f 6e28 7365 6c66 2c20   rotation(self, 
+0001b270: 6365 6e74 6572 3a20 766f 6c6d 646c 722e  center: volmdlr.
+0001b280: 506f 696e 7432 442c 2061 6e67 6c65 3a20  Point2D, angle: 
+0001b290: 666c 6f61 7429 3a0a 2020 2020 2020 2020  float):.        
+0001b2a0: 6e65 775f 6365 6e74 6572 203d 2073 656c  new_center = sel
+0001b2b0: 662e 5f63 656e 7465 722e 726f 7461 7469  f._center.rotati
+0001b2c0: 6f6e 2863 656e 7465 722c 2061 6e67 6c65  on(center, angle
+0001b2d0: 2c20 5472 7565 290a 2020 2020 2020 2020  , True).        
+0001b2e0: 6e65 775f 7374 6172 745f 656e 6420 3d20  new_start_end = 
+0001b2f0: 7365 6c66 2e73 7461 7274 2e72 6f74 6174  self.start.rotat
+0001b300: 696f 6e28 6365 6e74 6572 2c20 616e 676c  ion(center, angl
+0001b310: 652c 2054 7275 6529 0a20 2020 2020 2020  e, True).       
+0001b320: 2072 6574 7572 6e20 4675 6c6c 4172 6332   return FullArc2
+0001b330: 4428 6e65 775f 6365 6e74 6572 2c20 6e65  D(new_center, ne
+0001b340: 775f 7374 6172 745f 656e 6429 0a0a 2020  w_start_end)..  
+0001b350: 2020 6465 6620 726f 7461 7469 6f6e 5f69    def rotation_i
+0001b360: 6e70 6c61 6365 2873 656c 662c 2063 656e  nplace(self, cen
+0001b370: 7465 723a 2076 6f6c 6d64 6c72 2e50 6f69  ter: volmdlr.Poi
+0001b380: 6e74 3244 2c20 616e 676c 653a 2066 6c6f  nt2D, angle: flo
+0001b390: 6174 293a 0a20 2020 2020 2020 2077 6172  at):.        war
+0001b3a0: 6e69 6e67 732e 7761 726e 2822 2769 6e70  nings.warn("'inp
+0001b3b0: 6c61 6365 2720 6d65 7468 6f64 7320 6172  lace' methods ar
+0001b3c0: 6520 6465 7072 6563 6174 6564 2e20 5573  e deprecated. Us
+0001b3d0: 6520 6120 6e6f 7420 696e 706c 6163 6520  e a not inplace 
+0001b3e0: 6d65 7468 6f64 2069 6e73 7465 6164 2e22  method instead."
+0001b3f0: 2c20 4465 7072 6563 6174 696f 6e57 6172  , DeprecationWar
+0001b400: 6e69 6e67 290a 0a20 2020 2020 2020 2073  ning)..        s
+0001b410: 656c 662e 5f63 656e 7465 722e 726f 7461  elf._center.rota
+0001b420: 7469 6f6e 2863 656e 7465 722c 2061 6e67  tion(center, ang
+0001b430: 6c65 2c20 4661 6c73 6529 0a20 2020 2020  le, False).     
+0001b440: 2020 2073 656c 662e 7374 6172 742e 726f     self.start.ro
+0001b450: 7461 7469 6f6e 2863 656e 7465 722c 2061  tation(center, a
+0001b460: 6e67 6c65 2c20 4661 6c73 6529 0a20 2020  ngle, False).   
+0001b470: 2020 2020 2073 656c 662e 696e 7465 7269       self.interi
+0001b480: 6f72 2e72 6f74 6174 696f 6e28 6365 6e74  or.rotation(cent
+0001b490: 6572 2c20 616e 676c 652c 2046 616c 7365  er, angle, False
+0001b4a0: 290a 2020 2020 2020 2020 7365 6c66 2e65  ).        self.e
+0001b4b0: 6e64 2e72 6f74 6174 696f 6e28 6365 6e74  nd.rotation(cent
+0001b4c0: 6572 2c20 616e 676c 652c 2046 616c 7365  er, angle, False
+0001b4d0: 290a 0a20 2020 2064 6566 2074 7261 6e73  )..    def trans
+0001b4e0: 6c61 7469 6f6e 2873 656c 662c 206f 6666  lation(self, off
+0001b4f0: 7365 743a 2076 6f6c 6d64 6c72 2e56 6563  set: volmdlr.Vec
+0001b500: 746f 7232 4429 3a0a 2020 2020 2020 2020  tor2D):.        
+0001b510: 6e65 775f 6365 6e74 6572 203d 2073 656c  new_center = sel
 0001b520: 662e 5f63 656e 7465 722e 7472 616e 736c  f._center.transl
-0001b530: 6174 696f 6e5f 696e 706c 6163 6528 6f66  ation_inplace(of
-0001b540: 6673 6574 290a 2020 2020 2020 2020 7365  fset).        se
-0001b550: 6c66 2e73 7461 7274 2e74 7261 6e73 6c61  lf.start.transla
-0001b560: 7469 6f6e 5f69 6e70 6c61 6365 286f 6666  tion_inplace(off
-0001b570: 7365 7429 0a20 2020 2020 2020 2073 656c  set).        sel
-0001b580: 662e 656e 642e 7472 616e 736c 6174 696f  f.end.translatio
-0001b590: 6e5f 696e 706c 6163 6528 6f66 6673 6574  n_inplace(offset
-0001b5a0: 290a 2020 2020 2020 2020 7365 6c66 2e69  ).        self.i
-0001b5b0: 6e74 6572 696f 722e 7472 616e 736c 6174  nterior.translat
-0001b5c0: 696f 6e5f 696e 706c 6163 6528 6f66 6673  ion_inplace(offs
-0001b5d0: 6574 290a 0a20 2020 2064 6566 2066 7261  et)..    def fra
-0001b5e0: 6d65 5f6d 6170 7069 6e67 2873 656c 662c  me_mapping(self,
-0001b5f0: 2066 7261 6d65 3a20 766f 6c6d 646c 722e   frame: volmdlr.
-0001b600: 4672 616d 6532 442c 2073 6964 653a 2073  Frame2D, side: s
-0001b610: 7472 293a 0a20 2020 2020 2020 2022 2222  tr):.        """
-0001b620: 0a20 2020 2020 2020 204d 6170 2074 6865  .        Map the
-0001b630: 2032 4420 6675 6c6c 2061 7263 2074 6f20   2D full arc to 
-0001b640: 6120 6e65 7720 6672 616d 6520 6f72 2069  a new frame or i
-0001b650: 7473 206f 7269 6769 6e61 6c20 6672 616d  ts original fram
-0001b660: 652e 0a0a 2020 2020 2020 2020 3a70 6172  e...        :par
-0001b670: 616d 2066 7261 6d65 3a20 5468 6520 7461  am frame: The ta
-0001b680: 7267 6574 2066 7261 6d65 2066 6f72 2074  rget frame for t
-0001b690: 6865 206d 6170 7069 6e67 2e0a 2020 2020  he mapping..    
-0001b6a0: 2020 2020 3a74 7970 6520 6672 616d 653a      :type frame:
-0001b6b0: 203a 636c 6173 733a 6076 6f6c 6d64 6c72   :class:`volmdlr
-0001b6c0: 2e46 7261 6d65 3244 600a 2020 2020 2020  .Frame2D`.      
-0001b6d0: 2020 3a70 6172 616d 2073 6964 653a 2053    :param side: S
-0001b6e0: 7065 6369 6679 2077 6865 7468 6572 2074  pecify whether t
-0001b6f0: 6f20 6d61 7020 7468 6520 6172 6320 746f  o map the arc to
-0001b700: 2074 6865 206e 6577 2066 7261 6d65 2028   the new frame (
-0001b710: 276e 6577 2729 0a20 2020 2020 2020 2020  'new').         
-0001b720: 2020 206f 7220 6974 7320 6f72 6967 696e     or its origin
-0001b730: 616c 2066 7261 6d65 2028 276f 6c64 2729  al frame ('old')
-0001b740: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-0001b750: 7369 6465 3a20 7374 720a 2020 2020 2020  side: str.      
-0001b760: 2020 3a72 6574 7572 6e3a 2054 6865 2066    :return: The f
-0001b770: 756c 6c20 6172 6320 696e 2074 6865 2073  ull arc in the s
-0001b780: 7065 6369 6669 6564 2066 7261 6d65 2e0a  pecified frame..
-0001b790: 2020 2020 2020 2020 3a72 7479 7065 3a20          :rtype: 
-0001b7a0: 3a63 6c61 7373 3a60 766f 6c6d 646c 722e  :class:`volmdlr.
-0001b7b0: 6564 6765 732e 4675 6c6c 4172 6332 4460  edges.FullArc2D`
-0001b7c0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001b7d0: 2020 2020 2072 6574 7572 6e20 4675 6c6c       return Full
-0001b7e0: 4172 6332 4428 2a5b 706f 696e 742e 6672  Arc2D(*[point.fr
-0001b7f0: 616d 655f 6d61 7070 696e 6728 6672 616d  ame_mapping(fram
-0001b800: 652c 2073 6964 6529 2066 6f72 2070 6f69  e, side) for poi
-0001b810: 6e74 2069 6e0a 2020 2020 2020 2020 2020  nt in.          
-0001b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b830: 205b 7365 6c66 2e5f 6365 6e74 6572 2c20   [self._center, 
-0001b840: 7365 6c66 2e73 7461 7274 5d5d 290a 0a20  self.start]]).. 
-0001b850: 2020 2064 6566 2066 7261 6d65 5f6d 6170     def frame_map
-0001b860: 7069 6e67 5f69 6e70 6c61 6365 2873 656c  ping_inplace(sel
-0001b870: 662c 2066 7261 6d65 3a20 766f 6c6d 646c  f, frame: volmdl
-0001b880: 722e 4672 616d 6532 442c 2073 6964 653a  r.Frame2D, side:
-0001b890: 2073 7472 293a 0a20 2020 2020 2020 2077   str):.        w
-0001b8a0: 6172 6e69 6e67 732e 7761 726e 2822 2769  arnings.warn("'i
-0001b8b0: 6e70 6c61 6365 2720 6d65 7468 6f64 7320  nplace' methods 
-0001b8c0: 6172 6520 6465 7072 6563 6174 6564 2e20  are deprecated. 
-0001b8d0: 5573 6520 6120 6e6f 7420 696e 706c 6163  Use a not inplac
-0001b8e0: 6520 6d65 7468 6f64 2069 6e73 7465 6164  e method instead
-0001b8f0: 2e22 2c20 4465 7072 6563 6174 696f 6e57  .", DeprecationW
-0001b900: 6172 6e69 6e67 290a 0a20 2020 2020 2020  arning)..       
-0001b910: 2066 6f72 2070 2069 6e20 5b73 656c 662e   for p in [self.
-0001b920: 5f63 656e 7465 722c 2073 656c 662e 7374  _center, self.st
-0001b930: 6172 742c 2073 656c 662e 656e 642c 2073  art, self.end, s
-0001b940: 656c 662e 696e 7465 7269 6f72 5d3a 0a20  elf.interior]:. 
-0001b950: 2020 2020 2020 2020 2020 2070 2e66 7261             p.fra
-0001b960: 6d65 5f6d 6170 7069 6e67 5f69 6e70 6c61  me_mapping_inpla
-0001b970: 6365 2866 7261 6d65 2c20 7369 6465 290a  ce(frame, side).
-0001b980: 0a20 2020 2064 6566 2070 6f6c 7967 6f6e  .    def polygon
-0001b990: 697a 6174 696f 6e28 7365 6c66 293a 0a20  ization(self):. 
-0001b9a0: 2020 2020 2020 2072 6574 7572 6e20 766f         return vo
-0001b9b0: 6c6d 646c 722e 7769 7265 732e 436c 6f73  lmdlr.wires.Clos
-0001b9c0: 6564 506f 6c79 676f 6e32 4428 7365 6c66  edPolygon2D(self
-0001b9d0: 2e64 6973 6372 6574 697a 6174 696f 6e5f  .discretization_
-0001b9e0: 706f 696e 7473 2861 6e67 6c65 5f72 6573  points(angle_res
-0001b9f0: 6f6c 7574 696f 6e3d 3135 2929 0a0a 2020  olution=15))..  
-0001ba00: 2020 6465 6620 706c 6f74 2873 656c 662c    def plot(self,
-0001ba10: 2061 783d 4e6f 6e65 2c20 636f 6c6f 723d   ax=None, color=
-0001ba20: 276b 272c 2061 6c70 6861 3d31 2c20 706c  'k', alpha=1, pl
-0001ba30: 6f74 5f70 6f69 6e74 733d 4661 6c73 652c  ot_points=False,
-0001ba40: 0a20 2020 2020 2020 2020 2020 2020 6c69  .             li
-0001ba50: 6e65 7374 796c 653d 272d 272c 206c 696e  nestyle='-', lin
-0001ba60: 6577 6964 7468 3d31 293a 0a20 2020 2020  ewidth=1):.     
-0001ba70: 2020 2069 6620 6178 2069 7320 4e6f 6e65     if ax is None
-0001ba80: 3a0a 2020 2020 2020 2020 2020 2020 5f2c  :.            _,
-0001ba90: 2061 7820 3d20 706c 742e 7375 6270 6c6f   ax = plt.subplo
-0001baa0: 7473 2829 0a0a 2020 2020 2020 2020 6966  ts()..        if
-0001bab0: 2073 656c 662e 7261 6469 7573 203e 2030   self.radius > 0
-0001bac0: 3a0a 2020 2020 2020 2020 2020 2020 6178  :.            ax
-0001bad0: 2e61 6464 5f70 6174 6368 286d 6174 706c  .add_patch(matpl
-0001bae0: 6f74 6c69 622e 7061 7463 6865 732e 4172  otlib.patches.Ar
-0001baf0: 6328 2873 656c 662e 6365 6e74 6572 2e78  c((self.center.x
-0001bb00: 2c20 7365 6c66 2e63 656e 7465 722e 7929  , self.center.y)
-0001bb10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb40: 2020 3220 2a20 7365 6c66 2e72 6164 6975    2 * self.radiu
-0001bb50: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0001bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb80: 2020 2032 202a 2073 656c 662e 7261 6469     2 * self.radi
-0001bb90: 7573 2c0a 2020 2020 2020 2020 2020 2020  us,.            
-0001bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bbc0: 2020 2020 616e 676c 653d 302c 0a20 2020      angle=0,.   
-0001bbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bbf0: 2020 2020 2020 2020 2020 2020 2074 6865               the
-0001bc00: 7461 313d 302c 0a20 2020 2020 2020 2020  ta1=0,.         
-0001bc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bc30: 2020 2020 2020 2074 6865 7461 323d 3336         theta2=36
-0001bc40: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-0001bc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b530: 6174 696f 6e28 6f66 6673 6574 290a 2020  ation(offset).  
+0001b540: 2020 2020 2020 6e65 775f 7374 6172 745f        new_start_
+0001b550: 656e 6420 3d20 7365 6c66 2e73 7461 7274  end = self.start
+0001b560: 2e74 7261 6e73 6c61 7469 6f6e 286f 6666  .translation(off
+0001b570: 7365 7429 0a20 2020 2020 2020 2072 6574  set).        ret
+0001b580: 7572 6e20 4675 6c6c 4172 6332 4428 6e65  urn FullArc2D(ne
+0001b590: 775f 6365 6e74 6572 2c20 6e65 775f 7374  w_center, new_st
+0001b5a0: 6172 745f 656e 6429 0a0a 2020 2020 6465  art_end)..    de
+0001b5b0: 6620 7472 616e 736c 6174 696f 6e5f 696e  f translation_in
+0001b5c0: 706c 6163 6528 7365 6c66 2c20 6f66 6673  place(self, offs
+0001b5d0: 6574 3a20 766f 6c6d 646c 722e 5665 6374  et: volmdlr.Vect
+0001b5e0: 6f72 3244 293a 0a20 2020 2020 2020 2077  or2D):.        w
+0001b5f0: 6172 6e69 6e67 732e 7761 726e 2822 2769  arnings.warn("'i
+0001b600: 6e70 6c61 6365 2720 6d65 7468 6f64 7320  nplace' methods 
+0001b610: 6172 6520 6465 7072 6563 6174 6564 2e20  are deprecated. 
+0001b620: 5573 6520 6120 6e6f 7420 696e 706c 6163  Use a not inplac
+0001b630: 6520 6d65 7468 6f64 2069 6e73 7465 6164  e method instead
+0001b640: 2e22 2c20 4465 7072 6563 6174 696f 6e57  .", DeprecationW
+0001b650: 6172 6e69 6e67 290a 0a20 2020 2020 2020  arning)..       
+0001b660: 2073 656c 662e 5f63 656e 7465 722e 7472   self._center.tr
+0001b670: 616e 736c 6174 696f 6e5f 696e 706c 6163  anslation_inplac
+0001b680: 6528 6f66 6673 6574 290a 2020 2020 2020  e(offset).      
+0001b690: 2020 7365 6c66 2e73 7461 7274 2e74 7261    self.start.tra
+0001b6a0: 6e73 6c61 7469 6f6e 5f69 6e70 6c61 6365  nslation_inplace
+0001b6b0: 286f 6666 7365 7429 0a20 2020 2020 2020  (offset).       
+0001b6c0: 2073 656c 662e 656e 642e 7472 616e 736c   self.end.transl
+0001b6d0: 6174 696f 6e5f 696e 706c 6163 6528 6f66  ation_inplace(of
+0001b6e0: 6673 6574 290a 2020 2020 2020 2020 7365  fset).        se
+0001b6f0: 6c66 2e69 6e74 6572 696f 722e 7472 616e  lf.interior.tran
+0001b700: 736c 6174 696f 6e5f 696e 706c 6163 6528  slation_inplace(
+0001b710: 6f66 6673 6574 290a 0a20 2020 2064 6566  offset)..    def
+0001b720: 2066 7261 6d65 5f6d 6170 7069 6e67 2873   frame_mapping(s
+0001b730: 656c 662c 2066 7261 6d65 3a20 766f 6c6d  elf, frame: volm
+0001b740: 646c 722e 4672 616d 6532 442c 2073 6964  dlr.Frame2D, sid
+0001b750: 653a 2073 7472 293a 0a20 2020 2020 2020  e: str):.       
+0001b760: 2022 2222 0a20 2020 2020 2020 204d 6170   """.        Map
+0001b770: 2074 6865 2032 4420 6675 6c6c 2061 7263   the 2D full arc
+0001b780: 2074 6f20 6120 6e65 7720 6672 616d 6520   to a new frame 
+0001b790: 6f72 2069 7473 206f 7269 6769 6e61 6c20  or its original 
+0001b7a0: 6672 616d 652e 0a0a 2020 2020 2020 2020  frame...        
+0001b7b0: 3a70 6172 616d 2066 7261 6d65 3a20 5468  :param frame: Th
+0001b7c0: 6520 7461 7267 6574 2066 7261 6d65 2066  e target frame f
+0001b7d0: 6f72 2074 6865 206d 6170 7069 6e67 2e0a  or the mapping..
+0001b7e0: 2020 2020 2020 2020 3a74 7970 6520 6672          :type fr
+0001b7f0: 616d 653a 203a 636c 6173 733a 6076 6f6c  ame: :class:`vol
+0001b800: 6d64 6c72 2e46 7261 6d65 3244 600a 2020  mdlr.Frame2D`.  
+0001b810: 2020 2020 2020 3a70 6172 616d 2073 6964        :param sid
+0001b820: 653a 2053 7065 6369 6679 2077 6865 7468  e: Specify wheth
+0001b830: 6572 2074 6f20 6d61 7020 7468 6520 6172  er to map the ar
+0001b840: 6320 746f 2074 6865 206e 6577 2066 7261  c to the new fra
+0001b850: 6d65 2028 276e 6577 2729 0a20 2020 2020  me ('new').     
+0001b860: 2020 2020 2020 206f 7220 6974 7320 6f72         or its or
+0001b870: 6967 696e 616c 2066 7261 6d65 2028 276f  iginal frame ('o
+0001b880: 6c64 2729 2e0a 2020 2020 2020 2020 3a74  ld')..        :t
+0001b890: 7970 6520 7369 6465 3a20 7374 720a 2020  ype side: str.  
+0001b8a0: 2020 2020 2020 3a72 6574 7572 6e3a 2054        :return: T
+0001b8b0: 6865 2066 756c 6c20 6172 6320 696e 2074  he full arc in t
+0001b8c0: 6865 2073 7065 6369 6669 6564 2066 7261  he specified fra
+0001b8d0: 6d65 2e0a 2020 2020 2020 2020 3a72 7479  me..        :rty
+0001b8e0: 7065 3a20 3a63 6c61 7373 3a60 766f 6c6d  pe: :class:`volm
+0001b8f0: 646c 722e 6564 6765 732e 4675 6c6c 4172  dlr.edges.FullAr
+0001b900: 6332 4460 0a20 2020 2020 2020 2022 2222  c2D`.        """
+0001b910: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001b920: 4675 6c6c 4172 6332 4428 2a5b 706f 696e  FullArc2D(*[poin
+0001b930: 742e 6672 616d 655f 6d61 7070 696e 6728  t.frame_mapping(
+0001b940: 6672 616d 652c 2073 6964 6529 2066 6f72  frame, side) for
+0001b950: 2070 6f69 6e74 2069 6e0a 2020 2020 2020   point in.      
+0001b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b970: 2020 2020 205b 7365 6c66 2e5f 6365 6e74       [self._cent
+0001b980: 6572 2c20 7365 6c66 2e73 7461 7274 5d5d  er, self.start]]
+0001b990: 290a 0a20 2020 2064 6566 2066 7261 6d65  )..    def frame
+0001b9a0: 5f6d 6170 7069 6e67 5f69 6e70 6c61 6365  _mapping_inplace
+0001b9b0: 2873 656c 662c 2066 7261 6d65 3a20 766f  (self, frame: vo
+0001b9c0: 6c6d 646c 722e 4672 616d 6532 442c 2073  lmdlr.Frame2D, s
+0001b9d0: 6964 653a 2073 7472 293a 0a20 2020 2020  ide: str):.     
+0001b9e0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+0001b9f0: 2822 2769 6e70 6c61 6365 2720 6d65 7468  ("'inplace' meth
+0001ba00: 6f64 7320 6172 6520 6465 7072 6563 6174  ods are deprecat
+0001ba10: 6564 2e20 5573 6520 6120 6e6f 7420 696e  ed. Use a not in
+0001ba20: 706c 6163 6520 6d65 7468 6f64 2069 6e73  place method ins
+0001ba30: 7465 6164 2e22 2c20 4465 7072 6563 6174  tead.", Deprecat
+0001ba40: 696f 6e57 6172 6e69 6e67 290a 0a20 2020  ionWarning)..   
+0001ba50: 2020 2020 2066 6f72 2070 2069 6e20 5b73       for p in [s
+0001ba60: 656c 662e 5f63 656e 7465 722c 2073 656c  elf._center, sel
+0001ba70: 662e 7374 6172 742c 2073 656c 662e 656e  f.start, self.en
+0001ba80: 642c 2073 656c 662e 696e 7465 7269 6f72  d, self.interior
+0001ba90: 5d3a 0a20 2020 2020 2020 2020 2020 2070  ]:.            p
+0001baa0: 2e66 7261 6d65 5f6d 6170 7069 6e67 5f69  .frame_mapping_i
+0001bab0: 6e70 6c61 6365 2866 7261 6d65 2c20 7369  nplace(frame, si
+0001bac0: 6465 290a 0a20 2020 2064 6566 2070 6f6c  de)..    def pol
+0001bad0: 7967 6f6e 697a 6174 696f 6e28 7365 6c66  ygonization(self
+0001bae0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0001baf0: 6e20 766f 6c6d 646c 722e 7769 7265 732e  n volmdlr.wires.
+0001bb00: 436c 6f73 6564 506f 6c79 676f 6e32 4428  ClosedPolygon2D(
+0001bb10: 7365 6c66 2e64 6973 6372 6574 697a 6174  self.discretizat
+0001bb20: 696f 6e5f 706f 696e 7473 2861 6e67 6c65  ion_points(angle
+0001bb30: 5f72 6573 6f6c 7574 696f 6e3d 3135 2929  _resolution=15))
+0001bb40: 0a0a 2020 2020 6465 6620 706c 6f74 2873  ..    def plot(s
+0001bb50: 656c 662c 2061 783d 4e6f 6e65 2c20 636f  elf, ax=None, co
+0001bb60: 6c6f 723d 276b 272c 2061 6c70 6861 3d31  lor='k', alpha=1
+0001bb70: 2c20 706c 6f74 5f70 6f69 6e74 733d 4661  , plot_points=Fa
+0001bb80: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+0001bb90: 2020 6c69 6e65 7374 796c 653d 272d 272c    linestyle='-',
+0001bba0: 206c 696e 6577 6964 7468 3d31 293a 0a20   linewidth=1):. 
+0001bbb0: 2020 2020 2020 2069 6620 6178 2069 7320         if ax is 
+0001bbc0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0001bbd0: 2020 5f2c 2061 7820 3d20 706c 742e 7375    _, ax = plt.su
+0001bbe0: 6270 6c6f 7473 2829 0a0a 2020 2020 2020  bplots()..      
+0001bbf0: 2020 6966 2073 656c 662e 7261 6469 7573    if self.radius
+0001bc00: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+0001bc10: 2020 6178 2e61 6464 5f70 6174 6368 286d    ax.add_patch(m
+0001bc20: 6174 706c 6f74 6c69 622e 7061 7463 6865  atplotlib.patche
+0001bc30: 732e 4172 6328 2873 656c 662e 6365 6e74  s.Arc((self.cent
+0001bc40: 6572 2e78 2c20 7365 6c66 2e63 656e 7465  er.x, self.cente
+0001bc50: 722e 7929 2c0a 2020 2020 2020 2020 2020  r.y),.          
 0001bc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bc70: 2020 2063 6f6c 6f72 3d63 6f6c 6f72 2c0a     color=color,.
-0001bc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bc80: 2020 2020 2020 3220 2a20 7365 6c66 2e72        2 * self.r
+0001bc90: 6164 6975 732c 0a20 2020 2020 2020 2020  adius,.         
 0001bca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bcb0: 6c69 6e65 7374 796c 653d 6c69 6e65 7374  linestyle=linest
-0001bcc0: 796c 652c 0a20 2020 2020 2020 2020 2020  yle,.           
-0001bcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bcc0: 2020 2020 2020 2032 202a 2073 656c 662e         2 * self.
+0001bcd0: 7261 6469 7573 2c0a 2020 2020 2020 2020  radius,.        
 0001bce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bcf0: 2020 2020 206c 696e 6577 6964 7468 3d6c       linewidth=l
-0001bd00: 696e 6577 6964 7468 2929 0a20 2020 2020  inewidth)).     
-0001bd10: 2020 2069 6620 706c 6f74 5f70 6f69 6e74     if plot_point
-0001bd20: 733a 0a20 2020 2020 2020 2020 2020 2061  s:.            a
-0001bd30: 782e 706c 6f74 285b 7365 6c66 2e73 7461  x.plot([self.sta
-0001bd40: 7274 2e78 5d2c 205b 7365 6c66 2e73 7461  rt.x], [self.sta
-0001bd50: 7274 2e79 5d2c 2027 6f27 2c0a 2020 2020  rt.y], 'o',.    
+0001bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd00: 2020 2020 2020 2020 616e 676c 653d 302c          angle=0,
+0001bd10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd40: 2074 6865 7461 313d 302c 0a20 2020 2020   theta1=0,.     
+0001bd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001bd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bd70: 636f 6c6f 723d 636f 6c6f 722c 2061 6c70  color=color, alp
-0001bd80: 6861 3d61 6c70 6861 290a 2020 2020 2020  ha=alpha).      
-0001bd90: 2020 7265 7475 726e 2061 780a 0a20 2020    return ax..   
-0001bda0: 2064 6566 2063 7574 5f62 6574 7765 656e   def cut_between
-0001bdb0: 5f74 776f 5f70 6f69 6e74 7328 7365 6c66  _two_points(self
-0001bdc0: 2c20 706f 696e 7431 2c20 706f 696e 7432  , point1, point2
-0001bdd0: 293a 0a0a 2020 2020 2020 2020 7831 2c20  ):..        x1, 
-0001bde0: 7931 203d 2070 6f69 6e74 3120 2d20 7365  y1 = point1 - se
-0001bdf0: 6c66 2e63 656e 7465 720a 2020 2020 2020  lf.center.      
-0001be00: 2020 7832 2c20 7932 203d 2070 6f69 6e74    x2, y2 = point
-0001be10: 3220 2d20 7365 6c66 2e63 656e 7465 720a  2 - self.center.
-0001be20: 0a20 2020 2020 2020 2061 6e67 6c65 3120  .        angle1 
-0001be30: 3d20 6d61 7468 2e61 7461 6e32 2879 312c  = math.atan2(y1,
-0001be40: 2078 3129 0a20 2020 2020 2020 2061 6e67   x1).        ang
-0001be50: 6c65 3220 3d20 6d61 7468 2e61 7461 6e32  le2 = math.atan2
-0001be60: 2879 322c 2078 3229 0a20 2020 2020 2020  (y2, x2).       
-0001be70: 2069 6620 616e 676c 6532 203c 2061 6e67   if angle2 < ang
-0001be80: 6c65 313a 0a20 2020 2020 2020 2020 2020  le1:.           
-0001be90: 2061 6e67 6c65 3220 2b3d 2076 6f6c 6d64   angle2 += volmd
-0001bea0: 6c72 2e54 574f 5f50 490a 2020 2020 2020  lr.TWO_PI.      
-0001beb0: 2020 616e 676c 655f 6920 3d20 302e 3520    angle_i = 0.5 
-0001bec0: 2a20 2861 6e67 6c65 3120 2b20 616e 676c  * (angle1 + angl
-0001bed0: 6532 290a 2020 2020 2020 2020 696e 7465  e2).        inte
-0001bee0: 7269 6f72 203d 2070 6f69 6e74 312e 726f  rior = point1.ro
-0001bef0: 7461 7469 6f6e 2873 656c 662e 6365 6e74  tation(self.cent
-0001bf00: 6572 2c20 616e 676c 655f 6929 0a20 2020  er, angle_i).   
-0001bf10: 2020 2020 2061 7263 203d 2041 7263 3244       arc = Arc2D
-0001bf20: 2870 6f69 6e74 312c 2069 6e74 6572 696f  (point1, interio
-0001bf30: 722c 2070 6f69 6e74 3229 0a20 2020 2020  r, point2).     
-0001bf40: 2020 2069 6620 7365 6c66 2e69 735f 7472     if self.is_tr
-0001bf50: 6967 6f20 213d 2061 7263 2e69 735f 7472  igo != arc.is_tr
-0001bf60: 6967 6f3a 0a20 2020 2020 2020 2020 2020  igo:.           
-0001bf70: 2061 7263 203d 2061 7263 2e63 6f6d 706c   arc = arc.compl
-0001bf80: 656d 656e 7461 7279 2829 0a0a 2020 2020  ementary()..    
-0001bf90: 2020 2020 7265 7475 726e 2061 7263 0a0a      return arc..
-0001bfa0: 2020 2020 6465 6620 6c69 6e65 5f69 6e74      def line_int
-0001bfb0: 6572 7365 6374 696f 6e73 2873 656c 662c  ersections(self,
-0001bfc0: 206c 696e 6532 643a 204c 696e 6532 442c   line2d: Line2D,
-0001bfd0: 2074 6f6c 3d31 652d 3929 3a0a 2020 2020   tol=1e-9):.    
-0001bfe0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-0001bff0: 2020 2020 2069 6620 6c69 6e65 3264 2e73       if line2d.s
-0001c000: 7461 7274 203d 3d20 7365 6c66 2e63 656e  tart == self.cen
-0001c010: 7465 723a 0a20 2020 2020 2020 2020 2020  ter:.           
-0001c020: 2020 2020 2070 7431 203d 206c 696e 6532       pt1 = line2
-0001c030: 642e 656e 640a 2020 2020 2020 2020 2020  d.end.          
-0001c040: 2020 2020 2020 7665 6320 3d20 6c69 6e65        vec = line
-0001c050: 3264 2e73 7461 7274 202d 206c 696e 6532  2d.start - line2
-0001c060: 642e 656e 640a 2020 2020 2020 2020 2020  d.end.          
-0001c070: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001c080: 2020 2020 2020 2020 7074 3120 3d20 6c69          pt1 = li
-0001c090: 6e65 3264 2e73 7461 7274 0a20 2020 2020  ne2d.start.     
-0001c0a0: 2020 2020 2020 2020 2020 2076 6563 203d             vec =
-0001c0b0: 206c 696e 6532 642e 656e 6420 2d20 6c69   line2d.end - li
-0001c0c0: 6e65 3264 2e73 7461 7274 0a20 2020 2020  ne2d.start.     
-0001c0d0: 2020 2065 7863 6570 7420 4174 7472 6962     except Attrib
-0001c0e0: 7574 6545 7272 6f72 3a0a 2020 2020 2020  uteError:.      
-0001c0f0: 2020 2020 2020 6966 206c 696e 6532 642e        if line2d.
-0001c100: 706f 696e 7431 203d 3d20 7365 6c66 2e63  point1 == self.c
-0001c110: 656e 7465 723a 0a20 2020 2020 2020 2020  enter:.         
-0001c120: 2020 2020 2020 2070 7431 203d 206c 696e         pt1 = lin
-0001c130: 6532 642e 706f 696e 7432 0a20 2020 2020  e2d.point2.     
-0001c140: 2020 2020 2020 2020 2020 2076 6563 203d             vec =
-0001c150: 206c 696e 6532 642e 706f 696e 7431 202d   line2d.point1 -
-0001c160: 206c 696e 6532 642e 706f 696e 7432 0a20   line2d.point2. 
-0001c170: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001c180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c190: 2070 7431 203d 206c 696e 6532 642e 706f   pt1 = line2d.po
-0001c1a0: 696e 7431 0a20 2020 2020 2020 2020 2020  int1.           
-0001c1b0: 2020 2020 2076 6563 203d 206c 696e 6532       vec = line2
-0001c1c0: 642e 706f 696e 7432 202d 206c 696e 6532  d.point2 - line2
-0001c1d0: 642e 706f 696e 7431 0a20 2020 2020 2020  d.point1.       
-0001c1e0: 2061 203d 2076 6563 2e64 6f74 2876 6563   a = vec.dot(vec
-0001c1f0: 290a 2020 2020 2020 2020 6220 3d20 3220  ).        b = 2 
-0001c200: 2a20 7665 632e 646f 7428 7074 3120 2d20  * vec.dot(pt1 - 
-0001c210: 7365 6c66 2e63 656e 7465 7229 0a20 2020  self.center).   
-0001c220: 2020 2020 2063 203d 2070 7431 2e64 6f74       c = pt1.dot
-0001c230: 2870 7431 2920 2b20 7365 6c66 2e63 656e  (pt1) + self.cen
-0001c240: 7465 722e 646f 7428 7365 6c66 2e63 656e  ter.dot(self.cen
-0001c250: 7465 7229 205c 0a20 2020 2020 2020 2020  ter) \.         
-0001c260: 2020 202d 2032 202a 2070 7431 2e64 6f74     - 2 * pt1.dot
-0001c270: 2873 656c 662e 6365 6e74 6572 2920 2d20  (self.center) - 
-0001c280: 7365 6c66 2e72 6164 6975 7320 2a2a 2032  self.radius ** 2
-0001c290: 0a0a 2020 2020 2020 2020 6469 7363 203d  ..        disc =
-0001c2a0: 2062 202a 2a20 3220 2d20 3420 2a20 6120   b ** 2 - 4 * a 
-0001c2b0: 2a20 630a 2020 2020 2020 2020 6966 206d  * c.        if m
-0001c2c0: 6174 682e 6973 636c 6f73 6528 6469 7363  ath.isclose(disc
-0001c2d0: 2c20 302e 2c20 6162 735f 746f 6c3d 746f  , 0., abs_tol=to
-0001c2e0: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
-0001c2f0: 7431 203d 202d 6220 2f20 2832 202a 2061  t1 = -b / (2 * a
-0001c300: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0001c310: 7475 726e 205b 7074 3120 2b20 7431 202a  turn [pt1 + t1 *
-0001c320: 2076 6563 5d0a 0a20 2020 2020 2020 2069   vec]..        i
-0001c330: 6620 6469 7363 203e 2030 3a0a 2020 2020  f disc > 0:.    
-0001c340: 2020 2020 2020 2020 7371 7274 5f64 6973          sqrt_dis
-0001c350: 6320 3d20 6d61 7468 2e73 7172 7428 6469  c = math.sqrt(di
-0001c360: 7363 290a 2020 2020 2020 2020 2020 2020  sc).            
-0001c370: 7431 203d 2028 2d62 202b 2073 7172 745f  t1 = (-b + sqrt_
-0001c380: 6469 7363 2920 2f20 2832 202a 2061 290a  disc) / (2 * a).
-0001c390: 2020 2020 2020 2020 2020 2020 7432 203d              t2 =
-0001c3a0: 2028 2d62 202d 2073 7172 745f 6469 7363   (-b - sqrt_disc
-0001c3b0: 2920 2f20 2832 202a 2061 290a 2020 2020  ) / (2 * a).    
-0001c3c0: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-0001c3d0: 7074 3120 2b20 7431 202a 2076 6563 2c0a  pt1 + t1 * vec,.
-0001c3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c3f0: 2020 2020 7074 3120 2b20 7432 202a 2076      pt1 + t2 * v
-0001c400: 6563 5d0a 0a20 2020 2020 2020 2072 6574  ec]..        ret
-0001c410: 7572 6e20 5b5d 0a0a 2020 2020 6465 6620  urn []..    def 
-0001c420: 6c69 6e65 7365 676d 656e 745f 696e 7465  linesegment_inte
-0001c430: 7273 6563 7469 6f6e 7328 7365 6c66 2c20  rsections(self, 
-0001c440: 6c69 6e65 7365 676d 656e 7432 643a 204c  linesegment2d: L
-0001c450: 696e 6553 6567 6d65 6e74 3244 2c20 746f  ineSegment2D, to
-0001c460: 6c3d 3165 2d39 293a 0a20 2020 2020 2020  l=1e-9):.       
-0001c470: 2069 6620 6e6f 7420 7365 6c66 2e62 6f75   if not self.bou
-0001c480: 6e64 696e 675f 7265 6374 616e 676c 652e  nding_rectangle.
-0001c490: 625f 7265 6374 616e 676c 655f 696e 7465  b_rectangle_inte
-0001c4a0: 7273 6563 7469 6f6e 286c 696e 6573 6567  rsection(lineseg
-0001c4b0: 6d65 6e74 3264 2e62 6f75 6e64 696e 675f  ment2d.bounding_
-0001c4c0: 7265 6374 616e 676c 6529 3a0a 2020 2020  rectangle):.    
-0001c4d0: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-0001c4e0: 5d0a 2020 2020 2020 2020 7472 793a 0a20  ].        try:. 
-0001c4f0: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
-0001c500: 6e65 7365 676d 656e 7432 642e 7374 6172  nesegment2d.star
-0001c510: 7420 3d3d 2073 656c 662e 6365 6e74 6572  t == self.center
-0001c520: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001c530: 2020 7074 3120 3d20 6c69 6e65 7365 676d    pt1 = linesegm
-0001c540: 656e 7432 642e 656e 640a 2020 2020 2020  ent2d.end.      
-0001c550: 2020 2020 2020 2020 2020 7665 6320 3d20            vec = 
-0001c560: 6c69 6e65 7365 676d 656e 7432 642e 7374  linesegment2d.st
-0001c570: 6172 7420 2d20 6c69 6e65 7365 676d 656e  art - linesegmen
-0001c580: 7432 642e 656e 640a 2020 2020 2020 2020  t2d.end.        
-0001c590: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001c5a0: 2020 2020 2020 2020 2020 7074 3120 3d20            pt1 = 
-0001c5b0: 6c69 6e65 7365 676d 656e 7432 642e 7374  linesegment2d.st
-0001c5c0: 6172 740a 2020 2020 2020 2020 2020 2020  art.            
-0001c5d0: 2020 2020 7665 6320 3d20 6c69 6e65 7365      vec = linese
-0001c5e0: 676d 656e 7432 642e 656e 6420 2d20 6c69  gment2d.end - li
-0001c5f0: 6e65 7365 676d 656e 7432 642e 7374 6172  nesegment2d.star
-0001c600: 740a 2020 2020 2020 2020 6578 6365 7074  t.        except
-0001c610: 2041 7474 7269 6275 7465 4572 726f 723a   AttributeError:
-0001c620: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001c630: 6c69 6e65 7365 676d 656e 7432 642e 706f  linesegment2d.po
-0001c640: 696e 7431 203d 3d20 7365 6c66 2e63 656e  int1 == self.cen
-0001c650: 7465 723a 0a20 2020 2020 2020 2020 2020  ter:.           
-0001c660: 2020 2020 2070 7431 203d 206c 696e 6573       pt1 = lines
-0001c670: 6567 6d65 6e74 3264 2e70 6f69 6e74 320a  egment2d.point2.
-0001c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c690: 7665 6320 3d20 6c69 6e65 7365 676d 656e  vec = linesegmen
-0001c6a0: 7432 642e 706f 696e 7431 202d 206c 696e  t2d.point1 - lin
-0001c6b0: 6573 6567 6d65 6e74 3264 2e70 6f69 6e74  esegment2d.point
-0001c6c0: 320a 2020 2020 2020 2020 2020 2020 656c  2.            el
-0001c6d0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001c6e0: 2020 2020 7074 3120 3d20 6c69 6e65 7365      pt1 = linese
-0001c6f0: 676d 656e 7432 642e 706f 696e 7431 0a20  gment2d.point1. 
-0001c700: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0001c710: 6563 203d 206c 696e 6573 6567 6d65 6e74  ec = linesegment
-0001c720: 3264 2e70 6f69 6e74 3220 2d20 6c69 6e65  2d.point2 - line
-0001c730: 7365 676d 656e 7432 642e 706f 696e 7431  segment2d.point1
-0001c740: 0a20 2020 2020 2020 2061 203d 2076 6563  .        a = vec
-0001c750: 2e64 6f74 2876 6563 290a 2020 2020 2020  .dot(vec).      
-0001c760: 2020 6220 3d20 3220 2a20 7665 632e 646f    b = 2 * vec.do
-0001c770: 7428 7074 3120 2d20 7365 6c66 2e63 656e  t(pt1 - self.cen
-0001c780: 7465 7229 0a20 2020 2020 2020 2063 203d  ter).        c =
-0001c790: 2070 7431 2e64 6f74 2870 7431 2920 2b20   pt1.dot(pt1) + 
-0001c7a0: 7365 6c66 2e63 656e 7465 722e 646f 7428  self.center.dot(
-0001c7b0: 7365 6c66 2e63 656e 7465 7229 205c 0a20  self.center) \. 
-0001c7c0: 2020 2020 2020 2020 2020 202d 2032 202a             - 2 *
-0001c7d0: 2070 7431 2e64 6f74 2873 656c 662e 6365   pt1.dot(self.ce
-0001c7e0: 6e74 6572 2920 2d20 7365 6c66 2e72 6164  nter) - self.rad
-0001c7f0: 6975 7320 2a2a 2032 0a0a 2020 2020 2020  ius ** 2..      
-0001c800: 2020 6469 7363 203d 2062 202a 2a20 3220    disc = b ** 2 
-0001c810: 2d20 3420 2a20 6120 2a20 630a 2020 2020  - 4 * a * c.    
-0001c820: 2020 2020 6966 206d 6174 682e 6973 636c      if math.iscl
-0001c830: 6f73 6528 6469 7363 2c20 302e 2c20 6162  ose(disc, 0., ab
-0001c840: 735f 746f 6c3d 746f 6c29 3a0a 2020 2020  s_tol=tol):.    
-0001c850: 2020 2020 2020 2020 7431 203d 202d 6220          t1 = -b 
-0001c860: 2f20 2832 202a 2061 290a 2020 2020 2020  / (2 * a).      
-0001c870: 2020 2020 2020 706f 696e 7473 203d 205b        points = [
-0001c880: 7074 3120 2b20 7431 202a 2076 6563 5d0a  pt1 + t1 * vec].
-0001c890: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0001c8a0: 696e 6573 6567 6d65 6e74 3264 2e70 6f69  inesegment2d.poi
-0001c8b0: 6e74 5f62 656c 6f6e 6773 2870 6f69 6e74  nt_belongs(point
-0001c8c0: 735b 305d 293a 0a20 2020 2020 2020 2020  s[0]):.         
-0001c8d0: 2020 2020 2020 2072 6574 7572 6e20 706f         return po
-0001c8e0: 696e 7473 0a20 2020 2020 2020 2020 2020  ints.           
-0001c8f0: 2072 6574 7572 6e20 5b5d 0a0a 2020 2020   return []..    
-0001c900: 2020 2020 6966 2064 6973 6320 3e20 303a      if disc > 0:
-0001c910: 0a20 2020 2020 2020 2020 2020 2073 7172  .            sqr
-0001c920: 745f 6469 7363 203d 206d 6174 682e 7371  t_disc = math.sq
-0001c930: 7274 2864 6973 6329 0a20 2020 2020 2020  rt(disc).       
-0001c940: 2020 2020 2074 3120 3d20 282d 6220 2b20       t1 = (-b + 
-0001c950: 7371 7274 5f64 6973 6329 202f 2028 3220  sqrt_disc) / (2 
-0001c960: 2a20 6129 0a20 2020 2020 2020 2020 2020  * a).           
-0001c970: 2074 3220 3d20 282d 6220 2d20 7371 7274   t2 = (-b - sqrt
-0001c980: 5f64 6973 6329 202f 2028 3220 2a20 6129  _disc) / (2 * a)
-0001c990: 0a20 2020 2020 2020 2020 2020 2070 6f69  .            poi
-0001c9a0: 6e74 7320 3d20 5b70 7431 202b 2074 3120  nts = [pt1 + t1 
-0001c9b0: 2a20 7665 632c 2070 7431 202b 2074 3220  * vec, pt1 + t2 
-0001c9c0: 2a20 7665 635d 0a20 2020 2020 2020 2020  * vec].         
-0001c9d0: 2020 2076 616c 6964 5f70 6f69 6e74 7320     valid_points 
-0001c9e0: 3d20 5b70 7420 666f 7220 7074 2069 6e20  = [pt for pt in 
-0001c9f0: 706f 696e 7473 2069 660a 2020 2020 2020  points if.      
-0001ca00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca10: 2020 2020 2020 6c69 6e65 7365 676d 656e        linesegmen
-0001ca20: 7432 642e 706f 696e 745f 6265 6c6f 6e67  t2d.point_belong
-0001ca30: 7328 7074 295d 0a20 2020 2020 2020 2020  s(pt)].         
-0001ca40: 2020 2072 6574 7572 6e20 7661 6c69 645f     return valid_
-0001ca50: 706f 696e 7473 0a0a 2020 2020 2020 2020  points..        
-0001ca60: 7265 7475 726e 205b 5d0a 0a20 2020 2064  return []..    d
-0001ca70: 6566 2072 6576 6572 7365 2873 656c 6629  ef reverse(self)
-0001ca80: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0001ca90: 2073 656c 660a 0a0a 636c 6173 7320 4172   self...class Ar
-0001caa0: 6345 6c6c 6970 7365 3244 2845 6467 6529  cEllipse2D(Edge)
-0001cab0: 3a0a 2020 2020 2222 220a 2020 2020 416e  :.    """.    An
-0001cac0: 2032 2064 696d 656e 7369 6f6e 616c 2065   2 dimensional e
-0001cad0: 6c6c 6970 7469 6361 6c20 6172 632e 0a0a  lliptical arc...
-0001cae0: 2020 2020 3a70 6172 616d 2073 7461 7274      :param start
-0001caf0: 3a20 5468 6520 7374 6172 7469 6e67 2070  : The starting p
-0001cb00: 6f69 6e74 206f 6620 7468 6520 656c 6c69  oint of the elli
-0001cb10: 7074 6963 616c 2061 7263 0a20 2020 203a  ptical arc.    :
-0001cb20: 7479 7065 2073 7461 7274 3a20 3a63 6c61  type start: :cla
-0001cb30: 7373 3a60 766f 6c6d 646c 722e 506f 696e  ss:`volmdlr.Poin
-0001cb40: 7432 4460 0a20 2020 203a 7061 7261 6d20  t2D`.    :param 
-0001cb50: 696e 7465 7269 6f72 3a20 416e 2069 6e74  interior: An int
-0001cb60: 6572 696f 7220 706f 696e 7420 6f66 2074  erior point of t
-0001cb70: 6865 2065 6c6c 6970 7469 6361 6c20 6172  he elliptical ar
-0001cb80: 630a 2020 2020 3a74 7970 6520 696e 7465  c.    :type inte
-0001cb90: 7269 6f72 3a20 3a63 6c61 7373 3a60 766f  rior: :class:`vo
-0001cba0: 6c6d 646c 722e 506f 696e 7432 4460 0a20  lmdlr.Point2D`. 
-0001cbb0: 2020 203a 7061 7261 6d20 656e 643a 2054     :param end: T
-0001cbc0: 6865 2065 6e64 2070 6f69 6e74 206f 6620  he end point of 
-0001cbd0: 7468 6520 656c 6c69 7074 6963 616c 2061  the elliptical a
-0001cbe0: 7263 0a20 2020 203a 7479 7065 2065 6e64  rc.    :type end
-0001cbf0: 3a20 3a63 6c61 7373 3a60 766f 6c6d 646c  : :class:`volmdl
-0001cc00: 722e 506f 696e 7432 4460 0a20 2020 203a  r.Point2D`.    :
-0001cc10: 7061 7261 6d20 6365 6e74 6572 3a20 5468  param center: Th
-0001cc20: 6520 6365 6e74 6572 206f 6620 7468 6520  e center of the 
-0001cc30: 656c 6c69 7073 650a 2020 2020 3a74 7970  ellipse.    :typ
-0001cc40: 6520 6365 6e74 6572 3a20 3a63 6c61 7373  e center: :class
-0001cc50: 3a60 766f 6c6d 646c 722e 506f 696e 7432  :`volmdlr.Point2
-0001cc60: 4460 0a20 2020 203a 7061 7261 6d20 6d61  D`.    :param ma
-0001cc70: 6a6f 725f 6469 723a 2054 6865 206d 616a  jor_dir: The maj
-0001cc80: 6f72 2064 6972 6563 7469 6f6e 206f 6620  or direction of 
-0001cc90: 7468 6520 656c 6c69 7073 650a 2020 2020  the ellipse.    
-0001cca0: 3a74 7970 6520 6d61 6a6f 725f 6469 723a  :type major_dir:
-0001ccb0: 203a 636c 6173 733a 6076 6f6c 6d64 6c72   :class:`volmdlr
-0001ccc0: 2e56 6563 746f 7232 4460 0a20 2020 203a  .Vector2D`.    :
-0001ccd0: 7061 7261 6d20 6e61 6d65 3a20 5468 6520  param name: The 
-0001cce0: 6e61 6d65 206f 6620 7468 6520 656c 6c69  name of the elli
-0001ccf0: 7074 6963 616c 2061 7263 2e20 4465 6661  ptical arc. Defa
-0001cd00: 756c 7420 7661 6c75 6520 6973 2027 270a  ult value is ''.
-0001cd10: 2020 2020 3a74 7970 6520 6e61 6d65 3a20      :type name: 
-0001cd20: 7374 722c 206f 7074 696f 6e61 6c0a 2020  str, optional.  
-0001cd30: 2020 3a70 6172 616d 2065 7874 7261 3a20    :param extra: 
-0001cd40: 416e 2065 7874 7261 2069 6e74 6572 696f  An extra interio
-0001cd50: 7220 706f 696e 7420 6966 2073 7461 7274  r point if start
-0001cd60: 2069 7320 6571 7561 6c20 746f 2065 6e64   is equal to end
-0001cd70: 2e20 4465 6661 756c 740a 2020 2020 2020  . Default.      
-0001cd80: 2020 7661 6c75 6520 6973 204e 6f6e 650a    value is None.
-0001cd90: 2020 2020 3a74 7970 6520 6578 7472 613a      :type extra:
-0001cda0: 203a 636c 6173 733a 6076 6f6c 6d64 6c72   :class:`volmdlr
-0001cdb0: 2e50 6f69 6e74 3244 602c 206f 7074 696f  .Point2D`, optio
-0001cdc0: 6e61 6c0a 2020 2020 2222 220a 0a20 2020  nal.    """..   
-0001cdd0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-0001cde0: 6c66 2c20 7374 6172 743a 2076 6f6c 6d64  lf, start: volmd
-0001cdf0: 6c72 2e50 6f69 6e74 3244 2c20 696e 7465  lr.Point2D, inte
-0001ce00: 7269 6f72 3a20 766f 6c6d 646c 722e 506f  rior: volmdlr.Po
-0001ce10: 696e 7432 442c 0a20 2020 2020 2020 2020  int2D,.         
-0001ce20: 2020 2020 2020 2020 656e 643a 2076 6f6c          end: vol
-0001ce30: 6d64 6c72 2e50 6f69 6e74 3244 2c20 6365  mdlr.Point2D, ce
-0001ce40: 6e74 6572 3a20 766f 6c6d 646c 722e 506f  nter: volmdlr.Po
-0001ce50: 696e 7432 442c 0a20 2020 2020 2020 2020  int2D,.         
-0001ce60: 2020 2020 2020 2020 6d61 6a6f 725f 6469          major_di
-0001ce70: 723a 2076 6f6c 6d64 6c72 2e56 6563 746f  r: volmdlr.Vecto
-0001ce80: 7232 442c 206e 616d 653a 2073 7472 203d  r2D, name: str =
-0001ce90: 2027 272c 0a20 2020 2020 2020 2020 2020   '',.           
-0001cea0: 2020 2020 2020 6578 7472 613a 2076 6f6c        extra: vol
-0001ceb0: 6d64 6c72 2e50 6f69 6e74 3244 203d 204e  mdlr.Point2D = N
-0001cec0: 6f6e 6529 3a0a 2020 2020 2020 2020 4564  one):.        Ed
-0001ced0: 6765 2e5f 5f69 6e69 745f 5f28 7365 6c66  ge.__init__(self
-0001cee0: 2c20 7374 6172 742c 2065 6e64 2c20 6e61  , start, end, na
-0001cef0: 6d65 290a 2020 2020 2020 2020 7365 6c66  me).        self
-0001cf00: 2e69 6e74 6572 696f 7220 3d20 696e 7465  .interior = inte
-0001cf10: 7269 6f72 0a20 2020 2020 2020 2073 656c  rior.        sel
-0001cf20: 662e 6365 6e74 6572 203d 2063 656e 7465  f.center = cente
-0001cf30: 720a 2020 2020 2020 2020 7365 6c66 2e65  r.        self.e
-0001cf40: 7874 7261 203d 2065 7874 7261 0a20 2020  xtra = extra.   
-0001cf50: 2020 2020 2073 656c 662e 6d61 6a6f 725f       self.major_
-0001cf60: 6469 7220 3d20 6d61 6a6f 725f 6469 720a  dir = major_dir.
-0001cf70: 2020 2020 2020 2020 7365 6c66 2e6d 696e          self.min
-0001cf80: 6f72 5f64 6972 203d 2073 656c 662e 6d61  or_dir = self.ma
-0001cf90: 6a6f 725f 6469 722e 6465 7465 726d 696e  jor_dir.determin
-0001cfa0: 6973 7469 635f 756e 6974 5f6e 6f72 6d61  istic_unit_norma
-0001cfb0: 6c5f 7665 6374 6f72 2829 0a20 2020 2020  l_vector().     
-0001cfc0: 2020 2066 7261 6d65 203d 2076 6f6c 6d64     frame = volmd
-0001cfd0: 6c72 2e46 7261 6d65 3244 2873 656c 662e  lr.Frame2D(self.
-0001cfe0: 6365 6e74 6572 2c20 7365 6c66 2e6d 616a  center, self.maj
-0001cff0: 6f72 5f64 6972 2c20 7365 6c66 2e6d 696e  or_dir, self.min
-0001d000: 6f72 5f64 6972 290a 2020 2020 2020 2020  or_dir).        
-0001d010: 7365 6c66 2e66 7261 6d65 203d 2066 7261  self.frame = fra
-0001d020: 6d65 0a20 2020 2020 2020 2073 7461 7274  me.        start
-0001d030: 5f6e 6577 203d 2066 7261 6d65 2e67 6c6f  _new = frame.glo
-0001d040: 6261 6c5f 746f 5f6c 6f63 616c 5f63 6f6f  bal_to_local_coo
-0001d050: 7264 696e 6174 6573 2873 656c 662e 7374  rdinates(self.st
-0001d060: 6172 7429 0a20 2020 2020 2020 2065 6e64  art).        end
-0001d070: 5f6e 6577 203d 2066 7261 6d65 2e67 6c6f  _new = frame.glo
-0001d080: 6261 6c5f 746f 5f6c 6f63 616c 5f63 6f6f  bal_to_local_coo
-0001d090: 7264 696e 6174 6573 2873 656c 662e 656e  rdinates(self.en
-0001d0a0: 6429 0a20 2020 2020 2020 2069 6e74 6572  d).        inter
-0001d0b0: 696f 725f 6e65 7720 3d20 6672 616d 652e  ior_new = frame.
-0001d0c0: 676c 6f62 616c 5f74 6f5f 6c6f 6361 6c5f  global_to_local_
-0001d0d0: 636f 6f72 6469 6e61 7465 7328 7365 6c66  coordinates(self
-0001d0e0: 2e69 6e74 6572 696f 7229 0a20 2020 2020  .interior).     
-0001d0f0: 2020 2063 656e 7465 725f 6e65 7720 3d20     center_new = 
-0001d100: 6672 616d 652e 676c 6f62 616c 5f74 6f5f  frame.global_to_
-0001d110: 6c6f 6361 6c5f 636f 6f72 6469 6e61 7465  local_coordinate
-0001d120: 7328 7365 6c66 2e63 656e 7465 7229 0a20  s(self.center). 
-0001d130: 2020 2020 2020 2073 656c 662e 5f62 6f75         self._bou
-0001d140: 6e64 696e 675f 7265 6374 616e 676c 6520  nding_rectangle 
-0001d150: 3d20 4e6f 6e65 0a0a 2020 2020 2020 2020  = None..        
-0001d160: 6465 6620 7468 6574 615f 415f 4228 732c  def theta_A_B(s,
-0001d170: 2069 2c20 652c 2063 293a 0a20 2020 2020   i, e, c):.     
-0001d180: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001d190: 2020 2020 2020 2046 726f 6d20 3a20 6874         From : ht
-0001d1a0: 7470 733a 2f2f 6d61 7468 2e73 7461 636b  tps://math.stack
-0001d1b0: 6578 6368 616e 6765 2e63 6f6d 2f71 7565  exchange.com/que
-0001d1c0: 7374 696f 6e73 2f33 3339 3132 362f 686f  stions/339126/ho
-0001d1d0: 772d 746f 2d64 7261 772d 616e 2d65 6c6c  w-to-draw-an-ell
-0001d1e0: 6970 7365 2d69 662d 612d 6365 6e74 6572  ipse-if-a-center
-0001d1f0: 2d61 6e64 2d33 2d61 7262 6974 7261 7279  -and-3-arbitrary
-0001d200: 2d70 6f69 6e74 732d 6f6e 2d69 742d 6172  -points-on-it-ar
-0001d210: 652d 6769 7665 6e2e 0a20 2020 2020 2020  e-given..       
-0001d220: 2020 2020 2074 6865 7461 3d20 656c 6c69       theta= elli
-0001d230: 7073 6527 7320 696e 636c 696e 6174 696f  pse's inclinatio
-0001d240: 6e20 616e 676c 6520 7265 6c61 7465 6420  n angle related 
-0001d250: 746f 2074 6865 2068 6f72 697a 6f6e 7461  to the horizonta
-0001d260: 6c0a 2020 2020 2020 2020 2020 2020 2863  l.            (c
-0001d270: 6c6f 636b 7769 7365 292c 413d 7365 6d69  lockwise),A=semi
-0001d280: 206d 616a 6f72 2061 7869 732c 2042 3d73   major axis, B=s
-0001d290: 656d 6920 6d69 6e6f 7220 6178 6973 2e0a  emi minor axis..
-0001d2a0: 0a20 2020 2020 2020 2020 2020 2022 2222  .            """
-0001d2b0: 0a20 2020 2020 2020 2020 2020 2078 732c  .            xs,
-0001d2c0: 2079 732c 2078 692c 2079 692c 2078 652c   ys, xi, yi, xe,
-0001d2d0: 2079 6520 3d20 735b 305d 202d 2063 5b30   ye = s[0] - c[0
-0001d2e0: 5d2c 2073 5b31 5d20 2d20 635b 315d 2c20  ], s[1] - c[1], 
-0001d2f0: 695b 305d 202d 2063 5b30 5d2c 2069 5b0a  i[0] - c[0], i[.
-0001d300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d310: 315d 202d 2063 5b31 5d2c 2065 5b30 5d20  1] - c[1], e[0] 
-0001d320: 2d20 635b 305d 2c20 655b 315d 202d 2063  - c[0], e[1] - c
-0001d330: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-0001d340: 4120 3d20 6e70 792e 6172 7261 7928 285b  A = npy.array(([
-0001d350: 7873 202a 2a20 322c 2079 7320 2a2a 2032  xs ** 2, ys ** 2
-0001d360: 2c20 3220 2a20 7873 202a 2079 735d 2c0a  , 2 * xs * ys],.
-0001d370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d380: 2020 2020 2020 2020 2020 205b 7869 202a             [xi *
-0001d390: 2a20 322c 2079 6920 2a2a 2032 2c20 3220  * 2, yi ** 2, 2 
-0001d3a0: 2a20 7869 202a 2079 695d 2c0a 2020 2020  * xi * yi],.    
-0001d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d3c0: 2020 2020 2020 205b 7865 202a 2a20 322c         [xe ** 2,
-0001d3d0: 2079 6520 2a2a 2032 2c20 3220 2a20 7865   ye ** 2, 2 * xe
-0001d3e0: 202a 2079 655d 2929 0a20 2020 2020 2020   * ye])).       
-0001d3f0: 2020 2020 2069 6e76 4120 3d20 6e70 792e       invA = npy.
-0001d400: 6c69 6e61 6c67 2e69 6e76 2841 290a 2020  linalg.inv(A).  
-0001d410: 2020 2020 2020 2020 2020 4f6e 6520 3d20            One = 
-0001d420: 6e70 792e 6172 7261 7928 285b 315d 2c0a  npy.array(([1],.
-0001d430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d440: 2020 2020 2020 2020 2020 2020 205b 315d               [1]
-0001d450: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001d460: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0001d470: 315d 2929 0a20 2020 2020 2020 2020 2020  1])).           
-0001d480: 2043 203d 206e 7079 2e64 6f74 2869 6e76   C = npy.dot(inv
-0001d490: 412c 204f 6e65 290a 2020 2020 2020 2020  A, One).        
-0001d4a0: 2020 2020 7468 6574 6120 3d20 302e 3520      theta = 0.5 
-0001d4b0: 2a20 6d61 7468 2e61 7461 6e28 3220 2a20  * math.atan(2 * 
-0001d4c0: 435b 325d 202f 2028 435b 315d 202d 2043  C[2] / (C[1] - C
-0001d4d0: 5b30 5d29 290a 2020 2020 2020 2020 2020  [0])).          
-0001d4e0: 2020 6331 203d 2043 5b30 5d20 2b20 435b    c1 = C[0] + C[
-0001d4f0: 315d 0a20 2020 2020 2020 2020 2020 2063  1].            c
-0001d500: 3220 3d20 2843 5b31 5d20 2d20 435b 305d  2 = (C[1] - C[0]
-0001d510: 2920 2f20 6d61 7468 2e63 6f73 2832 202a  ) / math.cos(2 *
-0001d520: 2074 6865 7461 290a 2020 2020 2020 2020   theta).        
-0001d530: 2020 2020 6764 6178 6520 3d20 6d61 7468      gdaxe = math
-0001d540: 2e73 7172 7428 2832 202f 2028 6331 202d  .sqrt((2 / (c1 -
-0001d550: 2063 3229 2929 0a20 2020 2020 2020 2020   c2))).         
-0001d560: 2020 2070 7461 7820 3d20 6d61 7468 2e73     ptax = math.s
-0001d570: 7172 7428 2832 202f 2028 6331 202b 2063  qrt((2 / (c1 + c
-0001d580: 3229 2929 0a20 2020 2020 2020 2020 2020  2))).           
-0001d590: 2072 6574 7572 6e20 7468 6574 612c 2067   return theta, g
-0001d5a0: 6461 7865 2c20 7074 6178 0a0a 2020 2020  daxe, ptax..    
-0001d5b0: 2020 2020 6966 2073 7461 7274 203d 3d20      if start == 
-0001d5c0: 656e 643a 0a20 2020 2020 2020 2020 2020  end:.           
-0001d5d0: 2065 7874 7261 5f6e 6577 203d 2066 7261   extra_new = fra
-0001d5e0: 6d65 2e67 6c6f 6261 6c5f 746f 5f6c 6f63  me.global_to_loc
-0001d5f0: 616c 5f63 6f6f 7264 696e 6174 6573 2873  al_coordinates(s
-0001d600: 656c 662e 6578 7472 6129 0a20 2020 2020  elf.extra).     
-0001d610: 2020 2020 2020 2074 6865 7461 2c20 6d61         theta, ma
-0001d620: 6a6f 725f 6178 6973 2c20 6d69 6e6f 725f  jor_axis, minor_
-0001d630: 6178 6973 203d 2074 6865 7461 5f41 5f42  axis = theta_A_B
-0001d640: 2873 7461 7274 5f6e 6577 2c20 6578 7472  (start_new, extr
-0001d650: 615f 6e65 772c 2069 6e74 6572 696f 725f  a_new, interior_
-0001d660: 6e65 772c 0a20 2020 2020 2020 2020 2020  new,.           
-0001d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d690: 2020 2020 2020 2020 2020 2063 656e 7465             cente
-0001d6a0: 725f 6e65 7729 0a20 2020 2020 2020 2065  r_new).        e
-0001d6b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001d6c0: 2074 6865 7461 2c20 6d61 6a6f 725f 6178   theta, major_ax
-0001d6d0: 6973 2c20 6d69 6e6f 725f 6178 6973 203d  is, minor_axis =
-0001d6e0: 2074 6865 7461 5f41 5f42 2873 7461 7274   theta_A_B(start
-0001d6f0: 5f6e 6577 2c20 696e 7465 7269 6f72 5f6e  _new, interior_n
-0001d700: 6577 2c20 656e 645f 6e65 772c 0a20 2020  ew, end_new,.   
-0001d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d740: 2020 2063 656e 7465 725f 6e65 7729 0a0a     center_new)..
-0001d750: 2020 2020 2020 2020 7365 6c66 2e6d 616a          self.maj
-0001d760: 6f72 5f61 7869 7320 3d20 6d61 6a6f 725f  or_axis = major_
-0001d770: 6178 6973 0a20 2020 2020 2020 2073 656c  axis.        sel
-0001d780: 662e 6d69 6e6f 725f 6178 6973 203d 206d  f.minor_axis = m
-0001d790: 696e 6f72 5f61 7869 730a 2020 2020 2020  inor_axis.      
-0001d7a0: 2020 7365 6c66 2e74 6865 7461 203d 2074    self.theta = t
-0001d7b0: 6865 7461 0a0a 2020 2020 2020 2020 2320  heta..        # 
-0001d7c0: 416e 676c 6520 706f 7572 2073 7461 7274  Angle pour start
-0001d7d0: 0a20 2020 2020 2020 2075 312c 2075 3220  .        u1, u2 
-0001d7e0: 3d20 7374 6172 745f 6e65 772e 7820 2f20  = start_new.x / 
-0001d7f0: 7365 6c66 2e6d 616a 6f72 5f61 7869 732c  self.major_axis,
-0001d800: 2073 7461 7274 5f6e 6577 2e79 202f 2073   start_new.y / s
-0001d810: 656c 662e 6d69 6e6f 725f 6178 6973 0a20  elf.minor_axis. 
-0001d820: 2020 2020 2020 2061 6e67 6c65 3120 3d20         angle1 = 
-0001d830: 766f 6c6d 646c 722e 6765 6f6d 6574 7279  volmdlr.geometry
-0001d840: 2e73 696e 5f63 6f73 5f61 6e67 6c65 2875  .sin_cos_angle(u
-0001d850: 312c 2075 3229 0a20 2020 2020 2020 2073  1, u2).        s
-0001d860: 656c 662e 616e 676c 655f 7374 6172 7420  elf.angle_start 
-0001d870: 3d20 616e 676c 6531 0a20 2020 2020 2020  = angle1.       
-0001d880: 2023 2041 6e67 6c65 2070 6f75 7220 656e   # Angle pour en
-0001d890: 640a 2020 2020 2020 2020 7533 2c20 7534  d.        u3, u4
-0001d8a0: 203d 2065 6e64 5f6e 6577 2e78 202f 2073   = end_new.x / s
-0001d8b0: 656c 662e 6d61 6a6f 725f 6178 6973 2c20  elf.major_axis, 
-0001d8c0: 656e 645f 6e65 772e 7920 2f20 7365 6c66  end_new.y / self
-0001d8d0: 2e6d 696e 6f72 5f61 7869 730a 2020 2020  .minor_axis.    
-0001d8e0: 2020 2020 616e 676c 6532 203d 2076 6f6c      angle2 = vol
-0001d8f0: 6d64 6c72 2e67 656f 6d65 7472 792e 7369  mdlr.geometry.si
-0001d900: 6e5f 636f 735f 616e 676c 6528 7533 2c20  n_cos_angle(u3, 
-0001d910: 7534 290a 2020 2020 2020 2020 7365 6c66  u4).        self
-0001d920: 2e61 6e67 6c65 5f65 6e64 203d 2061 6e67  .angle_end = ang
-0001d930: 6c65 320a 2020 2020 2020 2020 2320 416e  le2.        # An
-0001d940: 676c 6520 706f 7572 2069 6e74 6572 696f  gle pour interio
-0001d950: 720a 2020 2020 2020 2020 7535 2c20 7536  r.        u5, u6
-0001d960: 203d 2069 6e74 6572 696f 725f 6e65 772e   = interior_new.
-0001d970: 7820 2f20 7365 6c66 2e6d 616a 6f72 5f61  x / self.major_a
-0001d980: 7869 732c 2069 6e74 6572 696f 725f 6e65  xis, interior_ne
-0001d990: 772e 7920 2f20 7365 6c66 2e6d 696e 6f72  w.y / self.minor
-0001d9a0: 5f61 7869 730a 2020 2020 2020 2020 616e  _axis.        an
-0001d9b0: 676c 6569 203d 2076 6f6c 6d64 6c72 2e67  glei = volmdlr.g
-0001d9c0: 656f 6d65 7472 792e 7369 6e5f 636f 735f  eometry.sin_cos_
-0001d9d0: 616e 676c 6528 7535 2c20 7536 290a 2020  angle(u5, u6).  
-0001d9e0: 2020 2020 2020 7365 6c66 2e61 6e67 6c65        self.angle
-0001d9f0: 5f69 6e74 6572 696f 7220 3d20 616e 676c  _interior = angl
-0001da00: 6569 0a20 2020 2020 2020 2023 2047 6f69  ei.        # Goi
-0001da10: 6e67 2074 7269 676f 2f63 6c6f 636b 2077  ng trigo/clock w
-0001da20: 6973 6520 6672 6f6d 2073 7461 7274 2074  ise from start t
-0001da30: 6f20 696e 7465 7269 6f72 0a20 2020 2020  o interior.     
-0001da40: 2020 2069 6620 616e 676c 6569 203c 2061     if anglei < a
-0001da50: 6e67 6c65 313a 0a20 2020 2020 2020 2020  ngle1:.         
-0001da60: 2020 2074 7269 676f 7769 7365 5f70 6174     trigowise_pat
-0001da70: 6820 3d20 2861 6e67 6c65 6920 2b20 766f  h = (anglei + vo
-0001da80: 6c6d 646c 722e 5457 4f5f 5049 2920 2d20  lmdlr.TWO_PI) - 
-0001da90: 616e 676c 6531 0a20 2020 2020 2020 2020  angle1.         
-0001daa0: 2020 2063 6c6f 636b 7769 7365 5f70 6174     clockwise_pat
-0001dab0: 6820 3d20 616e 676c 6531 202d 2061 6e67  h = angle1 - ang
-0001dac0: 6c65 690a 2020 2020 2020 2020 656c 7365  lei.        else
-0001dad0: 3a0a 2020 2020 2020 2020 2020 2020 7472  :.            tr
-0001dae0: 6967 6f77 6973 655f 7061 7468 203d 2061  igowise_path = a
-0001daf0: 6e67 6c65 6920 2d20 616e 676c 6531 0a20  nglei - angle1. 
-0001db00: 2020 2020 2020 2020 2020 2063 6c6f 636b             clock
-0001db10: 7769 7365 5f70 6174 6820 3d20 616e 676c  wise_path = angl
-0001db20: 6531 202d 2061 6e67 6c65 6920 2b20 766f  e1 - anglei + vo
-0001db30: 6c6d 646c 722e 5457 4f5f 5049 0a0a 2020  lmdlr.TWO_PI..  
-0001db40: 2020 2020 2020 2320 476f 696e 6720 7472        # Going tr
-0001db50: 6967 6f20 7769 7365 2066 726f 6d20 696e  igo wise from in
-0001db60: 7465 7269 6f72 2074 6f20 696e 7465 7269  terior to interi
-0001db70: 6f72 0a20 2020 2020 2020 2069 6620 616e  or.        if an
-0001db80: 676c 6532 203c 2061 6e67 6c65 693a 0a20  gle2 < anglei:. 
-0001db90: 2020 2020 2020 2020 2020 2074 7269 676f             trigo
-0001dba0: 7769 7365 5f70 6174 6820 2b3d 2028 616e  wise_path += (an
-0001dbb0: 676c 6532 202b 2076 6f6c 6d64 6c72 2e54  gle2 + volmdlr.T
-0001dbc0: 574f 5f50 4929 202d 2061 6e67 6c65 690a  WO_PI) - anglei.
-0001dbd0: 2020 2020 2020 2020 2020 2020 636c 6f63              cloc
-0001dbe0: 6b77 6973 655f 7061 7468 202b 3d20 616e  kwise_path += an
-0001dbf0: 676c 6569 202d 2061 6e67 6c65 320a 2020  glei - angle2.  
-0001dc00: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001dc10: 2020 2020 2020 2020 7472 6967 6f77 6973          trigowis
-0001dc20: 655f 7061 7468 202b 3d20 616e 676c 6532  e_path += angle2
-0001dc30: 202d 2061 6e67 6c65 690a 2020 2020 2020   - anglei.      
-0001dc40: 2020 2020 2020 636c 6f63 6b77 6973 655f        clockwise_
-0001dc50: 7061 7468 202b 3d20 616e 676c 6569 202d  path += anglei -
-0001dc60: 2061 6e67 6c65 3220 2b20 766f 6c6d 646c   angle2 + volmdl
-0001dc70: 722e 5457 4f5f 5049 0a0a 2020 2020 2020  r.TWO_PI..      
-0001dc80: 2020 6966 2063 6c6f 636b 7769 7365 5f70    if clockwise_p
-0001dc90: 6174 6820 3e20 7472 6967 6f77 6973 655f  ath > trigowise_
-0001dca0: 7061 7468 3a0a 2020 2020 2020 2020 2020  path:.          
-0001dcb0: 2020 7365 6c66 2e69 735f 7472 6967 6f20    self.is_trigo 
-0001dcc0: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-0001dcd0: 2020 2073 656c 662e 616e 676c 6520 3d20     self.angle = 
-0001dce0: 7472 6967 6f77 6973 655f 7061 7468 0a20  trigowise_path. 
-0001dcf0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001dd00: 2020 2020 2020 2020 2023 2043 6c6f 636b           # Clock
-0001dd10: 2077 6973 650a 2020 2020 2020 2020 2020   wise.          
-0001dd20: 2020 7365 6c66 2e69 735f 7472 6967 6f20    self.is_trigo 
-0001dd30: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-0001dd40: 2020 2020 7365 6c66 2e61 6e67 6c65 203d      self.angle =
-0001dd50: 2063 6c6f 636b 7769 7365 5f70 6174 680a   clockwise_path.
-0001dd60: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0001dd70: 2e73 7461 7274 203d 3d20 7365 6c66 2e65  .start == self.e
-0001dd80: 6e64 206f 7220 7365 6c66 2e61 6e67 6c65  nd or self.angle
-0001dd90: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-0001dda0: 2020 2073 656c 662e 616e 676c 6520 3d20     self.angle = 
-0001ddb0: 766f 6c6d 646c 722e 5457 4f5f 5049 0a0a  volmdlr.TWO_PI..
-0001ddc0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001ddd0: 6973 5f74 7269 676f 3a20 2023 2073 656e  is_trigo:  # sen
-0001dde0: 7320 7472 6967 6f0a 2020 2020 2020 2020  s trigo.        
-0001ddf0: 2020 2020 7365 6c66 2e6f 6666 7365 745f      self.offset_
-0001de00: 616e 676c 6520 3d20 616e 676c 6531 0a20  angle = angle1. 
-0001de10: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001de20: 2020 2020 2020 2020 2073 656c 662e 6f66           self.of
-0001de30: 6673 6574 5f61 6e67 6c65 203d 2061 6e67  fset_angle = ang
-0001de40: 6c65 320a 0a20 2020 2064 6566 205f 6765  le2..    def _ge
-0001de50: 745f 706f 696e 7473 2873 656c 6629 3a0a  t_points(self):.
-0001de60: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001de70: 656c 662e 6469 7363 7265 7469 7a61 7469  elf.discretizati
-0001de80: 6f6e 5f70 6f69 6e74 7328 6e75 6d62 6572  on_points(number
-0001de90: 5f70 6f69 6e74 733d 3230 290a 0a20 2020  _points=20)..   
-0001dea0: 2070 6f69 6e74 7320 3d20 7072 6f70 6572   points = proper
-0001deb0: 7479 285f 6765 745f 706f 696e 7473 290a  ty(_get_points).
-0001dec0: 0a20 2020 2064 6566 206c 656e 6774 6828  .    def length(
-0001ded0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0001dee0: 2222 0a20 2020 2020 2020 2043 616c 6375  "".        Calcu
-0001def0: 6c61 7465 7320 7468 6520 6c65 6e67 7468  lates the length
-0001df00: 206f 6620 7468 6520 6172 6365 6c6c 6970   of the arcellip
-0001df10: 7365 3264 2e0a 0a20 2020 2020 2020 203a  se2d...        :
-0001df20: 7265 7475 726e 3a20 6172 6365 6c6c 6970  return: arcellip
-0001df30: 7365 3264 2773 206c 656e 6774 680a 2020  se2d's length.  
-0001df40: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001df50: 2020 6c65 6e67 7468 203d 2073 656c 662e    length = self.
-0001df60: 6162 7363 6973 7361 2873 656c 662e 656e  abscissa(self.en
-0001df70: 6429 0a20 2020 2020 2020 2072 6574 7572  d).        retur
-0001df80: 6e20 6c65 6e67 7468 0a0a 2020 2020 6465  n length..    de
-0001df90: 6620 706f 696e 745f 6265 6c6f 6e67 7328  f point_belongs(
-0001dfa0: 7365 6c66 2c20 706f 696e 742c 2061 6273  self, point, abs
-0001dfb0: 5f74 6f6c 3a20 666c 6f61 7420 3d20 3165  _tol: float = 1e
-0001dfc0: 2d36 293a 0a20 2020 2020 2020 2022 2222  -6):.        """
-0001dfd0: 0a20 2020 2020 2020 2056 6572 6966 6965  .        Verifie
-0001dfe0: 7320 6966 2061 2070 6f69 6e74 2062 656c  s if a point bel
-0001dff0: 6f6e 6773 2074 6f20 7468 6520 6172 6365  ongs to the arce
-0001e000: 6c6c 6970 7365 3264 2e0a 0a20 2020 2020  llipse2d...     
-0001e010: 2020 203a 7061 7261 6d20 706f 696e 743a     :param point:
-0001e020: 2070 6f69 6e74 2074 6f20 6265 2076 6572   point to be ver
-0001e030: 6966 6965 640a 2020 2020 2020 2020 3a70  ified.        :p
-0001e040: 6172 616d 2061 6273 5f74 6f6c 3a20 746f  aram abs_tol: to
-0001e050: 6c65 7261 6e63 6520 6170 706c 6965 6420  lerance applied 
-0001e060: 6475 7269 6e67 2063 616c 6375 6c61 7469  during calculati
-0001e070: 6f6e 730a 2020 2020 2020 2020 3a72 6574  ons.        :ret
-0001e080: 7572 6e3a 2054 7275 6520 6966 2074 6865  urn: True if the
-0001e090: 2070 6f69 6e74 2062 656c 6f6e 6773 2c20   point belongs, 
-0001e0a0: 4661 6c73 6520 6f74 6865 7277 6973 650a  False otherwise.
-0001e0b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001e0c0: 2020 2020 6966 206e 6f74 206d 6174 682e      if not math.
-0001e0d0: 6973 636c 6f73 6528 2870 6f69 6e74 2e78  isclose((point.x
-0001e0e0: 202d 2073 656c 662e 6365 6e74 6572 2e78   - self.center.x
-0001e0f0: 2920 2a2a 2032 202f 2073 656c 662e 6d61  ) ** 2 / self.ma
-0001e100: 6a6f 725f 6178 6973 202a 2a20 3220 2b0a  jor_axis ** 2 +.
-0001e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e120: 2020 2020 2020 2020 2020 2020 2870 6f69              (poi
-0001e130: 6e74 2e79 202d 2073 656c 662e 6365 6e74  nt.y - self.cent
-0001e140: 6572 2e79 2920 2a2a 2032 202f 2073 656c  er.y) ** 2 / sel
-0001e150: 662e 6d69 6e6f 725f 6178 6973 202a 2a20  f.minor_axis ** 
-0001e160: 322c 2031 2c20 6162 735f 746f 6c3d 6162  2, 1, abs_tol=ab
-0001e170: 735f 746f 6c29 2061 6e64 206e 6f74 205c  s_tol) and not \
-0001e180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e190: 206d 6174 682e 6973 636c 6f73 6528 2870   math.isclose((p
-0001e1a0: 6f69 6e74 2e78 202d 2073 656c 662e 6365  oint.x - self.ce
-0001e1b0: 6e74 6572 2e78 2920 2a2a 2032 202f 2073  nter.x) ** 2 / s
-0001e1c0: 656c 662e 6d69 6e6f 725f 6178 6973 202a  elf.minor_axis *
-0001e1d0: 2a20 3220 2b0a 2020 2020 2020 2020 2020  * 2 +.          
-0001e1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e1f0: 2020 2028 706f 696e 742e 7920 2d20 7365     (point.y - se
-0001e200: 6c66 2e63 656e 7465 722e 7929 202a 2a20  lf.center.y) ** 
-0001e210: 3220 2f20 7365 6c66 2e6d 616a 6f72 5f61  2 / self.major_a
-0001e220: 7869 7320 2a2a 2032 2c20 312c 2061 6273  xis ** 2, 1, abs
-0001e230: 5f74 6f6c 3d61 6273 5f74 6f6c 293a 0a20  _tol=abs_tol):. 
-0001e240: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001e250: 6e20 4661 6c73 650a 2020 2020 2020 2020  n False.        
-0001e260: 6e65 775f 706f 696e 7420 3d20 7365 6c66  new_point = self
-0001e270: 2e66 7261 6d65 2e67 6c6f 6261 6c5f 746f  .frame.global_to
-0001e280: 5f6c 6f63 616c 5f63 6f6f 7264 696e 6174  _local_coordinat
-0001e290: 6573 2870 6f69 6e74 290a 2020 2020 2020  es(point).      
-0001e2a0: 2020 7531 2c20 7532 203d 206e 6577 5f70    u1, u2 = new_p
-0001e2b0: 6f69 6e74 2e78 202f 2073 656c 662e 6d61  oint.x / self.ma
-0001e2c0: 6a6f 725f 6178 6973 2c20 6e65 775f 706f  jor_axis, new_po
-0001e2d0: 696e 742e 7920 2f20 7365 6c66 2e6d 696e  int.y / self.min
-0001e2e0: 6f72 5f61 7869 730a 2020 2020 2020 2020  or_axis.        
-0001e2f0: 616e 676c 655f 6e65 775f 706f 696e 7420  angle_new_point 
-0001e300: 3d20 766f 6c6d 646c 722e 6765 6f6d 6574  = volmdlr.geomet
-0001e310: 7279 2e73 696e 5f63 6f73 5f61 6e67 6c65  ry.sin_cos_angle
-0001e320: 2875 312c 2075 3229 0a20 2020 2020 2020  (u1, u2).       
-0001e330: 2069 6620 7365 6c66 2e61 6e67 6c65 5f73   if self.angle_s
-0001e340: 7461 7274 203c 2073 656c 662e 616e 676c  tart < self.angl
-0001e350: 655f 656e 6420 616e 6420 7365 6c66 2e61  e_end and self.a
-0001e360: 6e67 6c65 5f65 6e64 203e 3d20 616e 676c  ngle_end >= angl
-0001e370: 655f 6e65 775f 706f 696e 7420 3e3d 2073  e_new_point >= s
-0001e380: 656c 662e 616e 676c 655f 7374 6172 743a  elf.angle_start:
-0001e390: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001e3a0: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
-0001e3b0: 2069 6620 7365 6c66 2e61 6e67 6c65 5f73   if self.angle_s
-0001e3c0: 7461 7274 203e 2073 656c 662e 616e 676c  tart > self.angl
-0001e3d0: 655f 656e 6420 616e 6420 7365 6c66 2e61  e_end and self.a
-0001e3e0: 6e67 6c65 5f65 6e64 203c 3d20 616e 676c  ngle_end <= angl
-0001e3f0: 655f 6e65 775f 706f 696e 7420 3c3d 2073  e_new_point <= s
-0001e400: 656c 662e 616e 676c 655f 7374 6172 743a  elf.angle_start:
-0001e410: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001e420: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
-0001e430: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
-0001e440: 2020 2064 6566 2061 6273 6369 7373 6128     def abscissa(
-0001e450: 7365 6c66 2c20 706f 696e 743a 2076 6f6c  self, point: vol
-0001e460: 6d64 6c72 2e50 6f69 6e74 3244 293a 0a20  mdlr.Point2D):. 
-0001e470: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001e480: 2020 2043 616c 6375 6c61 7465 7320 7468     Calculates th
-0001e490: 6520 6162 7363 6973 7361 206f 6620 6120  e abscissa of a 
-0001e4a0: 6769 7665 6e20 706f 696e 742e 0a0a 2020  given point...  
-0001e4b0: 2020 2020 2020 3a70 6172 616d 2070 6f69        :param poi
-0001e4c0: 6e74 3a20 706f 696e 7420 666f 7220 6361  nt: point for ca
-0001e4d0: 6c63 756c 6174 696e 6720 6162 7363 6973  lculating abscis
-0001e4e0: 7361 0a20 2020 2020 2020 203a 7265 7475  sa.        :retu
-0001e4f0: 726e 3a20 6120 666c 6f61 742c 2062 6574  rn: a float, bet
-0001e500: 7765 656e 2030 2061 6e64 2074 6865 2061  ween 0 and the a
-0001e510: 7263 656c 6c69 7365 3264 2773 206c 656e  rcellise2d's len
-0001e520: 6774 680a 2020 2020 2020 2020 2222 220a  gth.        """.
-0001e530: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001e540: 706f 696e 745f 6265 6c6f 6e67 7328 706f  point_belongs(po
-0001e550: 696e 7429 3a0a 2020 2020 2020 2020 2020  int):.          
-0001e560: 2020 616e 676c 655f 6162 7363 6973 7361    angle_abscissa
-0001e570: 203d 2076 6f6c 6d64 6c72 2e67 656f 6d65   = volmdlr.geome
-0001e580: 7472 792e 636c 6f63 6b77 6973 655f 616e  try.clockwise_an
-0001e590: 676c 6528 706f 696e 7420 2d20 7365 6c66  gle(point - self
-0001e5a0: 2e63 656e 7465 722c 2073 656c 662e 6d61  .center, self.ma
-0001e5b0: 6a6f 725f 6469 7229 0a20 2020 2020 2020  jor_dir).       
-0001e5c0: 2020 2020 2061 6e67 6c65 5f73 7461 7274       angle_start
-0001e5d0: 203d 2073 656c 662e 616e 676c 655f 7374   = self.angle_st
-0001e5e0: 6172 740a 2020 2020 2020 2020 2020 2020  art.            
-0001e5f0: 616e 676c 655f 656e 6420 3d20 616e 676c  angle_end = angl
-0001e600: 655f 6162 7363 6973 7361 0a20 2020 2020  e_abscissa.     
-0001e610: 2020 2020 2020 2069 6620 7365 6c66 2e61         if self.a
-0001e620: 6e67 6c65 5f73 7461 7274 203e 2061 6e67  ngle_start > ang
-0001e630: 6c65 5f61 6273 6369 7373 6120 3e20 7365  le_abscissa > se
-0001e640: 6c66 2e61 6e67 6c65 5f65 6e64 3a0a 2020  lf.angle_end:.  
-0001e650: 2020 2020 2020 2020 2020 2020 2020 616e                an
-0001e660: 676c 655f 7374 6172 7420 3d20 616e 676c  gle_start = angl
-0001e670: 655f 6162 7363 6973 7361 0a20 2020 2020  e_abscissa.     
-0001e680: 2020 2020 2020 2020 2020 2061 6e67 6c65             angle
-0001e690: 5f65 6e64 203d 2073 656c 662e 616e 676c  _end = self.angl
-0001e6a0: 655f 7374 6172 740a 0a20 2020 2020 2020  e_start..       
-0001e6b0: 2020 2020 2064 6566 2061 7263 5f6c 656e       def arc_len
-0001e6c0: 6774 6828 7468 6574 6129 3a0a 2020 2020  gth(theta):.    
-0001e6d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001e6e0: 726e 206d 6174 682e 7371 7274 2828 7365  rn math.sqrt((se
-0001e6f0: 6c66 2e6d 616a 6f72 5f61 7869 7320 2a2a  lf.major_axis **
-0001e700: 2032 2920 2a20 6d61 7468 2e73 696e 2874   2) * math.sin(t
-0001e710: 6865 7461 2920 2a2a 2032 202b 0a20 2020  heta) ** 2 +.   
-0001e720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e730: 2020 2020 2020 2020 2020 2020 2020 2873                (s
-0001e740: 656c 662e 6d69 6e6f 725f 6178 6973 202a  elf.minor_axis *
-0001e750: 2a20 3229 202a 206d 6174 682e 636f 7328  * 2) * math.cos(
-0001e760: 7468 6574 6129 202a 2a20 3229 0a0a 2020  theta) ** 2)..  
-0001e770: 2020 2020 2020 2020 2020 7265 732c 205f            res, _
-0001e780: 203d 2073 6369 7079 5f69 6e74 6567 7261   = scipy_integra
-0001e790: 7465 2e71 7561 6428 6172 635f 6c65 6e67  te.quad(arc_leng
-0001e7a0: 7468 2c20 616e 676c 655f 7374 6172 742c  th, angle_start,
-0001e7b0: 2061 6e67 6c65 5f65 6e64 290a 2020 2020   angle_end).    
-0001e7c0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0001e7d0: 6573 0a20 2020 2020 2020 2072 6169 7365  es.        raise
-0001e7e0: 2056 616c 7565 4572 726f 7228 6627 706f   ValueError(f'po
-0001e7f0: 696e 7420 7b70 6f69 6e74 7d20 646f 6573  int {point} does
-0001e800: 206e 6f74 2062 656c 6f6e 6720 746f 2065   not belong to e
-0001e810: 6c6c 6970 7365 2729 0a0a 2020 2020 4070  llipse')..    @p
-0001e820: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0001e830: 626f 756e 6469 6e67 5f72 6563 7461 6e67  bounding_rectang
-0001e840: 6c65 2873 656c 6629 3a0a 2020 2020 2020  le(self):.      
-0001e850: 2020 2222 220a 2020 2020 2020 2020 4361    """.        Ca
-0001e860: 6c63 756c 6174 6573 2074 6865 2062 6f75  lculates the bou
-0001e870: 6e64 696e 6720 7265 6374 616e 676c 6520  nding rectangle 
-0001e880: 666f 7220 7468 6520 6172 6365 6c6c 6970  for the arcellip
-0001e890: 7365 3264 2e0a 0a20 2020 2020 2020 203a  se2d...        :
-0001e8a0: 7265 7475 726e 3a20 766f 6c6d 646c 722e  return: volmdlr.
-0001e8b0: 636f 7265 2e42 6f75 6469 6e67 5265 6374  core.BoudingRect
-0001e8c0: 616e 676c 6520 6f62 6a65 6374 2e0a 2020  angle object..  
-0001e8d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001e8e0: 2020 6966 206e 6f74 2073 656c 662e 5f62    if not self._b
-0001e8f0: 6f75 6e64 696e 675f 7265 6374 616e 676c  ounding_rectangl
-0001e900: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-0001e910: 6973 6372 6574 697a 6174 696f 6e5f 706f  iscretization_po
-0001e920: 696e 7473 203d 2073 656c 662e 6469 7363  ints = self.disc
-0001e930: 7265 7469 7a61 7469 6f6e 5f70 6f69 6e74  retization_point
-0001e940: 7328 6e75 6d62 6572 5f70 6f69 6e74 733d  s(number_points=
-0001e950: 3230 290a 2020 2020 2020 2020 2020 2020  20).            
-0001e960: 785f 7661 6c75 6573 2c20 795f 7661 6c75  x_values, y_valu
-0001e970: 6573 203d 205b 5d2c 205b 5d0a 2020 2020  es = [], [].    
-0001e980: 2020 2020 2020 2020 666f 7220 706f 696e          for poin
-0001e990: 7420 696e 2064 6973 6372 6574 697a 6174  t in discretizat
-0001e9a0: 696f 6e5f 706f 696e 7473 3a0a 2020 2020  ion_points:.    
-0001e9b0: 2020 2020 2020 2020 2020 2020 785f 7661              x_va
-0001e9c0: 6c75 6573 2e61 7070 656e 6428 706f 696e  lues.append(poin
-0001e9d0: 742e 7829 0a20 2020 2020 2020 2020 2020  t.x).           
-0001e9e0: 2020 2020 2079 5f76 616c 7565 732e 6170       y_values.ap
-0001e9f0: 7065 6e64 2870 6f69 6e74 2e79 290a 2020  pend(point.y).  
-0001ea00: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0001ea10: 626f 756e 6469 6e67 5f72 6563 7461 6e67  bounding_rectang
-0001ea20: 6c65 203d 2076 6f6c 6d64 6c72 2e63 6f72  le = volmdlr.cor
-0001ea30: 652e 426f 756e 6469 6e67 5265 6374 616e  e.BoundingRectan
-0001ea40: 676c 6528 6d69 6e28 785f 7661 6c75 6573  gle(min(x_values
-0001ea50: 292c 206d 6178 2878 5f76 616c 7565 7329  ), max(x_values)
-0001ea60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ea80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ea90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eaa0: 2020 2020 2020 2020 6d69 6e28 795f 7661          min(y_va
-0001eab0: 6c75 6573 292c 206d 6178 2879 5f76 616c  lues), max(y_val
-0001eac0: 7565 7329 290a 2020 2020 2020 2020 7265  ues)).        re
-0001ead0: 7475 726e 2073 656c 662e 5f62 6f75 6e64  turn self._bound
-0001eae0: 696e 675f 7265 6374 616e 676c 650a 0a20  ing_rectangle.. 
-0001eaf0: 2020 2064 6566 2073 7472 6169 6768 745f     def straight_
-0001eb00: 6c69 6e65 5f61 7265 6128 7365 6c66 293a  line_area(self):
-0001eb10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001eb20: 2020 2020 2043 616c 6375 6c61 7465 7320       Calculates 
-0001eb30: 7468 6520 6172 6561 206f 6620 7468 6520  the area of the 
-0001eb40: 656c 6c69 7074 6963 2061 7263 2c20 7769  elliptic arc, wi
-0001eb50: 7468 206c 696e 6520 6472 6177 6e20 6672  th line drawn fr
-0001eb60: 6f6d 2073 7461 7274 2074 6f20 656e 642e  om start to end.
-0001eb70: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0001eb80: 6e3a 2073 7472 6169 6768 745f 6c69 6e65  n: straight_line
-0001eb90: 5f61 7265 612e 0a20 2020 2020 2020 2022  _area..        "
-0001eba0: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
-0001ebb0: 6c66 2e61 6e67 6c65 203e 3d20 6d61 7468  lf.angle >= math
-0001ebc0: 2e70 693a 0a20 2020 2020 2020 2020 2020  .pi:.           
-0001ebd0: 2061 6e67 6c65 203d 2076 6f6c 6d64 6c72   angle = volmdlr
-0001ebe0: 2e54 574f 5f50 4920 2d20 7365 6c66 2e61  .TWO_PI - self.a
-0001ebf0: 6e67 6c65 0a20 2020 2020 2020 2020 2020  ngle.           
-0001ec00: 2061 7265 6120 3d20 6d61 7468 2e70 6920   area = math.pi 
-0001ec10: 2a20 7365 6c66 2e6d 616a 6f72 5f61 7869  * self.major_axi
-0001ec20: 7320 2a20 7365 6c66 2e6d 696e 6f72 5f61  s * self.minor_a
-0001ec30: 7869 7320 2d20 302e 3520 2a20 7365 6c66  xis - 0.5 * self
-0001ec40: 2e6d 616a 6f72 5f61 7869 7320 2a20 7365  .major_axis * se
-0001ec50: 6c66 2e6d 696e 6f72 5f61 7869 7320 2a20  lf.minor_axis * 
-0001ec60: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001ec70: 2020 616e 676c 6520 2d20 6d61 7468 2e73    angle - math.s
-0001ec80: 696e 2861 6e67 6c65 2929 0a20 2020 2020  in(angle)).     
-0001ec90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001eca0: 2020 2020 2061 6e67 6c65 203d 2073 656c       angle = sel
-0001ecb0: 662e 616e 676c 650a 2020 2020 2020 2020  f.angle.        
-0001ecc0: 2020 2020 6172 6561 203d 2030 2e35 202a      area = 0.5 *
-0001ecd0: 2073 656c 662e 6d61 6a6f 725f 6178 6973   self.major_axis
-0001ece0: 202a 2073 656c 662e 6d69 6e6f 725f 6178   * self.minor_ax
-0001ecf0: 6973 202a 2028 616e 676c 6520 2d20 6d61  is * (angle - ma
-0001ed00: 7468 2e73 696e 2861 6e67 6c65 2929 0a0a  th.sin(angle))..
-0001ed10: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001ed20: 6973 5f74 7269 676f 3a0a 2020 2020 2020  is_trigo:.      
-0001ed30: 2020 2020 2020 7265 7475 726e 2061 7265        return are
-0001ed40: 610a 2020 2020 2020 2020 7265 7475 726e  a.        return
-0001ed50: 202d 6172 6561 0a0a 2020 2020 6465 6620   -area..    def 
-0001ed60: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
-0001ed70: 6f69 6e74 7328 7365 6c66 2c20 2a2c 206e  oints(self, *, n
-0001ed80: 756d 6265 725f 706f 696e 7473 3a20 696e  umber_points: in
-0001ed90: 7420 3d20 4e6f 6e65 2c20 616e 676c 655f  t = None, angle_
-0001eda0: 7265 736f 6c75 7469 6f6e 3a20 696e 7420  resolution: int 
-0001edb0: 3d20 4e6f 6e65 293a 0a20 2020 2020 2020  = None):.       
-0001edc0: 2022 2222 0a20 2020 2020 2020 2044 6973   """.        Dis
-0001edd0: 6372 6574 697a 6520 616e 2045 6467 6520  cretize an Edge 
-0001ede0: 746f 2068 6176 6520 226e 2220 706f 696e  to have "n" poin
-0001edf0: 7473 2e0a 0a20 2020 2020 2020 203a 7061  ts...        :pa
-0001ee00: 7261 6d20 6e75 6d62 6572 5f70 6f69 6e74  ram number_point
-0001ee10: 733a 2074 6865 206e 756d 6265 7220 6f66  s: the number of
-0001ee20: 2070 6f69 6e74 7320 2869 6e63 6c75 6469   points (includi
-0001ee30: 6e67 2073 7461 7274 2061 6e64 2065 6e64  ng start and end
-0001ee40: 2070 6f69 6e74 7329 0a20 2020 2020 2020   points).       
-0001ee50: 2020 2020 2020 6966 2075 6e73 6574 2c20        if unset, 
-0001ee60: 6f6e 6c79 2073 7461 7274 2061 6e64 2065  only start and e
-0001ee70: 6e64 2077 696c 6c20 6265 2072 6574 7572  nd will be retur
-0001ee80: 6e65 642e 0a20 2020 2020 2020 203a 7061  ned..        :pa
-0001ee90: 7261 6d20 616e 676c 655f 7265 736f 6c75  ram angle_resolu
-0001eea0: 7469 6f6e 3a20 6966 2073 6574 2c20 7468  tion: if set, th
-0001eeb0: 6520 7361 6d70 6c69 6e67 2077 696c 6c20  e sampling will 
-0001eec0: 6265 2061 6461 7074 6564 2074 6f20 6861  be adapted to ha
-0001eed0: 7665 2061 2063 6f6e 7472 6f6c 6c65 6420  ve a controlled 
-0001eee0: 616e 6775 6c61 7220 6469 7374 616e 6365  angular distance
-0001eef0: 2e20 5573 6566 756c 0a20 2020 2020 2020  . Useful.       
-0001ef00: 2020 2020 2074 6f20 6d65 7368 2061 6e20       to mesh an 
-0001ef10: 6172 632e 0a20 2020 2020 2020 203a 7265  arc..        :re
-0001ef20: 7475 726e 3a20 6120 6c69 7374 206f 6620  turn: a list of 
-0001ef30: 7361 6d70 6c65 6420 706f 696e 7473 2e0a  sampled points..
-0001ef40: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001ef50: 2020 2020 6966 206e 6f74 206e 756d 6265      if not numbe
-0001ef60: 725f 706f 696e 7473 3a0a 2020 2020 2020  r_points:.      
-0001ef70: 2020 2020 2020 6966 206e 6f74 2061 6e67        if not ang
-0001ef80: 6c65 5f72 6573 6f6c 7574 696f 6e3a 0a20  le_resolution:. 
-0001ef90: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001efa0: 756d 6265 725f 706f 696e 7473 203d 2032  umber_points = 2
-0001efb0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0001efc0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0001efd0: 2020 206e 756d 6265 725f 706f 696e 7473     number_points
-0001efe0: 203d 206d 6174 682e 6365 696c 2861 6e67   = math.ceil(ang
-0001eff0: 6c65 5f72 6573 6f6c 7574 696f 6e20 2a20  le_resolution * 
-0001f000: 6162 7328 302e 3520 2a20 7365 6c66 2e61  abs(0.5 * self.a
-0001f010: 6e67 6c65 202f 206d 6174 682e 7069 2929  ngle / math.pi))
-0001f020: 0a20 2020 2020 2020 2069 735f 7472 6967  .        is_trig
-0001f030: 6f20 3d20 5472 7565 0a20 2020 2020 2020  o = True.       
-0001f040: 2069 6620 7365 6c66 2e61 6e67 6c65 5f73   if self.angle_s
-0001f050: 7461 7274 203e 2073 656c 662e 616e 676c  tart > self.angl
-0001f060: 655f 656e 643a 0a20 2020 2020 2020 2020  e_end:.         
-0001f070: 2020 2069 6620 7365 6c66 2e61 6e67 6c65     if self.angle
-0001f080: 5f73 7461 7274 203e 3d20 7365 6c66 2e61  _start >= self.a
-0001f090: 6e67 6c65 5f69 6e74 6572 696f 7220 3e3d  ngle_interior >=
-0001f0a0: 2073 656c 662e 616e 676c 655f 656e 643a   self.angle_end:
-0001f0b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f0c0: 2061 6e67 6c65 5f73 7461 7274 203d 2073   angle_start = s
-0001f0d0: 656c 662e 616e 676c 655f 656e 640a 2020  elf.angle_end.  
-0001f0e0: 2020 2020 2020 2020 2020 2020 2020 616e                an
-0001f0f0: 676c 655f 656e 6420 3d20 7365 6c66 2e61  gle_end = self.a
-0001f100: 6e67 6c65 5f73 7461 7274 0a20 2020 2020  ngle_start.     
-0001f110: 2020 2020 2020 2020 2020 2069 735f 7472             is_tr
-0001f120: 6967 6f20 3d20 4661 6c73 650a 2020 2020  igo = False.    
-0001f130: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001f140: 2020 2020 2020 2020 2020 2020 2020 616e                an
-0001f150: 676c 655f 656e 6420 3d20 7365 6c66 2e61  gle_end = self.a
-0001f160: 6e67 6c65 5f65 6e64 202b 2076 6f6c 6d64  ngle_end + volmd
-0001f170: 6c72 2e54 574f 5f50 490a 2020 2020 2020  lr.TWO_PI.      
-0001f180: 2020 2020 2020 2020 2020 616e 676c 655f            angle_
-0001f190: 7374 6172 7420 3d20 7365 6c66 2e61 6e67  start = self.ang
-0001f1a0: 6c65 5f73 7461 7274 0a20 2020 2020 2020  le_start.       
-0001f1b0: 2065 6c69 6620 7365 6c66 2e61 6e67 6c65   elif self.angle
-0001f1c0: 5f73 7461 7274 203d 3d20 7365 6c66 2e61  _start == self.a
-0001f1d0: 6e67 6c65 5f65 6e64 3a0a 2020 2020 2020  ngle_end:.      
-0001f1e0: 2020 2020 2020 616e 676c 655f 7374 6172        angle_star
-0001f1f0: 7420 3d20 300a 2020 2020 2020 2020 2020  t = 0.          
-0001f200: 2020 616e 676c 655f 656e 6420 3d20 3220    angle_end = 2 
-0001f210: 2a20 6d61 7468 2e70 690a 2020 2020 2020  * math.pi.      
-0001f220: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001f230: 2020 2020 616e 676c 655f 656e 6420 3d20      angle_end = 
-0001f240: 7365 6c66 2e61 6e67 6c65 5f65 6e64 0a20  self.angle_end. 
-0001f250: 2020 2020 2020 2020 2020 2061 6e67 6c65             angle
-0001f260: 5f73 7461 7274 203d 2073 656c 662e 616e  _start = self.an
-0001f270: 676c 655f 7374 6172 740a 0a20 2020 2020  gle_start..     
-0001f280: 2020 2064 6973 6372 6574 697a 6174 696f     discretizatio
-0001f290: 6e5f 706f 696e 7473 203d 205b 7365 6c66  n_points = [self
-0001f2a0: 2e66 7261 6d65 2e6c 6f63 616c 5f74 6f5f  .frame.local_to_
-0001f2b0: 676c 6f62 616c 5f63 6f6f 7264 696e 6174  global_coordinat
-0001f2c0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-0001f2d0: 766f 6c6d 646c 722e 506f 696e 7432 4428  volmdlr.Point2D(
-0001f2e0: 7365 6c66 2e6d 616a 6f72 5f61 7869 7320  self.major_axis 
-0001f2f0: 2a20 6d61 7468 2e63 6f73 2861 6e67 6c65  * math.cos(angle
-0001f300: 292c 2073 656c 662e 6d69 6e6f 725f 6178  ), self.minor_ax
-0001f310: 6973 202a 206d 6174 682e 7369 6e28 616e  is * math.sin(an
-0001f320: 676c 6529 2929 0a20 2020 2020 2020 2020  gle))).         
-0001f330: 2020 2066 6f72 2061 6e67 6c65 2069 6e20     for angle in 
-0001f340: 6e70 792e 6c69 6e73 7061 6365 2861 6e67  npy.linspace(ang
-0001f350: 6c65 5f73 7461 7274 2c20 616e 676c 655f  le_start, angle_
-0001f360: 656e 642c 206e 756d 6265 725f 706f 696e  end, number_poin
-0001f370: 7473 295d 0a20 2020 2020 2020 2069 6620  ts)].        if 
-0001f380: 6e6f 7420 6973 5f74 7269 676f 3a0a 2020  not is_trigo:.  
-0001f390: 2020 2020 2020 2020 2020 6469 7363 7265            discre
-0001f3a0: 7469 7a61 7469 6f6e 5f70 6f69 6e74 7320  tization_points 
-0001f3b0: 3d20 6469 7363 7265 7469 7a61 7469 6f6e  = discretization
-0001f3c0: 5f70 6f69 6e74 735b 3a3a 2d31 5d0a 2020  _points[::-1].  
-0001f3d0: 2020 2020 2020 7265 7475 726e 2064 6973        return dis
-0001f3e0: 6372 6574 697a 6174 696f 6e5f 706f 696e  cretization_poin
-0001f3f0: 7473 0a0a 2020 2020 6465 6620 706f 6c79  ts..    def poly
-0001f400: 676f 6e5f 706f 696e 7473 2873 656c 662c  gon_points(self,
-0001f410: 2064 6973 6372 6574 697a 6174 696f 6e5f   discretization_
-0001f420: 7265 736f 6c75 7469 6f6e 3a20 696e 7429  resolution: int)
-0001f430: 3a0a 2020 2020 2020 2020 7761 726e 696e  :.        warnin
-0001f440: 6773 2e77 6172 6e28 2770 6f6c 7967 6f6e  gs.warn('polygon
-0001f450: 5f70 6f69 6e74 7320 6973 2064 6570 7265  _points is depre
-0001f460: 6361 7465 642c 5c0a 2020 2020 2020 2020  cated,\.        
-0001f470: 2020 2020 2020 2020 706c 6561 7365 2075          please u
-0001f480: 7365 2064 6973 6372 6574 697a 6174 696f  se discretizatio
-0001f490: 6e5f 706f 696e 7473 2069 6e73 7465 6164  n_points instead
-0001f4a0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0001f4b0: 2020 2020 2020 2020 2044 6570 7265 6361           Depreca
-0001f4c0: 7469 6f6e 5761 726e 696e 6729 0a20 2020  tionWarning).   
-0001f4d0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001f4e0: 2e64 6973 6372 6574 697a 6174 696f 6e5f  .discretization_
-0001f4f0: 706f 696e 7473 2861 6e67 6c65 5f72 6573  points(angle_res
-0001f500: 6f6c 7574 696f 6e3d 6469 7363 7265 7469  olution=discreti
-0001f510: 7a61 7469 6f6e 5f72 6573 6f6c 7574 696f  zation_resolutio
-0001f520: 6e29 0a0a 2020 2020 6465 6620 746f 5f33  n)..    def to_3
-0001f530: 6428 7365 6c66 2c20 706c 616e 655f 6f72  d(self, plane_or
-0001f540: 6967 696e 2c20 782c 2079 293a 0a20 2020  igin, x, y):.   
-0001f550: 2020 2020 2070 6f69 6e74 5f73 7461 7274       point_start
-0001f560: 3364 203d 2073 656c 662e 7374 6172 742e  3d = self.start.
-0001f570: 746f 5f33 6428 706c 616e 655f 6f72 6967  to_3d(plane_orig
-0001f580: 696e 2c20 782c 2079 290a 2020 2020 2020  in, x, y).      
-0001f590: 2020 706f 696e 745f 696e 7465 7269 6f72    point_interior
-0001f5a0: 3364 203d 2073 656c 662e 696e 7465 7269  3d = self.interi
-0001f5b0: 6f72 2e74 6f5f 3364 2870 6c61 6e65 5f6f  or.to_3d(plane_o
-0001f5c0: 7269 6769 6e2c 2078 2c20 7929 0a20 2020  rigin, x, y).   
-0001f5d0: 2020 2020 2070 6f69 6e74 5f65 6e64 3364       point_end3d
-0001f5e0: 203d 2073 656c 662e 656e 642e 746f 5f33   = self.end.to_3
-0001f5f0: 6428 706c 616e 655f 6f72 6967 696e 2c20  d(plane_origin, 
-0001f600: 782c 2079 290a 2020 2020 2020 2020 706f  x, y).        po
-0001f610: 696e 745f 6365 6e74 6572 3364 203d 2073  int_center3d = s
-0001f620: 656c 662e 6365 6e74 6572 2e74 6f5f 3364  elf.center.to_3d
-0001f630: 2870 6c61 6e65 5f6f 7269 6769 6e2c 2078  (plane_origin, x
-0001f640: 2c20 7929 0a0a 2020 2020 2020 2020 615f  , y)..        a_
-0001f650: 6d61 7832 6420 3d20 7365 6c66 2e63 656e  max2d = self.cen
-0001f660: 7465 7220 2b20 7365 6c66 2e6d 616a 6f72  ter + self.major
-0001f670: 5f64 6972 202a 2073 656c 662e 6d61 6a6f  _dir * self.majo
-0001f680: 725f 6178 6973 0a20 2020 2020 2020 2061  r_axis.        a
-0001f690: 5f6d 6178 3364 203d 2061 5f6d 6178 3264  _max3d = a_max2d
-0001f6a0: 2e74 6f5f 3364 2870 6c61 6e65 5f6f 7269  .to_3d(plane_ori
-0001f6b0: 6769 6e2c 2078 2c20 7929 0a20 2020 2020  gin, x, y).     
-0001f6c0: 2020 206e 6577 5f6d 616a 6f72 5f64 6972     new_major_dir
-0001f6d0: 203d 2061 5f6d 6178 3364 202d 2070 6f69   = a_max3d - poi
-0001f6e0: 6e74 5f63 656e 7465 7233 640a 2020 2020  nt_center3d.    
-0001f6f0: 2020 2020 6e65 775f 6d61 6a6f 725f 6469      new_major_di
-0001f700: 722e 6e6f 726d 616c 697a 6528 290a 2020  r.normalize().  
-0001f710: 2020 2020 2020 7265 7475 726e 2041 7263        return Arc
-0001f720: 456c 6c69 7073 6533 4428 706f 696e 745f  Ellipse3D(point_
-0001f730: 7374 6172 7433 642c 2070 6f69 6e74 5f69  start3d, point_i
-0001f740: 6e74 6572 696f 7233 642c 2070 6f69 6e74  nterior3d, point
-0001f750: 5f65 6e64 3364 2c0a 2020 2020 2020 2020  _end3d,.        
-0001f760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f770: 2020 2020 706f 696e 745f 6365 6e74 6572      point_center
-0001f780: 3364 2c20 6e65 775f 6d61 6a6f 725f 6469  3d, new_major_di
-0001f790: 722c 206e 616d 653d 7365 6c66 2e6e 616d  r, name=self.nam
-0001f7a0: 6529 0a0a 2020 2020 6465 6620 706c 6f74  e)..    def plot
-0001f7b0: 2873 656c 662c 2061 783d 4e6f 6e65 2c20  (self, ax=None, 
-0001f7c0: 636f 6c6f 723d 276b 272c 2061 6c70 6861  color='k', alpha
-0001f7d0: 3d31 293a 0a20 2020 2020 2020 2069 6620  =1):.        if 
-0001f7e0: 6178 2069 7320 4e6f 6e65 3a0a 2020 2020  ax is None:.    
-0001f7f0: 2020 2020 2020 2020 5f2c 2061 7820 3d20          _, ax = 
-0001f800: 706c 742e 7375 6270 6c6f 7473 2829 0a0a  plt.subplots()..
-0001f810: 2020 2020 2020 2020 7365 6c66 2e69 6e74          self.int
-0001f820: 6572 696f 722e 706c 6f74 2861 783d 6178  erior.plot(ax=ax
-0001f830: 2c20 636f 6c6f 723d 276d 2729 0a20 2020  , color='m').   
-0001f840: 2020 2020 2073 656c 662e 7374 6172 742e       self.start.
-0001f850: 706c 6f74 2861 783d 6178 2c20 636f 6c6f  plot(ax=ax, colo
-0001f860: 723d 2772 2729 0a20 2020 2020 2020 2073  r='r').        s
-0001f870: 656c 662e 656e 642e 706c 6f74 2861 783d  elf.end.plot(ax=
-0001f880: 6178 2c20 636f 6c6f 723d 2762 2729 0a20  ax, color='b'). 
-0001f890: 2020 2020 2020 2073 656c 662e 6365 6e74         self.cent
-0001f8a0: 6572 2e70 6c6f 7428 6178 3d61 782c 2063  er.plot(ax=ax, c
-0001f8b0: 6f6c 6f72 3d27 7927 290a 0a20 2020 2020  olor='y')..     
-0001f8c0: 2020 2078 203d 205b 5d0a 2020 2020 2020     x = [].      
-0001f8d0: 2020 7920 3d20 5b5d 0a20 2020 2020 2020    y = [].       
-0001f8e0: 2066 6f72 2070 782c 2070 7920 696e 2073   for px, py in s
-0001f8f0: 656c 662e 6469 7363 7265 7469 7a61 7469  elf.discretizati
-0001f900: 6f6e 5f70 6f69 6e74 7328 6e75 6d62 6572  on_points(number
-0001f910: 5f70 6f69 6e74 733d 3130 3029 3a0a 2020  _points=100):.  
-0001f920: 2020 2020 2020 2020 2020 782e 6170 7065            x.appe
-0001f930: 6e64 2870 7829 0a20 2020 2020 2020 2020  nd(px).         
-0001f940: 2020 2079 2e61 7070 656e 6428 7079 290a     y.append(py).
-0001f950: 0a20 2020 2020 2020 2070 6c74 2e70 6c6f  .        plt.plo
-0001f960: 7428 782c 2079 2c20 636f 6c6f 723d 636f  t(x, y, color=co
-0001f970: 6c6f 722c 2061 6c70 6861 3d61 6c70 6861  lor, alpha=alpha
-0001f980: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0001f990: 2061 780a 0a20 2020 2064 6566 206e 6f72   ax..    def nor
-0001f9a0: 6d61 6c5f 7665 6374 6f72 2873 656c 662c  mal_vector(self,
-0001f9b0: 2061 6273 6369 7373 6129 3a0a 2020 2020   abscissa):.    
-0001f9c0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-0001f9d0: 6c65 6d65 6e74 6564 4572 726f 720a 0a20  lementedError.. 
-0001f9e0: 2020 2064 6566 2075 6e69 745f 6e6f 726d     def unit_norm
-0001f9f0: 616c 5f76 6563 746f 7228 7365 6c66 2c20  al_vector(self, 
-0001fa00: 6162 7363 6973 7361 293a 0a20 2020 2020  abscissa):.     
-0001fa10: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-0001fa20: 656d 656e 7465 6445 7272 6f72 0a0a 2020  ementedError..  
-0001fa30: 2020 6465 6620 6469 7265 6374 696f 6e5f    def direction_
-0001fa40: 7665 6374 6f72 2873 656c 662c 2061 6273  vector(self, abs
-0001fa50: 6369 7373 6129 3a0a 2020 2020 2020 2020  cissa):.        
-0001fa60: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-0001fa70: 6e74 6564 4572 726f 720a 0a20 2020 2064  ntedError..    d
-0001fa80: 6566 2075 6e69 745f 6469 7265 6374 696f  ef unit_directio
-0001fa90: 6e5f 7665 6374 6f72 2873 656c 662c 2061  n_vector(self, a
-0001faa0: 6273 6369 7373 6129 3a0a 2020 2020 2020  bscissa):.      
-0001fab0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-0001fac0: 6d65 6e74 6564 4572 726f 720a 0a20 2020  mentedError..   
-0001fad0: 2064 6566 2072 6576 6572 7365 2873 656c   def reverse(sel
-0001fae0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-0001faf0: 726e 2073 656c 662e 5f5f 636c 6173 735f  rn self.__class_
-0001fb00: 5f28 7365 6c66 2e65 6e64 2e63 6f70 7928  _(self.end.copy(
-0001fb10: 292c 2073 656c 662e 696e 7465 7269 6f72  ), self.interior
-0001fb20: 2e63 6f70 7928 292c 2073 656c 662e 7374  .copy(), self.st
-0001fb30: 6172 742e 636f 7079 2829 2c0a 2020 2020  art.copy(),.    
-0001fb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fb50: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-0001fb60: 656e 7465 722e 636f 7079 2829 2c20 7365  enter.copy(), se
-0001fb70: 6c66 2e6d 616a 6f72 5f64 6972 2e63 6f70  lf.major_dir.cop
-0001fb80: 7928 292c 2073 656c 662e 6e61 6d65 290a  y(), self.name).
-0001fb90: 0a20 2020 2064 6566 206c 696e 655f 696e  .    def line_in
-0001fba0: 7465 7273 6563 7469 6f6e 7328 7365 6c66  tersections(self
-0001fbb0: 2c20 6c69 6e65 3264 3a20 4c69 6e65 3244  , line2d: Line2D
-0001fbc0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0001fbd0: 2020 2020 2020 2049 6e74 6572 7365 6374         Intersect
-0001fbe0: 696f 6e73 2062 6574 7765 656e 2061 6e20  ions between an 
-0001fbf0: 4172 6345 6c6c 6970 7365 3244 2061 6e64  ArcEllipse2D and
-0001fc00: 2061 204c 696e 6532 442e 0a0a 2020 2020   a Line2D...    
-0001fc10: 2020 2020 3a70 6172 616d 206c 696e 6532      :param line2
-0001fc20: 643a 204c 696e 6532 4420 746f 2076 6572  d: Line2D to ver
-0001fc30: 6966 7920 696e 7465 7273 6563 7469 6f6e  ify intersection
-0001fc40: 730a 2020 2020 2020 2020 3a72 6574 7572  s.        :retur
-0001fc50: 6e3a 204c 6973 7420 7769 7468 2061 6c6c  n: List with all
-0001fc60: 2069 6e74 6572 7365 6374 696f 6e73 0a20   intersections. 
-0001fc70: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001fc80: 2020 2065 6c6c 6970 7365 3264 5f6c 696e     ellipse2d_lin
-0001fc90: 6573 6567 6d65 6e74 5f69 6e74 6572 7365  esegment_interse
-0001fca0: 6374 696f 6e73 203d 2076 6d5f 7574 696c  ctions = vm_util
-0001fcb0: 735f 696e 7465 7273 6563 7469 6f6e 732e  s_intersections.
-0001fcc0: 656c 6c69 7073 6532 645f 6c69 6e65 5f69  ellipse2d_line_i
-0001fcd0: 6e74 6572 7365 6374 696f 6e73 2873 656c  ntersections(sel
-0001fce0: 662c 206c 696e 6532 6429 0a20 2020 2020  f, line2d).     
-0001fcf0: 2020 206c 696e 6573 6567 6d65 6e74 5f69     linesegment_i
-0001fd00: 6e74 6572 7365 6374 696f 6e73 203d 205b  ntersections = [
-0001fd10: 5d0a 2020 2020 2020 2020 666f 7220 696e  ].        for in
-0001fd20: 7465 7220 696e 2065 6c6c 6970 7365 3264  ter in ellipse2d
-0001fd30: 5f6c 696e 6573 6567 6d65 6e74 5f69 6e74  _linesegment_int
-0001fd40: 6572 7365 6374 696f 6e73 3a0a 2020 2020  ersections:.    
-0001fd50: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001fd60: 706f 696e 745f 6265 6c6f 6e67 7328 696e  point_belongs(in
-0001fd70: 7465 7229 3a0a 2020 2020 2020 2020 2020  ter):.          
-0001fd80: 2020 2020 2020 6c69 6e65 7365 676d 656e        linesegmen
-0001fd90: 745f 696e 7465 7273 6563 7469 6f6e 732e  t_intersections.
-0001fda0: 6170 7065 6e64 2869 6e74 6572 290a 2020  append(inter).  
-0001fdb0: 2020 2020 2020 7265 7475 726e 206c 696e        return lin
-0001fdc0: 6573 6567 6d65 6e74 5f69 6e74 6572 7365  esegment_interse
-0001fdd0: 6374 696f 6e73 0a0a 2020 2020 6465 6620  ctions..    def 
-0001fde0: 6c69 6e65 7365 676d 656e 745f 696e 7465  linesegment_inte
-0001fdf0: 7273 6563 7469 6f6e 7328 7365 6c66 2c20  rsections(self, 
-0001fe00: 6c69 6e65 7365 676d 656e 7432 643a 204c  linesegment2d: L
-0001fe10: 696e 6553 6567 6d65 6e74 3244 293a 0a20  ineSegment2D):. 
-0001fe20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001fe30: 2020 2049 6e74 6572 7365 6374 696f 6e73     Intersections
-0001fe40: 2062 6574 7765 656e 2061 6e20 4172 6345   between an ArcE
-0001fe50: 6c6c 6970 7365 3244 2061 6e64 2061 204c  llipse2D and a L
-0001fe60: 696e 6553 6567 6d65 6e74 3244 2e0a 0a20  ineSegment2D... 
-0001fe70: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
-0001fe80: 6e65 7365 676d 656e 7432 643a 204c 696e  nesegment2d: Lin
-0001fe90: 6553 6567 6d65 6e74 3244 2074 6f20 7665  eSegment2D to ve
-0001fea0: 7269 6679 2069 6e74 6572 7365 6374 696f  rify intersectio
-0001feb0: 6e73 0a20 2020 2020 2020 203a 7265 7475  ns.        :retu
-0001fec0: 726e 3a20 4c69 7374 2077 6974 6820 616c  rn: List with al
-0001fed0: 6c20 696e 7465 7273 6563 7469 6f6e 730a  l intersections.
-0001fee0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001fef0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-0001ff00: 626f 756e 6469 6e67 5f72 6563 7461 6e67  bounding_rectang
-0001ff10: 6c65 2e62 5f72 6563 7461 6e67 6c65 5f69  le.b_rectangle_i
-0001ff20: 6e74 6572 7365 6374 696f 6e28 6c69 6e65  ntersection(line
-0001ff30: 7365 676d 656e 7432 642e 626f 756e 6469  segment2d.boundi
-0001ff40: 6e67 5f72 6563 7461 6e67 6c65 293a 0a20  ng_rectangle):. 
-0001ff50: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001ff60: 6e20 5b5d 0a20 2020 2020 2020 2069 6e74  n [].        int
-0001ff70: 6572 7365 6374 696f 6e73 203d 2073 656c  ersections = sel
-0001ff80: 662e 6c69 6e65 5f69 6e74 6572 7365 6374  f.line_intersect
-0001ff90: 696f 6e73 286c 696e 6573 6567 6d65 6e74  ions(linesegment
-0001ffa0: 3264 290a 2020 2020 2020 2020 6c69 6e65  2d).        line
-0001ffb0: 7365 676d 656e 745f 696e 7465 7273 6563  segment_intersec
-0001ffc0: 7469 6f6e 7320 3d20 5b5d 0a20 2020 2020  tions = [].     
-0001ffd0: 2020 2066 6f72 2069 6e74 6572 2069 6e20     for inter in 
-0001ffe0: 696e 7465 7273 6563 7469 6f6e 733a 0a20  intersections:. 
-0001fff0: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
-00020000: 6e65 7365 676d 656e 7432 642e 706f 696e  nesegment2d.poin
-00020010: 745f 6265 6c6f 6e67 7328 696e 7465 7229  t_belongs(inter)
-00020020: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020030: 2020 6c69 6e65 7365 676d 656e 745f 696e    linesegment_in
-00020040: 7465 7273 6563 7469 6f6e 732e 6170 7065  tersections.appe
-00020050: 6e64 2869 6e74 6572 290a 2020 2020 2020  nd(inter).      
-00020060: 2020 7265 7475 726e 206c 696e 6573 6567    return lineseg
-00020070: 6d65 6e74 5f69 6e74 6572 7365 6374 696f  ment_intersectio
-00020080: 6e73 0a0a 2020 2020 6465 6620 6672 616d  ns..    def fram
-00020090: 655f 6d61 7070 696e 6728 7365 6c66 2c20  e_mapping(self, 
-000200a0: 6672 616d 653a 2076 6f6c 6d64 6c72 2e46  frame: volmdlr.F
-000200b0: 7261 6d65 3244 2c20 7369 6465 3a20 7374  rame2D, side: st
-000200c0: 7229 3a0a 2020 2020 2020 2020 2222 220a  r):.        """.
-000200d0: 2020 2020 2020 2020 4368 616e 6765 7320          Changes 
-000200e0: 6672 616d 655f 6d61 7070 696e 6720 616e  frame_mapping an
-000200f0: 6420 7265 7475 726e 2061 206e 6577 2041  d return a new A
-00020100: 7263 456c 6c69 7073 6532 442e 0a0a 2020  rcEllipse2D...  
-00020110: 2020 2020 2020 7369 6465 203d 2027 6f6c        side = 'ol
-00020120: 6427 206f 7220 276e 6577 270a 2020 2020  d' or 'new'.    
-00020130: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00020140: 6966 2073 6964 6520 3d3d 2027 6f6c 6427  if side == 'old'
-00020150: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00020160: 7475 726e 2041 7263 456c 6c69 7073 6532  turn ArcEllipse2
-00020170: 4428 6672 616d 652e 6c6f 6361 6c5f 746f  D(frame.local_to
-00020180: 5f67 6c6f 6261 6c5f 636f 6f72 6469 6e61  _global_coordina
-00020190: 7465 7328 7365 6c66 2e73 7461 7274 292c  tes(self.start),
-000201a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000201b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000201c0: 2066 7261 6d65 2e6c 6f63 616c 5f74 6f5f   frame.local_to_
-000201d0: 676c 6f62 616c 5f63 6f6f 7264 696e 6174  global_coordinat
-000201e0: 6573 2873 656c 662e 696e 7465 7269 6f72  es(self.interior
-000201f0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00020200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020210: 2020 2066 7261 6d65 2e6c 6f63 616c 5f74     frame.local_t
-00020220: 6f5f 676c 6f62 616c 5f63 6f6f 7264 696e  o_global_coordin
-00020230: 6174 6573 2873 656c 662e 656e 6429 2c0a  ates(self.end),.
-00020240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020260: 6672 616d 652e 6c6f 6361 6c5f 746f 5f67  frame.local_to_g
-00020270: 6c6f 6261 6c5f 636f 6f72 6469 6e61 7465  lobal_coordinate
-00020280: 7328 7365 6c66 2e63 656e 7465 7229 2c0a  s(self.center),.
-00020290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000202a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000202b0: 7365 6c66 2e6d 616a 6f72 5f64 6972 290a  self.major_dir).
-000202c0: 2020 2020 2020 2020 6966 2073 6964 6520          if side 
-000202d0: 3d3d 2027 6e65 7727 3a0a 2020 2020 2020  == 'new':.      
-000202e0: 2020 2020 2020 706f 696e 745f 6d61 6a6f        point_majo
-000202f0: 725f 6469 7220 3d20 7365 6c66 2e63 656e  r_dir = self.cen
-00020300: 7465 7220 2b20 7365 6c66 2e6d 616a 6f72  ter + self.major
-00020310: 5f64 6972 202a 2073 656c 662e 6d61 6a6f  _dir * self.majo
-00020320: 725f 6178 6973 0a20 2020 2020 2020 2020  r_axis.         
-00020330: 2020 206d 616a 6f72 5f64 6972 203d 2066     major_dir = f
-00020340: 7261 6d65 2e67 6c6f 6261 6c5f 746f 5f6c  rame.global_to_l
-00020350: 6f63 616c 5f63 6f6f 7264 696e 6174 6573  ocal_coordinates
-00020360: 2870 6f69 6e74 5f6d 616a 6f72 5f64 6972  (point_major_dir
-00020370: 290a 2020 2020 2020 2020 2020 2020 6d61  ).            ma
-00020380: 6a6f 725f 6469 722e 6e6f 726d 616c 697a  jor_dir.normaliz
-00020390: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-000203a0: 7265 7475 726e 2041 7263 456c 6c69 7073  return ArcEllips
-000203b0: 6532 4428 6672 616d 652e 676c 6f62 616c  e2D(frame.global
-000203c0: 5f74 6f5f 6c6f 6361 6c5f 636f 6f72 6469  _to_local_coordi
-000203d0: 6e61 7465 7328 7365 6c66 2e73 7461 7274  nates(self.start
-000203e0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000203f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020400: 2020 2066 7261 6d65 2e67 6c6f 6261 6c5f     frame.global_
-00020410: 746f 5f6c 6f63 616c 5f63 6f6f 7264 696e  to_local_coordin
-00020420: 6174 6573 2873 656c 662e 696e 7465 7269  ates(self.interi
-00020430: 6f72 292c 0a20 2020 2020 2020 2020 2020  or),.           
-00020440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020450: 2020 2020 2066 7261 6d65 2e67 6c6f 6261       frame.globa
-00020460: 6c5f 746f 5f6c 6f63 616c 5f63 6f6f 7264  l_to_local_coord
-00020470: 696e 6174 6573 2873 656c 662e 656e 6429  inates(self.end)
-00020480: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00020490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000204a0: 2020 6672 616d 652e 676c 6f62 616c 5f74    frame.global_t
-000204b0: 6f5f 6c6f 6361 6c5f 636f 6f72 6469 6e61  o_local_coordina
-000204c0: 7465 7328 7365 6c66 2e63 656e 7465 7229  tes(self.center)
-000204d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000204e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000204f0: 2020 6d61 6a6f 725f 6469 7229 0a20 2020    major_dir).   
-00020500: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00020510: 4572 726f 7228 2753 6964 6520 7368 6f75  Error('Side shou
-00020520: 6c64 2062 6520 5c27 6e65 775c 2720 5c27  ld be \'new\' \'
-00020530: 6f6c 645c 2727 290a 0a0a 636c 6173 7320  old\'')...class 
-00020540: 4c69 6e65 3344 284c 696e 6529 3a0a 2020  Line3D(Line):.  
-00020550: 2020 2222 220a 2020 2020 4465 6669 6e65    """.    Define
-00020560: 2061 6e20 696e 6669 6e69 7465 206c 696e   an infinite lin
-00020570: 6520 7061 7373 696e 6720 7468 726f 7567  e passing throug
-00020580: 6820 7468 6520 3220 706f 696e 7473 2e0a  h the 2 points..
-00020590: 0a20 2020 2022 2222 0a20 2020 205f 6e6f  .    """.    _no
-000205a0: 6e5f 6571 5f61 7474 7269 6275 7465 7320  n_eq_attributes 
-000205b0: 3d20 5b27 6e61 6d65 272c 2027 6261 7369  = ['name', 'basi
-000205c0: 735f 7072 696d 6974 6976 6573 272c 2027  s_primitives', '
-000205d0: 626f 756e 6469 6e67 5f62 6f78 275d 0a0a  bounding_box']..
-000205e0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-000205f0: 2873 656c 662c 2070 6f69 6e74 313a 2076  (self, point1: v
-00020600: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 2c20  olmdlr.Point3D, 
-00020610: 706f 696e 7432 3a20 766f 6c6d 646c 722e  point2: volmdlr.
-00020620: 506f 696e 7433 442c 0a20 2020 2020 2020  Point3D,.       
-00020630: 2020 2020 2020 2020 2020 6e61 6d65 3a20            name: 
-00020640: 7374 7220 3d20 2727 293a 0a20 2020 2020  str = ''):.     
-00020650: 2020 204c 696e 652e 5f5f 696e 6974 5f5f     Line.__init__
-00020660: 2873 656c 662c 2070 6f69 6e74 312c 2070  (self, point1, p
-00020670: 6f69 6e74 322c 206e 616d 653d 6e61 6d65  oint2, name=name
-00020680: 290a 2020 2020 2020 2020 2320 7365 6c66  ).        # self
-00020690: 2e70 6f69 6e74 7320 3d20 5b70 6f69 6e74  .points = [point
-000206a0: 312c 2070 6f69 6e74 325d 0a20 2020 2020  1, point2].     
-000206b0: 2020 2073 656c 662e 5f62 626f 7820 3d20     self._bbox = 
-000206c0: 4e6f 6e65 0a0a 2020 2020 4070 726f 7065  None..    @prope
-000206d0: 7274 790a 2020 2020 6465 6620 626f 756e  rty.    def boun
-000206e0: 6469 6e67 5f62 6f78 2873 656c 6629 3a0a  ding_box(self):.
-000206f0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00020700: 656c 662e 5f62 626f 783a 0a20 2020 2020  elf._bbox:.     
-00020710: 2020 2020 2020 2073 656c 662e 5f62 626f         self._bbo
-00020720: 7820 3d20 7365 6c66 2e5f 626f 756e 6469  x = self._boundi
-00020730: 6e67 5f62 6f78 2829 0a20 2020 2020 2020  ng_box().       
-00020740: 2072 6574 7572 6e20 7365 6c66 2e5f 6262   return self._bb
-00020750: 6f78 0a0a 2020 2020 4062 6f75 6e64 696e  ox..    @boundin
-00020760: 675f 626f 782e 7365 7474 6572 0a20 2020  g_box.setter.   
-00020770: 2064 6566 2062 6f75 6e64 696e 675f 626f   def bounding_bo
-00020780: 7828 7365 6c66 2c20 6e65 775f 626f 756e  x(self, new_boun
-00020790: 6469 6e67 5f62 6f78 293a 0a20 2020 2020  ding_box):.     
-000207a0: 2020 2073 656c 662e 5f62 626f 7820 3d20     self._bbox = 
-000207b0: 6e65 775f 626f 756e 6469 6e67 5f62 6f78  new_bounding_box
-000207c0: 0a0a 2020 2020 6465 6620 5f62 6f75 6e64  ..    def _bound
-000207d0: 696e 675f 626f 7828 7365 6c66 293a 0a20  ing_box(self):. 
-000207e0: 2020 2020 2020 2078 6d69 6e20 3d20 6d69         xmin = mi
-000207f0: 6e28 5b73 656c 662e 706f 696e 7431 5b30  n([self.point1[0
-00020800: 5d2c 2073 656c 662e 706f 696e 7432 5b30  ], self.point2[0
-00020810: 5d5d 290a 2020 2020 2020 2020 786d 6178  ]]).        xmax
-00020820: 203d 206d 6178 285b 7365 6c66 2e70 6f69   = max([self.poi
-00020830: 6e74 315b 305d 2c20 7365 6c66 2e70 6f69  nt1[0], self.poi
-00020840: 6e74 325b 305d 5d29 0a20 2020 2020 2020  nt2[0]]).       
-00020850: 2079 6d69 6e20 3d20 6d69 6e28 5b73 656c   ymin = min([sel
-00020860: 662e 706f 696e 7431 5b31 5d2c 2073 656c  f.point1[1], sel
-00020870: 662e 706f 696e 7432 5b31 5d5d 290a 2020  f.point2[1]]).  
-00020880: 2020 2020 2020 796d 6178 203d 206d 6178        ymax = max
-00020890: 285b 7365 6c66 2e70 6f69 6e74 315b 315d  ([self.point1[1]
-000208a0: 2c20 7365 6c66 2e70 6f69 6e74 325b 315d  , self.point2[1]
-000208b0: 5d29 0a20 2020 2020 2020 207a 6d69 6e20  ]).        zmin 
-000208c0: 3d20 6d69 6e28 5b73 656c 662e 706f 696e  = min([self.poin
-000208d0: 7431 5b32 5d2c 2073 656c 662e 706f 696e  t1[2], self.poin
-000208e0: 7432 5b32 5d5d 290a 2020 2020 2020 2020  t2[2]]).        
-000208f0: 7a6d 6178 203d 206d 6178 285b 7365 6c66  zmax = max([self
-00020900: 2e70 6f69 6e74 315b 325d 2c20 7365 6c66  .point1[2], self
-00020910: 2e70 6f69 6e74 325b 325d 5d29 0a0a 2020  .point2[2]])..  
-00020920: 2020 2020 2020 7265 7475 726e 2076 6f6c        return vol
-00020930: 6d64 6c72 2e63 6f72 652e 426f 756e 6469  mdlr.core.Boundi
-00020940: 6e67 426f 7828 786d 696e 2c20 786d 6178  ngBox(xmin, xmax
-00020950: 2c20 796d 696e 2c20 796d 6178 2c20 7a6d  , ymin, ymax, zm
-00020960: 696e 2c20 7a6d 6178 290a 0a20 2020 2064  in, zmax)..    d
-00020970: 6566 2070 6f69 6e74 5f61 745f 6162 7363  ef point_at_absc
-00020980: 6973 7361 2873 656c 662c 2061 6273 6369  issa(self, absci
-00020990: 7373 6129 3a0a 2020 2020 2020 2020 7265  ssa):.        re
-000209a0: 7475 726e 2073 656c 662e 706f 696e 7431  turn self.point1
-000209b0: 202b 2028 0a20 2020 2020 2020 2020 2020   + (.           
-000209c0: 2073 656c 662e 706f 696e 7432 202d 2073   self.point2 - s
-000209d0: 656c 662e 706f 696e 7431 2920 2a20 6162  elf.point1) * ab
-000209e0: 7363 6973 7361 0a0a 2020 2020 6465 6620  scissa..    def 
-000209f0: 706f 696e 745f 6265 6c6f 6e67 7328 7365  point_belongs(se
-00020a00: 6c66 2c20 706f 696e 7433 6429 3a0a 2020  lf, point3d):.  
-00020a10: 2020 2020 2020 6966 2070 6f69 6e74 3364        if point3d
-00020a20: 203d 3d20 7365 6c66 2e70 6f69 6e74 313a   == self.point1:
-00020a30: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00020a40: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
-00020a50: 2072 6574 7572 6e20 7365 6c66 2e64 6972   return self.dir
-00020a60: 6563 7469 6f6e 5f76 6563 746f 7228 292e  ection_vector().
-00020a70: 6973 5f63 6f6c 696e 6561 725f 746f 2870  is_colinear_to(p
-00020a80: 6f69 6e74 3364 202d 2073 656c 662e 706f  oint3d - self.po
-00020a90: 696e 7431 290a 0a20 2020 2064 6566 2070  int1)..    def p
-00020aa0: 6f69 6e74 5f64 6973 7461 6e63 6528 7365  oint_distance(se
-00020ab0: 6c66 2c20 706f 696e 7429 3a0a 2020 2020  lf, point):.    
-00020ac0: 2020 2020 7665 6374 6f72 3120 3d20 706f      vector1 = po
-00020ad0: 696e 7420 2d20 7365 6c66 2e70 6f69 6e74  int - self.point
-00020ae0: 310a 2020 2020 2020 2020 7665 6374 6f72  1.        vector
-00020af0: 312e 746f 5f76 6563 746f 7228 290a 2020  1.to_vector().  
-00020b00: 2020 2020 2020 7665 6374 6f72 3220 3d20        vector2 = 
-00020b10: 7365 6c66 2e70 6f69 6e74 3220 2d20 7365  self.point2 - se
-00020b20: 6c66 2e70 6f69 6e74 310a 2020 2020 2020  lf.point1.      
-00020b30: 2020 7665 6374 6f72 322e 746f 5f76 6563    vector2.to_vec
-00020b40: 746f 7228 290a 2020 2020 2020 2020 7265  tor().        re
-00020b50: 7475 726e 2076 6563 746f 7231 2e63 726f  turn vector1.cro
-00020b60: 7373 2876 6563 746f 7232 292e 6e6f 726d  ss(vector2).norm
-00020b70: 2829 202f 2076 6563 746f 7232 2e6e 6f72  () / vector2.nor
-00020b80: 6d28 290a 0a20 2020 2064 6566 206c 696e  m()..    def lin
-00020b90: 655f 6469 7374 616e 6365 2873 656c 662c  e_distance(self,
-00020ba0: 206c 696e 6532 293a 0a20 2020 2020 2020   line2):.       
-00020bb0: 2022 2222 0a20 2020 2020 2020 2043 616c   """.        Cal
-00020bc0: 6375 6c61 7465 7320 7468 6520 6469 7374  culates the dist
-00020bd0: 616e 6365 2062 6574 7765 656e 2074 776f  ance between two
-00020be0: 204c 696e 6533 442e 0a0a 2020 2020 2020   Line3D...      
-00020bf0: 2020 3a70 6172 616d 206c 696e 6532 3a20    :param line2: 
-00020c00: 6f74 6865 7220 4c69 6e65 3344 2e0a 2020  other Line3D..  
-00020c10: 2020 2020 2020 3a72 6574 7572 6e3a 2054        :return: T
-00020c20: 6865 2064 6973 7461 6e63 6520 6265 7477  he distance betw
-00020c30: 6565 6e20 7468 6520 7477 6f20 6c69 6e65  een the two line
-00020c40: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-00020c50: 2020 2020 2020 2064 6972 6563 7469 6f6e         direction
-00020c60: 5f76 6563 746f 7231 203d 2073 656c 662e  _vector1 = self.
-00020c70: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
-00020c80: 2829 0a20 2020 2020 2020 2064 6972 6563  ().        direc
-00020c90: 7469 6f6e 5f76 6563 746f 7232 203d 206c  tion_vector2 = l
-00020ca0: 696e 6532 2e64 6972 6563 7469 6f6e 5f76  ine2.direction_v
-00020cb0: 6563 746f 7228 290a 2020 2020 2020 2020  ector().        
-00020cc0: 6966 2064 6972 6563 7469 6f6e 5f76 6563  if direction_vec
-00020cd0: 746f 7231 2e69 735f 636f 6c69 6e65 6172  tor1.is_colinear
-00020ce0: 5f74 6f28 6469 7265 6374 696f 6e5f 7665  _to(direction_ve
-00020cf0: 6374 6f72 3229 3a0a 2020 2020 2020 2020  ctor2):.        
-00020d00: 2020 2020 7265 7475 726e 2064 6972 6563      return direc
-00020d10: 7469 6f6e 5f76 6563 746f 7231 2e63 726f  tion_vector1.cro
-00020d20: 7373 286c 696e 6532 2e70 6f69 6e74 3120  ss(line2.point1 
-00020d30: 2d20 7365 6c66 2e70 6f69 6e74 3129 2e6e  - self.point1).n
-00020d40: 6f72 6d28 2920 2f20 6469 7265 6374 696f  orm() / directio
-00020d50: 6e5f 7665 6374 6f72 312e 6e6f 726d 2829  n_vector1.norm()
-00020d60: 0a20 2020 2020 2020 2076 6563 746f 7220  .        vector 
-00020d70: 3d20 6c69 6e65 322e 706f 696e 7431 202d  = line2.point1 -
-00020d80: 2073 656c 662e 706f 696e 7431 0a20 2020   self.point1.   
-00020d90: 2020 2020 206c 696e 655f 6469 7374 616e       line_distan
-00020da0: 6365 203d 2061 6273 2876 6563 746f 722e  ce = abs(vector.
-00020db0: 646f 7428 6469 7265 6374 696f 6e5f 7665  dot(direction_ve
-00020dc0: 6374 6f72 312e 6372 6f73 7328 6469 7265  ctor1.cross(dire
-00020dd0: 6374 696f 6e5f 7665 6374 6f72 3229 2929  ction_vector2)))
-00020de0: 202f 2064 6972 6563 7469 6f6e 5f76 6563   / direction_vec
-00020df0: 746f 7231 2e63 726f 7373 280a 2020 2020  tor1.cross(.    
-00020e00: 2020 2020 2020 2020 6469 7265 6374 696f          directio
-00020e10: 6e5f 7665 6374 6f72 3229 2e6e 6f72 6d28  n_vector2).norm(
-00020e20: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00020e30: 206c 696e 655f 6469 7374 616e 6365 0a0a   line_distance..
-00020e40: 2020 2020 6465 6620 736b 6577 5f74 6f28      def skew_to(
-00020e50: 7365 6c66 2c20 6c69 6e65 293a 0a20 2020  self, line):.   
-00020e60: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00020e70: 2056 6572 6966 6965 7320 6966 2074 776f   Verifies if two
-00020e80: 204c 696e 6533 4420 6172 6520 736b 6577   Line3D are skew
-00020e90: 2074 6f20 6561 6368 206f 7468 6572 2c20   to each other, 
-00020ea0: 7468 6174 2069 732c 2074 6865 7920 6172  that is, they ar
-00020eb0: 6520 6e6f 7420 7061 7261 6c6c 656c 2061  e not parallel a
-00020ec0: 6e64 206e 6576 6572 2069 6e74 6572 7365  nd never interse
-00020ed0: 6374 2e0a 0a20 2020 2020 2020 203a 7061  ct...        :pa
-00020ee0: 7261 6d20 6c69 6e65 3a20 6f74 6865 7220  ram line: other 
-00020ef0: 6c69 6e65 2e0a 2020 2020 2020 2020 3a72  line..        :r
-00020f00: 6574 7572 6e3a 2054 7275 6520 6966 2074  eturn: True if t
-00020f10: 6865 7920 6172 6520 736b 6577 2c20 4661  hey are skew, Fa
-00020f20: 6c73 6520 6f74 6865 7277 6973 652e 0a20  lse otherwise.. 
-00020f30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00020f40: 2020 2069 6620 7365 6c66 2e64 6972 6563     if self.direc
-00020f50: 7469 6f6e 5f76 6563 746f 7228 292e 6973  tion_vector().is
-00020f60: 5f63 6f6c 696e 6561 725f 746f 286c 696e  _colinear_to(lin
-00020f70: 652e 6469 7265 6374 696f 6e5f 7665 6374  e.direction_vect
-00020f80: 6f72 2829 293a 0a20 2020 2020 2020 2020  or()):.         
-00020f90: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
-00020fa0: 2020 2020 2020 2020 6966 206d 6174 682e          if math.
-00020fb0: 6973 636c 6f73 6528 7365 6c66 2e6c 696e  isclose(self.lin
-00020fc0: 655f 6469 7374 616e 6365 286c 696e 6529  e_distance(line)
-00020fd0: 2c20 302c 2061 6273 5f74 6f6c 3d31 652d  , 0, abs_tol=1e-
-00020fe0: 3629 3a0a 2020 2020 2020 2020 2020 2020  6):.            
-00020ff0: 7265 7475 726e 2046 616c 7365 0a20 2020  return False.   
-00021000: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-00021010: 0a0a 2020 2020 6465 6620 696e 7465 7273  ..    def inters
-00021020: 6563 7469 6f6e 2873 656c 662c 206c 696e  ection(self, lin
-00021030: 6532 293a 0a20 2020 2020 2020 2022 2222  e2):.        """
-00021040: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
-00021050: 7465 7320 7468 6520 696e 7465 7273 6563  tes the intersec
-00021060: 7469 6f6e 2062 6574 7765 656e 2074 6f20  tion between to 
-00021070: 4c69 6e65 3344 2c20 6966 2074 6865 7265  Line3D, if there
-00021080: 2069 7320 616e 2069 6e74 6572 7365 6374   is an intersect
-00021090: 696f 6e2e 0a0a 2020 2020 2020 2020 3a70  ion...        :p
-000210a0: 6172 616d 206c 696e 653a 206f 7468 6572  aram line: other
-000210b0: 204c 696e 6533 440a 2020 2020 2020 2020   Line3D.        
-000210c0: 3a72 6574 7572 6e3a 204e 6f6e 6520 6966  :return: None if
-000210d0: 2074 6865 7265 2069 7320 6e6f 2069 6e74   there is no int
-000210e0: 6572 7365 6374 696f 6e20 6265 7477 6565  ersection betwee
-000210f0: 6e20 4c69 6e65 732e 2041 2076 6f6c 6d64  n Lines. A volmd
-00021100: 6c72 2e50 6f69 6e74 3344 2069 6620 7468  lr.Point3D if th
-00021110: 6572 6520 6578 6973 7465 7320 616e 2069  ere existes an i
-00021120: 6e74 6572 7365 6374 696f 6e0a 2020 2020  ntersection.    
-00021130: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00021140: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
-00021150: 3120 3d20 7365 6c66 2e64 6972 6563 7469  1 = self.directi
-00021160: 6f6e 5f76 6563 746f 7228 290a 2020 2020  on_vector().    
-00021170: 2020 2020 6469 7265 6374 696f 6e5f 7665      direction_ve
-00021180: 6374 6f72 3220 3d20 6c69 6e65 322e 6469  ctor2 = line2.di
-00021190: 7265 6374 696f 6e5f 7665 6374 6f72 2829  rection_vector()
-000211a0: 0a20 2020 2020 2020 2064 6973 7461 6e63  .        distanc
-000211b0: 655f 746f 5f6c 696e 6520 3d20 7365 6c66  e_to_line = self
-000211c0: 2e6c 696e 655f 6469 7374 616e 6365 286c  .line_distance(l
-000211d0: 696e 6532 290a 2020 2020 2020 2020 6966  ine2).        if
-000211e0: 2064 6972 6563 7469 6f6e 5f76 6563 746f   direction_vecto
-000211f0: 7231 2e69 735f 636f 6c69 6e65 6172 5f74  r1.is_colinear_t
-00021200: 6f28 6469 7265 6374 696f 6e5f 7665 6374  o(direction_vect
-00021210: 6f72 3229 206f 7220 5c0a 2020 2020 2020  or2) or \.      
-00021220: 2020 2020 2020 2020 2020 6e6f 7420 6d61            not ma
-00021230: 7468 2e69 7363 6c6f 7365 2864 6973 7461  th.isclose(dista
-00021240: 6e63 655f 746f 5f6c 696e 652c 2030 2c20  nce_to_line, 0, 
-00021250: 6162 735f 746f 6c3d 3165 2d36 293a 0a20  abs_tol=1e-6):. 
-00021260: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00021270: 6e20 4e6f 6e65 0a20 2020 2020 2020 2069  n None.        i
-00021280: 6620 6d61 7468 2e69 7363 6c6f 7365 2864  f math.isclose(d
-00021290: 6973 7461 6e63 655f 746f 5f6c 696e 652c  istance_to_line,
-000212a0: 2030 2c20 6162 735f 746f 6c3d 3165 2d36   0, abs_tol=1e-6
-000212b0: 2920 616e 6420 5c0a 2020 2020 2020 2020  ) and \.        
-000212c0: 2020 2020 2020 2020 6d61 7468 2e69 7363          math.isc
-000212d0: 6c6f 7365 2864 6972 6563 7469 6f6e 5f76  lose(direction_v
-000212e0: 6563 746f 7231 2e64 6f74 2864 6972 6563  ector1.dot(direc
-000212f0: 7469 6f6e 5f76 6563 746f 7232 292c 2030  tion_vector2), 0
-00021300: 2c20 6162 735f 746f 6c3d 3165 2d36 293a  , abs_tol=1e-6):
-00021310: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-00021320: 6a65 6374 6564 5f70 6f69 6e74 2c20 5f20  jected_point, _ 
-00021330: 3d20 7365 6c66 2e70 6f69 6e74 5f70 726f  = self.point_pro
-00021340: 6a65 6374 696f 6e28 6c69 6e65 322e 706f  jection(line2.po
-00021350: 696e 7431 290a 2020 2020 2020 2020 2020  int1).          
-00021360: 2020 7265 7475 726e 2070 726f 6a65 6374    return project
-00021370: 6564 5f70 6f69 6e74 0a20 2020 2020 2020  ed_point.       
-00021380: 2076 6563 746f 7220 3d20 7365 6c66 2e70   vector = self.p
-00021390: 6f69 6e74 3120 2d20 6c69 6e65 322e 706f  oint1 - line2.po
-000213a0: 696e 7431 0a20 2020 2020 2020 2074 5f63  int1.        t_c
-000213b0: 6f65 6666 6963 6965 6e74 203d 2028 0a20  oefficient = (. 
-000213c0: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
-000213d0: 722e 646f 7428 6469 7265 6374 696f 6e5f  r.dot(direction_
-000213e0: 7665 6374 6f72 3229 202a 2064 6972 6563  vector2) * direc
-000213f0: 7469 6f6e 5f76 6563 746f 7232 2e64 6f74  tion_vector2.dot
-00021400: 2864 6972 6563 7469 6f6e 5f76 6563 746f  (direction_vecto
-00021410: 7231 2920 2d0a 2020 2020 2020 2020 2020  r1) -.          
-00021420: 2020 7665 6374 6f72 2e64 6f74 2864 6972    vector.dot(dir
-00021430: 6563 7469 6f6e 5f76 6563 746f 7231 2920  ection_vector1) 
-00021440: 2a20 6469 7265 6374 696f 6e5f 7665 6374  * direction_vect
-00021450: 6f72 322e 646f 7428 6469 7265 6374 696f  or2.dot(directio
-00021460: 6e5f 7665 6374 6f72 3229 2920 2f20 280a  n_vector2)) / (.
-00021470: 2020 2020 2020 2020 2020 2020 6469 7265              dire
-00021480: 6374 696f 6e5f 7665 6374 6f72 312e 646f  ction_vector1.do
-00021490: 7428 6469 7265 6374 696f 6e5f 7665 6374  t(direction_vect
-000214a0: 6f72 3129 202a 2064 6972 6563 7469 6f6e  or1) * direction
-000214b0: 5f76 6563 746f 7232 2e64 6f74 2864 6972  _vector2.dot(dir
-000214c0: 6563 7469 6f6e 5f76 6563 746f 7232 2920  ection_vector2) 
-000214d0: 2d0a 2020 2020 2020 2020 2020 2020 6469  -.            di
-000214e0: 7265 6374 696f 6e5f 7665 6374 6f72 312e  rection_vector1.
-000214f0: 646f 7428 6469 7265 6374 696f 6e5f 7665  dot(direction_ve
-00021500: 6374 6f72 3229 202a 2064 6972 6563 7469  ctor2) * directi
-00021510: 6f6e 5f76 6563 746f 7232 2e64 6f74 2864  on_vector2.dot(d
-00021520: 6972 6563 7469 6f6e 5f76 6563 746f 7231  irection_vector1
-00021530: 2929 0a20 2020 2020 2020 2023 2075 5f63  )).        # u_c
-00021540: 6f65 6666 6963 6965 6e74 203d 2028 7665  oefficient = (ve
-00021550: 6374 6f72 2e64 6f74 2864 6972 6563 7469  ctor.dot(directi
-00021560: 6f6e 5f76 6563 746f 7232 2920 2b20 745f  on_vector2) + t_
-00021570: 636f 6566 6669 6369 656e 7420 2a20 6469  coefficient * di
-00021580: 7265 6374 696f 6e5f 7665 6374 6f72 312e  rection_vector1.
-00021590: 646f 7428 0a20 2020 2020 2020 2023 2064  dot(.        # d
-000215a0: 6972 6563 7469 6f6e 5f76 6563 746f 7232  irection_vector2
-000215b0: 2929 202f 2064 6972 6563 7469 6f6e 5f76  )) / direction_v
-000215c0: 6563 746f 7232 2e64 6f74 2864 6972 6563  ector2.dot(direc
-000215d0: 7469 6f6e 5f76 6563 746f 7232 290a 2020  tion_vector2).  
-000215e0: 2020 2020 2020 696e 7465 7273 6563 7469        intersecti
-000215f0: 6f6e 203d 2073 656c 662e 706f 696e 7431  on = self.point1
-00021600: 202b 2074 5f63 6f65 6666 6963 6965 6e74   + t_coefficient
-00021610: 202a 2064 6972 6563 7469 6f6e 5f76 6563   * direction_vec
-00021620: 746f 7231 0a20 2020 2020 2020 2072 6574  tor1.        ret
-00021630: 7572 6e20 696e 7465 7273 6563 7469 6f6e  urn intersection
-00021640: 0a0a 2020 2020 6465 6620 706c 6f74 2873  ..    def plot(s
-00021650: 656c 662c 2061 783d 4e6f 6e65 2c20 636f  elf, ax=None, co
-00021660: 6c6f 723d 276b 272c 2061 6c70 6861 3d31  lor='k', alpha=1
-00021670: 2c20 6461 7368 6564 3d54 7275 6529 3a0a  , dashed=True):.
-00021680: 2020 2020 2020 2020 6966 2061 7820 6973          if ax is
-00021690: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000216a0: 2020 2061 7820 3d20 4178 6573 3344 2870     ax = Axes3D(p
-000216b0: 6c74 2e66 6967 7572 6528 2929 0a0a 2020  lt.figure())..  
-000216c0: 2020 2020 2020 2320 4c69 6e65 2073 6567        # Line seg
-000216d0: 6d65 6e74 0a20 2020 2020 2020 2061 782e  ment.        ax.
-000216e0: 706c 6f74 285b 7365 6c66 2e70 6f69 6e74  plot([self.point
-000216f0: 312e 782c 2073 656c 662e 706f 696e 7432  1.x, self.point2
-00021700: 2e78 5d2c 205b 7365 6c66 2e70 6f69 6e74  .x], [self.point
-00021710: 312e 792c 2073 656c 662e 706f 696e 7432  1.y, self.point2
-00021720: 2e79 5d2c 0a20 2020 2020 2020 2020 2020  .y],.           
-00021730: 2020 2020 205b 7365 6c66 2e70 6f69 6e74       [self.point
-00021740: 312e 7a2c 2073 656c 662e 706f 696e 7432  1.z, self.point2
-00021750: 2e7a 5d2c 2063 6f6c 6f72 3d63 6f6c 6f72  .z], color=color
-00021760: 2c20 616c 7068 613d 616c 7068 6129 0a0a  , alpha=alpha)..
-00021770: 2020 2020 2020 2020 2320 4472 6177 696e          # Drawin
-00021780: 6720 3320 7469 6d65 7320 6c65 6e67 7468  g 3 times length
-00021790: 206f 6620 7365 676d 656e 7420 6f6e 2065   of segment on e
-000217a0: 6163 6820 7369 6465 0a20 2020 2020 2020  ach side.       
-000217b0: 2075 203d 2073 656c 662e 706f 696e 7432   u = self.point2
-000217c0: 202d 2073 656c 662e 706f 696e 7431 0a20   - self.point1. 
-000217d0: 2020 2020 2020 2076 3120 3d20 7365 6c66         v1 = self
-000217e0: 2e70 6f69 6e74 3120 2d20 3320 2a20 750a  .point1 - 3 * u.
-000217f0: 2020 2020 2020 2020 7831 2c20 7931 2c20          x1, y1, 
-00021800: 7a31 203d 2076 312e 782c 2076 312e 792c  z1 = v1.x, v1.y,
-00021810: 2076 312e 7a0a 2020 2020 2020 2020 7632   v1.z.        v2
-00021820: 203d 2073 656c 662e 706f 696e 7432 202d   = self.point2 -
-00021830: 2033 202a 2075 0a20 2020 2020 2020 2078   3 * u.        x
-00021840: 322c 2079 322c 207a 3220 3d20 7632 2e78  2, y2, z2 = v2.x
-00021850: 2c20 7632 2e79 2c20 7632 2e7a 0a20 2020  , v2.y, v2.z.   
-00021860: 2020 2020 2069 6620 6461 7368 6564 3a0a       if dashed:.
-00021870: 2020 2020 2020 2020 2020 2020 6178 2e70              ax.p
-00021880: 6c6f 7428 5b78 312c 2078 325d 2c20 5b79  lot([x1, x2], [y
-00021890: 312c 2079 325d 2c20 5b7a 312c 207a 325d  1, y2], [z1, z2]
-000218a0: 2c20 636f 6c6f 723d 636f 6c6f 722c 0a20  , color=color,. 
-000218b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000218c0: 2020 2064 6173 6865 733d 5b33 302c 2035     dashes=[30, 5
-000218d0: 2c20 3130 2c20 355d 290a 2020 2020 2020  , 10, 5]).      
-000218e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000218f0: 2020 2020 6178 2e70 6c6f 7428 5b78 312c      ax.plot([x1,
-00021900: 2078 325d 2c20 5b79 312c 2079 325d 2c20   x2], [y1, y2], 
-00021910: 5b7a 312c 207a 325d 2c20 636f 6c6f 723d  [z1, z2], color=
-00021920: 636f 6c6f 7229 0a20 2020 2020 2020 2072  color).        r
-00021930: 6574 7572 6e20 6178 0a0a 2020 2020 6465  eturn ax..    de
-00021940: 6620 706c 616e 655f 7072 6f6a 6563 7469  f plane_projecti
-00021950: 6f6e 3264 2873 656c 662c 2063 656e 7465  on2d(self, cente
-00021960: 722c 2078 2c20 7929 3a0a 2020 2020 2020  r, x, y):.      
-00021970: 2020 7265 7475 726e 204c 696e 6532 4428    return Line2D(
-00021980: 7365 6c66 2e70 6f69 6e74 312e 706c 616e  self.point1.plan
-00021990: 655f 7072 6f6a 6563 7469 6f6e 3264 2863  e_projection2d(c
-000219a0: 656e 7465 722c 2078 2c20 7929 2c0a 2020  enter, x, y),.  
-000219b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000219c0: 2020 2020 7365 6c66 2e70 6f69 6e74 322e      self.point2.
-000219d0: 706c 616e 655f 7072 6f6a 6563 7469 6f6e  plane_projection
-000219e0: 3264 2863 656e 7465 722c 2078 2c20 7929  2d(center, x, y)
-000219f0: 290a 0a20 2020 2064 6566 206d 696e 696d  )..    def minim
-00021a00: 756d 5f64 6973 7461 6e63 655f 706f 696e  um_distance_poin
-00021a10: 7473 2873 656c 662c 206f 7468 6572 5f6c  ts(self, other_l
-00021a20: 696e 6529 3a0a 2020 2020 2020 2020 2222  ine):.        ""
-00021a30: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-00021a40: 7320 7468 6520 706f 696e 7473 206f 6e20  s the points on 
-00021a50: 7468 6973 206c 696e 6520 616e 6420 7468  this line and th
-00021a60: 6520 6f74 6865 7220 6c69 6e65 2074 6861  e other line tha
-00021a70: 7420 6172 6520 7468 6520 636c 6f73 6573  t are the closes
-00021a80: 7420 6f66 206c 696e 6573 2e0a 2020 2020  t of lines..    
-00021a90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00021aa0: 7520 3d20 7365 6c66 2e70 6f69 6e74 3220  u = self.point2 
-00021ab0: 2d20 7365 6c66 2e70 6f69 6e74 310a 2020  - self.point1.  
-00021ac0: 2020 2020 2020 7620 3d20 6f74 6865 725f        v = other_
-00021ad0: 6c69 6e65 2e70 6f69 6e74 3220 2d20 6f74  line.point2 - ot
-00021ae0: 6865 725f 6c69 6e65 2e70 6f69 6e74 310a  her_line.point1.
-00021af0: 2020 2020 2020 2020 7720 3d20 7365 6c66          w = self
-00021b00: 2e70 6f69 6e74 3120 2d20 6f74 6865 725f  .point1 - other_
-00021b10: 6c69 6e65 2e70 6f69 6e74 310a 2020 2020  line.point1.    
-00021b20: 2020 2020 6120 3d20 752e 646f 7428 7529      a = u.dot(u)
-00021b30: 0a20 2020 2020 2020 2062 203d 2075 2e64  .        b = u.d
-00021b40: 6f74 2876 290a 2020 2020 2020 2020 6320  ot(v).        c 
-00021b50: 3d20 762e 646f 7428 7629 0a20 2020 2020  = v.dot(v).     
-00021b60: 2020 2064 203d 2075 2e64 6f74 2877 290a     d = u.dot(w).
-00021b70: 2020 2020 2020 2020 6520 3d20 762e 646f          e = v.do
-00021b80: 7428 7729 0a0a 2020 2020 2020 2020 7320  t(w)..        s 
-00021b90: 3d20 2862 202a 2065 202d 2063 202a 2064  = (b * e - c * d
-00021ba0: 2920 2f20 2861 202a 2063 202d 2062 202a  ) / (a * c - b *
-00021bb0: 2a20 3229 0a20 2020 2020 2020 2074 203d  * 2).        t =
-00021bc0: 2028 6120 2a20 6520 2d20 6220 2a20 6429   (a * e - b * d)
-00021bd0: 202f 2028 6120 2a20 6320 2d20 6220 2a2a   / (a * c - b **
-00021be0: 2032 290a 2020 2020 2020 2020 7031 203d   2).        p1 =
-00021bf0: 2073 656c 662e 706f 696e 7431 202b 2073   self.point1 + s
-00021c00: 202a 2075 0a20 2020 2020 2020 2070 3220   * u.        p2 
-00021c10: 3d20 6f74 6865 725f 6c69 6e65 2e70 6f69  = other_line.poi
-00021c20: 6e74 3120 2b20 7420 2a20 760a 2020 2020  nt1 + t * v.    
-00021c30: 2020 2020 7265 7475 726e 2070 312c 2070      return p1, p
-00021c40: 320a 0a20 2020 2064 6566 2072 6f74 6174  2..    def rotat
-00021c50: 696f 6e28 7365 6c66 2c20 6365 6e74 6572  ion(self, center
-00021c60: 3a20 766f 6c6d 646c 722e 506f 696e 7433  : volmdlr.Point3
-00021c70: 442c 2061 7869 733a 2076 6f6c 6d64 6c72  D, axis: volmdlr
-00021c80: 2e56 6563 746f 7233 442c 2061 6e67 6c65  .Vector3D, angle
-00021c90: 3a20 666c 6f61 7429 3a0a 2020 2020 2020  : float):.      
-00021ca0: 2020 2222 220a 2020 2020 2020 2020 4c69    """.        Li
-00021cb0: 6e65 3344 2072 6f74 6174 696f 6e2e 0a0a  ne3D rotation...
-00021cc0: 2020 2020 2020 2020 3a70 6172 616d 2063          :param c
-00021cd0: 656e 7465 723a 2072 6f74 6174 696f 6e20  enter: rotation 
-00021ce0: 6365 6e74 6572 0a20 2020 2020 2020 203a  center.        :
-00021cf0: 7061 7261 6d20 6178 6973 3a20 726f 7461  param axis: rota
-00021d00: 7469 6f6e 2061 7869 730a 2020 2020 2020  tion axis.      
-00021d10: 2020 3a70 6172 616d 2061 6e67 6c65 3a20    :param angle: 
-00021d20: 616e 676c 6520 726f 7461 7469 6f6e 0a20  angle rotation. 
-00021d30: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-00021d40: 6120 6e65 7720 726f 7461 7465 6420 4c69  a new rotated Li
-00021d50: 6e65 3344 0a20 2020 2020 2020 2022 2222  ne3D.        """
-00021d60: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00021d70: 204c 696e 6533 4428 2a5b 702e 726f 7461   Line3D(*[p.rota
-00021d80: 7469 6f6e 2863 656e 7465 722c 2061 7869  tion(center, axi
-00021d90: 732c 2061 6e67 6c65 2920 666f 7220 7020  s, angle) for p 
-00021da0: 696e 0a20 2020 2020 2020 2020 2020 2020  in.             
-00021db0: 2020 2020 2020 2020 2020 205b 7365 6c66             [self
-00021dc0: 2e70 6f69 6e74 312c 2073 656c 662e 706f  .point1, self.po
-00021dd0: 696e 7432 5d5d 290a 0a20 2020 2064 6566  int2]])..    def
-00021de0: 2072 6f74 6174 696f 6e5f 696e 706c 6163   rotation_inplac
-00021df0: 6528 7365 6c66 2c20 6365 6e74 6572 3a20  e(self, center: 
-00021e00: 766f 6c6d 646c 722e 506f 696e 7433 442c  volmdlr.Point3D,
-00021e10: 2061 7869 733a 2076 6f6c 6d64 6c72 2e56   axis: volmdlr.V
-00021e20: 6563 746f 7233 442c 2061 6e67 6c65 3a20  ector3D, angle: 
-00021e30: 666c 6f61 7429 3a0a 2020 2020 2020 2020  float):.        
-00021e40: 2222 220a 2020 2020 2020 2020 4c69 6e65  """.        Line
-00021e50: 3344 2072 6f74 6174 696f 6e2e 204f 626a  3D rotation. Obj
-00021e60: 6563 7420 6973 2075 7064 6174 6564 2069  ect is updated i
-00021e70: 6e70 6c61 6365 2e0a 0a20 2020 2020 2020  nplace...       
-00021e80: 203a 7061 7261 6d20 6365 6e74 6572 3a20   :param center: 
-00021e90: 726f 7461 7469 6f6e 2063 656e 7465 720a  rotation center.
-00021ea0: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
-00021eb0: 7869 733a 2072 6f74 6174 696f 6e20 6178  xis: rotation ax
-00021ec0: 6973 0a20 2020 2020 2020 203a 7061 7261  is.        :para
-00021ed0: 6d20 616e 676c 653a 2072 6f74 6174 696f  m angle: rotatio
-00021ee0: 6e20 616e 676c 650a 2020 2020 2020 2020  n angle.        
-00021ef0: 2222 220a 2020 2020 2020 2020 7761 726e  """.        warn
-00021f00: 696e 6773 2e77 6172 6e28 2227 696e 706c  ings.warn("'inpl
-00021f10: 6163 6527 206d 6574 686f 6473 2061 7265  ace' methods are
-00021f20: 2064 6570 7265 6361 7465 642e 2055 7365   deprecated. Use
-00021f30: 2061 206e 6f74 2069 6e70 6c61 6365 206d   a not inplace m
-00021f40: 6574 686f 6420 696e 7374 6561 642e 222c  ethod instead.",
-00021f50: 2044 6570 7265 6361 7469 6f6e 5761 726e   DeprecationWarn
-00021f60: 696e 6729 0a0a 2020 2020 2020 2020 666f  ing)..        fo
-00021f70: 7220 7020 696e 205b 7365 6c66 2e70 6f69  r p in [self.poi
-00021f80: 6e74 312c 2073 656c 662e 706f 696e 7432  nt1, self.point2
-00021f90: 5d3a 0a20 2020 2020 2020 2020 2020 2070  ]:.            p
-00021fa0: 2e72 6f74 6174 696f 6e5f 696e 706c 6163  .rotation_inplac
-00021fb0: 6528 6365 6e74 6572 2c20 6178 6973 2c20  e(center, axis, 
-00021fc0: 616e 676c 6529 0a20 2020 2020 2020 2073  angle).        s
-00021fd0: 656c 662e 5f62 626f 7820 3d20 4e6f 6e65  elf._bbox = None
-00021fe0: 0a0a 2020 2020 6465 6620 7472 616e 736c  ..    def transl
-00021ff0: 6174 696f 6e28 7365 6c66 2c20 6f66 6673  ation(self, offs
-00022000: 6574 3a20 766f 6c6d 646c 722e 5665 6374  et: volmdlr.Vect
-00022010: 6f72 3344 293a 0a20 2020 2020 2020 2022  or3D):.        "
-00022020: 2222 0a20 2020 2020 2020 204c 696e 6533  "".        Line3
-00022030: 4420 7472 616e 736c 6174 696f 6e2e 0a0a  D translation...
-00022040: 2020 2020 2020 2020 3a70 6172 616d 206f          :param o
-00022050: 6666 7365 743a 2074 7261 6e73 6c61 7469  ffset: translati
-00022060: 6f6e 2076 6563 746f 720a 2020 2020 2020  on vector.      
-00022070: 2020 3a72 6574 7572 6e3a 2041 206e 6577    :return: A new
-00022080: 2074 7261 6e73 6c61 7465 6420 4c69 6e65   translated Line
-00022090: 3344 0a20 2020 2020 2020 2022 2222 0a20  3D.        """. 
-000220a0: 2020 2020 2020 2072 6574 7572 6e20 4c69         return Li
-000220b0: 6e65 3344 282a 5b70 6f69 6e74 2e74 7261  ne3D(*[point.tra
-000220c0: 6e73 6c61 7469 6f6e 286f 6666 7365 7429  nslation(offset)
-000220d0: 2066 6f72 2070 6f69 6e74 2069 6e0a 2020   for point in.  
-000220e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000220f0: 2020 2020 2020 5b73 656c 662e 706f 696e        [self.poin
-00022100: 7431 2c20 7365 6c66 2e70 6f69 6e74 325d  t1, self.point2]
-00022110: 5d29 0a0a 2020 2020 6465 6620 7472 616e  ])..    def tran
-00022120: 736c 6174 696f 6e5f 696e 706c 6163 6528  slation_inplace(
-00022130: 7365 6c66 2c20 6f66 6673 6574 3a20 766f  self, offset: vo
-00022140: 6c6d 646c 722e 5665 6374 6f72 3344 293a  lmdlr.Vector3D):
-00022150: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00022160: 2020 2020 204c 696e 6533 4420 7472 616e       Line3D tran
-00022170: 736c 6174 696f 6e2e 204f 626a 6563 7420  slation. Object 
-00022180: 6973 2075 7064 6174 6564 2069 6e70 6c61  is updated inpla
-00022190: 6365 2e0a 0a20 2020 2020 2020 203a 7061  ce...        :pa
-000221a0: 7261 6d20 6f66 6673 6574 3a20 7472 616e  ram offset: tran
-000221b0: 736c 6174 696f 6e20 7665 6374 6f72 0a20  slation vector. 
-000221c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000221d0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-000221e0: 2822 2769 6e70 6c61 6365 2720 6d65 7468  ("'inplace' meth
-000221f0: 6f64 7320 6172 6520 6465 7072 6563 6174  ods are deprecat
-00022200: 6564 2e20 5573 6520 6120 6e6f 7420 696e  ed. Use a not in
-00022210: 706c 6163 6520 6d65 7468 6f64 2069 6e73  place method ins
-00022220: 7465 6164 2e22 2c20 4465 7072 6563 6174  tead.", Deprecat
-00022230: 696f 6e57 6172 6e69 6e67 290a 0a20 2020  ionWarning)..   
-00022240: 2020 2020 2066 6f72 2070 6f69 6e74 2069       for point i
-00022250: 6e20 5b73 656c 662e 706f 696e 7431 2c20  n [self.point1, 
-00022260: 7365 6c66 2e70 6f69 6e74 325d 3a0a 2020  self.point2]:.  
-00022270: 2020 2020 2020 2020 2020 706f 696e 742e            point.
-00022280: 7472 616e 736c 6174 696f 6e5f 696e 706c  translation_inpl
-00022290: 6163 6528 6f66 6673 6574 290a 2020 2020  ace(offset).    
-000222a0: 2020 2020 7365 6c66 2e5f 6262 6f78 203d      self._bbox =
-000222b0: 204e 6f6e 650a 0a20 2020 2064 6566 2066   None..    def f
-000222c0: 7261 6d65 5f6d 6170 7069 6e67 2873 656c  rame_mapping(sel
-000222d0: 662c 2066 7261 6d65 3a20 766f 6c6d 646c  f, frame: volmdl
-000222e0: 722e 4672 616d 6533 442c 2073 6964 653a  r.Frame3D, side:
-000222f0: 2073 7472 293a 0a20 2020 2020 2020 2022   str):.        "
-00022300: 2222 0a20 2020 2020 2020 2043 6861 6e67  "".        Chang
-00022310: 6573 2076 6563 746f 7220 6672 616d 655f  es vector frame_
-00022320: 6d61 7070 696e 6720 616e 6420 7265 7475  mapping and retu
-00022330: 726e 2061 206e 6577 204c 696e 6533 442e  rn a new Line3D.
-00022340: 0a0a 2020 2020 2020 2020 7369 6465 203d  ..        side =
-00022350: 2027 6f6c 6427 206f 7220 276e 6577 270a   'old' or 'new'.
-00022360: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00022370: 2020 2020 6966 2073 6964 6520 3d3d 2027      if side == '
-00022380: 6f6c 6427 3a0a 2020 2020 2020 2020 2020  old':.          
-00022390: 2020 6e65 775f 7374 6172 7420 3d20 6672    new_start = fr
-000223a0: 616d 652e 6c6f 6361 6c5f 746f 5f67 6c6f  ame.local_to_glo
-000223b0: 6261 6c5f 636f 6f72 6469 6e61 7465 7328  bal_coordinates(
-000223c0: 7365 6c66 2e70 6f69 6e74 3129 0a20 2020  self.point1).   
-000223d0: 2020 2020 2020 2020 206e 6577 5f65 6e64           new_end
-000223e0: 203d 2066 7261 6d65 2e6c 6f63 616c 5f74   = frame.local_t
-000223f0: 6f5f 676c 6f62 616c 5f63 6f6f 7264 696e  o_global_coordin
-00022400: 6174 6573 2873 656c 662e 706f 696e 7432  ates(self.point2
-00022410: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
-00022420: 6964 6520 3d3d 2027 6e65 7727 3a0a 2020  ide == 'new':.  
-00022430: 2020 2020 2020 2020 2020 6e65 775f 7374            new_st
-00022440: 6172 7420 3d20 6672 616d 652e 676c 6f62  art = frame.glob
-00022450: 616c 5f74 6f5f 6c6f 6361 6c5f 636f 6f72  al_to_local_coor
-00022460: 6469 6e61 7465 7328 7365 6c66 2e70 6f69  dinates(self.poi
-00022470: 6e74 3129 0a20 2020 2020 2020 2020 2020  nt1).           
-00022480: 206e 6577 5f65 6e64 203d 2066 7261 6d65   new_end = frame
-00022490: 2e67 6c6f 6261 6c5f 746f 5f6c 6f63 616c  .global_to_local
-000224a0: 5f63 6f6f 7264 696e 6174 6573 2873 656c  _coordinates(sel
-000224b0: 662e 706f 696e 7432 290a 2020 2020 2020  f.point2).      
-000224c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000224d0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-000224e0: 7272 6f72 2827 506c 6561 7365 2045 6e74  rror('Please Ent
-000224f0: 6572 2061 2076 616c 6964 2073 6964 653a  er a valid side:
-00022500: 206f 6c64 206f 7220 6e65 7727 290a 2020   old or new').  
-00022510: 2020 2020 2020 7265 7475 726e 204c 696e        return Lin
-00022520: 6533 4428 6e65 775f 7374 6172 742c 206e  e3D(new_start, n
-00022530: 6577 5f65 6e64 290a 0a20 2020 2064 6566  ew_end)..    def
-00022540: 2066 7261 6d65 5f6d 6170 7069 6e67 5f69   frame_mapping_i
-00022550: 6e70 6c61 6365 2873 656c 662c 2066 7261  nplace(self, fra
-00022560: 6d65 3a20 766f 6c6d 646c 722e 4672 616d  me: volmdlr.Fram
-00022570: 6533 442c 2073 6964 653a 2073 7472 293a  e3D, side: str):
-00022580: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00022590: 2020 2020 2043 6861 6e67 6573 204c 696e       Changes Lin
-000225a0: 6533 4420 6672 616d 655f 6d61 7070 696e  e3D frame_mappin
-000225b0: 6720 616e 6420 7468 6520 6f62 6a65 6374  g and the object
-000225c0: 2069 7320 7570 6461 7465 6420 696e 706c   is updated inpl
-000225d0: 6163 652e 0a0a 2020 2020 2020 2020 7369  ace...        si
-000225e0: 6465 203d 2027 6f6c 6427 206f 7220 276e  de = 'old' or 'n
-000225f0: 6577 270a 2020 2020 2020 2020 2222 220a  ew'.        """.
-00022600: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-00022610: 2e77 6172 6e28 2227 696e 706c 6163 6527  .warn("'inplace'
-00022620: 206d 6574 686f 6473 2061 7265 2064 6570   methods are dep
-00022630: 7265 6361 7465 642e 2055 7365 2061 206e  recated. Use a n
-00022640: 6f74 2069 6e70 6c61 6365 206d 6574 686f  ot inplace metho
-00022650: 6420 696e 7374 6561 642e 222c 2044 6570  d instead.", Dep
-00022660: 7265 6361 7469 6f6e 5761 726e 696e 6729  recationWarning)
-00022670: 0a0a 2020 2020 2020 2020 6966 2073 6964  ..        if sid
-00022680: 6520 3d3d 2027 6f6c 6427 3a0a 2020 2020  e == 'old':.    
-00022690: 2020 2020 2020 2020 6e65 775f 7374 6172          new_star
-000226a0: 7420 3d20 6672 616d 652e 6c6f 6361 6c5f  t = frame.local_
-000226b0: 746f 5f67 6c6f 6261 6c5f 636f 6f72 6469  to_global_coordi
-000226c0: 6e61 7465 7328 7365 6c66 2e70 6f69 6e74  nates(self.point
-000226d0: 3129 0a20 2020 2020 2020 2020 2020 206e  1).            n
-000226e0: 6577 5f65 6e64 203d 2066 7261 6d65 2e6c  ew_end = frame.l
-000226f0: 6f63 616c 5f74 6f5f 676c 6f62 616c 5f63  ocal_to_global_c
-00022700: 6f6f 7264 696e 6174 6573 2873 656c 662e  oordinates(self.
-00022710: 706f 696e 7432 290a 2020 2020 2020 2020  point2).        
-00022720: 656c 6966 2073 6964 6520 3d3d 2027 6e65  elif side == 'ne
-00022730: 7727 3a0a 2020 2020 2020 2020 2020 2020  w':.            
-00022740: 6e65 775f 7374 6172 7420 3d20 6672 616d  new_start = fram
-00022750: 652e 676c 6f62 616c 5f74 6f5f 6c6f 6361  e.global_to_loca
-00022760: 6c5f 636f 6f72 6469 6e61 7465 7328 7365  l_coordinates(se
-00022770: 6c66 2e70 6f69 6e74 3129 0a20 2020 2020  lf.point1).     
-00022780: 2020 2020 2020 206e 6577 5f65 6e64 203d         new_end =
-00022790: 2066 7261 6d65 2e67 6c6f 6261 6c5f 746f   frame.global_to
-000227a0: 5f6c 6f63 616c 5f63 6f6f 7264 696e 6174  _local_coordinat
-000227b0: 6573 2873 656c 662e 706f 696e 7432 290a  es(self.point2).
-000227c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000227d0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000227e0: 5661 6c75 6545 7272 6f72 2827 506c 6561  ValueError('Plea
-000227f0: 7365 2045 6e74 6572 2061 2076 616c 6964  se Enter a valid
-00022800: 2073 6964 653a 206f 6c64 206f 7220 6e65   side: old or ne
-00022810: 7727 290a 2020 2020 2020 2020 7365 6c66  w').        self
-00022820: 2e70 6f69 6e74 3120 3d20 6e65 775f 7374  .point1 = new_st
-00022830: 6172 740a 2020 2020 2020 2020 7365 6c66  art.        self
-00022840: 2e70 6f69 6e74 3220 3d20 6e65 775f 656e  .point2 = new_en
-00022850: 640a 2020 2020 2020 2020 7365 6c66 2e5f  d.        self._
-00022860: 6262 6f78 203d 204e 6f6e 650a 0a20 2020  bbox = None..   
-00022870: 2064 6566 2074 7269 6d28 7365 6c66 2c20   def trim(self, 
-00022880: 706f 696e 7431 3a20 766f 6c6d 646c 722e  point1: volmdlr.
-00022890: 506f 696e 7433 442c 2070 6f69 6e74 323a  Point3D, point2:
-000228a0: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3344   volmdlr.Point3D
-000228b0: 293a 0a20 2020 2020 2020 2069 6620 6e6f  ):.        if no
-000228c0: 7420 7365 6c66 2e70 6f69 6e74 5f62 656c  t self.point_bel
-000228d0: 6f6e 6773 2870 6f69 6e74 3129 206f 7220  ongs(point1) or 
-000228e0: 6e6f 7420 7365 6c66 2e70 6f69 6e74 5f62  not self.point_b
-000228f0: 656c 6f6e 6773 2870 6f69 6e74 3229 3a0a  elongs(point2):.
-00022900: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00022910: 6520 5661 6c75 6545 7272 6f72 2827 506f  e ValueError('Po
-00022920: 696e 7420 6e6f 7420 6f6e 2063 7572 7665  int not on curve
-00022930: 2729 0a0a 2020 2020 2020 2020 7265 7475  ')..        retu
-00022940: 726e 204c 696e 6553 6567 6d65 6e74 3344  rn LineSegment3D
-00022950: 2870 6f69 6e74 312c 2070 6f69 6e74 3229  (point1, point2)
-00022960: 0a0a 2020 2020 6465 6620 636f 7079 2873  ..    def copy(s
-00022970: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
-00022980: 6172 6773 293a 0a20 2020 2020 2020 2072  args):.        r
-00022990: 6574 7572 6e20 4c69 6e65 3344 282a 5b70  eturn Line3D(*[p
-000229a0: 2e63 6f70 7928 2920 666f 7220 7020 696e  .copy() for p in
-000229b0: 205b 7365 6c66 2e70 6f69 6e74 312c 2073   [self.point1, s
-000229c0: 656c 662e 706f 696e 7432 5d5d 290a 0a20  elf.point2]]).. 
-000229d0: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
-000229e0: 2020 2020 6465 6620 6672 6f6d 5f73 7465      def from_ste
-000229f0: 7028 636c 732c 2061 7267 756d 656e 7473  p(cls, arguments
-00022a00: 2c20 6f62 6a65 6374 5f64 6963 7429 3a0a  , object_dict):.
-00022a10: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00022a20: 2020 2020 436f 6e76 6572 7473 2061 2073      Converts a s
-00022a30: 7465 7020 7072 696d 6974 6976 6520 746f  tep primitive to
-00022a40: 2061 6e20 4c69 6e65 3344 2e0a 0a20 2020   an Line3D...   
-00022a50: 2020 2020 203a 7061 7261 6d20 6172 6775       :param argu
-00022a60: 6d65 6e74 733a 2054 6865 2061 7267 756d  ments: The argum
-00022a70: 656e 7473 206f 6620 7468 6520 7374 6570  ents of the step
-00022a80: 2070 7269 6d69 7469 7665 2e20 5468 6520   primitive. The 
-00022a90: 6c61 7374 2065 6c65 6d65 6e74 2072 6570  last element rep
-00022aa0: 7265 7365 6e74 7320 7468 6520 756e 6974  resents the unit
-00022ab0: 5f63 6f6e 7665 7273 696f 6e5f 6661 6374  _conversion_fact
-00022ac0: 6f72 2e0a 2020 2020 2020 2020 3a74 7970  or..        :typ
-00022ad0: 6520 6172 6775 6d65 6e74 733a 206c 6973  e arguments: lis
-00022ae0: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
-00022af0: 206f 626a 6563 745f 6469 6374 3a20 5468   object_dict: Th
-00022b00: 6520 6469 6374 696f 6e61 7279 2063 6f6e  e dictionary con
-00022b10: 7461 696e 696e 6720 616c 6c20 7468 6520  taining all the 
-00022b20: 7374 6570 2070 7269 6d69 7469 7665 730a  step primitives.
-00022b30: 2020 2020 2020 2020 2020 2020 7468 6174              that
-00022b40: 2068 6176 6520 616c 7265 6164 7920 6265   have already be
-00022b50: 656e 2069 6e73 7461 6e74 6961 7465 640a  en instantiated.
-00022b60: 2020 2020 2020 2020 3a74 7970 6520 6f62          :type ob
-00022b70: 6a65 6374 5f64 6963 743a 2064 6963 740a  ject_dict: dict.
-00022b80: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00022b90: 2054 6865 2063 6f72 7265 7370 6f6e 6469   The correspondi
-00022ba0: 6e67 204c 696e 6533 4420 6f62 6a65 6374  ng Line3D object
-00022bb0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
-00022bc0: 203a 636c 6173 733a 6076 6f6c 6d64 6c72   :class:`volmdlr
-00022bd0: 2e65 6467 6573 2e4c 696e 6533 4460 0a20  .edges.Line3D`. 
-00022be0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00022bf0: 2020 2070 6f69 6e74 3120 3d20 6f62 6a65     point1 = obje
-00022c00: 6374 5f64 6963 745b 6172 6775 6d65 6e74  ct_dict[argument
-00022c10: 735b 315d 5d0a 2020 2020 2020 2020 6469  s[1]].        di
-00022c20: 7265 6374 696f 6e20 3d20 6f62 6a65 6374  rection = object
-00022c30: 5f64 6963 745b 6172 6775 6d65 6e74 735b  _dict[arguments[
-00022c40: 325d 5d0a 2020 2020 2020 2020 706f 696e  2]].        poin
-00022c50: 7432 203d 2070 6f69 6e74 3120 2b20 6469  t2 = point1 + di
-00022c60: 7265 6374 696f 6e0a 2020 2020 2020 2020  rection.        
-00022c70: 7265 7475 726e 2063 6c73 2870 6f69 6e74  return cls(point
-00022c80: 312c 2070 6f69 6e74 322c 2061 7267 756d  1, point2, argum
-00022c90: 656e 7473 5b30 5d5b 313a 2d31 5d29 0a0a  ents[0][1:-1])..
-00022ca0: 2020 2020 6465 6620 746f 5f73 7465 7028      def to_step(
-00022cb0: 7365 6c66 2c20 6375 7272 656e 745f 6964  self, current_id
-00022cc0: 2c20 7375 7266 6163 655f 6964 3d4e 6f6e  , surface_id=Non
-00022cd0: 6529 3a0a 2020 2020 2020 2020 7031 5f63  e):.        p1_c
-00022ce0: 6f6e 7465 6e74 2c20 7031 5f69 6420 3d20  ontent, p1_id = 
-00022cf0: 7365 6c66 2e70 6f69 6e74 312e 746f 5f73  self.point1.to_s
-00022d00: 7465 7028 6375 7272 656e 745f 6964 290a  tep(current_id).
-00022d10: 2020 2020 2020 2020 2320 7032 5f63 6f6e          # p2_con
-00022d20: 7465 6e74 2c20 7032 5f69 6420 3d20 7365  tent, p2_id = se
-00022d30: 6c66 2e70 6f69 6e74 322e 746f 5f73 7465  lf.point2.to_ste
-00022d40: 7028 6375 7272 656e 745f 6964 2b31 290a  p(current_id+1).
-00022d50: 2020 2020 2020 2020 6375 7272 656e 745f          current_
-00022d60: 6964 203d 2070 315f 6964 202b 2031 0a20  id = p1_id + 1. 
-00022d70: 2020 2020 2020 2075 5f63 6f6e 7465 6e74         u_content
-00022d80: 2c20 755f 6964 203d 2076 6f6c 6d64 6c72  , u_id = volmdlr
-00022d90: 2e56 6563 746f 7233 442e 746f 5f73 7465  .Vector3D.to_ste
-00022da0: 7028 0a20 2020 2020 2020 2020 2020 2073  p(.            s
-00022db0: 656c 662e 756e 6974 5f64 6972 6563 7469  elf.unit_directi
-00022dc0: 6f6e 5f76 6563 746f 7228 292c 0a20 2020  on_vector(),.   
-00022dd0: 2020 2020 2020 2020 2063 7572 7265 6e74           current
-00022de0: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
-00022df0: 2076 6563 746f 723d 5472 7565 290a 2020   vector=True).  
-00022e00: 2020 2020 2020 6375 7272 656e 745f 6964        current_id
-00022e10: 203d 2075 5f69 6420 2b20 310a 2020 2020   = u_id + 1.    
-00022e20: 2020 2020 636f 6e74 656e 7420 3d20 7031      content = p1
-00022e30: 5f63 6f6e 7465 6e74 202b 2075 5f63 6f6e  _content + u_con
-00022e40: 7465 6e74 0a20 2020 2020 2020 2063 6f6e  tent.        con
-00022e50: 7465 6e74 202b 3d20 6622 237b 6375 7272  tent += f"#{curr
-00022e60: 656e 745f 6964 7d20 3d20 4c49 4e45 2827  ent_id} = LINE('
-00022e70: 7b73 656c 662e 6e61 6d65 7d27 2c23 7b70  {self.name}',#{p
-00022e80: 315f 6964 7d2c 237b 755f 6964 7d29 3b5c  1_id},#{u_id});\
-00022e90: 6e22 0a20 2020 2020 2020 2072 6574 7572  n".        retur
-00022ea0: 6e20 636f 6e74 656e 742c 2063 7572 7265  n content, curre
-00022eb0: 6e74 5f69 640a 0a20 2020 2064 6566 2074  nt_id..    def t
-00022ec0: 6f5f 3264 2873 656c 662c 2070 6c61 6e65  o_2d(self, plane
-00022ed0: 5f6f 7269 6769 6e2c 2078 2c20 7929 3a0a  _origin, x, y):.
-00022ee0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00022ef0: 2020 2020 5472 616e 7366 6f72 6d73 2061      Transforms a
-00022f00: 204c 696e 6533 4420 696e 746f 2061 6e20   Line3D into an 
-00022f10: 4c69 6e65 3244 2c20 6769 7665 6e20 616e  Line2D, given an
-00022f20: 2070 6c61 6e65 206f 7269 6769 6e20 616e   plane origin an
-00022f30: 6420 6120 7520 616e 6420 7620 706c 616e  d a u and v plan
-00022f40: 6520 7665 6374 6f72 2e0a 0a20 2020 2020  e vector...     
-00022f50: 2020 203a 7061 7261 6d20 706c 616e 655f     :param plane_
-00022f60: 6f72 6967 696e 3a20 706c 616e 6520 6f72  origin: plane or
-00022f70: 6967 696e 2e0a 2020 2020 2020 2020 3a70  igin..        :p
-00022f80: 6172 616d 2078 3a20 706c 616e 6520 7520  aram x: plane u 
-00022f90: 7665 6374 6f72 2e0a 2020 2020 2020 2020  vector..        
-00022fa0: 3a70 6172 616d 2079 3a20 706c 616e 6520  :param y: plane 
-00022fb0: 7620 7665 6374 6f72 2e0a 2020 2020 2020  v vector..      
-00022fc0: 2020 3a72 6574 7572 6e3a 204c 696e 6532    :return: Line2
-00022fd0: 442e 0a20 2020 2020 2020 2022 2222 0a20  D..        """. 
-00022fe0: 2020 2020 2020 2070 3264 203d 205b 702e         p2d = [p.
-00022ff0: 746f 5f32 6428 706c 616e 655f 6f72 6967  to_2d(plane_orig
-00023000: 696e 2c20 782c 2079 2920 666f 7220 7020  in, x, y) for p 
-00023010: 696e 2028 7365 6c66 2e70 6f69 6e74 312c  in (self.point1,
-00023020: 2073 656c 662e 706f 696e 7432 295d 0a20   self.point2)]. 
-00023030: 2020 2020 2020 2069 6620 7032 645b 305d         if p2d[0]
-00023040: 203d 3d20 7032 645b 315d 3a0a 2020 2020   == p2d[1]:.    
-00023050: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-00023060: 6f6e 650a 2020 2020 2020 2020 7265 7475  one.        retu
-00023070: 726e 204c 696e 6532 4428 2a70 3264 2c20  rn Line2D(*p2d, 
-00023080: 6e61 6d65 3d73 656c 662e 6e61 6d65 290a  name=self.name).
-00023090: 0a0a 636c 6173 7320 4c69 6e65 5365 676d  ..class LineSegm
-000230a0: 656e 7433 4428 4c69 6e65 5365 676d 656e  ent3D(LineSegmen
-000230b0: 7429 3a0a 2020 2020 2222 220a 2020 2020  t):.    """.    
-000230c0: 4465 6669 6e65 2061 206c 696e 6520 7365  Define a line se
-000230d0: 676d 656e 7420 6c69 6d69 7465 6420 6279  gment limited by
-000230e0: 2074 776f 2070 6f69 6e74 732e 0a0a 2020   two points...  
-000230f0: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
-00023100: 5f69 6e69 745f 5f28 7365 6c66 2c20 7374  _init__(self, st
-00023110: 6172 743a 2076 6f6c 6d64 6c72 2e50 6f69  art: volmdlr.Poi
-00023120: 6e74 3344 2c20 656e 643a 2076 6f6c 6d64  nt3D, end: volmd
-00023130: 6c72 2e50 6f69 6e74 3344 2c0a 2020 2020  lr.Point3D,.    
-00023140: 2020 2020 2020 2020 2020 2020 206e 616d               nam
-00023150: 653a 2073 7472 203d 2027 2729 3a0a 2020  e: str = ''):.  
-00023160: 2020 2020 2020 6966 2073 7461 7274 203d        if start =
-00023170: 3d20 656e 643a 0a20 2020 2020 2020 2020  = end:.         
-00023180: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00023190: 656d 656e 7465 6445 7272 6f72 0a20 2020  ementedError.   
-000231a0: 2020 2020 2023 2073 656c 662e 706f 696e       # self.poin
-000231b0: 7473 203d 205b 7374 6172 742c 2065 6e64  ts = [start, end
-000231c0: 5d0a 2020 2020 2020 2020 4c69 6e65 5365  ].        LineSe
-000231d0: 676d 656e 742e 5f5f 696e 6974 5f5f 2873  gment.__init__(s
-000231e0: 656c 662c 2073 7461 7274 3d73 7461 7274  elf, start=start
-000231f0: 2c20 656e 643d 656e 642c 206e 616d 653d  , end=end, name=
-00023200: 6e61 6d65 290a 2020 2020 2020 2020 7365  name).        se
-00023210: 6c66 2e5f 6262 6f78 203d 204e 6f6e 650a  lf._bbox = None.
-00023220: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00023230: 2020 2064 6566 2062 6f75 6e64 696e 675f     def bounding_
-00023240: 626f 7828 7365 6c66 293a 0a20 2020 2020  box(self):.     
-00023250: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
-00023260: 6262 6f78 3a0a 2020 2020 2020 2020 2020  bbox:.          
-00023270: 2020 7365 6c66 2e5f 6262 6f78 203d 2073    self._bbox = s
-00023280: 656c 662e 5f62 6f75 6e64 696e 675f 626f  elf._bounding_bo
-00023290: 7828 290a 2020 2020 2020 2020 7265 7475  x().        retu
-000232a0: 726e 2073 656c 662e 5f62 626f 780a 0a20  rn self._bbox.. 
-000232b0: 2020 2040 626f 756e 6469 6e67 5f62 6f78     @bounding_box
-000232c0: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
-000232d0: 626f 756e 6469 6e67 5f62 6f78 2873 656c  bounding_box(sel
-000232e0: 662c 206e 6577 5f62 6f75 6e64 696e 675f  f, new_bounding_
-000232f0: 626f 7829 3a0a 2020 2020 2020 2020 7365  box):.        se
-00023300: 6c66 2e5f 6262 6f78 203d 206e 6577 5f62  lf._bbox = new_b
-00023310: 6f75 6e64 696e 675f 626f 780a 0a20 2020  ounding_box..   
-00023320: 2064 6566 205f 5f68 6173 685f 5f28 7365   def __hash__(se
-00023330: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00023340: 7572 6e20 3220 2b20 6861 7368 2873 656c  urn 2 + hash(sel
-00023350: 662e 7374 6172 7429 202b 2068 6173 6828  f.start) + hash(
-00023360: 7365 6c66 2e65 6e64 290a 0a20 2020 2064  self.end)..    d
-00023370: 6566 205f 5f65 715f 5f28 7365 6c66 2c20  ef __eq__(self, 
-00023380: 6f74 6865 725f 6c69 6e65 7365 676d 656e  other_linesegmen
-00023390: 7433 6429 3a0a 2020 2020 2020 2020 6966  t3d):.        if
-000233a0: 206f 7468 6572 5f6c 696e 6573 6567 6d65   other_linesegme
-000233b0: 6e74 3364 2e5f 5f63 6c61 7373 5f5f 2021  nt3d.__class__ !
-000233c0: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
-000233d0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-000233e0: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
-000233f0: 2020 2072 6574 7572 6e20 2873 656c 662e     return (self.
-00023400: 7374 6172 7420 3d3d 206f 7468 6572 5f6c  start == other_l
-00023410: 696e 6573 6567 6d65 6e74 3364 2e73 7461  inesegment3d.sta
-00023420: 7274 0a20 2020 2020 2020 2020 2020 2020  rt.             
-00023430: 2020 2061 6e64 2073 656c 662e 656e 6420     and self.end 
-00023440: 3d3d 206f 7468 6572 5f6c 696e 6573 6567  == other_lineseg
-00023450: 6d65 6e74 3364 2e65 6e64 290a 0a20 2020  ment3d.end)..   
-00023460: 2064 6566 205f 626f 756e 6469 6e67 5f62   def _bounding_b
-00023470: 6f78 2873 656c 6629 3a0a 0a20 2020 2020  ox(self):..     
-00023480: 2020 2078 6d69 6e20 3d20 6d69 6e28 7365     xmin = min(se
-00023490: 6c66 2e73 7461 7274 2e78 2c20 7365 6c66  lf.start.x, self
-000234a0: 2e65 6e64 2e78 290a 2020 2020 2020 2020  .end.x).        
-000234b0: 786d 6178 203d 206d 6178 2873 656c 662e  xmax = max(self.
-000234c0: 7374 6172 742e 782c 2073 656c 662e 656e  start.x, self.en
-000234d0: 642e 7829 0a20 2020 2020 2020 2079 6d69  d.x).        ymi
-000234e0: 6e20 3d20 6d69 6e28 7365 6c66 2e73 7461  n = min(self.sta
-000234f0: 7274 2e79 2c20 7365 6c66 2e65 6e64 2e79  rt.y, self.end.y
-00023500: 290a 2020 2020 2020 2020 796d 6178 203d  ).        ymax =
-00023510: 206d 6178 2873 656c 662e 7374 6172 742e   max(self.start.
-00023520: 792c 2073 656c 662e 656e 642e 7929 0a20  y, self.end.y). 
-00023530: 2020 2020 2020 207a 6d69 6e20 3d20 6d69         zmin = mi
-00023540: 6e28 7365 6c66 2e73 7461 7274 2e7a 2c20  n(self.start.z, 
-00023550: 7365 6c66 2e65 6e64 2e7a 290a 2020 2020  self.end.z).    
-00023560: 2020 2020 7a6d 6178 203d 206d 6178 2873      zmax = max(s
-00023570: 656c 662e 7374 6172 742e 7a2c 2073 656c  elf.start.z, sel
-00023580: 662e 656e 642e 7a29 0a0a 2020 2020 2020  f.end.z)..      
-00023590: 2020 7265 7475 726e 2076 6f6c 6d64 6c72    return volmdlr
-000235a0: 2e63 6f72 652e 426f 756e 6469 6e67 426f  .core.BoundingBo
-000235b0: 7828 786d 696e 2c20 786d 6178 2c20 796d  x(xmin, xmax, ym
-000235c0: 696e 2c20 796d 6178 2c20 7a6d 696e 2c20  in, ymax, zmin, 
-000235d0: 7a6d 6178 290a 0a20 2020 2064 6566 2074  zmax)..    def t
-000235e0: 6f5f 6469 6374 2873 656c 662c 202a 6172  o_dict(self, *ar
-000235f0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-00023600: 2020 2020 2020 2072 6574 7572 6e20 7b27         return {'
-00023610: 6f62 6a65 6374 5f63 6c61 7373 273a 2027  object_class': '
-00023620: 766f 6c6d 646c 722e 6564 6765 732e 4c69  volmdlr.edges.Li
-00023630: 6e65 5365 676d 656e 7433 4427 2c0a 2020  neSegment3D',.  
-00023640: 2020 2020 2020 2020 2020 2020 2020 276e                'n
-00023650: 616d 6527 3a20 7365 6c66 2e6e 616d 652c  ame': self.name,
-00023660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023670: 2027 7374 6172 7427 3a20 7365 6c66 2e73   'start': self.s
-00023680: 7461 7274 2e74 6f5f 6469 6374 2829 2c0a  tart.to_dict(),.
-00023690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000236a0: 2765 6e64 273a 2073 656c 662e 656e 642e  'end': self.end.
-000236b0: 746f 5f64 6963 7428 290a 2020 2020 2020  to_dict().      
-000236c0: 2020 2020 2020 2020 2020 7d0a 0a20 2020            }..   
-000236d0: 2023 2064 6566 2070 6f69 6e74 5f61 745f   # def point_at_
-000236e0: 6162 7363 6973 7361 2873 656c 662c 2061  abscissa(self, a
-000236f0: 6273 6369 7373 6129 3a0a 2020 2020 2320  bscissa):.    # 
-00023700: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00023710: 7374 6172 7420 2b20 6162 7363 6973 7361  start + abscissa
-00023720: 202a 2028 0a20 2020 2023 2020 2020 2020   * (.    #      
-00023730: 2020 2073 656c 662e 656e 6420 2d20 7365     self.end - se
-00023740: 6c66 2e73 7461 7274 2920 2f20 7365 6c66  lf.start) / self
-00023750: 2e6c 656e 6774 6828 290a 0a20 2020 2064  .length()..    d
-00023760: 6566 2070 6f69 6e74 5f62 656c 6f6e 6773  ef point_belongs
-00023770: 2873 656c 662c 2070 6f69 6e74 2c20 6162  (self, point, ab
-00023780: 735f 746f 6c3d 3165 2d37 293a 0a20 2020  s_tol=1e-7):.   
-00023790: 2020 2020 2070 6f69 6e74 5f64 6973 7461       point_dista
-000237a0: 6e63 6520 3d20 7365 6c66 2e70 6f69 6e74  nce = self.point
-000237b0: 5f64 6973 7461 6e63 6528 706f 696e 7429  _distance(point)
-000237c0: 0a20 2020 2020 2020 2069 6620 6d61 7468  .        if math
-000237d0: 2e69 7363 6c6f 7365 2870 6f69 6e74 5f64  .isclose(point_d
-000237e0: 6973 7461 6e63 652c 2030 2c20 6162 735f  istance, 0, abs_
-000237f0: 746f 6c3d 6162 735f 746f 6c29 3a0a 2020  tol=abs_tol):.  
-00023800: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00023810: 2054 7275 650a 2020 2020 2020 2020 7265   True.        re
-00023820: 7475 726e 2046 616c 7365 0a0a 2020 2020  turn False..    
-00023830: 6465 6620 6e6f 726d 616c 5f76 6563 746f  def normal_vecto
-00023840: 7228 7365 6c66 2c20 6162 7363 6973 7361  r(self, abscissa
-00023850: 3d30 2e29 3a0a 2020 2020 2020 2020 7265  =0.):.        re
-00023860: 7475 726e 204e 6f6e 650a 0a20 2020 2064  turn None..    d
-00023870: 6566 2075 6e69 745f 6e6f 726d 616c 5f76  ef unit_normal_v
-00023880: 6563 746f 7228 7365 6c66 2c20 6162 7363  ector(self, absc
-00023890: 6973 7361 3d30 2e29 3a0a 2020 2020 2020  issa=0.):.      
-000238a0: 2020 7265 7475 726e 204e 6f6e 650a 0a20    return None.. 
-000238b0: 2020 2023 2064 6566 206d 6964 646c 655f     # def middle_
-000238c0: 706f 696e 7428 7365 6c66 293a 0a20 2020  point(self):.   
-000238d0: 2023 2020 2020 2072 6574 7572 6e20 7365   #     return se
-000238e0: 6c66 2e70 6f69 6e74 5f61 745f 6162 7363  lf.point_at_absc
-000238f0: 6973 7361 2830 2e35 202a 2073 656c 662e  issa(0.5 * self.
-00023900: 6c65 6e67 7468 2829 290a 0a20 2020 2064  length())..    d
-00023910: 6566 2070 6f69 6e74 5f64 6973 7461 6e63  ef point_distanc
-00023920: 6528 7365 6c66 2c20 706f 696e 7429 3a0a  e(self, point):.
-00023930: 2020 2020 2020 2020 6469 7374 616e 6365          distance
-00023940: 2c20 706f 696e 7420 3d20 766f 6c6d 646c  , point = volmdl
-00023950: 722e 4c69 6e65 5365 676d 656e 7433 4450  r.LineSegment3DP
-00023960: 6f69 6e74 4469 7374 616e 6365 280a 2020  ointDistance(.  
-00023970: 2020 2020 2020 2020 2020 5b28 7365 6c66            [(self
-00023980: 2e73 7461 7274 2e78 2c20 7365 6c66 2e73  .start.x, self.s
-00023990: 7461 7274 2e79 2c20 7365 6c66 2e73 7461  tart.y, self.sta
-000239a0: 7274 2e7a 292c 0a20 2020 2020 2020 2020  rt.z),.         
-000239b0: 2020 2020 2873 656c 662e 656e 642e 782c      (self.end.x,
-000239c0: 2073 656c 662e 656e 642e 792c 2073 656c   self.end.y, sel
-000239d0: 662e 656e 642e 7a29 5d2c 0a20 2020 2020  f.end.z)],.     
-000239e0: 2020 2020 2020 2028 706f 696e 742e 782c         (point.x,
-000239f0: 2070 6f69 6e74 2e79 2c20 706f 696e 742e   point.y, point.
-00023a00: 7a29 290a 2020 2020 2020 2020 7265 7475  z)).        retu
-00023a10: 726e 2064 6973 7461 6e63 650a 0a20 2020  rn distance..   
-00023a20: 2064 6566 2070 6c61 6e65 5f70 726f 6a65   def plane_proje
-00023a30: 6374 696f 6e32 6428 7365 6c66 2c20 6365  ction2d(self, ce
-00023a40: 6e74 6572 2c20 782c 2079 293a 0a20 2020  nter, x, y):.   
-00023a50: 2020 2020 2073 7461 7274 2c20 656e 6420       start, end 
-00023a60: 3d20 7365 6c66 2e73 7461 7274 2e70 6c61  = self.start.pla
-00023a70: 6e65 5f70 726f 6a65 6374 696f 6e32 6428  ne_projection2d(
-00023a80: 6365 6e74 6572 2c20 782c 2079 292c 2073  center, x, y), s
-00023a90: 656c 662e 656e 642e 706c 616e 655f 7072  elf.end.plane_pr
-00023aa0: 6f6a 6563 7469 6f6e 3264 2863 656e 7465  ojection2d(cente
-00023ab0: 722c 2078 2c20 7929 0a20 2020 2020 2020  r, x, y).       
-00023ac0: 2069 6620 7374 6172 7420 213d 2065 6e64   if start != end
-00023ad0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00023ae0: 7475 726e 204c 696e 6553 6567 6d65 6e74  turn LineSegment
-00023af0: 3244 2873 7461 7274 2c20 656e 6429 0a20  2D(start, end). 
-00023b00: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-00023b10: 6e65 0a0a 2020 2020 6465 6620 6c69 6e65  ne..    def line
-00023b20: 5f69 6e74 6572 7365 6374 696f 6e73 2873  _intersections(s
-00023b30: 656c 662c 206c 696e 6529 3a0a 2020 2020  elf, line):.    
-00023b40: 2020 2020 6c69 6e65 5f73 656c 6620 3d20      line_self = 
-00023b50: 7365 6c66 2e74 6f5f 6c69 6e65 2829 0a20  self.to_line(). 
-00023b60: 2020 2020 2020 2069 6620 6c69 6e65 5f73         if line_s
-00023b70: 656c 662e 736b 6577 5f74 6f28 6c69 6e65  elf.skew_to(line
-00023b80: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00023b90: 6574 7572 6e20 5b5d 0a20 2020 2020 2020  eturn [].       
-00023ba0: 2069 6e74 6572 7365 6374 696f 6e20 3d20   intersection = 
-00023bb0: 6c69 6e65 5f73 656c 662e 696e 7465 7273  line_self.inters
-00023bc0: 6563 7469 6f6e 286c 696e 6529 0a20 2020  ection(line).   
-00023bd0: 2020 2020 2069 6620 696e 7465 7273 6563       if intersec
-00023be0: 7469 6f6e 2061 6e64 2073 656c 662e 706f  tion and self.po
-00023bf0: 696e 745f 6265 6c6f 6e67 7328 696e 7465  int_belongs(inte
-00023c00: 7273 6563 7469 6f6e 293a 0a20 2020 2020  rsection):.     
-00023c10: 2020 2020 2020 2072 6574 7572 6e20 5b69         return [i
-00023c20: 6e74 6572 7365 6374 696f 6e5d 0a20 2020  ntersection].   
-00023c30: 2020 2020 2072 6574 7572 6e20 5b5d 0a0a       return []..
-00023c40: 2020 2020 6465 6620 6c69 6e65 7365 676d      def linesegm
-00023c50: 656e 745f 696e 7465 7273 6563 7469 6f6e  ent_intersection
-00023c60: 7328 7365 6c66 2c20 6c69 6e65 7365 676d  s(self, linesegm
-00023c70: 656e 7429 3a0a 2020 2020 2020 2020 6c69  ent):.        li
-00023c80: 6e65 3120 3d20 7365 6c66 2e74 6f5f 6c69  ne1 = self.to_li
-00023c90: 6e65 2829 0a20 2020 2020 2020 206c 696e  ne().        lin
-00023ca0: 6532 203d 206c 696e 6573 6567 6d65 6e74  e2 = linesegment
-00023cb0: 2e74 6f5f 6c69 6e65 2829 0a20 2020 2020  .to_line().     
-00023cc0: 2020 2069 6e74 6572 7365 6374 696f 6e20     intersection 
-00023cd0: 3d20 6c69 6e65 312e 696e 7465 7273 6563  = line1.intersec
-00023ce0: 7469 6f6e 286c 696e 6532 290a 2020 2020  tion(line2).    
-00023cf0: 2020 2020 6966 2069 6e74 6572 7365 6374      if intersect
-00023d00: 696f 6e20 616e 6420 7365 6c66 2e70 6f69  ion and self.poi
-00023d10: 6e74 5f62 656c 6f6e 6773 2869 6e74 6572  nt_belongs(inter
-00023d20: 7365 6374 696f 6e29 2061 6e64 206c 696e  section) and lin
-00023d30: 6573 6567 6d65 6e74 2e70 6f69 6e74 5f62  esegment.point_b
-00023d40: 656c 6f6e 6773 2869 6e74 6572 7365 6374  elongs(intersect
-00023d50: 696f 6e29 3a0a 2020 2020 2020 2020 2020  ion):.          
-00023d60: 2020 7265 7475 726e 205b 696e 7465 7273    return [inters
-00023d70: 6563 7469 6f6e 5d0a 2020 2020 2020 2020  ection].        
-00023d80: 7265 7475 726e 205b 5d0a 0a20 2020 2064  return []..    d
-00023d90: 6566 2072 6f74 6174 696f 6e28 7365 6c66  ef rotation(self
-00023da0: 2c20 6365 6e74 6572 3a20 766f 6c6d 646c  , center: volmdl
-00023db0: 722e 506f 696e 7433 442c 0a20 2020 2020  r.Point3D,.     
-00023dc0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00023dd0: 3a20 766f 6c6d 646c 722e 5665 6374 6f72  : volmdlr.Vector
-00023de0: 3344 2c20 616e 676c 653a 2066 6c6f 6174  3D, angle: float
-00023df0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00023e00: 2020 2020 2020 204c 696e 6553 6567 6d65         LineSegme
-00023e10: 6e74 3344 2072 6f74 6174 696f 6e2e 0a0a  nt3D rotation...
-00023e20: 2020 2020 2020 2020 3a70 6172 616d 2063          :param c
-00023e30: 656e 7465 723a 2072 6f74 6174 696f 6e20  enter: rotation 
-00023e40: 6365 6e74 6572 0a20 2020 2020 2020 203a  center.        :
-00023e50: 7061 7261 6d20 6178 6973 3a20 726f 7461  param axis: rota
-00023e60: 7469 6f6e 2061 7869 730a 2020 2020 2020  tion axis.      
-00023e70: 2020 3a70 6172 616d 2061 6e67 6c65 3a20    :param angle: 
-00023e80: 616e 676c 6520 726f 7461 7469 6f6e 0a20  angle rotation. 
-00023e90: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-00023ea0: 6120 6e65 7720 726f 7461 7465 6420 4c69  a new rotated Li
-00023eb0: 6e65 5365 676d 656e 7433 440a 2020 2020  neSegment3D.    
-00023ec0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00023ed0: 7265 7475 726e 204c 696e 6553 6567 6d65  return LineSegme
-00023ee0: 6e74 3344 280a 2020 2020 2020 2020 2020  nt3D(.          
-00023ef0: 2020 2a5b 706f 696e 742e 726f 7461 7469    *[point.rotati
-00023f00: 6f6e 2863 656e 7465 722c 2061 7869 732c  on(center, axis,
-00023f10: 2061 6e67 6c65 2920 666f 7220 706f 696e   angle) for poin
-00023f20: 7420 696e 2073 656c 662e 706f 696e 7473  t in self.points
-00023f30: 5d29 0a0a 2020 2020 6465 6620 726f 7461  ])..    def rota
-00023f40: 7469 6f6e 5f69 6e70 6c61 6365 2873 656c  tion_inplace(sel
-00023f50: 662c 2063 656e 7465 723a 2076 6f6c 6d64  f, center: volmd
-00023f60: 6c72 2e50 6f69 6e74 3344 2c0a 2020 2020  lr.Point3D,.    
-00023f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023f80: 2020 2020 2061 7869 733a 2076 6f6c 6d64       axis: volmd
-00023f90: 6c72 2e56 6563 746f 7233 442c 2061 6e67  lr.Vector3D, ang
-00023fa0: 6c65 3a20 666c 6f61 7429 3a0a 2020 2020  le: float):.    
-00023fb0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00023fc0: 4c69 6e65 3244 2072 6f74 6174 696f 6e2e  Line2D rotation.
-00023fd0: 204f 626a 6563 7420 6973 2075 7064 6174   Object is updat
-00023fe0: 6564 2069 6e70 6c61 6365 2e0a 0a20 2020  ed inplace...   
-00023ff0: 2020 2020 203a 7061 7261 6d20 6365 6e74       :param cent
-00024000: 6572 3a20 726f 7461 7469 6f6e 2063 656e  er: rotation cen
-00024010: 7465 720a 2020 2020 2020 2020 3a70 6172  ter.        :par
-00024020: 616d 2061 7869 733a 2072 6f74 6174 696f  am axis: rotatio
-00024030: 6e20 6178 6973 0a20 2020 2020 2020 203a  n axis.        :
-00024040: 7061 7261 6d20 616e 676c 653a 2072 6f74  param angle: rot
-00024050: 6174 696f 6e20 616e 676c 650a 2020 2020  ation angle.    
-00024060: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00024070: 7761 726e 696e 6773 2e77 6172 6e28 2227  warnings.warn("'
-00024080: 696e 706c 6163 6527 206d 6574 686f 6473  inplace' methods
-00024090: 2061 7265 2064 6570 7265 6361 7465 642e   are deprecated.
-000240a0: 2055 7365 2061 206e 6f74 2069 6e70 6c61   Use a not inpla
-000240b0: 6365 206d 6574 686f 6420 696e 7374 6561  ce method instea
-000240c0: 642e 222c 2044 6570 7265 6361 7469 6f6e  d.", Deprecation
-000240d0: 5761 726e 696e 6729 0a0a 2020 2020 2020  Warning)..      
-000240e0: 2020 666f 7220 706f 696e 7420 696e 2073    for point in s
-000240f0: 656c 662e 706f 696e 7473 3a0a 2020 2020  elf.points:.    
-00024100: 2020 2020 2020 2020 706f 696e 742e 726f          point.ro
-00024110: 7461 7469 6f6e 5f69 6e70 6c61 6365 2863  tation_inplace(c
-00024120: 656e 7465 722c 2061 7869 732c 2061 6e67  enter, axis, ang
-00024130: 6c65 290a 2020 2020 2020 2020 7365 6c66  le).        self
-00024140: 2e5f 6262 6f78 203d 204e 6f6e 650a 0a20  ._bbox = None.. 
-00024150: 2020 2064 6566 205f 5f63 6f6e 7461 696e     def __contain
-00024160: 735f 5f28 7365 6c66 2c20 706f 696e 7429  s__(self, point)
-00024170: 3a0a 0a20 2020 2020 2020 2070 6f69 6e74  :..        point
-00024180: 312c 2070 6f69 6e74 3220 3d20 7365 6c66  1, point2 = self
-00024190: 2e73 7461 7274 2c20 7365 6c66 2e65 6e64  .start, self.end
-000241a0: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
-000241b0: 706f 696e 7432 202d 2070 6f69 6e74 310a  point2 - point1.
-000241c0: 2020 2020 2020 2020 7465 7374 203d 2070          test = p
-000241d0: 6f69 6e74 2e72 6f74 6174 696f 6e28 706f  oint.rotation(po
-000241e0: 696e 7431 2c20 6178 6973 2c20 6d61 7468  int1, axis, math
-000241f0: 2e70 6929 0a20 2020 2020 2020 2069 6620  .pi).        if 
-00024200: 7465 7374 203d 3d20 706f 696e 743a 0a20  test == point:. 
-00024210: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00024220: 6e20 5472 7565 0a0a 2020 2020 2020 2020  n True..        
-00024230: 7265 7475 726e 2046 616c 7365 0a0a 2020  return False..  
-00024240: 2020 6465 6620 7472 616e 736c 6174 696f    def translatio
-00024250: 6e28 7365 6c66 2c20 6f66 6673 6574 3a20  n(self, offset: 
-00024260: 766f 6c6d 646c 722e 5665 6374 6f72 3344  volmdlr.Vector3D
-00024270: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00024280: 2020 2020 2020 204c 696e 6553 6567 6d65         LineSegme
-00024290: 6e74 3344 2074 7261 6e73 6c61 7469 6f6e  nt3D translation
-000242a0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-000242b0: 6d20 6f66 6673 6574 3a20 7472 616e 736c  m offset: transl
-000242c0: 6174 696f 6e20 7665 6374 6f72 0a20 2020  ation vector.   
-000242d0: 2020 2020 203a 7265 7475 726e 3a20 4120       :return: A 
-000242e0: 6e65 7720 7472 616e 736c 6174 6564 204c  new translated L
-000242f0: 696e 6553 6567 6d65 6e74 3344 0a20 2020  ineSegment3D.   
-00024300: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00024310: 2072 6574 7572 6e20 4c69 6e65 5365 676d   return LineSegm
-00024320: 656e 7433 4428 0a20 2020 2020 2020 2020  ent3D(.         
-00024330: 2020 202a 5b70 6f69 6e74 2e74 7261 6e73     *[point.trans
-00024340: 6c61 7469 6f6e 286f 6666 7365 7429 2066  lation(offset) f
-00024350: 6f72 2070 6f69 6e74 2069 6e20 7365 6c66  or point in self
-00024360: 2e70 6f69 6e74 735d 290a 0a20 2020 2064  .points])..    d
-00024370: 6566 2074 7261 6e73 6c61 7469 6f6e 5f69  ef translation_i
-00024380: 6e70 6c61 6365 2873 656c 662c 206f 6666  nplace(self, off
-00024390: 7365 743a 2076 6f6c 6d64 6c72 2e56 6563  set: volmdlr.Vec
-000243a0: 746f 7233 4429 3a0a 2020 2020 2020 2020  tor3D):.        
-000243b0: 2222 220a 2020 2020 2020 2020 4c69 6e65  """.        Line
-000243c0: 5365 676d 656e 7433 4420 7472 616e 736c  Segment3D transl
-000243d0: 6174 696f 6e2e 204f 626a 6563 7420 6973  ation. Object is
-000243e0: 2075 7064 6174 6564 2069 6e70 6c61 6365   updated inplace
-000243f0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00024400: 6d20 6f66 6673 6574 3a20 7472 616e 736c  m offset: transl
-00024410: 6174 696f 6e20 7665 6374 6f72 0a20 2020  ation vector.   
-00024420: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00024430: 2077 6172 6e69 6e67 732e 7761 726e 2822   warnings.warn("
-00024440: 2769 6e70 6c61 6365 2720 6d65 7468 6f64  'inplace' method
-00024450: 7320 6172 6520 6465 7072 6563 6174 6564  s are deprecated
-00024460: 2e20 5573 6520 6120 6e6f 7420 696e 706c  . Use a not inpl
-00024470: 6163 6520 6d65 7468 6f64 2069 6e73 7465  ace method inste
-00024480: 6164 2e22 2c20 4465 7072 6563 6174 696f  ad.", Deprecatio
-00024490: 6e57 6172 6e69 6e67 290a 0a20 2020 2020  nWarning)..     
-000244a0: 2020 2066 6f72 2070 6f69 6e74 2069 6e20     for point in 
-000244b0: 7365 6c66 2e70 6f69 6e74 733a 0a20 2020  self.points:.   
-000244c0: 2020 2020 2020 2020 2070 6f69 6e74 2e74           point.t
-000244d0: 7261 6e73 6c61 7469 6f6e 5f69 6e70 6c61  ranslation_inpla
-000244e0: 6365 286f 6666 7365 7429 0a20 2020 2020  ce(offset).     
-000244f0: 2020 2073 656c 662e 5f62 626f 7820 3d20     self._bbox = 
-00024500: 4e6f 6e65 0a0a 2020 2020 6465 6620 6672  None..    def fr
-00024510: 616d 655f 6d61 7070 696e 6728 7365 6c66  ame_mapping(self
-00024520: 2c20 6672 616d 653a 2076 6f6c 6d64 6c72  , frame: volmdlr
-00024530: 2e46 7261 6d65 3344 2c20 7369 6465 3a20  .Frame3D, side: 
-00024540: 7374 7229 3a0a 2020 2020 2020 2020 2222  str):.        ""
-00024550: 220a 2020 2020 2020 2020 4368 616e 6765  ".        Change
-00024560: 7320 4c69 6e65 5365 676d 656e 7433 4420  s LineSegment3D 
-00024570: 6672 616d 655f 6d61 7070 696e 6720 616e  frame_mapping an
-00024580: 6420 7265 7475 726e 2061 206e 6577 204c  d return a new L
-00024590: 696e 6553 6567 6d65 6e74 3344 2e0a 0a20  ineSegment3D... 
-000245a0: 2020 2020 2020 2073 6964 6520 3d20 276f         side = 'o
-000245b0: 6c64 2720 6f72 2027 6e65 7727 0a20 2020  ld' or 'new'.   
-000245c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000245d0: 2069 6620 7369 6465 203d 3d20 276f 6c64   if side == 'old
-000245e0: 273a 0a20 2020 2020 2020 2020 2020 2072  ':.            r
-000245f0: 6574 7572 6e20 4c69 6e65 5365 676d 656e  eturn LineSegmen
-00024600: 7433 4428 0a20 2020 2020 2020 2020 2020  t3D(.           
-00024610: 2020 2020 202a 5b66 7261 6d65 2e6c 6f63       *[frame.loc
-00024620: 616c 5f74 6f5f 676c 6f62 616c 5f63 6f6f  al_to_global_coo
-00024630: 7264 696e 6174 6573 2870 6f69 6e74 2920  rdinates(point) 
-00024640: 666f 7220 706f 696e 7420 696e 205b 7365  for point in [se
-00024650: 6c66 2e73 7461 7274 2c20 7365 6c66 2e65  lf.start, self.e
-00024660: 6e64 5d5d 290a 2020 2020 2020 2020 6966  nd]]).        if
-00024670: 2073 6964 6520 3d3d 2027 6e65 7727 3a0a   side == 'new':.
-00024680: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00024690: 726e 204c 696e 6553 6567 6d65 6e74 3344  rn LineSegment3D
-000246a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000246b0: 2020 2a5b 6672 616d 652e 676c 6f62 616c    *[frame.global
-000246c0: 5f74 6f5f 6c6f 6361 6c5f 636f 6f72 6469  _to_local_coordi
-000246d0: 6e61 7465 7328 706f 696e 7429 2066 6f72  nates(point) for
-000246e0: 2070 6f69 6e74 2069 6e20 5b73 656c 662e   point in [self.
-000246f0: 7374 6172 742c 2073 656c 662e 656e 645d  start, self.end]
-00024700: 5d29 0a20 2020 2020 2020 2072 6169 7365  ]).        raise
-00024710: 2056 616c 7565 4572 726f 7228 2750 6c65   ValueError('Ple
-00024720: 6173 6520 456e 7465 7220 6120 7661 6c69  ase Enter a vali
-00024730: 6420 7369 6465 3a20 6f6c 6420 6f72 206e  d side: old or n
-00024740: 6577 2729 0a0a 2020 2020 6465 6620 6672  ew')..    def fr
-00024750: 616d 655f 6d61 7070 696e 675f 696e 706c  ame_mapping_inpl
-00024760: 6163 6528 7365 6c66 2c20 6672 616d 653a  ace(self, frame:
-00024770: 2076 6f6c 6d64 6c72 2e46 7261 6d65 3344   volmdlr.Frame3D
-00024780: 2c20 7369 6465 3a20 7374 7229 3a0a 2020  , side: str):.  
-00024790: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000247a0: 2020 4368 616e 6765 7320 7665 6374 6f72    Changes vector
-000247b0: 2066 7261 6d65 5f6d 6170 7069 6e67 2061   frame_mapping a
-000247c0: 6e64 2074 6865 206f 626a 6563 7420 6973  nd the object is
-000247d0: 2075 7064 6174 6564 2069 6e70 6c61 6365   updated inplace
-000247e0: 2e0a 0a20 2020 2020 2020 2073 6964 6520  ...        side 
-000247f0: 3d20 276f 6c64 2720 6f72 2027 6e65 7727  = 'old' or 'new'
-00024800: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00024810: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00024820: 726e 2822 2769 6e70 6c61 6365 2720 6d65  rn("'inplace' me
-00024830: 7468 6f64 7320 6172 6520 6465 7072 6563  thods are deprec
-00024840: 6174 6564 2e20 5573 6520 6120 6e6f 7420  ated. Use a not 
-00024850: 696e 706c 6163 6520 6d65 7468 6f64 2069  inplace method i
-00024860: 6e73 7465 6164 2e22 2c20 4465 7072 6563  nstead.", Deprec
-00024870: 6174 696f 6e57 6172 6e69 6e67 290a 0a20  ationWarning).. 
-00024880: 2020 2020 2020 2069 6620 7369 6465 203d         if side =
-00024890: 3d20 276f 6c64 273a 0a20 2020 2020 2020  = 'old':.       
-000248a0: 2020 2020 206e 6577 5f73 7461 7274 203d       new_start =
-000248b0: 2066 7261 6d65 2e6c 6f63 616c 5f74 6f5f   frame.local_to_
-000248c0: 676c 6f62 616c 5f63 6f6f 7264 696e 6174  global_coordinat
-000248d0: 6573 2873 656c 662e 7374 6172 7429 0a20  es(self.start). 
-000248e0: 2020 2020 2020 2020 2020 206e 6577 5f65             new_e
-000248f0: 6e64 203d 2066 7261 6d65 2e6c 6f63 616c  nd = frame.local
-00024900: 5f74 6f5f 676c 6f62 616c 5f63 6f6f 7264  _to_global_coord
-00024910: 696e 6174 6573 2873 656c 662e 656e 6429  inates(self.end)
-00024920: 0a20 2020 2020 2020 2065 6c69 6620 7369  .        elif si
-00024930: 6465 203d 3d20 276e 6577 273a 0a20 2020  de == 'new':.   
-00024940: 2020 2020 2020 2020 206e 6577 5f73 7461           new_sta
-00024950: 7274 203d 2066 7261 6d65 2e67 6c6f 6261  rt = frame.globa
-00024960: 6c5f 746f 5f6c 6f63 616c 5f63 6f6f 7264  l_to_local_coord
-00024970: 696e 6174 6573 2873 656c 662e 7374 6172  inates(self.star
-00024980: 7429 0a20 2020 2020 2020 2020 2020 206e  t).            n
-00024990: 6577 5f65 6e64 203d 2066 7261 6d65 2e67  ew_end = frame.g
-000249a0: 6c6f 6261 6c5f 746f 5f6c 6f63 616c 5f63  lobal_to_local_c
-000249b0: 6f6f 7264 696e 6174 6573 2873 656c 662e  oordinates(self.
-000249c0: 656e 6429 0a20 2020 2020 2020 2065 6c73  end).        els
-000249d0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-000249e0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-000249f0: 2750 6c65 6173 6520 456e 7465 7220 6120  'Please Enter a 
-00024a00: 7661 6c69 6420 7369 6465 3a20 6f6c 6420  valid side: old 
-00024a10: 6f72 206e 6577 2729 0a20 2020 2020 2020  or new').       
-00024a20: 2073 656c 662e 7374 6172 7420 3d20 6e65   self.start = ne
-00024a30: 775f 7374 6172 740a 2020 2020 2020 2020  w_start.        
-00024a40: 7365 6c66 2e65 6e64 203d 206e 6577 5f65  self.end = new_e
-00024a50: 6e64 0a20 2020 2020 2020 2073 656c 662e  nd.        self.
-00024a60: 5f62 626f 7820 3d20 4e6f 6e65 0a0a 2020  _bbox = None..  
-00024a70: 2020 6465 6620 636f 7079 2873 656c 662c    def copy(self,
-00024a80: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00024a90: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00024aa0: 6e20 4c69 6e65 5365 676d 656e 7433 4428  n LineSegment3D(
-00024ab0: 7365 6c66 2e73 7461 7274 2e63 6f70 7928  self.start.copy(
-00024ac0: 292c 2073 656c 662e 656e 642e 636f 7079  ), self.end.copy
-00024ad0: 2829 290a 0a20 2020 2064 6566 2070 6c6f  ())..    def plo
-00024ae0: 7428 7365 6c66 2c20 6178 3d4e 6f6e 652c  t(self, ax=None,
-00024af0: 2063 6f6c 6f72 3d27 6b27 2c20 616c 7068   color='k', alph
-00024b00: 613d 312c 0a20 2020 2020 2020 2020 2020  a=1,.           
-00024b10: 2020 6564 6765 5f65 6e64 733d 4661 6c73    edge_ends=Fals
-00024b20: 652c 2065 6467 655f 6469 7265 6374 696f  e, edge_directio
-00024b30: 6e3d 4661 6c73 6529 3a0a 2020 2020 2020  n=False):.      
-00024b40: 2020 6966 2061 7820 6973 204e 6f6e 653a    if ax is None:
-00024b50: 0a20 2020 2020 2020 2020 2020 2066 6967  .            fig
-00024b60: 203d 2070 6c74 2e66 6967 7572 6528 290a   = plt.figure().
-00024b70: 2020 2020 2020 2020 2020 2020 6178 203d              ax =
-00024b80: 2066 6967 2e61 6464 5f73 7562 706c 6f74   fig.add_subplot
-00024b90: 2831 3131 2c20 7072 6f6a 6563 7469 6f6e  (111, projection
-00024ba0: 3d27 3364 2729 0a20 2020 2020 2020 2065  ='3d').        e
-00024bb0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00024bc0: 2066 6967 203d 2061 782e 6669 6775 7265   fig = ax.figure
-00024bd0: 0a0a 2020 2020 2020 2020 706f 696e 7473  ..        points
-00024be0: 203d 205b 7365 6c66 2e73 7461 7274 2c20   = [self.start, 
-00024bf0: 7365 6c66 2e65 6e64 5d0a 2020 2020 2020  self.end].      
-00024c00: 2020 7820 3d20 5b70 2e78 2066 6f72 2070    x = [p.x for p
-00024c10: 2069 6e20 706f 696e 7473 5d0a 2020 2020   in points].    
-00024c20: 2020 2020 7920 3d20 5b70 2e79 2066 6f72      y = [p.y for
-00024c30: 2070 2069 6e20 706f 696e 7473 5d0a 2020   p in points].  
-00024c40: 2020 2020 2020 7a20 3d20 5b70 2e7a 2066        z = [p.z f
-00024c50: 6f72 2070 2069 6e20 706f 696e 7473 5d0a  or p in points].
-00024c60: 2020 2020 2020 2020 6966 2065 6467 655f          if edge_
-00024c70: 656e 6473 3a0a 2020 2020 2020 2020 2020  ends:.          
-00024c80: 2020 6178 2e70 6c6f 7428 782c 2079 2c20    ax.plot(x, y, 
-00024c90: 7a2c 2063 6f6c 6f72 3d63 6f6c 6f72 2c20  z, color=color, 
-00024ca0: 616c 7068 613d 616c 7068 612c 206d 6172  alpha=alpha, mar
-00024cb0: 6b65 723d 276f 2729 0a20 2020 2020 2020  ker='o').       
-00024cc0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00024cd0: 2020 2061 782e 706c 6f74 2878 2c20 792c     ax.plot(x, y,
-00024ce0: 207a 2c20 636f 6c6f 723d 636f 6c6f 722c   z, color=color,
-00024cf0: 2061 6c70 6861 3d61 6c70 6861 290a 2020   alpha=alpha).  
-00024d00: 2020 2020 2020 6966 2065 6467 655f 6469        if edge_di
-00024d10: 7265 6374 696f 6e3a 0a20 2020 2020 2020  rection:.       
-00024d20: 2020 2020 2078 2c20 792c 207a 203d 2073       x, y, z = s
-00024d30: 656c 662e 706f 696e 745f 6174 5f61 6273  elf.point_at_abs
-00024d40: 6369 7373 6128 302e 3520 2a20 7365 6c66  cissa(0.5 * self
-00024d50: 2e6c 656e 6774 6828 2929 0a20 2020 2020  .length()).     
-00024d60: 2020 2020 2020 2075 2c20 762c 2077 203d         u, v, w =
-00024d70: 2030 2e30 3520 2a20 7365 6c66 2e64 6972   0.05 * self.dir
-00024d80: 6563 7469 6f6e 5f76 6563 746f 7228 290a  ection_vector().
-00024d90: 2020 2020 2020 2020 2020 2020 6178 2e71              ax.q
-00024da0: 7569 7665 7228 782c 2079 2c20 7a2c 2075  uiver(x, y, z, u
-00024db0: 2c20 762c 2077 2c20 6c65 6e67 7468 3d73  , v, w, length=s
-00024dc0: 656c 662e 6c65 6e67 7468 2829 202f 2031  elf.length() / 1
-00024dd0: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-00024de0: 2020 2020 2020 2020 2020 6172 726f 775f            arrow_
-00024df0: 6c65 6e67 7468 5f72 6174 696f 3d35 2c20  length_ratio=5, 
-00024e00: 6e6f 726d 616c 697a 653d 5472 7565 2c0a  normalize=True,.
-00024e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024e20: 2020 2020 2020 7069 766f 743d 2774 6970        pivot='tip
-00024e30: 272c 2063 6f6c 6f72 3d63 6f6c 6f72 290a  ', color=color).
-00024e40: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-00024e50: 780a 0a20 2020 2064 6566 2070 6c6f 7432  x..    def plot2
-00024e60: 6428 7365 6c66 2c20 785f 3344 2c20 795f  d(self, x_3D, y_
-00024e70: 3344 2c20 6178 3d4e 6f6e 652c 2063 6f6c  3D, ax=None, col
-00024e80: 6f72 3d27 6b27 2c20 7769 6474 683d 4e6f  or='k', width=No
-00024e90: 6e65 293a 0a20 2020 2020 2020 2069 6620  ne):.        if 
-00024ea0: 6178 2069 7320 4e6f 6e65 3a0a 2020 2020  ax is None:.    
-00024eb0: 2020 2020 2020 2020 6669 6720 3d20 706c          fig = pl
-00024ec0: 742e 6669 6775 7265 2829 0a20 2020 2020  t.figure().     
-00024ed0: 2020 2020 2020 2061 7820 3d20 6669 672e         ax = fig.
-00024ee0: 6164 645f 7375 6270 6c6f 7428 3131 312c  add_subplot(111,
-00024ef0: 2070 726f 6a65 6374 696f 6e3d 2733 6427   projection='3d'
-00024f00: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00024f10: 2020 2020 2020 2020 2020 2020 6669 6720              fig 
-00024f20: 3d20 6178 2e66 6967 7572 650a 0a20 2020  = ax.figure..   
-00024f30: 2020 2020 2065 6467 6532 4420 3d20 7365       edge2D = se
-00024f40: 6c66 2e70 6c61 6e65 5f70 726f 6a65 6374  lf.plane_project
-00024f50: 696f 6e32 6428 766f 6c6d 646c 722e 4f33  ion2d(volmdlr.O3
-00024f60: 442c 2078 5f33 442c 2079 5f33 4429 0a20  D, x_3D, y_3D). 
-00024f70: 2020 2020 2020 2065 6467 6532 442e 706c         edge2D.pl
-00024f80: 6f74 2861 783d 6178 2c20 636f 6c6f 723d  ot(ax=ax, color=
-00024f90: 636f 6c6f 722c 2077 6964 7468 3d77 6964  color, width=wid
-00024fa0: 7468 290a 2020 2020 2020 2020 7265 7475  th).        retu
-00024fb0: 726e 2061 780a 0a20 2020 2064 6566 2070  rn ax..    def p
-00024fc0: 6c6f 745f 6461 7461 2873 656c 662c 2078  lot_data(self, x
-00024fd0: 5f33 442c 2079 5f33 442c 206d 6172 6b65  _3D, y_3D, marke
-00024fe0: 723d 4e6f 6e65 2c20 636f 6c6f 723d 2762  r=None, color='b
-00024ff0: 6c61 636b 272c 2073 7472 6f6b 655f 7769  lack', stroke_wi
-00025000: 6474 683d 312c 0a20 2020 2020 2020 2020  dth=1,.         
-00025010: 2020 2020 2020 2020 2064 6173 683d 4661           dash=Fa
-00025020: 6c73 652c 206f 7061 6369 7479 3d31 2c20  lse, opacity=1, 
-00025030: 6172 726f 773d 4661 6c73 6529 3a0a 2020  arrow=False):.  
-00025040: 2020 2020 2020 6564 6765 3244 203d 2073        edge2D = s
-00025050: 656c 662e 706c 616e 655f 7072 6f6a 6563  elf.plane_projec
-00025060: 7469 6f6e 3264 2876 6f6c 6d64 6c72 2e4f  tion2d(volmdlr.O
-00025070: 3344 2c20 785f 3344 2c20 795f 3344 290a  3D, x_3D, y_3D).
-00025080: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-00025090: 6467 6532 442e 706c 6f74 5f64 6174 6128  dge2D.plot_data(
-000250a0: 6d61 726b 6572 2c20 636f 6c6f 722c 2073  marker, color, s
-000250b0: 7472 6f6b 655f 7769 6474 682c 0a20 2020  troke_width,.   
-000250c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000250d0: 2020 2020 2020 2020 2020 2020 2064 6173               das
-000250e0: 682c 206f 7061 6369 7479 2c20 6172 726f  h, opacity, arro
-000250f0: 7729 0a0a 2020 2020 6465 6620 746f 5f6c  w)..    def to_l
-00025100: 696e 6528 7365 6c66 293a 0a20 2020 2020  ine(self):.     
-00025110: 2020 2072 6574 7572 6e20 4c69 6e65 3344     return Line3D
-00025120: 2873 656c 662e 7374 6172 742c 2073 656c  (self.start, sel
-00025130: 662e 656e 6429 0a0a 2020 2020 6465 6620  f.end)..    def 
-00025140: 746f 5f32 6428 7365 6c66 2c20 706c 616e  to_2d(self, plan
-00025150: 655f 6f72 6967 696e 2c20 782c 2079 293a  e_origin, x, y):
-00025160: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00025170: 2020 2020 2054 7261 6e73 666f 726d 7320       Transforms 
-00025180: 6120 4c69 6e65 5365 676d 656e 7433 4420  a LineSegment3D 
-00025190: 696e 746f 2061 6e20 4c69 6e65 5365 676d  into an LineSegm
-000251a0: 656e 7432 442c 2067 6976 656e 2061 6e20  ent2D, given an 
-000251b0: 706c 616e 6520 6f72 6967 696e 2061 6e64  plane origin and
-000251c0: 2061 2075 2061 6e64 2076 2070 6c61 6e65   a u and v plane
-000251d0: 2076 6563 746f 722e 0a0a 2020 2020 2020   vector...      
-000251e0: 2020 3a70 6172 616d 2070 6c61 6e65 5f6f    :param plane_o
-000251f0: 7269 6769 6e3a 2070 6c61 6e65 206f 7269  rigin: plane ori
-00025200: 6769 6e2e 0a20 2020 2020 2020 203a 7061  gin..        :pa
-00025210: 7261 6d20 783a 2070 6c61 6e65 2075 2076  ram x: plane u v
-00025220: 6563 746f 722e 0a20 2020 2020 2020 203a  ector..        :
-00025230: 7061 7261 6d20 793a 2070 6c61 6e65 2076  param y: plane v
-00025240: 2076 6563 746f 722e 0a20 2020 2020 2020   vector..       
-00025250: 203a 7265 7475 726e 3a20 4c69 6e65 5365   :return: LineSe
-00025260: 676d 656e 7432 442e 0a20 2020 2020 2020  gment2D..       
-00025270: 2022 2222 0a20 2020 2020 2020 2070 3264   """.        p2d
-00025280: 203d 205b 702e 746f 5f32 6428 706c 616e   = [p.to_2d(plan
-00025290: 655f 6f72 6967 696e 2c20 782c 2079 2920  e_origin, x, y) 
-000252a0: 666f 7220 7020 696e 2028 7365 6c66 2e73  for p in (self.s
-000252b0: 7461 7274 2c20 7365 6c66 2e65 6e64 295d  tart, self.end)]
-000252c0: 0a20 2020 2020 2020 2069 6620 7032 645b  .        if p2d[
-000252d0: 305d 203d 3d20 7032 645b 315d 3a0a 2020  0] == p2d[1]:.  
-000252e0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000252f0: 204e 6f6e 650a 2020 2020 2020 2020 7265   None.        re
-00025300: 7475 726e 204c 696e 6553 6567 6d65 6e74  turn LineSegment
-00025310: 3244 282a 7032 642c 206e 616d 653d 7365  2D(*p2d, name=se
-00025320: 6c66 2e6e 616d 6529 0a0a 2020 2020 6465  lf.name)..    de
-00025330: 6620 746f 5f62 7370 6c69 6e65 5f63 7572  f to_bspline_cur
-00025340: 7665 2873 656c 662c 2072 6573 6f6c 7574  ve(self, resolut
-00025350: 696f 6e3d 3130 293a 0a20 2020 2020 2020  ion=10):.       
-00025360: 2022 2222 0a20 2020 2020 2020 2043 6f6e   """.        Con
-00025370: 7665 7274 2061 204c 696e 6553 6567 6d65  vert a LineSegme
-00025380: 6e74 3344 2074 6f20 6120 4253 706c 696e  nt3D to a BSplin
-00025390: 6543 7572 7665 3344 2e0a 2020 2020 2020  eCurve3D..      
-000253a0: 2020 2222 220a 2020 2020 2020 2020 6465    """.        de
-000253b0: 6772 6565 203d 2031 0a20 2020 2020 2020  gree = 1.       
-000253c0: 2070 6f69 6e74 7320 3d20 5b73 656c 662e   points = [self.
-000253d0: 706f 696e 745f 6174 5f61 6273 6369 7373  point_at_absciss
-000253e0: 6128 6162 7363 6973 7361 202f 2073 656c  a(abscissa / sel
-000253f0: 662e 6c65 6e67 7468 2829 290a 2020 2020  f.length()).    
-00025400: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00025410: 7220 6162 7363 6973 7361 2069 6e20 7261  r abscissa in ra
-00025420: 6e67 6528 7265 736f 6c75 7469 6f6e 202b  nge(resolution +
-00025430: 2031 295d 0a20 2020 2020 2020 2062 7370   1)].        bsp
-00025440: 6c69 6e65 5f63 7572 7665 203d 2042 5370  line_curve = BSp
-00025450: 6c69 6e65 4375 7276 6533 442e 6672 6f6d  lineCurve3D.from
-00025460: 5f70 6f69 6e74 735f 696e 7465 7270 6f6c  _points_interpol
-00025470: 6174 696f 6e28 706f 696e 7473 2c0a 2020  ation(points,.  
-00025480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000254a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000254b0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000254c0: 6567 7265 6529 0a20 2020 2020 2020 2072  egree).        r
-000254d0: 6574 7572 6e20 6273 706c 696e 655f 6375  eturn bspline_cu
-000254e0: 7276 650a 0a20 2020 2064 6566 2072 6576  rve..    def rev
-000254f0: 6572 7365 2873 656c 6629 3a0a 2020 2020  erse(self):.    
-00025500: 2020 2020 7265 7475 726e 204c 696e 6553      return LineS
-00025510: 6567 6d65 6e74 3344 2873 656c 662e 656e  egment3D(self.en
-00025520: 642e 636f 7079 2829 2c20 7365 6c66 2e73  d.copy(), self.s
-00025530: 7461 7274 2e63 6f70 7928 2929 0a0a 2020  tart.copy())..  
-00025540: 2020 6465 6620 6d69 6e69 6d75 6d5f 6469    def minimum_di
-00025550: 7374 616e 6365 5f70 6f69 6e74 7328 7365  stance_points(se
-00025560: 6c66 2c20 6f74 6865 725f 6c69 6e65 293a  lf, other_line):
-00025570: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00025580: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
-00025590: 2070 6f69 6e74 7320 6f6e 2074 6869 7320   points on this 
-000255a0: 6c69 6e65 2061 6e64 2074 6865 206f 7468  line and the oth
-000255b0: 6572 206c 696e 6520 7468 6174 2061 7265  er line that are
-000255c0: 2074 6865 2063 6c6f 7365 7374 206f 6620   the closest of 
-000255d0: 6c69 6e65 732e 0a20 2020 2020 2020 2022  lines..        "
-000255e0: 2222 0a20 2020 2020 2020 2075 203d 2073  "".        u = s
-000255f0: 656c 662e 656e 6420 2d20 7365 6c66 2e73  elf.end - self.s
-00025600: 7461 7274 0a20 2020 2020 2020 2076 203d  tart.        v =
-00025610: 206f 7468 6572 5f6c 696e 652e 656e 6420   other_line.end 
-00025620: 2d20 6f74 6865 725f 6c69 6e65 2e73 7461  - other_line.sta
-00025630: 7274 0a20 2020 2020 2020 2077 203d 2073  rt.        w = s
-00025640: 656c 662e 7374 6172 7420 2d20 6f74 6865  elf.start - othe
-00025650: 725f 6c69 6e65 2e73 7461 7274 0a20 2020  r_line.start.   
-00025660: 2020 2020 2061 203d 2075 2e64 6f74 2875       a = u.dot(u
-00025670: 290a 2020 2020 2020 2020 6220 3d20 752e  ).        b = u.
-00025680: 646f 7428 7629 0a20 2020 2020 2020 2063  dot(v).        c
-00025690: 203d 2076 2e64 6f74 2876 290a 2020 2020   = v.dot(v).    
-000256a0: 2020 2020 6420 3d20 752e 646f 7428 7729      d = u.dot(w)
-000256b0: 0a20 2020 2020 2020 2065 203d 2076 2e64  .        e = v.d
-000256c0: 6f74 2877 290a 2020 2020 2020 2020 6966  ot(w).        if
-000256d0: 2028 6120 2a20 6320 2d20 6220 2a2a 2032   (a * c - b ** 2
-000256e0: 2920 213d 2030 3a0a 2020 2020 2020 2020  ) != 0:.        
-000256f0: 2020 2020 7320 3d20 2862 202a 2065 202d      s = (b * e -
-00025700: 2063 202a 2064 2920 2f20 2861 202a 2063   c * d) / (a * c
-00025710: 202d 2062 202a 2a20 3229 0a20 2020 2020   - b ** 2).     
-00025720: 2020 2020 2020 2074 203d 2028 6120 2a20         t = (a * 
-00025730: 6520 2d20 6220 2a20 6429 202f 2028 6120  e - b * d) / (a 
-00025740: 2a20 6320 2d20 6220 2a2a 2032 290a 2020  * c - b ** 2).  
-00025750: 2020 2020 2020 2020 2020 7031 203d 2073            p1 = s
-00025760: 656c 662e 7374 6172 7420 2b20 7320 2a20  elf.start + s * 
-00025770: 750a 2020 2020 2020 2020 2020 2020 7032  u.            p2
-00025780: 203d 206f 7468 6572 5f6c 696e 652e 7374   = other_line.st
-00025790: 6172 7420 2b20 7420 2a20 760a 2020 2020  art + t * v.    
-000257a0: 2020 2020 2020 2020 7265 7475 726e 2070          return p
-000257b0: 312c 2070 320a 2020 2020 2020 2020 7265  1, p2.        re
-000257c0: 7475 726e 2073 656c 662e 7374 6172 742c  turn self.start,
-000257d0: 206f 7468 6572 5f6c 696e 652e 7374 6172   other_line.star
-000257e0: 740a 0a20 2020 2064 6566 206d 6174 7269  t..    def matri
-000257f0: 785f 6469 7374 616e 6365 2873 656c 662c  x_distance(self,
-00025800: 206f 7468 6572 5f6c 696e 6529 3a0a 2020   other_line):.  
-00025810: 2020 2020 2020 7520 3d20 7365 6c66 2e64        u = self.d
-00025820: 6972 6563 7469 6f6e 5f76 6563 746f 7228  irection_vector(
-00025830: 290a 2020 2020 2020 2020 7620 3d20 6f74  ).        v = ot
-00025840: 6865 725f 6c69 6e65 2e64 6972 6563 7469  her_line.directi
-00025850: 6f6e 5f76 6563 746f 7228 290a 2020 2020  on_vector().    
-00025860: 2020 2020 7720 3d20 6f74 6865 725f 6c69      w = other_li
-00025870: 6e65 2e73 7461 7274 202d 2073 656c 662e  ne.start - self.
-00025880: 7374 6172 740a 0a20 2020 2020 2020 2061  start..        a
-00025890: 3131 203d 2075 2e64 6f74 2875 290a 2020  11 = u.dot(u).  
-000258a0: 2020 2020 2020 6131 3220 3d20 2d75 2e64        a12 = -u.d
-000258b0: 6f74 2876 290a 2020 2020 2020 2020 6132  ot(v).        a2
-000258c0: 3220 3d20 762e 646f 7428 7629 0a0a 2020  2 = v.dot(v)..  
-000258d0: 2020 2020 2020 4120 3d20 6e70 792e 6172        A = npy.ar
-000258e0: 7261 7928 5b5b 6131 312c 2061 3132 5d2c  ray([[a11, a12],
-000258f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025900: 2020 2020 2020 2020 5b61 3132 2c20 6132          [a12, a2
-00025910: 325d 5d29 0a20 2020 2020 2020 2042 203d  2]]).        B =
-00025920: 206e 7079 2e61 7272 6179 285b 772e 646f   npy.array([w.do
-00025930: 7428 7529 2c20 2d77 2e64 6f74 2876 295d  t(u), -w.dot(v)]
-00025940: 290a 0a20 2020 2020 2020 2072 6573 203d  )..        res =
-00025950: 2073 6370 2e6f 7074 696d 697a 652e 6c73   scp.optimize.ls
-00025960: 715f 6c69 6e65 6172 2841 2c20 422c 2062  q_linear(A, B, b
-00025970: 6f75 6e64 733d 2830 2c20 3129 290a 2020  ounds=(0, 1)).  
-00025980: 2020 2020 2020 7031 203d 2073 656c 662e        p1 = self.
-00025990: 706f 696e 745f 6174 5f61 6273 6369 7373  point_at_absciss
-000259a0: 6128 7265 732e 785b 305d 202a 2073 656c  a(res.x[0] * sel
-000259b0: 662e 6c65 6e67 7468 2829 290a 2020 2020  f.length()).    
-000259c0: 2020 2020 7032 203d 206f 7468 6572 5f6c      p2 = other_l
-000259d0: 696e 652e 706f 696e 745f 6174 5f61 6273  ine.point_at_abs
-000259e0: 6369 7373 6128 0a20 2020 2020 2020 2020  cissa(.         
-000259f0: 2020 2072 6573 2e78 5b31 5d20 2a20 6f74     res.x[1] * ot
-00025a00: 6865 725f 6c69 6e65 2e6c 656e 6774 6828  her_line.length(
-00025a10: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
-00025a20: 6e20 7031 2c20 7032 0a0a 2020 2020 6465  n p1, p2..    de
-00025a30: 6620 7061 7261 6c6c 656c 5f64 6973 7461  f parallel_dista
-00025a40: 6e63 6528 7365 6c66 2c20 6f74 6865 725f  nce(self, other_
-00025a50: 6c69 6e65 7365 676d 656e 7429 3a0a 2020  linesegment):.  
-00025a60: 2020 2020 2020 7074 5f61 2c20 7074 5f62        pt_a, pt_b
-00025a70: 2c20 7074 5f63 203d 2073 656c 662e 7374  , pt_c = self.st
-00025a80: 6172 742c 2073 656c 662e 656e 642c 206f  art, self.end, o
-00025a90: 7468 6572 5f6c 696e 6573 6567 6d65 6e74  ther_linesegment
-00025aa0: 2e73 7461 7274 0a20 2020 2020 2020 2076  .start.        v
-00025ab0: 6563 746f 7220 3d20 766f 6c6d 646c 722e  ector = volmdlr.
-00025ac0: 5665 6374 6f72 3344 2828 7074 5f61 202d  Vector3D((pt_a -
-00025ad0: 2070 745f 6229 2e76 6563 746f 7229 0a20   pt_b).vector). 
-00025ae0: 2020 2020 2020 2076 6563 746f 722e 6e6f         vector.no
-00025af0: 726d 616c 697a 6528 290a 2020 2020 2020  rmalize().      
-00025b00: 2020 706c 616e 6531 203d 2076 6f6c 6d64    plane1 = volmd
-00025b10: 6c72 2e66 6163 6573 2e50 6c61 6e65 3344  lr.faces.Plane3D
-00025b20: 2e66 726f 6d5f 335f 706f 696e 7473 2870  .from_3_points(p
-00025b30: 745f 612c 2070 745f 622c 2070 745f 6329  t_a, pt_b, pt_c)
-00025b40: 0a20 2020 2020 2020 2076 203d 2076 6563  .        v = vec
-00025b50: 746f 722e 6372 6f73 7328 706c 616e 6531  tor.cross(plane1
-00025b60: 2e66 7261 6d65 2e77 2920 2023 2064 6973  .frame.w)  # dis
-00025b70: 7461 6e63 6520 7665 6374 6f72 0a20 2020  tance vector.   
-00025b80: 2020 2020 2023 2070 745f 6120 3d20 6b2a       # pt_a = k*
-00025b90: 7520 2b20 632a 7620 2b20 7074 5f63 0a20  u + c*v + pt_c. 
-00025ba0: 2020 2020 2020 2072 6573 203d 2028 7074         res = (pt
-00025bb0: 5f61 202d 2070 745f 6329 2e76 6563 746f  _a - pt_c).vecto
-00025bc0: 720a 2020 2020 2020 2020 782c 2079 2c20  r.        x, y, 
-00025bd0: 7a20 3d20 7265 735b 305d 2c20 7265 735b  z = res[0], res[
-00025be0: 315d 2c20 7265 735b 325d 0a20 2020 2020  1], res[2].     
-00025bf0: 2020 2075 312c 2075 322c 2075 3320 3d20     u1, u2, u3 = 
-00025c00: 7665 6374 6f72 2e78 2c20 7665 6374 6f72  vector.x, vector
-00025c10: 2e79 2c20 7665 6374 6f72 2e7a 0a20 2020  .y, vector.z.   
-00025c20: 2020 2020 2076 312c 2076 322c 2076 3320       v1, v2, v3 
-00025c30: 3d20 762e 782c 2076 2e79 2c20 762e 7a0a  = v.x, v.y, v.z.
-00025c40: 0a20 2020 2020 2020 2069 6620 2875 3120  .        if (u1 
-00025c50: 2a20 7632 202d 2076 3120 2a20 7532 2920  * v2 - v1 * u2) 
-00025c60: 213d 2030 2061 6e64 2075 3120 213d 2030  != 0 and u1 != 0
-00025c70: 3a0a 2020 2020 2020 2020 2020 2020 6320  :.            c 
-00025c80: 3d20 2879 202a 2075 3120 2d20 7820 2a20  = (y * u1 - x * 
-00025c90: 7532 2920 2f20 2875 3120 2a20 7632 202d  u2) / (u1 * v2 -
-00025ca0: 2076 3120 2a20 7532 290a 2020 2020 2020   v1 * u2).      
-00025cb0: 2020 2020 2020 6b20 3d20 2878 202d 2063        k = (x - c
-00025cc0: 202a 2076 3129 202f 2075 310a 2020 2020   * v1) / u1.    
-00025cd0: 2020 2020 2020 2020 6966 206d 6174 682e          if math.
-00025ce0: 6973 636c 6f73 6528 6b20 2a20 7533 202b  isclose(k * u3 +
-00025cf0: 2063 202a 2076 332c 207a 2c20 6162 735f   c * v3, z, abs_
-00025d00: 746f 6c3d 3165 2d37 293a 0a20 2020 2020  tol=1e-7):.     
-00025d10: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00025d20: 6e20 6b0a 2020 2020 2020 2020 656c 6966  n k.        elif
-00025d30: 2028 7531 202a 2076 3320 2d20 7631 202a   (u1 * v3 - v1 *
-00025d40: 2075 3329 2021 3d20 3020 616e 6420 7531   u3) != 0 and u1
-00025d50: 2021 3d20 303a 0a20 2020 2020 2020 2020   != 0:.         
-00025d60: 2020 2063 203d 2028 7a20 2a20 7531 202d     c = (z * u1 -
-00025d70: 2078 202a 2075 3329 202f 2028 7531 202a   x * u3) / (u1 *
-00025d80: 2076 3320 2d20 7631 202a 2075 3329 0a20   v3 - v1 * u3). 
-00025d90: 2020 2020 2020 2020 2020 206b 203d 2028             k = (
-00025da0: 7820 2d20 6320 2a20 7631 2920 2f20 7531  x - c * v1) / u1
-00025db0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00025dc0: 6d61 7468 2e69 7363 6c6f 7365 286b 202a  math.isclose(k *
-00025dd0: 2075 3220 2b20 6320 2a20 7632 2c20 792c   u2 + c * v2, y,
-00025de0: 2061 6273 5f74 6f6c 3d31 652d 3729 3a0a   abs_tol=1e-7):.
-00025df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025e00: 7265 7475 726e 206b 0a20 2020 2020 2020  return k.       
-00025e10: 2065 6c69 6620 2876 3120 2a20 7532 202d   elif (v1 * u2 -
-00025e20: 2076 3220 2a20 7531 2920 213d 2030 2061   v2 * u1) != 0 a
-00025e30: 6e64 2075 3220 213d 2030 3a0a 2020 2020  nd u2 != 0:.    
-00025e40: 2020 2020 2020 2020 6320 3d20 2875 3220          c = (u2 
-00025e50: 2a20 7820 2d20 7920 2a20 7531 2920 2f20  * x - y * u1) / 
-00025e60: 2876 3120 2a20 7532 202d 2076 3220 2a20  (v1 * u2 - v2 * 
-00025e70: 7531 290a 2020 2020 2020 2020 2020 2020  u1).            
-00025e80: 6b20 3d20 2879 202d 2063 202a 2076 3229  k = (y - c * v2)
-00025e90: 202f 2075 320a 2020 2020 2020 2020 2020   / u2.          
-00025ea0: 2020 6966 206d 6174 682e 6973 636c 6f73    if math.isclos
-00025eb0: 6528 6b20 2a20 7533 202b 2063 202a 2076  e(k * u3 + c * v
-00025ec0: 332c 207a 2c20 6162 735f 746f 6c3d 3165  3, z, abs_tol=1e
-00025ed0: 2d37 293a 0a20 2020 2020 2020 2020 2020  -7):.           
-00025ee0: 2020 2020 2072 6574 7572 6e20 6b0a 2020       return k.  
-00025ef0: 2020 2020 2020 656c 6966 2028 7633 202a        elif (v3 *
-00025f00: 2075 3220 2d20 7632 202a 2075 3329 2021   u2 - v2 * u3) !
-00025f10: 3d20 3020 616e 6420 7532 2021 3d20 303a  = 0 and u2 != 0:
-00025f20: 0a20 2020 2020 2020 2020 2020 2063 203d  .            c =
-00025f30: 2028 7532 202a 207a 202d 2079 202a 2075   (u2 * z - y * u
-00025f40: 3329 202f 2028 7633 202a 2075 3220 2d20  3) / (v3 * u2 - 
-00025f50: 7632 202a 2075 3329 0a20 2020 2020 2020  v2 * u3).       
-00025f60: 2020 2020 206b 203d 2028 7920 2d20 6320       k = (y - c 
-00025f70: 2a20 7632 2920 2f20 7532 0a20 2020 2020  * v2) / u2.     
-00025f80: 2020 2020 2020 2069 6620 6d61 7468 2e69         if math.i
-00025f90: 7363 6c6f 7365 286b 202a 2075 3120 2b20  sclose(k * u1 + 
-00025fa0: 6320 2a20 7631 2c20 782c 2061 6273 5f74  c * v1, x, abs_t
-00025fb0: 6f6c 3d31 652d 3729 3a0a 2020 2020 2020  ol=1e-7):.      
-00025fc0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00025fd0: 206b 0a20 2020 2020 2020 2065 6c69 6620   k.        elif 
-00025fe0: 2875 3120 2a20 7633 202d 2076 3120 2a20  (u1 * v3 - v1 * 
-00025ff0: 7533 2920 213d 2030 2061 6e64 2075 3320  u3) != 0 and u3 
-00026000: 213d 2030 3a0a 2020 2020 2020 2020 2020  != 0:.          
-00026010: 2020 6320 3d20 287a 202a 2075 3120 2d20    c = (z * u1 - 
-00026020: 7820 2a20 7533 2920 2f20 2875 3120 2a20  x * u3) / (u1 * 
-00026030: 7633 202d 2076 3120 2a20 7533 290a 2020  v3 - v1 * u3).  
-00026040: 2020 2020 2020 2020 2020 6b20 3d20 287a            k = (z
-00026050: 202d 2063 202a 2076 3329 202f 2075 330a   - c * v3) / u3.
-00026060: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-00026070: 6174 682e 6973 636c 6f73 6528 6b20 2a20  ath.isclose(k * 
-00026080: 7532 202b 2063 202a 2076 322c 2079 2c20  u2 + c * v2, y, 
-00026090: 6162 735f 746f 6c3d 3165 2d37 293a 0a20  abs_tol=1e-7):. 
-000260a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000260b0: 6574 7572 6e20 6b0a 2020 2020 2020 2020  eturn k.        
-000260c0: 656c 6966 2028 7532 202a 2076 3320 2d20  elif (u2 * v3 - 
-000260d0: 7632 202a 2075 3329 2021 3d20 3020 616e  v2 * u3) != 0 an
-000260e0: 6420 7533 2021 3d20 303a 0a20 2020 2020  d u3 != 0:.     
-000260f0: 2020 2020 2020 2063 203d 2028 7a20 2a20         c = (z * 
-00026100: 7532 202d 2079 202a 2075 3329 202f 2028  u2 - y * u3) / (
-00026110: 7532 202a 2076 3320 2d20 7632 202a 2075  u2 * v3 - v2 * u
-00026120: 3329 0a20 2020 2020 2020 2020 2020 206b  3).            k
-00026130: 203d 2028 7a20 2d20 6320 2a20 7633 2920   = (z - c * v3) 
-00026140: 2f20 7533 0a20 2020 2020 2020 2020 2020  / u3.           
-00026150: 2069 6620 6d61 7468 2e69 7363 6c6f 7365   if math.isclose
-00026160: 286b 202a 2075 3120 2b20 6320 2a20 7631  (k * u1 + c * v1
-00026170: 2c20 782c 2061 6273 5f74 6f6c 3d31 652d  , x, abs_tol=1e-
-00026180: 3729 3a0a 2020 2020 2020 2020 2020 2020  7):.            
-00026190: 2020 2020 7265 7475 726e 206b 0a20 2020      return k.   
-000261a0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-000261b0: 706c 656d 656e 7465 6445 7272 6f72 0a0a  plementedError..
-000261c0: 2020 2020 6465 6620 6d69 6e69 6d75 6d5f      def minimum_
-000261d0: 6469 7374 616e 6365 2873 656c 662c 2065  distance(self, e
-000261e0: 6c65 6d65 6e74 2c20 7265 7475 726e 5f70  lement, return_p
-000261f0: 6f69 6e74 733d 4661 6c73 6529 3a0a 2020  oints=False):.  
-00026200: 2020 2020 2020 6966 2065 6c65 6d65 6e74        if element
-00026210: 2e5f 5f63 6c61 7373 5f5f 2069 7320 4172  .__class__ is Ar
-00026220: 6333 4420 6f72 2065 6c65 6d65 6e74 2e5f  c3D or element._
-00026230: 5f63 6c61 7373 5f5f 2069 7320 766f 6c6d  _class__ is volm
-00026240: 646c 722e 7769 7265 732e 4369 7263 6c65  dlr.wires.Circle
-00026250: 3344 3a0a 2020 2020 2020 2020 2020 2020  3D:.            
-00026260: 7074 312c 2070 7432 203d 2065 6c65 6d65  pt1, pt2 = eleme
-00026270: 6e74 2e6d 696e 696d 756d 5f64 6973 7461  nt.minimum_dista
-00026280: 6e63 655f 706f 696e 7473 5f6c 696e 6528  nce_points_line(
-00026290: 7365 6c66 290a 2020 2020 2020 2020 2020  self).          
-000262a0: 2020 6966 2072 6574 7572 6e5f 706f 696e    if return_poin
-000262b0: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-000262c0: 2020 2020 7265 7475 726e 2070 7431 2e70      return pt1.p
-000262d0: 6f69 6e74 5f64 6973 7461 6e63 6528 7074  oint_distance(pt
-000262e0: 3229 2c20 7074 312c 2070 7432 0a20 2020  2), pt1, pt2.   
-000262f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00026300: 7074 312e 706f 696e 745f 6469 7374 616e  pt1.point_distan
-00026310: 6365 2870 7432 290a 0a20 2020 2020 2020  ce(pt2)..       
-00026320: 2069 6620 656c 656d 656e 742e 5f5f 636c   if element.__cl
-00026330: 6173 735f 5f20 6973 204c 696e 6553 6567  ass__ is LineSeg
-00026340: 6d65 6e74 3344 3a0a 2020 2020 2020 2020  ment3D:.        
-00026350: 2020 2020 7031 2c20 7032 203d 2073 656c      p1, p2 = sel
-00026360: 662e 6d61 7472 6978 5f64 6973 7461 6e63  f.matrix_distanc
-00026370: 6528 656c 656d 656e 7429 0a20 2020 2020  e(element).     
-00026380: 2020 2020 2020 2069 6620 7265 7475 726e         if return
-00026390: 5f70 6f69 6e74 733a 0a20 2020 2020 2020  _points:.       
-000263a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000263b0: 7031 2e70 6f69 6e74 5f64 6973 7461 6e63  p1.point_distanc
-000263c0: 6528 7032 292c 2070 312c 2070 320a 2020  e(p2), p1, p2.  
-000263d0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000263e0: 2070 312e 706f 696e 745f 6469 7374 616e   p1.point_distan
-000263f0: 6365 2870 3229 0a0a 2020 2020 2020 2020  ce(p2)..        
-00026400: 6966 2065 6c65 6d65 6e74 2e5f 5f63 6c61  if element.__cla
-00026410: 7373 5f5f 2069 7320 4253 706c 696e 6543  ss__ is BSplineC
-00026420: 7572 7665 3344 3a0a 2020 2020 2020 2020  urve3D:.        
-00026430: 2020 2020 706f 696e 7473 203d 2065 6c65      points = ele
-00026440: 6d65 6e74 2e70 6f69 6e74 730a 2020 2020  ment.points.    
-00026450: 2020 2020 2020 2020 6c69 6e65 7320 3d20          lines = 
-00026460: 5b5d 0a20 2020 2020 2020 2020 2020 2064  [].            d
-00026470: 6973 745f 6d69 6e20 3d20 6d61 7468 2e69  ist_min = math.i
-00026480: 6e66 0a20 2020 2020 2020 2020 2020 2066  nf.            f
-00026490: 6f72 2070 312c 2070 3220 696e 207a 6970  or p1, p2 in zip
-000264a0: 2870 6f69 6e74 735b 303a 2d31 5d2c 2070  (points[0:-1], p
-000264b0: 6f69 6e74 735b 313a 5d29 3a0a 2020 2020  oints[1:]):.    
-000264c0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-000264d0: 732e 6170 7065 6e64 284c 696e 6553 6567  s.append(LineSeg
-000264e0: 6d65 6e74 3344 2870 312c 2070 3229 290a  ment3D(p1, p2)).
-000264f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00026500: 6c69 6e65 2069 6e20 6c69 6e65 733a 0a20  line in lines:. 
-00026510: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00026520: 312c 2070 3220 3d20 7365 6c66 2e6d 6174  1, p2 = self.mat
-00026530: 7269 785f 6469 7374 616e 6365 286c 696e  rix_distance(lin
-00026540: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-00026550: 2020 2064 6973 7420 3d20 7031 2e70 6f69     dist = p1.poi
-00026560: 6e74 5f64 6973 7461 6e63 6528 7032 290a  nt_distance(p2).
-00026570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026580: 6966 2064 6973 7420 3c20 6469 7374 5f6d  if dist < dist_m
-00026590: 696e 3a0a 2020 2020 2020 2020 2020 2020  in:.            
-000265a0: 2020 2020 2020 2020 6469 7374 5f6d 696e          dist_min
-000265b0: 203d 2064 6973 740a 2020 2020 2020 2020   = dist.        
-000265c0: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
-000265d0: 706f 696e 7473 203d 2028 7031 2c20 7032  points = (p1, p2
-000265e0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-000265f0: 2072 6574 7572 6e5f 706f 696e 7473 3a0a   return_points:.
-00026600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026610: 7031 2c20 7032 203d 206d 696e 5f70 6f69  p1, p2 = min_poi
+0001bd70: 2020 2020 2020 2020 2020 2074 6865 7461             theta
+0001bd80: 323d 3336 302c 0a20 2020 2020 2020 2020  2=360,.         
+0001bd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bdb0: 2020 2020 2020 2063 6f6c 6f72 3d63 6f6c         color=col
+0001bdc0: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
+0001bdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bdf0: 2020 2020 6c69 6e65 7374 796c 653d 6c69      linestyle=li
+0001be00: 6e65 7374 796c 652c 0a20 2020 2020 2020  nestyle,.       
+0001be10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be30: 2020 2020 2020 2020 206c 696e 6577 6964           linewid
+0001be40: 7468 3d6c 696e 6577 6964 7468 2929 0a20  th=linewidth)). 
+0001be50: 2020 2020 2020 2069 6620 706c 6f74 5f70         if plot_p
+0001be60: 6f69 6e74 733a 0a20 2020 2020 2020 2020  oints:.         
+0001be70: 2020 2061 782e 706c 6f74 285b 7365 6c66     ax.plot([self
+0001be80: 2e73 7461 7274 2e78 5d2c 205b 7365 6c66  .start.x], [self
+0001be90: 2e73 7461 7274 2e79 5d2c 2027 6f27 2c0a  .start.y], 'o',.
+0001bea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001beb0: 2020 2020 636f 6c6f 723d 636f 6c6f 722c      color=color,
+0001bec0: 2061 6c70 6861 3d61 6c70 6861 290a 2020   alpha=alpha).  
+0001bed0: 2020 2020 2020 7265 7475 726e 2061 780a        return ax.
+0001bee0: 0a20 2020 2064 6566 2063 7574 5f62 6574  .    def cut_bet
+0001bef0: 7765 656e 5f74 776f 5f70 6f69 6e74 7328  ween_two_points(
+0001bf00: 7365 6c66 2c20 706f 696e 7431 2c20 706f  self, point1, po
+0001bf10: 696e 7432 293a 0a0a 2020 2020 2020 2020  int2):..        
+0001bf20: 7831 2c20 7931 203d 2070 6f69 6e74 3120  x1, y1 = point1 
+0001bf30: 2d20 7365 6c66 2e63 656e 7465 720a 2020  - self.center.  
+0001bf40: 2020 2020 2020 7832 2c20 7932 203d 2070        x2, y2 = p
+0001bf50: 6f69 6e74 3220 2d20 7365 6c66 2e63 656e  oint2 - self.cen
+0001bf60: 7465 720a 0a20 2020 2020 2020 2061 6e67  ter..        ang
+0001bf70: 6c65 3120 3d20 6d61 7468 2e61 7461 6e32  le1 = math.atan2
+0001bf80: 2879 312c 2078 3129 0a20 2020 2020 2020  (y1, x1).       
+0001bf90: 2061 6e67 6c65 3220 3d20 6d61 7468 2e61   angle2 = math.a
+0001bfa0: 7461 6e32 2879 322c 2078 3229 0a20 2020  tan2(y2, x2).   
+0001bfb0: 2020 2020 2069 6620 616e 676c 6532 203c       if angle2 <
+0001bfc0: 2061 6e67 6c65 313a 0a20 2020 2020 2020   angle1:.       
+0001bfd0: 2020 2020 2061 6e67 6c65 3220 2b3d 2076       angle2 += v
+0001bfe0: 6f6c 6d64 6c72 2e54 574f 5f50 490a 2020  olmdlr.TWO_PI.  
+0001bff0: 2020 2020 2020 616e 676c 655f 6920 3d20        angle_i = 
+0001c000: 302e 3520 2a20 2861 6e67 6c65 3120 2b20  0.5 * (angle1 + 
+0001c010: 616e 676c 6532 290a 2020 2020 2020 2020  angle2).        
+0001c020: 696e 7465 7269 6f72 203d 2070 6f69 6e74  interior = point
+0001c030: 312e 726f 7461 7469 6f6e 2873 656c 662e  1.rotation(self.
+0001c040: 6365 6e74 6572 2c20 616e 676c 655f 6929  center, angle_i)
+0001c050: 0a20 2020 2020 2020 2061 7263 203d 2041  .        arc = A
+0001c060: 7263 3244 2870 6f69 6e74 312c 2069 6e74  rc2D(point1, int
+0001c070: 6572 696f 722c 2070 6f69 6e74 3229 0a20  erior, point2). 
+0001c080: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
+0001c090: 735f 7472 6967 6f20 213d 2061 7263 2e69  s_trigo != arc.i
+0001c0a0: 735f 7472 6967 6f3a 0a20 2020 2020 2020  s_trigo:.       
+0001c0b0: 2020 2020 2061 7263 203d 2061 7263 2e63       arc = arc.c
+0001c0c0: 6f6d 706c 656d 656e 7461 7279 2829 0a0a  omplementary()..
+0001c0d0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+0001c0e0: 7263 0a0a 2020 2020 6465 6620 6c69 6e65  rc..    def line
+0001c0f0: 5f69 6e74 6572 7365 6374 696f 6e73 2873  _intersections(s
+0001c100: 656c 662c 206c 696e 6532 643a 204c 696e  elf, line2d: Lin
+0001c110: 6532 442c 2074 6f6c 3d31 652d 3929 3a0a  e2D, tol=1e-9):.
+0001c120: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+0001c130: 2020 2020 2020 2020 2069 6620 6c69 6e65           if line
+0001c140: 3264 2e73 7461 7274 203d 3d20 7365 6c66  2d.start == self
+0001c150: 2e63 656e 7465 723a 0a20 2020 2020 2020  .center:.       
+0001c160: 2020 2020 2020 2020 2070 7431 203d 206c           pt1 = l
+0001c170: 696e 6532 642e 656e 640a 2020 2020 2020  ine2d.end.      
+0001c180: 2020 2020 2020 2020 2020 7665 6320 3d20            vec = 
+0001c190: 6c69 6e65 3264 2e73 7461 7274 202d 206c  line2d.start - l
+0001c1a0: 696e 6532 642e 656e 640a 2020 2020 2020  ine2d.end.      
+0001c1b0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001c1c0: 2020 2020 2020 2020 2020 2020 7074 3120              pt1 
+0001c1d0: 3d20 6c69 6e65 3264 2e73 7461 7274 0a20  = line2d.start. 
+0001c1e0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0001c1f0: 6563 203d 206c 696e 6532 642e 656e 6420  ec = line2d.end 
+0001c200: 2d20 6c69 6e65 3264 2e73 7461 7274 0a20  - line2d.start. 
+0001c210: 2020 2020 2020 2065 7863 6570 7420 4174         except At
+0001c220: 7472 6962 7574 6545 7272 6f72 3a0a 2020  tributeError:.  
+0001c230: 2020 2020 2020 2020 2020 6966 206c 696e            if lin
+0001c240: 6532 642e 706f 696e 7431 203d 3d20 7365  e2d.point1 == se
+0001c250: 6c66 2e63 656e 7465 723a 0a20 2020 2020  lf.center:.     
+0001c260: 2020 2020 2020 2020 2020 2070 7431 203d             pt1 =
+0001c270: 206c 696e 6532 642e 706f 696e 7432 0a20   line2d.point2. 
+0001c280: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0001c290: 6563 203d 206c 696e 6532 642e 706f 696e  ec = line2d.poin
+0001c2a0: 7431 202d 206c 696e 6532 642e 706f 696e  t1 - line2d.poin
+0001c2b0: 7432 0a20 2020 2020 2020 2020 2020 2065  t2.            e
+0001c2c0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001c2d0: 2020 2020 2070 7431 203d 206c 696e 6532       pt1 = line2
+0001c2e0: 642e 706f 696e 7431 0a20 2020 2020 2020  d.point1.       
+0001c2f0: 2020 2020 2020 2020 2076 6563 203d 206c           vec = l
+0001c300: 696e 6532 642e 706f 696e 7432 202d 206c  ine2d.point2 - l
+0001c310: 696e 6532 642e 706f 696e 7431 0a20 2020  ine2d.point1.   
+0001c320: 2020 2020 2061 203d 2076 6563 2e64 6f74       a = vec.dot
+0001c330: 2876 6563 290a 2020 2020 2020 2020 6220  (vec).        b 
+0001c340: 3d20 3220 2a20 7665 632e 646f 7428 7074  = 2 * vec.dot(pt
+0001c350: 3120 2d20 7365 6c66 2e63 656e 7465 7229  1 - self.center)
+0001c360: 0a20 2020 2020 2020 2063 203d 2070 7431  .        c = pt1
+0001c370: 2e64 6f74 2870 7431 2920 2b20 7365 6c66  .dot(pt1) + self
+0001c380: 2e63 656e 7465 722e 646f 7428 7365 6c66  .center.dot(self
+0001c390: 2e63 656e 7465 7229 205c 0a20 2020 2020  .center) \.     
+0001c3a0: 2020 2020 2020 202d 2032 202a 2070 7431         - 2 * pt1
+0001c3b0: 2e64 6f74 2873 656c 662e 6365 6e74 6572  .dot(self.center
+0001c3c0: 2920 2d20 7365 6c66 2e72 6164 6975 7320  ) - self.radius 
+0001c3d0: 2a2a 2032 0a0a 2020 2020 2020 2020 6469  ** 2..        di
+0001c3e0: 7363 203d 2062 202a 2a20 3220 2d20 3420  sc = b ** 2 - 4 
+0001c3f0: 2a20 6120 2a20 630a 2020 2020 2020 2020  * a * c.        
+0001c400: 6966 206d 6174 682e 6973 636c 6f73 6528  if math.isclose(
+0001c410: 6469 7363 2c20 302e 2c20 6162 735f 746f  disc, 0., abs_to
+0001c420: 6c3d 746f 6c29 3a0a 2020 2020 2020 2020  l=tol):.        
+0001c430: 2020 2020 7431 203d 202d 6220 2f20 2832      t1 = -b / (2
+0001c440: 202a 2061 290a 2020 2020 2020 2020 2020   * a).          
+0001c450: 2020 7265 7475 726e 205b 7074 3120 2b20    return [pt1 + 
+0001c460: 7431 202a 2076 6563 5d0a 0a20 2020 2020  t1 * vec]..     
+0001c470: 2020 2069 6620 6469 7363 203e 2030 3a0a     if disc > 0:.
+0001c480: 2020 2020 2020 2020 2020 2020 7371 7274              sqrt
+0001c490: 5f64 6973 6320 3d20 6d61 7468 2e73 7172  _disc = math.sqr
+0001c4a0: 7428 6469 7363 290a 2020 2020 2020 2020  t(disc).        
+0001c4b0: 2020 2020 7431 203d 2028 2d62 202b 2073      t1 = (-b + s
+0001c4c0: 7172 745f 6469 7363 2920 2f20 2832 202a  qrt_disc) / (2 *
+0001c4d0: 2061 290a 2020 2020 2020 2020 2020 2020   a).            
+0001c4e0: 7432 203d 2028 2d62 202d 2073 7172 745f  t2 = (-b - sqrt_
+0001c4f0: 6469 7363 2920 2f20 2832 202a 2061 290a  disc) / (2 * a).
+0001c500: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001c510: 726e 205b 7074 3120 2b20 7431 202a 2076  rn [pt1 + t1 * v
+0001c520: 6563 2c0a 2020 2020 2020 2020 2020 2020  ec,.            
+0001c530: 2020 2020 2020 2020 7074 3120 2b20 7432          pt1 + t2
+0001c540: 202a 2076 6563 5d0a 0a20 2020 2020 2020   * vec]..       
+0001c550: 2072 6574 7572 6e20 5b5d 0a0a 2020 2020   return []..    
+0001c560: 6465 6620 6c69 6e65 7365 676d 656e 745f  def linesegment_
+0001c570: 696e 7465 7273 6563 7469 6f6e 7328 7365  intersections(se
+0001c580: 6c66 2c20 6c69 6e65 7365 676d 656e 7432  lf, linesegment2
+0001c590: 643a 204c 696e 6553 6567 6d65 6e74 3244  d: LineSegment2D
+0001c5a0: 2c20 746f 6c3d 3165 2d39 293a 0a20 2020  , tol=1e-9):.   
+0001c5b0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0001c5c0: 2e62 6f75 6e64 696e 675f 7265 6374 616e  .bounding_rectan
+0001c5d0: 676c 652e 625f 7265 6374 616e 676c 655f  gle.b_rectangle_
+0001c5e0: 696e 7465 7273 6563 7469 6f6e 286c 696e  intersection(lin
+0001c5f0: 6573 6567 6d65 6e74 3264 2e62 6f75 6e64  esegment2d.bound
+0001c600: 696e 675f 7265 6374 616e 676c 6529 3a0a  ing_rectangle):.
+0001c610: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001c620: 726e 205b 5d0a 2020 2020 2020 2020 7472  rn [].        tr
+0001c630: 793a 0a20 2020 2020 2020 2020 2020 2069  y:.            i
+0001c640: 6620 6c69 6e65 7365 676d 656e 7432 642e  f linesegment2d.
+0001c650: 7374 6172 7420 3d3d 2073 656c 662e 6365  start == self.ce
+0001c660: 6e74 6572 3a0a 2020 2020 2020 2020 2020  nter:.          
+0001c670: 2020 2020 2020 7074 3120 3d20 6c69 6e65        pt1 = line
+0001c680: 7365 676d 656e 7432 642e 656e 640a 2020  segment2d.end.  
+0001c690: 2020 2020 2020 2020 2020 2020 2020 7665                ve
+0001c6a0: 6320 3d20 6c69 6e65 7365 676d 656e 7432  c = linesegment2
+0001c6b0: 642e 7374 6172 7420 2d20 6c69 6e65 7365  d.start - linese
+0001c6c0: 676d 656e 7432 642e 656e 640a 2020 2020  gment2d.end.    
+0001c6d0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001c6e0: 2020 2020 2020 2020 2020 2020 2020 7074                pt
+0001c6f0: 3120 3d20 6c69 6e65 7365 676d 656e 7432  1 = linesegment2
+0001c700: 642e 7374 6172 740a 2020 2020 2020 2020  d.start.        
+0001c710: 2020 2020 2020 2020 7665 6320 3d20 6c69          vec = li
+0001c720: 6e65 7365 676d 656e 7432 642e 656e 6420  nesegment2d.end 
+0001c730: 2d20 6c69 6e65 7365 676d 656e 7432 642e  - linesegment2d.
+0001c740: 7374 6172 740a 2020 2020 2020 2020 6578  start.        ex
+0001c750: 6365 7074 2041 7474 7269 6275 7465 4572  cept AttributeEr
+0001c760: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+0001c770: 2069 6620 6c69 6e65 7365 676d 656e 7432   if linesegment2
+0001c780: 642e 706f 696e 7431 203d 3d20 7365 6c66  d.point1 == self
+0001c790: 2e63 656e 7465 723a 0a20 2020 2020 2020  .center:.       
+0001c7a0: 2020 2020 2020 2020 2070 7431 203d 206c           pt1 = l
+0001c7b0: 696e 6573 6567 6d65 6e74 3264 2e70 6f69  inesegment2d.poi
+0001c7c0: 6e74 320a 2020 2020 2020 2020 2020 2020  nt2.            
+0001c7d0: 2020 2020 7665 6320 3d20 6c69 6e65 7365      vec = linese
+0001c7e0: 676d 656e 7432 642e 706f 696e 7431 202d  gment2d.point1 -
+0001c7f0: 206c 696e 6573 6567 6d65 6e74 3264 2e70   linesegment2d.p
+0001c800: 6f69 6e74 320a 2020 2020 2020 2020 2020  oint2.          
+0001c810: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001c820: 2020 2020 2020 2020 7074 3120 3d20 6c69          pt1 = li
+0001c830: 6e65 7365 676d 656e 7432 642e 706f 696e  nesegment2d.poin
+0001c840: 7431 0a20 2020 2020 2020 2020 2020 2020  t1.             
+0001c850: 2020 2076 6563 203d 206c 696e 6573 6567     vec = lineseg
+0001c860: 6d65 6e74 3264 2e70 6f69 6e74 3220 2d20  ment2d.point2 - 
+0001c870: 6c69 6e65 7365 676d 656e 7432 642e 706f  linesegment2d.po
+0001c880: 696e 7431 0a20 2020 2020 2020 2061 203d  int1.        a =
+0001c890: 2076 6563 2e64 6f74 2876 6563 290a 2020   vec.dot(vec).  
+0001c8a0: 2020 2020 2020 6220 3d20 3220 2a20 7665        b = 2 * ve
+0001c8b0: 632e 646f 7428 7074 3120 2d20 7365 6c66  c.dot(pt1 - self
+0001c8c0: 2e63 656e 7465 7229 0a20 2020 2020 2020  .center).       
+0001c8d0: 2063 203d 2070 7431 2e64 6f74 2870 7431   c = pt1.dot(pt1
+0001c8e0: 2920 2b20 7365 6c66 2e63 656e 7465 722e  ) + self.center.
+0001c8f0: 646f 7428 7365 6c66 2e63 656e 7465 7229  dot(self.center)
+0001c900: 205c 0a20 2020 2020 2020 2020 2020 202d   \.            -
+0001c910: 2032 202a 2070 7431 2e64 6f74 2873 656c   2 * pt1.dot(sel
+0001c920: 662e 6365 6e74 6572 2920 2d20 7365 6c66  f.center) - self
+0001c930: 2e72 6164 6975 7320 2a2a 2032 0a0a 2020  .radius ** 2..  
+0001c940: 2020 2020 2020 6469 7363 203d 2062 202a        disc = b *
+0001c950: 2a20 3220 2d20 3420 2a20 6120 2a20 630a  * 2 - 4 * a * c.
+0001c960: 2020 2020 2020 2020 6966 206d 6174 682e          if math.
+0001c970: 6973 636c 6f73 6528 6469 7363 2c20 302e  isclose(disc, 0.
+0001c980: 2c20 6162 735f 746f 6c3d 746f 6c29 3a0a  , abs_tol=tol):.
+0001c990: 2020 2020 2020 2020 2020 2020 7431 203d              t1 =
+0001c9a0: 202d 6220 2f20 2832 202a 2061 290a 2020   -b / (2 * a).  
+0001c9b0: 2020 2020 2020 2020 2020 706f 696e 7473            points
+0001c9c0: 203d 205b 7074 3120 2b20 7431 202a 2076   = [pt1 + t1 * v
+0001c9d0: 6563 5d0a 2020 2020 2020 2020 2020 2020  ec].            
+0001c9e0: 6966 206c 696e 6573 6567 6d65 6e74 3264  if linesegment2d
+0001c9f0: 2e70 6f69 6e74 5f62 656c 6f6e 6773 2870  .point_belongs(p
+0001ca00: 6f69 6e74 735b 305d 293a 0a20 2020 2020  oints[0]):.     
+0001ca10: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001ca20: 6e20 706f 696e 7473 0a20 2020 2020 2020  n points.       
+0001ca30: 2020 2020 2072 6574 7572 6e20 5b5d 0a0a       return []..
+0001ca40: 2020 2020 2020 2020 6966 2064 6973 6320          if disc 
+0001ca50: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
+0001ca60: 2073 7172 745f 6469 7363 203d 206d 6174   sqrt_disc = mat
+0001ca70: 682e 7371 7274 2864 6973 6329 0a20 2020  h.sqrt(disc).   
+0001ca80: 2020 2020 2020 2020 2074 3120 3d20 282d           t1 = (-
+0001ca90: 6220 2b20 7371 7274 5f64 6973 6329 202f  b + sqrt_disc) /
+0001caa0: 2028 3220 2a20 6129 0a20 2020 2020 2020   (2 * a).       
+0001cab0: 2020 2020 2074 3220 3d20 282d 6220 2d20       t2 = (-b - 
+0001cac0: 7371 7274 5f64 6973 6329 202f 2028 3220  sqrt_disc) / (2 
+0001cad0: 2a20 6129 0a20 2020 2020 2020 2020 2020  * a).           
+0001cae0: 2070 6f69 6e74 7320 3d20 5b70 7431 202b   points = [pt1 +
+0001caf0: 2074 3120 2a20 7665 632c 2070 7431 202b   t1 * vec, pt1 +
+0001cb00: 2074 3220 2a20 7665 635d 0a20 2020 2020   t2 * vec].     
+0001cb10: 2020 2020 2020 2076 616c 6964 5f70 6f69         valid_poi
+0001cb20: 6e74 7320 3d20 5b70 7420 666f 7220 7074  nts = [pt for pt
+0001cb30: 2069 6e20 706f 696e 7473 2069 660a 2020   in points if.  
+0001cb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb50: 2020 2020 2020 2020 2020 6c69 6e65 7365            linese
+0001cb60: 676d 656e 7432 642e 706f 696e 745f 6265  gment2d.point_be
+0001cb70: 6c6f 6e67 7328 7074 295d 0a20 2020 2020  longs(pt)].     
+0001cb80: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
+0001cb90: 6c69 645f 706f 696e 7473 0a0a 2020 2020  lid_points..    
+0001cba0: 2020 2020 7265 7475 726e 205b 5d0a 0a20      return [].. 
+0001cbb0: 2020 2064 6566 2072 6576 6572 7365 2873     def reverse(s
+0001cbc0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+0001cbd0: 7475 726e 2073 656c 660a 0a0a 636c 6173  turn self...clas
+0001cbe0: 7320 4172 6345 6c6c 6970 7365 3244 2845  s ArcEllipse2D(E
+0001cbf0: 6467 6529 3a0a 2020 2020 2222 220a 2020  dge):.    """.  
+0001cc00: 2020 416e 2032 2064 696d 656e 7369 6f6e    An 2 dimension
+0001cc10: 616c 2065 6c6c 6970 7469 6361 6c20 6172  al elliptical ar
+0001cc20: 632e 0a0a 2020 2020 3a70 6172 616d 2073  c...    :param s
+0001cc30: 7461 7274 3a20 5468 6520 7374 6172 7469  tart: The starti
+0001cc40: 6e67 2070 6f69 6e74 206f 6620 7468 6520  ng point of the 
+0001cc50: 656c 6c69 7074 6963 616c 2061 7263 0a20  elliptical arc. 
+0001cc60: 2020 203a 7479 7065 2073 7461 7274 3a20     :type start: 
+0001cc70: 3a63 6c61 7373 3a60 766f 6c6d 646c 722e  :class:`volmdlr.
+0001cc80: 506f 696e 7432 4460 0a20 2020 203a 7061  Point2D`.    :pa
+0001cc90: 7261 6d20 696e 7465 7269 6f72 3a20 416e  ram interior: An
+0001cca0: 2069 6e74 6572 696f 7220 706f 696e 7420   interior point 
+0001ccb0: 6f66 2074 6865 2065 6c6c 6970 7469 6361  of the elliptica
+0001ccc0: 6c20 6172 630a 2020 2020 3a74 7970 6520  l arc.    :type 
+0001ccd0: 696e 7465 7269 6f72 3a20 3a63 6c61 7373  interior: :class
+0001cce0: 3a60 766f 6c6d 646c 722e 506f 696e 7432  :`volmdlr.Point2
+0001ccf0: 4460 0a20 2020 203a 7061 7261 6d20 656e  D`.    :param en
+0001cd00: 643a 2054 6865 2065 6e64 2070 6f69 6e74  d: The end point
+0001cd10: 206f 6620 7468 6520 656c 6c69 7074 6963   of the elliptic
+0001cd20: 616c 2061 7263 0a20 2020 203a 7479 7065  al arc.    :type
+0001cd30: 2065 6e64 3a20 3a63 6c61 7373 3a60 766f   end: :class:`vo
+0001cd40: 6c6d 646c 722e 506f 696e 7432 4460 0a20  lmdlr.Point2D`. 
+0001cd50: 2020 203a 7061 7261 6d20 6365 6e74 6572     :param center
+0001cd60: 3a20 5468 6520 6365 6e74 6572 206f 6620  : The center of 
+0001cd70: 7468 6520 656c 6c69 7073 650a 2020 2020  the ellipse.    
+0001cd80: 3a74 7970 6520 6365 6e74 6572 3a20 3a63  :type center: :c
+0001cd90: 6c61 7373 3a60 766f 6c6d 646c 722e 506f  lass:`volmdlr.Po
+0001cda0: 696e 7432 4460 0a20 2020 203a 7061 7261  int2D`.    :para
+0001cdb0: 6d20 6d61 6a6f 725f 6469 723a 2054 6865  m major_dir: The
+0001cdc0: 206d 616a 6f72 2064 6972 6563 7469 6f6e   major direction
+0001cdd0: 206f 6620 7468 6520 656c 6c69 7073 650a   of the ellipse.
+0001cde0: 2020 2020 3a74 7970 6520 6d61 6a6f 725f      :type major_
+0001cdf0: 6469 723a 203a 636c 6173 733a 6076 6f6c  dir: :class:`vol
+0001ce00: 6d64 6c72 2e56 6563 746f 7232 4460 0a20  mdlr.Vector2D`. 
+0001ce10: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
+0001ce20: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
+0001ce30: 656c 6c69 7074 6963 616c 2061 7263 2e20  elliptical arc. 
+0001ce40: 4465 6661 756c 7420 7661 6c75 6520 6973  Default value is
+0001ce50: 2027 270a 2020 2020 3a74 7970 6520 6e61   ''.    :type na
+0001ce60: 6d65 3a20 7374 722c 206f 7074 696f 6e61  me: str, optiona
+0001ce70: 6c0a 2020 2020 3a70 6172 616d 2065 7874  l.    :param ext
+0001ce80: 7261 3a20 416e 2065 7874 7261 2069 6e74  ra: An extra int
+0001ce90: 6572 696f 7220 706f 696e 7420 6966 2073  erior point if s
+0001cea0: 7461 7274 2069 7320 6571 7561 6c20 746f  tart is equal to
+0001ceb0: 2065 6e64 2e20 4465 6661 756c 740a 2020   end. Default.  
+0001cec0: 2020 2020 2020 7661 6c75 6520 6973 204e        value is N
+0001ced0: 6f6e 650a 2020 2020 3a74 7970 6520 6578  one.    :type ex
+0001cee0: 7472 613a 203a 636c 6173 733a 6076 6f6c  tra: :class:`vol
+0001cef0: 6d64 6c72 2e50 6f69 6e74 3244 602c 206f  mdlr.Point2D`, o
+0001cf00: 7074 696f 6e61 6c0a 2020 2020 2222 220a  ptional.    """.
+0001cf10: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+0001cf20: 5f28 7365 6c66 2c20 7374 6172 743a 2076  _(self, start: v
+0001cf30: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 2c20  olmdlr.Point2D, 
+0001cf40: 696e 7465 7269 6f72 3a20 766f 6c6d 646c  interior: volmdl
+0001cf50: 722e 506f 696e 7432 442c 0a20 2020 2020  r.Point2D,.     
+0001cf60: 2020 2020 2020 2020 2020 2020 656e 643a              end:
+0001cf70: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3244   volmdlr.Point2D
+0001cf80: 2c20 6365 6e74 6572 3a20 766f 6c6d 646c  , center: volmdl
+0001cf90: 722e 506f 696e 7432 442c 0a20 2020 2020  r.Point2D,.     
+0001cfa0: 2020 2020 2020 2020 2020 2020 6d61 6a6f              majo
+0001cfb0: 725f 6469 723a 2076 6f6c 6d64 6c72 2e56  r_dir: volmdlr.V
+0001cfc0: 6563 746f 7232 442c 206e 616d 653a 2073  ector2D, name: s
+0001cfd0: 7472 203d 2027 272c 0a20 2020 2020 2020  tr = '',.       
+0001cfe0: 2020 2020 2020 2020 2020 6578 7472 613a            extra:
+0001cff0: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3244   volmdlr.Point2D
+0001d000: 203d 204e 6f6e 6529 3a0a 2020 2020 2020   = None):.      
+0001d010: 2020 4564 6765 2e5f 5f69 6e69 745f 5f28    Edge.__init__(
+0001d020: 7365 6c66 2c20 7374 6172 742c 2065 6e64  self, start, end
+0001d030: 2c20 6e61 6d65 290a 2020 2020 2020 2020  , name).        
+0001d040: 7365 6c66 2e69 6e74 6572 696f 7220 3d20  self.interior = 
+0001d050: 696e 7465 7269 6f72 0a20 2020 2020 2020  interior.       
+0001d060: 2073 656c 662e 6365 6e74 6572 203d 2063   self.center = c
+0001d070: 656e 7465 720a 2020 2020 2020 2020 7365  enter.        se
+0001d080: 6c66 2e65 7874 7261 203d 2065 7874 7261  lf.extra = extra
+0001d090: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
+0001d0a0: 6a6f 725f 6469 7220 3d20 6d61 6a6f 725f  jor_dir = major_
+0001d0b0: 6469 720a 2020 2020 2020 2020 7365 6c66  dir.        self
+0001d0c0: 2e6d 696e 6f72 5f64 6972 203d 2073 656c  .minor_dir = sel
+0001d0d0: 662e 6d61 6a6f 725f 6469 722e 6465 7465  f.major_dir.dete
+0001d0e0: 726d 696e 6973 7469 635f 756e 6974 5f6e  rministic_unit_n
+0001d0f0: 6f72 6d61 6c5f 7665 6374 6f72 2829 0a20  ormal_vector(). 
+0001d100: 2020 2020 2020 2066 7261 6d65 203d 2076         frame = v
+0001d110: 6f6c 6d64 6c72 2e46 7261 6d65 3244 2873  olmdlr.Frame2D(s
+0001d120: 656c 662e 6365 6e74 6572 2c20 7365 6c66  elf.center, self
+0001d130: 2e6d 616a 6f72 5f64 6972 2c20 7365 6c66  .major_dir, self
+0001d140: 2e6d 696e 6f72 5f64 6972 290a 2020 2020  .minor_dir).    
+0001d150: 2020 2020 7365 6c66 2e66 7261 6d65 203d      self.frame =
+0001d160: 2066 7261 6d65 0a20 2020 2020 2020 2073   frame.        s
+0001d170: 7461 7274 5f6e 6577 203d 2066 7261 6d65  tart_new = frame
+0001d180: 2e67 6c6f 6261 6c5f 746f 5f6c 6f63 616c  .global_to_local
+0001d190: 5f63 6f6f 7264 696e 6174 6573 2873 656c  _coordinates(sel
+0001d1a0: 662e 7374 6172 7429 0a20 2020 2020 2020  f.start).       
+0001d1b0: 2065 6e64 5f6e 6577 203d 2066 7261 6d65   end_new = frame
+0001d1c0: 2e67 6c6f 6261 6c5f 746f 5f6c 6f63 616c  .global_to_local
+0001d1d0: 5f63 6f6f 7264 696e 6174 6573 2873 656c  _coordinates(sel
+0001d1e0: 662e 656e 6429 0a20 2020 2020 2020 2069  f.end).        i
+0001d1f0: 6e74 6572 696f 725f 6e65 7720 3d20 6672  nterior_new = fr
+0001d200: 616d 652e 676c 6f62 616c 5f74 6f5f 6c6f  ame.global_to_lo
+0001d210: 6361 6c5f 636f 6f72 6469 6e61 7465 7328  cal_coordinates(
+0001d220: 7365 6c66 2e69 6e74 6572 696f 7229 0a20  self.interior). 
+0001d230: 2020 2020 2020 2063 656e 7465 725f 6e65         center_ne
+0001d240: 7720 3d20 6672 616d 652e 676c 6f62 616c  w = frame.global
+0001d250: 5f74 6f5f 6c6f 6361 6c5f 636f 6f72 6469  _to_local_coordi
+0001d260: 6e61 7465 7328 7365 6c66 2e63 656e 7465  nates(self.cente
+0001d270: 7229 0a20 2020 2020 2020 2073 656c 662e  r).        self.
+0001d280: 5f62 6f75 6e64 696e 675f 7265 6374 616e  _bounding_rectan
+0001d290: 676c 6520 3d20 4e6f 6e65 0a0a 2020 2020  gle = None..    
+0001d2a0: 2020 2020 6465 6620 7468 6574 615f 415f      def theta_A_
+0001d2b0: 4228 732c 2069 2c20 652c 2063 293a 0a20  B(s, i, e, c):. 
+0001d2c0: 2020 2020 2020 2020 2020 2022 2222 0a20             """. 
+0001d2d0: 2020 2020 2020 2020 2020 2046 726f 6d20             From 
+0001d2e0: 3a20 6874 7470 733a 2f2f 6d61 7468 2e73  : https://math.s
+0001d2f0: 7461 636b 6578 6368 616e 6765 2e63 6f6d  tackexchange.com
+0001d300: 2f71 7565 7374 696f 6e73 2f33 3339 3132  /questions/33912
+0001d310: 362f 686f 772d 746f 2d64 7261 772d 616e  6/how-to-draw-an
+0001d320: 2d65 6c6c 6970 7365 2d69 662d 612d 6365  -ellipse-if-a-ce
+0001d330: 6e74 6572 2d61 6e64 2d33 2d61 7262 6974  nter-and-3-arbit
+0001d340: 7261 7279 2d70 6f69 6e74 732d 6f6e 2d69  rary-points-on-i
+0001d350: 742d 6172 652d 6769 7665 6e2e 0a20 2020  t-are-given..   
+0001d360: 2020 2020 2020 2020 2074 6865 7461 3d20           theta= 
+0001d370: 656c 6c69 7073 6527 7320 696e 636c 696e  ellipse's inclin
+0001d380: 6174 696f 6e20 616e 676c 6520 7265 6c61  ation angle rela
+0001d390: 7465 6420 746f 2074 6865 2068 6f72 697a  ted to the horiz
+0001d3a0: 6f6e 7461 6c0a 2020 2020 2020 2020 2020  ontal.          
+0001d3b0: 2020 2863 6c6f 636b 7769 7365 292c 413d    (clockwise),A=
+0001d3c0: 7365 6d69 206d 616a 6f72 2061 7869 732c  semi major axis,
+0001d3d0: 2042 3d73 656d 6920 6d69 6e6f 7220 6178   B=semi minor ax
+0001d3e0: 6973 2e0a 0a20 2020 2020 2020 2020 2020  is...           
+0001d3f0: 2022 2222 0a20 2020 2020 2020 2020 2020   """.           
+0001d400: 2078 732c 2079 732c 2078 692c 2079 692c   xs, ys, xi, yi,
+0001d410: 2078 652c 2079 6520 3d20 735b 305d 202d   xe, ye = s[0] -
+0001d420: 2063 5b30 5d2c 2073 5b31 5d20 2d20 635b   c[0], s[1] - c[
+0001d430: 315d 2c20 695b 305d 202d 2063 5b30 5d2c  1], i[0] - c[0],
+0001d440: 2069 5b0a 2020 2020 2020 2020 2020 2020   i[.            
+0001d450: 2020 2020 315d 202d 2063 5b31 5d2c 2065      1] - c[1], e
+0001d460: 5b30 5d20 2d20 635b 305d 2c20 655b 315d  [0] - c[0], e[1]
+0001d470: 202d 2063 5b31 5d0a 2020 2020 2020 2020   - c[1].        
+0001d480: 2020 2020 4120 3d20 6e70 792e 6172 7261      A = npy.arra
+0001d490: 7928 285b 7873 202a 2a20 322c 2079 7320  y(([xs ** 2, ys 
+0001d4a0: 2a2a 2032 2c20 3220 2a20 7873 202a 2079  ** 2, 2 * xs * y
+0001d4b0: 735d 2c0a 2020 2020 2020 2020 2020 2020  s],.            
+0001d4c0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0001d4d0: 7869 202a 2a20 322c 2079 6920 2a2a 2032  xi ** 2, yi ** 2
+0001d4e0: 2c20 3220 2a20 7869 202a 2079 695d 2c0a  , 2 * xi * yi],.
+0001d4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d500: 2020 2020 2020 2020 2020 205b 7865 202a             [xe *
+0001d510: 2a20 322c 2079 6520 2a2a 2032 2c20 3220  * 2, ye ** 2, 2 
+0001d520: 2a20 7865 202a 2079 655d 2929 0a20 2020  * xe * ye])).   
+0001d530: 2020 2020 2020 2020 2069 6e76 4120 3d20           invA = 
+0001d540: 6e70 792e 6c69 6e61 6c67 2e69 6e76 2841  npy.linalg.inv(A
+0001d550: 290a 2020 2020 2020 2020 2020 2020 4f6e  ).            On
+0001d560: 6520 3d20 6e70 792e 6172 7261 7928 285b  e = npy.array(([
+0001d570: 315d 2c0a 2020 2020 2020 2020 2020 2020  1],.            
+0001d580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d590: 205b 315d 2c0a 2020 2020 2020 2020 2020   [1],.          
+0001d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5b0: 2020 205b 315d 2929 0a20 2020 2020 2020     [1])).       
+0001d5c0: 2020 2020 2043 203d 206e 7079 2e64 6f74       C = npy.dot
+0001d5d0: 2869 6e76 412c 204f 6e65 290a 2020 2020  (invA, One).    
+0001d5e0: 2020 2020 2020 2020 7468 6574 6120 3d20          theta = 
+0001d5f0: 302e 3520 2a20 6d61 7468 2e61 7461 6e28  0.5 * math.atan(
+0001d600: 3220 2a20 435b 325d 202f 2028 435b 315d  2 * C[2] / (C[1]
+0001d610: 202d 2043 5b30 5d29 290a 2020 2020 2020   - C[0])).      
+0001d620: 2020 2020 2020 6331 203d 2043 5b30 5d20        c1 = C[0] 
+0001d630: 2b20 435b 315d 0a20 2020 2020 2020 2020  + C[1].         
+0001d640: 2020 2063 3220 3d20 2843 5b31 5d20 2d20     c2 = (C[1] - 
+0001d650: 435b 305d 2920 2f20 6d61 7468 2e63 6f73  C[0]) / math.cos
+0001d660: 2832 202a 2074 6865 7461 290a 2020 2020  (2 * theta).    
+0001d670: 2020 2020 2020 2020 6764 6178 6520 3d20          gdaxe = 
+0001d680: 6d61 7468 2e73 7172 7428 2832 202f 2028  math.sqrt((2 / (
+0001d690: 6331 202d 2063 3229 2929 0a20 2020 2020  c1 - c2))).     
+0001d6a0: 2020 2020 2020 2070 7461 7820 3d20 6d61         ptax = ma
+0001d6b0: 7468 2e73 7172 7428 2832 202f 2028 6331  th.sqrt((2 / (c1
+0001d6c0: 202b 2063 3229 2929 0a20 2020 2020 2020   + c2))).       
+0001d6d0: 2020 2020 2072 6574 7572 6e20 7468 6574       return thet
+0001d6e0: 612c 2067 6461 7865 2c20 7074 6178 0a0a  a, gdaxe, ptax..
+0001d6f0: 2020 2020 2020 2020 6966 2073 7461 7274          if start
+0001d700: 203d 3d20 656e 643a 0a20 2020 2020 2020   == end:.       
+0001d710: 2020 2020 2065 7874 7261 5f6e 6577 203d       extra_new =
+0001d720: 2066 7261 6d65 2e67 6c6f 6261 6c5f 746f   frame.global_to
+0001d730: 5f6c 6f63 616c 5f63 6f6f 7264 696e 6174  _local_coordinat
+0001d740: 6573 2873 656c 662e 6578 7472 6129 0a20  es(self.extra). 
+0001d750: 2020 2020 2020 2020 2020 2074 6865 7461             theta
+0001d760: 2c20 6d61 6a6f 725f 6178 6973 2c20 6d69  , major_axis, mi
+0001d770: 6e6f 725f 6178 6973 203d 2074 6865 7461  nor_axis = theta
+0001d780: 5f41 5f42 2873 7461 7274 5f6e 6577 2c20  _A_B(start_new, 
+0001d790: 6578 7472 615f 6e65 772c 2069 6e74 6572  extra_new, inter
+0001d7a0: 696f 725f 6e65 772c 0a20 2020 2020 2020  ior_new,.       
+0001d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d7d0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0001d7e0: 656e 7465 725f 6e65 7729 0a20 2020 2020  enter_new).     
+0001d7f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001d800: 2020 2020 2074 6865 7461 2c20 6d61 6a6f       theta, majo
+0001d810: 725f 6178 6973 2c20 6d69 6e6f 725f 6178  r_axis, minor_ax
+0001d820: 6973 203d 2074 6865 7461 5f41 5f42 2873  is = theta_A_B(s
+0001d830: 7461 7274 5f6e 6577 2c20 696e 7465 7269  tart_new, interi
+0001d840: 6f72 5f6e 6577 2c20 656e 645f 6e65 772c  or_new, end_new,
+0001d850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d880: 2020 2020 2020 2063 656e 7465 725f 6e65         center_ne
+0001d890: 7729 0a0a 2020 2020 2020 2020 7365 6c66  w)..        self
+0001d8a0: 2e6d 616a 6f72 5f61 7869 7320 3d20 6d61  .major_axis = ma
+0001d8b0: 6a6f 725f 6178 6973 0a20 2020 2020 2020  jor_axis.       
+0001d8c0: 2073 656c 662e 6d69 6e6f 725f 6178 6973   self.minor_axis
+0001d8d0: 203d 206d 696e 6f72 5f61 7869 730a 2020   = minor_axis.  
+0001d8e0: 2020 2020 2020 7365 6c66 2e74 6865 7461        self.theta
+0001d8f0: 203d 2074 6865 7461 0a0a 2020 2020 2020   = theta..      
+0001d900: 2020 2320 416e 676c 6520 706f 7572 2073    # Angle pour s
+0001d910: 7461 7274 0a20 2020 2020 2020 2075 312c  tart.        u1,
+0001d920: 2075 3220 3d20 7374 6172 745f 6e65 772e   u2 = start_new.
+0001d930: 7820 2f20 7365 6c66 2e6d 616a 6f72 5f61  x / self.major_a
+0001d940: 7869 732c 2073 7461 7274 5f6e 6577 2e79  xis, start_new.y
+0001d950: 202f 2073 656c 662e 6d69 6e6f 725f 6178   / self.minor_ax
+0001d960: 6973 0a20 2020 2020 2020 2061 6e67 6c65  is.        angle
+0001d970: 3120 3d20 766f 6c6d 646c 722e 6765 6f6d  1 = volmdlr.geom
+0001d980: 6574 7279 2e73 696e 5f63 6f73 5f61 6e67  etry.sin_cos_ang
+0001d990: 6c65 2875 312c 2075 3229 0a20 2020 2020  le(u1, u2).     
+0001d9a0: 2020 2073 656c 662e 616e 676c 655f 7374     self.angle_st
+0001d9b0: 6172 7420 3d20 616e 676c 6531 0a20 2020  art = angle1.   
+0001d9c0: 2020 2020 2023 2041 6e67 6c65 2070 6f75       # Angle pou
+0001d9d0: 7220 656e 640a 2020 2020 2020 2020 7533  r end.        u3
+0001d9e0: 2c20 7534 203d 2065 6e64 5f6e 6577 2e78  , u4 = end_new.x
+0001d9f0: 202f 2073 656c 662e 6d61 6a6f 725f 6178   / self.major_ax
+0001da00: 6973 2c20 656e 645f 6e65 772e 7920 2f20  is, end_new.y / 
+0001da10: 7365 6c66 2e6d 696e 6f72 5f61 7869 730a  self.minor_axis.
+0001da20: 2020 2020 2020 2020 616e 676c 6532 203d          angle2 =
+0001da30: 2076 6f6c 6d64 6c72 2e67 656f 6d65 7472   volmdlr.geometr
+0001da40: 792e 7369 6e5f 636f 735f 616e 676c 6528  y.sin_cos_angle(
+0001da50: 7533 2c20 7534 290a 2020 2020 2020 2020  u3, u4).        
+0001da60: 7365 6c66 2e61 6e67 6c65 5f65 6e64 203d  self.angle_end =
+0001da70: 2061 6e67 6c65 320a 2020 2020 2020 2020   angle2.        
+0001da80: 2320 416e 676c 6520 706f 7572 2069 6e74  # Angle pour int
+0001da90: 6572 696f 720a 2020 2020 2020 2020 7535  erior.        u5
+0001daa0: 2c20 7536 203d 2069 6e74 6572 696f 725f  , u6 = interior_
+0001dab0: 6e65 772e 7820 2f20 7365 6c66 2e6d 616a  new.x / self.maj
+0001dac0: 6f72 5f61 7869 732c 2069 6e74 6572 696f  or_axis, interio
+0001dad0: 725f 6e65 772e 7920 2f20 7365 6c66 2e6d  r_new.y / self.m
+0001dae0: 696e 6f72 5f61 7869 730a 2020 2020 2020  inor_axis.      
+0001daf0: 2020 616e 676c 6569 203d 2076 6f6c 6d64    anglei = volmd
+0001db00: 6c72 2e67 656f 6d65 7472 792e 7369 6e5f  lr.geometry.sin_
+0001db10: 636f 735f 616e 676c 6528 7535 2c20 7536  cos_angle(u5, u6
+0001db20: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0001db30: 6e67 6c65 5f69 6e74 6572 696f 7220 3d20  ngle_interior = 
+0001db40: 616e 676c 6569 0a20 2020 2020 2020 2023  anglei.        #
+0001db50: 2047 6f69 6e67 2074 7269 676f 2f63 6c6f   Going trigo/clo
+0001db60: 636b 2077 6973 6520 6672 6f6d 2073 7461  ck wise from sta
+0001db70: 7274 2074 6f20 696e 7465 7269 6f72 0a20  rt to interior. 
+0001db80: 2020 2020 2020 2069 6620 616e 676c 6569         if anglei
+0001db90: 203c 2061 6e67 6c65 313a 0a20 2020 2020   < angle1:.     
+0001dba0: 2020 2020 2020 2074 7269 676f 7769 7365         trigowise
+0001dbb0: 5f70 6174 6820 3d20 2861 6e67 6c65 6920  _path = (anglei 
+0001dbc0: 2b20 766f 6c6d 646c 722e 5457 4f5f 5049  + volmdlr.TWO_PI
+0001dbd0: 2920 2d20 616e 676c 6531 0a20 2020 2020  ) - angle1.     
+0001dbe0: 2020 2020 2020 2063 6c6f 636b 7769 7365         clockwise
+0001dbf0: 5f70 6174 6820 3d20 616e 676c 6531 202d  _path = angle1 -
+0001dc00: 2061 6e67 6c65 690a 2020 2020 2020 2020   anglei.        
+0001dc10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001dc20: 2020 7472 6967 6f77 6973 655f 7061 7468    trigowise_path
+0001dc30: 203d 2061 6e67 6c65 6920 2d20 616e 676c   = anglei - angl
+0001dc40: 6531 0a20 2020 2020 2020 2020 2020 2063  e1.            c
+0001dc50: 6c6f 636b 7769 7365 5f70 6174 6820 3d20  lockwise_path = 
+0001dc60: 616e 676c 6531 202d 2061 6e67 6c65 6920  angle1 - anglei 
+0001dc70: 2b20 766f 6c6d 646c 722e 5457 4f5f 5049  + volmdlr.TWO_PI
+0001dc80: 0a0a 2020 2020 2020 2020 2320 476f 696e  ..        # Goin
+0001dc90: 6720 7472 6967 6f20 7769 7365 2066 726f  g trigo wise fro
+0001dca0: 6d20 696e 7465 7269 6f72 2074 6f20 696e  m interior to in
+0001dcb0: 7465 7269 6f72 0a20 2020 2020 2020 2069  terior.        i
+0001dcc0: 6620 616e 676c 6532 203c 2061 6e67 6c65  f angle2 < angle
+0001dcd0: 693a 0a20 2020 2020 2020 2020 2020 2074  i:.            t
+0001dce0: 7269 676f 7769 7365 5f70 6174 6820 2b3d  rigowise_path +=
+0001dcf0: 2028 616e 676c 6532 202b 2076 6f6c 6d64   (angle2 + volmd
+0001dd00: 6c72 2e54 574f 5f50 4929 202d 2061 6e67  lr.TWO_PI) - ang
+0001dd10: 6c65 690a 2020 2020 2020 2020 2020 2020  lei.            
+0001dd20: 636c 6f63 6b77 6973 655f 7061 7468 202b  clockwise_path +
+0001dd30: 3d20 616e 676c 6569 202d 2061 6e67 6c65  = anglei - angle
+0001dd40: 320a 2020 2020 2020 2020 656c 7365 3a0a  2.        else:.
+0001dd50: 2020 2020 2020 2020 2020 2020 7472 6967              trig
+0001dd60: 6f77 6973 655f 7061 7468 202b 3d20 616e  owise_path += an
+0001dd70: 676c 6532 202d 2061 6e67 6c65 690a 2020  gle2 - anglei.  
+0001dd80: 2020 2020 2020 2020 2020 636c 6f63 6b77            clockw
+0001dd90: 6973 655f 7061 7468 202b 3d20 616e 676c  ise_path += angl
+0001dda0: 6569 202d 2061 6e67 6c65 3220 2b20 766f  ei - angle2 + vo
+0001ddb0: 6c6d 646c 722e 5457 4f5f 5049 0a0a 2020  lmdlr.TWO_PI..  
+0001ddc0: 2020 2020 2020 6966 2063 6c6f 636b 7769        if clockwi
+0001ddd0: 7365 5f70 6174 6820 3e20 7472 6967 6f77  se_path > trigow
+0001dde0: 6973 655f 7061 7468 3a0a 2020 2020 2020  ise_path:.      
+0001ddf0: 2020 2020 2020 7365 6c66 2e69 735f 7472        self.is_tr
+0001de00: 6967 6f20 3d20 5472 7565 0a20 2020 2020  igo = True.     
+0001de10: 2020 2020 2020 2073 656c 662e 616e 676c         self.angl
+0001de20: 6520 3d20 7472 6967 6f77 6973 655f 7061  e = trigowise_pa
+0001de30: 7468 0a20 2020 2020 2020 2065 6c73 653a  th.        else:
+0001de40: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
+0001de50: 6c6f 636b 2077 6973 650a 2020 2020 2020  lock wise.      
+0001de60: 2020 2020 2020 7365 6c66 2e69 735f 7472        self.is_tr
+0001de70: 6967 6f20 3d20 4661 6c73 650a 2020 2020  igo = False.    
+0001de80: 2020 2020 2020 2020 7365 6c66 2e61 6e67          self.ang
+0001de90: 6c65 203d 2063 6c6f 636b 7769 7365 5f70  le = clockwise_p
+0001dea0: 6174 680a 0a20 2020 2020 2020 2069 6620  ath..        if 
+0001deb0: 7365 6c66 2e73 7461 7274 203d 3d20 7365  self.start == se
+0001dec0: 6c66 2e65 6e64 206f 7220 7365 6c66 2e61  lf.end or self.a
+0001ded0: 6e67 6c65 203d 3d20 303a 0a20 2020 2020  ngle == 0:.     
+0001dee0: 2020 2020 2020 2073 656c 662e 616e 676c         self.angl
+0001def0: 6520 3d20 766f 6c6d 646c 722e 5457 4f5f  e = volmdlr.TWO_
+0001df00: 5049 0a0a 2020 2020 2020 2020 6966 2073  PI..        if s
+0001df10: 656c 662e 6973 5f74 7269 676f 3a20 2023  elf.is_trigo:  #
+0001df20: 2073 656e 7320 7472 6967 6f0a 2020 2020   sens trigo.    
+0001df30: 2020 2020 2020 2020 7365 6c66 2e6f 6666          self.off
+0001df40: 7365 745f 616e 676c 6520 3d20 616e 676c  set_angle = angl
+0001df50: 6531 0a20 2020 2020 2020 2065 6c73 653a  e1.        else:
+0001df60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001df70: 662e 6f66 6673 6574 5f61 6e67 6c65 203d  f.offset_angle =
+0001df80: 2061 6e67 6c65 320a 0a20 2020 2064 6566   angle2..    def
+0001df90: 205f 6765 745f 706f 696e 7473 2873 656c   _get_points(sel
+0001dfa0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+0001dfb0: 726e 2073 656c 662e 6469 7363 7265 7469  rn self.discreti
+0001dfc0: 7a61 7469 6f6e 5f70 6f69 6e74 7328 6e75  zation_points(nu
+0001dfd0: 6d62 6572 5f70 6f69 6e74 733d 3230 290a  mber_points=20).
+0001dfe0: 0a20 2020 2070 6f69 6e74 7320 3d20 7072  .    points = pr
+0001dff0: 6f70 6572 7479 285f 6765 745f 706f 696e  operty(_get_poin
+0001e000: 7473 290a 0a20 2020 2064 6566 206c 656e  ts)..    def len
+0001e010: 6774 6828 7365 6c66 293a 0a20 2020 2020  gth(self):.     
+0001e020: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+0001e030: 616c 6375 6c61 7465 7320 7468 6520 6c65  alculates the le
+0001e040: 6e67 7468 206f 6620 7468 6520 6172 6365  ngth of the arce
+0001e050: 6c6c 6970 7365 3264 2e0a 0a20 2020 2020  llipse2d...     
+0001e060: 2020 203a 7265 7475 726e 3a20 6172 6365     :return: arce
+0001e070: 6c6c 6970 7365 3264 2773 206c 656e 6774  llipse2d's lengt
+0001e080: 680a 2020 2020 2020 2020 2222 220a 2020  h.        """.  
+0001e090: 2020 2020 2020 6c65 6e67 7468 203d 2073        length = s
+0001e0a0: 656c 662e 6162 7363 6973 7361 2873 656c  elf.abscissa(sel
+0001e0b0: 662e 656e 6429 0a20 2020 2020 2020 2072  f.end).        r
+0001e0c0: 6574 7572 6e20 6c65 6e67 7468 0a0a 2020  eturn length..  
+0001e0d0: 2020 6465 6620 706f 696e 745f 6265 6c6f    def point_belo
+0001e0e0: 6e67 7328 7365 6c66 2c20 706f 696e 742c  ngs(self, point,
+0001e0f0: 2061 6273 5f74 6f6c 3a20 666c 6f61 7420   abs_tol: float 
+0001e100: 3d20 3165 2d36 293a 0a20 2020 2020 2020  = 1e-6):.       
+0001e110: 2022 2222 0a20 2020 2020 2020 2056 6572   """.        Ver
+0001e120: 6966 6965 7320 6966 2061 2070 6f69 6e74  ifies if a point
+0001e130: 2062 656c 6f6e 6773 2074 6f20 7468 6520   belongs to the 
+0001e140: 6172 6365 6c6c 6970 7365 3264 2e0a 0a20  arcellipse2d... 
+0001e150: 2020 2020 2020 203a 7061 7261 6d20 706f         :param po
+0001e160: 696e 743a 2070 6f69 6e74 2074 6f20 6265  int: point to be
+0001e170: 2076 6572 6966 6965 640a 2020 2020 2020   verified.      
+0001e180: 2020 3a70 6172 616d 2061 6273 5f74 6f6c    :param abs_tol
+0001e190: 3a20 746f 6c65 7261 6e63 6520 6170 706c  : tolerance appl
+0001e1a0: 6965 6420 6475 7269 6e67 2063 616c 6375  ied during calcu
+0001e1b0: 6c61 7469 6f6e 730a 2020 2020 2020 2020  lations.        
+0001e1c0: 3a72 6574 7572 6e3a 2054 7275 6520 6966  :return: True if
+0001e1d0: 2074 6865 2070 6f69 6e74 2062 656c 6f6e   the point belon
+0001e1e0: 6773 2c20 4661 6c73 6520 6f74 6865 7277  gs, False otherw
+0001e1f0: 6973 650a 2020 2020 2020 2020 2222 220a  ise.        """.
+0001e200: 2020 2020 2020 2020 6966 206e 6f74 206d          if not m
+0001e210: 6174 682e 6973 636c 6f73 6528 2870 6f69  ath.isclose((poi
+0001e220: 6e74 2e78 202d 2073 656c 662e 6365 6e74  nt.x - self.cent
+0001e230: 6572 2e78 2920 2a2a 2032 202f 2073 656c  er.x) ** 2 / sel
+0001e240: 662e 6d61 6a6f 725f 6178 6973 202a 2a20  f.major_axis ** 
+0001e250: 3220 2b0a 2020 2020 2020 2020 2020 2020  2 +.            
+0001e260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e270: 2870 6f69 6e74 2e79 202d 2073 656c 662e  (point.y - self.
+0001e280: 6365 6e74 6572 2e79 2920 2a2a 2032 202f  center.y) ** 2 /
+0001e290: 2073 656c 662e 6d69 6e6f 725f 6178 6973   self.minor_axis
+0001e2a0: 202a 2a20 322c 2031 2c20 6162 735f 746f   ** 2, 1, abs_to
+0001e2b0: 6c3d 6162 735f 746f 6c29 2061 6e64 206e  l=abs_tol) and n
+0001e2c0: 6f74 205c 0a20 2020 2020 2020 2020 2020  ot \.           
+0001e2d0: 2020 2020 206d 6174 682e 6973 636c 6f73       math.isclos
+0001e2e0: 6528 2870 6f69 6e74 2e78 202d 2073 656c  e((point.x - sel
+0001e2f0: 662e 6365 6e74 6572 2e78 2920 2a2a 2032  f.center.x) ** 2
+0001e300: 202f 2073 656c 662e 6d69 6e6f 725f 6178   / self.minor_ax
+0001e310: 6973 202a 2a20 3220 2b0a 2020 2020 2020  is ** 2 +.      
+0001e320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e330: 2020 2020 2020 2028 706f 696e 742e 7920         (point.y 
+0001e340: 2d20 7365 6c66 2e63 656e 7465 722e 7929  - self.center.y)
+0001e350: 202a 2a20 3220 2f20 7365 6c66 2e6d 616a   ** 2 / self.maj
+0001e360: 6f72 5f61 7869 7320 2a2a 2032 2c20 312c  or_axis ** 2, 1,
+0001e370: 2061 6273 5f74 6f6c 3d61 6273 5f74 6f6c   abs_tol=abs_tol
+0001e380: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0001e390: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
+0001e3a0: 2020 2020 6e65 775f 706f 696e 7420 3d20      new_point = 
+0001e3b0: 7365 6c66 2e66 7261 6d65 2e67 6c6f 6261  self.frame.globa
+0001e3c0: 6c5f 746f 5f6c 6f63 616c 5f63 6f6f 7264  l_to_local_coord
+0001e3d0: 696e 6174 6573 2870 6f69 6e74 290a 2020  inates(point).  
+0001e3e0: 2020 2020 2020 7531 2c20 7532 203d 206e        u1, u2 = n
+0001e3f0: 6577 5f70 6f69 6e74 2e78 202f 2073 656c  ew_point.x / sel
+0001e400: 662e 6d61 6a6f 725f 6178 6973 2c20 6e65  f.major_axis, ne
+0001e410: 775f 706f 696e 742e 7920 2f20 7365 6c66  w_point.y / self
+0001e420: 2e6d 696e 6f72 5f61 7869 730a 2020 2020  .minor_axis.    
+0001e430: 2020 2020 616e 676c 655f 6e65 775f 706f      angle_new_po
+0001e440: 696e 7420 3d20 766f 6c6d 646c 722e 6765  int = volmdlr.ge
+0001e450: 6f6d 6574 7279 2e73 696e 5f63 6f73 5f61  ometry.sin_cos_a
+0001e460: 6e67 6c65 2875 312c 2075 3229 0a20 2020  ngle(u1, u2).   
+0001e470: 2020 2020 2069 6620 7365 6c66 2e61 6e67       if self.ang
+0001e480: 6c65 5f73 7461 7274 203c 2073 656c 662e  le_start < self.
+0001e490: 616e 676c 655f 656e 6420 616e 6420 7365  angle_end and se
+0001e4a0: 6c66 2e61 6e67 6c65 5f65 6e64 203e 3d20  lf.angle_end >= 
+0001e4b0: 616e 676c 655f 6e65 775f 706f 696e 7420  angle_new_point 
+0001e4c0: 3e3d 2073 656c 662e 616e 676c 655f 7374  >= self.angle_st
+0001e4d0: 6172 743a 0a20 2020 2020 2020 2020 2020  art:.           
+0001e4e0: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
+0001e4f0: 2020 2020 2069 6620 7365 6c66 2e61 6e67       if self.ang
+0001e500: 6c65 5f73 7461 7274 203e 2073 656c 662e  le_start > self.
+0001e510: 616e 676c 655f 656e 6420 616e 6420 7365  angle_end and se
+0001e520: 6c66 2e61 6e67 6c65 5f65 6e64 203c 3d20  lf.angle_end <= 
+0001e530: 616e 676c 655f 6e65 775f 706f 696e 7420  angle_new_point 
+0001e540: 3c3d 2073 656c 662e 616e 676c 655f 7374  <= self.angle_st
+0001e550: 6172 743a 0a20 2020 2020 2020 2020 2020  art:.           
+0001e560: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
+0001e570: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
+0001e580: 650a 0a20 2020 2064 6566 2061 6273 6369  e..    def absci
+0001e590: 7373 6128 7365 6c66 2c20 706f 696e 743a  ssa(self, point:
+0001e5a0: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3244   volmdlr.Point2D
+0001e5b0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0001e5c0: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
+0001e5d0: 7320 7468 6520 6162 7363 6973 7361 206f  s the abscissa o
+0001e5e0: 6620 6120 6769 7665 6e20 706f 696e 742e  f a given point.
+0001e5f0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001e600: 2070 6f69 6e74 3a20 706f 696e 7420 666f   point: point fo
+0001e610: 7220 6361 6c63 756c 6174 696e 6720 6162  r calculating ab
+0001e620: 7363 6973 7361 0a20 2020 2020 2020 203a  scissa.        :
+0001e630: 7265 7475 726e 3a20 6120 666c 6f61 742c  return: a float,
+0001e640: 2062 6574 7765 656e 2030 2061 6e64 2074   between 0 and t
+0001e650: 6865 2061 7263 656c 6c69 7365 3264 2773  he arcellise2d's
+0001e660: 206c 656e 6774 680a 2020 2020 2020 2020   length.        
+0001e670: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
+0001e680: 656c 662e 706f 696e 745f 6265 6c6f 6e67  elf.point_belong
+0001e690: 7328 706f 696e 7429 3a0a 2020 2020 2020  s(point):.      
+0001e6a0: 2020 2020 2020 616e 676c 655f 6162 7363        angle_absc
+0001e6b0: 6973 7361 203d 2076 6f6c 6d64 6c72 2e67  issa = volmdlr.g
+0001e6c0: 656f 6d65 7472 792e 636c 6f63 6b77 6973  eometry.clockwis
+0001e6d0: 655f 616e 676c 6528 706f 696e 7420 2d20  e_angle(point - 
+0001e6e0: 7365 6c66 2e63 656e 7465 722c 2073 656c  self.center, sel
+0001e6f0: 662e 6d61 6a6f 725f 6469 7229 0a20 2020  f.major_dir).   
+0001e700: 2020 2020 2020 2020 2061 6e67 6c65 5f73           angle_s
+0001e710: 7461 7274 203d 2073 656c 662e 616e 676c  tart = self.angl
+0001e720: 655f 7374 6172 740a 2020 2020 2020 2020  e_start.        
+0001e730: 2020 2020 616e 676c 655f 656e 6420 3d20      angle_end = 
+0001e740: 616e 676c 655f 6162 7363 6973 7361 0a20  angle_abscissa. 
+0001e750: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001e760: 6c66 2e61 6e67 6c65 5f73 7461 7274 203e  lf.angle_start >
+0001e770: 2061 6e67 6c65 5f61 6273 6369 7373 6120   angle_abscissa 
+0001e780: 3e20 7365 6c66 2e61 6e67 6c65 5f65 6e64  > self.angle_end
+0001e790: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001e7a0: 2020 616e 676c 655f 7374 6172 7420 3d20    angle_start = 
+0001e7b0: 616e 676c 655f 6162 7363 6973 7361 0a20  angle_abscissa. 
+0001e7c0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0001e7d0: 6e67 6c65 5f65 6e64 203d 2073 656c 662e  ngle_end = self.
+0001e7e0: 616e 676c 655f 7374 6172 740a 0a20 2020  angle_start..   
+0001e7f0: 2020 2020 2020 2020 2064 6566 2061 7263           def arc
+0001e800: 5f6c 656e 6774 6828 7468 6574 6129 3a0a  _length(theta):.
+0001e810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e820: 7265 7475 726e 206d 6174 682e 7371 7274  return math.sqrt
+0001e830: 2828 7365 6c66 2e6d 616a 6f72 5f61 7869  ((self.major_axi
+0001e840: 7320 2a2a 2032 2920 2a20 6d61 7468 2e73  s ** 2) * math.s
+0001e850: 696e 2874 6865 7461 2920 2a2a 2032 202b  in(theta) ** 2 +
+0001e860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e880: 2020 2873 656c 662e 6d69 6e6f 725f 6178    (self.minor_ax
+0001e890: 6973 202a 2a20 3229 202a 206d 6174 682e  is ** 2) * math.
+0001e8a0: 636f 7328 7468 6574 6129 202a 2a20 3229  cos(theta) ** 2)
+0001e8b0: 0a0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+0001e8c0: 732c 205f 203d 2073 6369 7079 5f69 6e74  s, _ = scipy_int
+0001e8d0: 6567 7261 7465 2e71 7561 6428 6172 635f  egrate.quad(arc_
+0001e8e0: 6c65 6e67 7468 2c20 616e 676c 655f 7374  length, angle_st
+0001e8f0: 6172 742c 2061 6e67 6c65 5f65 6e64 290a  art, angle_end).
+0001e900: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001e910: 726e 2072 6573 0a20 2020 2020 2020 2072  rn res.        r
+0001e920: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0001e930: 6627 706f 696e 7420 7b70 6f69 6e74 7d20  f'point {point} 
+0001e940: 646f 6573 206e 6f74 2062 656c 6f6e 6720  does not belong 
+0001e950: 746f 2065 6c6c 6970 7365 2729 0a0a 2020  to ellipse')..  
+0001e960: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0001e970: 6465 6620 626f 756e 6469 6e67 5f72 6563  def bounding_rec
+0001e980: 7461 6e67 6c65 2873 656c 6629 3a0a 2020  tangle(self):.  
+0001e990: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001e9a0: 2020 4361 6c63 756c 6174 6573 2074 6865    Calculates the
+0001e9b0: 2062 6f75 6e64 696e 6720 7265 6374 616e   bounding rectan
+0001e9c0: 676c 6520 666f 7220 7468 6520 6172 6365  gle for the arce
+0001e9d0: 6c6c 6970 7365 3264 2e0a 0a20 2020 2020  llipse2d...     
+0001e9e0: 2020 203a 7265 7475 726e 3a20 766f 6c6d     :return: volm
+0001e9f0: 646c 722e 636f 7265 2e42 6f75 6469 6e67  dlr.core.Bouding
+0001ea00: 5265 6374 616e 676c 6520 6f62 6a65 6374  Rectangle object
+0001ea10: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0001ea20: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+0001ea30: 662e 5f62 6f75 6e64 696e 675f 7265 6374  f._bounding_rect
+0001ea40: 616e 676c 653a 0a20 2020 2020 2020 2020  angle:.         
+0001ea50: 2020 2064 6973 6372 6574 697a 6174 696f     discretizatio
+0001ea60: 6e5f 706f 696e 7473 203d 2073 656c 662e  n_points = self.
+0001ea70: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
+0001ea80: 6f69 6e74 7328 6e75 6d62 6572 5f70 6f69  oints(number_poi
+0001ea90: 6e74 733d 3230 290a 2020 2020 2020 2020  nts=20).        
+0001eaa0: 2020 2020 785f 7661 6c75 6573 2c20 795f      x_values, y_
+0001eab0: 7661 6c75 6573 203d 205b 5d2c 205b 5d0a  values = [], [].
+0001eac0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0001ead0: 706f 696e 7420 696e 2064 6973 6372 6574  point in discret
+0001eae0: 697a 6174 696f 6e5f 706f 696e 7473 3a0a  ization_points:.
+0001eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eb00: 785f 7661 6c75 6573 2e61 7070 656e 6428  x_values.append(
+0001eb10: 706f 696e 742e 7829 0a20 2020 2020 2020  point.x).       
+0001eb20: 2020 2020 2020 2020 2079 5f76 616c 7565           y_value
+0001eb30: 732e 6170 7065 6e64 2870 6f69 6e74 2e79  s.append(point.y
+0001eb40: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0001eb50: 6c66 2e5f 626f 756e 6469 6e67 5f72 6563  lf._bounding_rec
+0001eb60: 7461 6e67 6c65 203d 2076 6f6c 6d64 6c72  tangle = volmdlr
+0001eb70: 2e63 6f72 652e 426f 756e 6469 6e67 5265  .core.BoundingRe
+0001eb80: 6374 616e 676c 6528 6d69 6e28 785f 7661  ctangle(min(x_va
+0001eb90: 6c75 6573 292c 206d 6178 2878 5f76 616c  lues), max(x_val
+0001eba0: 7565 7329 2c0a 2020 2020 2020 2020 2020  ues),.          
+0001ebb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ebc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ebd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ebe0: 2020 2020 2020 2020 2020 2020 6d69 6e28              min(
+0001ebf0: 795f 7661 6c75 6573 292c 206d 6178 2879  y_values), max(y
+0001ec00: 5f76 616c 7565 7329 290a 2020 2020 2020  _values)).      
+0001ec10: 2020 7265 7475 726e 2073 656c 662e 5f62    return self._b
+0001ec20: 6f75 6e64 696e 675f 7265 6374 616e 676c  ounding_rectangl
+0001ec30: 650a 0a20 2020 2064 6566 2073 7472 6169  e..    def strai
+0001ec40: 6768 745f 6c69 6e65 5f61 7265 6128 7365  ght_line_area(se
+0001ec50: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0001ec60: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
+0001ec70: 7465 7320 7468 6520 6172 6561 206f 6620  tes the area of 
+0001ec80: 7468 6520 656c 6c69 7074 6963 2061 7263  the elliptic arc
+0001ec90: 2c20 7769 7468 206c 696e 6520 6472 6177  , with line draw
+0001eca0: 6e20 6672 6f6d 2073 7461 7274 2074 6f20  n from start to 
+0001ecb0: 656e 642e 0a0a 2020 2020 2020 2020 3a72  end...        :r
+0001ecc0: 6574 7572 6e3a 2073 7472 6169 6768 745f  eturn: straight_
+0001ecd0: 6c69 6e65 5f61 7265 612e 0a20 2020 2020  line_area..     
+0001ece0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0001ecf0: 6620 7365 6c66 2e61 6e67 6c65 203e 3d20  f self.angle >= 
+0001ed00: 6d61 7468 2e70 693a 0a20 2020 2020 2020  math.pi:.       
+0001ed10: 2020 2020 2061 6e67 6c65 203d 2076 6f6c       angle = vol
+0001ed20: 6d64 6c72 2e54 574f 5f50 4920 2d20 7365  mdlr.TWO_PI - se
+0001ed30: 6c66 2e61 6e67 6c65 0a20 2020 2020 2020  lf.angle.       
+0001ed40: 2020 2020 2061 7265 6120 3d20 6d61 7468       area = math
+0001ed50: 2e70 6920 2a20 7365 6c66 2e6d 616a 6f72  .pi * self.major
+0001ed60: 5f61 7869 7320 2a20 7365 6c66 2e6d 696e  _axis * self.min
+0001ed70: 6f72 5f61 7869 7320 2d20 302e 3520 2a20  or_axis - 0.5 * 
+0001ed80: 7365 6c66 2e6d 616a 6f72 5f61 7869 7320  self.major_axis 
+0001ed90: 2a20 7365 6c66 2e6d 696e 6f72 5f61 7869  * self.minor_axi
+0001eda0: 7320 2a20 280a 2020 2020 2020 2020 2020  s * (.          
+0001edb0: 2020 2020 2020 616e 676c 6520 2d20 6d61        angle - ma
+0001edc0: 7468 2e73 696e 2861 6e67 6c65 2929 0a20  th.sin(angle)). 
+0001edd0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001ede0: 2020 2020 2020 2020 2061 6e67 6c65 203d           angle =
+0001edf0: 2073 656c 662e 616e 676c 650a 2020 2020   self.angle.    
+0001ee00: 2020 2020 2020 2020 6172 6561 203d 2030          area = 0
+0001ee10: 2e35 202a 2073 656c 662e 6d61 6a6f 725f  .5 * self.major_
+0001ee20: 6178 6973 202a 2073 656c 662e 6d69 6e6f  axis * self.mino
+0001ee30: 725f 6178 6973 202a 2028 616e 676c 6520  r_axis * (angle 
+0001ee40: 2d20 6d61 7468 2e73 696e 2861 6e67 6c65  - math.sin(angle
+0001ee50: 2929 0a0a 2020 2020 2020 2020 6966 2073  ))..        if s
+0001ee60: 656c 662e 6973 5f74 7269 676f 3a0a 2020  elf.is_trigo:.  
+0001ee70: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001ee80: 2061 7265 610a 2020 2020 2020 2020 7265   area.        re
+0001ee90: 7475 726e 202d 6172 6561 0a0a 2020 2020  turn -area..    
+0001eea0: 6465 6620 6469 7363 7265 7469 7a61 7469  def discretizati
+0001eeb0: 6f6e 5f70 6f69 6e74 7328 7365 6c66 2c20  on_points(self, 
+0001eec0: 2a2c 206e 756d 6265 725f 706f 696e 7473  *, number_points
+0001eed0: 3a20 696e 7420 3d20 4e6f 6e65 2c20 616e  : int = None, an
+0001eee0: 676c 655f 7265 736f 6c75 7469 6f6e 3a20  gle_resolution: 
+0001eef0: 696e 7420 3d20 4e6f 6e65 293a 0a20 2020  int = None):.   
+0001ef00: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001ef10: 2044 6973 6372 6574 697a 6520 616e 2045   Discretize an E
+0001ef20: 6467 6520 746f 2068 6176 6520 226e 2220  dge to have "n" 
+0001ef30: 706f 696e 7473 2e0a 0a20 2020 2020 2020  points...       
+0001ef40: 203a 7061 7261 6d20 6e75 6d62 6572 5f70   :param number_p
+0001ef50: 6f69 6e74 733a 2074 6865 206e 756d 6265  oints: the numbe
+0001ef60: 7220 6f66 2070 6f69 6e74 7320 2869 6e63  r of points (inc
+0001ef70: 6c75 6469 6e67 2073 7461 7274 2061 6e64  luding start and
+0001ef80: 2065 6e64 2070 6f69 6e74 7329 0a20 2020   end points).   
+0001ef90: 2020 2020 2020 2020 2020 6966 2075 6e73            if uns
+0001efa0: 6574 2c20 6f6e 6c79 2073 7461 7274 2061  et, only start a
+0001efb0: 6e64 2065 6e64 2077 696c 6c20 6265 2072  nd end will be r
+0001efc0: 6574 7572 6e65 642e 0a20 2020 2020 2020  eturned..       
+0001efd0: 203a 7061 7261 6d20 616e 676c 655f 7265   :param angle_re
+0001efe0: 736f 6c75 7469 6f6e 3a20 6966 2073 6574  solution: if set
+0001eff0: 2c20 7468 6520 7361 6d70 6c69 6e67 2077  , the sampling w
+0001f000: 696c 6c20 6265 2061 6461 7074 6564 2074  ill be adapted t
+0001f010: 6f20 6861 7665 2061 2063 6f6e 7472 6f6c  o have a control
+0001f020: 6c65 6420 616e 6775 6c61 7220 6469 7374  led angular dist
+0001f030: 616e 6365 2e20 5573 6566 756c 0a20 2020  ance. Useful.   
+0001f040: 2020 2020 2020 2020 2074 6f20 6d65 7368           to mesh
+0001f050: 2061 6e20 6172 632e 0a20 2020 2020 2020   an arc..       
+0001f060: 203a 7265 7475 726e 3a20 6120 6c69 7374   :return: a list
+0001f070: 206f 6620 7361 6d70 6c65 6420 706f 696e   of sampled poin
+0001f080: 7473 2e0a 2020 2020 2020 2020 2222 220a  ts..        """.
+0001f090: 2020 2020 2020 2020 6966 206e 6f74 206e          if not n
+0001f0a0: 756d 6265 725f 706f 696e 7473 3a0a 2020  umber_points:.  
+0001f0b0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0001f0c0: 2061 6e67 6c65 5f72 6573 6f6c 7574 696f   angle_resolutio
+0001f0d0: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
+0001f0e0: 2020 206e 756d 6265 725f 706f 696e 7473     number_points
+0001f0f0: 203d 2032 0a20 2020 2020 2020 2020 2020   = 2.           
+0001f100: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001f110: 2020 2020 2020 206e 756d 6265 725f 706f         number_po
+0001f120: 696e 7473 203d 206d 6174 682e 6365 696c  ints = math.ceil
+0001f130: 2861 6e67 6c65 5f72 6573 6f6c 7574 696f  (angle_resolutio
+0001f140: 6e20 2a20 6162 7328 302e 3520 2a20 7365  n * abs(0.5 * se
+0001f150: 6c66 2e61 6e67 6c65 202f 206d 6174 682e  lf.angle / math.
+0001f160: 7069 2929 0a20 2020 2020 2020 2069 735f  pi)).        is_
+0001f170: 7472 6967 6f20 3d20 5472 7565 0a20 2020  trigo = True.   
+0001f180: 2020 2020 2069 6620 7365 6c66 2e61 6e67       if self.ang
+0001f190: 6c65 5f73 7461 7274 203e 2073 656c 662e  le_start > self.
+0001f1a0: 616e 676c 655f 656e 643a 0a20 2020 2020  angle_end:.     
+0001f1b0: 2020 2020 2020 2069 6620 7365 6c66 2e61         if self.a
+0001f1c0: 6e67 6c65 5f73 7461 7274 203e 3d20 7365  ngle_start >= se
+0001f1d0: 6c66 2e61 6e67 6c65 5f69 6e74 6572 696f  lf.angle_interio
+0001f1e0: 7220 3e3d 2073 656c 662e 616e 676c 655f  r >= self.angle_
+0001f1f0: 656e 643a 0a20 2020 2020 2020 2020 2020  end:.           
+0001f200: 2020 2020 2061 6e67 6c65 5f73 7461 7274       angle_start
+0001f210: 203d 2073 656c 662e 616e 676c 655f 656e   = self.angle_en
+0001f220: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0001f230: 2020 616e 676c 655f 656e 6420 3d20 7365    angle_end = se
+0001f240: 6c66 2e61 6e67 6c65 5f73 7461 7274 0a20  lf.angle_start. 
+0001f250: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001f260: 735f 7472 6967 6f20 3d20 4661 6c73 650a  s_trigo = False.
+0001f270: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0001f280: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001f290: 2020 616e 676c 655f 656e 6420 3d20 7365    angle_end = se
+0001f2a0: 6c66 2e61 6e67 6c65 5f65 6e64 202b 2076  lf.angle_end + v
+0001f2b0: 6f6c 6d64 6c72 2e54 574f 5f50 490a 2020  olmdlr.TWO_PI.  
+0001f2c0: 2020 2020 2020 2020 2020 2020 2020 616e                an
+0001f2d0: 676c 655f 7374 6172 7420 3d20 7365 6c66  gle_start = self
+0001f2e0: 2e61 6e67 6c65 5f73 7461 7274 0a20 2020  .angle_start.   
+0001f2f0: 2020 2020 2065 6c69 6620 7365 6c66 2e61       elif self.a
+0001f300: 6e67 6c65 5f73 7461 7274 203d 3d20 7365  ngle_start == se
+0001f310: 6c66 2e61 6e67 6c65 5f65 6e64 3a0a 2020  lf.angle_end:.  
+0001f320: 2020 2020 2020 2020 2020 616e 676c 655f            angle_
+0001f330: 7374 6172 7420 3d20 300a 2020 2020 2020  start = 0.      
+0001f340: 2020 2020 2020 616e 676c 655f 656e 6420        angle_end 
+0001f350: 3d20 3220 2a20 6d61 7468 2e70 690a 2020  = 2 * math.pi.  
+0001f360: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001f370: 2020 2020 2020 2020 616e 676c 655f 656e          angle_en
+0001f380: 6420 3d20 7365 6c66 2e61 6e67 6c65 5f65  d = self.angle_e
+0001f390: 6e64 0a20 2020 2020 2020 2020 2020 2061  nd.            a
+0001f3a0: 6e67 6c65 5f73 7461 7274 203d 2073 656c  ngle_start = sel
+0001f3b0: 662e 616e 676c 655f 7374 6172 740a 0a20  f.angle_start.. 
+0001f3c0: 2020 2020 2020 2064 6973 6372 6574 697a         discretiz
+0001f3d0: 6174 696f 6e5f 706f 696e 7473 203d 205b  ation_points = [
+0001f3e0: 7365 6c66 2e66 7261 6d65 2e6c 6f63 616c  self.frame.local
+0001f3f0: 5f74 6f5f 676c 6f62 616c 5f63 6f6f 7264  _to_global_coord
+0001f400: 696e 6174 6573 280a 2020 2020 2020 2020  inates(.        
+0001f410: 2020 2020 766f 6c6d 646c 722e 506f 696e      volmdlr.Poin
+0001f420: 7432 4428 7365 6c66 2e6d 616a 6f72 5f61  t2D(self.major_a
+0001f430: 7869 7320 2a20 6d61 7468 2e63 6f73 2861  xis * math.cos(a
+0001f440: 6e67 6c65 292c 2073 656c 662e 6d69 6e6f  ngle), self.mino
+0001f450: 725f 6178 6973 202a 206d 6174 682e 7369  r_axis * math.si
+0001f460: 6e28 616e 676c 6529 2929 0a20 2020 2020  n(angle))).     
+0001f470: 2020 2020 2020 2066 6f72 2061 6e67 6c65         for angle
+0001f480: 2069 6e20 6e70 792e 6c69 6e73 7061 6365   in npy.linspace
+0001f490: 2861 6e67 6c65 5f73 7461 7274 2c20 616e  (angle_start, an
+0001f4a0: 676c 655f 656e 642c 206e 756d 6265 725f  gle_end, number_
+0001f4b0: 706f 696e 7473 295d 0a20 2020 2020 2020  points)].       
+0001f4c0: 2069 6620 6e6f 7420 6973 5f74 7269 676f   if not is_trigo
+0001f4d0: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
+0001f4e0: 7363 7265 7469 7a61 7469 6f6e 5f70 6f69  scretization_poi
+0001f4f0: 6e74 7320 3d20 6469 7363 7265 7469 7a61  nts = discretiza
+0001f500: 7469 6f6e 5f70 6f69 6e74 735b 3a3a 2d31  tion_points[::-1
+0001f510: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
+0001f520: 2064 6973 6372 6574 697a 6174 696f 6e5f   discretization_
+0001f530: 706f 696e 7473 0a0a 2020 2020 6465 6620  points..    def 
+0001f540: 706f 6c79 676f 6e5f 706f 696e 7473 2873  polygon_points(s
+0001f550: 656c 662c 2064 6973 6372 6574 697a 6174  elf, discretizat
+0001f560: 696f 6e5f 7265 736f 6c75 7469 6f6e 3a20  ion_resolution: 
+0001f570: 696e 7429 3a0a 2020 2020 2020 2020 7761  int):.        wa
+0001f580: 726e 696e 6773 2e77 6172 6e28 2770 6f6c  rnings.warn('pol
+0001f590: 7967 6f6e 5f70 6f69 6e74 7320 6973 2064  ygon_points is d
+0001f5a0: 6570 7265 6361 7465 642c 5c0a 2020 2020  eprecated,\.    
+0001f5b0: 2020 2020 2020 2020 2020 2020 706c 6561              plea
+0001f5c0: 7365 2075 7365 2064 6973 6372 6574 697a  se use discretiz
+0001f5d0: 6174 696f 6e5f 706f 696e 7473 2069 6e73  ation_points ins
+0001f5e0: 7465 6164 272c 0a20 2020 2020 2020 2020  tead',.         
+0001f5f0: 2020 2020 2020 2020 2020 2020 2044 6570               Dep
+0001f600: 7265 6361 7469 6f6e 5761 726e 696e 6729  recationWarning)
+0001f610: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001f620: 7365 6c66 2e64 6973 6372 6574 697a 6174  self.discretizat
+0001f630: 696f 6e5f 706f 696e 7473 2861 6e67 6c65  ion_points(angle
+0001f640: 5f72 6573 6f6c 7574 696f 6e3d 6469 7363  _resolution=disc
+0001f650: 7265 7469 7a61 7469 6f6e 5f72 6573 6f6c  retization_resol
+0001f660: 7574 696f 6e29 0a0a 2020 2020 6465 6620  ution)..    def 
+0001f670: 746f 5f33 6428 7365 6c66 2c20 706c 616e  to_3d(self, plan
+0001f680: 655f 6f72 6967 696e 2c20 782c 2079 293a  e_origin, x, y):
+0001f690: 0a20 2020 2020 2020 2070 6f69 6e74 5f73  .        point_s
+0001f6a0: 7461 7274 3364 203d 2073 656c 662e 7374  tart3d = self.st
+0001f6b0: 6172 742e 746f 5f33 6428 706c 616e 655f  art.to_3d(plane_
+0001f6c0: 6f72 6967 696e 2c20 782c 2079 290a 2020  origin, x, y).  
+0001f6d0: 2020 2020 2020 706f 696e 745f 696e 7465        point_inte
+0001f6e0: 7269 6f72 3364 203d 2073 656c 662e 696e  rior3d = self.in
+0001f6f0: 7465 7269 6f72 2e74 6f5f 3364 2870 6c61  terior.to_3d(pla
+0001f700: 6e65 5f6f 7269 6769 6e2c 2078 2c20 7929  ne_origin, x, y)
+0001f710: 0a20 2020 2020 2020 2070 6f69 6e74 5f65  .        point_e
+0001f720: 6e64 3364 203d 2073 656c 662e 656e 642e  nd3d = self.end.
+0001f730: 746f 5f33 6428 706c 616e 655f 6f72 6967  to_3d(plane_orig
+0001f740: 696e 2c20 782c 2079 290a 2020 2020 2020  in, x, y).      
+0001f750: 2020 706f 696e 745f 6365 6e74 6572 3364    point_center3d
+0001f760: 203d 2073 656c 662e 6365 6e74 6572 2e74   = self.center.t
+0001f770: 6f5f 3364 2870 6c61 6e65 5f6f 7269 6769  o_3d(plane_origi
+0001f780: 6e2c 2078 2c20 7929 0a0a 2020 2020 2020  n, x, y)..      
+0001f790: 2020 615f 6d61 7832 6420 3d20 7365 6c66    a_max2d = self
+0001f7a0: 2e63 656e 7465 7220 2b20 7365 6c66 2e6d  .center + self.m
+0001f7b0: 616a 6f72 5f64 6972 202a 2073 656c 662e  ajor_dir * self.
+0001f7c0: 6d61 6a6f 725f 6178 6973 0a20 2020 2020  major_axis.     
+0001f7d0: 2020 2061 5f6d 6178 3364 203d 2061 5f6d     a_max3d = a_m
+0001f7e0: 6178 3264 2e74 6f5f 3364 2870 6c61 6e65  ax2d.to_3d(plane
+0001f7f0: 5f6f 7269 6769 6e2c 2078 2c20 7929 0a20  _origin, x, y). 
+0001f800: 2020 2020 2020 206e 6577 5f6d 616a 6f72         new_major
+0001f810: 5f64 6972 203d 2061 5f6d 6178 3364 202d  _dir = a_max3d -
+0001f820: 2070 6f69 6e74 5f63 656e 7465 7233 640a   point_center3d.
+0001f830: 2020 2020 2020 2020 6e65 775f 6d61 6a6f          new_majo
+0001f840: 725f 6469 722e 6e6f 726d 616c 697a 6528  r_dir.normalize(
+0001f850: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0001f860: 2041 7263 456c 6c69 7073 6533 4428 706f   ArcEllipse3D(po
+0001f870: 696e 745f 7374 6172 7433 642c 2070 6f69  int_start3d, poi
+0001f880: 6e74 5f69 6e74 6572 696f 7233 642c 2070  nt_interior3d, p
+0001f890: 6f69 6e74 5f65 6e64 3364 2c0a 2020 2020  oint_end3d,.    
+0001f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f8b0: 2020 2020 2020 2020 706f 696e 745f 6365          point_ce
+0001f8c0: 6e74 6572 3364 2c20 6e65 775f 6d61 6a6f  nter3d, new_majo
+0001f8d0: 725f 6469 722c 206e 616d 653d 7365 6c66  r_dir, name=self
+0001f8e0: 2e6e 616d 6529 0a0a 2020 2020 6465 6620  .name)..    def 
+0001f8f0: 706c 6f74 2873 656c 662c 2061 783d 4e6f  plot(self, ax=No
+0001f900: 6e65 2c20 636f 6c6f 723d 276b 272c 2061  ne, color='k', a
+0001f910: 6c70 6861 3d31 293a 0a20 2020 2020 2020  lpha=1):.       
+0001f920: 2069 6620 6178 2069 7320 4e6f 6e65 3a0a   if ax is None:.
+0001f930: 2020 2020 2020 2020 2020 2020 5f2c 2061              _, a
+0001f940: 7820 3d20 706c 742e 7375 6270 6c6f 7473  x = plt.subplots
+0001f950: 2829 0a0a 2020 2020 2020 2020 7365 6c66  ()..        self
+0001f960: 2e69 6e74 6572 696f 722e 706c 6f74 2861  .interior.plot(a
+0001f970: 783d 6178 2c20 636f 6c6f 723d 276d 2729  x=ax, color='m')
+0001f980: 0a20 2020 2020 2020 2073 656c 662e 7374  .        self.st
+0001f990: 6172 742e 706c 6f74 2861 783d 6178 2c20  art.plot(ax=ax, 
+0001f9a0: 636f 6c6f 723d 2772 2729 0a20 2020 2020  color='r').     
+0001f9b0: 2020 2073 656c 662e 656e 642e 706c 6f74     self.end.plot
+0001f9c0: 2861 783d 6178 2c20 636f 6c6f 723d 2762  (ax=ax, color='b
+0001f9d0: 2729 0a20 2020 2020 2020 2073 656c 662e  ').        self.
+0001f9e0: 6365 6e74 6572 2e70 6c6f 7428 6178 3d61  center.plot(ax=a
+0001f9f0: 782c 2063 6f6c 6f72 3d27 7927 290a 0a20  x, color='y').. 
+0001fa00: 2020 2020 2020 2078 203d 205b 5d0a 2020         x = [].  
+0001fa10: 2020 2020 2020 7920 3d20 5b5d 0a20 2020        y = [].   
+0001fa20: 2020 2020 2066 6f72 2070 782c 2070 7920       for px, py 
+0001fa30: 696e 2073 656c 662e 6469 7363 7265 7469  in self.discreti
+0001fa40: 7a61 7469 6f6e 5f70 6f69 6e74 7328 6e75  zation_points(nu
+0001fa50: 6d62 6572 5f70 6f69 6e74 733d 3130 3029  mber_points=100)
+0001fa60: 3a0a 2020 2020 2020 2020 2020 2020 782e  :.            x.
+0001fa70: 6170 7065 6e64 2870 7829 0a20 2020 2020  append(px).     
+0001fa80: 2020 2020 2020 2079 2e61 7070 656e 6428         y.append(
+0001fa90: 7079 290a 0a20 2020 2020 2020 2070 6c74  py)..        plt
+0001faa0: 2e70 6c6f 7428 782c 2079 2c20 636f 6c6f  .plot(x, y, colo
+0001fab0: 723d 636f 6c6f 722c 2061 6c70 6861 3d61  r=color, alpha=a
+0001fac0: 6c70 6861 290a 2020 2020 2020 2020 7265  lpha).        re
+0001fad0: 7475 726e 2061 780a 0a20 2020 2064 6566  turn ax..    def
+0001fae0: 206e 6f72 6d61 6c5f 7665 6374 6f72 2873   normal_vector(s
+0001faf0: 656c 662c 2061 6273 6369 7373 6129 3a0a  elf, abscissa):.
+0001fb00: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+0001fb10: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+0001fb20: 720a 0a20 2020 2064 6566 2075 6e69 745f  r..    def unit_
+0001fb30: 6e6f 726d 616c 5f76 6563 746f 7228 7365  normal_vector(se
+0001fb40: 6c66 2c20 6162 7363 6973 7361 293a 0a20  lf, abscissa):. 
+0001fb50: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+0001fb60: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+0001fb70: 0a0a 2020 2020 6465 6620 6469 7265 6374  ..    def direct
+0001fb80: 696f 6e5f 7665 6374 6f72 2873 656c 662c  ion_vector(self,
+0001fb90: 2061 6273 6369 7373 6129 3a0a 2020 2020   abscissa):.    
+0001fba0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+0001fbb0: 6c65 6d65 6e74 6564 4572 726f 720a 0a20  lementedError.. 
+0001fbc0: 2020 2064 6566 2075 6e69 745f 6469 7265     def unit_dire
+0001fbd0: 6374 696f 6e5f 7665 6374 6f72 2873 656c  ction_vector(sel
+0001fbe0: 662c 2061 6273 6369 7373 6129 3a0a 2020  f, abscissa):.  
+0001fbf0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+0001fc00: 6d70 6c65 6d65 6e74 6564 4572 726f 720a  mplementedError.
+0001fc10: 0a20 2020 2064 6566 2072 6576 6572 7365  .    def reverse
+0001fc20: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0001fc30: 7265 7475 726e 2073 656c 662e 5f5f 636c  return self.__cl
+0001fc40: 6173 735f 5f28 7365 6c66 2e65 6e64 2e63  ass__(self.end.c
+0001fc50: 6f70 7928 292c 2073 656c 662e 696e 7465  opy(), self.inte
+0001fc60: 7269 6f72 2e63 6f70 7928 292c 2073 656c  rior.copy(), sel
+0001fc70: 662e 7374 6172 742e 636f 7079 2829 2c0a  f.start.copy(),.
+0001fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc90: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001fca0: 6c66 2e63 656e 7465 722e 636f 7079 2829  lf.center.copy()
+0001fcb0: 2c20 7365 6c66 2e6d 616a 6f72 5f64 6972  , self.major_dir
+0001fcc0: 2e63 6f70 7928 292c 2073 656c 662e 6e61  .copy(), self.na
+0001fcd0: 6d65 290a 0a20 2020 2064 6566 206c 696e  me)..    def lin
+0001fce0: 655f 696e 7465 7273 6563 7469 6f6e 7328  e_intersections(
+0001fcf0: 7365 6c66 2c20 6c69 6e65 3264 3a20 4c69  self, line2d: Li
+0001fd00: 6e65 3244 293a 0a20 2020 2020 2020 2022  ne2D):.        "
+0001fd10: 2222 0a20 2020 2020 2020 2049 6e74 6572  "".        Inter
+0001fd20: 7365 6374 696f 6e73 2062 6574 7765 656e  sections between
+0001fd30: 2061 6e20 4172 6345 6c6c 6970 7365 3244   an ArcEllipse2D
+0001fd40: 2061 6e64 2061 204c 696e 6532 442e 0a0a   and a Line2D...
+0001fd50: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
+0001fd60: 696e 6532 643a 204c 696e 6532 4420 746f  ine2d: Line2D to
+0001fd70: 2076 6572 6966 7920 696e 7465 7273 6563   verify intersec
+0001fd80: 7469 6f6e 730a 2020 2020 2020 2020 3a72  tions.        :r
+0001fd90: 6574 7572 6e3a 204c 6973 7420 7769 7468  eturn: List with
+0001fda0: 2061 6c6c 2069 6e74 6572 7365 6374 696f   all intersectio
+0001fdb0: 6e73 0a20 2020 2020 2020 2022 2222 0a20  ns.        """. 
+0001fdc0: 2020 2020 2020 2065 6c6c 6970 7365 3264         ellipse2d
+0001fdd0: 5f6c 696e 6573 6567 6d65 6e74 5f69 6e74  _linesegment_int
+0001fde0: 6572 7365 6374 696f 6e73 203d 2076 6d5f  ersections = vm_
+0001fdf0: 7574 696c 735f 696e 7465 7273 6563 7469  utils_intersecti
+0001fe00: 6f6e 732e 656c 6c69 7073 6532 645f 6c69  ons.ellipse2d_li
+0001fe10: 6e65 5f69 6e74 6572 7365 6374 696f 6e73  ne_intersections
+0001fe20: 2873 656c 662c 206c 696e 6532 6429 0a20  (self, line2d). 
+0001fe30: 2020 2020 2020 206c 696e 6573 6567 6d65         linesegme
+0001fe40: 6e74 5f69 6e74 6572 7365 6374 696f 6e73  nt_intersections
+0001fe50: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
+0001fe60: 7220 696e 7465 7220 696e 2065 6c6c 6970  r inter in ellip
+0001fe70: 7365 3264 5f6c 696e 6573 6567 6d65 6e74  se2d_linesegment
+0001fe80: 5f69 6e74 6572 7365 6374 696f 6e73 3a0a  _intersections:.
+0001fe90: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001fea0: 656c 662e 706f 696e 745f 6265 6c6f 6e67  elf.point_belong
+0001feb0: 7328 696e 7465 7229 3a0a 2020 2020 2020  s(inter):.      
+0001fec0: 2020 2020 2020 2020 2020 6c69 6e65 7365            linese
+0001fed0: 676d 656e 745f 696e 7465 7273 6563 7469  gment_intersecti
+0001fee0: 6f6e 732e 6170 7065 6e64 2869 6e74 6572  ons.append(inter
+0001fef0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0001ff00: 206c 696e 6573 6567 6d65 6e74 5f69 6e74   linesegment_int
+0001ff10: 6572 7365 6374 696f 6e73 0a0a 2020 2020  ersections..    
+0001ff20: 6465 6620 6c69 6e65 7365 676d 656e 745f  def linesegment_
+0001ff30: 696e 7465 7273 6563 7469 6f6e 7328 7365  intersections(se
+0001ff40: 6c66 2c20 6c69 6e65 7365 676d 656e 7432  lf, linesegment2
+0001ff50: 643a 204c 696e 6553 6567 6d65 6e74 3244  d: LineSegment2D
+0001ff60: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0001ff70: 2020 2020 2020 2049 6e74 6572 7365 6374         Intersect
+0001ff80: 696f 6e73 2062 6574 7765 656e 2061 6e20  ions between an 
+0001ff90: 4172 6345 6c6c 6970 7365 3244 2061 6e64  ArcEllipse2D and
+0001ffa0: 2061 204c 696e 6553 6567 6d65 6e74 3244   a LineSegment2D
+0001ffb0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0001ffc0: 6d20 6c69 6e65 7365 676d 656e 7432 643a  m linesegment2d:
+0001ffd0: 204c 696e 6553 6567 6d65 6e74 3244 2074   LineSegment2D t
+0001ffe0: 6f20 7665 7269 6679 2069 6e74 6572 7365  o verify interse
+0001fff0: 6374 696f 6e73 0a20 2020 2020 2020 203a  ctions.        :
+00020000: 7265 7475 726e 3a20 4c69 7374 2077 6974  return: List wit
+00020010: 6820 616c 6c20 696e 7465 7273 6563 7469  h all intersecti
+00020020: 6f6e 730a 2020 2020 2020 2020 2222 220a  ons.        """.
+00020030: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00020040: 656c 662e 626f 756e 6469 6e67 5f72 6563  elf.bounding_rec
+00020050: 7461 6e67 6c65 2e62 5f72 6563 7461 6e67  tangle.b_rectang
+00020060: 6c65 5f69 6e74 6572 7365 6374 696f 6e28  le_intersection(
+00020070: 6c69 6e65 7365 676d 656e 7432 642e 626f  linesegment2d.bo
+00020080: 756e 6469 6e67 5f72 6563 7461 6e67 6c65  unding_rectangle
+00020090: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+000200a0: 6574 7572 6e20 5b5d 0a20 2020 2020 2020  eturn [].       
+000200b0: 2069 6e74 6572 7365 6374 696f 6e73 203d   intersections =
+000200c0: 2073 656c 662e 6c69 6e65 5f69 6e74 6572   self.line_inter
+000200d0: 7365 6374 696f 6e73 286c 696e 6573 6567  sections(lineseg
+000200e0: 6d65 6e74 3264 290a 2020 2020 2020 2020  ment2d).        
+000200f0: 6c69 6e65 7365 676d 656e 745f 696e 7465  linesegment_inte
+00020100: 7273 6563 7469 6f6e 7320 3d20 5b5d 0a20  rsections = []. 
+00020110: 2020 2020 2020 2066 6f72 2069 6e74 6572         for inter
+00020120: 2069 6e20 696e 7465 7273 6563 7469 6f6e   in intersection
+00020130: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
+00020140: 6620 6c69 6e65 7365 676d 656e 7432 642e  f linesegment2d.
+00020150: 706f 696e 745f 6265 6c6f 6e67 7328 696e  point_belongs(in
+00020160: 7465 7229 3a0a 2020 2020 2020 2020 2020  ter):.          
+00020170: 2020 2020 2020 6c69 6e65 7365 676d 656e        linesegmen
+00020180: 745f 696e 7465 7273 6563 7469 6f6e 732e  t_intersections.
+00020190: 6170 7065 6e64 2869 6e74 6572 290a 2020  append(inter).  
+000201a0: 2020 2020 2020 7265 7475 726e 206c 696e        return lin
+000201b0: 6573 6567 6d65 6e74 5f69 6e74 6572 7365  esegment_interse
+000201c0: 6374 696f 6e73 0a0a 2020 2020 6465 6620  ctions..    def 
+000201d0: 6672 616d 655f 6d61 7070 696e 6728 7365  frame_mapping(se
+000201e0: 6c66 2c20 6672 616d 653a 2076 6f6c 6d64  lf, frame: volmd
+000201f0: 6c72 2e46 7261 6d65 3244 2c20 7369 6465  lr.Frame2D, side
+00020200: 3a20 7374 7229 3a0a 2020 2020 2020 2020  : str):.        
+00020210: 2222 220a 2020 2020 2020 2020 4368 616e  """.        Chan
+00020220: 6765 7320 6672 616d 655f 6d61 7070 696e  ges frame_mappin
+00020230: 6720 616e 6420 7265 7475 726e 2061 206e  g and return a n
+00020240: 6577 2041 7263 456c 6c69 7073 6532 442e  ew ArcEllipse2D.
+00020250: 0a0a 2020 2020 2020 2020 7369 6465 203d  ..        side =
+00020260: 2027 6f6c 6427 206f 7220 276e 6577 270a   'old' or 'new'.
+00020270: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00020280: 2020 2020 6966 2073 6964 6520 3d3d 2027      if side == '
+00020290: 6f6c 6427 3a0a 2020 2020 2020 2020 2020  old':.          
+000202a0: 2020 7265 7475 726e 2041 7263 456c 6c69    return ArcElli
+000202b0: 7073 6532 4428 6672 616d 652e 6c6f 6361  pse2D(frame.loca
+000202c0: 6c5f 746f 5f67 6c6f 6261 6c5f 636f 6f72  l_to_global_coor
+000202d0: 6469 6e61 7465 7328 7365 6c66 2e73 7461  dinates(self.sta
+000202e0: 7274 292c 0a20 2020 2020 2020 2020 2020  rt),.           
+000202f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020300: 2020 2020 2066 7261 6d65 2e6c 6f63 616c       frame.local
+00020310: 5f74 6f5f 676c 6f62 616c 5f63 6f6f 7264  _to_global_coord
+00020320: 696e 6174 6573 2873 656c 662e 696e 7465  inates(self.inte
+00020330: 7269 6f72 292c 0a20 2020 2020 2020 2020  rior),.         
+00020340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020350: 2020 2020 2020 2066 7261 6d65 2e6c 6f63         frame.loc
+00020360: 616c 5f74 6f5f 676c 6f62 616c 5f63 6f6f  al_to_global_coo
+00020370: 7264 696e 6174 6573 2873 656c 662e 656e  rdinates(self.en
+00020380: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
+00020390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000203a0: 2020 2020 6672 616d 652e 6c6f 6361 6c5f      frame.local_
+000203b0: 746f 5f67 6c6f 6261 6c5f 636f 6f72 6469  to_global_coordi
+000203c0: 6e61 7465 7328 7365 6c66 2e63 656e 7465  nates(self.cente
+000203d0: 7229 2c0a 2020 2020 2020 2020 2020 2020  r),.            
+000203e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000203f0: 2020 2020 7365 6c66 2e6d 616a 6f72 5f64      self.major_d
+00020400: 6972 290a 2020 2020 2020 2020 6966 2073  ir).        if s
+00020410: 6964 6520 3d3d 2027 6e65 7727 3a0a 2020  ide == 'new':.  
+00020420: 2020 2020 2020 2020 2020 706f 696e 745f            point_
+00020430: 6d61 6a6f 725f 6469 7220 3d20 7365 6c66  major_dir = self
+00020440: 2e63 656e 7465 7220 2b20 7365 6c66 2e6d  .center + self.m
+00020450: 616a 6f72 5f64 6972 202a 2073 656c 662e  ajor_dir * self.
+00020460: 6d61 6a6f 725f 6178 6973 0a20 2020 2020  major_axis.     
+00020470: 2020 2020 2020 206d 616a 6f72 5f64 6972         major_dir
+00020480: 203d 2066 7261 6d65 2e67 6c6f 6261 6c5f   = frame.global_
+00020490: 746f 5f6c 6f63 616c 5f63 6f6f 7264 696e  to_local_coordin
+000204a0: 6174 6573 2870 6f69 6e74 5f6d 616a 6f72  ates(point_major
+000204b0: 5f64 6972 290a 2020 2020 2020 2020 2020  _dir).          
+000204c0: 2020 6d61 6a6f 725f 6469 722e 6e6f 726d    major_dir.norm
+000204d0: 616c 697a 6528 290a 2020 2020 2020 2020  alize().        
+000204e0: 2020 2020 7265 7475 726e 2041 7263 456c      return ArcEl
+000204f0: 6c69 7073 6532 4428 6672 616d 652e 676c  lipse2D(frame.gl
+00020500: 6f62 616c 5f74 6f5f 6c6f 6361 6c5f 636f  obal_to_local_co
+00020510: 6f72 6469 6e61 7465 7328 7365 6c66 2e73  ordinates(self.s
+00020520: 7461 7274 292c 0a20 2020 2020 2020 2020  tart),.         
+00020530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020540: 2020 2020 2020 2066 7261 6d65 2e67 6c6f         frame.glo
+00020550: 6261 6c5f 746f 5f6c 6f63 616c 5f63 6f6f  bal_to_local_coo
+00020560: 7264 696e 6174 6573 2873 656c 662e 696e  rdinates(self.in
+00020570: 7465 7269 6f72 292c 0a20 2020 2020 2020  terior),.       
+00020580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020590: 2020 2020 2020 2020 2066 7261 6d65 2e67           frame.g
+000205a0: 6c6f 6261 6c5f 746f 5f6c 6f63 616c 5f63  lobal_to_local_c
+000205b0: 6f6f 7264 696e 6174 6573 2873 656c 662e  oordinates(self.
+000205c0: 656e 6429 2c0a 2020 2020 2020 2020 2020  end),.          
+000205d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000205e0: 2020 2020 2020 6672 616d 652e 676c 6f62        frame.glob
+000205f0: 616c 5f74 6f5f 6c6f 6361 6c5f 636f 6f72  al_to_local_coor
+00020600: 6469 6e61 7465 7328 7365 6c66 2e63 656e  dinates(self.cen
+00020610: 7465 7229 2c0a 2020 2020 2020 2020 2020  ter),.          
+00020620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020630: 2020 2020 2020 6d61 6a6f 725f 6469 7229        major_dir)
+00020640: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+00020650: 616c 7565 4572 726f 7228 2753 6964 6520  alueError('Side 
+00020660: 7368 6f75 6c64 2062 6520 5c27 6e65 775c  should be \'new\
+00020670: 2720 5c27 6f6c 645c 2727 290a 0a0a 636c  ' \'old\'')...cl
+00020680: 6173 7320 4c69 6e65 3344 284c 696e 6529  ass Line3D(Line)
+00020690: 3a0a 2020 2020 2222 220a 2020 2020 4465  :.    """.    De
+000206a0: 6669 6e65 2061 6e20 696e 6669 6e69 7465  fine an infinite
+000206b0: 206c 696e 6520 7061 7373 696e 6720 7468   line passing th
+000206c0: 726f 7567 6820 7468 6520 3220 706f 696e  rough the 2 poin
+000206d0: 7473 2e0a 0a20 2020 2022 2222 0a20 2020  ts...    """.   
+000206e0: 205f 6e6f 6e5f 6571 5f61 7474 7269 6275   _non_eq_attribu
+000206f0: 7465 7320 3d20 5b27 6e61 6d65 272c 2027  tes = ['name', '
+00020700: 6261 7369 735f 7072 696d 6974 6976 6573  basis_primitives
+00020710: 272c 2027 626f 756e 6469 6e67 5f62 6f78  ', 'bounding_box
+00020720: 275d 0a0a 2020 2020 6465 6620 5f5f 696e  ']..    def __in
+00020730: 6974 5f5f 2873 656c 662c 2070 6f69 6e74  it__(self, point
+00020740: 313a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  1: volmdlr.Point
+00020750: 3344 2c20 706f 696e 7432 3a20 766f 6c6d  3D, point2: volm
+00020760: 646c 722e 506f 696e 7433 442c 0a20 2020  dlr.Point3D,.   
+00020770: 2020 2020 2020 2020 2020 2020 2020 6e61                na
+00020780: 6d65 3a20 7374 7220 3d20 2727 293a 0a20  me: str = ''):. 
+00020790: 2020 2020 2020 204c 696e 652e 5f5f 696e         Line.__in
+000207a0: 6974 5f5f 2873 656c 662c 2070 6f69 6e74  it__(self, point
+000207b0: 312c 2070 6f69 6e74 322c 206e 616d 653d  1, point2, name=
+000207c0: 6e61 6d65 290a 2020 2020 2020 2020 2320  name).        # 
+000207d0: 7365 6c66 2e70 6f69 6e74 7320 3d20 5b70  self.points = [p
+000207e0: 6f69 6e74 312c 2070 6f69 6e74 325d 0a20  oint1, point2]. 
+000207f0: 2020 2020 2020 2073 656c 662e 5f62 626f         self._bbo
+00020800: 7820 3d20 4e6f 6e65 0a0a 2020 2020 4070  x = None..    @p
+00020810: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00020820: 626f 756e 6469 6e67 5f62 6f78 2873 656c  bounding_box(sel
+00020830: 6629 3a0a 2020 2020 2020 2020 6966 206e  f):.        if n
+00020840: 6f74 2073 656c 662e 5f62 626f 783a 0a20  ot self._bbox:. 
+00020850: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00020860: 5f62 626f 7820 3d20 7365 6c66 2e5f 626f  _bbox = self._bo
+00020870: 756e 6469 6e67 5f62 6f78 2829 0a20 2020  unding_box().   
+00020880: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00020890: 2e5f 6262 6f78 0a0a 2020 2020 4062 6f75  ._bbox..    @bou
+000208a0: 6e64 696e 675f 626f 782e 7365 7474 6572  nding_box.setter
+000208b0: 0a20 2020 2064 6566 2062 6f75 6e64 696e  .    def boundin
+000208c0: 675f 626f 7828 7365 6c66 2c20 6e65 775f  g_box(self, new_
+000208d0: 626f 756e 6469 6e67 5f62 6f78 293a 0a20  bounding_box):. 
+000208e0: 2020 2020 2020 2073 656c 662e 5f62 626f         self._bbo
+000208f0: 7820 3d20 6e65 775f 626f 756e 6469 6e67  x = new_bounding
+00020900: 5f62 6f78 0a0a 2020 2020 6465 6620 5f62  _box..    def _b
+00020910: 6f75 6e64 696e 675f 626f 7828 7365 6c66  ounding_box(self
+00020920: 293a 0a20 2020 2020 2020 2078 6d69 6e20  ):.        xmin 
+00020930: 3d20 6d69 6e28 5b73 656c 662e 706f 696e  = min([self.poin
+00020940: 7431 5b30 5d2c 2073 656c 662e 706f 696e  t1[0], self.poin
+00020950: 7432 5b30 5d5d 290a 2020 2020 2020 2020  t2[0]]).        
+00020960: 786d 6178 203d 206d 6178 285b 7365 6c66  xmax = max([self
+00020970: 2e70 6f69 6e74 315b 305d 2c20 7365 6c66  .point1[0], self
+00020980: 2e70 6f69 6e74 325b 305d 5d29 0a20 2020  .point2[0]]).   
+00020990: 2020 2020 2079 6d69 6e20 3d20 6d69 6e28       ymin = min(
+000209a0: 5b73 656c 662e 706f 696e 7431 5b31 5d2c  [self.point1[1],
+000209b0: 2073 656c 662e 706f 696e 7432 5b31 5d5d   self.point2[1]]
+000209c0: 290a 2020 2020 2020 2020 796d 6178 203d  ).        ymax =
+000209d0: 206d 6178 285b 7365 6c66 2e70 6f69 6e74   max([self.point
+000209e0: 315b 315d 2c20 7365 6c66 2e70 6f69 6e74  1[1], self.point
+000209f0: 325b 315d 5d29 0a20 2020 2020 2020 207a  2[1]]).        z
+00020a00: 6d69 6e20 3d20 6d69 6e28 5b73 656c 662e  min = min([self.
+00020a10: 706f 696e 7431 5b32 5d2c 2073 656c 662e  point1[2], self.
+00020a20: 706f 696e 7432 5b32 5d5d 290a 2020 2020  point2[2]]).    
+00020a30: 2020 2020 7a6d 6178 203d 206d 6178 285b      zmax = max([
+00020a40: 7365 6c66 2e70 6f69 6e74 315b 325d 2c20  self.point1[2], 
+00020a50: 7365 6c66 2e70 6f69 6e74 325b 325d 5d29  self.point2[2]])
+00020a60: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00020a70: 2076 6f6c 6d64 6c72 2e63 6f72 652e 426f   volmdlr.core.Bo
+00020a80: 756e 6469 6e67 426f 7828 786d 696e 2c20  undingBox(xmin, 
+00020a90: 786d 6178 2c20 796d 696e 2c20 796d 6178  xmax, ymin, ymax
+00020aa0: 2c20 7a6d 696e 2c20 7a6d 6178 290a 0a20  , zmin, zmax).. 
+00020ab0: 2020 2064 6566 2070 6f69 6e74 5f61 745f     def point_at_
+00020ac0: 6162 7363 6973 7361 2873 656c 662c 2061  abscissa(self, a
+00020ad0: 6273 6369 7373 6129 3a0a 2020 2020 2020  bscissa):.      
+00020ae0: 2020 7265 7475 726e 2073 656c 662e 706f    return self.po
+00020af0: 696e 7431 202b 2028 0a20 2020 2020 2020  int1 + (.       
+00020b00: 2020 2020 2073 656c 662e 706f 696e 7432       self.point2
+00020b10: 202d 2073 656c 662e 706f 696e 7431 2920   - self.point1) 
+00020b20: 2a20 6162 7363 6973 7361 0a0a 2020 2020  * abscissa..    
+00020b30: 6465 6620 706f 696e 745f 6265 6c6f 6e67  def point_belong
+00020b40: 7328 7365 6c66 2c20 706f 696e 7433 6429  s(self, point3d)
+00020b50: 3a0a 2020 2020 2020 2020 6966 2070 6f69  :.        if poi
+00020b60: 6e74 3364 203d 3d20 7365 6c66 2e70 6f69  nt3d == self.poi
+00020b70: 6e74 313a 0a20 2020 2020 2020 2020 2020  nt1:.           
+00020b80: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
+00020b90: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00020ba0: 2e64 6972 6563 7469 6f6e 5f76 6563 746f  .direction_vecto
+00020bb0: 7228 292e 6973 5f63 6f6c 696e 6561 725f  r().is_colinear_
+00020bc0: 746f 2870 6f69 6e74 3364 202d 2073 656c  to(point3d - sel
+00020bd0: 662e 706f 696e 7431 290a 0a20 2020 2064  f.point1)..    d
+00020be0: 6566 2070 6f69 6e74 5f64 6973 7461 6e63  ef point_distanc
+00020bf0: 6528 7365 6c66 2c20 706f 696e 7429 3a0a  e(self, point):.
+00020c00: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00020c10: 6e73 2074 6865 206d 696e 696d 616c 2064  ns the minimal d
+00020c20: 6973 7461 6e63 6520 746f 2061 2070 6f69  istance to a poi
+00020c30: 6e74 2e22 2222 0a20 2020 2020 2020 2076  nt.""".        v
+00020c40: 6563 746f 7231 203d 2070 6f69 6e74 202d  ector1 = point -
+00020c50: 2073 656c 662e 706f 696e 7431 0a20 2020   self.point1.   
+00020c60: 2020 2020 2076 6563 746f 7231 2e74 6f5f       vector1.to_
+00020c70: 7665 6374 6f72 2829 0a20 2020 2020 2020  vector().       
+00020c80: 2076 6563 746f 7232 203d 2073 656c 662e   vector2 = self.
+00020c90: 706f 696e 7432 202d 2073 656c 662e 706f  point2 - self.po
+00020ca0: 696e 7431 0a20 2020 2020 2020 2076 6563  int1.        vec
+00020cb0: 746f 7232 2e74 6f5f 7665 6374 6f72 2829  tor2.to_vector()
+00020cc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00020cd0: 7665 6374 6f72 312e 6372 6f73 7328 7665  vector1.cross(ve
+00020ce0: 6374 6f72 3229 2e6e 6f72 6d28 2920 2f20  ctor2).norm() / 
+00020cf0: 7665 6374 6f72 322e 6e6f 726d 2829 0a0a  vector2.norm()..
+00020d00: 2020 2020 6465 6620 6c69 6e65 5f64 6973      def line_dis
+00020d10: 7461 6e63 6528 7365 6c66 2c20 6c69 6e65  tance(self, line
+00020d20: 3229 3a0a 2020 2020 2020 2020 2222 220a  2):.        """.
+00020d30: 2020 2020 2020 2020 4361 6c63 756c 6174          Calculat
+00020d40: 6573 2074 6865 2064 6973 7461 6e63 6520  es the distance 
+00020d50: 6265 7477 6565 6e20 7477 6f20 4c69 6e65  between two Line
+00020d60: 3344 2e0a 0a20 2020 2020 2020 203a 7061  3D...        :pa
+00020d70: 7261 6d20 6c69 6e65 323a 206f 7468 6572  ram line2: other
+00020d80: 204c 696e 6533 442e 0a20 2020 2020 2020   Line3D..       
+00020d90: 203a 7265 7475 726e 3a20 5468 6520 6469   :return: The di
+00020da0: 7374 616e 6365 2062 6574 7765 656e 2074  stance between t
+00020db0: 6865 2074 776f 206c 696e 6573 2e0a 2020  he two lines..  
+00020dc0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00020dd0: 2020 6469 7265 6374 696f 6e5f 7665 6374    direction_vect
+00020de0: 6f72 3120 3d20 7365 6c66 2e64 6972 6563  or1 = self.direc
+00020df0: 7469 6f6e 5f76 6563 746f 7228 290a 2020  tion_vector().  
+00020e00: 2020 2020 2020 6469 7265 6374 696f 6e5f        direction_
+00020e10: 7665 6374 6f72 3220 3d20 6c69 6e65 322e  vector2 = line2.
+00020e20: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
+00020e30: 2829 0a20 2020 2020 2020 2069 6620 6469  ().        if di
+00020e40: 7265 6374 696f 6e5f 7665 6374 6f72 312e  rection_vector1.
+00020e50: 6973 5f63 6f6c 696e 6561 725f 746f 2864  is_colinear_to(d
+00020e60: 6972 6563 7469 6f6e 5f76 6563 746f 7232  irection_vector2
+00020e70: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00020e80: 6574 7572 6e20 6469 7265 6374 696f 6e5f  eturn direction_
+00020e90: 7665 6374 6f72 312e 6372 6f73 7328 6c69  vector1.cross(li
+00020ea0: 6e65 322e 706f 696e 7431 202d 2073 656c  ne2.point1 - sel
+00020eb0: 662e 706f 696e 7431 292e 6e6f 726d 2829  f.point1).norm()
+00020ec0: 202f 2064 6972 6563 7469 6f6e 5f76 6563   / direction_vec
+00020ed0: 746f 7231 2e6e 6f72 6d28 290a 2020 2020  tor1.norm().    
+00020ee0: 2020 2020 7665 6374 6f72 203d 206c 696e      vector = lin
+00020ef0: 6532 2e70 6f69 6e74 3120 2d20 7365 6c66  e2.point1 - self
+00020f00: 2e70 6f69 6e74 310a 2020 2020 2020 2020  .point1.        
+00020f10: 6c69 6e65 5f64 6973 7461 6e63 6520 3d20  line_distance = 
+00020f20: 6162 7328 7665 6374 6f72 2e64 6f74 2864  abs(vector.dot(d
+00020f30: 6972 6563 7469 6f6e 5f76 6563 746f 7231  irection_vector1
+00020f40: 2e63 726f 7373 2864 6972 6563 7469 6f6e  .cross(direction
+00020f50: 5f76 6563 746f 7232 2929 2920 2f20 6469  _vector2))) / di
+00020f60: 7265 6374 696f 6e5f 7665 6374 6f72 312e  rection_vector1.
+00020f70: 6372 6f73 7328 0a20 2020 2020 2020 2020  cross(.         
+00020f80: 2020 2064 6972 6563 7469 6f6e 5f76 6563     direction_vec
+00020f90: 746f 7232 292e 6e6f 726d 2829 0a20 2020  tor2).norm().   
+00020fa0: 2020 2020 2072 6574 7572 6e20 6c69 6e65       return line
+00020fb0: 5f64 6973 7461 6e63 650a 0a20 2020 2064  _distance..    d
+00020fc0: 6566 2073 6b65 775f 746f 2873 656c 662c  ef skew_to(self,
+00020fd0: 206c 696e 6529 3a0a 2020 2020 2020 2020   line):.        
+00020fe0: 2222 220a 2020 2020 2020 2020 5665 7269  """.        Veri
+00020ff0: 6669 6573 2069 6620 7477 6f20 4c69 6e65  fies if two Line
+00021000: 3344 2061 7265 2073 6b65 7720 746f 2065  3D are skew to e
+00021010: 6163 6820 6f74 6865 722c 2074 6861 7420  ach other, that 
+00021020: 6973 2c20 7468 6579 2061 7265 206e 6f74  is, they are not
+00021030: 2070 6172 616c 6c65 6c20 616e 6420 6e65   parallel and ne
+00021040: 7665 7220 696e 7465 7273 6563 742e 0a0a  ver intersect...
+00021050: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
+00021060: 696e 653a 206f 7468 6572 206c 696e 652e  ine: other line.
+00021070: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00021080: 3a20 5472 7565 2069 6620 7468 6579 2061  : True if they a
+00021090: 7265 2073 6b65 772c 2046 616c 7365 206f  re skew, False o
+000210a0: 7468 6572 7769 7365 2e0a 2020 2020 2020  therwise..      
+000210b0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+000210c0: 2073 656c 662e 6469 7265 6374 696f 6e5f   self.direction_
+000210d0: 7665 6374 6f72 2829 2e69 735f 636f 6c69  vector().is_coli
+000210e0: 6e65 6172 5f74 6f28 6c69 6e65 2e64 6972  near_to(line.dir
+000210f0: 6563 7469 6f6e 5f76 6563 746f 7228 2929  ection_vector())
+00021100: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00021110: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
+00021120: 2020 2069 6620 6d61 7468 2e69 7363 6c6f     if math.isclo
+00021130: 7365 2873 656c 662e 6c69 6e65 5f64 6973  se(self.line_dis
+00021140: 7461 6e63 6528 6c69 6e65 292c 2030 2c20  tance(line), 0, 
+00021150: 6162 735f 746f 6c3d 3165 2d36 293a 0a20  abs_tol=1e-6):. 
+00021160: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00021170: 6e20 4661 6c73 650a 2020 2020 2020 2020  n False.        
+00021180: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
+00021190: 2064 6566 2069 6e74 6572 7365 6374 696f   def intersectio
+000211a0: 6e28 7365 6c66 2c20 6c69 6e65 3229 3a0a  n(self, line2):.
+000211b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000211c0: 2020 2020 4361 6c63 756c 6174 6573 2074      Calculates t
+000211d0: 6865 2069 6e74 6572 7365 6374 696f 6e20  he intersection 
+000211e0: 6265 7477 6565 6e20 746f 204c 696e 6533  between to Line3
+000211f0: 442c 2069 6620 7468 6572 6520 6973 2061  D, if there is a
+00021200: 6e20 696e 7465 7273 6563 7469 6f6e 2e0a  n intersection..
+00021210: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00021220: 6c69 6e65 3a20 6f74 6865 7220 4c69 6e65  line: other Line
+00021230: 3344 0a20 2020 2020 2020 203a 7265 7475  3D.        :retu
+00021240: 726e 3a20 4e6f 6e65 2069 6620 7468 6572  rn: None if ther
+00021250: 6520 6973 206e 6f20 696e 7465 7273 6563  e is no intersec
+00021260: 7469 6f6e 2062 6574 7765 656e 204c 696e  tion between Lin
+00021270: 6573 2e20 4120 766f 6c6d 646c 722e 506f  es. A volmdlr.Po
+00021280: 696e 7433 4420 6966 2074 6865 7265 2065  int3D if there e
+00021290: 7869 7374 6573 2061 6e20 696e 7465 7273  xistes an inters
+000212a0: 6563 7469 6f6e 0a20 2020 2020 2020 2022  ection.        "
+000212b0: 2222 0a20 2020 2020 2020 2064 6972 6563  "".        direc
+000212c0: 7469 6f6e 5f76 6563 746f 7231 203d 2073  tion_vector1 = s
+000212d0: 656c 662e 6469 7265 6374 696f 6e5f 7665  elf.direction_ve
+000212e0: 6374 6f72 2829 0a20 2020 2020 2020 2064  ctor().        d
+000212f0: 6972 6563 7469 6f6e 5f76 6563 746f 7232  irection_vector2
+00021300: 203d 206c 696e 6532 2e64 6972 6563 7469   = line2.directi
+00021310: 6f6e 5f76 6563 746f 7228 290a 2020 2020  on_vector().    
+00021320: 2020 2020 6469 7374 616e 6365 5f74 6f5f      distance_to_
+00021330: 6c69 6e65 203d 2073 656c 662e 6c69 6e65  line = self.line
+00021340: 5f64 6973 7461 6e63 6528 6c69 6e65 3229  _distance(line2)
+00021350: 0a20 2020 2020 2020 2069 6620 6469 7265  .        if dire
+00021360: 6374 696f 6e5f 7665 6374 6f72 312e 6973  ction_vector1.is
+00021370: 5f63 6f6c 696e 6561 725f 746f 2864 6972  _colinear_to(dir
+00021380: 6563 7469 6f6e 5f76 6563 746f 7232 2920  ection_vector2) 
+00021390: 6f72 205c 0a20 2020 2020 2020 2020 2020  or \.           
+000213a0: 2020 2020 206e 6f74 206d 6174 682e 6973       not math.is
+000213b0: 636c 6f73 6528 6469 7374 616e 6365 5f74  close(distance_t
+000213c0: 6f5f 6c69 6e65 2c20 302c 2061 6273 5f74  o_line, 0, abs_t
+000213d0: 6f6c 3d31 652d 3629 3a0a 2020 2020 2020  ol=1e-6):.      
+000213e0: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+000213f0: 650a 2020 2020 2020 2020 6966 206d 6174  e.        if mat
+00021400: 682e 6973 636c 6f73 6528 6469 7374 616e  h.isclose(distan
+00021410: 6365 5f74 6f5f 6c69 6e65 2c20 302c 2061  ce_to_line, 0, a
+00021420: 6273 5f74 6f6c 3d31 652d 3629 2061 6e64  bs_tol=1e-6) and
+00021430: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+00021440: 2020 206d 6174 682e 6973 636c 6f73 6528     math.isclose(
+00021450: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
+00021460: 312e 646f 7428 6469 7265 6374 696f 6e5f  1.dot(direction_
+00021470: 7665 6374 6f72 3229 2c20 302c 2061 6273  vector2), 0, abs
+00021480: 5f74 6f6c 3d31 652d 3629 3a0a 2020 2020  _tol=1e-6):.    
+00021490: 2020 2020 2020 2020 7072 6f6a 6563 7465          projecte
+000214a0: 645f 706f 696e 742c 205f 203d 2073 656c  d_point, _ = sel
+000214b0: 662e 706f 696e 745f 7072 6f6a 6563 7469  f.point_projecti
+000214c0: 6f6e 286c 696e 6532 2e70 6f69 6e74 3129  on(line2.point1)
+000214d0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000214e0: 7572 6e20 7072 6f6a 6563 7465 645f 706f  urn projected_po
+000214f0: 696e 740a 2020 2020 2020 2020 7665 6374  int.        vect
+00021500: 6f72 203d 2073 656c 662e 706f 696e 7431  or = self.point1
+00021510: 202d 206c 696e 6532 2e70 6f69 6e74 310a   - line2.point1.
+00021520: 2020 2020 2020 2020 745f 636f 6566 6669          t_coeffi
+00021530: 6369 656e 7420 3d20 280a 2020 2020 2020  cient = (.      
+00021540: 2020 2020 2020 7665 6374 6f72 2e64 6f74        vector.dot
+00021550: 2864 6972 6563 7469 6f6e 5f76 6563 746f  (direction_vecto
+00021560: 7232 2920 2a20 6469 7265 6374 696f 6e5f  r2) * direction_
+00021570: 7665 6374 6f72 322e 646f 7428 6469 7265  vector2.dot(dire
+00021580: 6374 696f 6e5f 7665 6374 6f72 3129 202d  ction_vector1) -
+00021590: 0a20 2020 2020 2020 2020 2020 2076 6563  .            vec
+000215a0: 746f 722e 646f 7428 6469 7265 6374 696f  tor.dot(directio
+000215b0: 6e5f 7665 6374 6f72 3129 202a 2064 6972  n_vector1) * dir
+000215c0: 6563 7469 6f6e 5f76 6563 746f 7232 2e64  ection_vector2.d
+000215d0: 6f74 2864 6972 6563 7469 6f6e 5f76 6563  ot(direction_vec
+000215e0: 746f 7232 2929 202f 2028 0a20 2020 2020  tor2)) / (.     
+000215f0: 2020 2020 2020 2064 6972 6563 7469 6f6e         direction
+00021600: 5f76 6563 746f 7231 2e64 6f74 2864 6972  _vector1.dot(dir
+00021610: 6563 7469 6f6e 5f76 6563 746f 7231 2920  ection_vector1) 
+00021620: 2a20 6469 7265 6374 696f 6e5f 7665 6374  * direction_vect
+00021630: 6f72 322e 646f 7428 6469 7265 6374 696f  or2.dot(directio
+00021640: 6e5f 7665 6374 6f72 3229 202d 0a20 2020  n_vector2) -.   
+00021650: 2020 2020 2020 2020 2064 6972 6563 7469           directi
+00021660: 6f6e 5f76 6563 746f 7231 2e64 6f74 2864  on_vector1.dot(d
+00021670: 6972 6563 7469 6f6e 5f76 6563 746f 7232  irection_vector2
+00021680: 2920 2a20 6469 7265 6374 696f 6e5f 7665  ) * direction_ve
+00021690: 6374 6f72 322e 646f 7428 6469 7265 6374  ctor2.dot(direct
+000216a0: 696f 6e5f 7665 6374 6f72 3129 290a 2020  ion_vector1)).  
+000216b0: 2020 2020 2020 2320 755f 636f 6566 6669        # u_coeffi
+000216c0: 6369 656e 7420 3d20 2876 6563 746f 722e  cient = (vector.
+000216d0: 646f 7428 6469 7265 6374 696f 6e5f 7665  dot(direction_ve
+000216e0: 6374 6f72 3229 202b 2074 5f63 6f65 6666  ctor2) + t_coeff
+000216f0: 6963 6965 6e74 202a 2064 6972 6563 7469  icient * directi
+00021700: 6f6e 5f76 6563 746f 7231 2e64 6f74 280a  on_vector1.dot(.
+00021710: 2020 2020 2020 2020 2320 6469 7265 6374          # direct
+00021720: 696f 6e5f 7665 6374 6f72 3229 2920 2f20  ion_vector2)) / 
+00021730: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
+00021740: 322e 646f 7428 6469 7265 6374 696f 6e5f  2.dot(direction_
+00021750: 7665 6374 6f72 3229 0a20 2020 2020 2020  vector2).       
+00021760: 2069 6e74 6572 7365 6374 696f 6e20 3d20   intersection = 
+00021770: 7365 6c66 2e70 6f69 6e74 3120 2b20 745f  self.point1 + t_
+00021780: 636f 6566 6669 6369 656e 7420 2a20 6469  coefficient * di
+00021790: 7265 6374 696f 6e5f 7665 6374 6f72 310a  rection_vector1.
+000217a0: 2020 2020 2020 2020 7265 7475 726e 2069          return i
+000217b0: 6e74 6572 7365 6374 696f 6e0a 0a20 2020  ntersection..   
+000217c0: 2064 6566 2070 6c6f 7428 7365 6c66 2c20   def plot(self, 
+000217d0: 6178 3d4e 6f6e 652c 2063 6f6c 6f72 3d27  ax=None, color='
+000217e0: 6b27 2c20 616c 7068 613d 312c 2064 6173  k', alpha=1, das
+000217f0: 6865 643d 5472 7565 293a 0a20 2020 2020  hed=True):.     
+00021800: 2020 2069 6620 6178 2069 7320 4e6f 6e65     if ax is None
+00021810: 3a0a 2020 2020 2020 2020 2020 2020 6178  :.            ax
+00021820: 203d 2041 7865 7333 4428 706c 742e 6669   = Axes3D(plt.fi
+00021830: 6775 7265 2829 290a 0a20 2020 2020 2020  gure())..       
+00021840: 2023 204c 696e 6520 7365 676d 656e 740a   # Line segment.
+00021850: 2020 2020 2020 2020 6178 2e70 6c6f 7428          ax.plot(
+00021860: 5b73 656c 662e 706f 696e 7431 2e78 2c20  [self.point1.x, 
+00021870: 7365 6c66 2e70 6f69 6e74 322e 785d 2c20  self.point2.x], 
+00021880: 5b73 656c 662e 706f 696e 7431 2e79 2c20  [self.point1.y, 
+00021890: 7365 6c66 2e70 6f69 6e74 322e 795d 2c0a  self.point2.y],.
+000218a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000218b0: 5b73 656c 662e 706f 696e 7431 2e7a 2c20  [self.point1.z, 
+000218c0: 7365 6c66 2e70 6f69 6e74 322e 7a5d 2c20  self.point2.z], 
+000218d0: 636f 6c6f 723d 636f 6c6f 722c 2061 6c70  color=color, alp
+000218e0: 6861 3d61 6c70 6861 290a 0a20 2020 2020  ha=alpha)..     
+000218f0: 2020 2023 2044 7261 7769 6e67 2033 2074     # Drawing 3 t
+00021900: 696d 6573 206c 656e 6774 6820 6f66 2073  imes length of s
+00021910: 6567 6d65 6e74 206f 6e20 6561 6368 2073  egment on each s
+00021920: 6964 650a 2020 2020 2020 2020 7520 3d20  ide.        u = 
+00021930: 7365 6c66 2e70 6f69 6e74 3220 2d20 7365  self.point2 - se
+00021940: 6c66 2e70 6f69 6e74 310a 2020 2020 2020  lf.point1.      
+00021950: 2020 7631 203d 2073 656c 662e 706f 696e    v1 = self.poin
+00021960: 7431 202d 2033 202a 2075 0a20 2020 2020  t1 - 3 * u.     
+00021970: 2020 2078 312c 2079 312c 207a 3120 3d20     x1, y1, z1 = 
+00021980: 7631 2e78 2c20 7631 2e79 2c20 7631 2e7a  v1.x, v1.y, v1.z
+00021990: 0a20 2020 2020 2020 2076 3220 3d20 7365  .        v2 = se
+000219a0: 6c66 2e70 6f69 6e74 3220 2d20 3320 2a20  lf.point2 - 3 * 
+000219b0: 750a 2020 2020 2020 2020 7832 2c20 7932  u.        x2, y2
+000219c0: 2c20 7a32 203d 2076 322e 782c 2076 322e  , z2 = v2.x, v2.
+000219d0: 792c 2076 322e 7a0a 2020 2020 2020 2020  y, v2.z.        
+000219e0: 6966 2064 6173 6865 643a 0a20 2020 2020  if dashed:.     
+000219f0: 2020 2020 2020 2061 782e 706c 6f74 285b         ax.plot([
+00021a00: 7831 2c20 7832 5d2c 205b 7931 2c20 7932  x1, x2], [y1, y2
+00021a10: 5d2c 205b 7a31 2c20 7a32 5d2c 2063 6f6c  ], [z1, z2], col
+00021a20: 6f72 3d63 6f6c 6f72 2c0a 2020 2020 2020  or=color,.      
+00021a30: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00021a40: 7368 6573 3d5b 3330 2c20 352c 2031 302c  shes=[30, 5, 10,
+00021a50: 2035 5d29 0a20 2020 2020 2020 2065 6c73   5]).        els
+00021a60: 653a 0a20 2020 2020 2020 2020 2020 2061  e:.            a
+00021a70: 782e 706c 6f74 285b 7831 2c20 7832 5d2c  x.plot([x1, x2],
+00021a80: 205b 7931 2c20 7932 5d2c 205b 7a31 2c20   [y1, y2], [z1, 
+00021a90: 7a32 5d2c 2063 6f6c 6f72 3d63 6f6c 6f72  z2], color=color
+00021aa0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00021ab0: 2061 780a 0a20 2020 2064 6566 2070 6c61   ax..    def pla
+00021ac0: 6e65 5f70 726f 6a65 6374 696f 6e32 6428  ne_projection2d(
+00021ad0: 7365 6c66 2c20 6365 6e74 6572 2c20 782c  self, center, x,
+00021ae0: 2079 293a 0a20 2020 2020 2020 2072 6574   y):.        ret
+00021af0: 7572 6e20 4c69 6e65 3244 2873 656c 662e  urn Line2D(self.
+00021b00: 706f 696e 7431 2e70 6c61 6e65 5f70 726f  point1.plane_pro
+00021b10: 6a65 6374 696f 6e32 6428 6365 6e74 6572  jection2d(center
+00021b20: 2c20 782c 2079 292c 0a20 2020 2020 2020  , x, y),.       
+00021b30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00021b40: 656c 662e 706f 696e 7432 2e70 6c61 6e65  elf.point2.plane
+00021b50: 5f70 726f 6a65 6374 696f 6e32 6428 6365  _projection2d(ce
+00021b60: 6e74 6572 2c20 782c 2079 2929 0a0a 2020  nter, x, y))..  
+00021b70: 2020 6465 6620 6d69 6e69 6d75 6d5f 6469    def minimum_di
+00021b80: 7374 616e 6365 5f70 6f69 6e74 7328 7365  stance_points(se
+00021b90: 6c66 2c20 6f74 6865 725f 6c69 6e65 293a  lf, other_line):
+00021ba0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00021bb0: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
+00021bc0: 2070 6f69 6e74 7320 6f6e 2074 6869 7320   points on this 
+00021bd0: 6c69 6e65 2061 6e64 2074 6865 206f 7468  line and the oth
+00021be0: 6572 206c 696e 6520 7468 6174 2061 7265  er line that are
+00021bf0: 2074 6865 2063 6c6f 7365 7374 206f 6620   the closest of 
+00021c00: 6c69 6e65 732e 0a20 2020 2020 2020 2022  lines..        "
+00021c10: 2222 0a20 2020 2020 2020 2075 203d 2073  "".        u = s
+00021c20: 656c 662e 706f 696e 7432 202d 2073 656c  elf.point2 - sel
+00021c30: 662e 706f 696e 7431 0a20 2020 2020 2020  f.point1.       
+00021c40: 2076 203d 206f 7468 6572 5f6c 696e 652e   v = other_line.
+00021c50: 706f 696e 7432 202d 206f 7468 6572 5f6c  point2 - other_l
+00021c60: 696e 652e 706f 696e 7431 0a20 2020 2020  ine.point1.     
+00021c70: 2020 2077 203d 2073 656c 662e 706f 696e     w = self.poin
+00021c80: 7431 202d 206f 7468 6572 5f6c 696e 652e  t1 - other_line.
+00021c90: 706f 696e 7431 0a20 2020 2020 2020 2061  point1.        a
+00021ca0: 203d 2075 2e64 6f74 2875 290a 2020 2020   = u.dot(u).    
+00021cb0: 2020 2020 6220 3d20 752e 646f 7428 7629      b = u.dot(v)
+00021cc0: 0a20 2020 2020 2020 2063 203d 2076 2e64  .        c = v.d
+00021cd0: 6f74 2876 290a 2020 2020 2020 2020 6420  ot(v).        d 
+00021ce0: 3d20 752e 646f 7428 7729 0a20 2020 2020  = u.dot(w).     
+00021cf0: 2020 2065 203d 2076 2e64 6f74 2877 290a     e = v.dot(w).
+00021d00: 0a20 2020 2020 2020 2073 203d 2028 6220  .        s = (b 
+00021d10: 2a20 6520 2d20 6320 2a20 6429 202f 2028  * e - c * d) / (
+00021d20: 6120 2a20 6320 2d20 6220 2a2a 2032 290a  a * c - b ** 2).
+00021d30: 2020 2020 2020 2020 7420 3d20 2861 202a          t = (a *
+00021d40: 2065 202d 2062 202a 2064 2920 2f20 2861   e - b * d) / (a
+00021d50: 202a 2063 202d 2062 202a 2a20 3229 0a20   * c - b ** 2). 
+00021d60: 2020 2020 2020 2070 3120 3d20 7365 6c66         p1 = self
+00021d70: 2e70 6f69 6e74 3120 2b20 7320 2a20 750a  .point1 + s * u.
+00021d80: 2020 2020 2020 2020 7032 203d 206f 7468          p2 = oth
+00021d90: 6572 5f6c 696e 652e 706f 696e 7431 202b  er_line.point1 +
+00021da0: 2074 202a 2076 0a20 2020 2020 2020 2072   t * v.        r
+00021db0: 6574 7572 6e20 7031 2c20 7032 0a0a 2020  eturn p1, p2..  
+00021dc0: 2020 6465 6620 726f 7461 7469 6f6e 2873    def rotation(s
+00021dd0: 656c 662c 2063 656e 7465 723a 2076 6f6c  elf, center: vol
+00021de0: 6d64 6c72 2e50 6f69 6e74 3344 2c20 6178  mdlr.Point3D, ax
+00021df0: 6973 3a20 766f 6c6d 646c 722e 5665 6374  is: volmdlr.Vect
+00021e00: 6f72 3344 2c20 616e 676c 653a 2066 6c6f  or3D, angle: flo
+00021e10: 6174 293a 0a20 2020 2020 2020 2022 2222  at):.        """
+00021e20: 0a20 2020 2020 2020 204c 696e 6533 4420  .        Line3D 
+00021e30: 726f 7461 7469 6f6e 2e0a 0a20 2020 2020  rotation...     
+00021e40: 2020 203a 7061 7261 6d20 6365 6e74 6572     :param center
+00021e50: 3a20 726f 7461 7469 6f6e 2063 656e 7465  : rotation cente
+00021e60: 720a 2020 2020 2020 2020 3a70 6172 616d  r.        :param
+00021e70: 2061 7869 733a 2072 6f74 6174 696f 6e20   axis: rotation 
+00021e80: 6178 6973 0a20 2020 2020 2020 203a 7061  axis.        :pa
+00021e90: 7261 6d20 616e 676c 653a 2061 6e67 6c65  ram angle: angle
+00021ea0: 2072 6f74 6174 696f 6e0a 2020 2020 2020   rotation.      
+00021eb0: 2020 3a72 6574 7572 6e3a 2061 206e 6577    :return: a new
+00021ec0: 2072 6f74 6174 6564 204c 696e 6533 440a   rotated Line3D.
+00021ed0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00021ee0: 2020 2020 2072 6574 7572 6e20 4c69 6e65       return Line
+00021ef0: 3344 282a 5b70 2e72 6f74 6174 696f 6e28  3D(*[p.rotation(
+00021f00: 6365 6e74 6572 2c20 6178 6973 2c20 616e  center, axis, an
+00021f10: 676c 6529 2066 6f72 2070 2069 6e0a 2020  gle) for p in.  
+00021f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021f30: 2020 2020 2020 5b73 656c 662e 706f 696e        [self.poin
+00021f40: 7431 2c20 7365 6c66 2e70 6f69 6e74 325d  t1, self.point2]
+00021f50: 5d29 0a0a 2020 2020 6465 6620 726f 7461  ])..    def rota
+00021f60: 7469 6f6e 5f69 6e70 6c61 6365 2873 656c  tion_inplace(sel
+00021f70: 662c 2063 656e 7465 723a 2076 6f6c 6d64  f, center: volmd
+00021f80: 6c72 2e50 6f69 6e74 3344 2c20 6178 6973  lr.Point3D, axis
+00021f90: 3a20 766f 6c6d 646c 722e 5665 6374 6f72  : volmdlr.Vector
+00021fa0: 3344 2c20 616e 676c 653a 2066 6c6f 6174  3D, angle: float
+00021fb0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00021fc0: 2020 2020 2020 204c 696e 6533 4420 726f         Line3D ro
+00021fd0: 7461 7469 6f6e 2e20 4f62 6a65 6374 2069  tation. Object i
+00021fe0: 7320 7570 6461 7465 6420 696e 706c 6163  s updated inplac
+00021ff0: 652e 0a0a 2020 2020 2020 2020 3a70 6172  e...        :par
+00022000: 616d 2063 656e 7465 723a 2072 6f74 6174  am center: rotat
+00022010: 696f 6e20 6365 6e74 6572 0a20 2020 2020  ion center.     
+00022020: 2020 203a 7061 7261 6d20 6178 6973 3a20     :param axis: 
+00022030: 726f 7461 7469 6f6e 2061 7869 730a 2020  rotation axis.  
+00022040: 2020 2020 2020 3a70 6172 616d 2061 6e67        :param ang
+00022050: 6c65 3a20 726f 7461 7469 6f6e 2061 6e67  le: rotation ang
+00022060: 6c65 0a20 2020 2020 2020 2022 2222 0a20  le.        """. 
+00022070: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+00022080: 7761 726e 2822 2769 6e70 6c61 6365 2720  warn("'inplace' 
+00022090: 6d65 7468 6f64 7320 6172 6520 6465 7072  methods are depr
+000220a0: 6563 6174 6564 2e20 5573 6520 6120 6e6f  ecated. Use a no
+000220b0: 7420 696e 706c 6163 6520 6d65 7468 6f64  t inplace method
+000220c0: 2069 6e73 7465 6164 2e22 2c20 4465 7072   instead.", Depr
+000220d0: 6563 6174 696f 6e57 6172 6e69 6e67 290a  ecationWarning).
+000220e0: 0a20 2020 2020 2020 2066 6f72 2070 2069  .        for p i
+000220f0: 6e20 5b73 656c 662e 706f 696e 7431 2c20  n [self.point1, 
+00022100: 7365 6c66 2e70 6f69 6e74 325d 3a0a 2020  self.point2]:.  
+00022110: 2020 2020 2020 2020 2020 702e 726f 7461            p.rota
+00022120: 7469 6f6e 5f69 6e70 6c61 6365 2863 656e  tion_inplace(cen
+00022130: 7465 722c 2061 7869 732c 2061 6e67 6c65  ter, axis, angle
+00022140: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+00022150: 6262 6f78 203d 204e 6f6e 650a 0a20 2020  bbox = None..   
+00022160: 2064 6566 2074 7261 6e73 6c61 7469 6f6e   def translation
+00022170: 2873 656c 662c 206f 6666 7365 743a 2076  (self, offset: v
+00022180: 6f6c 6d64 6c72 2e56 6563 746f 7233 4429  olmdlr.Vector3D)
+00022190: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000221a0: 2020 2020 2020 4c69 6e65 3344 2074 7261        Line3D tra
+000221b0: 6e73 6c61 7469 6f6e 2e0a 0a20 2020 2020  nslation...     
+000221c0: 2020 203a 7061 7261 6d20 6f66 6673 6574     :param offset
+000221d0: 3a20 7472 616e 736c 6174 696f 6e20 7665  : translation ve
+000221e0: 6374 6f72 0a20 2020 2020 2020 203a 7265  ctor.        :re
+000221f0: 7475 726e 3a20 4120 6e65 7720 7472 616e  turn: A new tran
+00022200: 736c 6174 6564 204c 696e 6533 440a 2020  slated Line3D.  
+00022210: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00022220: 2020 7265 7475 726e 204c 696e 6533 4428    return Line3D(
+00022230: 2a5b 706f 696e 742e 7472 616e 736c 6174  *[point.translat
+00022240: 696f 6e28 6f66 6673 6574 2920 666f 7220  ion(offset) for 
+00022250: 706f 696e 7420 696e 0a20 2020 2020 2020  point in.       
+00022260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022270: 205b 7365 6c66 2e70 6f69 6e74 312c 2073   [self.point1, s
+00022280: 656c 662e 706f 696e 7432 5d5d 290a 0a20  elf.point2]]).. 
+00022290: 2020 2064 6566 2074 7261 6e73 6c61 7469     def translati
+000222a0: 6f6e 5f69 6e70 6c61 6365 2873 656c 662c  on_inplace(self,
+000222b0: 206f 6666 7365 743a 2076 6f6c 6d64 6c72   offset: volmdlr
+000222c0: 2e56 6563 746f 7233 4429 3a0a 2020 2020  .Vector3D):.    
+000222d0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000222e0: 4c69 6e65 3344 2074 7261 6e73 6c61 7469  Line3D translati
+000222f0: 6f6e 2e20 4f62 6a65 6374 2069 7320 7570  on. Object is up
+00022300: 6461 7465 6420 696e 706c 6163 652e 0a0a  dated inplace...
+00022310: 2020 2020 2020 2020 3a70 6172 616d 206f          :param o
+00022320: 6666 7365 743a 2074 7261 6e73 6c61 7469  ffset: translati
+00022330: 6f6e 2076 6563 746f 720a 2020 2020 2020  on vector.      
+00022340: 2020 2222 220a 2020 2020 2020 2020 7761    """.        wa
+00022350: 726e 696e 6773 2e77 6172 6e28 2227 696e  rnings.warn("'in
+00022360: 706c 6163 6527 206d 6574 686f 6473 2061  place' methods a
+00022370: 7265 2064 6570 7265 6361 7465 642e 2055  re deprecated. U
+00022380: 7365 2061 206e 6f74 2069 6e70 6c61 6365  se a not inplace
+00022390: 206d 6574 686f 6420 696e 7374 6561 642e   method instead.
+000223a0: 222c 2044 6570 7265 6361 7469 6f6e 5761  ", DeprecationWa
+000223b0: 726e 696e 6729 0a0a 2020 2020 2020 2020  rning)..        
+000223c0: 666f 7220 706f 696e 7420 696e 205b 7365  for point in [se
+000223d0: 6c66 2e70 6f69 6e74 312c 2073 656c 662e  lf.point1, self.
+000223e0: 706f 696e 7432 5d3a 0a20 2020 2020 2020  point2]:.       
+000223f0: 2020 2020 2070 6f69 6e74 2e74 7261 6e73       point.trans
+00022400: 6c61 7469 6f6e 5f69 6e70 6c61 6365 286f  lation_inplace(o
+00022410: 6666 7365 7429 0a20 2020 2020 2020 2073  ffset).        s
+00022420: 656c 662e 5f62 626f 7820 3d20 4e6f 6e65  elf._bbox = None
+00022430: 0a0a 2020 2020 6465 6620 6672 616d 655f  ..    def frame_
+00022440: 6d61 7070 696e 6728 7365 6c66 2c20 6672  mapping(self, fr
+00022450: 616d 653a 2076 6f6c 6d64 6c72 2e46 7261  ame: volmdlr.Fra
+00022460: 6d65 3344 2c20 7369 6465 3a20 7374 7229  me3D, side: str)
+00022470: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00022480: 2020 2020 2020 4368 616e 6765 7320 7665        Changes ve
+00022490: 6374 6f72 2066 7261 6d65 5f6d 6170 7069  ctor frame_mappi
+000224a0: 6e67 2061 6e64 2072 6574 7572 6e20 6120  ng and return a 
+000224b0: 6e65 7720 4c69 6e65 3344 2e0a 0a20 2020  new Line3D...   
+000224c0: 2020 2020 2073 6964 6520 3d20 276f 6c64       side = 'old
+000224d0: 2720 6f72 2027 6e65 7727 0a20 2020 2020  ' or 'new'.     
+000224e0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+000224f0: 6620 7369 6465 203d 3d20 276f 6c64 273a  f side == 'old':
+00022500: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+00022510: 5f73 7461 7274 203d 2066 7261 6d65 2e6c  _start = frame.l
+00022520: 6f63 616c 5f74 6f5f 676c 6f62 616c 5f63  ocal_to_global_c
+00022530: 6f6f 7264 696e 6174 6573 2873 656c 662e  oordinates(self.
+00022540: 706f 696e 7431 290a 2020 2020 2020 2020  point1).        
+00022550: 2020 2020 6e65 775f 656e 6420 3d20 6672      new_end = fr
+00022560: 616d 652e 6c6f 6361 6c5f 746f 5f67 6c6f  ame.local_to_glo
+00022570: 6261 6c5f 636f 6f72 6469 6e61 7465 7328  bal_coordinates(
+00022580: 7365 6c66 2e70 6f69 6e74 3229 0a20 2020  self.point2).   
+00022590: 2020 2020 2065 6c69 6620 7369 6465 203d       elif side =
+000225a0: 3d20 276e 6577 273a 0a20 2020 2020 2020  = 'new':.       
+000225b0: 2020 2020 206e 6577 5f73 7461 7274 203d       new_start =
+000225c0: 2066 7261 6d65 2e67 6c6f 6261 6c5f 746f   frame.global_to
+000225d0: 5f6c 6f63 616c 5f63 6f6f 7264 696e 6174  _local_coordinat
+000225e0: 6573 2873 656c 662e 706f 696e 7431 290a  es(self.point1).
+000225f0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+00022600: 656e 6420 3d20 6672 616d 652e 676c 6f62  end = frame.glob
+00022610: 616c 5f74 6f5f 6c6f 6361 6c5f 636f 6f72  al_to_local_coor
+00022620: 6469 6e61 7465 7328 7365 6c66 2e70 6f69  dinates(self.poi
+00022630: 6e74 3229 0a20 2020 2020 2020 2065 6c73  nt2).        els
+00022640: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00022650: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00022660: 2750 6c65 6173 6520 456e 7465 7220 6120  'Please Enter a 
+00022670: 7661 6c69 6420 7369 6465 3a20 6f6c 6420  valid side: old 
+00022680: 6f72 206e 6577 2729 0a20 2020 2020 2020  or new').       
+00022690: 2072 6574 7572 6e20 4c69 6e65 3344 286e   return Line3D(n
+000226a0: 6577 5f73 7461 7274 2c20 6e65 775f 656e  ew_start, new_en
+000226b0: 6429 0a0a 2020 2020 6465 6620 6672 616d  d)..    def fram
+000226c0: 655f 6d61 7070 696e 675f 696e 706c 6163  e_mapping_inplac
+000226d0: 6528 7365 6c66 2c20 6672 616d 653a 2076  e(self, frame: v
+000226e0: 6f6c 6d64 6c72 2e46 7261 6d65 3344 2c20  olmdlr.Frame3D, 
+000226f0: 7369 6465 3a20 7374 7229 3a0a 2020 2020  side: str):.    
+00022700: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00022710: 4368 616e 6765 7320 4c69 6e65 3344 2066  Changes Line3D f
+00022720: 7261 6d65 5f6d 6170 7069 6e67 2061 6e64  rame_mapping and
+00022730: 2074 6865 206f 626a 6563 7420 6973 2075   the object is u
+00022740: 7064 6174 6564 2069 6e70 6c61 6365 2e0a  pdated inplace..
+00022750: 0a20 2020 2020 2020 2073 6964 6520 3d20  .        side = 
+00022760: 276f 6c64 2720 6f72 2027 6e65 7727 0a20  'old' or 'new'. 
+00022770: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00022780: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+00022790: 2822 2769 6e70 6c61 6365 2720 6d65 7468  ("'inplace' meth
+000227a0: 6f64 7320 6172 6520 6465 7072 6563 6174  ods are deprecat
+000227b0: 6564 2e20 5573 6520 6120 6e6f 7420 696e  ed. Use a not in
+000227c0: 706c 6163 6520 6d65 7468 6f64 2069 6e73  place method ins
+000227d0: 7465 6164 2e22 2c20 4465 7072 6563 6174  tead.", Deprecat
+000227e0: 696f 6e57 6172 6e69 6e67 290a 0a20 2020  ionWarning)..   
+000227f0: 2020 2020 2069 6620 7369 6465 203d 3d20       if side == 
+00022800: 276f 6c64 273a 0a20 2020 2020 2020 2020  'old':.         
+00022810: 2020 206e 6577 5f73 7461 7274 203d 2066     new_start = f
+00022820: 7261 6d65 2e6c 6f63 616c 5f74 6f5f 676c  rame.local_to_gl
+00022830: 6f62 616c 5f63 6f6f 7264 696e 6174 6573  obal_coordinates
+00022840: 2873 656c 662e 706f 696e 7431 290a 2020  (self.point1).  
+00022850: 2020 2020 2020 2020 2020 6e65 775f 656e            new_en
+00022860: 6420 3d20 6672 616d 652e 6c6f 6361 6c5f  d = frame.local_
+00022870: 746f 5f67 6c6f 6261 6c5f 636f 6f72 6469  to_global_coordi
+00022880: 6e61 7465 7328 7365 6c66 2e70 6f69 6e74  nates(self.point
+00022890: 3229 0a20 2020 2020 2020 2065 6c69 6620  2).        elif 
+000228a0: 7369 6465 203d 3d20 276e 6577 273a 0a20  side == 'new':. 
+000228b0: 2020 2020 2020 2020 2020 206e 6577 5f73             new_s
+000228c0: 7461 7274 203d 2066 7261 6d65 2e67 6c6f  tart = frame.glo
+000228d0: 6261 6c5f 746f 5f6c 6f63 616c 5f63 6f6f  bal_to_local_coo
+000228e0: 7264 696e 6174 6573 2873 656c 662e 706f  rdinates(self.po
+000228f0: 696e 7431 290a 2020 2020 2020 2020 2020  int1).          
+00022900: 2020 6e65 775f 656e 6420 3d20 6672 616d    new_end = fram
+00022910: 652e 676c 6f62 616c 5f74 6f5f 6c6f 6361  e.global_to_loca
+00022920: 6c5f 636f 6f72 6469 6e61 7465 7328 7365  l_coordinates(se
+00022930: 6c66 2e70 6f69 6e74 3229 0a20 2020 2020  lf.point2).     
+00022940: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00022950: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00022960: 4572 726f 7228 2750 6c65 6173 6520 456e  Error('Please En
+00022970: 7465 7220 6120 7661 6c69 6420 7369 6465  ter a valid side
+00022980: 3a20 6f6c 6420 6f72 206e 6577 2729 0a20  : old or new'). 
+00022990: 2020 2020 2020 2073 656c 662e 706f 696e         self.poin
+000229a0: 7431 203d 206e 6577 5f73 7461 7274 0a20  t1 = new_start. 
+000229b0: 2020 2020 2020 2073 656c 662e 706f 696e         self.poin
+000229c0: 7432 203d 206e 6577 5f65 6e64 0a20 2020  t2 = new_end.   
+000229d0: 2020 2020 2073 656c 662e 5f62 626f 7820       self._bbox 
+000229e0: 3d20 4e6f 6e65 0a0a 2020 2020 6465 6620  = None..    def 
+000229f0: 7472 696d 2873 656c 662c 2070 6f69 6e74  trim(self, point
+00022a00: 313a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  1: volmdlr.Point
+00022a10: 3344 2c20 706f 696e 7432 3a20 766f 6c6d  3D, point2: volm
+00022a20: 646c 722e 506f 696e 7433 4429 3a0a 2020  dlr.Point3D):.  
+00022a30: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+00022a40: 662e 706f 696e 745f 6265 6c6f 6e67 7328  f.point_belongs(
+00022a50: 706f 696e 7431 2920 6f72 206e 6f74 2073  point1) or not s
+00022a60: 656c 662e 706f 696e 745f 6265 6c6f 6e67  elf.point_belong
+00022a70: 7328 706f 696e 7432 293a 0a20 2020 2020  s(point2):.     
+00022a80: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00022a90: 7565 4572 726f 7228 2750 6f69 6e74 206e  ueError('Point n
+00022aa0: 6f74 206f 6e20 6375 7276 6527 290a 0a20  ot on curve').. 
+00022ab0: 2020 2020 2020 2072 6574 7572 6e20 4c69         return Li
+00022ac0: 6e65 5365 676d 656e 7433 4428 706f 696e  neSegment3D(poin
+00022ad0: 7431 2c20 706f 696e 7432 290a 0a20 2020  t1, point2)..   
+00022ae0: 2064 6566 2063 6f70 7928 7365 6c66 2c20   def copy(self, 
+00022af0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00022b00: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00022b10: 204c 696e 6533 4428 2a5b 702e 636f 7079   Line3D(*[p.copy
+00022b20: 2829 2066 6f72 2070 2069 6e20 5b73 656c  () for p in [sel
+00022b30: 662e 706f 696e 7431 2c20 7365 6c66 2e70  f.point1, self.p
+00022b40: 6f69 6e74 325d 5d29 0a0a 2020 2020 4063  oint2]])..    @c
+00022b50: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
+00022b60: 6566 2066 726f 6d5f 7374 6570 2863 6c73  ef from_step(cls
+00022b70: 2c20 6172 6775 6d65 6e74 732c 206f 626a  , arguments, obj
+00022b80: 6563 745f 6469 6374 293a 0a20 2020 2020  ect_dict):.     
+00022b90: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+00022ba0: 6f6e 7665 7274 7320 6120 7374 6570 2070  onverts a step p
+00022bb0: 7269 6d69 7469 7665 2074 6f20 616e 204c  rimitive to an L
+00022bc0: 696e 6533 442e 0a0a 2020 2020 2020 2020  ine3D...        
+00022bd0: 3a70 6172 616d 2061 7267 756d 656e 7473  :param arguments
+00022be0: 3a20 5468 6520 6172 6775 6d65 6e74 7320  : The arguments 
+00022bf0: 6f66 2074 6865 2073 7465 7020 7072 696d  of the step prim
+00022c00: 6974 6976 652e 2054 6865 206c 6173 7420  itive. The last 
+00022c10: 656c 656d 656e 7420 7265 7072 6573 656e  element represen
+00022c20: 7473 2074 6865 2075 6e69 745f 636f 6e76  ts the unit_conv
+00022c30: 6572 7369 6f6e 5f66 6163 746f 722e 0a20  ersion_factor.. 
+00022c40: 2020 2020 2020 203a 7479 7065 2061 7267         :type arg
+00022c50: 756d 656e 7473 3a20 6c69 7374 0a20 2020  uments: list.   
+00022c60: 2020 2020 203a 7061 7261 6d20 6f62 6a65       :param obje
+00022c70: 6374 5f64 6963 743a 2054 6865 2064 6963  ct_dict: The dic
+00022c80: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
+00022c90: 6e67 2061 6c6c 2074 6865 2073 7465 7020  ng all the step 
+00022ca0: 7072 696d 6974 6976 6573 0a20 2020 2020  primitives.     
+00022cb0: 2020 2020 2020 2074 6861 7420 6861 7665         that have
+00022cc0: 2061 6c72 6561 6479 2062 6565 6e20 696e   already been in
+00022cd0: 7374 616e 7469 6174 6564 0a20 2020 2020  stantiated.     
+00022ce0: 2020 203a 7479 7065 206f 626a 6563 745f     :type object_
+00022cf0: 6469 6374 3a20 6469 6374 0a20 2020 2020  dict: dict.     
+00022d00: 2020 203a 7265 7475 726e 3a20 5468 6520     :return: The 
+00022d10: 636f 7272 6573 706f 6e64 696e 6720 4c69  corresponding Li
+00022d20: 6e65 3344 206f 626a 6563 740a 2020 2020  ne3D object.    
+00022d30: 2020 2020 3a72 7479 7065 3a20 3a63 6c61      :rtype: :cla
+00022d40: 7373 3a60 766f 6c6d 646c 722e 6564 6765  ss:`volmdlr.edge
+00022d50: 732e 4c69 6e65 3344 600a 2020 2020 2020  s.Line3D`.      
+00022d60: 2020 2222 220a 2020 2020 2020 2020 706f    """.        po
+00022d70: 696e 7431 203d 206f 626a 6563 745f 6469  int1 = object_di
+00022d80: 6374 5b61 7267 756d 656e 7473 5b31 5d5d  ct[arguments[1]]
+00022d90: 0a20 2020 2020 2020 2064 6972 6563 7469  .        directi
+00022da0: 6f6e 203d 206f 626a 6563 745f 6469 6374  on = object_dict
+00022db0: 5b61 7267 756d 656e 7473 5b32 5d5d 0a20  [arguments[2]]. 
+00022dc0: 2020 2020 2020 2070 6f69 6e74 3220 3d20         point2 = 
+00022dd0: 706f 696e 7431 202b 2064 6972 6563 7469  point1 + directi
+00022de0: 6f6e 0a20 2020 2020 2020 2072 6574 7572  on.        retur
+00022df0: 6e20 636c 7328 706f 696e 7431 2c20 706f  n cls(point1, po
+00022e00: 696e 7432 2c20 6172 6775 6d65 6e74 735b  int2, arguments[
+00022e10: 305d 5b31 3a2d 315d 290a 0a20 2020 2064  0][1:-1])..    d
+00022e20: 6566 2074 6f5f 7374 6570 2873 656c 662c  ef to_step(self,
+00022e30: 2063 7572 7265 6e74 5f69 642c 2073 7572   current_id, sur
+00022e40: 6661 6365 5f69 643d 4e6f 6e65 293a 0a20  face_id=None):. 
+00022e50: 2020 2020 2020 2022 2222 4578 706f 7274         """Export
+00022e60: 7320 746f 2053 5445 5020 666f 726d 6174  s to STEP format
+00022e70: 2e22 2222 0a20 2020 2020 2020 2070 315f  .""".        p1_
+00022e80: 636f 6e74 656e 742c 2070 315f 6964 203d  content, p1_id =
+00022e90: 2073 656c 662e 706f 696e 7431 2e74 6f5f   self.point1.to_
+00022ea0: 7374 6570 2863 7572 7265 6e74 5f69 6429  step(current_id)
+00022eb0: 0a20 2020 2020 2020 2023 2070 325f 636f  .        # p2_co
+00022ec0: 6e74 656e 742c 2070 325f 6964 203d 2073  ntent, p2_id = s
+00022ed0: 656c 662e 706f 696e 7432 2e74 6f5f 7374  elf.point2.to_st
+00022ee0: 6570 2863 7572 7265 6e74 5f69 642b 3129  ep(current_id+1)
+00022ef0: 0a20 2020 2020 2020 2063 7572 7265 6e74  .        current
+00022f00: 5f69 6420 3d20 7031 5f69 6420 2b20 310a  _id = p1_id + 1.
+00022f10: 2020 2020 2020 2020 755f 636f 6e74 656e          u_conten
+00022f20: 742c 2075 5f69 6420 3d20 766f 6c6d 646c  t, u_id = volmdl
+00022f30: 722e 5665 6374 6f72 3344 2e74 6f5f 7374  r.Vector3D.to_st
+00022f40: 6570 280a 2020 2020 2020 2020 2020 2020  ep(.            
+00022f50: 7365 6c66 2e75 6e69 745f 6469 7265 6374  self.unit_direct
+00022f60: 696f 6e5f 7665 6374 6f72 2829 2c0a 2020  ion_vector(),.  
+00022f70: 2020 2020 2020 2020 2020 6375 7272 656e            curren
+00022f80: 745f 6964 2c0a 2020 2020 2020 2020 2020  t_id,.          
+00022f90: 2020 7665 6374 6f72 3d54 7275 6529 0a20    vector=True). 
+00022fa0: 2020 2020 2020 2063 7572 7265 6e74 5f69         current_i
+00022fb0: 6420 3d20 755f 6964 202b 2031 0a20 2020  d = u_id + 1.   
+00022fc0: 2020 2020 2063 6f6e 7465 6e74 203d 2070       content = p
+00022fd0: 315f 636f 6e74 656e 7420 2b20 755f 636f  1_content + u_co
+00022fe0: 6e74 656e 740a 2020 2020 2020 2020 636f  ntent.        co
+00022ff0: 6e74 656e 7420 2b3d 2066 2223 7b63 7572  ntent += f"#{cur
+00023000: 7265 6e74 5f69 647d 203d 204c 494e 4528  rent_id} = LINE(
+00023010: 277b 7365 6c66 2e6e 616d 657d 272c 237b  '{self.name}',#{
+00023020: 7031 5f69 647d 2c23 7b75 5f69 647d 293b  p1_id},#{u_id});
+00023030: 5c6e 220a 2020 2020 2020 2020 7265 7475  \n".        retu
+00023040: 726e 2063 6f6e 7465 6e74 2c20 6375 7272  rn content, curr
+00023050: 656e 745f 6964 0a0a 2020 2020 6465 6620  ent_id..    def 
+00023060: 746f 5f32 6428 7365 6c66 2c20 706c 616e  to_2d(self, plan
+00023070: 655f 6f72 6967 696e 2c20 782c 2079 293a  e_origin, x, y):
+00023080: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00023090: 2020 2020 2054 7261 6e73 666f 726d 7320       Transforms 
+000230a0: 6120 4c69 6e65 3344 2069 6e74 6f20 616e  a Line3D into an
+000230b0: 204c 696e 6532 442c 2067 6976 656e 2061   Line2D, given a
+000230c0: 6e20 706c 616e 6520 6f72 6967 696e 2061  n plane origin a
+000230d0: 6e64 2061 2075 2061 6e64 2076 2070 6c61  nd a u and v pla
+000230e0: 6e65 2076 6563 746f 722e 0a0a 2020 2020  ne vector...    
+000230f0: 2020 2020 3a70 6172 616d 2070 6c61 6e65      :param plane
+00023100: 5f6f 7269 6769 6e3a 2070 6c61 6e65 206f  _origin: plane o
+00023110: 7269 6769 6e2e 0a20 2020 2020 2020 203a  rigin..        :
+00023120: 7061 7261 6d20 783a 2070 6c61 6e65 2075  param x: plane u
+00023130: 2076 6563 746f 722e 0a20 2020 2020 2020   vector..       
+00023140: 203a 7061 7261 6d20 793a 2070 6c61 6e65   :param y: plane
+00023150: 2076 2076 6563 746f 722e 0a20 2020 2020   v vector..     
+00023160: 2020 203a 7265 7475 726e 3a20 4c69 6e65     :return: Line
+00023170: 3244 2e0a 2020 2020 2020 2020 2222 220a  2D..        """.
+00023180: 2020 2020 2020 2020 7032 6420 3d20 5b70          p2d = [p
+00023190: 2e74 6f5f 3264 2870 6c61 6e65 5f6f 7269  .to_2d(plane_ori
+000231a0: 6769 6e2c 2078 2c20 7929 2066 6f72 2070  gin, x, y) for p
+000231b0: 2069 6e20 2873 656c 662e 706f 696e 7431   in (self.point1
+000231c0: 2c20 7365 6c66 2e70 6f69 6e74 3229 5d0a  , self.point2)].
+000231d0: 2020 2020 2020 2020 6966 2070 3264 5b30          if p2d[0
+000231e0: 5d20 3d3d 2070 3264 5b31 5d3a 0a20 2020  ] == p2d[1]:.   
+000231f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00023200: 4e6f 6e65 0a20 2020 2020 2020 2072 6574  None.        ret
+00023210: 7572 6e20 4c69 6e65 3244 282a 7032 642c  urn Line2D(*p2d,
+00023220: 206e 616d 653d 7365 6c66 2e6e 616d 6529   name=self.name)
+00023230: 0a0a 0a63 6c61 7373 204c 696e 6553 6567  ...class LineSeg
+00023240: 6d65 6e74 3344 284c 696e 6553 6567 6d65  ment3D(LineSegme
+00023250: 6e74 293a 0a20 2020 2022 2222 0a20 2020  nt):.    """.   
+00023260: 2044 6566 696e 6520 6120 6c69 6e65 2073   Define a line s
+00023270: 6567 6d65 6e74 206c 696d 6974 6564 2062  egment limited b
+00023280: 7920 7477 6f20 706f 696e 7473 2e0a 0a20  y two points... 
+00023290: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
+000232a0: 5f5f 696e 6974 5f5f 2873 656c 662c 2073  __init__(self, s
+000232b0: 7461 7274 3a20 766f 6c6d 646c 722e 506f  tart: volmdlr.Po
+000232c0: 696e 7433 442c 2065 6e64 3a20 766f 6c6d  int3D, end: volm
+000232d0: 646c 722e 506f 696e 7433 442c 0a20 2020  dlr.Point3D,.   
+000232e0: 2020 2020 2020 2020 2020 2020 2020 6e61                na
+000232f0: 6d65 3a20 7374 7220 3d20 2727 293a 0a20  me: str = ''):. 
+00023300: 2020 2020 2020 2069 6620 7374 6172 7420         if start 
+00023310: 3d3d 2065 6e64 3a0a 2020 2020 2020 2020  == end:.        
+00023320: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+00023330: 6c65 6d65 6e74 6564 4572 726f 720a 2020  lementedError.  
+00023340: 2020 2020 2020 2320 7365 6c66 2e70 6f69        # self.poi
+00023350: 6e74 7320 3d20 5b73 7461 7274 2c20 656e  nts = [start, en
+00023360: 645d 0a20 2020 2020 2020 204c 696e 6553  d].        LineS
+00023370: 6567 6d65 6e74 2e5f 5f69 6e69 745f 5f28  egment.__init__(
+00023380: 7365 6c66 2c20 7374 6172 743d 7374 6172  self, start=star
+00023390: 742c 2065 6e64 3d65 6e64 2c20 6e61 6d65  t, end=end, name
+000233a0: 3d6e 616d 6529 0a20 2020 2020 2020 2073  =name).        s
+000233b0: 656c 662e 5f62 626f 7820 3d20 4e6f 6e65  elf._bbox = None
+000233c0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+000233d0: 2020 2020 6465 6620 626f 756e 6469 6e67      def bounding
+000233e0: 5f62 6f78 2873 656c 6629 3a0a 2020 2020  _box(self):.    
+000233f0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+00023400: 5f62 626f 783a 0a20 2020 2020 2020 2020  _bbox:.         
+00023410: 2020 2073 656c 662e 5f62 626f 7820 3d20     self._bbox = 
+00023420: 7365 6c66 2e5f 626f 756e 6469 6e67 5f62  self._bounding_b
+00023430: 6f78 2829 0a20 2020 2020 2020 2072 6574  ox().        ret
+00023440: 7572 6e20 7365 6c66 2e5f 6262 6f78 0a0a  urn self._bbox..
+00023450: 2020 2020 4062 6f75 6e64 696e 675f 626f      @bounding_bo
+00023460: 782e 7365 7474 6572 0a20 2020 2064 6566  x.setter.    def
+00023470: 2062 6f75 6e64 696e 675f 626f 7828 7365   bounding_box(se
+00023480: 6c66 2c20 6e65 775f 626f 756e 6469 6e67  lf, new_bounding
+00023490: 5f62 6f78 293a 0a20 2020 2020 2020 2073  _box):.        s
+000234a0: 656c 662e 5f62 626f 7820 3d20 6e65 775f  elf._bbox = new_
+000234b0: 626f 756e 6469 6e67 5f62 6f78 0a0a 2020  bounding_box..  
+000234c0: 2020 6465 6620 5f5f 6861 7368 5f5f 2873    def __hash__(s
+000234d0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+000234e0: 7475 726e 2032 202b 2068 6173 6828 7365  turn 2 + hash(se
+000234f0: 6c66 2e73 7461 7274 2920 2b20 6861 7368  lf.start) + hash
+00023500: 2873 656c 662e 656e 6429 0a0a 2020 2020  (self.end)..    
+00023510: 6465 6620 5f5f 6571 5f5f 2873 656c 662c  def __eq__(self,
+00023520: 206f 7468 6572 5f6c 696e 6573 6567 6d65   other_linesegme
+00023530: 6e74 3364 293a 0a20 2020 2020 2020 2069  nt3d):.        i
+00023540: 6620 6f74 6865 725f 6c69 6e65 7365 676d  f other_linesegm
+00023550: 656e 7433 642e 5f5f 636c 6173 735f 5f20  ent3d.__class__ 
+00023560: 213d 2073 656c 662e 5f5f 636c 6173 735f  != self.__class_
+00023570: 5f3a 0a20 2020 2020 2020 2020 2020 2072  _:.            r
+00023580: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
+00023590: 2020 2020 7265 7475 726e 2028 7365 6c66      return (self
+000235a0: 2e73 7461 7274 203d 3d20 6f74 6865 725f  .start == other_
+000235b0: 6c69 6e65 7365 676d 656e 7433 642e 7374  linesegment3d.st
+000235c0: 6172 740a 2020 2020 2020 2020 2020 2020  art.            
+000235d0: 2020 2020 616e 6420 7365 6c66 2e65 6e64      and self.end
+000235e0: 203d 3d20 6f74 6865 725f 6c69 6e65 7365   == other_linese
+000235f0: 676d 656e 7433 642e 656e 6429 0a0a 2020  gment3d.end)..  
+00023600: 2020 6465 6620 5f62 6f75 6e64 696e 675f    def _bounding_
+00023610: 626f 7828 7365 6c66 293a 0a0a 2020 2020  box(self):..    
+00023620: 2020 2020 786d 696e 203d 206d 696e 2873      xmin = min(s
+00023630: 656c 662e 7374 6172 742e 782c 2073 656c  elf.start.x, sel
+00023640: 662e 656e 642e 7829 0a20 2020 2020 2020  f.end.x).       
+00023650: 2078 6d61 7820 3d20 6d61 7828 7365 6c66   xmax = max(self
+00023660: 2e73 7461 7274 2e78 2c20 7365 6c66 2e65  .start.x, self.e
+00023670: 6e64 2e78 290a 2020 2020 2020 2020 796d  nd.x).        ym
+00023680: 696e 203d 206d 696e 2873 656c 662e 7374  in = min(self.st
+00023690: 6172 742e 792c 2073 656c 662e 656e 642e  art.y, self.end.
+000236a0: 7929 0a20 2020 2020 2020 2079 6d61 7820  y).        ymax 
+000236b0: 3d20 6d61 7828 7365 6c66 2e73 7461 7274  = max(self.start
+000236c0: 2e79 2c20 7365 6c66 2e65 6e64 2e79 290a  .y, self.end.y).
+000236d0: 2020 2020 2020 2020 7a6d 696e 203d 206d          zmin = m
+000236e0: 696e 2873 656c 662e 7374 6172 742e 7a2c  in(self.start.z,
+000236f0: 2073 656c 662e 656e 642e 7a29 0a20 2020   self.end.z).   
+00023700: 2020 2020 207a 6d61 7820 3d20 6d61 7828       zmax = max(
+00023710: 7365 6c66 2e73 7461 7274 2e7a 2c20 7365  self.start.z, se
+00023720: 6c66 2e65 6e64 2e7a 290a 0a20 2020 2020  lf.end.z)..     
+00023730: 2020 2072 6574 7572 6e20 766f 6c6d 646c     return volmdl
+00023740: 722e 636f 7265 2e42 6f75 6e64 696e 6742  r.core.BoundingB
+00023750: 6f78 2878 6d69 6e2c 2078 6d61 782c 2079  ox(xmin, xmax, y
+00023760: 6d69 6e2c 2079 6d61 782c 207a 6d69 6e2c  min, ymax, zmin,
+00023770: 207a 6d61 7829 0a0a 2020 2020 6465 6620   zmax)..    def 
+00023780: 746f 5f64 6963 7428 7365 6c66 2c20 2a61  to_dict(self, *a
+00023790: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+000237a0: 2020 2020 2020 2020 7265 7475 726e 207b          return {
+000237b0: 276f 626a 6563 745f 636c 6173 7327 3a20  'object_class': 
+000237c0: 2776 6f6c 6d64 6c72 2e65 6467 6573 2e4c  'volmdlr.edges.L
+000237d0: 696e 6553 6567 6d65 6e74 3344 272c 0a20  ineSegment3D',. 
+000237e0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000237f0: 6e61 6d65 273a 2073 656c 662e 6e61 6d65  name': self.name
+00023800: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00023810: 2020 2773 7461 7274 273a 2073 656c 662e    'start': self.
+00023820: 7374 6172 742e 746f 5f64 6963 7428 292c  start.to_dict(),
+00023830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023840: 2027 656e 6427 3a20 7365 6c66 2e65 6e64   'end': self.end
+00023850: 2e74 6f5f 6469 6374 2829 0a20 2020 2020  .to_dict().     
+00023860: 2020 2020 2020 2020 2020 207d 0a0a 2020             }..  
+00023870: 2020 2320 6465 6620 706f 696e 745f 6174    # def point_at
+00023880: 5f61 6273 6369 7373 6128 7365 6c66 2c20  _abscissa(self, 
+00023890: 6162 7363 6973 7361 293a 0a20 2020 2023  abscissa):.    #
+000238a0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000238b0: 2e73 7461 7274 202b 2061 6273 6369 7373  .start + absciss
+000238c0: 6120 2a20 280a 2020 2020 2320 2020 2020  a * (.    #     
+000238d0: 2020 2020 7365 6c66 2e65 6e64 202d 2073      self.end - s
+000238e0: 656c 662e 7374 6172 7429 202f 2073 656c  elf.start) / sel
+000238f0: 662e 6c65 6e67 7468 2829 0a0a 2020 2020  f.length()..    
+00023900: 6465 6620 706f 696e 745f 6265 6c6f 6e67  def point_belong
+00023910: 7328 7365 6c66 2c20 706f 696e 742c 2061  s(self, point, a
+00023920: 6273 5f74 6f6c 3d31 652d 3729 3a0a 2020  bs_tol=1e-7):.  
+00023930: 2020 2020 2020 706f 696e 745f 6469 7374        point_dist
+00023940: 616e 6365 203d 2073 656c 662e 706f 696e  ance = self.poin
+00023950: 745f 6469 7374 616e 6365 2870 6f69 6e74  t_distance(point
+00023960: 290a 2020 2020 2020 2020 6966 206d 6174  ).        if mat
+00023970: 682e 6973 636c 6f73 6528 706f 696e 745f  h.isclose(point_
+00023980: 6469 7374 616e 6365 2c20 302c 2061 6273  distance, 0, abs
+00023990: 5f74 6f6c 3d61 6273 5f74 6f6c 293a 0a20  _tol=abs_tol):. 
+000239a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000239b0: 6e20 5472 7565 0a20 2020 2020 2020 2072  n True.        r
+000239c0: 6574 7572 6e20 4661 6c73 650a 0a20 2020  eturn False..   
+000239d0: 2064 6566 206e 6f72 6d61 6c5f 7665 6374   def normal_vect
+000239e0: 6f72 2873 656c 662c 2061 6273 6369 7373  or(self, absciss
+000239f0: 613d 302e 293a 0a20 2020 2020 2020 2072  a=0.):.        r
+00023a00: 6574 7572 6e20 4e6f 6e65 0a0a 2020 2020  eturn None..    
+00023a10: 6465 6620 756e 6974 5f6e 6f72 6d61 6c5f  def unit_normal_
+00023a20: 7665 6374 6f72 2873 656c 662c 2061 6273  vector(self, abs
+00023a30: 6369 7373 613d 302e 293a 0a20 2020 2020  cissa=0.):.     
+00023a40: 2020 2072 6574 7572 6e20 4e6f 6e65 0a0a     return None..
+00023a50: 2020 2020 2320 6465 6620 6d69 6464 6c65      # def middle
+00023a60: 5f70 6f69 6e74 2873 656c 6629 3a0a 2020  _point(self):.  
+00023a70: 2020 2320 2020 2020 7265 7475 726e 2073    #     return s
+00023a80: 656c 662e 706f 696e 745f 6174 5f61 6273  elf.point_at_abs
+00023a90: 6369 7373 6128 302e 3520 2a20 7365 6c66  cissa(0.5 * self
+00023aa0: 2e6c 656e 6774 6828 2929 0a0a 2020 2020  .length())..    
+00023ab0: 6465 6620 706f 696e 745f 6469 7374 616e  def point_distan
+00023ac0: 6365 2873 656c 662c 2070 6f69 6e74 293a  ce(self, point):
+00023ad0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00023ae0: 726e 7320 7468 6520 6d69 6e69 6d61 6c20  rns the minimal 
+00023af0: 6469 7374 616e 6365 2074 6f20 6120 706f  distance to a po
+00023b00: 696e 742e 2222 220a 2020 2020 2020 2020  int.""".        
+00023b10: 6469 7374 616e 6365 2c20 706f 696e 7420  distance, point 
+00023b20: 3d20 766f 6c6d 646c 722e 4c69 6e65 5365  = volmdlr.LineSe
+00023b30: 676d 656e 7433 4450 6f69 6e74 4469 7374  gment3DPointDist
+00023b40: 616e 6365 280a 2020 2020 2020 2020 2020  ance(.          
+00023b50: 2020 5b28 7365 6c66 2e73 7461 7274 2e78    [(self.start.x
+00023b60: 2c20 7365 6c66 2e73 7461 7274 2e79 2c20  , self.start.y, 
+00023b70: 7365 6c66 2e73 7461 7274 2e7a 292c 0a20  self.start.z),. 
+00023b80: 2020 2020 2020 2020 2020 2020 2873 656c              (sel
+00023b90: 662e 656e 642e 782c 2073 656c 662e 656e  f.end.x, self.en
+00023ba0: 642e 792c 2073 656c 662e 656e 642e 7a29  d.y, self.end.z)
+00023bb0: 5d2c 0a20 2020 2020 2020 2020 2020 2028  ],.            (
+00023bc0: 706f 696e 742e 782c 2070 6f69 6e74 2e79  point.x, point.y
+00023bd0: 2c20 706f 696e 742e 7a29 290a 2020 2020  , point.z)).    
+00023be0: 2020 2020 7265 7475 726e 2064 6973 7461      return dista
+00023bf0: 6e63 650a 0a20 2020 2064 6566 2070 6c61  nce..    def pla
+00023c00: 6e65 5f70 726f 6a65 6374 696f 6e32 6428  ne_projection2d(
+00023c10: 7365 6c66 2c20 6365 6e74 6572 2c20 782c  self, center, x,
+00023c20: 2079 293a 0a20 2020 2020 2020 2073 7461   y):.        sta
+00023c30: 7274 2c20 656e 6420 3d20 7365 6c66 2e73  rt, end = self.s
+00023c40: 7461 7274 2e70 6c61 6e65 5f70 726f 6a65  tart.plane_proje
+00023c50: 6374 696f 6e32 6428 6365 6e74 6572 2c20  ction2d(center, 
+00023c60: 782c 2079 292c 2073 656c 662e 656e 642e  x, y), self.end.
+00023c70: 706c 616e 655f 7072 6f6a 6563 7469 6f6e  plane_projection
+00023c80: 3264 2863 656e 7465 722c 2078 2c20 7929  2d(center, x, y)
+00023c90: 0a20 2020 2020 2020 2069 6620 7374 6172  .        if star
+00023ca0: 7420 213d 2065 6e64 3a0a 2020 2020 2020  t != end:.      
+00023cb0: 2020 2020 2020 7265 7475 726e 204c 696e        return Lin
+00023cc0: 6553 6567 6d65 6e74 3244 2873 7461 7274  eSegment2D(start
+00023cd0: 2c20 656e 6429 0a20 2020 2020 2020 2072  , end).        r
+00023ce0: 6574 7572 6e20 4e6f 6e65 0a0a 2020 2020  eturn None..    
+00023cf0: 6465 6620 6c69 6e65 5f69 6e74 6572 7365  def line_interse
+00023d00: 6374 696f 6e73 2873 656c 662c 206c 696e  ctions(self, lin
+00023d10: 6529 3a0a 2020 2020 2020 2020 6c69 6e65  e):.        line
+00023d20: 5f73 656c 6620 3d20 7365 6c66 2e74 6f5f  _self = self.to_
+00023d30: 6c69 6e65 2829 0a20 2020 2020 2020 2069  line().        i
+00023d40: 6620 6c69 6e65 5f73 656c 662e 736b 6577  f line_self.skew
+00023d50: 5f74 6f28 6c69 6e65 293a 0a20 2020 2020  _to(line):.     
+00023d60: 2020 2020 2020 2072 6574 7572 6e20 5b5d         return []
+00023d70: 0a20 2020 2020 2020 2069 6e74 6572 7365  .        interse
+00023d80: 6374 696f 6e20 3d20 6c69 6e65 5f73 656c  ction = line_sel
+00023d90: 662e 696e 7465 7273 6563 7469 6f6e 286c  f.intersection(l
+00023da0: 696e 6529 0a20 2020 2020 2020 2069 6620  ine).        if 
+00023db0: 696e 7465 7273 6563 7469 6f6e 2061 6e64  intersection and
+00023dc0: 2073 656c 662e 706f 696e 745f 6265 6c6f   self.point_belo
+00023dd0: 6e67 7328 696e 7465 7273 6563 7469 6f6e  ngs(intersection
+00023de0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00023df0: 6574 7572 6e20 5b69 6e74 6572 7365 6374  eturn [intersect
+00023e00: 696f 6e5d 0a20 2020 2020 2020 2072 6574  ion].        ret
+00023e10: 7572 6e20 5b5d 0a0a 2020 2020 6465 6620  urn []..    def 
+00023e20: 6c69 6e65 7365 676d 656e 745f 696e 7465  linesegment_inte
+00023e30: 7273 6563 7469 6f6e 7328 7365 6c66 2c20  rsections(self, 
+00023e40: 6c69 6e65 7365 676d 656e 7429 3a0a 2020  linesegment):.  
+00023e50: 2020 2020 2020 6c69 6e65 3120 3d20 7365        line1 = se
+00023e60: 6c66 2e74 6f5f 6c69 6e65 2829 0a20 2020  lf.to_line().   
+00023e70: 2020 2020 206c 696e 6532 203d 206c 696e       line2 = lin
+00023e80: 6573 6567 6d65 6e74 2e74 6f5f 6c69 6e65  esegment.to_line
+00023e90: 2829 0a20 2020 2020 2020 2069 6e74 6572  ().        inter
+00023ea0: 7365 6374 696f 6e20 3d20 6c69 6e65 312e  section = line1.
+00023eb0: 696e 7465 7273 6563 7469 6f6e 286c 696e  intersection(lin
+00023ec0: 6532 290a 2020 2020 2020 2020 6966 2069  e2).        if i
+00023ed0: 6e74 6572 7365 6374 696f 6e20 616e 6420  ntersection and 
+00023ee0: 7365 6c66 2e70 6f69 6e74 5f62 656c 6f6e  self.point_belon
+00023ef0: 6773 2869 6e74 6572 7365 6374 696f 6e29  gs(intersection)
+00023f00: 2061 6e64 206c 696e 6573 6567 6d65 6e74   and linesegment
+00023f10: 2e70 6f69 6e74 5f62 656c 6f6e 6773 2869  .point_belongs(i
+00023f20: 6e74 6572 7365 6374 696f 6e29 3a0a 2020  ntersection):.  
+00023f30: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00023f40: 205b 696e 7465 7273 6563 7469 6f6e 5d0a   [intersection].
+00023f50: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+00023f60: 5d0a 0a20 2020 2064 6566 2072 6f74 6174  ]..    def rotat
+00023f70: 696f 6e28 7365 6c66 2c20 6365 6e74 6572  ion(self, center
+00023f80: 3a20 766f 6c6d 646c 722e 506f 696e 7433  : volmdlr.Point3
+00023f90: 442c 0a20 2020 2020 2020 2020 2020 2020  D,.             
+00023fa0: 2020 2020 6178 6973 3a20 766f 6c6d 646c      axis: volmdl
+00023fb0: 722e 5665 6374 6f72 3344 2c20 616e 676c  r.Vector3D, angl
+00023fc0: 653a 2066 6c6f 6174 293a 0a20 2020 2020  e: float):.     
+00023fd0: 2020 2022 2222 0a20 2020 2020 2020 204c     """.        L
+00023fe0: 696e 6553 6567 6d65 6e74 3344 2072 6f74  ineSegment3D rot
+00023ff0: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+00024000: 3a70 6172 616d 2063 656e 7465 723a 2072  :param center: r
+00024010: 6f74 6174 696f 6e20 6365 6e74 6572 0a20  otation center. 
+00024020: 2020 2020 2020 203a 7061 7261 6d20 6178         :param ax
+00024030: 6973 3a20 726f 7461 7469 6f6e 2061 7869  is: rotation axi
+00024040: 730a 2020 2020 2020 2020 3a70 6172 616d  s.        :param
+00024050: 2061 6e67 6c65 3a20 616e 676c 6520 726f   angle: angle ro
+00024060: 7461 7469 6f6e 0a20 2020 2020 2020 203a  tation.        :
+00024070: 7265 7475 726e 3a20 6120 6e65 7720 726f  return: a new ro
+00024080: 7461 7465 6420 4c69 6e65 5365 676d 656e  tated LineSegmen
+00024090: 7433 440a 2020 2020 2020 2020 2222 220a  t3D.        """.
+000240a0: 2020 2020 2020 2020 7265 7475 726e 204c          return L
+000240b0: 696e 6553 6567 6d65 6e74 3344 280a 2020  ineSegment3D(.  
+000240c0: 2020 2020 2020 2020 2020 2a5b 706f 696e            *[poin
+000240d0: 742e 726f 7461 7469 6f6e 2863 656e 7465  t.rotation(cente
+000240e0: 722c 2061 7869 732c 2061 6e67 6c65 2920  r, axis, angle) 
+000240f0: 666f 7220 706f 696e 7420 696e 2073 656c  for point in sel
+00024100: 662e 706f 696e 7473 5d29 0a0a 2020 2020  f.points])..    
+00024110: 6465 6620 726f 7461 7469 6f6e 5f69 6e70  def rotation_inp
+00024120: 6c61 6365 2873 656c 662c 2063 656e 7465  lace(self, cente
+00024130: 723a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  r: volmdlr.Point
+00024140: 3344 2c0a 2020 2020 2020 2020 2020 2020  3D,.            
+00024150: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+00024160: 733a 2076 6f6c 6d64 6c72 2e56 6563 746f  s: volmdlr.Vecto
+00024170: 7233 442c 2061 6e67 6c65 3a20 666c 6f61  r3D, angle: floa
+00024180: 7429 3a0a 2020 2020 2020 2020 2222 220a  t):.        """.
+00024190: 2020 2020 2020 2020 4c69 6e65 3244 2072          Line2D r
+000241a0: 6f74 6174 696f 6e2e 204f 626a 6563 7420  otation. Object 
+000241b0: 6973 2075 7064 6174 6564 2069 6e70 6c61  is updated inpla
+000241c0: 6365 2e0a 0a20 2020 2020 2020 203a 7061  ce...        :pa
+000241d0: 7261 6d20 6365 6e74 6572 3a20 726f 7461  ram center: rota
+000241e0: 7469 6f6e 2063 656e 7465 720a 2020 2020  tion center.    
+000241f0: 2020 2020 3a70 6172 616d 2061 7869 733a      :param axis:
+00024200: 2072 6f74 6174 696f 6e20 6178 6973 0a20   rotation axis. 
+00024210: 2020 2020 2020 203a 7061 7261 6d20 616e         :param an
+00024220: 676c 653a 2072 6f74 6174 696f 6e20 616e  gle: rotation an
+00024230: 676c 650a 2020 2020 2020 2020 2222 220a  gle.        """.
+00024240: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00024250: 2e77 6172 6e28 2227 696e 706c 6163 6527  .warn("'inplace'
+00024260: 206d 6574 686f 6473 2061 7265 2064 6570   methods are dep
+00024270: 7265 6361 7465 642e 2055 7365 2061 206e  recated. Use a n
+00024280: 6f74 2069 6e70 6c61 6365 206d 6574 686f  ot inplace metho
+00024290: 6420 696e 7374 6561 642e 222c 2044 6570  d instead.", Dep
+000242a0: 7265 6361 7469 6f6e 5761 726e 696e 6729  recationWarning)
+000242b0: 0a0a 2020 2020 2020 2020 666f 7220 706f  ..        for po
+000242c0: 696e 7420 696e 2073 656c 662e 706f 696e  int in self.poin
+000242d0: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
+000242e0: 706f 696e 742e 726f 7461 7469 6f6e 5f69  point.rotation_i
+000242f0: 6e70 6c61 6365 2863 656e 7465 722c 2061  nplace(center, a
+00024300: 7869 732c 2061 6e67 6c65 290a 2020 2020  xis, angle).    
+00024310: 2020 2020 7365 6c66 2e5f 6262 6f78 203d      self._bbox =
+00024320: 204e 6f6e 650a 0a20 2020 2064 6566 205f   None..    def _
+00024330: 5f63 6f6e 7461 696e 735f 5f28 7365 6c66  _contains__(self
+00024340: 2c20 706f 696e 7429 3a0a 0a20 2020 2020  , point):..     
+00024350: 2020 2070 6f69 6e74 312c 2070 6f69 6e74     point1, point
+00024360: 3220 3d20 7365 6c66 2e73 7461 7274 2c20  2 = self.start, 
+00024370: 7365 6c66 2e65 6e64 0a20 2020 2020 2020  self.end.       
+00024380: 2061 7869 7320 3d20 706f 696e 7432 202d   axis = point2 -
+00024390: 2070 6f69 6e74 310a 2020 2020 2020 2020   point1.        
+000243a0: 7465 7374 203d 2070 6f69 6e74 2e72 6f74  test = point.rot
+000243b0: 6174 696f 6e28 706f 696e 7431 2c20 6178  ation(point1, ax
+000243c0: 6973 2c20 6d61 7468 2e70 6929 0a20 2020  is, math.pi).   
+000243d0: 2020 2020 2069 6620 7465 7374 203d 3d20       if test == 
+000243e0: 706f 696e 743a 0a20 2020 2020 2020 2020  point:.         
+000243f0: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
+00024400: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+00024410: 616c 7365 0a0a 2020 2020 6465 6620 7472  alse..    def tr
+00024420: 616e 736c 6174 696f 6e28 7365 6c66 2c20  anslation(self, 
+00024430: 6f66 6673 6574 3a20 766f 6c6d 646c 722e  offset: volmdlr.
+00024440: 5665 6374 6f72 3344 293a 0a20 2020 2020  Vector3D):.     
+00024450: 2020 2022 2222 0a20 2020 2020 2020 204c     """.        L
+00024460: 696e 6553 6567 6d65 6e74 3344 2074 7261  ineSegment3D tra
+00024470: 6e73 6c61 7469 6f6e 2e0a 0a20 2020 2020  nslation...     
+00024480: 2020 203a 7061 7261 6d20 6f66 6673 6574     :param offset
+00024490: 3a20 7472 616e 736c 6174 696f 6e20 7665  : translation ve
+000244a0: 6374 6f72 0a20 2020 2020 2020 203a 7265  ctor.        :re
+000244b0: 7475 726e 3a20 4120 6e65 7720 7472 616e  turn: A new tran
+000244c0: 736c 6174 6564 204c 696e 6553 6567 6d65  slated LineSegme
+000244d0: 6e74 3344 0a20 2020 2020 2020 2022 2222  nt3D.        """
+000244e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000244f0: 4c69 6e65 5365 676d 656e 7433 4428 0a20  LineSegment3D(. 
+00024500: 2020 2020 2020 2020 2020 202a 5b70 6f69             *[poi
+00024510: 6e74 2e74 7261 6e73 6c61 7469 6f6e 286f  nt.translation(o
+00024520: 6666 7365 7429 2066 6f72 2070 6f69 6e74  ffset) for point
+00024530: 2069 6e20 7365 6c66 2e70 6f69 6e74 735d   in self.points]
+00024540: 290a 0a20 2020 2064 6566 2074 7261 6e73  )..    def trans
+00024550: 6c61 7469 6f6e 5f69 6e70 6c61 6365 2873  lation_inplace(s
+00024560: 656c 662c 206f 6666 7365 743a 2076 6f6c  elf, offset: vol
+00024570: 6d64 6c72 2e56 6563 746f 7233 4429 3a0a  mdlr.Vector3D):.
+00024580: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00024590: 2020 2020 4c69 6e65 5365 676d 656e 7433      LineSegment3
+000245a0: 4420 7472 616e 736c 6174 696f 6e2e 204f  D translation. O
+000245b0: 626a 6563 7420 6973 2075 7064 6174 6564  bject is updated
+000245c0: 2069 6e70 6c61 6365 2e0a 0a20 2020 2020   inplace...     
+000245d0: 2020 203a 7061 7261 6d20 6f66 6673 6574     :param offset
+000245e0: 3a20 7472 616e 736c 6174 696f 6e20 7665  : translation ve
+000245f0: 6374 6f72 0a20 2020 2020 2020 2022 2222  ctor.        """
+00024600: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
+00024610: 732e 7761 726e 2822 2769 6e70 6c61 6365  s.warn("'inplace
+00024620: 2720 6d65 7468 6f64 7320 6172 6520 6465  ' methods are de
+00024630: 7072 6563 6174 6564 2e20 5573 6520 6120  precated. Use a 
+00024640: 6e6f 7420 696e 706c 6163 6520 6d65 7468  not inplace meth
+00024650: 6f64 2069 6e73 7465 6164 2e22 2c20 4465  od instead.", De
+00024660: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
+00024670: 290a 0a20 2020 2020 2020 2066 6f72 2070  )..        for p
+00024680: 6f69 6e74 2069 6e20 7365 6c66 2e70 6f69  oint in self.poi
+00024690: 6e74 733a 0a20 2020 2020 2020 2020 2020  nts:.           
+000246a0: 2070 6f69 6e74 2e74 7261 6e73 6c61 7469   point.translati
+000246b0: 6f6e 5f69 6e70 6c61 6365 286f 6666 7365  on_inplace(offse
+000246c0: 7429 0a20 2020 2020 2020 2073 656c 662e  t).        self.
+000246d0: 5f62 626f 7820 3d20 4e6f 6e65 0a0a 2020  _bbox = None..  
+000246e0: 2020 6465 6620 6672 616d 655f 6d61 7070    def frame_mapp
+000246f0: 696e 6728 7365 6c66 2c20 6672 616d 653a  ing(self, frame:
+00024700: 2076 6f6c 6d64 6c72 2e46 7261 6d65 3344   volmdlr.Frame3D
+00024710: 2c20 7369 6465 3a20 7374 7229 3a0a 2020  , side: str):.  
+00024720: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00024730: 2020 4368 616e 6765 7320 4c69 6e65 5365    Changes LineSe
+00024740: 676d 656e 7433 4420 6672 616d 655f 6d61  gment3D frame_ma
+00024750: 7070 696e 6720 616e 6420 7265 7475 726e  pping and return
+00024760: 2061 206e 6577 204c 696e 6553 6567 6d65   a new LineSegme
+00024770: 6e74 3344 2e0a 0a20 2020 2020 2020 2073  nt3D...        s
+00024780: 6964 6520 3d20 276f 6c64 2720 6f72 2027  ide = 'old' or '
+00024790: 6e65 7727 0a20 2020 2020 2020 2022 2222  new'.        """
+000247a0: 0a20 2020 2020 2020 2069 6620 7369 6465  .        if side
+000247b0: 203d 3d20 276f 6c64 273a 0a20 2020 2020   == 'old':.     
+000247c0: 2020 2020 2020 2072 6574 7572 6e20 4c69         return Li
+000247d0: 6e65 5365 676d 656e 7433 4428 0a20 2020  neSegment3D(.   
+000247e0: 2020 2020 2020 2020 2020 2020 202a 5b66               *[f
+000247f0: 7261 6d65 2e6c 6f63 616c 5f74 6f5f 676c  rame.local_to_gl
+00024800: 6f62 616c 5f63 6f6f 7264 696e 6174 6573  obal_coordinates
+00024810: 2870 6f69 6e74 2920 666f 7220 706f 696e  (point) for poin
+00024820: 7420 696e 205b 7365 6c66 2e73 7461 7274  t in [self.start
+00024830: 2c20 7365 6c66 2e65 6e64 5d5d 290a 2020  , self.end]]).  
+00024840: 2020 2020 2020 6966 2073 6964 6520 3d3d        if side ==
+00024850: 2027 6e65 7727 3a0a 2020 2020 2020 2020   'new':.        
+00024860: 2020 2020 7265 7475 726e 204c 696e 6553      return LineS
+00024870: 6567 6d65 6e74 3344 280a 2020 2020 2020  egment3D(.      
+00024880: 2020 2020 2020 2020 2020 2a5b 6672 616d            *[fram
+00024890: 652e 676c 6f62 616c 5f74 6f5f 6c6f 6361  e.global_to_loca
+000248a0: 6c5f 636f 6f72 6469 6e61 7465 7328 706f  l_coordinates(po
+000248b0: 696e 7429 2066 6f72 2070 6f69 6e74 2069  int) for point i
+000248c0: 6e20 5b73 656c 662e 7374 6172 742c 2073  n [self.start, s
+000248d0: 656c 662e 656e 645d 5d29 0a20 2020 2020  elf.end]]).     
+000248e0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000248f0: 726f 7228 2750 6c65 6173 6520 456e 7465  ror('Please Ente
+00024900: 7220 6120 7661 6c69 6420 7369 6465 3a20  r a valid side: 
+00024910: 6f6c 6420 6f72 206e 6577 2729 0a0a 2020  old or new')..  
+00024920: 2020 6465 6620 6672 616d 655f 6d61 7070    def frame_mapp
+00024930: 696e 675f 696e 706c 6163 6528 7365 6c66  ing_inplace(self
+00024940: 2c20 6672 616d 653a 2076 6f6c 6d64 6c72  , frame: volmdlr
+00024950: 2e46 7261 6d65 3344 2c20 7369 6465 3a20  .Frame3D, side: 
+00024960: 7374 7229 3a0a 2020 2020 2020 2020 2222  str):.        ""
+00024970: 220a 2020 2020 2020 2020 4368 616e 6765  ".        Change
+00024980: 7320 7665 6374 6f72 2066 7261 6d65 5f6d  s vector frame_m
+00024990: 6170 7069 6e67 2061 6e64 2074 6865 206f  apping and the o
+000249a0: 626a 6563 7420 6973 2075 7064 6174 6564  bject is updated
+000249b0: 2069 6e70 6c61 6365 2e0a 0a20 2020 2020   inplace...     
+000249c0: 2020 2073 6964 6520 3d20 276f 6c64 2720     side = 'old' 
+000249d0: 6f72 2027 6e65 7727 0a20 2020 2020 2020  or 'new'.       
+000249e0: 2022 2222 0a20 2020 2020 2020 2077 6172   """.        war
+000249f0: 6e69 6e67 732e 7761 726e 2822 2769 6e70  nings.warn("'inp
+00024a00: 6c61 6365 2720 6d65 7468 6f64 7320 6172  lace' methods ar
+00024a10: 6520 6465 7072 6563 6174 6564 2e20 5573  e deprecated. Us
+00024a20: 6520 6120 6e6f 7420 696e 706c 6163 6520  e a not inplace 
+00024a30: 6d65 7468 6f64 2069 6e73 7465 6164 2e22  method instead."
+00024a40: 2c20 4465 7072 6563 6174 696f 6e57 6172  , DeprecationWar
+00024a50: 6e69 6e67 290a 0a20 2020 2020 2020 2069  ning)..        i
+00024a60: 6620 7369 6465 203d 3d20 276f 6c64 273a  f side == 'old':
+00024a70: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+00024a80: 5f73 7461 7274 203d 2066 7261 6d65 2e6c  _start = frame.l
+00024a90: 6f63 616c 5f74 6f5f 676c 6f62 616c 5f63  ocal_to_global_c
+00024aa0: 6f6f 7264 696e 6174 6573 2873 656c 662e  oordinates(self.
+00024ab0: 7374 6172 7429 0a20 2020 2020 2020 2020  start).         
+00024ac0: 2020 206e 6577 5f65 6e64 203d 2066 7261     new_end = fra
+00024ad0: 6d65 2e6c 6f63 616c 5f74 6f5f 676c 6f62  me.local_to_glob
+00024ae0: 616c 5f63 6f6f 7264 696e 6174 6573 2873  al_coordinates(s
+00024af0: 656c 662e 656e 6429 0a20 2020 2020 2020  elf.end).       
+00024b00: 2065 6c69 6620 7369 6465 203d 3d20 276e   elif side == 'n
+00024b10: 6577 273a 0a20 2020 2020 2020 2020 2020  ew':.           
+00024b20: 206e 6577 5f73 7461 7274 203d 2066 7261   new_start = fra
+00024b30: 6d65 2e67 6c6f 6261 6c5f 746f 5f6c 6f63  me.global_to_loc
+00024b40: 616c 5f63 6f6f 7264 696e 6174 6573 2873  al_coordinates(s
+00024b50: 656c 662e 7374 6172 7429 0a20 2020 2020  elf.start).     
+00024b60: 2020 2020 2020 206e 6577 5f65 6e64 203d         new_end =
+00024b70: 2066 7261 6d65 2e67 6c6f 6261 6c5f 746f   frame.global_to
+00024b80: 5f6c 6f63 616c 5f63 6f6f 7264 696e 6174  _local_coordinat
+00024b90: 6573 2873 656c 662e 656e 6429 0a20 2020  es(self.end).   
+00024ba0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00024bb0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00024bc0: 7565 4572 726f 7228 2750 6c65 6173 6520  ueError('Please 
+00024bd0: 456e 7465 7220 6120 7661 6c69 6420 7369  Enter a valid si
+00024be0: 6465 3a20 6f6c 6420 6f72 206e 6577 2729  de: old or new')
+00024bf0: 0a20 2020 2020 2020 2073 656c 662e 7374  .        self.st
+00024c00: 6172 7420 3d20 6e65 775f 7374 6172 740a  art = new_start.
+00024c10: 2020 2020 2020 2020 7365 6c66 2e65 6e64          self.end
+00024c20: 203d 206e 6577 5f65 6e64 0a20 2020 2020   = new_end.     
+00024c30: 2020 2073 656c 662e 5f62 626f 7820 3d20     self._bbox = 
+00024c40: 4e6f 6e65 0a0a 2020 2020 6465 6620 636f  None..    def co
+00024c50: 7079 2873 656c 662c 202a 6172 6773 2c20  py(self, *args, 
+00024c60: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+00024c70: 2020 2072 6574 7572 6e20 4c69 6e65 5365     return LineSe
+00024c80: 676d 656e 7433 4428 7365 6c66 2e73 7461  gment3D(self.sta
+00024c90: 7274 2e63 6f70 7928 292c 2073 656c 662e  rt.copy(), self.
+00024ca0: 656e 642e 636f 7079 2829 290a 0a20 2020  end.copy())..   
+00024cb0: 2064 6566 2070 6c6f 7428 7365 6c66 2c20   def plot(self, 
+00024cc0: 6178 3d4e 6f6e 652c 2063 6f6c 6f72 3d27  ax=None, color='
+00024cd0: 6b27 2c20 616c 7068 613d 312c 0a20 2020  k', alpha=1,.   
+00024ce0: 2020 2020 2020 2020 2020 6564 6765 5f65            edge_e
+00024cf0: 6e64 733d 4661 6c73 652c 2065 6467 655f  nds=False, edge_
+00024d00: 6469 7265 6374 696f 6e3d 4661 6c73 6529  direction=False)
+00024d10: 3a0a 2020 2020 2020 2020 6966 2061 7820  :.        if ax 
+00024d20: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00024d30: 2020 2020 2066 6967 203d 2070 6c74 2e66       fig = plt.f
+00024d40: 6967 7572 6528 290a 2020 2020 2020 2020  igure().        
+00024d50: 2020 2020 6178 203d 2066 6967 2e61 6464      ax = fig.add
+00024d60: 5f73 7562 706c 6f74 2831 3131 2c20 7072  _subplot(111, pr
+00024d70: 6f6a 6563 7469 6f6e 3d27 3364 2729 0a20  ojection='3d'). 
+00024d80: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00024d90: 2020 2020 2020 2020 2066 6967 203d 2061           fig = a
+00024da0: 782e 6669 6775 7265 0a0a 2020 2020 2020  x.figure..      
+00024db0: 2020 706f 696e 7473 203d 205b 7365 6c66    points = [self
+00024dc0: 2e73 7461 7274 2c20 7365 6c66 2e65 6e64  .start, self.end
+00024dd0: 5d0a 2020 2020 2020 2020 7820 3d20 5b70  ].        x = [p
+00024de0: 2e78 2066 6f72 2070 2069 6e20 706f 696e  .x for p in poin
+00024df0: 7473 5d0a 2020 2020 2020 2020 7920 3d20  ts].        y = 
+00024e00: 5b70 2e79 2066 6f72 2070 2069 6e20 706f  [p.y for p in po
+00024e10: 696e 7473 5d0a 2020 2020 2020 2020 7a20  ints].        z 
+00024e20: 3d20 5b70 2e7a 2066 6f72 2070 2069 6e20  = [p.z for p in 
+00024e30: 706f 696e 7473 5d0a 2020 2020 2020 2020  points].        
+00024e40: 6966 2065 6467 655f 656e 6473 3a0a 2020  if edge_ends:.  
+00024e50: 2020 2020 2020 2020 2020 6178 2e70 6c6f            ax.plo
+00024e60: 7428 782c 2079 2c20 7a2c 2063 6f6c 6f72  t(x, y, z, color
+00024e70: 3d63 6f6c 6f72 2c20 616c 7068 613d 616c  =color, alpha=al
+00024e80: 7068 612c 206d 6172 6b65 723d 276f 2729  pha, marker='o')
+00024e90: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00024ea0: 2020 2020 2020 2020 2020 2061 782e 706c             ax.pl
+00024eb0: 6f74 2878 2c20 792c 207a 2c20 636f 6c6f  ot(x, y, z, colo
+00024ec0: 723d 636f 6c6f 722c 2061 6c70 6861 3d61  r=color, alpha=a
+00024ed0: 6c70 6861 290a 2020 2020 2020 2020 6966  lpha).        if
+00024ee0: 2065 6467 655f 6469 7265 6374 696f 6e3a   edge_direction:
+00024ef0: 0a20 2020 2020 2020 2020 2020 2078 2c20  .            x, 
+00024f00: 792c 207a 203d 2073 656c 662e 706f 696e  y, z = self.poin
+00024f10: 745f 6174 5f61 6273 6369 7373 6128 302e  t_at_abscissa(0.
+00024f20: 3520 2a20 7365 6c66 2e6c 656e 6774 6828  5 * self.length(
+00024f30: 2929 0a20 2020 2020 2020 2020 2020 2075  )).            u
+00024f40: 2c20 762c 2077 203d 2030 2e30 3520 2a20  , v, w = 0.05 * 
+00024f50: 7365 6c66 2e64 6972 6563 7469 6f6e 5f76  self.direction_v
+00024f60: 6563 746f 7228 290a 2020 2020 2020 2020  ector().        
+00024f70: 2020 2020 6178 2e71 7569 7665 7228 782c      ax.quiver(x,
+00024f80: 2079 2c20 7a2c 2075 2c20 762c 2077 2c20   y, z, u, v, w, 
+00024f90: 6c65 6e67 7468 3d73 656c 662e 6c65 6e67  length=self.leng
+00024fa0: 7468 2829 202f 2031 3030 2c0a 2020 2020  th() / 100,.    
+00024fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024fc0: 2020 6172 726f 775f 6c65 6e67 7468 5f72    arrow_length_r
+00024fd0: 6174 696f 3d35 2c20 6e6f 726d 616c 697a  atio=5, normaliz
+00024fe0: 653d 5472 7565 2c0a 2020 2020 2020 2020  e=True,.        
+00024ff0: 2020 2020 2020 2020 2020 2020 2020 7069                pi
+00025000: 766f 743d 2774 6970 272c 2063 6f6c 6f72  vot='tip', color
+00025010: 3d63 6f6c 6f72 290a 2020 2020 2020 2020  =color).        
+00025020: 7265 7475 726e 2061 780a 0a20 2020 2064  return ax..    d
+00025030: 6566 2070 6c6f 7432 6428 7365 6c66 2c20  ef plot2d(self, 
+00025040: 785f 3344 2c20 795f 3344 2c20 6178 3d4e  x_3D, y_3D, ax=N
+00025050: 6f6e 652c 2063 6f6c 6f72 3d27 6b27 2c20  one, color='k', 
+00025060: 7769 6474 683d 4e6f 6e65 293a 0a20 2020  width=None):.   
+00025070: 2020 2020 2069 6620 6178 2069 7320 4e6f       if ax is No
+00025080: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00025090: 6669 6720 3d20 706c 742e 6669 6775 7265  fig = plt.figure
+000250a0: 2829 0a20 2020 2020 2020 2020 2020 2061  ().            a
+000250b0: 7820 3d20 6669 672e 6164 645f 7375 6270  x = fig.add_subp
+000250c0: 6c6f 7428 3131 312c 2070 726f 6a65 6374  lot(111, project
+000250d0: 696f 6e3d 2733 6427 290a 2020 2020 2020  ion='3d').      
+000250e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000250f0: 2020 2020 6669 6720 3d20 6178 2e66 6967      fig = ax.fig
+00025100: 7572 650a 0a20 2020 2020 2020 2065 6467  ure..        edg
+00025110: 6532 4420 3d20 7365 6c66 2e70 6c61 6e65  e2D = self.plane
+00025120: 5f70 726f 6a65 6374 696f 6e32 6428 766f  _projection2d(vo
+00025130: 6c6d 646c 722e 4f33 442c 2078 5f33 442c  lmdlr.O3D, x_3D,
+00025140: 2079 5f33 4429 0a20 2020 2020 2020 2065   y_3D).        e
+00025150: 6467 6532 442e 706c 6f74 2861 783d 6178  dge2D.plot(ax=ax
+00025160: 2c20 636f 6c6f 723d 636f 6c6f 722c 2077  , color=color, w
+00025170: 6964 7468 3d77 6964 7468 290a 2020 2020  idth=width).    
+00025180: 2020 2020 7265 7475 726e 2061 780a 0a20      return ax.. 
+00025190: 2020 2064 6566 2070 6c6f 745f 6461 7461     def plot_data
+000251a0: 2873 656c 662c 2078 5f33 442c 2079 5f33  (self, x_3D, y_3
+000251b0: 442c 206d 6172 6b65 723d 4e6f 6e65 2c20  D, marker=None, 
+000251c0: 636f 6c6f 723d 2762 6c61 636b 272c 2073  color='black', s
+000251d0: 7472 6f6b 655f 7769 6474 683d 312c 0a20  troke_width=1,. 
+000251e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000251f0: 2064 6173 683d 4661 6c73 652c 206f 7061   dash=False, opa
+00025200: 6369 7479 3d31 2c20 6172 726f 773d 4661  city=1, arrow=Fa
+00025210: 6c73 6529 3a0a 2020 2020 2020 2020 6564  lse):.        ed
+00025220: 6765 3244 203d 2073 656c 662e 706c 616e  ge2D = self.plan
+00025230: 655f 7072 6f6a 6563 7469 6f6e 3264 2876  e_projection2d(v
+00025240: 6f6c 6d64 6c72 2e4f 3344 2c20 785f 3344  olmdlr.O3D, x_3D
+00025250: 2c20 795f 3344 290a 2020 2020 2020 2020  , y_3D).        
+00025260: 7265 7475 726e 2065 6467 6532 442e 706c  return edge2D.pl
+00025270: 6f74 5f64 6174 6128 6d61 726b 6572 2c20  ot_data(marker, 
+00025280: 636f 6c6f 722c 2073 7472 6f6b 655f 7769  color, stroke_wi
+00025290: 6474 682c 0a20 2020 2020 2020 2020 2020  dth,.           
+000252a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000252b0: 2020 2020 2064 6173 682c 206f 7061 6369       dash, opaci
+000252c0: 7479 2c20 6172 726f 7729 0a0a 2020 2020  ty, arrow)..    
+000252d0: 6465 6620 746f 5f6c 696e 6528 7365 6c66  def to_line(self
+000252e0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000252f0: 6e20 4c69 6e65 3344 2873 656c 662e 7374  n Line3D(self.st
+00025300: 6172 742c 2073 656c 662e 656e 6429 0a0a  art, self.end)..
+00025310: 2020 2020 6465 6620 746f 5f32 6428 7365      def to_2d(se
+00025320: 6c66 2c20 706c 616e 655f 6f72 6967 696e  lf, plane_origin
+00025330: 2c20 782c 2079 293a 0a20 2020 2020 2020  , x, y):.       
+00025340: 2022 2222 0a20 2020 2020 2020 2054 7261   """.        Tra
+00025350: 6e73 666f 726d 7320 6120 4c69 6e65 5365  nsforms a LineSe
+00025360: 676d 656e 7433 4420 696e 746f 2061 6e20  gment3D into an 
+00025370: 4c69 6e65 5365 676d 656e 7432 442c 2067  LineSegment2D, g
+00025380: 6976 656e 2061 6e20 706c 616e 6520 6f72  iven an plane or
+00025390: 6967 696e 2061 6e64 2061 2075 2061 6e64  igin and a u and
+000253a0: 2076 2070 6c61 6e65 2076 6563 746f 722e   v plane vector.
+000253b0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000253c0: 2070 6c61 6e65 5f6f 7269 6769 6e3a 2070   plane_origin: p
+000253d0: 6c61 6e65 206f 7269 6769 6e2e 0a20 2020  lane origin..   
+000253e0: 2020 2020 203a 7061 7261 6d20 783a 2070       :param x: p
+000253f0: 6c61 6e65 2075 2076 6563 746f 722e 0a20  lane u vector.. 
+00025400: 2020 2020 2020 203a 7061 7261 6d20 793a         :param y:
+00025410: 2070 6c61 6e65 2076 2076 6563 746f 722e   plane v vector.
+00025420: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00025430: 3a20 4c69 6e65 5365 676d 656e 7432 442e  : LineSegment2D.
+00025440: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00025450: 2020 2020 2070 3264 203d 205b 702e 746f       p2d = [p.to
+00025460: 5f32 6428 706c 616e 655f 6f72 6967 696e  _2d(plane_origin
+00025470: 2c20 782c 2079 2920 666f 7220 7020 696e  , x, y) for p in
+00025480: 2028 7365 6c66 2e73 7461 7274 2c20 7365   (self.start, se
+00025490: 6c66 2e65 6e64 295d 0a20 2020 2020 2020  lf.end)].       
+000254a0: 2069 6620 7032 645b 305d 203d 3d20 7032   if p2d[0] == p2
+000254b0: 645b 315d 3a0a 2020 2020 2020 2020 2020  d[1]:.          
+000254c0: 2020 7265 7475 726e 204e 6f6e 650a 2020    return None.  
+000254d0: 2020 2020 2020 7265 7475 726e 204c 696e        return Lin
+000254e0: 6553 6567 6d65 6e74 3244 282a 7032 642c  eSegment2D(*p2d,
+000254f0: 206e 616d 653d 7365 6c66 2e6e 616d 6529   name=self.name)
+00025500: 0a0a 2020 2020 6465 6620 746f 5f62 7370  ..    def to_bsp
+00025510: 6c69 6e65 5f63 7572 7665 2873 656c 662c  line_curve(self,
+00025520: 2072 6573 6f6c 7574 696f 6e3d 3130 293a   resolution=10):
+00025530: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00025540: 2020 2020 2043 6f6e 7665 7274 2061 204c       Convert a L
+00025550: 696e 6553 6567 6d65 6e74 3344 2074 6f20  ineSegment3D to 
+00025560: 6120 4253 706c 696e 6543 7572 7665 3344  a BSplineCurve3D
+00025570: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00025580: 2020 2020 2020 6465 6772 6565 203d 2031        degree = 1
+00025590: 0a20 2020 2020 2020 2070 6f69 6e74 7320  .        points 
+000255a0: 3d20 5b73 656c 662e 706f 696e 745f 6174  = [self.point_at
+000255b0: 5f61 6273 6369 7373 6128 6162 7363 6973  _abscissa(abscis
+000255c0: 7361 202f 2073 656c 662e 6c65 6e67 7468  sa / self.length
+000255d0: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
+000255e0: 2020 2020 2020 666f 7220 6162 7363 6973        for abscis
+000255f0: 7361 2069 6e20 7261 6e67 6528 7265 736f  sa in range(reso
+00025600: 6c75 7469 6f6e 202b 2031 295d 0a20 2020  lution + 1)].   
+00025610: 2020 2020 2062 7370 6c69 6e65 5f63 7572       bspline_cur
+00025620: 7665 203d 2042 5370 6c69 6e65 4375 7276  ve = BSplineCurv
+00025630: 6533 442e 6672 6f6d 5f70 6f69 6e74 735f  e3D.from_points_
+00025640: 696e 7465 7270 6f6c 6174 696f 6e28 706f  interpolation(po
+00025650: 696e 7473 2c0a 2020 2020 2020 2020 2020  ints,.          
+00025660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025690: 2020 2020 2020 2064 6567 7265 6529 0a20         degree). 
+000256a0: 2020 2020 2020 2072 6574 7572 6e20 6273         return bs
+000256b0: 706c 696e 655f 6375 7276 650a 0a20 2020  pline_curve..   
+000256c0: 2064 6566 2072 6576 6572 7365 2873 656c   def reverse(sel
+000256d0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+000256e0: 726e 204c 696e 6553 6567 6d65 6e74 3344  rn LineSegment3D
+000256f0: 2873 656c 662e 656e 642e 636f 7079 2829  (self.end.copy()
+00025700: 2c20 7365 6c66 2e73 7461 7274 2e63 6f70  , self.start.cop
+00025710: 7928 2929 0a0a 2020 2020 6465 6620 6d69  y())..    def mi
+00025720: 6e69 6d75 6d5f 6469 7374 616e 6365 5f70  nimum_distance_p
+00025730: 6f69 6e74 7328 7365 6c66 2c20 6f74 6865  oints(self, othe
+00025740: 725f 6c69 6e65 293a 0a20 2020 2020 2020  r_line):.       
+00025750: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+00025760: 7572 6e73 2074 6865 2070 6f69 6e74 7320  urns the points 
+00025770: 6f6e 2074 6869 7320 6c69 6e65 2061 6e64  on this line and
+00025780: 2074 6865 206f 7468 6572 206c 696e 6520   the other line 
+00025790: 7468 6174 2061 7265 2074 6865 2063 6c6f  that are the clo
+000257a0: 7365 7374 206f 6620 6c69 6e65 732e 0a20  sest of lines.. 
+000257b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000257c0: 2020 2075 203d 2073 656c 662e 656e 6420     u = self.end 
+000257d0: 2d20 7365 6c66 2e73 7461 7274 0a20 2020  - self.start.   
+000257e0: 2020 2020 2076 203d 206f 7468 6572 5f6c       v = other_l
+000257f0: 696e 652e 656e 6420 2d20 6f74 6865 725f  ine.end - other_
+00025800: 6c69 6e65 2e73 7461 7274 0a20 2020 2020  line.start.     
+00025810: 2020 2077 203d 2073 656c 662e 7374 6172     w = self.star
+00025820: 7420 2d20 6f74 6865 725f 6c69 6e65 2e73  t - other_line.s
+00025830: 7461 7274 0a20 2020 2020 2020 2061 203d  tart.        a =
+00025840: 2075 2e64 6f74 2875 290a 2020 2020 2020   u.dot(u).      
+00025850: 2020 6220 3d20 752e 646f 7428 7629 0a20    b = u.dot(v). 
+00025860: 2020 2020 2020 2063 203d 2076 2e64 6f74         c = v.dot
+00025870: 2876 290a 2020 2020 2020 2020 6420 3d20  (v).        d = 
+00025880: 752e 646f 7428 7729 0a20 2020 2020 2020  u.dot(w).       
+00025890: 2065 203d 2076 2e64 6f74 2877 290a 2020   e = v.dot(w).  
+000258a0: 2020 2020 2020 6966 2028 6120 2a20 6320        if (a * c 
+000258b0: 2d20 6220 2a2a 2032 2920 213d 2030 3a0a  - b ** 2) != 0:.
+000258c0: 2020 2020 2020 2020 2020 2020 7320 3d20              s = 
+000258d0: 2862 202a 2065 202d 2063 202a 2064 2920  (b * e - c * d) 
+000258e0: 2f20 2861 202a 2063 202d 2062 202a 2a20  / (a * c - b ** 
+000258f0: 3229 0a20 2020 2020 2020 2020 2020 2074  2).            t
+00025900: 203d 2028 6120 2a20 6520 2d20 6220 2a20   = (a * e - b * 
+00025910: 6429 202f 2028 6120 2a20 6320 2d20 6220  d) / (a * c - b 
+00025920: 2a2a 2032 290a 2020 2020 2020 2020 2020  ** 2).          
+00025930: 2020 7031 203d 2073 656c 662e 7374 6172    p1 = self.star
+00025940: 7420 2b20 7320 2a20 750a 2020 2020 2020  t + s * u.      
+00025950: 2020 2020 2020 7032 203d 206f 7468 6572        p2 = other
+00025960: 5f6c 696e 652e 7374 6172 7420 2b20 7420  _line.start + t 
+00025970: 2a20 760a 2020 2020 2020 2020 2020 2020  * v.            
+00025980: 7265 7475 726e 2070 312c 2070 320a 2020  return p1, p2.  
+00025990: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000259a0: 662e 7374 6172 742c 206f 7468 6572 5f6c  f.start, other_l
+000259b0: 696e 652e 7374 6172 740a 0a20 2020 2064  ine.start..    d
+000259c0: 6566 206d 6174 7269 785f 6469 7374 616e  ef matrix_distan
+000259d0: 6365 2873 656c 662c 206f 7468 6572 5f6c  ce(self, other_l
+000259e0: 696e 6529 3a0a 2020 2020 2020 2020 7520  ine):.        u 
+000259f0: 3d20 7365 6c66 2e64 6972 6563 7469 6f6e  = self.direction
+00025a00: 5f76 6563 746f 7228 290a 2020 2020 2020  _vector().      
+00025a10: 2020 7620 3d20 6f74 6865 725f 6c69 6e65    v = other_line
+00025a20: 2e64 6972 6563 7469 6f6e 5f76 6563 746f  .direction_vecto
+00025a30: 7228 290a 2020 2020 2020 2020 7720 3d20  r().        w = 
+00025a40: 6f74 6865 725f 6c69 6e65 2e73 7461 7274  other_line.start
+00025a50: 202d 2073 656c 662e 7374 6172 740a 0a20   - self.start.. 
+00025a60: 2020 2020 2020 2061 3131 203d 2075 2e64         a11 = u.d
+00025a70: 6f74 2875 290a 2020 2020 2020 2020 6131  ot(u).        a1
+00025a80: 3220 3d20 2d75 2e64 6f74 2876 290a 2020  2 = -u.dot(v).  
+00025a90: 2020 2020 2020 6132 3220 3d20 762e 646f        a22 = v.do
+00025aa0: 7428 7629 0a0a 2020 2020 2020 2020 4120  t(v)..        A 
+00025ab0: 3d20 6e70 792e 6172 7261 7928 5b5b 6131  = npy.array([[a1
+00025ac0: 312c 2061 3132 5d2c 0a20 2020 2020 2020  1, a12],.       
+00025ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025ae0: 5b61 3132 2c20 6132 325d 5d29 0a20 2020  [a12, a22]]).   
+00025af0: 2020 2020 2042 203d 206e 7079 2e61 7272       B = npy.arr
+00025b00: 6179 285b 772e 646f 7428 7529 2c20 2d77  ay([w.dot(u), -w
+00025b10: 2e64 6f74 2876 295d 290a 0a20 2020 2020  .dot(v)])..     
+00025b20: 2020 2072 6573 203d 2073 6370 2e6f 7074     res = scp.opt
+00025b30: 696d 697a 652e 6c73 715f 6c69 6e65 6172  imize.lsq_linear
+00025b40: 2841 2c20 422c 2062 6f75 6e64 733d 2830  (A, B, bounds=(0
+00025b50: 2c20 3129 290a 2020 2020 2020 2020 7031  , 1)).        p1
+00025b60: 203d 2073 656c 662e 706f 696e 745f 6174   = self.point_at
+00025b70: 5f61 6273 6369 7373 6128 7265 732e 785b  _abscissa(res.x[
+00025b80: 305d 202a 2073 656c 662e 6c65 6e67 7468  0] * self.length
+00025b90: 2829 290a 2020 2020 2020 2020 7032 203d  ()).        p2 =
+00025ba0: 206f 7468 6572 5f6c 696e 652e 706f 696e   other_line.poin
+00025bb0: 745f 6174 5f61 6273 6369 7373 6128 0a20  t_at_abscissa(. 
+00025bc0: 2020 2020 2020 2020 2020 2072 6573 2e78             res.x
+00025bd0: 5b31 5d20 2a20 6f74 6865 725f 6c69 6e65  [1] * other_line
+00025be0: 2e6c 656e 6774 6828 2929 0a20 2020 2020  .length()).     
+00025bf0: 2020 2072 6574 7572 6e20 7031 2c20 7032     return p1, p2
+00025c00: 0a0a 2020 2020 6465 6620 7061 7261 6c6c  ..    def parall
+00025c10: 656c 5f64 6973 7461 6e63 6528 7365 6c66  el_distance(self
+00025c20: 2c20 6f74 6865 725f 6c69 6e65 7365 676d  , other_linesegm
+00025c30: 656e 7429 3a0a 2020 2020 2020 2020 7074  ent):.        pt
+00025c40: 5f61 2c20 7074 5f62 2c20 7074 5f63 203d  _a, pt_b, pt_c =
+00025c50: 2073 656c 662e 7374 6172 742c 2073 656c   self.start, sel
+00025c60: 662e 656e 642c 206f 7468 6572 5f6c 696e  f.end, other_lin
+00025c70: 6573 6567 6d65 6e74 2e73 7461 7274 0a20  esegment.start. 
+00025c80: 2020 2020 2020 2076 6563 746f 7220 3d20         vector = 
+00025c90: 766f 6c6d 646c 722e 5665 6374 6f72 3344  volmdlr.Vector3D
+00025ca0: 2828 7074 5f61 202d 2070 745f 6229 2e76  ((pt_a - pt_b).v
+00025cb0: 6563 746f 7229 0a20 2020 2020 2020 2076  ector).        v
+00025cc0: 6563 746f 722e 6e6f 726d 616c 697a 6528  ector.normalize(
+00025cd0: 290a 2020 2020 2020 2020 706c 616e 6531  ).        plane1
+00025ce0: 203d 2076 6f6c 6d64 6c72 2e66 6163 6573   = volmdlr.faces
+00025cf0: 2e50 6c61 6e65 3344 2e66 726f 6d5f 335f  .Plane3D.from_3_
+00025d00: 706f 696e 7473 2870 745f 612c 2070 745f  points(pt_a, pt_
+00025d10: 622c 2070 745f 6329 0a20 2020 2020 2020  b, pt_c).       
+00025d20: 2076 203d 2076 6563 746f 722e 6372 6f73   v = vector.cros
+00025d30: 7328 706c 616e 6531 2e66 7261 6d65 2e77  s(plane1.frame.w
+00025d40: 2920 2023 2064 6973 7461 6e63 6520 7665  )  # distance ve
+00025d50: 6374 6f72 0a20 2020 2020 2020 2023 2070  ctor.        # p
+00025d60: 745f 6120 3d20 6b2a 7520 2b20 632a 7620  t_a = k*u + c*v 
+00025d70: 2b20 7074 5f63 0a20 2020 2020 2020 2072  + pt_c.        r
+00025d80: 6573 203d 2028 7074 5f61 202d 2070 745f  es = (pt_a - pt_
+00025d90: 6329 2e76 6563 746f 720a 2020 2020 2020  c).vector.      
+00025da0: 2020 782c 2079 2c20 7a20 3d20 7265 735b    x, y, z = res[
+00025db0: 305d 2c20 7265 735b 315d 2c20 7265 735b  0], res[1], res[
+00025dc0: 325d 0a20 2020 2020 2020 2075 312c 2075  2].        u1, u
+00025dd0: 322c 2075 3320 3d20 7665 6374 6f72 2e78  2, u3 = vector.x
+00025de0: 2c20 7665 6374 6f72 2e79 2c20 7665 6374  , vector.y, vect
+00025df0: 6f72 2e7a 0a20 2020 2020 2020 2076 312c  or.z.        v1,
+00025e00: 2076 322c 2076 3320 3d20 762e 782c 2076   v2, v3 = v.x, v
+00025e10: 2e79 2c20 762e 7a0a 0a20 2020 2020 2020  .y, v.z..       
+00025e20: 2069 6620 2875 3120 2a20 7632 202d 2076   if (u1 * v2 - v
+00025e30: 3120 2a20 7532 2920 213d 2030 2061 6e64  1 * u2) != 0 and
+00025e40: 2075 3120 213d 2030 3a0a 2020 2020 2020   u1 != 0:.      
+00025e50: 2020 2020 2020 6320 3d20 2879 202a 2075        c = (y * u
+00025e60: 3120 2d20 7820 2a20 7532 2920 2f20 2875  1 - x * u2) / (u
+00025e70: 3120 2a20 7632 202d 2076 3120 2a20 7532  1 * v2 - v1 * u2
+00025e80: 290a 2020 2020 2020 2020 2020 2020 6b20  ).            k 
+00025e90: 3d20 2878 202d 2063 202a 2076 3129 202f  = (x - c * v1) /
+00025ea0: 2075 310a 2020 2020 2020 2020 2020 2020   u1.            
+00025eb0: 6966 206d 6174 682e 6973 636c 6f73 6528  if math.isclose(
+00025ec0: 6b20 2a20 7533 202b 2063 202a 2076 332c  k * u3 + c * v3,
+00025ed0: 207a 2c20 6162 735f 746f 6c3d 3165 2d37   z, abs_tol=1e-7
+00025ee0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00025ef0: 2020 2072 6574 7572 6e20 6b0a 2020 2020     return k.    
+00025f00: 2020 2020 656c 6966 2028 7531 202a 2076      elif (u1 * v
+00025f10: 3320 2d20 7631 202a 2075 3329 2021 3d20  3 - v1 * u3) != 
+00025f20: 3020 616e 6420 7531 2021 3d20 303a 0a20  0 and u1 != 0:. 
+00025f30: 2020 2020 2020 2020 2020 2063 203d 2028             c = (
+00025f40: 7a20 2a20 7531 202d 2078 202a 2075 3329  z * u1 - x * u3)
+00025f50: 202f 2028 7531 202a 2076 3320 2d20 7631   / (u1 * v3 - v1
+00025f60: 202a 2075 3329 0a20 2020 2020 2020 2020   * u3).         
+00025f70: 2020 206b 203d 2028 7820 2d20 6320 2a20     k = (x - c * 
+00025f80: 7631 2920 2f20 7531 0a20 2020 2020 2020  v1) / u1.       
+00025f90: 2020 2020 2069 6620 6d61 7468 2e69 7363       if math.isc
+00025fa0: 6c6f 7365 286b 202a 2075 3220 2b20 6320  lose(k * u2 + c 
+00025fb0: 2a20 7632 2c20 792c 2061 6273 5f74 6f6c  * v2, y, abs_tol
+00025fc0: 3d31 652d 3729 3a0a 2020 2020 2020 2020  =1e-7):.        
+00025fd0: 2020 2020 2020 2020 7265 7475 726e 206b          return k
+00025fe0: 0a20 2020 2020 2020 2065 6c69 6620 2876  .        elif (v
+00025ff0: 3120 2a20 7532 202d 2076 3220 2a20 7531  1 * u2 - v2 * u1
+00026000: 2920 213d 2030 2061 6e64 2075 3220 213d  ) != 0 and u2 !=
+00026010: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00026020: 6320 3d20 2875 3220 2a20 7820 2d20 7920  c = (u2 * x - y 
+00026030: 2a20 7531 2920 2f20 2876 3120 2a20 7532  * u1) / (v1 * u2
+00026040: 202d 2076 3220 2a20 7531 290a 2020 2020   - v2 * u1).    
+00026050: 2020 2020 2020 2020 6b20 3d20 2879 202d          k = (y -
+00026060: 2063 202a 2076 3229 202f 2075 320a 2020   c * v2) / u2.  
+00026070: 2020 2020 2020 2020 2020 6966 206d 6174            if mat
+00026080: 682e 6973 636c 6f73 6528 6b20 2a20 7533  h.isclose(k * u3
+00026090: 202b 2063 202a 2076 332c 207a 2c20 6162   + c * v3, z, ab
+000260a0: 735f 746f 6c3d 3165 2d37 293a 0a20 2020  s_tol=1e-7):.   
+000260b0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+000260c0: 7572 6e20 6b0a 2020 2020 2020 2020 656c  urn k.        el
+000260d0: 6966 2028 7633 202a 2075 3220 2d20 7632  if (v3 * u2 - v2
+000260e0: 202a 2075 3329 2021 3d20 3020 616e 6420   * u3) != 0 and 
+000260f0: 7532 2021 3d20 303a 0a20 2020 2020 2020  u2 != 0:.       
+00026100: 2020 2020 2063 203d 2028 7532 202a 207a       c = (u2 * z
+00026110: 202d 2079 202a 2075 3329 202f 2028 7633   - y * u3) / (v3
+00026120: 202a 2075 3220 2d20 7632 202a 2075 3329   * u2 - v2 * u3)
+00026130: 0a20 2020 2020 2020 2020 2020 206b 203d  .            k =
+00026140: 2028 7920 2d20 6320 2a20 7632 2920 2f20   (y - c * v2) / 
+00026150: 7532 0a20 2020 2020 2020 2020 2020 2069  u2.            i
+00026160: 6620 6d61 7468 2e69 7363 6c6f 7365 286b  f math.isclose(k
+00026170: 202a 2075 3120 2b20 6320 2a20 7631 2c20   * u1 + c * v1, 
+00026180: 782c 2061 6273 5f74 6f6c 3d31 652d 3729  x, abs_tol=1e-7)
+00026190: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000261a0: 2020 7265 7475 726e 206b 0a20 2020 2020    return k.     
+000261b0: 2020 2065 6c69 6620 2875 3120 2a20 7633     elif (u1 * v3
+000261c0: 202d 2076 3120 2a20 7533 2920 213d 2030   - v1 * u3) != 0
+000261d0: 2061 6e64 2075 3320 213d 2030 3a0a 2020   and u3 != 0:.  
+000261e0: 2020 2020 2020 2020 2020 6320 3d20 287a            c = (z
+000261f0: 202a 2075 3120 2d20 7820 2a20 7533 2920   * u1 - x * u3) 
+00026200: 2f20 2875 3120 2a20 7633 202d 2076 3120  / (u1 * v3 - v1 
+00026210: 2a20 7533 290a 2020 2020 2020 2020 2020  * u3).          
+00026220: 2020 6b20 3d20 287a 202d 2063 202a 2076    k = (z - c * v
+00026230: 3329 202f 2075 330a 2020 2020 2020 2020  3) / u3.        
+00026240: 2020 2020 6966 206d 6174 682e 6973 636c      if math.iscl
+00026250: 6f73 6528 6b20 2a20 7532 202b 2063 202a  ose(k * u2 + c *
+00026260: 2076 322c 2079 2c20 6162 735f 746f 6c3d   v2, y, abs_tol=
+00026270: 3165 2d37 293a 0a20 2020 2020 2020 2020  1e-7):.         
+00026280: 2020 2020 2020 2072 6574 7572 6e20 6b0a         return k.
+00026290: 2020 2020 2020 2020 656c 6966 2028 7532          elif (u2
+000262a0: 202a 2076 3320 2d20 7632 202a 2075 3329   * v3 - v2 * u3)
+000262b0: 2021 3d20 3020 616e 6420 7533 2021 3d20   != 0 and u3 != 
+000262c0: 303a 0a20 2020 2020 2020 2020 2020 2063  0:.            c
+000262d0: 203d 2028 7a20 2a20 7532 202d 2079 202a   = (z * u2 - y *
+000262e0: 2075 3329 202f 2028 7532 202a 2076 3320   u3) / (u2 * v3 
+000262f0: 2d20 7632 202a 2075 3329 0a20 2020 2020  - v2 * u3).     
+00026300: 2020 2020 2020 206b 203d 2028 7a20 2d20         k = (z - 
+00026310: 6320 2a20 7633 2920 2f20 7533 0a20 2020  c * v3) / u3.   
+00026320: 2020 2020 2020 2020 2069 6620 6d61 7468           if math
+00026330: 2e69 7363 6c6f 7365 286b 202a 2075 3120  .isclose(k * u1 
+00026340: 2b20 6320 2a20 7631 2c20 782c 2061 6273  + c * v1, x, abs
+00026350: 5f74 6f6c 3d31 652d 3729 3a0a 2020 2020  _tol=1e-7):.    
+00026360: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00026370: 726e 206b 0a20 2020 2020 2020 2072 6169  rn k.        rai
+00026380: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00026390: 6445 7272 6f72 0a0a 2020 2020 6465 6620  dError..    def 
+000263a0: 6d69 6e69 6d75 6d5f 6469 7374 616e 6365  minimum_distance
+000263b0: 2873 656c 662c 2065 6c65 6d65 6e74 2c20  (self, element, 
+000263c0: 7265 7475 726e 5f70 6f69 6e74 733d 4661  return_points=Fa
+000263d0: 6c73 6529 3a0a 2020 2020 2020 2020 6966  lse):.        if
+000263e0: 2065 6c65 6d65 6e74 2e5f 5f63 6c61 7373   element.__class
+000263f0: 5f5f 2069 7320 4172 6333 4420 6f72 2065  __ is Arc3D or e
+00026400: 6c65 6d65 6e74 2e5f 5f63 6c61 7373 5f5f  lement.__class__
+00026410: 2069 7320 766f 6c6d 646c 722e 7769 7265   is volmdlr.wire
+00026420: 732e 4369 7263 6c65 3344 3a0a 2020 2020  s.Circle3D:.    
+00026430: 2020 2020 2020 2020 7074 312c 2070 7432          pt1, pt2
+00026440: 203d 2065 6c65 6d65 6e74 2e6d 696e 696d   = element.minim
+00026450: 756d 5f64 6973 7461 6e63 655f 706f 696e  um_distance_poin
+00026460: 7473 5f6c 696e 6528 7365 6c66 290a 2020  ts_line(self).  
+00026470: 2020 2020 2020 2020 2020 6966 2072 6574            if ret
+00026480: 7572 6e5f 706f 696e 7473 3a0a 2020 2020  urn_points:.    
+00026490: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000264a0: 726e 2070 7431 2e70 6f69 6e74 5f64 6973  rn pt1.point_dis
+000264b0: 7461 6e63 6528 7074 3229 2c20 7074 312c  tance(pt2), pt1,
+000264c0: 2070 7432 0a20 2020 2020 2020 2020 2020   pt2.           
+000264d0: 2072 6574 7572 6e20 7074 312e 706f 696e   return pt1.poin
+000264e0: 745f 6469 7374 616e 6365 2870 7432 290a  t_distance(pt2).
+000264f0: 0a20 2020 2020 2020 2069 6620 656c 656d  .        if elem
+00026500: 656e 742e 5f5f 636c 6173 735f 5f20 6973  ent.__class__ is
+00026510: 204c 696e 6553 6567 6d65 6e74 3344 3a0a   LineSegment3D:.
+00026520: 2020 2020 2020 2020 2020 2020 7031 2c20              p1, 
+00026530: 7032 203d 2073 656c 662e 6d61 7472 6978  p2 = self.matrix
+00026540: 5f64 6973 7461 6e63 6528 656c 656d 656e  _distance(elemen
+00026550: 7429 0a20 2020 2020 2020 2020 2020 2069  t).            i
+00026560: 6620 7265 7475 726e 5f70 6f69 6e74 733a  f return_points:
+00026570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026580: 2072 6574 7572 6e20 7031 2e70 6f69 6e74   return p1.point
+00026590: 5f64 6973 7461 6e63 6528 7032 292c 2070  _distance(p2), p
+000265a0: 312c 2070 320a 2020 2020 2020 2020 2020  1, p2.          
+000265b0: 2020 7265 7475 726e 2070 312e 706f 696e    return p1.poin
+000265c0: 745f 6469 7374 616e 6365 2870 3229 0a0a  t_distance(p2)..
+000265d0: 2020 2020 2020 2020 6966 2065 6c65 6d65          if eleme
+000265e0: 6e74 2e5f 5f63 6c61 7373 5f5f 2069 7320  nt.__class__ is 
+000265f0: 4253 706c 696e 6543 7572 7665 3344 3a0a  BSplineCurve3D:.
+00026600: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+00026610: 7473 203d 2065 6c65 6d65 6e74 2e70 6f69  ts = element.poi
 00026620: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
-00026630: 2020 2020 7265 7475 726e 2064 6973 745f      return dist_
-00026640: 6d69 6e2c 2070 312c 2070 320a 2020 2020  min, p1, p2.    
-00026650: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-00026660: 6973 745f 6d69 6e0a 0a20 2020 2020 2020  ist_min..       
-00026670: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-00026680: 656e 7465 6445 7272 6f72 0a0a 2020 2020  entedError..    
-00026690: 6465 6620 6578 7472 7573 696f 6e28 7365  def extrusion(se
-000266a0: 6c66 2c20 6578 7472 7573 696f 6e5f 7665  lf, extrusion_ve
-000266b0: 6374 6f72 293a 0a20 2020 2020 2020 2075  ctor):.        u
-000266c0: 203d 2073 656c 662e 756e 6974 5f64 6972   = self.unit_dir
-000266d0: 6563 7469 6f6e 5f76 6563 746f 7228 290a  ection_vector().
-000266e0: 2020 2020 2020 2020 7620 3d20 6578 7472          v = extr
-000266f0: 7573 696f 6e5f 7665 6374 6f72 2e63 6f70  usion_vector.cop
-00026700: 7928 290a 2020 2020 2020 2020 762e 6e6f  y().        v.no
-00026710: 726d 616c 697a 6528 290a 2020 2020 2020  rmalize().      
-00026720: 2020 7720 3d20 752e 6372 6f73 7328 7629    w = u.cross(v)
-00026730: 0a20 2020 2020 2020 206c 3120 3d20 7365  .        l1 = se
-00026740: 6c66 2e6c 656e 6774 6828 290a 2020 2020  lf.length().    
-00026750: 2020 2020 6c32 203d 2065 7874 7275 7369      l2 = extrusi
-00026760: 6f6e 5f76 6563 746f 722e 6e6f 726d 2829  on_vector.norm()
-00026770: 0a20 2020 2020 2020 2023 206f 7574 6572  .        # outer
-00026780: 5f63 6f6e 746f 7572 203d 2050 6f6c 7967  _contour = Polyg
-00026790: 6f6e 3244 285b 4f32 442c 2050 6f69 6e74  on2D([O2D, Point
-000267a0: 3244 2828 6c31 2c20 302e 2929 2c0a 2020  2D((l1, 0.)),.  
-000267b0: 2020 2020 2020 2320 2020 2020 2020 2020        #         
-000267c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000267d0: 2020 2050 6f69 6e74 3244 2828 6c31 2c20     Point2D((l1, 
-000267e0: 6c32 2929 2c20 506f 696e 7432 4428 2830  l2)), Point2D((0
-000267f0: 2e2c 206c 3229 295d 290a 2020 2020 2020  ., l2))]).      
-00026800: 2020 706c 616e 6520 3d20 766f 6c6d 646c    plane = volmdl
-00026810: 722e 6661 6365 732e 506c 616e 6533 4428  r.faces.Plane3D(
-00026820: 766f 6c6d 646c 722e 4672 616d 6533 4428  volmdlr.Frame3D(
-00026830: 7365 6c66 2e73 7461 7274 2c20 752c 2076  self.start, u, v
-00026840: 2c20 7729 290a 2020 2020 2020 2020 7265  , w)).        re
-00026850: 7475 726e 205b 706c 616e 652e 7265 6374  turn [plane.rect
-00026860: 616e 6775 6c61 725f 6375 7428 302c 206c  angular_cut(0, l
-00026870: 312c 2030 2c20 6c32 295d 0a0a 2020 2020  1, 0, l2)]..    
-00026880: 6465 6620 7265 766f 6c75 7469 6f6e 2873  def revolution(s
-00026890: 656c 662c 2061 7869 735f 706f 696e 742c  elf, axis_point,
-000268a0: 2061 7869 732c 2061 6e67 6c65 293a 0a20   axis, angle):. 
-000268b0: 2020 2020 2020 2061 7869 735f 6c69 6e65         axis_line
-000268c0: 3364 203d 204c 696e 6533 4428 6178 6973  3d = Line3D(axis
-000268d0: 5f70 6f69 6e74 2c20 6178 6973 5f70 6f69  _point, axis_poi
-000268e0: 6e74 202b 2061 7869 7329 0a20 2020 2020  nt + axis).     
-000268f0: 2020 2069 6620 6178 6973 5f6c 696e 6533     if axis_line3
-00026900: 642e 706f 696e 745f 6265 6c6f 6e67 7328  d.point_belongs(
-00026910: 7365 6c66 2e73 7461 7274 2920 616e 6420  self.start) and 
-00026920: 6178 6973 5f6c 696e 6533 642e 706f 696e  axis_line3d.poin
-00026930: 745f 6265 6c6f 6e67 7328 0a20 2020 2020  t_belongs(.     
-00026940: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00026950: 656e 6429 3a0a 2020 2020 2020 2020 2020  end):.          
-00026960: 2020 7265 7475 726e 205b 5d0a 0a20 2020    return []..   
-00026970: 2020 2020 2070 315f 7072 6f6a 2c20 5f20       p1_proj, _ 
-00026980: 3d20 6178 6973 5f6c 696e 6533 642e 706f  = axis_line3d.po
-00026990: 696e 745f 7072 6f6a 6563 7469 6f6e 2873  int_projection(s
-000269a0: 656c 662e 7374 6172 7429 0a20 2020 2020  elf.start).     
-000269b0: 2020 2070 325f 7072 6f6a 2c20 5f20 3d20     p2_proj, _ = 
-000269c0: 6178 6973 5f6c 696e 6533 642e 706f 696e  axis_line3d.poin
-000269d0: 745f 7072 6f6a 6563 7469 6f6e 2873 656c  t_projection(sel
-000269e0: 662e 656e 6429 0a20 2020 2020 2020 2064  f.end).        d
-000269f0: 3120 3d20 7365 6c66 2e73 7461 7274 2e70  1 = self.start.p
-00026a00: 6f69 6e74 5f64 6973 7461 6e63 6528 7031  oint_distance(p1
-00026a10: 5f70 726f 6a29 0a20 2020 2020 2020 2064  _proj).        d
-00026a20: 3220 3d20 7365 6c66 2e65 6e64 2e70 6f69  2 = self.end.poi
-00026a30: 6e74 5f64 6973 7461 6e63 6528 7032 5f70  nt_distance(p2_p
-00026a40: 726f 6a29 0a20 2020 2020 2020 2069 6620  roj).        if 
-00026a50: 6e6f 7420 6d61 7468 2e69 7363 6c6f 7365  not math.isclose
-00026a60: 2864 312c 2030 2e2c 2061 6273 5f74 6f6c  (d1, 0., abs_tol
-00026a70: 3d31 652d 3929 3a0a 2020 2020 2020 2020  =1e-9):.        
-00026a80: 2020 2020 7520 3d20 7365 6c66 2e73 7461      u = self.sta
-00026a90: 7274 202d 2070 315f 7072 6f6a 2020 2320  rt - p1_proj  # 
-00026aa0: 556e 6974 2076 6563 746f 7220 6672 6f6d  Unit vector from
-00026ab0: 2070 315f 7072 6f6a 2074 6f20 7031 0a20   p1_proj to p1. 
-00026ac0: 2020 2020 2020 2020 2020 2075 2e6e 6f72             u.nor
-00026ad0: 6d61 6c69 7a65 2829 0a20 2020 2020 2020  malize().       
-00026ae0: 2065 6c69 6620 6e6f 7420 6d61 7468 2e69   elif not math.i
-00026af0: 7363 6c6f 7365 2864 322c 2030 2e2c 2061  sclose(d2, 0., a
-00026b00: 6273 5f74 6f6c 3d31 652d 3929 3a0a 2020  bs_tol=1e-9):.  
-00026b10: 2020 2020 2020 2020 2020 7520 3d20 7365            u = se
-00026b20: 6c66 2e65 6e64 202d 2070 325f 7072 6f6a  lf.end - p2_proj
-00026b30: 2020 2320 556e 6974 2076 6563 746f 7220    # Unit vector 
-00026b40: 6672 6f6d 2070 315f 7072 6f6a 2074 6f20  from p1_proj to 
-00026b50: 7031 0a20 2020 2020 2020 2020 2020 2075  p1.            u
-00026b60: 2e6e 6f72 6d61 6c69 7a65 2829 0a20 2020  .normalize().   
-00026b70: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00026b80: 2020 2020 2020 2072 6574 7572 6e20 5b5d         return []
-00026b90: 0a20 2020 2020 2020 2069 6620 752e 6973  .        if u.is
-00026ba0: 5f63 6f6c 696e 6561 725f 746f 2873 656c  _colinear_to(sel
-00026bb0: 662e 6469 7265 6374 696f 6e5f 7665 6374  f.direction_vect
-00026bc0: 6f72 2829 293a 0a20 2020 2020 2020 2020  or()):.         
-00026bd0: 2020 2023 2050 6c61 6e61 7220 6661 6365     # Planar face
-00026be0: 0a20 2020 2020 2020 2020 2020 2076 203d  .            v =
-00026bf0: 2061 7869 732e 6372 6f73 7328 7529 0a20   axis.cross(u). 
-00026c00: 2020 2020 2020 2020 2020 2073 7572 6661             surfa
-00026c10: 6365 203d 2076 6f6c 6d64 6c72 2e66 6163  ce = volmdlr.fac
-00026c20: 6573 2e50 6c61 6e65 3344 280a 2020 2020  es.Plane3D(.    
-00026c30: 2020 2020 2020 2020 2020 2020 766f 6c6d              volm
-00026c40: 646c 722e 4672 616d 6533 4428 7031 5f70  dlr.Frame3D(p1_p
-00026c50: 726f 6a2c 2075 2c20 762c 2061 7869 7329  roj, u, v, axis)
-00026c60: 290a 2020 2020 2020 2020 2020 2020 722c  ).            r,
-00026c70: 2052 203d 2073 6f72 7465 6428 5b64 312c   R = sorted([d1,
-00026c80: 2064 325d 290a 2020 2020 2020 2020 2020   d2]).          
-00026c90: 2020 6966 2061 6e67 6c65 203d 3d20 766f    if angle == vo
-00026ca0: 6c6d 646c 722e 5457 4f5f 5049 3a0a 2020  lmdlr.TWO_PI:.  
-00026cb0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00026cc0: 4f6e 6c79 2032 2063 6972 636c 6573 2061  Only 2 circles a
-00026cd0: 7320 636f 6e74 6f75 7273 0a20 2020 2020  s contours.     
-00026ce0: 2020 2020 2020 2020 2020 206f 7574 6572             outer
-00026cf0: 5f63 6f6e 746f 7572 3264 203d 2076 6f6c  _contour2d = vol
-00026d00: 6d64 6c72 2e77 6972 6573 2e43 6972 636c  mdlr.wires.Circl
-00026d10: 6532 4428 766f 6c6d 646c 722e 4f32 442c  e2D(volmdlr.O2D,
-00026d20: 2052 290a 2020 2020 2020 2020 2020 2020   R).            
-00026d30: 2020 2020 6966 206e 6f74 206d 6174 682e      if not math.
-00026d40: 6973 636c 6f73 6528 722c 2030 2c20 6162  isclose(r, 0, ab
-00026d50: 735f 746f 6c3d 3165 2d39 293a 0a20 2020  s_tol=1e-9):.   
-00026d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026d70: 2069 6e6e 6572 5f63 6f6e 746f 7572 7332   inner_contours2
-00026d80: 6420 3d20 5b76 6f6c 6d64 6c72 2e77 6972  d = [volmdlr.wir
-00026d90: 6573 2e43 6972 636c 6532 4428 766f 6c6d  es.Circle2D(volm
-00026da0: 646c 722e 4f32 442c 2072 295d 0a20 2020  dlr.O2D, r)].   
-00026db0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00026dc0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00026dd0: 2020 2020 2020 2069 6e6e 6572 5f63 6f6e         inner_con
-00026de0: 746f 7572 7332 6420 3d20 5b5d 0a20 2020  tours2d = [].   
-00026df0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00026e00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00026e10: 6e6e 6572 5f63 6f6e 746f 7572 7332 6420  nner_contours2d 
-00026e20: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
-00026e30: 2020 2020 2069 6620 6d61 7468 2e69 7363       if math.isc
-00026e40: 6c6f 7365 2872 2c20 302c 2061 6273 5f74  lose(r, 0, abs_t
-00026e50: 6f6c 3d31 652d 3929 3a0a 2020 2020 2020  ol=1e-9):.      
-00026e60: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00026e70: 4f6e 6520 6172 6320 616e 6420 3220 6c69  One arc and 2 li
-00026e80: 6e65 7320 2870 697a 7a61 2073 6c69 6365  nes (pizza slice
-00026e90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00026ea0: 2020 2020 2020 6172 6332 5f65 203d 2076        arc2_e = v
-00026eb0: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 2852  olmdlr.Point2D(R
-00026ec0: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
-00026ed0: 2020 2020 2020 2020 2061 7263 325f 6920           arc2_i 
-00026ee0: 3d20 6172 6332 5f65 2e72 6f74 6174 696f  = arc2_e.rotatio
-00026ef0: 6e28 6365 6e74 6572 3d76 6f6c 6d64 6c72  n(center=volmdlr
-00026f00: 2e4f 3244 2c0a 2020 2020 2020 2020 2020  .O2D,.          
-00026f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026f30: 2020 2061 6e67 6c65 3d30 2e35 202a 2061     angle=0.5 * a
-00026f40: 6e67 6c65 290a 2020 2020 2020 2020 2020  ngle).          
-00026f50: 2020 2020 2020 2020 2020 6172 6332 5f73            arc2_s
-00026f60: 203d 2061 7263 325f 652e 726f 7461 7469   = arc2_e.rotati
-00026f70: 6f6e 2863 656e 7465 723d 766f 6c6d 646c  on(center=volmdl
-00026f80: 722e 4f32 442c 2061 6e67 6c65 3d61 6e67  r.O2D, angle=ang
-00026f90: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
-00026fa0: 2020 2020 2020 2020 6172 6332 203d 2041          arc2 = A
-00026fb0: 7263 3244 2861 7263 325f 732c 2061 7263  rc2D(arc2_s, arc
-00026fc0: 325f 692c 2061 7263 325f 6529 0a20 2020  2_i, arc2_e).   
-00026fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026fe0: 206c 696e 6531 203d 204c 696e 6553 6567   line1 = LineSeg
-00026ff0: 6d65 6e74 3244 2861 7263 325f 652c 2076  ment2D(arc2_e, v
-00027000: 6f6c 6d64 6c72 2e4f 3244 290a 2020 2020  olmdlr.O2D).    
-00027010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027020: 6c69 6e65 3220 3d20 4c69 6e65 5365 676d  line2 = LineSegm
-00027030: 656e 7432 4428 766f 6c6d 646c 722e 4f32  ent2D(volmdlr.O2
-00027040: 442c 2061 7263 325f 7329 0a20 2020 2020  D, arc2_s).     
-00027050: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00027060: 7574 6572 5f63 6f6e 746f 7572 3264 203d  uter_contour2d =
-00027070: 2076 6f6c 6d64 6c72 2e77 6972 6573 2e43   volmdlr.wires.C
-00027080: 6f6e 746f 7572 3244 285b 6172 6332 2c20  ontour2D([arc2, 
-00027090: 6c69 6e65 312c 0a20 2020 2020 2020 2020  line1,.         
+00026630: 6c69 6e65 7320 3d20 5b5d 0a20 2020 2020  lines = [].     
+00026640: 2020 2020 2020 2064 6973 745f 6d69 6e20         dist_min 
+00026650: 3d20 6d61 7468 2e69 6e66 0a20 2020 2020  = math.inf.     
+00026660: 2020 2020 2020 2066 6f72 2070 312c 2070         for p1, p
+00026670: 3220 696e 207a 6970 2870 6f69 6e74 735b  2 in zip(points[
+00026680: 303a 2d31 5d2c 2070 6f69 6e74 735b 313a  0:-1], points[1:
+00026690: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+000266a0: 2020 2020 6c69 6e65 732e 6170 7065 6e64      lines.append
+000266b0: 284c 696e 6553 6567 6d65 6e74 3344 2870  (LineSegment3D(p
+000266c0: 312c 2070 3229 290a 2020 2020 2020 2020  1, p2)).        
+000266d0: 2020 2020 666f 7220 6c69 6e65 2069 6e20      for line in 
+000266e0: 6c69 6e65 733a 0a20 2020 2020 2020 2020  lines:.         
+000266f0: 2020 2020 2020 2070 312c 2070 3220 3d20         p1, p2 = 
+00026700: 7365 6c66 2e6d 6174 7269 785f 6469 7374  self.matrix_dist
+00026710: 616e 6365 286c 696e 6529 0a20 2020 2020  ance(line).     
+00026720: 2020 2020 2020 2020 2020 2064 6973 7420             dist 
+00026730: 3d20 7031 2e70 6f69 6e74 5f64 6973 7461  = p1.point_dista
+00026740: 6e63 6528 7032 290a 2020 2020 2020 2020  nce(p2).        
+00026750: 2020 2020 2020 2020 6966 2064 6973 7420          if dist 
+00026760: 3c20 6469 7374 5f6d 696e 3a0a 2020 2020  < dist_min:.    
+00026770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026780: 6469 7374 5f6d 696e 203d 2064 6973 740a  dist_min = dist.
+00026790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000267a0: 2020 2020 6d69 6e5f 706f 696e 7473 203d      min_points =
+000267b0: 2028 7031 2c20 7032 290a 2020 2020 2020   (p1, p2).      
+000267c0: 2020 2020 2020 6966 2072 6574 7572 6e5f        if return_
+000267d0: 706f 696e 7473 3a0a 2020 2020 2020 2020  points:.        
+000267e0: 2020 2020 2020 2020 7031 2c20 7032 203d          p1, p2 =
+000267f0: 206d 696e 5f70 6f69 6e74 730a 2020 2020   min_points.    
+00026800: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00026810: 726e 2064 6973 745f 6d69 6e2c 2070 312c  rn dist_min, p1,
+00026820: 2070 320a 2020 2020 2020 2020 2020 2020   p2.            
+00026830: 7265 7475 726e 2064 6973 745f 6d69 6e0a  return dist_min.
+00026840: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
+00026850: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00026860: 6f72 0a0a 2020 2020 6465 6620 6578 7472  or..    def extr
+00026870: 7573 696f 6e28 7365 6c66 2c20 6578 7472  usion(self, extr
+00026880: 7573 696f 6e5f 7665 6374 6f72 293a 0a20  usion_vector):. 
+00026890: 2020 2020 2020 2075 203d 2073 656c 662e         u = self.
+000268a0: 756e 6974 5f64 6972 6563 7469 6f6e 5f76  unit_direction_v
+000268b0: 6563 746f 7228 290a 2020 2020 2020 2020  ector().        
+000268c0: 7620 3d20 6578 7472 7573 696f 6e5f 7665  v = extrusion_ve
+000268d0: 6374 6f72 2e63 6f70 7928 290a 2020 2020  ctor.copy().    
+000268e0: 2020 2020 762e 6e6f 726d 616c 697a 6528      v.normalize(
+000268f0: 290a 2020 2020 2020 2020 7720 3d20 752e  ).        w = u.
+00026900: 6372 6f73 7328 7629 0a20 2020 2020 2020  cross(v).       
+00026910: 206c 3120 3d20 7365 6c66 2e6c 656e 6774   l1 = self.lengt
+00026920: 6828 290a 2020 2020 2020 2020 6c32 203d  h().        l2 =
+00026930: 2065 7874 7275 7369 6f6e 5f76 6563 746f   extrusion_vecto
+00026940: 722e 6e6f 726d 2829 0a20 2020 2020 2020  r.norm().       
+00026950: 2023 206f 7574 6572 5f63 6f6e 746f 7572   # outer_contour
+00026960: 203d 2050 6f6c 7967 6f6e 3244 285b 4f32   = Polygon2D([O2
+00026970: 442c 2050 6f69 6e74 3244 2828 6c31 2c20  D, Point2D((l1, 
+00026980: 302e 2929 2c0a 2020 2020 2020 2020 2320  0.)),.        # 
+00026990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000269a0: 2020 2020 2020 2020 2020 2050 6f69 6e74             Point
+000269b0: 3244 2828 6c31 2c20 6c32 2929 2c20 506f  2D((l1, l2)), Po
+000269c0: 696e 7432 4428 2830 2e2c 206c 3229 295d  int2D((0., l2))]
+000269d0: 290a 2020 2020 2020 2020 706c 616e 6520  ).        plane 
+000269e0: 3d20 766f 6c6d 646c 722e 6661 6365 732e  = volmdlr.faces.
+000269f0: 506c 616e 6533 4428 766f 6c6d 646c 722e  Plane3D(volmdlr.
+00026a00: 4672 616d 6533 4428 7365 6c66 2e73 7461  Frame3D(self.sta
+00026a10: 7274 2c20 752c 2076 2c20 7729 290a 2020  rt, u, v, w)).  
+00026a20: 2020 2020 2020 7265 7475 726e 205b 706c        return [pl
+00026a30: 616e 652e 7265 6374 616e 6775 6c61 725f  ane.rectangular_
+00026a40: 6375 7428 302c 206c 312c 2030 2c20 6c32  cut(0, l1, 0, l2
+00026a50: 295d 0a0a 2020 2020 6465 6620 7265 766f  )]..    def revo
+00026a60: 6c75 7469 6f6e 2873 656c 662c 2061 7869  lution(self, axi
+00026a70: 735f 706f 696e 742c 2061 7869 732c 2061  s_point, axis, a
+00026a80: 6e67 6c65 293a 0a20 2020 2020 2020 2061  ngle):.        a
+00026a90: 7869 735f 6c69 6e65 3364 203d 204c 696e  xis_line3d = Lin
+00026aa0: 6533 4428 6178 6973 5f70 6f69 6e74 2c20  e3D(axis_point, 
+00026ab0: 6178 6973 5f70 6f69 6e74 202b 2061 7869  axis_point + axi
+00026ac0: 7329 0a20 2020 2020 2020 2069 6620 6178  s).        if ax
+00026ad0: 6973 5f6c 696e 6533 642e 706f 696e 745f  is_line3d.point_
+00026ae0: 6265 6c6f 6e67 7328 7365 6c66 2e73 7461  belongs(self.sta
+00026af0: 7274 2920 616e 6420 6178 6973 5f6c 696e  rt) and axis_lin
+00026b00: 6533 642e 706f 696e 745f 6265 6c6f 6e67  e3d.point_belong
+00026b10: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00026b20: 2020 2073 656c 662e 656e 6429 3a0a 2020     self.end):.  
+00026b30: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00026b40: 205b 5d0a 0a20 2020 2020 2020 2070 315f   []..        p1_
+00026b50: 7072 6f6a 2c20 5f20 3d20 6178 6973 5f6c  proj, _ = axis_l
+00026b60: 696e 6533 642e 706f 696e 745f 7072 6f6a  ine3d.point_proj
+00026b70: 6563 7469 6f6e 2873 656c 662e 7374 6172  ection(self.star
+00026b80: 7429 0a20 2020 2020 2020 2070 325f 7072  t).        p2_pr
+00026b90: 6f6a 2c20 5f20 3d20 6178 6973 5f6c 696e  oj, _ = axis_lin
+00026ba0: 6533 642e 706f 696e 745f 7072 6f6a 6563  e3d.point_projec
+00026bb0: 7469 6f6e 2873 656c 662e 656e 6429 0a20  tion(self.end). 
+00026bc0: 2020 2020 2020 2064 3120 3d20 7365 6c66         d1 = self
+00026bd0: 2e73 7461 7274 2e70 6f69 6e74 5f64 6973  .start.point_dis
+00026be0: 7461 6e63 6528 7031 5f70 726f 6a29 0a20  tance(p1_proj). 
+00026bf0: 2020 2020 2020 2064 3220 3d20 7365 6c66         d2 = self
+00026c00: 2e65 6e64 2e70 6f69 6e74 5f64 6973 7461  .end.point_dista
+00026c10: 6e63 6528 7032 5f70 726f 6a29 0a20 2020  nce(p2_proj).   
+00026c20: 2020 2020 2069 6620 6e6f 7420 6d61 7468       if not math
+00026c30: 2e69 7363 6c6f 7365 2864 312c 2030 2e2c  .isclose(d1, 0.,
+00026c40: 2061 6273 5f74 6f6c 3d31 652d 3929 3a0a   abs_tol=1e-9):.
+00026c50: 2020 2020 2020 2020 2020 2020 7520 3d20              u = 
+00026c60: 7365 6c66 2e73 7461 7274 202d 2070 315f  self.start - p1_
+00026c70: 7072 6f6a 2020 2320 556e 6974 2076 6563  proj  # Unit vec
+00026c80: 746f 7220 6672 6f6d 2070 315f 7072 6f6a  tor from p1_proj
+00026c90: 2074 6f20 7031 0a20 2020 2020 2020 2020   to p1.         
+00026ca0: 2020 2075 2e6e 6f72 6d61 6c69 7a65 2829     u.normalize()
+00026cb0: 0a20 2020 2020 2020 2065 6c69 6620 6e6f  .        elif no
+00026cc0: 7420 6d61 7468 2e69 7363 6c6f 7365 2864  t math.isclose(d
+00026cd0: 322c 2030 2e2c 2061 6273 5f74 6f6c 3d31  2, 0., abs_tol=1
+00026ce0: 652d 3929 3a0a 2020 2020 2020 2020 2020  e-9):.          
+00026cf0: 2020 7520 3d20 7365 6c66 2e65 6e64 202d    u = self.end -
+00026d00: 2070 325f 7072 6f6a 2020 2320 556e 6974   p2_proj  # Unit
+00026d10: 2076 6563 746f 7220 6672 6f6d 2070 315f   vector from p1_
+00026d20: 7072 6f6a 2074 6f20 7031 0a20 2020 2020  proj to p1.     
+00026d30: 2020 2020 2020 2075 2e6e 6f72 6d61 6c69         u.normali
+00026d40: 7a65 2829 0a20 2020 2020 2020 2065 6c73  ze().        els
+00026d50: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00026d60: 6574 7572 6e20 5b5d 0a20 2020 2020 2020  eturn [].       
+00026d70: 2069 6620 752e 6973 5f63 6f6c 696e 6561   if u.is_colinea
+00026d80: 725f 746f 2873 656c 662e 6469 7265 6374  r_to(self.direct
+00026d90: 696f 6e5f 7665 6374 6f72 2829 293a 0a20  ion_vector()):. 
+00026da0: 2020 2020 2020 2020 2020 2023 2050 6c61             # Pla
+00026db0: 6e61 7220 6661 6365 0a20 2020 2020 2020  nar face.       
+00026dc0: 2020 2020 2076 203d 2061 7869 732e 6372       v = axis.cr
+00026dd0: 6f73 7328 7529 0a20 2020 2020 2020 2020  oss(u).         
+00026de0: 2020 2073 7572 6661 6365 203d 2076 6f6c     surface = vol
+00026df0: 6d64 6c72 2e66 6163 6573 2e50 6c61 6e65  mdlr.faces.Plane
+00026e00: 3344 280a 2020 2020 2020 2020 2020 2020  3D(.            
+00026e10: 2020 2020 766f 6c6d 646c 722e 4672 616d      volmdlr.Fram
+00026e20: 6533 4428 7031 5f70 726f 6a2c 2075 2c20  e3D(p1_proj, u, 
+00026e30: 762c 2061 7869 7329 290a 2020 2020 2020  v, axis)).      
+00026e40: 2020 2020 2020 722c 2052 203d 2073 6f72        r, R = sor
+00026e50: 7465 6428 5b64 312c 2064 325d 290a 2020  ted([d1, d2]).  
+00026e60: 2020 2020 2020 2020 2020 6966 2061 6e67            if ang
+00026e70: 6c65 203d 3d20 766f 6c6d 646c 722e 5457  le == volmdlr.TW
+00026e80: 4f5f 5049 3a0a 2020 2020 2020 2020 2020  O_PI:.          
+00026e90: 2020 2020 2020 2320 4f6e 6c79 2032 2063        # Only 2 c
+00026ea0: 6972 636c 6573 2061 7320 636f 6e74 6f75  ircles as contou
+00026eb0: 7273 0a20 2020 2020 2020 2020 2020 2020  rs.             
+00026ec0: 2020 206f 7574 6572 5f63 6f6e 746f 7572     outer_contour
+00026ed0: 3264 203d 2076 6f6c 6d64 6c72 2e77 6972  2d = volmdlr.wir
+00026ee0: 6573 2e43 6972 636c 6532 4428 766f 6c6d  es.Circle2D(volm
+00026ef0: 646c 722e 4f32 442c 2052 290a 2020 2020  dlr.O2D, R).    
+00026f00: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00026f10: 6f74 206d 6174 682e 6973 636c 6f73 6528  ot math.isclose(
+00026f20: 722c 2030 2c20 6162 735f 746f 6c3d 3165  r, 0, abs_tol=1e
+00026f30: 2d39 293a 0a20 2020 2020 2020 2020 2020  -9):.           
+00026f40: 2020 2020 2020 2020 2069 6e6e 6572 5f63           inner_c
+00026f50: 6f6e 746f 7572 7332 6420 3d20 5b76 6f6c  ontours2d = [vol
+00026f60: 6d64 6c72 2e77 6972 6573 2e43 6972 636c  mdlr.wires.Circl
+00026f70: 6532 4428 766f 6c6d 646c 722e 4f32 442c  e2D(volmdlr.O2D,
+00026f80: 2072 295d 0a20 2020 2020 2020 2020 2020   r)].           
+00026f90: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00026fa0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00026fb0: 6e6e 6572 5f63 6f6e 746f 7572 7332 6420  nner_contours2d 
+00026fc0: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+00026fd0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00026fe0: 2020 2020 2020 2069 6e6e 6572 5f63 6f6e         inner_con
+00026ff0: 746f 7572 7332 6420 3d20 5b5d 0a20 2020  tours2d = [].   
+00027000: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00027010: 6d61 7468 2e69 7363 6c6f 7365 2872 2c20  math.isclose(r, 
+00027020: 302c 2061 6273 5f74 6f6c 3d31 652d 3929  0, abs_tol=1e-9)
+00027030: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00027040: 2020 2020 2020 2320 4f6e 6520 6172 6320        # One arc 
+00027050: 616e 6420 3220 6c69 6e65 7320 2870 697a  and 2 lines (piz
+00027060: 7a61 2073 6c69 6365 290a 2020 2020 2020  za slice).      
+00027070: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+00027080: 6332 5f65 203d 2076 6f6c 6d64 6c72 2e50  c2_e = volmdlr.P
+00027090: 6f69 6e74 3244 2852 2c20 3029 0a20 2020  oint2D(R, 0).   
 000270a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270d0: 2020 2020 2020 6c69 6e65 325d 290a 0a20        line2]).. 
-000270e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000270f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00027100: 2020 2020 2020 2020 2023 2054 776f 2061           # Two a
-00027110: 7263 7320 616e 6420 6c69 6e65 730a 2020  rcs and lines.  
+000270b0: 2061 7263 325f 6920 3d20 6172 6332 5f65   arc2_i = arc2_e
+000270c0: 2e72 6f74 6174 696f 6e28 6365 6e74 6572  .rotation(center
+000270d0: 3d76 6f6c 6d64 6c72 2e4f 3244 2c0a 2020  =volmdlr.O2D,.  
+000270e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000270f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027100: 2020 2020 2020 2020 2020 2061 6e67 6c65             angle
+00027110: 3d30 2e35 202a 2061 6e67 6c65 290a 2020  =0.5 * angle).  
 00027120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027130: 2020 6172 6331 5f73 203d 2076 6f6c 6d64    arc1_s = volmd
-00027140: 6c72 2e50 6f69 6e74 3244 2852 2c20 3029  lr.Point2D(R, 0)
-00027150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027160: 2020 2020 2061 7263 315f 6920 3d20 6172       arc1_i = ar
-00027170: 6331 5f73 2e72 6f74 6174 696f 6e28 6365  c1_s.rotation(ce
-00027180: 6e74 6572 3d76 6f6c 6d64 6c72 2e4f 3244  nter=volmdlr.O2D
-00027190: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000271a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000271b0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000271c0: 6e67 6c65 3d30 2e35 202a 2061 6e67 6c65  ngle=0.5 * angle
-000271d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000271e0: 2020 2020 2020 6172 6331 5f65 203d 2061        arc1_e = a
-000271f0: 7263 315f 732e 726f 7461 7469 6f6e 2863  rc1_s.rotation(c
-00027200: 656e 7465 723d 766f 6c6d 646c 722e 4f32  enter=volmdlr.O2
-00027210: 442c 2061 6e67 6c65 3d61 6e67 6c65 290a  D, angle=angle).
-00027220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027230: 2020 2020 6172 6331 203d 2041 7263 3244      arc1 = Arc2D
-00027240: 2861 7263 315f 732c 2061 7263 315f 692c  (arc1_s, arc1_i,
-00027250: 2061 7263 315f 6529 0a0a 2020 2020 2020   arc1_e)..      
-00027260: 2020 2020 2020 2020 2020 2020 2020 6172                ar
-00027270: 6332 5f65 203d 2076 6f6c 6d64 6c72 2e50  c2_e = volmdlr.P
-00027280: 6f69 6e74 3244 2872 2c20 3029 0a20 2020  oint2D(r, 0).   
+00027130: 2020 6172 6332 5f73 203d 2061 7263 325f    arc2_s = arc2_
+00027140: 652e 726f 7461 7469 6f6e 2863 656e 7465  e.rotation(cente
+00027150: 723d 766f 6c6d 646c 722e 4f32 442c 2061  r=volmdlr.O2D, a
+00027160: 6e67 6c65 3d61 6e67 6c65 290a 2020 2020  ngle=angle).    
+00027170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027180: 6172 6332 203d 2041 7263 3244 2861 7263  arc2 = Arc2D(arc
+00027190: 325f 732c 2061 7263 325f 692c 2061 7263  2_s, arc2_i, arc
+000271a0: 325f 6529 0a20 2020 2020 2020 2020 2020  2_e).           
+000271b0: 2020 2020 2020 2020 206c 696e 6531 203d           line1 =
+000271c0: 204c 696e 6553 6567 6d65 6e74 3244 2861   LineSegment2D(a
+000271d0: 7263 325f 652c 2076 6f6c 6d64 6c72 2e4f  rc2_e, volmdlr.O
+000271e0: 3244 290a 2020 2020 2020 2020 2020 2020  2D).            
+000271f0: 2020 2020 2020 2020 6c69 6e65 3220 3d20          line2 = 
+00027200: 4c69 6e65 5365 676d 656e 7432 4428 766f  LineSegment2D(vo
+00027210: 6c6d 646c 722e 4f32 442c 2061 7263 325f  lmdlr.O2D, arc2_
+00027220: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+00027230: 2020 2020 2020 206f 7574 6572 5f63 6f6e         outer_con
+00027240: 746f 7572 3264 203d 2076 6f6c 6d64 6c72  tour2d = volmdlr
+00027250: 2e77 6972 6573 2e43 6f6e 746f 7572 3244  .wires.Contour2D
+00027260: 285b 6172 6332 2c20 6c69 6e65 312c 0a20  ([arc2, line1,. 
+00027270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027280: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00027290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000272a0: 2061 7263 325f 6920 3d20 6172 6332 5f65   arc2_i = arc2_e
-000272b0: 2e72 6f74 6174 696f 6e28 6365 6e74 6572  .rotation(center
-000272c0: 3d76 6f6c 6d64 6c72 2e4f 3244 2c0a 2020  =volmdlr.O2D,.  
+000272a0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+000272b0: 6e65 325d 290a 0a20 2020 2020 2020 2020  ne2])..         
+000272c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
 000272d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000272e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000272f0: 2020 2020 2020 2020 2020 2061 6e67 6c65             angle
-00027300: 3d30 2e35 202a 2061 6e67 6c65 290a 2020  =0.5 * angle).  
-00027310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027320: 2020 6172 6332 5f73 203d 2061 7263 325f    arc2_s = arc2_
-00027330: 652e 726f 7461 7469 6f6e 2863 656e 7465  e.rotation(cente
-00027340: 723d 766f 6c6d 646c 722e 4f32 442c 2061  r=volmdlr.O2D, a
-00027350: 6e67 6c65 3d61 6e67 6c65 290a 2020 2020  ngle=angle).    
-00027360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027370: 6172 6332 203d 2041 7263 3244 2861 7263  arc2 = Arc2D(arc
-00027380: 325f 732c 2061 7263 325f 692c 2061 7263  2_s, arc2_i, arc
-00027390: 325f 6529 0a0a 2020 2020 2020 2020 2020  2_e)..          
-000273a0: 2020 2020 2020 2020 2020 6c69 6e65 3120            line1 
-000273b0: 3d20 4c69 6e65 5365 676d 656e 7432 4428  = LineSegment2D(
-000273c0: 6172 6331 5f65 2c20 6172 6332 5f73 290a  arc1_e, arc2_s).
-000273d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000273e0: 2020 2020 6c69 6e65 3220 3d20 4c69 6e65      line2 = Line
-000273f0: 5365 676d 656e 7432 4428 6172 6332 5f65  Segment2D(arc2_e
-00027400: 2c20 6172 6331 5f73 290a 0a20 2020 2020  , arc1_s)..     
-00027410: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00027420: 7574 6572 5f63 6f6e 746f 7572 3264 203d  uter_contour2d =
-00027430: 2076 6f6c 6d64 6c72 2e77 6972 6573 2e43   volmdlr.wires.C
-00027440: 6f6e 746f 7572 3244 285b 6172 6331 2c20  ontour2D([arc1, 
-00027450: 6c69 6e65 312c 0a20 2020 2020 2020 2020  line1,.         
-00027460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027490: 2020 2020 2020 6172 6332 2c20 6c69 6e65        arc2, line
-000274a0: 325d 290a 0a20 2020 2020 2020 2020 2020  2])..           
-000274b0: 2072 6574 7572 6e20 5b76 6f6c 6d64 6c72   return [volmdlr
-000274c0: 2e66 6163 6573 2e50 6c61 6e65 4661 6365  .faces.PlaneFace
-000274d0: 3344 2873 7572 6661 6365 2c0a 2020 2020  3D(surface,.    
-000274e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000274f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027500: 2020 2020 2020 2020 2020 766f 6c6d 646c            volmdl
-00027510: 722e 6661 6365 732e 5375 7266 6163 6532  r.faces.Surface2
-00027520: 4428 0a20 2020 2020 2020 2020 2020 2020  D(.             
-00027530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027550: 2020 2020 206f 7574 6572 5f63 6f6e 746f       outer_conto
-00027560: 7572 3264 2c0a 2020 2020 2020 2020 2020  ur2d,.          
+000272e0: 2023 2054 776f 2061 7263 7320 616e 6420   # Two arcs and 
+000272f0: 6c69 6e65 730a 2020 2020 2020 2020 2020  lines.          
+00027300: 2020 2020 2020 2020 2020 6172 6331 5f73            arc1_s
+00027310: 203d 2076 6f6c 6d64 6c72 2e50 6f69 6e74   = volmdlr.Point
+00027320: 3244 2852 2c20 3029 0a20 2020 2020 2020  2D(R, 0).       
+00027330: 2020 2020 2020 2020 2020 2020 2061 7263               arc
+00027340: 315f 6920 3d20 6172 6331 5f73 2e72 6f74  1_i = arc1_s.rot
+00027350: 6174 696f 6e28 6365 6e74 6572 3d76 6f6c  ation(center=vol
+00027360: 6d64 6c72 2e4f 3244 2c0a 2020 2020 2020  mdlr.O2D,.      
+00027370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027390: 2020 2020 2020 2061 6e67 6c65 3d30 2e35         angle=0.5
+000273a0: 202a 2061 6e67 6c65 290a 2020 2020 2020   * angle).      
+000273b0: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+000273c0: 6331 5f65 203d 2061 7263 315f 732e 726f  c1_e = arc1_s.ro
+000273d0: 7461 7469 6f6e 2863 656e 7465 723d 766f  tation(center=vo
+000273e0: 6c6d 646c 722e 4f32 442c 2061 6e67 6c65  lmdlr.O2D, angle
+000273f0: 3d61 6e67 6c65 290a 2020 2020 2020 2020  =angle).        
+00027400: 2020 2020 2020 2020 2020 2020 6172 6331              arc1
+00027410: 203d 2041 7263 3244 2861 7263 315f 732c   = Arc2D(arc1_s,
+00027420: 2061 7263 315f 692c 2061 7263 315f 6529   arc1_i, arc1_e)
+00027430: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00027440: 2020 2020 2020 6172 6332 5f65 203d 2076        arc2_e = v
+00027450: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 2872  olmdlr.Point2D(r
+00027460: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
+00027470: 2020 2020 2020 2020 2061 7263 325f 6920           arc2_i 
+00027480: 3d20 6172 6332 5f65 2e72 6f74 6174 696f  = arc2_e.rotatio
+00027490: 6e28 6365 6e74 6572 3d76 6f6c 6d64 6c72  n(center=volmdlr
+000274a0: 2e4f 3244 2c0a 2020 2020 2020 2020 2020  .O2D,.          
+000274b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000274c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000274d0: 2020 2061 6e67 6c65 3d30 2e35 202a 2061     angle=0.5 * a
+000274e0: 6e67 6c65 290a 2020 2020 2020 2020 2020  ngle).          
+000274f0: 2020 2020 2020 2020 2020 6172 6332 5f73            arc2_s
+00027500: 203d 2061 7263 325f 652e 726f 7461 7469   = arc2_e.rotati
+00027510: 6f6e 2863 656e 7465 723d 766f 6c6d 646c  on(center=volmdl
+00027520: 722e 4f32 442c 2061 6e67 6c65 3d61 6e67  r.O2D, angle=ang
+00027530: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
+00027540: 2020 2020 2020 2020 6172 6332 203d 2041          arc2 = A
+00027550: 7263 3244 2861 7263 325f 732c 2061 7263  rc2D(arc2_s, arc
+00027560: 325f 692c 2061 7263 325f 6529 0a0a 2020  2_i, arc2_e)..  
 00027570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027590: 2020 2020 2020 2020 696e 6e65 725f 636f          inner_co
-000275a0: 6e74 6f75 7273 3264 2929 5d0a 0a20 2020  ntours2d))]..   
-000275b0: 2020 2020 2065 6c69 6620 6e6f 7420 6d61       elif not ma
-000275c0: 7468 2e69 7363 6c6f 7365 2864 312c 2064  th.isclose(d1, d
-000275d0: 322c 2061 6273 5f74 6f6c 3d31 652d 3929  2, abs_tol=1e-9)
-000275e0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-000275f0: 436f 6e69 6361 6c0a 2020 2020 2020 2020  Conical.        
-00027600: 2020 2020 7620 3d20 6178 6973 2e63 726f      v = axis.cro
-00027610: 7373 2875 290a 2020 2020 2020 2020 2020  ss(u).          
-00027620: 2020 6476 203d 2073 656c 662e 6469 7265    dv = self.dire
-00027630: 6374 696f 6e5f 7665 6374 6f72 2829 0a20  ction_vector(). 
-00027640: 2020 2020 2020 2020 2020 2064 762e 6e6f             dv.no
-00027650: 726d 616c 697a 6528 290a 0a20 2020 2020  rmalize()..     
-00027660: 2020 2020 2020 2073 656d 695f 616e 676c         semi_angl
-00027670: 6520 3d20 6d61 7468 2e61 7461 6e32 2864  e = math.atan2(d
-00027680: 762e 646f 7428 7529 2c20 6476 2e64 6f74  v.dot(u), dv.dot
-00027690: 2861 7869 7329 290a 2020 2020 2020 2020  (axis)).        
-000276a0: 2020 2020 636f 6e65 5f6f 7269 6769 6e20      cone_origin 
-000276b0: 3d20 7031 5f70 726f 6a20 2d20 6431 202f  = p1_proj - d1 /
-000276c0: 206d 6174 682e 7461 6e28 7365 6d69 5f61   math.tan(semi_a
-000276d0: 6e67 6c65 2920 2a20 6178 6973 0a20 2020  ngle) * axis.   
-000276e0: 2020 2020 2020 2020 2069 6620 7365 6d69           if semi
-000276f0: 5f61 6e67 6c65 203e 2030 2e35 202a 206d  _angle > 0.5 * m
-00027700: 6174 682e 7069 3a0a 2020 2020 2020 2020  ath.pi:.        
-00027710: 2020 2020 2020 2020 7365 6d69 5f61 6e67          semi_ang
-00027720: 6c65 203d 206d 6174 682e 7069 202d 2073  le = math.pi - s
-00027730: 656d 695f 616e 676c 650a 0a20 2020 2020  emi_angle..     
-00027740: 2020 2020 2020 2020 2020 2063 6f6e 655f             cone_
-00027750: 6672 616d 6520 3d20 766f 6c6d 646c 722e  frame = volmdlr.
-00027760: 4672 616d 6533 4428 636f 6e65 5f6f 7269  Frame3D(cone_ori
-00027770: 6769 6e2c 2075 2c20 2d76 2c20 2d61 7869  gin, u, -v, -axi
-00027780: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-00027790: 2020 2061 6e67 6c65 3220 3d20 2d61 6e67     angle2 = -ang
-000277a0: 6c65 0a20 2020 2020 2020 2020 2020 2065  le.            e
-000277b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000277c0: 2020 2020 2061 6e67 6c65 3220 3d20 616e       angle2 = an
-000277d0: 676c 650a 2020 2020 2020 2020 2020 2020  gle.            
-000277e0: 2020 2020 636f 6e65 5f66 7261 6d65 203d      cone_frame =
-000277f0: 2076 6f6c 6d64 6c72 2e46 7261 6d65 3344   volmdlr.Frame3D
-00027800: 2863 6f6e 655f 6f72 6967 696e 2c20 752c  (cone_origin, u,
-00027810: 2076 2c20 6178 6973 290a 0a20 2020 2020   v, axis)..     
-00027820: 2020 2020 2020 2073 7572 6661 6365 203d         surface =
-00027830: 2076 6f6c 6d64 6c72 2e66 6163 6573 2e43   volmdlr.faces.C
-00027840: 6f6e 6963 616c 5375 7266 6163 6533 4428  onicalSurface3D(
-00027850: 636f 6e65 5f66 7261 6d65 2c0a 2020 2020  cone_frame,.    
-00027860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027890: 2073 656d 695f 616e 676c 6529 0a20 2020   semi_angle).   
-000278a0: 2020 2020 2020 2020 207a 3120 3d20 6431           z1 = d1
-000278b0: 202f 206d 6174 682e 7461 6e28 7365 6d69   / math.tan(semi
-000278c0: 5f61 6e67 6c65 290a 2020 2020 2020 2020  _angle).        
-000278d0: 2020 2020 7a32 203d 2064 3220 2f20 6d61      z2 = d2 / ma
-000278e0: 7468 2e74 616e 2873 656d 695f 616e 676c  th.tan(semi_angl
-000278f0: 6529 0a20 2020 2020 2020 2020 2020 2072  e).            r
-00027900: 6574 7572 6e20 5b73 7572 6661 6365 2e72  eturn [surface.r
-00027910: 6563 7461 6e67 756c 6172 5f63 7574 2830  ectangular_cut(0
-00027920: 2c20 616e 676c 6532 2c20 7a31 2c20 7a32  , angle2, z1, z2
-00027930: 295d 0a20 2020 2020 2020 2065 6c73 653a  )].        else:
-00027940: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
-00027950: 796c 696e 6472 6963 616c 2066 6163 650a  ylindrical face.
-00027960: 2020 2020 2020 2020 2020 2020 7620 3d20              v = 
-00027970: 6178 6973 2e63 726f 7373 2875 290a 2020  axis.cross(u).  
-00027980: 2020 2020 2020 2020 2020 7375 7266 6163            surfac
-00027990: 6520 3d20 766f 6c6d 646c 722e 6661 6365  e = volmdlr.face
-000279a0: 732e 4379 6c69 6e64 7269 6361 6c53 7572  s.CylindricalSur
-000279b0: 6661 6365 3344 280a 2020 2020 2020 2020  face3D(.        
-000279c0: 2020 2020 2020 2020 766f 6c6d 646c 722e          volmdlr.
-000279d0: 4672 616d 6533 4428 7031 5f70 726f 6a2c  Frame3D(p1_proj,
-000279e0: 2075 2c20 762c 2061 7869 7329 2c20 6431   u, v, axis), d1
-000279f0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00027a00: 7475 726e 205b 7375 7266 6163 652e 7265  turn [surface.re
-00027a10: 6374 616e 6775 6c61 725f 6375 7428 302c  ctangular_cut(0,
-00027a20: 2061 6e67 6c65 2c0a 2020 2020 2020 2020   angle,.        
-00027a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027580: 2020 6c69 6e65 3120 3d20 4c69 6e65 5365    line1 = LineSe
+00027590: 676d 656e 7432 4428 6172 6331 5f65 2c20  gment2D(arc1_e, 
+000275a0: 6172 6332 5f73 290a 2020 2020 2020 2020  arc2_s).        
+000275b0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+000275c0: 3220 3d20 4c69 6e65 5365 676d 656e 7432  2 = LineSegment2
+000275d0: 4428 6172 6332 5f65 2c20 6172 6331 5f73  D(arc2_e, arc1_s
+000275e0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+000275f0: 2020 2020 2020 206f 7574 6572 5f63 6f6e         outer_con
+00027600: 746f 7572 3264 203d 2076 6f6c 6d64 6c72  tour2d = volmdlr
+00027610: 2e77 6972 6573 2e43 6f6e 746f 7572 3244  .wires.Contour2D
+00027620: 285b 6172 6331 2c20 6c69 6e65 312c 0a20  ([arc1, line1,. 
+00027630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027660: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+00027670: 6332 2c20 6c69 6e65 325d 290a 0a20 2020  c2, line2])..   
+00027680: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00027690: 5b76 6f6c 6d64 6c72 2e66 6163 6573 2e50  [volmdlr.faces.P
+000276a0: 6c61 6e65 4661 6365 3344 2873 7572 6661  laneFace3D(surfa
+000276b0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
+000276c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000276d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000276e0: 2020 766f 6c6d 646c 722e 6661 6365 732e    volmdlr.faces.
+000276f0: 5375 7266 6163 6532 4428 0a20 2020 2020  Surface2D(.     
+00027700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027720: 2020 2020 2020 2020 2020 2020 206f 7574               out
+00027730: 6572 5f63 6f6e 746f 7572 3264 2c0a 2020  er_contour2d,.  
+00027740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027770: 696e 6e65 725f 636f 6e74 6f75 7273 3264  inner_contours2d
+00027780: 2929 5d0a 0a20 2020 2020 2020 2065 6c69  ))]..        eli
+00027790: 6620 6e6f 7420 6d61 7468 2e69 7363 6c6f  f not math.isclo
+000277a0: 7365 2864 312c 2064 322c 2061 6273 5f74  se(d1, d2, abs_t
+000277b0: 6f6c 3d31 652d 3929 3a0a 2020 2020 2020  ol=1e-9):.      
+000277c0: 2020 2020 2020 2320 436f 6e69 6361 6c0a        # Conical.
+000277d0: 2020 2020 2020 2020 2020 2020 7620 3d20              v = 
+000277e0: 6178 6973 2e63 726f 7373 2875 290a 2020  axis.cross(u).  
+000277f0: 2020 2020 2020 2020 2020 6476 203d 2073            dv = s
+00027800: 656c 662e 6469 7265 6374 696f 6e5f 7665  elf.direction_ve
+00027810: 6374 6f72 2829 0a20 2020 2020 2020 2020  ctor().         
+00027820: 2020 2064 762e 6e6f 726d 616c 697a 6528     dv.normalize(
+00027830: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00027840: 656d 695f 616e 676c 6520 3d20 6d61 7468  emi_angle = math
+00027850: 2e61 7461 6e32 2864 762e 646f 7428 7529  .atan2(dv.dot(u)
+00027860: 2c20 6476 2e64 6f74 2861 7869 7329 290a  , dv.dot(axis)).
+00027870: 2020 2020 2020 2020 2020 2020 636f 6e65              cone
+00027880: 5f6f 7269 6769 6e20 3d20 7031 5f70 726f  _origin = p1_pro
+00027890: 6a20 2d20 6431 202f 206d 6174 682e 7461  j - d1 / math.ta
+000278a0: 6e28 7365 6d69 5f61 6e67 6c65 2920 2a20  n(semi_angle) * 
+000278b0: 6178 6973 0a20 2020 2020 2020 2020 2020  axis.           
+000278c0: 2069 6620 7365 6d69 5f61 6e67 6c65 203e   if semi_angle >
+000278d0: 2030 2e35 202a 206d 6174 682e 7069 3a0a   0.5 * math.pi:.
+000278e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000278f0: 7365 6d69 5f61 6e67 6c65 203d 206d 6174  semi_angle = mat
+00027900: 682e 7069 202d 2073 656d 695f 616e 676c  h.pi - semi_angl
+00027910: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
+00027920: 2020 2063 6f6e 655f 6672 616d 6520 3d20     cone_frame = 
+00027930: 766f 6c6d 646c 722e 4672 616d 6533 4428  volmdlr.Frame3D(
+00027940: 636f 6e65 5f6f 7269 6769 6e2c 2075 2c20  cone_origin, u, 
+00027950: 2d76 2c20 2d61 7869 7329 0a20 2020 2020  -v, -axis).     
+00027960: 2020 2020 2020 2020 2020 2061 6e67 6c65             angle
+00027970: 3220 3d20 2d61 6e67 6c65 0a20 2020 2020  2 = -angle.     
+00027980: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00027990: 2020 2020 2020 2020 2020 2020 2061 6e67               ang
+000279a0: 6c65 3220 3d20 616e 676c 650a 2020 2020  le2 = angle.    
+000279b0: 2020 2020 2020 2020 2020 2020 636f 6e65              cone
+000279c0: 5f66 7261 6d65 203d 2076 6f6c 6d64 6c72  _frame = volmdlr
+000279d0: 2e46 7261 6d65 3344 2863 6f6e 655f 6f72  .Frame3D(cone_or
+000279e0: 6967 696e 2c20 752c 2076 2c20 6178 6973  igin, u, v, axis
+000279f0: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00027a00: 7572 6661 6365 203d 2076 6f6c 6d64 6c72  urface = volmdlr
+00027a10: 2e66 6163 6573 2e43 6f6e 6963 616c 5375  .faces.ConicalSu
+00027a20: 7266 6163 6533 4428 636f 6e65 5f66 7261  rface3D(cone_fra
+00027a30: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
 00027a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027a50: 2020 2020 302c 0a20 2020 2020 2020 2020      0,.         
-00027a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027a80: 2020 2028 7365 6c66 2e65 6e64 202d 2073     (self.end - s
-00027a90: 656c 662e 7374 6172 7429 2e64 6f74 2861  elf.start).dot(a
-00027aa0: 7869 7329 295d 0a0a 2020 2020 6465 6620  xis))]..    def 
-00027ab0: 746f 5f73 7465 7028 7365 6c66 2c20 6375  to_step(self, cu
-00027ac0: 7272 656e 745f 6964 2c20 7375 7266 6163  rrent_id, surfac
-00027ad0: 655f 6964 3d4e 6f6e 6529 3a0a 2020 2020  e_id=None):.    
-00027ae0: 2020 2020 6c69 6e65 203d 2073 656c 662e      line = self.
-00027af0: 746f 5f6c 696e 6528 290a 2020 2020 2020  to_line().      
-00027b00: 2020 636f 6e74 656e 742c 206c 696e 655f    content, line_
-00027b10: 6964 203d 206c 696e 652e 746f 5f73 7465  id = line.to_ste
-00027b20: 7028 6375 7272 656e 745f 6964 290a 2020  p(current_id).  
-00027b30: 2020 2020 2020 6375 7272 656e 745f 6964        current_id
-00027b40: 203d 206c 696e 655f 6964 202b 2031 0a20   = line_id + 1. 
-00027b50: 2020 2020 2020 2073 7461 7274 5f63 6f6e         start_con
-00027b60: 7465 6e74 2c20 7374 6172 745f 6964 203d  tent, start_id =
-00027b70: 2073 656c 662e 7374 6172 742e 746f 5f73   self.start.to_s
-00027b80: 7465 7028 6375 7272 656e 745f 6964 2c20  tep(current_id, 
-00027b90: 7665 7274 6578 3d54 7275 6529 0a20 2020  vertex=True).   
-00027ba0: 2020 2020 2063 7572 7265 6e74 5f69 6420       current_id 
-00027bb0: 3d20 7374 6172 745f 6964 202b 2031 0a20  = start_id + 1. 
-00027bc0: 2020 2020 2020 2065 6e64 5f63 6f6e 7465         end_conte
-00027bd0: 6e74 2c20 656e 645f 6964 203d 2073 656c  nt, end_id = sel
-00027be0: 662e 656e 642e 746f 5f73 7465 7028 6375  f.end.to_step(cu
-00027bf0: 7272 656e 745f 6964 202b 2031 2c20 7665  rrent_id + 1, ve
-00027c00: 7274 6578 3d54 7275 6529 0a20 2020 2020  rtex=True).     
-00027c10: 2020 2063 6f6e 7465 6e74 202b 3d20 7374     content += st
-00027c20: 6172 745f 636f 6e74 656e 7420 2b20 656e  art_content + en
-00027c30: 645f 636f 6e74 656e 740a 2020 2020 2020  d_content.      
-00027c40: 2020 6375 7272 656e 745f 6964 203d 2065    current_id = e
-00027c50: 6e64 5f69 6420 2b20 310a 2020 2020 2020  nd_id + 1.      
-00027c60: 2020 636f 6e74 656e 7420 2b3d 2022 237b    content += "#{
-00027c70: 7d20 3d20 4544 4745 5f43 5552 5645 2827  } = EDGE_CURVE('
-00027c80: 7b7d 272c 237b 7d2c 237b 7d2c 237b 7d2c  {}',#{},#{},#{},
-00027c90: 2e54 2e29 3b5c 6e22 2e66 6f72 6d61 7428  .T.);\n".format(
-00027ca0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-00027cb0: 7265 6e74 5f69 642c 2073 656c 662e 6e61  rent_id, self.na
-00027cc0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00027cd0: 7374 6172 745f 6964 2c20 656e 645f 6964  start_id, end_id
-00027ce0: 2c20 6c69 6e65 5f69 6429 0a20 2020 2020  , line_id).     
-00027cf0: 2020 2072 6574 7572 6e20 636f 6e74 656e     return conten
-00027d00: 742c 205b 6375 7272 656e 745f 6964 5d0a  t, [current_id].
-00027d10: 0a0a 636c 6173 7320 4253 706c 696e 6543  ..class BSplineC
-00027d20: 7572 7665 3344 2842 5370 6c69 6e65 4375  urve3D(BSplineCu
-00027d30: 7276 6529 3a0a 2020 2020 2222 220a 2020  rve):.    """.  
-00027d40: 2020 4120 636c 6173 7320 666f 7220 3320    A class for 3 
-00027d50: 6469 6d65 6e73 696f 6e61 6c20 422d 7370  dimensional B-sp
-00027d60: 6c69 6e65 2063 7572 7665 732e 0a0a 2020  line curves...  
-00027d70: 2020 5468 6520 666f 6c6c 6f77 696e 6720    The following 
-00027d80: 7275 6c65 206d 7573 7420 6265 2072 6573  rule must be res
-00027d90: 7065 6374 6564 203a 2060 6e75 6d62 6572  pected : `number
-00027da0: 206f 6620 6b6e 6f74 7320 3d20 6e75 6d62   of knots = numb
-00027db0: 6572 206f 6620 636f 6e74 726f 6c20 706f  er of control po
-00027dc0: 696e 7473 202b 2064 6567 7265 6520 2b20  ints + degree + 
-00027dd0: 3160 0a0a 2020 2020 3a70 6172 616d 2064  1`..    :param d
-00027de0: 6567 7265 653a 2054 6865 2064 6567 7265  egree: The degre
-00027df0: 6520 6f66 2074 6865 2033 2064 696d 656e  e of the 3 dimen
-00027e00: 7369 6f6e 616c 2042 2d73 706c 696e 6520  sional B-spline 
-00027e10: 6375 7276 650a 2020 2020 3a74 7970 6520  curve.    :type 
-00027e20: 6465 6772 6565 3a20 696e 740a 2020 2020  degree: int.    
-00027e30: 3a70 6172 616d 2063 6f6e 7472 6f6c 5f70  :param control_p
-00027e40: 6f69 6e74 733a 2041 206c 6973 7420 6f66  oints: A list of
-00027e50: 2033 2064 696d 656e 7369 6f6e 616c 2070   3 dimensional p
-00027e60: 6f69 6e74 730a 2020 2020 3a74 7970 6520  oints.    :type 
-00027e70: 636f 6e74 726f 6c5f 706f 696e 7473 3a20  control_points: 
-00027e80: 4c69 7374 5b3a 636c 6173 733a 6076 6f6c  List[:class:`vol
-00027e90: 6d64 6c72 2e50 6f69 6e74 3344 605d 0a20  mdlr.Point3D`]. 
-00027ea0: 2020 203a 7061 7261 6d20 6b6e 6f74 5f6d     :param knot_m
-00027eb0: 756c 7469 706c 6963 6974 6965 733a 2054  ultiplicities: T
-00027ec0: 6865 2076 6563 746f 7220 6f66 206d 756c  he vector of mul
-00027ed0: 7469 706c 6963 6974 6965 7320 666f 7220  tiplicities for 
-00027ee0: 6561 6368 206b 6e6f 740a 2020 2020 3a74  each knot.    :t
-00027ef0: 7970 6520 6b6e 6f74 5f6d 756c 7469 706c  ype knot_multipl
-00027f00: 6963 6974 6965 733a 204c 6973 745b 696e  icities: List[in
-00027f10: 745d 0a20 2020 203a 7061 7261 6d20 6b6e  t].    :param kn
-00027f20: 6f74 733a 2054 6865 206b 6e6f 7420 7665  ots: The knot ve
-00027f30: 6374 6f72 2063 6f6d 706f 7365 6420 6f66  ctor composed of
-00027f40: 2076 616c 7565 7320 6265 7477 6565 6e20   values between 
-00027f50: 3020 616e 6420 310a 2020 2020 3a74 7970  0 and 1.    :typ
-00027f60: 6520 6b6e 6f74 733a 204c 6973 745b 666c  e knots: List[fl
-00027f70: 6f61 745d 0a20 2020 203a 7061 7261 6d20  oat].    :param 
-00027f80: 7765 6967 6874 733a 2054 6865 2077 6569  weights: The wei
-00027f90: 6768 7420 7665 6374 6f72 2061 7070 6c69  ght vector appli
-00027fa0: 6564 2074 6f20 7468 6520 6b6e 6f74 2076  ed to the knot v
-00027fb0: 6563 746f 722e 2044 6566 6175 6c74 0a20  ector. Default. 
-00027fc0: 2020 2020 2020 2076 616c 7565 2069 7320         value is 
-00027fd0: 4e6f 6e65 0a20 2020 203a 7479 7065 2077  None.    :type w
-00027fe0: 6569 6768 7473 3a20 4c69 7374 5b66 6c6f  eights: List[flo
-00027ff0: 6174 5d2c 206f 7074 696f 6e61 6c0a 2020  at], optional.  
-00028000: 2020 3a70 6172 616d 2070 6572 696f 6469    :param periodi
-00028010: 633a 2049 6620 6054 7275 6560 2074 6865  c: If `True` the
-00028020: 2042 2d73 706c 696e 6520 6375 7276 6520   B-spline curve 
-00028030: 6973 2070 6572 696f 6469 632e 2044 6566  is periodic. Def
-00028040: 6175 6c74 2076 616c 7565 0a20 2020 2020  ault value.     
-00028050: 2020 2069 7320 4661 6c73 650a 2020 2020     is False.    
-00028060: 3a74 7970 6520 7065 7269 6f64 6963 3a20  :type periodic: 
-00028070: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
-00028080: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
-00028090: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
-000280a0: 422d 7370 6c69 6e65 2063 7572 7665 2e20  B-spline curve. 
-000280b0: 4465 6661 756c 7420 7661 6c75 6520 6973  Default value is
-000280c0: 2027 270a 2020 2020 3a74 7970 6520 6e61   ''.    :type na
-000280d0: 6d65 3a20 7374 722c 206f 7074 696f 6e61  me: str, optiona
-000280e0: 6c0a 2020 2020 2222 220a 2020 2020 5f6e  l.    """.    _n
-000280f0: 6f6e 5f73 6572 6961 6c69 7a61 626c 655f  on_serializable_
-00028100: 6174 7472 6962 7574 6573 203d 205b 2763  attributes = ['c
-00028110: 7572 7665 275d 0a0a 2020 2020 6465 6620  urve']..    def 
-00028120: 5f5f 696e 6974 5f5f 2873 656c 662c 0a20  __init__(self,. 
-00028130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028140: 6465 6772 6565 3a20 696e 742c 0a20 2020  degree: int,.   
-00028150: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00028160: 6e74 726f 6c5f 706f 696e 7473 3a20 4c69  ntrol_points: Li
-00028170: 7374 5b76 6f6c 6d64 6c72 2e50 6f69 6e74  st[volmdlr.Point
-00028180: 3344 5d2c 0a20 2020 2020 2020 2020 2020  3D],.           
-00028190: 2020 2020 2020 6b6e 6f74 5f6d 756c 7469        knot_multi
-000281a0: 706c 6963 6974 6965 733a 204c 6973 745b  plicities: List[
-000281b0: 696e 745d 2c0a 2020 2020 2020 2020 2020  int],.          
-000281c0: 2020 2020 2020 206b 6e6f 7473 3a20 4c69         knots: Li
-000281d0: 7374 5b66 6c6f 6174 5d2c 0a20 2020 2020  st[float],.     
-000281e0: 2020 2020 2020 2020 2020 2020 7765 6967              weig
-000281f0: 6874 733a 204c 6973 745b 666c 6f61 745d  hts: List[float]
-00028200: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00028210: 2020 2020 2020 2020 2020 7065 7269 6f64            period
-00028220: 6963 3a20 626f 6f6c 203d 2046 616c 7365  ic: bool = False
-00028230: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00028240: 2020 206e 616d 653a 2073 7472 203d 2027     name: str = '
-00028250: 2729 3a0a 0a20 2020 2020 2020 2042 5370  '):..        BSp
-00028260: 6c69 6e65 4375 7276 652e 5f5f 696e 6974  lineCurve.__init
-00028270: 5f5f 2873 656c 662c 2064 6567 7265 652c  __(self, degree,
-00028280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028290: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000282a0: 6f6e 7472 6f6c 5f70 6f69 6e74 732c 0a20  ontrol_points,. 
-000282b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000282c0: 2020 2020 2020 2020 2020 2020 206b 6e6f               kno
-000282d0: 745f 6d75 6c74 6970 6c69 6369 7469 6573  t_multiplicities
-000282e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000282f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028300: 6b6e 6f74 732c 0a20 2020 2020 2020 2020  knots,.         
-00028310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028320: 2020 2020 2077 6569 6768 7473 2c0a 2020       weights,.  
-00028330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028340: 2020 2020 2020 2020 2020 2020 7065 7269              peri
-00028350: 6f64 6963 2c0a 2020 2020 2020 2020 2020  odic,.          
-00028360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028370: 2020 2020 6e61 6d65 290a 0a20 2020 2020      name)..     
-00028380: 2020 2073 656c 662e 5f62 626f 7820 3d20     self._bbox = 
-00028390: 4e6f 6e65 0a0a 2020 2020 4070 726f 7065  None..    @prope
-000283a0: 7274 790a 2020 2020 6465 6620 626f 756e  rty.    def boun
-000283b0: 6469 6e67 5f62 6f78 2873 656c 6629 3a0a  ding_box(self):.
-000283c0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-000283d0: 656c 662e 5f62 626f 783a 0a20 2020 2020  elf._bbox:.     
-000283e0: 2020 2020 2020 2073 656c 662e 5f62 626f         self._bbo
-000283f0: 7820 3d20 7365 6c66 2e5f 626f 756e 6469  x = self._boundi
-00028400: 6e67 5f62 6f78 2829 0a20 2020 2020 2020  ng_box().       
-00028410: 2072 6574 7572 6e20 7365 6c66 2e5f 6262   return self._bb
-00028420: 6f78 0a0a 2020 2020 4062 6f75 6e64 696e  ox..    @boundin
-00028430: 675f 626f 782e 7365 7474 6572 0a20 2020  g_box.setter.   
-00028440: 2064 6566 2062 6f75 6e64 696e 675f 626f   def bounding_bo
-00028450: 7828 7365 6c66 2c20 6e65 775f 626f 756e  x(self, new_boun
-00028460: 6469 6e67 5f62 6f78 293a 0a20 2020 2020  ding_box):.     
-00028470: 2020 2073 656c 662e 5f62 626f 7820 3d20     self._bbox = 
-00028480: 6e65 775f 626f 756e 6469 6e67 5f62 6f78  new_bounding_box
-00028490: 0a0a 2020 2020 6465 6620 5f62 6f75 6e64  ..    def _bound
-000284a0: 696e 675f 626f 7828 7365 6c66 293a 0a20  ing_box(self):. 
-000284b0: 2020 2020 2020 2062 626f 7820 3d20 7365         bbox = se
-000284c0: 6c66 2e63 7572 7665 2e62 626f 780a 2020  lf.curve.bbox.  
-000284d0: 2020 2020 2020 7265 7475 726e 2076 6f6c        return vol
-000284e0: 6d64 6c72 2e63 6f72 652e 426f 756e 6469  mdlr.core.Boundi
-000284f0: 6e67 426f 7828 6262 6f78 5b30 5d5b 305d  ngBox(bbox[0][0]
-00028500: 2c20 6262 6f78 5b31 5d5b 305d 2c0a 2020  , bbox[1][0],.  
+00027a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027a60: 2020 2020 2020 2020 2073 656d 695f 616e           semi_an
+00027a70: 676c 6529 0a20 2020 2020 2020 2020 2020  gle).           
+00027a80: 207a 3120 3d20 6431 202f 206d 6174 682e   z1 = d1 / math.
+00027a90: 7461 6e28 7365 6d69 5f61 6e67 6c65 290a  tan(semi_angle).
+00027aa0: 2020 2020 2020 2020 2020 2020 7a32 203d              z2 =
+00027ab0: 2064 3220 2f20 6d61 7468 2e74 616e 2873   d2 / math.tan(s
+00027ac0: 656d 695f 616e 676c 6529 0a20 2020 2020  emi_angle).     
+00027ad0: 2020 2020 2020 2072 6574 7572 6e20 5b73         return [s
+00027ae0: 7572 6661 6365 2e72 6563 7461 6e67 756c  urface.rectangul
+00027af0: 6172 5f63 7574 2830 2c20 616e 676c 6532  ar_cut(0, angle2
+00027b00: 2c20 7a31 2c20 7a32 295d 0a20 2020 2020  , z1, z2)].     
+00027b10: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00027b20: 2020 2020 2023 2043 796c 696e 6472 6963       # Cylindric
+00027b30: 616c 2066 6163 650a 2020 2020 2020 2020  al face.        
+00027b40: 2020 2020 7620 3d20 6178 6973 2e63 726f      v = axis.cro
+00027b50: 7373 2875 290a 2020 2020 2020 2020 2020  ss(u).          
+00027b60: 2020 7375 7266 6163 6520 3d20 766f 6c6d    surface = volm
+00027b70: 646c 722e 6661 6365 732e 4379 6c69 6e64  dlr.faces.Cylind
+00027b80: 7269 6361 6c53 7572 6661 6365 3344 280a  ricalSurface3D(.
+00027b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027ba0: 766f 6c6d 646c 722e 4672 616d 6533 4428  volmdlr.Frame3D(
+00027bb0: 7031 5f70 726f 6a2c 2075 2c20 762c 2061  p1_proj, u, v, a
+00027bc0: 7869 7329 2c20 6431 290a 2020 2020 2020  xis), d1).      
+00027bd0: 2020 2020 2020 7265 7475 726e 205b 7375        return [su
+00027be0: 7266 6163 652e 7265 6374 616e 6775 6c61  rface.rectangula
+00027bf0: 725f 6375 7428 302c 2061 6e67 6c65 2c0a  r_cut(0, angle,.
+00027c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c20: 2020 2020 2020 2020 2020 2020 302c 0a20              0,. 
+00027c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c50: 2020 2020 2020 2020 2020 2028 7365 6c66             (self
+00027c60: 2e65 6e64 202d 2073 656c 662e 7374 6172  .end - self.star
+00027c70: 7429 2e64 6f74 2861 7869 7329 295d 0a0a  t).dot(axis))]..
+00027c80: 2020 2020 6465 6620 746f 5f73 7465 7028      def to_step(
+00027c90: 7365 6c66 2c20 6375 7272 656e 745f 6964  self, current_id
+00027ca0: 2c20 7375 7266 6163 655f 6964 3d4e 6f6e  , surface_id=Non
+00027cb0: 6529 3a0a 2020 2020 2020 2020 2222 2245  e):.        """E
+00027cc0: 7870 6f72 7473 2074 6f20 5354 4550 2066  xports to STEP f
+00027cd0: 6f72 6d61 742e 2222 220a 2020 2020 2020  ormat.""".      
+00027ce0: 2020 6c69 6e65 203d 2073 656c 662e 746f    line = self.to
+00027cf0: 5f6c 696e 6528 290a 2020 2020 2020 2020  _line().        
+00027d00: 636f 6e74 656e 742c 206c 696e 655f 6964  content, line_id
+00027d10: 203d 206c 696e 652e 746f 5f73 7465 7028   = line.to_step(
+00027d20: 6375 7272 656e 745f 6964 290a 2020 2020  current_id).    
+00027d30: 2020 2020 6375 7272 656e 745f 6964 203d      current_id =
+00027d40: 206c 696e 655f 6964 202b 2031 0a20 2020   line_id + 1.   
+00027d50: 2020 2020 2073 7461 7274 5f63 6f6e 7465       start_conte
+00027d60: 6e74 2c20 7374 6172 745f 6964 203d 2073  nt, start_id = s
+00027d70: 656c 662e 7374 6172 742e 746f 5f73 7465  elf.start.to_ste
+00027d80: 7028 6375 7272 656e 745f 6964 2c20 7665  p(current_id, ve
+00027d90: 7274 6578 3d54 7275 6529 0a20 2020 2020  rtex=True).     
+00027da0: 2020 2063 7572 7265 6e74 5f69 6420 3d20     current_id = 
+00027db0: 7374 6172 745f 6964 202b 2031 0a20 2020  start_id + 1.   
+00027dc0: 2020 2020 2065 6e64 5f63 6f6e 7465 6e74       end_content
+00027dd0: 2c20 656e 645f 6964 203d 2073 656c 662e  , end_id = self.
+00027de0: 656e 642e 746f 5f73 7465 7028 6375 7272  end.to_step(curr
+00027df0: 656e 745f 6964 202b 2031 2c20 7665 7274  ent_id + 1, vert
+00027e00: 6578 3d54 7275 6529 0a20 2020 2020 2020  ex=True).       
+00027e10: 2063 6f6e 7465 6e74 202b 3d20 7374 6172   content += star
+00027e20: 745f 636f 6e74 656e 7420 2b20 656e 645f  t_content + end_
+00027e30: 636f 6e74 656e 740a 2020 2020 2020 2020  content.        
+00027e40: 6375 7272 656e 745f 6964 203d 2065 6e64  current_id = end
+00027e50: 5f69 6420 2b20 310a 2020 2020 2020 2020  _id + 1.        
+00027e60: 636f 6e74 656e 7420 2b3d 2022 237b 7d20  content += "#{} 
+00027e70: 3d20 4544 4745 5f43 5552 5645 2827 7b7d  = EDGE_CURVE('{}
+00027e80: 272c 237b 7d2c 237b 7d2c 237b 7d2c 2e54  ',#{},#{},#{},.T
+00027e90: 2e29 3b5c 6e22 2e66 6f72 6d61 7428 0a20  .);\n".format(. 
+00027ea0: 2020 2020 2020 2020 2020 2063 7572 7265             curre
+00027eb0: 6e74 5f69 642c 2073 656c 662e 6e61 6d65  nt_id, self.name
+00027ec0: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+00027ed0: 6172 745f 6964 2c20 656e 645f 6964 2c20  art_id, end_id, 
+00027ee0: 6c69 6e65 5f69 6429 0a20 2020 2020 2020  line_id).       
+00027ef0: 2072 6574 7572 6e20 636f 6e74 656e 742c   return content,
+00027f00: 205b 6375 7272 656e 745f 6964 5d0a 0a0a   [current_id]...
+00027f10: 636c 6173 7320 4253 706c 696e 6543 7572  class BSplineCur
+00027f20: 7665 3344 2842 5370 6c69 6e65 4375 7276  ve3D(BSplineCurv
+00027f30: 6529 3a0a 2020 2020 2222 220a 2020 2020  e):.    """.    
+00027f40: 4120 636c 6173 7320 666f 7220 3320 6469  A class for 3 di
+00027f50: 6d65 6e73 696f 6e61 6c20 422d 7370 6c69  mensional B-spli
+00027f60: 6e65 2063 7572 7665 732e 0a0a 2020 2020  ne curves...    
+00027f70: 5468 6520 666f 6c6c 6f77 696e 6720 7275  The following ru
+00027f80: 6c65 206d 7573 7420 6265 2072 6573 7065  le must be respe
+00027f90: 6374 6564 203a 2060 6e75 6d62 6572 206f  cted : `number o
+00027fa0: 6620 6b6e 6f74 7320 3d20 6e75 6d62 6572  f knots = number
+00027fb0: 206f 6620 636f 6e74 726f 6c20 706f 696e   of control poin
+00027fc0: 7473 202b 2064 6567 7265 6520 2b20 3160  ts + degree + 1`
+00027fd0: 0a0a 2020 2020 3a70 6172 616d 2064 6567  ..    :param deg
+00027fe0: 7265 653a 2054 6865 2064 6567 7265 6520  ree: The degree 
+00027ff0: 6f66 2074 6865 2033 2064 696d 656e 7369  of the 3 dimensi
+00028000: 6f6e 616c 2042 2d73 706c 696e 6520 6375  onal B-spline cu
+00028010: 7276 650a 2020 2020 3a74 7970 6520 6465  rve.    :type de
+00028020: 6772 6565 3a20 696e 740a 2020 2020 3a70  gree: int.    :p
+00028030: 6172 616d 2063 6f6e 7472 6f6c 5f70 6f69  aram control_poi
+00028040: 6e74 733a 2041 206c 6973 7420 6f66 2033  nts: A list of 3
+00028050: 2064 696d 656e 7369 6f6e 616c 2070 6f69   dimensional poi
+00028060: 6e74 730a 2020 2020 3a74 7970 6520 636f  nts.    :type co
+00028070: 6e74 726f 6c5f 706f 696e 7473 3a20 4c69  ntrol_points: Li
+00028080: 7374 5b3a 636c 6173 733a 6076 6f6c 6d64  st[:class:`volmd
+00028090: 6c72 2e50 6f69 6e74 3344 605d 0a20 2020  lr.Point3D`].   
+000280a0: 203a 7061 7261 6d20 6b6e 6f74 5f6d 756c   :param knot_mul
+000280b0: 7469 706c 6963 6974 6965 733a 2054 6865  tiplicities: The
+000280c0: 2076 6563 746f 7220 6f66 206d 756c 7469   vector of multi
+000280d0: 706c 6963 6974 6965 7320 666f 7220 6561  plicities for ea
+000280e0: 6368 206b 6e6f 740a 2020 2020 3a74 7970  ch knot.    :typ
+000280f0: 6520 6b6e 6f74 5f6d 756c 7469 706c 6963  e knot_multiplic
+00028100: 6974 6965 733a 204c 6973 745b 696e 745d  ities: List[int]
+00028110: 0a20 2020 203a 7061 7261 6d20 6b6e 6f74  .    :param knot
+00028120: 733a 2054 6865 206b 6e6f 7420 7665 6374  s: The knot vect
+00028130: 6f72 2063 6f6d 706f 7365 6420 6f66 2076  or composed of v
+00028140: 616c 7565 7320 6265 7477 6565 6e20 3020  alues between 0 
+00028150: 616e 6420 310a 2020 2020 3a74 7970 6520  and 1.    :type 
+00028160: 6b6e 6f74 733a 204c 6973 745b 666c 6f61  knots: List[floa
+00028170: 745d 0a20 2020 203a 7061 7261 6d20 7765  t].    :param we
+00028180: 6967 6874 733a 2054 6865 2077 6569 6768  ights: The weigh
+00028190: 7420 7665 6374 6f72 2061 7070 6c69 6564  t vector applied
+000281a0: 2074 6f20 7468 6520 6b6e 6f74 2076 6563   to the knot vec
+000281b0: 746f 722e 2044 6566 6175 6c74 0a20 2020  tor. Default.   
+000281c0: 2020 2020 2076 616c 7565 2069 7320 4e6f       value is No
+000281d0: 6e65 0a20 2020 203a 7479 7065 2077 6569  ne.    :type wei
+000281e0: 6768 7473 3a20 4c69 7374 5b66 6c6f 6174  ghts: List[float
+000281f0: 5d2c 206f 7074 696f 6e61 6c0a 2020 2020  ], optional.    
+00028200: 3a70 6172 616d 2070 6572 696f 6469 633a  :param periodic:
+00028210: 2049 6620 6054 7275 6560 2074 6865 2042   If `True` the B
+00028220: 2d73 706c 696e 6520 6375 7276 6520 6973  -spline curve is
+00028230: 2070 6572 696f 6469 632e 2044 6566 6175   periodic. Defau
+00028240: 6c74 2076 616c 7565 0a20 2020 2020 2020  lt value.       
+00028250: 2069 7320 4661 6c73 650a 2020 2020 3a74   is False.    :t
+00028260: 7970 6520 7065 7269 6f64 6963 3a20 626f  ype periodic: bo
+00028270: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
+00028280: 203a 7061 7261 6d20 6e61 6d65 3a20 5468   :param name: Th
+00028290: 6520 6e61 6d65 206f 6620 7468 6520 422d  e name of the B-
+000282a0: 7370 6c69 6e65 2063 7572 7665 2e20 4465  spline curve. De
+000282b0: 6661 756c 7420 7661 6c75 6520 6973 2027  fault value is '
+000282c0: 270a 2020 2020 3a74 7970 6520 6e61 6d65  '.    :type name
+000282d0: 3a20 7374 722c 206f 7074 696f 6e61 6c0a  : str, optional.
+000282e0: 2020 2020 2222 220a 2020 2020 5f6e 6f6e      """.    _non
+000282f0: 5f73 6572 6961 6c69 7a61 626c 655f 6174  _serializable_at
+00028300: 7472 6962 7574 6573 203d 205b 2763 7572  tributes = ['cur
+00028310: 7665 275d 0a0a 2020 2020 6465 6620 5f5f  ve']..    def __
+00028320: 696e 6974 5f5f 2873 656c 662c 0a20 2020  init__(self,.   
+00028330: 2020 2020 2020 2020 2020 2020 2020 6465                de
+00028340: 6772 6565 3a20 696e 742c 0a20 2020 2020  gree: int,.     
+00028350: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+00028360: 726f 6c5f 706f 696e 7473 3a20 4c69 7374  rol_points: List
+00028370: 5b76 6f6c 6d64 6c72 2e50 6f69 6e74 3344  [volmdlr.Point3D
+00028380: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00028390: 2020 2020 6b6e 6f74 5f6d 756c 7469 706c      knot_multipl
+000283a0: 6963 6974 6965 733a 204c 6973 745b 696e  icities: List[in
+000283b0: 745d 2c0a 2020 2020 2020 2020 2020 2020  t],.            
+000283c0: 2020 2020 206b 6e6f 7473 3a20 4c69 7374       knots: List
+000283d0: 5b66 6c6f 6174 5d2c 0a20 2020 2020 2020  [float],.       
+000283e0: 2020 2020 2020 2020 2020 7765 6967 6874            weight
+000283f0: 733a 204c 6973 745b 666c 6f61 745d 203d  s: List[float] =
+00028400: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+00028410: 2020 2020 2020 2020 7065 7269 6f64 6963          periodic
+00028420: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+00028430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028440: 206e 616d 653a 2073 7472 203d 2027 2729   name: str = '')
+00028450: 3a0a 0a20 2020 2020 2020 2042 5370 6c69  :..        BSpli
+00028460: 6e65 4375 7276 652e 5f5f 696e 6974 5f5f  neCurve.__init__
+00028470: 2873 656c 662c 2064 6567 7265 652c 0a20  (self, degree,. 
+00028480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028490: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+000284a0: 7472 6f6c 5f70 6f69 6e74 732c 0a20 2020  trol_points,.   
+000284b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000284c0: 2020 2020 2020 2020 2020 206b 6e6f 745f             knot_
+000284d0: 6d75 6c74 6970 6c69 6369 7469 6573 2c0a  multiplicities,.
+000284e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000284f0: 2020 2020 2020 2020 2020 2020 2020 6b6e                kn
+00028500: 6f74 732c 0a20 2020 2020 2020 2020 2020  ots,.           
 00028510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028530: 2020 2020 2020 6262 6f78 5b30 5d5b 315d        bbox[0][1]
-00028540: 2c20 6262 6f78 5b31 5d5b 315d 2c0a 2020  , bbox[1][1],.  
-00028550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028520: 2020 2077 6569 6768 7473 2c0a 2020 2020     weights,.    
+00028530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028540: 2020 2020 2020 2020 2020 7065 7269 6f64            period
+00028550: 6963 2c0a 2020 2020 2020 2020 2020 2020  ic,.            
 00028560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028570: 2020 2020 2020 6262 6f78 5b30 5d5b 325d        bbox[0][2]
-00028580: 2c20 6262 6f78 5b31 5d5b 325d 290a 0a20  , bbox[1][2]).. 
-00028590: 2020 2064 6566 206c 6f6f 6b5f 7570 5f74     def look_up_t
-000285a0: 6162 6c65 2873 656c 662c 2072 6573 6f6c  able(self, resol
-000285b0: 7574 696f 6e3a 2069 6e74 203d 2032 302c  ution: int = 20,
-000285c0: 2073 7461 7274 5f70 6172 616d 6574 6572   start_parameter
-000285d0: 3a20 666c 6f61 7420 3d20 302c 0a20 2020  : float = 0,.   
-000285e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000285f0: 2020 2065 6e64 5f70 6172 616d 6574 6572     end_parameter
-00028600: 3a20 666c 6f61 7420 3d20 3129 3a0a 2020  : float = 1):.  
-00028610: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00028620: 2020 4372 6561 7465 7320 6120 7461 626c    Creates a tabl
-00028630: 6520 6f66 2065 7175 6976 616c 656e 6365  e of equivalence
-00028640: 2062 6574 7765 656e 2074 6865 2070 6172   between the par
-00028650: 616d 6574 6572 2074 2028 6576 616c 2e20  ameter t (eval. 
-00028660: 6f66 2074 6865 2042 5370 6c69 6e65 4375  of the BSplineCu
-00028670: 7276 6529 2061 6e64 2074 6865 2063 756d  rve) and the cum
-00028680: 756c 6174 6976 6520 6469 7374 616e 6365  ulative distance
-00028690: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-000286a0: 6d20 7265 736f 6c75 7469 6f6e 3a20 5468  m resolution: Th
-000286b0: 6520 7072 6563 6973 696f 6e20 6f66 2074  e precision of t
-000286c0: 6865 2074 6162 6c65 2e20 4175 746f 6164  he table. Autoad
-000286d0: 6a75 7374 6564 2062 7920 7468 650a 2020  justed by the.  
-000286e0: 2020 2020 2020 2020 2020 616c 676f 7269            algori
-000286f0: 7468 6d2e 2044 6566 6175 6c74 2076 616c  thm. Default val
-00028700: 7565 2073 6574 2074 6f20 3230 0a20 2020  ue set to 20.   
-00028710: 2020 2020 203a 7479 7065 2072 6573 6f6c       :type resol
-00028720: 7574 696f 6e3a 2069 6e74 2c20 6f70 7469  ution: int, opti
-00028730: 6f6e 616c 0a20 2020 2020 2020 203a 7061  onal.        :pa
-00028740: 7261 6d20 7374 6172 745f 7061 7261 6d65  ram start_parame
-00028750: 7465 723a 2046 6972 7374 2070 6172 616d  ter: First param
-00028760: 6574 6572 2065 7661 6c75 6174 6564 2069  eter evaluated i
-00028770: 6e20 7468 6520 7461 626c 652e 0a20 2020  n the table..   
-00028780: 2020 2020 2020 2020 2044 6566 6175 6c74           Default
-00028790: 2076 616c 7565 2073 6574 2074 6f20 300a   value set to 0.
-000287a0: 2020 2020 2020 2020 3a74 7970 6520 7374          :type st
-000287b0: 6172 745f 7061 7261 6d65 7465 723a 2066  art_parameter: f
-000287c0: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
-000287d0: 2020 2020 2020 203a 7061 7261 6d20 656e         :param en
-000287e0: 645f 7061 7261 6d65 7465 723a 204c 6173  d_parameter: Las
-000287f0: 7420 7061 7261 6d65 7465 7220 6576 616c  t parameter eval
-00028800: 7561 7465 6420 696e 2074 6865 2074 6162  uated in the tab
-00028810: 6c65 2e0a 2020 2020 2020 2020 2020 2020  le..            
-00028820: 4465 6661 756c 7420 7661 6c75 6520 7365  Default value se
-00028830: 7420 746f 2031 0a20 2020 2020 2020 203a  t to 1.        :
-00028840: 7479 7065 2073 7461 7274 5f70 6172 616d  type start_param
-00028850: 6574 6572 3a20 666c 6f61 742c 206f 7074  eter: float, opt
-00028860: 696f 6e61 6c0a 2020 2020 2020 2020 3a72  ional.        :r
-00028870: 6574 7572 6e3a 2059 6965 6c64 7320 6120  eturn: Yields a 
-00028880: 6c69 7374 206f 6620 7475 706c 6573 2063  list of tuples c
-00028890: 6f6e 7461 696e 696e 6720 7468 6520 7061  ontaining the pa
-000288a0: 7261 6d65 7465 7220 616e 6420 7468 650a  rameter and the.
-000288b0: 2020 2020 2020 2020 2020 2020 6375 6d75              cumu
-000288c0: 6c61 7465 6420 6469 7374 616e 6365 2061  lated distance a
-000288d0: 6c6f 6e67 2074 6865 2042 5370 6c69 6e65  long the BSpline
-000288e0: 4372 7576 6533 4420 6672 6f6d 2074 6865  Cruve3D from the
-000288f0: 2065 7661 6c75 6174 696f 6e20 6f66 0a20   evaluation of. 
-00028900: 2020 2020 2020 2020 2020 2073 7461 7274             start
-00028910: 5f70 6172 616d 6574 6572 0a20 2020 2020  _parameter.     
-00028920: 2020 203a 7274 7970 653a 2054 7570 6c65     :rtype: Tuple
-00028930: 5b66 6c6f 6174 2c20 666c 6f61 745d 0a20  [float, float]. 
-00028940: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00028950: 2020 2072 6573 6f6c 7574 696f 6e20 3d20     resolution = 
-00028960: 6d61 7828 3130 2c20 6d69 6e28 7265 736f  max(10, min(reso
-00028970: 6c75 7469 6f6e 2c20 696e 7428 7365 6c66  lution, int(self
-00028980: 2e6c 656e 6774 6828 2920 2f20 3165 2d34  .length() / 1e-4
-00028990: 2929 290a 2020 2020 2020 2020 6465 6c74  ))).        delt
-000289a0: 615f 7061 7261 6d20 3d20 3120 2f20 7265  a_param = 1 / re
-000289b0: 736f 6c75 7469 6f6e 202a 2028 656e 645f  solution * (end_
-000289c0: 7061 7261 6d65 7465 7220 2d20 7374 6172  parameter - star
-000289d0: 745f 7061 7261 6d65 7465 7229 0a20 2020  t_parameter).   
-000289e0: 2020 2020 2064 6973 7461 6e63 6520 3d20       distance = 
-000289f0: 300a 2020 2020 2020 2020 666f 7220 6920  0.        for i 
-00028a00: 696e 2072 616e 6765 2872 6573 6f6c 7574  in range(resolut
-00028a10: 696f 6e20 2b20 3129 3a0a 2020 2020 2020  ion + 1):.      
-00028a20: 2020 2020 2020 6966 2069 203d 3d20 303a        if i == 0:
-00028a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028a40: 2079 6965 6c64 2073 7461 7274 5f70 6172   yield start_par
-00028a50: 616d 6574 6572 2c20 300a 2020 2020 2020  ameter, 0.      
-00028a60: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00028a70: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00028a80: 6d31 203d 2073 7461 7274 5f70 6172 616d  m1 = start_param
-00028a90: 6574 6572 202b 2028 6920 2d20 3129 202a  eter + (i - 1) *
-00028aa0: 2064 656c 7461 5f70 6172 616d 0a20 2020   delta_param.   
-00028ab0: 2020 2020 2020 2020 2020 2020 2070 6172               par
-00028ac0: 616d 3220 3d20 7374 6172 745f 7061 7261  am2 = start_para
-00028ad0: 6d65 7465 7220 2b20 6920 2a20 6465 6c74  meter + i * delt
-00028ae0: 615f 7061 7261 6d0a 2020 2020 2020 2020  a_param.        
-00028af0: 2020 2020 2020 2020 706f 696e 7431 203d          point1 =
-00028b00: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3344   volmdlr.Point3D
-00028b10: 282a 7365 6c66 2e63 7572 7665 2e65 7661  (*self.curve.eva
-00028b20: 6c75 6174 655f 7369 6e67 6c65 2870 6172  luate_single(par
-00028b30: 616d 3129 290a 2020 2020 2020 2020 2020  am1)).          
-00028b40: 2020 2020 2020 706f 696e 7432 203d 2076        point2 = v
-00028b50: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 282a  olmdlr.Point3D(*
-00028b60: 7365 6c66 2e63 7572 7665 2e65 7661 6c75  self.curve.evalu
-00028b70: 6174 655f 7369 6e67 6c65 2870 6172 616d  ate_single(param
-00028b80: 3229 290a 2020 2020 2020 2020 2020 2020  2)).            
-00028b90: 2020 2020 6469 7374 616e 6365 202b 3d20      distance += 
-00028ba0: 706f 696e 7431 2e70 6f69 6e74 5f64 6973  point1.point_dis
-00028bb0: 7461 6e63 6528 706f 696e 7432 290a 2020  tance(point2).  
-00028bc0: 2020 2020 2020 2020 2020 2020 2020 7969                yi
-00028bd0: 656c 6420 7061 7261 6d32 2c20 6469 7374  eld param2, dist
-00028be0: 616e 6365 0a0a 2020 2020 6465 6620 706f  ance..    def po
-00028bf0: 696e 745f 6174 5f61 6273 6369 7373 6128  int_at_abscissa(
-00028c00: 7365 6c66 2c20 6162 7363 6973 7361 3a20  self, abscissa: 
-00028c10: 666c 6f61 742c 2072 6573 6f6c 7574 696f  float, resolutio
-00028c20: 6e3a 2069 6e74 203d 2031 3030 3029 3a0a  n: int = 1000):.
-00028c30: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00028c40: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
-00028c50: 3320 6469 6d65 6e73 696f 6e61 6c20 706f  3 dimensional po
-00028c60: 696e 7420 6174 2061 2067 6976 656e 2063  int at a given c
-00028c70: 7572 7669 6c69 6e65 6172 2061 6273 6369  urvilinear absci
-00028c80: 7373 612e 0a0a 2020 2020 2020 2020 5468  ssa...        Th
-00028c90: 6973 2069 7320 616e 2061 7070 726f 7869  is is an approxi
-00028ca0: 6d61 7469 6f6e 2e20 5265 736f 6c75 7469  mation. Resoluti
-00028cb0: 6f6e 2070 6172 616d 6574 6572 2063 616e  on parameter can
-00028cc0: 2062 6520 696e 6372 6561 7365 640a 2020   be increased.  
-00028cd0: 2020 2020 2020 666f 7220 6d6f 7265 2061        for more a
-00028ce0: 6363 7572 6174 6520 7265 7375 6c74 2e0a  ccurate result..
-00028cf0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00028d00: 6162 7363 6973 7361 3a20 5468 6520 6469  abscissa: The di
-00028d10: 7374 616e 6365 206f 6e20 7468 6520 4253  stance on the BS
-00028d20: 706c 696e 6543 7572 7665 3344 2066 726f  plineCurve3D fro
-00028d30: 6d20 6974 7320 7374 6172 740a 2020 2020  m its start.    
-00028d40: 2020 2020 3a74 7970 6520 6162 7363 6973      :type abscis
-00028d50: 7361 3a20 666c 6f61 740a 2020 2020 2020  sa: float.      
-00028d60: 2020 3a70 6172 616d 2072 6573 6f6c 7574    :param resolut
-00028d70: 696f 6e3a 2054 6865 2070 7265 6369 7369  ion: The precisi
-00028d80: 6f6e 206f 6620 7468 6520 6170 7072 6f78  on of the approx
-00028d90: 696d 6174 696f 6e2e 2044 6566 6175 6c74  imation. Default
-00028da0: 2076 616c 7565 0a20 2020 2020 2020 2020   value.         
-00028db0: 2020 2073 6574 2074 6f20 3130 3030 0a20     set to 1000. 
-00028dc0: 2020 2020 2020 203a 7479 7065 2072 6573         :type res
-00028dd0: 6f6c 7574 696f 6e3a 2069 6e74 2c20 6f70  olution: int, op
-00028de0: 7469 6f6e 616c 0a20 2020 2020 2020 203a  tional.        :
-00028df0: 7265 7475 726e 3a20 5468 6520 506f 696e  return: The Poin
-00028e00: 7433 4420 6174 2074 6865 2067 6976 656e  t3D at the given
-00028e10: 2063 7572 7669 6c69 6e65 6172 2061 6273   curvilinear abs
-00028e20: 6369 7373 612e 0a20 2020 2020 2020 203a  cissa..        :
-00028e30: 7274 7970 653a 203a 636c 6173 733a 6076  rtype: :class:`v
-00028e40: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 600a  olmdlr.Point3D`.
-00028e50: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00028e60: 2020 2020 6966 206d 6174 682e 6973 636c      if math.iscl
-00028e70: 6f73 6528 6162 7363 6973 7361 2c20 302c  ose(abscissa, 0,
-00028e80: 2061 6273 5f74 6f6c 3d31 652d 3130 293a   abs_tol=1e-10):
-00028e90: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00028ea0: 7572 6e20 7365 6c66 2e73 7461 7274 0a20  urn self.start. 
-00028eb0: 2020 2020 2020 2069 6620 6d61 7468 2e69         if math.i
-00028ec0: 7363 6c6f 7365 2861 6273 6369 7373 612c  sclose(abscissa,
-00028ed0: 2073 656c 662e 6c65 6e67 7468 2829 2c20   self.length(), 
-00028ee0: 6162 735f 746f 6c3d 3165 2d31 3029 3a0a  abs_tol=1e-10):.
-00028ef0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00028f00: 726e 2073 656c 662e 656e 640a 2020 2020  rn self.end.    
-00028f10: 2020 2020 6c75 7420 3d20 7365 6c66 2e6c      lut = self.l
-00028f20: 6f6f 6b5f 7570 5f74 6162 6c65 2872 6573  ook_up_table(res
-00028f30: 6f6c 7574 696f 6e3d 7265 736f 6c75 7469  olution=resoluti
-00028f40: 6f6e 290a 2020 2020 2020 2020 6966 2030  on).        if 0
-00028f50: 203c 2061 6273 6369 7373 6120 3c20 7365   < abscissa < se
-00028f60: 6c66 2e6c 656e 6774 6828 293a 0a20 2020  lf.length():.   
-00028f70: 2020 2020 2020 2020 206c 6173 745f 7061           last_pa
-00028f80: 7261 6d20 3d20 300a 2020 2020 2020 2020  ram = 0.        
-00028f90: 2020 2020 666f 7220 742c 2064 6973 7420      for t, dist 
-00028fa0: 696e 206c 7574 3a0a 2020 2020 2020 2020  in lut:.        
-00028fb0: 2020 2020 2020 2020 6966 2061 6273 6369          if absci
-00028fc0: 7373 6120 3c20 6469 7374 3a0a 2020 2020  ssa < dist:.    
-00028fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028fe0: 7431 203d 206c 6173 745f 7061 7261 6d0a  t1 = last_param.
-00028ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029000: 2020 2020 7432 203d 2074 0a20 2020 2020      t2 = t.     
-00029010: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00029020: 6574 7572 6e20 766f 6c6d 646c 722e 506f  eturn volmdlr.Po
-00029030: 696e 7433 4428 0a20 2020 2020 2020 2020  int3D(.         
-00029040: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-00029050: 7365 6c66 2e63 7572 7665 2e65 7661 6c75  self.curve.evalu
-00029060: 6174 655f 7369 6e67 6c65 2828 7431 202b  ate_single((t1 +
-00029070: 2074 3229 202f 2032 2929 0a20 2020 2020   t2) / 2)).     
-00029080: 2020 2020 2020 2020 2020 206c 6173 745f             last_
-00029090: 7061 7261 6d20 3d20 740a 2020 2020 2020  param = t.      
-000290a0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000290b0: 6f72 2827 4375 7276 696c 696e 6561 7220  or('Curvilinear 
-000290c0: 6162 7363 6973 7361 2069 7320 6269 6767  abscissa is bigg
-000290d0: 6572 2074 6861 6e20 6c65 6e67 7468 2c27  er than length,'
-000290e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000290f0: 2020 2020 2020 2020 2020 2720 6f72 206e            ' or n
-00029100: 6567 6174 6976 6527 290a 0a20 2020 2064  egative')..    d
-00029110: 6566 206e 6f72 6d61 6c28 7365 6c66 2c20  ef normal(self, 
-00029120: 706f 7369 7469 6f6e 3a20 666c 6f61 7420  position: float 
-00029130: 3d20 302e 3029 3a0a 2020 2020 2020 2020  = 0.0):.        
-00029140: 5f2c 206e 6f72 6d61 6c20 3d20 6f70 6572  _, normal = oper
-00029150: 6174 696f 6e73 2e6e 6f72 6d61 6c28 7365  ations.normal(se
-00029160: 6c66 2e63 7572 7665 2c20 706f 7369 7469  lf.curve, positi
-00029170: 6f6e 2c20 6e6f 726d 616c 697a 653d 5472  on, normalize=Tr
-00029180: 7565 290a 2020 2020 2020 2020 6e6f 726d  ue).        norm
-00029190: 616c 203d 2076 6f6c 6d64 6c72 2e50 6f69  al = volmdlr.Poi
-000291a0: 6e74 3344 286e 6f72 6d61 6c5b 305d 2c20  nt3D(normal[0], 
-000291b0: 6e6f 726d 616c 5b31 5d2c 206e 6f72 6d61  normal[1], norma
-000291c0: 6c5b 325d 290a 2020 2020 2020 2020 7265  l[2]).        re
-000291d0: 7475 726e 206e 6f72 6d61 6c0a 0a20 2020  turn normal..   
-000291e0: 2064 6566 2064 6972 6563 7469 6f6e 5f76   def direction_v
-000291f0: 6563 746f 7228 7365 6c66 2c20 6162 7363  ector(self, absc
-00029200: 6973 7361 3d30 2e29 3a0a 2020 2020 2020  issa=0.):.      
-00029210: 2020 6c20 3d20 7365 6c66 2e6c 656e 6774    l = self.lengt
-00029220: 6828 290a 2020 2020 2020 2020 6966 2061  h().        if a
-00029230: 6273 6369 7373 6120 3e3d 206c 3a0a 2020  bscissa >= l:.  
-00029240: 2020 2020 2020 2020 2020 6162 7363 6973            abscis
-00029250: 7361 3220 3d20 6c0a 2020 2020 2020 2020  sa2 = l.        
-00029260: 2020 2020 6162 7363 6973 7361 203d 2061      abscissa = a
-00029270: 6273 6369 7373 6132 202d 2030 2e30 3031  bscissa2 - 0.001
-00029280: 202a 206c 0a0a 2020 2020 2020 2020 656c   * l..        el
-00029290: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000292a0: 6162 7363 6973 7361 3220 3d20 6d69 6e28  abscissa2 = min(
-000292b0: 6162 7363 6973 7361 202b 2030 2e30 3031  abscissa + 0.001
-000292c0: 202a 206c 2c20 6c29 0a0a 2020 2020 2020   * l, l)..      
-000292d0: 2020 7461 6e67 656e 7420 3d20 7365 6c66    tangent = self
-000292e0: 2e70 6f69 6e74 5f61 745f 6162 7363 6973  .point_at_abscis
-000292f0: 7361 2861 6273 6369 7373 6132 2920 2d20  sa(abscissa2) - 
-00029300: 7365 6c66 2e70 6f69 6e74 5f61 745f 6162  self.point_at_ab
-00029310: 7363 6973 7361 280a 2020 2020 2020 2020  scissa(.        
-00029320: 2020 2020 6162 7363 6973 7361 290a 2020      abscissa).  
-00029330: 2020 2020 2020 7265 7475 726e 2074 616e        return tan
-00029340: 6765 6e74 0a0a 2020 2020 6465 6620 6e6f  gent..    def no
-00029350: 726d 616c 5f76 6563 746f 7228 7365 6c66  rmal_vector(self
-00029360: 2c20 6162 7363 6973 7361 293a 0a20 2020  , abscissa):.   
-00029370: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
-00029380: 0a0a 2020 2020 6465 6620 756e 6974 5f6e  ..    def unit_n
-00029390: 6f72 6d61 6c5f 7665 6374 6f72 2873 656c  ormal_vector(sel
-000293a0: 662c 2061 6273 6369 7373 6129 3a0a 2020  f, abscissa):.  
-000293b0: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-000293c0: 650a 0a20 2020 2064 6566 2070 6f69 6e74  e..    def point
-000293d0: 3364 5f74 6f5f 7061 7261 6d65 7465 7228  3d_to_parameter(
-000293e0: 7365 6c66 2c20 706f 696e 743a 2076 6f6c  self, point: vol
-000293f0: 6d64 6c72 2e50 6f69 6e74 3344 293a 0a20  mdlr.Point3D):. 
-00029400: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00029410: 2020 2053 6561 7263 6820 666f 7220 7468     Search for th
-00029420: 6520 7661 6c75 6520 6f66 2074 6865 206e  e value of the n
-00029430: 6f72 6d61 6c69 7a65 6420 6576 616c 7561  ormalized evalua
-00029440: 7469 6f6e 2070 6172 616d 6574 6572 2074  tion parameter t
-00029450: 2028 6265 7477 6565 6e20 3020 616e 6420   (between 0 and 
-00029460: 3129 2e0a 0a20 2020 2020 2020 203a 7265  1)...        :re
-00029470: 7475 726e 3a20 7468 6520 6769 7665 6e20  turn: the given 
-00029480: 706f 696e 7420 7768 656e 2074 6865 2042  point when the B
-00029490: 5370 6c69 6e65 4375 7276 6533 4420 6973  SplineCurve3D is
-000294a0: 2065 7661 6c75 6174 6564 2061 7420 7468   evaluated at th
-000294b0: 6520 7420 7661 6c75 652e 0a20 2020 2020  e t value..     
-000294c0: 2020 2022 2222 0a20 2020 2020 2020 2064     """.        d
-000294d0: 6566 2066 2870 6172 616d 293a 0a20 2020  ef f(param):.   
-000294e0: 2020 2020 2020 2020 2070 3364 203d 2076           p3d = v
-000294f0: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 282a  olmdlr.Point3D(*
-00029500: 7365 6c66 2e63 7572 7665 2e65 7661 6c75  self.curve.evalu
-00029510: 6174 655f 7369 6e67 6c65 2870 6172 616d  ate_single(param
-00029520: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
-00029530: 6574 7572 6e20 706f 696e 742e 706f 696e  eturn point.poin
-00029540: 745f 6469 7374 616e 6365 2870 3364 290a  t_distance(p3d).
-00029550: 2020 2020 2020 2020 7265 7320 3d20 7363          res = sc
-00029560: 6970 792e 6f70 7469 6d69 7a65 2e6d 696e  ipy.optimize.min
-00029570: 696d 697a 6528 6675 6e3d 662c 2078 303d  imize(fun=f, x0=
-00029580: 2830 2e35 292c 2062 6f75 6e64 733d 5b28  (0.5), bounds=[(
-00029590: 302c 2031 295d 2c0a 2020 2020 2020 2020  0, 1)],.        
-000295a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000295b0: 2020 2020 2020 2020 2020 2020 2020 746f                to
-000295c0: 6c3d 3165 2d39 290a 2020 2020 2020 2020  l=1e-9).        
-000295d0: 7265 7475 726e 2072 6573 2e78 5b30 5d0a  return res.x[0].
-000295e0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-000295f0: 640a 2020 2020 6465 6620 6672 6f6d 5f73  d.    def from_s
-00029600: 7465 7028 636c 732c 2061 7267 756d 656e  tep(cls, argumen
-00029610: 7473 2c20 6f62 6a65 6374 5f64 6963 7429  ts, object_dict)
-00029620: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00029630: 2020 2020 2020 436f 6e76 6572 7473 2061        Converts a
-00029640: 2073 7465 7020 7072 696d 6974 6976 6520   step primitive 
-00029650: 746f 2061 2042 5370 6c69 6e65 4375 7276  to a BSplineCurv
-00029660: 6533 442e 0a0a 2020 2020 2020 2020 3a70  e3D...        :p
-00029670: 6172 616d 2061 7267 756d 656e 7473 3a20  aram arguments: 
-00029680: 5468 6520 6172 6775 6d65 6e74 7320 6f66  The arguments of
-00029690: 2074 6865 2073 7465 7020 7072 696d 6974   the step primit
-000296a0: 6976 652e 2054 6865 206c 6173 7420 656c  ive. The last el
-000296b0: 656d 656e 7420 7265 7072 6573 656e 7473  ement represents
-000296c0: 2074 6865 2075 6e69 745f 636f 6e76 6572   the unit_conver
-000296d0: 7369 6f6e 5f66 6163 746f 722e 0a20 2020  sion_factor..   
-000296e0: 2020 2020 203a 7479 7065 2061 7267 756d       :type argum
-000296f0: 656e 7473 3a20 6c69 7374 0a20 2020 2020  ents: list.     
-00029700: 2020 203a 7061 7261 6d20 6f62 6a65 6374     :param object
-00029710: 5f64 6963 743a 2054 6865 2064 6963 7469  _dict: The dicti
-00029720: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
-00029730: 2061 6c6c 2074 6865 2073 7465 7020 7072   all the step pr
-00029740: 696d 6974 6976 6573 0a20 2020 2020 2020  imitives.       
-00029750: 2020 2020 2074 6861 7420 6861 7665 2061       that have a
-00029760: 6c72 6561 6479 2062 6565 6e20 696e 7374  lready been inst
-00029770: 616e 7469 6174 6564 0a20 2020 2020 2020  antiated.       
-00029780: 203a 7479 7065 206f 626a 6563 745f 6469   :type object_di
-00029790: 6374 3a20 6469 6374 0a20 2020 2020 2020  ct: dict.       
-000297a0: 203a 7265 7475 726e 3a20 5468 6520 636f   :return: The co
-000297b0: 7272 6573 706f 6e64 696e 6720 4253 706c  rresponding BSpl
-000297c0: 696e 6543 7572 7665 3344 2e0a 2020 2020  ineCurve3D..    
-000297d0: 2020 2020 3a72 7479 7065 3a20 3a63 6c61      :rtype: :cla
-000297e0: 7373 3a60 766f 6c6d 646c 722e 6564 6765  ss:`volmdlr.edge
-000297f0: 732e 4253 706c 696e 6543 7572 7665 3344  s.BSplineCurve3D
-00029800: 600a 2020 2020 2020 2020 2222 220a 2020  `.        """.  
-00029810: 2020 2020 2020 6e61 6d65 203d 2061 7267        name = arg
-00029820: 756d 656e 7473 5b30 5d5b 313a 2d31 5d0a  uments[0][1:-1].
-00029830: 2020 2020 2020 2020 6465 6772 6565 203d          degree =
-00029840: 2069 6e74 2861 7267 756d 656e 7473 5b31   int(arguments[1
-00029850: 5d29 0a20 2020 2020 2020 2070 6f69 6e74  ]).        point
-00029860: 7320 3d20 5b6f 626a 6563 745f 6469 6374  s = [object_dict
-00029870: 5b69 6e74 2869 5b31 3a5d 295d 2066 6f72  [int(i[1:])] for
-00029880: 2069 2069 6e20 6172 6775 6d65 6e74 735b   i in arguments[
-00029890: 325d 5d0a 2020 2020 2020 2020 6c69 6e65  2]].        line
-000298a0: 7320 3d20 5b4c 696e 6553 6567 6d65 6e74  s = [LineSegment
-000298b0: 3344 2870 7431 2c20 7074 3229 2066 6f72  3D(pt1, pt2) for
-000298c0: 2070 7431 2c20 7074 3220 696e 207a 6970   pt1, pt2 in zip
-000298d0: 2870 6f69 6e74 735b 3a2d 315d 2c20 706f  (points[:-1], po
-000298e0: 696e 7473 5b31 3a5d 2920 6966 2070 7431  ints[1:]) if pt1
-000298f0: 2021 3d20 7074 325d 0a20 2020 2020 2020   != pt2].       
-00029900: 2069 6620 6c69 6e65 733a 2020 2320 7175   if lines:  # qu
-00029910: 6963 6b20 6669 782e 2052 6561 6c20 7072  ick fix. Real pr
-00029920: 6f62 6c65 6d3a 2054 6f6c 6572 616e 6365  oblem: Tolerance
-00029930: 2074 6f6f 206c 6f77 2028 3165 2d36 206d   too low (1e-6 m
-00029940: 203d 2030 2e30 3031 6d6d 290a 2020 2020   = 0.001mm).    
-00029950: 2020 2020 2020 2020 6469 725f 7665 6374          dir_vect
-00029960: 6f72 203d 206c 696e 6573 5b30 5d2e 756e  or = lines[0].un
-00029970: 6974 5f64 6972 6563 7469 6f6e 5f76 6563  it_direction_vec
-00029980: 746f 7228 290a 2020 2020 2020 2020 2020  tor().          
-00029990: 2020 6966 2061 6c6c 286c 696e 652e 756e    if all(line.un
-000299a0: 6974 5f64 6972 6563 7469 6f6e 5f76 6563  it_direction_vec
-000299b0: 746f 7228 2920 3d3d 2064 6972 5f76 6563  tor() == dir_vec
-000299c0: 746f 7220 666f 7220 6c69 6e65 2069 6e20  tor for line in 
-000299d0: 6c69 6e65 7329 3a0a 2020 2020 2020 2020  lines):.        
-000299e0: 2020 2020 2020 2020 7265 7475 726e 204c          return L
-000299f0: 696e 6553 6567 6d65 6e74 3344 2870 6f69  ineSegment3D(poi
-00029a00: 6e74 735b 305d 2c20 706f 696e 7473 5b2d  nts[0], points[-
-00029a10: 315d 290a 2020 2020 2020 2020 2320 6375  1]).        # cu
-00029a20: 7276 655f 666f 726d 203d 2061 7267 756d  rve_form = argum
-00029a30: 656e 7473 5b33 5d0a 2020 2020 2020 2020  ents[3].        
-00029a40: 6966 2061 7267 756d 656e 7473 5b34 5d20  if arguments[4] 
-00029a50: 3d3d 2027 2e46 2e27 3a0a 2020 2020 2020  == '.F.':.      
-00029a60: 2020 2020 2020 636c 6f73 6564 5f63 7572        closed_cur
-00029a70: 7665 203d 2046 616c 7365 0a20 2020 2020  ve = False.     
-00029a80: 2020 2065 6c69 6620 6172 6775 6d65 6e74     elif argument
-00029a90: 735b 345d 203d 3d20 272e 542e 273a 0a20  s[4] == '.T.':. 
-00029aa0: 2020 2020 2020 2020 2020 2063 6c6f 7365             close
-00029ab0: 645f 6375 7276 6520 3d20 5472 7565 0a20  d_curve = True. 
-00029ac0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00029ad0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00029ae0: 616c 7565 4572 726f 720a 2020 2020 2020  alueError.      
-00029af0: 2020 2320 7365 6c66 5f69 6e74 6572 7365    # self_interse
-00029b00: 6374 203d 2061 7267 756d 656e 7473 5b35  ct = arguments[5
-00029b10: 5d0a 2020 2020 2020 2020 6b6e 6f74 5f6d  ].        knot_m
-00029b20: 756c 7469 706c 6963 6974 6965 7320 3d20  ultiplicities = 
-00029b30: 5b69 6e74 2869 2920 666f 7220 6920 696e  [int(i) for i in
-00029b40: 2061 7267 756d 656e 7473 5b36 5d5b 313a   arguments[6][1:
-00029b50: 2d31 5d2e 7370 6c69 7428 222c 2229 5d0a  -1].split(",")].
-00029b60: 2020 2020 2020 2020 6b6e 6f74 7320 3d20          knots = 
-00029b70: 5b66 6c6f 6174 2869 2920 666f 7220 6920  [float(i) for i 
-00029b80: 696e 2061 7267 756d 656e 7473 5b37 5d5b  in arguments[7][
-00029b90: 313a 2d31 5d2e 7370 6c69 7428 222c 2229  1:-1].split(",")
-00029ba0: 5d0a 2020 2020 2020 2020 2320 6b6e 6f74  ].        # knot
-00029bb0: 5f73 7065 6320 3d20 6172 6775 6d65 6e74  _spec = argument
-00029bc0: 735b 385d 0a20 2020 2020 2020 206b 6e6f  s[8].        kno
-00029bd0: 745f 7665 6374 6f72 203d 205b 5d0a 2020  t_vector = [].  
-00029be0: 2020 2020 2020 666f 7220 692c 206b 6e6f        for i, kno
-00029bf0: 7420 696e 2065 6e75 6d65 7261 7465 286b  t in enumerate(k
-00029c00: 6e6f 7473 293a 0a20 2020 2020 2020 2020  nots):.         
-00029c10: 2020 206b 6e6f 745f 7665 6374 6f72 2e65     knot_vector.e
-00029c20: 7874 656e 6428 5b6b 6e6f 745d 202a 206b  xtend([knot] * k
-00029c30: 6e6f 745f 6d75 6c74 6970 6c69 6369 7469  not_multipliciti
-00029c40: 6573 5b69 5d29 0a0a 2020 2020 2020 2020  es[i])..        
-00029c50: 6966 2031 3020 696e 2072 616e 6765 286c  if 10 in range(l
-00029c60: 656e 2861 7267 756d 656e 7473 2929 3a0a  en(arguments)):.
-00029c70: 2020 2020 2020 2020 2020 2020 7765 6967              weig
-00029c80: 6874 5f64 6174 6120 3d20 5b66 6c6f 6174  ht_data = [float
-00029c90: 2869 2920 666f 7220 6920 696e 2061 7267  (i) for i in arg
-00029ca0: 756d 656e 7473 5b39 5d5b 313a 2d31 5d2e  uments[9][1:-1].
-00029cb0: 7370 6c69 7428 222c 2229 5d0a 2020 2020  split(",")].    
-00029cc0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00029cd0: 2020 2020 2020 7765 6967 6874 5f64 6174        weight_dat
-00029ce0: 6120 3d20 4e6f 6e65 0a0a 2020 2020 2020  a = None..      
-00029cf0: 2020 2320 464f 5243 494e 4720 434c 4f53    # FORCING CLOS
-00029d00: 4544 5f43 5552 5645 203d 2046 414c 5345  ED_CURVE = FALSE
-00029d10: 3a0a 2020 2020 2020 2020 2320 636c 6f73  :.        # clos
-00029d20: 6564 5f63 7572 7665 203d 2046 616c 7365  ed_curve = False
-00029d30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00029d40: 636c 7328 6465 6772 6565 2c20 706f 696e  cls(degree, poin
-00029d50: 7473 2c20 6b6e 6f74 5f6d 756c 7469 706c  ts, knot_multipl
-00029d60: 6963 6974 6965 732c 206b 6e6f 7473 2c20  icities, knots, 
-00029d70: 7765 6967 6874 5f64 6174 612c 0a20 2020  weight_data,.   
-00029d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d90: 636c 6f73 6564 5f63 7572 7665 2c20 6e61  closed_curve, na
-00029da0: 6d65 290a 0a20 2020 2064 6566 2074 6f5f  me)..    def to_
-00029db0: 7374 6570 2873 656c 662c 2063 7572 7265  step(self, curre
-00029dc0: 6e74 5f69 642c 2073 7572 6661 6365 5f69  nt_id, surface_i
-00029dd0: 643d 4e6f 6e65 2c20 6375 7276 6532 643d  d=None, curve2d=
-00029de0: 4e6f 6e65 293a 0a0a 2020 2020 2020 2020  None):..        
-00029df0: 706f 696e 7473 5f69 6473 203d 205b 5d0a  points_ids = [].
-00029e00: 2020 2020 2020 2020 636f 6e74 656e 7420          content 
-00029e10: 3d20 2727 0a20 2020 2020 2020 2070 6f69  = ''.        poi
-00029e20: 6e74 5f69 6420 3d20 6375 7272 656e 745f  nt_id = current_
-00029e30: 6964 0a20 2020 2020 2020 2066 6f72 2070  id.        for p
-00029e40: 6f69 6e74 2069 6e20 7365 6c66 2e63 6f6e  oint in self.con
-00029e50: 7472 6f6c 5f70 6f69 6e74 733a 0a20 2020  trol_points:.   
-00029e60: 2020 2020 2020 2020 2070 6f69 6e74 5f63           point_c
-00029e70: 6f6e 7465 6e74 2c20 706f 696e 745f 6964  ontent, point_id
-00029e80: 203d 2070 6f69 6e74 2e74 6f5f 7374 6570   = point.to_step
-00029e90: 2870 6f69 6e74 5f69 642c 0a20 2020 2020  (point_id,.     
-00029ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ec0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00029ed0: 6572 7465 783d 4661 6c73 6529 0a20 2020  ertex=False).   
-00029ee0: 2020 2020 2020 2020 2063 6f6e 7465 6e74           content
-00029ef0: 202b 3d20 706f 696e 745f 636f 6e74 656e   += point_conten
-00029f00: 740a 2020 2020 2020 2020 2020 2020 706f  t.            po
-00029f10: 696e 7473 5f69 6473 2e61 7070 656e 6428  ints_ids.append(
-00029f20: 706f 696e 745f 6964 290a 2020 2020 2020  point_id).      
-00029f30: 2020 2020 2020 706f 696e 745f 6964 202b        point_id +
-00029f40: 3d20 310a 0a20 2020 2020 2020 2063 7572  = 1..        cur
-00029f50: 7665 5f69 6420 3d20 706f 696e 745f 6964  ve_id = point_id
-00029f60: 0a20 2020 2020 2020 2063 6f6e 7465 6e74  .        content
-00029f70: 202b 3d20 2223 7b7d 203d 2042 5f53 504c   += "#{} = B_SPL
-00029f80: 494e 455f 4355 5256 455f 5749 5448 5f4b  INE_CURVE_WITH_K
-00029f90: 4e4f 5453 2827 7b7d 272c 7b7d 2c28 7b7d  NOTS('{}',{},({}
-00029fa0: 292c 2220 5c0a 2020 2020 2020 2020 2020  )," \.          
-00029fb0: 2020 2020 2020 2020 2022 2e55 4e53 5045           ".UNSPE
-00029fc0: 4349 4649 4544 2e2c 2e46 2e2c 2e46 2e2c  CIFIED.,.F.,.F.,
-00029fd0: 7b7d 2c7b 7d2c 2220 5c0a 2020 2020 2020  {},{}," \.      
-00029fe0: 2020 2020 2020 2020 2020 2020 2022 2e55               ".U
-00029ff0: 4e53 5045 4349 4649 4544 2e29 3b5c 6e22  NSPECIFIED.);\n"
-0002a000: 2e66 6f72 6d61 7428 0a20 2020 2020 2020  .format(.       
-0002a010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a020: 6375 7276 655f 6964 2c20 7365 6c66 2e6e  curve_id, self.n
-0002a030: 616d 652c 2073 656c 662e 6465 6772 6565  ame, self.degree
-0002a040: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002a050: 2020 2020 2020 2020 2076 6f6c 6d64 6c72           volmdlr
-0002a060: 2e63 6f72 652e 7374 6570 5f69 6473 5f74  .core.step_ids_t
-0002a070: 6f5f 7374 7228 706f 696e 7473 5f69 6473  o_str(points_ids
-0002a080: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0002a090: 2020 2020 2020 2020 2020 7475 706c 6528            tuple(
-0002a0a0: 7365 6c66 2e6b 6e6f 745f 6d75 6c74 6970  self.knot_multip
-0002a0b0: 6c69 6369 7469 6573 292c 0a20 2020 2020  licities),.     
+00028570: 2020 6e61 6d65 290a 0a20 2020 2020 2020    name)..       
+00028580: 2073 656c 662e 5f62 626f 7820 3d20 4e6f   self._bbox = No
+00028590: 6e65 0a0a 2020 2020 4070 726f 7065 7274  ne..    @propert
+000285a0: 790a 2020 2020 6465 6620 626f 756e 6469  y.    def boundi
+000285b0: 6e67 5f62 6f78 2873 656c 6629 3a0a 2020  ng_box(self):.  
+000285c0: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+000285d0: 662e 5f62 626f 783a 0a20 2020 2020 2020  f._bbox:.       
+000285e0: 2020 2020 2073 656c 662e 5f62 626f 7820       self._bbox 
+000285f0: 3d20 7365 6c66 2e5f 626f 756e 6469 6e67  = self._bounding
+00028600: 5f62 6f78 2829 0a20 2020 2020 2020 2072  _box().        r
+00028610: 6574 7572 6e20 7365 6c66 2e5f 6262 6f78  eturn self._bbox
+00028620: 0a0a 2020 2020 4062 6f75 6e64 696e 675f  ..    @bounding_
+00028630: 626f 782e 7365 7474 6572 0a20 2020 2064  box.setter.    d
+00028640: 6566 2062 6f75 6e64 696e 675f 626f 7828  ef bounding_box(
+00028650: 7365 6c66 2c20 6e65 775f 626f 756e 6469  self, new_boundi
+00028660: 6e67 5f62 6f78 293a 0a20 2020 2020 2020  ng_box):.       
+00028670: 2073 656c 662e 5f62 626f 7820 3d20 6e65   self._bbox = ne
+00028680: 775f 626f 756e 6469 6e67 5f62 6f78 0a0a  w_bounding_box..
+00028690: 2020 2020 6465 6620 5f62 6f75 6e64 696e      def _boundin
+000286a0: 675f 626f 7828 7365 6c66 293a 0a20 2020  g_box(self):.   
+000286b0: 2020 2020 2062 626f 7820 3d20 7365 6c66       bbox = self
+000286c0: 2e63 7572 7665 2e62 626f 780a 2020 2020  .curve.bbox.    
+000286d0: 2020 2020 7265 7475 726e 2076 6f6c 6d64      return volmd
+000286e0: 6c72 2e63 6f72 652e 426f 756e 6469 6e67  lr.core.Bounding
+000286f0: 426f 7828 6262 6f78 5b30 5d5b 305d 2c20  Box(bbox[0][0], 
+00028700: 6262 6f78 5b31 5d5b 305d 2c0a 2020 2020  bbox[1][0],.    
+00028710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028730: 2020 2020 6262 6f78 5b30 5d5b 315d 2c20      bbox[0][1], 
+00028740: 6262 6f78 5b31 5d5b 315d 2c0a 2020 2020  bbox[1][1],.    
+00028750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028770: 2020 2020 6262 6f78 5b30 5d5b 325d 2c20      bbox[0][2], 
+00028780: 6262 6f78 5b31 5d5b 325d 290a 0a20 2020  bbox[1][2])..   
+00028790: 2064 6566 206c 6f6f 6b5f 7570 5f74 6162   def look_up_tab
+000287a0: 6c65 2873 656c 662c 2072 6573 6f6c 7574  le(self, resolut
+000287b0: 696f 6e3a 2069 6e74 203d 2032 302c 2073  ion: int = 20, s
+000287c0: 7461 7274 5f70 6172 616d 6574 6572 3a20  tart_parameter: 
+000287d0: 666c 6f61 7420 3d20 302c 0a20 2020 2020  float = 0,.     
+000287e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000287f0: 2065 6e64 5f70 6172 616d 6574 6572 3a20   end_parameter: 
+00028800: 666c 6f61 7420 3d20 3129 3a0a 2020 2020  float = 1):.    
+00028810: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00028820: 4372 6561 7465 7320 6120 7461 626c 6520  Creates a table 
+00028830: 6f66 2065 7175 6976 616c 656e 6365 2062  of equivalence b
+00028840: 6574 7765 656e 2074 6865 2070 6172 616d  etween the param
+00028850: 6574 6572 2074 2028 6576 616c 2e20 6f66  eter t (eval. of
+00028860: 2074 6865 2042 5370 6c69 6e65 4375 7276   the BSplineCurv
+00028870: 6529 2061 6e64 2074 6865 2063 756d 756c  e) and the cumul
+00028880: 6174 6976 6520 6469 7374 616e 6365 2e0a  ative distance..
+00028890: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000288a0: 7265 736f 6c75 7469 6f6e 3a20 5468 6520  resolution: The 
+000288b0: 7072 6563 6973 696f 6e20 6f66 2074 6865  precision of the
+000288c0: 2074 6162 6c65 2e20 4175 746f 6164 6a75   table. Autoadju
+000288d0: 7374 6564 2062 7920 7468 650a 2020 2020  sted by the.    
+000288e0: 2020 2020 2020 2020 616c 676f 7269 7468          algorith
+000288f0: 6d2e 2044 6566 6175 6c74 2076 616c 7565  m. Default value
+00028900: 2073 6574 2074 6f20 3230 0a20 2020 2020   set to 20.     
+00028910: 2020 203a 7479 7065 2072 6573 6f6c 7574     :type resolut
+00028920: 696f 6e3a 2069 6e74 2c20 6f70 7469 6f6e  ion: int, option
+00028930: 616c 0a20 2020 2020 2020 203a 7061 7261  al.        :para
+00028940: 6d20 7374 6172 745f 7061 7261 6d65 7465  m start_paramete
+00028950: 723a 2046 6972 7374 2070 6172 616d 6574  r: First paramet
+00028960: 6572 2065 7661 6c75 6174 6564 2069 6e20  er evaluated in 
+00028970: 7468 6520 7461 626c 652e 0a20 2020 2020  the table..     
+00028980: 2020 2020 2020 2044 6566 6175 6c74 2076         Default v
+00028990: 616c 7565 2073 6574 2074 6f20 300a 2020  alue set to 0.  
+000289a0: 2020 2020 2020 3a74 7970 6520 7374 6172        :type star
+000289b0: 745f 7061 7261 6d65 7465 723a 2066 6c6f  t_parameter: flo
+000289c0: 6174 2c20 6f70 7469 6f6e 616c 0a20 2020  at, optional.   
+000289d0: 2020 2020 203a 7061 7261 6d20 656e 645f       :param end_
+000289e0: 7061 7261 6d65 7465 723a 204c 6173 7420  parameter: Last 
+000289f0: 7061 7261 6d65 7465 7220 6576 616c 7561  parameter evalua
+00028a00: 7465 6420 696e 2074 6865 2074 6162 6c65  ted in the table
+00028a10: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
+00028a20: 6661 756c 7420 7661 6c75 6520 7365 7420  fault value set 
+00028a30: 746f 2031 0a20 2020 2020 2020 203a 7479  to 1.        :ty
+00028a40: 7065 2073 7461 7274 5f70 6172 616d 6574  pe start_paramet
+00028a50: 6572 3a20 666c 6f61 742c 206f 7074 696f  er: float, optio
+00028a60: 6e61 6c0a 2020 2020 2020 2020 3a72 6574  nal.        :ret
+00028a70: 7572 6e3a 2059 6965 6c64 7320 6120 6c69  urn: Yields a li
+00028a80: 7374 206f 6620 7475 706c 6573 2063 6f6e  st of tuples con
+00028a90: 7461 696e 696e 6720 7468 6520 7061 7261  taining the para
+00028aa0: 6d65 7465 7220 616e 6420 7468 650a 2020  meter and the.  
+00028ab0: 2020 2020 2020 2020 2020 6375 6d75 6c61            cumula
+00028ac0: 7465 6420 6469 7374 616e 6365 2061 6c6f  ted distance alo
+00028ad0: 6e67 2074 6865 2042 5370 6c69 6e65 4372  ng the BSplineCr
+00028ae0: 7576 6533 4420 6672 6f6d 2074 6865 2065  uve3D from the e
+00028af0: 7661 6c75 6174 696f 6e20 6f66 0a20 2020  valuation of.   
+00028b00: 2020 2020 2020 2020 2073 7461 7274 5f70           start_p
+00028b10: 6172 616d 6574 6572 0a20 2020 2020 2020  arameter.       
+00028b20: 203a 7274 7970 653a 2054 7570 6c65 5b66   :rtype: Tuple[f
+00028b30: 6c6f 6174 2c20 666c 6f61 745d 0a20 2020  loat, float].   
+00028b40: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00028b50: 2072 6573 6f6c 7574 696f 6e20 3d20 6d61   resolution = ma
+00028b60: 7828 3130 2c20 6d69 6e28 7265 736f 6c75  x(10, min(resolu
+00028b70: 7469 6f6e 2c20 696e 7428 7365 6c66 2e6c  tion, int(self.l
+00028b80: 656e 6774 6828 2920 2f20 3165 2d34 2929  ength() / 1e-4))
+00028b90: 290a 2020 2020 2020 2020 6465 6c74 615f  ).        delta_
+00028ba0: 7061 7261 6d20 3d20 3120 2f20 7265 736f  param = 1 / reso
+00028bb0: 6c75 7469 6f6e 202a 2028 656e 645f 7061  lution * (end_pa
+00028bc0: 7261 6d65 7465 7220 2d20 7374 6172 745f  rameter - start_
+00028bd0: 7061 7261 6d65 7465 7229 0a20 2020 2020  parameter).     
+00028be0: 2020 2064 6973 7461 6e63 6520 3d20 300a     distance = 0.
+00028bf0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00028c00: 2072 616e 6765 2872 6573 6f6c 7574 696f   range(resolutio
+00028c10: 6e20 2b20 3129 3a0a 2020 2020 2020 2020  n + 1):.        
+00028c20: 2020 2020 6966 2069 203d 3d20 303a 0a20      if i == 0:. 
+00028c30: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00028c40: 6965 6c64 2073 7461 7274 5f70 6172 616d  ield start_param
+00028c50: 6574 6572 2c20 300a 2020 2020 2020 2020  eter, 0.        
+00028c60: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00028c70: 2020 2020 2020 2020 2020 7061 7261 6d31            param1
+00028c80: 203d 2073 7461 7274 5f70 6172 616d 6574   = start_paramet
+00028c90: 6572 202b 2028 6920 2d20 3129 202a 2064  er + (i - 1) * d
+00028ca0: 656c 7461 5f70 6172 616d 0a20 2020 2020  elta_param.     
+00028cb0: 2020 2020 2020 2020 2020 2070 6172 616d             param
+00028cc0: 3220 3d20 7374 6172 745f 7061 7261 6d65  2 = start_parame
+00028cd0: 7465 7220 2b20 6920 2a20 6465 6c74 615f  ter + i * delta_
+00028ce0: 7061 7261 6d0a 2020 2020 2020 2020 2020  param.          
+00028cf0: 2020 2020 2020 706f 696e 7431 203d 2076        point1 = v
+00028d00: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 282a  olmdlr.Point3D(*
+00028d10: 7365 6c66 2e63 7572 7665 2e65 7661 6c75  self.curve.evalu
+00028d20: 6174 655f 7369 6e67 6c65 2870 6172 616d  ate_single(param
+00028d30: 3129 290a 2020 2020 2020 2020 2020 2020  1)).            
+00028d40: 2020 2020 706f 696e 7432 203d 2076 6f6c      point2 = vol
+00028d50: 6d64 6c72 2e50 6f69 6e74 3344 282a 7365  mdlr.Point3D(*se
+00028d60: 6c66 2e63 7572 7665 2e65 7661 6c75 6174  lf.curve.evaluat
+00028d70: 655f 7369 6e67 6c65 2870 6172 616d 3229  e_single(param2)
+00028d80: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00028d90: 2020 6469 7374 616e 6365 202b 3d20 706f    distance += po
+00028da0: 696e 7431 2e70 6f69 6e74 5f64 6973 7461  int1.point_dista
+00028db0: 6e63 6528 706f 696e 7432 290a 2020 2020  nce(point2).    
+00028dc0: 2020 2020 2020 2020 2020 2020 7969 656c              yiel
+00028dd0: 6420 7061 7261 6d32 2c20 6469 7374 616e  d param2, distan
+00028de0: 6365 0a0a 2020 2020 6465 6620 706f 696e  ce..    def poin
+00028df0: 745f 6174 5f61 6273 6369 7373 6128 7365  t_at_abscissa(se
+00028e00: 6c66 2c20 6162 7363 6973 7361 3a20 666c  lf, abscissa: fl
+00028e10: 6f61 742c 2072 6573 6f6c 7574 696f 6e3a  oat, resolution:
+00028e20: 2069 6e74 203d 2031 3030 3029 3a0a 2020   int = 1000):.  
+00028e30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00028e40: 2020 5265 7475 726e 7320 7468 6520 3320    Returns the 3 
+00028e50: 6469 6d65 6e73 696f 6e61 6c20 706f 696e  dimensional poin
+00028e60: 7420 6174 2061 2067 6976 656e 2063 7572  t at a given cur
+00028e70: 7669 6c69 6e65 6172 2061 6273 6369 7373  vilinear absciss
+00028e80: 612e 0a0a 2020 2020 2020 2020 5468 6973  a...        This
+00028e90: 2069 7320 616e 2061 7070 726f 7869 6d61   is an approxima
+00028ea0: 7469 6f6e 2e20 5265 736f 6c75 7469 6f6e  tion. Resolution
+00028eb0: 2070 6172 616d 6574 6572 2063 616e 2062   parameter can b
+00028ec0: 6520 696e 6372 6561 7365 640a 2020 2020  e increased.    
+00028ed0: 2020 2020 666f 7220 6d6f 7265 2061 6363      for more acc
+00028ee0: 7572 6174 6520 7265 7375 6c74 2e0a 0a20  urate result... 
+00028ef0: 2020 2020 2020 203a 7061 7261 6d20 6162         :param ab
+00028f00: 7363 6973 7361 3a20 5468 6520 6469 7374  scissa: The dist
+00028f10: 616e 6365 206f 6e20 7468 6520 4253 706c  ance on the BSpl
+00028f20: 696e 6543 7572 7665 3344 2066 726f 6d20  ineCurve3D from 
+00028f30: 6974 7320 7374 6172 740a 2020 2020 2020  its start.      
+00028f40: 2020 3a74 7970 6520 6162 7363 6973 7361    :type abscissa
+00028f50: 3a20 666c 6f61 740a 2020 2020 2020 2020  : float.        
+00028f60: 3a70 6172 616d 2072 6573 6f6c 7574 696f  :param resolutio
+00028f70: 6e3a 2054 6865 2070 7265 6369 7369 6f6e  n: The precision
+00028f80: 206f 6620 7468 6520 6170 7072 6f78 696d   of the approxim
+00028f90: 6174 696f 6e2e 2044 6566 6175 6c74 2076  ation. Default v
+00028fa0: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
+00028fb0: 2073 6574 2074 6f20 3130 3030 0a20 2020   set to 1000.   
+00028fc0: 2020 2020 203a 7479 7065 2072 6573 6f6c       :type resol
+00028fd0: 7574 696f 6e3a 2069 6e74 2c20 6f70 7469  ution: int, opti
+00028fe0: 6f6e 616c 0a20 2020 2020 2020 203a 7265  onal.        :re
+00028ff0: 7475 726e 3a20 5468 6520 506f 696e 7433  turn: The Point3
+00029000: 4420 6174 2074 6865 2067 6976 656e 2063  D at the given c
+00029010: 7572 7669 6c69 6e65 6172 2061 6273 6369  urvilinear absci
+00029020: 7373 612e 0a20 2020 2020 2020 203a 7274  ssa..        :rt
+00029030: 7970 653a 203a 636c 6173 733a 6076 6f6c  ype: :class:`vol
+00029040: 6d64 6c72 2e50 6f69 6e74 3344 600a 2020  mdlr.Point3D`.  
+00029050: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00029060: 2020 6966 206d 6174 682e 6973 636c 6f73    if math.isclos
+00029070: 6528 6162 7363 6973 7361 2c20 302c 2061  e(abscissa, 0, a
+00029080: 6273 5f74 6f6c 3d31 652d 3130 293a 0a20  bs_tol=1e-10):. 
+00029090: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000290a0: 6e20 7365 6c66 2e73 7461 7274 0a20 2020  n self.start.   
+000290b0: 2020 2020 2069 6620 6d61 7468 2e69 7363       if math.isc
+000290c0: 6c6f 7365 2861 6273 6369 7373 612c 2073  lose(abscissa, s
+000290d0: 656c 662e 6c65 6e67 7468 2829 2c20 6162  elf.length(), ab
+000290e0: 735f 746f 6c3d 3165 2d31 3029 3a0a 2020  s_tol=1e-10):.  
+000290f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00029100: 2073 656c 662e 656e 640a 2020 2020 2020   self.end.      
+00029110: 2020 6c75 7420 3d20 7365 6c66 2e6c 6f6f    lut = self.loo
+00029120: 6b5f 7570 5f74 6162 6c65 2872 6573 6f6c  k_up_table(resol
+00029130: 7574 696f 6e3d 7265 736f 6c75 7469 6f6e  ution=resolution
+00029140: 290a 2020 2020 2020 2020 6966 2030 203c  ).        if 0 <
+00029150: 2061 6273 6369 7373 6120 3c20 7365 6c66   abscissa < self
+00029160: 2e6c 656e 6774 6828 293a 0a20 2020 2020  .length():.     
+00029170: 2020 2020 2020 206c 6173 745f 7061 7261         last_para
+00029180: 6d20 3d20 300a 2020 2020 2020 2020 2020  m = 0.          
+00029190: 2020 666f 7220 742c 2064 6973 7420 696e    for t, dist in
+000291a0: 206c 7574 3a0a 2020 2020 2020 2020 2020   lut:.          
+000291b0: 2020 2020 2020 6966 2061 6273 6369 7373        if absciss
+000291c0: 6120 3c20 6469 7374 3a0a 2020 2020 2020  a < dist:.      
+000291d0: 2020 2020 2020 2020 2020 2020 2020 7431                t1
+000291e0: 203d 206c 6173 745f 7061 7261 6d0a 2020   = last_param.  
+000291f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029200: 2020 7432 203d 2074 0a20 2020 2020 2020    t2 = t.       
+00029210: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00029220: 7572 6e20 766f 6c6d 646c 722e 506f 696e  urn volmdlr.Poin
+00029230: 7433 4428 0a20 2020 2020 2020 2020 2020  t3D(.           
+00029240: 2020 2020 2020 2020 2020 2020 202a 7365               *se
+00029250: 6c66 2e63 7572 7665 2e65 7661 6c75 6174  lf.curve.evaluat
+00029260: 655f 7369 6e67 6c65 2828 7431 202b 2074  e_single((t1 + t
+00029270: 3229 202f 2032 2929 0a20 2020 2020 2020  2) / 2)).       
+00029280: 2020 2020 2020 2020 206c 6173 745f 7061           last_pa
+00029290: 7261 6d20 3d20 740a 2020 2020 2020 2020  ram = t.        
+000292a0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+000292b0: 2827 4375 7276 696c 696e 6561 7220 6162  ('Curvilinear ab
+000292c0: 7363 6973 7361 2069 7320 6269 6767 6572  scissa is bigger
+000292d0: 2074 6861 6e20 6c65 6e67 7468 2c27 0a20   than length,'. 
+000292e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000292f0: 2020 2020 2020 2020 2720 6f72 206e 6567          ' or neg
+00029300: 6174 6976 6527 290a 0a20 2020 2064 6566  ative')..    def
+00029310: 206e 6f72 6d61 6c28 7365 6c66 2c20 706f   normal(self, po
+00029320: 7369 7469 6f6e 3a20 666c 6f61 7420 3d20  sition: float = 
+00029330: 302e 3029 3a0a 2020 2020 2020 2020 5f2c  0.0):.        _,
+00029340: 206e 6f72 6d61 6c20 3d20 6f70 6572 6174   normal = operat
+00029350: 696f 6e73 2e6e 6f72 6d61 6c28 7365 6c66  ions.normal(self
+00029360: 2e63 7572 7665 2c20 706f 7369 7469 6f6e  .curve, position
+00029370: 2c20 6e6f 726d 616c 697a 653d 5472 7565  , normalize=True
+00029380: 290a 2020 2020 2020 2020 6e6f 726d 616c  ).        normal
+00029390: 203d 2076 6f6c 6d64 6c72 2e50 6f69 6e74   = volmdlr.Point
+000293a0: 3344 286e 6f72 6d61 6c5b 305d 2c20 6e6f  3D(normal[0], no
+000293b0: 726d 616c 5b31 5d2c 206e 6f72 6d61 6c5b  rmal[1], normal[
+000293c0: 325d 290a 2020 2020 2020 2020 7265 7475  2]).        retu
+000293d0: 726e 206e 6f72 6d61 6c0a 0a20 2020 2064  rn normal..    d
+000293e0: 6566 2064 6972 6563 7469 6f6e 5f76 6563  ef direction_vec
+000293f0: 746f 7228 7365 6c66 2c20 6162 7363 6973  tor(self, abscis
+00029400: 7361 3d30 2e29 3a0a 2020 2020 2020 2020  sa=0.):.        
+00029410: 6c20 3d20 7365 6c66 2e6c 656e 6774 6828  l = self.length(
+00029420: 290a 2020 2020 2020 2020 6966 2061 6273  ).        if abs
+00029430: 6369 7373 6120 3e3d 206c 3a0a 2020 2020  cissa >= l:.    
+00029440: 2020 2020 2020 2020 6162 7363 6973 7361          abscissa
+00029450: 3220 3d20 6c0a 2020 2020 2020 2020 2020  2 = l.          
+00029460: 2020 6162 7363 6973 7361 203d 2061 6273    abscissa = abs
+00029470: 6369 7373 6132 202d 2030 2e30 3031 202a  cissa2 - 0.001 *
+00029480: 206c 0a0a 2020 2020 2020 2020 656c 7365   l..        else
+00029490: 3a0a 2020 2020 2020 2020 2020 2020 6162  :.            ab
+000294a0: 7363 6973 7361 3220 3d20 6d69 6e28 6162  scissa2 = min(ab
+000294b0: 7363 6973 7361 202b 2030 2e30 3031 202a  scissa + 0.001 *
+000294c0: 206c 2c20 6c29 0a0a 2020 2020 2020 2020   l, l)..        
+000294d0: 7461 6e67 656e 7420 3d20 7365 6c66 2e70  tangent = self.p
+000294e0: 6f69 6e74 5f61 745f 6162 7363 6973 7361  oint_at_abscissa
+000294f0: 2861 6273 6369 7373 6132 2920 2d20 7365  (abscissa2) - se
+00029500: 6c66 2e70 6f69 6e74 5f61 745f 6162 7363  lf.point_at_absc
+00029510: 6973 7361 280a 2020 2020 2020 2020 2020  issa(.          
+00029520: 2020 6162 7363 6973 7361 290a 2020 2020    abscissa).    
+00029530: 2020 2020 7265 7475 726e 2074 616e 6765      return tange
+00029540: 6e74 0a0a 2020 2020 6465 6620 6e6f 726d  nt..    def norm
+00029550: 616c 5f76 6563 746f 7228 7365 6c66 2c20  al_vector(self, 
+00029560: 6162 7363 6973 7361 293a 0a20 2020 2020  abscissa):.     
+00029570: 2020 2072 6574 7572 6e20 4e6f 6e65 0a0a     return None..
+00029580: 2020 2020 6465 6620 756e 6974 5f6e 6f72      def unit_nor
+00029590: 6d61 6c5f 7665 6374 6f72 2873 656c 662c  mal_vector(self,
+000295a0: 2061 6273 6369 7373 6129 3a0a 2020 2020   abscissa):.    
+000295b0: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
+000295c0: 0a20 2020 2064 6566 2070 6f69 6e74 3364  .    def point3d
+000295d0: 5f74 6f5f 7061 7261 6d65 7465 7228 7365  _to_parameter(se
+000295e0: 6c66 2c20 706f 696e 743a 2076 6f6c 6d64  lf, point: volmd
+000295f0: 6c72 2e50 6f69 6e74 3344 293a 0a20 2020  lr.Point3D):.   
+00029600: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00029610: 2053 6561 7263 6820 666f 7220 7468 6520   Search for the 
+00029620: 7661 6c75 6520 6f66 2074 6865 206e 6f72  value of the nor
+00029630: 6d61 6c69 7a65 6420 6576 616c 7561 7469  malized evaluati
+00029640: 6f6e 2070 6172 616d 6574 6572 2074 2028  on parameter t (
+00029650: 6265 7477 6565 6e20 3020 616e 6420 3129  between 0 and 1)
+00029660: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
+00029670: 726e 3a20 7468 6520 6769 7665 6e20 706f  rn: the given po
+00029680: 696e 7420 7768 656e 2074 6865 2042 5370  int when the BSp
+00029690: 6c69 6e65 4375 7276 6533 4420 6973 2065  lineCurve3D is e
+000296a0: 7661 6c75 6174 6564 2061 7420 7468 6520  valuated at the 
+000296b0: 7420 7661 6c75 652e 0a20 2020 2020 2020  t value..       
+000296c0: 2022 2222 0a20 2020 2020 2020 2064 6566   """.        def
+000296d0: 2066 2870 6172 616d 293a 0a20 2020 2020   f(param):.     
+000296e0: 2020 2020 2020 2070 3364 203d 2076 6f6c         p3d = vol
+000296f0: 6d64 6c72 2e50 6f69 6e74 3344 282a 7365  mdlr.Point3D(*se
+00029700: 6c66 2e63 7572 7665 2e65 7661 6c75 6174  lf.curve.evaluat
+00029710: 655f 7369 6e67 6c65 2870 6172 616d 2929  e_single(param))
+00029720: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00029730: 7572 6e20 706f 696e 742e 706f 696e 745f  urn point.point_
+00029740: 6469 7374 616e 6365 2870 3364 290a 2020  distance(p3d).  
+00029750: 2020 2020 2020 7265 7320 3d20 7363 6970        res = scip
+00029760: 792e 6f70 7469 6d69 7a65 2e6d 696e 696d  y.optimize.minim
+00029770: 697a 6528 6675 6e3d 662c 2078 303d 2830  ize(fun=f, x0=(0
+00029780: 2e35 292c 2062 6f75 6e64 733d 5b28 302c  .5), bounds=[(0,
+00029790: 2031 295d 2c0a 2020 2020 2020 2020 2020   1)],.          
+000297a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000297b0: 2020 2020 2020 2020 2020 2020 746f 6c3d              tol=
+000297c0: 3165 2d39 290a 2020 2020 2020 2020 7265  1e-9).        re
+000297d0: 7475 726e 2072 6573 2e78 5b30 5d0a 0a20  turn res.x[0].. 
+000297e0: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
+000297f0: 2020 2020 6465 6620 6672 6f6d 5f73 7465      def from_ste
+00029800: 7028 636c 732c 2061 7267 756d 656e 7473  p(cls, arguments
+00029810: 2c20 6f62 6a65 6374 5f64 6963 7429 3a0a  , object_dict):.
+00029820: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00029830: 2020 2020 436f 6e76 6572 7473 2061 2073      Converts a s
+00029840: 7465 7020 7072 696d 6974 6976 6520 746f  tep primitive to
+00029850: 2061 2042 5370 6c69 6e65 4375 7276 6533   a BSplineCurve3
+00029860: 442e 0a0a 2020 2020 2020 2020 3a70 6172  D...        :par
+00029870: 616d 2061 7267 756d 656e 7473 3a20 5468  am arguments: Th
+00029880: 6520 6172 6775 6d65 6e74 7320 6f66 2074  e arguments of t
+00029890: 6865 2073 7465 7020 7072 696d 6974 6976  he step primitiv
+000298a0: 652e 2054 6865 206c 6173 7420 656c 656d  e. The last elem
+000298b0: 656e 7420 7265 7072 6573 656e 7473 2074  ent represents t
+000298c0: 6865 2075 6e69 745f 636f 6e76 6572 7369  he unit_conversi
+000298d0: 6f6e 5f66 6163 746f 722e 0a20 2020 2020  on_factor..     
+000298e0: 2020 203a 7479 7065 2061 7267 756d 656e     :type argumen
+000298f0: 7473 3a20 6c69 7374 0a20 2020 2020 2020  ts: list.       
+00029900: 203a 7061 7261 6d20 6f62 6a65 6374 5f64   :param object_d
+00029910: 6963 743a 2054 6865 2064 6963 7469 6f6e  ict: The diction
+00029920: 6172 7920 636f 6e74 6169 6e69 6e67 2061  ary containing a
+00029930: 6c6c 2074 6865 2073 7465 7020 7072 696d  ll the step prim
+00029940: 6974 6976 6573 0a20 2020 2020 2020 2020  itives.         
+00029950: 2020 2074 6861 7420 6861 7665 2061 6c72     that have alr
+00029960: 6561 6479 2062 6565 6e20 696e 7374 616e  eady been instan
+00029970: 7469 6174 6564 0a20 2020 2020 2020 203a  tiated.        :
+00029980: 7479 7065 206f 626a 6563 745f 6469 6374  type object_dict
+00029990: 3a20 6469 6374 0a20 2020 2020 2020 203a  : dict.        :
+000299a0: 7265 7475 726e 3a20 5468 6520 636f 7272  return: The corr
+000299b0: 6573 706f 6e64 696e 6720 4253 706c 696e  esponding BSplin
+000299c0: 6543 7572 7665 3344 2e0a 2020 2020 2020  eCurve3D..      
+000299d0: 2020 3a72 7479 7065 3a20 3a63 6c61 7373    :rtype: :class
+000299e0: 3a60 766f 6c6d 646c 722e 6564 6765 732e  :`volmdlr.edges.
+000299f0: 4253 706c 696e 6543 7572 7665 3344 600a  BSplineCurve3D`.
+00029a00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00029a10: 2020 2020 6e61 6d65 203d 2061 7267 756d      name = argum
+00029a20: 656e 7473 5b30 5d5b 313a 2d31 5d0a 2020  ents[0][1:-1].  
+00029a30: 2020 2020 2020 6465 6772 6565 203d 2069        degree = i
+00029a40: 6e74 2861 7267 756d 656e 7473 5b31 5d29  nt(arguments[1])
+00029a50: 0a20 2020 2020 2020 2070 6f69 6e74 7320  .        points 
+00029a60: 3d20 5b6f 626a 6563 745f 6469 6374 5b69  = [object_dict[i
+00029a70: 6e74 2869 5b31 3a5d 295d 2066 6f72 2069  nt(i[1:])] for i
+00029a80: 2069 6e20 6172 6775 6d65 6e74 735b 325d   in arguments[2]
+00029a90: 5d0a 2020 2020 2020 2020 6c69 6e65 7320  ].        lines 
+00029aa0: 3d20 5b4c 696e 6553 6567 6d65 6e74 3344  = [LineSegment3D
+00029ab0: 2870 7431 2c20 7074 3229 2066 6f72 2070  (pt1, pt2) for p
+00029ac0: 7431 2c20 7074 3220 696e 207a 6970 2870  t1, pt2 in zip(p
+00029ad0: 6f69 6e74 735b 3a2d 315d 2c20 706f 696e  oints[:-1], poin
+00029ae0: 7473 5b31 3a5d 2920 6966 2070 7431 2021  ts[1:]) if pt1 !
+00029af0: 3d20 7074 325d 0a20 2020 2020 2020 2069  = pt2].        i
+00029b00: 6620 6c69 6e65 733a 2020 2320 7175 6963  f lines:  # quic
+00029b10: 6b20 6669 782e 2052 6561 6c20 7072 6f62  k fix. Real prob
+00029b20: 6c65 6d3a 2054 6f6c 6572 616e 6365 2074  lem: Tolerance t
+00029b30: 6f6f 206c 6f77 2028 3165 2d36 206d 203d  oo low (1e-6 m =
+00029b40: 2030 2e30 3031 6d6d 290a 2020 2020 2020   0.001mm).      
+00029b50: 2020 2020 2020 6469 725f 7665 6374 6f72        dir_vector
+00029b60: 203d 206c 696e 6573 5b30 5d2e 756e 6974   = lines[0].unit
+00029b70: 5f64 6972 6563 7469 6f6e 5f76 6563 746f  _direction_vecto
+00029b80: 7228 290a 2020 2020 2020 2020 2020 2020  r().            
+00029b90: 6966 2061 6c6c 286c 696e 652e 756e 6974  if all(line.unit
+00029ba0: 5f64 6972 6563 7469 6f6e 5f76 6563 746f  _direction_vecto
+00029bb0: 7228 2920 3d3d 2064 6972 5f76 6563 746f  r() == dir_vecto
+00029bc0: 7220 666f 7220 6c69 6e65 2069 6e20 6c69  r for line in li
+00029bd0: 6e65 7329 3a0a 2020 2020 2020 2020 2020  nes):.          
+00029be0: 2020 2020 2020 7265 7475 726e 204c 696e        return Lin
+00029bf0: 6553 6567 6d65 6e74 3344 2870 6f69 6e74  eSegment3D(point
+00029c00: 735b 305d 2c20 706f 696e 7473 5b2d 315d  s[0], points[-1]
+00029c10: 290a 2020 2020 2020 2020 2320 6375 7276  ).        # curv
+00029c20: 655f 666f 726d 203d 2061 7267 756d 656e  e_form = argumen
+00029c30: 7473 5b33 5d0a 2020 2020 2020 2020 6966  ts[3].        if
+00029c40: 2061 7267 756d 656e 7473 5b34 5d20 3d3d   arguments[4] ==
+00029c50: 2027 2e46 2e27 3a0a 2020 2020 2020 2020   '.F.':.        
+00029c60: 2020 2020 636c 6f73 6564 5f63 7572 7665      closed_curve
+00029c70: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00029c80: 2065 6c69 6620 6172 6775 6d65 6e74 735b   elif arguments[
+00029c90: 345d 203d 3d20 272e 542e 273a 0a20 2020  4] == '.T.':.   
+00029ca0: 2020 2020 2020 2020 2063 6c6f 7365 645f           closed_
+00029cb0: 6375 7276 6520 3d20 5472 7565 0a20 2020  curve = True.   
+00029cc0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00029cd0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00029ce0: 7565 4572 726f 720a 2020 2020 2020 2020  ueError.        
+00029cf0: 2320 7365 6c66 5f69 6e74 6572 7365 6374  # self_intersect
+00029d00: 203d 2061 7267 756d 656e 7473 5b35 5d0a   = arguments[5].
+00029d10: 2020 2020 2020 2020 6b6e 6f74 5f6d 756c          knot_mul
+00029d20: 7469 706c 6963 6974 6965 7320 3d20 5b69  tiplicities = [i
+00029d30: 6e74 2869 2920 666f 7220 6920 696e 2061  nt(i) for i in a
+00029d40: 7267 756d 656e 7473 5b36 5d5b 313a 2d31  rguments[6][1:-1
+00029d50: 5d2e 7370 6c69 7428 222c 2229 5d0a 2020  ].split(",")].  
+00029d60: 2020 2020 2020 6b6e 6f74 7320 3d20 5b66        knots = [f
+00029d70: 6c6f 6174 2869 2920 666f 7220 6920 696e  loat(i) for i in
+00029d80: 2061 7267 756d 656e 7473 5b37 5d5b 313a   arguments[7][1:
+00029d90: 2d31 5d2e 7370 6c69 7428 222c 2229 5d0a  -1].split(",")].
+00029da0: 2020 2020 2020 2020 2320 6b6e 6f74 5f73          # knot_s
+00029db0: 7065 6320 3d20 6172 6775 6d65 6e74 735b  pec = arguments[
+00029dc0: 385d 0a20 2020 2020 2020 206b 6e6f 745f  8].        knot_
+00029dd0: 7665 6374 6f72 203d 205b 5d0a 2020 2020  vector = [].    
+00029de0: 2020 2020 666f 7220 692c 206b 6e6f 7420      for i, knot 
+00029df0: 696e 2065 6e75 6d65 7261 7465 286b 6e6f  in enumerate(kno
+00029e00: 7473 293a 0a20 2020 2020 2020 2020 2020  ts):.           
+00029e10: 206b 6e6f 745f 7665 6374 6f72 2e65 7874   knot_vector.ext
+00029e20: 656e 6428 5b6b 6e6f 745d 202a 206b 6e6f  end([knot] * kno
+00029e30: 745f 6d75 6c74 6970 6c69 6369 7469 6573  t_multiplicities
+00029e40: 5b69 5d29 0a0a 2020 2020 2020 2020 6966  [i])..        if
+00029e50: 2031 3020 696e 2072 616e 6765 286c 656e   10 in range(len
+00029e60: 2861 7267 756d 656e 7473 2929 3a0a 2020  (arguments)):.  
+00029e70: 2020 2020 2020 2020 2020 7765 6967 6874            weight
+00029e80: 5f64 6174 6120 3d20 5b66 6c6f 6174 2869  _data = [float(i
+00029e90: 2920 666f 7220 6920 696e 2061 7267 756d  ) for i in argum
+00029ea0: 656e 7473 5b39 5d5b 313a 2d31 5d2e 7370  ents[9][1:-1].sp
+00029eb0: 6c69 7428 222c 2229 5d0a 2020 2020 2020  lit(",")].      
+00029ec0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00029ed0: 2020 2020 7765 6967 6874 5f64 6174 6120      weight_data 
+00029ee0: 3d20 4e6f 6e65 0a0a 2020 2020 2020 2020  = None..        
+00029ef0: 2320 464f 5243 494e 4720 434c 4f53 4544  # FORCING CLOSED
+00029f00: 5f43 5552 5645 203d 2046 414c 5345 3a0a  _CURVE = FALSE:.
+00029f10: 2020 2020 2020 2020 2320 636c 6f73 6564          # closed
+00029f20: 5f63 7572 7665 203d 2046 616c 7365 0a20  _curve = False. 
+00029f30: 2020 2020 2020 2072 6574 7572 6e20 636c         return cl
+00029f40: 7328 6465 6772 6565 2c20 706f 696e 7473  s(degree, points
+00029f50: 2c20 6b6e 6f74 5f6d 756c 7469 706c 6963  , knot_multiplic
+00029f60: 6974 6965 732c 206b 6e6f 7473 2c20 7765  ities, knots, we
+00029f70: 6967 6874 5f64 6174 612c 0a20 2020 2020  ight_data,.     
+00029f80: 2020 2020 2020 2020 2020 2020 2020 636c                cl
+00029f90: 6f73 6564 5f63 7572 7665 2c20 6e61 6d65  osed_curve, name
+00029fa0: 290a 0a20 2020 2064 6566 2074 6f5f 7374  )..    def to_st
+00029fb0: 6570 2873 656c 662c 2063 7572 7265 6e74  ep(self, current
+00029fc0: 5f69 642c 2073 7572 6661 6365 5f69 643d  _id, surface_id=
+00029fd0: 4e6f 6e65 2c20 6375 7276 6532 643d 4e6f  None, curve2d=No
+00029fe0: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
+00029ff0: 4578 706f 7274 7320 746f 2053 5445 5020  Exports to STEP 
+0002a000: 666f 726d 6174 2e22 2222 0a20 2020 2020  format.""".     
+0002a010: 2020 2070 6f69 6e74 735f 6964 7320 3d20     points_ids = 
+0002a020: 5b5d 0a20 2020 2020 2020 2063 6f6e 7465  [].        conte
+0002a030: 6e74 203d 2027 270a 2020 2020 2020 2020  nt = ''.        
+0002a040: 706f 696e 745f 6964 203d 2063 7572 7265  point_id = curre
+0002a050: 6e74 5f69 640a 2020 2020 2020 2020 666f  nt_id.        fo
+0002a060: 7220 706f 696e 7420 696e 2073 656c 662e  r point in self.
+0002a070: 636f 6e74 726f 6c5f 706f 696e 7473 3a0a  control_points:.
+0002a080: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+0002a090: 745f 636f 6e74 656e 742c 2070 6f69 6e74  t_content, point
+0002a0a0: 5f69 6420 3d20 706f 696e 742e 746f 5f73  _id = point.to_s
+0002a0b0: 7465 7028 706f 696e 745f 6964 2c0a 2020  tep(point_id,.  
 0002a0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a0d0: 2020 7475 706c 6528 7365 6c66 2e6b 6e6f    tuple(self.kno
-0002a0e0: 7473 2929 0a0a 2020 2020 2020 2020 6966  ts))..        if
-0002a0f0: 2073 7572 6661 6365 5f69 643a 0a20 2020   surface_id:.   
-0002a100: 2020 2020 2020 2020 2063 6f6e 7465 6e74           content
-0002a110: 202b 3d20 6622 237b 6375 7276 655f 6964   += f"#{curve_id
-0002a120: 202b 2031 7d20 3d20 5355 5246 4143 455f   + 1} = SURFACE_
-0002a130: 4355 5256 4528 2727 2c23 7b63 7572 7665  CURVE('',#{curve
-0002a140: 5f69 647d 2c28 237b 6375 7276 655f 6964  _id},(#{curve_id
-0002a150: 202b 2032 7d29 2c2e 5043 5552 5645 5f53   + 2}),.PCURVE_S
-0002a160: 312e 293b 5c6e 220a 2020 2020 2020 2020  1.);\n".        
-0002a170: 2020 2020 636f 6e74 656e 7420 2b3d 2066      content += f
-0002a180: 2223 7b63 7572 7665 5f69 6420 2b20 327d  "#{curve_id + 2}
-0002a190: 203d 2050 4355 5256 4528 2727 2c23 7b73   = PCURVE('',#{s
-0002a1a0: 7572 6661 6365 5f69 647d 2c23 7b63 7572  urface_id},#{cur
-0002a1b0: 7665 5f69 6420 2b20 337d 293b 5c6e 220a  ve_id + 3});\n".
-0002a1c0: 0a20 2020 2020 2020 2020 2020 2023 2032  .            # 2
-0002a1d0: 4420 7061 7261 6d65 7472 6963 2063 7572  D parametric cur
-0002a1e0: 7665 0a20 2020 2020 2020 2020 2020 2063  ve.            c
-0002a1f0: 7572 7665 3264 5f63 6f6e 7465 6e74 2c20  urve2d_content, 
-0002a200: 6375 7276 6532 645f 6964 203d 2063 7572  curve2d_id = cur
-0002a210: 7665 3264 2e74 6f5f 7374 6570 2863 7572  ve2d.to_step(cur
-0002a220: 7665 5f69 6420 2b20 3529 0a0a 2020 2020  ve_id + 5)..    
-0002a230: 2020 2020 2020 2020 636f 6e74 656e 7420          content 
-0002a240: 2b3d 2066 2223 7b63 7572 7665 5f69 6420  += f"#{curve_id 
-0002a250: 2b20 337d 203d 2044 4546 494e 4954 494f  + 3} = DEFINITIO
-0002a260: 4e41 4c5f 5245 5052 4553 454e 5441 5449  NAL_REPRESENTATI
-0002a270: 4f4e 2827 272c 2823 7b63 7572 7665 3264  ON('',(#{curve2d
-0002a280: 5f69 6420 2d20 317d 292c 237b 6375 7276  _id - 1}),#{curv
-0002a290: 655f 6964 202b 2034 7d29 3b5c 6e22 0a20  e_id + 4});\n". 
-0002a2a0: 2020 2020 2020 2020 2020 2063 6f6e 7465             conte
-0002a2b0: 6e74 202b 3d20 6622 237b 6375 7276 655f  nt += f"#{curve_
-0002a2c0: 6964 202b 2034 7d20 3d20 2820 4745 4f4d  id + 4} = ( GEOM
-0002a2d0: 4554 5249 435f 5245 5052 4553 454e 5441  ETRIC_REPRESENTA
-0002a2e0: 5449 4f4e 5f43 4f4e 5445 5854 2832 2922  TION_CONTEXT(2)"
-0002a2f0: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
-0002a300: 2020 2020 2020 2020 2020 6622 5041 5241            f"PARA
-0002a310: 4d45 5452 4943 5f52 4550 5245 5345 4e54  METRIC_REPRESENT
-0002a320: 4154 494f 4e5f 434f 4e54 4558 5428 2920  ATION_CONTEXT() 
-0002a330: 5245 5052 4553 454e 5441 5449 4f4e 5f43  REPRESENTATION_C
-0002a340: 4f4e 5445 5854 2827 3244 2053 5041 4345  ONTEXT('2D SPACE
-0002a350: 272c 2727 2920 293b 5c6e 220a 0a20 2020  ','') );\n"..   
-0002a360: 2020 2020 2020 2020 2063 6f6e 7465 6e74           content
-0002a370: 202b 3d20 6375 7276 6532 645f 636f 6e74   += curve2d_cont
-0002a380: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
-0002a390: 6375 7272 656e 745f 6964 203d 2063 7572  current_id = cur
-0002a3a0: 7665 3264 5f69 640a 2020 2020 2020 2020  ve2d_id.        
-0002a3b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0002a3c0: 2020 6375 7272 656e 745f 6964 203d 2063    current_id = c
-0002a3d0: 7572 7665 5f69 6420 2b20 310a 0a20 2020  urve_id + 1..   
-0002a3e0: 2020 2020 2073 7461 7274 5f63 6f6e 7465       start_conte
-0002a3f0: 6e74 2c20 7374 6172 745f 6964 203d 2073  nt, start_id = s
-0002a400: 656c 662e 7374 6172 742e 746f 5f73 7465  elf.start.to_ste
-0002a410: 7028 6375 7272 656e 745f 6964 2c20 7665  p(current_id, ve
-0002a420: 7274 6578 3d54 7275 6529 0a20 2020 2020  rtex=True).     
-0002a430: 2020 2063 7572 7265 6e74 5f69 6420 3d20     current_id = 
-0002a440: 7374 6172 745f 6964 202b 2031 0a20 2020  start_id + 1.   
-0002a450: 2020 2020 2065 6e64 5f63 6f6e 7465 6e74       end_content
-0002a460: 2c20 656e 645f 6964 203d 2073 656c 662e  , end_id = self.
-0002a470: 656e 642e 746f 5f73 7465 7028 6375 7272  end.to_step(curr
-0002a480: 656e 745f 6964 202b 2031 2c20 7665 7274  ent_id + 1, vert
-0002a490: 6578 3d54 7275 6529 0a20 2020 2020 2020  ex=True).       
-0002a4a0: 2063 6f6e 7465 6e74 202b 3d20 7374 6172   content += star
-0002a4b0: 745f 636f 6e74 656e 7420 2b20 656e 645f  t_content + end_
-0002a4c0: 636f 6e74 656e 740a 2020 2020 2020 2020  content.        
-0002a4d0: 6375 7272 656e 745f 6964 203d 2065 6e64  current_id = end
-0002a4e0: 5f69 6420 2b20 310a 2020 2020 2020 2020  _id + 1.        
-0002a4f0: 6966 2073 7572 6661 6365 5f69 643a 0a20  if surface_id:. 
-0002a500: 2020 2020 2020 2020 2020 2063 6f6e 7465             conte
-0002a510: 6e74 202b 3d20 2223 7b7d 203d 2045 4447  nt += "#{} = EDG
-0002a520: 455f 4355 5256 4528 277b 7d27 2c23 7b7d  E_CURVE('{}',#{}
-0002a530: 2c23 7b7d 2c23 7b7d 2c2e 542e 293b 5c6e  ,#{},#{},.T.);\n
-0002a540: 222e 666f 726d 6174 280a 2020 2020 2020  ".format(.      
-0002a550: 2020 2020 2020 2020 2020 6375 7272 656e            curren
-0002a560: 745f 6964 2c20 7365 6c66 2e6e 616d 652c  t_id, self.name,
-0002a570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a580: 2073 7461 7274 5f69 642c 2065 6e64 5f69   start_id, end_i
-0002a590: 642c 2063 7572 7665 5f69 6420 2b20 3129  d, curve_id + 1)
-0002a5a0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0002a5b0: 2020 2020 2020 2020 2020 2063 6f6e 7465             conte
-0002a5c0: 6e74 202b 3d20 2223 7b7d 203d 2045 4447  nt += "#{} = EDG
-0002a5d0: 455f 4355 5256 4528 277b 7d27 2c23 7b7d  E_CURVE('{}',#{}
-0002a5e0: 2c23 7b7d 2c23 7b7d 2c2e 542e 293b 5c6e  ,#{},#{},.T.);\n
-0002a5f0: 222e 666f 726d 6174 280a 2020 2020 2020  ".format(.      
-0002a600: 2020 2020 2020 2020 2020 6375 7272 656e            curren
-0002a610: 745f 6964 2c20 7365 6c66 2e6e 616d 652c  t_id, self.name,
-0002a620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a630: 2073 7461 7274 5f69 642c 2065 6e64 5f69   start_id, end_i
-0002a640: 642c 2063 7572 7665 5f69 6429 0a20 2020  d, curve_id).   
-0002a650: 2020 2020 2072 6574 7572 6e20 636f 6e74       return cont
-0002a660: 656e 742c 205b 6375 7272 656e 745f 6964  ent, [current_id
-0002a670: 5d0a 0a20 2020 2064 6566 2070 6f69 6e74  ]..    def point
-0002a680: 5f64 6973 7461 6e63 6528 7365 6c66 2c20  _distance(self, 
-0002a690: 7074 3129 3a0a 2020 2020 2020 2020 6469  pt1):.        di
-0002a6a0: 7374 616e 6365 7320 3d20 5b5d 0a20 2020  stances = [].   
-0002a6b0: 2020 2020 2066 6f72 2070 6f69 6e74 2069       for point i
-0002a6c0: 6e20 7365 6c66 2e70 6f69 6e74 733a 0a20  n self.points:. 
-0002a6d0: 2020 2020 2020 2020 2020 2023 2020 2020             #    
-0002a6e0: 2020 2020 2020 2020 766d 7074 203d 2050          vmpt = P
-0002a6f0: 6f69 6e74 3344 2828 706f 696e 745b 315d  oint3D((point[1]
-0002a700: 2c20 706f 696e 745b 325d 2c20 706f 696e  , point[2], poin
-0002a710: 745b 335d 2929 0a20 2020 2020 2020 2020  t[3])).         
-0002a720: 2020 2064 6973 7461 6e63 6573 2e61 7070     distances.app
-0002a730: 656e 6428 7074 312e 706f 696e 745f 6469  end(pt1.point_di
-0002a740: 7374 616e 6365 2870 6f69 6e74 2929 0a20  stance(point)). 
-0002a750: 2020 2020 2020 2072 6574 7572 6e20 6d69         return mi
-0002a760: 6e28 6469 7374 616e 6365 7329 0a0a 2020  n(distances)..  
-0002a770: 2020 2320 6465 6620 706f 696e 745f 6265    # def point_be
-0002a780: 6c6f 6e67 7328 7365 6c66 2c20 706f 696e  longs(self, poin
-0002a790: 7429 3a0a 2020 2020 2320 2020 2020 706f  t):.    #     po
-0002a7a0: 6c79 676f 6e5f 706f 696e 7473 203d 2073  lygon_points = s
-0002a7b0: 656c 662e 706f 6c79 676f 6e5f 706f 696e  elf.polygon_poin
-0002a7c0: 7473 2829 0a20 2020 2023 2020 2020 2066  ts().    #     f
-0002a7d0: 6f72 2070 312c 2070 3220 696e 207a 6970  or p1, p2 in zip
-0002a7e0: 2870 6f6c 7967 6f6e 5f70 6f69 6e74 735b  (polygon_points[
-0002a7f0: 3a2d 315d 2c20 706f 6c79 676f 6e5f 706f  :-1], polygon_po
-0002a800: 696e 7473 5b31 3a5d 293a 0a20 2020 2023  ints[1:]):.    #
-0002a810: 2020 2020 2020 2020 206c 696e 6520 3d20           line = 
-0002a820: 4c69 6e65 5365 676d 656e 7433 4428 7031  LineSegment3D(p1
-0002a830: 2c20 7032 290a 2020 2020 2320 2020 2020  , p2).    #     
-0002a840: 2020 2020 6966 206c 696e 652e 706f 696e      if line.poin
-0002a850: 745f 6265 6c6f 6e67 7328 706f 696e 7429  t_belongs(point)
-0002a860: 3a0a 2020 2020 2320 2020 2020 2020 2020  :.    #         
-0002a870: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
-0002a880: 2020 2020 2320 2020 2020 7265 7475 726e      #     return
-0002a890: 2046 616c 7365 0a0a 2020 2020 6465 6620   False..    def 
-0002a8a0: 726f 7461 7469 6f6e 2873 656c 662c 2063  rotation(self, c
-0002a8b0: 656e 7465 723a 2076 6f6c 6d64 6c72 2e50  enter: volmdlr.P
-0002a8c0: 6f69 6e74 3344 2c20 6178 6973 3a20 766f  oint3D, axis: vo
-0002a8d0: 6c6d 646c 722e 5665 6374 6f72 3344 2c20  lmdlr.Vector3D, 
-0002a8e0: 616e 676c 653a 2066 6c6f 6174 293a 0a20  angle: float):. 
-0002a8f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002a900: 2020 2042 5370 6c69 6e65 4375 7276 6533     BSplineCurve3
-0002a910: 4420 726f 7461 7469 6f6e 2e0a 0a20 2020  D rotation...   
-0002a920: 2020 2020 203a 7061 7261 6d20 6365 6e74       :param cent
-0002a930: 6572 3a20 726f 7461 7469 6f6e 2063 656e  er: rotation cen
-0002a940: 7465 720a 2020 2020 2020 2020 3a70 6172  ter.        :par
-0002a950: 616d 2061 7869 733a 2072 6f74 6174 696f  am axis: rotatio
-0002a960: 6e20 6178 6973 0a20 2020 2020 2020 203a  n axis.        :
-0002a970: 7061 7261 6d20 616e 676c 653a 2061 6e67  param angle: ang
-0002a980: 6c65 2072 6f74 6174 696f 6e0a 2020 2020  le rotation.    
-0002a990: 2020 2020 3a72 6574 7572 6e3a 2061 206e      :return: a n
-0002a9a0: 6577 2072 6f74 6174 6564 2042 5370 6c69  ew rotated BSpli
-0002a9b0: 6e65 4375 7276 6533 440a 2020 2020 2020  neCurve3D.      
-0002a9c0: 2020 2222 220a 2020 2020 2020 2020 6e65    """.        ne
-0002a9d0: 775f 636f 6e74 726f 6c5f 706f 696e 7473  w_control_points
-0002a9e0: 203d 205b 702e 726f 7461 7469 6f6e 2863   = [p.rotation(c
-0002a9f0: 656e 7465 722c 2061 7869 732c 2061 6e67  enter, axis, ang
-0002aa00: 6c65 2920 666f 7220 7020 696e 0a20 2020  le) for p in.   
-0002aa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002aa30: 636f 6e74 726f 6c5f 706f 696e 7473 5d0a  control_points].
-0002aa40: 2020 2020 2020 2020 6e65 775f 6273 706c          new_bspl
-0002aa50: 696e 6563 7572 7665 3364 203d 2042 5370  inecurve3d = BSp
-0002aa60: 6c69 6e65 4375 7276 6533 4428 7365 6c66  lineCurve3D(self
-0002aa70: 2e64 6567 7265 652c 206e 6577 5f63 6f6e  .degree, new_con
-0002aa80: 7472 6f6c 5f70 6f69 6e74 732c 0a20 2020  trol_points,.   
-0002aa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aab0: 2020 2020 2020 2020 2073 656c 662e 6b6e           self.kn
-0002aac0: 6f74 5f6d 756c 7469 706c 6963 6974 6965  ot_multiplicitie
-0002aad0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0002aae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aaf0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002ab00: 656c 662e 6b6e 6f74 732c 2073 656c 662e  elf.knots, self.
-0002ab10: 7765 6967 6874 732c 0a20 2020 2020 2020  weights,.       
-0002ab20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ab30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ab40: 2020 2020 2073 656c 662e 7065 7269 6f64       self.period
-0002ab50: 6963 2c20 7365 6c66 2e6e 616d 6529 0a20  ic, self.name). 
-0002ab60: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-0002ab70: 775f 6273 706c 696e 6563 7572 7665 3364  w_bsplinecurve3d
-0002ab80: 0a0a 2020 2020 6465 6620 726f 7461 7469  ..    def rotati
-0002ab90: 6f6e 5f69 6e70 6c61 6365 2873 656c 662c  on_inplace(self,
-0002aba0: 2063 656e 7465 723a 2076 6f6c 6d64 6c72   center: volmdlr
-0002abb0: 2e50 6f69 6e74 3344 2c20 6178 6973 3a20  .Point3D, axis: 
-0002abc0: 766f 6c6d 646c 722e 5665 6374 6f72 3344  volmdlr.Vector3D
-0002abd0: 2c20 616e 676c 653a 2066 6c6f 6174 293a  , angle: float):
-0002abe0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0002abf0: 2020 2020 2042 5370 6c69 6e65 4375 7276       BSplineCurv
-0002ac00: 6533 4420 726f 7461 7469 6f6e 2e20 4f62  e3D rotation. Ob
-0002ac10: 6a65 6374 2069 7320 7570 6461 7465 6420  ject is updated 
-0002ac20: 696e 706c 6163 652e 0a0a 2020 2020 2020  inplace...      
-0002ac30: 2020 3a70 6172 616d 2063 656e 7465 723a    :param center:
-0002ac40: 2072 6f74 6174 696f 6e20 6365 6e74 6572   rotation center
-0002ac50: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0002ac60: 6178 6973 3a20 726f 7461 7469 6f6e 2061  axis: rotation a
-0002ac70: 7869 730a 2020 2020 2020 2020 3a70 6172  xis.        :par
-0002ac80: 616d 2061 6e67 6c65 3a20 726f 7461 7469  am angle: rotati
-0002ac90: 6f6e 2061 6e67 6c65 0a20 2020 2020 2020  on angle.       
-0002aca0: 2022 2222 0a20 2020 2020 2020 2077 6172   """.        war
-0002acb0: 6e69 6e67 732e 7761 726e 2822 2769 6e70  nings.warn("'inp
-0002acc0: 6c61 6365 2720 6d65 7468 6f64 7320 6172  lace' methods ar
-0002acd0: 6520 6465 7072 6563 6174 6564 2e20 5573  e deprecated. Us
-0002ace0: 6520 6120 6e6f 7420 696e 706c 6163 6520  e a not inplace 
-0002acf0: 6d65 7468 6f64 2069 6e73 7465 6164 2e22  method instead."
-0002ad00: 2c20 4465 7072 6563 6174 696f 6e57 6172  , DeprecationWar
-0002ad10: 6e69 6e67 290a 0a20 2020 2020 2020 206e  ning)..        n
-0002ad20: 6577 5f63 6f6e 7472 6f6c 5f70 6f69 6e74  ew_control_point
-0002ad30: 7320 3d20 5b70 2e72 6f74 6174 696f 6e28  s = [p.rotation(
-0002ad40: 6365 6e74 6572 2c20 6178 6973 2c20 616e  center, axis, an
-0002ad50: 676c 6529 2066 6f72 2070 2069 6e0a 2020  gle) for p in.  
-0002ad60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ad70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002ad80: 2e63 6f6e 7472 6f6c 5f70 6f69 6e74 735d  .control_points]
-0002ad90: 0a20 2020 2020 2020 206e 6577 5f62 7370  .        new_bsp
-0002ada0: 6c69 6e65 6375 7276 6533 6420 3d20 4253  linecurve3d = BS
-0002adb0: 706c 696e 6543 7572 7665 3344 2873 656c  plineCurve3D(sel
-0002adc0: 662e 6465 6772 6565 2c20 6e65 775f 636f  f.degree, new_co
-0002add0: 6e74 726f 6c5f 706f 696e 7473 2c0a 2020  ntrol_points,.  
-0002ade0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002adf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ae00: 2020 2020 2020 2020 2020 7365 6c66 2e6b            self.k
-0002ae10: 6e6f 745f 6d75 6c74 6970 6c69 6369 7469  not_multipliciti
-0002ae20: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-0002ae30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ae40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ae50: 7365 6c66 2e6b 6e6f 7473 2c20 7365 6c66  self.knots, self
-0002ae60: 2e77 6569 6768 7473 2c0a 2020 2020 2020  .weights,.      
-0002ae70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ae90: 2020 2020 2020 7365 6c66 2e70 6572 696f        self.perio
-0002aea0: 6469 632c 2073 656c 662e 6e61 6d65 290a  dic, self.name).
-0002aeb0: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
-0002aec0: 7472 6f6c 5f70 6f69 6e74 7320 3d20 6e65  trol_points = ne
-0002aed0: 775f 636f 6e74 726f 6c5f 706f 696e 7473  w_control_points
-0002aee0: 0a20 2020 2020 2020 2073 656c 662e 6375  .        self.cu
-0002aef0: 7276 6520 3d20 6e65 775f 6273 706c 696e  rve = new_bsplin
-0002af00: 6563 7572 7665 3364 2e63 7572 7665 0a20  ecurve3d.curve. 
-0002af10: 2020 2020 2020 2073 656c 662e 706f 696e         self.poin
-0002af20: 7473 203d 206e 6577 5f62 7370 6c69 6e65  ts = new_bspline
-0002af30: 6375 7276 6533 642e 706f 696e 7473 0a20  curve3d.points. 
-0002af40: 2020 2020 2020 2073 656c 662e 5f62 626f         self._bbo
-0002af50: 7820 3d20 4e6f 6e65 0a0a 2020 2020 6465  x = None..    de
-0002af60: 6620 7472 696d 2873 656c 662c 2070 6f69  f trim(self, poi
-0002af70: 6e74 313a 2076 6f6c 6d64 6c72 2e50 6f69  nt1: volmdlr.Poi
-0002af80: 6e74 3344 2c20 706f 696e 7432 3a20 766f  nt3D, point2: vo
-0002af90: 6c6d 646c 722e 506f 696e 7433 4429 3a0a  lmdlr.Point3D):.
-0002afa0: 2020 2020 2020 2020 6966 2028 706f 696e          if (poin
-0002afb0: 7431 203d 3d20 7365 6c66 2e73 7461 7274  t1 == self.start
-0002afc0: 2061 6e64 2070 6f69 6e74 3220 3d3d 2073   and point2 == s
-0002afd0: 656c 662e 656e 6429 205c 0a20 2020 2020  elf.end) \.     
-0002afe0: 2020 2020 2020 2020 2020 206f 7220 2870             or (p
-0002aff0: 6f69 6e74 3120 3d3d 2073 656c 662e 656e  oint1 == self.en
-0002b000: 6420 616e 6420 706f 696e 7432 203d 3d20  d and point2 == 
-0002b010: 7365 6c66 2e73 7461 7274 293a 0a20 2020  self.start):.   
-0002b020: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0002b030: 7365 6c66 0a0a 2020 2020 2020 2020 6966  self..        if
-0002b040: 2070 6f69 6e74 3120 3d3d 2073 656c 662e   point1 == self.
-0002b050: 7374 6172 7420 616e 6420 706f 696e 7432  start and point2
-0002b060: 2021 3d20 7365 6c66 2e65 6e64 3a0a 2020   != self.end:.  
-0002b070: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002b080: 2073 656c 662e 6375 745f 6166 7465 7228   self.cut_after(
-0002b090: 7365 6c66 2e70 6f69 6e74 3364 5f74 6f5f  self.point3d_to_
-0002b0a0: 7061 7261 6d65 7465 7228 706f 696e 7432  parameter(point2
-0002b0b0: 2929 0a0a 2020 2020 2020 2020 6966 2070  ))..        if p
-0002b0c0: 6f69 6e74 3220 3d3d 2073 656c 662e 7374  oint2 == self.st
-0002b0d0: 6172 7420 616e 6420 706f 696e 7431 2021  art and point1 !
-0002b0e0: 3d20 7365 6c66 2e65 6e64 3a0a 2020 2020  = self.end:.    
-0002b0f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002b100: 656c 662e 6375 745f 6166 7465 7228 7365  elf.cut_after(se
-0002b110: 6c66 2e70 6f69 6e74 3364 5f74 6f5f 7061  lf.point3d_to_pa
-0002b120: 7261 6d65 7465 7228 706f 696e 7431 2929  rameter(point1))
-0002b130: 0a0a 2020 2020 2020 2020 6966 2070 6f69  ..        if poi
-0002b140: 6e74 3120 213d 2073 656c 662e 7374 6172  nt1 != self.star
-0002b150: 7420 616e 6420 706f 696e 7432 203d 3d20  t and point2 == 
-0002b160: 7365 6c66 2e65 6e64 3a0a 2020 2020 2020  self.end:.      
-0002b170: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0002b180: 662e 6375 745f 6265 666f 7265 2873 656c  f.cut_before(sel
-0002b190: 662e 706f 696e 7433 645f 746f 5f70 6172  f.point3d_to_par
-0002b1a0: 616d 6574 6572 2870 6f69 6e74 3129 290a  ameter(point1)).
-0002b1b0: 0a20 2020 2020 2020 2069 6620 706f 696e  .        if poin
-0002b1c0: 7432 2021 3d20 7365 6c66 2e73 7461 7274  t2 != self.start
-0002b1d0: 2061 6e64 2070 6f69 6e74 3120 3d3d 2073   and point1 == s
-0002b1e0: 656c 662e 656e 643a 0a20 2020 2020 2020  elf.end:.       
-0002b1f0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0002b200: 2e63 7574 5f62 6566 6f72 6528 7365 6c66  .cut_before(self
-0002b210: 2e70 6f69 6e74 3364 5f74 6f5f 7061 7261  .point3d_to_para
-0002b220: 6d65 7465 7228 706f 696e 7432 2929 0a0a  meter(point2))..
-0002b230: 2020 2020 2020 2020 7061 7261 6d65 7465          paramete
-0002b240: 7231 203d 2073 656c 662e 706f 696e 7433  r1 = self.point3
-0002b250: 645f 746f 5f70 6172 616d 6574 6572 2870  d_to_parameter(p
-0002b260: 6f69 6e74 3129 0a20 2020 2020 2020 2070  oint1).        p
-0002b270: 6172 616d 6574 6572 3220 3d20 7365 6c66  arameter2 = self
-0002b280: 2e70 6f69 6e74 3364 5f74 6f5f 7061 7261  .point3d_to_para
-0002b290: 6d65 7465 7228 706f 696e 7432 290a 2020  meter(point2).  
-0002b2a0: 2020 2020 2020 6966 2070 6172 616d 6574        if paramet
-0002b2b0: 6572 3120 6973 204e 6f6e 6520 6f72 2070  er1 is None or p
-0002b2c0: 6172 616d 6574 6572 3220 6973 204e 6f6e  arameter2 is Non
-0002b2d0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0002b2e0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0002b2f0: 2750 6f69 6e74 206e 6f74 206f 6e20 4253  'Point not on BS
-0002b300: 706c 696e 6543 7572 7665 2066 6f72 2074  plineCurve for t
-0002b310: 7269 6d20 6d65 7468 6f64 2729 0a0a 2020  rim method')..  
-0002b320: 2020 2020 2020 6966 2070 6172 616d 6574        if paramet
-0002b330: 6572 3120 3e20 7061 7261 6d65 7465 7232  er1 > parameter2
-0002b340: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
-0002b350: 7261 6d65 7465 7231 2c20 7061 7261 6d65  rameter1, parame
-0002b360: 7465 7232 203d 2070 6172 616d 6574 6572  ter2 = parameter
-0002b370: 322c 2070 6172 616d 6574 6572 310a 2020  2, parameter1.  
-0002b380: 2020 2020 2020 2020 2020 706f 696e 7431            point1
-0002b390: 2c20 706f 696e 7432 203d 2070 6f69 6e74  , point2 = point
-0002b3a0: 322c 2070 6f69 6e74 310a 0a20 2020 2020  2, point1..     
-0002b3b0: 2020 2062 7370 6c69 6e65 5f63 7572 7665     bspline_curve
-0002b3c0: 203d 2073 656c 662e 6375 745f 6265 666f   = self.cut_befo
-0002b3d0: 7265 2870 6172 616d 6574 6572 3129 0a20  re(parameter1). 
-0002b3e0: 2020 2020 2020 206e 6577 5f70 6172 616d         new_param
-0002b3f0: 3220 3d20 6273 706c 696e 655f 6375 7276  2 = bspline_curv
-0002b400: 652e 706f 696e 7433 645f 746f 5f70 6172  e.point3d_to_par
-0002b410: 616d 6574 6572 2870 6f69 6e74 3229 0a20  ameter(point2). 
-0002b420: 2020 2020 2020 2074 7269 6d6d 6564 5f62         trimmed_b
-0002b430: 7370 6c69 6e65 5f63 7275 7665 203d 2062  spline_cruve = b
-0002b440: 7370 6c69 6e65 5f63 7572 7665 2e63 7574  spline_curve.cut
-0002b450: 5f61 6674 6572 286e 6577 5f70 6172 616d  _after(new_param
-0002b460: 3229 0a20 2020 2020 2020 2072 6574 7572  2).        retur
-0002b470: 6e20 7472 696d 6d65 645f 6273 706c 696e  n trimmed_bsplin
-0002b480: 655f 6372 7576 650a 0a20 2020 2064 6566  e_cruve..    def
-0002b490: 2074 7269 6d5f 6265 7477 6565 6e5f 6576   trim_between_ev
-0002b4a0: 616c 7561 7469 6f6e 7328 7365 6c66 2c20  aluations(self, 
-0002b4b0: 7061 7261 6d65 7465 7231 3a20 666c 6f61  parameter1: floa
-0002b4c0: 742c 2070 6172 616d 6574 6572 323a 2066  t, parameter2: f
-0002b4d0: 6c6f 6174 293a 0a20 2020 2020 2020 2070  loat):.        p
-0002b4e0: 7269 6e74 2827 5573 6520 4253 706c 696e  rint('Use BSplin
-0002b4f0: 6543 7572 7665 3344 2e74 7269 6d20 696e  eCurve3D.trim in
-0002b500: 7374 6561 6420 6f66 2074 7269 6d5f 6265  stead of trim_be
-0002b510: 7477 6565 6e5f 6576 616c 7561 7469 6f6e  tween_evaluation
-0002b520: 2729 0a20 2020 2020 2020 2070 6172 616d  ').        param
-0002b530: 6574 6572 312c 2070 6172 616d 6574 6572  eter1, parameter
-0002b540: 3220 3d20 6d69 6e28 5b70 6172 616d 6574  2 = min([paramet
-0002b550: 6572 312c 2070 6172 616d 6574 6572 325d  er1, parameter2]
-0002b560: 292c 205c 0a20 2020 2020 2020 2020 2020  ), \.           
-0002b570: 206d 6178 285b 7061 7261 6d65 7465 7231   max([parameter1
-0002b580: 2c20 7061 7261 6d65 7465 7232 5d29 0a0a  , parameter2])..
-0002b590: 2020 2020 2020 2020 6966 206d 6174 682e          if math.
-0002b5a0: 6973 636c 6f73 6528 7061 7261 6d65 7465  isclose(paramete
-0002b5b0: 7231 2c20 302c 2061 6273 5f74 6f6c 3d31  r1, 0, abs_tol=1
-0002b5c0: 652d 3729 205c 0a20 2020 2020 2020 2020  e-7) \.         
-0002b5d0: 2020 2020 2020 2061 6e64 206d 6174 682e         and math.
-0002b5e0: 6973 636c 6f73 6528 7061 7261 6d65 7465  isclose(paramete
-0002b5f0: 7232 2c20 312c 2061 6273 5f74 6f6c 3d31  r2, 1, abs_tol=1
-0002b600: 652d 3729 3a0a 2020 2020 2020 2020 2020  e-7):.          
-0002b610: 2020 7265 7475 726e 2073 656c 660a 2020    return self.  
-0002b620: 2020 2020 2020 656c 6966 206d 6174 682e        elif math.
-0002b630: 6973 636c 6f73 6528 7061 7261 6d65 7465  isclose(paramete
-0002b640: 7231 2c20 302c 2061 6273 5f74 6f6c 3d31  r1, 0, abs_tol=1
-0002b650: 652d 3729 3a0a 2020 2020 2020 2020 2020  e-7):.          
-0002b660: 2020 7265 7475 726e 2073 656c 662e 6375    return self.cu
-0002b670: 745f 6166 7465 7228 7061 7261 6d65 7465  t_after(paramete
-0002b680: 7232 290a 2020 2020 2020 2020 656c 6966  r2).        elif
-0002b690: 206d 6174 682e 6973 636c 6f73 6528 7061   math.isclose(pa
-0002b6a0: 7261 6d65 7465 7232 2c20 312c 2061 6273  rameter2, 1, abs
-0002b6b0: 5f74 6f6c 3d31 652d 3729 3a0a 2020 2020  _tol=1e-7):.    
-0002b6c0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002b6d0: 656c 662e 6375 745f 6265 666f 7265 2870  elf.cut_before(p
-0002b6e0: 6172 616d 6574 6572 3129 0a0a 2020 2020  arameter1)..    
-0002b6f0: 2020 2020 2320 4375 7420 6265 666f 7265      # Cut before
-0002b700: 0a20 2020 2020 2020 2062 7370 6c69 6e65  .        bspline
-0002b710: 5f63 7572 7665 203d 2073 656c 662e 696e  _curve = self.in
-0002b720: 7365 7274 5f6b 6e6f 7428 7061 7261 6d65  sert_knot(parame
-0002b730: 7465 7231 2c20 6e75 6d3d 7365 6c66 2e64  ter1, num=self.d
-0002b740: 6567 7265 6529 0a20 2020 2020 2020 2069  egree).        i
-0002b750: 6620 6273 706c 696e 655f 6375 7276 652e  f bspline_curve.
-0002b760: 7765 6967 6874 7320 6973 206e 6f74 204e  weights is not N
-0002b770: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0002b780: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-0002b790: 656e 7465 6445 7272 6f72 0a0a 2020 2020  entedError..    
-0002b7a0: 2020 2020 2320 4375 7420 6166 7465 720a      # Cut after.
-0002b7b0: 2020 2020 2020 2020 6273 706c 696e 655f          bspline_
-0002b7c0: 6375 7276 6520 3d20 6273 706c 696e 655f  curve = bspline_
-0002b7d0: 6375 7276 652e 696e 7365 7274 5f6b 6e6f  curve.insert_kno
-0002b7e0: 7428 7061 7261 6d65 7465 7232 2c20 6e75  t(parameter2, nu
-0002b7f0: 6d3d 7365 6c66 2e64 6567 7265 6529 0a20  m=self.degree). 
-0002b800: 2020 2020 2020 2069 6620 6273 706c 696e         if bsplin
-0002b810: 655f 6375 7276 652e 7765 6967 6874 7320  e_curve.weights 
-0002b820: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0002b830: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0002b840: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0002b850: 6f72 0a0a 2020 2020 2020 2020 6e65 775f  or..        new_
-0002b860: 6374 726c 7074 7320 3d20 6273 706c 696e  ctrlpts = bsplin
-0002b870: 655f 6375 7276 652e 636f 6e74 726f 6c5f  e_curve.control_
-0002b880: 706f 696e 7473 5b62 7370 6c69 6e65 5f63  points[bspline_c
-0002b890: 7572 7665 2e64 6567 7265 653a 0a20 2020  urve.degree:.   
-0002b8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b8d0: 2d62 7370 6c69 6e65 5f63 7572 7665 2e64  -bspline_curve.d
-0002b8e0: 6567 7265 655d 0a20 2020 2020 2020 206e  egree].        n
-0002b8f0: 6577 5f6d 756c 7469 706c 6963 6974 6965  ew_multiplicitie
-0002b900: 7320 3d20 6273 706c 696e 655f 6375 7276  s = bspline_curv
-0002b910: 652e 6b6e 6f74 5f6d 756c 7469 706c 6963  e.knot_multiplic
-0002b920: 6974 6965 735b 313a 2d31 5d0a 2020 2020  ities[1:-1].    
-0002b930: 2020 2020 2320 6e65 775f 6d75 6c74 6970      # new_multip
-0002b940: 6c69 6369 7469 6573 203d 2062 7370 6c69  licities = bspli
-0002b950: 6e65 5f63 7572 7665 2e6b 6e6f 745f 6d75  ne_curve.knot_mu
-0002b960: 6c74 6970 6c69 6369 7469 6573 5b32 3a2d  ltiplicities[2:-
-0002b970: 355d 0a20 2020 2020 2020 206e 6577 5f6d  5].        new_m
-0002b980: 756c 7469 706c 6963 6974 6965 735b 2d31  ultiplicities[-1
-0002b990: 5d20 2b3d 2031 0a20 2020 2020 2020 206e  ] += 1.        n
-0002b9a0: 6577 5f6d 756c 7469 706c 6963 6974 6965  ew_multiplicitie
-0002b9b0: 735b 305d 202b 3d20 310a 2020 2020 2020  s[0] += 1.      
-0002b9c0: 2020 6e65 775f 6b6e 6f74 7320 3d20 6273    new_knots = bs
-0002b9d0: 706c 696e 655f 6375 7276 652e 6b6e 6f74  pline_curve.knot
-0002b9e0: 735b 313a 2d31 5d0a 2020 2020 2020 2020  s[1:-1].        
-0002b9f0: 2320 6e65 775f 6b6e 6f74 7320 3d20 6273  # new_knots = bs
-0002ba00: 706c 696e 655f 6375 7276 652e 6b6e 6f74  pline_curve.knot
-0002ba10: 735b 323a 2d35 5d0a 2020 2020 2020 2020  s[2:-5].        
-0002ba20: 6e65 775f 6b6e 6f74 7320 3d20 7374 616e  new_knots = stan
-0002ba30: 6461 7264 697a 655f 6b6e 6f74 5f76 6563  dardize_knot_vec
-0002ba40: 746f 7228 6e65 775f 6b6e 6f74 7329 0a0a  tor(new_knots)..
-0002ba50: 2020 2020 2020 2020 7265 7475 726e 2042          return B
-0002ba60: 5370 6c69 6e65 4375 7276 6533 4428 6465  SplineCurve3D(de
-0002ba70: 6772 6565 3d62 7370 6c69 6e65 5f63 7572  gree=bspline_cur
-0002ba80: 7665 2e64 6567 7265 652c 0a20 2020 2020  ve.degree,.     
-0002ba90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002baa0: 2020 2020 2020 2020 2063 6f6e 7472 6f6c           control
-0002bab0: 5f70 6f69 6e74 733d 6e65 775f 6374 726c  _points=new_ctrl
-0002bac0: 7074 732c 0a20 2020 2020 2020 2020 2020  pts,.           
-0002bad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bae0: 2020 206b 6e6f 745f 6d75 6c74 6970 6c69     knot_multipli
-0002baf0: 6369 7469 6573 3d6e 6577 5f6d 756c 7469  cities=new_multi
-0002bb00: 706c 6963 6974 6965 732c 0a20 2020 2020  plicities,.     
+0002a0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a0f0: 2020 7665 7274 6578 3d46 616c 7365 290a    vertex=False).
+0002a100: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0002a110: 656e 7420 2b3d 2070 6f69 6e74 5f63 6f6e  ent += point_con
+0002a120: 7465 6e74 0a20 2020 2020 2020 2020 2020  tent.           
+0002a130: 2070 6f69 6e74 735f 6964 732e 6170 7065   points_ids.appe
+0002a140: 6e64 2870 6f69 6e74 5f69 6429 0a20 2020  nd(point_id).   
+0002a150: 2020 2020 2020 2020 2070 6f69 6e74 5f69           point_i
+0002a160: 6420 2b3d 2031 0a0a 2020 2020 2020 2020  d += 1..        
+0002a170: 6375 7276 655f 6964 203d 2070 6f69 6e74  curve_id = point
+0002a180: 5f69 640a 2020 2020 2020 2020 636f 6e74  _id.        cont
+0002a190: 656e 7420 2b3d 2022 237b 7d20 3d20 425f  ent += "#{} = B_
+0002a1a0: 5350 4c49 4e45 5f43 5552 5645 5f57 4954  SPLINE_CURVE_WIT
+0002a1b0: 485f 4b4e 4f54 5328 277b 7d27 2c7b 7d2c  H_KNOTS('{}',{},
+0002a1c0: 287b 7d29 2c22 205c 0a20 2020 2020 2020  ({})," \.       
+0002a1d0: 2020 2020 2020 2020 2020 2020 222e 554e              ".UN
+0002a1e0: 5350 4543 4946 4945 442e 2c2e 462e 2c2e  SPECIFIED.,.F.,.
+0002a1f0: 462e 2c7b 7d2c 7b7d 2c22 205c 0a20 2020  F.,{},{}," \.   
+0002a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a210: 222e 554e 5350 4543 4946 4945 442e 293b  ".UNSPECIFIED.);
+0002a220: 5c6e 222e 666f 726d 6174 280a 2020 2020  \n".format(.    
+0002a230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a240: 2020 2063 7572 7665 5f69 642c 2073 656c     curve_id, sel
+0002a250: 662e 6e61 6d65 2c20 7365 6c66 2e64 6567  f.name, self.deg
+0002a260: 7265 652c 0a20 2020 2020 2020 2020 2020  ree,.           
+0002a270: 2020 2020 2020 2020 2020 2020 766f 6c6d              volm
+0002a280: 646c 722e 636f 7265 2e73 7465 705f 6964  dlr.core.step_id
+0002a290: 735f 746f 5f73 7472 2870 6f69 6e74 735f  s_to_str(points_
+0002a2a0: 6964 7329 2c0a 2020 2020 2020 2020 2020  ids),.          
+0002a2b0: 2020 2020 2020 2020 2020 2020 2074 7570               tup
+0002a2c0: 6c65 2873 656c 662e 6b6e 6f74 5f6d 756c  le(self.knot_mul
+0002a2d0: 7469 706c 6963 6974 6965 7329 2c0a 2020  tiplicities),.  
+0002a2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a2f0: 2020 2020 2074 7570 6c65 2873 656c 662e       tuple(self.
+0002a300: 6b6e 6f74 7329 290a 0a20 2020 2020 2020  knots))..       
+0002a310: 2069 6620 7375 7266 6163 655f 6964 3a0a   if surface_id:.
+0002a320: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0002a330: 656e 7420 2b3d 2066 2223 7b63 7572 7665  ent += f"#{curve
+0002a340: 5f69 6420 2b20 317d 203d 2053 5552 4641  _id + 1} = SURFA
+0002a350: 4345 5f43 5552 5645 2827 272c 237b 6375  CE_CURVE('',#{cu
+0002a360: 7276 655f 6964 7d2c 2823 7b63 7572 7665  rve_id},(#{curve
+0002a370: 5f69 6420 2b20 327d 292c 2e50 4355 5256  _id + 2}),.PCURV
+0002a380: 455f 5331 2e29 3b5c 6e22 0a20 2020 2020  E_S1.);\n".     
+0002a390: 2020 2020 2020 2063 6f6e 7465 6e74 202b         content +
+0002a3a0: 3d20 6622 237b 6375 7276 655f 6964 202b  = f"#{curve_id +
+0002a3b0: 2032 7d20 3d20 5043 5552 5645 2827 272c   2} = PCURVE('',
+0002a3c0: 237b 7375 7266 6163 655f 6964 7d2c 237b  #{surface_id},#{
+0002a3d0: 6375 7276 655f 6964 202b 2033 7d29 3b5c  curve_id + 3});\
+0002a3e0: 6e22 0a0a 2020 2020 2020 2020 2020 2020  n"..            
+0002a3f0: 2320 3244 2070 6172 616d 6574 7269 6320  # 2D parametric 
+0002a400: 6375 7276 650a 2020 2020 2020 2020 2020  curve.          
+0002a410: 2020 6375 7276 6532 645f 636f 6e74 656e    curve2d_conten
+0002a420: 742c 2063 7572 7665 3264 5f69 6420 3d20  t, curve2d_id = 
+0002a430: 6375 7276 6532 642e 746f 5f73 7465 7028  curve2d.to_step(
+0002a440: 6375 7276 655f 6964 202b 2035 290a 0a20  curve_id + 5).. 
+0002a450: 2020 2020 2020 2020 2020 2063 6f6e 7465             conte
+0002a460: 6e74 202b 3d20 6622 237b 6375 7276 655f  nt += f"#{curve_
+0002a470: 6964 202b 2033 7d20 3d20 4445 4649 4e49  id + 3} = DEFINI
+0002a480: 5449 4f4e 414c 5f52 4550 5245 5345 4e54  TIONAL_REPRESENT
+0002a490: 4154 494f 4e28 2727 2c28 237b 6375 7276  ATION('',(#{curv
+0002a4a0: 6532 645f 6964 202d 2031 7d29 2c23 7b63  e2d_id - 1}),#{c
+0002a4b0: 7572 7665 5f69 6420 2b20 347d 293b 5c6e  urve_id + 4});\n
+0002a4c0: 220a 2020 2020 2020 2020 2020 2020 636f  ".            co
+0002a4d0: 6e74 656e 7420 2b3d 2066 2223 7b63 7572  ntent += f"#{cur
+0002a4e0: 7665 5f69 6420 2b20 347d 203d 2028 2047  ve_id + 4} = ( G
+0002a4f0: 454f 4d45 5452 4943 5f52 4550 5245 5345  EOMETRIC_REPRESE
+0002a500: 4e54 4154 494f 4e5f 434f 4e54 4558 5428  NTATION_CONTEXT(
+0002a510: 3229 2220 5c0a 2020 2020 2020 2020 2020  2)" \.          
+0002a520: 2020 2020 2020 2020 2020 2020 2066 2250               f"P
+0002a530: 4152 414d 4554 5249 435f 5245 5052 4553  ARAMETRIC_REPRES
+0002a540: 454e 5441 5449 4f4e 5f43 4f4e 5445 5854  ENTATION_CONTEXT
+0002a550: 2829 2052 4550 5245 5345 4e54 4154 494f  () REPRESENTATIO
+0002a560: 4e5f 434f 4e54 4558 5428 2732 4420 5350  N_CONTEXT('2D SP
+0002a570: 4143 4527 2c27 2729 2029 3b5c 6e22 0a0a  ACE','') );\n"..
+0002a580: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0002a590: 656e 7420 2b3d 2063 7572 7665 3264 5f63  ent += curve2d_c
+0002a5a0: 6f6e 7465 6e74 0a20 2020 2020 2020 2020  ontent.         
+0002a5b0: 2020 2063 7572 7265 6e74 5f69 6420 3d20     current_id = 
+0002a5c0: 6375 7276 6532 645f 6964 0a20 2020 2020  curve2d_id.     
+0002a5d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002a5e0: 2020 2020 2063 7572 7265 6e74 5f69 6420       current_id 
+0002a5f0: 3d20 6375 7276 655f 6964 202b 2031 0a0a  = curve_id + 1..
+0002a600: 2020 2020 2020 2020 7374 6172 745f 636f          start_co
+0002a610: 6e74 656e 742c 2073 7461 7274 5f69 6420  ntent, start_id 
+0002a620: 3d20 7365 6c66 2e73 7461 7274 2e74 6f5f  = self.start.to_
+0002a630: 7374 6570 2863 7572 7265 6e74 5f69 642c  step(current_id,
+0002a640: 2076 6572 7465 783d 5472 7565 290a 2020   vertex=True).  
+0002a650: 2020 2020 2020 6375 7272 656e 745f 6964        current_id
+0002a660: 203d 2073 7461 7274 5f69 6420 2b20 310a   = start_id + 1.
+0002a670: 2020 2020 2020 2020 656e 645f 636f 6e74          end_cont
+0002a680: 656e 742c 2065 6e64 5f69 6420 3d20 7365  ent, end_id = se
+0002a690: 6c66 2e65 6e64 2e74 6f5f 7374 6570 2863  lf.end.to_step(c
+0002a6a0: 7572 7265 6e74 5f69 6420 2b20 312c 2076  urrent_id + 1, v
+0002a6b0: 6572 7465 783d 5472 7565 290a 2020 2020  ertex=True).    
+0002a6c0: 2020 2020 636f 6e74 656e 7420 2b3d 2073      content += s
+0002a6d0: 7461 7274 5f63 6f6e 7465 6e74 202b 2065  tart_content + e
+0002a6e0: 6e64 5f63 6f6e 7465 6e74 0a20 2020 2020  nd_content.     
+0002a6f0: 2020 2063 7572 7265 6e74 5f69 6420 3d20     current_id = 
+0002a700: 656e 645f 6964 202b 2031 0a20 2020 2020  end_id + 1.     
+0002a710: 2020 2069 6620 7375 7266 6163 655f 6964     if surface_id
+0002a720: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+0002a730: 6e74 656e 7420 2b3d 2022 237b 7d20 3d20  ntent += "#{} = 
+0002a740: 4544 4745 5f43 5552 5645 2827 7b7d 272c  EDGE_CURVE('{}',
+0002a750: 237b 7d2c 237b 7d2c 237b 7d2c 2e54 2e29  #{},#{},#{},.T.)
+0002a760: 3b5c 6e22 2e66 6f72 6d61 7428 0a20 2020  ;\n".format(.   
+0002a770: 2020 2020 2020 2020 2020 2020 2063 7572               cur
+0002a780: 7265 6e74 5f69 642c 2073 656c 662e 6e61  rent_id, self.na
+0002a790: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0002a7a0: 2020 2020 7374 6172 745f 6964 2c20 656e      start_id, en
+0002a7b0: 645f 6964 2c20 6375 7276 655f 6964 202b  d_id, curve_id +
+0002a7c0: 2031 290a 2020 2020 2020 2020 656c 7365   1).        else
+0002a7d0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+0002a7e0: 6e74 656e 7420 2b3d 2022 237b 7d20 3d20  ntent += "#{} = 
+0002a7f0: 4544 4745 5f43 5552 5645 2827 7b7d 272c  EDGE_CURVE('{}',
+0002a800: 237b 7d2c 237b 7d2c 237b 7d2c 2e54 2e29  #{},#{},#{},.T.)
+0002a810: 3b5c 6e22 2e66 6f72 6d61 7428 0a20 2020  ;\n".format(.   
+0002a820: 2020 2020 2020 2020 2020 2020 2063 7572               cur
+0002a830: 7265 6e74 5f69 642c 2073 656c 662e 6e61  rent_id, self.na
+0002a840: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0002a850: 2020 2020 7374 6172 745f 6964 2c20 656e      start_id, en
+0002a860: 645f 6964 2c20 6375 7276 655f 6964 290a  d_id, curve_id).
+0002a870: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+0002a880: 6f6e 7465 6e74 2c20 5b63 7572 7265 6e74  ontent, [current
+0002a890: 5f69 645d 0a0a 2020 2020 6465 6620 706f  _id]..    def po
+0002a8a0: 696e 745f 6469 7374 616e 6365 2873 656c  int_distance(sel
+0002a8b0: 662c 2070 7431 293a 0a20 2020 2020 2020  f, pt1):.       
+0002a8c0: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
+0002a8d0: 6d69 6e69 6d61 6c20 6469 7374 616e 6365  minimal distance
+0002a8e0: 2074 6f20 6120 706f 696e 742e 2222 220a   to a point.""".
+0002a8f0: 2020 2020 2020 2020 6469 7374 616e 6365          distance
+0002a900: 7320 3d20 5b5d 0a20 2020 2020 2020 2066  s = [].        f
+0002a910: 6f72 2070 6f69 6e74 2069 6e20 7365 6c66  or point in self
+0002a920: 2e70 6f69 6e74 733a 0a20 2020 2020 2020  .points:.       
+0002a930: 2020 2020 2023 2020 2020 2020 2020 2020       #          
+0002a940: 2020 766d 7074 203d 2050 6f69 6e74 3344    vmpt = Point3D
+0002a950: 2828 706f 696e 745b 315d 2c20 706f 696e  ((point[1], poin
+0002a960: 745b 325d 2c20 706f 696e 745b 335d 2929  t[2], point[3]))
+0002a970: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+0002a980: 7461 6e63 6573 2e61 7070 656e 6428 7074  tances.append(pt
+0002a990: 312e 706f 696e 745f 6469 7374 616e 6365  1.point_distance
+0002a9a0: 2870 6f69 6e74 2929 0a20 2020 2020 2020  (point)).       
+0002a9b0: 2072 6574 7572 6e20 6d69 6e28 6469 7374   return min(dist
+0002a9c0: 616e 6365 7329 0a0a 2020 2020 2320 6465  ances)..    # de
+0002a9d0: 6620 706f 696e 745f 6265 6c6f 6e67 7328  f point_belongs(
+0002a9e0: 7365 6c66 2c20 706f 696e 7429 3a0a 2020  self, point):.  
+0002a9f0: 2020 2320 2020 2020 706f 6c79 676f 6e5f    #     polygon_
+0002aa00: 706f 696e 7473 203d 2073 656c 662e 706f  points = self.po
+0002aa10: 6c79 676f 6e5f 706f 696e 7473 2829 0a20  lygon_points(). 
+0002aa20: 2020 2023 2020 2020 2066 6f72 2070 312c     #     for p1,
+0002aa30: 2070 3220 696e 207a 6970 2870 6f6c 7967   p2 in zip(polyg
+0002aa40: 6f6e 5f70 6f69 6e74 735b 3a2d 315d 2c20  on_points[:-1], 
+0002aa50: 706f 6c79 676f 6e5f 706f 696e 7473 5b31  polygon_points[1
+0002aa60: 3a5d 293a 0a20 2020 2023 2020 2020 2020  :]):.    #      
+0002aa70: 2020 206c 696e 6520 3d20 4c69 6e65 5365     line = LineSe
+0002aa80: 676d 656e 7433 4428 7031 2c20 7032 290a  gment3D(p1, p2).
+0002aa90: 2020 2020 2320 2020 2020 2020 2020 6966      #         if
+0002aaa0: 206c 696e 652e 706f 696e 745f 6265 6c6f   line.point_belo
+0002aab0: 6e67 7328 706f 696e 7429 3a0a 2020 2020  ngs(point):.    
+0002aac0: 2320 2020 2020 2020 2020 2020 2020 7265  #             re
+0002aad0: 7475 726e 2054 7275 650a 2020 2020 2320  turn True.    # 
+0002aae0: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+0002aaf0: 0a0a 2020 2020 6465 6620 726f 7461 7469  ..    def rotati
+0002ab00: 6f6e 2873 656c 662c 2063 656e 7465 723a  on(self, center:
+0002ab10: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3344   volmdlr.Point3D
+0002ab20: 2c20 6178 6973 3a20 766f 6c6d 646c 722e  , axis: volmdlr.
+0002ab30: 5665 6374 6f72 3344 2c20 616e 676c 653a  Vector3D, angle:
+0002ab40: 2066 6c6f 6174 293a 0a20 2020 2020 2020   float):.       
+0002ab50: 2022 2222 0a20 2020 2020 2020 2042 5370   """.        BSp
+0002ab60: 6c69 6e65 4375 7276 6533 4420 726f 7461  lineCurve3D rota
+0002ab70: 7469 6f6e 2e0a 0a20 2020 2020 2020 203a  tion...        :
+0002ab80: 7061 7261 6d20 6365 6e74 6572 3a20 726f  param center: ro
+0002ab90: 7461 7469 6f6e 2063 656e 7465 720a 2020  tation center.  
+0002aba0: 2020 2020 2020 3a70 6172 616d 2061 7869        :param axi
+0002abb0: 733a 2072 6f74 6174 696f 6e20 6178 6973  s: rotation axis
+0002abc0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0002abd0: 616e 676c 653a 2061 6e67 6c65 2072 6f74  angle: angle rot
+0002abe0: 6174 696f 6e0a 2020 2020 2020 2020 3a72  ation.        :r
+0002abf0: 6574 7572 6e3a 2061 206e 6577 2072 6f74  eturn: a new rot
+0002ac00: 6174 6564 2042 5370 6c69 6e65 4375 7276  ated BSplineCurv
+0002ac10: 6533 440a 2020 2020 2020 2020 2222 220a  e3D.        """.
+0002ac20: 2020 2020 2020 2020 6e65 775f 636f 6e74          new_cont
+0002ac30: 726f 6c5f 706f 696e 7473 203d 205b 702e  rol_points = [p.
+0002ac40: 726f 7461 7469 6f6e 2863 656e 7465 722c  rotation(center,
+0002ac50: 2061 7869 732c 2061 6e67 6c65 2920 666f   axis, angle) fo
+0002ac60: 7220 7020 696e 0a20 2020 2020 2020 2020  r p in.         
+0002ac70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ac80: 2020 2020 2073 656c 662e 636f 6e74 726f       self.contro
+0002ac90: 6c5f 706f 696e 7473 5d0a 2020 2020 2020  l_points].      
+0002aca0: 2020 6e65 775f 6273 706c 696e 6563 7572    new_bsplinecur
+0002acb0: 7665 3364 203d 2042 5370 6c69 6e65 4375  ve3d = BSplineCu
+0002acc0: 7276 6533 4428 7365 6c66 2e64 6567 7265  rve3D(self.degre
+0002acd0: 652c 206e 6577 5f63 6f6e 7472 6f6c 5f70  e, new_control_p
+0002ace0: 6f69 6e74 732c 0a20 2020 2020 2020 2020  oints,.         
+0002acf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ad00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ad10: 2020 2073 656c 662e 6b6e 6f74 5f6d 756c     self.knot_mul
+0002ad20: 7469 706c 6963 6974 6965 732c 0a20 2020  tiplicities,.   
+0002ad30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ad40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ad50: 2020 2020 2020 2020 2073 656c 662e 6b6e           self.kn
+0002ad60: 6f74 732c 2073 656c 662e 7765 6967 6874  ots, self.weight
+0002ad70: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0002ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ad90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0002ada0: 656c 662e 7065 7269 6f64 6963 2c20 7365  elf.periodic, se
+0002adb0: 6c66 2e6e 616d 6529 0a20 2020 2020 2020  lf.name).       
+0002adc0: 2072 6574 7572 6e20 6e65 775f 6273 706c   return new_bspl
+0002add0: 696e 6563 7572 7665 3364 0a0a 2020 2020  inecurve3d..    
+0002ade0: 6465 6620 726f 7461 7469 6f6e 5f69 6e70  def rotation_inp
+0002adf0: 6c61 6365 2873 656c 662c 2063 656e 7465  lace(self, cente
+0002ae00: 723a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  r: volmdlr.Point
+0002ae10: 3344 2c20 6178 6973 3a20 766f 6c6d 646c  3D, axis: volmdl
+0002ae20: 722e 5665 6374 6f72 3344 2c20 616e 676c  r.Vector3D, angl
+0002ae30: 653a 2066 6c6f 6174 293a 0a20 2020 2020  e: float):.     
+0002ae40: 2020 2022 2222 0a20 2020 2020 2020 2042     """.        B
+0002ae50: 5370 6c69 6e65 4375 7276 6533 4420 726f  SplineCurve3D ro
+0002ae60: 7461 7469 6f6e 2e20 4f62 6a65 6374 2069  tation. Object i
+0002ae70: 7320 7570 6461 7465 6420 696e 706c 6163  s updated inplac
+0002ae80: 652e 0a0a 2020 2020 2020 2020 3a70 6172  e...        :par
+0002ae90: 616d 2063 656e 7465 723a 2072 6f74 6174  am center: rotat
+0002aea0: 696f 6e20 6365 6e74 6572 0a20 2020 2020  ion center.     
+0002aeb0: 2020 203a 7061 7261 6d20 6178 6973 3a20     :param axis: 
+0002aec0: 726f 7461 7469 6f6e 2061 7869 730a 2020  rotation axis.  
+0002aed0: 2020 2020 2020 3a70 6172 616d 2061 6e67        :param ang
+0002aee0: 6c65 3a20 726f 7461 7469 6f6e 2061 6e67  le: rotation ang
+0002aef0: 6c65 0a20 2020 2020 2020 2022 2222 0a20  le.        """. 
+0002af00: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+0002af10: 7761 726e 2822 2769 6e70 6c61 6365 2720  warn("'inplace' 
+0002af20: 6d65 7468 6f64 7320 6172 6520 6465 7072  methods are depr
+0002af30: 6563 6174 6564 2e20 5573 6520 6120 6e6f  ecated. Use a no
+0002af40: 7420 696e 706c 6163 6520 6d65 7468 6f64  t inplace method
+0002af50: 2069 6e73 7465 6164 2e22 2c20 4465 7072   instead.", Depr
+0002af60: 6563 6174 696f 6e57 6172 6e69 6e67 290a  ecationWarning).
+0002af70: 0a20 2020 2020 2020 206e 6577 5f63 6f6e  .        new_con
+0002af80: 7472 6f6c 5f70 6f69 6e74 7320 3d20 5b70  trol_points = [p
+0002af90: 2e72 6f74 6174 696f 6e28 6365 6e74 6572  .rotation(center
+0002afa0: 2c20 6178 6973 2c20 616e 676c 6529 2066  , axis, angle) f
+0002afb0: 6f72 2070 2069 6e0a 2020 2020 2020 2020  or p in.        
+0002afc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002afd0: 2020 2020 2020 7365 6c66 2e63 6f6e 7472        self.contr
+0002afe0: 6f6c 5f70 6f69 6e74 735d 0a20 2020 2020  ol_points].     
+0002aff0: 2020 206e 6577 5f62 7370 6c69 6e65 6375     new_bsplinecu
+0002b000: 7276 6533 6420 3d20 4253 706c 696e 6543  rve3d = BSplineC
+0002b010: 7572 7665 3344 2873 656c 662e 6465 6772  urve3D(self.degr
+0002b020: 6565 2c20 6e65 775f 636f 6e74 726f 6c5f  ee, new_control_
+0002b030: 706f 696e 7473 2c0a 2020 2020 2020 2020  points,.        
+0002b040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b060: 2020 2020 7365 6c66 2e6b 6e6f 745f 6d75      self.knot_mu
+0002b070: 6c74 6970 6c69 6369 7469 6573 2c0a 2020  ltiplicities,.  
+0002b080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b0a0: 2020 2020 2020 2020 2020 7365 6c66 2e6b            self.k
+0002b0b0: 6e6f 7473 2c20 7365 6c66 2e77 6569 6768  nots, self.weigh
+0002b0c0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+0002b0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b0f0: 7365 6c66 2e70 6572 696f 6469 632c 2073  self.periodic, s
+0002b100: 656c 662e 6e61 6d65 290a 2020 2020 2020  elf.name).      
+0002b110: 2020 7365 6c66 2e63 6f6e 7472 6f6c 5f70    self.control_p
+0002b120: 6f69 6e74 7320 3d20 6e65 775f 636f 6e74  oints = new_cont
+0002b130: 726f 6c5f 706f 696e 7473 0a20 2020 2020  rol_points.     
+0002b140: 2020 2073 656c 662e 6375 7276 6520 3d20     self.curve = 
+0002b150: 6e65 775f 6273 706c 696e 6563 7572 7665  new_bsplinecurve
+0002b160: 3364 2e63 7572 7665 0a20 2020 2020 2020  3d.curve.       
+0002b170: 2073 656c 662e 706f 696e 7473 203d 206e   self.points = n
+0002b180: 6577 5f62 7370 6c69 6e65 6375 7276 6533  ew_bsplinecurve3
+0002b190: 642e 706f 696e 7473 0a20 2020 2020 2020  d.points.       
+0002b1a0: 2073 656c 662e 5f62 626f 7820 3d20 4e6f   self._bbox = No
+0002b1b0: 6e65 0a0a 2020 2020 6465 6620 7472 696d  ne..    def trim
+0002b1c0: 2873 656c 662c 2070 6f69 6e74 313a 2076  (self, point1: v
+0002b1d0: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 2c20  olmdlr.Point3D, 
+0002b1e0: 706f 696e 7432 3a20 766f 6c6d 646c 722e  point2: volmdlr.
+0002b1f0: 506f 696e 7433 4429 3a0a 2020 2020 2020  Point3D):.      
+0002b200: 2020 6966 2028 706f 696e 7431 203d 3d20    if (point1 == 
+0002b210: 7365 6c66 2e73 7461 7274 2061 6e64 2070  self.start and p
+0002b220: 6f69 6e74 3220 3d3d 2073 656c 662e 656e  oint2 == self.en
+0002b230: 6429 205c 0a20 2020 2020 2020 2020 2020  d) \.           
+0002b240: 2020 2020 206f 7220 2870 6f69 6e74 3120       or (point1 
+0002b250: 3d3d 2073 656c 662e 656e 6420 616e 6420  == self.end and 
+0002b260: 706f 696e 7432 203d 3d20 7365 6c66 2e73  point2 == self.s
+0002b270: 7461 7274 293a 0a20 2020 2020 2020 2020  tart):.         
+0002b280: 2020 2072 6574 7572 6e20 7365 6c66 0a0a     return self..
+0002b290: 2020 2020 2020 2020 6966 2070 6f69 6e74          if point
+0002b2a0: 3120 3d3d 2073 656c 662e 7374 6172 7420  1 == self.start 
+0002b2b0: 616e 6420 706f 696e 7432 2021 3d20 7365  and point2 != se
+0002b2c0: 6c66 2e65 6e64 3a0a 2020 2020 2020 2020  lf.end:.        
+0002b2d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0002b2e0: 6375 745f 6166 7465 7228 7365 6c66 2e70  cut_after(self.p
+0002b2f0: 6f69 6e74 3364 5f74 6f5f 7061 7261 6d65  oint3d_to_parame
+0002b300: 7465 7228 706f 696e 7432 2929 0a0a 2020  ter(point2))..  
+0002b310: 2020 2020 2020 6966 2070 6f69 6e74 3220        if point2 
+0002b320: 3d3d 2073 656c 662e 7374 6172 7420 616e  == self.start an
+0002b330: 6420 706f 696e 7431 2021 3d20 7365 6c66  d point1 != self
+0002b340: 2e65 6e64 3a0a 2020 2020 2020 2020 2020  .end:.          
+0002b350: 2020 7265 7475 726e 2073 656c 662e 6375    return self.cu
+0002b360: 745f 6166 7465 7228 7365 6c66 2e70 6f69  t_after(self.poi
+0002b370: 6e74 3364 5f74 6f5f 7061 7261 6d65 7465  nt3d_to_paramete
+0002b380: 7228 706f 696e 7431 2929 0a0a 2020 2020  r(point1))..    
+0002b390: 2020 2020 6966 2070 6f69 6e74 3120 213d      if point1 !=
+0002b3a0: 2073 656c 662e 7374 6172 7420 616e 6420   self.start and 
+0002b3b0: 706f 696e 7432 203d 3d20 7365 6c66 2e65  point2 == self.e
+0002b3c0: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
+0002b3d0: 7265 7475 726e 2073 656c 662e 6375 745f  return self.cut_
+0002b3e0: 6265 666f 7265 2873 656c 662e 706f 696e  before(self.poin
+0002b3f0: 7433 645f 746f 5f70 6172 616d 6574 6572  t3d_to_parameter
+0002b400: 2870 6f69 6e74 3129 290a 0a20 2020 2020  (point1))..     
+0002b410: 2020 2069 6620 706f 696e 7432 2021 3d20     if point2 != 
+0002b420: 7365 6c66 2e73 7461 7274 2061 6e64 2070  self.start and p
+0002b430: 6f69 6e74 3120 3d3d 2073 656c 662e 656e  oint1 == self.en
+0002b440: 643a 0a20 2020 2020 2020 2020 2020 2072  d:.            r
+0002b450: 6574 7572 6e20 7365 6c66 2e63 7574 5f62  eturn self.cut_b
+0002b460: 6566 6f72 6528 7365 6c66 2e70 6f69 6e74  efore(self.point
+0002b470: 3364 5f74 6f5f 7061 7261 6d65 7465 7228  3d_to_parameter(
+0002b480: 706f 696e 7432 2929 0a0a 2020 2020 2020  point2))..      
+0002b490: 2020 7061 7261 6d65 7465 7231 203d 2073    parameter1 = s
+0002b4a0: 656c 662e 706f 696e 7433 645f 746f 5f70  elf.point3d_to_p
+0002b4b0: 6172 616d 6574 6572 2870 6f69 6e74 3129  arameter(point1)
+0002b4c0: 0a20 2020 2020 2020 2070 6172 616d 6574  .        paramet
+0002b4d0: 6572 3220 3d20 7365 6c66 2e70 6f69 6e74  er2 = self.point
+0002b4e0: 3364 5f74 6f5f 7061 7261 6d65 7465 7228  3d_to_parameter(
+0002b4f0: 706f 696e 7432 290a 2020 2020 2020 2020  point2).        
+0002b500: 6966 2070 6172 616d 6574 6572 3120 6973  if parameter1 is
+0002b510: 204e 6f6e 6520 6f72 2070 6172 616d 6574   None or paramet
+0002b520: 6572 3220 6973 204e 6f6e 653a 0a20 2020  er2 is None:.   
+0002b530: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0002b540: 616c 7565 4572 726f 7228 2750 6f69 6e74  alueError('Point
+0002b550: 206e 6f74 206f 6e20 4253 706c 696e 6543   not on BSplineC
+0002b560: 7572 7665 2066 6f72 2074 7269 6d20 6d65  urve for trim me
+0002b570: 7468 6f64 2729 0a0a 2020 2020 2020 2020  thod')..        
+0002b580: 6966 2070 6172 616d 6574 6572 3120 3e20  if parameter1 > 
+0002b590: 7061 7261 6d65 7465 7232 3a0a 2020 2020  parameter2:.    
+0002b5a0: 2020 2020 2020 2020 7061 7261 6d65 7465          paramete
+0002b5b0: 7231 2c20 7061 7261 6d65 7465 7232 203d  r1, parameter2 =
+0002b5c0: 2070 6172 616d 6574 6572 322c 2070 6172   parameter2, par
+0002b5d0: 616d 6574 6572 310a 2020 2020 2020 2020  ameter1.        
+0002b5e0: 2020 2020 706f 696e 7431 2c20 706f 696e      point1, poin
+0002b5f0: 7432 203d 2070 6f69 6e74 322c 2070 6f69  t2 = point2, poi
+0002b600: 6e74 310a 0a20 2020 2020 2020 2062 7370  nt1..        bsp
+0002b610: 6c69 6e65 5f63 7572 7665 203d 2073 656c  line_curve = sel
+0002b620: 662e 6375 745f 6265 666f 7265 2870 6172  f.cut_before(par
+0002b630: 616d 6574 6572 3129 0a20 2020 2020 2020  ameter1).       
+0002b640: 206e 6577 5f70 6172 616d 3220 3d20 6273   new_param2 = bs
+0002b650: 706c 696e 655f 6375 7276 652e 706f 696e  pline_curve.poin
+0002b660: 7433 645f 746f 5f70 6172 616d 6574 6572  t3d_to_parameter
+0002b670: 2870 6f69 6e74 3229 0a20 2020 2020 2020  (point2).       
+0002b680: 2074 7269 6d6d 6564 5f62 7370 6c69 6e65   trimmed_bspline
+0002b690: 5f63 7275 7665 203d 2062 7370 6c69 6e65  _cruve = bspline
+0002b6a0: 5f63 7572 7665 2e63 7574 5f61 6674 6572  _curve.cut_after
+0002b6b0: 286e 6577 5f70 6172 616d 3229 0a20 2020  (new_param2).   
+0002b6c0: 2020 2020 2072 6574 7572 6e20 7472 696d       return trim
+0002b6d0: 6d65 645f 6273 706c 696e 655f 6372 7576  med_bspline_cruv
+0002b6e0: 650a 0a20 2020 2064 6566 2074 7269 6d5f  e..    def trim_
+0002b6f0: 6265 7477 6565 6e5f 6576 616c 7561 7469  between_evaluati
+0002b700: 6f6e 7328 7365 6c66 2c20 7061 7261 6d65  ons(self, parame
+0002b710: 7465 7231 3a20 666c 6f61 742c 2070 6172  ter1: float, par
+0002b720: 616d 6574 6572 323a 2066 6c6f 6174 293a  ameter2: float):
+0002b730: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+0002b740: 5573 6520 4253 706c 696e 6543 7572 7665  Use BSplineCurve
+0002b750: 3344 2e74 7269 6d20 696e 7374 6561 6420  3D.trim instead 
+0002b760: 6f66 2074 7269 6d5f 6265 7477 6565 6e5f  of trim_between_
+0002b770: 6576 616c 7561 7469 6f6e 2729 0a20 2020  evaluation').   
+0002b780: 2020 2020 2070 6172 616d 6574 6572 312c       parameter1,
+0002b790: 2070 6172 616d 6574 6572 3220 3d20 6d69   parameter2 = mi
+0002b7a0: 6e28 5b70 6172 616d 6574 6572 312c 2070  n([parameter1, p
+0002b7b0: 6172 616d 6574 6572 325d 292c 205c 0a20  arameter2]), \. 
+0002b7c0: 2020 2020 2020 2020 2020 206d 6178 285b             max([
+0002b7d0: 7061 7261 6d65 7465 7231 2c20 7061 7261  parameter1, para
+0002b7e0: 6d65 7465 7232 5d29 0a0a 2020 2020 2020  meter2])..      
+0002b7f0: 2020 6966 206d 6174 682e 6973 636c 6f73    if math.isclos
+0002b800: 6528 7061 7261 6d65 7465 7231 2c20 302c  e(parameter1, 0,
+0002b810: 2061 6273 5f74 6f6c 3d31 652d 3729 205c   abs_tol=1e-7) \
+0002b820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b830: 2061 6e64 206d 6174 682e 6973 636c 6f73   and math.isclos
+0002b840: 6528 7061 7261 6d65 7465 7232 2c20 312c  e(parameter2, 1,
+0002b850: 2061 6273 5f74 6f6c 3d31 652d 3729 3a0a   abs_tol=1e-7):.
+0002b860: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002b870: 726e 2073 656c 660a 2020 2020 2020 2020  rn self.        
+0002b880: 656c 6966 206d 6174 682e 6973 636c 6f73  elif math.isclos
+0002b890: 6528 7061 7261 6d65 7465 7231 2c20 302c  e(parameter1, 0,
+0002b8a0: 2061 6273 5f74 6f6c 3d31 652d 3729 3a0a   abs_tol=1e-7):.
+0002b8b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002b8c0: 726e 2073 656c 662e 6375 745f 6166 7465  rn self.cut_afte
+0002b8d0: 7228 7061 7261 6d65 7465 7232 290a 2020  r(parameter2).  
+0002b8e0: 2020 2020 2020 656c 6966 206d 6174 682e        elif math.
+0002b8f0: 6973 636c 6f73 6528 7061 7261 6d65 7465  isclose(paramete
+0002b900: 7232 2c20 312c 2061 6273 5f74 6f6c 3d31  r2, 1, abs_tol=1
+0002b910: 652d 3729 3a0a 2020 2020 2020 2020 2020  e-7):.          
+0002b920: 2020 7265 7475 726e 2073 656c 662e 6375    return self.cu
+0002b930: 745f 6265 666f 7265 2870 6172 616d 6574  t_before(paramet
+0002b940: 6572 3129 0a0a 2020 2020 2020 2020 2320  er1)..        # 
+0002b950: 4375 7420 6265 666f 7265 0a20 2020 2020  Cut before.     
+0002b960: 2020 2062 7370 6c69 6e65 5f63 7572 7665     bspline_curve
+0002b970: 203d 2073 656c 662e 696e 7365 7274 5f6b   = self.insert_k
+0002b980: 6e6f 7428 7061 7261 6d65 7465 7231 2c20  not(parameter1, 
+0002b990: 6e75 6d3d 7365 6c66 2e64 6567 7265 6529  num=self.degree)
+0002b9a0: 0a20 2020 2020 2020 2069 6620 6273 706c  .        if bspl
+0002b9b0: 696e 655f 6375 7276 652e 7765 6967 6874  ine_curve.weight
+0002b9c0: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+0002b9d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002b9e0: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+0002b9f0: 7272 6f72 0a0a 2020 2020 2020 2020 2320  rror..        # 
+0002ba00: 4375 7420 6166 7465 720a 2020 2020 2020  Cut after.      
+0002ba10: 2020 6273 706c 696e 655f 6375 7276 6520    bspline_curve 
+0002ba20: 3d20 6273 706c 696e 655f 6375 7276 652e  = bspline_curve.
+0002ba30: 696e 7365 7274 5f6b 6e6f 7428 7061 7261  insert_knot(para
+0002ba40: 6d65 7465 7232 2c20 6e75 6d3d 7365 6c66  meter2, num=self
+0002ba50: 2e64 6567 7265 6529 0a20 2020 2020 2020  .degree).       
+0002ba60: 2069 6620 6273 706c 696e 655f 6375 7276   if bspline_curv
+0002ba70: 652e 7765 6967 6874 7320 6973 206e 6f74  e.weights is not
+0002ba80: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0002ba90: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+0002baa0: 656d 656e 7465 6445 7272 6f72 0a0a 2020  ementedError..  
+0002bab0: 2020 2020 2020 6e65 775f 6374 726c 7074        new_ctrlpt
+0002bac0: 7320 3d20 6273 706c 696e 655f 6375 7276  s = bspline_curv
+0002bad0: 652e 636f 6e74 726f 6c5f 706f 696e 7473  e.control_points
+0002bae0: 5b62 7370 6c69 6e65 5f63 7572 7665 2e64  [bspline_curve.d
+0002baf0: 6567 7265 653a 0a20 2020 2020 2020 2020  egree:.         
+0002bb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0002bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb20: 2020 2020 2020 2020 206b 6e6f 7473 3d6e           knots=n
-0002bb30: 6577 5f6b 6e6f 7473 2c0a 2020 2020 2020  ew_knots,.      
-0002bb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb50: 2020 2020 2020 2020 7765 6967 6874 733d          weights=
-0002bb60: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0002bb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb80: 2020 2020 7065 7269 6f64 6963 3d62 7370      periodic=bsp
-0002bb90: 6c69 6e65 5f63 7572 7665 2e70 6572 696f  line_curve.perio
-0002bba0: 6469 632c 0a20 2020 2020 2020 2020 2020  dic,.           
-0002bbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bbc0: 2020 206e 616d 653d 6273 706c 696e 655f     name=bspline_
-0002bbd0: 6375 7276 652e 6e61 6d65 290a 0a20 2020  curve.name)..   
-0002bbe0: 2064 6566 2063 7574 5f62 6566 6f72 6528   def cut_before(
-0002bbf0: 7365 6c66 2c20 7061 7261 6d65 7465 723a  self, parameter:
-0002bc00: 2066 6c6f 6174 293a 0a20 2020 2020 2020   float):.       
-0002bc10: 2023 2049 7320 6120 7661 6c75 6520 6f66   # Is a value of
-0002bc20: 2070 6172 616d 6574 6572 2062 656c 6f77   parameter below
-0002bc30: 2034 652d 3320 6120 7265 616c 206e 6565   4e-3 a real nee
-0002bc40: 6420 666f 7220 7072 6563 6973 696f 6e20  d for precision 
-0002bc50: 3f0a 2020 2020 2020 2020 6966 206d 6174  ?.        if mat
-0002bc60: 682e 6973 636c 6f73 6528 7061 7261 6d65  h.isclose(parame
-0002bc70: 7465 722c 2030 2c20 6162 735f 746f 6c3d  ter, 0, abs_tol=
-0002bc80: 3465 2d33 293a 0a20 2020 2020 2020 2020  4e-3):.         
-0002bc90: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
-0002bca0: 2020 2020 2020 2069 6620 6d61 7468 2e69         if math.i
-0002bcb0: 7363 6c6f 7365 2870 6172 616d 6574 6572  sclose(parameter
-0002bcc0: 2c20 312c 2061 6273 5f74 6f6c 3d34 652d  , 1, abs_tol=4e-
-0002bcd0: 3329 3a0a 2020 2020 2020 2020 2020 2020  3):.            
-0002bce0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0002bcf0: 2827 4e6f 7468 696e 6720 7769 6c6c 2062  ('Nothing will b
-0002bd00: 6520 6c65 6674 2066 726f 6d20 7468 6520  e left from the 
-0002bd10: 4253 706c 696e 6543 7572 7665 3344 2729  BSplineCurve3D')
-0002bd20: 0a0a 2020 2020 2020 2020 6375 7276 6573  ..        curves
-0002bd30: 203d 206f 7065 7261 7469 6f6e 732e 7370   = operations.sp
-0002bd40: 6c69 745f 6375 7276 6528 7365 6c66 2e63  lit_curve(self.c
-0002bd50: 7572 7665 2c20 7061 7261 6d65 7465 7229  urve, parameter)
-0002bd60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002bd70: 7365 6c66 2e66 726f 6d5f 6765 6f6d 646c  self.from_geomdl
-0002bd80: 5f63 7572 7665 2863 7572 7665 735b 315d  _curve(curves[1]
-0002bd90: 290a 0a20 2020 2064 6566 2063 7574 5f61  )..    def cut_a
-0002bda0: 6674 6572 2873 656c 662c 2070 6172 616d  fter(self, param
-0002bdb0: 6574 6572 3a20 666c 6f61 7429 3a0a 2020  eter: float):.  
-0002bdc0: 2020 2020 2020 2320 4973 2061 2076 616c        # Is a val
-0002bdd0: 7565 206f 6620 7061 7261 6d65 7465 7220  ue of parameter 
-0002bde0: 6265 6c6f 7720 3465 2d33 2061 2072 6561  below 4e-3 a rea
-0002bdf0: 6c20 6e65 6564 2066 6f72 2070 7265 6369  l need for preci
-0002be00: 7369 6f6e 203f 0a20 2020 2020 2020 2069  sion ?.        i
-0002be10: 6620 6d61 7468 2e69 7363 6c6f 7365 2870  f math.isclose(p
-0002be20: 6172 616d 6574 6572 2c20 302c 2061 6273  arameter, 0, abs
-0002be30: 5f74 6f6c 3d34 652d 3329 3a0a 2020 2020  _tol=4e-3):.    
-0002be40: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002be50: 6c75 6545 7272 6f72 2827 4e6f 7468 696e  lueError('Nothin
-0002be60: 6720 7769 6c6c 2062 6520 6c65 6674 2066  g will be left f
-0002be70: 726f 6d20 7468 6520 4253 706c 696e 6543  rom the BSplineC
-0002be80: 7572 7665 3344 2729 0a20 2020 2020 2020  urve3D').       
-0002be90: 2069 6620 6d61 7468 2e69 7363 6c6f 7365   if math.isclose
-0002bea0: 2870 6172 616d 6574 6572 2c20 312c 2061  (parameter, 1, a
-0002beb0: 6273 5f74 6f6c 3d34 652d 3329 3a0a 2020  bs_tol=4e-3):.  
-0002bec0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002bed0: 2073 656c 660a 2020 2020 2020 2020 6375   self.        cu
-0002bee0: 7276 6573 203d 206f 7065 7261 7469 6f6e  rves = operation
-0002bef0: 732e 7370 6c69 745f 6375 7276 6528 7365  s.split_curve(se
-0002bf00: 6c66 2e63 7572 7665 2c20 7061 7261 6d65  lf.curve, parame
-0002bf10: 7465 7229 0a20 2020 2020 2020 2072 6574  ter).        ret
-0002bf20: 7572 6e20 7365 6c66 2e66 726f 6d5f 6765  urn self.from_ge
-0002bf30: 6f6d 646c 5f63 7572 7665 2863 7572 7665  omdl_curve(curve
-0002bf40: 735b 305d 290a 0a20 2020 2064 6566 2069  s[0])..    def i
-0002bf50: 6e73 6572 745f 6b6e 6f74 2873 656c 662c  nsert_knot(self,
-0002bf60: 206b 6e6f 743a 2066 6c6f 6174 2c20 6e75   knot: float, nu
-0002bf70: 6d3a 2069 6e74 203d 2031 293a 0a20 2020  m: int = 1):.   
-0002bf80: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002bf90: 2052 6574 7572 6e73 2061 206e 6577 2042   Returns a new B
-0002bfa0: 5370 6c69 6e65 4375 7276 6533 442e 0a0a  SplineCurve3D...
-0002bfb0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002bfc0: 2020 2020 6375 7276 655f 636f 7079 203d      curve_copy =
-0002bfd0: 2073 656c 662e 6375 7276 652e 5f5f 6465   self.curve.__de
-0002bfe0: 6570 636f 7079 5f5f 287b 7d29 0a20 2020  epcopy__({}).   
-0002bff0: 2020 2020 206d 6f64 6966 6965 645f 6375       modified_cu
-0002c000: 7276 6520 3d20 6f70 6572 6174 696f 6e73  rve = operations
-0002c010: 2e69 6e73 6572 745f 6b6e 6f74 2863 7572  .insert_knot(cur
-0002c020: 7665 5f63 6f70 792c 205b 6b6e 6f74 5d2c  ve_copy, [knot],
-0002c030: 206e 756d 3d5b 6e75 6d5d 290a 2020 2020   num=[num]).    
-0002c040: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0002c050: 6672 6f6d 5f67 656f 6d64 6c5f 6375 7276  from_geomdl_curv
-0002c060: 6528 6d6f 6469 6669 6564 5f63 7572 7665  e(modified_curve
-0002c070: 290a 0a20 2020 2023 2043 6f70 7920 7061  )..    # Copy pa
-0002c080: 7374 6520 6475 204c 696e 6553 6567 6d65  ste du LineSegme
-0002c090: 6e74 3344 0a20 2020 2064 6566 2070 6c6f  nt3D.    def plo
-0002c0a0: 7428 7365 6c66 2c20 6178 3d4e 6f6e 652c  t(self, ax=None,
-0002c0b0: 2063 6f6c 6f72 3d27 6b27 2c20 616c 7068   color='k', alph
-0002c0c0: 613d 312c 2065 6467 655f 656e 6473 3d46  a=1, edge_ends=F
-0002c0d0: 616c 7365 2c20 6564 6765 5f64 6972 6563  alse, edge_direc
-0002c0e0: 7469 6f6e 3d46 616c 7365 293a 0a20 2020  tion=False):.   
-0002c0f0: 2020 2020 2069 6620 6178 2069 7320 4e6f       if ax is No
-0002c100: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0002c110: 6669 6720 3d20 706c 742e 6669 6775 7265  fig = plt.figure
-0002c120: 2829 0a20 2020 2020 2020 2020 2020 2061  ().            a
-0002c130: 7820 3d20 6669 672e 6164 645f 7375 6270  x = fig.add_subp
-0002c140: 6c6f 7428 3131 312c 2070 726f 6a65 6374  lot(111, project
-0002c150: 696f 6e3d 2733 6427 290a 2020 2020 2020  ion='3d').      
-0002c160: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0002c170: 2020 2020 6669 6720 3d20 6178 2e66 6967      fig = ax.fig
-0002c180: 7572 650a 0a20 2020 2020 2020 2078 203d  ure..        x =
-0002c190: 205b 702e 7820 666f 7220 7020 696e 2073   [p.x for p in s
-0002c1a0: 656c 662e 706f 696e 7473 5d0a 2020 2020  elf.points].    
-0002c1b0: 2020 2020 7920 3d20 5b70 2e79 2066 6f72      y = [p.y for
-0002c1c0: 2070 2069 6e20 7365 6c66 2e70 6f69 6e74   p in self.point
-0002c1d0: 735d 0a20 2020 2020 2020 207a 203d 205b  s].        z = [
-0002c1e0: 702e 7a20 666f 7220 7020 696e 2073 656c  p.z for p in sel
-0002c1f0: 662e 706f 696e 7473 5d0a 2020 2020 2020  f.points].      
-0002c200: 2020 6178 2e70 6c6f 7428 782c 2079 2c20    ax.plot(x, y, 
-0002c210: 7a2c 2063 6f6c 6f72 3d63 6f6c 6f72 2c20  z, color=color, 
-0002c220: 616c 7068 613d 616c 7068 6129 0a20 2020  alpha=alpha).   
-0002c230: 2020 2020 2069 6620 6564 6765 5f65 6e64       if edge_end
-0002c240: 733a 0a20 2020 2020 2020 2020 2020 2061  s:.            a
-0002c250: 782e 706c 6f74 2878 2c20 792c 207a 2c20  x.plot(x, y, z, 
-0002c260: 276f 272c 2063 6f6c 6f72 3d63 6f6c 6f72  'o', color=color
-0002c270: 2c20 616c 7068 613d 616c 7068 6129 0a20  , alpha=alpha). 
-0002c280: 2020 2020 2020 2072 6574 7572 6e20 6178         return ax
-0002c290: 0a0a 2020 2020 6465 6620 746f 5f32 6428  ..    def to_2d(
-0002c2a0: 7365 6c66 2c20 706c 616e 655f 6f72 6967  self, plane_orig
-0002c2b0: 696e 2c20 782c 2079 293a 0a20 2020 2020  in, x, y):.     
-0002c2c0: 2020 2022 2222 0a20 2020 2020 2020 2054     """.        T
-0002c2d0: 7261 6e73 666f 726d 7320 6120 4253 706c  ransforms a BSpl
-0002c2e0: 696e 6543 7572 7665 3344 2069 6e74 6f20  ineCurve3D into 
-0002c2f0: 616e 2042 5370 6c69 6e65 4375 7276 6532  an BSplineCurve2
-0002c300: 442c 2067 6976 656e 2061 6e20 706c 616e  D, given an plan
-0002c310: 6520 6f72 6967 696e 2061 6e64 2061 2075  e origin and a u
-0002c320: 2061 6e64 2076 2070 6c61 6e65 2076 6563   and v plane vec
-0002c330: 746f 722e 0a0a 2020 2020 2020 2020 3a70  tor...        :p
-0002c340: 6172 616d 2070 6c61 6e65 5f6f 7269 6769  aram plane_origi
-0002c350: 6e3a 2070 6c61 6e65 206f 7269 6769 6e2e  n: plane origin.
-0002c360: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0002c370: 783a 2070 6c61 6e65 2075 2076 6563 746f  x: plane u vecto
-0002c380: 722e 0a20 2020 2020 2020 203a 7061 7261  r..        :para
-0002c390: 6d20 793a 2070 6c61 6e65 2076 2076 6563  m y: plane v vec
-0002c3a0: 746f 722e 0a20 2020 2020 2020 203a 7265  tor..        :re
-0002c3b0: 7475 726e 3a20 4253 706c 696e 6543 7572  turn: BSplineCur
-0002c3c0: 7665 3244 2e0a 2020 2020 2020 2020 2222  ve2D..        ""
-0002c3d0: 220a 2020 2020 2020 2020 636f 6e74 726f  ".        contro
-0002c3e0: 6c5f 706f 696e 7473 3264 203d 205b 702e  l_points2d = [p.
-0002c3f0: 746f 5f32 6428 706c 616e 655f 6f72 6967  to_2d(plane_orig
-0002c400: 696e 2c20 782c 2079 2920 666f 7220 7020  in, x, y) for p 
-0002c410: 696e 0a20 2020 2020 2020 2020 2020 2020  in.             
-0002c420: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002c430: 656c 662e 636f 6e74 726f 6c5f 706f 696e  elf.control_poin
-0002c440: 7473 5d0a 2020 2020 2020 2020 7265 7475  ts].        retu
-0002c450: 726e 2042 5370 6c69 6e65 4375 7276 6532  rn BSplineCurve2
-0002c460: 4428 7365 6c66 2e64 6567 7265 652c 2063  D(self.degree, c
-0002c470: 6f6e 7472 6f6c 5f70 6f69 6e74 7332 642c  ontrol_points2d,
-0002c480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002c490: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002c4a0: 656c 662e 6b6e 6f74 5f6d 756c 7469 706c  elf.knot_multipl
-0002c4b0: 6963 6974 6965 732c 2073 656c 662e 6b6e  icities, self.kn
-0002c4c0: 6f74 732c 0a20 2020 2020 2020 2020 2020  ots,.           
-0002c4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c4e0: 2020 2073 656c 662e 7765 6967 6874 732c     self.weights,
-0002c4f0: 2073 656c 662e 7065 7269 6f64 6963 2c20   self.periodic, 
-0002c500: 7365 6c66 2e6e 616d 6529 0a0a 2020 2020  self.name)..    
-0002c510: 6465 6620 706f 6c79 676f 6e5f 706f 696e  def polygon_poin
-0002c520: 7473 2873 656c 662c 2064 6973 6372 6574  ts(self, discret
-0002c530: 697a 6174 696f 6e5f 7265 736f 6c75 7469  ization_resoluti
-0002c540: 6f6e 3a20 696e 7429 3a0a 2020 2020 2020  on: int):.      
-0002c550: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-0002c560: 2770 6f6c 7967 6f6e 5f70 6f69 6e74 7320  'polygon_points 
-0002c570: 6973 2064 6570 7265 6361 7465 642c 5c0a  is deprecated,\.
-0002c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c590: 706c 6561 7365 2075 7365 2064 6973 6372  please use discr
-0002c5a0: 6574 697a 6174 696f 6e5f 706f 696e 7473  etization_points
-0002c5b0: 2069 6e73 7465 6164 272c 0a20 2020 2020   instead',.     
-0002c5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c5d0: 2044 6570 7265 6361 7469 6f6e 5761 726e   DeprecationWarn
-0002c5e0: 696e 6729 0a20 2020 2020 2020 2072 6574  ing).        ret
-0002c5f0: 7572 6e20 7365 6c66 2e64 6973 6372 6574  urn self.discret
-0002c600: 697a 6174 696f 6e5f 706f 696e 7473 2861  ization_points(a
-0002c610: 6e67 6c65 5f72 6573 6f6c 7574 696f 6e3d  ngle_resolution=
-0002c620: 6469 7363 7265 7469 7a61 7469 6f6e 5f72  discretization_r
-0002c630: 6573 6f6c 7574 696f 6e29 0a0a 2020 2020  esolution)..    
-0002c640: 6465 6620 6375 7276 6174 7572 6528 7365  def curvature(se
-0002c650: 6c66 2c20 753a 2066 6c6f 6174 2c20 706f  lf, u: float, po
-0002c660: 696e 745f 696e 5f63 7572 7665 3a20 626f  int_in_curve: bo
-0002c670: 6f6c 203d 2046 616c 7365 293a 0a20 2020  ol = False):.   
-0002c680: 2020 2020 2023 2075 2073 686f 756c 6420       # u should 
-0002c690: 6265 2069 6e20 7468 6520 696e 7465 7276  be in the interv
-0002c6a0: 616c 205b 302c 315d 0a20 2020 2020 2020  al [0,1].       
-0002c6b0: 2064 6572 7320 3d20 7365 6c66 2e64 6572   ders = self.der
-0002c6c0: 6976 6174 6976 6573 2875 2c20 3329 2020  ivatives(u, 3)  
-0002c6d0: 2320 3320 6669 7273 7420 6465 7269 7661  # 3 first deriva
-0002c6e0: 7469 7665 0a20 2020 2020 2020 2063 312c  tive.        c1,
-0002c6f0: 2063 3220 3d20 6465 7273 5b31 5d2c 2064   c2 = ders[1], d
-0002c700: 6572 735b 325d 0a20 2020 2020 2020 2064  ers[2].        d
-0002c710: 656e 6f6d 203d 2063 312e 6372 6f73 7328  enom = c1.cross(
-0002c720: 6332 290a 2020 2020 2020 2020 6966 2063  c2).        if c
-0002c730: 3120 3d3d 2076 6f6c 6d64 6c72 2e4f 3344  1 == volmdlr.O3D
-0002c740: 206f 7220 6332 203d 3d20 766f 6c6d 646c   or c2 == volmdl
-0002c750: 722e 4f33 4420 6f72 2064 656e 6f6d 2e6e  r.O3D or denom.n
-0002c760: 6f72 6d28 2920 3d3d 2030 2e30 3a0a 2020  orm() == 0.0:.  
-0002c770: 2020 2020 2020 2020 2020 6966 2070 6f69            if poi
-0002c780: 6e74 5f69 6e5f 6375 7276 653a 0a20 2020  nt_in_curve:.   
-0002c790: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0002c7a0: 7572 6e20 302e 2c20 766f 6c6d 646c 722e  urn 0., volmdlr.
-0002c7b0: 506f 696e 7433 4428 2a64 6572 735b 305d  Point3D(*ders[0]
-0002c7c0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0002c7d0: 7475 726e 2030 2e0a 2020 2020 2020 2020  turn 0..        
-0002c7e0: 725f 6320 3d20 2828 6331 2e6e 6f72 6d28  r_c = ((c1.norm(
-0002c7f0: 2929 202a 2a20 3329 202f 2064 656e 6f6d  )) ** 3) / denom
-0002c800: 2e6e 6f72 6d28 290a 2020 2020 2020 2020  .norm().        
-0002c810: 706f 696e 7420 3d20 766f 6c6d 646c 722e  point = volmdlr.
-0002c820: 506f 696e 7433 4428 2a64 6572 735b 305d  Point3D(*ders[0]
-0002c830: 290a 2020 2020 2020 2020 6966 2070 6f69  ).        if poi
-0002c840: 6e74 5f69 6e5f 6375 7276 653a 0a20 2020  nt_in_curve:.   
-0002c850: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0002c860: 3120 2f20 725f 632c 2070 6f69 6e74 0a20  1 / r_c, point. 
-0002c870: 2020 2020 2020 2072 6574 7572 6e20 3120         return 1 
-0002c880: 2f20 725f 630a 0a20 2020 2064 6566 2067  / r_c..    def g
-0002c890: 6c6f 6261 6c5f 6d61 7869 6d75 6d5f 6375  lobal_maximum_cu
-0002c8a0: 7276 6174 7572 6528 7365 6c66 2c20 6e62  rvature(self, nb
-0002c8b0: 5f65 7661 6c3a 2069 6e74 203d 2032 312c  _eval: int = 21,
-0002c8c0: 2070 6f69 6e74 5f69 6e5f 6375 7276 653a   point_in_curve:
-0002c8d0: 2062 6f6f 6c20 3d20 4661 6c73 6529 3a0a   bool = False):.
-0002c8e0: 2020 2020 2020 2020 6368 6563 6b20 3d20          check = 
-0002c8f0: 5b69 202f 2028 6e62 5f65 7661 6c20 2d20  [i / (nb_eval - 
-0002c900: 3129 2066 6f72 2069 2069 6e20 7261 6e67  1) for i in rang
-0002c910: 6528 6e62 5f65 7661 6c29 5d0a 2020 2020  e(nb_eval)].    
-0002c920: 2020 2020 6375 7276 6174 7572 6573 203d      curvatures =
-0002c930: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
-0002c940: 7520 696e 2063 6865 636b 3a0a 2020 2020  u in check:.    
-0002c950: 2020 2020 2020 2020 6375 7276 6174 7572          curvatur
-0002c960: 6573 2e61 7070 656e 6428 7365 6c66 2e63  es.append(self.c
-0002c970: 7572 7661 7475 7265 2875 2c20 706f 696e  urvature(u, poin
-0002c980: 745f 696e 5f63 7572 7665 2929 0a20 2020  t_in_curve)).   
-0002c990: 2020 2020 2072 6574 7572 6e20 6375 7276       return curv
-0002c9a0: 6174 7572 6573 0a0a 2020 2020 6465 6620  atures..    def 
-0002c9b0: 6d61 7869 6d75 6d5f 6375 7276 6174 7572  maximum_curvatur
-0002c9c0: 6528 7365 6c66 2c20 706f 696e 745f 696e  e(self, point_in
-0002c9d0: 5f63 7572 7665 3a20 626f 6f6c 203d 2046  _curve: bool = F
-0002c9e0: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
-0002c9f0: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
-0002ca00: 6e73 2074 6865 206d 6178 696d 756d 2063  ns the maximum c
-0002ca10: 7572 7661 7475 7265 206f 6620 6120 6375  urvature of a cu
-0002ca20: 7276 6520 616e 6420 7468 6520 706f 696e  rve and the poin
-0002ca30: 7420 7768 6572 6520 6974 2069 7320 6c6f  t where it is lo
-0002ca40: 6361 7465 642e 0a20 2020 2020 2020 2022  cated..        "
-0002ca50: 2222 0a20 2020 2020 2020 2069 6620 706f  "".        if po
-0002ca60: 696e 745f 696e 5f63 7572 7665 3a0a 2020  int_in_curve:.  
-0002ca70: 2020 2020 2020 2020 2020 6d61 7869 6d75            maximu
-0002ca80: 6d5f 6375 7276 6172 7475 7265 2c20 706f  m_curvarture, po
-0002ca90: 696e 7420 3d20 6d61 7828 7365 6c66 2e67  int = max(self.g
-0002caa0: 6c6f 6261 6c5f 6d61 7869 6d75 6d5f 6375  lobal_maximum_cu
-0002cab0: 7276 6174 7572 6528 6e62 5f65 7661 6c3d  rvature(nb_eval=
-0002cac0: 3231 2c20 706f 696e 745f 696e 5f63 7572  21, point_in_cur
-0002cad0: 7665 3d70 6f69 6e74 5f69 6e5f 6375 7276  ve=point_in_curv
-0002cae0: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
-0002caf0: 7265 7475 726e 206d 6178 696d 756d 5f63  return maximum_c
-0002cb00: 7572 7661 7274 7572 652c 2070 6f69 6e74  urvarture, point
-0002cb10: 0a20 2020 2020 2020 2023 2070 7269 6e74  .        # print
-0002cb20: 2873 656c 662e 676c 6f62 616c 5f6d 6178  (self.global_max
-0002cb30: 696d 756d 5f63 7572 7661 7475 7265 2870  imum_curvature(p
-0002cb40: 6f69 6e74 5f69 6e5f 6375 7276 6529 290a  oint_in_curve)).
-0002cb50: 2020 2020 2020 2020 6d61 7869 6d75 6d5f          maximum_
-0002cb60: 6375 7276 6172 7475 7265 203d 206d 6178  curvarture = max
-0002cb70: 2873 656c 662e 676c 6f62 616c 5f6d 6178  (self.global_max
-0002cb80: 696d 756d 5f63 7572 7661 7475 7265 286e  imum_curvature(n
-0002cb90: 625f 6576 616c 3d32 312c 2070 6f69 6e74  b_eval=21, point
-0002cba0: 5f69 6e5f 6375 7276 653d 706f 696e 745f  _in_curve=point_
-0002cbb0: 696e 5f63 7572 7665 2929 0a20 2020 2020  in_curve)).     
-0002cbc0: 2020 2072 6574 7572 6e20 6d61 7869 6d75     return maximu
-0002cbd0: 6d5f 6375 7276 6172 7475 7265 0a0a 2020  m_curvarture..  
-0002cbe0: 2020 6465 6620 6d69 6e69 6d75 6d5f 7261    def minimum_ra
-0002cbf0: 6469 7573 2873 656c 662c 2070 6f69 6e74  dius(self, point
-0002cc00: 5f69 6e5f 6375 7276 653d 4661 6c73 6529  _in_curve=False)
-0002cc10: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0002cc20: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
-0002cc30: 6520 6d69 6e69 6d75 6d20 6375 7276 6174  e minimum curvat
-0002cc40: 7572 6520 7261 6469 7573 206f 6620 6120  ure radius of a 
-0002cc50: 6375 7276 6520 616e 6420 7468 6520 706f  curve and the po
-0002cc60: 696e 7420 7768 6572 6520 6974 2069 7320  int where it is 
-0002cc70: 6c6f 6361 7465 642e 0a20 2020 2020 2020  located..       
-0002cc80: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-0002cc90: 706f 696e 745f 696e 5f63 7572 7665 3a0a  point_in_curve:.
-0002cca0: 2020 2020 2020 2020 2020 2020 6d61 7869              maxi
-0002ccb0: 6d75 6d5f 6375 7276 6172 7475 7265 2c20  mum_curvarture, 
-0002ccc0: 706f 696e 7420 3d20 7365 6c66 2e6d 6178  point = self.max
-0002ccd0: 696d 756d 5f63 7572 7661 7475 7265 2870  imum_curvature(p
-0002cce0: 6f69 6e74 5f69 6e5f 6375 7276 6529 0a20  oint_in_curve). 
-0002ccf0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002cd00: 6e20 3120 2f20 6d61 7869 6d75 6d5f 6375  n 1 / maximum_cu
-0002cd10: 7276 6172 7475 7265 2c20 706f 696e 740a  rvarture, point.
-0002cd20: 2020 2020 2020 2020 6d61 7869 6d75 6d5f          maximum_
-0002cd30: 6375 7276 6172 7475 7265 203d 2073 656c  curvarture = sel
-0002cd40: 662e 6d61 7869 6d75 6d5f 6375 7276 6174  f.maximum_curvat
-0002cd50: 7572 6528 706f 696e 745f 696e 5f63 7572  ure(point_in_cur
-0002cd60: 7665 290a 2020 2020 2020 2020 7265 7475  ve).        retu
-0002cd70: 726e 2031 202f 206d 6178 696d 756d 5f63  rn 1 / maximum_c
-0002cd80: 7572 7661 7274 7572 650a 0a20 2020 2064  urvarture..    d
-0002cd90: 6566 2067 6c6f 6261 6c5f 6d69 6e69 6d75  ef global_minimu
-0002cda0: 6d5f 6375 7276 6174 7572 6528 7365 6c66  m_curvature(self
-0002cdb0: 2c20 6e62 5f65 7661 6c3a 2069 6e74 203d  , nb_eval: int =
-0002cdc0: 2032 3129 3a0a 2020 2020 2020 2020 6368   21):.        ch
-0002cdd0: 6563 6b20 3d20 5b69 202f 2028 6e62 5f65  eck = [i / (nb_e
-0002cde0: 7661 6c20 2d20 3129 2066 6f72 2069 2069  val - 1) for i i
-0002cdf0: 6e20 7261 6e67 6528 6e62 5f65 7661 6c29  n range(nb_eval)
-0002ce00: 5d0a 2020 2020 2020 2020 7261 6469 7573  ].        radius
-0002ce10: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-0002ce20: 7220 7520 696e 2063 6865 636b 3a0a 2020  r u in check:.  
-0002ce30: 2020 2020 2020 2020 2020 7261 6469 7573            radius
-0002ce40: 2e61 7070 656e 6428 7365 6c66 2e6d 696e  .append(self.min
-0002ce50: 696d 756d 5f63 7572 7661 7475 7265 2875  imum_curvature(u
-0002ce60: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
-0002ce70: 6e20 7261 6469 7573 0a0a 2020 2020 6465  n radius..    de
-0002ce80: 6620 7472 6961 6e67 756c 6174 696f 6e28  f triangulation(
-0002ce90: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-0002cea0: 6574 7572 6e20 4e6f 6e65 0a0a 2020 2020  eturn None..    
-0002ceb0: 6465 6620 6c69 6e65 7365 676d 656e 745f  def linesegment_
-0002cec0: 696e 7465 7273 6563 7469 6f6e 7328 7365  intersections(se
-0002ced0: 6c66 2c20 6c69 6e65 7365 676d 656e 7433  lf, linesegment3
-0002cee0: 643a 204c 696e 6553 6567 6d65 6e74 3344  d: LineSegment3D
-0002cef0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0002cf00: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
-0002cf10: 7320 696e 7465 7273 6563 7469 6f6e 7320  s intersections 
-0002cf20: 6265 7477 6565 6e20 6120 4253 706c 696e  between a BSplin
-0002cf30: 6543 7572 7665 3344 2061 6e64 2061 204c  eCurve3D and a L
-0002cf40: 696e 6553 6567 6d65 6e74 3344 2e0a 0a20  ineSegment3D... 
-0002cf50: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
-0002cf60: 6e65 7365 676d 656e 7433 643a 206c 696e  nesegment3d: lin
-0002cf70: 6573 6567 6d65 6e74 2074 6f20 7665 7269  esegment to veri
-0002cf80: 6679 2069 6e74 6572 7365 6374 696f 6e73  fy intersections
-0002cf90: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0002cfa0: 6e3a 206c 6973 7420 7769 7468 2074 6865  n: list with the
-0002cfb0: 2069 6e74 6572 7365 6374 696f 6e73 2070   intersections p
-0002cfc0: 6f69 6e74 732e 0a20 2020 2020 2020 2022  oints..        "
-0002cfd0: 2222 0a20 2020 2020 2020 2069 6620 6e6f  "".        if no
-0002cfe0: 7420 7365 6c66 2e62 6f75 6e64 696e 675f  t self.bounding_
-0002cff0: 626f 782e 6262 6f78 5f69 6e74 6572 7365  box.bbox_interse
-0002d000: 6374 696f 6e28 6c69 6e65 7365 676d 656e  ction(linesegmen
-0002d010: 7433 642e 626f 756e 6469 6e67 5f62 6f78  t3d.bounding_box
-0002d020: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0002d030: 6574 7572 6e20 5b5d 0a20 2020 2020 2020  eturn [].       
-0002d040: 2069 6e74 6572 7365 6374 696f 6e73 5f70   intersections_p
-0002d050: 6f69 6e74 7320 3d20 7365 6c66 2e67 6574  oints = self.get
-0002d060: 5f6c 696e 6573 6567 6d65 6e74 5f69 6e74  _linesegment_int
-0002d070: 6572 7365 6374 696f 6e73 286c 696e 6573  ersections(lines
-0002d080: 6567 6d65 6e74 3364 290a 2020 2020 2020  egment3d).      
-0002d090: 2020 7265 7475 726e 2069 6e74 6572 7365    return interse
-0002d0a0: 6374 696f 6e73 5f70 6f69 6e74 730a 0a0a  ctions_points...
-0002d0b0: 636c 6173 7320 4265 7a69 6572 4375 7276  class BezierCurv
-0002d0c0: 6533 4428 4253 706c 696e 6543 7572 7665  e3D(BSplineCurve
-0002d0d0: 3344 293a 0a20 2020 2022 2222 0a20 2020  3D):.    """.   
-0002d0e0: 2041 2063 6c61 7373 2066 6f72 2033 2064   A class for 3 d
-0002d0f0: 696d 656e 7369 6f6e 616c 2042 657a 6965  imensional Bezie
-0002d100: 7220 6375 7276 6573 2e0a 0a20 2020 203a  r curves...    :
-0002d110: 7061 7261 6d20 6465 6772 6565 3a20 5468  param degree: Th
-0002d120: 6520 6465 6772 6565 206f 6620 7468 6520  e degree of the 
-0002d130: 4265 7a69 6572 2063 7572 7665 0a20 2020  Bezier curve.   
-0002d140: 203a 7479 7065 2064 6567 7265 653a 2069   :type degree: i
-0002d150: 6e74 0a20 2020 203a 7061 7261 6d20 636f  nt.    :param co
-0002d160: 6e74 726f 6c5f 706f 696e 7473 3a20 4120  ntrol_points: A 
-0002d170: 6c69 7374 206f 6620 3320 6469 6d65 6e73  list of 3 dimens
-0002d180: 696f 6e61 6c20 706f 696e 7473 0a20 2020  ional points.   
-0002d190: 203a 7479 7065 2063 6f6e 7472 6f6c 5f70   :type control_p
-0002d1a0: 6f69 6e74 733a 204c 6973 745b 3a63 6c61  oints: List[:cla
-0002d1b0: 7373 3a60 766f 6c6d 646c 722e 506f 696e  ss:`volmdlr.Poin
-0002d1c0: 7433 4460 5d0a 2020 2020 3a70 6172 616d  t3D`].    :param
-0002d1d0: 206e 616d 653a 2054 6865 206e 616d 6520   name: The name 
-0002d1e0: 6f66 2074 6865 2042 2d73 706c 696e 6520  of the B-spline 
-0002d1f0: 6375 7276 652e 2044 6566 6175 6c74 2076  curve. Default v
-0002d200: 616c 7565 2069 7320 2727 0a20 2020 203a  alue is ''.    :
-0002d210: 7479 7065 206e 616d 653a 2073 7472 2c20  type name: str, 
-0002d220: 6f70 7469 6f6e 616c 0a20 2020 2022 2222  optional.    """
-0002d230: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
-0002d240: 5f5f 2873 656c 662c 2064 6567 7265 653a  __(self, degree:
-0002d250: 2069 6e74 2c20 636f 6e74 726f 6c5f 706f   int, control_po
-0002d260: 696e 7473 3a20 4c69 7374 5b76 6f6c 6d64  ints: List[volmd
-0002d270: 6c72 2e50 6f69 6e74 3344 5d2c 0a20 2020  lr.Point3D],.   
-0002d280: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-0002d290: 6d65 3a20 7374 7220 3d20 2727 293a 0a20  me: str = ''):. 
-0002d2a0: 2020 2020 2020 206b 6e6f 7476 6563 746f         knotvecto
-0002d2b0: 7220 3d20 7574 696c 6974 6965 732e 6765  r = utilities.ge
-0002d2c0: 6e65 7261 7465 5f6b 6e6f 745f 7665 6374  nerate_knot_vect
-0002d2d0: 6f72 2864 6567 7265 652c 0a20 2020 2020  or(degree,.     
-0002d2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d300: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0002d310: 656e 2863 6f6e 7472 6f6c 5f70 6f69 6e74  en(control_point
-0002d320: 7329 290a 2020 2020 2020 2020 6b6e 6f74  s)).        knot
-0002d330: 5f6d 756c 7469 706c 6963 6974 7920 3d20  _multiplicity = 
-0002d340: 5b31 5d20 2a20 6c65 6e28 6b6e 6f74 7665  [1] * len(knotve
-0002d350: 6374 6f72 290a 0a20 2020 2020 2020 2042  ctor)..        B
-0002d360: 5370 6c69 6e65 4375 7276 6533 442e 5f5f  SplineCurve3D.__
-0002d370: 696e 6974 5f5f 2873 656c 662c 2064 6567  init__(self, deg
-0002d380: 7265 652c 2063 6f6e 7472 6f6c 5f70 6f69  ree, control_poi
-0002d390: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
-0002d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d3b0: 2020 2020 206b 6e6f 745f 6d75 6c74 6970       knot_multip
-0002d3c0: 6c69 6369 7479 2c20 6b6e 6f74 7665 6374  licity, knotvect
-0002d3d0: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
-0002d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d3f0: 2020 2020 4e6f 6e65 2c20 4661 6c73 652c      None, False,
-0002d400: 206e 616d 6529 0a0a 0a63 6c61 7373 2041   name)...class A
-0002d410: 7263 3344 2841 7263 293a 0a20 2020 2022  rc3D(Arc):.    "
-0002d420: 2222 0a20 2020 2041 6e20 6172 6320 6973  "".    An arc is
-0002d430: 2064 6566 696e 6564 2062 7920 6120 7374   defined by a st
-0002d440: 6172 7469 6e67 2070 6f69 6e74 2c20 616e  arting point, an
-0002d450: 2065 6e64 2070 6f69 6e74 2061 6e64 2061   end point and a
-0002d460: 6e20 696e 7465 7269 6f72 2070 6f69 6e74  n interior point
-0002d470: 2e0a 0a20 2020 2022 2222 0a0a 2020 2020  ...    """..    
-0002d480: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-0002d490: 662c 2073 7461 7274 2c20 696e 7465 7269  f, start, interi
-0002d4a0: 6f72 2c20 656e 642c 206e 616d 653d 2727  or, end, name=''
-0002d4b0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-0002d4c0: 5f75 7464 5f6e 6f72 6d61 6c20 3d20 4661  _utd_normal = Fa
-0002d4d0: 6c73 650a 2020 2020 2020 2020 7365 6c66  lse.        self
-0002d4e0: 2e5f 7574 645f 6365 6e74 6572 203d 2046  ._utd_center = F
-0002d4f0: 616c 7365 0a20 2020 2020 2020 2073 656c  alse.        sel
-0002d500: 662e 5f75 7464 5f66 7261 6d65 203d 2046  f._utd_frame = F
-0002d510: 616c 7365 0a20 2020 2020 2020 2073 656c  alse.        sel
-0002d520: 662e 5f75 7464 5f69 735f 7472 6967 6f20  f._utd_is_trigo 
-0002d530: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-0002d540: 7365 6c66 2e5f 7574 645f 616e 676c 6520  self._utd_angle 
-0002d550: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-0002d560: 7365 6c66 2e5f 6e6f 726d 616c 203d 204e  self._normal = N
-0002d570: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
-0002d580: 2e5f 6672 616d 6520 3d20 4e6f 6e65 0a20  ._frame = None. 
-0002d590: 2020 2020 2020 2073 656c 662e 5f63 656e         self._cen
-0002d5a0: 7465 7220 3d20 4e6f 6e65 0a20 2020 2020  ter = None.     
-0002d5b0: 2020 2073 656c 662e 5f69 735f 7472 6967     self._is_trig
-0002d5c0: 6f20 3d20 4e6f 6e65 0a20 2020 2020 2020  o = None.       
-0002d5d0: 2073 656c 662e 5f61 6e67 6c65 203d 204e   self._angle = N
-0002d5e0: 6f6e 650a 2020 2020 2020 2020 2320 7365  one.        # se
-0002d5f0: 6c66 2e5f 7574 645f 636c 6f63 6b77 6973  lf._utd_clockwis
-0002d600: 655f 616e 645f 7472 6967 6f77 6973 655f  e_and_trigowise_
-0002d610: 7061 7468 7320 3d20 4661 6c73 650a 2020  paths = False.  
-0002d620: 2020 2020 2020 4172 632e 5f5f 696e 6974        Arc.__init
-0002d630: 5f5f 2873 656c 662c 2073 7461 7274 3d73  __(self, start=s
-0002d640: 7461 7274 2c20 656e 643d 656e 642c 2069  tart, end=end, i
-0002d650: 6e74 6572 696f 723d 696e 7465 7269 6f72  nterior=interior
-0002d660: 2c20 6e61 6d65 3d6e 616d 6529 0a20 2020  , name=name).   
-0002d670: 2020 2020 2073 656c 662e 5f62 626f 7820       self._bbox 
-0002d680: 3d20 4e6f 6e65 0a0a 2020 2020 4070 726f  = None..    @pro
-0002d690: 7065 7274 790a 2020 2020 6465 6620 626f  perty.    def bo
-0002d6a0: 756e 6469 6e67 5f62 6f78 2873 656c 6629  unding_box(self)
-0002d6b0: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
-0002d6c0: 2073 656c 662e 5f62 626f 783a 0a20 2020   self._bbox:.   
-0002d6d0: 2020 2020 2020 2020 2073 656c 662e 5f62           self._b
-0002d6e0: 626f 7820 3d20 7365 6c66 2e67 6574 5f62  box = self.get_b
-0002d6f0: 6f75 6e64 696e 675f 626f 7828 290a 2020  ounding_box().  
-0002d700: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0002d710: 662e 5f62 626f 780a 0a20 2020 2040 626f  f._bbox..    @bo
-0002d720: 756e 6469 6e67 5f62 6f78 2e73 6574 7465  unding_box.sette
-0002d730: 720a 2020 2020 6465 6620 626f 756e 6469  r.    def boundi
-0002d740: 6e67 5f62 6f78 2873 656c 662c 206e 6577  ng_box(self, new
-0002d750: 5f62 6f75 6e64 696e 675f 626f 7829 3a0a  _bounding_box):.
-0002d760: 2020 2020 2020 2020 7365 6c66 2e5f 6262          self._bb
-0002d770: 6f78 203d 206e 6577 5f62 6f75 6e64 696e  ox = new_boundin
-0002d780: 675f 626f 780a 0a20 2020 2064 6566 2067  g_box..    def g
-0002d790: 6574 5f62 6f75 6e64 696e 675f 626f 7828  et_bounding_box(
-0002d7a0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0002d7b0: 2222 0a20 2020 2020 2020 2043 616c 6375  "".        Calcu
-0002d7c0: 6c61 7465 7320 7468 6520 626f 756e 6469  lates the boundi
-0002d7d0: 6e67 2062 6f78 206f 6620 7468 6520 4172  ng box of the Ar
-0002d7e0: 6333 442e 0a0a 2020 2020 2020 2020 3a72  c3D...        :r
-0002d7f0: 6574 7572 6e3a 2061 2076 6f6c 6d64 6c72  eturn: a volmdlr
-0002d800: 2e63 6f72 652e 426f 756e 6469 6e67 426f  .core.BoundingBo
-0002d810: 7820 6f62 6a65 6374 2e0a 2020 2020 2020  x object..      
-0002d820: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
-0002d830: 544f 444f 3a20 696d 706c 656d 656e 7420  TODO: implement 
-0002d840: 6578 6163 7420 6361 6c63 756c 6174 696f  exact calculatio
-0002d850: 6e0a 0a20 2020 2020 2020 2070 6f69 6e74  n..        point
-0002d860: 7320 3d20 7365 6c66 2e64 6973 6372 6574  s = self.discret
-0002d870: 697a 6174 696f 6e5f 706f 696e 7473 2861  ization_points(a
-0002d880: 6e67 6c65 5f72 6573 6f6c 7574 696f 6e3d  ngle_resolution=
-0002d890: 3130 290a 2020 2020 2020 2020 786d 696e  10).        xmin
-0002d8a0: 203d 206d 696e 2870 6f69 6e74 2e78 2066   = min(point.x f
-0002d8b0: 6f72 2070 6f69 6e74 2069 6e20 706f 696e  or point in poin
-0002d8c0: 7473 290a 2020 2020 2020 2020 786d 6178  ts).        xmax
-0002d8d0: 203d 206d 6178 2870 6f69 6e74 2e78 2066   = max(point.x f
-0002d8e0: 6f72 2070 6f69 6e74 2069 6e20 706f 696e  or point in poin
-0002d8f0: 7473 290a 2020 2020 2020 2020 796d 696e  ts).        ymin
-0002d900: 203d 206d 696e 2870 6f69 6e74 2e79 2066   = min(point.y f
-0002d910: 6f72 2070 6f69 6e74 2069 6e20 706f 696e  or point in poin
-0002d920: 7473 290a 2020 2020 2020 2020 796d 6178  ts).        ymax
-0002d930: 203d 206d 6178 2870 6f69 6e74 2e79 2066   = max(point.y f
-0002d940: 6f72 2070 6f69 6e74 2069 6e20 706f 696e  or point in poin
-0002d950: 7473 290a 2020 2020 2020 2020 7a6d 696e  ts).        zmin
-0002d960: 203d 206d 696e 2870 6f69 6e74 2e7a 2066   = min(point.z f
-0002d970: 6f72 2070 6f69 6e74 2069 6e20 706f 696e  or point in poin
-0002d980: 7473 290a 2020 2020 2020 2020 7a6d 6178  ts).        zmax
-0002d990: 203d 206d 6178 2870 6f69 6e74 2e7a 2066   = max(point.z f
-0002d9a0: 6f72 2070 6f69 6e74 2069 6e20 706f 696e  or point in poin
-0002d9b0: 7473 290a 2020 2020 2020 2020 7265 7475  ts).        retu
-0002d9c0: 726e 2076 6f6c 6d64 6c72 2e63 6f72 652e  rn volmdlr.core.
-0002d9d0: 426f 756e 6469 6e67 426f 7828 786d 696e  BoundingBox(xmin
-0002d9e0: 2c20 786d 6178 2c20 796d 696e 2c20 796d  , xmax, ymin, ym
-0002d9f0: 6178 2c20 7a6d 696e 2c20 7a6d 6178 290a  ax, zmin, zmax).
-0002da00: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-0002da10: 640a 2020 2020 6465 6620 6672 6f6d 5f61  d.    def from_a
-0002da20: 6e67 6c65 2863 6c73 2c20 7374 6172 743a  ngle(cls, start:
-0002da30: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3344   volmdlr.Point3D
-0002da40: 2c20 616e 676c 653a 2066 6c6f 6174 2c0a  , angle: float,.
-0002da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002da60: 2020 2061 7869 735f 706f 696e 743a 2076     axis_point: v
-0002da70: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 2c20  olmdlr.Point3D, 
-0002da80: 6178 6973 3a20 766f 6c6d 646c 722e 5665  axis: volmdlr.Ve
-0002da90: 6374 6f72 3344 293a 0a20 2020 2020 2020  ctor3D):.       
-0002daa0: 2022 2222 4769 7665 7320 7468 6520 6172   """Gives the ar
-0002dab0: 6333 4420 6672 6f6d 2061 2073 7461 7274  c3D from a start
-0002dac0: 2c20 616e 2061 6e67 6c65 2061 6e64 2061  , an angle and a
-0002dad0: 6e20 6178 6973 2e22 2222 0a20 2020 2020  n axis.""".     
-0002dae0: 2020 2073 7461 7274 5f67 656e 203d 2073     start_gen = s
-0002daf0: 7461 7274 0a20 2020 2020 2020 2069 6e74  tart.        int
-0002db00: 5f67 656e 203d 2073 7461 7274 5f67 656e  _gen = start_gen
-0002db10: 2e72 6f74 6174 696f 6e28 6178 6973 5f70  .rotation(axis_p
-0002db20: 6f69 6e74 2c20 6178 6973 2c20 616e 676c  oint, axis, angl
-0002db30: 6520 2f20 3229 0a20 2020 2020 2020 2065  e / 2).        e
-0002db40: 6e64 5f67 656e 203d 2073 7461 7274 5f67  nd_gen = start_g
-0002db50: 656e 2e72 6f74 6174 696f 6e28 6178 6973  en.rotation(axis
-0002db60: 5f70 6f69 6e74 2c20 6178 6973 2c20 616e  _point, axis, an
-0002db70: 676c 6529 0a20 2020 2020 2020 2069 6620  gle).        if 
-0002db80: 616e 676c 6520 3d3d 2076 6f6c 6d64 6c72  angle == volmdlr
-0002db90: 2e54 574f 5f50 493a 0a20 2020 2020 2020  .TWO_PI:.       
-0002dba0: 2020 2020 206c 696e 6520 3d20 4c69 6e65       line = Line
-0002dbb0: 3344 2861 7869 735f 706f 696e 742c 2061  3D(axis_point, a
-0002dbc0: 7869 735f 706f 696e 7420 2b20 6178 6973  xis_point + axis
-0002dbd0: 290a 2020 2020 2020 2020 2020 2020 6365  ).            ce
-0002dbe0: 6e74 6572 2c20 5f20 3d20 6c69 6e65 2e70  nter, _ = line.p
-0002dbf0: 6f69 6e74 5f70 726f 6a65 6374 696f 6e28  oint_projection(
-0002dc00: 7374 6172 7429 0a20 2020 2020 2020 2020  start).         
-0002dc10: 2020 2072 6164 6975 7320 3d20 6365 6e74     radius = cent
-0002dc20: 6572 2e70 6f69 6e74 5f64 6973 7461 6e63  er.point_distanc
-0002dc30: 6528 7374 6172 7429 0a20 2020 2020 2020  e(start).       
-0002dc40: 2020 2020 2075 203d 2073 7461 7274 202d       u = start -
-0002dc50: 2063 656e 7465 720a 2020 2020 2020 2020   center.        
-0002dc60: 2020 2020 7620 3d20 6178 6973 2e63 726f      v = axis.cro
-0002dc70: 7373 2875 290a 2020 2020 2020 2020 2020  ss(u).          
-0002dc80: 2020 7265 7475 726e 2076 6f6c 6d64 6c72    return volmdlr
-0002dc90: 2e77 6972 6573 2e43 6972 636c 6533 4428  .wires.Circle3D(
-0002dca0: 766f 6c6d 646c 722e 4672 616d 6533 4428  volmdlr.Frame3D(
-0002dcb0: 6365 6e74 6572 2c20 752c 2076 2c20 6178  center, u, v, ax
-0002dcc0: 6973 292c 0a20 2020 2020 2020 2020 2020  is),.           
-0002dcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dce0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0002dcf0: 6164 6975 7329 0a20 2020 2020 2020 2072  adius).        r
-0002dd00: 6574 7572 6e20 636c 7328 7374 6172 745f  eturn cls(start_
-0002dd10: 6765 6e2c 2069 6e74 5f67 656e 2c20 656e  gen, int_gen, en
-0002dd20: 645f 6765 6e2c 2061 7869 7329 0a0a 2020  d_gen, axis)..  
-0002dd30: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0002dd40: 6465 6620 6e6f 726d 616c 2873 656c 6629  def normal(self)
-0002dd50: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
-0002dd60: 2073 656c 662e 5f75 7464 5f6e 6f72 6d61   self._utd_norma
-0002dd70: 6c3a 0a20 2020 2020 2020 2020 2020 2073  l:.            s
-0002dd80: 656c 662e 5f6e 6f72 6d61 6c20 3d20 7365  elf._normal = se
-0002dd90: 6c66 2e67 6574 5f6e 6f72 6d61 6c28 290a  lf.get_normal().
-0002dda0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002ddb0: 2e5f 7574 645f 6e6f 726d 616c 203d 2054  ._utd_normal = T
-0002ddc0: 7275 650a 2020 2020 2020 2020 7265 7475  rue.        retu
-0002ddd0: 726e 2073 656c 662e 5f6e 6f72 6d61 6c0a  rn self._normal.
-0002dde0: 0a20 2020 2064 6566 2067 6574 5f6e 6f72  .    def get_nor
-0002ddf0: 6d61 6c28 7365 6c66 293a 0a20 2020 2020  mal(self):.     
-0002de00: 2020 2075 3120 3d20 7365 6c66 2e69 6e74     u1 = self.int
-0002de10: 6572 696f 7220 2d20 7365 6c66 2e73 7461  erior - self.sta
-0002de20: 7274 0a20 2020 2020 2020 2075 3220 3d20  rt.        u2 = 
-0002de30: 7365 6c66 2e69 6e74 6572 696f 7220 2d20  self.interior - 
-0002de40: 7365 6c66 2e65 6e64 0a20 2020 2020 2020  self.end.       
-0002de50: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0002de60: 2020 7531 2e6e 6f72 6d61 6c69 7a65 2829    u1.normalize()
-0002de70: 0a20 2020 2020 2020 2020 2020 2075 322e  .            u2.
-0002de80: 6e6f 726d 616c 697a 6528 290a 2020 2020  normalize().    
-0002de90: 2020 2020 6578 6365 7074 205a 6572 6f44      except ZeroD
-0002dea0: 6976 6973 696f 6e45 7272 6f72 3a0a 2020  ivisionError:.  
-0002deb0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0002dec0: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
-0002ded0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0002dee0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0002def0: 2020 2020 2753 7461 7274 2c20 656e 6420      'Start, end 
-0002df00: 616e 6420 696e 7465 7269 6f72 2070 6f69  and interior poi
-0002df10: 6e74 7320 6f66 2061 6e20 6172 6320 6d75  nts of an arc mu
-0002df20: 7374 2062 6520 6469 7374 696e 6374 7327  st be distincts'
-0002df30: 2920 6672 6f6d 205a 6572 6f44 6976 6973  ) from ZeroDivis
-0002df40: 696f 6e45 7272 6f72 0a0a 2020 2020 2020  ionError..      
-0002df50: 2020 6e6f 726d 616c 203d 2075 322e 6372    normal = u2.cr
-0002df60: 6f73 7328 7531 290a 2020 2020 2020 2020  oss(u1).        
-0002df70: 6e6f 726d 616c 2e6e 6f72 6d61 6c69 7a65  normal.normalize
-0002df80: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
-0002df90: 6e20 6e6f 726d 616c 0a0a 2020 2020 4070  n normal..    @p
-0002dfa0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0002dfb0: 6365 6e74 6572 2873 656c 6629 3a0a 2020  center(self):.  
-0002dfc0: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-0002dfd0: 662e 5f75 7464 5f63 656e 7465 723a 0a20  f._utd_center:. 
-0002dfe0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002dff0: 5f63 656e 7465 7220 3d20 7365 6c66 2e67  _center = self.g
-0002e000: 6574 5f63 656e 7465 7228 290a 2020 2020  et_center().    
-0002e010: 2020 2020 2020 2020 7365 6c66 2e5f 7574          self._ut
-0002e020: 645f 6365 6e74 6572 203d 2054 7275 650a  d_center = True.
-0002e030: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002e040: 656c 662e 5f63 656e 7465 720a 0a20 2020  elf._center..   
-0002e050: 2064 6566 2067 6574 5f63 656e 7465 7228   def get_center(
-0002e060: 7365 6c66 293a 0a20 2020 2020 2020 2075  self):.        u
-0002e070: 3120 3d20 7365 6c66 2e69 6e74 6572 696f  1 = self.interio
-0002e080: 7220 2d20 7365 6c66 2e73 7461 7274 0a20  r - self.start. 
-0002e090: 2020 2020 2020 2075 3220 3d20 7365 6c66         u2 = self
-0002e0a0: 2e69 6e74 6572 696f 7220 2d20 7365 6c66  .interior - self
-0002e0b0: 2e65 6e64 0a20 2020 2020 2020 2069 6620  .end.        if 
-0002e0c0: 7531 203d 3d20 7532 3a0a 2020 2020 2020  u1 == u2:.      
-0002e0d0: 2020 2020 2020 7532 203d 2073 656c 662e        u2 = self.
-0002e0e0: 6e6f 726d 616c 2e63 726f 7373 2875 3129  normal.cross(u1)
-0002e0f0: 0a20 2020 2020 2020 2020 2020 2075 322e  .            u2.
-0002e100: 6e6f 726d 616c 697a 6528 290a 0a20 2020  normalize()..   
-0002e110: 2020 2020 2076 3120 3d20 7365 6c66 2e6e       v1 = self.n
-0002e120: 6f72 6d61 6c2e 6372 6f73 7328 7531 2920  ormal.cross(u1) 
-0002e130: 2023 2076 3120 6973 206e 6f72 6d61 6c2c   # v1 is normal,
-0002e140: 2065 7175 616c 2075 320a 2020 2020 2020   equal u2.      
-0002e150: 2020 7632 203d 2073 656c 662e 6e6f 726d    v2 = self.norm
-0002e160: 616c 2e63 726f 7373 2875 3229 2020 2320  al.cross(u2)  # 
-0002e170: 6571 7561 6c20 2d75 310a 0a20 2020 2020  equal -u1..     
-0002e180: 2020 2070 3131 203d 2030 2e35 202a 2028     p11 = 0.5 * (
-0002e190: 7365 6c66 2e73 7461 7274 202b 2073 656c  self.start + sel
-0002e1a0: 662e 696e 7465 7269 6f72 2920 2023 204d  f.interior)  # M
-0002e1b0: 6964 2070 6f69 6e74 206f 6620 7365 676d  id point of segm
-0002e1c0: 656e 7420 732c 6d0a 2020 2020 2020 2020  ent s,m.        
-0002e1d0: 7031 3220 3d20 7031 3120 2b20 7631 0a20  p12 = p11 + v1. 
-0002e1e0: 2020 2020 2020 2070 3231 203d 2030 2e35         p21 = 0.5
-0002e1f0: 202a 2028 7365 6c66 2e65 6e64 202b 2073   * (self.end + s
-0002e200: 656c 662e 696e 7465 7269 6f72 2920 2023  elf.interior)  #
-0002e210: 204d 6964 2070 6f69 6e74 206f 6620 7365   Mid point of se
-0002e220: 676d 656e 7420 732c 6d0a 2020 2020 2020  gment s,m.      
-0002e230: 2020 7032 3220 3d20 7032 3120 2b20 7632    p22 = p21 + v2
-0002e240: 0a0a 2020 2020 2020 2020 6c31 203d 204c  ..        l1 = L
-0002e250: 696e 6533 4428 7031 312c 2070 3132 290a  ine3D(p11, p12).
-0002e260: 2020 2020 2020 2020 6c32 203d 204c 696e          l2 = Lin
-0002e270: 6533 4428 7032 312c 2070 3232 290a 0a20  e3D(p21, p22).. 
-0002e280: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0002e290: 2020 2020 2020 2020 6365 6e74 6572 2c20          center, 
-0002e2a0: 5f20 3d20 6c31 2e6d 696e 696d 756d 5f64  _ = l1.minimum_d
-0002e2b0: 6973 7461 6e63 655f 706f 696e 7473 286c  istance_points(l
-0002e2c0: 3229 0a20 2020 2020 2020 2065 7863 6570  2).        excep
-0002e2d0: 7420 5a65 726f 4469 7669 7369 6f6e 4572  t ZeroDivisionEr
-0002e2e0: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-0002e2f0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002e300: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0002e310: 2020 2027 5374 6172 742c 2065 6e64 2061     'Start, end a
-0002e320: 6e64 2069 6e74 6572 696f 7220 706f 696e  nd interior poin
-0002e330: 7473 2020 6f66 2061 6e20 6172 6320 6d75  ts  of an arc mu
-0002e340: 7374 2062 6520 6469 7374 696e 6374 7327  st be distincts'
-0002e350: 2920 6672 6f6d 205a 6572 6f44 6976 6973  ) from ZeroDivis
-0002e360: 696f 6e45 7272 6f72 0a0a 2020 2020 2020  ionError..      
-0002e370: 2020 7265 7475 726e 2063 656e 7465 720a    return center.
-0002e380: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0002e390: 2020 2064 6566 2066 7261 6d65 2873 656c     def frame(sel
-0002e3a0: 6629 3a0a 2020 2020 2020 2020 6966 206e  f):.        if n
-0002e3b0: 6f74 2073 656c 662e 5f75 7464 5f66 7261  ot self._utd_fra
-0002e3c0: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
-0002e3d0: 7365 6c66 2e5f 6672 616d 6520 3d20 7365  self._frame = se
-0002e3e0: 6c66 2e67 6574 5f66 7261 6d65 2829 0a20  lf.get_frame(). 
-0002e3f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002e400: 5f75 7464 5f66 7261 6d65 203d 2054 7275  _utd_frame = Tru
-0002e410: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
-0002e420: 2073 656c 662e 5f66 7261 6d65 0a0a 2020   self._frame..  
-0002e430: 2020 6465 6620 6765 745f 6672 616d 6528    def get_frame(
-0002e440: 7365 6c66 293a 0a20 2020 2020 2020 2076  self):.        v
-0002e450: 6563 3120 3d20 7365 6c66 2e73 7461 7274  ec1 = self.start
-0002e460: 202d 2073 656c 662e 6365 6e74 6572 0a20   - self.center. 
-0002e470: 2020 2020 2020 2076 6563 312e 6e6f 726d         vec1.norm
-0002e480: 616c 697a 6528 290a 2020 2020 2020 2020  alize().        
-0002e490: 7665 6332 203d 2073 656c 662e 6e6f 726d  vec2 = self.norm
-0002e4a0: 616c 2e63 726f 7373 2876 6563 3129 0a20  al.cross(vec1). 
-0002e4b0: 2020 2020 2020 2066 7261 6d65 203d 2076         frame = v
-0002e4c0: 6f6c 6d64 6c72 2e46 7261 6d65 3344 2873  olmdlr.Frame3D(s
-0002e4d0: 656c 662e 6365 6e74 6572 2c20 7665 6331  elf.center, vec1
-0002e4e0: 2c20 7665 6332 2c20 7365 6c66 2e6e 6f72  , vec2, self.nor
-0002e4f0: 6d61 6c29 0a20 2020 2020 2020 2072 6574  mal).        ret
-0002e500: 7572 6e20 6672 616d 650a 0a20 2020 2040  urn frame..    @
-0002e510: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0002e520: 2069 735f 7472 6967 6f28 7365 6c66 293a   is_trigo(self):
-0002e530: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0002e540: 7365 6c66 2e5f 7574 645f 6973 5f74 7269  self._utd_is_tri
-0002e550: 676f 3a0a 2020 2020 2020 2020 2020 2020  go:.            
-0002e560: 7365 6c66 2e5f 6973 5f74 7269 676f 203d  self._is_trigo =
-0002e570: 2073 656c 662e 6765 745f 6172 635f 6469   self.get_arc_di
-0002e580: 7265 6374 696f 6e28 290a 2020 2020 2020  rection().      
-0002e590: 2020 2020 2020 7365 6c66 2e5f 7574 645f        self._utd_
-0002e5a0: 6973 5f74 7269 676f 203d 2054 7275 650a  is_trigo = True.
-0002e5b0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002e5c0: 656c 662e 5f69 735f 7472 6967 6f0a 0a20  elf._is_trigo.. 
-0002e5d0: 2020 2064 6566 2067 6574 5f61 7263 5f64     def get_arc_d
-0002e5e0: 6972 6563 7469 6f6e 2873 656c 6629 3a0a  irection(self):.
-0002e5f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002e600: 2020 2020 5665 7269 6669 6573 2069 6620      Verifies if 
-0002e610: 6172 6320 6973 2063 6c6f 636b 7769 7365  arc is clockwise
-0002e620: 206f 7220 7472 6967 6f77 6973 652e 0a0a   or trigowise...
-0002e630: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-0002e640: 2054 7275 6520 6966 2063 6c6f 636b 7769   True if clockwi
-0002e650: 7365 2c20 4661 6c73 6520 6966 2074 7269  se, False if tri
-0002e660: 676f 7769 7365 2e0a 2020 2020 2020 2020  gowise..        
-0002e670: 2222 220a 2020 2020 2020 2020 636c 6f63  """.        cloc
-0002e680: 6b77 6973 655f 7061 7468 2c20 7472 6967  kwise_path, trig
-0002e690: 6f77 6973 655f 7061 7468 203d 2073 656c  owise_path = sel
-0002e6a0: 662e 636c 6f63 6b77 6973 655f 616e 645f  f.clockwise_and_
-0002e6b0: 7472 6967 6f77 6973 655f 7061 7468 730a  trigowise_paths.
-0002e6c0: 2020 2020 2020 2020 6966 2063 6c6f 636b          if clock
-0002e6d0: 7769 7365 5f70 6174 6820 3e20 7472 6967  wise_path > trig
-0002e6e0: 6f77 6973 655f 7061 7468 3a0a 2020 2020  owise_path:.    
-0002e6f0: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-0002e700: 7275 650a 2020 2020 2020 2020 7265 7475  rue.        retu
-0002e710: 726e 2046 616c 7365 0a0a 2020 2020 4070  rn False..    @p
-0002e720: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0002e730: 636c 6f63 6b77 6973 655f 616e 645f 7472  clockwise_and_tr
-0002e740: 6967 6f77 6973 655f 7061 7468 7328 7365  igowise_paths(se
-0002e750: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0002e760: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0002e770: 3a20 636c 6f63 6b77 6973 6520 7061 7468  : clockwise path
-0002e780: 2061 6e64 2074 7269 676f 6e6f 6d65 7472   and trigonometr
-0002e790: 6963 2070 6174 6820 7072 6f70 6572 7479  ic path property
-0002e7a0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0002e7b0: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-0002e7c0: 662e 5f75 7464 5f63 6c6f 636b 7769 7365  f._utd_clockwise
-0002e7d0: 5f61 6e64 5f74 7269 676f 7769 7365 5f70  _and_trigowise_p
-0002e7e0: 6174 6873 3a0a 2020 2020 2020 2020 2020  aths:.          
-0002e7f0: 2020 7665 6331 203d 2073 656c 662e 7374    vec1 = self.st
-0002e800: 6172 7420 2d20 7365 6c66 2e63 656e 7465  art - self.cente
-0002e810: 720a 2020 2020 2020 2020 2020 2020 7665  r.            ve
-0002e820: 6331 2e6e 6f72 6d61 6c69 7a65 2829 0a20  c1.normalize(). 
-0002e830: 2020 2020 2020 2020 2020 2076 6563 3220             vec2 
-0002e840: 3d20 7365 6c66 2e6e 6f72 6d61 6c2e 6372  = self.normal.cr
-0002e850: 6f73 7328 7665 6331 290a 2020 2020 2020  oss(vec1).      
-0002e860: 2020 2020 2020 7261 6469 7573 5f31 203d        radius_1 =
-0002e870: 2073 656c 662e 7374 6172 742e 746f 5f32   self.start.to_2
-0002e880: 6428 7365 6c66 2e63 656e 7465 722c 2076  d(self.center, v
-0002e890: 6563 312c 2076 6563 3229 0a20 2020 2020  ec1, vec2).     
-0002e8a0: 2020 2020 2020 2072 6164 6975 735f 3220         radius_2 
-0002e8b0: 3d20 7365 6c66 2e65 6e64 2e74 6f5f 3264  = self.end.to_2d
-0002e8c0: 2873 656c 662e 6365 6e74 6572 2c20 7665  (self.center, ve
-0002e8d0: 6331 2c20 7665 6332 290a 2020 2020 2020  c1, vec2).      
-0002e8e0: 2020 2020 2020 7261 6469 7573 5f69 203d        radius_i =
-0002e8f0: 2073 656c 662e 696e 7465 7269 6f72 2e74   self.interior.t
-0002e900: 6f5f 3264 2873 656c 662e 6365 6e74 6572  o_2d(self.center
-0002e910: 2c20 7665 6331 2c20 7665 6332 290a 2020  , vec1, vec2).  
-0002e920: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0002e930: 636c 6f63 6b77 6973 655f 616e 645f 7472  clockwise_and_tr
-0002e940: 6967 6f77 6973 655f 7061 7468 7320 3d20  igowise_paths = 
-0002e950: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0002e960: 2020 7365 6c66 2e67 6574 5f63 6c6f 636b    self.get_clock
-0002e970: 7769 7365 5f61 6e64 5f74 7269 676f 7769  wise_and_trigowi
-0002e980: 7365 5f70 6174 6873 2872 6164 6975 735f  se_paths(radius_
-0002e990: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
-0002e9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e9c0: 2020 2020 2020 2020 2020 7261 6469 7573            radius
-0002e9d0: 5f32 2c0a 2020 2020 2020 2020 2020 2020  _2,.            
-0002e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea00: 2020 2020 2020 2020 2020 2072 6164 6975             radiu
-0002ea10: 735f 6929 0a20 2020 2020 2020 2020 2020  s_i).           
-0002ea20: 2073 656c 662e 5f75 7464 5f63 6c6f 636b   self._utd_clock
-0002ea30: 7769 7365 5f61 6e64 5f74 7269 676f 7769  wise_and_trigowi
-0002ea40: 7365 5f70 6174 6873 203d 2054 7275 650a  se_paths = True.
-0002ea50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002ea60: 656c 662e 5f63 6c6f 636b 7769 7365 5f61  elf._clockwise_a
-0002ea70: 6e64 5f74 7269 676f 7769 7365 5f70 6174  nd_trigowise_pat
-0002ea80: 6873 0a0a 2020 2020 4070 726f 7065 7274  hs..    @propert
-0002ea90: 790a 2020 2020 6465 6620 616e 676c 6528  y.    def angle(
-0002eaa0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0002eab0: 2222 0a20 2020 2020 2020 2041 7263 2061  "".        Arc a
-0002eac0: 6e67 6c65 2070 726f 7065 7274 792e 0a0a  ngle property...
-0002ead0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-0002eae0: 2061 7263 2061 6e67 6c65 2e0a 2020 2020   arc angle..    
-0002eaf0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002eb00: 6966 206e 6f74 2073 656c 662e 5f75 7464  if not self._utd
-0002eb10: 5f61 6e67 6c65 3a0a 2020 2020 2020 2020  _angle:.        
-0002eb20: 2020 2020 7365 6c66 2e5f 616e 676c 6520      self._angle 
-0002eb30: 3d20 7365 6c66 2e67 6574 5f61 6e67 6c65  = self.get_angle
-0002eb40: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
-0002eb50: 656c 662e 5f75 7464 5f61 6e67 6c65 203d  elf._utd_angle =
-0002eb60: 2054 7275 650a 2020 2020 2020 2020 7265   True.        re
-0002eb70: 7475 726e 2073 656c 662e 5f61 6e67 6c65  turn self._angle
-0002eb80: 0a0a 2020 2020 6465 6620 6765 745f 616e  ..    def get_an
-0002eb90: 676c 6528 7365 6c66 293a 0a20 2020 2020  gle(self):.     
-0002eba0: 2020 2022 2222 0a20 2020 2020 2020 2047     """.        G
-0002ebb0: 6574 7320 7468 6520 6172 6320 616e 676c  ets the arc angl
-0002ebc0: 652e 0a0a 2020 2020 2020 2020 3a72 6574  e...        :ret
-0002ebd0: 7572 6e3a 2061 7263 2061 6e67 6c65 2e0a  urn: arc angle..
-0002ebe0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002ebf0: 2020 2020 636c 6f63 6b77 6973 655f 7061      clockwise_pa
-0002ec00: 7468 2c20 7472 6967 6f77 6973 655f 7061  th, trigowise_pa
-0002ec10: 7468 203d 205c 0a20 2020 2020 2020 2020  th = \.         
-0002ec20: 2020 2073 656c 662e 636c 6f63 6b77 6973     self.clockwis
-0002ec30: 655f 616e 645f 7472 6967 6f77 6973 655f  e_and_trigowise_
-0002ec40: 7061 7468 730a 2020 2020 2020 2020 6966  paths.        if
-0002ec50: 2073 656c 662e 6973 5f74 7269 676f 3a0a   self.is_trigo:.
-0002ec60: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0002ec70: 726e 2074 7269 676f 7769 7365 5f70 6174  rn trigowise_pat
-0002ec80: 680a 2020 2020 2020 2020 7265 7475 726e  h.        return
-0002ec90: 2063 6c6f 636b 7769 7365 5f70 6174 680a   clockwise_path.
-0002eca0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0002ecb0: 2020 2064 6566 2070 6f69 6e74 7328 7365     def points(se
-0002ecc0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-0002ecd0: 7572 6e20 5b73 656c 662e 7374 6172 742c  urn [self.start,
-0002ece0: 2073 656c 662e 696e 7465 7269 6f72 2c20   self.interior, 
-0002ecf0: 7365 6c66 2e65 6e64 5d0a 0a20 2020 2064  self.end]..    d
-0002ed00: 6566 2072 6576 6572 7365 2873 656c 6629  ef reverse(self)
-0002ed10: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0002ed20: 2020 2020 2020 4465 6669 6e65 7320 6120        Defines a 
-0002ed30: 6e65 7720 4172 6333 442c 206f 6465 6e74  new Arc3D, odent
-0002ed40: 6963 616c 2074 6f20 7365 6c66 2c20 6275  ical to self, bu
-0002ed50: 7420 696e 2074 6865 206f 7070 6f73 6974  t in the opposit
-0002ed60: 6520 6469 7265 6374 696f 6e2e 0a0a 2020  e direction...  
-0002ed70: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002ed80: 2020 7265 7475 726e 2073 656c 662e 5f5f    return self.__
-0002ed90: 636c 6173 735f 5f28 7365 6c66 2e65 6e64  class__(self.end
-0002eda0: 2e63 6f70 7928 292c 0a20 2020 2020 2020  .copy(),.       
-0002edb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002edc0: 2020 2020 2020 2073 656c 662e 696e 7465         self.inte
-0002edd0: 7269 6f72 2e63 6f70 7928 292c 0a20 2020  rior.copy(),.   
-0002ede0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002edf0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002ee00: 7374 6172 742e 636f 7079 2829 290a 0a20  start.copy()).. 
-0002ee10: 2020 2064 6566 2070 6f69 6e74 5f61 745f     def point_at_
-0002ee20: 6162 7363 6973 7361 2873 656c 662c 2061  abscissa(self, a
-0002ee30: 6273 6369 7373 6129 3a0a 2020 2020 2020  bscissa):.      
-0002ee40: 2020 2222 220a 2020 2020 2020 2020 4361    """.        Ca
-0002ee50: 6c63 756c 6174 6573 2061 2070 6f69 6e74  lculates a point
-0002ee60: 2069 6e20 7468 6520 4172 6333 4420 6174   in the Arc3D at
-0002ee70: 2061 2067 6976 656e 2061 6273 6369 7373   a given absciss
-0002ee80: 612e 0a0a 2020 2020 2020 2020 3a70 6172  a...        :par
-0002ee90: 616d 2061 6273 6369 7373 613a 2061 6273  am abscissa: abs
-0002eea0: 6369 7373 6120 7768 6572 6520 696e 2074  cissa where in t
-0002eeb0: 6865 2063 7572 7665 2074 6865 2070 6f69  he curve the poi
-0002eec0: 6e74 2073 686f 756c 6420 6265 2063 616c  nt should be cal
-0002eed0: 6375 6c61 7465 642e 0a20 2020 2020 2020  culated..       
-0002eee0: 203a 7265 7475 726e 3a20 436f 7272 6573   :return: Corres
-0002eef0: 706f 6e64 696e 6720 706f 696e 742e 0a20  ponding point.. 
-0002ef00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002ef10: 2020 2072 6574 7572 6e20 7365 6c66 2e73     return self.s
-0002ef20: 7461 7274 2e72 6f74 6174 696f 6e28 7365  tart.rotation(se
-0002ef30: 6c66 2e63 656e 7465 722c 2073 656c 662e  lf.center, self.
-0002ef40: 6e6f 726d 616c 2c0a 2020 2020 2020 2020  normal,.        
-0002ef50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ef60: 2020 2020 2020 2020 2020 2061 6273 6369             absci
-0002ef70: 7373 6120 2f20 7365 6c66 2e72 6164 6975  ssa / self.radiu
-0002ef80: 7329 0a0a 2020 2020 6465 6620 6e6f 726d  s)..    def norm
-0002ef90: 616c 5f76 6563 746f 7228 7365 6c66 2c20  al_vector(self, 
-0002efa0: 6162 7363 6973 7361 293a 0a20 2020 2020  abscissa):.     
-0002efb0: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-0002efc0: 616c 6375 6c61 7465 7320 6120 6e6f 726d  alculates a norm
-0002efd0: 616c 2076 6563 746f 7220 6174 2061 2067  al vector at a g
-0002efe0: 6976 656e 2061 6273 6369 7373 6120 6f66  iven abscissa of
-0002eff0: 2074 6865 2041 7263 3344 2e0a 0a20 2020   the Arc3D...   
-0002f000: 2020 2020 203a 7061 7261 6d20 6162 7363       :param absc
-0002f010: 6973 7361 3a20 6162 7363 6973 7361 2077  issa: abscissa w
-0002f020: 6865 7265 2069 6e20 7468 6520 6375 7276  here in the curv
-0002f030: 6520 7468 6520 6e6f 726d 616c 2076 6563  e the normal vec
-0002f040: 746f 7220 7368 6f75 6c64 2062 6520 6361  tor should be ca
-0002f050: 6c63 756c 6174 6564 2e0a 2020 2020 2020  lculated..      
-0002f060: 2020 3a72 6574 7572 6e3a 2043 6f72 7265    :return: Corre
-0002f070: 7370 6f6e 6469 6e67 206e 6f72 6d61 6c20  sponding normal 
-0002f080: 7665 6374 6f72 2e0a 2020 2020 2020 2020  vector..        
-0002f090: 2222 220a 2020 2020 2020 2020 7468 6574  """.        thet
-0002f0a0: 6120 3d20 6162 7363 6973 7361 202f 2073  a = abscissa / s
-0002f0b0: 656c 662e 7261 6469 7573 0a20 2020 2020  elf.radius.     
-0002f0c0: 2020 206e 5f30 203d 2073 656c 662e 6365     n_0 = self.ce
-0002f0d0: 6e74 6572 202d 2073 656c 662e 7374 6172  nter - self.star
-0002f0e0: 740a 2020 2020 2020 2020 6e6f 726d 616c  t.        normal
-0002f0f0: 203d 206e 5f30 2e72 6f74 6174 696f 6e28   = n_0.rotation(
-0002f100: 7365 6c66 2e63 656e 7465 722c 2073 656c  self.center, sel
-0002f110: 662e 6e6f 726d 616c 2c20 7468 6574 6129  f.normal, theta)
-0002f120: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002f130: 6e6f 726d 616c 0a0a 2020 2020 6465 6620  normal..    def 
-0002f140: 756e 6974 5f6e 6f72 6d61 6c5f 7665 6374  unit_normal_vect
-0002f150: 6f72 2873 656c 662c 2061 6273 6369 7373  or(self, absciss
-0002f160: 6129 3a0a 2020 2020 2020 2020 2222 220a  a):.        """.
-0002f170: 2020 2020 2020 2020 4361 6c63 756c 6174          Calculat
-0002f180: 6573 2061 2075 6e69 7420 6e6f 726d 616c  es a unit normal
-0002f190: 2076 6563 746f 7220 6174 2061 2067 6976   vector at a giv
-0002f1a0: 656e 2061 6273 6369 7373 6120 6f66 2074  en abscissa of t
-0002f1b0: 6865 2041 7263 3344 2e0a 0a20 2020 2020  he Arc3D...     
-0002f1c0: 2020 203a 7061 7261 6d20 6162 7363 6973     :param abscis
-0002f1d0: 7361 3a20 6162 7363 6973 7361 2077 6865  sa: abscissa whe
-0002f1e0: 7265 2069 6e20 7468 6520 6375 7276 6520  re in the curve 
-0002f1f0: 7468 6520 756e 6974 206e 6f72 6d61 6c20  the unit normal 
-0002f200: 7665 6374 6f72 2073 686f 756c 6420 6265  vector should be
-0002f210: 2063 616c 6375 6c61 7465 642e 0a20 2020   calculated..   
-0002f220: 2020 2020 203a 7265 7475 726e 3a20 436f       :return: Co
-0002f230: 7272 6573 706f 6e64 696e 6720 756e 6974  rresponding unit
-0002f240: 206e 6f72 6d61 6c20 7665 6374 6f72 2e0a   normal vector..
-0002f250: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002f260: 2020 2020 6e6f 726d 616c 5f76 6563 746f      normal_vecto
-0002f270: 7220 3d20 7365 6c66 2e6e 6f72 6d61 6c5f  r = self.normal_
-0002f280: 7665 6374 6f72 2861 6273 6369 7373 6129  vector(abscissa)
-0002f290: 0a20 2020 2020 2020 206e 6f72 6d61 6c5f  .        normal_
-0002f2a0: 7665 6374 6f72 2e6e 6f72 6d61 6c69 7a65  vector.normalize
-0002f2b0: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
-0002f2c0: 6e20 6e6f 726d 616c 5f76 6563 746f 720a  n normal_vector.
-0002f2d0: 0a20 2020 2064 6566 2064 6972 6563 7469  .    def directi
-0002f2e0: 6f6e 5f76 6563 746f 7228 7365 6c66 2c20  on_vector(self, 
-0002f2f0: 6162 7363 6973 7361 293a 0a20 2020 2020  abscissa):.     
-0002f300: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-0002f310: 616c 6375 6c61 7465 7320 6120 6469 7265  alculates a dire
-0002f320: 6374 696f 6e20 7665 6374 6f72 2061 7420  ction vector at 
-0002f330: 6120 6769 7665 6e20 6162 7363 6973 7361  a given abscissa
-0002f340: 206f 6620 7468 6520 4172 6333 442e 0a0a   of the Arc3D...
-0002f350: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
-0002f360: 6273 6369 7373 613a 2061 6273 6369 7373  bscissa: absciss
-0002f370: 6120 7768 6572 6520 696e 2074 6865 2063  a where in the c
-0002f380: 7572 7665 2074 6865 2064 6972 6563 7469  urve the directi
-0002f390: 6f6e 2076 6563 746f 7220 7368 6f75 6c64  on vector should
-0002f3a0: 2062 6520 6361 6c63 756c 6174 6564 2e0a   be calculated..
-0002f3b0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-0002f3c0: 2043 6f72 7265 7370 6f6e 6469 6e67 2064   Corresponding d
-0002f3d0: 6972 6563 7469 6f6e 2076 6563 746f 722e  irection vector.
-0002f3e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0002f3f0: 2020 2020 206e 6f72 6d61 6c5f 7665 6374       normal_vect
-0002f400: 6f72 203d 2073 656c 662e 6e6f 726d 616c  or = self.normal
-0002f410: 5f76 6563 746f 7228 6162 7363 6973 7361  _vector(abscissa
-0002f420: 290a 2020 2020 2020 2020 7461 6e67 656e  ).        tangen
-0002f430: 7420 3d20 6e6f 726d 616c 5f76 6563 746f  t = normal_vecto
-0002f440: 722e 6372 6f73 7328 7365 6c66 2e6e 6f72  r.cross(self.nor
-0002f450: 6d61 6c29 0a20 2020 2020 2020 2072 6574  mal).        ret
-0002f460: 7572 6e20 7461 6e67 656e 740a 0a20 2020  urn tangent..   
-0002f470: 2064 6566 2075 6e69 745f 6469 7265 6374   def unit_direct
-0002f480: 696f 6e5f 7665 6374 6f72 2873 656c 662c  ion_vector(self,
-0002f490: 2061 6273 6369 7373 6129 3a0a 2020 2020   abscissa):.    
-0002f4a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002f4b0: 4361 6c63 756c 6174 6573 2061 2075 6e69  Calculates a uni
-0002f4c0: 7420 6469 7265 6374 696f 6e20 7665 6374  t direction vect
-0002f4d0: 6f72 2061 7420 6120 6769 7665 6e20 6162  or at a given ab
-0002f4e0: 7363 6973 7361 206f 6620 7468 6520 4172  scissa of the Ar
-0002f4f0: 6333 442e 0a0a 2020 2020 2020 2020 3a70  c3D...        :p
-0002f500: 6172 616d 2061 6273 6369 7373 613a 2061  aram abscissa: a
-0002f510: 6273 6369 7373 6120 7768 6572 6520 696e  bscissa where in
-0002f520: 2074 6865 2063 7572 7665 2074 6865 2075   the curve the u
-0002f530: 6e69 7420 6469 7265 6374 696f 6e20 7665  nit direction ve
-0002f540: 6374 6f72 2073 686f 756c 6420 6265 2063  ctor should be c
-0002f550: 616c 6375 6c61 7465 642e 0a20 2020 2020  alculated..     
-0002f560: 2020 203a 7265 7475 726e 3a20 436f 7272     :return: Corr
-0002f570: 6573 706f 6e64 696e 6720 756e 6974 2064  esponding unit d
-0002f580: 6972 6563 7469 6f6e 2076 6563 746f 722e  irection vector.
-0002f590: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0002f5a0: 2020 2020 2064 6972 6563 7469 6f6e 5f76       direction_v
-0002f5b0: 6563 746f 7220 3d20 7365 6c66 2e64 6972  ector = self.dir
-0002f5c0: 6563 7469 6f6e 5f76 6563 746f 7228 6162  ection_vector(ab
-0002f5d0: 7363 6973 7361 290a 2020 2020 2020 2020  scissa).        
-0002f5e0: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
-0002f5f0: 2e6e 6f72 6d61 6c69 7a65 2829 0a20 2020  .normalize().   
-0002f600: 2020 2020 2072 6574 7572 6e20 6469 7265       return dire
-0002f610: 6374 696f 6e5f 7665 6374 6f72 0a0a 2020  ction_vector..  
-0002f620: 2020 6465 6620 726f 7461 7469 6f6e 2873    def rotation(s
-0002f630: 656c 662c 2063 656e 7465 723a 2076 6f6c  elf, center: vol
-0002f640: 6d64 6c72 2e50 6f69 6e74 3344 2c0a 2020  mdlr.Point3D,.  
-0002f650: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0002f660: 7869 733a 2076 6f6c 6d64 6c72 2e56 6563  xis: volmdlr.Vec
-0002f670: 746f 7233 442c 2061 6e67 6c65 3a20 666c  tor3D, angle: fl
-0002f680: 6f61 7429 3a0a 2020 2020 2020 2020 2222  oat):.        ""
-0002f690: 220a 2020 2020 2020 2020 4172 6333 4420  ".        Arc3D 
-0002f6a0: 726f 7461 7469 6f6e 2e0a 0a20 2020 2020  rotation...     
-0002f6b0: 2020 203a 7061 7261 6d20 6365 6e74 6572     :param center
-0002f6c0: 3a20 726f 7461 7469 6f6e 2063 656e 7465  : rotation cente
-0002f6d0: 720a 2020 2020 2020 2020 3a70 6172 616d  r.        :param
-0002f6e0: 2061 7869 733a 2072 6f74 6174 696f 6e20   axis: rotation 
-0002f6f0: 6178 6973 0a20 2020 2020 2020 203a 7061  axis.        :pa
-0002f700: 7261 6d20 616e 676c 653a 2061 6e67 6c65  ram angle: angle
-0002f710: 2072 6f74 6174 696f 6e0a 2020 2020 2020   rotation.      
-0002f720: 2020 3a72 6574 7572 6e3a 2061 206e 6577    :return: a new
-0002f730: 2072 6f74 6174 6564 2041 7263 3344 0a20   rotated Arc3D. 
-0002f740: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002f750: 2020 206e 6577 5f73 7461 7274 203d 2073     new_start = s
-0002f760: 656c 662e 7374 6172 742e 726f 7461 7469  elf.start.rotati
-0002f770: 6f6e 2863 656e 7465 722c 2061 7869 732c  on(center, axis,
-0002f780: 2061 6e67 6c65 290a 2020 2020 2020 2020   angle).        
-0002f790: 6e65 775f 696e 7465 7269 6f72 203d 2073  new_interior = s
-0002f7a0: 656c 662e 696e 7465 7269 6f72 2e72 6f74  elf.interior.rot
-0002f7b0: 6174 696f 6e28 6365 6e74 6572 2c20 6178  ation(center, ax
-0002f7c0: 6973 2c20 616e 676c 6529 0a20 2020 2020  is, angle).     
-0002f7d0: 2020 206e 6577 5f65 6e64 203d 2073 656c     new_end = sel
-0002f7e0: 662e 656e 642e 726f 7461 7469 6f6e 2863  f.end.rotation(c
-0002f7f0: 656e 7465 722c 2061 7869 732c 2061 6e67  enter, axis, ang
-0002f800: 6c65 290a 2020 2020 2020 2020 7265 7475  le).        retu
-0002f810: 726e 2041 7263 3344 286e 6577 5f73 7461  rn Arc3D(new_sta
-0002f820: 7274 2c20 6e65 775f 696e 7465 7269 6f72  rt, new_interior
-0002f830: 2c20 6e65 775f 656e 642c 206e 616d 653d  , new_end, name=
-0002f840: 7365 6c66 2e6e 616d 6529 0a0a 2020 2020  self.name)..    
-0002f850: 6465 6620 726f 7461 7469 6f6e 5f69 6e70  def rotation_inp
-0002f860: 6c61 6365 2873 656c 662c 2063 656e 7465  lace(self, cente
-0002f870: 723a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  r: volmdlr.Point
-0002f880: 3344 2c0a 2020 2020 2020 2020 2020 2020  3D,.            
-0002f890: 2020 2020 2020 2020 2020 2020 2061 7869               axi
-0002f8a0: 733a 2076 6f6c 6d64 6c72 2e56 6563 746f  s: volmdlr.Vecto
-0002f8b0: 7233 442c 2061 6e67 6c65 3a20 666c 6f61  r3D, angle: floa
-0002f8c0: 7429 3a0a 2020 2020 2020 2020 2222 220a  t):.        """.
-0002f8d0: 2020 2020 2020 2020 4172 6333 4420 726f          Arc3D ro
-0002f8e0: 7461 7469 6f6e 2e20 4f62 6a65 6374 2069  tation. Object i
-0002f8f0: 7320 7570 6461 7465 6420 696e 706c 6163  s updated inplac
-0002f900: 652e 0a0a 2020 2020 2020 2020 3a70 6172  e...        :par
-0002f910: 616d 2063 656e 7465 723a 2072 6f74 6174  am center: rotat
-0002f920: 696f 6e20 6365 6e74 6572 0a20 2020 2020  ion center.     
-0002f930: 2020 203a 7061 7261 6d20 6178 6973 3a20     :param axis: 
-0002f940: 726f 7461 7469 6f6e 2061 7869 730a 2020  rotation axis.  
-0002f950: 2020 2020 2020 3a70 6172 616d 2061 6e67        :param ang
-0002f960: 6c65 3a20 726f 7461 7469 6f6e 2061 6e67  le: rotation ang
-0002f970: 6c65 0a20 2020 2020 2020 2022 2222 0a20  le.        """. 
-0002f980: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-0002f990: 7761 726e 2822 2769 6e70 6c61 6365 2720  warn("'inplace' 
-0002f9a0: 6d65 7468 6f64 7320 6172 6520 6465 7072  methods are depr
-0002f9b0: 6563 6174 6564 2e20 5573 6520 6120 6e6f  ecated. Use a no
-0002f9c0: 7420 696e 706c 6163 6520 6d65 7468 6f64  t inplace method
-0002f9d0: 2069 6e73 7465 6164 2e22 2c20 4465 7072   instead.", Depr
-0002f9e0: 6563 6174 696f 6e57 6172 6e69 6e67 290a  ecationWarning).
-0002f9f0: 0a20 2020 2020 2020 2073 656c 662e 6365  .        self.ce
-0002fa00: 6e74 6572 2e72 6f74 6174 696f 6e5f 696e  nter.rotation_in
-0002fa10: 706c 6163 6528 6365 6e74 6572 2c20 6178  place(center, ax
-0002fa20: 6973 2c20 616e 676c 6529 0a20 2020 2020  is, angle).     
-0002fa30: 2020 2073 656c 662e 7374 6172 742e 726f     self.start.ro
-0002fa40: 7461 7469 6f6e 5f69 6e70 6c61 6365 2863  tation_inplace(c
-0002fa50: 656e 7465 722c 2061 7869 732c 2061 6e67  enter, axis, ang
-0002fa60: 6c65 290a 2020 2020 2020 2020 7365 6c66  le).        self
-0002fa70: 2e69 6e74 6572 696f 722e 726f 7461 7469  .interior.rotati
-0002fa80: 6f6e 5f69 6e70 6c61 6365 2863 656e 7465  on_inplace(cente
-0002fa90: 722c 2061 7869 732c 2061 6e67 6c65 290a  r, axis, angle).
-0002faa0: 2020 2020 2020 2020 7365 6c66 2e65 6e64          self.end
-0002fab0: 2e72 6f74 6174 696f 6e5f 696e 706c 6163  .rotation_inplac
-0002fac0: 6528 6365 6e74 6572 2c20 6178 6973 2c20  e(center, axis, 
-0002fad0: 616e 676c 6529 0a20 2020 2020 2020 2073  angle).        s
-0002fae0: 656c 662e 5f62 626f 7820 3d20 4e6f 6e65  elf._bbox = None
-0002faf0: 0a0a 2020 2020 6465 6620 7472 616e 736c  ..    def transl
-0002fb00: 6174 696f 6e28 7365 6c66 2c20 6f66 6673  ation(self, offs
-0002fb10: 6574 3a20 766f 6c6d 646c 722e 5665 6374  et: volmdlr.Vect
-0002fb20: 6f72 3344 293a 0a20 2020 2020 2020 2022  or3D):.        "
-0002fb30: 2222 0a20 2020 2020 2020 2041 7263 3344  "".        Arc3D
-0002fb40: 2074 7261 6e73 6c61 7469 6f6e 2e0a 0a20   translation... 
-0002fb50: 2020 2020 2020 203a 7061 7261 6d20 6f66         :param of
-0002fb60: 6673 6574 3a20 7472 616e 736c 6174 696f  fset: translatio
-0002fb70: 6e20 7665 6374 6f72 2e0a 2020 2020 2020  n vector..      
-0002fb80: 2020 3a72 6574 7572 6e3a 2041 206e 6577    :return: A new
-0002fb90: 2074 7261 6e73 6c61 7465 6420 4172 6333   translated Arc3
-0002fba0: 442e 0a20 2020 2020 2020 2022 2222 0a20  D..        """. 
-0002fbb0: 2020 2020 2020 206e 6577 5f73 7461 7274         new_start
-0002fbc0: 203d 2073 656c 662e 7374 6172 742e 7472   = self.start.tr
-0002fbd0: 616e 736c 6174 696f 6e28 6f66 6673 6574  anslation(offset
-0002fbe0: 290a 2020 2020 2020 2020 6e65 775f 696e  ).        new_in
-0002fbf0: 7465 7269 6f72 203d 2073 656c 662e 696e  terior = self.in
-0002fc00: 7465 7269 6f72 2e74 7261 6e73 6c61 7469  terior.translati
-0002fc10: 6f6e 286f 6666 7365 7429 0a20 2020 2020  on(offset).     
-0002fc20: 2020 206e 6577 5f65 6e64 203d 2073 656c     new_end = sel
-0002fc30: 662e 656e 642e 7472 616e 736c 6174 696f  f.end.translatio
-0002fc40: 6e28 6f66 6673 6574 290a 2020 2020 2020  n(offset).      
-0002fc50: 2020 7265 7475 726e 2041 7263 3344 286e    return Arc3D(n
-0002fc60: 6577 5f73 7461 7274 2c20 6e65 775f 696e  ew_start, new_in
-0002fc70: 7465 7269 6f72 2c20 6e65 775f 656e 642c  terior, new_end,
-0002fc80: 206e 616d 653d 7365 6c66 2e6e 616d 6529   name=self.name)
-0002fc90: 0a0a 2020 2020 6465 6620 7472 616e 736c  ..    def transl
-0002fca0: 6174 696f 6e5f 696e 706c 6163 6528 7365  ation_inplace(se
-0002fcb0: 6c66 2c20 6f66 6673 6574 3a20 766f 6c6d  lf, offset: volm
-0002fcc0: 646c 722e 5665 6374 6f72 3344 293a 0a20  dlr.Vector3D):. 
-0002fcd0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002fce0: 2020 2041 7263 3344 2074 7261 6e73 6c61     Arc3D transla
-0002fcf0: 7469 6f6e 2e20 4f62 6a65 6374 2069 7320  tion. Object is 
-0002fd00: 7570 6461 7465 6420 696e 706c 6163 652e  updated inplace.
-0002fd10: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0002fd20: 206f 6666 7365 743a 2074 7261 6e73 6c61   offset: transla
-0002fd30: 7469 6f6e 2076 6563 746f 722e 0a20 2020  tion vector..   
-0002fd40: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002fd50: 2077 6172 6e69 6e67 732e 7761 726e 2822   warnings.warn("
-0002fd60: 2769 6e70 6c61 6365 2720 6d65 7468 6f64  'inplace' method
-0002fd70: 7320 6172 6520 6465 7072 6563 6174 6564  s are deprecated
-0002fd80: 2e20 5573 6520 6120 6e6f 7420 696e 706c  . Use a not inpl
-0002fd90: 6163 6520 6d65 7468 6f64 2069 6e73 7465  ace method inste
-0002fda0: 6164 2e22 2c20 4465 7072 6563 6174 696f  ad.", Deprecatio
-0002fdb0: 6e57 6172 6e69 6e67 290a 0a20 2020 2020  nWarning)..     
-0002fdc0: 2020 2073 656c 662e 6365 6e74 6572 2e74     self.center.t
-0002fdd0: 7261 6e73 6c61 7469 6f6e 5f69 6e70 6c61  ranslation_inpla
-0002fde0: 6365 286f 6666 7365 7429 0a20 2020 2020  ce(offset).     
-0002fdf0: 2020 2073 656c 662e 7374 6172 742e 7472     self.start.tr
-0002fe00: 616e 736c 6174 696f 6e5f 696e 706c 6163  anslation_inplac
-0002fe10: 6528 6f66 6673 6574 290a 2020 2020 2020  e(offset).      
-0002fe20: 2020 7365 6c66 2e69 6e74 6572 696f 722e    self.interior.
-0002fe30: 7472 616e 736c 6174 696f 6e5f 696e 706c  translation_inpl
-0002fe40: 6163 6528 6f66 6673 6574 290a 2020 2020  ace(offset).    
-0002fe50: 2020 2020 7365 6c66 2e65 6e64 2e74 7261      self.end.tra
-0002fe60: 6e73 6c61 7469 6f6e 5f69 6e70 6c61 6365  nslation_inplace
-0002fe70: 286f 6666 7365 7429 0a20 2020 2020 2020  (offset).       
-0002fe80: 2073 656c 662e 5f62 626f 7820 3d20 4e6f   self._bbox = No
-0002fe90: 6e65 0a0a 2020 2020 6465 6620 706c 6f74  ne..    def plot
-0002fea0: 2873 656c 662c 2061 783d 4e6f 6e65 2c20  (self, ax=None, 
-0002feb0: 636f 6c6f 723d 276b 272c 2061 6c70 6861  color='k', alpha
-0002fec0: 3d31 2c0a 2020 2020 2020 2020 2020 2020  =1,.            
-0002fed0: 2065 6467 655f 656e 6473 3d46 616c 7365   edge_ends=False
-0002fee0: 2c20 6564 6765 5f64 6972 6563 7469 6f6e  , edge_direction
-0002fef0: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
-0002ff00: 2069 6620 6178 2069 7320 4e6f 6e65 3a0a   if ax is None:.
-0002ff10: 2020 2020 2020 2020 2020 2020 6178 203d              ax =
-0002ff20: 2070 6c74 2e66 6967 7572 6528 292e 6164   plt.figure().ad
-0002ff30: 645f 7375 6270 6c6f 7428 3131 312c 2070  d_subplot(111, p
-0002ff40: 726f 6a65 6374 696f 6e3d 2733 6427 290a  rojection='3d').
-0002ff50: 2020 2020 2020 2020 2320 6966 2070 6c6f          # if plo
-0002ff60: 745f 706f 696e 7473 3a0a 2020 2020 2020  t_points:.      
-0002ff70: 2020 2320 2020 2020 6178 2e70 6c6f 7428    #     ax.plot(
-0002ff80: 5b73 656c 662e 696e 7465 7269 6f72 5b30  [self.interior[0
-0002ff90: 5d5d 2c20 5b73 656c 662e 696e 7465 7269  ]], [self.interi
-0002ffa0: 6f72 5b31 5d5d 2c20 5b73 656c 662e 696e  or[1]], [self.in
-0002ffb0: 7465 7269 6f72 5b32 5d5d 2c0a 2020 2020  terior[2]],.    
-0002ffc0: 2020 2020 2320 2020 2020 2020 2020 2020      #           
-0002ffd0: 2020 636f 6c6f 723d 2762 2729 0a20 2020    color='b').   
-0002ffe0: 2020 2020 2023 2020 2020 2061 782e 706c       #     ax.pl
-0002fff0: 6f74 285b 7365 6c66 2e73 7461 7274 5b30  ot([self.start[0
-00030000: 5d5d 2c20 5b73 656c 662e 7374 6172 745b  ]], [self.start[
-00030010: 315d 5d2c 205b 7365 6c66 2e73 7461 7274  1]], [self.start
-00030020: 5b32 5d5d 2c20 633d 2772 2729 0a20 2020  [2]], c='r').   
-00030030: 2020 2020 2023 2020 2020 2061 782e 706c       #     ax.pl
-00030040: 6f74 285b 7365 6c66 2e65 6e64 5b30 5d5d  ot([self.end[0]]
-00030050: 2c20 5b73 656c 662e 656e 645b 315d 5d2c  , [self.end[1]],
-00030060: 205b 7365 6c66 2e65 6e64 5b32 5d5d 2c20   [self.end[2]], 
-00030070: 633d 2772 2729 0a20 2020 2020 2020 2023  c='r').        #
-00030080: 2020 2020 2061 782e 706c 6f74 285b 7365       ax.plot([se
-00030090: 6c66 2e69 6e74 6572 696f 725b 305d 5d2c  lf.interior[0]],
-000300a0: 205b 7365 6c66 2e69 6e74 6572 696f 725b   [self.interior[
-000300b0: 315d 5d2c 205b 7365 6c66 2e69 6e74 6572  1]], [self.inter
-000300c0: 696f 725b 325d 5d2c 0a20 2020 2020 2020  ior[2]],.       
-000300d0: 2023 2020 2020 2020 2020 2020 2020 2063   #             c
-000300e0: 3d27 6727 290a 2020 2020 2020 2020 7820  ='g').        x 
-000300f0: 3d20 5b5d 0a20 2020 2020 2020 2079 203d  = [].        y =
-00030100: 205b 5d0a 2020 2020 2020 2020 7a20 3d20   [].        z = 
-00030110: 5b5d 0a20 2020 2020 2020 2066 6f72 2070  [].        for p
-00030120: 6f69 6e74 782c 2070 6f69 6e74 792c 2070  ointx, pointy, p
-00030130: 6f69 6e74 7a20 696e 2073 656c 662e 6469  ointz in self.di
-00030140: 7363 7265 7469 7a61 7469 6f6e 5f70 6f69  scretization_poi
-00030150: 6e74 7328 6e75 6d62 6572 5f70 6f69 6e74  nts(number_point
-00030160: 733d 3235 293a 0a20 2020 2020 2020 2020  s=25):.         
-00030170: 2020 2078 2e61 7070 656e 6428 706f 696e     x.append(poin
-00030180: 7478 290a 2020 2020 2020 2020 2020 2020  tx).            
-00030190: 792e 6170 7065 6e64 2870 6f69 6e74 7929  y.append(pointy)
-000301a0: 0a20 2020 2020 2020 2020 2020 207a 2e61  .            z.a
-000301b0: 7070 656e 6428 706f 696e 747a 290a 0a20  ppend(pointz).. 
-000301c0: 2020 2020 2020 2061 782e 706c 6f74 2878         ax.plot(x
-000301d0: 2c20 792c 207a 2c20 636f 6c6f 723d 636f  , y, z, color=co
-000301e0: 6c6f 722c 2061 6c70 6861 3d61 6c70 6861  lor, alpha=alpha
-000301f0: 290a 2020 2020 2020 2020 6966 2065 6467  ).        if edg
-00030200: 655f 656e 6473 3a0a 2020 2020 2020 2020  e_ends:.        
-00030210: 2020 2020 7365 6c66 2e73 7461 7274 2e70      self.start.p
-00030220: 6c6f 7428 6178 3d61 7829 0a20 2020 2020  lot(ax=ax).     
-00030230: 2020 2020 2020 2073 656c 662e 656e 642e         self.end.
-00030240: 706c 6f74 2861 783d 6178 290a 0a20 2020  plot(ax=ax)..   
-00030250: 2020 2020 2069 6620 6564 6765 5f64 6972       if edge_dir
-00030260: 6563 7469 6f6e 3a0a 2020 2020 2020 2020  ection:.        
-00030270: 2020 2020 782c 2079 2c20 7a20 3d20 7365      x, y, z = se
-00030280: 6c66 2e70 6f69 6e74 5f61 745f 6162 7363  lf.point_at_absc
-00030290: 6973 7361 2830 2e35 202a 2073 656c 662e  issa(0.5 * self.
-000302a0: 6c65 6e67 7468 2829 290a 2020 2020 2020  length()).      
-000302b0: 2020 2020 2020 752c 2076 2c20 7720 3d20        u, v, w = 
-000302c0: 302e 3035 202a 2073 656c 662e 756e 6974  0.05 * self.unit
-000302d0: 5f64 6972 6563 7469 6f6e 5f76 6563 746f  _direction_vecto
-000302e0: 7228 302e 3520 2a20 7365 6c66 2e6c 656e  r(0.5 * self.len
-000302f0: 6774 6828 2929 0a20 2020 2020 2020 2020  gth()).         
-00030300: 2020 2061 782e 7175 6976 6572 2878 2c20     ax.quiver(x, 
-00030310: 792c 207a 2c20 752c 2076 2c20 772c 206c  y, z, u, v, w, l
-00030320: 656e 6774 683d 7365 6c66 2e6c 656e 6774  ength=self.lengt
-00030330: 6828 2920 2f20 3130 302c 0a20 2020 2020  h() / 100,.     
-00030340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030350: 2061 7272 6f77 5f6c 656e 6774 685f 7261   arrow_length_ra
-00030360: 7469 6f3d 352c 206e 6f72 6d61 6c69 7a65  tio=5, normalize
-00030370: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
-00030380: 2020 2020 2020 2020 2020 2020 2070 6976               piv
-00030390: 6f74 3d27 7469 7027 2c20 636f 6c6f 723d  ot='tip', color=
-000303a0: 636f 6c6f 7229 0a20 2020 2020 2020 2072  color).        r
-000303b0: 6574 7572 6e20 6178 0a0a 2020 2020 6465  eturn ax..    de
-000303c0: 6620 706c 6f74 3264 2873 656c 662c 2063  f plot2d(self, c
-000303d0: 656e 7465 723a 2076 6f6c 6d64 6c72 2e50  enter: volmdlr.P
-000303e0: 6f69 6e74 3344 203d 2076 6f6c 6d64 6c72  oint3D = volmdlr
-000303f0: 2e4f 3344 2c0a 2020 2020 2020 2020 2020  .O3D,.          
-00030400: 2020 2020 2078 3364 3a20 766f 6c6d 646c       x3d: volmdl
-00030410: 722e 5665 6374 6f72 3344 203d 2076 6f6c  r.Vector3D = vol
-00030420: 6d64 6c72 2e58 3344 2c20 7933 643a 2076  mdlr.X3D, y3d: v
-00030430: 6f6c 6d64 6c72 2e56 6563 746f 7233 4420  olmdlr.Vector3D 
-00030440: 3d20 766f 6c6d 646c 722e 5933 442c 0a20  = volmdlr.Y3D,. 
-00030450: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00030460: 3d4e 6f6e 652c 2063 6f6c 6f72 3d27 6b27  =None, color='k'
-00030470: 293a 0a0a 2020 2020 2020 2020 6966 2061  ):..        if a
-00030480: 7820 6973 204e 6f6e 653a 0a20 2020 2020  x is None:.     
-00030490: 2020 2020 2020 2066 6967 203d 2070 6c74         fig = plt
-000304a0: 2e66 6967 7572 6528 290a 2020 2020 2020  .figure().      
-000304b0: 2020 2020 2020 6178 203d 2066 6967 2e61        ax = fig.a
-000304c0: 6464 5f73 7562 706c 6f74 2831 3131 2c20  dd_subplot(111, 
-000304d0: 7072 6f6a 6563 7469 6f6e 3d27 3364 2729  projection='3d')
-000304e0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000304f0: 2020 2020 2020 2020 2020 2066 6967 203d             fig =
-00030500: 2061 782e 6669 6775 7265 0a0a 2020 2020   ax.figure..    
-00030510: 2020 2020 2320 544f 444f 3a20 456e 6861      # TODO: Enha
-00030520: 6e63 6520 7468 6973 2070 6c6f 740a 2020  nce this plot.  
-00030530: 2020 2020 2020 6c20 3d20 7365 6c66 2e6c        l = self.l
-00030540: 656e 6774 6828 290a 2020 2020 2020 2020  ength().        
-00030550: 7820 3d20 5b5d 0a20 2020 2020 2020 2079  x = [].        y
-00030560: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-00030570: 7220 6920 696e 2072 616e 6765 2833 3029  r i in range(30)
-00030580: 3a0a 2020 2020 2020 2020 2020 2020 7020  :.            p 
-00030590: 3d20 7365 6c66 2e70 6f69 6e74 5f61 745f  = self.point_at_
-000305a0: 6162 7363 6973 7361 2869 202f 2028 3239  abscissa(i / (29
-000305b0: 2e29 202a 206c 290a 2020 2020 2020 2020  .) * l).        
-000305c0: 2020 2020 7869 2c20 7969 203d 2070 2e70      xi, yi = p.p
-000305d0: 6c61 6e65 5f70 726f 6a65 6374 696f 6e32  lane_projection2
-000305e0: 6428 6365 6e74 6572 2c20 7833 642c 2079  d(center, x3d, y
-000305f0: 3364 290a 2020 2020 2020 2020 2020 2020  3d).            
-00030600: 782e 6170 7065 6e64 2878 6929 0a20 2020  x.append(xi).   
-00030610: 2020 2020 2020 2020 2079 2e61 7070 656e           y.appen
-00030620: 6428 7969 290a 2020 2020 2020 2020 6178  d(yi).        ax
-00030630: 2e70 6c6f 7428 782c 2079 2c20 636f 6c6f  .plot(x, y, colo
-00030640: 723d 636f 6c6f 7229 0a0a 2020 2020 2020  r=color)..      
-00030650: 2020 7265 7475 726e 2061 780a 0a20 2020    return ax..   
-00030660: 2064 6566 2063 6f70 7928 7365 6c66 2c20   def copy(self, 
-00030670: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-00030680: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00030690: 2041 7263 3344 2873 656c 662e 7374 6172   Arc3D(self.star
-000306a0: 742e 636f 7079 2829 2c20 7365 6c66 2e69  t.copy(), self.i
-000306b0: 6e74 6572 696f 722e 636f 7079 2829 2c20  nterior.copy(), 
-000306c0: 7365 6c66 2e65 6e64 2e63 6f70 7928 2929  self.end.copy())
-000306d0: 0a0a 2020 2020 6465 6620 6672 616d 655f  ..    def frame_
-000306e0: 6d61 7070 696e 675f 7061 7261 6d65 7465  mapping_paramete
-000306f0: 7273 2873 656c 662c 2066 7261 6d65 3a20  rs(self, frame: 
-00030700: 766f 6c6d 646c 722e 4672 616d 6533 442c  volmdlr.Frame3D,
-00030710: 2073 6964 653a 2073 7472 293a 0a20 2020   side: str):.   
-00030720: 2020 2020 2069 6620 7369 6465 203d 3d20       if side == 
-00030730: 276f 6c64 273a 0a20 2020 2020 2020 2020  'old':.         
-00030740: 2020 206e 6577 5f73 7461 7274 203d 2066     new_start = f
-00030750: 7261 6d65 2e6c 6f63 616c 5f74 6f5f 676c  rame.local_to_gl
-00030760: 6f62 616c 5f63 6f6f 7264 696e 6174 6573  obal_coordinates
-00030770: 2873 656c 662e 7374 6172 742e 636f 7079  (self.start.copy
-00030780: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
-00030790: 6e65 775f 696e 7465 7269 6f72 203d 2066  new_interior = f
-000307a0: 7261 6d65 2e6c 6f63 616c 5f74 6f5f 676c  rame.local_to_gl
-000307b0: 6f62 616c 5f63 6f6f 7264 696e 6174 6573  obal_coordinates
-000307c0: 2873 656c 662e 696e 7465 7269 6f72 2e63  (self.interior.c
-000307d0: 6f70 7928 2929 0a20 2020 2020 2020 2020  opy()).         
-000307e0: 2020 206e 6577 5f65 6e64 203d 2066 7261     new_end = fra
-000307f0: 6d65 2e6c 6f63 616c 5f74 6f5f 676c 6f62  me.local_to_glob
-00030800: 616c 5f63 6f6f 7264 696e 6174 6573 2873  al_coordinates(s
-00030810: 656c 662e 656e 642e 636f 7079 2829 290a  elf.end.copy()).
-00030820: 2020 2020 2020 2020 656c 6966 2073 6964          elif sid
-00030830: 6520 3d3d 2027 6e65 7727 3a0a 2020 2020  e == 'new':.    
-00030840: 2020 2020 2020 2020 6e65 775f 7374 6172          new_star
-00030850: 7420 3d20 6672 616d 652e 676c 6f62 616c  t = frame.global
-00030860: 5f74 6f5f 6c6f 6361 6c5f 636f 6f72 6469  _to_local_coordi
-00030870: 6e61 7465 7328 7365 6c66 2e73 7461 7274  nates(self.start
-00030880: 2e63 6f70 7928 2929 0a20 2020 2020 2020  .copy()).       
-00030890: 2020 2020 206e 6577 5f69 6e74 6572 696f       new_interio
-000308a0: 7220 3d20 6672 616d 652e 676c 6f62 616c  r = frame.global
-000308b0: 5f74 6f5f 6c6f 6361 6c5f 636f 6f72 6469  _to_local_coordi
-000308c0: 6e61 7465 7328 7365 6c66 2e69 6e74 6572  nates(self.inter
-000308d0: 696f 722e 636f 7079 2829 290a 2020 2020  ior.copy()).    
-000308e0: 2020 2020 2020 2020 6e65 775f 656e 6420          new_end 
-000308f0: 3d20 6672 616d 652e 676c 6f62 616c 5f74  = frame.global_t
-00030900: 6f5f 6c6f 6361 6c5f 636f 6f72 6469 6e61  o_local_coordina
-00030910: 7465 7328 7365 6c66 2e65 6e64 2e63 6f70  tes(self.end.cop
-00030920: 7928 2929 0a20 2020 2020 2020 2065 6c73  y()).        els
-00030930: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00030940: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00030950: 2773 6964 6520 7661 6c75 6520 6e6f 7420  'side value not 
-00030960: 7661 6c69 642c 2070 6c65 6173 6520 7370  valid, please sp
-00030970: 6563 6966 7927 0a20 2020 2020 2020 2020  ecify'.         
-00030980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030990: 2020 2020 2761 2063 6f72 7265 6374 2076      'a correct v
-000309a0: 616c 7565 3a20 5c27 6f6c 645c 2720 6f72  alue: \'old\' or
-000309b0: 205c 276e 6577 5c27 2729 0a20 2020 2020   \'new\'').     
-000309c0: 2020 2072 6574 7572 6e20 6e65 775f 7374     return new_st
-000309d0: 6172 742c 206e 6577 5f69 6e74 6572 696f  art, new_interio
-000309e0: 722c 206e 6577 5f65 6e64 0a0a 2020 2020  r, new_end..    
-000309f0: 6465 6620 6672 616d 655f 6d61 7070 696e  def frame_mappin
-00030a00: 6728 7365 6c66 2c20 6672 616d 653a 2076  g(self, frame: v
-00030a10: 6f6c 6d64 6c72 2e46 7261 6d65 3344 2c20  olmdlr.Frame3D, 
-00030a20: 7369 6465 3a20 7374 7229 3a0a 2020 2020  side: str):.    
-00030a30: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00030a40: 4368 616e 6765 7320 7665 6374 6f72 2066  Changes vector f
-00030a50: 7261 6d65 5f6d 6170 7069 6e67 2061 6e64  rame_mapping and
-00030a60: 2072 6574 7572 6e20 6120 6e65 7720 4172   return a new Ar
-00030a70: 6333 442e 0a0a 2020 2020 2020 2020 7369  c3D...        si
-00030a80: 6465 203d 2027 6f6c 6427 206f 7220 276e  de = 'old' or 'n
-00030a90: 6577 270a 2020 2020 2020 2020 2222 220a  ew'.        """.
-00030aa0: 2020 2020 2020 2020 6e65 775f 7374 6172          new_star
-00030ab0: 742c 206e 6577 5f69 6e74 6572 696f 722c  t, new_interior,
-00030ac0: 206e 6577 5f65 6e64 203d 5c0a 2020 2020   new_end =\.    
-00030ad0: 2020 2020 2020 2020 7365 6c66 2e66 7261          self.fra
-00030ae0: 6d65 5f6d 6170 7069 6e67 5f70 6172 616d  me_mapping_param
-00030af0: 6574 6572 7328 6672 616d 652c 2073 6964  eters(frame, sid
-00030b00: 6529 0a0a 2020 2020 2020 2020 7265 7475  e)..        retu
-00030b10: 726e 2041 7263 3344 286e 6577 5f73 7461  rn Arc3D(new_sta
-00030b20: 7274 2c20 6e65 775f 696e 7465 7269 6f72  rt, new_interior
-00030b30: 2c20 6e65 775f 656e 642c 206e 616d 653d  , new_end, name=
-00030b40: 7365 6c66 2e6e 616d 6529 0a0a 2020 2020  self.name)..    
-00030b50: 6465 6620 6672 616d 655f 6d61 7070 696e  def frame_mappin
-00030b60: 675f 696e 706c 6163 6528 7365 6c66 2c20  g_inplace(self, 
-00030b70: 6672 616d 653a 2076 6f6c 6d64 6c72 2e46  frame: volmdlr.F
-00030b80: 7261 6d65 3344 2c20 7369 6465 3a20 7374  rame3D, side: st
-00030b90: 7229 3a0a 2020 2020 2020 2020 2222 220a  r):.        """.
-00030ba0: 2020 2020 2020 2020 4368 616e 6765 7320          Changes 
-00030bb0: 7665 6374 6f72 2066 7261 6d65 5f6d 6170  vector frame_map
-00030bc0: 7069 6e67 2061 6e64 2074 6865 206f 626a  ping and the obj
-00030bd0: 6563 7420 6973 2075 7064 6174 6564 2069  ect is updated i
-00030be0: 6e70 6c61 6365 2e0a 0a20 2020 2020 2020  nplace...       
-00030bf0: 2073 6964 6520 3d20 276f 6c64 2720 6f72   side = 'old' or
-00030c00: 2027 6e65 7727 0a20 2020 2020 2020 2022   'new'.        "
-00030c10: 2222 0a20 2020 2020 2020 2077 6172 6e69  "".        warni
-00030c20: 6e67 732e 7761 726e 2822 2769 6e70 6c61  ngs.warn("'inpla
-00030c30: 6365 2720 6d65 7468 6f64 7320 6172 6520  ce' methods are 
-00030c40: 6465 7072 6563 6174 6564 2e20 5573 6520  deprecated. Use 
-00030c50: 6120 6e6f 7420 696e 706c 6163 6520 6d65  a not inplace me
-00030c60: 7468 6f64 2069 6e73 7465 6164 2e22 2c20  thod instead.", 
-00030c70: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
-00030c80: 6e67 290a 0a20 2020 2020 2020 206e 6577  ng)..        new
-00030c90: 5f73 7461 7274 2c20 6e65 775f 696e 7465  _start, new_inte
-00030ca0: 7269 6f72 2c20 6e65 775f 656e 6420 3d20  rior, new_end = 
-00030cb0: 5c0a 2020 2020 2020 2020 2020 2020 7365  \.            se
-00030cc0: 6c66 2e66 7261 6d65 5f6d 6170 7069 6e67  lf.frame_mapping
-00030cd0: 5f70 6172 616d 6574 6572 7328 6672 616d  _parameters(fram
-00030ce0: 652c 2073 6964 6529 0a20 2020 2020 2020  e, side).       
-00030cf0: 2073 656c 662e 7374 6172 742c 2073 656c   self.start, sel
-00030d00: 662e 696e 7465 7269 6f72 2c20 7365 6c66  f.interior, self
-00030d10: 2e65 6e64 203d 206e 6577 5f73 7461 7274  .end = new_start
-00030d20: 2c20 6e65 775f 696e 7465 7269 6f72 2c20  , new_interior, 
-00030d30: 6e65 775f 656e 640a 2020 2020 2020 2020  new_end.        
-00030d40: 7365 6c66 2e5f 6262 6f78 203d 204e 6f6e  self._bbox = Non
-00030d50: 650a 0a20 2020 2064 6566 2061 6273 6369  e..    def absci
-00030d60: 7373 6128 7365 6c66 2c20 706f 696e 7433  ssa(self, point3
-00030d70: 643a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  d: volmdlr.Point
-00030d80: 3344 293a 0a20 2020 2020 2020 2022 2222  3D):.        """
-00030d90: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
-00030da0: 7465 7320 7468 6520 6162 7363 6973 7361  tes the abscissa
-00030db0: 2067 6976 656e 2061 2070 6f69 6e74 2069   given a point i
-00030dc0: 6e20 7468 6520 4172 6333 442e 0a0a 2020  n the Arc3D...  
-00030dd0: 2020 2020 2020 3a70 6172 616d 2070 6f69        :param poi
-00030de0: 6e74 3364 3a20 706f 696e 7420 746f 2063  nt3d: point to c
-00030df0: 616c 6375 6c61 7465 2074 6865 2061 6273  alculate the abs
-00030e00: 6369 7373 612e 0a20 2020 2020 2020 203a  cissa..        :
-00030e10: 7265 7475 726e 3a20 636f 7272 6573 706f  return: correspo
-00030e20: 6e64 696e 6720 6162 7363 6973 7361 2e0a  nding abscissa..
-00030e30: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00030e40: 2020 2020 782c 2079 2c20 5f20 3d20 7365      x, y, _ = se
-00030e50: 6c66 2e66 7261 6d65 2e67 6c6f 6261 6c5f  lf.frame.global_
-00030e60: 746f 5f6c 6f63 616c 5f63 6f6f 7264 696e  to_local_coordin
-00030e70: 6174 6573 2870 6f69 6e74 3364 290a 2020  ates(point3d).  
-00030e80: 2020 2020 2020 7531 203d 2078 202f 2073        u1 = x / s
-00030e90: 656c 662e 7261 6469 7573 0a20 2020 2020  elf.radius.     
-00030ea0: 2020 2075 3220 3d20 7920 2f20 7365 6c66     u2 = y / self
-00030eb0: 2e72 6164 6975 730a 2020 2020 2020 2020  .radius.        
-00030ec0: 7468 6574 6120 3d20 766f 6c6d 646c 722e  theta = volmdlr.
-00030ed0: 6765 6f6d 6574 7279 2e73 696e 5f63 6f73  geometry.sin_cos
-00030ee0: 5f61 6e67 6c65 2875 312c 2075 3229 0a0a  _angle(u1, u2)..
-00030ef0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00030f00: 656c 662e 7261 6469 7573 202a 2061 6273  elf.radius * abs
-00030f10: 2874 6865 7461 290a 0a20 2020 2064 6566  (theta)..    def
-00030f20: 2073 706c 6974 2873 656c 662c 2073 706c   split(self, spl
-00030f30: 6974 5f70 6f69 6e74 3a20 766f 6c6d 646c  it_point: volmdl
-00030f40: 722e 506f 696e 7433 4429 3a0a 2020 2020  r.Point3D):.    
-00030f50: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00030f60: 5370 6c69 7473 2074 6865 2041 7263 3244  Splits the Arc2D
-00030f70: 2069 6e20 7477 6f20 6174 2061 2067 6976   in two at a giv
-00030f80: 656e 2070 6f69 6e74 2e0a 0a20 2020 2020  en point...     
-00030f90: 2020 203a 7061 7261 6d20 7370 6c69 745f     :param split_
-00030fa0: 706f 696e 743a 2073 706c 6974 7469 6e67  point: splitting
-00030fb0: 2070 6f69 6e74 0a20 2020 2020 2020 203a   point.        :
-00030fc0: 7265 7475 726e 3a20 7477 6f20 4172 6332  return: two Arc2
-00030fd0: 442e 0a20 2020 2020 2020 2022 2222 0a20  D..        """. 
-00030fe0: 2020 2020 2020 2061 6273 6369 7373 6120         abscissa 
-00030ff0: 3d20 7365 6c66 2e61 6273 6369 7373 6128  = self.abscissa(
-00031000: 7370 6c69 745f 706f 696e 7429 0a0a 2020  split_point)..  
-00031010: 2020 2020 2020 7265 7475 726e 205b 4172        return [Ar
-00031020: 6333 4428 7365 6c66 2e73 7461 7274 2c0a  c3D(self.start,.
-00031030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031040: 2020 2020 2020 7365 6c66 2e70 6f69 6e74        self.point
-00031050: 5f61 745f 6162 7363 6973 7361 2830 2e35  _at_abscissa(0.5
-00031060: 202a 2061 6273 6369 7373 6129 2c0a 2020   * abscissa),.  
-00031070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031080: 2020 2020 7370 6c69 745f 706f 696e 7429      split_point)
-00031090: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000310a0: 2020 4172 6333 4428 7370 6c69 745f 706f    Arc3D(split_po
-000310b0: 696e 742c 0a20 2020 2020 2020 2020 2020  int,.           
-000310c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000310d0: 706f 696e 745f 6174 5f61 6273 6369 7373  point_at_absciss
-000310e0: 6128 312e 3520 2a20 6162 7363 6973 7361  a(1.5 * abscissa
-000310f0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00031100: 2020 2020 2020 2020 2073 656c 662e 656e           self.en
-00031110: 6429 0a20 2020 2020 2020 2020 2020 2020  d).             
-00031120: 2020 205d 0a0a 2020 2020 6465 6620 746f     ]..    def to
-00031130: 5f32 6428 7365 6c66 2c20 706c 616e 655f  _2d(self, plane_
-00031140: 6f72 6967 696e 2c20 782c 2079 293a 0a20  origin, x, y):. 
-00031150: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00031160: 2020 2054 7261 6e73 666f 726d 7320 6120     Transforms a 
-00031170: 4172 6333 4420 696e 746f 2061 6e20 4172  Arc3D into an Ar
-00031180: 6332 442c 2067 6976 656e 2061 6e20 706c  c2D, given an pl
-00031190: 616e 6520 6f72 6967 696e 2061 6e64 2061  ane origin and a
-000311a0: 2075 2061 6e64 2076 2070 6c61 6e65 2076   u and v plane v
-000311b0: 6563 746f 722e 0a0a 2020 2020 2020 2020  ector...        
-000311c0: 3a70 6172 616d 2070 6c61 6e65 5f6f 7269  :param plane_ori
-000311d0: 6769 6e3a 2070 6c61 6e65 206f 7269 6769  gin: plane origi
-000311e0: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
-000311f0: 6d20 783a 2070 6c61 6e65 2075 2076 6563  m x: plane u vec
-00031200: 746f 722e 0a20 2020 2020 2020 203a 7061  tor..        :pa
-00031210: 7261 6d20 793a 2070 6c61 6e65 2076 2076  ram y: plane v v
-00031220: 6563 746f 722e 0a20 2020 2020 2020 203a  ector..        :
-00031230: 7265 7475 726e 3a20 4172 6332 442e 0a20  return: Arc2D.. 
-00031240: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00031250: 2020 2070 7320 3d20 7365 6c66 2e73 7461     ps = self.sta
-00031260: 7274 2e74 6f5f 3264 2870 6c61 6e65 5f6f  rt.to_2d(plane_o
-00031270: 7269 6769 6e2c 2078 2c20 7929 0a20 2020  rigin, x, y).   
-00031280: 2020 2020 2070 6920 3d20 7365 6c66 2e69       pi = self.i
-00031290: 6e74 6572 696f 722e 746f 5f32 6428 706c  nterior.to_2d(pl
-000312a0: 616e 655f 6f72 6967 696e 2c20 782c 2079  ane_origin, x, y
-000312b0: 290a 2020 2020 2020 2020 7065 203d 2073  ).        pe = s
-000312c0: 656c 662e 656e 642e 746f 5f32 6428 706c  elf.end.to_2d(pl
-000312d0: 616e 655f 6f72 6967 696e 2c20 782c 2079  ane_origin, x, y
-000312e0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000312f0: 2041 7263 3244 2870 732c 2070 692c 2070   Arc2D(ps, pi, p
-00031300: 652c 206e 616d 653d 7365 6c66 2e6e 616d  e, name=self.nam
-00031310: 6529 0a0a 2020 2020 6465 6620 6d69 6e69  e)..    def mini
-00031320: 6d75 6d5f 6469 7374 616e 6365 5f70 6f69  mum_distance_poi
-00031330: 6e74 735f 6172 6328 7365 6c66 2c20 6f74  nts_arc(self, ot
-00031340: 6865 725f 6172 6329 3a0a 0a20 2020 2020  her_arc):..     
-00031350: 2020 2075 3120 3d20 7365 6c66 2e73 7461     u1 = self.sta
-00031360: 7274 202d 2073 656c 662e 6365 6e74 6572  rt - self.center
-00031370: 0a20 2020 2020 2020 2075 312e 6e6f 726d  .        u1.norm
-00031380: 616c 697a 6528 290a 2020 2020 2020 2020  alize().        
-00031390: 7532 203d 2073 656c 662e 6e6f 726d 616c  u2 = self.normal
-000313a0: 2e63 726f 7373 2875 3129 0a0a 2020 2020  .cross(u1)..    
-000313b0: 2020 2020 7720 3d20 6f74 6865 725f 6172      w = other_ar
-000313c0: 632e 6365 6e74 6572 202d 2073 656c 662e  c.center - self.
-000313d0: 6365 6e74 6572 0a0a 2020 2020 2020 2020  center..        
-000313e0: 7533 203d 206f 7468 6572 5f61 7263 2e73  u3 = other_arc.s
-000313f0: 7461 7274 202d 206f 7468 6572 5f61 7263  tart - other_arc
-00031400: 2e63 656e 7465 720a 2020 2020 2020 2020  .center.        
-00031410: 7533 2e6e 6f72 6d61 6c69 7a65 2829 0a20  u3.normalize(). 
-00031420: 2020 2020 2020 2075 3420 3d20 6f74 6865         u4 = othe
-00031430: 725f 6172 632e 6e6f 726d 616c 2e63 726f  r_arc.normal.cro
-00031440: 7373 2875 3329 0a0a 2020 2020 2020 2020  ss(u3)..        
-00031450: 7231 2c20 7232 203d 2073 656c 662e 7261  r1, r2 = self.ra
-00031460: 6469 7573 2c20 6f74 6865 725f 6172 632e  dius, other_arc.
-00031470: 7261 6469 7573 0a0a 2020 2020 2020 2020  radius..        
-00031480: 612c 2062 2c20 632c 2064 203d 2075 312e  a, b, c, d = u1.
-00031490: 646f 7428 7531 292c 2075 312e 646f 7428  dot(u1), u1.dot(
-000314a0: 7532 292c 2075 312e 646f 7428 7533 292c  u2), u1.dot(u3),
-000314b0: 2075 312e 646f 7428 7534 290a 2020 2020   u1.dot(u4).    
-000314c0: 2020 2020 652c 2066 2c20 6720 3d20 7532      e, f, g = u2
-000314d0: 2e64 6f74 2875 3229 2c20 7532 2e64 6f74  .dot(u2), u2.dot
-000314e0: 2875 3329 2c20 7532 2e64 6f74 2875 3429  (u3), u2.dot(u4)
-000314f0: 0a20 2020 2020 2020 2068 2c20 6920 3d20  .        h, i = 
-00031500: 7533 2e64 6f74 2875 3329 2c20 7533 2e64  u3.dot(u3), u3.d
-00031510: 6f74 2875 3429 0a20 2020 2020 2020 206a  ot(u4).        j
-00031520: 203d 2075 342e 646f 7428 7534 290a 2020   = u4.dot(u4).  
-00031530: 2020 2020 2020 6b2c 206c 2c20 6d2c 206e        k, l, m, n
-00031540: 2c20 6f20 3d20 772e 646f 7428 7531 292c  , o = w.dot(u1),
-00031550: 2077 2e64 6f74 2875 3229 2c20 772e 646f   w.dot(u2), w.do
-00031560: 7428 7533 292c 2077 2e64 6f74 2875 3429  t(u3), w.dot(u4)
-00031570: 2c20 772e 646f 7428 7729 0a0a 2020 2020  , w.dot(w)..    
-00031580: 2020 2020 6465 6620 6469 7374 616e 6365      def distance
-00031590: 5f73 7175 6172 6564 2878 293a 0a20 2020  _squared(x):.   
-000315a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000315b0: 2861 202a 2028 286d 6174 682e 636f 7328  (a * ((math.cos(
-000315c0: 785b 305d 2929 202a 2a20 3229 202a 2072  x[0])) ** 2) * r
-000315d0: 3120 2a2a 2032 202b 2065 202a 2028 0a20  1 ** 2 + e * (. 
-000315e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000315f0: 2020 2028 6d61 7468 2e73 696e 2878 5b30     (math.sin(x[0
-00031600: 5d29 2920 2a2a 2032 2920 2a20 7231 202a  ])) ** 2) * r1 *
-00031610: 2a20 320a 2020 2020 2020 2020 2020 2020  * 2.            
-00031620: 2020 2020 2020 2020 2b20 6f20 2b20 6820          + o + h 
-00031630: 2a20 2828 6d61 7468 2e63 6f73 2878 5b31  * ((math.cos(x[1
-00031640: 5d29 2920 2a2a 2032 2920 2a20 7232 202a  ])) ** 2) * r2 *
-00031650: 2a20 3220 2b20 6a20 2a20 280a 2020 2020  * 2 + j * (.    
-00031660: 2020 2020 2020 2020 2020 2020 286d 6174              (mat
-00031670: 682e 7369 6e28 785b 315d 2929 202a 2a20  h.sin(x[1])) ** 
-00031680: 3229 202a 2072 3220 2a2a 2032 0a20 2020  2) * r2 ** 2.   
-00031690: 2020 2020 2020 2020 2020 2020 202b 2062               + b
-000316a0: 202a 206d 6174 682e 7369 6e28 3220 2a20   * math.sin(2 * 
-000316b0: 785b 305d 2920 2a20 7231 202a 2a20 3220  x[0]) * r1 ** 2 
-000316c0: 2d20 3220 2a20 7231 202a 206d 6174 682e  - 2 * r1 * math.
-000316d0: 636f 7328 0a20 2020 2020 2020 2020 2020  cos(.           
-000316e0: 2020 2020 2020 2020 2020 2020 2078 5b30               x[0
-000316f0: 5d29 202a 206b 0a20 2020 2020 2020 2020  ]) * k.         
-00031700: 2020 2020 2020 202d 2032 202a 2072 3120         - 2 * r1 
-00031710: 2a20 7232 202a 206d 6174 682e 636f 7328  * r2 * math.cos(
-00031720: 785b 305d 2920 2a20 6d61 7468 2e63 6f73  x[0]) * math.cos
-00031730: 2878 5b31 5d29 202a 2063 0a20 2020 2020  (x[1]) * c.     
-00031740: 2020 2020 2020 2020 2020 202d 2032 202a             - 2 *
-00031750: 2072 3120 2a20 7232 202a 206d 6174 682e   r1 * r2 * math.
-00031760: 636f 7328 785b 305d 2920 2a20 6d61 7468  cos(x[0]) * math
-00031770: 2e73 696e 280a 2020 2020 2020 2020 2020  .sin(.          
-00031780: 2020 2020 2020 2020 2020 2020 2020 785b                x[
-00031790: 315d 2920 2a20 6420 2d20 3220 2a20 7231  1]) * d - 2 * r1
-000317a0: 202a 206d 6174 682e 7369 6e28 785b 305d   * math.sin(x[0]
-000317b0: 2920 2a20 6c0a 2020 2020 2020 2020 2020  ) * l.          
-000317c0: 2020 2020 2020 2d20 3220 2a20 7231 202a        - 2 * r1 *
-000317d0: 2072 3220 2a20 6d61 7468 2e73 696e 2878   r2 * math.sin(x
-000317e0: 5b30 5d29 202a 206d 6174 682e 636f 7328  [0]) * math.cos(
-000317f0: 785b 315d 2920 2a20 660a 2020 2020 2020  x[1]) * f.      
-00031800: 2020 2020 2020 2020 2020 2d20 3220 2a20            - 2 * 
-00031810: 7231 202a 2072 3220 2a20 6d61 7468 2e73  r1 * r2 * math.s
-00031820: 696e 2878 5b30 5d29 202a 206d 6174 682e  in(x[0]) * math.
-00031830: 7369 6e28 0a20 2020 2020 2020 2020 2020  sin(.           
-00031840: 2020 2020 2020 2020 2020 2020 2078 5b31               x[1
-00031850: 5d29 202a 2067 202b 2032 202a 2072 3220  ]) * g + 2 * r2 
-00031860: 2a20 6d61 7468 2e63 6f73 2878 5b31 5d29  * math.cos(x[1])
-00031870: 202a 206d 0a20 2020 2020 2020 2020 2020   * m.           
-00031880: 2020 2020 202b 2032 202a 2072 3220 2a20       + 2 * r2 * 
-00031890: 6d61 7468 2e73 696e 2878 5b31 5d29 202a  math.sin(x[1]) *
-000318a0: 206e 202b 2069 202a 206d 6174 682e 7369   n + i * math.si
-000318b0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-000318c0: 2020 2020 2020 2020 2020 2032 202a 2078             2 * x
-000318d0: 5b31 5d29 202a 2072 3220 2a2a 2032 290a  [1]) * r2 ** 2).
-000318e0: 0a20 2020 2020 2020 2078 3031 203d 206e  .        x01 = n
-000318f0: 7079 2e61 7272 6179 285b 7365 6c66 2e61  py.array([self.a
-00031900: 6e67 6c65 202f 2032 2c20 6f74 6865 725f  ngle / 2, other_
-00031910: 6172 632e 616e 676c 6520 2f20 325d 290a  arc.angle / 2]).
-00031920: 0a20 2020 2020 2020 2072 6573 3120 3d20  .        res1 = 
-00031930: 7363 702e 6f70 7469 6d69 7a65 2e6c 6561  scp.optimize.lea
-00031940: 7374 5f73 7175 6172 6573 2864 6973 7461  st_squares(dista
-00031950: 6e63 655f 7371 7561 7265 642c 2078 3031  nce_squared, x01
-00031960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00031970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031980: 2020 2020 2020 2020 2020 2020 626f 756e              boun
-00031990: 6473 3d5b 2830 2c20 3029 2c20 280a 2020  ds=[(0, 0), (.  
-000319a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000319b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000319c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000319d0: 2e61 6e67 6c65 2c20 6f74 6865 725f 6172  .angle, other_ar
-000319e0: 632e 616e 676c 6529 5d29 0a0a 2020 2020  c.angle)])..    
-000319f0: 2020 2020 7031 203d 2073 656c 662e 706f      p1 = self.po
-00031a00: 696e 745f 6174 5f61 6273 6369 7373 6128  int_at_abscissa(
-00031a10: 7265 7331 2e78 5b30 5d20 2a20 7231 290a  res1.x[0] * r1).
-00031a20: 2020 2020 2020 2020 7032 203d 206f 7468          p2 = oth
-00031a30: 6572 5f61 7263 2e70 6f69 6e74 5f61 745f  er_arc.point_at_
-00031a40: 6162 7363 6973 7361 2872 6573 312e 785b  abscissa(res1.x[
-00031a50: 315d 202a 2072 3229 0a0a 2020 2020 2020  1] * r2)..      
-00031a60: 2020 7265 7475 726e 2070 312c 2070 320a    return p1, p2.
-00031a70: 0a20 2020 2064 6566 206d 696e 696d 756d  .    def minimum
-00031a80: 5f64 6973 7461 6e63 655f 706f 696e 7473  _distance_points
-00031a90: 5f6c 696e 6528 7365 6c66 2c20 6f74 6865  _line(self, othe
-00031aa0: 725f 6c69 6e65 293a 0a0a 2020 2020 2020  r_line):..      
-00031ab0: 2020 7520 3d20 6f74 6865 725f 6c69 6e65    u = other_line
-00031ac0: 2e64 6972 6563 7469 6f6e 5f76 6563 746f  .direction_vecto
-00031ad0: 7228 290a 2020 2020 2020 2020 6b20 3d20  r().        k = 
-00031ae0: 7365 6c66 2e73 7461 7274 202d 2073 656c  self.start - sel
-00031af0: 662e 6365 6e74 6572 0a20 2020 2020 2020  f.center.       
-00031b00: 206b 2e6e 6f72 6d61 6c69 7a65 2829 0a20   k.normalize(). 
-00031b10: 2020 2020 2020 2077 203d 2073 656c 662e         w = self.
-00031b20: 6365 6e74 6572 202d 206f 7468 6572 5f6c  center - other_l
-00031b30: 696e 652e 7374 6172 740a 2020 2020 2020  ine.start.      
-00031b40: 2020 7620 3d20 7365 6c66 2e6e 6f72 6d61    v = self.norma
-00031b50: 6c2e 6372 6f73 7328 6b29 0a0a 2020 2020  l.cross(k)..    
-00031b60: 2020 2020 7220 3d20 7365 6c66 2e72 6164      r = self.rad
-00031b70: 6975 730a 0a20 2020 2020 2020 2061 203d  ius..        a =
-00031b80: 2075 2e64 6f74 2875 290a 2020 2020 2020   u.dot(u).      
-00031b90: 2020 6220 3d20 752e 646f 7428 7629 0a20    b = u.dot(v). 
-00031ba0: 2020 2020 2020 2063 203d 2075 2e64 6f74         c = u.dot
-00031bb0: 286b 290a 2020 2020 2020 2020 6420 3d20  (k).        d = 
-00031bc0: 762e 646f 7428 7629 0a20 2020 2020 2020  v.dot(v).       
-00031bd0: 2065 203d 2076 2e64 6f74 286b 290a 2020   e = v.dot(k).  
-00031be0: 2020 2020 2020 6620 3d20 6b2e 646f 7428        f = k.dot(
-00031bf0: 6b29 0a20 2020 2020 2020 2067 203d 2077  k).        g = w
-00031c00: 2e64 6f74 2875 290a 2020 2020 2020 2020  .dot(u).        
-00031c10: 6820 3d20 772e 646f 7428 7629 0a20 2020  h = w.dot(v).   
-00031c20: 2020 2020 2069 203d 2077 2e64 6f74 286b       i = w.dot(k
-00031c30: 290a 2020 2020 2020 2020 6a20 3d20 772e  ).        j = w.
-00031c40: 646f 7428 7729 0a0a 2020 2020 2020 2020  dot(w)..        
-00031c50: 2320 7820 3d20 2873 2c20 7468 6574 6129  # x = (s, theta)
-00031c60: 0a20 2020 2020 2020 2064 6566 2064 6973  .        def dis
-00031c70: 7461 6e63 655f 7371 7561 7265 6428 7829  tance_squared(x)
-00031c80: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00031c90: 7475 726e 2028 6120 2a20 785b 305d 202a  turn (a * x[0] *
-00031ca0: 2a20 3220 2b20 6a20 2b20 6420 2a20 280a  * 2 + j + d * (.
-00031cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031cc0: 2020 2020 286d 6174 682e 7369 6e28 785b      (math.sin(x[
-00031cd0: 315d 2929 202a 2a20 3229 202a 2072 202a  1])) ** 2) * r *
-00031ce0: 2a20 3220 2b20 6620 2a20 280a 2020 2020  * 2 + f * (.    
-00031cf0: 2020 2020 2020 2020 2020 2020 286d 6174              (mat
-00031d00: 682e 636f 7328 785b 315d 2929 202a 2a20  h.cos(x[1])) ** 
-00031d10: 3229 202a 2072 202a 2a20 320a 2020 2020  2) * r ** 2.    
-00031d20: 2020 2020 2020 2020 2020 2020 2d20 3220              - 2 
-00031d30: 2a20 785b 305d 202a 2067 202d 2032 202a  * x[0] * g - 2 *
-00031d40: 2078 5b30 5d20 2a20 7220 2a20 6d61 7468   x[0] * r * math
-00031d50: 2e73 696e 2878 5b31 5d29 202a 2062 202d  .sin(x[1]) * b -
-00031d60: 2032 202a 2078 5b0a 2020 2020 2020 2020   2 * x[.        
-00031d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031d80: 305d 202a 2072 202a 206d 6174 682e 636f  0] * r * math.co
-00031d90: 7328 785b 315d 2920 2a20 630a 2020 2020  s(x[1]) * c.    
-00031da0: 2020 2020 2020 2020 2020 2020 2b20 3220              + 2 
-00031db0: 2a20 7220 2a20 6d61 7468 2e73 696e 2878  * r * math.sin(x
-00031dc0: 5b31 5d29 202a 2068 202b 2032 202a 2072  [1]) * h + 2 * r
-00031dd0: 202a 206d 6174 682e 636f 7328 785b 315d   * math.cos(x[1]
-00031de0: 2920 2a20 690a 2020 2020 2020 2020 2020  ) * i.          
-00031df0: 2020 2020 2020 2b20 6d61 7468 2e73 696e        + math.sin
-00031e00: 2832 202a 2078 5b31 5d29 202a 2065 202a  (2 * x[1]) * e *
-00031e10: 2072 202a 2a20 3229 0a0a 2020 2020 2020   r ** 2)..      
-00031e20: 2020 7830 3120 3d20 6e70 792e 6172 7261    x01 = npy.arra
-00031e30: 7928 5b30 2e35 2c20 7365 6c66 2e61 6e67  y([0.5, self.ang
-00031e40: 6c65 202f 2032 5d29 0a20 2020 2020 2020  le / 2]).       
-00031e50: 2078 3032 203d 206e 7079 2e61 7272 6179   x02 = npy.array
-00031e60: 285b 302e 352c 2030 5d29 0a20 2020 2020  ([0.5, 0]).     
-00031e70: 2020 2078 3033 203d 206e 7079 2e61 7272     x03 = npy.arr
-00031e80: 6179 285b 302e 352c 2073 656c 662e 616e  ay([0.5, self.an
-00031e90: 676c 655d 290a 0a20 2020 2020 2020 2072  gle])..        r
-00031ea0: 6573 3120 3d20 7363 702e 6f70 7469 6d69  es1 = scp.optimi
-00031eb0: 7a65 2e6c 6561 7374 5f73 7175 6172 6573  ze.least_squares
-00031ec0: 2864 6973 7461 6e63 655f 7371 7561 7265  (distance_square
-00031ed0: 642c 2078 3031 2c0a 2020 2020 2020 2020  d, x01,.        
-00031ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031f00: 2020 626f 756e 6473 3d5b 2830 2c20 3029    bounds=[(0, 0)
-00031f10: 2c20 2831 2c20 7365 6c66 2e61 6e67 6c65  , (1, self.angle
-00031f20: 295d 290a 2020 2020 2020 2020 7265 7332  )]).        res2
-00031f30: 203d 2073 6370 2e6f 7074 696d 697a 652e   = scp.optimize.
-00031f40: 6c65 6173 745f 7371 7561 7265 7328 6469  least_squares(di
-00031f50: 7374 616e 6365 5f73 7175 6172 6564 2c20  stance_squared, 
-00031f60: 7830 322c 0a20 2020 2020 2020 2020 2020  x02,.           
-00031f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031f80: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00031f90: 6f75 6e64 733d 5b28 302c 2030 292c 2028  ounds=[(0, 0), (
-00031fa0: 312c 2073 656c 662e 616e 676c 6529 5d29  1, self.angle)])
-00031fb0: 0a20 2020 2020 2020 2072 6573 3320 3d20  .        res3 = 
-00031fc0: 7363 702e 6f70 7469 6d69 7a65 2e6c 6561  scp.optimize.lea
-00031fd0: 7374 5f73 7175 6172 6573 2864 6973 7461  st_squares(dista
-00031fe0: 6e63 655f 7371 7561 7265 642c 2078 3033  nce_squared, x03
-00031ff0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00032000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032010: 2020 2020 2020 2020 2020 2020 626f 756e              boun
-00032020: 6473 3d5b 2830 2c20 3029 2c20 2831 2c20  ds=[(0, 0), (1, 
-00032030: 7365 6c66 2e61 6e67 6c65 295d 290a 0a20  self.angle)]).. 
-00032040: 2020 2020 2020 2070 3120 3d20 6f74 6865         p1 = othe
-00032050: 725f 6c69 6e65 2e70 6f69 6e74 5f61 745f  r_line.point_at_
-00032060: 6162 7363 6973 7361 280a 2020 2020 2020  abscissa(.      
-00032070: 2020 2020 2020 7265 7331 2e78 5b30 5d20        res1.x[0] 
-00032080: 2a20 6f74 6865 725f 6c69 6e65 2e6c 656e  * other_line.len
-00032090: 6774 6828 2929 0a20 2020 2020 2020 2070  gth()).        p
-000320a0: 3220 3d20 7365 6c66 2e70 6f69 6e74 5f61  2 = self.point_a
-000320b0: 745f 6162 7363 6973 7361 2872 6573 312e  t_abscissa(res1.
-000320c0: 785b 315d 202a 2072 290a 0a20 2020 2020  x[1] * r)..     
-000320d0: 2020 2072 6573 203d 205b 7265 7332 2c20     res = [res2, 
-000320e0: 7265 7333 5d0a 2020 2020 2020 2020 666f  res3].        fo
-000320f0: 7220 636f 7570 6c65 2069 6e20 7265 733a  r couple in res:
-00032100: 0a20 2020 2020 2020 2020 2020 2070 7465  .            pte
-00032110: 7374 3120 3d20 6f74 6865 725f 6c69 6e65  st1 = other_line
-00032120: 2e70 6f69 6e74 5f61 745f 6162 7363 6973  .point_at_abscis
-00032130: 7361 280a 2020 2020 2020 2020 2020 2020  sa(.            
-00032140: 2020 2020 636f 7570 6c65 2e78 5b30 5d20      couple.x[0] 
-00032150: 2a20 6f74 6865 725f 6c69 6e65 2e6c 656e  * other_line.len
-00032160: 6774 6828 2929 0a20 2020 2020 2020 2020  gth()).         
-00032170: 2020 2070 7465 7374 3220 3d20 7365 6c66     ptest2 = self
-00032180: 2e70 6f69 6e74 5f61 745f 6162 7363 6973  .point_at_abscis
-00032190: 7361 2863 6f75 706c 652e 785b 315d 202a  sa(couple.x[1] *
-000321a0: 2072 290a 2020 2020 2020 2020 2020 2020   r).            
-000321b0: 6474 6573 7420 3d20 7074 6573 7431 2e70  dtest = ptest1.p
-000321c0: 6f69 6e74 5f64 6973 7461 6e63 6528 7074  oint_distance(pt
-000321d0: 6573 7432 290a 2020 2020 2020 2020 2020  est2).          
-000321e0: 2020 6966 2064 7465 7374 203c 2064 3a0a    if dtest < d:.
-000321f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032200: 7031 2c20 7032 203d 2070 7465 7374 312c  p1, p2 = ptest1,
-00032210: 2070 7465 7374 320a 0a20 2020 2020 2020   ptest2..       
-00032220: 2072 6574 7572 6e20 7031 2c20 7032 0a0a   return p1, p2..
-00032230: 2020 2020 6465 6620 6d69 6e69 6d75 6d5f      def minimum_
-00032240: 6469 7374 616e 6365 2873 656c 662c 2065  distance(self, e
-00032250: 6c65 6d65 6e74 2c20 7265 7475 726e 5f70  lement, return_p
-00032260: 6f69 6e74 733d 4661 6c73 6529 3a0a 2020  oints=False):.  
-00032270: 2020 2020 2020 6966 2065 6c65 6d65 6e74        if element
-00032280: 2e5f 5f63 6c61 7373 5f5f 2069 7320 4172  .__class__ is Ar
-00032290: 6333 4420 6f72 2065 6c65 6d65 6e74 2e5f  c3D or element._
-000322a0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
-000322b0: 5f20 3d3d 2027 4369 7263 6c65 3344 273a  _ == 'Circle3D':
-000322c0: 0a20 2020 2020 2020 2020 2020 2070 312c  .            p1,
-000322d0: 2070 3220 3d20 7365 6c66 2e6d 696e 696d   p2 = self.minim
-000322e0: 756d 5f64 6973 7461 6e63 655f 706f 696e  um_distance_poin
-000322f0: 7473 5f61 7263 2865 6c65 6d65 6e74 290a  ts_arc(element).
-00032300: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-00032310: 6574 7572 6e5f 706f 696e 7473 3a0a 2020  eturn_points:.  
-00032320: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00032330: 7475 726e 2070 312e 706f 696e 745f 6469  turn p1.point_di
-00032340: 7374 616e 6365 2870 3229 2c20 7031 2c20  stance(p2), p1, 
-00032350: 7032 0a20 2020 2020 2020 2020 2020 2072  p2.            r
-00032360: 6574 7572 6e20 7031 2e70 6f69 6e74 5f64  eturn p1.point_d
-00032370: 6973 7461 6e63 6528 7032 290a 0a20 2020  istance(p2)..   
-00032380: 2020 2020 2069 6620 656c 656d 656e 742e       if element.
-00032390: 5f5f 636c 6173 735f 5f20 6973 204c 696e  __class__ is Lin
-000323a0: 6553 6567 6d65 6e74 3344 3a0a 2020 2020  eSegment3D:.    
-000323b0: 2020 2020 2020 2020 7074 312c 2070 7432          pt1, pt2
-000323c0: 203d 2073 656c 662e 6d69 6e69 6d75 6d5f   = self.minimum_
-000323d0: 6469 7374 616e 6365 5f70 6f69 6e74 735f  distance_points_
-000323e0: 6c69 6e65 2865 6c65 6d65 6e74 290a 2020  line(element).  
-000323f0: 2020 2020 2020 2020 2020 6966 2072 6574            if ret
-00032400: 7572 6e5f 706f 696e 7473 3a0a 2020 2020  urn_points:.    
-00032410: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00032420: 726e 2070 7431 2e70 6f69 6e74 5f64 6973  rn pt1.point_dis
-00032430: 7461 6e63 6528 7074 3229 2c20 7074 312c  tance(pt2), pt1,
-00032440: 2070 7432 0a20 2020 2020 2020 2020 2020   pt2.           
-00032450: 2072 6574 7572 6e20 7074 312e 706f 696e   return pt1.poin
-00032460: 745f 6469 7374 616e 6365 2870 7432 290a  t_distance(pt2).
-00032470: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00032480: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00032490: 726f 720a 0a20 2020 2064 6566 2065 7874  ror..    def ext
-000324a0: 7275 7369 6f6e 2873 656c 662c 2065 7874  rusion(self, ext
-000324b0: 7275 7369 6f6e 5f76 6563 746f 7229 3a0a  rusion_vector):.
-000324c0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000324d0: 6e6f 726d 616c 2e69 735f 636f 6c69 6e65  normal.is_coline
-000324e0: 6172 5f74 6f28 6578 7472 7573 696f 6e5f  ar_to(extrusion_
-000324f0: 7665 6374 6f72 293a 0a20 2020 2020 2020  vector):.       
-00032500: 2020 2020 2075 203d 2073 656c 662e 7374       u = self.st
-00032510: 6172 7420 2d20 7365 6c66 2e63 656e 7465  art - self.cente
-00032520: 720a 2020 2020 2020 2020 2020 2020 752e  r.            u.
-00032530: 6e6f 726d 616c 697a 6528 290a 2020 2020  normalize().    
-00032540: 2020 2020 2020 2020 7720 3d20 6578 7472          w = extr
-00032550: 7573 696f 6e5f 7665 6374 6f72 2e63 6f70  usion_vector.cop
-00032560: 7928 290a 2020 2020 2020 2020 2020 2020  y().            
-00032570: 772e 6e6f 726d 616c 697a 6528 290a 2020  w.normalize().  
-00032580: 2020 2020 2020 2020 2020 7620 3d20 772e            v = w.
-00032590: 6372 6f73 7328 7529 0a20 2020 2020 2020  cross(u).       
-000325a0: 2020 2020 2061 7263 3264 203d 2073 656c       arc2d = sel
-000325b0: 662e 746f 5f32 6428 7365 6c66 2e63 656e  f.to_2d(self.cen
-000325c0: 7465 722c 2075 2c20 7629 0a20 2020 2020  ter, u, v).     
-000325d0: 2020 2020 2020 2061 6e67 6c65 312c 2061         angle1, a
-000325e0: 6e67 6c65 3220 3d20 6172 6332 642e 616e  ngle2 = arc2d.an
-000325f0: 676c 6531 2c20 6172 6332 642e 616e 676c  gle1, arc2d.angl
-00032600: 6532 0a20 2020 2020 2020 2020 2020 2069  e2.            i
-00032610: 6620 616e 676c 6532 203c 2061 6e67 6c65  f angle2 < angle
-00032620: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-00032630: 2020 2061 6e67 6c65 3220 2b3d 2076 6f6c     angle2 += vol
-00032640: 6d64 6c72 2e54 574f 5f50 490a 2020 2020  mdlr.TWO_PI.    
-00032650: 2020 2020 2020 2020 6379 6c69 6e64 6572          cylinder
-00032660: 203d 2076 6f6c 6d64 6c72 2e66 6163 6573   = volmdlr.faces
-00032670: 2e43 796c 696e 6472 6963 616c 5375 7266  .CylindricalSurf
-00032680: 6163 6533 4428 0a20 2020 2020 2020 2020  ace3D(.         
-00032690: 2020 2020 2020 2076 6f6c 6d64 6c72 2e46         volmdlr.F
-000326a0: 7261 6d65 3344 2873 656c 662e 6365 6e74  rame3D(self.cent
-000326b0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-000326c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000326d0: 2020 2020 752c 0a20 2020 2020 2020 2020      u,.         
-000326e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000326f0: 2020 2020 2020 2076 2c0a 2020 2020 2020         v,.      
-00032700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032710: 2020 2020 2020 2020 2020 7729 2c0a 2020            w),.  
-00032720: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00032730: 6c66 2e72 6164 6975 730a 2020 2020 2020  lf.radius.      
-00032740: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00032750: 2020 2020 7265 7475 726e 205b 6379 6c69      return [cyli
-00032760: 6e64 6572 2e72 6563 7461 6e67 756c 6172  nder.rectangular
-00032770: 5f63 7574 2861 6e67 6c65 312c 2061 6e67  _cut(angle1, ang
-00032780: 6c65 322c 2030 2e2c 2065 7874 7275 7369  le2, 0., extrusi
-00032790: 6f6e 5f76 6563 746f 722e 6e6f 726d 2829  on_vector.norm()
-000327a0: 295d 0a20 2020 2020 2020 2072 6169 7365  )].        raise
-000327b0: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-000327c0: 7272 6f72 2866 2745 6c6c 6970 7469 6320  rror(f'Elliptic 
-000327d0: 6661 6365 7320 6e6f 7420 6861 6e64 6c65  faces not handle
-000327e0: 643a 2064 6f74 3d7b 7365 6c66 2e6e 6f72  d: dot={self.nor
-000327f0: 6d61 6c2e 646f 7428 6578 7472 7573 696f  mal.dot(extrusio
-00032800: 6e5f 7665 6374 6f72 297d 2729 0a0a 2020  n_vector)}')..  
-00032810: 2020 6465 6620 7265 766f 6c75 7469 6f6e    def revolution
-00032820: 2873 656c 662c 2061 7869 735f 706f 696e  (self, axis_poin
-00032830: 743a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  t: volmdlr.Point
-00032840: 3344 2c20 6178 6973 3a20 766f 6c6d 646c  3D, axis: volmdl
-00032850: 722e 5665 6374 6f72 3344 2c0a 2020 2020  r.Vector3D,.    
-00032860: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00032870: 6e67 6c65 3a20 666c 6f61 7429 3a0a 2020  ngle: float):.  
-00032880: 2020 2020 2020 6c69 6e65 3364 203d 204c        line3d = L
-00032890: 696e 6533 4428 6178 6973 5f70 6f69 6e74  ine3D(axis_point
-000328a0: 2c20 6178 6973 5f70 6f69 6e74 202b 2061  , axis_point + a
-000328b0: 7869 7329 0a20 2020 2020 2020 2074 6f72  xis).        tor
-000328c0: 655f 6365 6e74 6572 2c20 5f20 3d20 6c69  e_center, _ = li
-000328d0: 6e65 3364 2e70 6f69 6e74 5f70 726f 6a65  ne3d.point_proje
-000328e0: 6374 696f 6e28 7365 6c66 2e63 656e 7465  ction(self.cente
-000328f0: 7229 0a0a 2020 2020 2020 2020 2320 5370  r)..        # Sp
-00032900: 6865 7265 0a20 2020 2020 2020 2069 6620  here.        if 
-00032910: 6d61 7468 2e69 7363 6c6f 7365 2874 6f72  math.isclose(tor
-00032920: 655f 6365 6e74 6572 2e70 6f69 6e74 5f64  e_center.point_d
-00032930: 6973 7461 6e63 6528 7365 6c66 2e63 656e  istance(self.cen
-00032940: 7465 7229 2c20 302e 2c0a 2020 2020 2020  ter), 0.,.      
-00032950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032960: 2020 6162 735f 746f 6c3d 3165 2d36 293a    abs_tol=1e-6):
-00032970: 0a0a 2020 2020 2020 2020 2020 2020 7374  ..            st
-00032980: 6172 745f 702c 205f 203d 206c 696e 6533  art_p, _ = line3
-00032990: 642e 706f 696e 745f 7072 6f6a 6563 7469  d.point_projecti
-000329a0: 6f6e 2873 656c 662e 7374 6172 7429 0a20  on(self.start). 
-000329b0: 2020 2020 2020 2020 2020 2075 203d 2073             u = s
-000329c0: 656c 662e 7374 6172 7420 2d20 7374 6172  elf.start - star
-000329d0: 745f 700a 0a20 2020 2020 2020 2020 2020  t_p..           
-000329e0: 2069 6620 6d61 7468 2e69 7363 6c6f 7365   if math.isclose
-000329f0: 2875 2e6e 6f72 6d28 292c 2030 2c20 6162  (u.norm(), 0, ab
-00032a00: 735f 746f 6c3d 3165 2d36 293a 0a20 2020  s_tol=1e-6):.   
-00032a10: 2020 2020 2020 2020 2020 2020 2065 6e64               end
-00032a20: 5f70 2c20 5f20 3d20 6c69 6e65 3364 2e70  _p, _ = line3d.p
-00032a30: 6f69 6e74 5f70 726f 6a65 6374 696f 6e28  oint_projection(
-00032a40: 7365 6c66 2e65 6e64 290a 2020 2020 2020  self.end).      
-00032a50: 2020 2020 2020 2020 2020 7520 3d20 7365            u = se
-00032a60: 6c66 2e65 6e64 202d 2065 6e64 5f70 0a20  lf.end - end_p. 
-00032a70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00032a80: 6620 6d61 7468 2e69 7363 6c6f 7365 2875  f math.isclose(u
-00032a90: 2e6e 6f72 6d28 292c 2030 2c20 6162 735f  .norm(), 0, abs_
-00032aa0: 746f 6c3d 3165 2d36 293a 0a20 2020 2020  tol=1e-6):.     
-00032ab0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00032ac0: 6e74 6572 696f 725f 702c 205f 203d 206c  nterior_p, _ = l
-00032ad0: 696e 6533 642e 706f 696e 745f 7072 6f6a  ine3d.point_proj
-00032ae0: 6563 7469 6f6e 2873 656c 662e 696e 7465  ection(self.inte
-00032af0: 7269 6f72 290a 2020 2020 2020 2020 2020  rior).          
-00032b00: 2020 2020 2020 2020 2020 7520 3d20 7365            u = se
-00032b10: 6c66 2e69 6e74 6572 696f 7220 2d20 696e  lf.interior - in
-00032b20: 7465 7269 6f72 5f70 0a0a 2020 2020 2020  terior_p..      
-00032b30: 2020 2020 2020 752e 6e6f 726d 616c 697a        u.normaliz
-00032b40: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-00032b50: 7620 3d20 6178 6973 2e63 726f 7373 2875  v = axis.cross(u
-00032b60: 290a 2020 2020 2020 2020 2020 2020 6172  ).            ar
-00032b70: 6332 6420 3d20 7365 6c66 2e74 6f5f 3264  c2d = self.to_2d
-00032b80: 2873 656c 662e 6365 6e74 6572 2c20 752c  (self.center, u,
-00032b90: 2061 7869 7329 0a0a 2020 2020 2020 2020   axis)..        
-00032ba0: 2020 2020 7375 7266 6163 6520 3d20 766f      surface = vo
-00032bb0: 6c6d 646c 722e 6661 6365 732e 5370 6865  lmdlr.faces.Sphe
-00032bc0: 7269 6361 6c53 7572 6661 6365 3344 280a  ricalSurface3D(.
-00032bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032be0: 766f 6c6d 646c 722e 4672 616d 6533 4428  volmdlr.Frame3D(
-00032bf0: 7365 6c66 2e63 656e 7465 722c 2075 2c20  self.center, u, 
-00032c00: 762c 2061 7869 7329 2c20 7365 6c66 2e72  v, axis), self.r
-00032c10: 6164 6975 7329 0a0a 2020 2020 2020 2020  adius)..        
-00032c20: 2020 2020 7265 7475 726e 205b 7375 7266      return [surf
-00032c30: 6163 652e 7265 6374 616e 6775 6c61 725f  ace.rectangular_
-00032c40: 6375 7428 302c 2061 6e67 6c65 2c0a 2020  cut(0, angle,.  
-00032c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c70: 2020 2020 2020 2020 2020 6172 6332 642e            arc2d.
-00032c80: 616e 676c 6531 2c20 6172 6332 642e 616e  angle1, arc2d.an
-00032c90: 676c 6532 295d 0a0a 2020 2020 2020 2020  gle2)]..        
-00032ca0: 2320 546f 726f 6964 616c 0a20 2020 2020  # Toroidal.     
-00032cb0: 2020 2075 203d 2073 656c 662e 6365 6e74     u = self.cent
-00032cc0: 6572 202d 2074 6f72 655f 6365 6e74 6572  er - tore_center
-00032cd0: 0a20 2020 2020 2020 2075 2e6e 6f72 6d61  .        u.norma
-00032ce0: 6c69 7a65 2829 0a20 2020 2020 2020 2076  lize().        v
-00032cf0: 203d 2061 7869 732e 6372 6f73 7328 7529   = axis.cross(u)
-00032d00: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00032d10: 6d61 7468 2e69 7363 6c6f 7365 2873 656c  math.isclose(sel
-00032d20: 662e 6e6f 726d 616c 2e64 6f74 2875 292c  f.normal.dot(u),
-00032d30: 2030 2e2c 2061 6273 5f74 6f6c 3d31 652d   0., abs_tol=1e-
-00032d40: 3629 3a0a 2020 2020 2020 2020 2020 2020  6):.            
-00032d50: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00032d60: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
-00032d70: 2020 2020 2020 2020 2020 2027 4f75 7473             'Outs
-00032d80: 6964 6520 6f66 2070 6c61 6e65 2072 6576  ide of plane rev
-00032d90: 6f6c 7574 696f 6e20 6e6f 7420 7375 7070  olution not supp
-00032da0: 6f72 7465 6427 290a 0a20 2020 2020 2020  orted')..       
-00032db0: 2052 203d 2074 6f72 655f 6365 6e74 6572   R = tore_center
-00032dc0: 2e70 6f69 6e74 5f64 6973 7461 6e63 6528  .point_distance(
-00032dd0: 7365 6c66 2e63 656e 7465 7229 0a20 2020  self.center).   
-00032de0: 2020 2020 2073 7572 6661 6365 203d 2076       surface = v
-00032df0: 6f6c 6d64 6c72 2e66 6163 6573 2e54 6f72  olmdlr.faces.Tor
-00032e00: 6f69 6461 6c53 7572 6661 6365 3344 280a  oidalSurface3D(.
-00032e10: 2020 2020 2020 2020 2020 2020 766f 6c6d              volm
-00032e20: 646c 722e 4672 616d 6533 4428 746f 7265  dlr.Frame3D(tore
-00032e30: 5f63 656e 7465 722c 2075 2c20 762c 2061  _center, u, v, a
-00032e40: 7869 7329 2c20 522c 0a20 2020 2020 2020  xis), R,.       
-00032e50: 2020 2020 2073 656c 662e 7261 6469 7573       self.radius
-00032e60: 290a 2020 2020 2020 2020 6172 6332 6420  ).        arc2d 
-00032e70: 3d20 7365 6c66 2e74 6f5f 3264 2874 6f72  = self.to_2d(tor
-00032e80: 655f 6365 6e74 6572 2c20 752c 2061 7869  e_center, u, axi
-00032e90: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
-00032ea0: 6e20 5b73 7572 6661 6365 2e72 6563 7461  n [surface.recta
-00032eb0: 6e67 756c 6172 5f63 7574 2830 2c20 616e  ngular_cut(0, an
-00032ec0: 676c 652c 0a20 2020 2020 2020 2020 2020  gle,.           
-00032ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032ee0: 2020 2020 2020 2020 2020 2020 2061 7263               arc
-00032ef0: 3264 2e61 6e67 6c65 312c 2061 7263 3264  2d.angle1, arc2d
-00032f00: 2e61 6e67 6c65 3229 5d0a 0a20 2020 2064  .angle2)]..    d
-00032f10: 6566 2074 6f5f 7374 6570 2873 656c 662c  ef to_step(self,
-00032f20: 2063 7572 7265 6e74 5f69 642c 2073 7572   current_id, sur
-00032f30: 6661 6365 5f69 643d 4e6f 6e65 293a 0a20  face_id=None):. 
-00032f40: 2020 2020 2020 2069 6620 7365 6c66 2e61         if self.a
-00032f50: 6e67 6c65 203e 3d20 6d61 7468 2e70 693a  ngle >= math.pi:
-00032f60: 0a20 2020 2020 2020 2020 2020 206c 203d  .            l =
-00032f70: 2073 656c 662e 6c65 6e67 7468 2829 0a20   self.length(). 
-00032f80: 2020 2020 2020 2020 2020 2061 7263 312c             arc1,
-00032f90: 2061 7263 3220 3d20 7365 6c66 2e73 706c   arc2 = self.spl
-00032fa0: 6974 2873 656c 662e 706f 696e 745f 6174  it(self.point_at
-00032fb0: 5f61 6273 6369 7373 6128 302e 3333 202a  _abscissa(0.33 *
-00032fc0: 206c 2929 0a20 2020 2020 2020 2020 2020   l)).           
-00032fd0: 2061 7263 322c 2061 7263 3320 3d20 6172   arc2, arc3 = ar
-00032fe0: 6332 2e73 706c 6974 2873 656c 662e 706f  c2.split(self.po
-00032ff0: 696e 745f 6174 5f61 6273 6369 7373 6128  int_at_abscissa(
-00033000: 302e 3636 202a 206c 2929 0a20 2020 2020  0.66 * l)).     
-00033010: 2020 2020 2020 2063 6f6e 7465 6e74 2c20         content, 
-00033020: 6172 6373 315f 6964 203d 2061 7263 312e  arcs1_id = arc1.
-00033030: 746f 5f73 7465 705f 7769 7468 6f75 745f  to_step_without_
-00033040: 7370 6c69 7474 696e 6728 6375 7272 656e  splitting(curren
-00033050: 745f 6964 290a 2020 2020 2020 2020 2020  t_id).          
-00033060: 2020 6172 6332 5f63 6f6e 7465 6e74 2c20    arc2_content, 
-00033070: 6172 6373 325f 6964 203d 2061 7263 322e  arcs2_id = arc2.
-00033080: 746f 5f73 7465 705f 7769 7468 6f75 745f  to_step_without_
-00033090: 7370 6c69 7474 696e 6728 0a20 2020 2020  splitting(.     
-000330a0: 2020 2020 2020 2020 2020 2061 7263 7331             arcs1
-000330b0: 5f69 645b 305d 202b 2031 290a 2020 2020  _id[0] + 1).    
-000330c0: 2020 2020 2020 2020 6172 6333 5f63 6f6e          arc3_con
-000330d0: 7465 6e74 2c20 6172 6373 335f 6964 203d  tent, arcs3_id =
-000330e0: 2061 7263 332e 746f 5f73 7465 705f 7769   arc3.to_step_wi
-000330f0: 7468 6f75 745f 7370 6c69 7474 696e 6728  thout_splitting(
-00033100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033110: 2061 7263 7332 5f69 645b 305d 202b 2031   arcs2_id[0] + 1
-00033120: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-00033130: 6e74 656e 7420 2b3d 2061 7263 325f 636f  ntent += arc2_co
-00033140: 6e74 656e 7420 2b20 6172 6333 5f63 6f6e  ntent + arc3_con
-00033150: 7465 6e74 0a20 2020 2020 2020 2020 2020  tent.           
-00033160: 2072 6574 7572 6e20 636f 6e74 656e 742c   return content,
-00033170: 205b 6172 6373 315f 6964 5b30 5d2c 2061   [arcs1_id[0], a
-00033180: 7263 7332 5f69 645b 305d 2c20 6172 6373  rcs2_id[0], arcs
-00033190: 335f 6964 5b30 5d5d 0a20 2020 2020 2020  3_id[0]].       
-000331a0: 2072 6574 7572 6e20 7365 6c66 2e74 6f5f   return self.to_
-000331b0: 7374 6570 5f77 6974 686f 7574 5f73 706c  step_without_spl
-000331c0: 6974 7469 6e67 2863 7572 7265 6e74 5f69  itting(current_i
-000331d0: 6429 0a0a 2020 2020 6465 6620 746f 5f73  d)..    def to_s
-000331e0: 7465 705f 7769 7468 6f75 745f 7370 6c69  tep_without_spli
-000331f0: 7474 696e 6728 7365 6c66 2c20 6375 7272  tting(self, curr
-00033200: 656e 745f 6964 2c20 7375 7266 6163 655f  ent_id, surface_
-00033210: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
-00033220: 2020 7520 3d20 7365 6c66 2e73 7461 7274    u = self.start
-00033230: 202d 2073 656c 662e 6365 6e74 6572 0a20   - self.center. 
-00033240: 2020 2020 2020 2075 2e6e 6f72 6d61 6c69         u.normali
-00033250: 7a65 2829 0a20 2020 2020 2020 2076 203d  ze().        v =
-00033260: 2073 656c 662e 6e6f 726d 616c 2e63 726f   self.normal.cro
-00033270: 7373 2875 290a 2020 2020 2020 2020 6672  ss(u).        fr
-00033280: 616d 6520 3d20 766f 6c6d 646c 722e 4672  ame = volmdlr.Fr
-00033290: 616d 6533 4428 7365 6c66 2e63 656e 7465  ame3D(self.cente
-000332a0: 722c 2073 656c 662e 6e6f 726d 616c 2c20  r, self.normal, 
-000332b0: 752c 2076 290a 0a20 2020 2020 2020 2063  u, v)..        c
-000332c0: 6f6e 7465 6e74 2c20 6672 616d 655f 6964  ontent, frame_id
-000332d0: 203d 2066 7261 6d65 2e74 6f5f 7374 6570   = frame.to_step
-000332e0: 2863 7572 7265 6e74 5f69 6429 0a20 2020  (current_id).   
-000332f0: 2020 2020 2063 7572 7665 5f69 6420 3d20       curve_id = 
-00033300: 6672 616d 655f 6964 202b 2031 0a20 2020  frame_id + 1.   
-00033310: 2020 2020 2063 6f6e 7465 6e74 202b 3d20       content += 
-00033320: 2223 7b7d 203d 2043 4952 434c 4528 277b  "#{} = CIRCLE('{
-00033330: 7d27 2c20 237b 7d2c 207b 3a2e 3666 7d29  }', #{}, {:.6f})
-00033340: 3b5c 6e22 2e66 6f72 6d61 7428 6375 7276  ;\n".format(curv
-00033350: 655f 6964 2c0a 2020 2020 2020 2020 2020  e_id,.          
-00033360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033390: 2020 2020 2073 656c 662e 6e61 6d65 2c0a       self.name,.
-000333a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000333b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000333c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000333d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000333e0: 7261 6d65 5f69 642c 0a20 2020 2020 2020  rame_id,.       
-000333f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033420: 2020 2020 2020 2020 7365 6c66 2e72 6164          self.rad
-00033430: 6975 7320 2a20 3130 3030 2c0a 2020 2020  ius * 1000,.    
-00033440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033470: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00033480: 2020 2020 2020 6966 2073 7572 6661 6365        if surface
-00033490: 5f69 643a 0a20 2020 2020 2020 2020 2020  _id:.           
-000334a0: 2063 6f6e 7465 6e74 202b 3d20 2223 7b7d   content += "#{}
-000334b0: 203d 2053 5552 4641 4345 5f43 5552 5645   = SURFACE_CURVE
-000334c0: 2827 272c 237b 7d2c 2823 7b7d 292c 2e50  ('',#{},(#{}),.P
-000334d0: 4355 5256 455f 5331 2e29 3b5c 6e22 2e66  CURVE_S1.);\n".f
-000334e0: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
-000334f0: 2020 2020 2020 2063 7572 7665 5f69 6420         curve_id 
-00033500: 2b20 312c 2063 7572 7665 5f69 642c 2073  + 1, curve_id, s
-00033510: 7572 6661 6365 5f69 6429 0a20 2020 2020  urface_id).     
-00033520: 2020 2020 2020 2063 7572 7665 5f69 6420         curve_id 
-00033530: 2b3d 2031 0a0a 2020 2020 2020 2020 6375  += 1..        cu
-00033540: 7272 656e 745f 6964 203d 2063 7572 7665  rrent_id = curve
-00033550: 5f69 6420 2b20 310a 2020 2020 2020 2020  _id + 1.        
-00033560: 7374 6172 745f 636f 6e74 656e 742c 2073  start_content, s
-00033570: 7461 7274 5f69 6420 3d20 7365 6c66 2e73  tart_id = self.s
-00033580: 7461 7274 2e74 6f5f 7374 6570 2863 7572  tart.to_step(cur
-00033590: 7265 6e74 5f69 642c 2076 6572 7465 783d  rent_id, vertex=
-000335a0: 5472 7565 290a 2020 2020 2020 2020 656e  True).        en
-000335b0: 645f 636f 6e74 656e 742c 2065 6e64 5f69  d_content, end_i
-000335c0: 6420 3d20 7365 6c66 2e65 6e64 2e74 6f5f  d = self.end.to_
-000335d0: 7374 6570 2873 7461 7274 5f69 6420 2b20  step(start_id + 
-000335e0: 312c 2076 6572 7465 783d 5472 7565 290a  1, vertex=True).
-000335f0: 2020 2020 2020 2020 636f 6e74 656e 7420          content 
-00033600: 2b3d 2073 7461 7274 5f63 6f6e 7465 6e74  += start_content
-00033610: 202b 2065 6e64 5f63 6f6e 7465 6e74 0a20   + end_content. 
-00033620: 2020 2020 2020 2063 7572 7265 6e74 5f69         current_i
-00033630: 6420 3d20 656e 645f 6964 202b 2031 0a20  d = end_id + 1. 
-00033640: 2020 2020 2020 2063 6f6e 7465 6e74 202b         content +
-00033650: 3d20 2223 7b7d 203d 2045 4447 455f 4355  = "#{} = EDGE_CU
-00033660: 5256 4528 277b 7d27 2c23 7b7d 2c23 7b7d  RVE('{}',#{},#{}
-00033670: 2c23 7b7d 2c2e 542e 293b 5c6e 222e 666f  ,#{},.T.);\n".fo
-00033680: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
-00033690: 2020 6375 7272 656e 745f 6964 2c20 7365    current_id, se
-000336a0: 6c66 2e6e 616d 652c 0a20 2020 2020 2020  lf.name,.       
-000336b0: 2020 2020 2073 7461 7274 5f69 642c 2065       start_id, e
-000336c0: 6e64 5f69 642c 2063 7572 7665 5f69 6429  nd_id, curve_id)
-000336d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000336e0: 636f 6e74 656e 742c 205b 6375 7272 656e  content, [curren
-000336f0: 745f 6964 5d0a 0a20 2020 2064 6566 2070  t_id]..    def p
-00033700: 6f69 6e74 5f62 656c 6f6e 6773 2873 656c  oint_belongs(sel
-00033710: 662c 2070 6f69 6e74 3364 2c20 6162 735f  f, point3d, abs_
-00033720: 746f 6c3a 2066 6c6f 6174 203d 2031 652d  tol: float = 1e-
-00033730: 3629 3a0a 2020 2020 2020 2020 2222 220a  6):.        """.
-00033740: 2020 2020 2020 2020 4368 6563 6b20 6966          Check if
-00033750: 2061 2070 6f69 6e74 3364 2062 656c 6f6e   a point3d belon
-00033760: 6773 2074 6f20 7468 6520 6172 635f 3364  gs to the arc_3d
-00033770: 206f 7220 6e6f 742e 0a0a 2020 2020 2020   or not...      
-00033780: 2020 3a70 6172 616d 2070 6f69 6e74 3364    :param point3d
-00033790: 3a20 706f 696e 7420 746f 2062 6520 7665  : point to be ve
-000337a0: 7269 6669 6564 2069 7320 6f6e 2061 7263  rified is on arc
-000337b0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-000337c0: 3a20 5472 7565 2069 6620 706f 696e 7420  : True if point 
-000337d0: 6973 206f 6e20 4172 632c 2046 616c 7365  is on Arc, False
-000337e0: 206f 7468 6572 7769 7365 2e0a 2020 2020   otherwise..    
-000337f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00033800: 6966 206e 6f74 206d 6174 682e 6973 636c  if not math.iscl
-00033810: 6f73 6528 706f 696e 7433 642e 706f 696e  ose(point3d.poin
-00033820: 745f 6469 7374 616e 6365 2873 656c 662e  t_distance(self.
-00033830: 6365 6e74 6572 292c 2073 656c 662e 7261  center), self.ra
-00033840: 6469 7573 2c20 6162 735f 746f 6c3d 6162  dius, abs_tol=ab
-00033850: 735f 746f 6c29 3a0a 2020 2020 2020 2020  s_tol):.        
-00033860: 2020 2020 7265 7475 726e 2046 616c 7365      return False
-00033870: 0a20 2020 2020 2020 2023 2076 6563 746f  .        # vecto
-00033880: 7231 203d 2073 656c 662e 7374 6172 7420  r1 = self.start 
-00033890: 2d20 7365 6c66 2e63 656e 7465 720a 2020  - self.center.  
-000338a0: 2020 2020 2020 2320 7665 6374 6f72 3220        # vector2 
-000338b0: 3d20 7365 6c66 2e69 6e74 6572 696f 7220  = self.interior 
-000338c0: 2d20 7365 6c66 2e63 656e 7465 720a 2020  - self.center.  
-000338d0: 2020 2020 2020 7665 6374 6f72 203d 2070        vector = p
-000338e0: 6f69 6e74 3364 202d 2073 656c 662e 6365  oint3d - self.ce
-000338f0: 6e74 6572 0a20 2020 2020 2020 2069 6620  nter.        if 
-00033900: 6e6f 7420 6d61 7468 2e69 7363 6c6f 7365  not math.isclose
-00033910: 2876 6563 746f 722e 646f 7428 7365 6c66  (vector.dot(self
-00033920: 2e66 7261 6d65 2e77 292c 2030 2e30 2c20  .frame.w), 0.0, 
-00033930: 6162 735f 746f 6c3d 6162 735f 746f 6c29  abs_tol=abs_tol)
-00033940: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00033950: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
-00033960: 2020 2070 6f69 6e74 5f61 6273 6369 7373     point_absciss
-00033970: 6120 3d20 7365 6c66 2e61 6273 6369 7373  a = self.absciss
-00033980: 6128 706f 696e 7433 6429 0a20 2020 2020  a(point3d).     
-00033990: 2020 2061 6273 6369 7373 615f 7374 6172     abscissa_star
-000339a0: 7420 3d20 7365 6c66 2e61 6273 6369 7373  t = self.absciss
-000339b0: 6128 7365 6c66 2e73 7461 7274 290a 2020  a(self.start).  
-000339c0: 2020 2020 2020 6162 7363 6973 7361 5f65        abscissa_e
-000339d0: 6e64 203d 2073 656c 662e 6162 7363 6973  nd = self.abscis
-000339e0: 7361 2873 656c 662e 656e 6429 0a20 2020  sa(self.end).   
-000339f0: 2020 2020 2069 6620 6162 7363 6973 7361       if abscissa
-00033a00: 5f73 7461 7274 203c 3d20 706f 696e 745f  _start <= point_
-00033a10: 6162 7363 6973 7361 203c 3d20 6162 7363  abscissa <= absc
-00033a20: 6973 7361 5f65 6e64 3a0a 2020 2020 2020  issa_end:.      
-00033a30: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
-00033a40: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
-00033a50: 2046 616c 7365 0a0a 2020 2020 6465 6620   False..    def 
-00033a60: 7472 6961 6e67 756c 6174 696f 6e28 7365  triangulation(se
-00033a70: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00033a80: 7572 6e20 4e6f 6e65 0a0a 2020 2020 6465  urn None..    de
-00033a90: 6620 6d69 6464 6c65 5f70 6f69 6e74 2873  f middle_point(s
-00033aa0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00033ab0: 7475 726e 2073 656c 662e 706f 696e 745f  turn self.point_
-00033ac0: 6174 5f61 6273 6369 7373 6128 7365 6c66  at_abscissa(self
-00033ad0: 2e6c 656e 6774 6828 2920 2f20 3229 0a0a  .length() / 2)..
-00033ae0: 2020 2020 6465 6620 6c69 6e65 5f69 6e74      def line_int
-00033af0: 6572 7365 6374 696f 6e73 2873 656c 662c  ersections(self,
-00033b00: 206c 696e 6533 643a 204c 696e 6533 4429   line3d: Line3D)
-00033b10: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00033b20: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
-00033b30: 2069 6e74 6572 7365 6374 696f 6e73 2062   intersections b
-00033b40: 6574 7765 656e 2061 6e20 4172 6333 4420  etween an Arc3D 
-00033b50: 616e 6420 6120 4c69 6e65 3344 2e0a 0a20  and a Line3D... 
-00033b60: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
-00033b70: 6e65 7365 676d 656e 7433 643a 206c 696e  nesegment3d: lin
-00033b80: 6573 6567 6d65 6e74 2074 6f20 7665 7269  esegment to veri
-00033b90: 6679 2069 6e74 6572 7365 6374 696f 6e73  fy intersections
-00033ba0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00033bb0: 6e3a 206c 6973 7420 7769 7468 2069 6e74  n: list with int
-00033bc0: 6572 7365 6374 696f 6e73 2070 6f69 6e74  ersections point
-00033bd0: 7320 6265 7477 6565 6e20 6c69 6e65 2061  s between line a
-00033be0: 6e64 2041 7263 3344 2e0a 2020 2020 2020  nd Arc3D..      
-00033bf0: 2020 2222 220a 2020 2020 2020 2020 6369    """.        ci
-00033c00: 7263 6c65 3364 5f6c 696e 6573 6567 5f69  rcle3d_lineseg_i
-00033c10: 6e74 6572 7320 3d20 766d 5f75 7469 6c73  nters = vm_utils
-00033c20: 5f69 6e74 6572 7365 6374 696f 6e73 2e63  _intersections.c
-00033c30: 6972 636c 655f 3364 5f6c 696e 655f 696e  ircle_3d_line_in
-00033c40: 7465 7273 6563 7469 6f6e 7328 7365 6c66  tersections(self
-00033c50: 2c20 6c69 6e65 3364 290a 2020 2020 2020  , line3d).      
-00033c60: 2020 6c69 6e65 7365 676d 656e 745f 696e    linesegment_in
-00033c70: 7465 7273 6563 7469 6f6e 7320 3d20 5b5d  tersections = []
-00033c80: 0a20 2020 2020 2020 2066 6f72 2069 6e74  .        for int
-00033c90: 6572 7365 6374 696f 6e20 696e 2063 6972  ersection in cir
-00033ca0: 636c 6533 645f 6c69 6e65 7365 675f 696e  cle3d_lineseg_in
-00033cb0: 7465 7273 3a0a 2020 2020 2020 2020 2020  ters:.          
-00033cc0: 2020 6966 2073 656c 662e 706f 696e 745f    if self.point_
-00033cd0: 6265 6c6f 6e67 7328 696e 7465 7273 6563  belongs(intersec
-00033ce0: 7469 6f6e 2c20 3165 2d36 293a 0a20 2020  tion, 1e-6):.   
-00033cf0: 2020 2020 2020 2020 2020 2020 206c 696e               lin
-00033d00: 6573 6567 6d65 6e74 5f69 6e74 6572 7365  esegment_interse
-00033d10: 6374 696f 6e73 2e61 7070 656e 6428 696e  ctions.append(in
-00033d20: 7465 7273 6563 7469 6f6e 290a 2020 2020  tersection).    
-00033d30: 2020 2020 7265 7475 726e 206c 696e 6573      return lines
-00033d40: 6567 6d65 6e74 5f69 6e74 6572 7365 6374  egment_intersect
-00033d50: 696f 6e73 0a0a 2020 2020 6465 6620 6c69  ions..    def li
-00033d60: 6e65 7365 676d 656e 745f 696e 7465 7273  nesegment_inters
-00033d70: 6563 7469 6f6e 7328 7365 6c66 2c20 6c69  ections(self, li
-00033d80: 6e65 7365 676d 656e 7433 643a 204c 696e  nesegment3d: Lin
-00033d90: 6553 6567 6d65 6e74 3344 293a 0a20 2020  eSegment3D):.   
-00033da0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00033db0: 2043 616c 6375 6c61 7465 7320 696e 7465   Calculates inte
-00033dc0: 7273 6563 7469 6f6e 7320 6265 7477 6565  rsections betwee
-00033dd0: 6e20 616e 2041 7263 3344 2061 6e64 2061  n an Arc3D and a
-00033de0: 204c 696e 6553 6567 6d65 6e74 3344 2e0a   LineSegment3D..
-00033df0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00033e00: 6c69 6e65 7365 676d 656e 7433 643a 206c  linesegment3d: l
-00033e10: 696e 6573 6567 6d65 6e74 2074 6f20 7665  inesegment to ve
-00033e20: 7269 6679 2069 6e74 6572 7365 6374 696f  rify intersectio
-00033e30: 6e73 2e0a 2020 2020 2020 2020 3a72 6574  ns..        :ret
-00033e40: 7572 6e3a 206c 6973 7420 7769 7468 2069  urn: list with i
-00033e50: 6e74 6572 7365 6374 696f 6e73 2070 6f69  ntersections poi
-00033e60: 6e74 7320 6265 7477 6565 6e20 6c69 6e65  nts between line
-00033e70: 7365 676d 656e 7420 616e 6420 4172 6333  segment and Arc3
-00033e80: 442e 0a20 2020 2020 2020 2022 2222 0a20  D..        """. 
-00033e90: 2020 2020 2020 206c 696e 6573 6567 6d65         linesegme
-00033ea0: 6e74 5f69 6e74 6572 7365 6374 696f 6e73  nt_intersections
-00033eb0: 203d 205b 5d0a 2020 2020 2020 2020 696e   = [].        in
-00033ec0: 7465 7273 6563 7469 6f6e 7320 3d20 7365  tersections = se
-00033ed0: 6c66 2e6c 696e 655f 696e 7465 7273 6563  lf.line_intersec
-00033ee0: 7469 6f6e 7328 6c69 6e65 7365 676d 656e  tions(linesegmen
-00033ef0: 7433 6429 0a20 2020 2020 2020 2066 6f72  t3d).        for
-00033f00: 2069 6e74 6572 7365 6374 696f 6e20 696e   intersection in
-00033f10: 2069 6e74 6572 7365 6374 696f 6e73 3a0a   intersections:.
-00033f20: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00033f30: 696e 6573 6567 6d65 6e74 3364 2e70 6f69  inesegment3d.poi
-00033f40: 6e74 5f62 656c 6f6e 6773 2869 6e74 6572  nt_belongs(inter
-00033f50: 7365 6374 696f 6e29 3a0a 2020 2020 2020  section):.      
-00033f60: 2020 2020 2020 2020 2020 6c69 6e65 7365            linese
-00033f70: 676d 656e 745f 696e 7465 7273 6563 7469  gment_intersecti
-00033f80: 6f6e 732e 6170 7065 6e64 2869 6e74 6572  ons.append(inter
-00033f90: 7365 6374 696f 6e29 0a20 2020 2020 2020  section).       
-00033fa0: 2072 6574 7572 6e20 6c69 6e65 7365 676d   return linesegm
-00033fb0: 656e 745f 696e 7465 7273 6563 7469 6f6e  ent_intersection
-00033fc0: 730a 0a0a 636c 6173 7320 4675 6c6c 4172  s...class FullAr
-00033fd0: 6333 4428 4172 6333 4429 3a0a 2020 2020  c3D(Arc3D):.    
-00033fe0: 2222 220a 2020 2020 416e 2065 6467 6520  """.    An edge 
-00033ff0: 7468 6174 2073 7461 7274 7320 6174 2073  that starts at s
-00034000: 7461 7274 5f65 6e64 2c20 656e 6473 2061  tart_end, ends a
-00034010: 7420 7468 6520 7361 6d65 2070 6f69 6e74  t the same point
-00034020: 2061 6674 6572 2068 6176 696e 6720 6465   after having de
-00034030: 7363 7269 6265 6420 6120 6369 7263 6c65  scribed a circle
-00034040: 2e0a 0a20 2020 2022 2222 0a0a 2020 2020  ...    """..    
-00034050: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-00034060: 662c 2063 656e 7465 723a 2076 6f6c 6d64  f, center: volmd
-00034070: 6c72 2e50 6f69 6e74 3344 2c20 7374 6172  lr.Point3D, star
-00034080: 745f 656e 643a 2076 6f6c 6d64 6c72 2e50  t_end: volmdlr.P
-00034090: 6f69 6e74 3344 2c0a 2020 2020 2020 2020  oint3D,.        
-000340a0: 2020 2020 2020 2020 206e 6f72 6d61 6c3a           normal:
-000340b0: 2076 6f6c 6d64 6c72 2e56 6563 746f 7233   volmdlr.Vector3
-000340c0: 442c 0a20 2020 2020 2020 2020 2020 2020  D,.             
-000340d0: 2020 2020 6e61 6d65 3a20 7374 7220 3d20      name: str = 
-000340e0: 2727 293a 0a20 2020 2020 2020 2073 656c  ''):.        sel
-000340f0: 662e 5f5f 6365 6e74 6572 203d 2063 656e  f.__center = cen
-00034100: 7465 720a 2020 2020 2020 2020 7365 6c66  ter.        self
-00034110: 2e5f 5f6e 6f72 6d61 6c20 3d20 6e6f 726d  .__normal = norm
-00034120: 616c 0a20 2020 2020 2020 2073 656c 662e  al.        self.
-00034130: 7374 6172 745f 656e 6420 3d20 7374 6172  start_end = star
-00034140: 745f 656e 640a 2020 2020 2020 2020 696e  t_end.        in
-00034150: 7465 7269 6f72 203d 2073 7461 7274 5f65  terior = start_e
-00034160: 6e64 2e72 6f74 6174 696f 6e28 6365 6e74  nd.rotation(cent
-00034170: 6572 2c20 6e6f 726d 616c 2c20 6d61 7468  er, normal, math
-00034180: 2e70 6929 0a20 2020 2020 2020 2041 7263  .pi).        Arc
-00034190: 3344 2e5f 5f69 6e69 745f 5f28 7365 6c66  3D.__init__(self
-000341a0: 2c20 7374 6172 743d 7374 6172 745f 656e  , start=start_en
-000341b0: 642c 2065 6e64 3d73 7461 7274 5f65 6e64  d, end=start_end
-000341c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000341d0: 2020 2020 2020 2020 2069 6e74 6572 696f           interio
-000341e0: 723d 696e 7465 7269 6f72 2c20 6e61 6d65  r=interior, name
-000341f0: 3d6e 616d 6529 2020 2320 2121 2120 7468  =name)  # !!! th
-00034200: 6973 2069 7320 6461 6e67 6572 6f75 730a  is is dangerous.
-00034210: 0a20 2020 2064 6566 205f 5f68 6173 685f  .    def __hash_
-00034220: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00034230: 2072 6574 7572 6e20 6861 7368 2873 656c   return hash(sel
-00034240: 662e 6365 6e74 6572 2920 2b20 3520 2a20  f.center) + 5 * 
-00034250: 6861 7368 2873 656c 662e 7374 6172 745f  hash(self.start_
-00034260: 656e 6429 0a0a 2020 2020 6465 6620 5f5f  end)..    def __
-00034270: 6571 5f5f 2873 656c 662c 206f 7468 6572  eq__(self, other
-00034280: 5f61 7263 293a 0a20 2020 2020 2020 2072  _arc):.        r
-00034290: 6574 7572 6e20 2873 656c 662e 6365 6e74  eturn (self.cent
-000342a0: 6572 203d 3d20 6f74 6865 725f 6172 632e  er == other_arc.
-000342b0: 6365 6e74 6572 2920 5c0a 2020 2020 2020  center) \.      
-000342c0: 2020 2020 2020 616e 6420 2873 656c 662e        and (self.
-000342d0: 7374 6172 7420 3d3d 206f 7468 6572 5f61  start == other_a
-000342e0: 7263 2e73 7461 7274 290a 0a20 2020 2040  rc.start)..    @
-000342f0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00034300: 2063 656e 7465 7228 7365 6c66 293a 0a20   center(self):. 
-00034310: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00034320: 6c66 2e5f 5f63 656e 7465 720a 0a20 2020  lf.__center..   
-00034330: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00034340: 6566 2061 6e67 6c65 2873 656c 6629 3a0a  ef angle(self):.
-00034350: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-00034360: 6f6c 6d64 6c72 2e54 574f 5f50 490a 0a20  olmdlr.TWO_PI.. 
-00034370: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00034380: 2064 6566 206e 6f72 6d61 6c28 7365 6c66   def normal(self
-00034390: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-000343a0: 6e20 7365 6c66 2e5f 5f6e 6f72 6d61 6c0a  n self.__normal.
-000343b0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-000343c0: 2020 2064 6566 2069 735f 7472 6967 6f28     def is_trigo(
-000343d0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-000343e0: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
-000343f0: 6465 6620 636f 7079 2873 656c 662c 202a  def copy(self, *
-00034400: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-00034410: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00034420: 4675 6c6c 4172 6333 4428 7365 6c66 2e5f  FullArc3D(self._
-00034430: 6365 6e74 6572 2e63 6f70 7928 292c 2073  center.copy(), s
-00034440: 656c 662e 656e 642e 636f 7079 2829 2c20  elf.end.copy(), 
-00034450: 7365 6c66 2e5f 6e6f 726d 616c 2e63 6f70  self._normal.cop
-00034460: 7928 2929 0a0a 2020 2020 6465 6620 746f  y())..    def to
-00034470: 5f64 6963 7428 7365 6c66 2c20 7573 655f  _dict(self, use_
-00034480: 706f 696e 7465 7273 3a20 626f 6f6c 203d  pointers: bool =
-00034490: 2046 616c 7365 2c20 6d65 6d6f 3d4e 6f6e   False, memo=Non
-000344a0: 652c 2070 6174 683a 2073 7472 203d 2027  e, path: str = '
-000344b0: 2327 293a 0a20 2020 2020 2020 2064 6963  #'):.        dic
-000344c0: 745f 203d 2073 656c 662e 6261 7365 5f64  t_ = self.base_d
-000344d0: 6963 7428 290a 2020 2020 2020 2020 6469  ict().        di
-000344e0: 6374 5f5b 2763 656e 7465 7227 5d20 3d20  ct_['center'] = 
-000344f0: 7365 6c66 2e63 656e 7465 722e 746f 5f64  self.center.to_d
-00034500: 6963 7428 7573 655f 706f 696e 7465 7273  ict(use_pointers
-00034510: 3d75 7365 5f70 6f69 6e74 6572 732c 206d  =use_pointers, m
-00034520: 656d 6f3d 6d65 6d6f 2c20 7061 7468 3d70  emo=memo, path=p
-00034530: 6174 6820 2b20 272f 6365 6e74 6572 2729  ath + '/center')
-00034540: 0a20 2020 2020 2020 2064 6963 745f 5b27  .        dict_['
-00034550: 7261 6469 7573 275d 203d 2073 656c 662e  radius'] = self.
-00034560: 7261 6469 7573 0a20 2020 2020 2020 2064  radius.        d
-00034570: 6963 745f 5b27 616e 676c 6527 5d20 3d20  ict_['angle'] = 
-00034580: 7365 6c66 2e61 6e67 6c65 0a20 2020 2020  self.angle.     
-00034590: 2020 2064 6963 745f 5b27 6973 5f74 7269     dict_['is_tri
-000345a0: 676f 275d 203d 2073 656c 662e 6973 5f74  go'] = self.is_t
-000345b0: 7269 676f 0a20 2020 2020 2020 2064 6963  rigo.        dic
-000345c0: 745f 5b27 7374 6172 745f 656e 6427 5d20  t_['start_end'] 
-000345d0: 3d20 7365 6c66 2e73 7461 7274 2e74 6f5f  = self.start.to_
-000345e0: 6469 6374 2875 7365 5f70 6f69 6e74 6572  dict(use_pointer
-000345f0: 733d 7573 655f 706f 696e 7465 7273 2c20  s=use_pointers, 
-00034600: 6d65 6d6f 3d6d 656d 6f2c 2070 6174 683d  memo=memo, path=
-00034610: 7061 7468 202b 2027 2f73 7461 7274 5f65  path + '/start_e
-00034620: 6e64 2729 0a20 2020 2020 2020 2064 6963  nd').        dic
-00034630: 745f 5b27 6e6f 726d 616c 275d 203d 2073  t_['normal'] = s
-00034640: 656c 662e 6e6f 726d 616c 2e74 6f5f 6469  elf.normal.to_di
-00034650: 6374 2875 7365 5f70 6f69 6e74 6572 733d  ct(use_pointers=
-00034660: 7573 655f 706f 696e 7465 7273 2c20 6d65  use_pointers, me
-00034670: 6d6f 3d6d 656d 6f2c 2070 6174 683d 7061  mo=memo, path=pa
-00034680: 7468 202b 2027 2f6e 6f72 6d61 6c27 290a  th + '/normal').
-00034690: 2020 2020 2020 2020 6469 6374 5f5b 276e          dict_['n
-000346a0: 616d 6527 5d20 3d20 7365 6c66 2e6e 616d  ame'] = self.nam
-000346b0: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
-000346c0: 2064 6963 745f 0a0a 2020 2020 6465 6620   dict_..    def 
-000346d0: 746f 5f32 6428 7365 6c66 2c20 706c 616e  to_2d(self, plan
-000346e0: 655f 6f72 6967 696e 2c20 782c 2079 293a  e_origin, x, y):
-000346f0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00034700: 2020 2020 2054 7261 6e73 666f 726d 7320       Transforms 
-00034710: 6120 4675 6c6c 4172 6333 4420 696e 746f  a FullArc3D into
-00034720: 2061 6e20 4675 6c6c 4172 6332 442c 2067   an FullArc2D, g
-00034730: 6976 656e 2061 6e20 706c 616e 6520 6f72  iven an plane or
-00034740: 6967 696e 2061 6e64 2061 2075 2061 6e64  igin and a u and
-00034750: 2076 2070 6c61 6e65 2076 6563 746f 722e   v plane vector.
-00034760: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00034770: 2070 6c61 6e65 5f6f 7269 6769 6e3a 2070   plane_origin: p
-00034780: 6c61 6e65 206f 7269 6769 6e2e 0a20 2020  lane origin..   
-00034790: 2020 2020 203a 7061 7261 6d20 783a 2070       :param x: p
-000347a0: 6c61 6e65 2075 2076 6563 746f 722e 0a20  lane u vector.. 
-000347b0: 2020 2020 2020 203a 7061 7261 6d20 793a         :param y:
-000347c0: 2070 6c61 6e65 2076 2076 6563 746f 722e   plane v vector.
-000347d0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-000347e0: 3a20 4675 6c6c 4172 6332 442e 0a20 2020  : FullArc2D..   
-000347f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00034800: 2063 656e 7465 7220 3d20 7365 6c66 2e63   center = self.c
-00034810: 656e 7465 722e 746f 5f32 6428 706c 616e  enter.to_2d(plan
-00034820: 655f 6f72 6967 696e 2c20 782c 2079 290a  e_origin, x, y).
-00034830: 2020 2020 2020 2020 7374 6172 745f 656e          start_en
-00034840: 6420 3d20 7365 6c66 2e73 7461 7274 2e74  d = self.start.t
-00034850: 6f5f 3264 2870 6c61 6e65 5f6f 7269 6769  o_2d(plane_origi
-00034860: 6e2c 2078 2c20 7929 0a20 2020 2020 2020  n, x, y).       
-00034870: 2072 6574 7572 6e20 4675 6c6c 4172 6332   return FullArc2
-00034880: 4428 6365 6e74 6572 2c20 7374 6172 745f  D(center, start_
-00034890: 656e 6429 0a0a 2020 2020 6465 6620 746f  end)..    def to
-000348a0: 5f73 7465 7028 7365 6c66 2c20 6375 7272  _step(self, curr
-000348b0: 656e 745f 6964 2c20 7375 7266 6163 655f  ent_id, surface_
-000348c0: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
-000348d0: 2020 2320 4e6f 7420 6361 6c6c 696e 6720    # Not calling 
-000348e0: 4369 7263 6c65 3344 2e74 6f5f 7374 6570  Circle3D.to_step
-000348f0: 2062 6563 6175 7365 206f 6620 6369 7263   because of circ
-00034900: 756c 6172 2069 6d70 6f72 7473 0a20 2020  ular imports.   
-00034910: 2020 2020 2075 203d 2073 656c 662e 7374       u = self.st
-00034920: 6172 7420 2d20 7365 6c66 2e63 656e 7465  art - self.cente
-00034930: 720a 2020 2020 2020 2020 752e 6e6f 726d  r.        u.norm
-00034940: 616c 697a 6528 290a 2020 2020 2020 2020  alize().        
-00034950: 7620 3d20 7365 6c66 2e6e 6f72 6d61 6c2e  v = self.normal.
-00034960: 6372 6f73 7328 7529 0a20 2020 2020 2020  cross(u).       
-00034970: 2066 7261 6d65 203d 2076 6f6c 6d64 6c72   frame = volmdlr
-00034980: 2e46 7261 6d65 3344 2873 656c 662e 6365  .Frame3D(self.ce
-00034990: 6e74 6572 2c20 7365 6c66 2e6e 6f72 6d61  nter, self.norma
-000349a0: 6c2c 2075 2c20 7629 0a20 2020 2020 2020  l, u, v).       
-000349b0: 2063 6f6e 7465 6e74 2c20 6672 616d 655f   content, frame_
-000349c0: 6964 203d 2066 7261 6d65 2e74 6f5f 7374  id = frame.to_st
-000349d0: 6570 2863 7572 7265 6e74 5f69 6429 0a20  ep(current_id). 
-000349e0: 2020 2020 2020 2063 7572 7665 5f69 6420         curve_id 
-000349f0: 3d20 6672 616d 655f 6964 202b 2031 0a20  = frame_id + 1. 
-00034a00: 2020 2020 2020 2023 204e 6f74 2063 616c         # Not cal
-00034a10: 6c69 6e67 2043 6972 636c 6533 442e 746f  ling Circle3D.to
-00034a20: 5f73 7465 7020 6265 6361 7573 6520 6f66  _step because of
-00034a30: 2063 6972 6375 6c61 7220 696d 706f 7274   circular import
-00034a40: 730a 2020 2020 2020 2020 636f 6e74 656e  s.        conten
-00034a50: 7420 2b3d 2022 237b 7d20 3d20 4349 5243  t += "#{} = CIRC
-00034a60: 4c45 2827 7b7d 272c 237b 7d2c 7b3a 2e36  LE('{}',#{},{:.6
-00034a70: 667d 293b 5c6e 222e 666f 726d 6174 2863  f});\n".format(c
-00034a80: 7572 7665 5f69 642c 0a20 2020 2020 2020  urve_id,.       
-00034a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ac0: 2020 2020 2020 7365 6c66 2e6e 616d 652c        self.name,
-00034ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034b00: 2020 2020 2020 2020 2020 2020 2020 6672                fr
-00034b10: 616d 655f 6964 2c0a 2020 2020 2020 2020  ame_id,.        
-00034b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034b50: 2020 2020 2073 656c 662e 7261 6469 7573       self.radius
-00034b60: 202a 2031 3030 302c 0a20 2020 2020 2020   * 1000,.       
-00034b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ba0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00034bb0: 2069 6620 7375 7266 6163 655f 6964 3a0a   if surface_id:.
-00034bc0: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-00034bd0: 656e 7420 2b3d 2022 237b 7d20 3d20 5355  ent += "#{} = SU
-00034be0: 5246 4143 455f 4355 5256 4528 2727 2c23  RFACE_CURVE('',#
-00034bf0: 7b7d 2c28 237b 7d29 2c2e 5043 5552 5645  {},(#{}),.PCURVE
-00034c00: 5f53 312e 293b 5c6e 222e 666f 726d 6174  _S1.);\n".format
-00034c10: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00034c20: 2020 6375 7276 655f 6964 202b 2031 2c20    curve_id + 1, 
-00034c30: 6375 7276 655f 6964 2c20 7375 7266 6163  curve_id, surfac
-00034c40: 655f 6964 290a 2020 2020 2020 2020 2020  e_id).          
-00034c50: 2020 6375 7276 655f 6964 202b 3d20 310a    curve_id += 1.
-00034c60: 0a20 2020 2020 2020 2070 3120 3d20 2873  .        p1 = (s
-00034c70: 656c 662e 6365 6e74 6572 202b 2075 202a  elf.center + u *
-00034c80: 2073 656c 662e 7261 6469 7573 292e 746f   self.radius).to
-00034c90: 5f70 6f69 6e74 2829 0a20 2020 2020 2020  _point().       
-00034ca0: 2023 2070 3220 3d20 7365 6c66 2e63 656e   # p2 = self.cen
-00034cb0: 7465 7220 2b20 762a 7365 6c66 2e72 6164  ter + v*self.rad
-00034cc0: 6975 730a 2020 2020 2020 2020 2320 7033  ius.        # p3
-00034cd0: 203d 2073 656c 662e 6365 6e74 6572 202d   = self.center -
-00034ce0: 2075 2a73 656c 662e 7261 6469 7573 0a20   u*self.radius. 
-00034cf0: 2020 2020 2020 2023 2070 3420 3d20 7365         # p4 = se
-00034d00: 6c66 2e63 656e 7465 7220 2d20 762a 7365  lf.center - v*se
-00034d10: 6c66 2e72 6164 6975 730a 0a20 2020 2020  lf.radius..     
-00034d20: 2020 2070 315f 636f 6e74 656e 742c 2070     p1_content, p
-00034d30: 315f 6964 203d 2070 312e 746f 5f73 7465  1_id = p1.to_ste
-00034d40: 7028 6375 7276 655f 6964 202b 2031 2c20  p(curve_id + 1, 
-00034d50: 7665 7274 6578 3d54 7275 6529 0a20 2020  vertex=True).   
-00034d60: 2020 2020 2063 6f6e 7465 6e74 202b 3d20       content += 
-00034d70: 7031 5f63 6f6e 7465 6e74 0a20 2020 2020  p1_content.     
-00034d80: 2020 2023 2070 325f 636f 6e74 656e 742c     # p2_content,
-00034d90: 2070 325f 6964 203d 2070 322e 746f 5f73   p2_id = p2.to_s
-00034da0: 7465 7028 7031 5f69 642b 312c 2076 6572  tep(p1_id+1, ver
-00034db0: 7465 783d 5472 7565 290a 2020 2020 2020  tex=True).      
-00034dc0: 2020 2320 7033 5f63 6f6e 7465 6e74 2c20    # p3_content, 
-00034dd0: 7033 5f69 6420 3d20 7033 2e74 6f5f 7374  p3_id = p3.to_st
-00034de0: 6570 2870 325f 6964 2b31 2c20 7665 7274  ep(p2_id+1, vert
-00034df0: 6578 3d54 7275 6529 0a20 2020 2020 2020  ex=True).       
-00034e00: 2023 2070 345f 636f 6e74 656e 742c 2070   # p4_content, p
-00034e10: 345f 6964 203d 2070 342e 746f 5f73 7465  4_id = p4.to_ste
-00034e20: 7028 7033 5f69 642b 312c 2076 6572 7465  p(p3_id+1, verte
-00034e30: 783d 5472 7565 290a 2020 2020 2020 2020  x=True).        
-00034e40: 2320 636f 6e74 656e 7420 2b3d 2070 315f  # content += p1_
-00034e50: 636f 6e74 656e 7420 2b20 7032 5f63 6f6e  content + p2_con
-00034e60: 7465 6e74 202b 2070 335f 636f 6e74 656e  tent + p3_conten
-00034e70: 7420 2b20 7034 5f63 6f6e 7465 6e74 0a0a  t + p4_content..
-00034e80: 2020 2020 2020 2020 2320 6172 6331 5f69          # arc1_i
-00034e90: 6420 3d20 7034 5f69 6420 2b20 310a 2020  d = p4_id + 1.  
-00034ea0: 2020 2020 2020 2320 636f 6e74 656e 7420        # content 
-00034eb0: 2b3d 2022 237b 7d20 3d20 4544 4745 5f43  += "#{} = EDGE_C
-00034ec0: 5552 5645 2827 7b7d 272c 237b 7d2c 237b  URVE('{}',#{},#{
-00034ed0: 7d2c 237b 7d2c 2e54 2e29 3b5c 6e22 2e66  },#{},.T.);\n".f
-00034ee0: 6f72 6d61 7428 6172 6331 5f69 642c 2073  ormat(arc1_id, s
-00034ef0: 656c 662e 6e61 6d65 2c0a 2020 2020 2020  elf.name,.      
-00034f00: 2020 2320 2020 2020 2020 2020 2020 2020    #             
-00034f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034f40: 7031 5f69 642c 2070 325f 6964 2c0a 2020  p1_id, p2_id,.  
-00034f50: 2020 2020 2020 2320 2020 2020 2020 2020        #         
-00034f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034f90: 2020 2020 6369 7263 6c65 5f69 6429 0a0a      circle_id)..
-00034fa0: 2020 2020 2020 2020 2320 6172 6332 5f69          # arc2_i
-00034fb0: 6420 3d20 6172 6331 5f69 6420 2b20 310a  d = arc1_id + 1.
-00034fc0: 2020 2020 2020 2020 2320 636f 6e74 656e          # conten
-00034fd0: 7420 2b3d 2022 237b 7d20 3d20 4544 4745  t += "#{} = EDGE
-00034fe0: 5f43 5552 5645 2827 7b7d 272c 237b 7d2c  _CURVE('{}',#{},
-00034ff0: 237b 7d2c 237b 7d2c 2e54 2e29 3b5c 6e22  #{},#{},.T.);\n"
-00035000: 2e66 6f72 6d61 7428 6172 6332 5f69 642c  .format(arc2_id,
-00035010: 2073 656c 662e 6e61 6d65 2c0a 2020 2020   self.name,.    
-00035020: 2020 2020 2320 2020 2020 2020 2020 2020      #           
-00035030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035060: 2020 7032 5f69 642c 2070 335f 6964 2c0a    p2_id, p3_id,.
-00035070: 2020 2020 2020 2020 2320 2020 2020 2020          #       
-00035080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000350a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000350b0: 2020 2020 2020 6369 7263 6c65 5f69 6429        circle_id)
-000350c0: 0a0a 2020 2020 2020 2020 2320 6172 6333  ..        # arc3
-000350d0: 5f69 6420 3d20 6172 6332 5f69 6420 2b20  _id = arc2_id + 
-000350e0: 310a 2020 2020 2020 2020 2320 636f 6e74  1.        # cont
-000350f0: 656e 7420 2b3d 2022 237b 7d20 3d20 4544  ent += "#{} = ED
-00035100: 4745 5f43 5552 5645 2827 7b7d 272c 237b  GE_CURVE('{}',#{
-00035110: 7d2c 237b 7d2c 237b 7d2c 2e54 2e29 3b5c  },#{},#{},.T.);\
-00035120: 6e22 2e66 6f72 6d61 7428 6172 6333 5f69  n".format(arc3_i
-00035130: 642c 2073 656c 662e 6e61 6d65 2c0a 2020  d, self.name,.  
-00035140: 2020 2020 2020 2320 2020 2020 2020 2020        #         
-00035150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035180: 2020 2020 7033 5f69 642c 2070 345f 6964      p3_id, p4_id
-00035190: 2c0a 2020 2020 2020 2020 2320 2020 2020  ,.        #     
-000351a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bb20: 2020 2020 2020 2020 2020 2d62 7370 6c69            -bspli
+0002bb30: 6e65 5f63 7572 7665 2e64 6567 7265 655d  ne_curve.degree]
+0002bb40: 0a20 2020 2020 2020 206e 6577 5f6d 756c  .        new_mul
+0002bb50: 7469 706c 6963 6974 6965 7320 3d20 6273  tiplicities = bs
+0002bb60: 706c 696e 655f 6375 7276 652e 6b6e 6f74  pline_curve.knot
+0002bb70: 5f6d 756c 7469 706c 6963 6974 6965 735b  _multiplicities[
+0002bb80: 313a 2d31 5d0a 2020 2020 2020 2020 2320  1:-1].        # 
+0002bb90: 6e65 775f 6d75 6c74 6970 6c69 6369 7469  new_multipliciti
+0002bba0: 6573 203d 2062 7370 6c69 6e65 5f63 7572  es = bspline_cur
+0002bbb0: 7665 2e6b 6e6f 745f 6d75 6c74 6970 6c69  ve.knot_multipli
+0002bbc0: 6369 7469 6573 5b32 3a2d 355d 0a20 2020  cities[2:-5].   
+0002bbd0: 2020 2020 206e 6577 5f6d 756c 7469 706c       new_multipl
+0002bbe0: 6963 6974 6965 735b 2d31 5d20 2b3d 2031  icities[-1] += 1
+0002bbf0: 0a20 2020 2020 2020 206e 6577 5f6d 756c  .        new_mul
+0002bc00: 7469 706c 6963 6974 6965 735b 305d 202b  tiplicities[0] +
+0002bc10: 3d20 310a 2020 2020 2020 2020 6e65 775f  = 1.        new_
+0002bc20: 6b6e 6f74 7320 3d20 6273 706c 696e 655f  knots = bspline_
+0002bc30: 6375 7276 652e 6b6e 6f74 735b 313a 2d31  curve.knots[1:-1
+0002bc40: 5d0a 2020 2020 2020 2020 2320 6e65 775f  ].        # new_
+0002bc50: 6b6e 6f74 7320 3d20 6273 706c 696e 655f  knots = bspline_
+0002bc60: 6375 7276 652e 6b6e 6f74 735b 323a 2d35  curve.knots[2:-5
+0002bc70: 5d0a 2020 2020 2020 2020 6e65 775f 6b6e  ].        new_kn
+0002bc80: 6f74 7320 3d20 7374 616e 6461 7264 697a  ots = standardiz
+0002bc90: 655f 6b6e 6f74 5f76 6563 746f 7228 6e65  e_knot_vector(ne
+0002bca0: 775f 6b6e 6f74 7329 0a0a 2020 2020 2020  w_knots)..      
+0002bcb0: 2020 7265 7475 726e 2042 5370 6c69 6e65    return BSpline
+0002bcc0: 4375 7276 6533 4428 6465 6772 6565 3d62  Curve3D(degree=b
+0002bcd0: 7370 6c69 6e65 5f63 7572 7665 2e64 6567  spline_curve.deg
+0002bce0: 7265 652c 0a20 2020 2020 2020 2020 2020  ree,.           
+0002bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bd00: 2020 2063 6f6e 7472 6f6c 5f70 6f69 6e74     control_point
+0002bd10: 733d 6e65 775f 6374 726c 7074 732c 0a20  s=new_ctrlpts,. 
+0002bd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bd30: 2020 2020 2020 2020 2020 2020 206b 6e6f               kno
+0002bd40: 745f 6d75 6c74 6970 6c69 6369 7469 6573  t_multiplicities
+0002bd50: 3d6e 6577 5f6d 756c 7469 706c 6963 6974  =new_multiplicit
+0002bd60: 6965 732c 0a20 2020 2020 2020 2020 2020  ies,.           
+0002bd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bd80: 2020 206b 6e6f 7473 3d6e 6577 5f6b 6e6f     knots=new_kno
+0002bd90: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+0002bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bdb0: 2020 7765 6967 6874 733d 4e6f 6e65 2c0a    weights=None,.
+0002bdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bdd0: 2020 2020 2020 2020 2020 2020 2020 7065                pe
+0002bde0: 7269 6f64 6963 3d62 7370 6c69 6e65 5f63  riodic=bspline_c
+0002bdf0: 7572 7665 2e70 6572 696f 6469 632c 0a20  urve.periodic,. 
+0002be00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002be10: 2020 2020 2020 2020 2020 2020 206e 616d               nam
+0002be20: 653d 6273 706c 696e 655f 6375 7276 652e  e=bspline_curve.
+0002be30: 6e61 6d65 290a 0a20 2020 2064 6566 2063  name)..    def c
+0002be40: 7574 5f62 6566 6f72 6528 7365 6c66 2c20  ut_before(self, 
+0002be50: 7061 7261 6d65 7465 723a 2066 6c6f 6174  parameter: float
+0002be60: 293a 0a20 2020 2020 2020 2023 2049 7320  ):.        # Is 
+0002be70: 6120 7661 6c75 6520 6f66 2070 6172 616d  a value of param
+0002be80: 6574 6572 2062 656c 6f77 2034 652d 3320  eter below 4e-3 
+0002be90: 6120 7265 616c 206e 6565 6420 666f 7220  a real need for 
+0002bea0: 7072 6563 6973 696f 6e20 3f0a 2020 2020  precision ?.    
+0002beb0: 2020 2020 6966 206d 6174 682e 6973 636c      if math.iscl
+0002bec0: 6f73 6528 7061 7261 6d65 7465 722c 2030  ose(parameter, 0
+0002bed0: 2c20 6162 735f 746f 6c3d 3465 2d33 293a  , abs_tol=4e-3):
+0002bee0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0002bef0: 7572 6e20 7365 6c66 0a20 2020 2020 2020  urn self.       
+0002bf00: 2069 6620 6d61 7468 2e69 7363 6c6f 7365   if math.isclose
+0002bf10: 2870 6172 616d 6574 6572 2c20 312c 2061  (parameter, 1, a
+0002bf20: 6273 5f74 6f6c 3d34 652d 3329 3a0a 2020  bs_tol=4e-3):.  
+0002bf30: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0002bf40: 5661 6c75 6545 7272 6f72 2827 4e6f 7468  ValueError('Noth
+0002bf50: 696e 6720 7769 6c6c 2062 6520 6c65 6674  ing will be left
+0002bf60: 2066 726f 6d20 7468 6520 4253 706c 696e   from the BSplin
+0002bf70: 6543 7572 7665 3344 2729 0a0a 2020 2020  eCurve3D')..    
+0002bf80: 2020 2020 6375 7276 6573 203d 206f 7065      curves = ope
+0002bf90: 7261 7469 6f6e 732e 7370 6c69 745f 6375  rations.split_cu
+0002bfa0: 7276 6528 7365 6c66 2e63 7572 7665 2c20  rve(self.curve, 
+0002bfb0: 7061 7261 6d65 7465 7229 0a20 2020 2020  parameter).     
+0002bfc0: 2020 2072 6574 7572 6e20 7365 6c66 2e66     return self.f
+0002bfd0: 726f 6d5f 6765 6f6d 646c 5f63 7572 7665  rom_geomdl_curve
+0002bfe0: 2863 7572 7665 735b 315d 290a 0a20 2020  (curves[1])..   
+0002bff0: 2064 6566 2063 7574 5f61 6674 6572 2873   def cut_after(s
+0002c000: 656c 662c 2070 6172 616d 6574 6572 3a20  elf, parameter: 
+0002c010: 666c 6f61 7429 3a0a 2020 2020 2020 2020  float):.        
+0002c020: 2320 4973 2061 2076 616c 7565 206f 6620  # Is a value of 
+0002c030: 7061 7261 6d65 7465 7220 6265 6c6f 7720  parameter below 
+0002c040: 3465 2d33 2061 2072 6561 6c20 6e65 6564  4e-3 a real need
+0002c050: 2066 6f72 2070 7265 6369 7369 6f6e 203f   for precision ?
+0002c060: 0a20 2020 2020 2020 2069 6620 6d61 7468  .        if math
+0002c070: 2e69 7363 6c6f 7365 2870 6172 616d 6574  .isclose(paramet
+0002c080: 6572 2c20 302c 2061 6273 5f74 6f6c 3d34  er, 0, abs_tol=4
+0002c090: 652d 3329 3a0a 2020 2020 2020 2020 2020  e-3):.          
+0002c0a0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0002c0b0: 6f72 2827 4e6f 7468 696e 6720 7769 6c6c  or('Nothing will
+0002c0c0: 2062 6520 6c65 6674 2066 726f 6d20 7468   be left from th
+0002c0d0: 6520 4253 706c 696e 6543 7572 7665 3344  e BSplineCurve3D
+0002c0e0: 2729 0a20 2020 2020 2020 2069 6620 6d61  ').        if ma
+0002c0f0: 7468 2e69 7363 6c6f 7365 2870 6172 616d  th.isclose(param
+0002c100: 6574 6572 2c20 312c 2061 6273 5f74 6f6c  eter, 1, abs_tol
+0002c110: 3d34 652d 3329 3a0a 2020 2020 2020 2020  =4e-3):.        
+0002c120: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+0002c130: 2020 2020 2020 2020 6375 7276 6573 203d          curves =
+0002c140: 206f 7065 7261 7469 6f6e 732e 7370 6c69   operations.spli
+0002c150: 745f 6375 7276 6528 7365 6c66 2e63 7572  t_curve(self.cur
+0002c160: 7665 2c20 7061 7261 6d65 7465 7229 0a20  ve, parameter). 
+0002c170: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0002c180: 6c66 2e66 726f 6d5f 6765 6f6d 646c 5f63  lf.from_geomdl_c
+0002c190: 7572 7665 2863 7572 7665 735b 305d 290a  urve(curves[0]).
+0002c1a0: 0a20 2020 2064 6566 2069 6e73 6572 745f  .    def insert_
+0002c1b0: 6b6e 6f74 2873 656c 662c 206b 6e6f 743a  knot(self, knot:
+0002c1c0: 2066 6c6f 6174 2c20 6e75 6d3a 2069 6e74   float, num: int
+0002c1d0: 203d 2031 293a 0a20 2020 2020 2020 2022   = 1):.        "
+0002c1e0: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+0002c1f0: 6e73 2061 206e 6577 2042 5370 6c69 6e65  ns a new BSpline
+0002c200: 4375 7276 6533 442e 0a0a 2020 2020 2020  Curve3D...      
+0002c210: 2020 2222 220a 2020 2020 2020 2020 6375    """.        cu
+0002c220: 7276 655f 636f 7079 203d 2073 656c 662e  rve_copy = self.
+0002c230: 6375 7276 652e 5f5f 6465 6570 636f 7079  curve.__deepcopy
+0002c240: 5f5f 287b 7d29 0a20 2020 2020 2020 206d  __({}).        m
+0002c250: 6f64 6966 6965 645f 6375 7276 6520 3d20  odified_curve = 
+0002c260: 6f70 6572 6174 696f 6e73 2e69 6e73 6572  operations.inser
+0002c270: 745f 6b6e 6f74 2863 7572 7665 5f63 6f70  t_knot(curve_cop
+0002c280: 792c 205b 6b6e 6f74 5d2c 206e 756d 3d5b  y, [knot], num=[
+0002c290: 6e75 6d5d 290a 2020 2020 2020 2020 7265  num]).        re
+0002c2a0: 7475 726e 2073 656c 662e 6672 6f6d 5f67  turn self.from_g
+0002c2b0: 656f 6d64 6c5f 6375 7276 6528 6d6f 6469  eomdl_curve(modi
+0002c2c0: 6669 6564 5f63 7572 7665 290a 0a20 2020  fied_curve)..   
+0002c2d0: 2023 2043 6f70 7920 7061 7374 6520 6475   # Copy paste du
+0002c2e0: 204c 696e 6553 6567 6d65 6e74 3344 0a20   LineSegment3D. 
+0002c2f0: 2020 2064 6566 2070 6c6f 7428 7365 6c66     def plot(self
+0002c300: 2c20 6178 3d4e 6f6e 652c 2063 6f6c 6f72  , ax=None, color
+0002c310: 3d27 6b27 2c20 616c 7068 613d 312c 2065  ='k', alpha=1, e
+0002c320: 6467 655f 656e 6473 3d46 616c 7365 2c20  dge_ends=False, 
+0002c330: 6564 6765 5f64 6972 6563 7469 6f6e 3d46  edge_direction=F
+0002c340: 616c 7365 293a 0a20 2020 2020 2020 2069  alse):.        i
+0002c350: 6620 6178 2069 7320 4e6f 6e65 3a0a 2020  f ax is None:.  
+0002c360: 2020 2020 2020 2020 2020 6669 6720 3d20            fig = 
+0002c370: 706c 742e 6669 6775 7265 2829 0a20 2020  plt.figure().   
+0002c380: 2020 2020 2020 2020 2061 7820 3d20 6669           ax = fi
+0002c390: 672e 6164 645f 7375 6270 6c6f 7428 3131  g.add_subplot(11
+0002c3a0: 312c 2070 726f 6a65 6374 696f 6e3d 2733  1, projection='3
+0002c3b0: 6427 290a 2020 2020 2020 2020 656c 7365  d').        else
+0002c3c0: 3a0a 2020 2020 2020 2020 2020 2020 6669  :.            fi
+0002c3d0: 6720 3d20 6178 2e66 6967 7572 650a 0a20  g = ax.figure.. 
+0002c3e0: 2020 2020 2020 2078 203d 205b 702e 7820         x = [p.x 
+0002c3f0: 666f 7220 7020 696e 2073 656c 662e 706f  for p in self.po
+0002c400: 696e 7473 5d0a 2020 2020 2020 2020 7920  ints].        y 
+0002c410: 3d20 5b70 2e79 2066 6f72 2070 2069 6e20  = [p.y for p in 
+0002c420: 7365 6c66 2e70 6f69 6e74 735d 0a20 2020  self.points].   
+0002c430: 2020 2020 207a 203d 205b 702e 7a20 666f       z = [p.z fo
+0002c440: 7220 7020 696e 2073 656c 662e 706f 696e  r p in self.poin
+0002c450: 7473 5d0a 2020 2020 2020 2020 6178 2e70  ts].        ax.p
+0002c460: 6c6f 7428 782c 2079 2c20 7a2c 2063 6f6c  lot(x, y, z, col
+0002c470: 6f72 3d63 6f6c 6f72 2c20 616c 7068 613d  or=color, alpha=
+0002c480: 616c 7068 6129 0a20 2020 2020 2020 2069  alpha).        i
+0002c490: 6620 6564 6765 5f65 6e64 733a 0a20 2020  f edge_ends:.   
+0002c4a0: 2020 2020 2020 2020 2061 782e 706c 6f74           ax.plot
+0002c4b0: 2878 2c20 792c 207a 2c20 276f 272c 2063  (x, y, z, 'o', c
+0002c4c0: 6f6c 6f72 3d63 6f6c 6f72 2c20 616c 7068  olor=color, alph
+0002c4d0: 613d 616c 7068 6129 0a20 2020 2020 2020  a=alpha).       
+0002c4e0: 2072 6574 7572 6e20 6178 0a0a 2020 2020   return ax..    
+0002c4f0: 6465 6620 746f 5f32 6428 7365 6c66 2c20  def to_2d(self, 
+0002c500: 706c 616e 655f 6f72 6967 696e 2c20 782c  plane_origin, x,
+0002c510: 2079 293a 0a20 2020 2020 2020 2022 2222   y):.        """
+0002c520: 0a20 2020 2020 2020 2054 7261 6e73 666f  .        Transfo
+0002c530: 726d 7320 6120 4253 706c 696e 6543 7572  rms a BSplineCur
+0002c540: 7665 3344 2069 6e74 6f20 616e 2042 5370  ve3D into an BSp
+0002c550: 6c69 6e65 4375 7276 6532 442c 2067 6976  lineCurve2D, giv
+0002c560: 656e 2061 6e20 706c 616e 6520 6f72 6967  en an plane orig
+0002c570: 696e 2061 6e64 2061 2075 2061 6e64 2076  in and a u and v
+0002c580: 2070 6c61 6e65 2076 6563 746f 722e 0a0a   plane vector...
+0002c590: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0002c5a0: 6c61 6e65 5f6f 7269 6769 6e3a 2070 6c61  lane_origin: pla
+0002c5b0: 6e65 206f 7269 6769 6e2e 0a20 2020 2020  ne origin..     
+0002c5c0: 2020 203a 7061 7261 6d20 783a 2070 6c61     :param x: pla
+0002c5d0: 6e65 2075 2076 6563 746f 722e 0a20 2020  ne u vector..   
+0002c5e0: 2020 2020 203a 7061 7261 6d20 793a 2070       :param y: p
+0002c5f0: 6c61 6e65 2076 2076 6563 746f 722e 0a20  lane v vector.. 
+0002c600: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+0002c610: 4253 706c 696e 6543 7572 7665 3244 2e0a  BSplineCurve2D..
+0002c620: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002c630: 2020 2020 636f 6e74 726f 6c5f 706f 696e      control_poin
+0002c640: 7473 3264 203d 205b 702e 746f 5f32 6428  ts2d = [p.to_2d(
+0002c650: 706c 616e 655f 6f72 6967 696e 2c20 782c  plane_origin, x,
+0002c660: 2079 2920 666f 7220 7020 696e 0a20 2020   y) for p in.   
+0002c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c680: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
+0002c690: 6e74 726f 6c5f 706f 696e 7473 5d0a 2020  ntrol_points].  
+0002c6a0: 2020 2020 2020 7265 7475 726e 2042 5370        return BSp
+0002c6b0: 6c69 6e65 4375 7276 6532 4428 7365 6c66  lineCurve2D(self
+0002c6c0: 2e64 6567 7265 652c 2063 6f6e 7472 6f6c  .degree, control
+0002c6d0: 5f70 6f69 6e74 7332 642c 0a20 2020 2020  _points2d,.     
+0002c6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c6f0: 2020 2020 2020 2020 2073 656c 662e 6b6e           self.kn
+0002c700: 6f74 5f6d 756c 7469 706c 6963 6974 6965  ot_multiplicitie
+0002c710: 732c 2073 656c 662e 6b6e 6f74 732c 0a20  s, self.knots,. 
+0002c720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c730: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0002c740: 662e 7765 6967 6874 732c 2073 656c 662e  f.weights, self.
+0002c750: 7065 7269 6f64 6963 2c20 7365 6c66 2e6e  periodic, self.n
+0002c760: 616d 6529 0a0a 2020 2020 6465 6620 706f  ame)..    def po
+0002c770: 6c79 676f 6e5f 706f 696e 7473 2873 656c  lygon_points(sel
+0002c780: 662c 2064 6973 6372 6574 697a 6174 696f  f, discretizatio
+0002c790: 6e5f 7265 736f 6c75 7469 6f6e 3a20 696e  n_resolution: in
+0002c7a0: 7429 3a0a 2020 2020 2020 2020 7761 726e  t):.        warn
+0002c7b0: 696e 6773 2e77 6172 6e28 2770 6f6c 7967  ings.warn('polyg
+0002c7c0: 6f6e 5f70 6f69 6e74 7320 6973 2064 6570  on_points is dep
+0002c7d0: 7265 6361 7465 642c 5c0a 2020 2020 2020  recated,\.      
+0002c7e0: 2020 2020 2020 2020 2020 706c 6561 7365            please
+0002c7f0: 2075 7365 2064 6973 6372 6574 697a 6174   use discretizat
+0002c800: 696f 6e5f 706f 696e 7473 2069 6e73 7465  ion_points inste
+0002c810: 6164 272c 0a20 2020 2020 2020 2020 2020  ad',.           
+0002c820: 2020 2020 2020 2020 2020 2044 6570 7265             Depre
+0002c830: 6361 7469 6f6e 5761 726e 696e 6729 0a20  cationWarning). 
+0002c840: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0002c850: 6c66 2e64 6973 6372 6574 697a 6174 696f  lf.discretizatio
+0002c860: 6e5f 706f 696e 7473 2861 6e67 6c65 5f72  n_points(angle_r
+0002c870: 6573 6f6c 7574 696f 6e3d 6469 7363 7265  esolution=discre
+0002c880: 7469 7a61 7469 6f6e 5f72 6573 6f6c 7574  tization_resolut
+0002c890: 696f 6e29 0a0a 2020 2020 6465 6620 6375  ion)..    def cu
+0002c8a0: 7276 6174 7572 6528 7365 6c66 2c20 753a  rvature(self, u:
+0002c8b0: 2066 6c6f 6174 2c20 706f 696e 745f 696e   float, point_in
+0002c8c0: 5f63 7572 7665 3a20 626f 6f6c 203d 2046  _curve: bool = F
+0002c8d0: 616c 7365 293a 0a20 2020 2020 2020 2023  alse):.        #
+0002c8e0: 2075 2073 686f 756c 6420 6265 2069 6e20   u should be in 
+0002c8f0: 7468 6520 696e 7465 7276 616c 205b 302c  the interval [0,
+0002c900: 315d 0a20 2020 2020 2020 2064 6572 7320  1].        ders 
+0002c910: 3d20 7365 6c66 2e64 6572 6976 6174 6976  = self.derivativ
+0002c920: 6573 2875 2c20 3329 2020 2320 3320 6669  es(u, 3)  # 3 fi
+0002c930: 7273 7420 6465 7269 7661 7469 7665 0a20  rst derivative. 
+0002c940: 2020 2020 2020 2063 312c 2063 3220 3d20         c1, c2 = 
+0002c950: 6465 7273 5b31 5d2c 2064 6572 735b 325d  ders[1], ders[2]
+0002c960: 0a20 2020 2020 2020 2064 656e 6f6d 203d  .        denom =
+0002c970: 2063 312e 6372 6f73 7328 6332 290a 2020   c1.cross(c2).  
+0002c980: 2020 2020 2020 6966 2063 3120 3d3d 2076        if c1 == v
+0002c990: 6f6c 6d64 6c72 2e4f 3344 206f 7220 6332  olmdlr.O3D or c2
+0002c9a0: 203d 3d20 766f 6c6d 646c 722e 4f33 4420   == volmdlr.O3D 
+0002c9b0: 6f72 2064 656e 6f6d 2e6e 6f72 6d28 2920  or denom.norm() 
+0002c9c0: 3d3d 2030 2e30 3a0a 2020 2020 2020 2020  == 0.0:.        
+0002c9d0: 2020 2020 6966 2070 6f69 6e74 5f69 6e5f      if point_in_
+0002c9e0: 6375 7276 653a 0a20 2020 2020 2020 2020  curve:.         
+0002c9f0: 2020 2020 2020 2072 6574 7572 6e20 302e         return 0.
+0002ca00: 2c20 766f 6c6d 646c 722e 506f 696e 7433  , volmdlr.Point3
+0002ca10: 4428 2a64 6572 735b 305d 290a 2020 2020  D(*ders[0]).    
+0002ca20: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
+0002ca30: 2e0a 2020 2020 2020 2020 725f 6320 3d20  ..        r_c = 
+0002ca40: 2828 6331 2e6e 6f72 6d28 2929 202a 2a20  ((c1.norm()) ** 
+0002ca50: 3329 202f 2064 656e 6f6d 2e6e 6f72 6d28  3) / denom.norm(
+0002ca60: 290a 2020 2020 2020 2020 706f 696e 7420  ).        point 
+0002ca70: 3d20 766f 6c6d 646c 722e 506f 696e 7433  = volmdlr.Point3
+0002ca80: 4428 2a64 6572 735b 305d 290a 2020 2020  D(*ders[0]).    
+0002ca90: 2020 2020 6966 2070 6f69 6e74 5f69 6e5f      if point_in_
+0002caa0: 6375 7276 653a 0a20 2020 2020 2020 2020  curve:.         
+0002cab0: 2020 2072 6574 7572 6e20 3120 2f20 725f     return 1 / r_
+0002cac0: 632c 2070 6f69 6e74 0a20 2020 2020 2020  c, point.       
+0002cad0: 2072 6574 7572 6e20 3120 2f20 725f 630a   return 1 / r_c.
+0002cae0: 0a20 2020 2064 6566 2067 6c6f 6261 6c5f  .    def global_
+0002caf0: 6d61 7869 6d75 6d5f 6375 7276 6174 7572  maximum_curvatur
+0002cb00: 6528 7365 6c66 2c20 6e62 5f65 7661 6c3a  e(self, nb_eval:
+0002cb10: 2069 6e74 203d 2032 312c 2070 6f69 6e74   int = 21, point
+0002cb20: 5f69 6e5f 6375 7276 653a 2062 6f6f 6c20  _in_curve: bool 
+0002cb30: 3d20 4661 6c73 6529 3a0a 2020 2020 2020  = False):.      
+0002cb40: 2020 6368 6563 6b20 3d20 5b69 202f 2028    check = [i / (
+0002cb50: 6e62 5f65 7661 6c20 2d20 3129 2066 6f72  nb_eval - 1) for
+0002cb60: 2069 2069 6e20 7261 6e67 6528 6e62 5f65   i in range(nb_e
+0002cb70: 7661 6c29 5d0a 2020 2020 2020 2020 6375  val)].        cu
+0002cb80: 7276 6174 7572 6573 203d 205b 5d0a 2020  rvatures = [].  
+0002cb90: 2020 2020 2020 666f 7220 7520 696e 2063        for u in c
+0002cba0: 6865 636b 3a0a 2020 2020 2020 2020 2020  heck:.          
+0002cbb0: 2020 6375 7276 6174 7572 6573 2e61 7070    curvatures.app
+0002cbc0: 656e 6428 7365 6c66 2e63 7572 7661 7475  end(self.curvatu
+0002cbd0: 7265 2875 2c20 706f 696e 745f 696e 5f63  re(u, point_in_c
+0002cbe0: 7572 7665 2929 0a20 2020 2020 2020 2072  urve)).        r
+0002cbf0: 6574 7572 6e20 6375 7276 6174 7572 6573  eturn curvatures
+0002cc00: 0a0a 2020 2020 6465 6620 6d61 7869 6d75  ..    def maximu
+0002cc10: 6d5f 6375 7276 6174 7572 6528 7365 6c66  m_curvature(self
+0002cc20: 2c20 706f 696e 745f 696e 5f63 7572 7665  , point_in_curve
+0002cc30: 3a20 626f 6f6c 203d 2046 616c 7365 293a  : bool = False):
+0002cc40: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002cc50: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
+0002cc60: 206d 6178 696d 756d 2063 7572 7661 7475   maximum curvatu
+0002cc70: 7265 206f 6620 6120 6375 7276 6520 616e  re of a curve an
+0002cc80: 6420 7468 6520 706f 696e 7420 7768 6572  d the point wher
+0002cc90: 6520 6974 2069 7320 6c6f 6361 7465 642e  e it is located.
+0002cca0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002ccb0: 2020 2020 2069 6620 706f 696e 745f 696e       if point_in
+0002ccc0: 5f63 7572 7665 3a0a 2020 2020 2020 2020  _curve:.        
+0002ccd0: 2020 2020 6d61 7869 6d75 6d5f 6375 7276      maximum_curv
+0002cce0: 6172 7475 7265 2c20 706f 696e 7420 3d20  arture, point = 
+0002ccf0: 6d61 7828 7365 6c66 2e67 6c6f 6261 6c5f  max(self.global_
+0002cd00: 6d61 7869 6d75 6d5f 6375 7276 6174 7572  maximum_curvatur
+0002cd10: 6528 6e62 5f65 7661 6c3d 3231 2c20 706f  e(nb_eval=21, po
+0002cd20: 696e 745f 696e 5f63 7572 7665 3d70 6f69  int_in_curve=poi
+0002cd30: 6e74 5f69 6e5f 6375 7276 6529 290a 2020  nt_in_curve)).  
+0002cd40: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0002cd50: 206d 6178 696d 756d 5f63 7572 7661 7274   maximum_curvart
+0002cd60: 7572 652c 2070 6f69 6e74 0a20 2020 2020  ure, point.     
+0002cd70: 2020 2023 2070 7269 6e74 2873 656c 662e     # print(self.
+0002cd80: 676c 6f62 616c 5f6d 6178 696d 756d 5f63  global_maximum_c
+0002cd90: 7572 7661 7475 7265 2870 6f69 6e74 5f69  urvature(point_i
+0002cda0: 6e5f 6375 7276 6529 290a 2020 2020 2020  n_curve)).      
+0002cdb0: 2020 6d61 7869 6d75 6d5f 6375 7276 6172    maximum_curvar
+0002cdc0: 7475 7265 203d 206d 6178 2873 656c 662e  ture = max(self.
+0002cdd0: 676c 6f62 616c 5f6d 6178 696d 756d 5f63  global_maximum_c
+0002cde0: 7572 7661 7475 7265 286e 625f 6576 616c  urvature(nb_eval
+0002cdf0: 3d32 312c 2070 6f69 6e74 5f69 6e5f 6375  =21, point_in_cu
+0002ce00: 7276 653d 706f 696e 745f 696e 5f63 7572  rve=point_in_cur
+0002ce10: 7665 2929 0a20 2020 2020 2020 2072 6574  ve)).        ret
+0002ce20: 7572 6e20 6d61 7869 6d75 6d5f 6375 7276  urn maximum_curv
+0002ce30: 6172 7475 7265 0a0a 2020 2020 6465 6620  arture..    def 
+0002ce40: 6d69 6e69 6d75 6d5f 7261 6469 7573 2873  minimum_radius(s
+0002ce50: 656c 662c 2070 6f69 6e74 5f69 6e5f 6375  elf, point_in_cu
+0002ce60: 7276 653d 4661 6c73 6529 3a0a 2020 2020  rve=False):.    
+0002ce70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0002ce80: 5265 7475 726e 7320 7468 6520 6d69 6e69  Returns the mini
+0002ce90: 6d75 6d20 6375 7276 6174 7572 6520 7261  mum curvature ra
+0002cea0: 6469 7573 206f 6620 6120 6375 7276 6520  dius of a curve 
+0002ceb0: 616e 6420 7468 6520 706f 696e 7420 7768  and the point wh
+0002cec0: 6572 6520 6974 2069 7320 6c6f 6361 7465  ere it is locate
+0002ced0: 642e 0a20 2020 2020 2020 2022 2222 0a20  d..        """. 
+0002cee0: 2020 2020 2020 2069 6620 706f 696e 745f         if point_
+0002cef0: 696e 5f63 7572 7665 3a0a 2020 2020 2020  in_curve:.      
+0002cf00: 2020 2020 2020 6d61 7869 6d75 6d5f 6375        maximum_cu
+0002cf10: 7276 6172 7475 7265 2c20 706f 696e 7420  rvarture, point 
+0002cf20: 3d20 7365 6c66 2e6d 6178 696d 756d 5f63  = self.maximum_c
+0002cf30: 7572 7661 7475 7265 2870 6f69 6e74 5f69  urvature(point_i
+0002cf40: 6e5f 6375 7276 6529 0a20 2020 2020 2020  n_curve).       
+0002cf50: 2020 2020 2072 6574 7572 6e20 3120 2f20       return 1 / 
+0002cf60: 6d61 7869 6d75 6d5f 6375 7276 6172 7475  maximum_curvartu
+0002cf70: 7265 2c20 706f 696e 740a 2020 2020 2020  re, point.      
+0002cf80: 2020 6d61 7869 6d75 6d5f 6375 7276 6172    maximum_curvar
+0002cf90: 7475 7265 203d 2073 656c 662e 6d61 7869  ture = self.maxi
+0002cfa0: 6d75 6d5f 6375 7276 6174 7572 6528 706f  mum_curvature(po
+0002cfb0: 696e 745f 696e 5f63 7572 7665 290a 2020  int_in_curve).  
+0002cfc0: 2020 2020 2020 7265 7475 726e 2031 202f        return 1 /
+0002cfd0: 206d 6178 696d 756d 5f63 7572 7661 7274   maximum_curvart
+0002cfe0: 7572 650a 0a20 2020 2064 6566 2067 6c6f  ure..    def glo
+0002cff0: 6261 6c5f 6d69 6e69 6d75 6d5f 6375 7276  bal_minimum_curv
+0002d000: 6174 7572 6528 7365 6c66 2c20 6e62 5f65  ature(self, nb_e
+0002d010: 7661 6c3a 2069 6e74 203d 2032 3129 3a0a  val: int = 21):.
+0002d020: 2020 2020 2020 2020 6368 6563 6b20 3d20          check = 
+0002d030: 5b69 202f 2028 6e62 5f65 7661 6c20 2d20  [i / (nb_eval - 
+0002d040: 3129 2066 6f72 2069 2069 6e20 7261 6e67  1) for i in rang
+0002d050: 6528 6e62 5f65 7661 6c29 5d0a 2020 2020  e(nb_eval)].    
+0002d060: 2020 2020 7261 6469 7573 203d 205b 5d0a      radius = [].
+0002d070: 2020 2020 2020 2020 666f 7220 7520 696e          for u in
+0002d080: 2063 6865 636b 3a0a 2020 2020 2020 2020   check:.        
+0002d090: 2020 2020 7261 6469 7573 2e61 7070 656e      radius.appen
+0002d0a0: 6428 7365 6c66 2e6d 696e 696d 756d 5f63  d(self.minimum_c
+0002d0b0: 7572 7661 7475 7265 2875 2929 0a20 2020  urvature(u)).   
+0002d0c0: 2020 2020 2072 6574 7572 6e20 7261 6469       return radi
+0002d0d0: 7573 0a0a 2020 2020 6465 6620 7472 6961  us..    def tria
+0002d0e0: 6e67 756c 6174 696f 6e28 7365 6c66 293a  ngulation(self):
+0002d0f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002d100: 4e6f 6e65 0a0a 2020 2020 6465 6620 6c69  None..    def li
+0002d110: 6e65 7365 676d 656e 745f 696e 7465 7273  nesegment_inters
+0002d120: 6563 7469 6f6e 7328 7365 6c66 2c20 6c69  ections(self, li
+0002d130: 6e65 7365 676d 656e 7433 643a 204c 696e  nesegment3d: Lin
+0002d140: 6553 6567 6d65 6e74 3344 293a 0a20 2020  eSegment3D):.   
+0002d150: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0002d160: 2043 616c 6375 6c61 7465 7320 696e 7465   Calculates inte
+0002d170: 7273 6563 7469 6f6e 7320 6265 7477 6565  rsections betwee
+0002d180: 6e20 6120 4253 706c 696e 6543 7572 7665  n a BSplineCurve
+0002d190: 3344 2061 6e64 2061 204c 696e 6553 6567  3D and a LineSeg
+0002d1a0: 6d65 6e74 3344 2e0a 0a20 2020 2020 2020  ment3D...       
+0002d1b0: 203a 7061 7261 6d20 6c69 6e65 7365 676d   :param linesegm
+0002d1c0: 656e 7433 643a 206c 696e 6573 6567 6d65  ent3d: linesegme
+0002d1d0: 6e74 2074 6f20 7665 7269 6679 2069 6e74  nt to verify int
+0002d1e0: 6572 7365 6374 696f 6e73 2e0a 2020 2020  ersections..    
+0002d1f0: 2020 2020 3a72 6574 7572 6e3a 206c 6973      :return: lis
+0002d200: 7420 7769 7468 2074 6865 2069 6e74 6572  t with the inter
+0002d210: 7365 6374 696f 6e73 2070 6f69 6e74 732e  sections points.
+0002d220: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002d230: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0002d240: 2e62 6f75 6e64 696e 675f 626f 782e 6262  .bounding_box.bb
+0002d250: 6f78 5f69 6e74 6572 7365 6374 696f 6e28  ox_intersection(
+0002d260: 6c69 6e65 7365 676d 656e 7433 642e 626f  linesegment3d.bo
+0002d270: 756e 6469 6e67 5f62 6f78 293a 0a20 2020  unding_box):.   
+0002d280: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0002d290: 5b5d 0a20 2020 2020 2020 2069 6e74 6572  [].        inter
+0002d2a0: 7365 6374 696f 6e73 5f70 6f69 6e74 7320  sections_points 
+0002d2b0: 3d20 7365 6c66 2e67 6574 5f6c 696e 6573  = self.get_lines
+0002d2c0: 6567 6d65 6e74 5f69 6e74 6572 7365 6374  egment_intersect
+0002d2d0: 696f 6e73 286c 696e 6573 6567 6d65 6e74  ions(linesegment
+0002d2e0: 3364 290a 2020 2020 2020 2020 7265 7475  3d).        retu
+0002d2f0: 726e 2069 6e74 6572 7365 6374 696f 6e73  rn intersections
+0002d300: 5f70 6f69 6e74 730a 0a0a 636c 6173 7320  _points...class 
+0002d310: 4265 7a69 6572 4375 7276 6533 4428 4253  BezierCurve3D(BS
+0002d320: 706c 696e 6543 7572 7665 3344 293a 0a20  plineCurve3D):. 
+0002d330: 2020 2022 2222 0a20 2020 2041 2063 6c61     """.    A cla
+0002d340: 7373 2066 6f72 2033 2064 696d 656e 7369  ss for 3 dimensi
+0002d350: 6f6e 616c 2042 657a 6965 7220 6375 7276  onal Bezier curv
+0002d360: 6573 2e0a 0a20 2020 203a 7061 7261 6d20  es...    :param 
+0002d370: 6465 6772 6565 3a20 5468 6520 6465 6772  degree: The degr
+0002d380: 6565 206f 6620 7468 6520 4265 7a69 6572  ee of the Bezier
+0002d390: 2063 7572 7665 0a20 2020 203a 7479 7065   curve.    :type
+0002d3a0: 2064 6567 7265 653a 2069 6e74 0a20 2020   degree: int.   
+0002d3b0: 203a 7061 7261 6d20 636f 6e74 726f 6c5f   :param control_
+0002d3c0: 706f 696e 7473 3a20 4120 6c69 7374 206f  points: A list o
+0002d3d0: 6620 3320 6469 6d65 6e73 696f 6e61 6c20  f 3 dimensional 
+0002d3e0: 706f 696e 7473 0a20 2020 203a 7479 7065  points.    :type
+0002d3f0: 2063 6f6e 7472 6f6c 5f70 6f69 6e74 733a   control_points:
+0002d400: 204c 6973 745b 3a63 6c61 7373 3a60 766f   List[:class:`vo
+0002d410: 6c6d 646c 722e 506f 696e 7433 4460 5d0a  lmdlr.Point3D`].
+0002d420: 2020 2020 3a70 6172 616d 206e 616d 653a      :param name:
+0002d430: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
+0002d440: 2042 2d73 706c 696e 6520 6375 7276 652e   B-spline curve.
+0002d450: 2044 6566 6175 6c74 2076 616c 7565 2069   Default value i
+0002d460: 7320 2727 0a20 2020 203a 7479 7065 206e  s ''.    :type n
+0002d470: 616d 653a 2073 7472 2c20 6f70 7469 6f6e  ame: str, option
+0002d480: 616c 0a20 2020 2022 2222 0a0a 2020 2020  al.    """..    
+0002d490: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+0002d4a0: 662c 2064 6567 7265 653a 2069 6e74 2c20  f, degree: int, 
+0002d4b0: 636f 6e74 726f 6c5f 706f 696e 7473 3a20  control_points: 
+0002d4c0: 4c69 7374 5b76 6f6c 6d64 6c72 2e50 6f69  List[volmdlr.Poi
+0002d4d0: 6e74 3344 5d2c 0a20 2020 2020 2020 2020  nt3D],.         
+0002d4e0: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+0002d4f0: 7220 3d20 2727 293a 0a20 2020 2020 2020  r = ''):.       
+0002d500: 206b 6e6f 7476 6563 746f 7220 3d20 7574   knotvector = ut
+0002d510: 696c 6974 6965 732e 6765 6e65 7261 7465  ilities.generate
+0002d520: 5f6b 6e6f 745f 7665 6374 6f72 2864 6567  _knot_vector(deg
+0002d530: 7265 652c 0a20 2020 2020 2020 2020 2020  ree,.           
+0002d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d560: 2020 2020 2020 2020 206c 656e 2863 6f6e           len(con
+0002d570: 7472 6f6c 5f70 6f69 6e74 7329 290a 2020  trol_points)).  
+0002d580: 2020 2020 2020 6b6e 6f74 5f6d 756c 7469        knot_multi
+0002d590: 706c 6963 6974 7920 3d20 5b31 5d20 2a20  plicity = [1] * 
+0002d5a0: 6c65 6e28 6b6e 6f74 7665 6374 6f72 290a  len(knotvector).
+0002d5b0: 0a20 2020 2020 2020 2042 5370 6c69 6e65  .        BSpline
+0002d5c0: 4375 7276 6533 442e 5f5f 696e 6974 5f5f  Curve3D.__init__
+0002d5d0: 2873 656c 662c 2064 6567 7265 652c 2063  (self, degree, c
+0002d5e0: 6f6e 7472 6f6c 5f70 6f69 6e74 732c 0a20  ontrol_points,. 
+0002d5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d600: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+0002d610: 6e6f 745f 6d75 6c74 6970 6c69 6369 7479  not_multiplicity
+0002d620: 2c20 6b6e 6f74 7665 6374 6f72 2c0a 2020  , knotvector,.  
+0002d630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d640: 2020 2020 2020 2020 2020 2020 2020 4e6f                No
+0002d650: 6e65 2c20 4661 6c73 652c 206e 616d 6529  ne, False, name)
+0002d660: 0a0a 0a63 6c61 7373 2041 7263 3344 2841  ...class Arc3D(A
+0002d670: 7263 293a 0a20 2020 2022 2222 0a20 2020  rc):.    """.   
+0002d680: 2041 6e20 6172 6320 6973 2064 6566 696e   An arc is defin
+0002d690: 6564 2062 7920 6120 7374 6172 7469 6e67  ed by a starting
+0002d6a0: 2070 6f69 6e74 2c20 616e 2065 6e64 2070   point, an end p
+0002d6b0: 6f69 6e74 2061 6e64 2061 6e20 696e 7465  oint and an inte
+0002d6c0: 7269 6f72 2070 6f69 6e74 2e0a 0a20 2020  rior point...   
+0002d6d0: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
+0002d6e0: 696e 6974 5f5f 2873 656c 662c 2073 7461  init__(self, sta
+0002d6f0: 7274 2c20 696e 7465 7269 6f72 2c20 656e  rt, interior, en
+0002d700: 642c 206e 616d 653d 2727 293a 0a20 2020  d, name=''):.   
+0002d710: 2020 2020 2073 656c 662e 5f75 7464 5f6e       self._utd_n
+0002d720: 6f72 6d61 6c20 3d20 4661 6c73 650a 2020  ormal = False.  
+0002d730: 2020 2020 2020 7365 6c66 2e5f 7574 645f        self._utd_
+0002d740: 6365 6e74 6572 203d 2046 616c 7365 0a20  center = False. 
+0002d750: 2020 2020 2020 2073 656c 662e 5f75 7464         self._utd
+0002d760: 5f66 7261 6d65 203d 2046 616c 7365 0a20  _frame = False. 
+0002d770: 2020 2020 2020 2073 656c 662e 5f75 7464         self._utd
+0002d780: 5f69 735f 7472 6967 6f20 3d20 4661 6c73  _is_trigo = Fals
+0002d790: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+0002d7a0: 7574 645f 616e 676c 6520 3d20 4661 6c73  utd_angle = Fals
+0002d7b0: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+0002d7c0: 6e6f 726d 616c 203d 204e 6f6e 650a 2020  normal = None.  
+0002d7d0: 2020 2020 2020 7365 6c66 2e5f 6672 616d        self._fram
+0002d7e0: 6520 3d20 4e6f 6e65 0a20 2020 2020 2020  e = None.       
+0002d7f0: 2073 656c 662e 5f63 656e 7465 7220 3d20   self._center = 
+0002d800: 4e6f 6e65 0a20 2020 2020 2020 2073 656c  None.        sel
+0002d810: 662e 5f69 735f 7472 6967 6f20 3d20 4e6f  f._is_trigo = No
+0002d820: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
+0002d830: 5f61 6e67 6c65 203d 204e 6f6e 650a 2020  _angle = None.  
+0002d840: 2020 2020 2020 2320 7365 6c66 2e5f 7574        # self._ut
+0002d850: 645f 636c 6f63 6b77 6973 655f 616e 645f  d_clockwise_and_
+0002d860: 7472 6967 6f77 6973 655f 7061 7468 7320  trigowise_paths 
+0002d870: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+0002d880: 4172 632e 5f5f 696e 6974 5f5f 2873 656c  Arc.__init__(sel
+0002d890: 662c 2073 7461 7274 3d73 7461 7274 2c20  f, start=start, 
+0002d8a0: 656e 643d 656e 642c 2069 6e74 6572 696f  end=end, interio
+0002d8b0: 723d 696e 7465 7269 6f72 2c20 6e61 6d65  r=interior, name
+0002d8c0: 3d6e 616d 6529 0a20 2020 2020 2020 2073  =name).        s
+0002d8d0: 656c 662e 5f62 626f 7820 3d20 4e6f 6e65  elf._bbox = None
+0002d8e0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0002d8f0: 2020 2020 6465 6620 626f 756e 6469 6e67      def bounding
+0002d900: 5f62 6f78 2873 656c 6629 3a0a 2020 2020  _box(self):.    
+0002d910: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+0002d920: 5f62 626f 783a 0a20 2020 2020 2020 2020  _bbox:.         
+0002d930: 2020 2073 656c 662e 5f62 626f 7820 3d20     self._bbox = 
+0002d940: 7365 6c66 2e67 6574 5f62 6f75 6e64 696e  self.get_boundin
+0002d950: 675f 626f 7828 290a 2020 2020 2020 2020  g_box().        
+0002d960: 7265 7475 726e 2073 656c 662e 5f62 626f  return self._bbo
+0002d970: 780a 0a20 2020 2040 626f 756e 6469 6e67  x..    @bounding
+0002d980: 5f62 6f78 2e73 6574 7465 720a 2020 2020  _box.setter.    
+0002d990: 6465 6620 626f 756e 6469 6e67 5f62 6f78  def bounding_box
+0002d9a0: 2873 656c 662c 206e 6577 5f62 6f75 6e64  (self, new_bound
+0002d9b0: 696e 675f 626f 7829 3a0a 2020 2020 2020  ing_box):.      
+0002d9c0: 2020 7365 6c66 2e5f 6262 6f78 203d 206e    self._bbox = n
+0002d9d0: 6577 5f62 6f75 6e64 696e 675f 626f 780a  ew_bounding_box.
+0002d9e0: 0a20 2020 2064 6566 2067 6574 5f62 6f75  .    def get_bou
+0002d9f0: 6e64 696e 675f 626f 7828 7365 6c66 293a  nding_box(self):
+0002da00: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002da10: 2020 2020 2043 616c 6375 6c61 7465 7320       Calculates 
+0002da20: 7468 6520 626f 756e 6469 6e67 2062 6f78  the bounding box
+0002da30: 206f 6620 7468 6520 4172 6333 442e 0a0a   of the Arc3D...
+0002da40: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+0002da50: 2061 2076 6f6c 6d64 6c72 2e63 6f72 652e   a volmdlr.core.
+0002da60: 426f 756e 6469 6e67 426f 7820 6f62 6a65  BoundingBox obje
+0002da70: 6374 2e0a 2020 2020 2020 2020 2222 220a  ct..        """.
+0002da80: 2020 2020 2020 2020 2320 544f 444f 3a20          # TODO: 
+0002da90: 696d 706c 656d 656e 7420 6578 6163 7420  implement exact 
+0002daa0: 6361 6c63 756c 6174 696f 6e0a 0a20 2020  calculation..   
+0002dab0: 2020 2020 2070 6f69 6e74 7320 3d20 7365       points = se
+0002dac0: 6c66 2e64 6973 6372 6574 697a 6174 696f  lf.discretizatio
+0002dad0: 6e5f 706f 696e 7473 2861 6e67 6c65 5f72  n_points(angle_r
+0002dae0: 6573 6f6c 7574 696f 6e3d 3130 290a 2020  esolution=10).  
+0002daf0: 2020 2020 2020 786d 696e 203d 206d 696e        xmin = min
+0002db00: 2870 6f69 6e74 2e78 2066 6f72 2070 6f69  (point.x for poi
+0002db10: 6e74 2069 6e20 706f 696e 7473 290a 2020  nt in points).  
+0002db20: 2020 2020 2020 786d 6178 203d 206d 6178        xmax = max
+0002db30: 2870 6f69 6e74 2e78 2066 6f72 2070 6f69  (point.x for poi
+0002db40: 6e74 2069 6e20 706f 696e 7473 290a 2020  nt in points).  
+0002db50: 2020 2020 2020 796d 696e 203d 206d 696e        ymin = min
+0002db60: 2870 6f69 6e74 2e79 2066 6f72 2070 6f69  (point.y for poi
+0002db70: 6e74 2069 6e20 706f 696e 7473 290a 2020  nt in points).  
+0002db80: 2020 2020 2020 796d 6178 203d 206d 6178        ymax = max
+0002db90: 2870 6f69 6e74 2e79 2066 6f72 2070 6f69  (point.y for poi
+0002dba0: 6e74 2069 6e20 706f 696e 7473 290a 2020  nt in points).  
+0002dbb0: 2020 2020 2020 7a6d 696e 203d 206d 696e        zmin = min
+0002dbc0: 2870 6f69 6e74 2e7a 2066 6f72 2070 6f69  (point.z for poi
+0002dbd0: 6e74 2069 6e20 706f 696e 7473 290a 2020  nt in points).  
+0002dbe0: 2020 2020 2020 7a6d 6178 203d 206d 6178        zmax = max
+0002dbf0: 2870 6f69 6e74 2e7a 2066 6f72 2070 6f69  (point.z for poi
+0002dc00: 6e74 2069 6e20 706f 696e 7473 290a 2020  nt in points).  
+0002dc10: 2020 2020 2020 7265 7475 726e 2076 6f6c        return vol
+0002dc20: 6d64 6c72 2e63 6f72 652e 426f 756e 6469  mdlr.core.Boundi
+0002dc30: 6e67 426f 7828 786d 696e 2c20 786d 6178  ngBox(xmin, xmax
+0002dc40: 2c20 796d 696e 2c20 796d 6178 2c20 7a6d  , ymin, ymax, zm
+0002dc50: 696e 2c20 7a6d 6178 290a 0a20 2020 2040  in, zmax)..    @
+0002dc60: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
+0002dc70: 6465 6620 6672 6f6d 5f61 6e67 6c65 2863  def from_angle(c
+0002dc80: 6c73 2c20 7374 6172 743a 2076 6f6c 6d64  ls, start: volmd
+0002dc90: 6c72 2e50 6f69 6e74 3344 2c20 616e 676c  lr.Point3D, angl
+0002dca0: 653a 2066 6c6f 6174 2c0a 2020 2020 2020  e: float,.      
+0002dcb0: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+0002dcc0: 735f 706f 696e 743a 2076 6f6c 6d64 6c72  s_point: volmdlr
+0002dcd0: 2e50 6f69 6e74 3344 2c20 6178 6973 3a20  .Point3D, axis: 
+0002dce0: 766f 6c6d 646c 722e 5665 6374 6f72 3344  volmdlr.Vector3D
+0002dcf0: 293a 0a20 2020 2020 2020 2022 2222 4769  ):.        """Gi
+0002dd00: 7665 7320 7468 6520 6172 6333 4420 6672  ves the arc3D fr
+0002dd10: 6f6d 2061 2073 7461 7274 2c20 616e 2061  om a start, an a
+0002dd20: 6e67 6c65 2061 6e64 2061 6e20 6178 6973  ngle and an axis
+0002dd30: 2e22 2222 0a20 2020 2020 2020 2073 7461  .""".        sta
+0002dd40: 7274 5f67 656e 203d 2073 7461 7274 0a20  rt_gen = start. 
+0002dd50: 2020 2020 2020 2069 6e74 5f67 656e 203d         int_gen =
+0002dd60: 2073 7461 7274 5f67 656e 2e72 6f74 6174   start_gen.rotat
+0002dd70: 696f 6e28 6178 6973 5f70 6f69 6e74 2c20  ion(axis_point, 
+0002dd80: 6178 6973 2c20 616e 676c 6520 2f20 3229  axis, angle / 2)
+0002dd90: 0a20 2020 2020 2020 2065 6e64 5f67 656e  .        end_gen
+0002dda0: 203d 2073 7461 7274 5f67 656e 2e72 6f74   = start_gen.rot
+0002ddb0: 6174 696f 6e28 6178 6973 5f70 6f69 6e74  ation(axis_point
+0002ddc0: 2c20 6178 6973 2c20 616e 676c 6529 0a20  , axis, angle). 
+0002ddd0: 2020 2020 2020 2069 6620 616e 676c 6520         if angle 
+0002dde0: 3d3d 2076 6f6c 6d64 6c72 2e54 574f 5f50  == volmdlr.TWO_P
+0002ddf0: 493a 0a20 2020 2020 2020 2020 2020 206c  I:.            l
+0002de00: 696e 6520 3d20 4c69 6e65 3344 2861 7869  ine = Line3D(axi
+0002de10: 735f 706f 696e 742c 2061 7869 735f 706f  s_point, axis_po
+0002de20: 696e 7420 2b20 6178 6973 290a 2020 2020  int + axis).    
+0002de30: 2020 2020 2020 2020 6365 6e74 6572 2c20          center, 
+0002de40: 5f20 3d20 6c69 6e65 2e70 6f69 6e74 5f70  _ = line.point_p
+0002de50: 726f 6a65 6374 696f 6e28 7374 6172 7429  rojection(start)
+0002de60: 0a20 2020 2020 2020 2020 2020 2072 6164  .            rad
+0002de70: 6975 7320 3d20 6365 6e74 6572 2e70 6f69  ius = center.poi
+0002de80: 6e74 5f64 6973 7461 6e63 6528 7374 6172  nt_distance(star
+0002de90: 7429 0a20 2020 2020 2020 2020 2020 2075  t).            u
+0002dea0: 203d 2073 7461 7274 202d 2063 656e 7465   = start - cente
+0002deb0: 720a 2020 2020 2020 2020 2020 2020 7620  r.            v 
+0002dec0: 3d20 6178 6973 2e63 726f 7373 2875 290a  = axis.cross(u).
+0002ded0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002dee0: 726e 2076 6f6c 6d64 6c72 2e77 6972 6573  rn volmdlr.wires
+0002def0: 2e43 6972 636c 6533 4428 766f 6c6d 646c  .Circle3D(volmdl
+0002df00: 722e 4672 616d 6533 4428 6365 6e74 6572  r.Frame3D(center
+0002df10: 2c20 752c 2076 2c20 6178 6973 292c 0a20  , u, v, axis),. 
+0002df20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002df30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002df40: 2020 2020 2020 2020 2072 6164 6975 7329           radius)
+0002df50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002df60: 636c 7328 7374 6172 745f 6765 6e2c 2069  cls(start_gen, i
+0002df70: 6e74 5f67 656e 2c20 656e 645f 6765 6e2c  nt_gen, end_gen,
+0002df80: 2061 7869 7329 0a0a 2020 2020 4070 726f   axis)..    @pro
+0002df90: 7065 7274 790a 2020 2020 6465 6620 6e6f  perty.    def no
+0002dfa0: 726d 616c 2873 656c 6629 3a0a 2020 2020  rmal(self):.    
+0002dfb0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+0002dfc0: 5f75 7464 5f6e 6f72 6d61 6c3a 0a20 2020  _utd_normal:.   
+0002dfd0: 2020 2020 2020 2020 2073 656c 662e 5f6e           self._n
+0002dfe0: 6f72 6d61 6c20 3d20 7365 6c66 2e67 6574  ormal = self.get
+0002dff0: 5f6e 6f72 6d61 6c28 290a 2020 2020 2020  _normal().      
+0002e000: 2020 2020 2020 7365 6c66 2e5f 7574 645f        self._utd_
+0002e010: 6e6f 726d 616c 203d 2054 7275 650a 2020  normal = True.  
+0002e020: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0002e030: 662e 5f6e 6f72 6d61 6c0a 0a20 2020 2064  f._normal..    d
+0002e040: 6566 2067 6574 5f6e 6f72 6d61 6c28 7365  ef get_normal(se
+0002e050: 6c66 293a 0a20 2020 2020 2020 2075 3120  lf):.        u1 
+0002e060: 3d20 7365 6c66 2e69 6e74 6572 696f 7220  = self.interior 
+0002e070: 2d20 7365 6c66 2e73 7461 7274 0a20 2020  - self.start.   
+0002e080: 2020 2020 2075 3220 3d20 7365 6c66 2e69       u2 = self.i
+0002e090: 6e74 6572 696f 7220 2d20 7365 6c66 2e65  nterior - self.e
+0002e0a0: 6e64 0a20 2020 2020 2020 2074 7279 3a0a  nd.        try:.
+0002e0b0: 2020 2020 2020 2020 2020 2020 7531 2e6e              u1.n
+0002e0c0: 6f72 6d61 6c69 7a65 2829 0a20 2020 2020  ormalize().     
+0002e0d0: 2020 2020 2020 2075 322e 6e6f 726d 616c         u2.normal
+0002e0e0: 697a 6528 290a 2020 2020 2020 2020 6578  ize().        ex
+0002e0f0: 6365 7074 205a 6572 6f44 6976 6973 696f  cept ZeroDivisio
+0002e100: 6e45 7272 6f72 3a0a 2020 2020 2020 2020  nError:.        
+0002e110: 2020 2020 7072 696e 7428 5472 7565 290a      print(True).
+0002e120: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0002e130: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+0002e140: 2020 2020 2020 2020 2020 2020 2020 2753                'S
+0002e150: 7461 7274 2c20 656e 6420 616e 6420 696e  tart, end and in
+0002e160: 7465 7269 6f72 2070 6f69 6e74 7320 6f66  terior points of
+0002e170: 2061 6e20 6172 6320 6d75 7374 2062 6520   an arc must be 
+0002e180: 6469 7374 696e 6374 7327 2920 6672 6f6d  distincts') from
+0002e190: 205a 6572 6f44 6976 6973 696f 6e45 7272   ZeroDivisionErr
+0002e1a0: 6f72 0a0a 2020 2020 2020 2020 6e6f 726d  or..        norm
+0002e1b0: 616c 203d 2075 322e 6372 6f73 7328 7531  al = u2.cross(u1
+0002e1c0: 290a 2020 2020 2020 2020 6e6f 726d 616c  ).        normal
+0002e1d0: 2e6e 6f72 6d61 6c69 7a65 2829 0a20 2020  .normalize().   
+0002e1e0: 2020 2020 2072 6574 7572 6e20 6e6f 726d       return norm
+0002e1f0: 616c 0a0a 2020 2020 4070 726f 7065 7274  al..    @propert
+0002e200: 790a 2020 2020 6465 6620 6365 6e74 6572  y.    def center
+0002e210: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0002e220: 6966 206e 6f74 2073 656c 662e 5f75 7464  if not self._utd
+0002e230: 5f63 656e 7465 723a 0a20 2020 2020 2020  _center:.       
+0002e240: 2020 2020 2073 656c 662e 5f63 656e 7465       self._cente
+0002e250: 7220 3d20 7365 6c66 2e67 6574 5f63 656e  r = self.get_cen
+0002e260: 7465 7228 290a 2020 2020 2020 2020 2020  ter().          
+0002e270: 2020 7365 6c66 2e5f 7574 645f 6365 6e74    self._utd_cent
+0002e280: 6572 203d 2054 7275 650a 2020 2020 2020  er = True.      
+0002e290: 2020 7265 7475 726e 2073 656c 662e 5f63    return self._c
+0002e2a0: 656e 7465 720a 0a20 2020 2064 6566 2067  enter..    def g
+0002e2b0: 6574 5f63 656e 7465 7228 7365 6c66 293a  et_center(self):
+0002e2c0: 0a20 2020 2020 2020 2075 3120 3d20 7365  .        u1 = se
+0002e2d0: 6c66 2e69 6e74 6572 696f 7220 2d20 7365  lf.interior - se
+0002e2e0: 6c66 2e73 7461 7274 0a20 2020 2020 2020  lf.start.       
+0002e2f0: 2075 3220 3d20 7365 6c66 2e69 6e74 6572   u2 = self.inter
+0002e300: 696f 7220 2d20 7365 6c66 2e65 6e64 0a20  ior - self.end. 
+0002e310: 2020 2020 2020 2069 6620 7531 203d 3d20         if u1 == 
+0002e320: 7532 3a0a 2020 2020 2020 2020 2020 2020  u2:.            
+0002e330: 7532 203d 2073 656c 662e 6e6f 726d 616c  u2 = self.normal
+0002e340: 2e63 726f 7373 2875 3129 0a20 2020 2020  .cross(u1).     
+0002e350: 2020 2020 2020 2075 322e 6e6f 726d 616c         u2.normal
+0002e360: 697a 6528 290a 0a20 2020 2020 2020 2076  ize()..        v
+0002e370: 3120 3d20 7365 6c66 2e6e 6f72 6d61 6c2e  1 = self.normal.
+0002e380: 6372 6f73 7328 7531 2920 2023 2076 3120  cross(u1)  # v1 
+0002e390: 6973 206e 6f72 6d61 6c2c 2065 7175 616c  is normal, equal
+0002e3a0: 2075 320a 2020 2020 2020 2020 7632 203d   u2.        v2 =
+0002e3b0: 2073 656c 662e 6e6f 726d 616c 2e63 726f   self.normal.cro
+0002e3c0: 7373 2875 3229 2020 2320 6571 7561 6c20  ss(u2)  # equal 
+0002e3d0: 2d75 310a 0a20 2020 2020 2020 2070 3131  -u1..        p11
+0002e3e0: 203d 2030 2e35 202a 2028 7365 6c66 2e73   = 0.5 * (self.s
+0002e3f0: 7461 7274 202b 2073 656c 662e 696e 7465  tart + self.inte
+0002e400: 7269 6f72 2920 2023 204d 6964 2070 6f69  rior)  # Mid poi
+0002e410: 6e74 206f 6620 7365 676d 656e 7420 732c  nt of segment s,
+0002e420: 6d0a 2020 2020 2020 2020 7031 3220 3d20  m.        p12 = 
+0002e430: 7031 3120 2b20 7631 0a20 2020 2020 2020  p11 + v1.       
+0002e440: 2070 3231 203d 2030 2e35 202a 2028 7365   p21 = 0.5 * (se
+0002e450: 6c66 2e65 6e64 202b 2073 656c 662e 696e  lf.end + self.in
+0002e460: 7465 7269 6f72 2920 2023 204d 6964 2070  terior)  # Mid p
+0002e470: 6f69 6e74 206f 6620 7365 676d 656e 7420  oint of segment 
+0002e480: 732c 6d0a 2020 2020 2020 2020 7032 3220  s,m.        p22 
+0002e490: 3d20 7032 3120 2b20 7632 0a0a 2020 2020  = p21 + v2..    
+0002e4a0: 2020 2020 6c31 203d 204c 696e 6533 4428      l1 = Line3D(
+0002e4b0: 7031 312c 2070 3132 290a 2020 2020 2020  p11, p12).      
+0002e4c0: 2020 6c32 203d 204c 696e 6533 4428 7032    l2 = Line3D(p2
+0002e4d0: 312c 2070 3232 290a 0a20 2020 2020 2020  1, p22)..       
+0002e4e0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0002e4f0: 2020 6365 6e74 6572 2c20 5f20 3d20 6c31    center, _ = l1
+0002e500: 2e6d 696e 696d 756d 5f64 6973 7461 6e63  .minimum_distanc
+0002e510: 655f 706f 696e 7473 286c 3229 0a20 2020  e_points(l2).   
+0002e520: 2020 2020 2065 7863 6570 7420 5a65 726f       except Zero
+0002e530: 4469 7669 7369 6f6e 4572 726f 723a 0a20  DivisionError:. 
+0002e540: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002e550: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0002e560: 2020 2020 2020 2020 2020 2020 2027 5374               'St
+0002e570: 6172 742c 2065 6e64 2061 6e64 2069 6e74  art, end and int
+0002e580: 6572 696f 7220 706f 696e 7473 2020 6f66  erior points  of
+0002e590: 2061 6e20 6172 6320 6d75 7374 2062 6520   an arc must be 
+0002e5a0: 6469 7374 696e 6374 7327 2920 6672 6f6d  distincts') from
+0002e5b0: 205a 6572 6f44 6976 6973 696f 6e45 7272   ZeroDivisionErr
+0002e5c0: 6f72 0a0a 2020 2020 2020 2020 7265 7475  or..        retu
+0002e5d0: 726e 2063 656e 7465 720a 0a20 2020 2040  rn center..    @
+0002e5e0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0002e5f0: 2066 7261 6d65 2873 656c 6629 3a0a 2020   frame(self):.  
+0002e600: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+0002e610: 662e 5f75 7464 5f66 7261 6d65 3a0a 2020  f._utd_frame:.  
+0002e620: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0002e630: 6672 616d 6520 3d20 7365 6c66 2e67 6574  frame = self.get
+0002e640: 5f66 7261 6d65 2829 0a20 2020 2020 2020  _frame().       
+0002e650: 2020 2020 2073 656c 662e 5f75 7464 5f66       self._utd_f
+0002e660: 7261 6d65 203d 2054 7275 650a 2020 2020  rame = True.    
+0002e670: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0002e680: 5f66 7261 6d65 0a0a 2020 2020 6465 6620  _frame..    def 
+0002e690: 6765 745f 6672 616d 6528 7365 6c66 293a  get_frame(self):
+0002e6a0: 0a20 2020 2020 2020 2076 6563 3120 3d20  .        vec1 = 
+0002e6b0: 7365 6c66 2e73 7461 7274 202d 2073 656c  self.start - sel
+0002e6c0: 662e 6365 6e74 6572 0a20 2020 2020 2020  f.center.       
+0002e6d0: 2076 6563 312e 6e6f 726d 616c 697a 6528   vec1.normalize(
+0002e6e0: 290a 2020 2020 2020 2020 7665 6332 203d  ).        vec2 =
+0002e6f0: 2073 656c 662e 6e6f 726d 616c 2e63 726f   self.normal.cro
+0002e700: 7373 2876 6563 3129 0a20 2020 2020 2020  ss(vec1).       
+0002e710: 2066 7261 6d65 203d 2076 6f6c 6d64 6c72   frame = volmdlr
+0002e720: 2e46 7261 6d65 3344 2873 656c 662e 6365  .Frame3D(self.ce
+0002e730: 6e74 6572 2c20 7665 6331 2c20 7665 6332  nter, vec1, vec2
+0002e740: 2c20 7365 6c66 2e6e 6f72 6d61 6c29 0a20  , self.normal). 
+0002e750: 2020 2020 2020 2072 6574 7572 6e20 6672         return fr
+0002e760: 616d 650a 0a20 2020 2040 7072 6f70 6572  ame..    @proper
+0002e770: 7479 0a20 2020 2064 6566 2069 735f 7472  ty.    def is_tr
+0002e780: 6967 6f28 7365 6c66 293a 0a20 2020 2020  igo(self):.     
+0002e790: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
+0002e7a0: 7574 645f 6973 5f74 7269 676f 3a0a 2020  utd_is_trigo:.  
+0002e7b0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0002e7c0: 6973 5f74 7269 676f 203d 2073 656c 662e  is_trigo = self.
+0002e7d0: 6765 745f 6172 635f 6469 7265 6374 696f  get_arc_directio
+0002e7e0: 6e28 290a 2020 2020 2020 2020 2020 2020  n().            
+0002e7f0: 7365 6c66 2e5f 7574 645f 6973 5f74 7269  self._utd_is_tri
+0002e800: 676f 203d 2054 7275 650a 2020 2020 2020  go = True.      
+0002e810: 2020 7265 7475 726e 2073 656c 662e 5f69    return self._i
+0002e820: 735f 7472 6967 6f0a 0a20 2020 2064 6566  s_trigo..    def
+0002e830: 2067 6574 5f61 7263 5f64 6972 6563 7469   get_arc_directi
+0002e840: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
+0002e850: 2020 2222 220a 2020 2020 2020 2020 5665    """.        Ve
+0002e860: 7269 6669 6573 2069 6620 6172 6320 6973  rifies if arc is
+0002e870: 2063 6c6f 636b 7769 7365 206f 7220 7472   clockwise or tr
+0002e880: 6967 6f77 6973 652e 0a0a 2020 2020 2020  igowise...      
+0002e890: 2020 3a72 6574 7572 6e3a 2054 7275 6520    :return: True 
+0002e8a0: 6966 2063 6c6f 636b 7769 7365 2c20 4661  if clockwise, Fa
+0002e8b0: 6c73 6520 6966 2074 7269 676f 7769 7365  lse if trigowise
+0002e8c0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0002e8d0: 2020 2020 2020 636c 6f63 6b77 6973 655f        clockwise_
+0002e8e0: 7061 7468 2c20 7472 6967 6f77 6973 655f  path, trigowise_
+0002e8f0: 7061 7468 203d 2073 656c 662e 636c 6f63  path = self.cloc
+0002e900: 6b77 6973 655f 616e 645f 7472 6967 6f77  kwise_and_trigow
+0002e910: 6973 655f 7061 7468 730a 2020 2020 2020  ise_paths.      
+0002e920: 2020 6966 2063 6c6f 636b 7769 7365 5f70    if clockwise_p
+0002e930: 6174 6820 3e20 7472 6967 6f77 6973 655f  ath > trigowise_
+0002e940: 7061 7468 3a0a 2020 2020 2020 2020 2020  path:.          
+0002e950: 2020 7265 7475 726e 2054 7275 650a 2020    return True.  
+0002e960: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+0002e970: 7365 0a0a 2020 2020 4070 726f 7065 7274  se..    @propert
+0002e980: 790a 2020 2020 6465 6620 636c 6f63 6b77  y.    def clockw
+0002e990: 6973 655f 616e 645f 7472 6967 6f77 6973  ise_and_trigowis
+0002e9a0: 655f 7061 7468 7328 7365 6c66 293a 0a20  e_paths(self):. 
+0002e9b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0002e9c0: 2020 203a 7265 7475 726e 3a20 636c 6f63     :return: cloc
+0002e9d0: 6b77 6973 6520 7061 7468 2061 6e64 2074  kwise path and t
+0002e9e0: 7269 676f 6e6f 6d65 7472 6963 2070 6174  rigonometric pat
+0002e9f0: 6820 7072 6f70 6572 7479 2e0a 2020 2020  h property..    
+0002ea00: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0002ea10: 6966 206e 6f74 2073 656c 662e 5f75 7464  if not self._utd
+0002ea20: 5f63 6c6f 636b 7769 7365 5f61 6e64 5f74  _clockwise_and_t
+0002ea30: 7269 676f 7769 7365 5f70 6174 6873 3a0a  rigowise_paths:.
+0002ea40: 2020 2020 2020 2020 2020 2020 7665 6331              vec1
+0002ea50: 203d 2073 656c 662e 7374 6172 7420 2d20   = self.start - 
+0002ea60: 7365 6c66 2e63 656e 7465 720a 2020 2020  self.center.    
+0002ea70: 2020 2020 2020 2020 7665 6331 2e6e 6f72          vec1.nor
+0002ea80: 6d61 6c69 7a65 2829 0a20 2020 2020 2020  malize().       
+0002ea90: 2020 2020 2076 6563 3220 3d20 7365 6c66       vec2 = self
+0002eaa0: 2e6e 6f72 6d61 6c2e 6372 6f73 7328 7665  .normal.cross(ve
+0002eab0: 6331 290a 2020 2020 2020 2020 2020 2020  c1).            
+0002eac0: 7261 6469 7573 5f31 203d 2073 656c 662e  radius_1 = self.
+0002ead0: 7374 6172 742e 746f 5f32 6428 7365 6c66  start.to_2d(self
+0002eae0: 2e63 656e 7465 722c 2076 6563 312c 2076  .center, vec1, v
+0002eaf0: 6563 3229 0a20 2020 2020 2020 2020 2020  ec2).           
+0002eb00: 2072 6164 6975 735f 3220 3d20 7365 6c66   radius_2 = self
+0002eb10: 2e65 6e64 2e74 6f5f 3264 2873 656c 662e  .end.to_2d(self.
+0002eb20: 6365 6e74 6572 2c20 7665 6331 2c20 7665  center, vec1, ve
+0002eb30: 6332 290a 2020 2020 2020 2020 2020 2020  c2).            
+0002eb40: 7261 6469 7573 5f69 203d 2073 656c 662e  radius_i = self.
+0002eb50: 696e 7465 7269 6f72 2e74 6f5f 3264 2873  interior.to_2d(s
+0002eb60: 656c 662e 6365 6e74 6572 2c20 7665 6331  elf.center, vec1
+0002eb70: 2c20 7665 6332 290a 2020 2020 2020 2020  , vec2).        
+0002eb80: 2020 2020 7365 6c66 2e5f 636c 6f63 6b77      self._clockw
+0002eb90: 6973 655f 616e 645f 7472 6967 6f77 6973  ise_and_trigowis
+0002eba0: 655f 7061 7468 7320 3d20 5c0a 2020 2020  e_paths = \.    
+0002ebb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002ebc0: 2e67 6574 5f63 6c6f 636b 7769 7365 5f61  .get_clockwise_a
+0002ebd0: 6e64 5f74 7269 676f 7769 7365 5f70 6174  nd_trigowise_pat
+0002ebe0: 6873 2872 6164 6975 735f 312c 0a20 2020  hs(radius_1,.   
+0002ebf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec20: 2020 2020 7261 6469 7573 5f32 2c0a 2020      radius_2,.  
+0002ec30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec60: 2020 2020 2072 6164 6975 735f 6929 0a20       radius_i). 
+0002ec70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002ec80: 5f75 7464 5f63 6c6f 636b 7769 7365 5f61  _utd_clockwise_a
+0002ec90: 6e64 5f74 7269 676f 7769 7365 5f70 6174  nd_trigowise_pat
+0002eca0: 6873 203d 2054 7275 650a 2020 2020 2020  hs = True.      
+0002ecb0: 2020 7265 7475 726e 2073 656c 662e 5f63    return self._c
+0002ecc0: 6c6f 636b 7769 7365 5f61 6e64 5f74 7269  lockwise_and_tri
+0002ecd0: 676f 7769 7365 5f70 6174 6873 0a0a 2020  gowise_paths..  
+0002ece0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0002ecf0: 6465 6620 616e 676c 6528 7365 6c66 293a  def angle(self):
+0002ed00: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002ed10: 2020 2020 2041 7263 2061 6e67 6c65 2070       Arc angle p
+0002ed20: 726f 7065 7274 792e 0a0a 2020 2020 2020  roperty...      
+0002ed30: 2020 3a72 6574 7572 6e3a 2061 7263 2061    :return: arc a
+0002ed40: 6e67 6c65 2e0a 2020 2020 2020 2020 2222  ngle..        ""
+0002ed50: 220a 2020 2020 2020 2020 6966 206e 6f74  ".        if not
+0002ed60: 2073 656c 662e 5f75 7464 5f61 6e67 6c65   self._utd_angle
+0002ed70: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0002ed80: 6c66 2e5f 616e 676c 6520 3d20 7365 6c66  lf._angle = self
+0002ed90: 2e67 6574 5f61 6e67 6c65 2829 0a20 2020  .get_angle().   
+0002eda0: 2020 2020 2020 2020 2073 656c 662e 5f75           self._u
+0002edb0: 7464 5f61 6e67 6c65 203d 2054 7275 650a  td_angle = True.
+0002edc0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0002edd0: 656c 662e 5f61 6e67 6c65 0a0a 2020 2020  elf._angle..    
+0002ede0: 6465 6620 6765 745f 616e 676c 6528 7365  def get_angle(se
+0002edf0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0002ee00: 0a20 2020 2020 2020 2047 6574 7320 7468  .        Gets th
+0002ee10: 6520 6172 6320 616e 676c 652e 0a0a 2020  e arc angle...  
+0002ee20: 2020 2020 2020 3a72 6574 7572 6e3a 2061        :return: a
+0002ee30: 7263 2061 6e67 6c65 2e0a 2020 2020 2020  rc angle..      
+0002ee40: 2020 2222 220a 2020 2020 2020 2020 636c    """.        cl
+0002ee50: 6f63 6b77 6973 655f 7061 7468 2c20 7472  ockwise_path, tr
+0002ee60: 6967 6f77 6973 655f 7061 7468 203d 205c  igowise_path = \
+0002ee70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002ee80: 662e 636c 6f63 6b77 6973 655f 616e 645f  f.clockwise_and_
+0002ee90: 7472 6967 6f77 6973 655f 7061 7468 730a  trigowise_paths.
+0002eea0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0002eeb0: 6973 5f74 7269 676f 3a0a 2020 2020 2020  is_trigo:.      
+0002eec0: 2020 2020 2020 7265 7475 726e 2074 7269        return tri
+0002eed0: 676f 7769 7365 5f70 6174 680a 2020 2020  gowise_path.    
+0002eee0: 2020 2020 7265 7475 726e 2063 6c6f 636b      return clock
+0002eef0: 7769 7365 5f70 6174 680a 0a20 2020 2040  wise_path..    @
+0002ef00: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0002ef10: 2070 6f69 6e74 7328 7365 6c66 293a 0a20   points(self):. 
+0002ef20: 2020 2020 2020 2072 6574 7572 6e20 5b73         return [s
+0002ef30: 656c 662e 7374 6172 742c 2073 656c 662e  elf.start, self.
+0002ef40: 696e 7465 7269 6f72 2c20 7365 6c66 2e65  interior, self.e
+0002ef50: 6e64 5d0a 0a20 2020 2064 6566 2072 6576  nd]..    def rev
+0002ef60: 6572 7365 2873 656c 6629 3a0a 2020 2020  erse(self):.    
+0002ef70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0002ef80: 4465 6669 6e65 7320 6120 6e65 7720 4172  Defines a new Ar
+0002ef90: 6333 442c 206f 6465 6e74 6963 616c 2074  c3D, odentical t
+0002efa0: 6f20 7365 6c66 2c20 6275 7420 696e 2074  o self, but in t
+0002efb0: 6865 206f 7070 6f73 6974 6520 6469 7265  he opposite dire
+0002efc0: 6374 696f 6e2e 0a0a 2020 2020 2020 2020  ction...        
+0002efd0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0002efe0: 726e 2073 656c 662e 5f5f 636c 6173 735f  rn self.__class_
+0002eff0: 5f28 7365 6c66 2e65 6e64 2e63 6f70 7928  _(self.end.copy(
+0002f000: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0002f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f020: 2073 656c 662e 696e 7465 7269 6f72 2e63   self.interior.c
+0002f030: 6f70 7928 292c 0a20 2020 2020 2020 2020  opy(),.         
+0002f040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f050: 2020 2020 2073 656c 662e 7374 6172 742e       self.start.
+0002f060: 636f 7079 2829 290a 0a20 2020 2064 6566  copy())..    def
+0002f070: 2070 6f69 6e74 5f61 745f 6162 7363 6973   point_at_abscis
+0002f080: 7361 2873 656c 662c 2061 6273 6369 7373  sa(self, absciss
+0002f090: 6129 3a0a 2020 2020 2020 2020 2222 220a  a):.        """.
+0002f0a0: 2020 2020 2020 2020 4361 6c63 756c 6174          Calculat
+0002f0b0: 6573 2061 2070 6f69 6e74 2069 6e20 7468  es a point in th
+0002f0c0: 6520 4172 6333 4420 6174 2061 2067 6976  e Arc3D at a giv
+0002f0d0: 656e 2061 6273 6369 7373 612e 0a0a 2020  en abscissa...  
+0002f0e0: 2020 2020 2020 3a70 6172 616d 2061 6273        :param abs
+0002f0f0: 6369 7373 613a 2061 6273 6369 7373 6120  cissa: abscissa 
+0002f100: 7768 6572 6520 696e 2074 6865 2063 7572  where in the cur
+0002f110: 7665 2074 6865 2070 6f69 6e74 2073 686f  ve the point sho
+0002f120: 756c 6420 6265 2063 616c 6375 6c61 7465  uld be calculate
+0002f130: 642e 0a20 2020 2020 2020 203a 7265 7475  d..        :retu
+0002f140: 726e 3a20 436f 7272 6573 706f 6e64 696e  rn: Correspondin
+0002f150: 6720 706f 696e 742e 0a20 2020 2020 2020  g point..       
+0002f160: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+0002f170: 7572 6e20 7365 6c66 2e73 7461 7274 2e72  urn self.start.r
+0002f180: 6f74 6174 696f 6e28 7365 6c66 2e63 656e  otation(self.cen
+0002f190: 7465 722c 2073 656c 662e 6e6f 726d 616c  ter, self.normal
+0002f1a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002f1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f1c0: 2020 2020 2061 6273 6369 7373 6120 2f20       abscissa / 
+0002f1d0: 7365 6c66 2e72 6164 6975 7329 0a0a 2020  self.radius)..  
+0002f1e0: 2020 6465 6620 6e6f 726d 616c 5f76 6563    def normal_vec
+0002f1f0: 746f 7228 7365 6c66 2c20 6162 7363 6973  tor(self, abscis
+0002f200: 7361 293a 0a20 2020 2020 2020 2022 2222  sa):.        """
+0002f210: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
+0002f220: 7465 7320 6120 6e6f 726d 616c 2076 6563  tes a normal vec
+0002f230: 746f 7220 6174 2061 2067 6976 656e 2061  tor at a given a
+0002f240: 6273 6369 7373 6120 6f66 2074 6865 2041  bscissa of the A
+0002f250: 7263 3344 2e0a 0a20 2020 2020 2020 203a  rc3D...        :
+0002f260: 7061 7261 6d20 6162 7363 6973 7361 3a20  param abscissa: 
+0002f270: 6162 7363 6973 7361 2077 6865 7265 2069  abscissa where i
+0002f280: 6e20 7468 6520 6375 7276 6520 7468 6520  n the curve the 
+0002f290: 6e6f 726d 616c 2076 6563 746f 7220 7368  normal vector sh
+0002f2a0: 6f75 6c64 2062 6520 6361 6c63 756c 6174  ould be calculat
+0002f2b0: 6564 2e0a 2020 2020 2020 2020 3a72 6574  ed..        :ret
+0002f2c0: 7572 6e3a 2043 6f72 7265 7370 6f6e 6469  urn: Correspondi
+0002f2d0: 6e67 206e 6f72 6d61 6c20 7665 6374 6f72  ng normal vector
+0002f2e0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0002f2f0: 2020 2020 2020 7468 6574 6120 3d20 6162        theta = ab
+0002f300: 7363 6973 7361 202f 2073 656c 662e 7261  scissa / self.ra
+0002f310: 6469 7573 0a20 2020 2020 2020 206e 5f30  dius.        n_0
+0002f320: 203d 2073 656c 662e 6365 6e74 6572 202d   = self.center -
+0002f330: 2073 656c 662e 7374 6172 740a 2020 2020   self.start.    
+0002f340: 2020 2020 6e6f 726d 616c 203d 206e 5f30      normal = n_0
+0002f350: 2e72 6f74 6174 696f 6e28 7365 6c66 2e63  .rotation(self.c
+0002f360: 656e 7465 722c 2073 656c 662e 6e6f 726d  enter, self.norm
+0002f370: 616c 2c20 7468 6574 6129 0a20 2020 2020  al, theta).     
+0002f380: 2020 2072 6574 7572 6e20 6e6f 726d 616c     return normal
+0002f390: 0a0a 2020 2020 6465 6620 756e 6974 5f6e  ..    def unit_n
+0002f3a0: 6f72 6d61 6c5f 7665 6374 6f72 2873 656c  ormal_vector(sel
+0002f3b0: 662c 2061 6273 6369 7373 6129 3a0a 2020  f, abscissa):.  
+0002f3c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0002f3d0: 2020 4361 6c63 756c 6174 6573 2061 2075    Calculates a u
+0002f3e0: 6e69 7420 6e6f 726d 616c 2076 6563 746f  nit normal vecto
+0002f3f0: 7220 6174 2061 2067 6976 656e 2061 6273  r at a given abs
+0002f400: 6369 7373 6120 6f66 2074 6865 2041 7263  cissa of the Arc
+0002f410: 3344 2e0a 0a20 2020 2020 2020 203a 7061  3D...        :pa
+0002f420: 7261 6d20 6162 7363 6973 7361 3a20 6162  ram abscissa: ab
+0002f430: 7363 6973 7361 2077 6865 7265 2069 6e20  scissa where in 
+0002f440: 7468 6520 6375 7276 6520 7468 6520 756e  the curve the un
+0002f450: 6974 206e 6f72 6d61 6c20 7665 6374 6f72  it normal vector
+0002f460: 2073 686f 756c 6420 6265 2063 616c 6375   should be calcu
+0002f470: 6c61 7465 642e 0a20 2020 2020 2020 203a  lated..        :
+0002f480: 7265 7475 726e 3a20 436f 7272 6573 706f  return: Correspo
+0002f490: 6e64 696e 6720 756e 6974 206e 6f72 6d61  nding unit norma
+0002f4a0: 6c20 7665 6374 6f72 2e0a 2020 2020 2020  l vector..      
+0002f4b0: 2020 2222 220a 2020 2020 2020 2020 6e6f    """.        no
+0002f4c0: 726d 616c 5f76 6563 746f 7220 3d20 7365  rmal_vector = se
+0002f4d0: 6c66 2e6e 6f72 6d61 6c5f 7665 6374 6f72  lf.normal_vector
+0002f4e0: 2861 6273 6369 7373 6129 0a20 2020 2020  (abscissa).     
+0002f4f0: 2020 206e 6f72 6d61 6c5f 7665 6374 6f72     normal_vector
+0002f500: 2e6e 6f72 6d61 6c69 7a65 2829 0a20 2020  .normalize().   
+0002f510: 2020 2020 2072 6574 7572 6e20 6e6f 726d       return norm
+0002f520: 616c 5f76 6563 746f 720a 0a20 2020 2064  al_vector..    d
+0002f530: 6566 2064 6972 6563 7469 6f6e 5f76 6563  ef direction_vec
+0002f540: 746f 7228 7365 6c66 2c20 6162 7363 6973  tor(self, abscis
+0002f550: 7361 293a 0a20 2020 2020 2020 2022 2222  sa):.        """
+0002f560: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
+0002f570: 7465 7320 6120 6469 7265 6374 696f 6e20  tes a direction 
+0002f580: 7665 6374 6f72 2061 7420 6120 6769 7665  vector at a give
+0002f590: 6e20 6162 7363 6973 7361 206f 6620 7468  n abscissa of th
+0002f5a0: 6520 4172 6333 442e 0a0a 2020 2020 2020  e Arc3D...      
+0002f5b0: 2020 3a70 6172 616d 2061 6273 6369 7373    :param absciss
+0002f5c0: 613a 2061 6273 6369 7373 6120 7768 6572  a: abscissa wher
+0002f5d0: 6520 696e 2074 6865 2063 7572 7665 2074  e in the curve t
+0002f5e0: 6865 2064 6972 6563 7469 6f6e 2076 6563  he direction vec
+0002f5f0: 746f 7220 7368 6f75 6c64 2062 6520 6361  tor should be ca
+0002f600: 6c63 756c 6174 6564 2e0a 2020 2020 2020  lculated..      
+0002f610: 2020 3a72 6574 7572 6e3a 2043 6f72 7265    :return: Corre
+0002f620: 7370 6f6e 6469 6e67 2064 6972 6563 7469  sponding directi
+0002f630: 6f6e 2076 6563 746f 722e 0a20 2020 2020  on vector..     
+0002f640: 2020 2022 2222 0a20 2020 2020 2020 206e     """.        n
+0002f650: 6f72 6d61 6c5f 7665 6374 6f72 203d 2073  ormal_vector = s
+0002f660: 656c 662e 6e6f 726d 616c 5f76 6563 746f  elf.normal_vecto
+0002f670: 7228 6162 7363 6973 7361 290a 2020 2020  r(abscissa).    
+0002f680: 2020 2020 7461 6e67 656e 7420 3d20 6e6f      tangent = no
+0002f690: 726d 616c 5f76 6563 746f 722e 6372 6f73  rmal_vector.cros
+0002f6a0: 7328 7365 6c66 2e6e 6f72 6d61 6c29 0a20  s(self.normal). 
+0002f6b0: 2020 2020 2020 2072 6574 7572 6e20 7461         return ta
+0002f6c0: 6e67 656e 740a 0a20 2020 2064 6566 2075  ngent..    def u
+0002f6d0: 6e69 745f 6469 7265 6374 696f 6e5f 7665  nit_direction_ve
+0002f6e0: 6374 6f72 2873 656c 662c 2061 6273 6369  ctor(self, absci
+0002f6f0: 7373 6129 3a0a 2020 2020 2020 2020 2222  ssa):.        ""
+0002f700: 220a 2020 2020 2020 2020 4361 6c63 756c  ".        Calcul
+0002f710: 6174 6573 2061 2075 6e69 7420 6469 7265  ates a unit dire
+0002f720: 6374 696f 6e20 7665 6374 6f72 2061 7420  ction vector at 
+0002f730: 6120 6769 7665 6e20 6162 7363 6973 7361  a given abscissa
+0002f740: 206f 6620 7468 6520 4172 6333 442e 0a0a   of the Arc3D...
+0002f750: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
+0002f760: 6273 6369 7373 613a 2061 6273 6369 7373  bscissa: absciss
+0002f770: 6120 7768 6572 6520 696e 2074 6865 2063  a where in the c
+0002f780: 7572 7665 2074 6865 2075 6e69 7420 6469  urve the unit di
+0002f790: 7265 6374 696f 6e20 7665 6374 6f72 2073  rection vector s
+0002f7a0: 686f 756c 6420 6265 2063 616c 6375 6c61  hould be calcula
+0002f7b0: 7465 642e 0a20 2020 2020 2020 203a 7265  ted..        :re
+0002f7c0: 7475 726e 3a20 436f 7272 6573 706f 6e64  turn: Correspond
+0002f7d0: 696e 6720 756e 6974 2064 6972 6563 7469  ing unit directi
+0002f7e0: 6f6e 2076 6563 746f 722e 0a20 2020 2020  on vector..     
+0002f7f0: 2020 2022 2222 0a20 2020 2020 2020 2064     """.        d
+0002f800: 6972 6563 7469 6f6e 5f76 6563 746f 7220  irection_vector 
+0002f810: 3d20 7365 6c66 2e64 6972 6563 7469 6f6e  = self.direction
+0002f820: 5f76 6563 746f 7228 6162 7363 6973 7361  _vector(abscissa
+0002f830: 290a 2020 2020 2020 2020 6469 7265 6374  ).        direct
+0002f840: 696f 6e5f 7665 6374 6f72 2e6e 6f72 6d61  ion_vector.norma
+0002f850: 6c69 7a65 2829 0a20 2020 2020 2020 2072  lize().        r
+0002f860: 6574 7572 6e20 6469 7265 6374 696f 6e5f  eturn direction_
+0002f870: 7665 6374 6f72 0a0a 2020 2020 6465 6620  vector..    def 
+0002f880: 726f 7461 7469 6f6e 2873 656c 662c 2063  rotation(self, c
+0002f890: 656e 7465 723a 2076 6f6c 6d64 6c72 2e50  enter: volmdlr.P
+0002f8a0: 6f69 6e74 3344 2c0a 2020 2020 2020 2020  oint3D,.        
+0002f8b0: 2020 2020 2020 2020 2061 7869 733a 2076           axis: v
+0002f8c0: 6f6c 6d64 6c72 2e56 6563 746f 7233 442c  olmdlr.Vector3D,
+0002f8d0: 2061 6e67 6c65 3a20 666c 6f61 7429 3a0a   angle: float):.
+0002f8e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002f8f0: 2020 2020 4172 6333 4420 726f 7461 7469      Arc3D rotati
+0002f900: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
+0002f910: 7261 6d20 6365 6e74 6572 3a20 726f 7461  ram center: rota
+0002f920: 7469 6f6e 2063 656e 7465 720a 2020 2020  tion center.    
+0002f930: 2020 2020 3a70 6172 616d 2061 7869 733a      :param axis:
+0002f940: 2072 6f74 6174 696f 6e20 6178 6973 0a20   rotation axis. 
+0002f950: 2020 2020 2020 203a 7061 7261 6d20 616e         :param an
+0002f960: 676c 653a 2061 6e67 6c65 2072 6f74 6174  gle: angle rotat
+0002f970: 696f 6e0a 2020 2020 2020 2020 3a72 6574  ion.        :ret
+0002f980: 7572 6e3a 2061 206e 6577 2072 6f74 6174  urn: a new rotat
+0002f990: 6564 2041 7263 3344 0a20 2020 2020 2020  ed Arc3D.       
+0002f9a0: 2022 2222 0a20 2020 2020 2020 206e 6577   """.        new
+0002f9b0: 5f73 7461 7274 203d 2073 656c 662e 7374  _start = self.st
+0002f9c0: 6172 742e 726f 7461 7469 6f6e 2863 656e  art.rotation(cen
+0002f9d0: 7465 722c 2061 7869 732c 2061 6e67 6c65  ter, axis, angle
+0002f9e0: 290a 2020 2020 2020 2020 6e65 775f 696e  ).        new_in
+0002f9f0: 7465 7269 6f72 203d 2073 656c 662e 696e  terior = self.in
+0002fa00: 7465 7269 6f72 2e72 6f74 6174 696f 6e28  terior.rotation(
+0002fa10: 6365 6e74 6572 2c20 6178 6973 2c20 616e  center, axis, an
+0002fa20: 676c 6529 0a20 2020 2020 2020 206e 6577  gle).        new
+0002fa30: 5f65 6e64 203d 2073 656c 662e 656e 642e  _end = self.end.
+0002fa40: 726f 7461 7469 6f6e 2863 656e 7465 722c  rotation(center,
+0002fa50: 2061 7869 732c 2061 6e67 6c65 290a 2020   axis, angle).  
+0002fa60: 2020 2020 2020 7265 7475 726e 2041 7263        return Arc
+0002fa70: 3344 286e 6577 5f73 7461 7274 2c20 6e65  3D(new_start, ne
+0002fa80: 775f 696e 7465 7269 6f72 2c20 6e65 775f  w_interior, new_
+0002fa90: 656e 642c 206e 616d 653d 7365 6c66 2e6e  end, name=self.n
+0002faa0: 616d 6529 0a0a 2020 2020 6465 6620 726f  ame)..    def ro
+0002fab0: 7461 7469 6f6e 5f69 6e70 6c61 6365 2873  tation_inplace(s
+0002fac0: 656c 662c 2063 656e 7465 723a 2076 6f6c  elf, center: vol
+0002fad0: 6d64 6c72 2e50 6f69 6e74 3344 2c0a 2020  mdlr.Point3D,.  
+0002fae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002faf0: 2020 2020 2020 2061 7869 733a 2076 6f6c         axis: vol
+0002fb00: 6d64 6c72 2e56 6563 746f 7233 442c 2061  mdlr.Vector3D, a
+0002fb10: 6e67 6c65 3a20 666c 6f61 7429 3a0a 2020  ngle: float):.  
+0002fb20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0002fb30: 2020 4172 6333 4420 726f 7461 7469 6f6e    Arc3D rotation
+0002fb40: 2e20 4f62 6a65 6374 2069 7320 7570 6461  . Object is upda
+0002fb50: 7465 6420 696e 706c 6163 652e 0a0a 2020  ted inplace...  
+0002fb60: 2020 2020 2020 3a70 6172 616d 2063 656e        :param cen
+0002fb70: 7465 723a 2072 6f74 6174 696f 6e20 6365  ter: rotation ce
+0002fb80: 6e74 6572 0a20 2020 2020 2020 203a 7061  nter.        :pa
+0002fb90: 7261 6d20 6178 6973 3a20 726f 7461 7469  ram axis: rotati
+0002fba0: 6f6e 2061 7869 730a 2020 2020 2020 2020  on axis.        
+0002fbb0: 3a70 6172 616d 2061 6e67 6c65 3a20 726f  :param angle: ro
+0002fbc0: 7461 7469 6f6e 2061 6e67 6c65 0a20 2020  tation angle.   
+0002fbd0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0002fbe0: 2077 6172 6e69 6e67 732e 7761 726e 2822   warnings.warn("
+0002fbf0: 2769 6e70 6c61 6365 2720 6d65 7468 6f64  'inplace' method
+0002fc00: 7320 6172 6520 6465 7072 6563 6174 6564  s are deprecated
+0002fc10: 2e20 5573 6520 6120 6e6f 7420 696e 706c  . Use a not inpl
+0002fc20: 6163 6520 6d65 7468 6f64 2069 6e73 7465  ace method inste
+0002fc30: 6164 2e22 2c20 4465 7072 6563 6174 696f  ad.", Deprecatio
+0002fc40: 6e57 6172 6e69 6e67 290a 0a20 2020 2020  nWarning)..     
+0002fc50: 2020 2073 656c 662e 6365 6e74 6572 2e72     self.center.r
+0002fc60: 6f74 6174 696f 6e5f 696e 706c 6163 6528  otation_inplace(
+0002fc70: 6365 6e74 6572 2c20 6178 6973 2c20 616e  center, axis, an
+0002fc80: 676c 6529 0a20 2020 2020 2020 2073 656c  gle).        sel
+0002fc90: 662e 7374 6172 742e 726f 7461 7469 6f6e  f.start.rotation
+0002fca0: 5f69 6e70 6c61 6365 2863 656e 7465 722c  _inplace(center,
+0002fcb0: 2061 7869 732c 2061 6e67 6c65 290a 2020   axis, angle).  
+0002fcc0: 2020 2020 2020 7365 6c66 2e69 6e74 6572        self.inter
+0002fcd0: 696f 722e 726f 7461 7469 6f6e 5f69 6e70  ior.rotation_inp
+0002fce0: 6c61 6365 2863 656e 7465 722c 2061 7869  lace(center, axi
+0002fcf0: 732c 2061 6e67 6c65 290a 2020 2020 2020  s, angle).      
+0002fd00: 2020 7365 6c66 2e65 6e64 2e72 6f74 6174    self.end.rotat
+0002fd10: 696f 6e5f 696e 706c 6163 6528 6365 6e74  ion_inplace(cent
+0002fd20: 6572 2c20 6178 6973 2c20 616e 676c 6529  er, axis, angle)
+0002fd30: 0a20 2020 2020 2020 2073 656c 662e 5f62  .        self._b
+0002fd40: 626f 7820 3d20 4e6f 6e65 0a0a 2020 2020  box = None..    
+0002fd50: 6465 6620 7472 616e 736c 6174 696f 6e28  def translation(
+0002fd60: 7365 6c66 2c20 6f66 6673 6574 3a20 766f  self, offset: vo
+0002fd70: 6c6d 646c 722e 5665 6374 6f72 3344 293a  lmdlr.Vector3D):
+0002fd80: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002fd90: 2020 2020 2041 7263 3344 2074 7261 6e73       Arc3D trans
+0002fda0: 6c61 7469 6f6e 2e0a 0a20 2020 2020 2020  lation...       
+0002fdb0: 203a 7061 7261 6d20 6f66 6673 6574 3a20   :param offset: 
+0002fdc0: 7472 616e 736c 6174 696f 6e20 7665 6374  translation vect
+0002fdd0: 6f72 2e0a 2020 2020 2020 2020 3a72 6574  or..        :ret
+0002fde0: 7572 6e3a 2041 206e 6577 2074 7261 6e73  urn: A new trans
+0002fdf0: 6c61 7465 6420 4172 6333 442e 0a20 2020  lated Arc3D..   
+0002fe00: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0002fe10: 206e 6577 5f73 7461 7274 203d 2073 656c   new_start = sel
+0002fe20: 662e 7374 6172 742e 7472 616e 736c 6174  f.start.translat
+0002fe30: 696f 6e28 6f66 6673 6574 290a 2020 2020  ion(offset).    
+0002fe40: 2020 2020 6e65 775f 696e 7465 7269 6f72      new_interior
+0002fe50: 203d 2073 656c 662e 696e 7465 7269 6f72   = self.interior
+0002fe60: 2e74 7261 6e73 6c61 7469 6f6e 286f 6666  .translation(off
+0002fe70: 7365 7429 0a20 2020 2020 2020 206e 6577  set).        new
+0002fe80: 5f65 6e64 203d 2073 656c 662e 656e 642e  _end = self.end.
+0002fe90: 7472 616e 736c 6174 696f 6e28 6f66 6673  translation(offs
+0002fea0: 6574 290a 2020 2020 2020 2020 7265 7475  et).        retu
+0002feb0: 726e 2041 7263 3344 286e 6577 5f73 7461  rn Arc3D(new_sta
+0002fec0: 7274 2c20 6e65 775f 696e 7465 7269 6f72  rt, new_interior
+0002fed0: 2c20 6e65 775f 656e 642c 206e 616d 653d  , new_end, name=
+0002fee0: 7365 6c66 2e6e 616d 6529 0a0a 2020 2020  self.name)..    
+0002fef0: 6465 6620 7472 616e 736c 6174 696f 6e5f  def translation_
+0002ff00: 696e 706c 6163 6528 7365 6c66 2c20 6f66  inplace(self, of
+0002ff10: 6673 6574 3a20 766f 6c6d 646c 722e 5665  fset: volmdlr.Ve
+0002ff20: 6374 6f72 3344 293a 0a20 2020 2020 2020  ctor3D):.       
+0002ff30: 2022 2222 0a20 2020 2020 2020 2041 7263   """.        Arc
+0002ff40: 3344 2074 7261 6e73 6c61 7469 6f6e 2e20  3D translation. 
+0002ff50: 4f62 6a65 6374 2069 7320 7570 6461 7465  Object is update
+0002ff60: 6420 696e 706c 6163 652e 0a0a 2020 2020  d inplace...    
+0002ff70: 2020 2020 3a70 6172 616d 206f 6666 7365      :param offse
+0002ff80: 743a 2074 7261 6e73 6c61 7469 6f6e 2076  t: translation v
+0002ff90: 6563 746f 722e 0a20 2020 2020 2020 2022  ector..        "
+0002ffa0: 2222 0a20 2020 2020 2020 2077 6172 6e69  "".        warni
+0002ffb0: 6e67 732e 7761 726e 2822 2769 6e70 6c61  ngs.warn("'inpla
+0002ffc0: 6365 2720 6d65 7468 6f64 7320 6172 6520  ce' methods are 
+0002ffd0: 6465 7072 6563 6174 6564 2e20 5573 6520  deprecated. Use 
+0002ffe0: 6120 6e6f 7420 696e 706c 6163 6520 6d65  a not inplace me
+0002fff0: 7468 6f64 2069 6e73 7465 6164 2e22 2c20  thod instead.", 
+00030000: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
+00030010: 6e67 290a 0a20 2020 2020 2020 2073 656c  ng)..        sel
+00030020: 662e 6365 6e74 6572 2e74 7261 6e73 6c61  f.center.transla
+00030030: 7469 6f6e 5f69 6e70 6c61 6365 286f 6666  tion_inplace(off
+00030040: 7365 7429 0a20 2020 2020 2020 2073 656c  set).        sel
+00030050: 662e 7374 6172 742e 7472 616e 736c 6174  f.start.translat
+00030060: 696f 6e5f 696e 706c 6163 6528 6f66 6673  ion_inplace(offs
+00030070: 6574 290a 2020 2020 2020 2020 7365 6c66  et).        self
+00030080: 2e69 6e74 6572 696f 722e 7472 616e 736c  .interior.transl
+00030090: 6174 696f 6e5f 696e 706c 6163 6528 6f66  ation_inplace(of
+000300a0: 6673 6574 290a 2020 2020 2020 2020 7365  fset).        se
+000300b0: 6c66 2e65 6e64 2e74 7261 6e73 6c61 7469  lf.end.translati
+000300c0: 6f6e 5f69 6e70 6c61 6365 286f 6666 7365  on_inplace(offse
+000300d0: 7429 0a20 2020 2020 2020 2073 656c 662e  t).        self.
+000300e0: 5f62 626f 7820 3d20 4e6f 6e65 0a0a 2020  _bbox = None..  
+000300f0: 2020 6465 6620 706c 6f74 2873 656c 662c    def plot(self,
+00030100: 2061 783d 4e6f 6e65 2c20 636f 6c6f 723d   ax=None, color=
+00030110: 276b 272c 2061 6c70 6861 3d31 2c0a 2020  'k', alpha=1,.  
+00030120: 2020 2020 2020 2020 2020 2065 6467 655f             edge_
+00030130: 656e 6473 3d46 616c 7365 2c20 6564 6765  ends=False, edge
+00030140: 5f64 6972 6563 7469 6f6e 3d46 616c 7365  _direction=False
+00030150: 293a 0a20 2020 2020 2020 2069 6620 6178  ):.        if ax
+00030160: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00030170: 2020 2020 2020 6178 203d 2070 6c74 2e66        ax = plt.f
+00030180: 6967 7572 6528 292e 6164 645f 7375 6270  igure().add_subp
+00030190: 6c6f 7428 3131 312c 2070 726f 6a65 6374  lot(111, project
+000301a0: 696f 6e3d 2733 6427 290a 2020 2020 2020  ion='3d').      
+000301b0: 2020 2320 6966 2070 6c6f 745f 706f 696e    # if plot_poin
+000301c0: 7473 3a0a 2020 2020 2020 2020 2320 2020  ts:.        #   
+000301d0: 2020 6178 2e70 6c6f 7428 5b73 656c 662e    ax.plot([self.
+000301e0: 696e 7465 7269 6f72 5b30 5d5d 2c20 5b73  interior[0]], [s
+000301f0: 656c 662e 696e 7465 7269 6f72 5b31 5d5d  elf.interior[1]]
+00030200: 2c20 5b73 656c 662e 696e 7465 7269 6f72  , [self.interior
+00030210: 5b32 5d5d 2c0a 2020 2020 2020 2020 2320  [2]],.        # 
+00030220: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
+00030230: 723d 2762 2729 0a20 2020 2020 2020 2023  r='b').        #
+00030240: 2020 2020 2061 782e 706c 6f74 285b 7365       ax.plot([se
+00030250: 6c66 2e73 7461 7274 5b30 5d5d 2c20 5b73  lf.start[0]], [s
+00030260: 656c 662e 7374 6172 745b 315d 5d2c 205b  elf.start[1]], [
+00030270: 7365 6c66 2e73 7461 7274 5b32 5d5d 2c20  self.start[2]], 
+00030280: 633d 2772 2729 0a20 2020 2020 2020 2023  c='r').        #
+00030290: 2020 2020 2061 782e 706c 6f74 285b 7365       ax.plot([se
+000302a0: 6c66 2e65 6e64 5b30 5d5d 2c20 5b73 656c  lf.end[0]], [sel
+000302b0: 662e 656e 645b 315d 5d2c 205b 7365 6c66  f.end[1]], [self
+000302c0: 2e65 6e64 5b32 5d5d 2c20 633d 2772 2729  .end[2]], c='r')
+000302d0: 0a20 2020 2020 2020 2023 2020 2020 2061  .        #     a
+000302e0: 782e 706c 6f74 285b 7365 6c66 2e69 6e74  x.plot([self.int
+000302f0: 6572 696f 725b 305d 5d2c 205b 7365 6c66  erior[0]], [self
+00030300: 2e69 6e74 6572 696f 725b 315d 5d2c 205b  .interior[1]], [
+00030310: 7365 6c66 2e69 6e74 6572 696f 725b 325d  self.interior[2]
+00030320: 5d2c 0a20 2020 2020 2020 2023 2020 2020  ],.        #    
+00030330: 2020 2020 2020 2020 2063 3d27 6727 290a           c='g').
+00030340: 2020 2020 2020 2020 7820 3d20 5b5d 0a20          x = []. 
+00030350: 2020 2020 2020 2079 203d 205b 5d0a 2020         y = [].  
+00030360: 2020 2020 2020 7a20 3d20 5b5d 0a20 2020        z = [].   
+00030370: 2020 2020 2066 6f72 2070 6f69 6e74 782c       for pointx,
+00030380: 2070 6f69 6e74 792c 2070 6f69 6e74 7a20   pointy, pointz 
+00030390: 696e 2073 656c 662e 6469 7363 7265 7469  in self.discreti
+000303a0: 7a61 7469 6f6e 5f70 6f69 6e74 7328 6e75  zation_points(nu
+000303b0: 6d62 6572 5f70 6f69 6e74 733d 3235 293a  mber_points=25):
+000303c0: 0a20 2020 2020 2020 2020 2020 2078 2e61  .            x.a
+000303d0: 7070 656e 6428 706f 696e 7478 290a 2020  ppend(pointx).  
+000303e0: 2020 2020 2020 2020 2020 792e 6170 7065            y.appe
+000303f0: 6e64 2870 6f69 6e74 7929 0a20 2020 2020  nd(pointy).     
+00030400: 2020 2020 2020 207a 2e61 7070 656e 6428         z.append(
+00030410: 706f 696e 747a 290a 0a20 2020 2020 2020  pointz)..       
+00030420: 2061 782e 706c 6f74 2878 2c20 792c 207a   ax.plot(x, y, z
+00030430: 2c20 636f 6c6f 723d 636f 6c6f 722c 2061  , color=color, a
+00030440: 6c70 6861 3d61 6c70 6861 290a 2020 2020  lpha=alpha).    
+00030450: 2020 2020 6966 2065 6467 655f 656e 6473      if edge_ends
+00030460: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00030470: 6c66 2e73 7461 7274 2e70 6c6f 7428 6178  lf.start.plot(ax
+00030480: 3d61 7829 0a20 2020 2020 2020 2020 2020  =ax).           
+00030490: 2073 656c 662e 656e 642e 706c 6f74 2861   self.end.plot(a
+000304a0: 783d 6178 290a 0a20 2020 2020 2020 2069  x=ax)..        i
+000304b0: 6620 6564 6765 5f64 6972 6563 7469 6f6e  f edge_direction
+000304c0: 3a0a 2020 2020 2020 2020 2020 2020 782c  :.            x,
+000304d0: 2079 2c20 7a20 3d20 7365 6c66 2e70 6f69   y, z = self.poi
+000304e0: 6e74 5f61 745f 6162 7363 6973 7361 2830  nt_at_abscissa(0
+000304f0: 2e35 202a 2073 656c 662e 6c65 6e67 7468  .5 * self.length
+00030500: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
+00030510: 752c 2076 2c20 7720 3d20 302e 3035 202a  u, v, w = 0.05 *
+00030520: 2073 656c 662e 756e 6974 5f64 6972 6563   self.unit_direc
+00030530: 7469 6f6e 5f76 6563 746f 7228 302e 3520  tion_vector(0.5 
+00030540: 2a20 7365 6c66 2e6c 656e 6774 6828 2929  * self.length())
+00030550: 0a20 2020 2020 2020 2020 2020 2061 782e  .            ax.
+00030560: 7175 6976 6572 2878 2c20 792c 207a 2c20  quiver(x, y, z, 
+00030570: 752c 2076 2c20 772c 206c 656e 6774 683d  u, v, w, length=
+00030580: 7365 6c66 2e6c 656e 6774 6828 2920 2f20  self.length() / 
+00030590: 3130 302c 0a20 2020 2020 2020 2020 2020  100,.           
+000305a0: 2020 2020 2020 2020 2020 2061 7272 6f77             arrow
+000305b0: 5f6c 656e 6774 685f 7261 7469 6f3d 352c  _length_ratio=5,
+000305c0: 206e 6f72 6d61 6c69 7a65 3d54 7275 652c   normalize=True,
+000305d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000305e0: 2020 2020 2020 2070 6976 6f74 3d27 7469         pivot='ti
+000305f0: 7027 2c20 636f 6c6f 723d 636f 6c6f 7229  p', color=color)
+00030600: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00030610: 6178 0a0a 2020 2020 6465 6620 706c 6f74  ax..    def plot
+00030620: 3264 2873 656c 662c 2063 656e 7465 723a  2d(self, center:
+00030630: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3344   volmdlr.Point3D
+00030640: 203d 2076 6f6c 6d64 6c72 2e4f 3344 2c0a   = volmdlr.O3D,.
+00030650: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+00030660: 3364 3a20 766f 6c6d 646c 722e 5665 6374  3d: volmdlr.Vect
+00030670: 6f72 3344 203d 2076 6f6c 6d64 6c72 2e58  or3D = volmdlr.X
+00030680: 3344 2c20 7933 643a 2076 6f6c 6d64 6c72  3D, y3d: volmdlr
+00030690: 2e56 6563 746f 7233 4420 3d20 766f 6c6d  .Vector3D = volm
+000306a0: 646c 722e 5933 442c 0a20 2020 2020 2020  dlr.Y3D,.       
+000306b0: 2020 2020 2020 2020 6178 3d4e 6f6e 652c          ax=None,
+000306c0: 2063 6f6c 6f72 3d27 6b27 293a 0a0a 2020   color='k'):..  
+000306d0: 2020 2020 2020 6966 2061 7820 6973 204e        if ax is N
+000306e0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000306f0: 2066 6967 203d 2070 6c74 2e66 6967 7572   fig = plt.figur
+00030700: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+00030710: 6178 203d 2066 6967 2e61 6464 5f73 7562  ax = fig.add_sub
+00030720: 706c 6f74 2831 3131 2c20 7072 6f6a 6563  plot(111, projec
+00030730: 7469 6f6e 3d27 3364 2729 0a20 2020 2020  tion='3d').     
+00030740: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00030750: 2020 2020 2066 6967 203d 2061 782e 6669       fig = ax.fi
+00030760: 6775 7265 0a0a 2020 2020 2020 2020 2320  gure..        # 
+00030770: 544f 444f 3a20 456e 6861 6e63 6520 7468  TODO: Enhance th
+00030780: 6973 2070 6c6f 740a 2020 2020 2020 2020  is plot.        
+00030790: 6c20 3d20 7365 6c66 2e6c 656e 6774 6828  l = self.length(
+000307a0: 290a 2020 2020 2020 2020 7820 3d20 5b5d  ).        x = []
+000307b0: 0a20 2020 2020 2020 2079 203d 205b 5d0a  .        y = [].
+000307c0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+000307d0: 2072 616e 6765 2833 3029 3a0a 2020 2020   range(30):.    
+000307e0: 2020 2020 2020 2020 7020 3d20 7365 6c66          p = self
+000307f0: 2e70 6f69 6e74 5f61 745f 6162 7363 6973  .point_at_abscis
+00030800: 7361 2869 202f 2028 3239 2e29 202a 206c  sa(i / (29.) * l
+00030810: 290a 2020 2020 2020 2020 2020 2020 7869  ).            xi
+00030820: 2c20 7969 203d 2070 2e70 6c61 6e65 5f70  , yi = p.plane_p
+00030830: 726f 6a65 6374 696f 6e32 6428 6365 6e74  rojection2d(cent
+00030840: 6572 2c20 7833 642c 2079 3364 290a 2020  er, x3d, y3d).  
+00030850: 2020 2020 2020 2020 2020 782e 6170 7065            x.appe
+00030860: 6e64 2878 6929 0a20 2020 2020 2020 2020  nd(xi).         
+00030870: 2020 2079 2e61 7070 656e 6428 7969 290a     y.append(yi).
+00030880: 2020 2020 2020 2020 6178 2e70 6c6f 7428          ax.plot(
+00030890: 782c 2079 2c20 636f 6c6f 723d 636f 6c6f  x, y, color=colo
+000308a0: 7229 0a0a 2020 2020 2020 2020 7265 7475  r)..        retu
+000308b0: 726e 2061 780a 0a20 2020 2064 6566 2063  rn ax..    def c
+000308c0: 6f70 7928 7365 6c66 2c20 2a61 7267 732c  opy(self, *args,
+000308d0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+000308e0: 2020 2020 7265 7475 726e 2041 7263 3344      return Arc3D
+000308f0: 2873 656c 662e 7374 6172 742e 636f 7079  (self.start.copy
+00030900: 2829 2c20 7365 6c66 2e69 6e74 6572 696f  (), self.interio
+00030910: 722e 636f 7079 2829 2c20 7365 6c66 2e65  r.copy(), self.e
+00030920: 6e64 2e63 6f70 7928 2929 0a0a 2020 2020  nd.copy())..    
+00030930: 6465 6620 6672 616d 655f 6d61 7070 696e  def frame_mappin
+00030940: 675f 7061 7261 6d65 7465 7273 2873 656c  g_parameters(sel
+00030950: 662c 2066 7261 6d65 3a20 766f 6c6d 646c  f, frame: volmdl
+00030960: 722e 4672 616d 6533 442c 2073 6964 653a  r.Frame3D, side:
+00030970: 2073 7472 293a 0a20 2020 2020 2020 2069   str):.        i
+00030980: 6620 7369 6465 203d 3d20 276f 6c64 273a  f side == 'old':
+00030990: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+000309a0: 5f73 7461 7274 203d 2066 7261 6d65 2e6c  _start = frame.l
+000309b0: 6f63 616c 5f74 6f5f 676c 6f62 616c 5f63  ocal_to_global_c
+000309c0: 6f6f 7264 696e 6174 6573 2873 656c 662e  oordinates(self.
+000309d0: 7374 6172 742e 636f 7079 2829 290a 2020  start.copy()).  
+000309e0: 2020 2020 2020 2020 2020 6e65 775f 696e            new_in
+000309f0: 7465 7269 6f72 203d 2066 7261 6d65 2e6c  terior = frame.l
+00030a00: 6f63 616c 5f74 6f5f 676c 6f62 616c 5f63  ocal_to_global_c
+00030a10: 6f6f 7264 696e 6174 6573 2873 656c 662e  oordinates(self.
+00030a20: 696e 7465 7269 6f72 2e63 6f70 7928 2929  interior.copy())
+00030a30: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+00030a40: 5f65 6e64 203d 2066 7261 6d65 2e6c 6f63  _end = frame.loc
+00030a50: 616c 5f74 6f5f 676c 6f62 616c 5f63 6f6f  al_to_global_coo
+00030a60: 7264 696e 6174 6573 2873 656c 662e 656e  rdinates(self.en
+00030a70: 642e 636f 7079 2829 290a 2020 2020 2020  d.copy()).      
+00030a80: 2020 656c 6966 2073 6964 6520 3d3d 2027    elif side == '
+00030a90: 6e65 7727 3a0a 2020 2020 2020 2020 2020  new':.          
+00030aa0: 2020 6e65 775f 7374 6172 7420 3d20 6672    new_start = fr
+00030ab0: 616d 652e 676c 6f62 616c 5f74 6f5f 6c6f  ame.global_to_lo
+00030ac0: 6361 6c5f 636f 6f72 6469 6e61 7465 7328  cal_coordinates(
+00030ad0: 7365 6c66 2e73 7461 7274 2e63 6f70 7928  self.start.copy(
+00030ae0: 2929 0a20 2020 2020 2020 2020 2020 206e  )).            n
+00030af0: 6577 5f69 6e74 6572 696f 7220 3d20 6672  ew_interior = fr
+00030b00: 616d 652e 676c 6f62 616c 5f74 6f5f 6c6f  ame.global_to_lo
+00030b10: 6361 6c5f 636f 6f72 6469 6e61 7465 7328  cal_coordinates(
+00030b20: 7365 6c66 2e69 6e74 6572 696f 722e 636f  self.interior.co
+00030b30: 7079 2829 290a 2020 2020 2020 2020 2020  py()).          
+00030b40: 2020 6e65 775f 656e 6420 3d20 6672 616d    new_end = fram
+00030b50: 652e 676c 6f62 616c 5f74 6f5f 6c6f 6361  e.global_to_loca
+00030b60: 6c5f 636f 6f72 6469 6e61 7465 7328 7365  l_coordinates(se
+00030b70: 6c66 2e65 6e64 2e63 6f70 7928 2929 0a20  lf.end.copy()). 
+00030b80: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00030b90: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00030ba0: 616c 7565 4572 726f 7228 2773 6964 6520  alueError('side 
+00030bb0: 7661 6c75 6520 6e6f 7420 7661 6c69 642c  value not valid,
+00030bc0: 2070 6c65 6173 6520 7370 6563 6966 7927   please specify'
+00030bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030be0: 2020 2020 2020 2020 2020 2020 2020 2761                'a
+00030bf0: 2063 6f72 7265 6374 2076 616c 7565 3a20   correct value: 
+00030c00: 5c27 6f6c 645c 2720 6f72 205c 276e 6577  \'old\' or \'new
+00030c10: 5c27 2729 0a20 2020 2020 2020 2072 6574  \'').        ret
+00030c20: 7572 6e20 6e65 775f 7374 6172 742c 206e  urn new_start, n
+00030c30: 6577 5f69 6e74 6572 696f 722c 206e 6577  ew_interior, new
+00030c40: 5f65 6e64 0a0a 2020 2020 6465 6620 6672  _end..    def fr
+00030c50: 616d 655f 6d61 7070 696e 6728 7365 6c66  ame_mapping(self
+00030c60: 2c20 6672 616d 653a 2076 6f6c 6d64 6c72  , frame: volmdlr
+00030c70: 2e46 7261 6d65 3344 2c20 7369 6465 3a20  .Frame3D, side: 
+00030c80: 7374 7229 3a0a 2020 2020 2020 2020 2222  str):.        ""
+00030c90: 220a 2020 2020 2020 2020 4368 616e 6765  ".        Change
+00030ca0: 7320 7665 6374 6f72 2066 7261 6d65 5f6d  s vector frame_m
+00030cb0: 6170 7069 6e67 2061 6e64 2072 6574 7572  apping and retur
+00030cc0: 6e20 6120 6e65 7720 4172 6333 442e 0a0a  n a new Arc3D...
+00030cd0: 2020 2020 2020 2020 7369 6465 203d 2027          side = '
+00030ce0: 6f6c 6427 206f 7220 276e 6577 270a 2020  old' or 'new'.  
+00030cf0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00030d00: 2020 6e65 775f 7374 6172 742c 206e 6577    new_start, new
+00030d10: 5f69 6e74 6572 696f 722c 206e 6577 5f65  _interior, new_e
+00030d20: 6e64 203d 5c0a 2020 2020 2020 2020 2020  nd =\.          
+00030d30: 2020 7365 6c66 2e66 7261 6d65 5f6d 6170    self.frame_map
+00030d40: 7069 6e67 5f70 6172 616d 6574 6572 7328  ping_parameters(
+00030d50: 6672 616d 652c 2073 6964 6529 0a0a 2020  frame, side)..  
+00030d60: 2020 2020 2020 7265 7475 726e 2041 7263        return Arc
+00030d70: 3344 286e 6577 5f73 7461 7274 2c20 6e65  3D(new_start, ne
+00030d80: 775f 696e 7465 7269 6f72 2c20 6e65 775f  w_interior, new_
+00030d90: 656e 642c 206e 616d 653d 7365 6c66 2e6e  end, name=self.n
+00030da0: 616d 6529 0a0a 2020 2020 6465 6620 6672  ame)..    def fr
+00030db0: 616d 655f 6d61 7070 696e 675f 696e 706c  ame_mapping_inpl
+00030dc0: 6163 6528 7365 6c66 2c20 6672 616d 653a  ace(self, frame:
+00030dd0: 2076 6f6c 6d64 6c72 2e46 7261 6d65 3344   volmdlr.Frame3D
+00030de0: 2c20 7369 6465 3a20 7374 7229 3a0a 2020  , side: str):.  
+00030df0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00030e00: 2020 4368 616e 6765 7320 7665 6374 6f72    Changes vector
+00030e10: 2066 7261 6d65 5f6d 6170 7069 6e67 2061   frame_mapping a
+00030e20: 6e64 2074 6865 206f 626a 6563 7420 6973  nd the object is
+00030e30: 2075 7064 6174 6564 2069 6e70 6c61 6365   updated inplace
+00030e40: 2e0a 0a20 2020 2020 2020 2073 6964 6520  ...        side 
+00030e50: 3d20 276f 6c64 2720 6f72 2027 6e65 7727  = 'old' or 'new'
+00030e60: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00030e70: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00030e80: 726e 2822 2769 6e70 6c61 6365 2720 6d65  rn("'inplace' me
+00030e90: 7468 6f64 7320 6172 6520 6465 7072 6563  thods are deprec
+00030ea0: 6174 6564 2e20 5573 6520 6120 6e6f 7420  ated. Use a not 
+00030eb0: 696e 706c 6163 6520 6d65 7468 6f64 2069  inplace method i
+00030ec0: 6e73 7465 6164 2e22 2c20 4465 7072 6563  nstead.", Deprec
+00030ed0: 6174 696f 6e57 6172 6e69 6e67 290a 0a20  ationWarning).. 
+00030ee0: 2020 2020 2020 206e 6577 5f73 7461 7274         new_start
+00030ef0: 2c20 6e65 775f 696e 7465 7269 6f72 2c20  , new_interior, 
+00030f00: 6e65 775f 656e 6420 3d20 5c0a 2020 2020  new_end = \.    
+00030f10: 2020 2020 2020 2020 7365 6c66 2e66 7261          self.fra
+00030f20: 6d65 5f6d 6170 7069 6e67 5f70 6172 616d  me_mapping_param
+00030f30: 6574 6572 7328 6672 616d 652c 2073 6964  eters(frame, sid
+00030f40: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
+00030f50: 7374 6172 742c 2073 656c 662e 696e 7465  start, self.inte
+00030f60: 7269 6f72 2c20 7365 6c66 2e65 6e64 203d  rior, self.end =
+00030f70: 206e 6577 5f73 7461 7274 2c20 6e65 775f   new_start, new_
+00030f80: 696e 7465 7269 6f72 2c20 6e65 775f 656e  interior, new_en
+00030f90: 640a 2020 2020 2020 2020 7365 6c66 2e5f  d.        self._
+00030fa0: 6262 6f78 203d 204e 6f6e 650a 0a20 2020  bbox = None..   
+00030fb0: 2064 6566 2061 6273 6369 7373 6128 7365   def abscissa(se
+00030fc0: 6c66 2c20 706f 696e 7433 643a 2076 6f6c  lf, point3d: vol
+00030fd0: 6d64 6c72 2e50 6f69 6e74 3344 293a 0a20  mdlr.Point3D):. 
+00030fe0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00030ff0: 2020 2043 616c 6375 6c61 7465 7320 7468     Calculates th
+00031000: 6520 6162 7363 6973 7361 2067 6976 656e  e abscissa given
+00031010: 2061 2070 6f69 6e74 2069 6e20 7468 6520   a point in the 
+00031020: 4172 6333 442e 0a0a 2020 2020 2020 2020  Arc3D...        
+00031030: 3a70 6172 616d 2070 6f69 6e74 3364 3a20  :param point3d: 
+00031040: 706f 696e 7420 746f 2063 616c 6375 6c61  point to calcula
+00031050: 7465 2074 6865 2061 6273 6369 7373 612e  te the abscissa.
+00031060: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00031070: 3a20 636f 7272 6573 706f 6e64 696e 6720  : corresponding 
+00031080: 6162 7363 6973 7361 2e0a 2020 2020 2020  abscissa..      
+00031090: 2020 2222 220a 2020 2020 2020 2020 782c    """.        x,
+000310a0: 2079 2c20 5f20 3d20 7365 6c66 2e66 7261   y, _ = self.fra
+000310b0: 6d65 2e67 6c6f 6261 6c5f 746f 5f6c 6f63  me.global_to_loc
+000310c0: 616c 5f63 6f6f 7264 696e 6174 6573 2870  al_coordinates(p
+000310d0: 6f69 6e74 3364 290a 2020 2020 2020 2020  oint3d).        
+000310e0: 7531 203d 2078 202f 2073 656c 662e 7261  u1 = x / self.ra
+000310f0: 6469 7573 0a20 2020 2020 2020 2075 3220  dius.        u2 
+00031100: 3d20 7920 2f20 7365 6c66 2e72 6164 6975  = y / self.radiu
+00031110: 730a 2020 2020 2020 2020 7468 6574 6120  s.        theta 
+00031120: 3d20 766f 6c6d 646c 722e 6765 6f6d 6574  = volmdlr.geomet
+00031130: 7279 2e73 696e 5f63 6f73 5f61 6e67 6c65  ry.sin_cos_angle
+00031140: 2875 312c 2075 3229 0a0a 2020 2020 2020  (u1, u2)..      
+00031150: 2020 7265 7475 726e 2073 656c 662e 7261    return self.ra
+00031160: 6469 7573 202a 2061 6273 2874 6865 7461  dius * abs(theta
+00031170: 290a 0a20 2020 2064 6566 2073 706c 6974  )..    def split
+00031180: 2873 656c 662c 2073 706c 6974 5f70 6f69  (self, split_poi
+00031190: 6e74 3a20 766f 6c6d 646c 722e 506f 696e  nt: volmdlr.Poin
+000311a0: 7433 4429 3a0a 2020 2020 2020 2020 2222  t3D):.        ""
+000311b0: 220a 2020 2020 2020 2020 5370 6c69 7473  ".        Splits
+000311c0: 2074 6865 2041 7263 3244 2069 6e20 7477   the Arc2D in tw
+000311d0: 6f20 6174 2061 2067 6976 656e 2070 6f69  o at a given poi
+000311e0: 6e74 2e0a 0a20 2020 2020 2020 203a 7061  nt...        :pa
+000311f0: 7261 6d20 7370 6c69 745f 706f 696e 743a  ram split_point:
+00031200: 2073 706c 6974 7469 6e67 2070 6f69 6e74   splitting point
+00031210: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00031220: 3a20 7477 6f20 4172 6332 442e 0a20 2020  : two Arc2D..   
+00031230: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00031240: 2061 6273 6369 7373 6120 3d20 7365 6c66   abscissa = self
+00031250: 2e61 6273 6369 7373 6128 7370 6c69 745f  .abscissa(split_
+00031260: 706f 696e 7429 0a0a 2020 2020 2020 2020  point)..        
+00031270: 7265 7475 726e 205b 4172 6333 4428 7365  return [Arc3D(se
+00031280: 6c66 2e73 7461 7274 2c0a 2020 2020 2020  lf.start,.      
+00031290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000312a0: 7365 6c66 2e70 6f69 6e74 5f61 745f 6162  self.point_at_ab
+000312b0: 7363 6973 7361 2830 2e35 202a 2061 6273  scissa(0.5 * abs
+000312c0: 6369 7373 6129 2c0a 2020 2020 2020 2020  cissa),.        
+000312d0: 2020 2020 2020 2020 2020 2020 2020 7370                sp
+000312e0: 6c69 745f 706f 696e 7429 2c0a 2020 2020  lit_point),.    
+000312f0: 2020 2020 2020 2020 2020 2020 4172 6333              Arc3
+00031300: 4428 7370 6c69 745f 706f 696e 742c 0a20  D(split_point,. 
+00031310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031320: 2020 2020 2073 656c 662e 706f 696e 745f       self.point_
+00031330: 6174 5f61 6273 6369 7373 6128 312e 3520  at_abscissa(1.5 
+00031340: 2a20 6162 7363 6973 7361 292c 0a20 2020  * abscissa),.   
+00031350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031360: 2020 2073 656c 662e 656e 6429 0a20 2020     self.end).   
+00031370: 2020 2020 2020 2020 2020 2020 205d 0a0a               ]..
+00031380: 2020 2020 6465 6620 746f 5f32 6428 7365      def to_2d(se
+00031390: 6c66 2c20 706c 616e 655f 6f72 6967 696e  lf, plane_origin
+000313a0: 2c20 782c 2079 293a 0a20 2020 2020 2020  , x, y):.       
+000313b0: 2022 2222 0a20 2020 2020 2020 2054 7261   """.        Tra
+000313c0: 6e73 666f 726d 7320 6120 4172 6333 4420  nsforms a Arc3D 
+000313d0: 696e 746f 2061 6e20 4172 6332 442c 2067  into an Arc2D, g
+000313e0: 6976 656e 2061 6e20 706c 616e 6520 6f72  iven an plane or
+000313f0: 6967 696e 2061 6e64 2061 2075 2061 6e64  igin and a u and
+00031400: 2076 2070 6c61 6e65 2076 6563 746f 722e   v plane vector.
+00031410: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00031420: 2070 6c61 6e65 5f6f 7269 6769 6e3a 2070   plane_origin: p
+00031430: 6c61 6e65 206f 7269 6769 6e2e 0a20 2020  lane origin..   
+00031440: 2020 2020 203a 7061 7261 6d20 783a 2070       :param x: p
+00031450: 6c61 6e65 2075 2076 6563 746f 722e 0a20  lane u vector.. 
+00031460: 2020 2020 2020 203a 7061 7261 6d20 793a         :param y:
+00031470: 2070 6c61 6e65 2076 2076 6563 746f 722e   plane v vector.
+00031480: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00031490: 3a20 4172 6332 442e 0a20 2020 2020 2020  : Arc2D..       
+000314a0: 2022 2222 0a20 2020 2020 2020 2070 7320   """.        ps 
+000314b0: 3d20 7365 6c66 2e73 7461 7274 2e74 6f5f  = self.start.to_
+000314c0: 3264 2870 6c61 6e65 5f6f 7269 6769 6e2c  2d(plane_origin,
+000314d0: 2078 2c20 7929 0a20 2020 2020 2020 2070   x, y).        p
+000314e0: 6920 3d20 7365 6c66 2e69 6e74 6572 696f  i = self.interio
+000314f0: 722e 746f 5f32 6428 706c 616e 655f 6f72  r.to_2d(plane_or
+00031500: 6967 696e 2c20 782c 2079 290a 2020 2020  igin, x, y).    
+00031510: 2020 2020 7065 203d 2073 656c 662e 656e      pe = self.en
+00031520: 642e 746f 5f32 6428 706c 616e 655f 6f72  d.to_2d(plane_or
+00031530: 6967 696e 2c20 782c 2079 290a 2020 2020  igin, x, y).    
+00031540: 2020 2020 7265 7475 726e 2041 7263 3244      return Arc2D
+00031550: 2870 732c 2070 692c 2070 652c 206e 616d  (ps, pi, pe, nam
+00031560: 653d 7365 6c66 2e6e 616d 6529 0a0a 2020  e=self.name)..  
+00031570: 2020 6465 6620 6d69 6e69 6d75 6d5f 6469    def minimum_di
+00031580: 7374 616e 6365 5f70 6f69 6e74 735f 6172  stance_points_ar
+00031590: 6328 7365 6c66 2c20 6f74 6865 725f 6172  c(self, other_ar
+000315a0: 6329 3a0a 0a20 2020 2020 2020 2075 3120  c):..        u1 
+000315b0: 3d20 7365 6c66 2e73 7461 7274 202d 2073  = self.start - s
+000315c0: 656c 662e 6365 6e74 6572 0a20 2020 2020  elf.center.     
+000315d0: 2020 2075 312e 6e6f 726d 616c 697a 6528     u1.normalize(
+000315e0: 290a 2020 2020 2020 2020 7532 203d 2073  ).        u2 = s
+000315f0: 656c 662e 6e6f 726d 616c 2e63 726f 7373  elf.normal.cross
+00031600: 2875 3129 0a0a 2020 2020 2020 2020 7720  (u1)..        w 
+00031610: 3d20 6f74 6865 725f 6172 632e 6365 6e74  = other_arc.cent
+00031620: 6572 202d 2073 656c 662e 6365 6e74 6572  er - self.center
+00031630: 0a0a 2020 2020 2020 2020 7533 203d 206f  ..        u3 = o
+00031640: 7468 6572 5f61 7263 2e73 7461 7274 202d  ther_arc.start -
+00031650: 206f 7468 6572 5f61 7263 2e63 656e 7465   other_arc.cente
+00031660: 720a 2020 2020 2020 2020 7533 2e6e 6f72  r.        u3.nor
+00031670: 6d61 6c69 7a65 2829 0a20 2020 2020 2020  malize().       
+00031680: 2075 3420 3d20 6f74 6865 725f 6172 632e   u4 = other_arc.
+00031690: 6e6f 726d 616c 2e63 726f 7373 2875 3329  normal.cross(u3)
+000316a0: 0a0a 2020 2020 2020 2020 7231 2c20 7232  ..        r1, r2
+000316b0: 203d 2073 656c 662e 7261 6469 7573 2c20   = self.radius, 
+000316c0: 6f74 6865 725f 6172 632e 7261 6469 7573  other_arc.radius
+000316d0: 0a0a 2020 2020 2020 2020 612c 2062 2c20  ..        a, b, 
+000316e0: 632c 2064 203d 2075 312e 646f 7428 7531  c, d = u1.dot(u1
+000316f0: 292c 2075 312e 646f 7428 7532 292c 2075  ), u1.dot(u2), u
+00031700: 312e 646f 7428 7533 292c 2075 312e 646f  1.dot(u3), u1.do
+00031710: 7428 7534 290a 2020 2020 2020 2020 652c  t(u4).        e,
+00031720: 2066 2c20 6720 3d20 7532 2e64 6f74 2875   f, g = u2.dot(u
+00031730: 3229 2c20 7532 2e64 6f74 2875 3329 2c20  2), u2.dot(u3), 
+00031740: 7532 2e64 6f74 2875 3429 0a20 2020 2020  u2.dot(u4).     
+00031750: 2020 2068 2c20 6920 3d20 7533 2e64 6f74     h, i = u3.dot
+00031760: 2875 3329 2c20 7533 2e64 6f74 2875 3429  (u3), u3.dot(u4)
+00031770: 0a20 2020 2020 2020 206a 203d 2075 342e  .        j = u4.
+00031780: 646f 7428 7534 290a 2020 2020 2020 2020  dot(u4).        
+00031790: 6b2c 206c 2c20 6d2c 206e 2c20 6f20 3d20  k, l, m, n, o = 
+000317a0: 772e 646f 7428 7531 292c 2077 2e64 6f74  w.dot(u1), w.dot
+000317b0: 2875 3229 2c20 772e 646f 7428 7533 292c  (u2), w.dot(u3),
+000317c0: 2077 2e64 6f74 2875 3429 2c20 772e 646f   w.dot(u4), w.do
+000317d0: 7428 7729 0a0a 2020 2020 2020 2020 6465  t(w)..        de
+000317e0: 6620 6469 7374 616e 6365 5f73 7175 6172  f distance_squar
+000317f0: 6564 2878 293a 0a20 2020 2020 2020 2020  ed(x):.         
+00031800: 2020 2072 6574 7572 6e20 2861 202a 2028     return (a * (
+00031810: 286d 6174 682e 636f 7328 785b 305d 2929  (math.cos(x[0]))
+00031820: 202a 2a20 3229 202a 2072 3120 2a2a 2032   ** 2) * r1 ** 2
+00031830: 202b 2065 202a 2028 0a20 2020 2020 2020   + e * (.       
+00031840: 2020 2020 2020 2020 2020 2020 2028 6d61               (ma
+00031850: 7468 2e73 696e 2878 5b30 5d29 2920 2a2a  th.sin(x[0])) **
+00031860: 2032 2920 2a20 7231 202a 2a20 320a 2020   2) * r1 ** 2.  
+00031870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031880: 2020 2b20 6f20 2b20 6820 2a20 2828 6d61    + o + h * ((ma
+00031890: 7468 2e63 6f73 2878 5b31 5d29 2920 2a2a  th.cos(x[1])) **
+000318a0: 2032 2920 2a20 7232 202a 2a20 3220 2b20   2) * r2 ** 2 + 
+000318b0: 6a20 2a20 280a 2020 2020 2020 2020 2020  j * (.          
+000318c0: 2020 2020 2020 286d 6174 682e 7369 6e28        (math.sin(
+000318d0: 785b 315d 2929 202a 2a20 3229 202a 2072  x[1])) ** 2) * r
+000318e0: 3220 2a2a 2032 0a20 2020 2020 2020 2020  2 ** 2.         
+000318f0: 2020 2020 2020 202b 2062 202a 206d 6174         + b * mat
+00031900: 682e 7369 6e28 3220 2a20 785b 305d 2920  h.sin(2 * x[0]) 
+00031910: 2a20 7231 202a 2a20 3220 2d20 3220 2a20  * r1 ** 2 - 2 * 
+00031920: 7231 202a 206d 6174 682e 636f 7328 0a20  r1 * math.cos(. 
+00031930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031940: 2020 2020 2020 2078 5b30 5d29 202a 206b         x[0]) * k
+00031950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031960: 202d 2032 202a 2072 3120 2a20 7232 202a   - 2 * r1 * r2 *
+00031970: 206d 6174 682e 636f 7328 785b 305d 2920   math.cos(x[0]) 
+00031980: 2a20 6d61 7468 2e63 6f73 2878 5b31 5d29  * math.cos(x[1])
+00031990: 202a 2063 0a20 2020 2020 2020 2020 2020   * c.           
+000319a0: 2020 2020 202d 2032 202a 2072 3120 2a20       - 2 * r1 * 
+000319b0: 7232 202a 206d 6174 682e 636f 7328 785b  r2 * math.cos(x[
+000319c0: 305d 2920 2a20 6d61 7468 2e73 696e 280a  0]) * math.sin(.
+000319d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000319e0: 2020 2020 2020 2020 785b 315d 2920 2a20          x[1]) * 
+000319f0: 6420 2d20 3220 2a20 7231 202a 206d 6174  d - 2 * r1 * mat
+00031a00: 682e 7369 6e28 785b 305d 2920 2a20 6c0a  h.sin(x[0]) * l.
+00031a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031a20: 2d20 3220 2a20 7231 202a 2072 3220 2a20  - 2 * r1 * r2 * 
+00031a30: 6d61 7468 2e73 696e 2878 5b30 5d29 202a  math.sin(x[0]) *
+00031a40: 206d 6174 682e 636f 7328 785b 315d 2920   math.cos(x[1]) 
+00031a50: 2a20 660a 2020 2020 2020 2020 2020 2020  * f.            
+00031a60: 2020 2020 2d20 3220 2a20 7231 202a 2072      - 2 * r1 * r
+00031a70: 3220 2a20 6d61 7468 2e73 696e 2878 5b30  2 * math.sin(x[0
+00031a80: 5d29 202a 206d 6174 682e 7369 6e28 0a20  ]) * math.sin(. 
+00031a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031aa0: 2020 2020 2020 2078 5b31 5d29 202a 2067         x[1]) * g
+00031ab0: 202b 2032 202a 2072 3220 2a20 6d61 7468   + 2 * r2 * math
+00031ac0: 2e63 6f73 2878 5b31 5d29 202a 206d 0a20  .cos(x[1]) * m. 
+00031ad0: 2020 2020 2020 2020 2020 2020 2020 202b                 +
+00031ae0: 2032 202a 2072 3220 2a20 6d61 7468 2e73   2 * r2 * math.s
+00031af0: 696e 2878 5b31 5d29 202a 206e 202b 2069  in(x[1]) * n + i
+00031b00: 202a 206d 6174 682e 7369 6e28 0a20 2020   * math.sin(.   
+00031b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031b20: 2020 2020 2032 202a 2078 5b31 5d29 202a       2 * x[1]) *
+00031b30: 2072 3220 2a2a 2032 290a 0a20 2020 2020   r2 ** 2)..     
+00031b40: 2020 2078 3031 203d 206e 7079 2e61 7272     x01 = npy.arr
+00031b50: 6179 285b 7365 6c66 2e61 6e67 6c65 202f  ay([self.angle /
+00031b60: 2032 2c20 6f74 6865 725f 6172 632e 616e   2, other_arc.an
+00031b70: 676c 6520 2f20 325d 290a 0a20 2020 2020  gle / 2])..     
+00031b80: 2020 2072 6573 3120 3d20 7363 702e 6f70     res1 = scp.op
+00031b90: 7469 6d69 7a65 2e6c 6561 7374 5f73 7175  timize.least_squ
+00031ba0: 6172 6573 2864 6973 7461 6e63 655f 7371  ares(distance_sq
+00031bb0: 7561 7265 642c 2078 3031 2c0a 2020 2020  uared, x01,.    
+00031bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031be0: 2020 2020 2020 626f 756e 6473 3d5b 2830        bounds=[(0
+00031bf0: 2c20 3029 2c20 280a 2020 2020 2020 2020  , 0), (.        
+00031c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031c20: 2020 2020 2020 7365 6c66 2e61 6e67 6c65        self.angle
+00031c30: 2c20 6f74 6865 725f 6172 632e 616e 676c  , other_arc.angl
+00031c40: 6529 5d29 0a0a 2020 2020 2020 2020 7031  e)])..        p1
+00031c50: 203d 2073 656c 662e 706f 696e 745f 6174   = self.point_at
+00031c60: 5f61 6273 6369 7373 6128 7265 7331 2e78  _abscissa(res1.x
+00031c70: 5b30 5d20 2a20 7231 290a 2020 2020 2020  [0] * r1).      
+00031c80: 2020 7032 203d 206f 7468 6572 5f61 7263    p2 = other_arc
+00031c90: 2e70 6f69 6e74 5f61 745f 6162 7363 6973  .point_at_abscis
+00031ca0: 7361 2872 6573 312e 785b 315d 202a 2072  sa(res1.x[1] * r
+00031cb0: 3229 0a0a 2020 2020 2020 2020 7265 7475  2)..        retu
+00031cc0: 726e 2070 312c 2070 320a 0a20 2020 2064  rn p1, p2..    d
+00031cd0: 6566 206d 696e 696d 756d 5f64 6973 7461  ef minimum_dista
+00031ce0: 6e63 655f 706f 696e 7473 5f6c 696e 6528  nce_points_line(
+00031cf0: 7365 6c66 2c20 6f74 6865 725f 6c69 6e65  self, other_line
+00031d00: 293a 0a0a 2020 2020 2020 2020 7520 3d20  ):..        u = 
+00031d10: 6f74 6865 725f 6c69 6e65 2e64 6972 6563  other_line.direc
+00031d20: 7469 6f6e 5f76 6563 746f 7228 290a 2020  tion_vector().  
+00031d30: 2020 2020 2020 6b20 3d20 7365 6c66 2e73        k = self.s
+00031d40: 7461 7274 202d 2073 656c 662e 6365 6e74  tart - self.cent
+00031d50: 6572 0a20 2020 2020 2020 206b 2e6e 6f72  er.        k.nor
+00031d60: 6d61 6c69 7a65 2829 0a20 2020 2020 2020  malize().       
+00031d70: 2077 203d 2073 656c 662e 6365 6e74 6572   w = self.center
+00031d80: 202d 206f 7468 6572 5f6c 696e 652e 7374   - other_line.st
+00031d90: 6172 740a 2020 2020 2020 2020 7620 3d20  art.        v = 
+00031da0: 7365 6c66 2e6e 6f72 6d61 6c2e 6372 6f73  self.normal.cros
+00031db0: 7328 6b29 0a0a 2020 2020 2020 2020 7220  s(k)..        r 
+00031dc0: 3d20 7365 6c66 2e72 6164 6975 730a 0a20  = self.radius.. 
+00031dd0: 2020 2020 2020 2061 203d 2075 2e64 6f74         a = u.dot
+00031de0: 2875 290a 2020 2020 2020 2020 6220 3d20  (u).        b = 
+00031df0: 752e 646f 7428 7629 0a20 2020 2020 2020  u.dot(v).       
+00031e00: 2063 203d 2075 2e64 6f74 286b 290a 2020   c = u.dot(k).  
+00031e10: 2020 2020 2020 6420 3d20 762e 646f 7428        d = v.dot(
+00031e20: 7629 0a20 2020 2020 2020 2065 203d 2076  v).        e = v
+00031e30: 2e64 6f74 286b 290a 2020 2020 2020 2020  .dot(k).        
+00031e40: 6620 3d20 6b2e 646f 7428 6b29 0a20 2020  f = k.dot(k).   
+00031e50: 2020 2020 2067 203d 2077 2e64 6f74 2875       g = w.dot(u
+00031e60: 290a 2020 2020 2020 2020 6820 3d20 772e  ).        h = w.
+00031e70: 646f 7428 7629 0a20 2020 2020 2020 2069  dot(v).        i
+00031e80: 203d 2077 2e64 6f74 286b 290a 2020 2020   = w.dot(k).    
+00031e90: 2020 2020 6a20 3d20 772e 646f 7428 7729      j = w.dot(w)
+00031ea0: 0a0a 2020 2020 2020 2020 2320 7820 3d20  ..        # x = 
+00031eb0: 2873 2c20 7468 6574 6129 0a20 2020 2020  (s, theta).     
+00031ec0: 2020 2064 6566 2064 6973 7461 6e63 655f     def distance_
+00031ed0: 7371 7561 7265 6428 7829 3a0a 2020 2020  squared(x):.    
+00031ee0: 2020 2020 2020 2020 7265 7475 726e 2028          return (
+00031ef0: 6120 2a20 785b 305d 202a 2a20 3220 2b20  a * x[0] ** 2 + 
+00031f00: 6a20 2b20 6420 2a20 280a 2020 2020 2020  j + d * (.      
+00031f10: 2020 2020 2020 2020 2020 2020 2020 286d                (m
+00031f20: 6174 682e 7369 6e28 785b 315d 2929 202a  ath.sin(x[1])) *
+00031f30: 2a20 3229 202a 2072 202a 2a20 3220 2b20  * 2) * r ** 2 + 
+00031f40: 6620 2a20 280a 2020 2020 2020 2020 2020  f * (.          
+00031f50: 2020 2020 2020 286d 6174 682e 636f 7328        (math.cos(
+00031f60: 785b 315d 2929 202a 2a20 3229 202a 2072  x[1])) ** 2) * r
+00031f70: 202a 2a20 320a 2020 2020 2020 2020 2020   ** 2.          
+00031f80: 2020 2020 2020 2d20 3220 2a20 785b 305d        - 2 * x[0]
+00031f90: 202a 2067 202d 2032 202a 2078 5b30 5d20   * g - 2 * x[0] 
+00031fa0: 2a20 7220 2a20 6d61 7468 2e73 696e 2878  * r * math.sin(x
+00031fb0: 5b31 5d29 202a 2062 202d 2032 202a 2078  [1]) * b - 2 * x
+00031fc0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00031fd0: 2020 2020 2020 2020 2020 305d 202a 2072            0] * r
+00031fe0: 202a 206d 6174 682e 636f 7328 785b 315d   * math.cos(x[1]
+00031ff0: 2920 2a20 630a 2020 2020 2020 2020 2020  ) * c.          
+00032000: 2020 2020 2020 2b20 3220 2a20 7220 2a20        + 2 * r * 
+00032010: 6d61 7468 2e73 696e 2878 5b31 5d29 202a  math.sin(x[1]) *
+00032020: 2068 202b 2032 202a 2072 202a 206d 6174   h + 2 * r * mat
+00032030: 682e 636f 7328 785b 315d 2920 2a20 690a  h.cos(x[1]) * i.
+00032040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032050: 2b20 6d61 7468 2e73 696e 2832 202a 2078  + math.sin(2 * x
+00032060: 5b31 5d29 202a 2065 202a 2072 202a 2a20  [1]) * e * r ** 
+00032070: 3229 0a0a 2020 2020 2020 2020 7830 3120  2)..        x01 
+00032080: 3d20 6e70 792e 6172 7261 7928 5b30 2e35  = npy.array([0.5
+00032090: 2c20 7365 6c66 2e61 6e67 6c65 202f 2032  , self.angle / 2
+000320a0: 5d29 0a20 2020 2020 2020 2078 3032 203d  ]).        x02 =
+000320b0: 206e 7079 2e61 7272 6179 285b 302e 352c   npy.array([0.5,
+000320c0: 2030 5d29 0a20 2020 2020 2020 2078 3033   0]).        x03
+000320d0: 203d 206e 7079 2e61 7272 6179 285b 302e   = npy.array([0.
+000320e0: 352c 2073 656c 662e 616e 676c 655d 290a  5, self.angle]).
+000320f0: 0a20 2020 2020 2020 2072 6573 3120 3d20  .        res1 = 
+00032100: 7363 702e 6f70 7469 6d69 7a65 2e6c 6561  scp.optimize.lea
+00032110: 7374 5f73 7175 6172 6573 2864 6973 7461  st_squares(dista
+00032120: 6e63 655f 7371 7561 7265 642c 2078 3031  nce_squared, x01
+00032130: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00032140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032150: 2020 2020 2020 2020 2020 2020 626f 756e              boun
+00032160: 6473 3d5b 2830 2c20 3029 2c20 2831 2c20  ds=[(0, 0), (1, 
+00032170: 7365 6c66 2e61 6e67 6c65 295d 290a 2020  self.angle)]).  
+00032180: 2020 2020 2020 7265 7332 203d 2073 6370        res2 = scp
+00032190: 2e6f 7074 696d 697a 652e 6c65 6173 745f  .optimize.least_
+000321a0: 7371 7561 7265 7328 6469 7374 616e 6365  squares(distance
+000321b0: 5f73 7175 6172 6564 2c20 7830 322c 0a20  _squared, x02,. 
+000321c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000321d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000321e0: 2020 2020 2020 2020 2062 6f75 6e64 733d           bounds=
+000321f0: 5b28 302c 2030 292c 2028 312c 2073 656c  [(0, 0), (1, sel
+00032200: 662e 616e 676c 6529 5d29 0a20 2020 2020  f.angle)]).     
+00032210: 2020 2072 6573 3320 3d20 7363 702e 6f70     res3 = scp.op
+00032220: 7469 6d69 7a65 2e6c 6561 7374 5f73 7175  timize.least_squ
+00032230: 6172 6573 2864 6973 7461 6e63 655f 7371  ares(distance_sq
+00032240: 7561 7265 642c 2078 3033 2c0a 2020 2020  uared, x03,.    
+00032250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032270: 2020 2020 2020 626f 756e 6473 3d5b 2830        bounds=[(0
+00032280: 2c20 3029 2c20 2831 2c20 7365 6c66 2e61  , 0), (1, self.a
+00032290: 6e67 6c65 295d 290a 0a20 2020 2020 2020  ngle)])..       
+000322a0: 2070 3120 3d20 6f74 6865 725f 6c69 6e65   p1 = other_line
+000322b0: 2e70 6f69 6e74 5f61 745f 6162 7363 6973  .point_at_abscis
+000322c0: 7361 280a 2020 2020 2020 2020 2020 2020  sa(.            
+000322d0: 7265 7331 2e78 5b30 5d20 2a20 6f74 6865  res1.x[0] * othe
+000322e0: 725f 6c69 6e65 2e6c 656e 6774 6828 2929  r_line.length())
+000322f0: 0a20 2020 2020 2020 2070 3220 3d20 7365  .        p2 = se
+00032300: 6c66 2e70 6f69 6e74 5f61 745f 6162 7363  lf.point_at_absc
+00032310: 6973 7361 2872 6573 312e 785b 315d 202a  issa(res1.x[1] *
+00032320: 2072 290a 0a20 2020 2020 2020 2072 6573   r)..        res
+00032330: 203d 205b 7265 7332 2c20 7265 7333 5d0a   = [res2, res3].
+00032340: 2020 2020 2020 2020 666f 7220 636f 7570          for coup
+00032350: 6c65 2069 6e20 7265 733a 0a20 2020 2020  le in res:.     
+00032360: 2020 2020 2020 2070 7465 7374 3120 3d20         ptest1 = 
+00032370: 6f74 6865 725f 6c69 6e65 2e70 6f69 6e74  other_line.point
+00032380: 5f61 745f 6162 7363 6973 7361 280a 2020  _at_abscissa(.  
+00032390: 2020 2020 2020 2020 2020 2020 2020 636f                co
+000323a0: 7570 6c65 2e78 5b30 5d20 2a20 6f74 6865  uple.x[0] * othe
+000323b0: 725f 6c69 6e65 2e6c 656e 6774 6828 2929  r_line.length())
+000323c0: 0a20 2020 2020 2020 2020 2020 2070 7465  .            pte
+000323d0: 7374 3220 3d20 7365 6c66 2e70 6f69 6e74  st2 = self.point
+000323e0: 5f61 745f 6162 7363 6973 7361 2863 6f75  _at_abscissa(cou
+000323f0: 706c 652e 785b 315d 202a 2072 290a 2020  ple.x[1] * r).  
+00032400: 2020 2020 2020 2020 2020 6474 6573 7420            dtest 
+00032410: 3d20 7074 6573 7431 2e70 6f69 6e74 5f64  = ptest1.point_d
+00032420: 6973 7461 6e63 6528 7074 6573 7432 290a  istance(ptest2).
+00032430: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+00032440: 7465 7374 203c 2064 3a0a 2020 2020 2020  test < d:.      
+00032450: 2020 2020 2020 2020 2020 7031 2c20 7032            p1, p2
+00032460: 203d 2070 7465 7374 312c 2070 7465 7374   = ptest1, ptest
+00032470: 320a 0a20 2020 2020 2020 2072 6574 7572  2..        retur
+00032480: 6e20 7031 2c20 7032 0a0a 2020 2020 6465  n p1, p2..    de
+00032490: 6620 6d69 6e69 6d75 6d5f 6469 7374 616e  f minimum_distan
+000324a0: 6365 2873 656c 662c 2065 6c65 6d65 6e74  ce(self, element
+000324b0: 2c20 7265 7475 726e 5f70 6f69 6e74 733d  , return_points=
+000324c0: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+000324d0: 6966 2065 6c65 6d65 6e74 2e5f 5f63 6c61  if element.__cla
+000324e0: 7373 5f5f 2069 7320 4172 6333 4420 6f72  ss__ is Arc3D or
+000324f0: 2065 6c65 6d65 6e74 2e5f 5f63 6c61 7373   element.__class
+00032500: 5f5f 2e5f 5f6e 616d 655f 5f20 3d3d 2027  __.__name__ == '
+00032510: 4369 7263 6c65 3344 273a 0a20 2020 2020  Circle3D':.     
+00032520: 2020 2020 2020 2070 312c 2070 3220 3d20         p1, p2 = 
+00032530: 7365 6c66 2e6d 696e 696d 756d 5f64 6973  self.minimum_dis
+00032540: 7461 6e63 655f 706f 696e 7473 5f61 7263  tance_points_arc
+00032550: 2865 6c65 6d65 6e74 290a 2020 2020 2020  (element).      
+00032560: 2020 2020 2020 6966 2072 6574 7572 6e5f        if return_
+00032570: 706f 696e 7473 3a0a 2020 2020 2020 2020  points:.        
+00032580: 2020 2020 2020 2020 7265 7475 726e 2070          return p
+00032590: 312e 706f 696e 745f 6469 7374 616e 6365  1.point_distance
+000325a0: 2870 3229 2c20 7031 2c20 7032 0a20 2020  (p2), p1, p2.   
+000325b0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000325c0: 7031 2e70 6f69 6e74 5f64 6973 7461 6e63  p1.point_distanc
+000325d0: 6528 7032 290a 0a20 2020 2020 2020 2069  e(p2)..        i
+000325e0: 6620 656c 656d 656e 742e 5f5f 636c 6173  f element.__clas
+000325f0: 735f 5f20 6973 204c 696e 6553 6567 6d65  s__ is LineSegme
+00032600: 6e74 3344 3a0a 2020 2020 2020 2020 2020  nt3D:.          
+00032610: 2020 7074 312c 2070 7432 203d 2073 656c    pt1, pt2 = sel
+00032620: 662e 6d69 6e69 6d75 6d5f 6469 7374 616e  f.minimum_distan
+00032630: 6365 5f70 6f69 6e74 735f 6c69 6e65 2865  ce_points_line(e
+00032640: 6c65 6d65 6e74 290a 2020 2020 2020 2020  lement).        
+00032650: 2020 2020 6966 2072 6574 7572 6e5f 706f      if return_po
+00032660: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
+00032670: 2020 2020 2020 7265 7475 726e 2070 7431        return pt1
+00032680: 2e70 6f69 6e74 5f64 6973 7461 6e63 6528  .point_distance(
+00032690: 7074 3229 2c20 7074 312c 2070 7432 0a20  pt2), pt1, pt2. 
+000326a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000326b0: 6e20 7074 312e 706f 696e 745f 6469 7374  n pt1.point_dist
+000326c0: 616e 6365 2870 7432 290a 0a20 2020 2020  ance(pt2)..     
+000326d0: 2020 2072 6574 7572 6e20 4e6f 7449 6d70     return NotImp
+000326e0: 6c65 6d65 6e74 6564 4572 726f 720a 0a20  lementedError.. 
+000326f0: 2020 2064 6566 2065 7874 7275 7369 6f6e     def extrusion
+00032700: 2873 656c 662c 2065 7874 7275 7369 6f6e  (self, extrusion
+00032710: 5f76 6563 746f 7229 3a0a 2020 2020 2020  _vector):.      
+00032720: 2020 6966 2073 656c 662e 6e6f 726d 616c    if self.normal
+00032730: 2e69 735f 636f 6c69 6e65 6172 5f74 6f28  .is_colinear_to(
+00032740: 6578 7472 7573 696f 6e5f 7665 6374 6f72  extrusion_vector
+00032750: 293a 0a20 2020 2020 2020 2020 2020 2075  ):.            u
+00032760: 203d 2073 656c 662e 7374 6172 7420 2d20   = self.start - 
+00032770: 7365 6c66 2e63 656e 7465 720a 2020 2020  self.center.    
+00032780: 2020 2020 2020 2020 752e 6e6f 726d 616c          u.normal
+00032790: 697a 6528 290a 2020 2020 2020 2020 2020  ize().          
+000327a0: 2020 7720 3d20 6578 7472 7573 696f 6e5f    w = extrusion_
+000327b0: 7665 6374 6f72 2e63 6f70 7928 290a 2020  vector.copy().  
+000327c0: 2020 2020 2020 2020 2020 772e 6e6f 726d            w.norm
+000327d0: 616c 697a 6528 290a 2020 2020 2020 2020  alize().        
+000327e0: 2020 2020 7620 3d20 772e 6372 6f73 7328      v = w.cross(
+000327f0: 7529 0a20 2020 2020 2020 2020 2020 2061  u).            a
+00032800: 7263 3264 203d 2073 656c 662e 746f 5f32  rc2d = self.to_2
+00032810: 6428 7365 6c66 2e63 656e 7465 722c 2075  d(self.center, u
+00032820: 2c20 7629 0a20 2020 2020 2020 2020 2020  , v).           
+00032830: 2061 6e67 6c65 312c 2061 6e67 6c65 3220   angle1, angle2 
+00032840: 3d20 6172 6332 642e 616e 676c 6531 2c20  = arc2d.angle1, 
+00032850: 6172 6332 642e 616e 676c 6532 0a20 2020  arc2d.angle2.   
+00032860: 2020 2020 2020 2020 2069 6620 616e 676c           if angl
+00032870: 6532 203c 2061 6e67 6c65 313a 0a20 2020  e2 < angle1:.   
+00032880: 2020 2020 2020 2020 2020 2020 2061 6e67               ang
+00032890: 6c65 3220 2b3d 2076 6f6c 6d64 6c72 2e54  le2 += volmdlr.T
+000328a0: 574f 5f50 490a 2020 2020 2020 2020 2020  WO_PI.          
+000328b0: 2020 6379 6c69 6e64 6572 203d 2076 6f6c    cylinder = vol
+000328c0: 6d64 6c72 2e66 6163 6573 2e43 796c 696e  mdlr.faces.Cylin
+000328d0: 6472 6963 616c 5375 7266 6163 6533 4428  dricalSurface3D(
+000328e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000328f0: 2076 6f6c 6d64 6c72 2e46 7261 6d65 3344   volmdlr.Frame3D
+00032900: 2873 656c 662e 6365 6e74 6572 2c0a 2020  (self.center,.  
+00032910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032920: 2020 2020 2020 2020 2020 2020 2020 752c                u,
+00032930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032950: 2076 2c0a 2020 2020 2020 2020 2020 2020   v,.            
+00032960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032970: 2020 2020 7729 2c0a 2020 2020 2020 2020      w),.        
+00032980: 2020 2020 2020 2020 7365 6c66 2e72 6164          self.rad
+00032990: 6975 730a 2020 2020 2020 2020 2020 2020  ius.            
+000329a0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+000329b0: 7475 726e 205b 6379 6c69 6e64 6572 2e72  turn [cylinder.r
+000329c0: 6563 7461 6e67 756c 6172 5f63 7574 2861  ectangular_cut(a
+000329d0: 6e67 6c65 312c 2061 6e67 6c65 322c 2030  ngle1, angle2, 0
+000329e0: 2e2c 2065 7874 7275 7369 6f6e 5f76 6563  ., extrusion_vec
+000329f0: 746f 722e 6e6f 726d 2829 295d 0a20 2020  tor.norm())].   
+00032a00: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00032a10: 706c 656d 656e 7465 6445 7272 6f72 2866  plementedError(f
+00032a20: 2745 6c6c 6970 7469 6320 6661 6365 7320  'Elliptic faces 
+00032a30: 6e6f 7420 6861 6e64 6c65 643a 2064 6f74  not handled: dot
+00032a40: 3d7b 7365 6c66 2e6e 6f72 6d61 6c2e 646f  ={self.normal.do
+00032a50: 7428 6578 7472 7573 696f 6e5f 7665 6374  t(extrusion_vect
+00032a60: 6f72 297d 2729 0a0a 2020 2020 6465 6620  or)}')..    def 
+00032a70: 7265 766f 6c75 7469 6f6e 2873 656c 662c  revolution(self,
+00032a80: 2061 7869 735f 706f 696e 743a 2076 6f6c   axis_point: vol
+00032a90: 6d64 6c72 2e50 6f69 6e74 3344 2c20 6178  mdlr.Point3D, ax
+00032aa0: 6973 3a20 766f 6c6d 646c 722e 5665 6374  is: volmdlr.Vect
+00032ab0: 6f72 3344 2c0a 2020 2020 2020 2020 2020  or3D,.          
+00032ac0: 2020 2020 2020 2020 2061 6e67 6c65 3a20           angle: 
+00032ad0: 666c 6f61 7429 3a0a 2020 2020 2020 2020  float):.        
+00032ae0: 6c69 6e65 3364 203d 204c 696e 6533 4428  line3d = Line3D(
+00032af0: 6178 6973 5f70 6f69 6e74 2c20 6178 6973  axis_point, axis
+00032b00: 5f70 6f69 6e74 202b 2061 7869 7329 0a20  _point + axis). 
+00032b10: 2020 2020 2020 2074 6f72 655f 6365 6e74         tore_cent
+00032b20: 6572 2c20 5f20 3d20 6c69 6e65 3364 2e70  er, _ = line3d.p
+00032b30: 6f69 6e74 5f70 726f 6a65 6374 696f 6e28  oint_projection(
+00032b40: 7365 6c66 2e63 656e 7465 7229 0a0a 2020  self.center)..  
+00032b50: 2020 2020 2020 2320 5370 6865 7265 0a20        # Sphere. 
+00032b60: 2020 2020 2020 2069 6620 6d61 7468 2e69         if math.i
+00032b70: 7363 6c6f 7365 2874 6f72 655f 6365 6e74  sclose(tore_cent
+00032b80: 6572 2e70 6f69 6e74 5f64 6973 7461 6e63  er.point_distanc
+00032b90: 6528 7365 6c66 2e63 656e 7465 7229 2c20  e(self.center), 
+00032ba0: 302e 2c0a 2020 2020 2020 2020 2020 2020  0.,.            
+00032bb0: 2020 2020 2020 2020 2020 2020 6162 735f              abs_
+00032bc0: 746f 6c3d 3165 2d36 293a 0a0a 2020 2020  tol=1e-6):..    
+00032bd0: 2020 2020 2020 2020 7374 6172 745f 702c          start_p,
+00032be0: 205f 203d 206c 696e 6533 642e 706f 696e   _ = line3d.poin
+00032bf0: 745f 7072 6f6a 6563 7469 6f6e 2873 656c  t_projection(sel
+00032c00: 662e 7374 6172 7429 0a20 2020 2020 2020  f.start).       
+00032c10: 2020 2020 2075 203d 2073 656c 662e 7374       u = self.st
+00032c20: 6172 7420 2d20 7374 6172 745f 700a 0a20  art - start_p.. 
+00032c30: 2020 2020 2020 2020 2020 2069 6620 6d61             if ma
+00032c40: 7468 2e69 7363 6c6f 7365 2875 2e6e 6f72  th.isclose(u.nor
+00032c50: 6d28 292c 2030 2c20 6162 735f 746f 6c3d  m(), 0, abs_tol=
+00032c60: 3165 2d36 293a 0a20 2020 2020 2020 2020  1e-6):.         
+00032c70: 2020 2020 2020 2065 6e64 5f70 2c20 5f20         end_p, _ 
+00032c80: 3d20 6c69 6e65 3364 2e70 6f69 6e74 5f70  = line3d.point_p
+00032c90: 726f 6a65 6374 696f 6e28 7365 6c66 2e65  rojection(self.e
+00032ca0: 6e64 290a 2020 2020 2020 2020 2020 2020  nd).            
+00032cb0: 2020 2020 7520 3d20 7365 6c66 2e65 6e64      u = self.end
+00032cc0: 202d 2065 6e64 5f70 0a20 2020 2020 2020   - end_p.       
+00032cd0: 2020 2020 2020 2020 2069 6620 6d61 7468           if math
+00032ce0: 2e69 7363 6c6f 7365 2875 2e6e 6f72 6d28  .isclose(u.norm(
+00032cf0: 292c 2030 2c20 6162 735f 746f 6c3d 3165  ), 0, abs_tol=1e
+00032d00: 2d36 293a 0a20 2020 2020 2020 2020 2020  -6):.           
+00032d10: 2020 2020 2020 2020 2069 6e74 6572 696f           interio
+00032d20: 725f 702c 205f 203d 206c 696e 6533 642e  r_p, _ = line3d.
+00032d30: 706f 696e 745f 7072 6f6a 6563 7469 6f6e  point_projection
+00032d40: 2873 656c 662e 696e 7465 7269 6f72 290a  (self.interior).
+00032d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032d60: 2020 2020 7520 3d20 7365 6c66 2e69 6e74      u = self.int
+00032d70: 6572 696f 7220 2d20 696e 7465 7269 6f72  erior - interior
+00032d80: 5f70 0a0a 2020 2020 2020 2020 2020 2020  _p..            
+00032d90: 752e 6e6f 726d 616c 697a 6528 290a 2020  u.normalize().  
+00032da0: 2020 2020 2020 2020 2020 7620 3d20 6178            v = ax
+00032db0: 6973 2e63 726f 7373 2875 290a 2020 2020  is.cross(u).    
+00032dc0: 2020 2020 2020 2020 6172 6332 6420 3d20          arc2d = 
+00032dd0: 7365 6c66 2e74 6f5f 3264 2873 656c 662e  self.to_2d(self.
+00032de0: 6365 6e74 6572 2c20 752c 2061 7869 7329  center, u, axis)
+00032df0: 0a0a 2020 2020 2020 2020 2020 2020 7375  ..            su
+00032e00: 7266 6163 6520 3d20 766f 6c6d 646c 722e  rface = volmdlr.
+00032e10: 6661 6365 732e 5370 6865 7269 6361 6c53  faces.SphericalS
+00032e20: 7572 6661 6365 3344 280a 2020 2020 2020  urface3D(.      
+00032e30: 2020 2020 2020 2020 2020 766f 6c6d 646c            volmdl
+00032e40: 722e 4672 616d 6533 4428 7365 6c66 2e63  r.Frame3D(self.c
+00032e50: 656e 7465 722c 2075 2c20 762c 2061 7869  enter, u, v, axi
+00032e60: 7329 2c20 7365 6c66 2e72 6164 6975 7329  s), self.radius)
+00032e70: 0a0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00032e80: 7475 726e 205b 7375 7266 6163 652e 7265  turn [surface.re
+00032e90: 6374 616e 6775 6c61 725f 6375 7428 302c  ctangular_cut(0,
+00032ea0: 2061 6e67 6c65 2c0a 2020 2020 2020 2020   angle,.        
+00032eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ed0: 2020 2020 6172 6332 642e 616e 676c 6531      arc2d.angle1
+00032ee0: 2c20 6172 6332 642e 616e 676c 6532 295d  , arc2d.angle2)]
+00032ef0: 0a0a 2020 2020 2020 2020 2320 546f 726f  ..        # Toro
+00032f00: 6964 616c 0a20 2020 2020 2020 2075 203d  idal.        u =
+00032f10: 2073 656c 662e 6365 6e74 6572 202d 2074   self.center - t
+00032f20: 6f72 655f 6365 6e74 6572 0a20 2020 2020  ore_center.     
+00032f30: 2020 2075 2e6e 6f72 6d61 6c69 7a65 2829     u.normalize()
+00032f40: 0a20 2020 2020 2020 2076 203d 2061 7869  .        v = axi
+00032f50: 732e 6372 6f73 7328 7529 0a20 2020 2020  s.cross(u).     
+00032f60: 2020 2069 6620 6e6f 7420 6d61 7468 2e69     if not math.i
+00032f70: 7363 6c6f 7365 2873 656c 662e 6e6f 726d  sclose(self.norm
+00032f80: 616c 2e64 6f74 2875 292c 2030 2e2c 2061  al.dot(u), 0., a
+00032f90: 6273 5f74 6f6c 3d31 652d 3629 3a0a 2020  bs_tol=1e-6):.  
+00032fa0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00032fb0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+00032fc0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00032fd0: 2020 2020 2027 4f75 7473 6964 6520 6f66       'Outside of
+00032fe0: 2070 6c61 6e65 2072 6576 6f6c 7574 696f   plane revolutio
+00032ff0: 6e20 6e6f 7420 7375 7070 6f72 7465 6427  n not supported'
+00033000: 290a 0a20 2020 2020 2020 2052 203d 2074  )..        R = t
+00033010: 6f72 655f 6365 6e74 6572 2e70 6f69 6e74  ore_center.point
+00033020: 5f64 6973 7461 6e63 6528 7365 6c66 2e63  _distance(self.c
+00033030: 656e 7465 7229 0a20 2020 2020 2020 2073  enter).        s
+00033040: 7572 6661 6365 203d 2076 6f6c 6d64 6c72  urface = volmdlr
+00033050: 2e66 6163 6573 2e54 6f72 6f69 6461 6c53  .faces.ToroidalS
+00033060: 7572 6661 6365 3344 280a 2020 2020 2020  urface3D(.      
+00033070: 2020 2020 2020 766f 6c6d 646c 722e 4672        volmdlr.Fr
+00033080: 616d 6533 4428 746f 7265 5f63 656e 7465  ame3D(tore_cente
+00033090: 722c 2075 2c20 762c 2061 7869 7329 2c20  r, u, v, axis), 
+000330a0: 522c 0a20 2020 2020 2020 2020 2020 2073  R,.            s
+000330b0: 656c 662e 7261 6469 7573 290a 2020 2020  elf.radius).    
+000330c0: 2020 2020 6172 6332 6420 3d20 7365 6c66      arc2d = self
+000330d0: 2e74 6f5f 3264 2874 6f72 655f 6365 6e74  .to_2d(tore_cent
+000330e0: 6572 2c20 752c 2061 7869 7329 0a20 2020  er, u, axis).   
+000330f0: 2020 2020 2072 6574 7572 6e20 5b73 7572       return [sur
+00033100: 6661 6365 2e72 6563 7461 6e67 756c 6172  face.rectangular
+00033110: 5f63 7574 2830 2c20 616e 676c 652c 0a20  _cut(0, angle,. 
+00033120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033140: 2020 2020 2020 2061 7263 3264 2e61 6e67         arc2d.ang
+00033150: 6c65 312c 2061 7263 3264 2e61 6e67 6c65  le1, arc2d.angle
+00033160: 3229 5d0a 0a20 2020 2064 6566 2074 6f5f  2)]..    def to_
+00033170: 7374 6570 2873 656c 662c 2063 7572 7265  step(self, curre
+00033180: 6e74 5f69 642c 2073 7572 6661 6365 5f69  nt_id, surface_i
+00033190: 643d 4e6f 6e65 293a 0a20 2020 2020 2020  d=None):.       
+000331a0: 2022 2222 4578 706f 7274 7320 746f 2053   """Exports to S
+000331b0: 5445 5020 666f 726d 6174 2e22 2222 0a20  TEP format.""". 
+000331c0: 2020 2020 2020 2069 6620 7365 6c66 2e61         if self.a
+000331d0: 6e67 6c65 203e 3d20 6d61 7468 2e70 693a  ngle >= math.pi:
+000331e0: 0a20 2020 2020 2020 2020 2020 206c 203d  .            l =
+000331f0: 2073 656c 662e 6c65 6e67 7468 2829 0a20   self.length(). 
+00033200: 2020 2020 2020 2020 2020 2061 7263 312c             arc1,
+00033210: 2061 7263 3220 3d20 7365 6c66 2e73 706c   arc2 = self.spl
+00033220: 6974 2873 656c 662e 706f 696e 745f 6174  it(self.point_at
+00033230: 5f61 6273 6369 7373 6128 302e 3333 202a  _abscissa(0.33 *
+00033240: 206c 2929 0a20 2020 2020 2020 2020 2020   l)).           
+00033250: 2061 7263 322c 2061 7263 3320 3d20 6172   arc2, arc3 = ar
+00033260: 6332 2e73 706c 6974 2873 656c 662e 706f  c2.split(self.po
+00033270: 696e 745f 6174 5f61 6273 6369 7373 6128  int_at_abscissa(
+00033280: 302e 3636 202a 206c 2929 0a20 2020 2020  0.66 * l)).     
+00033290: 2020 2020 2020 2063 6f6e 7465 6e74 2c20         content, 
+000332a0: 6172 6373 315f 6964 203d 2061 7263 312e  arcs1_id = arc1.
+000332b0: 746f 5f73 7465 705f 7769 7468 6f75 745f  to_step_without_
+000332c0: 7370 6c69 7474 696e 6728 6375 7272 656e  splitting(curren
+000332d0: 745f 6964 290a 2020 2020 2020 2020 2020  t_id).          
+000332e0: 2020 6172 6332 5f63 6f6e 7465 6e74 2c20    arc2_content, 
+000332f0: 6172 6373 325f 6964 203d 2061 7263 322e  arcs2_id = arc2.
+00033300: 746f 5f73 7465 705f 7769 7468 6f75 745f  to_step_without_
+00033310: 7370 6c69 7474 696e 6728 0a20 2020 2020  splitting(.     
+00033320: 2020 2020 2020 2020 2020 2061 7263 7331             arcs1
+00033330: 5f69 645b 305d 202b 2031 290a 2020 2020  _id[0] + 1).    
+00033340: 2020 2020 2020 2020 6172 6333 5f63 6f6e          arc3_con
+00033350: 7465 6e74 2c20 6172 6373 335f 6964 203d  tent, arcs3_id =
+00033360: 2061 7263 332e 746f 5f73 7465 705f 7769   arc3.to_step_wi
+00033370: 7468 6f75 745f 7370 6c69 7474 696e 6728  thout_splitting(
+00033380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033390: 2061 7263 7332 5f69 645b 305d 202b 2031   arcs2_id[0] + 1
+000333a0: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+000333b0: 6e74 656e 7420 2b3d 2061 7263 325f 636f  ntent += arc2_co
+000333c0: 6e74 656e 7420 2b20 6172 6333 5f63 6f6e  ntent + arc3_con
+000333d0: 7465 6e74 0a20 2020 2020 2020 2020 2020  tent.           
+000333e0: 2072 6574 7572 6e20 636f 6e74 656e 742c   return content,
+000333f0: 205b 6172 6373 315f 6964 5b30 5d2c 2061   [arcs1_id[0], a
+00033400: 7263 7332 5f69 645b 305d 2c20 6172 6373  rcs2_id[0], arcs
+00033410: 335f 6964 5b30 5d5d 0a20 2020 2020 2020  3_id[0]].       
+00033420: 2072 6574 7572 6e20 7365 6c66 2e74 6f5f   return self.to_
+00033430: 7374 6570 5f77 6974 686f 7574 5f73 706c  step_without_spl
+00033440: 6974 7469 6e67 2863 7572 7265 6e74 5f69  itting(current_i
+00033450: 6429 0a0a 2020 2020 6465 6620 746f 5f73  d)..    def to_s
+00033460: 7465 705f 7769 7468 6f75 745f 7370 6c69  tep_without_spli
+00033470: 7474 696e 6728 7365 6c66 2c20 6375 7272  tting(self, curr
+00033480: 656e 745f 6964 2c20 7375 7266 6163 655f  ent_id, surface_
+00033490: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
+000334a0: 2020 7520 3d20 7365 6c66 2e73 7461 7274    u = self.start
+000334b0: 202d 2073 656c 662e 6365 6e74 6572 0a20   - self.center. 
+000334c0: 2020 2020 2020 2075 2e6e 6f72 6d61 6c69         u.normali
+000334d0: 7a65 2829 0a20 2020 2020 2020 2076 203d  ze().        v =
+000334e0: 2073 656c 662e 6e6f 726d 616c 2e63 726f   self.normal.cro
+000334f0: 7373 2875 290a 2020 2020 2020 2020 6672  ss(u).        fr
+00033500: 616d 6520 3d20 766f 6c6d 646c 722e 4672  ame = volmdlr.Fr
+00033510: 616d 6533 4428 7365 6c66 2e63 656e 7465  ame3D(self.cente
+00033520: 722c 2073 656c 662e 6e6f 726d 616c 2c20  r, self.normal, 
+00033530: 752c 2076 290a 0a20 2020 2020 2020 2063  u, v)..        c
+00033540: 6f6e 7465 6e74 2c20 6672 616d 655f 6964  ontent, frame_id
+00033550: 203d 2066 7261 6d65 2e74 6f5f 7374 6570   = frame.to_step
+00033560: 2863 7572 7265 6e74 5f69 6429 0a20 2020  (current_id).   
+00033570: 2020 2020 2063 7572 7665 5f69 6420 3d20       curve_id = 
+00033580: 6672 616d 655f 6964 202b 2031 0a20 2020  frame_id + 1.   
+00033590: 2020 2020 2063 6f6e 7465 6e74 202b 3d20       content += 
+000335a0: 2223 7b7d 203d 2043 4952 434c 4528 277b  "#{} = CIRCLE('{
+000335b0: 7d27 2c20 237b 7d2c 207b 3a2e 3666 7d29  }', #{}, {:.6f})
+000335c0: 3b5c 6e22 2e66 6f72 6d61 7428 6375 7276  ;\n".format(curv
+000335d0: 655f 6964 2c0a 2020 2020 2020 2020 2020  e_id,.          
+000335e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000335f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033610: 2020 2020 2073 656c 662e 6e61 6d65 2c0a       self.name,.
+00033620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033650: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00033660: 7261 6d65 5f69 642c 0a20 2020 2020 2020  rame_id,.       
+00033670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000336a0: 2020 2020 2020 2020 7365 6c66 2e72 6164          self.rad
+000336b0: 6975 7320 2a20 3130 3030 2c0a 2020 2020  ius * 1000,.    
+000336c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000336d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000336e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000336f0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00033700: 2020 2020 2020 6966 2073 7572 6661 6365        if surface
+00033710: 5f69 643a 0a20 2020 2020 2020 2020 2020  _id:.           
+00033720: 2063 6f6e 7465 6e74 202b 3d20 2223 7b7d   content += "#{}
+00033730: 203d 2053 5552 4641 4345 5f43 5552 5645   = SURFACE_CURVE
+00033740: 2827 272c 237b 7d2c 2823 7b7d 292c 2e50  ('',#{},(#{}),.P
+00033750: 4355 5256 455f 5331 2e29 3b5c 6e22 2e66  CURVE_S1.);\n".f
+00033760: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
+00033770: 2020 2020 2020 2063 7572 7665 5f69 6420         curve_id 
+00033780: 2b20 312c 2063 7572 7665 5f69 642c 2073  + 1, curve_id, s
+00033790: 7572 6661 6365 5f69 6429 0a20 2020 2020  urface_id).     
+000337a0: 2020 2020 2020 2063 7572 7665 5f69 6420         curve_id 
+000337b0: 2b3d 2031 0a0a 2020 2020 2020 2020 6375  += 1..        cu
+000337c0: 7272 656e 745f 6964 203d 2063 7572 7665  rrent_id = curve
+000337d0: 5f69 6420 2b20 310a 2020 2020 2020 2020  _id + 1.        
+000337e0: 7374 6172 745f 636f 6e74 656e 742c 2073  start_content, s
+000337f0: 7461 7274 5f69 6420 3d20 7365 6c66 2e73  tart_id = self.s
+00033800: 7461 7274 2e74 6f5f 7374 6570 2863 7572  tart.to_step(cur
+00033810: 7265 6e74 5f69 642c 2076 6572 7465 783d  rent_id, vertex=
+00033820: 5472 7565 290a 2020 2020 2020 2020 656e  True).        en
+00033830: 645f 636f 6e74 656e 742c 2065 6e64 5f69  d_content, end_i
+00033840: 6420 3d20 7365 6c66 2e65 6e64 2e74 6f5f  d = self.end.to_
+00033850: 7374 6570 2873 7461 7274 5f69 6420 2b20  step(start_id + 
+00033860: 312c 2076 6572 7465 783d 5472 7565 290a  1, vertex=True).
+00033870: 2020 2020 2020 2020 636f 6e74 656e 7420          content 
+00033880: 2b3d 2073 7461 7274 5f63 6f6e 7465 6e74  += start_content
+00033890: 202b 2065 6e64 5f63 6f6e 7465 6e74 0a20   + end_content. 
+000338a0: 2020 2020 2020 2063 7572 7265 6e74 5f69         current_i
+000338b0: 6420 3d20 656e 645f 6964 202b 2031 0a20  d = end_id + 1. 
+000338c0: 2020 2020 2020 2063 6f6e 7465 6e74 202b         content +
+000338d0: 3d20 2223 7b7d 203d 2045 4447 455f 4355  = "#{} = EDGE_CU
+000338e0: 5256 4528 277b 7d27 2c23 7b7d 2c23 7b7d  RVE('{}',#{},#{}
+000338f0: 2c23 7b7d 2c2e 542e 293b 5c6e 222e 666f  ,#{},.T.);\n".fo
+00033900: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
+00033910: 2020 6375 7272 656e 745f 6964 2c20 7365    current_id, se
+00033920: 6c66 2e6e 616d 652c 0a20 2020 2020 2020  lf.name,.       
+00033930: 2020 2020 2073 7461 7274 5f69 642c 2065       start_id, e
+00033940: 6e64 5f69 642c 2063 7572 7665 5f69 6429  nd_id, curve_id)
+00033950: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00033960: 636f 6e74 656e 742c 205b 6375 7272 656e  content, [curren
+00033970: 745f 6964 5d0a 0a20 2020 2064 6566 2070  t_id]..    def p
+00033980: 6f69 6e74 5f62 656c 6f6e 6773 2873 656c  oint_belongs(sel
+00033990: 662c 2070 6f69 6e74 3364 2c20 6162 735f  f, point3d, abs_
+000339a0: 746f 6c3a 2066 6c6f 6174 203d 2031 652d  tol: float = 1e-
+000339b0: 3629 3a0a 2020 2020 2020 2020 2222 220a  6):.        """.
+000339c0: 2020 2020 2020 2020 4368 6563 6b20 6966          Check if
+000339d0: 2061 2070 6f69 6e74 3364 2062 656c 6f6e   a point3d belon
+000339e0: 6773 2074 6f20 7468 6520 6172 635f 3364  gs to the arc_3d
+000339f0: 206f 7220 6e6f 742e 0a0a 2020 2020 2020   or not...      
+00033a00: 2020 3a70 6172 616d 2070 6f69 6e74 3364    :param point3d
+00033a10: 3a20 706f 696e 7420 746f 2062 6520 7665  : point to be ve
+00033a20: 7269 6669 6564 2069 7320 6f6e 2061 7263  rified is on arc
+00033a30: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00033a40: 3a20 5472 7565 2069 6620 706f 696e 7420  : True if point 
+00033a50: 6973 206f 6e20 4172 632c 2046 616c 7365  is on Arc, False
+00033a60: 206f 7468 6572 7769 7365 2e0a 2020 2020   otherwise..    
+00033a70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00033a80: 6966 206e 6f74 206d 6174 682e 6973 636c  if not math.iscl
+00033a90: 6f73 6528 706f 696e 7433 642e 706f 696e  ose(point3d.poin
+00033aa0: 745f 6469 7374 616e 6365 2873 656c 662e  t_distance(self.
+00033ab0: 6365 6e74 6572 292c 2073 656c 662e 7261  center), self.ra
+00033ac0: 6469 7573 2c20 6162 735f 746f 6c3d 6162  dius, abs_tol=ab
+00033ad0: 735f 746f 6c29 3a0a 2020 2020 2020 2020  s_tol):.        
+00033ae0: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+00033af0: 0a20 2020 2020 2020 2023 2076 6563 746f  .        # vecto
+00033b00: 7231 203d 2073 656c 662e 7374 6172 7420  r1 = self.start 
+00033b10: 2d20 7365 6c66 2e63 656e 7465 720a 2020  - self.center.  
+00033b20: 2020 2020 2020 2320 7665 6374 6f72 3220        # vector2 
+00033b30: 3d20 7365 6c66 2e69 6e74 6572 696f 7220  = self.interior 
+00033b40: 2d20 7365 6c66 2e63 656e 7465 720a 2020  - self.center.  
+00033b50: 2020 2020 2020 7665 6374 6f72 203d 2070        vector = p
+00033b60: 6f69 6e74 3364 202d 2073 656c 662e 6365  oint3d - self.ce
+00033b70: 6e74 6572 0a20 2020 2020 2020 2069 6620  nter.        if 
+00033b80: 6e6f 7420 6d61 7468 2e69 7363 6c6f 7365  not math.isclose
+00033b90: 2876 6563 746f 722e 646f 7428 7365 6c66  (vector.dot(self
+00033ba0: 2e66 7261 6d65 2e77 292c 2030 2e30 2c20  .frame.w), 0.0, 
+00033bb0: 6162 735f 746f 6c3d 6162 735f 746f 6c29  abs_tol=abs_tol)
+00033bc0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00033bd0: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
+00033be0: 2020 2070 6f69 6e74 5f61 6273 6369 7373     point_absciss
+00033bf0: 6120 3d20 7365 6c66 2e61 6273 6369 7373  a = self.absciss
+00033c00: 6128 706f 696e 7433 6429 0a20 2020 2020  a(point3d).     
+00033c10: 2020 2061 6273 6369 7373 615f 7374 6172     abscissa_star
+00033c20: 7420 3d20 7365 6c66 2e61 6273 6369 7373  t = self.absciss
+00033c30: 6128 7365 6c66 2e73 7461 7274 290a 2020  a(self.start).  
+00033c40: 2020 2020 2020 6162 7363 6973 7361 5f65        abscissa_e
+00033c50: 6e64 203d 2073 656c 662e 6162 7363 6973  nd = self.abscis
+00033c60: 7361 2873 656c 662e 656e 6429 0a20 2020  sa(self.end).   
+00033c70: 2020 2020 2069 6620 6162 7363 6973 7361       if abscissa
+00033c80: 5f73 7461 7274 203c 3d20 706f 696e 745f  _start <= point_
+00033c90: 6162 7363 6973 7361 203c 3d20 6162 7363  abscissa <= absc
+00033ca0: 6973 7361 5f65 6e64 3a0a 2020 2020 2020  issa_end:.      
+00033cb0: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+00033cc0: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
+00033cd0: 2046 616c 7365 0a0a 2020 2020 6465 6620   False..    def 
+00033ce0: 7472 6961 6e67 756c 6174 696f 6e28 7365  triangulation(se
+00033cf0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00033d00: 7572 6e20 4e6f 6e65 0a0a 2020 2020 6465  urn None..    de
+00033d10: 6620 6d69 6464 6c65 5f70 6f69 6e74 2873  f middle_point(s
+00033d20: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00033d30: 7475 726e 2073 656c 662e 706f 696e 745f  turn self.point_
+00033d40: 6174 5f61 6273 6369 7373 6128 7365 6c66  at_abscissa(self
+00033d50: 2e6c 656e 6774 6828 2920 2f20 3229 0a0a  .length() / 2)..
+00033d60: 2020 2020 6465 6620 6c69 6e65 5f69 6e74      def line_int
+00033d70: 6572 7365 6374 696f 6e73 2873 656c 662c  ersections(self,
+00033d80: 206c 696e 6533 643a 204c 696e 6533 4429   line3d: Line3D)
+00033d90: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00033da0: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
+00033db0: 2069 6e74 6572 7365 6374 696f 6e73 2062   intersections b
+00033dc0: 6574 7765 656e 2061 6e20 4172 6333 4420  etween an Arc3D 
+00033dd0: 616e 6420 6120 4c69 6e65 3344 2e0a 0a20  and a Line3D... 
+00033de0: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
+00033df0: 6e65 7365 676d 656e 7433 643a 206c 696e  nesegment3d: lin
+00033e00: 6573 6567 6d65 6e74 2074 6f20 7665 7269  esegment to veri
+00033e10: 6679 2069 6e74 6572 7365 6374 696f 6e73  fy intersections
+00033e20: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00033e30: 6e3a 206c 6973 7420 7769 7468 2069 6e74  n: list with int
+00033e40: 6572 7365 6374 696f 6e73 2070 6f69 6e74  ersections point
+00033e50: 7320 6265 7477 6565 6e20 6c69 6e65 2061  s between line a
+00033e60: 6e64 2041 7263 3344 2e0a 2020 2020 2020  nd Arc3D..      
+00033e70: 2020 2222 220a 2020 2020 2020 2020 6369    """.        ci
+00033e80: 7263 6c65 3364 5f6c 696e 6573 6567 5f69  rcle3d_lineseg_i
+00033e90: 6e74 6572 7320 3d20 766d 5f75 7469 6c73  nters = vm_utils
+00033ea0: 5f69 6e74 6572 7365 6374 696f 6e73 2e63  _intersections.c
+00033eb0: 6972 636c 655f 3364 5f6c 696e 655f 696e  ircle_3d_line_in
+00033ec0: 7465 7273 6563 7469 6f6e 7328 7365 6c66  tersections(self
+00033ed0: 2c20 6c69 6e65 3364 290a 2020 2020 2020  , line3d).      
+00033ee0: 2020 6c69 6e65 7365 676d 656e 745f 696e    linesegment_in
+00033ef0: 7465 7273 6563 7469 6f6e 7320 3d20 5b5d  tersections = []
+00033f00: 0a20 2020 2020 2020 2066 6f72 2069 6e74  .        for int
+00033f10: 6572 7365 6374 696f 6e20 696e 2063 6972  ersection in cir
+00033f20: 636c 6533 645f 6c69 6e65 7365 675f 696e  cle3d_lineseg_in
+00033f30: 7465 7273 3a0a 2020 2020 2020 2020 2020  ters:.          
+00033f40: 2020 6966 2073 656c 662e 706f 696e 745f    if self.point_
+00033f50: 6265 6c6f 6e67 7328 696e 7465 7273 6563  belongs(intersec
+00033f60: 7469 6f6e 2c20 3165 2d36 293a 0a20 2020  tion, 1e-6):.   
+00033f70: 2020 2020 2020 2020 2020 2020 206c 696e               lin
+00033f80: 6573 6567 6d65 6e74 5f69 6e74 6572 7365  esegment_interse
+00033f90: 6374 696f 6e73 2e61 7070 656e 6428 696e  ctions.append(in
+00033fa0: 7465 7273 6563 7469 6f6e 290a 2020 2020  tersection).    
+00033fb0: 2020 2020 7265 7475 726e 206c 696e 6573      return lines
+00033fc0: 6567 6d65 6e74 5f69 6e74 6572 7365 6374  egment_intersect
+00033fd0: 696f 6e73 0a0a 2020 2020 6465 6620 6c69  ions..    def li
+00033fe0: 6e65 7365 676d 656e 745f 696e 7465 7273  nesegment_inters
+00033ff0: 6563 7469 6f6e 7328 7365 6c66 2c20 6c69  ections(self, li
+00034000: 6e65 7365 676d 656e 7433 643a 204c 696e  nesegment3d: Lin
+00034010: 6553 6567 6d65 6e74 3344 293a 0a20 2020  eSegment3D):.   
+00034020: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00034030: 2043 616c 6375 6c61 7465 7320 696e 7465   Calculates inte
+00034040: 7273 6563 7469 6f6e 7320 6265 7477 6565  rsections betwee
+00034050: 6e20 616e 2041 7263 3344 2061 6e64 2061  n an Arc3D and a
+00034060: 204c 696e 6553 6567 6d65 6e74 3344 2e0a   LineSegment3D..
+00034070: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00034080: 6c69 6e65 7365 676d 656e 7433 643a 206c  linesegment3d: l
+00034090: 696e 6573 6567 6d65 6e74 2074 6f20 7665  inesegment to ve
+000340a0: 7269 6679 2069 6e74 6572 7365 6374 696f  rify intersectio
+000340b0: 6e73 2e0a 2020 2020 2020 2020 3a72 6574  ns..        :ret
+000340c0: 7572 6e3a 206c 6973 7420 7769 7468 2069  urn: list with i
+000340d0: 6e74 6572 7365 6374 696f 6e73 2070 6f69  ntersections poi
+000340e0: 6e74 7320 6265 7477 6565 6e20 6c69 6e65  nts between line
+000340f0: 7365 676d 656e 7420 616e 6420 4172 6333  segment and Arc3
+00034100: 442e 0a20 2020 2020 2020 2022 2222 0a20  D..        """. 
+00034110: 2020 2020 2020 206c 696e 6573 6567 6d65         linesegme
+00034120: 6e74 5f69 6e74 6572 7365 6374 696f 6e73  nt_intersections
+00034130: 203d 205b 5d0a 2020 2020 2020 2020 696e   = [].        in
+00034140: 7465 7273 6563 7469 6f6e 7320 3d20 7365  tersections = se
+00034150: 6c66 2e6c 696e 655f 696e 7465 7273 6563  lf.line_intersec
+00034160: 7469 6f6e 7328 6c69 6e65 7365 676d 656e  tions(linesegmen
+00034170: 7433 6429 0a20 2020 2020 2020 2066 6f72  t3d).        for
+00034180: 2069 6e74 6572 7365 6374 696f 6e20 696e   intersection in
+00034190: 2069 6e74 6572 7365 6374 696f 6e73 3a0a   intersections:.
+000341a0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+000341b0: 696e 6573 6567 6d65 6e74 3364 2e70 6f69  inesegment3d.poi
+000341c0: 6e74 5f62 656c 6f6e 6773 2869 6e74 6572  nt_belongs(inter
+000341d0: 7365 6374 696f 6e29 3a0a 2020 2020 2020  section):.      
+000341e0: 2020 2020 2020 2020 2020 6c69 6e65 7365            linese
+000341f0: 676d 656e 745f 696e 7465 7273 6563 7469  gment_intersecti
+00034200: 6f6e 732e 6170 7065 6e64 2869 6e74 6572  ons.append(inter
+00034210: 7365 6374 696f 6e29 0a20 2020 2020 2020  section).       
+00034220: 2072 6574 7572 6e20 6c69 6e65 7365 676d   return linesegm
+00034230: 656e 745f 696e 7465 7273 6563 7469 6f6e  ent_intersection
+00034240: 730a 0a0a 636c 6173 7320 4675 6c6c 4172  s...class FullAr
+00034250: 6333 4428 4172 6333 4429 3a0a 2020 2020  c3D(Arc3D):.    
+00034260: 2222 220a 2020 2020 416e 2065 6467 6520  """.    An edge 
+00034270: 7468 6174 2073 7461 7274 7320 6174 2073  that starts at s
+00034280: 7461 7274 5f65 6e64 2c20 656e 6473 2061  tart_end, ends a
+00034290: 7420 7468 6520 7361 6d65 2070 6f69 6e74  t the same point
+000342a0: 2061 6674 6572 2068 6176 696e 6720 6465   after having de
+000342b0: 7363 7269 6265 6420 6120 6369 7263 6c65  scribed a circle
+000342c0: 2e0a 0a20 2020 2022 2222 0a0a 2020 2020  ...    """..    
+000342d0: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+000342e0: 662c 2063 656e 7465 723a 2076 6f6c 6d64  f, center: volmd
+000342f0: 6c72 2e50 6f69 6e74 3344 2c20 7374 6172  lr.Point3D, star
+00034300: 745f 656e 643a 2076 6f6c 6d64 6c72 2e50  t_end: volmdlr.P
+00034310: 6f69 6e74 3344 2c0a 2020 2020 2020 2020  oint3D,.        
+00034320: 2020 2020 2020 2020 206e 6f72 6d61 6c3a           normal:
+00034330: 2076 6f6c 6d64 6c72 2e56 6563 746f 7233   volmdlr.Vector3
+00034340: 442c 0a20 2020 2020 2020 2020 2020 2020  D,.             
+00034350: 2020 2020 6e61 6d65 3a20 7374 7220 3d20      name: str = 
+00034360: 2727 293a 0a20 2020 2020 2020 2073 656c  ''):.        sel
+00034370: 662e 5f5f 6365 6e74 6572 203d 2063 656e  f.__center = cen
+00034380: 7465 720a 2020 2020 2020 2020 7365 6c66  ter.        self
+00034390: 2e5f 5f6e 6f72 6d61 6c20 3d20 6e6f 726d  .__normal = norm
+000343a0: 616c 0a20 2020 2020 2020 2073 656c 662e  al.        self.
+000343b0: 7374 6172 745f 656e 6420 3d20 7374 6172  start_end = star
+000343c0: 745f 656e 640a 2020 2020 2020 2020 696e  t_end.        in
+000343d0: 7465 7269 6f72 203d 2073 7461 7274 5f65  terior = start_e
+000343e0: 6e64 2e72 6f74 6174 696f 6e28 6365 6e74  nd.rotation(cent
+000343f0: 6572 2c20 6e6f 726d 616c 2c20 6d61 7468  er, normal, math
+00034400: 2e70 6929 0a20 2020 2020 2020 2041 7263  .pi).        Arc
+00034410: 3344 2e5f 5f69 6e69 745f 5f28 7365 6c66  3D.__init__(self
+00034420: 2c20 7374 6172 743d 7374 6172 745f 656e  , start=start_en
+00034430: 642c 2065 6e64 3d73 7461 7274 5f65 6e64  d, end=start_end
+00034440: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00034450: 2020 2020 2020 2020 2069 6e74 6572 696f           interio
+00034460: 723d 696e 7465 7269 6f72 2c20 6e61 6d65  r=interior, name
+00034470: 3d6e 616d 6529 2020 2320 2121 2120 7468  =name)  # !!! th
+00034480: 6973 2069 7320 6461 6e67 6572 6f75 730a  is is dangerous.
+00034490: 0a20 2020 2064 6566 205f 5f68 6173 685f  .    def __hash_
+000344a0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+000344b0: 2072 6574 7572 6e20 6861 7368 2873 656c   return hash(sel
+000344c0: 662e 6365 6e74 6572 2920 2b20 3520 2a20  f.center) + 5 * 
+000344d0: 6861 7368 2873 656c 662e 7374 6172 745f  hash(self.start_
+000344e0: 656e 6429 0a0a 2020 2020 6465 6620 5f5f  end)..    def __
+000344f0: 6571 5f5f 2873 656c 662c 206f 7468 6572  eq__(self, other
+00034500: 5f61 7263 293a 0a20 2020 2020 2020 2072  _arc):.        r
+00034510: 6574 7572 6e20 2873 656c 662e 6365 6e74  eturn (self.cent
+00034520: 6572 203d 3d20 6f74 6865 725f 6172 632e  er == other_arc.
+00034530: 6365 6e74 6572 2920 5c0a 2020 2020 2020  center) \.      
+00034540: 2020 2020 2020 616e 6420 2873 656c 662e        and (self.
+00034550: 7374 6172 7420 3d3d 206f 7468 6572 5f61  start == other_a
+00034560: 7263 2e73 7461 7274 290a 0a20 2020 2040  rc.start)..    @
+00034570: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00034580: 2063 656e 7465 7228 7365 6c66 293a 0a20   center(self):. 
+00034590: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000345a0: 6c66 2e5f 5f63 656e 7465 720a 0a20 2020  lf.__center..   
+000345b0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000345c0: 6566 2061 6e67 6c65 2873 656c 6629 3a0a  ef angle(self):.
+000345d0: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+000345e0: 6f6c 6d64 6c72 2e54 574f 5f50 490a 0a20  olmdlr.TWO_PI.. 
+000345f0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00034600: 2064 6566 206e 6f72 6d61 6c28 7365 6c66   def normal(self
+00034610: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00034620: 6e20 7365 6c66 2e5f 5f6e 6f72 6d61 6c0a  n self.__normal.
+00034630: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00034640: 2020 2064 6566 2069 735f 7472 6967 6f28     def is_trigo(
+00034650: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00034660: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+00034670: 6465 6620 636f 7079 2873 656c 662c 202a  def copy(self, *
+00034680: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+00034690: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000346a0: 4675 6c6c 4172 6333 4428 7365 6c66 2e5f  FullArc3D(self._
+000346b0: 6365 6e74 6572 2e63 6f70 7928 292c 2073  center.copy(), s
+000346c0: 656c 662e 656e 642e 636f 7079 2829 2c20  elf.end.copy(), 
+000346d0: 7365 6c66 2e5f 6e6f 726d 616c 2e63 6f70  self._normal.cop
+000346e0: 7928 2929 0a0a 2020 2020 6465 6620 746f  y())..    def to
+000346f0: 5f64 6963 7428 7365 6c66 2c20 7573 655f  _dict(self, use_
+00034700: 706f 696e 7465 7273 3a20 626f 6f6c 203d  pointers: bool =
+00034710: 2046 616c 7365 2c20 6d65 6d6f 3d4e 6f6e   False, memo=Non
+00034720: 652c 2070 6174 683a 2073 7472 203d 2027  e, path: str = '
+00034730: 2327 293a 0a20 2020 2020 2020 2064 6963  #'):.        dic
+00034740: 745f 203d 2073 656c 662e 6261 7365 5f64  t_ = self.base_d
+00034750: 6963 7428 290a 2020 2020 2020 2020 6469  ict().        di
+00034760: 6374 5f5b 2763 656e 7465 7227 5d20 3d20  ct_['center'] = 
+00034770: 7365 6c66 2e63 656e 7465 722e 746f 5f64  self.center.to_d
+00034780: 6963 7428 7573 655f 706f 696e 7465 7273  ict(use_pointers
+00034790: 3d75 7365 5f70 6f69 6e74 6572 732c 206d  =use_pointers, m
+000347a0: 656d 6f3d 6d65 6d6f 2c20 7061 7468 3d70  emo=memo, path=p
+000347b0: 6174 6820 2b20 272f 6365 6e74 6572 2729  ath + '/center')
+000347c0: 0a20 2020 2020 2020 2064 6963 745f 5b27  .        dict_['
+000347d0: 7261 6469 7573 275d 203d 2073 656c 662e  radius'] = self.
+000347e0: 7261 6469 7573 0a20 2020 2020 2020 2064  radius.        d
+000347f0: 6963 745f 5b27 616e 676c 6527 5d20 3d20  ict_['angle'] = 
+00034800: 7365 6c66 2e61 6e67 6c65 0a20 2020 2020  self.angle.     
+00034810: 2020 2064 6963 745f 5b27 6973 5f74 7269     dict_['is_tri
+00034820: 676f 275d 203d 2073 656c 662e 6973 5f74  go'] = self.is_t
+00034830: 7269 676f 0a20 2020 2020 2020 2064 6963  rigo.        dic
+00034840: 745f 5b27 7374 6172 745f 656e 6427 5d20  t_['start_end'] 
+00034850: 3d20 7365 6c66 2e73 7461 7274 2e74 6f5f  = self.start.to_
+00034860: 6469 6374 2875 7365 5f70 6f69 6e74 6572  dict(use_pointer
+00034870: 733d 7573 655f 706f 696e 7465 7273 2c20  s=use_pointers, 
+00034880: 6d65 6d6f 3d6d 656d 6f2c 2070 6174 683d  memo=memo, path=
+00034890: 7061 7468 202b 2027 2f73 7461 7274 5f65  path + '/start_e
+000348a0: 6e64 2729 0a20 2020 2020 2020 2064 6963  nd').        dic
+000348b0: 745f 5b27 6e6f 726d 616c 275d 203d 2073  t_['normal'] = s
+000348c0: 656c 662e 6e6f 726d 616c 2e74 6f5f 6469  elf.normal.to_di
+000348d0: 6374 2875 7365 5f70 6f69 6e74 6572 733d  ct(use_pointers=
+000348e0: 7573 655f 706f 696e 7465 7273 2c20 6d65  use_pointers, me
+000348f0: 6d6f 3d6d 656d 6f2c 2070 6174 683d 7061  mo=memo, path=pa
+00034900: 7468 202b 2027 2f6e 6f72 6d61 6c27 290a  th + '/normal').
+00034910: 2020 2020 2020 2020 6469 6374 5f5b 276e          dict_['n
+00034920: 616d 6527 5d20 3d20 7365 6c66 2e6e 616d  ame'] = self.nam
+00034930: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
+00034940: 2064 6963 745f 0a0a 2020 2020 6465 6620   dict_..    def 
+00034950: 746f 5f32 6428 7365 6c66 2c20 706c 616e  to_2d(self, plan
+00034960: 655f 6f72 6967 696e 2c20 782c 2079 293a  e_origin, x, y):
+00034970: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00034980: 2020 2020 2054 7261 6e73 666f 726d 7320       Transforms 
+00034990: 6120 4675 6c6c 4172 6333 4420 696e 746f  a FullArc3D into
+000349a0: 2061 6e20 4675 6c6c 4172 6332 442c 2067   an FullArc2D, g
+000349b0: 6976 656e 2061 6e20 706c 616e 6520 6f72  iven an plane or
+000349c0: 6967 696e 2061 6e64 2061 2075 2061 6e64  igin and a u and
+000349d0: 2076 2070 6c61 6e65 2076 6563 746f 722e   v plane vector.
+000349e0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000349f0: 2070 6c61 6e65 5f6f 7269 6769 6e3a 2070   plane_origin: p
+00034a00: 6c61 6e65 206f 7269 6769 6e2e 0a20 2020  lane origin..   
+00034a10: 2020 2020 203a 7061 7261 6d20 783a 2070       :param x: p
+00034a20: 6c61 6e65 2075 2076 6563 746f 722e 0a20  lane u vector.. 
+00034a30: 2020 2020 2020 203a 7061 7261 6d20 793a         :param y:
+00034a40: 2070 6c61 6e65 2076 2076 6563 746f 722e   plane v vector.
+00034a50: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00034a60: 3a20 4675 6c6c 4172 6332 442e 0a20 2020  : FullArc2D..   
+00034a70: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00034a80: 2063 656e 7465 7220 3d20 7365 6c66 2e63   center = self.c
+00034a90: 656e 7465 722e 746f 5f32 6428 706c 616e  enter.to_2d(plan
+00034aa0: 655f 6f72 6967 696e 2c20 782c 2079 290a  e_origin, x, y).
+00034ab0: 2020 2020 2020 2020 7374 6172 745f 656e          start_en
+00034ac0: 6420 3d20 7365 6c66 2e73 7461 7274 2e74  d = self.start.t
+00034ad0: 6f5f 3264 2870 6c61 6e65 5f6f 7269 6769  o_2d(plane_origi
+00034ae0: 6e2c 2078 2c20 7929 0a20 2020 2020 2020  n, x, y).       
+00034af0: 2072 6574 7572 6e20 4675 6c6c 4172 6332   return FullArc2
+00034b00: 4428 6365 6e74 6572 2c20 7374 6172 745f  D(center, start_
+00034b10: 656e 6429 0a0a 2020 2020 6465 6620 746f  end)..    def to
+00034b20: 5f73 7465 7028 7365 6c66 2c20 6375 7272  _step(self, curr
+00034b30: 656e 745f 6964 2c20 7375 7266 6163 655f  ent_id, surface_
+00034b40: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
+00034b50: 2020 2222 2245 7870 6f72 7473 2074 6f20    """Exports to 
+00034b60: 5354 4550 2066 6f72 6d61 742e 2222 220a  STEP format.""".
+00034b70: 2020 2020 2020 2020 2320 4e6f 7420 6361          # Not ca
+00034b80: 6c6c 696e 6720 4369 7263 6c65 3344 2e74  lling Circle3D.t
+00034b90: 6f5f 7374 6570 2062 6563 6175 7365 206f  o_step because o
+00034ba0: 6620 6369 7263 756c 6172 2069 6d70 6f72  f circular impor
+00034bb0: 7473 0a20 2020 2020 2020 2075 203d 2073  ts.        u = s
+00034bc0: 656c 662e 7374 6172 7420 2d20 7365 6c66  elf.start - self
+00034bd0: 2e63 656e 7465 720a 2020 2020 2020 2020  .center.        
+00034be0: 752e 6e6f 726d 616c 697a 6528 290a 2020  u.normalize().  
+00034bf0: 2020 2020 2020 7620 3d20 7365 6c66 2e6e        v = self.n
+00034c00: 6f72 6d61 6c2e 6372 6f73 7328 7529 0a20  ormal.cross(u). 
+00034c10: 2020 2020 2020 2066 7261 6d65 203d 2076         frame = v
+00034c20: 6f6c 6d64 6c72 2e46 7261 6d65 3344 2873  olmdlr.Frame3D(s
+00034c30: 656c 662e 6365 6e74 6572 2c20 7365 6c66  elf.center, self
+00034c40: 2e6e 6f72 6d61 6c2c 2075 2c20 7629 0a20  .normal, u, v). 
+00034c50: 2020 2020 2020 2063 6f6e 7465 6e74 2c20         content, 
+00034c60: 6672 616d 655f 6964 203d 2066 7261 6d65  frame_id = frame
+00034c70: 2e74 6f5f 7374 6570 2863 7572 7265 6e74  .to_step(current
+00034c80: 5f69 6429 0a20 2020 2020 2020 2063 7572  _id).        cur
+00034c90: 7665 5f69 6420 3d20 6672 616d 655f 6964  ve_id = frame_id
+00034ca0: 202b 2031 0a20 2020 2020 2020 2023 204e   + 1.        # N
+00034cb0: 6f74 2063 616c 6c69 6e67 2043 6972 636c  ot calling Circl
+00034cc0: 6533 442e 746f 5f73 7465 7020 6265 6361  e3D.to_step beca
+00034cd0: 7573 6520 6f66 2063 6972 6375 6c61 7220  use of circular 
+00034ce0: 696d 706f 7274 730a 2020 2020 2020 2020  imports.        
+00034cf0: 636f 6e74 656e 7420 2b3d 2022 237b 7d20  content += "#{} 
+00034d00: 3d20 4349 5243 4c45 2827 7b7d 272c 237b  = CIRCLE('{}',#{
+00034d10: 7d2c 7b3a 2e36 667d 293b 5c6e 222e 666f  },{:.6f});\n".fo
+00034d20: 726d 6174 2863 7572 7665 5f69 642c 0a20  rmat(curve_id,. 
+00034d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034d60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00034d70: 2e6e 616d 652c 0a20 2020 2020 2020 2020  .name,.         
+00034d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034db0: 2020 2020 6672 616d 655f 6964 2c0a 2020      frame_id,.  
+00034dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034df0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00034e00: 7261 6469 7573 202a 2031 3030 302c 0a20  radius * 1000,. 
+00034e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034e40: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00034e50: 2020 2020 2020 2069 6620 7375 7266 6163         if surfac
+00034e60: 655f 6964 3a0a 2020 2020 2020 2020 2020  e_id:.          
+00034e70: 2020 636f 6e74 656e 7420 2b3d 2022 237b    content += "#{
+00034e80: 7d20 3d20 5355 5246 4143 455f 4355 5256  } = SURFACE_CURV
+00034e90: 4528 2727 2c23 7b7d 2c28 237b 7d29 2c2e  E('',#{},(#{}),.
+00034ea0: 5043 5552 5645 5f53 312e 293b 5c6e 222e  PCURVE_S1.);\n".
+00034eb0: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
+00034ec0: 2020 2020 2020 2020 6375 7276 655f 6964          curve_id
+00034ed0: 202b 2031 2c20 6375 7276 655f 6964 2c20   + 1, curve_id, 
+00034ee0: 7375 7266 6163 655f 6964 290a 2020 2020  surface_id).    
+00034ef0: 2020 2020 2020 2020 6375 7276 655f 6964          curve_id
+00034f00: 202b 3d20 310a 0a20 2020 2020 2020 2070   += 1..        p
+00034f10: 3120 3d20 2873 656c 662e 6365 6e74 6572  1 = (self.center
+00034f20: 202b 2075 202a 2073 656c 662e 7261 6469   + u * self.radi
+00034f30: 7573 292e 746f 5f70 6f69 6e74 2829 0a20  us).to_point(). 
+00034f40: 2020 2020 2020 2023 2070 3220 3d20 7365         # p2 = se
+00034f50: 6c66 2e63 656e 7465 7220 2b20 762a 7365  lf.center + v*se
+00034f60: 6c66 2e72 6164 6975 730a 2020 2020 2020  lf.radius.      
+00034f70: 2020 2320 7033 203d 2073 656c 662e 6365    # p3 = self.ce
+00034f80: 6e74 6572 202d 2075 2a73 656c 662e 7261  nter - u*self.ra
+00034f90: 6469 7573 0a20 2020 2020 2020 2023 2070  dius.        # p
+00034fa0: 3420 3d20 7365 6c66 2e63 656e 7465 7220  4 = self.center 
+00034fb0: 2d20 762a 7365 6c66 2e72 6164 6975 730a  - v*self.radius.
+00034fc0: 0a20 2020 2020 2020 2070 315f 636f 6e74  .        p1_cont
+00034fd0: 656e 742c 2070 315f 6964 203d 2070 312e  ent, p1_id = p1.
+00034fe0: 746f 5f73 7465 7028 6375 7276 655f 6964  to_step(curve_id
+00034ff0: 202b 2031 2c20 7665 7274 6578 3d54 7275   + 1, vertex=Tru
+00035000: 6529 0a20 2020 2020 2020 2063 6f6e 7465  e).        conte
+00035010: 6e74 202b 3d20 7031 5f63 6f6e 7465 6e74  nt += p1_content
+00035020: 0a20 2020 2020 2020 2023 2070 325f 636f  .        # p2_co
+00035030: 6e74 656e 742c 2070 325f 6964 203d 2070  ntent, p2_id = p
+00035040: 322e 746f 5f73 7465 7028 7031 5f69 642b  2.to_step(p1_id+
+00035050: 312c 2076 6572 7465 783d 5472 7565 290a  1, vertex=True).
+00035060: 2020 2020 2020 2020 2320 7033 5f63 6f6e          # p3_con
+00035070: 7465 6e74 2c20 7033 5f69 6420 3d20 7033  tent, p3_id = p3
+00035080: 2e74 6f5f 7374 6570 2870 325f 6964 2b31  .to_step(p2_id+1
+00035090: 2c20 7665 7274 6578 3d54 7275 6529 0a20  , vertex=True). 
+000350a0: 2020 2020 2020 2023 2070 345f 636f 6e74         # p4_cont
+000350b0: 656e 742c 2070 345f 6964 203d 2070 342e  ent, p4_id = p4.
+000350c0: 746f 5f73 7465 7028 7033 5f69 642b 312c  to_step(p3_id+1,
+000350d0: 2076 6572 7465 783d 5472 7565 290a 2020   vertex=True).  
+000350e0: 2020 2020 2020 2320 636f 6e74 656e 7420        # content 
+000350f0: 2b3d 2070 315f 636f 6e74 656e 7420 2b20  += p1_content + 
+00035100: 7032 5f63 6f6e 7465 6e74 202b 2070 335f  p2_content + p3_
+00035110: 636f 6e74 656e 7420 2b20 7034 5f63 6f6e  content + p4_con
+00035120: 7465 6e74 0a0a 2020 2020 2020 2020 2320  tent..        # 
+00035130: 6172 6331 5f69 6420 3d20 7034 5f69 6420  arc1_id = p4_id 
+00035140: 2b20 310a 2020 2020 2020 2020 2320 636f  + 1.        # co
+00035150: 6e74 656e 7420 2b3d 2022 237b 7d20 3d20  ntent += "#{} = 
+00035160: 4544 4745 5f43 5552 5645 2827 7b7d 272c  EDGE_CURVE('{}',
+00035170: 237b 7d2c 237b 7d2c 237b 7d2c 2e54 2e29  #{},#{},#{},.T.)
+00035180: 3b5c 6e22 2e66 6f72 6d61 7428 6172 6331  ;\n".format(arc1
+00035190: 5f69 642c 2073 656c 662e 6e61 6d65 2c0a  _id, self.name,.
+000351a0: 2020 2020 2020 2020 2320 2020 2020 2020          #       
 000351b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000351c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000351d0: 2020 2020 2020 2020 6369 7263 6c65 5f69          circle_i
-000351e0: 6429 0a0a 2020 2020 2020 2020 2320 6172  d)..        # ar
-000351f0: 6334 5f69 6420 3d20 6172 6333 5f69 6420  c4_id = arc3_id 
-00035200: 2b20 310a 2020 2020 2020 2020 2320 636f  + 1.        # co
-00035210: 6e74 656e 7420 2b3d 2022 237b 7d20 3d20  ntent += "#{} = 
-00035220: 4544 4745 5f43 5552 5645 2827 7b7d 272c  EDGE_CURVE('{}',
-00035230: 237b 7d2c 237b 7d2c 237b 7d2c 2e54 2e29  #{},#{},#{},.T.)
-00035240: 3b5c 6e22 2e66 6f72 6d61 7428 6172 6334  ;\n".format(arc4
-00035250: 5f69 642c 2073 656c 662e 6e61 6d65 2c0a  _id, self.name,.
-00035260: 2020 2020 2020 2020 2320 2020 2020 2020          #       
-00035270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000352a0: 2020 2020 2020 7034 5f69 642c 2070 315f        p4_id, p1_
-000352b0: 6964 2c0a 2020 2020 2020 2020 2320 2020  id,.        #   
-000352c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000351d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000351e0: 2020 2020 2020 7031 5f69 642c 2070 325f        p1_id, p2_
+000351f0: 6964 2c0a 2020 2020 2020 2020 2320 2020  id,.        #   
+00035200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035230: 2020 2020 2020 2020 2020 6369 7263 6c65            circle
+00035240: 5f69 6429 0a0a 2020 2020 2020 2020 2320  _id)..        # 
+00035250: 6172 6332 5f69 6420 3d20 6172 6331 5f69  arc2_id = arc1_i
+00035260: 6420 2b20 310a 2020 2020 2020 2020 2320  d + 1.        # 
+00035270: 636f 6e74 656e 7420 2b3d 2022 237b 7d20  content += "#{} 
+00035280: 3d20 4544 4745 5f43 5552 5645 2827 7b7d  = EDGE_CURVE('{}
+00035290: 272c 237b 7d2c 237b 7d2c 237b 7d2c 2e54  ',#{},#{},#{},.T
+000352a0: 2e29 3b5c 6e22 2e66 6f72 6d61 7428 6172  .);\n".format(ar
+000352b0: 6332 5f69 642c 2073 656c 662e 6e61 6d65  c2_id, self.name
+000352c0: 2c0a 2020 2020 2020 2020 2320 2020 2020  ,.        #     
 000352d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000352e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000352f0: 2020 2020 2020 2020 2020 6369 7263 6c65            circle
-00035300: 5f69 6429 0a0a 2020 2020 2020 2020 6564  _id)..        ed
-00035310: 6765 5f63 7572 7665 203d 2070 315f 6964  ge_curve = p1_id
-00035320: 202b 2031 0a20 2020 2020 2020 2063 6f6e   + 1.        con
-00035330: 7465 6e74 202b 3d20 6622 237b 6564 6765  tent += f"#{edge
-00035340: 5f63 7572 7665 7d20 3d20 4544 4745 5f43  _curve} = EDGE_C
-00035350: 5552 5645 2827 7b73 656c 662e 6e61 6d65  URVE('{self.name
-00035360: 7d27 2c23 7b70 315f 6964 7d2c 237b 7031  }',#{p1_id},#{p1
-00035370: 5f69 647d 2c23 7b63 7572 7665 5f69 647d  _id},#{curve_id}
-00035380: 2c2e 542e 293b 5c6e 220a 2020 2020 2020  ,.T.);\n".      
-00035390: 2020 6375 7276 655f 6964 202b 3d20 310a    curve_id += 1.
-000353a0: 0a20 2020 2020 2020 2023 2072 6574 7572  .        # retur
-000353b0: 6e20 636f 6e74 656e 742c 205b 6172 6331  n content, [arc1
-000353c0: 5f69 642c 2061 7263 325f 6964 2c20 6172  _id, arc2_id, ar
-000353d0: 6333 5f69 642c 2061 7263 345f 6964 5d0a  c3_id, arc4_id].
-000353e0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-000353f0: 6f6e 7465 6e74 2c20 5b65 6467 655f 6375  ontent, [edge_cu
-00035400: 7276 655d 0a0a 2020 2020 6465 6620 706c  rve]..    def pl
-00035410: 6f74 2873 656c 662c 2061 783d 4e6f 6e65  ot(self, ax=None
-00035420: 2c20 636f 6c6f 723d 276b 272c 2061 6c70  , color='k', alp
-00035430: 6861 3d31 2e2c 2065 6467 655f 656e 6473  ha=1., edge_ends
-00035440: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00035450: 2020 2020 2065 6467 655f 6469 7265 6374       edge_direct
-00035460: 696f 6e3d 4661 6c73 6529 3a0a 2020 2020  ion=False):.    
-00035470: 2020 2020 6966 2061 7820 6973 204e 6f6e      if ax is Non
-00035480: 653a 0a20 2020 2020 2020 2020 2020 2061  e:.            a
-00035490: 7820 3d20 4178 6573 3344 2870 6c74 2e66  x = Axes3D(plt.f
-000354a0: 6967 7572 6528 2929 0a0a 2020 2020 2020  igure())..      
-000354b0: 2020 7820 3d20 5b5d 0a20 2020 2020 2020    x = [].       
-000354c0: 2079 203d 205b 5d0a 2020 2020 2020 2020   y = [].        
-000354d0: 7a20 3d20 5b5d 0a20 2020 2020 2020 2066  z = [].        f
-000354e0: 6f72 2070 782c 2070 792c 2070 7a20 696e  or px, py, pz in
-000354f0: 2073 656c 662e 6469 7363 7265 7469 7a61   self.discretiza
-00035500: 7469 6f6e 5f70 6f69 6e74 7328 6e75 6d62  tion_points(numb
-00035510: 6572 5f70 6f69 6e74 733d 3230 293a 0a20  er_points=20):. 
-00035520: 2020 2020 2020 2020 2020 2078 2e61 7070             x.app
-00035530: 656e 6428 7078 290a 2020 2020 2020 2020  end(px).        
-00035540: 2020 2020 792e 6170 7065 6e64 2870 7929      y.append(py)
-00035550: 0a20 2020 2020 2020 2020 2020 207a 2e61  .            z.a
-00035560: 7070 656e 6428 707a 290a 2020 2020 2020  ppend(pz).      
-00035570: 2020 782e 6170 7065 6e64 2878 5b30 5d29    x.append(x[0])
-00035580: 0a20 2020 2020 2020 2079 2e61 7070 656e  .        y.appen
-00035590: 6428 795b 305d 290a 2020 2020 2020 2020  d(y[0]).        
-000355a0: 7a2e 6170 7065 6e64 287a 5b30 5d29 0a20  z.append(z[0]). 
-000355b0: 2020 2020 2020 2061 782e 706c 6f74 2878         ax.plot(x
-000355c0: 2c20 792c 207a 2c20 636f 6c6f 723d 636f  , y, z, color=co
-000355d0: 6c6f 722c 2061 6c70 6861 3d61 6c70 6861  lor, alpha=alpha
-000355e0: 290a 0a20 2020 2020 2020 2069 6620 6564  )..        if ed
-000355f0: 6765 5f65 6e64 733a 0a20 2020 2020 2020  ge_ends:.       
-00035600: 2020 2020 2073 656c 662e 7374 6172 742e       self.start.
-00035610: 706c 6f74 2861 783d 6178 290a 2020 2020  plot(ax=ax).    
-00035620: 2020 2020 2020 2020 7365 6c66 2e65 6e64          self.end
-00035630: 2e70 6c6f 7428 6178 3d61 7829 0a0a 2020  .plot(ax=ax)..  
-00035640: 2020 2020 2020 6966 2065 6467 655f 6469        if edge_di
-00035650: 7265 6374 696f 6e3a 0a20 2020 2020 2020  rection:.       
-00035660: 2020 2020 2073 203d 2030 2e35 202a 2073       s = 0.5 * s
-00035670: 656c 662e 6c65 6e67 7468 2829 0a20 2020  elf.length().   
-00035680: 2020 2020 2020 2020 2078 2c20 792c 207a           x, y, z
-00035690: 203d 2073 656c 662e 706f 696e 745f 6174   = self.point_at
-000356a0: 5f61 6273 6369 7373 6128 7329 0a20 2020  _abscissa(s).   
-000356b0: 2020 2020 2020 2020 2074 616e 6765 6e74           tangent
-000356c0: 203d 2073 656c 662e 756e 6974 5f64 6972   = self.unit_dir
-000356d0: 6563 7469 6f6e 5f76 6563 746f 7228 7329  ection_vector(s)
-000356e0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-000356f0: 6f77 5f6c 656e 6774 6820 3d20 302e 3135  ow_length = 0.15
-00035700: 202a 2073 0a20 2020 2020 2020 2020 2020   * s.           
-00035710: 2061 782e 7175 6976 6572 2878 2c20 792c   ax.quiver(x, y,
-00035720: 207a 2c20 2a61 7272 6f77 5f6c 656e 6774   z, *arrow_lengt
-00035730: 6820 2a20 7461 6e67 656e 742c 0a20 2020  h * tangent,.   
-00035740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035750: 2020 2070 6976 6f74 3d27 7469 7027 290a     pivot='tip').
-00035760: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00035770: 6178 0a0a 2020 2020 6465 6620 726f 7461  ax..    def rota
-00035780: 7469 6f6e 2873 656c 662c 2063 656e 7465  tion(self, cente
-00035790: 723a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  r: volmdlr.Point
-000357a0: 3344 2c20 6178 6973 3a20 766f 6c6d 646c  3D, axis: volmdl
-000357b0: 722e 5665 6374 6f72 3344 2c20 616e 676c  r.Vector3D, angl
-000357c0: 653a 2066 6c6f 6174 293a 0a20 2020 2020  e: float):.     
-000357d0: 2020 206e 6577 5f73 7461 7274 5f65 6e64     new_start_end
-000357e0: 203d 2073 656c 662e 7374 6172 742e 726f   = self.start.ro
-000357f0: 7461 7469 6f6e 2863 656e 7465 722c 2061  tation(center, a
-00035800: 7869 732c 2061 6e67 6c65 290a 2020 2020  xis, angle).    
-00035810: 2020 2020 6e65 775f 6365 6e74 6572 203d      new_center =
-00035820: 2073 656c 662e 5f63 656e 7465 722e 726f   self._center.ro
-00035830: 7461 7469 6f6e 2863 656e 7465 722c 2061  tation(center, a
-00035840: 7869 732c 2061 6e67 6c65 290a 2020 2020  xis, angle).    
-00035850: 2020 2020 6e65 775f 6e6f 726d 616c 203d      new_normal =
-00035860: 2073 656c 662e 5f6e 6f72 6d61 6c2e 726f   self._normal.ro
-00035870: 7461 7469 6f6e 2863 656e 7465 722c 2061  tation(center, a
-00035880: 7869 732c 2061 6e67 6c65 290a 2020 2020  xis, angle).    
-00035890: 2020 2020 7265 7475 726e 2046 756c 6c41      return FullA
-000358a0: 7263 3344 286e 6577 5f63 656e 7465 722c  rc3D(new_center,
-000358b0: 206e 6577 5f73 7461 7274 5f65 6e64 2c0a   new_start_end,.
-000358c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000358d0: 2020 2020 2020 2020 206e 6577 5f6e 6f72           new_nor
-000358e0: 6d61 6c2c 206e 616d 653d 7365 6c66 2e6e  mal, name=self.n
-000358f0: 616d 6529 0a0a 2020 2020 6465 6620 726f  ame)..    def ro
-00035900: 7461 7469 6f6e 5f69 6e70 6c61 6365 2873  tation_inplace(s
-00035910: 656c 662c 2063 656e 7465 723a 2076 6f6c  elf, center: vol
-00035920: 6d64 6c72 2e50 6f69 6e74 3344 2c20 6178  mdlr.Point3D, ax
-00035930: 6973 3a20 766f 6c6d 646c 722e 5665 6374  is: volmdlr.Vect
-00035940: 6f72 3344 2c20 616e 676c 653a 2066 6c6f  or3D, angle: flo
-00035950: 6174 293a 0a20 2020 2020 2020 2077 6172  at):.        war
-00035960: 6e69 6e67 732e 7761 726e 2822 2769 6e70  nings.warn("'inp
-00035970: 6c61 6365 2720 6d65 7468 6f64 7320 6172  lace' methods ar
-00035980: 6520 6465 7072 6563 6174 6564 2e20 5573  e deprecated. Us
-00035990: 6520 6120 6e6f 7420 696e 706c 6163 6520  e a not inplace 
-000359a0: 6d65 7468 6f64 2069 6e73 7465 6164 2e22  method instead."
-000359b0: 2c20 4465 7072 6563 6174 696f 6e57 6172  , DeprecationWar
-000359c0: 6e69 6e67 290a 0a20 2020 2020 2020 2073  ning)..        s
-000359d0: 656c 662e 7374 6172 742e 726f 7461 7469  elf.start.rotati
-000359e0: 6f6e 2863 656e 7465 722c 2061 7869 732c  on(center, axis,
-000359f0: 2061 6e67 6c65 2c20 4661 6c73 6529 0a20   angle, False). 
-00035a00: 2020 2020 2020 2073 656c 662e 656e 642e         self.end.
-00035a10: 726f 7461 7469 6f6e 2863 656e 7465 722c  rotation(center,
-00035a20: 2061 7869 732c 2061 6e67 6c65 2c20 4661   axis, angle, Fa
-00035a30: 6c73 6529 0a20 2020 2020 2020 2073 656c  lse).        sel
-00035a40: 662e 5f63 656e 7465 722e 726f 7461 7469  f._center.rotati
-00035a50: 6f6e 2863 656e 7465 722c 2061 7869 732c  on(center, axis,
-00035a60: 2061 6e67 6c65 2c20 4661 6c73 6529 0a20   angle, False). 
-00035a70: 2020 2020 2020 2073 656c 662e 696e 7465         self.inte
-00035a80: 7269 6f72 2e72 6f74 6174 696f 6e28 6365  rior.rotation(ce
-00035a90: 6e74 6572 2c20 6178 6973 2c20 616e 676c  nter, axis, angl
-00035aa0: 652c 2046 616c 7365 290a 2020 2020 2020  e, False).      
-00035ab0: 2020 7365 6c66 2e5f 6262 6f78 203d 204e    self._bbox = N
-00035ac0: 6f6e 650a 0a20 2020 2064 6566 2074 7261  one..    def tra
-00035ad0: 6e73 6c61 7469 6f6e 2873 656c 662c 206f  nslation(self, o
-00035ae0: 6666 7365 743a 2076 6f6c 6d64 6c72 2e56  ffset: volmdlr.V
-00035af0: 6563 746f 7233 4429 3a0a 2020 2020 2020  ector3D):.      
-00035b00: 2020 6e65 775f 7374 6172 745f 656e 6420    new_start_end 
-00035b10: 3d20 7365 6c66 2e73 7461 7274 2e74 7261  = self.start.tra
-00035b20: 6e73 6c61 7469 6f6e 286f 6666 7365 742c  nslation(offset,
-00035b30: 2054 7275 6529 0a20 2020 2020 2020 206e   True).        n
-00035b40: 6577 5f63 656e 7465 7220 3d20 7365 6c66  ew_center = self
-00035b50: 2e5f 6365 6e74 6572 2e74 7261 6e73 6c61  ._center.transla
-00035b60: 7469 6f6e 286f 6666 7365 742c 2054 7275  tion(offset, Tru
-00035b70: 6529 0a20 2020 2020 2020 206e 6577 5f6e  e).        new_n
-00035b80: 6f72 6d61 6c20 3d20 7365 6c66 2e5f 6e6f  ormal = self._no
-00035b90: 726d 616c 2e74 7261 6e73 6c61 7469 6f6e  rmal.translation
-00035ba0: 286f 6666 7365 742c 2054 7275 6529 0a20  (offset, True). 
-00035bb0: 2020 2020 2020 2072 6574 7572 6e20 4675         return Fu
-00035bc0: 6c6c 4172 6333 4428 6e65 775f 6365 6e74  llArc3D(new_cent
-00035bd0: 6572 2c20 6e65 775f 7374 6172 745f 656e  er, new_start_en
-00035be0: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
-00035bf0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00035c00: 6e6f 726d 616c 2c20 6e61 6d65 3d73 656c  normal, name=sel
-00035c10: 662e 6e61 6d65 290a 0a20 2020 2064 6566  f.name)..    def
-00035c20: 2074 7261 6e73 6c61 7469 6f6e 5f69 6e70   translation_inp
-00035c30: 6c61 6365 2873 656c 662c 206f 6666 7365  lace(self, offse
-00035c40: 743a 2076 6f6c 6d64 6c72 2e56 6563 746f  t: volmdlr.Vecto
-00035c50: 7233 4429 3a0a 2020 2020 2020 2020 7761  r3D):.        wa
-00035c60: 726e 696e 6773 2e77 6172 6e28 2227 696e  rnings.warn("'in
-00035c70: 706c 6163 6527 206d 6574 686f 6473 2061  place' methods a
-00035c80: 7265 2064 6570 7265 6361 7465 642e 2055  re deprecated. U
-00035c90: 7365 2061 206e 6f74 2069 6e70 6c61 6365  se a not inplace
-00035ca0: 206d 6574 686f 6420 696e 7374 6561 642e   method instead.
-00035cb0: 222c 2044 6570 7265 6361 7469 6f6e 5761  ", DeprecationWa
-00035cc0: 726e 696e 6729 0a0a 2020 2020 2020 2020  rning)..        
-00035cd0: 7365 6c66 2e73 7461 7274 2e74 7261 6e73  self.start.trans
-00035ce0: 6c61 7469 6f6e 286f 6666 7365 742c 2046  lation(offset, F
-00035cf0: 616c 7365 290a 2020 2020 2020 2020 7365  alse).        se
-00035d00: 6c66 2e65 6e64 2e74 7261 6e73 6c61 7469  lf.end.translati
-00035d10: 6f6e 286f 6666 7365 742c 2046 616c 7365  on(offset, False
-00035d20: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
-00035d30: 6365 6e74 6572 2e74 7261 6e73 6c61 7469  center.translati
-00035d40: 6f6e 286f 6666 7365 742c 2046 616c 7365  on(offset, False
-00035d50: 290a 2020 2020 2020 2020 7365 6c66 2e69  ).        self.i
-00035d60: 6e74 6572 696f 722e 7472 616e 736c 6174  nterior.translat
-00035d70: 696f 6e28 6f66 6673 6574 2c20 4661 6c73  ion(offset, Fals
-00035d80: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
-00035d90: 5f62 626f 7820 3d20 4e6f 6e65 0a0a 2020  _bbox = None..  
-00035da0: 2020 6465 6620 6c69 6e65 7365 676d 656e    def linesegmen
-00035db0: 745f 696e 7465 7273 6563 7469 6f6e 7328  t_intersections(
-00035dc0: 7365 6c66 2c20 6c69 6e65 7365 676d 656e  self, linesegmen
-00035dd0: 743a 204c 696e 6553 6567 6d65 6e74 3344  t: LineSegment3D
-00035de0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00035df0: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
-00035e00: 7320 7468 6520 696e 7465 7273 6563 7469  s the intersecti
-00035e10: 6f6e 7320 6265 7477 6565 6e20 6120 6675  ons between a fu
-00035e20: 6c6c 6172 6333 6420 616e 6420 6120 6c69  llarc3d and a li
-00035e30: 6e65 7365 676d 656e 7433 642e 0a0a 2020  nesegment3d...  
-00035e40: 2020 2020 2020 3a70 6172 616d 206c 696e        :param lin
-00035e50: 6573 6567 6d65 6e74 3a20 6c69 6e65 7365  esegment: linese
-00035e60: 676d 656e 7433 6420 746f 2076 6572 6966  gment3d to verif
-00035e70: 7920 696e 7465 7273 6563 7469 6f6e 732e  y intersections.
-00035e80: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00035e90: 3a20 6c69 7374 206f 6620 706f 696e 7473  : list of points
-00035ea0: 3364 2c20 6966 2074 6865 7265 2061 7265  3d, if there are
-00035eb0: 2061 6e79 2069 6e74 6572 7365 6374 696f   any intersectio
-00035ec0: 6e73 2c20 616e 2065 6d70 7479 206c 6973  ns, an empty lis
-00035ed0: 7420 6966 206f 7468 6572 7769 7365 2e0a  t if otherwise..
-00035ee0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00035ef0: 2020 2020 6469 7374 616e 6365 5f63 656e      distance_cen
-00035f00: 7465 725f 6c69 6e65 7365 6720 3d20 6c69  ter_lineseg = li
-00035f10: 6e65 7365 676d 656e 742e 706f 696e 745f  nesegment.point_
-00035f20: 6469 7374 616e 6365 2873 656c 662e 6672  distance(self.fr
-00035f30: 616d 652e 6f72 6967 696e 290a 2020 2020  ame.origin).    
-00035f40: 2020 2020 6966 2064 6973 7461 6e63 655f      if distance_
-00035f50: 6365 6e74 6572 5f6c 696e 6573 6567 203e  center_lineseg >
-00035f60: 2073 656c 662e 7261 6469 7573 3a0a 2020   self.radius:.  
-00035f70: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00035f80: 205b 5d0a 2020 2020 2020 2020 6469 7265   [].        dire
-00035f90: 6374 696f 6e5f 7665 6374 6f72 203d 206c  ction_vector = l
-00035fa0: 696e 6573 6567 6d65 6e74 2e64 6972 6563  inesegment.direc
-00035fb0: 7469 6f6e 5f76 6563 746f 7228 290a 2020  tion_vector().  
-00035fc0: 2020 2020 2020 6966 206d 6174 682e 6973        if math.is
-00035fd0: 636c 6f73 6528 7365 6c66 2e66 7261 6d65  close(self.frame
-00035fe0: 2e77 2e64 6f74 2864 6972 6563 7469 6f6e  .w.dot(direction
-00035ff0: 5f76 6563 746f 7229 2c20 302c 2061 6273  _vector), 0, abs
-00036000: 5f74 6f6c 3d31 652d 3629 2061 6e64 205c  _tol=1e-6) and \
-00036010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036020: 206e 6f74 206d 6174 682e 6973 636c 6f73   not math.isclos
-00036030: 6528 6c69 6e65 7365 676d 656e 742e 7374  e(linesegment.st
-00036040: 6172 742e 7a20 2d20 7365 6c66 2e66 7261  art.z - self.fra
-00036050: 6d65 2e6f 7269 6769 6e2e 7a2c 2030 2c20  me.origin.z, 0, 
-00036060: 6162 735f 746f 6c3d 3165 2d36 293a 0a20  abs_tol=1e-6):. 
-00036070: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00036080: 6e20 5b5d 0a0a 2020 2020 2020 2020 6966  n []..        if
-00036090: 206c 696e 6573 6567 6d65 6e74 2e73 7461   linesegment.sta
-000360a0: 7274 2e7a 203d 3d20 6c69 6e65 7365 676d  rt.z == linesegm
-000360b0: 656e 742e 656e 642e 7a20 3d3d 2073 656c  ent.end.z == sel
-000360c0: 662e 6672 616d 652e 6f72 6967 696e 2e7a  f.frame.origin.z
-000360d0: 3a0a 2020 2020 2020 2020 2020 2020 7175  :.            qu
-000360e0: 6164 7261 7469 635f 6571 7561 7469 6f6e  adratic_equation
-000360f0: 5f61 203d 2031 202b 2028 6469 7265 6374  _a = 1 + (direct
-00036100: 696f 6e5f 7665 6374 6f72 2e79 202a 2a20  ion_vector.y ** 
-00036110: 3220 2f20 6469 7265 6374 696f 6e5f 7665  2 / direction_ve
-00036120: 6374 6f72 2e78 202a 2a20 3229 0a20 2020  ctor.x ** 2).   
-00036130: 2020 2020 2020 2020 2071 7561 6472 6174           quadrat
-00036140: 6963 5f65 7175 6174 696f 6e5f 6220 3d20  ic_equation_b = 
-00036150: 2d32 202a 2028 6469 7265 6374 696f 6e5f  -2 * (direction_
-00036160: 7665 6374 6f72 2e79 202a 2a20 3220 2f20  vector.y ** 2 / 
-00036170: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
-00036180: 2e78 202a 2a20 3229 202a 206c 696e 6573  .x ** 2) * lines
-00036190: 6567 6d65 6e74 2e73 7461 7274 2e78 202b  egment.start.x +
-000361a0: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
-000361b0: 2020 2032 202a 2028 6469 7265 6374 696f     2 * (directio
-000361c0: 6e5f 7665 6374 6f72 2e79 202f 2064 6972  n_vector.y / dir
-000361d0: 6563 7469 6f6e 5f76 6563 746f 722e 7829  ection_vector.x)
-000361e0: 202a 206c 696e 6573 6567 6d65 6e74 2e73   * linesegment.s
-000361f0: 7461 7274 2e79 0a20 2020 2020 2020 2020  tart.y.         
-00036200: 2020 2071 7561 6472 6174 6963 5f65 7175     quadratic_equ
-00036210: 6174 696f 6e5f 6320 3d20 286c 696e 6573  ation_c = (lines
-00036220: 6567 6d65 6e74 2e73 7461 7274 2e79 202d  egment.start.y -
-00036230: 2028 6469 7265 6374 696f 6e5f 7665 6374   (direction_vect
-00036240: 6f72 2e79 202f 2064 6972 6563 7469 6f6e  or.y / direction
-00036250: 5f76 6563 746f 722e 7829 202a 0a20 2020  _vector.x) *.   
-00036260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036280: 206c 696e 6573 6567 6d65 6e74 2e73 7461   linesegment.sta
-00036290: 7274 2e78 2920 2a2a 2032 202d 2073 656c  rt.x) ** 2 - sel
-000362a0: 662e 7261 6469 7573 202a 2a20 320a 2020  f.radius ** 2.  
-000362b0: 2020 2020 2020 2020 2020 6465 6c74 6120            delta 
-000362c0: 3d20 7175 6164 7261 7469 635f 6571 7561  = quadratic_equa
-000362d0: 7469 6f6e 5f62 202a 2a20 3220 2d20 3420  tion_b ** 2 - 4 
-000362e0: 2a20 7175 6164 7261 7469 635f 6571 7561  * quadratic_equa
-000362f0: 7469 6f6e 5f61 202a 2071 7561 6472 6174  tion_a * quadrat
-00036300: 6963 5f65 7175 6174 696f 6e5f 630a 2020  ic_equation_c.  
-00036310: 2020 2020 2020 2020 2020 7831 203d 2028            x1 = (
-00036320: 2d20 7175 6164 7261 7469 635f 6571 7561  - quadratic_equa
-00036330: 7469 6f6e 5f62 202b 206d 6174 682e 7371  tion_b + math.sq
-00036340: 7274 2864 656c 7461 2929 202f 2028 3220  rt(delta)) / (2 
-00036350: 2a20 7175 6164 7261 7469 635f 6571 7561  * quadratic_equa
-00036360: 7469 6f6e 5f61 290a 2020 2020 2020 2020  tion_a).        
-00036370: 2020 2020 7832 203d 2028 2d20 7175 6164      x2 = (- quad
-00036380: 7261 7469 635f 6571 7561 7469 6f6e 5f62  ratic_equation_b
-00036390: 202d 206d 6174 682e 7371 7274 2864 656c   - math.sqrt(del
-000363a0: 7461 2929 202f 2028 3220 2a20 7175 6164  ta)) / (2 * quad
-000363b0: 7261 7469 635f 6571 7561 7469 6f6e 5f61  ratic_equation_a
-000363c0: 290a 2020 2020 2020 2020 2020 2020 7931  ).            y1
-000363d0: 203d 2028 6469 7265 6374 696f 6e5f 7665   = (direction_ve
-000363e0: 6374 6f72 2e79 202f 2064 6972 6563 7469  ctor.y / directi
-000363f0: 6f6e 5f76 6563 746f 722e 7829 202a 2028  on_vector.x) * (
-00036400: 7831 202d 206c 696e 6573 6567 6d65 6e74  x1 - linesegment
-00036410: 2e73 7461 7274 2e78 2920 2b20 6c69 6e65  .start.x) + line
-00036420: 7365 676d 656e 742e 7374 6172 742e 790a  segment.start.y.
-00036430: 2020 2020 2020 2020 2020 2020 7932 203d              y2 =
-00036440: 2028 6469 7265 6374 696f 6e5f 7665 6374   (direction_vect
-00036450: 6f72 2e79 202f 2064 6972 6563 7469 6f6e  or.y / direction
-00036460: 5f76 6563 746f 722e 7829 202a 2028 7832  _vector.x) * (x2
-00036470: 202d 206c 696e 6573 6567 6d65 6e74 2e73   - linesegment.s
-00036480: 7461 7274 2e78 2920 2b20 6c69 6e65 7365  tart.x) + linese
-00036490: 676d 656e 742e 7374 6172 742e 790a 2020  gment.start.y.  
-000364a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000364b0: 205b 766f 6c6d 646c 722e 506f 696e 7433   [volmdlr.Point3
-000364c0: 4428 7831 2c20 7931 2c20 7365 6c66 2e66  D(x1, y1, self.f
-000364d0: 7261 6d65 2e6f 7269 6769 6e2e 7a29 2c20  rame.origin.z), 
-000364e0: 766f 6c6d 646c 722e 506f 696e 7433 4428  volmdlr.Point3D(
-000364f0: 7832 2c20 7932 2c20 7365 6c66 2e66 7261  x2, y2, self.fra
-00036500: 6d65 2e6f 7269 6769 6e2e 7a29 5d0a 2020  me.origin.z)].  
-00036510: 2020 2020 2020 6966 206d 6174 682e 6973        if math.is
-00036520: 636c 6f73 6528 6469 7265 6374 696f 6e5f  close(direction_
-00036530: 7665 6374 6f72 2e7a 2c20 302c 2061 6273  vector.z, 0, abs
-00036540: 5f74 6f6c 3d31 652d 3629 3a0a 2020 2020  _tol=1e-6):.    
-00036550: 2020 2020 2020 2020 7072 696e 7428 5472          print(Tr
-00036560: 7565 290a 2020 2020 2020 2020 636f 6e73  ue).        cons
-00036570: 7461 6e74 203d 2028 7365 6c66 2e66 7261  tant = (self.fra
-00036580: 6d65 2e6f 7269 6769 6e2e 7a20 2d20 6c69  me.origin.z - li
-00036590: 6e65 7365 676d 656e 742e 7374 6172 742e  nesegment.start.
-000365a0: 7a29 202f 2064 6972 6563 7469 6f6e 5f76  z) / direction_v
-000365b0: 6563 746f 722e 7a0a 2020 2020 2020 2020  ector.z.        
-000365c0: 785f 636f 6f72 6469 6e61 7465 203d 2063  x_coordinate = c
-000365d0: 6f6e 7374 616e 7420 2a20 6469 7265 6374  onstant * direct
-000365e0: 696f 6e5f 7665 6374 6f72 2e78 202b 206c  ion_vector.x + l
-000365f0: 696e 6573 6567 6d65 6e74 2e73 7461 7274  inesegment.start
-00036600: 2e78 0a20 2020 2020 2020 2079 5f63 6f6f  .x.        y_coo
-00036610: 7264 696e 6174 6520 3d20 636f 6e73 7461  rdinate = consta
-00036620: 6e74 202a 2064 6972 6563 7469 6f6e 5f76  nt * direction_v
-00036630: 6563 746f 722e 7920 2b20 6c69 6e65 7365  ector.y + linese
-00036640: 676d 656e 742e 7374 6172 742e 790a 2020  gment.start.y.  
-00036650: 2020 2020 2020 6966 206d 6174 682e 6973        if math.is
-00036660: 636c 6f73 6528 2878 5f63 6f6f 7264 696e  close((x_coordin
-00036670: 6174 6520 2d20 7365 6c66 2e66 7261 6d65  ate - self.frame
-00036680: 2e6f 7269 6769 6e2e 7829 202a 2a20 3220  .origin.x) ** 2 
-00036690: 2b20 2879 5f63 6f6f 7264 696e 6174 6520  + (y_coordinate 
-000366a0: 2d20 7365 6c66 2e66 7261 6d65 2e6f 7269  - self.frame.ori
-000366b0: 6769 6e2e 7929 202a 2a20 322c 0a20 2020  gin.y) ** 2,.   
-000366c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000366d0: 2020 2020 2073 656c 662e 7261 6469 7573       self.radius
-000366e0: 202a 2a20 322c 2061 6273 5f74 6f6c 3d31   ** 2, abs_tol=1
-000366f0: 652d 3629 3a0a 2020 2020 2020 2020 2020  e-6):.          
-00036700: 2020 7265 7475 726e 205b 766f 6c6d 646c    return [volmdl
-00036710: 722e 506f 696e 7433 4428 785f 636f 6f72  r.Point3D(x_coor
-00036720: 6469 6e61 7465 2c20 795f 636f 6f72 6469  dinate, y_coordi
-00036730: 6e61 7465 2c20 7365 6c66 2e66 7261 6d65  nate, self.frame
-00036740: 2e6f 7269 6769 6e2e 7a29 5d0a 2020 2020  .origin.z)].    
-00036750: 2020 2020 7265 7475 726e 205b 5d0a 0a20      return [].. 
-00036760: 2020 2064 6566 2072 6576 6572 7365 2873     def reverse(s
-00036770: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00036780: 220a 2020 2020 2020 2020 4465 6669 6e65  ".        Define
-00036790: 7320 6120 6e65 7720 4675 6c6c 4172 6333  s a new FullArc3
-000367a0: 442c 2069 6465 6e74 6963 616c 2074 6f20  D, identical to 
-000367b0: 7365 6c66 2c20 6275 7420 696e 2074 6865  self, but in the
-000367c0: 206f 7070 6f73 6974 6520 6469 7265 6374   opposite direct
-000367d0: 696f 6e2e 0a0a 2020 2020 2020 2020 2222  ion...        ""
-000367e0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-000367f0: 2073 656c 660a 0a0a 636c 6173 7320 4172   self...class Ar
-00036800: 6345 6c6c 6970 7365 3344 2845 6467 6529  cEllipse3D(Edge)
-00036810: 3a0a 2020 2020 2222 220a 2020 2020 416e  :.    """.    An
-00036820: 2061 7263 2069 7320 6465 6669 6e65 6420   arc is defined 
-00036830: 6279 2061 2073 7461 7274 696e 6720 706f  by a starting po
-00036840: 696e 742c 2061 6e20 656e 6420 706f 696e  int, an end poin
-00036850: 7420 616e 6420 616e 2069 6e74 6572 696f  t and an interio
-00036860: 7220 706f 696e 742e 0a0a 2020 2020 2222  r point...    ""
-00036870: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
-00036880: 745f 5f28 7365 6c66 2c20 7374 6172 742c  t__(self, start,
-00036890: 2069 6e74 6572 696f 722c 2065 6e64 2c20   interior, end, 
-000368a0: 6365 6e74 6572 2c20 6d61 6a6f 725f 6469  center, major_di
-000368b0: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-000368c0: 2020 2020 6e61 6d65 3d27 2729 3a20 2023      name=''):  #
-000368d0: 202c 2065 7874 7261 3d4e 6f6e 6529 3a0a   , extra=None):.
-000368e0: 2020 2020 2020 2020 4564 6765 2e5f 5f69          Edge.__i
-000368f0: 6e69 745f 5f28 7365 6c66 2c20 7374 6172  nit__(self, star
-00036900: 743d 7374 6172 742c 2065 6e64 3d65 6e64  t=start, end=end
-00036910: 2c20 6e61 6d65 3d6e 616d 6529 0a20 2020  , name=name).   
-00036920: 2020 2020 2073 656c 662e 696e 7465 7269       self.interi
-00036930: 6f72 203d 2069 6e74 6572 696f 720a 2020  or = interior.  
-00036940: 2020 2020 2020 7365 6c66 2e63 656e 7465        self.cente
-00036950: 7220 3d20 6365 6e74 6572 0a20 2020 2020  r = center.     
-00036960: 2020 206d 616a 6f72 5f64 6972 2e6e 6f72     major_dir.nor
-00036970: 6d61 6c69 7a65 2829 0a20 2020 2020 2020  malize().       
-00036980: 2073 656c 662e 6d61 6a6f 725f 6469 7220   self.major_dir 
-00036990: 3d20 6d61 6a6f 725f 6469 7220 2023 2056  = major_dir  # V
-000369a0: 6563 746f 7220 666f 7220 4772 6164 6975  ector for Gradiu
-000369b0: 730a 2020 2020 2020 2020 2320 7365 6c66  s.        # self
-000369c0: 2e65 7874 7261 203d 2065 7874 7261 0a0a  .extra = extra..
-000369d0: 2020 2020 2020 2020 7531 203d 2073 656c          u1 = sel
-000369e0: 662e 696e 7465 7269 6f72 202d 2073 656c  f.interior - sel
-000369f0: 662e 7374 6172 740a 2020 2020 2020 2020  f.start.        
-00036a00: 7532 203d 2073 656c 662e 696e 7465 7269  u2 = self.interi
-00036a10: 6f72 202d 2073 656c 662e 656e 640a 2020  or - self.end.  
-00036a20: 2020 2020 2020 7531 2e6e 6f72 6d61 6c69        u1.normali
-00036a30: 7a65 2829 0a20 2020 2020 2020 2075 322e  ze().        u2.
-00036a40: 6e6f 726d 616c 697a 6528 290a 2020 2020  normalize().    
-00036a50: 2020 2020 6966 2075 3120 3d3d 2075 323a      if u1 == u2:
-00036a60: 0a20 2020 2020 2020 2020 2020 2075 3220  .            u2 
-00036a70: 3d20 7365 6c66 2e69 6e74 6572 696f 7220  = self.interior 
-00036a80: 2d20 7365 6c66 2e69 6e74 6572 696f 720a  - self.interior.
-00036a90: 2020 2020 2020 2020 2020 2020 7532 2e6e              u2.n
-00036aa0: 6f72 6d61 6c69 7a65 2829 0a0a 2020 2020  ormalize()..    
-00036ab0: 2020 2020 6e20 3d20 7532 2e63 726f 7373      n = u2.cross
-00036ac0: 2875 3129 0a20 2020 2020 2020 206e 2e6e  (u1).        n.n
-00036ad0: 6f72 6d61 6c69 7a65 2829 0a20 2020 2020  ormalize().     
-00036ae0: 2020 2073 656c 662e 6e6f 726d 616c 203d     self.normal =
-00036af0: 206e 0a0a 2020 2020 2020 2020 7365 6c66   n..        self
-00036b00: 2e6d 696e 6f72 5f64 6972 203d 2073 656c  .minor_dir = sel
-00036b10: 662e 6e6f 726d 616c 2e63 726f 7373 2873  f.normal.cross(s
-00036b20: 656c 662e 6d61 6a6f 725f 6469 7229 0a0a  elf.major_dir)..
-00036b30: 2020 2020 2020 2020 6672 616d 6520 3d20          frame = 
-00036b40: 766f 6c6d 646c 722e 4672 616d 6533 4428  volmdlr.Frame3D(
-00036b50: 7365 6c66 2e63 656e 7465 722c 2073 656c  self.center, sel
-00036b60: 662e 6d61 6a6f 725f 6469 722c 2073 656c  f.major_dir, sel
-00036b70: 662e 6d69 6e6f 725f 6469 722c 2073 656c  f.minor_dir, sel
-00036b80: 662e 6e6f 726d 616c 290a 2020 2020 2020  f.normal).      
-00036b90: 2020 7365 6c66 2e66 7261 6d65 203d 2066    self.frame = f
-00036ba0: 7261 6d65 0a20 2020 2020 2020 2073 7461  rame.        sta
-00036bb0: 7274 5f6e 6577 2c20 656e 645f 6e65 7720  rt_new, end_new 
-00036bc0: 3d20 6672 616d 652e 676c 6f62 616c 5f74  = frame.global_t
-00036bd0: 6f5f 6c6f 6361 6c5f 636f 6f72 6469 6e61  o_local_coordina
-00036be0: 7465 7328 0a20 2020 2020 2020 2020 2020  tes(.           
-00036bf0: 2073 656c 662e 7374 6172 7429 2c20 6672   self.start), fr
-00036c00: 616d 652e 676c 6f62 616c 5f74 6f5f 6c6f  ame.global_to_lo
-00036c10: 6361 6c5f 636f 6f72 6469 6e61 7465 7328  cal_coordinates(
-00036c20: 7365 6c66 2e65 6e64 290a 2020 2020 2020  self.end).      
-00036c30: 2020 696e 7465 7269 6f72 5f6e 6577 2c20    interior_new, 
-00036c40: 6365 6e74 6572 5f6e 6577 203d 2066 7261  center_new = fra
-00036c50: 6d65 2e67 6c6f 6261 6c5f 746f 5f6c 6f63  me.global_to_loc
-00036c60: 616c 5f63 6f6f 7264 696e 6174 6573 280a  al_coordinates(.
-00036c70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00036c80: 2e69 6e74 6572 696f 7229 2c20 6672 616d  .interior), fram
-00036c90: 652e 676c 6f62 616c 5f74 6f5f 6c6f 6361  e.global_to_loca
-00036ca0: 6c5f 636f 6f72 6469 6e61 7465 7328 7365  l_coordinates(se
-00036cb0: 6c66 2e63 656e 7465 7229 0a20 2020 2020  lf.center).     
-00036cc0: 2020 2073 656c 662e 5f62 626f 7820 3d20     self._bbox = 
-00036cd0: 4e6f 6e65 0a20 2020 2020 2020 2023 2066  None.        # f
-00036ce0: 726f 6d20 3a0a 2020 2020 2020 2020 2320  rom :.        # 
-00036cf0: 6874 7470 733a 2f2f 6d61 7468 2e73 7461  https://math.sta
-00036d00: 636b 6578 6368 616e 6765 2e63 6f6d 2f71  ckexchange.com/q
-00036d10: 7565 7374 696f 6e73 2f33 3339 3132 362f  uestions/339126/
-00036d20: 686f 772d 746f 2d64 7261 772d 616e 2d65  how-to-draw-an-e
-00036d30: 6c6c 6970 7365 2d69 662d 612d 6365 6e74  llipse-if-a-cent
-00036d40: 6572 2d61 6e64 2d33 2d61 7262 6974 7261  er-and-3-arbitra
-00036d50: 7279 2d70 6f69 6e74 732d 6f6e 2d69 742d  ry-points-on-it-
-00036d60: 6172 652d 6769 7665 6e0a 0a20 2020 2020  are-given..     
-00036d70: 2020 2064 6566 2074 6865 7461 5f41 5f42     def theta_A_B
-00036d80: 2873 2c20 692c 2065 2c20 6329 3a0a 2020  (s, i, e, c):.  
-00036d90: 2020 2020 2020 2020 2020 2320 7468 6574            # thet
-00036da0: 613d 616e 676c 6520 6427 696e 636c 696e  a=angle d'inclin
-00036db0: 6169 736f 6e20 656c 6c69 7073 6520 7061  aison ellipse pa
-00036dc0: 7220 7261 7070 6f72 7420 c3a0 2068 6f72  r rapport .. hor
-00036dd0: 697a 6f6e 7461 6c28 7365 6e73 2068 6f72  izontal(sens hor
-00036de0: 6169 7265 292c 413d 6465 6d69 2067 7264  aire),A=demi grd
-00036df0: 2061 7865 2c20 423d 6465 6d69 2070 6574   axe, B=demi pet
-00036e00: 6974 2061 7865 0a20 2020 2020 2020 2020  it axe.         
-00036e10: 2020 2078 732c 2079 732c 2078 692c 2079     xs, ys, xi, y
-00036e20: 692c 2078 652c 2079 6520 3d20 735b 305d  i, xe, ye = s[0]
-00036e30: 202d 2063 5b30 5d2c 2073 5b31 5d20 2d20   - c[0], s[1] - 
-00036e40: 635b 315d 2c20 695b 305d 202d 2063 5b30  c[1], i[0] - c[0
-00036e50: 5d2c 2069 5b0a 2020 2020 2020 2020 2020  ], i[.          
-00036e60: 2020 2020 2020 315d 202d 2063 5b31 5d2c        1] - c[1],
-00036e70: 2065 5b30 5d20 2d20 635b 305d 2c20 655b   e[0] - c[0], e[
-00036e80: 315d 202d 2063 5b31 5d0a 2020 2020 2020  1] - c[1].      
-00036e90: 2020 2020 2020 4120 3d20 6e70 792e 6172        A = npy.ar
-00036ea0: 7261 7928 285b 7873 202a 2a20 322c 2079  ray(([xs ** 2, y
-00036eb0: 7320 2a2a 2032 2c20 3220 2a20 7873 202a  s ** 2, 2 * xs *
-00036ec0: 2079 735d 2c0a 2020 2020 2020 2020 2020   ys],.          
-00036ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ee0: 205b 7869 202a 2a20 322c 2079 6920 2a2a   [xi ** 2, yi **
-00036ef0: 2032 2c20 3220 2a20 7869 202a 2079 695d   2, 2 * xi * yi]
-00036f00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00036f10: 2020 2020 2020 2020 2020 2020 205b 7865               [xe
-00036f20: 202a 2a20 322c 2079 6520 2a2a 2032 2c20   ** 2, ye ** 2, 
-00036f30: 3220 2a20 7865 202a 2079 655d 2929 0a20  2 * xe * ye])). 
-00036f40: 2020 2020 2020 2020 2020 2069 6e76 4120             invA 
-00036f50: 3d20 6e70 792e 6c69 6e61 6c67 2e69 6e76  = npy.linalg.inv
-00036f60: 2841 290a 2020 2020 2020 2020 2020 2020  (A).            
-00036f70: 6964 656e 7469 7479 203d 206e 7079 2e61  identity = npy.a
-00036f80: 7272 6179 2828 5b31 5d2c 205b 315d 2c20  rray(([1], [1], 
-00036f90: 5b31 5d29 290a 2020 2020 2020 2020 2020  [1])).          
-00036fa0: 2020 7231 2c20 7232 2c20 7233 203d 206e    r1, r2, r3 = n
-00036fb0: 7079 2e64 6f74 2869 6e76 412c 2069 6465  py.dot(invA, ide
-00036fc0: 6e74 6974 7929 2020 2320 3320 6974 656d  ntity)  # 3 item
-00036fd0: 2063 6f6c 756d 6e20 6d61 7472 6978 0a20   column matrix. 
-00036fe0: 2020 2020 2020 2020 2020 2074 6865 7461             theta
-00036ff0: 203d 2030 2e35 202a 206d 6174 682e 6174   = 0.5 * math.at
-00037000: 616e 2832 202a 2072 3320 2f20 2872 3220  an(2 * r3 / (r2 
-00037010: 2d20 7231 2929 0a20 2020 2020 2020 2020  - r1)).         
-00037020: 2020 2063 3120 3d20 7231 202b 2072 320a     c1 = r1 + r2.
-00037030: 2020 2020 2020 2020 2020 2020 6332 203d              c2 =
-00037040: 2028 7232 202d 2072 3129 202f 206d 6174   (r2 - r1) / mat
-00037050: 682e 636f 7328 3220 2a20 7468 6574 6129  h.cos(2 * theta)
-00037060: 0a20 2020 2020 2020 2020 2020 2067 6461  .            gda
-00037070: 7865 203d 206d 6174 682e 7371 7274 2828  xe = math.sqrt((
-00037080: 3220 2f20 2863 3120 2d20 6332 2929 290a  2 / (c1 - c2))).
-00037090: 2020 2020 2020 2020 2020 2020 7074 6178              ptax
-000370a0: 203d 206d 6174 682e 7371 7274 2828 3220   = math.sqrt((2 
-000370b0: 2f20 2863 3120 2b20 6332 2929 290a 2020  / (c1 + c2))).  
-000370c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000370d0: 2074 6865 7461 2c20 6764 6178 652c 2070   theta, gdaxe, p
-000370e0: 7461 780a 0a20 2020 2020 2020 2069 6620  tax..        if 
-000370f0: 7374 6172 7420 3d3d 2065 6e64 3a0a 2020  start == end:.  
-00037100: 2020 2020 2020 2020 2020 6578 7472 615f            extra_
-00037110: 6e65 7720 3d20 6672 616d 652e 676c 6f62  new = frame.glob
-00037120: 616c 5f74 6f5f 6c6f 6361 6c5f 636f 6f72  al_to_local_coor
-00037130: 6469 6e61 7465 7328 7365 6c66 2e69 6e74  dinates(self.int
-00037140: 6572 696f 7229 0a20 2020 2020 2020 2020  erior).         
-00037150: 2020 2074 6865 7461 2c20 412c 2042 203d     theta, A, B =
-00037160: 2074 6865 7461 5f41 5f42 2873 7461 7274   theta_A_B(start
-00037170: 5f6e 6577 2c20 6578 7472 615f 6e65 772c  _new, extra_new,
-00037180: 2069 6e74 6572 696f 725f 6e65 772c 0a20   interior_new,. 
-00037190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000371a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000371b0: 2020 2063 656e 7465 725f 6e65 7729 0a20     center_new). 
-000371c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000371d0: 2020 2020 2020 2020 2074 6865 7461 2c20           theta, 
-000371e0: 412c 2042 203d 2074 6865 7461 5f41 5f42  A, B = theta_A_B
-000371f0: 2873 7461 7274 5f6e 6577 2c20 696e 7465  (start_new, inte
-00037200: 7269 6f72 5f6e 6577 2c20 656e 645f 6e65  rior_new, end_ne
-00037210: 772c 0a20 2020 2020 2020 2020 2020 2020  w,.             
-00037220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037230: 2020 2020 2020 2063 656e 7465 725f 6e65         center_ne
-00037240: 7729 0a0a 2020 2020 2020 2020 7365 6c66  w)..        self
-00037250: 2e47 7261 6469 7573 203d 2041 0a20 2020  .Gradius = A.   
-00037260: 2020 2020 2073 656c 662e 5372 6164 6975       self.Sradiu
-00037270: 7320 3d20 420a 2020 2020 2020 2020 7365  s = B.        se
-00037280: 6c66 2e74 6865 7461 203d 2074 6865 7461  lf.theta = theta
-00037290: 0a0a 2020 2020 2020 2020 2320 416e 676c  ..        # Angl
-000372a0: 6520 706f 7572 2073 7461 7274 0a20 2020  e pour start.   
-000372b0: 2020 2020 2075 312c 2075 3220 3d20 7374       u1, u2 = st
-000372c0: 6172 745f 6e65 772e 7820 2f20 7365 6c66  art_new.x / self
-000372d0: 2e47 7261 6469 7573 2c20 7374 6172 745f  .Gradius, start_
-000372e0: 6e65 772e 7920 2f20 7365 6c66 2e53 7261  new.y / self.Sra
-000372f0: 6469 7573 0a20 2020 2020 2020 2061 6e67  dius.        ang
-00037300: 6c65 3120 3d20 766f 6c6d 646c 722e 6765  le1 = volmdlr.ge
-00037310: 6f6d 6574 7279 2e73 696e 5f63 6f73 5f61  ometry.sin_cos_a
-00037320: 6e67 6c65 2875 312c 2075 3229 0a20 2020  ngle(u1, u2).   
-00037330: 2020 2020 2073 656c 662e 616e 676c 655f       self.angle_
-00037340: 7374 6172 7420 3d20 616e 676c 6531 0a20  start = angle1. 
-00037350: 2020 2020 2020 2023 2041 6e67 6c65 2070         # Angle p
-00037360: 6f75 7220 656e 640a 2020 2020 2020 2020  our end.        
-00037370: 7533 2c20 7534 203d 2065 6e64 5f6e 6577  u3, u4 = end_new
-00037380: 2e78 202f 2073 656c 662e 4772 6164 6975  .x / self.Gradiu
-00037390: 732c 2065 6e64 5f6e 6577 2e79 202f 2073  s, end_new.y / s
-000373a0: 656c 662e 5372 6164 6975 730a 2020 2020  elf.Sradius.    
-000373b0: 2020 2020 616e 676c 6532 203d 2076 6f6c      angle2 = vol
-000373c0: 6d64 6c72 2e67 656f 6d65 7472 792e 7369  mdlr.geometry.si
-000373d0: 6e5f 636f 735f 616e 676c 6528 7533 2c20  n_cos_angle(u3, 
-000373e0: 7534 290a 2020 2020 2020 2020 7365 6c66  u4).        self
-000373f0: 2e61 6e67 6c65 5f65 6e64 203d 2061 6e67  .angle_end = ang
-00037400: 6c65 320a 2020 2020 2020 2020 2320 416e  le2.        # An
-00037410: 676c 6520 706f 7572 2069 6e74 6572 696f  gle pour interio
-00037420: 720a 2020 2020 2020 2020 7535 2c20 7536  r.        u5, u6
-00037430: 203d 2069 6e74 6572 696f 725f 6e65 772e   = interior_new.
-00037440: 7820 2f20 7365 6c66 2e47 7261 6469 7573  x / self.Gradius
-00037450: 2c20 696e 7465 7269 6f72 5f6e 6577 2e79  , interior_new.y
-00037460: 202f 2073 656c 662e 5372 6164 6975 730a   / self.Sradius.
-00037470: 2020 2020 2020 2020 616e 676c 6569 203d          anglei =
-00037480: 2076 6f6c 6d64 6c72 2e67 656f 6d65 7472   volmdlr.geometr
-00037490: 792e 7369 6e5f 636f 735f 616e 676c 6528  y.sin_cos_angle(
-000374a0: 7535 2c20 7536 290a 2020 2020 2020 2020  u5, u6).        
-000374b0: 7365 6c66 2e61 6e67 6c65 5f69 6e74 6572  self.angle_inter
-000374c0: 696f 7220 3d20 616e 676c 6569 0a20 2020  ior = anglei.   
-000374d0: 2020 2020 2023 2047 6f69 6e67 2074 7269       # Going tri
-000374e0: 676f 2f63 6c6f 636b 2077 6973 6520 6672  go/clock wise fr
-000374f0: 6f6d 2073 7461 7274 2074 6f20 696e 7465  om start to inte
-00037500: 7269 6f72 0a20 2020 2020 2020 2069 6620  rior.        if 
-00037510: 616e 676c 6569 203c 2061 6e67 6c65 313a  anglei < angle1:
-00037520: 0a20 2020 2020 2020 2020 2020 2074 7269  .            tri
-00037530: 676f 7769 7365 5f70 6174 6820 3d20 2861  gowise_path = (a
-00037540: 6e67 6c65 6920 2b20 766f 6c6d 646c 722e  nglei + volmdlr.
-00037550: 5457 4f5f 5049 2920 2d20 616e 676c 6531  TWO_PI) - angle1
-00037560: 0a20 2020 2020 2020 2020 2020 2063 6c6f  .            clo
-00037570: 636b 7769 7365 5f70 6174 6820 3d20 616e  ckwise_path = an
-00037580: 676c 6531 202d 2061 6e67 6c65 690a 2020  gle1 - anglei.  
-00037590: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000375a0: 2020 2020 2020 2020 7472 6967 6f77 6973          trigowis
-000375b0: 655f 7061 7468 203d 2061 6e67 6c65 6920  e_path = anglei 
-000375c0: 2d20 616e 676c 6531 0a20 2020 2020 2020  - angle1.       
-000375d0: 2020 2020 2063 6c6f 636b 7769 7365 5f70       clockwise_p
-000375e0: 6174 6820 3d20 616e 676c 6531 202d 2061  ath = angle1 - a
-000375f0: 6e67 6c65 6920 2b20 766f 6c6d 646c 722e  nglei + volmdlr.
-00037600: 5457 4f5f 5049 0a0a 2020 2020 2020 2020  TWO_PI..        
-00037610: 2320 476f 696e 6720 7472 6967 6f20 7769  # Going trigo wi
-00037620: 7365 2066 726f 6d20 696e 7465 7269 6f72  se from interior
-00037630: 2074 6f20 696e 7465 7269 6f72 0a20 2020   to interior.   
-00037640: 2020 2020 2069 6620 616e 676c 6532 203c       if angle2 <
-00037650: 2061 6e67 6c65 693a 0a20 2020 2020 2020   anglei:.       
-00037660: 2020 2020 2074 7269 676f 7769 7365 5f70       trigowise_p
-00037670: 6174 6820 2b3d 2028 616e 676c 6532 202b  ath += (angle2 +
-00037680: 2076 6f6c 6d64 6c72 2e54 574f 5f50 4929   volmdlr.TWO_PI)
-00037690: 202d 2061 6e67 6c65 690a 2020 2020 2020   - anglei.      
-000376a0: 2020 2020 2020 636c 6f63 6b77 6973 655f        clockwise_
-000376b0: 7061 7468 202b 3d20 616e 676c 6569 202d  path += anglei -
-000376c0: 2061 6e67 6c65 320a 2020 2020 2020 2020   angle2.        
-000376d0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000376e0: 2020 7472 6967 6f77 6973 655f 7061 7468    trigowise_path
-000376f0: 202b 3d20 616e 676c 6532 202d 2061 6e67   += angle2 - ang
-00037700: 6c65 690a 2020 2020 2020 2020 2020 2020  lei.            
-00037710: 636c 6f63 6b77 6973 655f 7061 7468 202b  clockwise_path +
-00037720: 3d20 616e 676c 6569 202d 2061 6e67 6c65  = anglei - angle
-00037730: 3220 2b20 766f 6c6d 646c 722e 5457 4f5f  2 + volmdlr.TWO_
-00037740: 5049 0a0a 2020 2020 2020 2020 6966 2063  PI..        if c
-00037750: 6c6f 636b 7769 7365 5f70 6174 6820 3e20  lockwise_path > 
-00037760: 7472 6967 6f77 6973 655f 7061 7468 3a0a  trigowise_path:.
-00037770: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00037780: 2e69 735f 7472 6967 6f20 3d20 5472 7565  .is_trigo = True
-00037790: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000377a0: 662e 616e 676c 6520 3d20 7472 6967 6f77  f.angle = trigow
-000377b0: 6973 655f 7061 7468 0a20 2020 2020 2020  ise_path.       
-000377c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000377d0: 2020 2023 2043 6c6f 636b 2077 6973 650a     # Clock wise.
-000377e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000377f0: 2e69 735f 7472 6967 6f20 3d20 4661 6c73  .is_trigo = Fals
-00037800: 650a 2020 2020 2020 2020 2020 2020 7365  e.            se
-00037810: 6c66 2e61 6e67 6c65 203d 2063 6c6f 636b  lf.angle = clock
-00037820: 7769 7365 5f70 6174 680a 0a20 2020 2020  wise_path..     
-00037830: 2020 2069 6620 7365 6c66 2e73 7461 7274     if self.start
-00037840: 203d 3d20 7365 6c66 2e65 6e64 3a0a 2020   == self.end:.  
-00037850: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00037860: 6e67 6c65 203d 2076 6f6c 6d64 6c72 2e54  ngle = volmdlr.T
-00037870: 574f 5f50 490a 0a20 2020 2020 2020 2069  WO_PI..        i
-00037880: 6620 7365 6c66 2e69 735f 7472 6967 6f3a  f self.is_trigo:
-00037890: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000378a0: 662e 6f66 6673 6574 5f61 6e67 6c65 203d  f.offset_angle =
-000378b0: 2061 6e67 6c65 310a 2020 2020 2020 2020   angle1.        
-000378c0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000378d0: 2020 7365 6c66 2e6f 6666 7365 745f 616e    self.offset_an
-000378e0: 676c 6520 3d20 616e 676c 6532 0a0a 2020  gle = angle2..  
-000378f0: 2020 2020 2020 766f 6c6d 646c 722e 636f        volmdlr.co
-00037900: 7265 2e43 6f6d 706f 7369 7465 5072 696d  re.CompositePrim
-00037910: 6974 6976 6533 442e 5f5f 696e 6974 5f5f  itive3D.__init__
-00037920: 2873 656c 662c 0a20 2020 2020 2020 2020  (self,.         
-00037930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037950: 2020 2020 2020 2020 2020 7072 696d 6974            primit
-00037960: 6976 6573 3d73 656c 662e 6469 7363 7265  ives=self.discre
-00037970: 7469 7a61 7469 6f6e 5f70 6f69 6e74 7328  tization_points(
-00037980: 6e75 6d62 6572 5f70 6f69 6e74 733d 3230  number_points=20
-00037990: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000379a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000379b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000379c0: 2020 2020 2020 6e61 6d65 3d6e 616d 6529        name=name)
-000379d0: 0a0a 2020 2020 6465 6620 6469 7363 7265  ..    def discre
-000379e0: 7469 7a61 7469 6f6e 5f70 6f69 6e74 7328  tization_points(
-000379f0: 7365 6c66 2c20 2a2c 206e 756d 6265 725f  self, *, number_
-00037a00: 706f 696e 7473 3a20 696e 7420 3d20 4e6f  points: int = No
-00037a10: 6e65 2c20 616e 676c 655f 7265 736f 6c75  ne, angle_resolu
-00037a20: 7469 6f6e 3a20 696e 7420 3d20 3230 293a  tion: int = 20):
-00037a30: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00037a40: 2020 2020 2044 6973 6372 6574 697a 6520       Discretize 
-00037a50: 6120 436f 6e74 6f75 7220 746f 2068 6176  a Contour to hav
-00037a60: 6520 226e 2220 706f 696e 7473 2e0a 0a20  e "n" points... 
-00037a70: 2020 2020 2020 203a 7061 7261 6d20 6e75         :param nu
-00037a80: 6d62 6572 5f70 6f69 6e74 733a 2074 6865  mber_points: the
-00037a90: 206e 756d 6265 7220 6f66 2070 6f69 6e74   number of point
-00037aa0: 7320 2869 6e63 6c75 6469 6e67 2073 7461  s (including sta
-00037ab0: 7274 2061 6e64 2065 6e64 2070 6f69 6e74  rt and end point
-00037ac0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-00037ad0: 6966 2075 6e73 6574 2c20 6f6e 6c79 2073  if unset, only s
-00037ae0: 7461 7274 2061 6e64 2065 6e64 2077 696c  tart and end wil
-00037af0: 6c20 6265 2072 6574 7572 6e65 640a 2020  l be returned.  
-00037b00: 2020 2020 2020 3a70 6172 616d 2061 6e67        :param ang
-00037b10: 6c65 5f72 6573 6f6c 7574 696f 6e3a 2069  le_resolution: i
-00037b20: 6620 7365 742c 2074 6865 2073 616d 706c  f set, the sampl
-00037b30: 696e 6720 7769 6c6c 2062 6520 6164 6170  ing will be adap
-00037b40: 7465 6420 746f 2068 6176 6520 6120 636f  ted to have a co
-00037b50: 6e74 726f 6c6c 6564 2061 6e67 756c 6172  ntrolled angular
-00037b60: 2064 6973 7461 6e63 652e 2055 7365 6675   distance. Usefu
-00037b70: 6c0a 2020 2020 2020 2020 2020 2020 746f  l.            to
-00037b80: 206d 6573 6820 616e 2061 7263 0a20 2020   mesh an arc.   
-00037b90: 2020 2020 203a 7265 7475 726e 3a20 6120       :return: a 
-00037ba0: 6c69 7374 206f 6620 7361 6d70 6c65 6420  list of sampled 
-00037bb0: 706f 696e 7473 0a20 2020 2020 2020 2022  points.        "
-00037bc0: 2222 0a20 2020 2020 2020 2069 6620 6e6f  "".        if no
-00037bd0: 7420 6e75 6d62 6572 5f70 6f69 6e74 733a  t number_points:
-00037be0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00037bf0: 6e6f 7420 616e 676c 655f 7265 736f 6c75  not angle_resolu
-00037c00: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-00037c10: 2020 2020 2020 6e75 6d62 6572 5f70 6f69        number_poi
-00037c20: 6e74 7320 3d20 320a 2020 2020 2020 2020  nts = 2.        
-00037c30: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00037c40: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-00037c50: 5f70 6f69 6e74 7320 3d20 6d61 7468 2e63  _points = math.c
-00037c60: 6569 6c28 616e 676c 655f 7265 736f 6c75  eil(angle_resolu
-00037c70: 7469 6f6e 202a 2061 6273 2830 2e35 202a  tion * abs(0.5 *
-00037c80: 2073 656c 662e 616e 676c 6520 2f20 6d61   self.angle / ma
-00037c90: 7468 2e70 6929 2920 2b20 310a 2020 2020  th.pi)) + 1.    
-00037ca0: 2020 2020 6966 2073 656c 662e 616e 676c      if self.angl
-00037cb0: 655f 7374 6172 7420 3e20 7365 6c66 2e61  e_start > self.a
-00037cc0: 6e67 6c65 5f65 6e64 3a0a 2020 2020 2020  ngle_end:.      
-00037cd0: 2020 2020 2020 6966 2073 656c 662e 616e        if self.an
-00037ce0: 676c 655f 7374 6172 7420 3e3d 2073 656c  gle_start >= sel
-00037cf0: 662e 616e 676c 655f 696e 7465 7269 6f72  f.angle_interior
-00037d00: 203e 3d20 7365 6c66 2e61 6e67 6c65 5f65   >= self.angle_e
-00037d10: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
-00037d20: 2020 2020 616e 676c 655f 7374 6172 7420      angle_start 
-00037d30: 3d20 7365 6c66 2e61 6e67 6c65 5f65 6e64  = self.angle_end
-00037d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037d50: 2061 6e67 6c65 5f65 6e64 203d 2073 656c   angle_end = sel
-00037d60: 662e 616e 676c 655f 7374 6172 740a 2020  f.angle_start.  
-00037d70: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00037d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037d90: 616e 676c 655f 656e 6420 3d20 7365 6c66  angle_end = self
-00037da0: 2e61 6e67 6c65 5f65 6e64 202b 2076 6f6c  .angle_end + vol
-00037db0: 6d64 6c72 2e54 574f 5f50 490a 2020 2020  mdlr.TWO_PI.    
-00037dc0: 2020 2020 2020 2020 2020 2020 616e 676c              angl
-00037dd0: 655f 7374 6172 7420 3d20 7365 6c66 2e61  e_start = self.a
-00037de0: 6e67 6c65 5f73 7461 7274 0a20 2020 2020  ngle_start.     
-00037df0: 2020 2065 6c69 6620 7365 6c66 2e61 6e67     elif self.ang
-00037e00: 6c65 5f73 7461 7274 203d 3d20 7365 6c66  le_start == self
-00037e10: 2e61 6e67 6c65 5f65 6e64 3a0a 2020 2020  .angle_end:.    
-00037e20: 2020 2020 2020 2020 616e 676c 655f 7374          angle_st
-00037e30: 6172 7420 3d20 300a 2020 2020 2020 2020  art = 0.        
-00037e40: 2020 2020 616e 676c 655f 656e 6420 3d20      angle_end = 
-00037e50: 3220 2a20 6d61 7468 2e70 690a 2020 2020  2 * math.pi.    
-00037e60: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00037e70: 2020 2020 2020 616e 676c 655f 656e 6420        angle_end 
-00037e80: 3d20 7365 6c66 2e61 6e67 6c65 5f65 6e64  = self.angle_end
-00037e90: 0a20 2020 2020 2020 2020 2020 2061 6e67  .            ang
-00037ea0: 6c65 5f73 7461 7274 203d 2073 656c 662e  le_start = self.
-00037eb0: 616e 676c 655f 7374 6172 740a 2020 2020  angle_start.    
-00037ec0: 2020 2020 6469 7363 7265 7469 7a61 7469      discretizati
-00037ed0: 6f6e 5f70 6f69 6e74 7320 3d20 5b73 656c  on_points = [sel
-00037ee0: 662e 6672 616d 652e 6c6f 6361 6c5f 746f  f.frame.local_to
-00037ef0: 5f67 6c6f 6261 6c5f 636f 6f72 6469 6e61  _global_coordina
-00037f00: 7465 7328 0a20 2020 2020 2020 2020 2020  tes(.           
-00037f10: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3344   volmdlr.Point3D
-00037f20: 2873 656c 662e 4772 6164 6975 7320 2a20  (self.Gradius * 
-00037f30: 6d61 7468 2e63 6f73 2861 6e67 6c65 292c  math.cos(angle),
-00037f40: 2073 656c 662e 5372 6164 6975 7320 2a20   self.Sradius * 
-00037f50: 6d61 7468 2e73 696e 2861 6e67 6c65 292c  math.sin(angle),
-00037f60: 2030 2929 0a20 2020 2020 2020 2020 2020   0)).           
-00037f70: 2066 6f72 2061 6e67 6c65 2069 6e20 6e70   for angle in np
-00037f80: 792e 6c69 6e73 7061 6365 2861 6e67 6c65  y.linspace(angle
-00037f90: 5f73 7461 7274 2c20 616e 676c 655f 656e  _start, angle_en
-00037fa0: 642c 206e 756d 6265 725f 706f 696e 7473  d, number_points
-00037fb0: 295d 0a20 2020 2020 2020 2072 6574 7572  )].        retur
-00037fc0: 6e20 6469 7363 7265 7469 7a61 7469 6f6e  n discretization
-00037fd0: 5f70 6f69 6e74 730a 0a20 2020 2064 6566  _points..    def
-00037fe0: 2070 6f6c 7967 6f6e 5f70 6f69 6e74 7328   polygon_points(
-00037ff0: 7365 6c66 2c20 6469 7363 7265 7469 7a61  self, discretiza
-00038000: 7469 6f6e 5f72 6573 6f6c 7574 696f 6e3a  tion_resolution:
-00038010: 2069 6e74 293a 0a20 2020 2020 2020 2077   int):.        w
-00038020: 6172 6e69 6e67 732e 7761 726e 2827 706f  arnings.warn('po
-00038030: 6c79 676f 6e5f 706f 696e 7473 2069 7320  lygon_points is 
-00038040: 6465 7072 6563 6174 6564 2c5c 0a20 2020  deprecated,\.   
-00038050: 2020 2020 2070 6c65 6173 6520 7573 6520       please use 
-00038060: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
-00038070: 6f69 6e74 7320 696e 7374 6561 6427 2c0a  oints instead',.
-00038080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038090: 2020 2020 2020 4465 7072 6563 6174 696f        Deprecatio
-000380a0: 6e57 6172 6e69 6e67 290a 2020 2020 2020  nWarning).      
-000380b0: 2020 7265 7475 726e 2073 656c 662e 6469    return self.di
-000380c0: 7363 7265 7469 7a61 7469 6f6e 5f70 6f69  scretization_poi
-000380d0: 6e74 7328 616e 676c 655f 7265 736f 6c75  nts(angle_resolu
-000380e0: 7469 6f6e 3d64 6973 6372 6574 697a 6174  tion=discretizat
-000380f0: 696f 6e5f 7265 736f 6c75 7469 6f6e 290a  ion_resolution).
-00038100: 0a20 2020 2064 6566 205f 6765 745f 706f  .    def _get_po
-00038110: 696e 7473 2873 656c 6629 3a0a 2020 2020  ints(self):.    
-00038120: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00038130: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
-00038140: 6f69 6e74 7328 6e75 6d62 6572 5f70 6f69  oints(number_poi
-00038150: 6e74 733d 3230 290a 2020 2020 706f 696e  nts=20).    poin
-00038160: 7473 203d 2070 726f 7065 7274 7928 5f67  ts = property(_g
-00038170: 6574 5f70 6f69 6e74 7329 0a0a 2020 2020  et_points)..    
-00038180: 6465 6620 746f 5f32 6428 7365 6c66 2c20  def to_2d(self, 
-00038190: 706c 616e 655f 6f72 6967 696e 2c20 782c  plane_origin, x,
-000381a0: 2079 293a 0a20 2020 2020 2020 2022 2222   y):.        """
-000381b0: 0a20 2020 2020 2020 2054 7261 6e73 666f  .        Transfo
-000381c0: 726d 7320 6120 4172 6345 6c6c 6970 7365  rms a ArcEllipse
-000381d0: 3344 2069 6e74 6f20 616e 2041 7263 456c  3D into an ArcEl
-000381e0: 6c69 7073 6532 442c 2067 6976 656e 2061  lipse2D, given a
-000381f0: 6e20 706c 616e 6520 6f72 6967 696e 2061  n plane origin a
-00038200: 6e64 2061 2075 2061 6e64 2076 2070 6c61  nd a u and v pla
-00038210: 6e65 2076 6563 746f 722e 0a0a 2020 2020  ne vector...    
-00038220: 2020 2020 3a70 6172 616d 2070 6c61 6e65      :param plane
-00038230: 5f6f 7269 6769 6e3a 2070 6c61 6e65 206f  _origin: plane o
-00038240: 7269 6769 6e2e 0a20 2020 2020 2020 203a  rigin..        :
-00038250: 7061 7261 6d20 783a 2070 6c61 6e65 2075  param x: plane u
-00038260: 2076 6563 746f 722e 0a20 2020 2020 2020   vector..       
-00038270: 203a 7061 7261 6d20 793a 2070 6c61 6e65   :param y: plane
-00038280: 2076 2076 6563 746f 722e 0a20 2020 2020   v vector..     
-00038290: 2020 203a 7265 7475 726e 3a20 4172 6345     :return: ArcE
-000382a0: 6c6c 6970 7365 3244 2e0a 2020 2020 2020  llipse2D..      
-000382b0: 2020 2222 220a 2020 2020 2020 2020 706f    """.        po
-000382c0: 696e 745f 7374 6172 7432 6420 3d20 7365  int_start2d = se
-000382d0: 6c66 2e73 7461 7274 2e74 6f5f 3264 2870  lf.start.to_2d(p
-000382e0: 6c61 6e65 5f6f 7269 6769 6e2c 2078 2c20  lane_origin, x, 
-000382f0: 7929 0a20 2020 2020 2020 2070 6f69 6e74  y).        point
-00038300: 5f69 6e74 6572 696f 7232 6420 3d20 7365  _interior2d = se
-00038310: 6c66 2e69 6e74 6572 696f 722e 746f 5f32  lf.interior.to_2
-00038320: 6428 706c 616e 655f 6f72 6967 696e 2c20  d(plane_origin, 
-00038330: 782c 2079 290a 2020 2020 2020 2020 706f  x, y).        po
-00038340: 696e 745f 656e 6432 6420 3d20 7365 6c66  int_end2d = self
-00038350: 2e65 6e64 2e74 6f5f 3264 2870 6c61 6e65  .end.to_2d(plane
-00038360: 5f6f 7269 6769 6e2c 2078 2c20 7929 0a20  _origin, x, y). 
-00038370: 2020 2020 2020 2063 656e 7465 7220 3d20         center = 
-00038380: 7365 6c66 2e63 656e 7465 722e 746f 5f32  self.center.to_2
-00038390: 6428 706c 616e 655f 6f72 6967 696e 2c20  d(plane_origin, 
-000383a0: 782c 2079 290a 2020 2020 2020 2020 706f  x, y).        po
-000383b0: 696e 745f 6d61 6a6f 725f 6469 7220 3d20  int_major_dir = 
-000383c0: 7365 6c66 2e63 656e 7465 7220 2b20 7365  self.center + se
-000383d0: 6c66 2e47 7261 6469 7573 202a 2073 656c  lf.Gradius * sel
-000383e0: 662e 6d61 6a6f 725f 6469 720a 2020 2020  f.major_dir.    
-000383f0: 2020 2020 706f 696e 745f 6d61 6a6f 725f      point_major_
-00038400: 6469 725f 3264 203d 2070 6f69 6e74 5f6d  dir_2d = point_m
-00038410: 616a 6f72 5f64 6972 2e74 6f5f 3264 2870  ajor_dir.to_2d(p
-00038420: 6c61 6e65 5f6f 7269 6769 6e2c 2078 2c20  lane_origin, x, 
-00038430: 7929 0a20 2020 2020 2020 2076 6563 746f  y).        vecto
-00038440: 725f 6d61 6a6f 725f 6469 725f 3264 203d  r_major_dir_2d =
-00038450: 2070 6f69 6e74 5f6d 616a 6f72 5f64 6972   point_major_dir
-00038460: 5f32 6420 2d20 6365 6e74 6572 0a20 2020  _2d - center.   
-00038470: 2020 2020 2076 6563 746f 725f 6d61 6a6f       vector_majo
-00038480: 725f 6469 725f 3264 2e6e 6f72 6d61 6c69  r_dir_2d.normali
-00038490: 7a65 2829 0a20 2020 2020 2020 2072 6574  ze().        ret
-000384a0: 7572 6e20 4172 6345 6c6c 6970 7365 3244  urn ArcEllipse2D
-000384b0: 2870 6f69 6e74 5f73 7461 7274 3264 2c20  (point_start2d, 
-000384c0: 706f 696e 745f 696e 7465 7269 6f72 3264  point_interior2d
-000384d0: 2c20 706f 696e 745f 656e 6432 642c 2063  , point_end2d, c
-000384e0: 656e 7465 722c 2076 6563 746f 725f 6d61  enter, vector_ma
-000384f0: 6a6f 725f 6469 725f 3264 2c20 6e61 6d65  jor_dir_2d, name
-00038500: 3d73 656c 662e 6e61 6d65 290a 0a20 2020  =self.name)..   
-00038510: 2064 6566 206c 656e 6774 6828 7365 6c66   def length(self
-00038520: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
-00038530: 6d70 7574 6573 2074 6865 206c 656e 6774  mputes the lengt
-00038540: 682e 2222 220a 2020 2020 2020 2020 7265  h.""".        re
-00038550: 7475 726e 2073 656c 662e 616e 676c 6520  turn self.angle 
-00038560: 2a20 6d61 7468 2e73 7172 7428 0a20 2020  * math.sqrt(.   
-00038570: 2020 2020 2020 2020 2028 7365 6c66 2e47           (self.G
-00038580: 7261 6469 7573 202a 2a20 3220 2b20 7365  radius ** 2 + se
-00038590: 6c66 2e53 7261 6469 7573 202a 2a20 3229  lf.Sradius ** 2)
-000385a0: 202f 2032 290a 0a20 2020 2064 6566 206e   / 2)..    def n
-000385b0: 6f72 6d61 6c5f 7665 6374 6f72 2873 656c  ormal_vector(sel
-000385c0: 662c 2061 6273 6369 7373 6129 3a0a 2020  f, abscissa):.  
-000385d0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-000385e0: 6d70 6c65 6d65 6e74 6564 4572 726f 720a  mplementedError.
-000385f0: 0a20 2020 2064 6566 2075 6e69 745f 6e6f  .    def unit_no
-00038600: 726d 616c 5f76 6563 746f 7228 7365 6c66  rmal_vector(self
-00038610: 2c20 6162 7363 6973 7361 293a 0a20 2020  , abscissa):.   
-00038620: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-00038630: 706c 656d 656e 7465 6445 7272 6f72 0a0a  plementedError..
-00038640: 2020 2020 6465 6620 6469 7265 6374 696f      def directio
-00038650: 6e5f 7665 6374 6f72 2873 656c 662c 2061  n_vector(self, a
-00038660: 6273 6369 7373 6129 3a0a 2020 2020 2020  bscissa):.      
-00038670: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-00038680: 6d65 6e74 6564 4572 726f 720a 0a20 2020  mentedError..   
-00038690: 2064 6566 2075 6e69 745f 6469 7265 6374   def unit_direct
-000386a0: 696f 6e5f 7665 6374 6f72 2873 656c 662c  ion_vector(self,
-000386b0: 2061 6273 6369 7373 6129 3a0a 2020 2020   abscissa):.    
-000386c0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-000386d0: 6c65 6d65 6e74 6564 4572 726f 720a 0a20  lementedError.. 
-000386e0: 2020 2064 6566 2072 6576 6572 7365 2873     def reverse(s
-000386f0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00038700: 7475 726e 2073 656c 662e 5f5f 636c 6173  turn self.__clas
-00038710: 735f 5f28 7365 6c66 2e65 6e64 2e63 6f70  s__(self.end.cop
-00038720: 7928 292c 0a20 2020 2020 2020 2020 2020  y(),.           
-00038730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038740: 2020 2073 656c 662e 696e 7465 7269 6f72     self.interior
-00038750: 2e63 6f70 7928 292c 0a20 2020 2020 2020  .copy(),.       
-00038760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038770: 2020 2020 2020 2073 656c 662e 7374 6172         self.star
-00038780: 742e 636f 7079 2829 2c0a 2020 2020 2020  t.copy(),.      
-00038790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000387a0: 2020 2020 2020 2020 7365 6c66 2e63 656e          self.cen
-000387b0: 7465 722e 636f 7079 2829 2c0a 2020 2020  ter.copy(),.    
-000387c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000387d0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-000387e0: 616a 6f72 5f64 6972 2e63 6f70 7928 292c  ajor_dir.copy(),
-000387f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038800: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00038810: 656c 662e 6e61 6d65 290a 0a20 2020 2064  elf.name)..    d
-00038820: 6566 2070 6c6f 7428 7365 6c66 2c20 6178  ef plot(self, ax
-00038830: 3d4e 6f6e 652c 2063 6f6c 6f72 3a20 7374  =None, color: st
-00038840: 7220 3d20 276b 272c 2061 6c70 6861 3d31  r = 'k', alpha=1
-00038850: 2e30 2c20 6564 6765 5f65 6e64 733d 4661  .0, edge_ends=Fa
-00038860: 6c73 652c 2065 6467 655f 6469 7265 6374  lse, edge_direct
-00038870: 696f 6e3d 4661 6c73 6529 3a0a 2020 2020  ion=False):.    
-00038880: 2020 2020 2222 2250 6c6f 7420 7468 6520      """Plot the 
-00038890: 6172 6320 656c 6c69 7073 652e 2222 220a  arc ellipse.""".
-000388a0: 2020 2020 2020 2020 6966 2061 7820 6973          if ax is
-000388b0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000388c0: 2020 2066 6967 203d 2070 6c74 2e66 6967     fig = plt.fig
-000388d0: 7572 6528 290a 2020 2020 2020 2020 2020  ure().          
-000388e0: 2020 6178 203d 2041 7865 7333 4428 6669    ax = Axes3D(fi
-000388f0: 6729 0a20 2020 2020 2020 2065 6c73 653a  g).        else:
-00038900: 0a20 2020 2020 2020 2020 2020 2066 6967  .            fig
-00038910: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
-00038920: 2061 782e 706c 6f74 285b 7365 6c66 2e69   ax.plot([self.i
-00038930: 6e74 6572 696f 725b 305d 5d2c 205b 7365  nterior[0]], [se
-00038940: 6c66 2e69 6e74 6572 696f 725b 315d 5d2c  lf.interior[1]],
-00038950: 205b 7365 6c66 2e69 6e74 6572 696f 725b   [self.interior[
-00038960: 325d 5d2c 0a20 2020 2020 2020 2020 2020  2]],.           
-00038970: 2020 2020 2063 6f6c 6f72 3d27 6227 290a       color='b').
-00038980: 2020 2020 2020 2020 6178 2e70 6c6f 7428          ax.plot(
-00038990: 5b73 656c 662e 7374 6172 745b 305d 5d2c  [self.start[0]],
-000389a0: 205b 7365 6c66 2e73 7461 7274 5b31 5d5d   [self.start[1]]
-000389b0: 2c20 5b73 656c 662e 7374 6172 745b 325d  , [self.start[2]
-000389c0: 5d2c 2063 3d27 7227 290a 2020 2020 2020  ], c='r').      
-000389d0: 2020 6178 2e70 6c6f 7428 5b73 656c 662e    ax.plot([self.
-000389e0: 656e 645b 305d 5d2c 205b 7365 6c66 2e65  end[0]], [self.e
-000389f0: 6e64 5b31 5d5d 2c20 5b73 656c 662e 656e  nd[1]], [self.en
-00038a00: 645b 325d 5d2c 2063 3d27 7227 290a 2020  d[2]], c='r').  
-00038a10: 2020 2020 2020 6178 2e70 6c6f 7428 5b73        ax.plot([s
-00038a20: 656c 662e 696e 7465 7269 6f72 5b30 5d5d  elf.interior[0]]
-00038a30: 2c20 5b73 656c 662e 696e 7465 7269 6f72  , [self.interior
-00038a40: 5b31 5d5d 2c20 5b73 656c 662e 696e 7465  [1]], [self.inte
-00038a50: 7269 6f72 5b32 5d5d 2c0a 2020 2020 2020  rior[2]],.      
-00038a60: 2020 2020 2020 2020 2020 633d 2767 2729            c='g')
-00038a70: 0a20 2020 2020 2020 2078 203d 205b 5d0a  .        x = [].
-00038a80: 2020 2020 2020 2020 7920 3d20 5b5d 0a20          y = []. 
-00038a90: 2020 2020 2020 207a 203d 205b 5d0a 2020         z = [].  
-00038aa0: 2020 2020 2020 666f 7220 7078 2c20 7079        for px, py
-00038ab0: 2c20 707a 2069 6e20 7365 6c66 2e64 6973  , pz in self.dis
-00038ac0: 6372 6574 697a 6174 696f 6e5f 706f 696e  cretization_poin
-00038ad0: 7473 286e 756d 6265 725f 706f 696e 7473  ts(number_points
-00038ae0: 3d32 3029 3a0a 2020 2020 2020 2020 2020  =20):.          
-00038af0: 2020 782e 6170 7065 6e64 2870 7829 0a20    x.append(px). 
-00038b00: 2020 2020 2020 2020 2020 2079 2e61 7070             y.app
-00038b10: 656e 6428 7079 290a 2020 2020 2020 2020  end(py).        
-00038b20: 2020 2020 7a2e 6170 7065 6e64 2870 7a29      z.append(pz)
-00038b30: 0a0a 2020 2020 2020 2020 6178 2e70 6c6f  ..        ax.plo
-00038b40: 7428 782c 2079 2c20 7a2c 2063 6f6c 6f72  t(x, y, z, color
-00038b50: 2c20 616c 7068 613d 616c 7068 6129 0a20  , alpha=alpha). 
-00038b60: 2020 2020 2020 2069 6620 6564 6765 5f65         if edge_e
-00038b70: 6e64 733a 0a20 2020 2020 2020 2020 2020  nds:.           
-00038b80: 2073 656c 662e 7374 6172 742e 706c 6f74   self.start.plot
-00038b90: 2861 7829 0a20 2020 2020 2020 2020 2020  (ax).           
-00038ba0: 2073 656c 662e 656e 642e 706c 6f74 2861   self.end.plot(a
-00038bb0: 7829 0a20 2020 2020 2020 2072 6574 7572  x).        retur
-00038bc0: 6e20 6178 0a0a 2020 2020 6465 6620 706c  n ax..    def pl
-00038bd0: 6f74 3264 2873 656c 662c 2078 3364 3a20  ot2d(self, x3d: 
-00038be0: 766f 6c6d 646c 722e 5665 6374 6f72 3344  volmdlr.Vector3D
-00038bf0: 203d 2076 6f6c 6d64 6c72 2e58 3344 2c20   = volmdlr.X3D, 
-00038c00: 7933 643a 2076 6f6c 6d64 6c72 2e56 6563  y3d: volmdlr.Vec
-00038c10: 746f 7233 4420 3d20 766f 6c6d 646c 722e  tor3D = volmdlr.
-00038c20: 5933 442c 0a20 2020 2020 2020 2020 2020  Y3D,.           
-00038c30: 2020 2020 6178 3d4e 6f6e 652c 2063 6f6c      ax=None, col
-00038c40: 6f72 3d27 6b27 293a 0a20 2020 2020 2020  or='k'):.       
-00038c50: 2069 6620 6178 2069 7320 4e6f 6e65 3a0a   if ax is None:.
-00038c60: 2020 2020 2020 2020 2020 2020 6669 6720              fig 
-00038c70: 3d20 706c 742e 6669 6775 7265 2829 0a20  = plt.figure(). 
-00038c80: 2020 2020 2020 2020 2020 2061 7820 3d20             ax = 
-00038c90: 6669 672e 6164 645f 7375 6270 6c6f 7428  fig.add_subplot(
-00038ca0: 3131 312c 2070 726f 6a65 6374 696f 6e3d  111, projection=
-00038cb0: 2733 6427 290a 2020 2020 2020 2020 656c  '3d').        el
-00038cc0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00038cd0: 6669 6720 3d20 6178 2e66 6967 7572 650a  fig = ax.figure.
-00038ce0: 0a20 2020 2020 2020 2023 2054 4f44 4f3a  .        # TODO:
-00038cf0: 2045 6e68 616e 6365 2074 6869 7320 706c   Enhance this pl
-00038d00: 6f74 0a20 2020 2020 2020 206c 656e 6774  ot.        lengt
-00038d10: 6820 3d20 7365 6c66 2e6c 656e 6774 6828  h = self.length(
-00038d20: 290a 2020 2020 2020 2020 7820 3d20 5b5d  ).        x = []
-00038d30: 0a20 2020 2020 2020 2079 203d 205b 5d0a  .        y = [].
-00038d40: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00038d50: 2072 616e 6765 2833 3029 3a0a 2020 2020   range(30):.    
-00038d60: 2020 2020 2020 2020 7020 3d20 7365 6c66          p = self
-00038d70: 2e70 6f69 6e74 5f61 745f 6162 7363 6973  .point_at_abscis
-00038d80: 7361 2869 202f 2028 3239 2e29 202a 206c  sa(i / (29.) * l
-00038d90: 656e 6774 6829 0a20 2020 2020 2020 2020  ength).         
-00038da0: 2020 2078 692c 2079 6920 3d20 702e 706c     xi, yi = p.pl
-00038db0: 616e 655f 7072 6f6a 6563 7469 6f6e 3264  ane_projection2d
-00038dc0: 2878 3364 2c20 7933 6429 0a20 2020 2020  (x3d, y3d).     
-00038dd0: 2020 2020 2020 2078 2e61 7070 656e 6428         x.append(
-00038de0: 7869 290a 2020 2020 2020 2020 2020 2020  xi).            
-00038df0: 792e 6170 7065 6e64 2879 6929 0a20 2020  y.append(yi).   
-00038e00: 2020 2020 2061 782e 706c 6f74 2878 2c20       ax.plot(x, 
-00038e10: 792c 2063 6f6c 6f72 3d63 6f6c 6f72 290a  y, color=color).
-00038e20: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-00038e30: 780a 0a20 2020 2064 6566 2074 7269 616e  x..    def trian
-00038e40: 6775 6c61 7469 6f6e 2873 656c 6629 3a0a  gulation(self):.
-00038e50: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-00038e60: 6f6e 650a 0a20 2020 2040 7072 6f70 6572  one..    @proper
-00038e70: 7479 0a20 2020 2064 6566 2062 6f75 6e64  ty.    def bound
-00038e80: 696e 675f 626f 7828 7365 6c66 293a 0a20  ing_box(self):. 
-00038e90: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00038ea0: 6c66 2e5f 6262 6f78 3a0a 2020 2020 2020  lf._bbox:.      
-00038eb0: 2020 2020 2020 7365 6c66 2e5f 6262 6f78        self._bbox
-00038ec0: 203d 2073 656c 662e 6765 745f 626f 756e   = self.get_boun
-00038ed0: 6469 6e67 5f62 6f78 2829 0a20 2020 2020  ding_box().     
-00038ee0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00038ef0: 6262 6f78 0a0a 2020 2020 4062 6f75 6e64  bbox..    @bound
-00038f00: 696e 675f 626f 782e 7365 7474 6572 0a20  ing_box.setter. 
-00038f10: 2020 2064 6566 2062 6f75 6e64 696e 675f     def bounding_
-00038f20: 626f 7828 7365 6c66 2c20 6e65 775f 626f  box(self, new_bo
-00038f30: 756e 6469 6e67 5f62 6f78 293a 0a20 2020  unding_box):.   
-00038f40: 2020 2020 2073 656c 662e 5f62 626f 7820       self._bbox 
-00038f50: 3d20 6e65 775f 626f 756e 6469 6e67 5f62  = new_bounding_b
-00038f60: 6f78 0a0a 2020 2020 6465 6620 6765 745f  ox..    def get_
-00038f70: 626f 756e 6469 6e67 5f62 6f78 2873 656c  bounding_box(sel
-00038f80: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-00038f90: 2020 2020 2020 2020 4361 6c63 756c 6174          Calculat
-00038fa0: 6573 2074 6865 2062 6f75 6e64 696e 6720  es the bounding 
-00038fb0: 626f 7820 6f66 2074 6865 2041 7263 3344  box of the Arc3D
-00038fc0: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
-00038fd0: 726e 3a20 6120 766f 6c6d 646c 722e 636f  rn: a volmdlr.co
-00038fe0: 7265 2e42 6f75 6e64 696e 6742 6f78 206f  re.BoundingBox o
-00038ff0: 626a 6563 742e 0a20 2020 2020 2020 2022  bject..        "
-00039000: 2222 0a20 2020 2020 2020 2023 2054 4f44  "".        # TOD
-00039010: 4f3a 2069 6d70 6c65 6d65 6e74 2065 7861  O: implement exa
-00039020: 6374 2063 616c 6375 6c61 7469 6f6e 0a0a  ct calculation..
-00039030: 2020 2020 2020 2020 706f 696e 7473 203d          points =
-00039040: 2073 656c 662e 6469 7363 7265 7469 7a61   self.discretiza
-00039050: 7469 6f6e 5f70 6f69 6e74 7328 616e 676c  tion_points(angl
-00039060: 655f 7265 736f 6c75 7469 6f6e 3d31 3029  e_resolution=10)
-00039070: 0a20 2020 2020 2020 2078 6d69 6e20 3d20  .        xmin = 
-00039080: 6d69 6e28 706f 696e 742e 7820 666f 7220  min(point.x for 
-00039090: 706f 696e 7420 696e 2070 6f69 6e74 7329  point in points)
-000390a0: 0a20 2020 2020 2020 2078 6d61 7820 3d20  .        xmax = 
-000390b0: 6d61 7828 706f 696e 742e 7820 666f 7220  max(point.x for 
-000390c0: 706f 696e 7420 696e 2070 6f69 6e74 7329  point in points)
-000390d0: 0a20 2020 2020 2020 2079 6d69 6e20 3d20  .        ymin = 
-000390e0: 6d69 6e28 706f 696e 742e 7920 666f 7220  min(point.y for 
-000390f0: 706f 696e 7420 696e 2070 6f69 6e74 7329  point in points)
-00039100: 0a20 2020 2020 2020 2079 6d61 7820 3d20  .        ymax = 
-00039110: 6d61 7828 706f 696e 742e 7920 666f 7220  max(point.y for 
-00039120: 706f 696e 7420 696e 2070 6f69 6e74 7329  point in points)
-00039130: 0a20 2020 2020 2020 207a 6d69 6e20 3d20  .        zmin = 
-00039140: 6d69 6e28 706f 696e 742e 7a20 666f 7220  min(point.z for 
-00039150: 706f 696e 7420 696e 2070 6f69 6e74 7329  point in points)
-00039160: 0a20 2020 2020 2020 207a 6d61 7820 3d20  .        zmax = 
-00039170: 6d61 7828 706f 696e 742e 7a20 666f 7220  max(point.z for 
-00039180: 706f 696e 7420 696e 2070 6f69 6e74 7329  point in points)
-00039190: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000391a0: 766f 6c6d 646c 722e 636f 7265 2e42 6f75  volmdlr.core.Bou
-000391b0: 6e64 696e 6742 6f78 2878 6d69 6e2c 2078  ndingBox(xmin, x
-000391c0: 6d61 782c 2079 6d69 6e2c 2079 6d61 782c  max, ymin, ymax,
-000391d0: 207a 6d69 6e2c 207a 6d61 7829 0a          zmin, zmax).
+000352f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035300: 2020 2020 2020 2020 7032 5f69 642c 2070          p2_id, p
+00035310: 335f 6964 2c0a 2020 2020 2020 2020 2320  3_id,.        # 
+00035320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035350: 2020 2020 2020 2020 2020 2020 6369 7263              circ
+00035360: 6c65 5f69 6429 0a0a 2020 2020 2020 2020  le_id)..        
+00035370: 2320 6172 6333 5f69 6420 3d20 6172 6332  # arc3_id = arc2
+00035380: 5f69 6420 2b20 310a 2020 2020 2020 2020  _id + 1.        
+00035390: 2320 636f 6e74 656e 7420 2b3d 2022 237b  # content += "#{
+000353a0: 7d20 3d20 4544 4745 5f43 5552 5645 2827  } = EDGE_CURVE('
+000353b0: 7b7d 272c 237b 7d2c 237b 7d2c 237b 7d2c  {}',#{},#{},#{},
+000353c0: 2e54 2e29 3b5c 6e22 2e66 6f72 6d61 7428  .T.);\n".format(
+000353d0: 6172 6333 5f69 642c 2073 656c 662e 6e61  arc3_id, self.na
+000353e0: 6d65 2c0a 2020 2020 2020 2020 2320 2020  me,.        #   
+000353f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035420: 2020 2020 2020 2020 2020 7033 5f69 642c            p3_id,
+00035430: 2070 345f 6964 2c0a 2020 2020 2020 2020   p4_id,.        
+00035440: 2320 2020 2020 2020 2020 2020 2020 2020  #               
+00035450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035470: 2020 2020 2020 2020 2020 2020 2020 6369                ci
+00035480: 7263 6c65 5f69 6429 0a0a 2020 2020 2020  rcle_id)..      
+00035490: 2020 2320 6172 6334 5f69 6420 3d20 6172    # arc4_id = ar
+000354a0: 6333 5f69 6420 2b20 310a 2020 2020 2020  c3_id + 1.      
+000354b0: 2020 2320 636f 6e74 656e 7420 2b3d 2022    # content += "
+000354c0: 237b 7d20 3d20 4544 4745 5f43 5552 5645  #{} = EDGE_CURVE
+000354d0: 2827 7b7d 272c 237b 7d2c 237b 7d2c 237b  ('{}',#{},#{},#{
+000354e0: 7d2c 2e54 2e29 3b5c 6e22 2e66 6f72 6d61  },.T.);\n".forma
+000354f0: 7428 6172 6334 5f69 642c 2073 656c 662e  t(arc4_id, self.
+00035500: 6e61 6d65 2c0a 2020 2020 2020 2020 2320  name,.        # 
+00035510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035540: 2020 2020 2020 2020 2020 2020 7034 5f69              p4_i
+00035550: 642c 2070 315f 6964 2c0a 2020 2020 2020  d, p1_id,.      
+00035560: 2020 2320 2020 2020 2020 2020 2020 2020    #             
+00035570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000355a0: 6369 7263 6c65 5f69 6429 0a0a 2020 2020  circle_id)..    
+000355b0: 2020 2020 6564 6765 5f63 7572 7665 203d      edge_curve =
+000355c0: 2070 315f 6964 202b 2031 0a20 2020 2020   p1_id + 1.     
+000355d0: 2020 2063 6f6e 7465 6e74 202b 3d20 6622     content += f"
+000355e0: 237b 6564 6765 5f63 7572 7665 7d20 3d20  #{edge_curve} = 
+000355f0: 4544 4745 5f43 5552 5645 2827 7b73 656c  EDGE_CURVE('{sel
+00035600: 662e 6e61 6d65 7d27 2c23 7b70 315f 6964  f.name}',#{p1_id
+00035610: 7d2c 237b 7031 5f69 647d 2c23 7b63 7572  },#{p1_id},#{cur
+00035620: 7665 5f69 647d 2c2e 542e 293b 5c6e 220a  ve_id},.T.);\n".
+00035630: 2020 2020 2020 2020 6375 7276 655f 6964          curve_id
+00035640: 202b 3d20 310a 0a20 2020 2020 2020 2023   += 1..        #
+00035650: 2072 6574 7572 6e20 636f 6e74 656e 742c   return content,
+00035660: 205b 6172 6331 5f69 642c 2061 7263 325f   [arc1_id, arc2_
+00035670: 6964 2c20 6172 6333 5f69 642c 2061 7263  id, arc3_id, arc
+00035680: 345f 6964 5d0a 2020 2020 2020 2020 7265  4_id].        re
+00035690: 7475 726e 2063 6f6e 7465 6e74 2c20 5b65  turn content, [e
+000356a0: 6467 655f 6375 7276 655d 0a0a 2020 2020  dge_curve]..    
+000356b0: 6465 6620 706c 6f74 2873 656c 662c 2061  def plot(self, a
+000356c0: 783d 4e6f 6e65 2c20 636f 6c6f 723d 276b  x=None, color='k
+000356d0: 272c 2061 6c70 6861 3d31 2e2c 2065 6467  ', alpha=1., edg
+000356e0: 655f 656e 6473 3d46 616c 7365 2c0a 2020  e_ends=False,.  
+000356f0: 2020 2020 2020 2020 2020 2065 6467 655f             edge_
+00035700: 6469 7265 6374 696f 6e3d 4661 6c73 6529  direction=False)
+00035710: 3a0a 2020 2020 2020 2020 6966 2061 7820  :.        if ax 
+00035720: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00035730: 2020 2020 2061 7820 3d20 4178 6573 3344       ax = Axes3D
+00035740: 2870 6c74 2e66 6967 7572 6528 2929 0a0a  (plt.figure())..
+00035750: 2020 2020 2020 2020 7820 3d20 5b5d 0a20          x = []. 
+00035760: 2020 2020 2020 2079 203d 205b 5d0a 2020         y = [].  
+00035770: 2020 2020 2020 7a20 3d20 5b5d 0a20 2020        z = [].   
+00035780: 2020 2020 2066 6f72 2070 782c 2070 792c       for px, py,
+00035790: 2070 7a20 696e 2073 656c 662e 6469 7363   pz in self.disc
+000357a0: 7265 7469 7a61 7469 6f6e 5f70 6f69 6e74  retization_point
+000357b0: 7328 6e75 6d62 6572 5f70 6f69 6e74 733d  s(number_points=
+000357c0: 3230 293a 0a20 2020 2020 2020 2020 2020  20):.           
+000357d0: 2078 2e61 7070 656e 6428 7078 290a 2020   x.append(px).  
+000357e0: 2020 2020 2020 2020 2020 792e 6170 7065            y.appe
+000357f0: 6e64 2870 7929 0a20 2020 2020 2020 2020  nd(py).         
+00035800: 2020 207a 2e61 7070 656e 6428 707a 290a     z.append(pz).
+00035810: 2020 2020 2020 2020 782e 6170 7065 6e64          x.append
+00035820: 2878 5b30 5d29 0a20 2020 2020 2020 2079  (x[0]).        y
+00035830: 2e61 7070 656e 6428 795b 305d 290a 2020  .append(y[0]).  
+00035840: 2020 2020 2020 7a2e 6170 7065 6e64 287a        z.append(z
+00035850: 5b30 5d29 0a20 2020 2020 2020 2061 782e  [0]).        ax.
+00035860: 706c 6f74 2878 2c20 792c 207a 2c20 636f  plot(x, y, z, co
+00035870: 6c6f 723d 636f 6c6f 722c 2061 6c70 6861  lor=color, alpha
+00035880: 3d61 6c70 6861 290a 0a20 2020 2020 2020  =alpha)..       
+00035890: 2069 6620 6564 6765 5f65 6e64 733a 0a20   if edge_ends:. 
+000358a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000358b0: 7374 6172 742e 706c 6f74 2861 783d 6178  start.plot(ax=ax
+000358c0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+000358d0: 6c66 2e65 6e64 2e70 6c6f 7428 6178 3d61  lf.end.plot(ax=a
+000358e0: 7829 0a0a 2020 2020 2020 2020 6966 2065  x)..        if e
+000358f0: 6467 655f 6469 7265 6374 696f 6e3a 0a20  dge_direction:. 
+00035900: 2020 2020 2020 2020 2020 2073 203d 2030             s = 0
+00035910: 2e35 202a 2073 656c 662e 6c65 6e67 7468  .5 * self.length
+00035920: 2829 0a20 2020 2020 2020 2020 2020 2078  ().            x
+00035930: 2c20 792c 207a 203d 2073 656c 662e 706f  , y, z = self.po
+00035940: 696e 745f 6174 5f61 6273 6369 7373 6128  int_at_abscissa(
+00035950: 7329 0a20 2020 2020 2020 2020 2020 2074  s).            t
+00035960: 616e 6765 6e74 203d 2073 656c 662e 756e  angent = self.un
+00035970: 6974 5f64 6972 6563 7469 6f6e 5f76 6563  it_direction_vec
+00035980: 746f 7228 7329 0a20 2020 2020 2020 2020  tor(s).         
+00035990: 2020 2061 7272 6f77 5f6c 656e 6774 6820     arrow_length 
+000359a0: 3d20 302e 3135 202a 2073 0a20 2020 2020  = 0.15 * s.     
+000359b0: 2020 2020 2020 2061 782e 7175 6976 6572         ax.quiver
+000359c0: 2878 2c20 792c 207a 2c20 2a61 7272 6f77  (x, y, z, *arrow
+000359d0: 5f6c 656e 6774 6820 2a20 7461 6e67 656e  _length * tangen
+000359e0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+000359f0: 2020 2020 2020 2020 2070 6976 6f74 3d27           pivot='
+00035a00: 7469 7027 290a 0a20 2020 2020 2020 2072  tip')..        r
+00035a10: 6574 7572 6e20 6178 0a0a 2020 2020 6465  eturn ax..    de
+00035a20: 6620 726f 7461 7469 6f6e 2873 656c 662c  f rotation(self,
+00035a30: 2063 656e 7465 723a 2076 6f6c 6d64 6c72   center: volmdlr
+00035a40: 2e50 6f69 6e74 3344 2c20 6178 6973 3a20  .Point3D, axis: 
+00035a50: 766f 6c6d 646c 722e 5665 6374 6f72 3344  volmdlr.Vector3D
+00035a60: 2c20 616e 676c 653a 2066 6c6f 6174 293a  , angle: float):
+00035a70: 0a20 2020 2020 2020 206e 6577 5f73 7461  .        new_sta
+00035a80: 7274 5f65 6e64 203d 2073 656c 662e 7374  rt_end = self.st
+00035a90: 6172 742e 726f 7461 7469 6f6e 2863 656e  art.rotation(cen
+00035aa0: 7465 722c 2061 7869 732c 2061 6e67 6c65  ter, axis, angle
+00035ab0: 290a 2020 2020 2020 2020 6e65 775f 6365  ).        new_ce
+00035ac0: 6e74 6572 203d 2073 656c 662e 5f63 656e  nter = self._cen
+00035ad0: 7465 722e 726f 7461 7469 6f6e 2863 656e  ter.rotation(cen
+00035ae0: 7465 722c 2061 7869 732c 2061 6e67 6c65  ter, axis, angle
+00035af0: 290a 2020 2020 2020 2020 6e65 775f 6e6f  ).        new_no
+00035b00: 726d 616c 203d 2073 656c 662e 5f6e 6f72  rmal = self._nor
+00035b10: 6d61 6c2e 726f 7461 7469 6f6e 2863 656e  mal.rotation(cen
+00035b20: 7465 722c 2061 7869 732c 2061 6e67 6c65  ter, axis, angle
+00035b30: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00035b40: 2046 756c 6c41 7263 3344 286e 6577 5f63   FullArc3D(new_c
+00035b50: 656e 7465 722c 206e 6577 5f73 7461 7274  enter, new_start
+00035b60: 5f65 6e64 2c0a 2020 2020 2020 2020 2020  _end,.          
+00035b70: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00035b80: 6577 5f6e 6f72 6d61 6c2c 206e 616d 653d  ew_normal, name=
+00035b90: 7365 6c66 2e6e 616d 6529 0a0a 2020 2020  self.name)..    
+00035ba0: 6465 6620 726f 7461 7469 6f6e 5f69 6e70  def rotation_inp
+00035bb0: 6c61 6365 2873 656c 662c 2063 656e 7465  lace(self, cente
+00035bc0: 723a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  r: volmdlr.Point
+00035bd0: 3344 2c20 6178 6973 3a20 766f 6c6d 646c  3D, axis: volmdl
+00035be0: 722e 5665 6374 6f72 3344 2c20 616e 676c  r.Vector3D, angl
+00035bf0: 653a 2066 6c6f 6174 293a 0a20 2020 2020  e: float):.     
+00035c00: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+00035c10: 2822 2769 6e70 6c61 6365 2720 6d65 7468  ("'inplace' meth
+00035c20: 6f64 7320 6172 6520 6465 7072 6563 6174  ods are deprecat
+00035c30: 6564 2e20 5573 6520 6120 6e6f 7420 696e  ed. Use a not in
+00035c40: 706c 6163 6520 6d65 7468 6f64 2069 6e73  place method ins
+00035c50: 7465 6164 2e22 2c20 4465 7072 6563 6174  tead.", Deprecat
+00035c60: 696f 6e57 6172 6e69 6e67 290a 0a20 2020  ionWarning)..   
+00035c70: 2020 2020 2073 656c 662e 7374 6172 742e       self.start.
+00035c80: 726f 7461 7469 6f6e 2863 656e 7465 722c  rotation(center,
+00035c90: 2061 7869 732c 2061 6e67 6c65 2c20 4661   axis, angle, Fa
+00035ca0: 6c73 6529 0a20 2020 2020 2020 2073 656c  lse).        sel
+00035cb0: 662e 656e 642e 726f 7461 7469 6f6e 2863  f.end.rotation(c
+00035cc0: 656e 7465 722c 2061 7869 732c 2061 6e67  enter, axis, ang
+00035cd0: 6c65 2c20 4661 6c73 6529 0a20 2020 2020  le, False).     
+00035ce0: 2020 2073 656c 662e 5f63 656e 7465 722e     self._center.
+00035cf0: 726f 7461 7469 6f6e 2863 656e 7465 722c  rotation(center,
+00035d00: 2061 7869 732c 2061 6e67 6c65 2c20 4661   axis, angle, Fa
+00035d10: 6c73 6529 0a20 2020 2020 2020 2073 656c  lse).        sel
+00035d20: 662e 696e 7465 7269 6f72 2e72 6f74 6174  f.interior.rotat
+00035d30: 696f 6e28 6365 6e74 6572 2c20 6178 6973  ion(center, axis
+00035d40: 2c20 616e 676c 652c 2046 616c 7365 290a  , angle, False).
+00035d50: 2020 2020 2020 2020 7365 6c66 2e5f 6262          self._bb
+00035d60: 6f78 203d 204e 6f6e 650a 0a20 2020 2064  ox = None..    d
+00035d70: 6566 2074 7261 6e73 6c61 7469 6f6e 2873  ef translation(s
+00035d80: 656c 662c 206f 6666 7365 743a 2076 6f6c  elf, offset: vol
+00035d90: 6d64 6c72 2e56 6563 746f 7233 4429 3a0a  mdlr.Vector3D):.
+00035da0: 2020 2020 2020 2020 6e65 775f 7374 6172          new_star
+00035db0: 745f 656e 6420 3d20 7365 6c66 2e73 7461  t_end = self.sta
+00035dc0: 7274 2e74 7261 6e73 6c61 7469 6f6e 286f  rt.translation(o
+00035dd0: 6666 7365 742c 2054 7275 6529 0a20 2020  ffset, True).   
+00035de0: 2020 2020 206e 6577 5f63 656e 7465 7220       new_center 
+00035df0: 3d20 7365 6c66 2e5f 6365 6e74 6572 2e74  = self._center.t
+00035e00: 7261 6e73 6c61 7469 6f6e 286f 6666 7365  ranslation(offse
+00035e10: 742c 2054 7275 6529 0a20 2020 2020 2020  t, True).       
+00035e20: 206e 6577 5f6e 6f72 6d61 6c20 3d20 7365   new_normal = se
+00035e30: 6c66 2e5f 6e6f 726d 616c 2e74 7261 6e73  lf._normal.trans
+00035e40: 6c61 7469 6f6e 286f 6666 7365 742c 2054  lation(offset, T
+00035e50: 7275 6529 0a20 2020 2020 2020 2072 6574  rue).        ret
+00035e60: 7572 6e20 4675 6c6c 4172 6333 4428 6e65  urn FullArc3D(ne
+00035e70: 775f 6365 6e74 6572 2c20 6e65 775f 7374  w_center, new_st
+00035e80: 6172 745f 656e 642c 0a20 2020 2020 2020  art_end,.       
+00035e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035ea0: 2020 6e65 775f 6e6f 726d 616c 2c20 6e61    new_normal, na
+00035eb0: 6d65 3d73 656c 662e 6e61 6d65 290a 0a20  me=self.name).. 
+00035ec0: 2020 2064 6566 2074 7261 6e73 6c61 7469     def translati
+00035ed0: 6f6e 5f69 6e70 6c61 6365 2873 656c 662c  on_inplace(self,
+00035ee0: 206f 6666 7365 743a 2076 6f6c 6d64 6c72   offset: volmdlr
+00035ef0: 2e56 6563 746f 7233 4429 3a0a 2020 2020  .Vector3D):.    
+00035f00: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00035f10: 6e28 2227 696e 706c 6163 6527 206d 6574  n("'inplace' met
+00035f20: 686f 6473 2061 7265 2064 6570 7265 6361  hods are depreca
+00035f30: 7465 642e 2055 7365 2061 206e 6f74 2069  ted. Use a not i
+00035f40: 6e70 6c61 6365 206d 6574 686f 6420 696e  nplace method in
+00035f50: 7374 6561 642e 222c 2044 6570 7265 6361  stead.", Depreca
+00035f60: 7469 6f6e 5761 726e 696e 6729 0a0a 2020  tionWarning)..  
+00035f70: 2020 2020 2020 7365 6c66 2e73 7461 7274        self.start
+00035f80: 2e74 7261 6e73 6c61 7469 6f6e 286f 6666  .translation(off
+00035f90: 7365 742c 2046 616c 7365 290a 2020 2020  set, False).    
+00035fa0: 2020 2020 7365 6c66 2e65 6e64 2e74 7261      self.end.tra
+00035fb0: 6e73 6c61 7469 6f6e 286f 6666 7365 742c  nslation(offset,
+00035fc0: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
+00035fd0: 7365 6c66 2e5f 6365 6e74 6572 2e74 7261  self._center.tra
+00035fe0: 6e73 6c61 7469 6f6e 286f 6666 7365 742c  nslation(offset,
+00035ff0: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
+00036000: 7365 6c66 2e69 6e74 6572 696f 722e 7472  self.interior.tr
+00036010: 616e 736c 6174 696f 6e28 6f66 6673 6574  anslation(offset
+00036020: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
+00036030: 2073 656c 662e 5f62 626f 7820 3d20 4e6f   self._bbox = No
+00036040: 6e65 0a0a 2020 2020 6465 6620 6c69 6e65  ne..    def line
+00036050: 7365 676d 656e 745f 696e 7465 7273 6563  segment_intersec
+00036060: 7469 6f6e 7328 7365 6c66 2c20 6c69 6e65  tions(self, line
+00036070: 7365 676d 656e 743a 204c 696e 6553 6567  segment: LineSeg
+00036080: 6d65 6e74 3344 293a 0a20 2020 2020 2020  ment3D):.       
+00036090: 2022 2222 0a20 2020 2020 2020 2043 616c   """.        Cal
+000360a0: 6375 6c61 7465 7320 7468 6520 696e 7465  culates the inte
+000360b0: 7273 6563 7469 6f6e 7320 6265 7477 6565  rsections betwee
+000360c0: 6e20 6120 6675 6c6c 6172 6333 6420 616e  n a fullarc3d an
+000360d0: 6420 6120 6c69 6e65 7365 676d 656e 7433  d a linesegment3
+000360e0: 642e 0a0a 2020 2020 2020 2020 3a70 6172  d...        :par
+000360f0: 616d 206c 696e 6573 6567 6d65 6e74 3a20  am linesegment: 
+00036100: 6c69 6e65 7365 676d 656e 7433 6420 746f  linesegment3d to
+00036110: 2076 6572 6966 7920 696e 7465 7273 6563   verify intersec
+00036120: 7469 6f6e 732e 0a20 2020 2020 2020 203a  tions..        :
+00036130: 7265 7475 726e 3a20 6c69 7374 206f 6620  return: list of 
+00036140: 706f 696e 7473 3364 2c20 6966 2074 6865  points3d, if the
+00036150: 7265 2061 7265 2061 6e79 2069 6e74 6572  re are any inter
+00036160: 7365 6374 696f 6e73 2c20 616e 2065 6d70  sections, an emp
+00036170: 7479 206c 6973 7420 6966 206f 7468 6572  ty list if other
+00036180: 7769 7365 2e0a 2020 2020 2020 2020 2222  wise..        ""
+00036190: 220a 2020 2020 2020 2020 6469 7374 616e  ".        distan
+000361a0: 6365 5f63 656e 7465 725f 6c69 6e65 7365  ce_center_linese
+000361b0: 6720 3d20 6c69 6e65 7365 676d 656e 742e  g = linesegment.
+000361c0: 706f 696e 745f 6469 7374 616e 6365 2873  point_distance(s
+000361d0: 656c 662e 6672 616d 652e 6f72 6967 696e  elf.frame.origin
+000361e0: 290a 2020 2020 2020 2020 6966 2064 6973  ).        if dis
+000361f0: 7461 6e63 655f 6365 6e74 6572 5f6c 696e  tance_center_lin
+00036200: 6573 6567 203e 2073 656c 662e 7261 6469  eseg > self.radi
+00036210: 7573 3a0a 2020 2020 2020 2020 2020 2020  us:.            
+00036220: 7265 7475 726e 205b 5d0a 2020 2020 2020  return [].      
+00036230: 2020 6469 7265 6374 696f 6e5f 7665 6374    direction_vect
+00036240: 6f72 203d 206c 696e 6573 6567 6d65 6e74  or = linesegment
+00036250: 2e64 6972 6563 7469 6f6e 5f76 6563 746f  .direction_vecto
+00036260: 7228 290a 2020 2020 2020 2020 6966 206d  r().        if m
+00036270: 6174 682e 6973 636c 6f73 6528 7365 6c66  ath.isclose(self
+00036280: 2e66 7261 6d65 2e77 2e64 6f74 2864 6972  .frame.w.dot(dir
+00036290: 6563 7469 6f6e 5f76 6563 746f 7229 2c20  ection_vector), 
+000362a0: 302c 2061 6273 5f74 6f6c 3d31 652d 3629  0, abs_tol=1e-6)
+000362b0: 2061 6e64 205c 0a20 2020 2020 2020 2020   and \.         
+000362c0: 2020 2020 2020 206e 6f74 206d 6174 682e         not math.
+000362d0: 6973 636c 6f73 6528 6c69 6e65 7365 676d  isclose(linesegm
+000362e0: 656e 742e 7374 6172 742e 7a20 2d20 7365  ent.start.z - se
+000362f0: 6c66 2e66 7261 6d65 2e6f 7269 6769 6e2e  lf.frame.origin.
+00036300: 7a2c 2030 2c20 6162 735f 746f 6c3d 3165  z, 0, abs_tol=1e
+00036310: 2d36 293a 0a20 2020 2020 2020 2020 2020  -6):.           
+00036320: 2072 6574 7572 6e20 5b5d 0a0a 2020 2020   return []..    
+00036330: 2020 2020 6966 206c 696e 6573 6567 6d65      if linesegme
+00036340: 6e74 2e73 7461 7274 2e7a 203d 3d20 6c69  nt.start.z == li
+00036350: 6e65 7365 676d 656e 742e 656e 642e 7a20  nesegment.end.z 
+00036360: 3d3d 2073 656c 662e 6672 616d 652e 6f72  == self.frame.or
+00036370: 6967 696e 2e7a 3a0a 2020 2020 2020 2020  igin.z:.        
+00036380: 2020 2020 7175 6164 7261 7469 635f 6571      quadratic_eq
+00036390: 7561 7469 6f6e 5f61 203d 2031 202b 2028  uation_a = 1 + (
+000363a0: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
+000363b0: 2e79 202a 2a20 3220 2f20 6469 7265 6374  .y ** 2 / direct
+000363c0: 696f 6e5f 7665 6374 6f72 2e78 202a 2a20  ion_vector.x ** 
+000363d0: 3229 0a20 2020 2020 2020 2020 2020 2071  2).            q
+000363e0: 7561 6472 6174 6963 5f65 7175 6174 696f  uadratic_equatio
+000363f0: 6e5f 6220 3d20 2d32 202a 2028 6469 7265  n_b = -2 * (dire
+00036400: 6374 696f 6e5f 7665 6374 6f72 2e79 202a  ction_vector.y *
+00036410: 2a20 3220 2f20 6469 7265 6374 696f 6e5f  * 2 / direction_
+00036420: 7665 6374 6f72 2e78 202a 2a20 3229 202a  vector.x ** 2) *
+00036430: 206c 696e 6573 6567 6d65 6e74 2e73 7461   linesegment.sta
+00036440: 7274 2e78 202b 205c 0a20 2020 2020 2020  rt.x + \.       
+00036450: 2020 2020 2020 2020 2032 202a 2028 6469           2 * (di
+00036460: 7265 6374 696f 6e5f 7665 6374 6f72 2e79  rection_vector.y
+00036470: 202f 2064 6972 6563 7469 6f6e 5f76 6563   / direction_vec
+00036480: 746f 722e 7829 202a 206c 696e 6573 6567  tor.x) * lineseg
+00036490: 6d65 6e74 2e73 7461 7274 2e79 0a20 2020  ment.start.y.   
+000364a0: 2020 2020 2020 2020 2071 7561 6472 6174           quadrat
+000364b0: 6963 5f65 7175 6174 696f 6e5f 6320 3d20  ic_equation_c = 
+000364c0: 286c 696e 6573 6567 6d65 6e74 2e73 7461  (linesegment.sta
+000364d0: 7274 2e79 202d 2028 6469 7265 6374 696f  rt.y - (directio
+000364e0: 6e5f 7665 6374 6f72 2e79 202f 2064 6972  n_vector.y / dir
+000364f0: 6563 7469 6f6e 5f76 6563 746f 722e 7829  ection_vector.x)
+00036500: 202a 0a20 2020 2020 2020 2020 2020 2020   *.             
+00036510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036520: 2020 2020 2020 206c 696e 6573 6567 6d65         linesegme
+00036530: 6e74 2e73 7461 7274 2e78 2920 2a2a 2032  nt.start.x) ** 2
+00036540: 202d 2073 656c 662e 7261 6469 7573 202a   - self.radius *
+00036550: 2a20 320a 2020 2020 2020 2020 2020 2020  * 2.            
+00036560: 6465 6c74 6120 3d20 7175 6164 7261 7469  delta = quadrati
+00036570: 635f 6571 7561 7469 6f6e 5f62 202a 2a20  c_equation_b ** 
+00036580: 3220 2d20 3420 2a20 7175 6164 7261 7469  2 - 4 * quadrati
+00036590: 635f 6571 7561 7469 6f6e 5f61 202a 2071  c_equation_a * q
+000365a0: 7561 6472 6174 6963 5f65 7175 6174 696f  uadratic_equatio
+000365b0: 6e5f 630a 2020 2020 2020 2020 2020 2020  n_c.            
+000365c0: 7831 203d 2028 2d20 7175 6164 7261 7469  x1 = (- quadrati
+000365d0: 635f 6571 7561 7469 6f6e 5f62 202b 206d  c_equation_b + m
+000365e0: 6174 682e 7371 7274 2864 656c 7461 2929  ath.sqrt(delta))
+000365f0: 202f 2028 3220 2a20 7175 6164 7261 7469   / (2 * quadrati
+00036600: 635f 6571 7561 7469 6f6e 5f61 290a 2020  c_equation_a).  
+00036610: 2020 2020 2020 2020 2020 7832 203d 2028            x2 = (
+00036620: 2d20 7175 6164 7261 7469 635f 6571 7561  - quadratic_equa
+00036630: 7469 6f6e 5f62 202d 206d 6174 682e 7371  tion_b - math.sq
+00036640: 7274 2864 656c 7461 2929 202f 2028 3220  rt(delta)) / (2 
+00036650: 2a20 7175 6164 7261 7469 635f 6571 7561  * quadratic_equa
+00036660: 7469 6f6e 5f61 290a 2020 2020 2020 2020  tion_a).        
+00036670: 2020 2020 7931 203d 2028 6469 7265 6374      y1 = (direct
+00036680: 696f 6e5f 7665 6374 6f72 2e79 202f 2064  ion_vector.y / d
+00036690: 6972 6563 7469 6f6e 5f76 6563 746f 722e  irection_vector.
+000366a0: 7829 202a 2028 7831 202d 206c 696e 6573  x) * (x1 - lines
+000366b0: 6567 6d65 6e74 2e73 7461 7274 2e78 2920  egment.start.x) 
+000366c0: 2b20 6c69 6e65 7365 676d 656e 742e 7374  + linesegment.st
+000366d0: 6172 742e 790a 2020 2020 2020 2020 2020  art.y.          
+000366e0: 2020 7932 203d 2028 6469 7265 6374 696f    y2 = (directio
+000366f0: 6e5f 7665 6374 6f72 2e79 202f 2064 6972  n_vector.y / dir
+00036700: 6563 7469 6f6e 5f76 6563 746f 722e 7829  ection_vector.x)
+00036710: 202a 2028 7832 202d 206c 696e 6573 6567   * (x2 - lineseg
+00036720: 6d65 6e74 2e73 7461 7274 2e78 2920 2b20  ment.start.x) + 
+00036730: 6c69 6e65 7365 676d 656e 742e 7374 6172  linesegment.star
+00036740: 742e 790a 2020 2020 2020 2020 2020 2020  t.y.            
+00036750: 7265 7475 726e 205b 766f 6c6d 646c 722e  return [volmdlr.
+00036760: 506f 696e 7433 4428 7831 2c20 7931 2c20  Point3D(x1, y1, 
+00036770: 7365 6c66 2e66 7261 6d65 2e6f 7269 6769  self.frame.origi
+00036780: 6e2e 7a29 2c20 766f 6c6d 646c 722e 506f  n.z), volmdlr.Po
+00036790: 696e 7433 4428 7832 2c20 7932 2c20 7365  int3D(x2, y2, se
+000367a0: 6c66 2e66 7261 6d65 2e6f 7269 6769 6e2e  lf.frame.origin.
+000367b0: 7a29 5d0a 2020 2020 2020 2020 6966 206d  z)].        if m
+000367c0: 6174 682e 6973 636c 6f73 6528 6469 7265  ath.isclose(dire
+000367d0: 6374 696f 6e5f 7665 6374 6f72 2e7a 2c20  ction_vector.z, 
+000367e0: 302c 2061 6273 5f74 6f6c 3d31 652d 3629  0, abs_tol=1e-6)
+000367f0: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
+00036800: 696e 7428 5472 7565 290a 2020 2020 2020  int(True).      
+00036810: 2020 636f 6e73 7461 6e74 203d 2028 7365    constant = (se
+00036820: 6c66 2e66 7261 6d65 2e6f 7269 6769 6e2e  lf.frame.origin.
+00036830: 7a20 2d20 6c69 6e65 7365 676d 656e 742e  z - linesegment.
+00036840: 7374 6172 742e 7a29 202f 2064 6972 6563  start.z) / direc
+00036850: 7469 6f6e 5f76 6563 746f 722e 7a0a 2020  tion_vector.z.  
+00036860: 2020 2020 2020 785f 636f 6f72 6469 6e61        x_coordina
+00036870: 7465 203d 2063 6f6e 7374 616e 7420 2a20  te = constant * 
+00036880: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
+00036890: 2e78 202b 206c 696e 6573 6567 6d65 6e74  .x + linesegment
+000368a0: 2e73 7461 7274 2e78 0a20 2020 2020 2020  .start.x.       
+000368b0: 2079 5f63 6f6f 7264 696e 6174 6520 3d20   y_coordinate = 
+000368c0: 636f 6e73 7461 6e74 202a 2064 6972 6563  constant * direc
+000368d0: 7469 6f6e 5f76 6563 746f 722e 7920 2b20  tion_vector.y + 
+000368e0: 6c69 6e65 7365 676d 656e 742e 7374 6172  linesegment.star
+000368f0: 742e 790a 2020 2020 2020 2020 6966 206d  t.y.        if m
+00036900: 6174 682e 6973 636c 6f73 6528 2878 5f63  ath.isclose((x_c
+00036910: 6f6f 7264 696e 6174 6520 2d20 7365 6c66  oordinate - self
+00036920: 2e66 7261 6d65 2e6f 7269 6769 6e2e 7829  .frame.origin.x)
+00036930: 202a 2a20 3220 2b20 2879 5f63 6f6f 7264   ** 2 + (y_coord
+00036940: 696e 6174 6520 2d20 7365 6c66 2e66 7261  inate - self.fra
+00036950: 6d65 2e6f 7269 6769 6e2e 7929 202a 2a20  me.origin.y) ** 
+00036960: 322c 0a20 2020 2020 2020 2020 2020 2020  2,.             
+00036970: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00036980: 7261 6469 7573 202a 2a20 322c 2061 6273  radius ** 2, abs
+00036990: 5f74 6f6c 3d31 652d 3629 3a0a 2020 2020  _tol=1e-6):.    
+000369a0: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+000369b0: 766f 6c6d 646c 722e 506f 696e 7433 4428  volmdlr.Point3D(
+000369c0: 785f 636f 6f72 6469 6e61 7465 2c20 795f  x_coordinate, y_
+000369d0: 636f 6f72 6469 6e61 7465 2c20 7365 6c66  coordinate, self
+000369e0: 2e66 7261 6d65 2e6f 7269 6769 6e2e 7a29  .frame.origin.z)
+000369f0: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
+00036a00: 205b 5d0a 0a20 2020 2064 6566 2072 6576   []..    def rev
+00036a10: 6572 7365 2873 656c 6629 3a0a 2020 2020  erse(self):.    
+00036a20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00036a30: 4465 6669 6e65 7320 6120 6e65 7720 4675  Defines a new Fu
+00036a40: 6c6c 4172 6333 442c 2069 6465 6e74 6963  llArc3D, identic
+00036a50: 616c 2074 6f20 7365 6c66 2c20 6275 7420  al to self, but 
+00036a60: 696e 2074 6865 206f 7070 6f73 6974 6520  in the opposite 
+00036a70: 6469 7265 6374 696f 6e2e 0a0a 2020 2020  direction...    
+00036a80: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00036a90: 7265 7475 726e 2073 656c 660a 0a0a 636c  return self...cl
+00036aa0: 6173 7320 4172 6345 6c6c 6970 7365 3344  ass ArcEllipse3D
+00036ab0: 2845 6467 6529 3a0a 2020 2020 2222 220a  (Edge):.    """.
+00036ac0: 2020 2020 416e 2061 7263 2069 7320 6465      An arc is de
+00036ad0: 6669 6e65 6420 6279 2061 2073 7461 7274  fined by a start
+00036ae0: 696e 6720 706f 696e 742c 2061 6e20 656e  ing point, an en
+00036af0: 6420 706f 696e 7420 616e 6420 616e 2069  d point and an i
+00036b00: 6e74 6572 696f 7220 706f 696e 742e 0a0a  nterior point...
+00036b10: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
+00036b20: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00036b30: 7374 6172 742c 2069 6e74 6572 696f 722c  start, interior,
+00036b40: 2065 6e64 2c20 6365 6e74 6572 2c20 6d61   end, center, ma
+00036b50: 6a6f 725f 6469 722c 0a20 2020 2020 2020  jor_dir,.       
+00036b60: 2020 2020 2020 2020 2020 6e61 6d65 3d27            name='
+00036b70: 2729 3a20 2023 202c 2065 7874 7261 3d4e  '):  # , extra=N
+00036b80: 6f6e 6529 3a0a 2020 2020 2020 2020 4564  one):.        Ed
+00036b90: 6765 2e5f 5f69 6e69 745f 5f28 7365 6c66  ge.__init__(self
+00036ba0: 2c20 7374 6172 743d 7374 6172 742c 2065  , start=start, e
+00036bb0: 6e64 3d65 6e64 2c20 6e61 6d65 3d6e 616d  nd=end, name=nam
+00036bc0: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
+00036bd0: 696e 7465 7269 6f72 203d 2069 6e74 6572  interior = inter
+00036be0: 696f 720a 2020 2020 2020 2020 7365 6c66  ior.        self
+00036bf0: 2e63 656e 7465 7220 3d20 6365 6e74 6572  .center = center
+00036c00: 0a20 2020 2020 2020 206d 616a 6f72 5f64  .        major_d
+00036c10: 6972 2e6e 6f72 6d61 6c69 7a65 2829 0a20  ir.normalize(). 
+00036c20: 2020 2020 2020 2073 656c 662e 6d61 6a6f         self.majo
+00036c30: 725f 6469 7220 3d20 6d61 6a6f 725f 6469  r_dir = major_di
+00036c40: 7220 2023 2056 6563 746f 7220 666f 7220  r  # Vector for 
+00036c50: 4772 6164 6975 730a 2020 2020 2020 2020  Gradius.        
+00036c60: 2320 7365 6c66 2e65 7874 7261 203d 2065  # self.extra = e
+00036c70: 7874 7261 0a0a 2020 2020 2020 2020 7531  xtra..        u1
+00036c80: 203d 2073 656c 662e 696e 7465 7269 6f72   = self.interior
+00036c90: 202d 2073 656c 662e 7374 6172 740a 2020   - self.start.  
+00036ca0: 2020 2020 2020 7532 203d 2073 656c 662e        u2 = self.
+00036cb0: 696e 7465 7269 6f72 202d 2073 656c 662e  interior - self.
+00036cc0: 656e 640a 2020 2020 2020 2020 7531 2e6e  end.        u1.n
+00036cd0: 6f72 6d61 6c69 7a65 2829 0a20 2020 2020  ormalize().     
+00036ce0: 2020 2075 322e 6e6f 726d 616c 697a 6528     u2.normalize(
+00036cf0: 290a 2020 2020 2020 2020 6966 2075 3120  ).        if u1 
+00036d00: 3d3d 2075 323a 0a20 2020 2020 2020 2020  == u2:.         
+00036d10: 2020 2075 3220 3d20 7365 6c66 2e69 6e74     u2 = self.int
+00036d20: 6572 696f 7220 2d20 7365 6c66 2e69 6e74  erior - self.int
+00036d30: 6572 696f 720a 2020 2020 2020 2020 2020  erior.          
+00036d40: 2020 7532 2e6e 6f72 6d61 6c69 7a65 2829    u2.normalize()
+00036d50: 0a0a 2020 2020 2020 2020 6e20 3d20 7532  ..        n = u2
+00036d60: 2e63 726f 7373 2875 3129 0a20 2020 2020  .cross(u1).     
+00036d70: 2020 206e 2e6e 6f72 6d61 6c69 7a65 2829     n.normalize()
+00036d80: 0a20 2020 2020 2020 2073 656c 662e 6e6f  .        self.no
+00036d90: 726d 616c 203d 206e 0a0a 2020 2020 2020  rmal = n..      
+00036da0: 2020 7365 6c66 2e6d 696e 6f72 5f64 6972    self.minor_dir
+00036db0: 203d 2073 656c 662e 6e6f 726d 616c 2e63   = self.normal.c
+00036dc0: 726f 7373 2873 656c 662e 6d61 6a6f 725f  ross(self.major_
+00036dd0: 6469 7229 0a0a 2020 2020 2020 2020 6672  dir)..        fr
+00036de0: 616d 6520 3d20 766f 6c6d 646c 722e 4672  ame = volmdlr.Fr
+00036df0: 616d 6533 4428 7365 6c66 2e63 656e 7465  ame3D(self.cente
+00036e00: 722c 2073 656c 662e 6d61 6a6f 725f 6469  r, self.major_di
+00036e10: 722c 2073 656c 662e 6d69 6e6f 725f 6469  r, self.minor_di
+00036e20: 722c 2073 656c 662e 6e6f 726d 616c 290a  r, self.normal).
+00036e30: 2020 2020 2020 2020 7365 6c66 2e66 7261          self.fra
+00036e40: 6d65 203d 2066 7261 6d65 0a20 2020 2020  me = frame.     
+00036e50: 2020 2073 7461 7274 5f6e 6577 2c20 656e     start_new, en
+00036e60: 645f 6e65 7720 3d20 6672 616d 652e 676c  d_new = frame.gl
+00036e70: 6f62 616c 5f74 6f5f 6c6f 6361 6c5f 636f  obal_to_local_co
+00036e80: 6f72 6469 6e61 7465 7328 0a20 2020 2020  ordinates(.     
+00036e90: 2020 2020 2020 2073 656c 662e 7374 6172         self.star
+00036ea0: 7429 2c20 6672 616d 652e 676c 6f62 616c  t), frame.global
+00036eb0: 5f74 6f5f 6c6f 6361 6c5f 636f 6f72 6469  _to_local_coordi
+00036ec0: 6e61 7465 7328 7365 6c66 2e65 6e64 290a  nates(self.end).
+00036ed0: 2020 2020 2020 2020 696e 7465 7269 6f72          interior
+00036ee0: 5f6e 6577 2c20 6365 6e74 6572 5f6e 6577  _new, center_new
+00036ef0: 203d 2066 7261 6d65 2e67 6c6f 6261 6c5f   = frame.global_
+00036f00: 746f 5f6c 6f63 616c 5f63 6f6f 7264 696e  to_local_coordin
+00036f10: 6174 6573 280a 2020 2020 2020 2020 2020  ates(.          
+00036f20: 2020 7365 6c66 2e69 6e74 6572 696f 7229    self.interior)
+00036f30: 2c20 6672 616d 652e 676c 6f62 616c 5f74  , frame.global_t
+00036f40: 6f5f 6c6f 6361 6c5f 636f 6f72 6469 6e61  o_local_coordina
+00036f50: 7465 7328 7365 6c66 2e63 656e 7465 7229  tes(self.center)
+00036f60: 0a20 2020 2020 2020 2073 656c 662e 5f62  .        self._b
+00036f70: 626f 7820 3d20 4e6f 6e65 0a20 2020 2020  box = None.     
+00036f80: 2020 2023 2066 726f 6d20 3a0a 2020 2020     # from :.    
+00036f90: 2020 2020 2320 6874 7470 733a 2f2f 6d61      # https://ma
+00036fa0: 7468 2e73 7461 636b 6578 6368 616e 6765  th.stackexchange
+00036fb0: 2e63 6f6d 2f71 7565 7374 696f 6e73 2f33  .com/questions/3
+00036fc0: 3339 3132 362f 686f 772d 746f 2d64 7261  39126/how-to-dra
+00036fd0: 772d 616e 2d65 6c6c 6970 7365 2d69 662d  w-an-ellipse-if-
+00036fe0: 612d 6365 6e74 6572 2d61 6e64 2d33 2d61  a-center-and-3-a
+00036ff0: 7262 6974 7261 7279 2d70 6f69 6e74 732d  rbitrary-points-
+00037000: 6f6e 2d69 742d 6172 652d 6769 7665 6e0a  on-it-are-given.
+00037010: 0a20 2020 2020 2020 2064 6566 2074 6865  .        def the
+00037020: 7461 5f41 5f42 2873 2c20 692c 2065 2c20  ta_A_B(s, i, e, 
+00037030: 6329 3a0a 2020 2020 2020 2020 2020 2020  c):.            
+00037040: 2320 7468 6574 613d 616e 676c 6520 6427  # theta=angle d'
+00037050: 696e 636c 696e 6169 736f 6e20 656c 6c69  inclinaison elli
+00037060: 7073 6520 7061 7220 7261 7070 6f72 7420  pse par rapport 
+00037070: c3a0 2068 6f72 697a 6f6e 7461 6c28 7365  .. horizontal(se
+00037080: 6e73 2068 6f72 6169 7265 292c 413d 6465  ns horaire),A=de
+00037090: 6d69 2067 7264 2061 7865 2c20 423d 6465  mi grd axe, B=de
+000370a0: 6d69 2070 6574 6974 2061 7865 0a20 2020  mi petit axe.   
+000370b0: 2020 2020 2020 2020 2078 732c 2079 732c           xs, ys,
+000370c0: 2078 692c 2079 692c 2078 652c 2079 6520   xi, yi, xe, ye 
+000370d0: 3d20 735b 305d 202d 2063 5b30 5d2c 2073  = s[0] - c[0], s
+000370e0: 5b31 5d20 2d20 635b 315d 2c20 695b 305d  [1] - c[1], i[0]
+000370f0: 202d 2063 5b30 5d2c 2069 5b0a 2020 2020   - c[0], i[.    
+00037100: 2020 2020 2020 2020 2020 2020 315d 202d              1] -
+00037110: 2063 5b31 5d2c 2065 5b30 5d20 2d20 635b   c[1], e[0] - c[
+00037120: 305d 2c20 655b 315d 202d 2063 5b31 5d0a  0], e[1] - c[1].
+00037130: 2020 2020 2020 2020 2020 2020 4120 3d20              A = 
+00037140: 6e70 792e 6172 7261 7928 285b 7873 202a  npy.array(([xs *
+00037150: 2a20 322c 2079 7320 2a2a 2032 2c20 3220  * 2, ys ** 2, 2 
+00037160: 2a20 7873 202a 2079 735d 2c0a 2020 2020  * xs * ys],.    
+00037170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037180: 2020 2020 2020 205b 7869 202a 2a20 322c         [xi ** 2,
+00037190: 2079 6920 2a2a 2032 2c20 3220 2a20 7869   yi ** 2, 2 * xi
+000371a0: 202a 2079 695d 2c0a 2020 2020 2020 2020   * yi],.        
+000371b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000371c0: 2020 205b 7865 202a 2a20 322c 2079 6520     [xe ** 2, ye 
+000371d0: 2a2a 2032 2c20 3220 2a20 7865 202a 2079  ** 2, 2 * xe * y
+000371e0: 655d 2929 0a20 2020 2020 2020 2020 2020  e])).           
+000371f0: 2069 6e76 4120 3d20 6e70 792e 6c69 6e61   invA = npy.lina
+00037200: 6c67 2e69 6e76 2841 290a 2020 2020 2020  lg.inv(A).      
+00037210: 2020 2020 2020 6964 656e 7469 7479 203d        identity =
+00037220: 206e 7079 2e61 7272 6179 2828 5b31 5d2c   npy.array(([1],
+00037230: 205b 315d 2c20 5b31 5d29 290a 2020 2020   [1], [1])).    
+00037240: 2020 2020 2020 2020 7231 2c20 7232 2c20          r1, r2, 
+00037250: 7233 203d 206e 7079 2e64 6f74 2869 6e76  r3 = npy.dot(inv
+00037260: 412c 2069 6465 6e74 6974 7929 2020 2320  A, identity)  # 
+00037270: 3320 6974 656d 2063 6f6c 756d 6e20 6d61  3 item column ma
+00037280: 7472 6978 0a20 2020 2020 2020 2020 2020  trix.           
+00037290: 2074 6865 7461 203d 2030 2e35 202a 206d   theta = 0.5 * m
+000372a0: 6174 682e 6174 616e 2832 202a 2072 3320  ath.atan(2 * r3 
+000372b0: 2f20 2872 3220 2d20 7231 2929 0a20 2020  / (r2 - r1)).   
+000372c0: 2020 2020 2020 2020 2063 3120 3d20 7231           c1 = r1
+000372d0: 202b 2072 320a 2020 2020 2020 2020 2020   + r2.          
+000372e0: 2020 6332 203d 2028 7232 202d 2072 3129    c2 = (r2 - r1)
+000372f0: 202f 206d 6174 682e 636f 7328 3220 2a20   / math.cos(2 * 
+00037300: 7468 6574 6129 0a20 2020 2020 2020 2020  theta).         
+00037310: 2020 2067 6461 7865 203d 206d 6174 682e     gdaxe = math.
+00037320: 7371 7274 2828 3220 2f20 2863 3120 2d20  sqrt((2 / (c1 - 
+00037330: 6332 2929 290a 2020 2020 2020 2020 2020  c2))).          
+00037340: 2020 7074 6178 203d 206d 6174 682e 7371    ptax = math.sq
+00037350: 7274 2828 3220 2f20 2863 3120 2b20 6332  rt((2 / (c1 + c2
+00037360: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+00037370: 7265 7475 726e 2074 6865 7461 2c20 6764  return theta, gd
+00037380: 6178 652c 2070 7461 780a 0a20 2020 2020  axe, ptax..     
+00037390: 2020 2069 6620 7374 6172 7420 3d3d 2065     if start == e
+000373a0: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
+000373b0: 6578 7472 615f 6e65 7720 3d20 6672 616d  extra_new = fram
+000373c0: 652e 676c 6f62 616c 5f74 6f5f 6c6f 6361  e.global_to_loca
+000373d0: 6c5f 636f 6f72 6469 6e61 7465 7328 7365  l_coordinates(se
+000373e0: 6c66 2e69 6e74 6572 696f 7229 0a20 2020  lf.interior).   
+000373f0: 2020 2020 2020 2020 2074 6865 7461 2c20           theta, 
+00037400: 412c 2042 203d 2074 6865 7461 5f41 5f42  A, B = theta_A_B
+00037410: 2873 7461 7274 5f6e 6577 2c20 6578 7472  (start_new, extr
+00037420: 615f 6e65 772c 2069 6e74 6572 696f 725f  a_new, interior_
+00037430: 6e65 772c 0a20 2020 2020 2020 2020 2020  new,.           
+00037440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037450: 2020 2020 2020 2020 2063 656e 7465 725f           center_
+00037460: 6e65 7729 0a20 2020 2020 2020 2065 6c73  new).        els
+00037470: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
+00037480: 6865 7461 2c20 412c 2042 203d 2074 6865  heta, A, B = the
+00037490: 7461 5f41 5f42 2873 7461 7274 5f6e 6577  ta_A_B(start_new
+000374a0: 2c20 696e 7465 7269 6f72 5f6e 6577 2c20  , interior_new, 
+000374b0: 656e 645f 6e65 772c 0a20 2020 2020 2020  end_new,.       
+000374c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000374d0: 2020 2020 2020 2020 2020 2020 2063 656e               cen
+000374e0: 7465 725f 6e65 7729 0a0a 2020 2020 2020  ter_new)..      
+000374f0: 2020 7365 6c66 2e47 7261 6469 7573 203d    self.Gradius =
+00037500: 2041 0a20 2020 2020 2020 2073 656c 662e   A.        self.
+00037510: 5372 6164 6975 7320 3d20 420a 2020 2020  Sradius = B.    
+00037520: 2020 2020 7365 6c66 2e74 6865 7461 203d      self.theta =
+00037530: 2074 6865 7461 0a0a 2020 2020 2020 2020   theta..        
+00037540: 2320 416e 676c 6520 706f 7572 2073 7461  # Angle pour sta
+00037550: 7274 0a20 2020 2020 2020 2075 312c 2075  rt.        u1, u
+00037560: 3220 3d20 7374 6172 745f 6e65 772e 7820  2 = start_new.x 
+00037570: 2f20 7365 6c66 2e47 7261 6469 7573 2c20  / self.Gradius, 
+00037580: 7374 6172 745f 6e65 772e 7920 2f20 7365  start_new.y / se
+00037590: 6c66 2e53 7261 6469 7573 0a20 2020 2020  lf.Sradius.     
+000375a0: 2020 2061 6e67 6c65 3120 3d20 766f 6c6d     angle1 = volm
+000375b0: 646c 722e 6765 6f6d 6574 7279 2e73 696e  dlr.geometry.sin
+000375c0: 5f63 6f73 5f61 6e67 6c65 2875 312c 2075  _cos_angle(u1, u
+000375d0: 3229 0a20 2020 2020 2020 2073 656c 662e  2).        self.
+000375e0: 616e 676c 655f 7374 6172 7420 3d20 616e  angle_start = an
+000375f0: 676c 6531 0a20 2020 2020 2020 2023 2041  gle1.        # A
+00037600: 6e67 6c65 2070 6f75 7220 656e 640a 2020  ngle pour end.  
+00037610: 2020 2020 2020 7533 2c20 7534 203d 2065        u3, u4 = e
+00037620: 6e64 5f6e 6577 2e78 202f 2073 656c 662e  nd_new.x / self.
+00037630: 4772 6164 6975 732c 2065 6e64 5f6e 6577  Gradius, end_new
+00037640: 2e79 202f 2073 656c 662e 5372 6164 6975  .y / self.Sradiu
+00037650: 730a 2020 2020 2020 2020 616e 676c 6532  s.        angle2
+00037660: 203d 2076 6f6c 6d64 6c72 2e67 656f 6d65   = volmdlr.geome
+00037670: 7472 792e 7369 6e5f 636f 735f 616e 676c  try.sin_cos_angl
+00037680: 6528 7533 2c20 7534 290a 2020 2020 2020  e(u3, u4).      
+00037690: 2020 7365 6c66 2e61 6e67 6c65 5f65 6e64    self.angle_end
+000376a0: 203d 2061 6e67 6c65 320a 2020 2020 2020   = angle2.      
+000376b0: 2020 2320 416e 676c 6520 706f 7572 2069    # Angle pour i
+000376c0: 6e74 6572 696f 720a 2020 2020 2020 2020  nterior.        
+000376d0: 7535 2c20 7536 203d 2069 6e74 6572 696f  u5, u6 = interio
+000376e0: 725f 6e65 772e 7820 2f20 7365 6c66 2e47  r_new.x / self.G
+000376f0: 7261 6469 7573 2c20 696e 7465 7269 6f72  radius, interior
+00037700: 5f6e 6577 2e79 202f 2073 656c 662e 5372  _new.y / self.Sr
+00037710: 6164 6975 730a 2020 2020 2020 2020 616e  adius.        an
+00037720: 676c 6569 203d 2076 6f6c 6d64 6c72 2e67  glei = volmdlr.g
+00037730: 656f 6d65 7472 792e 7369 6e5f 636f 735f  eometry.sin_cos_
+00037740: 616e 676c 6528 7535 2c20 7536 290a 2020  angle(u5, u6).  
+00037750: 2020 2020 2020 7365 6c66 2e61 6e67 6c65        self.angle
+00037760: 5f69 6e74 6572 696f 7220 3d20 616e 676c  _interior = angl
+00037770: 6569 0a20 2020 2020 2020 2023 2047 6f69  ei.        # Goi
+00037780: 6e67 2074 7269 676f 2f63 6c6f 636b 2077  ng trigo/clock w
+00037790: 6973 6520 6672 6f6d 2073 7461 7274 2074  ise from start t
+000377a0: 6f20 696e 7465 7269 6f72 0a20 2020 2020  o interior.     
+000377b0: 2020 2069 6620 616e 676c 6569 203c 2061     if anglei < a
+000377c0: 6e67 6c65 313a 0a20 2020 2020 2020 2020  ngle1:.         
+000377d0: 2020 2074 7269 676f 7769 7365 5f70 6174     trigowise_pat
+000377e0: 6820 3d20 2861 6e67 6c65 6920 2b20 766f  h = (anglei + vo
+000377f0: 6c6d 646c 722e 5457 4f5f 5049 2920 2d20  lmdlr.TWO_PI) - 
+00037800: 616e 676c 6531 0a20 2020 2020 2020 2020  angle1.         
+00037810: 2020 2063 6c6f 636b 7769 7365 5f70 6174     clockwise_pat
+00037820: 6820 3d20 616e 676c 6531 202d 2061 6e67  h = angle1 - ang
+00037830: 6c65 690a 2020 2020 2020 2020 656c 7365  lei.        else
+00037840: 3a0a 2020 2020 2020 2020 2020 2020 7472  :.            tr
+00037850: 6967 6f77 6973 655f 7061 7468 203d 2061  igowise_path = a
+00037860: 6e67 6c65 6920 2d20 616e 676c 6531 0a20  nglei - angle1. 
+00037870: 2020 2020 2020 2020 2020 2063 6c6f 636b             clock
+00037880: 7769 7365 5f70 6174 6820 3d20 616e 676c  wise_path = angl
+00037890: 6531 202d 2061 6e67 6c65 6920 2b20 766f  e1 - anglei + vo
+000378a0: 6c6d 646c 722e 5457 4f5f 5049 0a0a 2020  lmdlr.TWO_PI..  
+000378b0: 2020 2020 2020 2320 476f 696e 6720 7472        # Going tr
+000378c0: 6967 6f20 7769 7365 2066 726f 6d20 696e  igo wise from in
+000378d0: 7465 7269 6f72 2074 6f20 696e 7465 7269  terior to interi
+000378e0: 6f72 0a20 2020 2020 2020 2069 6620 616e  or.        if an
+000378f0: 676c 6532 203c 2061 6e67 6c65 693a 0a20  gle2 < anglei:. 
+00037900: 2020 2020 2020 2020 2020 2074 7269 676f             trigo
+00037910: 7769 7365 5f70 6174 6820 2b3d 2028 616e  wise_path += (an
+00037920: 676c 6532 202b 2076 6f6c 6d64 6c72 2e54  gle2 + volmdlr.T
+00037930: 574f 5f50 4929 202d 2061 6e67 6c65 690a  WO_PI) - anglei.
+00037940: 2020 2020 2020 2020 2020 2020 636c 6f63              cloc
+00037950: 6b77 6973 655f 7061 7468 202b 3d20 616e  kwise_path += an
+00037960: 676c 6569 202d 2061 6e67 6c65 320a 2020  glei - angle2.  
+00037970: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00037980: 2020 2020 2020 2020 7472 6967 6f77 6973          trigowis
+00037990: 655f 7061 7468 202b 3d20 616e 676c 6532  e_path += angle2
+000379a0: 202d 2061 6e67 6c65 690a 2020 2020 2020   - anglei.      
+000379b0: 2020 2020 2020 636c 6f63 6b77 6973 655f        clockwise_
+000379c0: 7061 7468 202b 3d20 616e 676c 6569 202d  path += anglei -
+000379d0: 2061 6e67 6c65 3220 2b20 766f 6c6d 646c   angle2 + volmdl
+000379e0: 722e 5457 4f5f 5049 0a0a 2020 2020 2020  r.TWO_PI..      
+000379f0: 2020 6966 2063 6c6f 636b 7769 7365 5f70    if clockwise_p
+00037a00: 6174 6820 3e20 7472 6967 6f77 6973 655f  ath > trigowise_
+00037a10: 7061 7468 3a0a 2020 2020 2020 2020 2020  path:.          
+00037a20: 2020 7365 6c66 2e69 735f 7472 6967 6f20    self.is_trigo 
+00037a30: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+00037a40: 2020 2073 656c 662e 616e 676c 6520 3d20     self.angle = 
+00037a50: 7472 6967 6f77 6973 655f 7061 7468 0a20  trigowise_path. 
+00037a60: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00037a70: 2020 2020 2020 2020 2023 2043 6c6f 636b           # Clock
+00037a80: 2077 6973 650a 2020 2020 2020 2020 2020   wise.          
+00037a90: 2020 7365 6c66 2e69 735f 7472 6967 6f20    self.is_trigo 
+00037aa0: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+00037ab0: 2020 2020 7365 6c66 2e61 6e67 6c65 203d      self.angle =
+00037ac0: 2063 6c6f 636b 7769 7365 5f70 6174 680a   clockwise_path.
+00037ad0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00037ae0: 2e73 7461 7274 203d 3d20 7365 6c66 2e65  .start == self.e
+00037af0: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
+00037b00: 7365 6c66 2e61 6e67 6c65 203d 2076 6f6c  self.angle = vol
+00037b10: 6d64 6c72 2e54 574f 5f50 490a 0a20 2020  mdlr.TWO_PI..   
+00037b20: 2020 2020 2069 6620 7365 6c66 2e69 735f       if self.is_
+00037b30: 7472 6967 6f3a 0a20 2020 2020 2020 2020  trigo:.         
+00037b40: 2020 2073 656c 662e 6f66 6673 6574 5f61     self.offset_a
+00037b50: 6e67 6c65 203d 2061 6e67 6c65 310a 2020  ngle = angle1.  
+00037b60: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00037b70: 2020 2020 2020 2020 7365 6c66 2e6f 6666          self.off
+00037b80: 7365 745f 616e 676c 6520 3d20 616e 676c  set_angle = angl
+00037b90: 6532 0a0a 2020 2020 2020 2020 766f 6c6d  e2..        volm
+00037ba0: 646c 722e 636f 7265 2e43 6f6d 706f 7369  dlr.core.Composi
+00037bb0: 7465 5072 696d 6974 6976 6533 442e 5f5f  tePrimitive3D.__
+00037bc0: 696e 6974 5f5f 2873 656c 662c 0a20 2020  init__(self,.   
+00037bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037c00: 7072 696d 6974 6976 6573 3d73 656c 662e  primitives=self.
+00037c10: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
+00037c20: 6f69 6e74 7328 6e75 6d62 6572 5f70 6f69  oints(number_poi
+00037c30: 6e74 733d 3230 292c 0a20 2020 2020 2020  nts=20),.       
+00037c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037c60: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00037c70: 3d6e 616d 6529 0a0a 2020 2020 6465 6620  =name)..    def 
+00037c80: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
+00037c90: 6f69 6e74 7328 7365 6c66 2c20 2a2c 206e  oints(self, *, n
+00037ca0: 756d 6265 725f 706f 696e 7473 3a20 696e  umber_points: in
+00037cb0: 7420 3d20 4e6f 6e65 2c20 616e 676c 655f  t = None, angle_
+00037cc0: 7265 736f 6c75 7469 6f6e 3a20 696e 7420  resolution: int 
+00037cd0: 3d20 3230 293a 0a20 2020 2020 2020 2022  = 20):.        "
+00037ce0: 2222 0a20 2020 2020 2020 2044 6973 6372  "".        Discr
+00037cf0: 6574 697a 6520 6120 436f 6e74 6f75 7220  etize a Contour 
+00037d00: 746f 2068 6176 6520 226e 2220 706f 696e  to have "n" poin
+00037d10: 7473 2e0a 0a20 2020 2020 2020 203a 7061  ts...        :pa
+00037d20: 7261 6d20 6e75 6d62 6572 5f70 6f69 6e74  ram number_point
+00037d30: 733a 2074 6865 206e 756d 6265 7220 6f66  s: the number of
+00037d40: 2070 6f69 6e74 7320 2869 6e63 6c75 6469   points (includi
+00037d50: 6e67 2073 7461 7274 2061 6e64 2065 6e64  ng start and end
+00037d60: 2070 6f69 6e74 7329 0a20 2020 2020 2020   points).       
+00037d70: 2020 2020 2020 6966 2075 6e73 6574 2c20        if unset, 
+00037d80: 6f6e 6c79 2073 7461 7274 2061 6e64 2065  only start and e
+00037d90: 6e64 2077 696c 6c20 6265 2072 6574 7572  nd will be retur
+00037da0: 6e65 640a 2020 2020 2020 2020 3a70 6172  ned.        :par
+00037db0: 616d 2061 6e67 6c65 5f72 6573 6f6c 7574  am angle_resolut
+00037dc0: 696f 6e3a 2069 6620 7365 742c 2074 6865  ion: if set, the
+00037dd0: 2073 616d 706c 696e 6720 7769 6c6c 2062   sampling will b
+00037de0: 6520 6164 6170 7465 6420 746f 2068 6176  e adapted to hav
+00037df0: 6520 6120 636f 6e74 726f 6c6c 6564 2061  e a controlled a
+00037e00: 6e67 756c 6172 2064 6973 7461 6e63 652e  ngular distance.
+00037e10: 2055 7365 6675 6c0a 2020 2020 2020 2020   Useful.        
+00037e20: 2020 2020 746f 206d 6573 6820 616e 2061      to mesh an a
+00037e30: 7263 0a20 2020 2020 2020 203a 7265 7475  rc.        :retu
+00037e40: 726e 3a20 6120 6c69 7374 206f 6620 7361  rn: a list of sa
+00037e50: 6d70 6c65 6420 706f 696e 7473 0a20 2020  mpled points.   
+00037e60: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00037e70: 2069 6620 6e6f 7420 6e75 6d62 6572 5f70   if not number_p
+00037e80: 6f69 6e74 733a 0a20 2020 2020 2020 2020  oints:.         
+00037e90: 2020 2069 6620 6e6f 7420 616e 676c 655f     if not angle_
+00037ea0: 7265 736f 6c75 7469 6f6e 3a0a 2020 2020  resolution:.    
+00037eb0: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+00037ec0: 6572 5f70 6f69 6e74 7320 3d20 320a 2020  er_points = 2.  
+00037ed0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00037ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037ef0: 6e75 6d62 6572 5f70 6f69 6e74 7320 3d20  number_points = 
+00037f00: 6d61 7468 2e63 6569 6c28 616e 676c 655f  math.ceil(angle_
+00037f10: 7265 736f 6c75 7469 6f6e 202a 2061 6273  resolution * abs
+00037f20: 2830 2e35 202a 2073 656c 662e 616e 676c  (0.5 * self.angl
+00037f30: 6520 2f20 6d61 7468 2e70 6929 2920 2b20  e / math.pi)) + 
+00037f40: 310a 2020 2020 2020 2020 6966 2073 656c  1.        if sel
+00037f50: 662e 616e 676c 655f 7374 6172 7420 3e20  f.angle_start > 
+00037f60: 7365 6c66 2e61 6e67 6c65 5f65 6e64 3a0a  self.angle_end:.
+00037f70: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00037f80: 656c 662e 616e 676c 655f 7374 6172 7420  elf.angle_start 
+00037f90: 3e3d 2073 656c 662e 616e 676c 655f 696e  >= self.angle_in
+00037fa0: 7465 7269 6f72 203e 3d20 7365 6c66 2e61  terior >= self.a
+00037fb0: 6e67 6c65 5f65 6e64 3a0a 2020 2020 2020  ngle_end:.      
+00037fc0: 2020 2020 2020 2020 2020 616e 676c 655f            angle_
+00037fd0: 7374 6172 7420 3d20 7365 6c66 2e61 6e67  start = self.ang
+00037fe0: 6c65 5f65 6e64 0a20 2020 2020 2020 2020  le_end.         
+00037ff0: 2020 2020 2020 2061 6e67 6c65 5f65 6e64         angle_end
+00038000: 203d 2073 656c 662e 616e 676c 655f 7374   = self.angle_st
+00038010: 6172 740a 2020 2020 2020 2020 2020 2020  art.            
+00038020: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00038030: 2020 2020 2020 616e 676c 655f 656e 6420        angle_end 
+00038040: 3d20 7365 6c66 2e61 6e67 6c65 5f65 6e64  = self.angle_end
+00038050: 202b 2076 6f6c 6d64 6c72 2e54 574f 5f50   + volmdlr.TWO_P
+00038060: 490a 2020 2020 2020 2020 2020 2020 2020  I.              
+00038070: 2020 616e 676c 655f 7374 6172 7420 3d20    angle_start = 
+00038080: 7365 6c66 2e61 6e67 6c65 5f73 7461 7274  self.angle_start
+00038090: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+000380a0: 6c66 2e61 6e67 6c65 5f73 7461 7274 203d  lf.angle_start =
+000380b0: 3d20 7365 6c66 2e61 6e67 6c65 5f65 6e64  = self.angle_end
+000380c0: 3a0a 2020 2020 2020 2020 2020 2020 616e  :.            an
+000380d0: 676c 655f 7374 6172 7420 3d20 300a 2020  gle_start = 0.  
+000380e0: 2020 2020 2020 2020 2020 616e 676c 655f            angle_
+000380f0: 656e 6420 3d20 3220 2a20 6d61 7468 2e70  end = 2 * math.p
+00038100: 690a 2020 2020 2020 2020 656c 7365 3a0a  i.        else:.
+00038110: 2020 2020 2020 2020 2020 2020 616e 676c              angl
+00038120: 655f 656e 6420 3d20 7365 6c66 2e61 6e67  e_end = self.ang
+00038130: 6c65 5f65 6e64 0a20 2020 2020 2020 2020  le_end.         
+00038140: 2020 2061 6e67 6c65 5f73 7461 7274 203d     angle_start =
+00038150: 2073 656c 662e 616e 676c 655f 7374 6172   self.angle_star
+00038160: 740a 2020 2020 2020 2020 6469 7363 7265  t.        discre
+00038170: 7469 7a61 7469 6f6e 5f70 6f69 6e74 7320  tization_points 
+00038180: 3d20 5b73 656c 662e 6672 616d 652e 6c6f  = [self.frame.lo
+00038190: 6361 6c5f 746f 5f67 6c6f 6261 6c5f 636f  cal_to_global_co
+000381a0: 6f72 6469 6e61 7465 7328 0a20 2020 2020  ordinates(.     
+000381b0: 2020 2020 2020 2076 6f6c 6d64 6c72 2e50         volmdlr.P
+000381c0: 6f69 6e74 3344 2873 656c 662e 4772 6164  oint3D(self.Grad
+000381d0: 6975 7320 2a20 6d61 7468 2e63 6f73 2861  ius * math.cos(a
+000381e0: 6e67 6c65 292c 2073 656c 662e 5372 6164  ngle), self.Srad
+000381f0: 6975 7320 2a20 6d61 7468 2e73 696e 2861  ius * math.sin(a
+00038200: 6e67 6c65 292c 2030 2929 0a20 2020 2020  ngle), 0)).     
+00038210: 2020 2020 2020 2066 6f72 2061 6e67 6c65         for angle
+00038220: 2069 6e20 6e70 792e 6c69 6e73 7061 6365   in npy.linspace
+00038230: 2861 6e67 6c65 5f73 7461 7274 2c20 616e  (angle_start, an
+00038240: 676c 655f 656e 642c 206e 756d 6265 725f  gle_end, number_
+00038250: 706f 696e 7473 295d 0a20 2020 2020 2020  points)].       
+00038260: 2072 6574 7572 6e20 6469 7363 7265 7469   return discreti
+00038270: 7a61 7469 6f6e 5f70 6f69 6e74 730a 0a20  zation_points.. 
+00038280: 2020 2064 6566 2070 6f6c 7967 6f6e 5f70     def polygon_p
+00038290: 6f69 6e74 7328 7365 6c66 2c20 6469 7363  oints(self, disc
+000382a0: 7265 7469 7a61 7469 6f6e 5f72 6573 6f6c  retization_resol
+000382b0: 7574 696f 6e3a 2069 6e74 293a 0a20 2020  ution: int):.   
+000382c0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+000382d0: 726e 2827 706f 6c79 676f 6e5f 706f 696e  rn('polygon_poin
+000382e0: 7473 2069 7320 6465 7072 6563 6174 6564  ts is deprecated
+000382f0: 2c5c 0a20 2020 2020 2020 2070 6c65 6173  ,\.        pleas
+00038300: 6520 7573 6520 6469 7363 7265 7469 7a61  e use discretiza
+00038310: 7469 6f6e 5f70 6f69 6e74 7320 696e 7374  tion_points inst
+00038320: 6561 6427 2c0a 2020 2020 2020 2020 2020  ead',.          
+00038330: 2020 2020 2020 2020 2020 2020 4465 7072              Depr
+00038340: 6563 6174 696f 6e57 6172 6e69 6e67 290a  ecationWarning).
+00038350: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00038360: 656c 662e 6469 7363 7265 7469 7a61 7469  elf.discretizati
+00038370: 6f6e 5f70 6f69 6e74 7328 616e 676c 655f  on_points(angle_
+00038380: 7265 736f 6c75 7469 6f6e 3d64 6973 6372  resolution=discr
+00038390: 6574 697a 6174 696f 6e5f 7265 736f 6c75  etization_resolu
+000383a0: 7469 6f6e 290a 0a20 2020 2064 6566 205f  tion)..    def _
+000383b0: 6765 745f 706f 696e 7473 2873 656c 6629  get_points(self)
+000383c0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000383d0: 2073 656c 662e 6469 7363 7265 7469 7a61   self.discretiza
+000383e0: 7469 6f6e 5f70 6f69 6e74 7328 6e75 6d62  tion_points(numb
+000383f0: 6572 5f70 6f69 6e74 733d 3230 290a 2020  er_points=20).  
+00038400: 2020 706f 696e 7473 203d 2070 726f 7065    points = prope
+00038410: 7274 7928 5f67 6574 5f70 6f69 6e74 7329  rty(_get_points)
+00038420: 0a0a 2020 2020 6465 6620 746f 5f32 6428  ..    def to_2d(
+00038430: 7365 6c66 2c20 706c 616e 655f 6f72 6967  self, plane_orig
+00038440: 696e 2c20 782c 2079 293a 0a20 2020 2020  in, x, y):.     
+00038450: 2020 2022 2222 0a20 2020 2020 2020 2054     """.        T
+00038460: 7261 6e73 666f 726d 7320 6120 4172 6345  ransforms a ArcE
+00038470: 6c6c 6970 7365 3344 2069 6e74 6f20 616e  llipse3D into an
+00038480: 2041 7263 456c 6c69 7073 6532 442c 2067   ArcEllipse2D, g
+00038490: 6976 656e 2061 6e20 706c 616e 6520 6f72  iven an plane or
+000384a0: 6967 696e 2061 6e64 2061 2075 2061 6e64  igin and a u and
+000384b0: 2076 2070 6c61 6e65 2076 6563 746f 722e   v plane vector.
+000384c0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000384d0: 2070 6c61 6e65 5f6f 7269 6769 6e3a 2070   plane_origin: p
+000384e0: 6c61 6e65 206f 7269 6769 6e2e 0a20 2020  lane origin..   
+000384f0: 2020 2020 203a 7061 7261 6d20 783a 2070       :param x: p
+00038500: 6c61 6e65 2075 2076 6563 746f 722e 0a20  lane u vector.. 
+00038510: 2020 2020 2020 203a 7061 7261 6d20 793a         :param y:
+00038520: 2070 6c61 6e65 2076 2076 6563 746f 722e   plane v vector.
+00038530: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00038540: 3a20 4172 6345 6c6c 6970 7365 3244 2e0a  : ArcEllipse2D..
+00038550: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00038560: 2020 2020 706f 696e 745f 7374 6172 7432      point_start2
+00038570: 6420 3d20 7365 6c66 2e73 7461 7274 2e74  d = self.start.t
+00038580: 6f5f 3264 2870 6c61 6e65 5f6f 7269 6769  o_2d(plane_origi
+00038590: 6e2c 2078 2c20 7929 0a20 2020 2020 2020  n, x, y).       
+000385a0: 2070 6f69 6e74 5f69 6e74 6572 696f 7232   point_interior2
+000385b0: 6420 3d20 7365 6c66 2e69 6e74 6572 696f  d = self.interio
+000385c0: 722e 746f 5f32 6428 706c 616e 655f 6f72  r.to_2d(plane_or
+000385d0: 6967 696e 2c20 782c 2079 290a 2020 2020  igin, x, y).    
+000385e0: 2020 2020 706f 696e 745f 656e 6432 6420      point_end2d 
+000385f0: 3d20 7365 6c66 2e65 6e64 2e74 6f5f 3264  = self.end.to_2d
+00038600: 2870 6c61 6e65 5f6f 7269 6769 6e2c 2078  (plane_origin, x
+00038610: 2c20 7929 0a20 2020 2020 2020 2063 656e  , y).        cen
+00038620: 7465 7220 3d20 7365 6c66 2e63 656e 7465  ter = self.cente
+00038630: 722e 746f 5f32 6428 706c 616e 655f 6f72  r.to_2d(plane_or
+00038640: 6967 696e 2c20 782c 2079 290a 2020 2020  igin, x, y).    
+00038650: 2020 2020 706f 696e 745f 6d61 6a6f 725f      point_major_
+00038660: 6469 7220 3d20 7365 6c66 2e63 656e 7465  dir = self.cente
+00038670: 7220 2b20 7365 6c66 2e47 7261 6469 7573  r + self.Gradius
+00038680: 202a 2073 656c 662e 6d61 6a6f 725f 6469   * self.major_di
+00038690: 720a 2020 2020 2020 2020 706f 696e 745f  r.        point_
+000386a0: 6d61 6a6f 725f 6469 725f 3264 203d 2070  major_dir_2d = p
+000386b0: 6f69 6e74 5f6d 616a 6f72 5f64 6972 2e74  oint_major_dir.t
+000386c0: 6f5f 3264 2870 6c61 6e65 5f6f 7269 6769  o_2d(plane_origi
+000386d0: 6e2c 2078 2c20 7929 0a20 2020 2020 2020  n, x, y).       
+000386e0: 2076 6563 746f 725f 6d61 6a6f 725f 6469   vector_major_di
+000386f0: 725f 3264 203d 2070 6f69 6e74 5f6d 616a  r_2d = point_maj
+00038700: 6f72 5f64 6972 5f32 6420 2d20 6365 6e74  or_dir_2d - cent
+00038710: 6572 0a20 2020 2020 2020 2076 6563 746f  er.        vecto
+00038720: 725f 6d61 6a6f 725f 6469 725f 3264 2e6e  r_major_dir_2d.n
+00038730: 6f72 6d61 6c69 7a65 2829 0a20 2020 2020  ormalize().     
+00038740: 2020 2072 6574 7572 6e20 4172 6345 6c6c     return ArcEll
+00038750: 6970 7365 3244 2870 6f69 6e74 5f73 7461  ipse2D(point_sta
+00038760: 7274 3264 2c20 706f 696e 745f 696e 7465  rt2d, point_inte
+00038770: 7269 6f72 3264 2c20 706f 696e 745f 656e  rior2d, point_en
+00038780: 6432 642c 2063 656e 7465 722c 2076 6563  d2d, center, vec
+00038790: 746f 725f 6d61 6a6f 725f 6469 725f 3264  tor_major_dir_2d
+000387a0: 2c20 6e61 6d65 3d73 656c 662e 6e61 6d65  , name=self.name
+000387b0: 290a 0a20 2020 2064 6566 206c 656e 6774  )..    def lengt
+000387c0: 6828 7365 6c66 293a 0a20 2020 2020 2020  h(self):.       
+000387d0: 2022 2222 436f 6d70 7574 6573 2074 6865   """Computes the
+000387e0: 206c 656e 6774 682e 2222 220a 2020 2020   length.""".    
+000387f0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00038800: 616e 676c 6520 2a20 6d61 7468 2e73 7172  angle * math.sqr
+00038810: 7428 0a20 2020 2020 2020 2020 2020 2028  t(.            (
+00038820: 7365 6c66 2e47 7261 6469 7573 202a 2a20  self.Gradius ** 
+00038830: 3220 2b20 7365 6c66 2e53 7261 6469 7573  2 + self.Sradius
+00038840: 202a 2a20 3229 202f 2032 290a 0a20 2020   ** 2) / 2)..   
+00038850: 2064 6566 206e 6f72 6d61 6c5f 7665 6374   def normal_vect
+00038860: 6f72 2873 656c 662c 2061 6273 6369 7373  or(self, absciss
+00038870: 6129 3a0a 2020 2020 2020 2020 7261 6973  a):.        rais
+00038880: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+00038890: 4572 726f 720a 0a20 2020 2064 6566 2075  Error..    def u
+000388a0: 6e69 745f 6e6f 726d 616c 5f76 6563 746f  nit_normal_vecto
+000388b0: 7228 7365 6c66 2c20 6162 7363 6973 7361  r(self, abscissa
+000388c0: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+000388d0: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+000388e0: 7272 6f72 0a0a 2020 2020 6465 6620 6469  rror..    def di
+000388f0: 7265 6374 696f 6e5f 7665 6374 6f72 2873  rection_vector(s
+00038900: 656c 662c 2061 6273 6369 7373 6129 3a0a  elf, abscissa):.
+00038910: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+00038920: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+00038930: 720a 0a20 2020 2064 6566 2075 6e69 745f  r..    def unit_
+00038940: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
+00038950: 2873 656c 662c 2061 6273 6369 7373 6129  (self, abscissa)
+00038960: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+00038970: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+00038980: 726f 720a 0a20 2020 2064 6566 2072 6576  ror..    def rev
+00038990: 6572 7365 2873 656c 6629 3a0a 2020 2020  erse(self):.    
+000389a0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000389b0: 5f5f 636c 6173 735f 5f28 7365 6c66 2e65  __class__(self.e
+000389c0: 6e64 2e63 6f70 7928 292c 0a20 2020 2020  nd.copy(),.     
+000389d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000389e0: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
+000389f0: 7465 7269 6f72 2e63 6f70 7928 292c 0a20  terior.copy(),. 
+00038a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038a10: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00038a20: 662e 7374 6172 742e 636f 7079 2829 2c0a  f.start.copy(),.
+00038a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038a40: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00038a50: 6c66 2e63 656e 7465 722e 636f 7079 2829  lf.center.copy()
+00038a60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00038a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038a80: 7365 6c66 2e6d 616a 6f72 5f64 6972 2e63  self.major_dir.c
+00038a90: 6f70 7928 292c 0a20 2020 2020 2020 2020  opy(),.         
+00038aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038ab0: 2020 2020 2073 656c 662e 6e61 6d65 290a       self.name).
+00038ac0: 0a20 2020 2064 6566 2070 6c6f 7428 7365  .    def plot(se
+00038ad0: 6c66 2c20 6178 3d4e 6f6e 652c 2063 6f6c  lf, ax=None, col
+00038ae0: 6f72 3a20 7374 7220 3d20 276b 272c 2061  or: str = 'k', a
+00038af0: 6c70 6861 3d31 2e30 2c20 6564 6765 5f65  lpha=1.0, edge_e
+00038b00: 6e64 733d 4661 6c73 652c 2065 6467 655f  nds=False, edge_
+00038b10: 6469 7265 6374 696f 6e3d 4661 6c73 6529  direction=False)
+00038b20: 3a0a 2020 2020 2020 2020 2222 2250 6c6f  :.        """Plo
+00038b30: 7420 7468 6520 6172 6320 656c 6c69 7073  t the arc ellips
+00038b40: 652e 2222 220a 2020 2020 2020 2020 6966  e.""".        if
+00038b50: 2061 7820 6973 204e 6f6e 653a 0a20 2020   ax is None:.   
+00038b60: 2020 2020 2020 2020 2066 6967 203d 2070           fig = p
+00038b70: 6c74 2e66 6967 7572 6528 290a 2020 2020  lt.figure().    
+00038b80: 2020 2020 2020 2020 6178 203d 2041 7865          ax = Axe
+00038b90: 7333 4428 6669 6729 0a20 2020 2020 2020  s3D(fig).       
+00038ba0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00038bb0: 2020 2066 6967 203d 204e 6f6e 650a 0a20     fig = None.. 
+00038bc0: 2020 2020 2020 2061 782e 706c 6f74 285b         ax.plot([
+00038bd0: 7365 6c66 2e69 6e74 6572 696f 725b 305d  self.interior[0]
+00038be0: 5d2c 205b 7365 6c66 2e69 6e74 6572 696f  ], [self.interio
+00038bf0: 725b 315d 5d2c 205b 7365 6c66 2e69 6e74  r[1]], [self.int
+00038c00: 6572 696f 725b 325d 5d2c 0a20 2020 2020  erior[2]],.     
+00038c10: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
+00038c20: 3d27 6227 290a 2020 2020 2020 2020 6178  ='b').        ax
+00038c30: 2e70 6c6f 7428 5b73 656c 662e 7374 6172  .plot([self.star
+00038c40: 745b 305d 5d2c 205b 7365 6c66 2e73 7461  t[0]], [self.sta
+00038c50: 7274 5b31 5d5d 2c20 5b73 656c 662e 7374  rt[1]], [self.st
+00038c60: 6172 745b 325d 5d2c 2063 3d27 7227 290a  art[2]], c='r').
+00038c70: 2020 2020 2020 2020 6178 2e70 6c6f 7428          ax.plot(
+00038c80: 5b73 656c 662e 656e 645b 305d 5d2c 205b  [self.end[0]], [
+00038c90: 7365 6c66 2e65 6e64 5b31 5d5d 2c20 5b73  self.end[1]], [s
+00038ca0: 656c 662e 656e 645b 325d 5d2c 2063 3d27  elf.end[2]], c='
+00038cb0: 7227 290a 2020 2020 2020 2020 6178 2e70  r').        ax.p
+00038cc0: 6c6f 7428 5b73 656c 662e 696e 7465 7269  lot([self.interi
+00038cd0: 6f72 5b30 5d5d 2c20 5b73 656c 662e 696e  or[0]], [self.in
+00038ce0: 7465 7269 6f72 5b31 5d5d 2c20 5b73 656c  terior[1]], [sel
+00038cf0: 662e 696e 7465 7269 6f72 5b32 5d5d 2c0a  f.interior[2]],.
+00038d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038d10: 633d 2767 2729 0a20 2020 2020 2020 2078  c='g').        x
+00038d20: 203d 205b 5d0a 2020 2020 2020 2020 7920   = [].        y 
+00038d30: 3d20 5b5d 0a20 2020 2020 2020 207a 203d  = [].        z =
+00038d40: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
+00038d50: 7078 2c20 7079 2c20 707a 2069 6e20 7365  px, py, pz in se
+00038d60: 6c66 2e64 6973 6372 6574 697a 6174 696f  lf.discretizatio
+00038d70: 6e5f 706f 696e 7473 286e 756d 6265 725f  n_points(number_
+00038d80: 706f 696e 7473 3d32 3029 3a0a 2020 2020  points=20):.    
+00038d90: 2020 2020 2020 2020 782e 6170 7065 6e64          x.append
+00038da0: 2870 7829 0a20 2020 2020 2020 2020 2020  (px).           
+00038db0: 2079 2e61 7070 656e 6428 7079 290a 2020   y.append(py).  
+00038dc0: 2020 2020 2020 2020 2020 7a2e 6170 7065            z.appe
+00038dd0: 6e64 2870 7a29 0a0a 2020 2020 2020 2020  nd(pz)..        
+00038de0: 6178 2e70 6c6f 7428 782c 2079 2c20 7a2c  ax.plot(x, y, z,
+00038df0: 2063 6f6c 6f72 2c20 616c 7068 613d 616c   color, alpha=al
+00038e00: 7068 6129 0a20 2020 2020 2020 2069 6620  pha).        if 
+00038e10: 6564 6765 5f65 6e64 733a 0a20 2020 2020  edge_ends:.     
+00038e20: 2020 2020 2020 2073 656c 662e 7374 6172         self.star
+00038e30: 742e 706c 6f74 2861 7829 0a20 2020 2020  t.plot(ax).     
+00038e40: 2020 2020 2020 2073 656c 662e 656e 642e         self.end.
+00038e50: 706c 6f74 2861 7829 0a20 2020 2020 2020  plot(ax).       
+00038e60: 2072 6574 7572 6e20 6178 0a0a 2020 2020   return ax..    
+00038e70: 6465 6620 706c 6f74 3264 2873 656c 662c  def plot2d(self,
+00038e80: 2078 3364 3a20 766f 6c6d 646c 722e 5665   x3d: volmdlr.Ve
+00038e90: 6374 6f72 3344 203d 2076 6f6c 6d64 6c72  ctor3D = volmdlr
+00038ea0: 2e58 3344 2c20 7933 643a 2076 6f6c 6d64  .X3D, y3d: volmd
+00038eb0: 6c72 2e56 6563 746f 7233 4420 3d20 766f  lr.Vector3D = vo
+00038ec0: 6c6d 646c 722e 5933 442c 0a20 2020 2020  lmdlr.Y3D,.     
+00038ed0: 2020 2020 2020 2020 2020 6178 3d4e 6f6e            ax=Non
+00038ee0: 652c 2063 6f6c 6f72 3d27 6b27 293a 0a20  e, color='k'):. 
+00038ef0: 2020 2020 2020 2069 6620 6178 2069 7320         if ax is 
+00038f00: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00038f10: 2020 6669 6720 3d20 706c 742e 6669 6775    fig = plt.figu
+00038f20: 7265 2829 0a20 2020 2020 2020 2020 2020  re().           
+00038f30: 2061 7820 3d20 6669 672e 6164 645f 7375   ax = fig.add_su
+00038f40: 6270 6c6f 7428 3131 312c 2070 726f 6a65  bplot(111, proje
+00038f50: 6374 696f 6e3d 2733 6427 290a 2020 2020  ction='3d').    
+00038f60: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00038f70: 2020 2020 2020 6669 6720 3d20 6178 2e66        fig = ax.f
+00038f80: 6967 7572 650a 0a20 2020 2020 2020 2023  igure..        #
+00038f90: 2054 4f44 4f3a 2045 6e68 616e 6365 2074   TODO: Enhance t
+00038fa0: 6869 7320 706c 6f74 0a20 2020 2020 2020  his plot.       
+00038fb0: 206c 656e 6774 6820 3d20 7365 6c66 2e6c   length = self.l
+00038fc0: 656e 6774 6828 290a 2020 2020 2020 2020  ength().        
+00038fd0: 7820 3d20 5b5d 0a20 2020 2020 2020 2079  x = [].        y
+00038fe0: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
+00038ff0: 7220 6920 696e 2072 616e 6765 2833 3029  r i in range(30)
+00039000: 3a0a 2020 2020 2020 2020 2020 2020 7020  :.            p 
+00039010: 3d20 7365 6c66 2e70 6f69 6e74 5f61 745f  = self.point_at_
+00039020: 6162 7363 6973 7361 2869 202f 2028 3239  abscissa(i / (29
+00039030: 2e29 202a 206c 656e 6774 6829 0a20 2020  .) * length).   
+00039040: 2020 2020 2020 2020 2078 692c 2079 6920           xi, yi 
+00039050: 3d20 702e 706c 616e 655f 7072 6f6a 6563  = p.plane_projec
+00039060: 7469 6f6e 3264 2878 3364 2c20 7933 6429  tion2d(x3d, y3d)
+00039070: 0a20 2020 2020 2020 2020 2020 2078 2e61  .            x.a
+00039080: 7070 656e 6428 7869 290a 2020 2020 2020  ppend(xi).      
+00039090: 2020 2020 2020 792e 6170 7065 6e64 2879        y.append(y
+000390a0: 6929 0a20 2020 2020 2020 2061 782e 706c  i).        ax.pl
+000390b0: 6f74 2878 2c20 792c 2063 6f6c 6f72 3d63  ot(x, y, color=c
+000390c0: 6f6c 6f72 290a 2020 2020 2020 2020 7265  olor).        re
+000390d0: 7475 726e 2061 780a 0a20 2020 2064 6566  turn ax..    def
+000390e0: 2074 7269 616e 6775 6c61 7469 6f6e 2873   triangulation(s
+000390f0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00039100: 7475 726e 204e 6f6e 650a 0a20 2020 2040  turn None..    @
+00039110: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00039120: 2062 6f75 6e64 696e 675f 626f 7828 7365   bounding_box(se
+00039130: 6c66 293a 0a20 2020 2020 2020 2069 6620  lf):.        if 
+00039140: 6e6f 7420 7365 6c66 2e5f 6262 6f78 3a0a  not self._bbox:.
+00039150: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00039160: 2e5f 6262 6f78 203d 2073 656c 662e 6765  ._bbox = self.ge
+00039170: 745f 626f 756e 6469 6e67 5f62 6f78 2829  t_bounding_box()
+00039180: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00039190: 7365 6c66 2e5f 6262 6f78 0a0a 2020 2020  self._bbox..    
+000391a0: 4062 6f75 6e64 696e 675f 626f 782e 7365  @bounding_box.se
+000391b0: 7474 6572 0a20 2020 2064 6566 2062 6f75  tter.    def bou
+000391c0: 6e64 696e 675f 626f 7828 7365 6c66 2c20  nding_box(self, 
+000391d0: 6e65 775f 626f 756e 6469 6e67 5f62 6f78  new_bounding_box
+000391e0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+000391f0: 5f62 626f 7820 3d20 6e65 775f 626f 756e  _bbox = new_boun
+00039200: 6469 6e67 5f62 6f78 0a0a 2020 2020 6465  ding_box..    de
+00039210: 6620 6765 745f 626f 756e 6469 6e67 5f62  f get_bounding_b
+00039220: 6f78 2873 656c 6629 3a0a 2020 2020 2020  ox(self):.      
+00039230: 2020 2222 220a 2020 2020 2020 2020 4361    """.        Ca
+00039240: 6c63 756c 6174 6573 2074 6865 2062 6f75  lculates the bou
+00039250: 6e64 696e 6720 626f 7820 6f66 2074 6865  nding box of the
+00039260: 2041 7263 3344 2e0a 0a20 2020 2020 2020   Arc3D...       
+00039270: 203a 7265 7475 726e 3a20 6120 766f 6c6d   :return: a volm
+00039280: 646c 722e 636f 7265 2e42 6f75 6e64 696e  dlr.core.Boundin
+00039290: 6742 6f78 206f 626a 6563 742e 0a20 2020  gBox object..   
+000392a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000392b0: 2023 2054 4f44 4f3a 2069 6d70 6c65 6d65   # TODO: impleme
+000392c0: 6e74 2065 7861 6374 2063 616c 6375 6c61  nt exact calcula
+000392d0: 7469 6f6e 0a0a 2020 2020 2020 2020 706f  tion..        po
+000392e0: 696e 7473 203d 2073 656c 662e 6469 7363  ints = self.disc
+000392f0: 7265 7469 7a61 7469 6f6e 5f70 6f69 6e74  retization_point
+00039300: 7328 616e 676c 655f 7265 736f 6c75 7469  s(angle_resoluti
+00039310: 6f6e 3d31 3029 0a20 2020 2020 2020 2078  on=10).        x
+00039320: 6d69 6e20 3d20 6d69 6e28 706f 696e 742e  min = min(point.
+00039330: 7820 666f 7220 706f 696e 7420 696e 2070  x for point in p
+00039340: 6f69 6e74 7329 0a20 2020 2020 2020 2078  oints).        x
+00039350: 6d61 7820 3d20 6d61 7828 706f 696e 742e  max = max(point.
+00039360: 7820 666f 7220 706f 696e 7420 696e 2070  x for point in p
+00039370: 6f69 6e74 7329 0a20 2020 2020 2020 2079  oints).        y
+00039380: 6d69 6e20 3d20 6d69 6e28 706f 696e 742e  min = min(point.
+00039390: 7920 666f 7220 706f 696e 7420 696e 2070  y for point in p
+000393a0: 6f69 6e74 7329 0a20 2020 2020 2020 2079  oints).        y
+000393b0: 6d61 7820 3d20 6d61 7828 706f 696e 742e  max = max(point.
+000393c0: 7920 666f 7220 706f 696e 7420 696e 2070  y for point in p
+000393d0: 6f69 6e74 7329 0a20 2020 2020 2020 207a  oints).        z
+000393e0: 6d69 6e20 3d20 6d69 6e28 706f 696e 742e  min = min(point.
+000393f0: 7a20 666f 7220 706f 696e 7420 696e 2070  z for point in p
+00039400: 6f69 6e74 7329 0a20 2020 2020 2020 207a  oints).        z
+00039410: 6d61 7820 3d20 6d61 7828 706f 696e 742e  max = max(point.
+00039420: 7a20 666f 7220 706f 696e 7420 696e 2070  z for point in p
+00039430: 6f69 6e74 7329 0a20 2020 2020 2020 2072  oints).        r
+00039440: 6574 7572 6e20 766f 6c6d 646c 722e 636f  eturn volmdlr.co
+00039450: 7265 2e42 6f75 6e64 696e 6742 6f78 2878  re.BoundingBox(x
+00039460: 6d69 6e2c 2078 6d61 782c 2079 6d69 6e2c  min, xmax, ymin,
+00039470: 2079 6d61 782c 207a 6d69 6e2c 207a 6d61   ymax, zmin, zma
+00039480: 7829 0a                                  x).
```

### Comparing `volmdlr-0.9.0/volmdlr/faces.py` & `volmdlr-0.9.1/volmdlr/faces.py`

 * *Files 0% similar despite different names*

```diff
@@ -1197,16 +1197,15 @@
         return cls(frame, arguments[0][1:-1])
 
     def to_step(self, current_id):
         frame = volmdlr.Frame3D(self.frame.origin, self.frame.w, self.frame.u,
                                 self.frame.v)
         content, frame_id = frame.to_step(current_id)
         plane_id = frame_id + 1
-        content += "#{} = PLANE('{}',#{});\n".format(plane_id, self.name,
-                                                     frame_id)
+        content += f"#{plane_id} = PLANE('{self.name}',#{frame_id});\n"
         return content, [plane_id]
 
     @classmethod
     def from_3_points(cls, point1, point2, point3):
         """
         Point 1 is used as origin of the plane.
         """
@@ -2876,18 +2875,15 @@
                         primitives3d.extend(primitives_list)
                     else:
                         continue
                 except NotImplementedError:
                     print(f'Class {self.__class__.__name__} does not implement {method_name}'
                           f'with {primitive2d.__class__.__name__}')
             else:
-                raise NotImplementedError(
-                    'Class {} does not implement {}'.format(
-                        self.__class__.__name__,
-                        method_name))
+                raise NotImplementedError(f'Class {self.__class__.__name__} does not implement {method_name}')
 
         return volmdlr.wires.Contour3D(primitives3d)
 
     @classmethod
     def from_step(cls, arguments, object_dict):
         """
         Converts a step primitive to a SphericalSurface3D.
@@ -3645,32 +3641,32 @@
 
         """
 
         knots = self.u_knots
         multiplicities = self.u_multiplicities
 
         knots_vec = []
-        for i in range(0, len(knots)):
+        for i, knot in enumerate(knots):
             for _ in range(0, multiplicities[i]):
-                knots_vec.append(knots[i])
+                knots_vec.append(knot)
         return knots_vec
 
     def knots_vector_v(self):
         """
         Compute the global knot vector (v direction) based on knot elements and multiplicities.
 
         """
 
         knots = self.v_knots
         multiplicities = self.v_multiplicities
 
         knots_vec = []
-        for i in range(0, len(knots)):
+        for i, knot in enumerate(knots):
             for _ in range(0, multiplicities[i]):
-                knots_vec.append(knots[i])
+                knots_vec.append(knot)
         return knots_vec
 
     def basis_functions_u(self, u, k, i):
         """
         Compute basis functions Bi in u direction for u=u and degree=k.
 
         """
@@ -4081,41 +4077,14 @@
         p2 = volmdlr.Point2D(u2, v1)
         p3 = volmdlr.Point2D(u2, v2)
         p4 = volmdlr.Point2D(u1, v2)
         outer_contour = volmdlr.wires.ClosedPolygon2D([p1, p2, p3, p4])
         surface = Surface2D(outer_contour, [])
         return BSplineFace3D(self, surface, name)  # PlaneFace3D
 
-    def FreeCADExport(self, ip, ndigits=3):
-        name = 'primitive{}'.format(ip)
-        script = ""
-        points = '['
-        for pts_row in self.control_points_table:
-            pts = '['
-            for pt in pts_row:
-                point = 'fc.Vector({},{},{}),'.format(pt[0], pt[1], pt[2])
-                pts += point
-            pts = pts[:-1] + '],'
-            points += pts
-        points = points[:-1] + ']'
-
-        script += '{} = Part.BSplineSurface()\n'.format(name)
-        if self.weights is None:
-            script += '{}.buildFromPolesMultsKnots({},{},{},udegree={},vdegree={},uknots={},vknots={})\n'.format(
-                name, points, self.u_multiplicities, self.v_multiplicities,
-                self.degree_u, self.degree_v, self.u_knots, self.v_knots)
-        else:
-            script += '{}.buildFromPolesMultsKnots({},{},{},udegree={},vdegree={},uknots={}, \
-                vknots={},weights={})\n'.format(
-                name, points, self.u_multiplicities, self.v_multiplicities,
-                self.degree_u, self.degree_v, self.u_knots, self.v_knots,
-                self.weights)
-
-        return script
-
     def rotation(self, center: volmdlr.Vector3D,
                  axis: volmdlr.Vector3D, angle: float):
         """
         BSplineSurface3D rotation.
 
         :param center: rotation center
         :param axis: rotation axis
```

### Comparing `volmdlr-0.9.0/volmdlr/geometry.py` & `volmdlr-0.9.1/volmdlr/geometry.py`

 * *Files 4% similar despite different names*

```diff
@@ -11,14 +11,15 @@
 
 import volmdlr as vm
 
 
 def euler_angles_to_transfer_matrix(psi, theta, phi):
     """
     Give Transition Matrix from euler angles.
+
     Angles in radians
     """
 
     cpsi = math.cos(psi)
     spsi = math.sin(psi)
     ctheta = math.cos(theta)
     stheta = math.sin(theta)
@@ -27,17 +28,15 @@
     matrix = array([[cphi * cpsi - sphi * ctheta * spsi, -spsi * cphi - cpsi * ctheta * sphi, stheta * sphi],
                     [cpsi * sphi + spsi * ctheta * cphi, -sphi * spsi + cphi * ctheta * cpsi, -stheta * cphi],
                     [spsi * stheta, cpsi * stheta, ctheta]])
     return matrix
 
 
 def transfer_matrix_to_euler_angles(R):
-    """
-    Returns the Euler angle from a transfer matrix.
-    """
+    """Returns the Euler angle from a transfer matrix."""
     if (R[2, 2] != 1) and (R[2, 2] != -1):
         theta = math.acos(R[2, 2])
         psi = math.atan2(R[2, 0] / math.sin(theta), R[2, 1] / math.sin(theta))
         phi = math.atan2(R[0, 2] / math.sin(theta), -R[1, 2] / math.sin(theta))
     else:
         phi = 0
         if R[2, 2] == 1:
```

### Comparing `volmdlr-0.9.0/volmdlr/gmsh_vm.py` & `volmdlr-0.9.1/volmdlr/gmsh_vm.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/grid.py` & `volmdlr-0.9.1/volmdlr/grid.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/mesh.py` & `volmdlr-0.9.1/volmdlr/mesh.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/models/bspline_curves.py` & `volmdlr-0.9.1/volmdlr/models/bspline_curves.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/models/bspline_surfaces.py` & `volmdlr-0.9.1/volmdlr/models/bspline_surfaces.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/models/casing.py` & `volmdlr-0.9.1/volmdlr/models/casing.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/models/conical_surfaces.py` & `volmdlr-0.9.1/volmdlr/models/conical_surfaces.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/models/contours.py` & `volmdlr-0.9.1/volmdlr/models/contours.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/models/workflows/core.py` & `volmdlr-0.9.1/volmdlr/models/workflows/core.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/primitives.py` & `volmdlr-0.9.1/volmdlr/primitives.py`

 * *Files 1% similar despite different names*

```diff
@@ -74,15 +74,15 @@
             group = [rounded_points_indices[0]]
             _, _, _, dist0, alpha0 = self.arc_features(rounded_points_indices[0])
             dist[rounded_points_indices[0]] = dist0
             alpha[rounded_points_indices[0]] = alpha0
 
             for i in rounded_points_indices[1:]:
                 # Computing the arc
-                _, pi2, _, dist2, alpha2 = self.arc_features(i)
+                _, _, _, dist2, alpha2 = self.arc_features(i)
                 dist[i] = dist2
                 alpha[i] = alpha2
                 if i - 1 in self.radius:
                     p1 = self.points[i - 1]
                     p2 = self.points[i]
                     length = (p2 - p1).norm()
                     lines_length[i - 1] = length
@@ -92,18 +92,18 @@
                         groups.append(group)
                         group = [i]
                     else:
                         if not self.adapt_radius:
                             raise ValueError
                         group.append(i)
                 else:
-                    if group != []:
+                    if group:
                         groups.append(group)
                     group = [i]
-            if group != []:
+            if group:
                 groups.append(group)
             if self.adapt_radius:
                 if self.closed:
                     if 0 in groups[0]:
                         if self.npoints in groups[-1]:
                             new_group = groups[0] + groups[-1]
                             groups[0] = new_group
```

### Comparing `volmdlr-0.9.0/volmdlr/primitives2d.py` & `volmdlr-0.9.1/volmdlr/primitives2d.py`

 * *Files 1% similar despite different names*

```diff
@@ -203,14 +203,16 @@
             offset_points.append(self.points[-1] + offset * offset_vectors[-1])
 
         return self.__class__(offset_points, new_radii,
                               adapt_radius=self.adapt_radius)
 
     def offset_single_line(self, line_index, offset):
         """
+        Offsets a single line.
+
         :param line_index: 0 being the 1st line
         """
         new_linesegment2D_points = []
         dont_add_last_point = False
 
         for i, point in enumerate(
                 self.points[:-1] + (self.closed) * [self.points[-1]]):
@@ -407,19 +409,19 @@
         else:
             new_points[line_indexes[-1] + 1] = self.points[line_indexes[
                                                                -1] + 1] + distance_dir2 * dir_vec_2
 
         # =============================================================================
         # CREATE THE NEW POINTS' LIST
         # =============================================================================
-        for i in range(len(self.points)):
+        for i, point in enumerate(self.points):
             if i in new_points:
                 new_linesegment2D_points.append(new_points[i])
             else:
-                new_linesegment2D_points.append(self.points[i])
+                new_linesegment2D_points.append(point)
 
         rls_2d = self.__class__(new_linesegment2D_points, self.radius,
                                 adapt_radius=self.adapt_radius)
 
         return rls_2d
 
 
@@ -443,21 +445,18 @@
         volmdlr.wires.Contour2D.__init__(self, self._primitives(), name)
 
 
 class Measure2D(volmdlr.edges.LineSegment2D):
     """
     Measure 2D class.
 
+    :param unit: 'mm', 'm' or None. If None, the distance won't be in the label
     """
 
     def __init__(self, point1, point2, label='', unit='mm', type_='distance'):
-        """
-        :param unit: 'mm', 'm' or None. If None, the distance won't be in the label
-
-        """
         # TODO: offset parameter
         volmdlr.edges.LineSegment2D.__init__(self, point1, point2)
         self.label = label
         self.unit = unit
         self.type_ = type_
 
     def plot(self, ax, ndigits=6):
@@ -467,17 +466,17 @@
         distance = self.end.point_distance(self.start)
 
         if self.label != '':
             label = '{}: '.format(self.label)
         else:
             label = ''
         if self.unit == 'mm':
-            label += '{} mm'.format(round(distance * 1000, ndigits))
+            label += f'{round(distance * 1000, ndigits)} mm'
         else:
-            label += '{} m'.format(round(distance, ndigits))
+            label += f'{round(distance, ndigits)} m'
 
         if self.type_ == 'distance':
             arrow = matplotlib.patches.FancyArrowPatch((x1, y1), (x2, y2),
                                                        arrowstyle='<|-|>,head_length=10,head_width=5',
                                                        shrinkA=0, shrinkB=0,
                                                        color='k')
         elif self.type_ == 'radius':
```

### Comparing `volmdlr-0.9.0/volmdlr/primitives3d.py` & `volmdlr-0.9.1/volmdlr/primitives3d.py`

 * *Files 1% similar despite different names*

```diff
@@ -27,14 +27,15 @@
 
 npy.seterr(divide='raise')
 
 
 class OpenRoundedLineSegments3D(volmdlr.wires.Wire3D,
                                 volmdlr.primitives.RoundedLineSegments):
     """
+    Defines an open rounded line segments.
 
     :param points: Points used to draw the wire.
     :type points: List of Point3D.
     :param radius: Radius used to connect different parts of the wire.
     :type radius: {position1(n): float which is the radius linked the n-1 and.
     n+1 points, position2(n+1):...}
     """
@@ -785,16 +786,15 @@
         p2_3D = self.axis_point + volmdlr.Point3D(self.axis.vector)
         p2_2D = p2_3D.To2D(self.plane_origin, self.x, self.y)
         axis_2D = volmdlr.edges.Line2D(p1_2D, p2_2D)
         com = self.contour2d.center_of_mass()
         if com is not False:
             rg = axis_2D.point_distance(com)
             return self.angle * rg * self.contour2d.area()
-        else:
-            return 0
+        return 0.
 
     def rotation(self, center: volmdlr.Point3D, axis: volmdlr.Vector3D,
                  angle: float):
         """
         Revolved profile rotation.
 
         :param center: rotation center
@@ -1253,14 +1253,16 @@
             point=self.position, vector=self.axis, main_axis=volmdlr.Z3D
         )
 
         return local_frame.local_to_global_coordinates(volmdlr.Point3D(x_local, y_local, z_local))
 
     def lhs_points_inside(self, n_points: int) -> List[volmdlr.Point3D]:
         """
+        Returns some points inside the cylinder from a LHS samplings.
+
         :param n_points: number of points
         :return: Latin hypercube sampling points inside the cylinder
         """
         local_frame = volmdlr.Frame3D.from_point_and_vector(
             point=self.position, vector=self.axis, main_axis=volmdlr.Z3D
         )
 
@@ -1286,14 +1288,16 @@
                 local_frame.local_to_global_coordinates(volmdlr.Point3D(x_local, y_local, z_local))
             )
 
         return points
 
     def point_belongs(self, point3d: volmdlr.Point3D, **kwargs) -> bool:
         """
+        Returns if the point belongs to the cylinder.
+
         :param point3d: volmdlr Point3D
         :return: True if the given point is inside the cylinder, False otherwise
         """
         local_frame = volmdlr.Frame3D.from_point_and_vector(
             point=self.position, vector=self.axis, main_axis=volmdlr.Z3D
         )
 
@@ -1455,16 +1459,15 @@
 
         """
         return self.length * math.pi * self.radius**2 / 3
 
 
 class HollowCylinder(RevolvedProfile):
     """
-    Creates a hollow cylinder with the position, the axis of revolution,
-    the inner and outer radius and the length.
+    Creates a hollow cylinder with the position, the axis of revolution the inner and outer radius and the length.
 
     """
 
     def __init__(self, position: volmdlr.Point3D, axis: volmdlr.Vector3D,
                  inner_radius: float, outer_radius: float, length: float,
                  color: Tuple[float, float, float] = None, alpha: float = 1,
                  name: str = ''):
@@ -1774,17 +1777,15 @@
                                                          volmdlr.edges.LineSegment2D(volmdlr.Y2D, volmdlr.O2D)])
                 surf2d = volmdlr.faces.Surface2D(outer_contour, [])
 
                 bsface3d = volmdlr.faces.BSplineFace3D(bezier_surface3d, surf2d)
                 faces.append(bsface3d)
 
             else:
-                raise NotImplementedError(
-                    'Unimplemented primitive for sweep: {}'
-                    .format(wire_primitive.__class__.__name__))
+                raise NotImplementedError(f'Unimplemented primitive for sweep: {wire_primitive.__class__.__name__}')
 
         return faces
 
     def frame_mapping(self, frame: volmdlr.Frame3D, side: str):
         """
         Changes frame_mapping and return a new Sweep.
 
@@ -1842,22 +1843,24 @@
                                  color=color, alpha=alpha, name=name)
 
     def volume(self):
         return 4 / 3 * math.pi * self.radius**3
 
     def frame_mapping(self, frame: volmdlr.Frame3D, side: str):
         """
-        Changes frame_mapping and return a new Sphere
+        Changes frame_mapping and return a new Sphere.
+
         :param side: 'old' or 'new'
         """
         return Sphere(self.center.frame_mapping(frame, side), self.radius)
 
     def frame_mapping_inplace(self, frame: volmdlr.Frame3D, side: str):
         """
-        Changes frame_mapping and the object is updated inplace
+        Changes frame_mapping and the object is updated inplace.
+
         side = 'old' or 'new'
         """
         warnings.warn("'inplace' methods are deprecated. Use a not inplace method instead.", DeprecationWarning)
 
         self.center.frame_mapping_inplace(frame, side)
 
     def to_point_skin(self, resolution: float = 1e-3):
```

### Comparing `volmdlr-0.9.0/volmdlr/step.py` & `volmdlr-0.9.1/volmdlr/step.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/stl.py` & `volmdlr-0.9.1/volmdlr/stl.py`

 * *Files 1% similar despite different names*

```diff
@@ -254,15 +254,15 @@
 
         valid_points = vm.Vector3D.remove_duplicate(points1 + points2 + points3)
         return valid_points
 
     # TODO: decide which algorithm to be used (no _BIS)
     def extract_points_BIS(self, min_distance: float = 0.001):
         points = []
-        for i, t in enumerate(self.triangles):
+        for t in self.triangles:
             distance12 = t.point1.point_distance(t.point2)
             distance13 = t.point1.point_distance(t.point3)
             distance23 = t.point2.point_distance(t.point3)
             if distance12 > min_distance:
                 n_div = int(distance12 / min_distance)
                 for n in range(n_div):
                     new_point = t.point1 + (t.point2 - t.point1) * n / n_div
```

### Comparing `volmdlr-0.9.0/volmdlr/templates.py` & `volmdlr-0.9.1/volmdlr/templates.py`

 * *Files 2% similar despite different names*

```diff
@@ -118,17 +118,14 @@
         //    }
         // })
 
       	var light1 = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(-1, -1, -1), scene);
       	light1.intensity=0.5;
       	light1.specular = new BABYLON.Color3(0, 0, 0);
 
-      	// var light2 = new BABYLON.SpotLight("Spot0", new BABYLON.Vector3(0, 30, -10), new BABYLON.Vector3(0, -1, 0), 0.8, 2, scene);
-      	// light2.diffuse = new BABYLON.Color3(1, 1, 1);
-      	// light2.specular = new BABYLON.Color3(1, 1, 1);
         var light2 = new BABYLON.PointLight("light2", new BABYLON.Vector3(0, 0, 0), scene);
         light2.specular = new BABYLON.Color3(0, 0, 0);
         light2.intensity = 0.3;
         light2.parent = camera;
 
         var light3 = new BABYLON.HemisphericLight("light3", new BABYLON.Vector3(1, 1, 1), scene);
         light3.specular = new BABYLON.Color3(0, 0, 0);
@@ -144,29 +141,32 @@
                 plane.material = new BABYLON.StandardMaterial("TextPlaneMaterial", scene);
                 plane.material.backFaceCulling = false;
                 plane.material.specularColor = new BABYLON.Color3(0, 0, 0);
                 plane.material.diffuseTexture = dynamicTexture;
                 return plane;
             };
             var axisX = BABYLON.Mesh.CreateLines("axisX", [
-                new BABYLON.Vector3.Zero(), new BABYLON.Vector3(size, 0, 0), new BABYLON.Vector3(size * 0.95, 0.05 * size, 0),
+                new BABYLON.Vector3.Zero(), new BABYLON.Vector3(size, 0, 0),
+                new BABYLON.Vector3(size * 0.95, 0.05 * size, 0),
                 new BABYLON.Vector3(size, 0, 0), new BABYLON.Vector3(size * 0.95, -0.05 * size, 0)
             ], scene);
             axisX.color = new BABYLON.Color3(1, 0, 0);
             var xChar = makeTextPlane("X", "red", size / 10);
             xChar.position = new BABYLON.Vector3(0.9 * size, -0.05 * size, 0);
             var axisY = BABYLON.Mesh.CreateLines("axisY", [
-                new BABYLON.Vector3.Zero(), new BABYLON.Vector3(0, size, 0), new BABYLON.Vector3(-0.05 * size, size * 0.95, 0),
+                new BABYLON.Vector3.Zero(), new BABYLON.Vector3(0, size, 0),
+                new BABYLON.Vector3(-0.05 * size, size * 0.95, 0),
                 new BABYLON.Vector3(0, size, 0), new BABYLON.Vector3(0.05 * size, size * 0.95, 0)
             ], scene);
             axisY.color = new BABYLON.Color3(0, 1, 0);
             var yChar = makeTextPlane("Y", "green", size / 10);
             yChar.position = new BABYLON.Vector3(0, 0.9 * size, -0.05 * size);
             var axisZ = BABYLON.Mesh.CreateLines("axisZ", [
-                new BABYLON.Vector3.Zero(), new BABYLON.Vector3(0, 0, size), new BABYLON.Vector3(0, -0.05 * size, size * 0.95),
+                new BABYLON.Vector3.Zero(), new BABYLON.Vector3(0, 0, size),
+                new BABYLON.Vector3(0, -0.05 * size, size * 0.95),
                 new BABYLON.Vector3(0, 0, size), new BABYLON.Vector3(0, 0.05 * size, size * 0.95)
             ], scene);
             axisZ.color = new BABYLON.Color3(0, 0, 1);
             var zChar = makeTextPlane("Z", "blue", size / 10);
             zChar.position = new BABYLON.Vector3(0, 0.05 * size, 0.9 * size);
         };
```

### Comparing `volmdlr-0.9.0/volmdlr/utils/intersections.py` & `volmdlr-0.9.1/volmdlr/utils/intersections.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/utils/parametric.py` & `volmdlr-0.9.1/volmdlr/utils/parametric.py`

 * *Files identical despite different names*

### Comparing `volmdlr-0.9.0/volmdlr/wires.py` & `volmdlr-0.9.1/volmdlr/wires.py`

 * *Files 0% similar despite different names*

```diff
@@ -419,14866 +419,14864 @@
 00001a20: 6578 290a 2020 2020 2020 2020 2020 2020  ex).            
 00001a30: 696e 6469 6365 732e 6170 7065 6e64 2869  indices.append(i
 00001a40: 6e64 290a 0a20 2020 2020 2020 2073 6861  nd)..        sha
 00001a50: 7265 6420 3d20 6c69 7374 2873 6574 2869  red = list(set(i
 00001a60: 6e64 6963 6573 5b30 5d29 2026 2073 6574  ndices[0]) & set
 00001a70: 2869 6e64 6963 6573 5b31 5d29 290a 2020  (indices[1])).  
 00001a80: 2020 2020 2020 696e 6420 3d20 5b5d 0a20        ind = []. 
-00001a90: 2020 2020 2020 2069 6620 7368 6172 6564         if shared
-00001aa0: 203d 3d20 5b5d 3a0a 2020 2020 2020 2020   == []:.        
-00001ab0: 2020 2020 696e 642e 6170 7065 6e64 2869      ind.append(i
-00001ac0: 6e64 6963 6573 5b30 5d5b 305d 290a 2020  ndices[0][0]).  
-00001ad0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00001ae0: 2869 6e64 6963 6573 5b31 5d29 203d 3d20  (indices[1]) == 
-00001af0: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
-00001b00: 2020 2069 6e64 2e61 7070 656e 6428 696e     ind.append(in
-00001b10: 6469 6365 735b 315d 5b31 5d29 0a20 2020  dices[1][1]).   
-00001b20: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00001b30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00001b40: 6e64 2e61 7070 656e 6428 696e 6469 6365  nd.append(indice
-00001b50: 735b 315d 5b30 5d29 0a20 2020 2020 2020  s[1][0]).       
-00001b60: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00001b70: 2020 2066 6f72 2069 6e64 6963 6520 696e     for indice in
-00001b80: 2069 6e64 6963 6573 3a0a 2020 2020 2020   indices:.      
-00001b90: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00001ba0: 2869 6e64 6963 6529 203d 3d20 313a 0a20  (indice) == 1:. 
+00001a90: 2020 2020 2020 2069 6620 6e6f 7420 7368         if not sh
+00001aa0: 6172 6564 3a0a 2020 2020 2020 2020 2020  ared:.          
+00001ab0: 2020 696e 642e 6170 7065 6e64 2869 6e64    ind.append(ind
+00001ac0: 6963 6573 5b30 5d5b 305d 290a 2020 2020  ices[0][0]).    
+00001ad0: 2020 2020 2020 2020 6966 206c 656e 2869          if len(i
+00001ae0: 6e64 6963 6573 5b31 5d29 203d 3d20 323a  ndices[1]) == 2:
+00001af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001b00: 2069 6e64 2e61 7070 656e 6428 696e 6469   ind.append(indi
+00001b10: 6365 735b 315d 5b31 5d29 0a20 2020 2020  ces[1][1]).     
+00001b20: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00001b30: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
+00001b40: 2e61 7070 656e 6428 696e 6469 6365 735b  .append(indices[
+00001b50: 315d 5b30 5d29 0a20 2020 2020 2020 2065  1][0]).        e
+00001b60: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00001b70: 2066 6f72 2069 6e64 6963 6520 696e 2069   for indice in i
+00001b80: 6e64 6963 6573 3a0a 2020 2020 2020 2020  ndices:.        
+00001b90: 2020 2020 2020 2020 6966 206c 656e 2869          if len(i
+00001ba0: 6e64 6963 6529 203d 3d20 313a 0a20 2020  ndice) == 1:.   
 00001bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001bc0: 2020 2069 6e64 2e61 7070 656e 6428 696e     ind.append(in
-00001bd0: 6469 6365 5b30 5d29 0a20 2020 2020 2020  dice[0]).       
-00001be0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00001bc0: 2069 6e64 2e61 7070 656e 6428 696e 6469   ind.append(indi
+00001bd0: 6365 5b30 5d29 0a20 2020 2020 2020 2020  ce[0]).         
+00001be0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
 00001bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c00: 2020 2066 6f72 2069 2069 6e20 696e 6469     for i in indi
-00001c10: 6365 3a0a 2020 2020 2020 2020 2020 2020  ce:.            
-00001c20: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00001c30: 2021 3d20 7368 6172 6564 5b30 5d3a 0a20   != shared[0]:. 
+00001c00: 2066 6f72 2069 2069 6e20 696e 6469 6365   for i in indice
+00001c10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00001c20: 2020 2020 2020 2020 2020 6966 2069 2021            if i !
+00001c30: 3d20 7368 6172 6564 5b30 5d3a 0a20 2020  = shared[0]:.   
 00001c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c50: 2020 2020 2020 2020 2020 2069 6e64 2e61             ind.a
-00001c60: 7070 656e 6428 6929 0a20 2020 2020 2020  ppend(i).       
-00001c70: 2072 6574 7572 6e20 7365 6c66 2e65 7874   return self.ext
-00001c80: 7261 6374 5f70 7269 6d69 7469 7665 7328  ract_primitives(
-00001c90: 706f 696e 7431 2c20 7072 696d 6974 6976  point1, primitiv
-00001ca0: 6573 5b69 6e64 5b30 5d5d 2c20 706f 696e  es[ind[0]], poin
-00001cb0: 7432 2c0a 2020 2020 2020 2020 2020 2020  t2,.            
+00001c50: 2020 2020 2020 2020 2069 6e64 2e61 7070           ind.app
+00001c60: 656e 6428 6929 0a20 2020 2020 2020 2072  end(i).        r
+00001c70: 6574 7572 6e20 7365 6c66 2e65 7874 7261  eturn self.extra
+00001c80: 6374 5f70 7269 6d69 7469 7665 7328 706f  ct_primitives(po
+00001c90: 696e 7431 2c20 7072 696d 6974 6976 6573  int1, primitives
+00001ca0: 5b69 6e64 5b30 5d5d 2c20 706f 696e 7432  [ind[0]], point2
+00001cb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 00001cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001cd0: 2020 2020 2020 2020 2020 2070 7269 6d69             primi
-00001ce0: 7469 7665 735b 696e 645b 315d 5d2c 2069  tives[ind[1]], i
-00001cf0: 6e73 6964 6529 0a0a 2020 2020 6465 6620  nside)..    def 
-00001d00: 6162 7363 6973 7361 2873 656c 662c 2070  abscissa(self, p
-00001d10: 6f69 6e74 2c20 746f 6c3d 3165 2d36 293a  oint, tol=1e-6):
-00001d20: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00001d30: 2020 2020 2043 6f6d 7075 7465 2074 6865       Compute the
-00001d40: 2063 7572 7669 6c69 6e65 6172 2061 6273   curvilinear abs
-00001d50: 6369 7373 6120 6f66 2061 2070 6f69 6e74  cissa of a point
-00001d60: 206f 6e20 6120 7769 7265 2e0a 0a20 2020   on a wire...   
-00001d70: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00001d80: 2069 6620 7365 6c66 2e70 6f69 6e74 5f6f   if self.point_o
-00001d90: 7665 725f 7769 7265 2870 6f69 6e74 2c20  ver_wire(point, 
-00001da0: 746f 6c29 3a0a 2020 2020 2020 2020 2020  tol):.          
-00001db0: 2020 6c65 6e67 7468 203d 2030 0a20 2020    length = 0.   
-00001dc0: 2020 2020 2020 2020 2066 6f72 2070 7269           for pri
-00001dd0: 6d69 7469 7665 2069 6e20 7365 6c66 2e70  mitive in self.p
-00001de0: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
-00001df0: 2020 2020 2020 2020 2020 2069 6620 7072             if pr
-00001e00: 696d 6974 6976 652e 706f 696e 745f 6265  imitive.point_be
-00001e10: 6c6f 6e67 7328 706f 696e 742c 2074 6f6c  longs(point, tol
-00001e20: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00001e30: 2020 2020 2020 206c 656e 6774 6820 2b3d         length +=
-00001e40: 2070 7269 6d69 7469 7665 2e61 6273 6369   primitive.absci
-00001e50: 7373 6128 706f 696e 7429 0a20 2020 2020  ssa(point).     
-00001e60: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00001e70: 7265 616b 0a20 2020 2020 2020 2020 2020  reak.           
-00001e80: 2020 2020 206c 656e 6774 6820 2b3d 2070       length += p
-00001e90: 7269 6d69 7469 7665 2e6c 656e 6774 6828  rimitive.length(
-00001ea0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00001eb0: 7475 726e 206c 656e 6774 680a 0a20 2020  turn length..   
-00001ec0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00001ed0: 4572 726f 7228 2750 6f69 6e74 2069 7320  Error('Point is 
-00001ee0: 6e6f 7420 6f6e 2077 6972 6527 290a 0a20  not on wire').. 
-00001ef0: 2020 2064 6566 2073 6f72 745f 706f 696e     def sort_poin
-00001f00: 7473 5f61 6c6f 6e67 5f77 6972 6528 7365  ts_along_wire(se
-00001f10: 6c66 2c20 706f 696e 7473 293a 0a0a 2020  lf, points):..  
-00001f20: 2020 2020 2020 7265 7475 726e 2073 6f72        return sor
-00001f30: 7465 6428 706f 696e 7473 2c20 6b65 793d  ted(points, key=
-00001f40: 6c61 6d62 6461 2070 6f69 6e74 3a20 7365  lambda point: se
-00001f50: 6c66 2e61 6273 6369 7373 6128 706f 696e  lf.abscissa(poin
-00001f60: 7429 290a 0a20 2020 2064 6566 2069 735f  t))..    def is_
-00001f70: 6f72 6465 7265 6428 7365 6c66 2c20 746f  ordered(self, to
-00001f80: 6c3d 3165 2d36 293a 0a20 2020 2020 2020  l=1e-6):.       
-00001f90: 2022 2222 0a20 2020 2020 2020 2043 6865   """.        Che
-00001fa0: 636b 2069 6620 7468 6520 7769 7265 2773  ck if the wire's
-00001fb0: 2070 7269 6d69 7469 7665 7320 6172 6520   primitives are 
-00001fc0: 6f72 6465 7265 6420 6f72 206e 6f74 2e0a  ordered or not..
-00001fd0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00001fe0: 2020 2020 2020 666f 7220 7072 696d 6974        for primit
-00001ff0: 6976 655f 312c 2070 7269 6d69 7469 7665  ive_1, primitive
-00002000: 5f32 2069 6e20 7a69 7028 7365 6c66 2e70  _2 in zip(self.p
-00002010: 7269 6d69 7469 7665 732c 2073 656c 662e  rimitives, self.
-00002020: 7072 696d 6974 6976 6573 5b31 3a5d 293a  primitives[1:]):
-00002030: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00002040: 7072 696d 6974 6976 655f 312e 656e 642e  primitive_1.end.
-00002050: 706f 696e 745f 6469 7374 616e 6365 2870  point_distance(p
-00002060: 7269 6d69 7469 7665 5f32 2e73 7461 7274  rimitive_2.start
-00002070: 2920 3e20 746f 6c3a 0a20 2020 2020 2020  ) > tol:.       
-00002080: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00002090: 4661 6c73 650a 2020 2020 2020 2020 7265  False.        re
-000020a0: 7475 726e 2054 7275 650a 0a20 2020 2064  turn True..    d
-000020b0: 6566 206f 7264 6572 5f77 6972 6528 7365  ef order_wire(se
-000020c0: 6c66 2c20 746f 6c3d 3165 2d36 293a 0a20  lf, tol=1e-6):. 
-000020d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000020e0: 2020 204f 7264 6572 2077 6972 6527 7320     Order wire's 
-000020f0: 7072 696d 6974 6976 6573 2e0a 0a20 2020  primitives...   
-00002100: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00002110: 2020 6966 2073 656c 662e 6973 5f6f 7264    if self.is_ord
-00002120: 6572 6564 2874 6f6c 3d74 6f6c 293a 0a20  ered(tol=tol):. 
-00002130: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00002140: 6e20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  n self.__class__
-00002150: 2873 656c 662e 7072 696d 6974 6976 6573  (self.primitives
-00002160: 5b3a 5d29 0a0a 2020 2020 2020 2020 6e65  [:])..        ne
-00002170: 775f 7072 696d 6974 6976 6573 203d 205b  w_primitives = [
-00002180: 7365 6c66 2e70 7269 6d69 7469 7665 735b  self.primitives[
-00002190: 305d 5d0a 2020 2020 2020 2020 7072 696d  0]].        prim
-000021a0: 6974 6976 6573 203d 2073 656c 662e 7072  itives = self.pr
-000021b0: 696d 6974 6976 6573 5b31 3a5d 0a20 2020  imitives[1:].   
-000021c0: 2020 2020 206c 656e 6774 685f 7072 696d       length_prim
-000021d0: 6974 6976 6573 203d 206c 656e 2870 7269  itives = len(pri
-000021e0: 6d69 7469 7665 7329 202b 2031 0a0a 2020  mitives) + 1..  
-000021f0: 2020 2020 2020 7768 696c 6520 6c65 6e28        while len(
-00002200: 6e65 775f 7072 696d 6974 6976 6573 2920  new_primitives) 
-00002210: 3c20 6c65 6e67 7468 5f70 7269 6d69 7469  < length_primiti
-00002220: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
-00002230: 2066 6f72 2070 7269 6d69 7469 7665 2069   for primitive i
-00002240: 6e20 7072 696d 6974 6976 6573 3a0a 2020  n primitives:.  
-00002250: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00002260: 206e 6577 5f70 7269 6d69 7469 7665 735b   new_primitives[
-00002270: 305d 2e73 7461 7274 2e70 6f69 6e74 5f64  0].start.point_d
-00002280: 6973 7461 6e63 6528 7072 696d 6974 6976  istance(primitiv
-00002290: 652e 7374 6172 7429 203c 2074 6f6c 3a0a  e.start) < tol:.
+00001cd0: 2020 2020 2020 2020 2070 7269 6d69 7469           primiti
+00001ce0: 7665 735b 696e 645b 315d 5d2c 2069 6e73  ves[ind[1]], ins
+00001cf0: 6964 6529 0a0a 2020 2020 6465 6620 6162  ide)..    def ab
+00001d00: 7363 6973 7361 2873 656c 662c 2070 6f69  scissa(self, poi
+00001d10: 6e74 2c20 746f 6c3d 3165 2d36 293a 0a20  nt, tol=1e-6):. 
+00001d20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00001d30: 2020 2043 6f6d 7075 7465 2074 6865 2063     Compute the c
+00001d40: 7572 7669 6c69 6e65 6172 2061 6273 6369  urvilinear absci
+00001d50: 7373 6120 6f66 2061 2070 6f69 6e74 206f  ssa of a point o
+00001d60: 6e20 6120 7769 7265 2e0a 0a20 2020 2020  n a wire...     
+00001d70: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+00001d80: 6620 7365 6c66 2e70 6f69 6e74 5f6f 7665  f self.point_ove
+00001d90: 725f 7769 7265 2870 6f69 6e74 2c20 746f  r_wire(point, to
+00001da0: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+00001db0: 6c65 6e67 7468 203d 2030 0a20 2020 2020  length = 0.     
+00001dc0: 2020 2020 2020 2066 6f72 2070 7269 6d69         for primi
+00001dd0: 7469 7665 2069 6e20 7365 6c66 2e70 7269  tive in self.pri
+00001de0: 6d69 7469 7665 733a 0a20 2020 2020 2020  mitives:.       
+00001df0: 2020 2020 2020 2020 2069 6620 7072 696d           if prim
+00001e00: 6974 6976 652e 706f 696e 745f 6265 6c6f  itive.point_belo
+00001e10: 6e67 7328 706f 696e 742c 2074 6f6c 293a  ngs(point, tol):
+00001e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001e30: 2020 2020 206c 656e 6774 6820 2b3d 2070       length += p
+00001e40: 7269 6d69 7469 7665 2e61 6273 6369 7373  rimitive.absciss
+00001e50: 6128 706f 696e 7429 0a20 2020 2020 2020  a(point).       
+00001e60: 2020 2020 2020 2020 2020 2020 2062 7265               bre
+00001e70: 616b 0a20 2020 2020 2020 2020 2020 2020  ak.             
+00001e80: 2020 206c 656e 6774 6820 2b3d 2070 7269     length += pri
+00001e90: 6d69 7469 7665 2e6c 656e 6774 6828 290a  mitive.length().
+00001ea0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00001eb0: 726e 206c 656e 6774 680a 0a20 2020 2020  rn length..     
+00001ec0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00001ed0: 726f 7228 2750 6f69 6e74 2069 7320 6e6f  ror('Point is no
+00001ee0: 7420 6f6e 2077 6972 6527 290a 0a20 2020  t on wire')..   
+00001ef0: 2064 6566 2073 6f72 745f 706f 696e 7473   def sort_points
+00001f00: 5f61 6c6f 6e67 5f77 6972 6528 7365 6c66  _along_wire(self
+00001f10: 2c20 706f 696e 7473 293a 0a0a 2020 2020  , points):..    
+00001f20: 2020 2020 7265 7475 726e 2073 6f72 7465      return sorte
+00001f30: 6428 706f 696e 7473 2c20 6b65 793d 6c61  d(points, key=la
+00001f40: 6d62 6461 2070 6f69 6e74 3a20 7365 6c66  mbda point: self
+00001f50: 2e61 6273 6369 7373 6128 706f 696e 7429  .abscissa(point)
+00001f60: 290a 0a20 2020 2064 6566 2069 735f 6f72  )..    def is_or
+00001f70: 6465 7265 6428 7365 6c66 2c20 746f 6c3d  dered(self, tol=
+00001f80: 3165 2d36 293a 0a20 2020 2020 2020 2022  1e-6):.        "
+00001f90: 2222 0a20 2020 2020 2020 2043 6865 636b  "".        Check
+00001fa0: 2069 6620 7468 6520 7769 7265 2773 2070   if the wire's p
+00001fb0: 7269 6d69 7469 7665 7320 6172 6520 6f72  rimitives are or
+00001fc0: 6465 7265 6420 6f72 206e 6f74 2e0a 0a20  dered or not... 
+00001fd0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00001fe0: 2020 2020 666f 7220 7072 696d 6974 6976      for primitiv
+00001ff0: 655f 312c 2070 7269 6d69 7469 7665 5f32  e_1, primitive_2
+00002000: 2069 6e20 7a69 7028 7365 6c66 2e70 7269   in zip(self.pri
+00002010: 6d69 7469 7665 732c 2073 656c 662e 7072  mitives, self.pr
+00002020: 696d 6974 6976 6573 5b31 3a5d 293a 0a20  imitives[1:]):. 
+00002030: 2020 2020 2020 2020 2020 2069 6620 7072             if pr
+00002040: 696d 6974 6976 655f 312e 656e 642e 706f  imitive_1.end.po
+00002050: 696e 745f 6469 7374 616e 6365 2870 7269  int_distance(pri
+00002060: 6d69 7469 7665 5f32 2e73 7461 7274 2920  mitive_2.start) 
+00002070: 3e20 746f 6c3a 0a20 2020 2020 2020 2020  > tol:.         
+00002080: 2020 2020 2020 2072 6574 7572 6e20 4661         return Fa
+00002090: 6c73 650a 2020 2020 2020 2020 7265 7475  lse.        retu
+000020a0: 726e 2054 7275 650a 0a20 2020 2064 6566  rn True..    def
+000020b0: 206f 7264 6572 5f77 6972 6528 7365 6c66   order_wire(self
+000020c0: 2c20 746f 6c3d 3165 2d36 293a 0a20 2020  , tol=1e-6):.   
+000020d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000020e0: 204f 7264 6572 2077 6972 6527 7320 7072   Order wire's pr
+000020f0: 696d 6974 6976 6573 2e0a 0a20 2020 2020  imitives...     
+00002100: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00002110: 6966 2073 656c 662e 6973 5f6f 7264 6572  if self.is_order
+00002120: 6564 2874 6f6c 3d74 6f6c 293a 0a20 2020  ed(tol=tol):.   
+00002130: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00002140: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2873  self.__class__(s
+00002150: 656c 662e 7072 696d 6974 6976 6573 5b3a  elf.primitives[:
+00002160: 5d29 0a0a 2020 2020 2020 2020 6e65 775f  ])..        new_
+00002170: 7072 696d 6974 6976 6573 203d 205b 7365  primitives = [se
+00002180: 6c66 2e70 7269 6d69 7469 7665 735b 305d  lf.primitives[0]
+00002190: 5d0a 2020 2020 2020 2020 7072 696d 6974  ].        primit
+000021a0: 6976 6573 203d 2073 656c 662e 7072 696d  ives = self.prim
+000021b0: 6974 6976 6573 5b31 3a5d 0a20 2020 2020  itives[1:].     
+000021c0: 2020 206c 656e 6774 685f 7072 696d 6974     length_primit
+000021d0: 6976 6573 203d 206c 656e 2870 7269 6d69  ives = len(primi
+000021e0: 7469 7665 7329 202b 2031 0a0a 2020 2020  tives) + 1..    
+000021f0: 2020 2020 7768 696c 6520 6c65 6e28 6e65      while len(ne
+00002200: 775f 7072 696d 6974 6976 6573 2920 3c20  w_primitives) < 
+00002210: 6c65 6e67 7468 5f70 7269 6d69 7469 7665  length_primitive
+00002220: 733a 0a20 2020 2020 2020 2020 2020 2066  s:.            f
+00002230: 6f72 2070 7269 6d69 7469 7665 2069 6e20  or primitive in 
+00002240: 7072 696d 6974 6976 6573 3a0a 2020 2020  primitives:.    
+00002250: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00002260: 6577 5f70 7269 6d69 7469 7665 735b 305d  ew_primitives[0]
+00002270: 2e73 7461 7274 2e70 6f69 6e74 5f64 6973  .start.point_dis
+00002280: 7461 6e63 6528 7072 696d 6974 6976 652e  tance(primitive.
+00002290: 7374 6172 7429 203c 2074 6f6c 3a0a 2020  start) < tol:.  
 000022a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000022b0: 2020 2020 6e65 775f 7072 696d 6974 6976      new_primitiv
-000022c0: 6573 2e69 6e73 6572 7428 302c 2070 7269  es.insert(0, pri
-000022d0: 6d69 7469 7665 2e72 6576 6572 7365 2829  mitive.reverse()
-000022e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000022f0: 2020 2020 2020 7072 696d 6974 6976 6573        primitives
-00002300: 2e72 656d 6f76 6528 7072 696d 6974 6976  .remove(primitiv
-00002310: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-00002320: 2020 2065 6c69 6620 6e65 775f 7072 696d     elif new_prim
-00002330: 6974 6976 6573 5b2d 315d 2e65 6e64 2e70  itives[-1].end.p
-00002340: 6f69 6e74 5f64 6973 7461 6e63 6528 7072  oint_distance(pr
-00002350: 696d 6974 6976 652e 7374 6172 7429 203c  imitive.start) <
-00002360: 2074 6f6c 3a0a 2020 2020 2020 2020 2020   tol:.          
-00002370: 2020 2020 2020 2020 2020 6e65 775f 7072            new_pr
-00002380: 696d 6974 6976 6573 2e61 7070 656e 6428  imitives.append(
-00002390: 7072 696d 6974 6976 6529 0a20 2020 2020  primitive).     
-000023a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000023b0: 7269 6d69 7469 7665 732e 7265 6d6f 7665  rimitives.remove
-000023c0: 2870 7269 6d69 7469 7665 290a 2020 2020  (primitive).    
-000023d0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-000023e0: 206e 6577 5f70 7269 6d69 7469 7665 735b   new_primitives[
-000023f0: 305d 2e73 7461 7274 2e70 6f69 6e74 5f64  0].start.point_d
-00002400: 6973 7461 6e63 6528 7072 696d 6974 6976  istance(primitiv
-00002410: 652e 656e 6429 203c 2074 6f6c 3a0a 2020  e.end) < tol:.  
+000022b0: 2020 6e65 775f 7072 696d 6974 6976 6573    new_primitives
+000022c0: 2e69 6e73 6572 7428 302c 2070 7269 6d69  .insert(0, primi
+000022d0: 7469 7665 2e72 6576 6572 7365 2829 290a  tive.reverse()).
+000022e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000022f0: 2020 2020 7072 696d 6974 6976 6573 2e72      primitives.r
+00002300: 656d 6f76 6528 7072 696d 6974 6976 6529  emove(primitive)
+00002310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002320: 2065 6c69 6620 6e65 775f 7072 696d 6974   elif new_primit
+00002330: 6976 6573 5b2d 315d 2e65 6e64 2e70 6f69  ives[-1].end.poi
+00002340: 6e74 5f64 6973 7461 6e63 6528 7072 696d  nt_distance(prim
+00002350: 6974 6976 652e 7374 6172 7429 203c 2074  itive.start) < t
+00002360: 6f6c 3a0a 2020 2020 2020 2020 2020 2020  ol:.            
+00002370: 2020 2020 2020 2020 6e65 775f 7072 696d          new_prim
+00002380: 6974 6976 6573 2e61 7070 656e 6428 7072  itives.append(pr
+00002390: 696d 6974 6976 6529 0a20 2020 2020 2020  imitive).       
+000023a0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000023b0: 6d69 7469 7665 732e 7265 6d6f 7665 2870  mitives.remove(p
+000023c0: 7269 6d69 7469 7665 290a 2020 2020 2020  rimitive).      
+000023d0: 2020 2020 2020 2020 2020 656c 6966 206e            elif n
+000023e0: 6577 5f70 7269 6d69 7469 7665 735b 305d  ew_primitives[0]
+000023f0: 2e73 7461 7274 2e70 6f69 6e74 5f64 6973  .start.point_dis
+00002400: 7461 6e63 6528 7072 696d 6974 6976 652e  tance(primitive.
+00002410: 656e 6429 203c 2074 6f6c 3a0a 2020 2020  end) < tol:.    
 00002420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002430: 2020 6e65 775f 7072 696d 6974 6976 6573    new_primitives
-00002440: 2e69 6e73 6572 7428 302c 2070 7269 6d69  .insert(0, primi
-00002450: 7469 7665 290a 2020 2020 2020 2020 2020  tive).          
-00002460: 2020 2020 2020 2020 2020 7072 696d 6974            primit
-00002470: 6976 6573 2e72 656d 6f76 6528 7072 696d  ives.remove(prim
-00002480: 6974 6976 6529 0a20 2020 2020 2020 2020  itive).         
-00002490: 2020 2020 2020 2065 6c69 6620 6e65 775f         elif new_
-000024a0: 7072 696d 6974 6976 6573 5b2d 315d 2e65  primitives[-1].e
-000024b0: 6e64 2e70 6f69 6e74 5f64 6973 7461 6e63  nd.point_distanc
-000024c0: 6528 7072 696d 6974 6976 652e 656e 6429  e(primitive.end)
-000024d0: 203c 2074 6f6c 3a0a 2020 2020 2020 2020   < tol:.        
-000024e0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-000024f0: 7072 696d 6974 6976 6573 2e61 7070 656e  primitives.appen
-00002500: 6428 7072 696d 6974 6976 652e 7265 7665  d(primitive.reve
-00002510: 7273 6528 2929 0a20 2020 2020 2020 2020  rse()).         
-00002520: 2020 2020 2020 2020 2020 2070 7269 6d69             primi
-00002530: 7469 7665 732e 7265 6d6f 7665 2870 7269  tives.remove(pri
-00002540: 6d69 7469 7665 290a 0a20 2020 2020 2020  mitive)..       
-00002550: 2072 6574 7572 6e20 7365 6c66 2e5f 5f63   return self.__c
-00002560: 6c61 7373 5f5f 286e 6577 5f70 7269 6d69  lass__(new_primi
-00002570: 7469 7665 7329 0a0a 2020 2020 4063 6c61  tives)..    @cla
-00002580: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
-00002590: 2066 726f 6d5f 7769 7265 7328 636c 732c   from_wires(cls,
-000025a0: 2077 6972 6573 293a 0a20 2020 2020 2020   wires):.       
-000025b0: 2022 2222 0a20 2020 2020 2020 2044 6566   """.        Def
-000025c0: 696e 6520 6120 7769 7265 2066 726f 6d20  ine a wire from 
-000025d0: 7375 6363 6573 7369 7665 2077 6972 6573  successive wires
-000025e0: 2e0a 0a20 2020 2020 2020 2022 2222 0a0a  ...        """..
-000025f0: 2020 2020 2020 2020 7072 696d 6974 6976          primitiv
-00002600: 6573 203d 205b 5d0a 2020 2020 2020 2020  es = [].        
-00002610: 666f 7220 7769 7265 2069 6e20 7769 7265  for wire in wire
-00002620: 733a 0a20 2020 2020 2020 2020 2020 2070  s:.            p
-00002630: 7269 6d69 7469 7665 732e 6578 7465 6e64  rimitives.extend
-00002640: 2877 6972 652e 7072 696d 6974 6976 6573  (wire.primitives
-00002650: 290a 0a20 2020 2020 2020 2077 6972 6520  )..        wire 
-00002660: 3d20 636c 7328 7072 696d 6974 6976 6573  = cls(primitives
-00002670: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-00002680: 7420 7769 7265 2e69 735f 6f72 6465 7265  t wire.is_ordere
-00002690: 6428 293a 0a20 2020 2020 2020 2020 2020  d():.           
-000026a0: 2072 6574 7572 6e20 7769 7265 2e6f 7264   return wire.ord
-000026b0: 6572 5f77 6972 6528 290a 2020 2020 2020  er_wire().      
-000026c0: 2020 7265 7475 726e 2077 6972 650a 0a20    return wire.. 
-000026d0: 2020 2064 6566 2069 6e76 6572 7465 645f     def inverted_
-000026e0: 7072 696d 6974 6976 6573 2873 656c 6629  primitives(self)
-000026f0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00002700: 2020 2020 2020 496e 7665 7274 2077 6972        Invert wir
-00002710: 6527 7320 7072 696d 6974 6976 6573 2e0a  e's primitives..
-00002720: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00002730: 2020 2020 2020 6e65 775f 7072 696d 6974        new_primit
-00002740: 6976 6573 203d 205b 5d0a 2020 2020 2020  ives = [].      
-00002750: 2020 666f 7220 7072 696d 2069 6e20 7365    for prim in se
-00002760: 6c66 2e70 7269 6d69 7469 7665 735b 3a3a  lf.primitives[::
-00002770: 2d31 5d3a 0a20 2020 2020 2020 2020 2020  -1]:.           
-00002780: 206e 6577 5f70 7269 6d69 7469 7665 732e   new_primitives.
-00002790: 6170 7065 6e64 2870 7269 6d2e 7265 7665  append(prim.reve
-000027a0: 7273 6528 2929 0a20 2020 2020 2020 2072  rse()).        r
-000027b0: 6574 7572 6e20 6e65 775f 7072 696d 6974  eturn new_primit
-000027c0: 6976 6573 0a0a 2020 2020 6465 6620 6973  ives..    def is
-000027d0: 5f66 6f6c 6c6f 7765 645f 6279 2873 656c  _followed_by(sel
-000027e0: 662c 2077 6972 655f 322c 2074 6f6c 3d31  f, wire_2, tol=1
-000027f0: 652d 3629 3a0a 2020 2020 2020 2020 2222  e-6):.        ""
-00002800: 220a 2020 2020 2020 2020 4368 6563 6b20  ".        Check 
-00002810: 6966 2074 6865 2077 6972 6520 6973 2066  if the wire is f
-00002820: 6f6c 6c6f 7765 6420 6279 2077 6972 655f  ollowed by wire_
-00002830: 322e 0a0a 2020 2020 2020 2020 2222 220a  2...        """.
-00002840: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00002850: 656c 662e 7072 696d 6974 6976 6573 5b2d  elf.primitives[-
-00002860: 315d 2e65 6e64 2e70 6f69 6e74 5f64 6973  1].end.point_dis
-00002870: 7461 6e63 6528 7769 7265 5f32 2e70 7269  tance(wire_2.pri
-00002880: 6d69 7469 7665 735b 305d 2e73 7461 7274  mitives[0].start
-00002890: 2920 3c20 746f 6c0a 0a20 2020 2064 6566  ) < tol..    def
-000028a0: 2070 6f69 6e74 5f6f 7665 725f 7769 7265   point_over_wire
-000028b0: 2873 656c 662c 2070 6f69 6e74 2c20 6162  (self, point, ab
-000028c0: 735f 746f 6c3d 3165 2d36 293a 0a0a 2020  s_tol=1e-6):..  
-000028d0: 2020 2020 2020 6265 6c6f 6e67 7320 3d20        belongs = 
-000028e0: 4661 6c73 650a 2020 2020 2020 2020 666f  False.        fo
-000028f0: 7220 7072 696d 6974 6976 6520 696e 2073  r primitive in s
-00002900: 656c 662e 7072 696d 6974 6976 6573 3a0a  elf.primitives:.
-00002910: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-00002920: 7269 6d69 7469 7665 2e70 6f69 6e74 5f62  rimitive.point_b
-00002930: 656c 6f6e 6773 2870 6f69 6e74 2c20 6162  elongs(point, ab
-00002940: 735f 746f 6c29 3a0a 2020 2020 2020 2020  s_tol):.        
-00002950: 2020 2020 2020 2020 6265 6c6f 6e67 7320          belongs 
-00002960: 3d20 5472 7565 0a20 2020 2020 2020 2072  = True.        r
-00002970: 6574 7572 6e20 6265 6c6f 6e67 730a 0a20  eturn belongs.. 
-00002980: 2020 2064 6566 2070 7269 6d69 7469 7665     def primitive
-00002990: 5f6f 7665 725f 7769 7265 2873 656c 662c  _over_wire(self,
-000029a0: 2070 7269 6d69 7469 7665 2c20 746f 6c3a   primitive, tol:
-000029b0: 2066 6c6f 6174 203d 2031 652d 3629 3a0a   float = 1e-6):.
-000029c0: 2020 2020 2020 2020 706f 696e 7473 203d          points =
-000029d0: 2070 7269 6d69 7469 7665 2e64 6973 6372   primitive.discr
-000029e0: 6574 697a 6174 696f 6e5f 706f 696e 7473  etization_points
-000029f0: 286e 756d 6265 725f 706f 696e 7473 3d31  (number_points=1
-00002a00: 3029 0a20 2020 2020 2020 2069 6620 616c  0).        if al
-00002a10: 6c28 7365 6c66 2e70 6f69 6e74 5f6f 7665  l(self.point_ove
-00002a20: 725f 636f 6e74 6f75 7228 706f 696e 742c  r_contour(point,
-00002a30: 2074 6f6c 2920 666f 7220 706f 696e 7420   tol) for point 
-00002a40: 696e 2070 6f69 6e74 7329 3a0a 2020 2020  in points):.    
-00002a50: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-00002a60: 7275 650a 2020 2020 2020 2020 7265 7475  rue.        retu
-00002a70: 726e 2046 616c 7365 0a0a 2020 2020 4063  rn False..    @c
-00002a80: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
-00002a90: 6566 2066 726f 6d5f 706f 696e 7473 2863  ef from_points(c
-00002aa0: 6c73 2c20 706f 696e 7473 293a 0a20 2020  ls, points):.   
-00002ab0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00002ac0: 2043 7265 6174 6520 6120 636f 6e74 6f75   Create a contou
-00002ad0: 7220 6672 6f6d 2070 6f69 6e74 7320 7769  r from points wi
-00002ae0: 7468 206c 696e 655f 7365 676d 656e 7473  th line_segments
-00002af0: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-00002b00: 2020 2020 2020 206c 696e 6573 6567 6d65         linesegme
-00002b10: 6e74 5f6e 616d 6520 3d20 274c 696e 6553  nt_name = 'LineS
-00002b20: 6567 6d65 6e74 2720 2b20 706f 696e 7473  egment' + points
-00002b30: 5b30 5d2e 5f5f 636c 6173 735f 5f2e 5f5f  [0].__class__.__
-00002b40: 6e61 6d65 5f5f 5b2d 323a 5d0a 2020 2020  name__[-2:].    
-00002b50: 2020 2020 6564 6765 7320 3d20 5b5d 0a20      edges = []. 
-00002b60: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00002b70: 7261 6e67 6528 302c 206c 656e 2870 6f69  range(0, len(poi
-00002b80: 6e74 7329 202d 2031 293a 0a20 2020 2020  nts) - 1):.     
-00002b90: 2020 2020 2020 2065 6467 6573 2e61 7070         edges.app
-00002ba0: 656e 6428 6765 7461 7474 7228 766f 6c6d  end(getattr(volm
-00002bb0: 646c 722e 6564 6765 732c 206c 696e 6573  dlr.edges, lines
-00002bc0: 6567 6d65 6e74 5f6e 616d 6529 2870 6f69  egment_name)(poi
-00002bd0: 6e74 735b 695d 2c20 706f 696e 7473 5b69  nts[i], points[i
-00002be0: 202b 2031 5d29 290a 2020 2020 2020 2020   + 1])).        
-00002bf0: 636f 6e74 6f75 7220 3d20 636c 7328 6564  contour = cls(ed
-00002c00: 6765 7329 0a20 2020 2020 2020 2072 6574  ges).        ret
-00002c10: 7572 6e20 636f 6e74 6f75 720a 0a0a 636c  urn contour...cl
-00002c20: 6173 7320 4564 6765 436f 6c6c 6563 7469  ass EdgeCollecti
-00002c30: 6f6e 3344 2857 6972 654d 6978 696e 293a  on3D(WireMixin):
-00002c40: 0a20 2020 2022 2222 0a20 2020 2041 2063  .    """.    A c
-00002c50: 6f6c 6c65 6374 696f 6e20 6f66 2073 696d  ollection of sim
-00002c60: 706c 6520 6564 6765 7320 3344 2e0a 2020  ple edges 3D..  
-00002c70: 2020 2222 220a 2020 2020 5f73 7461 6e64    """.    _stand
-00002c80: 616c 6f6e 655f 696e 5f64 6220 3d20 5472  alone_in_db = Tr
-00002c90: 7565 0a20 2020 205f 6571 5f69 735f 6461  ue.    _eq_is_da
-00002ca0: 7461 5f65 7120 3d20 5472 7565 0a20 2020  ta_eq = True.   
-00002cb0: 205f 6e6f 6e5f 7365 7269 616c 697a 6162   _non_serializab
-00002cc0: 6c65 5f61 7474 7269 6275 7465 7320 3d20  le_attributes = 
-00002cd0: 5b27 6261 7369 735f 7072 696d 6974 6976  ['basis_primitiv
-00002ce0: 6573 275d 0a20 2020 205f 6e6f 6e5f 6461  es'].    _non_da
-00002cf0: 7461 5f65 715f 6174 7472 6962 7574 6573  ta_eq_attributes
-00002d00: 203d 205b 276e 616d 6527 2c20 2762 6173   = ['name', 'bas
-00002d10: 6973 5f70 7269 6d69 7469 7665 7327 5d0a  is_primitives'].
-00002d20: 2020 2020 5f6e 6f6e 5f64 6174 615f 6861      _non_data_ha
-00002d30: 7368 5f61 7474 7269 6275 7465 7320 3d20  sh_attributes = 
-00002d40: 5b5d 0a0a 2020 2020 6465 6620 5f5f 696e  []..    def __in
-00002d50: 6974 5f5f 2873 656c 662c 2070 7269 6d69  it__(self, primi
-00002d60: 7469 7665 733a 204c 6973 745b 766f 6c6d  tives: List[volm
-00002d70: 646c 722e 6564 6765 732e 4564 6765 5d2c  dlr.edges.Edge],
-00002d80: 2063 6f6c 6f72 3d4e 6f6e 652c 2061 6c70   color=None, alp
-00002d90: 6861 3d31 2c20 6e61 6d65 3a20 7374 7220  ha=1, name: str 
-00002da0: 3d20 2727 293a 0a20 2020 2020 2020 2073  = ''):.        s
-00002db0: 656c 662e 7072 696d 6974 6976 6573 203d  elf.primitives =
-00002dc0: 2070 7269 6d69 7469 7665 730a 2020 2020   primitives.    
-00002dd0: 2020 2020 7365 6c66 2e63 6f6c 6f72 203d      self.color =
-00002de0: 2063 6f6c 6f72 0a20 2020 2020 2020 2073   color.        s
-00002df0: 656c 662e 616c 7068 6120 3d20 616c 7068  elf.alpha = alph
-00002e00: 610a 2020 2020 2020 2020 7365 6c66 2e5f  a.        self._
-00002e10: 6262 6f78 203d 204e 6f6e 650a 2020 2020  bbox = None.    
-00002e20: 2020 2020 7365 6c66 2e6e 616d 6520 3d20      self.name = 
-00002e30: 6e61 6d65 0a0a 2020 2020 6465 6620 706c  name..    def pl
-00002e40: 6f74 2873 656c 662c 2061 783d 4e6f 6e65  ot(self, ax=None
-00002e50: 2c20 636f 6c6f 723d 276b 272c 2061 6c70  , color='k', alp
-00002e60: 6861 3d31 2c20 6564 6765 5f64 6574 6169  ha=1, edge_detai
-00002e70: 6c73 3d46 616c 7365 293a 0a20 2020 2020  ls=False):.     
-00002e80: 2020 2022 2222 2050 6c6f 7420 6564 6765     """ Plot edge
-00002e90: 7320 7769 7468 206d 6174 706c 6f6c 6962  s with matplolib
-00002ea0: 2c20 6e6f 7420 7465 7374 6564 2e20 2222  , not tested. ""
-00002eb0: 220a 2020 2020 2020 2020 6966 2061 7820  ".        if ax 
-00002ec0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00002ed0: 2020 2020 2066 6967 203d 2070 6c74 2e66       fig = plt.f
-00002ee0: 6967 7572 6528 290a 2020 2020 2020 2020  igure().        
-00002ef0: 2020 2020 6178 203d 2066 6967 2e61 6464      ax = fig.add
-00002f00: 5f73 7562 706c 6f74 2831 3131 2c20 7072  _subplot(111, pr
-00002f10: 6f6a 6563 7469 6f6e 3d27 3364 2729 0a20  ojection='3d'). 
-00002f20: 2020 2020 2020 2066 6f72 2070 7269 6d69         for primi
-00002f30: 7469 7665 2069 6e20 7365 6c66 2e70 7269  tive in self.pri
-00002f40: 6d69 7469 7665 733a 0a20 2020 2020 2020  mitives:.       
-00002f50: 2020 2020 2070 7269 6d69 7469 7665 2e70       primitive.p
-00002f60: 6c6f 7428 6178 3d61 782c 2063 6f6c 6f72  lot(ax=ax, color
-00002f70: 3d63 6f6c 6f72 2c20 616c 7068 613d 616c  =color, alpha=al
-00002f80: 7068 6129 0a20 2020 2020 2020 2072 6574  pha).        ret
-00002f90: 7572 6e20 6178 0a0a 2020 2020 6465 6620  urn ax..    def 
-00002fa0: 5f62 6f75 6e64 696e 675f 626f 7828 7365  _bounding_box(se
-00002fb0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00002fc0: 2046 6c61 7765 6420 6d65 7468 6f64 2c20   Flawed method, 
-00002fd0: 746f 2062 6520 656e 666f 7263 6564 2062  to be enforced b
-00002fe0: 7920 6f76 6572 6c6f 6164 696e 672e 2022  y overloading. "
-00002ff0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00003000: 6e20 766f 6c6d 646c 722e 636f 7265 2e42  n volmdlr.core.B
-00003010: 6f75 6e64 696e 6742 6f78 2e66 726f 6d5f  oundingBox.from_
-00003020: 706f 696e 7473 2873 656c 662e 706f 696e  points(self.poin
-00003030: 7473 2829 290a 0a20 2020 2040 7072 6f70  ts())..    @prop
-00003040: 6572 7479 0a20 2020 2064 6566 2062 6f75  erty.    def bou
-00003050: 6e64 696e 675f 626f 7828 7365 6c66 293a  nding_box(self):
-00003060: 0a20 2020 2020 2020 2022 2222 2047 6574  .        """ Get
-00003070: 2062 6967 2062 6f75 6e64 696e 6720 626f   big bounding bo
-00003080: 7820 6f66 2061 6c6c 2065 6467 6573 2e20  x of all edges. 
-00003090: 2222 220a 2020 2020 2020 2020 6966 206e  """.        if n
-000030a0: 6f74 2073 656c 662e 5f62 626f 783a 0a20  ot self._bbox:. 
-000030b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000030c0: 5f62 626f 7820 3d20 7365 6c66 2e5f 626f  _bbox = self._bo
-000030d0: 756e 6469 6e67 5f62 6f78 2829 0a20 2020  unding_box().   
-000030e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000030f0: 2e5f 6262 6f78 0a0a 2020 2020 6465 6620  ._bbox..    def 
-00003100: 706f 696e 7473 2873 656c 6629 3a0a 2020  points(self):.  
-00003110: 2020 2020 2020 2222 2220 4765 7420 6c69        """ Get li
-00003120: 7374 206f 6620 616c 6c20 706f 696e 7473  st of all points
-00003130: 2e20 2222 220a 2020 2020 2020 2020 706f  . """.        po
-00003140: 696e 7473 203d 205b 5d0a 2020 2020 2020  ints = [].      
-00003150: 2020 666f 7220 7072 696d 2069 6e20 7365    for prim in se
-00003160: 6c66 2e70 7269 6d69 7469 7665 733a 0a20  lf.primitives:. 
-00003170: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-00003180: 7320 2b3d 205b 7072 696d 2e73 7461 7274  s += [prim.start
-00003190: 2c20 7072 696d 2e65 6e64 5d0a 2020 2020  , prim.end].    
-000031a0: 2020 2020 7265 7475 726e 2070 6f69 6e74      return point
-000031b0: 730a 0a20 2020 2064 6566 2062 6162 796c  s..    def babyl
-000031c0: 6f6e 5f70 6172 616d 2873 656c 6629 3a0a  on_param(self):.
-000031d0: 2020 2020 2020 2020 2222 2220 4765 7420          """ Get 
-000031e0: 6469 6374 2066 6f72 2062 6162 796c 6f6e  dict for babylon
-000031f0: 6a73 206f 626a 6563 7420 7365 7474 696e  js object settin
-00003200: 6773 2e20 2222 220a 2020 2020 2020 2020  gs. """.        
-00003210: 6261 6279 6c6f 6e5f 7061 7261 6d20 3d20  babylon_param = 
-00003220: 7b27 616c 7068 6127 3a20 7365 6c66 2e61  {'alpha': self.a
-00003230: 6c70 6861 2c0a 2020 2020 2020 2020 2020  lpha,.          
-00003240: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00003250: 6e61 6d65 273a 2073 656c 662e 6e61 6d65  name': self.name
-00003260: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00003270: 2020 2020 2020 2020 2020 2027 636f 6c6f             'colo
-00003280: 7227 3a20 5b30 2c20 302c 2030 2e36 5d7d  r': [0, 0, 0.6]}
-00003290: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-000032a0: 2e63 6f6c 6f72 2069 7320 4e6f 6e65 3a0a  .color is None:.
-000032b0: 2020 2020 2020 2020 2020 2020 6261 6279              baby
-000032c0: 6c6f 6e5f 7061 7261 6d5b 2765 6467 6573  lon_param['edges
-000032d0: 5f63 6f6c 6f72 275d 203d 205b 302c 2030  _color'] = [0, 0
-000032e0: 2c20 302e 365d 0a20 2020 2020 2020 2065  , 0.6].        e
-000032f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00003300: 2062 6162 796c 6f6e 5f70 6172 616d 5b27   babylon_param['
-00003310: 6564 6765 735f 636f 6c6f 7227 5d20 3d20  edges_color'] = 
-00003320: 6c69 7374 2873 656c 662e 636f 6c6f 7229  list(self.color)
-00003330: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00003340: 6261 6279 6c6f 6e5f 7061 7261 6d0a 0a20  babylon_param.. 
-00003350: 2020 2064 6566 2062 6162 796c 6f6e 5f70     def babylon_p
-00003360: 6f69 6e74 7328 7365 6c66 293a 0a20 2020  oints(self):.   
-00003370: 2020 2020 2022 2222 2047 6574 206c 6973       """ Get lis
-00003380: 7420 6f66 2070 6f69 6e74 7320 636f 6f72  t of points coor
-00003390: 6469 6e61 7465 732e 2022 2222 0a20 2020  dinates. """.   
-000033a0: 2020 2020 2072 6574 7572 6e20 5b5b 702e       return [[p.
-000033b0: 782c 2070 2e79 2c20 702e 7a5d 2066 6f72  x, p.y, p.z] for
-000033c0: 2070 2069 6e20 7365 6c66 2e70 6f69 6e74   p in self.point
-000033d0: 7328 295d 0a0a 2020 2020 6465 6620 746f  s()]..    def to
-000033e0: 5f62 6162 796c 6f6e 2873 656c 6629 3a0a  _babylon(self):.
-000033f0: 2020 2020 2020 2020 2222 2220 4765 6e65          """ Gene
-00003400: 7261 7465 2061 206d 6573 6820 6672 6f6d  rate a mesh from
-00003410: 2061 6c6c 2065 6467 6573 2066 6f72 2070   all edges for p
-00003420: 6572 666f 726d 616e 6365 2077 6865 6e20  erformance when 
-00003430: 6472 6177 696e 672e 2022 2222 0a20 2020  drawing. """.   
-00003440: 2020 2020 2070 6f73 6974 696f 6e73 203d       positions =
-00003450: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
-00003460: 7072 696d 2069 6e20 7365 6c66 2e70 7269  prim in self.pri
-00003470: 6d69 7469 7665 733a 0a20 2020 2020 2020  mitives:.       
-00003480: 2020 2020 2070 6f73 6974 696f 6e73 202b       positions +
-00003490: 3d20 5b70 7269 6d2e 7374 6172 742e 782c  = [prim.start.x,
-000034a0: 2070 7269 6d2e 7374 6172 742e 792c 2070   prim.start.y, p
-000034b0: 7269 6d2e 7374 6172 742e 7a2c 0a20 2020  rim.start.z,.   
+00002430: 6e65 775f 7072 696d 6974 6976 6573 2e69  new_primitives.i
+00002440: 6e73 6572 7428 302c 2070 7269 6d69 7469  nsert(0, primiti
+00002450: 7665 290a 2020 2020 2020 2020 2020 2020  ve).            
+00002460: 2020 2020 2020 2020 7072 696d 6974 6976          primitiv
+00002470: 6573 2e72 656d 6f76 6528 7072 696d 6974  es.remove(primit
+00002480: 6976 6529 0a20 2020 2020 2020 2020 2020  ive).           
+00002490: 2020 2020 2065 6c69 6620 6e65 775f 7072       elif new_pr
+000024a0: 696d 6974 6976 6573 5b2d 315d 2e65 6e64  imitives[-1].end
+000024b0: 2e70 6f69 6e74 5f64 6973 7461 6e63 6528  .point_distance(
+000024c0: 7072 696d 6974 6976 652e 656e 6429 203c  primitive.end) <
+000024d0: 2074 6f6c 3a0a 2020 2020 2020 2020 2020   tol:.          
+000024e0: 2020 2020 2020 2020 2020 6e65 775f 7072            new_pr
+000024f0: 696d 6974 6976 6573 2e61 7070 656e 6428  imitives.append(
+00002500: 7072 696d 6974 6976 652e 7265 7665 7273  primitive.revers
+00002510: 6528 2929 0a20 2020 2020 2020 2020 2020  e()).           
+00002520: 2020 2020 2020 2020 2070 7269 6d69 7469           primiti
+00002530: 7665 732e 7265 6d6f 7665 2870 7269 6d69  ves.remove(primi
+00002540: 7469 7665 290a 0a20 2020 2020 2020 2072  tive)..        r
+00002550: 6574 7572 6e20 7365 6c66 2e5f 5f63 6c61  eturn self.__cla
+00002560: 7373 5f5f 286e 6577 5f70 7269 6d69 7469  ss__(new_primiti
+00002570: 7665 7329 0a0a 2020 2020 4063 6c61 7373  ves)..    @class
+00002580: 6d65 7468 6f64 0a20 2020 2064 6566 2066  method.    def f
+00002590: 726f 6d5f 7769 7265 7328 636c 732c 2077  rom_wires(cls, w
+000025a0: 6972 6573 293a 0a20 2020 2020 2020 2022  ires):.        "
+000025b0: 2222 0a20 2020 2020 2020 2044 6566 696e  "".        Defin
+000025c0: 6520 6120 7769 7265 2066 726f 6d20 7375  e a wire from su
+000025d0: 6363 6573 7369 7665 2077 6972 6573 2e0a  ccessive wires..
+000025e0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+000025f0: 2020 2020 2020 7072 696d 6974 6976 6573        primitives
+00002600: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
+00002610: 7220 7769 7265 2069 6e20 7769 7265 733a  r wire in wires:
+00002620: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00002630: 6d69 7469 7665 732e 6578 7465 6e64 2877  mitives.extend(w
+00002640: 6972 652e 7072 696d 6974 6976 6573 290a  ire.primitives).
+00002650: 0a20 2020 2020 2020 2077 6972 6520 3d20  .        wire = 
+00002660: 636c 7328 7072 696d 6974 6976 6573 290a  cls(primitives).
+00002670: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00002680: 7769 7265 2e69 735f 6f72 6465 7265 6428  wire.is_ordered(
+00002690: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+000026a0: 6574 7572 6e20 7769 7265 2e6f 7264 6572  eturn wire.order
+000026b0: 5f77 6972 6528 290a 2020 2020 2020 2020  _wire().        
+000026c0: 7265 7475 726e 2077 6972 650a 0a20 2020  return wire..   
+000026d0: 2064 6566 2069 6e76 6572 7465 645f 7072   def inverted_pr
+000026e0: 696d 6974 6976 6573 2873 656c 6629 3a0a  imitives(self):.
+000026f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00002700: 2020 2020 496e 7665 7274 2077 6972 6527      Invert wire'
+00002710: 7320 7072 696d 6974 6976 6573 2e0a 0a20  s primitives... 
+00002720: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00002730: 2020 2020 6e65 775f 7072 696d 6974 6976      new_primitiv
+00002740: 6573 203d 205b 5d0a 2020 2020 2020 2020  es = [].        
+00002750: 666f 7220 7072 696d 2069 6e20 7365 6c66  for prim in self
+00002760: 2e70 7269 6d69 7469 7665 735b 3a3a 2d31  .primitives[::-1
+00002770: 5d3a 0a20 2020 2020 2020 2020 2020 206e  ]:.            n
+00002780: 6577 5f70 7269 6d69 7469 7665 732e 6170  ew_primitives.ap
+00002790: 7065 6e64 2870 7269 6d2e 7265 7665 7273  pend(prim.revers
+000027a0: 6528 2929 0a20 2020 2020 2020 2072 6574  e()).        ret
+000027b0: 7572 6e20 6e65 775f 7072 696d 6974 6976  urn new_primitiv
+000027c0: 6573 0a0a 2020 2020 6465 6620 6973 5f66  es..    def is_f
+000027d0: 6f6c 6c6f 7765 645f 6279 2873 656c 662c  ollowed_by(self,
+000027e0: 2077 6972 655f 322c 2074 6f6c 3d31 652d   wire_2, tol=1e-
+000027f0: 3629 3a0a 2020 2020 2020 2020 2222 220a  6):.        """.
+00002800: 2020 2020 2020 2020 4368 6563 6b20 6966          Check if
+00002810: 2074 6865 2077 6972 6520 6973 2066 6f6c   the wire is fol
+00002820: 6c6f 7765 6420 6279 2077 6972 655f 322e  lowed by wire_2.
+00002830: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00002840: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00002850: 662e 7072 696d 6974 6976 6573 5b2d 315d  f.primitives[-1]
+00002860: 2e65 6e64 2e70 6f69 6e74 5f64 6973 7461  .end.point_dista
+00002870: 6e63 6528 7769 7265 5f32 2e70 7269 6d69  nce(wire_2.primi
+00002880: 7469 7665 735b 305d 2e73 7461 7274 2920  tives[0].start) 
+00002890: 3c20 746f 6c0a 0a20 2020 2064 6566 2070  < tol..    def p
+000028a0: 6f69 6e74 5f6f 7665 725f 7769 7265 2873  oint_over_wire(s
+000028b0: 656c 662c 2070 6f69 6e74 2c20 6162 735f  elf, point, abs_
+000028c0: 746f 6c3d 3165 2d36 293a 0a0a 2020 2020  tol=1e-6):..    
+000028d0: 2020 2020 6265 6c6f 6e67 7320 3d20 4661      belongs = Fa
+000028e0: 6c73 650a 2020 2020 2020 2020 666f 7220  lse.        for 
+000028f0: 7072 696d 6974 6976 6520 696e 2073 656c  primitive in sel
+00002900: 662e 7072 696d 6974 6976 6573 3a0a 2020  f.primitives:.  
+00002910: 2020 2020 2020 2020 2020 6966 2070 7269            if pri
+00002920: 6d69 7469 7665 2e70 6f69 6e74 5f62 656c  mitive.point_bel
+00002930: 6f6e 6773 2870 6f69 6e74 2c20 6162 735f  ongs(point, abs_
+00002940: 746f 6c29 3a0a 2020 2020 2020 2020 2020  tol):.          
+00002950: 2020 2020 2020 6265 6c6f 6e67 7320 3d20        belongs = 
+00002960: 5472 7565 0a20 2020 2020 2020 2072 6574  True.        ret
+00002970: 7572 6e20 6265 6c6f 6e67 730a 0a20 2020  urn belongs..   
+00002980: 2064 6566 2070 7269 6d69 7469 7665 5f6f   def primitive_o
+00002990: 7665 725f 7769 7265 2873 656c 662c 2070  ver_wire(self, p
+000029a0: 7269 6d69 7469 7665 2c20 746f 6c3a 2066  rimitive, tol: f
+000029b0: 6c6f 6174 203d 2031 652d 3629 3a0a 2020  loat = 1e-6):.  
+000029c0: 2020 2020 2020 706f 696e 7473 203d 2070        points = p
+000029d0: 7269 6d69 7469 7665 2e64 6973 6372 6574  rimitive.discret
+000029e0: 697a 6174 696f 6e5f 706f 696e 7473 286e  ization_points(n
+000029f0: 756d 6265 725f 706f 696e 7473 3d31 3029  umber_points=10)
+00002a00: 0a20 2020 2020 2020 2069 6620 616c 6c28  .        if all(
+00002a10: 7365 6c66 2e70 6f69 6e74 5f6f 7665 725f  self.point_over_
+00002a20: 636f 6e74 6f75 7228 706f 696e 742c 2074  contour(point, t
+00002a30: 6f6c 2920 666f 7220 706f 696e 7420 696e  ol) for point in
+00002a40: 2070 6f69 6e74 7329 3a0a 2020 2020 2020   points):.      
+00002a50: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+00002a60: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
+00002a70: 2046 616c 7365 0a0a 2020 2020 4063 6c61   False..    @cla
+00002a80: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+00002a90: 2066 726f 6d5f 706f 696e 7473 2863 6c73   from_points(cls
+00002aa0: 2c20 706f 696e 7473 293a 0a20 2020 2020  , points):.     
+00002ab0: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+00002ac0: 7265 6174 6520 6120 636f 6e74 6f75 7220  reate a contour 
+00002ad0: 6672 6f6d 2070 6f69 6e74 7320 7769 7468  from points with
+00002ae0: 206c 696e 655f 7365 676d 656e 7473 2e0a   line_segments..
+00002af0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00002b00: 2020 2020 206c 696e 6573 6567 6d65 6e74       linesegment
+00002b10: 5f6e 616d 6520 3d20 274c 696e 6553 6567  _name = 'LineSeg
+00002b20: 6d65 6e74 2720 2b20 706f 696e 7473 5b30  ment' + points[0
+00002b30: 5d2e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  ].__class__.__na
+00002b40: 6d65 5f5f 5b2d 323a 5d0a 2020 2020 2020  me__[-2:].      
+00002b50: 2020 6564 6765 7320 3d20 5b5d 0a20 2020    edges = [].   
+00002b60: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00002b70: 6e67 6528 302c 206c 656e 2870 6f69 6e74  nge(0, len(point
+00002b80: 7329 202d 2031 293a 0a20 2020 2020 2020  s) - 1):.       
+00002b90: 2020 2020 2065 6467 6573 2e61 7070 656e       edges.appen
+00002ba0: 6428 6765 7461 7474 7228 766f 6c6d 646c  d(getattr(volmdl
+00002bb0: 722e 6564 6765 732c 206c 696e 6573 6567  r.edges, lineseg
+00002bc0: 6d65 6e74 5f6e 616d 6529 2870 6f69 6e74  ment_name)(point
+00002bd0: 735b 695d 2c20 706f 696e 7473 5b69 202b  s[i], points[i +
+00002be0: 2031 5d29 290a 2020 2020 2020 2020 636f   1])).        co
+00002bf0: 6e74 6f75 7220 3d20 636c 7328 6564 6765  ntour = cls(edge
+00002c00: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
+00002c10: 6e20 636f 6e74 6f75 720a 0a0a 636c 6173  n contour...clas
+00002c20: 7320 4564 6765 436f 6c6c 6563 7469 6f6e  s EdgeCollection
+00002c30: 3344 2857 6972 654d 6978 696e 293a 0a20  3D(WireMixin):. 
+00002c40: 2020 2022 2222 0a20 2020 2041 2063 6f6c     """.    A col
+00002c50: 6c65 6374 696f 6e20 6f66 2073 696d 706c  lection of simpl
+00002c60: 6520 6564 6765 7320 3344 2e0a 2020 2020  e edges 3D..    
+00002c70: 2222 220a 2020 2020 5f73 7461 6e64 616c  """.    _standal
+00002c80: 6f6e 655f 696e 5f64 6220 3d20 5472 7565  one_in_db = True
+00002c90: 0a20 2020 205f 6571 5f69 735f 6461 7461  .    _eq_is_data
+00002ca0: 5f65 7120 3d20 5472 7565 0a20 2020 205f  _eq = True.    _
+00002cb0: 6e6f 6e5f 7365 7269 616c 697a 6162 6c65  non_serializable
+00002cc0: 5f61 7474 7269 6275 7465 7320 3d20 5b27  _attributes = ['
+00002cd0: 6261 7369 735f 7072 696d 6974 6976 6573  basis_primitives
+00002ce0: 275d 0a20 2020 205f 6e6f 6e5f 6461 7461  '].    _non_data
+00002cf0: 5f65 715f 6174 7472 6962 7574 6573 203d  _eq_attributes =
+00002d00: 205b 276e 616d 6527 2c20 2762 6173 6973   ['name', 'basis
+00002d10: 5f70 7269 6d69 7469 7665 7327 5d0a 2020  _primitives'].  
+00002d20: 2020 5f6e 6f6e 5f64 6174 615f 6861 7368    _non_data_hash
+00002d30: 5f61 7474 7269 6275 7465 7320 3d20 5b5d  _attributes = []
+00002d40: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+00002d50: 5f5f 2873 656c 662c 2070 7269 6d69 7469  __(self, primiti
+00002d60: 7665 733a 204c 6973 745b 766f 6c6d 646c  ves: List[volmdl
+00002d70: 722e 6564 6765 732e 4564 6765 5d2c 2063  r.edges.Edge], c
+00002d80: 6f6c 6f72 3d4e 6f6e 652c 2061 6c70 6861  olor=None, alpha
+00002d90: 3d31 2c20 6e61 6d65 3a20 7374 7220 3d20  =1, name: str = 
+00002da0: 2727 293a 0a20 2020 2020 2020 2073 656c  ''):.        sel
+00002db0: 662e 7072 696d 6974 6976 6573 203d 2070  f.primitives = p
+00002dc0: 7269 6d69 7469 7665 730a 2020 2020 2020  rimitives.      
+00002dd0: 2020 7365 6c66 2e63 6f6c 6f72 203d 2063    self.color = c
+00002de0: 6f6c 6f72 0a20 2020 2020 2020 2073 656c  olor.        sel
+00002df0: 662e 616c 7068 6120 3d20 616c 7068 610a  f.alpha = alpha.
+00002e00: 2020 2020 2020 2020 7365 6c66 2e5f 6262          self._bb
+00002e10: 6f78 203d 204e 6f6e 650a 2020 2020 2020  ox = None.      
+00002e20: 2020 7365 6c66 2e6e 616d 6520 3d20 6e61    self.name = na
+00002e30: 6d65 0a0a 2020 2020 6465 6620 706c 6f74  me..    def plot
+00002e40: 2873 656c 662c 2061 783d 4e6f 6e65 2c20  (self, ax=None, 
+00002e50: 636f 6c6f 723d 276b 272c 2061 6c70 6861  color='k', alpha
+00002e60: 3d31 2c20 6564 6765 5f64 6574 6169 6c73  =1, edge_details
+00002e70: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
+00002e80: 2022 2222 2050 6c6f 7420 6564 6765 7320   """ Plot edges 
+00002e90: 7769 7468 206d 6174 706c 6f6c 6962 2c20  with matplolib, 
+00002ea0: 6e6f 7420 7465 7374 6564 2e20 2222 220a  not tested. """.
+00002eb0: 2020 2020 2020 2020 6966 2061 7820 6973          if ax is
+00002ec0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00002ed0: 2020 2066 6967 203d 2070 6c74 2e66 6967     fig = plt.fig
+00002ee0: 7572 6528 290a 2020 2020 2020 2020 2020  ure().          
+00002ef0: 2020 6178 203d 2066 6967 2e61 6464 5f73    ax = fig.add_s
+00002f00: 7562 706c 6f74 2831 3131 2c20 7072 6f6a  ubplot(111, proj
+00002f10: 6563 7469 6f6e 3d27 3364 2729 0a20 2020  ection='3d').   
+00002f20: 2020 2020 2066 6f72 2070 7269 6d69 7469       for primiti
+00002f30: 7665 2069 6e20 7365 6c66 2e70 7269 6d69  ve in self.primi
+00002f40: 7469 7665 733a 0a20 2020 2020 2020 2020  tives:.         
+00002f50: 2020 2070 7269 6d69 7469 7665 2e70 6c6f     primitive.plo
+00002f60: 7428 6178 3d61 782c 2063 6f6c 6f72 3d63  t(ax=ax, color=c
+00002f70: 6f6c 6f72 2c20 616c 7068 613d 616c 7068  olor, alpha=alph
+00002f80: 6129 0a20 2020 2020 2020 2072 6574 7572  a).        retur
+00002f90: 6e20 6178 0a0a 2020 2020 6465 6620 5f62  n ax..    def _b
+00002fa0: 6f75 6e64 696e 675f 626f 7828 7365 6c66  ounding_box(self
+00002fb0: 293a 0a20 2020 2020 2020 2022 2222 2046  ):.        """ F
+00002fc0: 6c61 7765 6420 6d65 7468 6f64 2c20 746f  lawed method, to
+00002fd0: 2062 6520 656e 666f 7263 6564 2062 7920   be enforced by 
+00002fe0: 6f76 6572 6c6f 6164 696e 672e 2022 2222  overloading. """
+00002ff0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00003000: 766f 6c6d 646c 722e 636f 7265 2e42 6f75  volmdlr.core.Bou
+00003010: 6e64 696e 6742 6f78 2e66 726f 6d5f 706f  ndingBox.from_po
+00003020: 696e 7473 2873 656c 662e 706f 696e 7473  ints(self.points
+00003030: 2829 290a 0a20 2020 2040 7072 6f70 6572  ())..    @proper
+00003040: 7479 0a20 2020 2064 6566 2062 6f75 6e64  ty.    def bound
+00003050: 696e 675f 626f 7828 7365 6c66 293a 0a20  ing_box(self):. 
+00003060: 2020 2020 2020 2022 2222 2047 6574 2062         """ Get b
+00003070: 6967 2062 6f75 6e64 696e 6720 626f 7820  ig bounding box 
+00003080: 6f66 2061 6c6c 2065 6467 6573 2e20 2222  of all edges. ""
+00003090: 220a 2020 2020 2020 2020 6966 206e 6f74  ".        if not
+000030a0: 2073 656c 662e 5f62 626f 783a 0a20 2020   self._bbox:.   
+000030b0: 2020 2020 2020 2020 2073 656c 662e 5f62           self._b
+000030c0: 626f 7820 3d20 7365 6c66 2e5f 626f 756e  box = self._boun
+000030d0: 6469 6e67 5f62 6f78 2829 0a20 2020 2020  ding_box().     
+000030e0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+000030f0: 6262 6f78 0a0a 2020 2020 6465 6620 706f  bbox..    def po
+00003100: 696e 7473 2873 656c 6629 3a0a 2020 2020  ints(self):.    
+00003110: 2020 2020 2222 2220 4765 7420 6c69 7374      """ Get list
+00003120: 206f 6620 616c 6c20 706f 696e 7473 2e20   of all points. 
+00003130: 2222 220a 2020 2020 2020 2020 706f 696e  """.        poin
+00003140: 7473 203d 205b 5d0a 2020 2020 2020 2020  ts = [].        
+00003150: 666f 7220 7072 696d 2069 6e20 7365 6c66  for prim in self
+00003160: 2e70 7269 6d69 7469 7665 733a 0a20 2020  .primitives:.   
+00003170: 2020 2020 2020 2020 2070 6f69 6e74 7320           points 
+00003180: 2b3d 205b 7072 696d 2e73 7461 7274 2c20  += [prim.start, 
+00003190: 7072 696d 2e65 6e64 5d0a 2020 2020 2020  prim.end].      
+000031a0: 2020 7265 7475 726e 2070 6f69 6e74 730a    return points.
+000031b0: 0a20 2020 2064 6566 2062 6162 796c 6f6e  .    def babylon
+000031c0: 5f70 6172 616d 2873 656c 6629 3a0a 2020  _param(self):.  
+000031d0: 2020 2020 2020 2222 2220 4765 7420 6469        """ Get di
+000031e0: 6374 2066 6f72 2062 6162 796c 6f6e 6a73  ct for babylonjs
+000031f0: 206f 626a 6563 7420 7365 7474 696e 6773   object settings
+00003200: 2e20 2222 220a 2020 2020 2020 2020 6261  . """.        ba
+00003210: 6279 6c6f 6e5f 7061 7261 6d20 3d20 7b27  bylon_param = {'
+00003220: 616c 7068 6127 3a20 7365 6c66 2e61 6c70  alpha': self.alp
+00003230: 6861 2c0a 2020 2020 2020 2020 2020 2020  ha,.            
+00003240: 2020 2020 2020 2020 2020 2020 2027 6e61               'na
+00003250: 6d65 273a 2073 656c 662e 6e61 6d65 2c0a  me': self.name,.
+00003260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003270: 2020 2020 2020 2020 2027 636f 6c6f 7227           'color'
+00003280: 3a20 5b30 2c20 302c 2030 2e36 5d7d 0a20  : [0, 0, 0.6]}. 
+00003290: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
+000032a0: 6f6c 6f72 2069 7320 4e6f 6e65 3a0a 2020  olor is None:.  
+000032b0: 2020 2020 2020 2020 2020 6261 6279 6c6f            babylo
+000032c0: 6e5f 7061 7261 6d5b 2765 6467 6573 5f63  n_param['edges_c
+000032d0: 6f6c 6f72 275d 203d 205b 302c 2030 2c20  olor'] = [0, 0, 
+000032e0: 302e 365d 0a20 2020 2020 2020 2065 6c73  0.6].        els
+000032f0: 653a 0a20 2020 2020 2020 2020 2020 2062  e:.            b
+00003300: 6162 796c 6f6e 5f70 6172 616d 5b27 6564  abylon_param['ed
+00003310: 6765 735f 636f 6c6f 7227 5d20 3d20 6c69  ges_color'] = li
+00003320: 7374 2873 656c 662e 636f 6c6f 7229 0a20  st(self.color). 
+00003330: 2020 2020 2020 2072 6574 7572 6e20 6261         return ba
+00003340: 6279 6c6f 6e5f 7061 7261 6d0a 0a20 2020  bylon_param..   
+00003350: 2064 6566 2062 6162 796c 6f6e 5f70 6f69   def babylon_poi
+00003360: 6e74 7328 7365 6c66 293a 0a20 2020 2020  nts(self):.     
+00003370: 2020 2022 2222 2047 6574 206c 6973 7420     """ Get list 
+00003380: 6f66 2070 6f69 6e74 7320 636f 6f72 6469  of points coordi
+00003390: 6e61 7465 732e 2022 2222 0a20 2020 2020  nates. """.     
+000033a0: 2020 2072 6574 7572 6e20 5b5b 702e 782c     return [[p.x,
+000033b0: 2070 2e79 2c20 702e 7a5d 2066 6f72 2070   p.y, p.z] for p
+000033c0: 2069 6e20 7365 6c66 2e70 6f69 6e74 7328   in self.points(
+000033d0: 295d 0a0a 2020 2020 6465 6620 746f 5f62  )]..    def to_b
+000033e0: 6162 796c 6f6e 2873 656c 6629 3a0a 2020  abylon(self):.  
+000033f0: 2020 2020 2020 2222 2220 4765 6e65 7261        """ Genera
+00003400: 7465 2061 206d 6573 6820 6672 6f6d 2061  te a mesh from a
+00003410: 6c6c 2065 6467 6573 2066 6f72 2070 6572  ll edges for per
+00003420: 666f 726d 616e 6365 2077 6865 6e20 6472  formance when dr
+00003430: 6177 696e 672e 2022 2222 0a20 2020 2020  awing. """.     
+00003440: 2020 2070 6f73 6974 696f 6e73 203d 205b     positions = [
+00003450: 5d0a 2020 2020 2020 2020 666f 7220 7072  ].        for pr
+00003460: 696d 2069 6e20 7365 6c66 2e70 7269 6d69  im in self.primi
+00003470: 7469 7665 733a 0a20 2020 2020 2020 2020  tives:.         
+00003480: 2020 2070 6f73 6974 696f 6e73 202b 3d20     positions += 
+00003490: 5b70 7269 6d2e 7374 6172 742e 782c 2070  [prim.start.x, p
+000034a0: 7269 6d2e 7374 6172 742e 792c 2070 7269  rim.start.y, pri
+000034b0: 6d2e 7374 6172 742e 7a2c 0a20 2020 2020  m.start.z,.     
 000034c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000034d0: 2020 2020 2020 2070 7269 6d2e 656e 642e         prim.end.
-000034e0: 782c 2070 7269 6d2e 656e 642e 792c 2070  x, prim.end.y, p
-000034f0: 7269 6d2e 656e 642e 7a2c 0a20 2020 2020  rim.end.z,.     
+000034d0: 2020 2020 2070 7269 6d2e 656e 642e 782c       prim.end.x,
+000034e0: 2070 7269 6d2e 656e 642e 792c 2070 7269   prim.end.y, pri
+000034f0: 6d2e 656e 642e 7a2c 0a20 2020 2020 2020  m.end.z,.       
 00003500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003510: 2020 2020 2070 7269 6d2e 656e 642e 782c       prim.end.x,
-00003520: 2070 7269 6d2e 656e 642e 792c 2070 7269   prim.end.y, pri
-00003530: 6d2e 656e 642e 7a5d 0a0a 2020 2020 2020  m.end.z]..      
-00003540: 2020 696e 6469 6365 7320 3d20 6c69 7374    indices = list
-00003550: 2872 616e 6765 286c 656e 2870 6f73 6974  (range(len(posit
-00003560: 696f 6e73 2929 290a 2020 2020 2020 2020  ions))).        
-00003570: 7265 7475 726e 2070 6f73 6974 696f 6e73  return positions
-00003580: 2c20 696e 6469 6365 730a 0a20 2020 2064  , indices..    d
-00003590: 6566 2062 6162 796c 6f6e 5f6d 6573 6865  ef babylon_meshe
-000035a0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-000035b0: 2022 2222 2053 6574 2074 6865 206d 6573   """ Set the mes
-000035c0: 6820 666f 7220 6261 6279 6c6f 6e6a 732e  h for babylonjs.
-000035d0: 2022 2222 0a20 2020 2020 2020 2070 6f73   """.        pos
-000035e0: 6974 696f 6e73 2c20 696e 6469 6365 7320  itions, indices 
-000035f0: 3d20 7365 6c66 2e74 6f5f 6261 6279 6c6f  = self.to_babylo
-00003600: 6e28 290a 2020 2020 2020 2020 6261 6279  n().        baby
-00003610: 6c6f 6e5f 6d65 7368 203d 207b 2770 6f73  lon_mesh = {'pos
-00003620: 6974 696f 6e73 273a 2070 6f73 6974 696f  itions': positio
-00003630: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-00003640: 2020 2020 2020 2020 2020 2020 2769 6e64              'ind
-00003650: 6963 6573 273a 2069 6e64 6963 6573 7d0a  ices': indices}.
-00003660: 2020 2020 2020 2020 6261 6279 6c6f 6e5f          babylon_
-00003670: 6d65 7368 2e75 7064 6174 6528 7365 6c66  mesh.update(self
-00003680: 2e62 6162 796c 6f6e 5f70 6172 616d 2829  .babylon_param()
-00003690: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000036a0: 205b 6261 6279 6c6f 6e5f 6d65 7368 5d0a   [babylon_mesh].
-000036b0: 0a0a 636c 6173 7320 5769 7265 3244 2876  ..class Wire2D(v
-000036c0: 6f6c 6d64 6c72 2e63 6f72 652e 436f 6d70  olmdlr.core.Comp
-000036d0: 6f73 6974 6550 7269 6d69 7469 7665 3244  ositePrimitive2D
-000036e0: 2c20 5769 7265 4d69 7869 6e29 3a0a 2020  , WireMixin):.  
-000036f0: 2020 2222 220a 2020 2020 4120 636f 6c6c    """.    A coll
-00003700: 6563 7469 6f6e 206f 6620 7369 6d70 6c65  ection of simple
-00003710: 2070 7269 6d69 7469 7665 732c 2066 6f6c   primitives, fol
-00003720: 6c6f 7769 6e67 2065 6163 6820 6f74 6865  lowing each othe
-00003730: 7220 6d61 6b69 6e67 2061 2077 6972 652e  r making a wire.
-00003740: 0a0a 2020 2020 2222 220a 0a20 2020 2064  ..    """..    d
-00003750: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-00003760: 2c20 7072 696d 6974 6976 6573 3a20 4c69  , primitives: Li
-00003770: 7374 5b76 6f6c 6d64 6c72 2e63 6f72 652e  st[volmdlr.core.
-00003780: 5072 696d 6974 6976 6532 445d 2c0a 2020  Primitive2D],.  
-00003790: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-000037a0: 616d 653a 2073 7472 203d 2027 2729 3a0a  ame: str = ''):.
-000037b0: 2020 2020 2020 2020 7365 6c66 2e5f 626f          self._bo
-000037c0: 756e 6469 6e67 5f72 6563 7461 6e67 6c65  unding_rectangle
-000037d0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-000037e0: 766f 6c6d 646c 722e 636f 7265 2e43 6f6d  volmdlr.core.Com
-000037f0: 706f 7369 7465 5072 696d 6974 6976 6532  positePrimitive2
-00003800: 442e 5f5f 696e 6974 5f5f 2873 656c 662c  D.__init__(self,
-00003810: 2070 7269 6d69 7469 7665 732c 206e 616d   primitives, nam
-00003820: 6529 0a0a 2020 2020 6465 6620 746f 5f33  e)..    def to_3
-00003830: 6428 7365 6c66 2c20 706c 616e 655f 6f72  d(self, plane_or
-00003840: 6967 696e 2c20 782c 2079 293a 0a20 2020  igin, x, y):.   
-00003850: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00003860: 2054 7261 6e73 666f 726d 7320 6120 5769   Transforms a Wi
-00003870: 7265 3244 2069 6e74 6f20 616e 2057 6972  re2D into an Wir
-00003880: 6533 442c 2067 6976 656e 2061 2070 6c61  e3D, given a pla
-00003890: 6e65 206f 7269 6769 6e20 616e 6420 616e  ne origin and an
-000038a0: 2075 2061 6e64 2076 2070 6c61 6e65 2076   u and v plane v
-000038b0: 6563 746f 722e 0a0a 2020 2020 2020 2020  ector...        
-000038c0: 3a70 6172 616d 2070 6c61 6e65 5f6f 7269  :param plane_ori
-000038d0: 6769 6e3a 2070 6c61 6e65 206f 7269 6769  gin: plane origi
-000038e0: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
-000038f0: 6d20 783a 2070 6c61 6e65 2075 2076 6563  m x: plane u vec
-00003900: 746f 722e 0a20 2020 2020 2020 203a 7061  tor..        :pa
-00003910: 7261 6d20 793a 2070 6c61 6e65 2076 2076  ram y: plane v v
-00003920: 6563 746f 722e 0a20 2020 2020 2020 203a  ector..        :
-00003930: 7265 7475 726e 3a20 5769 7265 3344 2e0a  return: Wire3D..
-00003940: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00003950: 2020 2020 7072 696d 6974 6976 6573 3364      primitives3d
-00003960: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-00003970: 7220 6564 6765 2069 6e20 7365 6c66 2e70  r edge in self.p
-00003980: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
-00003990: 2020 2020 2020 2070 7269 6d69 7469 7665         primitive
-000039a0: 7333 642e 6170 7065 6e64 2865 6467 652e  s3d.append(edge.
-000039b0: 746f 5f33 6428 706c 616e 655f 6f72 6967  to_3d(plane_orig
-000039c0: 696e 2c20 782c 2079 2929 0a0a 2020 2020  in, x, y))..    
-000039d0: 2020 2020 7265 7475 726e 2057 6972 6533      return Wire3
-000039e0: 4428 7072 696d 6974 6976 6573 3364 290a  D(primitives3d).
-000039f0: 0a20 2020 2064 6566 2065 7874 7261 6374  .    def extract
-00003a00: 2873 656c 662c 2070 6f69 6e74 312c 2070  (self, point1, p
-00003a10: 7269 6d69 7469 7665 312c 2070 6f69 6e74  rimitive1, point
-00003a20: 322c 2070 7269 6d69 7469 7665 322c 0a20  2, primitive2,. 
-00003a30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00003a40: 6e73 6964 653a 2062 6f6f 6c20 3d20 5472  nside: bool = Tr
-00003a50: 7565 293a 0a20 2020 2020 2020 2022 2222  ue):.        """
-00003a60: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00003a70: 2069 6e73 6964 653a 2065 7874 7261 6374   inside: extract
-00003a80: 6564 2063 6f6e 746f 7572 2069 7320 6265  ed contour is be
-00003a90: 7477 6565 6e20 7468 6520 7477 6f20 706f  tween the two po
-00003aa0: 696e 7473 2069 6620 5472 7565 2061 6e64  ints if True and
-00003ab0: 206f 7574 7369 6465 2074 6865 7365 2070   outside these p
-00003ac0: 6f69 6e74 7320 6966 2046 616c 7365 2e0a  oints if False..
-00003ad0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00003ae0: 2020 2020 7265 7475 726e 2057 6972 6532      return Wire2
-00003af0: 4428 0a20 2020 2020 2020 2020 2020 2073  D(.            s
-00003b00: 656c 662e 6578 7472 6163 745f 7072 696d  elf.extract_prim
-00003b10: 6974 6976 6573 2870 6f69 6e74 312c 2070  itives(point1, p
-00003b20: 7269 6d69 7469 7665 312c 2070 6f69 6e74  rimitive1, point
-00003b30: 322c 2070 7269 6d69 7469 7665 322c 0a20  2, primitive2,. 
+00003510: 2020 2070 7269 6d2e 656e 642e 782c 2070     prim.end.x, p
+00003520: 7269 6d2e 656e 642e 792c 2070 7269 6d2e  rim.end.y, prim.
+00003530: 656e 642e 7a5d 0a0a 2020 2020 2020 2020  end.z]..        
+00003540: 696e 6469 6365 7320 3d20 6c69 7374 2872  indices = list(r
+00003550: 616e 6765 286c 656e 2870 6f73 6974 696f  ange(len(positio
+00003560: 6e73 2929 290a 2020 2020 2020 2020 7265  ns))).        re
+00003570: 7475 726e 2070 6f73 6974 696f 6e73 2c20  turn positions, 
+00003580: 696e 6469 6365 730a 0a20 2020 2064 6566  indices..    def
+00003590: 2062 6162 796c 6f6e 5f6d 6573 6865 7328   babylon_meshes(
+000035a0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+000035b0: 2222 2053 6574 2074 6865 206d 6573 6820  "" Set the mesh 
+000035c0: 666f 7220 6261 6279 6c6f 6e6a 732e 2022  for babylonjs. "
+000035d0: 2222 0a20 2020 2020 2020 2070 6f73 6974  "".        posit
+000035e0: 696f 6e73 2c20 696e 6469 6365 7320 3d20  ions, indices = 
+000035f0: 7365 6c66 2e74 6f5f 6261 6279 6c6f 6e28  self.to_babylon(
+00003600: 290a 2020 2020 2020 2020 6261 6279 6c6f  ).        babylo
+00003610: 6e5f 6d65 7368 203d 207b 2770 6f73 6974  n_mesh = {'posit
+00003620: 696f 6e73 273a 2070 6f73 6974 696f 6e73  ions': positions
+00003630: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00003640: 2020 2020 2020 2020 2020 2769 6e64 6963            'indic
+00003650: 6573 273a 2069 6e64 6963 6573 7d0a 2020  es': indices}.  
+00003660: 2020 2020 2020 6261 6279 6c6f 6e5f 6d65        babylon_me
+00003670: 7368 2e75 7064 6174 6528 7365 6c66 2e62  sh.update(self.b
+00003680: 6162 796c 6f6e 5f70 6172 616d 2829 290a  abylon_param()).
+00003690: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+000036a0: 6261 6279 6c6f 6e5f 6d65 7368 5d0a 0a0a  babylon_mesh]...
+000036b0: 636c 6173 7320 5769 7265 3244 2876 6f6c  class Wire2D(vol
+000036c0: 6d64 6c72 2e63 6f72 652e 436f 6d70 6f73  mdlr.core.Compos
+000036d0: 6974 6550 7269 6d69 7469 7665 3244 2c20  itePrimitive2D, 
+000036e0: 5769 7265 4d69 7869 6e29 3a0a 2020 2020  WireMixin):.    
+000036f0: 2222 220a 2020 2020 4120 636f 6c6c 6563  """.    A collec
+00003700: 7469 6f6e 206f 6620 7369 6d70 6c65 2070  tion of simple p
+00003710: 7269 6d69 7469 7665 732c 2066 6f6c 6c6f  rimitives, follo
+00003720: 7769 6e67 2065 6163 6820 6f74 6865 7220  wing each other 
+00003730: 6d61 6b69 6e67 2061 2077 6972 652e 0a0a  making a wire...
+00003740: 2020 2020 2222 220a 0a20 2020 2064 6566      """..    def
+00003750: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00003760: 7072 696d 6974 6976 6573 3a20 4c69 7374  primitives: List
+00003770: 5b76 6f6c 6d64 6c72 2e63 6f72 652e 5072  [volmdlr.core.Pr
+00003780: 696d 6974 6976 6532 445d 2c0a 2020 2020  imitive2D],.    
+00003790: 2020 2020 2020 2020 2020 2020 206e 616d               nam
+000037a0: 653a 2073 7472 203d 2027 2729 3a0a 2020  e: str = ''):.  
+000037b0: 2020 2020 2020 7365 6c66 2e5f 626f 756e        self._boun
+000037c0: 6469 6e67 5f72 6563 7461 6e67 6c65 203d  ding_rectangle =
+000037d0: 204e 6f6e 650a 2020 2020 2020 2020 766f   None.        vo
+000037e0: 6c6d 646c 722e 636f 7265 2e43 6f6d 706f  lmdlr.core.Compo
+000037f0: 7369 7465 5072 696d 6974 6976 6532 442e  sitePrimitive2D.
+00003800: 5f5f 696e 6974 5f5f 2873 656c 662c 2070  __init__(self, p
+00003810: 7269 6d69 7469 7665 732c 206e 616d 6529  rimitives, name)
+00003820: 0a0a 2020 2020 6465 6620 746f 5f33 6428  ..    def to_3d(
+00003830: 7365 6c66 2c20 706c 616e 655f 6f72 6967  self, plane_orig
+00003840: 696e 2c20 782c 2079 293a 0a20 2020 2020  in, x, y):.     
+00003850: 2020 2022 2222 0a20 2020 2020 2020 2054     """.        T
+00003860: 7261 6e73 666f 726d 7320 6120 5769 7265  ransforms a Wire
+00003870: 3244 2069 6e74 6f20 616e 2057 6972 6533  2D into an Wire3
+00003880: 442c 2067 6976 656e 2061 2070 6c61 6e65  D, given a plane
+00003890: 206f 7269 6769 6e20 616e 6420 616e 2075   origin and an u
+000038a0: 2061 6e64 2076 2070 6c61 6e65 2076 6563   and v plane vec
+000038b0: 746f 722e 0a0a 2020 2020 2020 2020 3a70  tor...        :p
+000038c0: 6172 616d 2070 6c61 6e65 5f6f 7269 6769  aram plane_origi
+000038d0: 6e3a 2070 6c61 6e65 206f 7269 6769 6e2e  n: plane origin.
+000038e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000038f0: 783a 2070 6c61 6e65 2075 2076 6563 746f  x: plane u vecto
+00003900: 722e 0a20 2020 2020 2020 203a 7061 7261  r..        :para
+00003910: 6d20 793a 2070 6c61 6e65 2076 2076 6563  m y: plane v vec
+00003920: 746f 722e 0a20 2020 2020 2020 203a 7265  tor..        :re
+00003930: 7475 726e 3a20 5769 7265 3344 2e0a 2020  turn: Wire3D..  
+00003940: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00003950: 2020 7072 696d 6974 6976 6573 3364 203d    primitives3d =
+00003960: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
+00003970: 6564 6765 2069 6e20 7365 6c66 2e70 7269  edge in self.pri
+00003980: 6d69 7469 7665 733a 0a20 2020 2020 2020  mitives:.       
+00003990: 2020 2020 2070 7269 6d69 7469 7665 7333       primitives3
+000039a0: 642e 6170 7065 6e64 2865 6467 652e 746f  d.append(edge.to
+000039b0: 5f33 6428 706c 616e 655f 6f72 6967 696e  _3d(plane_origin
+000039c0: 2c20 782c 2079 2929 0a0a 2020 2020 2020  , x, y))..      
+000039d0: 2020 7265 7475 726e 2057 6972 6533 4428    return Wire3D(
+000039e0: 7072 696d 6974 6976 6573 3364 290a 0a20  primitives3d).. 
+000039f0: 2020 2064 6566 2065 7874 7261 6374 2873     def extract(s
+00003a00: 656c 662c 2070 6f69 6e74 312c 2070 7269  elf, point1, pri
+00003a10: 6d69 7469 7665 312c 2070 6f69 6e74 322c  mitive1, point2,
+00003a20: 2070 7269 6d69 7469 7665 322c 0a20 2020   primitive2,.   
+00003a30: 2020 2020 2020 2020 2020 2020 2069 6e73               ins
+00003a40: 6964 653a 2062 6f6f 6c20 3d20 5472 7565  ide: bool = True
+00003a50: 293a 0a20 2020 2020 2020 2022 2222 0a0a  ):.        """..
+00003a60: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+00003a70: 6e73 6964 653a 2065 7874 7261 6374 6564  nside: extracted
+00003a80: 2063 6f6e 746f 7572 2069 7320 6265 7477   contour is betw
+00003a90: 6565 6e20 7468 6520 7477 6f20 706f 696e  een the two poin
+00003aa0: 7473 2069 6620 5472 7565 2061 6e64 206f  ts if True and o
+00003ab0: 7574 7369 6465 2074 6865 7365 2070 6f69  utside these poi
+00003ac0: 6e74 7320 6966 2046 616c 7365 2e0a 2020  nts if False..  
+00003ad0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00003ae0: 2020 7265 7475 726e 2057 6972 6532 4428    return Wire2D(
+00003af0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00003b00: 662e 6578 7472 6163 745f 7072 696d 6974  f.extract_primit
+00003b10: 6976 6573 2870 6f69 6e74 312c 2070 7269  ives(point1, pri
+00003b20: 6d69 7469 7665 312c 2070 6f69 6e74 322c  mitive1, point2,
+00003b30: 2070 7269 6d69 7469 7665 322c 0a20 2020   primitive2,.   
 00003b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00003b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003b60: 2020 2069 6e73 6964 6529 290a 0a20 2020     inside))..   
-00003b70: 2064 6566 2065 7874 7261 6374 5f77 6974   def extract_wit
-00003b80: 685f 706f 696e 7473 2873 656c 662c 2070  h_points(self, p
-00003b90: 6f69 6e74 313a 2076 6f6c 6d64 6c72 2e50  oint1: volmdlr.P
-00003ba0: 6f69 6e74 3244 2c0a 2020 2020 2020 2020  oint2D,.        
+00003b60: 2069 6e73 6964 6529 290a 0a20 2020 2064   inside))..    d
+00003b70: 6566 2065 7874 7261 6374 5f77 6974 685f  ef extract_with_
+00003b80: 706f 696e 7473 2873 656c 662c 2070 6f69  points(self, poi
+00003b90: 6e74 313a 2076 6f6c 6d64 6c72 2e50 6f69  nt1: volmdlr.Poi
+00003ba0: 6e74 3244 2c0a 2020 2020 2020 2020 2020  nt2D,.          
 00003bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003bc0: 2020 2020 706f 696e 7432 3a20 766f 6c6d      point2: volm
-00003bd0: 646c 722e 506f 696e 7432 442c 2069 6e73  dlr.Point2D, ins
-00003be0: 6964 653a 2062 6f6f 6c20 3d20 5472 7565  ide: bool = True
-00003bf0: 293a 0a20 2020 2020 2020 2022 2222 0a0a  ):.        """..
-00003c00: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
-00003c10: 6e73 6964 653a 2065 7874 7261 6374 6564  nside: extracted
-00003c20: 2063 6f6e 746f 7572 2069 7320 6265 7477   contour is betw
-00003c30: 6565 6e20 7468 6520 7477 6f20 706f 696e  een the two poin
-00003c40: 7473 2069 6620 5472 7565 2061 6e64 206f  ts if True and o
-00003c50: 7574 7369 6465 2074 6865 7365 2070 6f69  utside these poi
-00003c60: 6e74 7320 6966 2046 616c 7365 2e0a 2020  nts if False..  
-00003c70: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00003c80: 2020 7265 7475 726e 2073 656c 662e 6578    return self.ex
-00003c90: 7472 6163 745f 7769 7468 6f75 745f 7072  tract_without_pr
-00003ca0: 696d 6974 6976 6573 2870 6f69 6e74 312c  imitives(point1,
-00003cb0: 2070 6f69 6e74 322c 2069 6e73 6964 6529   point2, inside)
-00003cc0: 0a0a 2020 2020 2020 2020 2320 544f 444f  ..        # TODO
-00003cd0: 3a20 6d65 7468 6f64 2074 6f20 6368 6563  : method to chec
-00003ce0: 6b20 6966 2069 7420 6973 2061 2077 6972  k if it is a wir
-00003cf0: 650a 0a20 2020 2064 6566 2069 6e66 696e  e..    def infin
-00003d00: 6974 655f 696e 7465 7273 6563 7469 6f6e  ite_intersection
-00003d10: 7328 7365 6c66 2c20 696e 6669 6e69 7465  s(self, infinite
-00003d20: 5f70 7269 6d69 7469 7665 7329 3a0a 2020  _primitives):.  
-00003d30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00003d40: 2020 5265 7475 726e 7320 6120 6c69 7374    Returns a list
-00003d50: 2074 6861 7420 636f 6e74 6169 6e73 3a0a   that contains:.
-00003d60: 0a20 2020 2020 2020 2074 6865 2069 6e74  .        the int
-00003d70: 6572 7365 6374 696f 6e73 2062 6574 7765  ersections betwe
-00003d80: 656e 2061 2073 7563 6365 7373 696f 6e20  en a succession 
-00003d90: 6f66 2069 6e66 696e 6974 6520 7072 696d  of infinite prim
-00003da0: 6974 6976 6573 2028 6c69 6e65 2c0a 2020  itives (line,.  
-00003db0: 2020 2020 2020 6369 7263 6c65 292e 2054        circle). T
-00003dc0: 6865 7265 206d 7573 7420 6265 2061 206d  here must be a m
-00003dd0: 6574 686f 6420 696d 706c 656d 656e 7465  ethod implemente
-00003de0: 6420 746f 2069 6e74 6572 7365 6374 2074  d to intersect t
-00003df0: 6865 2074 776f 0a20 2020 2020 2020 2069  he two.        i
-00003e00: 6e66 696e 6974 6520 7072 696d 6974 6976  nfinite primitiv
-00003e10: 6573 2e0a 2020 2020 2020 2020 2222 220a  es..        """.
-00003e20: 2020 2020 2020 2020 6f66 6673 6574 5f69          offset_i
-00003e30: 6e74 6572 7365 6374 696f 6e73 203d 205b  ntersections = [
-00003e40: 5d0a 0a20 2020 2020 2020 2066 6f72 2070  ]..        for p
-00003e50: 7269 6d69 7469 7665 5f31 2c20 7072 696d  rimitive_1, prim
-00003e60: 6974 6976 655f 3220 696e 207a 6970 2869  itive_2 in zip(i
-00003e70: 6e66 696e 6974 655f 7072 696d 6974 6976  nfinite_primitiv
-00003e80: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-00003e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003eb0: 696e 6669 6e69 7465 5f70 7269 6d69 7469  infinite_primiti
-00003ec0: 7665 735b 313a 5d20 2b20 5b69 6e66 696e  ves[1:] + [infin
-00003ed0: 6974 655f 7072 696d 6974 6976 6573 5b30  ite_primitives[0
-00003ee0: 5d5d 293a 0a0a 2020 2020 2020 2020 2020  ]]):..          
-00003ef0: 2020 6920 3d20 696e 6669 6e69 7465 5f70    i = infinite_p
-00003f00: 7269 6d69 7469 7665 732e 696e 6465 7828  rimitives.index(
-00003f10: 7072 696d 6974 6976 655f 3129 0a20 2020  primitive_1).   
-00003f20: 2020 2020 2020 2020 2023 206b 203d 2069           # k = i
-00003f30: 6e66 696e 6974 655f 7072 696d 6974 6976  nfinite_primitiv
-00003f40: 6573 2e69 6e64 6578 2870 7269 6d69 7469  es.index(primiti
-00003f50: 7665 5f32 290a 0a20 2020 2020 2020 2020  ve_2)..         
-00003f60: 2020 2070 7269 6d69 7469 7665 5f6e 616d     primitive_nam
-00003f70: 6520 3d20 7072 696d 6974 6976 655f 312e  e = primitive_1.
-00003f80: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-00003f90: 5f5f 2e6c 6f77 6572 2829 2e72 6570 6c61  __.lower().repla
-00003fa0: 6365 2827 3264 272c 2027 2729 0a20 2020  ce('2d', '').   
-00003fb0: 2020 2020 2020 2020 2069 6e74 6572 7365           interse
-00003fc0: 6374 696f 6e5f 6d65 7468 6f64 5f6e 616d  ction_method_nam
-00003fd0: 6520 3d20 277b 7d5f 696e 7465 7273 6563  e = '{}_intersec
-00003fe0: 7469 6f6e 7327 2e66 6f72 6d61 7428 7072  tions'.format(pr
-00003ff0: 696d 6974 6976 655f 6e61 6d65 290a 2020  imitive_name).  
-00004000: 2020 2020 2020 2020 2020 6e65 7874 5f70            next_p
-00004010: 7269 6d69 7469 7665 5f6e 616d 6520 3d20  rimitive_name = 
-00004020: 7072 696d 6974 6976 655f 322e 5f5f 636c  primitive_2.__cl
-00004030: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2e6c  ass__.__name__.l
-00004040: 6f77 6572 2829 2e72 6570 6c61 6365 2827  ower().replace('
-00004050: 3264 272c 2027 2729 0a20 2020 2020 2020  2d', '').       
-00004060: 2020 2020 206e 6578 745f 696e 7465 7273       next_inters
-00004070: 6563 7469 6f6e 5f6d 6574 686f 645f 6e61  ection_method_na
-00004080: 6d65 203d 2027 7b7d 5f69 6e74 6572 7365  me = '{}_interse
-00004090: 6374 696f 6e73 272e 666f 726d 6174 286e  ctions'.format(n
-000040a0: 6578 745f 7072 696d 6974 6976 655f 6e61  ext_primitive_na
-000040b0: 6d65 290a 0a20 2020 2020 2020 2020 2020  me)..           
-000040c0: 2069 6620 6861 7361 7474 7228 7072 696d   if hasattr(prim
-000040d0: 6974 6976 655f 312c 206e 6578 745f 696e  itive_1, next_in
-000040e0: 7465 7273 6563 7469 6f6e 5f6d 6574 686f  tersection_metho
-000040f0: 645f 6e61 6d65 293a 0a20 2020 2020 2020  d_name):.       
-00004100: 2020 2020 2020 2020 2069 6e74 6572 7365           interse
-00004110: 6374 696f 6e73 203d 2067 6574 6174 7472  ctions = getattr
-00004120: 2870 7269 6d69 7469 7665 5f31 2c20 6e65  (primitive_1, ne
-00004130: 7874 5f69 6e74 6572 7365 6374 696f 6e5f  xt_intersection_
-00004140: 6d65 7468 6f64 5f6e 616d 6529 280a 2020  method_name)(.  
-00004150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004160: 2020 7072 696d 6974 6976 655f 3229 0a20    primitive_2). 
-00004170: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00004180: 6e64 203d 2073 656c 662e 7072 696d 6974  nd = self.primit
-00004190: 6976 6573 5b69 5d2e 656e 640a 2020 2020  ives[i].end.    
-000041a0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-000041b0: 6f74 2069 6e74 6572 7365 6374 696f 6e73  ot intersections
-000041c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000041d0: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
-000041e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000041f0: 6966 206c 656e 2869 6e74 6572 7365 6374  if len(intersect
-00004200: 696f 6e73 2920 3d3d 2031 3a0a 2020 2020  ions) == 1:.    
-00004210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004220: 6f66 6673 6574 5f69 6e74 6572 7365 6374  offset_intersect
-00004230: 696f 6e73 2e61 7070 656e 6428 696e 7465  ions.append(inte
-00004240: 7273 6563 7469 6f6e 735b 305d 290a 0a20  rsections[0]).. 
-00004250: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00004260: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00004270: 2020 2020 2020 2020 2065 6e64 203d 2073           end = s
-00004280: 656c 662e 7072 696d 6974 6976 6573 5b69  elf.primitives[i
-00004290: 5d2e 656e 640a 2020 2020 2020 2020 2020  ].end.          
-000042a0: 2020 2020 2020 2020 2020 6966 2069 6e74            if int
-000042b0: 6572 7365 6374 696f 6e73 5b30 5d2e 706f  ersections[0].po
-000042c0: 696e 745f 6469 7374 616e 6365 2865 6e64  int_distance(end
-000042d0: 2920 3e20 696e 7465 7273 6563 7469 6f6e  ) > intersection
-000042e0: 735b 315d 2e70 6f69 6e74 5f64 6973 7461  s[1].point_dista
-000042f0: 6e63 6528 656e 6429 3a0a 2020 2020 2020  nce(end):.      
-00004300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004310: 2020 696e 7465 7273 6563 7469 6f6e 732e    intersections.
-00004320: 7265 7665 7273 6528 290a 2020 2020 2020  reverse().      
-00004330: 2020 2020 2020 2020 2020 2020 2020 6f66                of
-00004340: 6673 6574 5f69 6e74 6572 7365 6374 696f  fset_intersectio
-00004350: 6e73 2e61 7070 656e 6428 696e 7465 7273  ns.append(inters
-00004360: 6563 7469 6f6e 735b 305d 290a 0a20 2020  ections[0])..   
-00004370: 2020 2020 2020 2020 2065 6c69 6620 6861           elif ha
-00004380: 7361 7474 7228 7072 696d 6974 6976 655f  sattr(primitive_
-00004390: 322c 2069 6e74 6572 7365 6374 696f 6e5f  2, intersection_
-000043a0: 6d65 7468 6f64 5f6e 616d 6529 3a0a 2020  method_name):.  
-000043b0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-000043c0: 7465 7273 6563 7469 6f6e 7320 3d20 6765  tersections = ge
-000043d0: 7461 7474 7228 7072 696d 6974 6976 655f  tattr(primitive_
-000043e0: 322c 2069 6e74 6572 7365 6374 696f 6e5f  2, intersection_
-000043f0: 6d65 7468 6f64 5f6e 616d 6529 2870 7269  method_name)(pri
-00004400: 6d69 7469 7665 5f31 290a 2020 2020 2020  mitive_1).      
-00004410: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00004420: 2069 6e74 6572 7365 6374 696f 6e73 3a0a   intersections:.
-00004430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004440: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
-00004450: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00004460: 6c65 6e28 696e 7465 7273 6563 7469 6f6e  len(intersection
-00004470: 7329 203d 3d20 313a 0a20 2020 2020 2020  s) == 1:.       
-00004480: 2020 2020 2020 2020 2020 2020 206f 6666               off
-00004490: 7365 745f 696e 7465 7273 6563 7469 6f6e  set_intersection
-000044a0: 732e 6170 7065 6e64 2869 6e74 6572 7365  s.append(interse
-000044b0: 6374 696f 6e73 5b30 5d29 0a20 2020 2020  ctions[0]).     
-000044c0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000044d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000044e0: 2020 2020 2065 6e64 203d 2073 656c 662e       end = self.
-000044f0: 7072 696d 6974 6976 6573 5b69 5d2e 656e  primitives[i].en
-00004500: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00004510: 2020 2020 2020 6966 2069 6e74 6572 7365        if interse
-00004520: 6374 696f 6e73 5b30 5d2e 706f 696e 745f  ctions[0].point_
-00004530: 6469 7374 616e 6365 2865 6e64 2920 3e20  distance(end) > 
-00004540: 696e 7465 7273 6563 7469 6f6e 735b 0a20  intersections[. 
-00004550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004560: 2020 2020 2020 2020 2020 2031 5d2e 706f             1].po
-00004570: 696e 745f 6469 7374 616e 6365 2865 6e64  int_distance(end
-00004580: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00004590: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
-000045a0: 7365 6374 696f 6e73 2e72 6576 6572 7365  sections.reverse
-000045b0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-000045c0: 2020 2020 2020 206f 6666 7365 745f 696e         offset_in
-000045d0: 7465 7273 6563 7469 6f6e 732e 6170 7065  tersections.appe
-000045e0: 6e64 2869 6e74 6572 7365 6374 696f 6e73  nd(intersections
-000045f0: 5b30 5d29 0a0a 2020 2020 2020 2020 2020  [0])..          
-00004600: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00004610: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-00004620: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-00004630: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00004640: 2020 2020 2020 2027 4e6f 2069 6e74 6572         'No inter
-00004650: 7365 6374 696f 6e20 6d65 7468 6f64 2062  section method b
-00004660: 6574 7765 656e 207b 7d20 616e 6420 7b7d  etween {} and {}
-00004670: 2e20 4465 6669 6e65 207b 7d20 6f6e 207b  . Define {} on {
-00004680: 7d20 6f72 207b 7d20 6f6e 207b 7d27 2e66  } or {} on {}'.f
-00004690: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
-000046a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000046b0: 7269 6d69 7469 7665 5f31 2e5f 5f63 6c61  rimitive_1.__cla
-000046c0: 7373 5f5f 2e5f 5f6e 616d 655f 5f2c 0a20  ss__.__name__,. 
-000046d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000046e0: 2020 2020 2020 2070 7269 6d69 7469 7665         primitive
-000046f0: 5f32 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  _2.__class__.__n
-00004700: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
-00004710: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00004720: 6578 745f 696e 7465 7273 6563 7469 6f6e  ext_intersection
-00004730: 5f6d 6574 686f 645f 6e61 6d65 2c0a 2020  _method_name,.  
-00004740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004750: 2020 2020 2020 7072 696d 6974 6976 655f        primitive_
-00004760: 312e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  1.__class__.__na
-00004770: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
-00004780: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00004790: 7465 7273 6563 7469 6f6e 5f6d 6574 686f  tersection_metho
-000047a0: 645f 6e61 6d65 2c0a 2020 2020 2020 2020  d_name,.        
-000047b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000047c0: 7072 696d 6974 6976 655f 322e 5f5f 636c  primitive_2.__cl
-000047d0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 0a20  ass__.__name__. 
-000047e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000047f0: 2020 2029 290a 0a20 2020 2020 2020 2072     ))..        r
-00004800: 6574 7572 6e20 6f66 6673 6574 5f69 6e74  eturn offset_int
-00004810: 6572 7365 6374 696f 6e73 0a0a 2020 2020  ersections..    
-00004820: 6465 6620 6f66 6673 6574 2873 656c 662c  def offset(self,
-00004830: 206f 6666 7365 7429 3a0a 2020 2020 2020   offset):.      
-00004840: 2020 2222 220a 2020 2020 2020 2020 4765    """.        Ge
-00004850: 6e65 7261 7465 7320 616e 206f 6666 7365  nerates an offse
-00004860: 7420 6f66 2061 2057 6972 6532 442e 0a0a  t of a Wire2D...
-00004870: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00004880: 2020 2020 6f66 6673 6574 5f70 7269 6d69      offset_primi
-00004890: 7469 7665 7320 3d20 5b5d 0a20 2020 2020  tives = [].     
-000048a0: 2020 2069 6e66 696e 6974 655f 7072 696d     infinite_prim
-000048b0: 6974 6976 6573 203d 205b 5d0a 2020 2020  itives = [].    
-000048c0: 2020 2020 6f66 6673 6574 5f69 6e74 6572      offset_inter
-000048d0: 7365 6374 696f 6e73 203d 205b 5d0a 2020  sections = [].  
-000048e0: 2020 2020 2020 2320 6178 203d 2073 656c        # ax = sel
-000048f0: 662e 706c 6f74 2829 0a20 2020 2020 2020  f.plot().       
-00004900: 2066 6f72 2070 7269 6d69 7469 7665 2069   for primitive i
-00004910: 6e20 7365 6c66 2e70 7269 6d69 7469 7665  n self.primitive
-00004920: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
-00004930: 6e66 696e 6974 655f 7072 696d 6974 6976  nfinite_primitiv
-00004940: 6520 3d20 7072 696d 6974 6976 652e 696e  e = primitive.in
-00004950: 6669 6e69 7465 5f70 7269 6d69 7469 7665  finite_primitive
-00004960: 286f 6666 7365 7429 0a20 2020 2020 2020  (offset).       
-00004970: 2020 2020 2069 6620 696e 6669 6e69 7465       if infinite
-00004980: 5f70 7269 6d69 7469 7665 2069 7320 6e6f  _primitive is no
-00004990: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-000049a0: 2020 2020 2020 2020 696e 6669 6e69 7465          infinite
-000049b0: 5f70 7269 6d69 7469 7665 732e 6170 7065  _primitives.appe
-000049c0: 6e64 2869 6e66 696e 6974 655f 7072 696d  nd(infinite_prim
-000049d0: 6974 6976 6529 0a20 2020 2020 2020 206f  itive).        o
-000049e0: 6666 7365 745f 696e 7465 7273 6563 7469  ffset_intersecti
-000049f0: 6f6e 7320 2b3d 2073 656c 662e 696e 6669  ons += self.infi
-00004a00: 6e69 7465 5f69 6e74 6572 7365 6374 696f  nite_intersectio
-00004a10: 6e73 2869 6e66 696e 6974 655f 7072 696d  ns(infinite_prim
-00004a20: 6974 6976 6573 290a 2020 2020 2020 2020  itives).        
-00004a30: 666f 7220 692c 2028 706f 696e 7431 2c20  for i, (point1, 
-00004a40: 706f 696e 7432 2920 696e 2065 6e75 6d65  point2) in enume
-00004a50: 7261 7465 287a 6970 286f 6666 7365 745f  rate(zip(offset_
-00004a60: 696e 7465 7273 6563 7469 6f6e 732c 0a20  intersections,. 
-00004a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004aa0: 6f66 6673 6574 5f69 6e74 6572 7365 6374  offset_intersect
-00004ab0: 696f 6e73 5b31 3a5d 202b 205b 6f66 6673  ions[1:] + [offs
-00004ac0: 6574 5f69 6e74 6572 7365 6374 696f 6e73  et_intersections
-00004ad0: 5b30 5d5d 2929 3a0a 2020 2020 2020 2020  [0]])):.        
-00004ae0: 2020 2020 6966 2069 202b 2031 203d 3d20      if i + 1 == 
-00004af0: 6c65 6e28 6f66 6673 6574 5f69 6e74 6572  len(offset_inter
-00004b00: 7365 6374 696f 6e73 293a 0a20 2020 2020  sections):.     
-00004b10: 2020 2020 2020 2020 2020 2063 7574 7465             cutte
-00004b20: 645f 7072 696d 6974 6976 6520 3d20 696e  d_primitive = in
-00004b30: 6669 6e69 7465 5f70 7269 6d69 7469 7665  finite_primitive
-00004b40: 735b 305d 2e63 7574 5f62 6574 7765 656e  s[0].cut_between
-00004b50: 5f74 776f 5f70 6f69 6e74 7328 706f 696e  _two_points(poin
-00004b60: 7431 2c20 706f 696e 7432 290a 2020 2020  t1, point2).    
-00004b70: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00004b80: 2020 2020 2020 2020 2020 2020 2020 6375                cu
-00004b90: 7474 6564 5f70 7269 6d69 7469 7665 203d  tted_primitive =
-00004ba0: 2069 6e66 696e 6974 655f 7072 696d 6974   infinite_primit
-00004bb0: 6976 6573 5b69 202b 2031 5d2e 6375 745f  ives[i + 1].cut_
-00004bc0: 6265 7477 6565 6e5f 7477 6f5f 706f 696e  between_two_poin
-00004bd0: 7473 2870 6f69 6e74 312c 2070 6f69 6e74  ts(point1, point
-00004be0: 3229 0a20 2020 2020 2020 2020 2020 206f  2).            o
-00004bf0: 6666 7365 745f 7072 696d 6974 6976 6573  ffset_primitives
-00004c00: 2e61 7070 656e 6428 6375 7474 6564 5f70  .append(cutted_p
-00004c10: 7269 6d69 7469 7665 290a 0a20 2020 2020  rimitive)..     
-00004c20: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00004c30: 5f63 6c61 7373 5f5f 286f 6666 7365 745f  _class__(offset_
-00004c40: 7072 696d 6974 6976 6573 290a 0a20 2020  primitives)..   
-00004c50: 2064 6566 2070 6c6f 745f 6461 7461 2873   def plot_data(s
-00004c60: 656c 662c 206e 616d 653a 2073 7472 203d  elf, name: str =
-00004c70: 2027 272c 2066 696c 6c3d 4e6f 6e65 2c20   '', fill=None, 
-00004c80: 636f 6c6f 723d 2762 6c61 636b 272c 0a20  color='black',. 
-00004c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ca0: 2073 7472 6f6b 655f 7769 6474 683a 2066   stroke_width: f
-00004cb0: 6c6f 6174 203d 2031 2c20 6f70 6163 6974  loat = 1, opacit
-00004cc0: 793a 2066 6c6f 6174 203d 2031 293a 0a20  y: float = 1):. 
-00004cd0: 2020 2020 2020 2064 6174 6120 3d20 5b5d         data = []
-00004ce0: 0a20 2020 2020 2020 2066 6f72 2069 7465  .        for ite
-00004cf0: 6d20 696e 2073 656c 662e 7072 696d 6974  m in self.primit
-00004d00: 6976 6573 3a0a 2020 2020 2020 2020 2020  ives:.          
-00004d10: 2020 6461 7461 2e61 7070 656e 6428 6974    data.append(it
-00004d20: 656d 2e70 6c6f 745f 6461 7461 2829 290a  em.plot_data()).
-00004d30: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-00004d40: 6174 610a 0a20 2020 2064 6566 206c 696e  ata..    def lin
-00004d50: 655f 696e 7465 7273 6563 7469 6f6e 7328  e_intersections(
-00004d60: 7365 6c66 2c20 6c69 6e65 3a20 2776 6f6c  self, line: 'vol
-00004d70: 6d64 6c72 2e65 6467 6573 2e4c 696e 6532  mdlr.edges.Line2
-00004d80: 4427 293a 0a20 2020 2020 2020 2022 2222  D'):.        """
-00004d90: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00004da0: 2061 206c 6973 7420 6f66 2069 6e74 6572   a list of inter
-00004db0: 7365 6374 696f 6e20 696e 2074 6865 2066  section in the f
-00004dc0: 6f72 6d20 6f66 2061 2074 7570 6c65 2028  orm of a tuple (
-00004dd0: 706f 696e 742c 0a20 2020 2020 2020 2070  point,.        p
-00004de0: 7269 6d69 7469 7665 2920 6f66 2074 6865  rimitive) of the
-00004df0: 2077 6972 6520 7072 696d 6974 6976 6573   wire primitives
-00004e00: 2069 6e74 6572 7365 6374 696e 6720 7769   intersecting wi
-00004e10: 7468 2074 6865 206c 696e 652e 0a0a 2020  th the line...  
-00004e20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00004e30: 2020 696e 7465 7273 6563 7469 6f6e 5f70    intersection_p
-00004e40: 6f69 6e74 7320 3d20 5b5d 0a20 2020 2020  oints = [].     
-00004e50: 2020 2066 6f72 2070 7269 6d69 7469 7665     for primitive
-00004e60: 2069 6e20 7365 6c66 2e70 7269 6d69 7469   in self.primiti
-00004e70: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
-00004e80: 2066 6f72 2070 6f69 6e74 2069 6e20 7072   for point in pr
-00004e90: 696d 6974 6976 652e 6c69 6e65 5f69 6e74  imitive.line_int
-00004ea0: 6572 7365 6374 696f 6e73 286c 696e 6529  ersections(line)
-00004eb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00004ec0: 2020 696e 7465 7273 6563 7469 6f6e 5f70    intersection_p
-00004ed0: 6f69 6e74 732e 6170 7065 6e64 2828 706f  oints.append((po
-00004ee0: 696e 742c 2070 7269 6d69 7469 7665 2929  int, primitive))
-00004ef0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00004f00: 696e 7465 7273 6563 7469 6f6e 5f70 6f69  intersection_poi
-00004f10: 6e74 730a 0a20 2020 2064 6566 206c 696e  nts..    def lin
-00004f20: 6573 6567 6d65 6e74 5f69 6e74 6572 7365  esegment_interse
-00004f30: 6374 696f 6e73 2873 656c 662c 0a20 2020  ctions(self,.   
-00004f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004f50: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00004f60: 696e 6573 6567 6d65 6e74 3a20 2776 6f6c  inesegment: 'vol
-00004f70: 6d64 6c72 2e65 6467 6573 2e4c 696e 6553  mdlr.edges.LineS
-00004f80: 6567 6d65 6e74 3244 2729 3a0a 2020 2020  egment2D'):.    
-00004f90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00004fa0: 5265 7475 726e 7320 6120 6c69 7374 206f  Returns a list o
-00004fb0: 6620 696e 7465 7273 6563 7469 6f6e 2069  f intersection i
-00004fc0: 6e20 7468 6520 666f 726d 206f 6620 6120  n the form of a 
-00004fd0: 7475 706c 6520 2870 6f69 6e74 2c0a 2020  tuple (point,.  
-00004fe0: 2020 2020 2020 7072 696d 6974 6976 6529        primitive)
-00004ff0: 206f 6620 7468 6520 7769 7265 2070 7269   of the wire pri
-00005000: 6d69 7469 7665 7320 696e 7465 7273 6563  mitives intersec
-00005010: 7469 6e67 2077 6974 6820 7468 6520 6c69  ting with the li
-00005020: 6e65 2e0a 0a20 2020 2020 2020 2022 2222  ne...        """
-00005030: 0a20 2020 2020 2020 2069 6e74 6572 7365  .        interse
-00005040: 6374 696f 6e5f 706f 696e 7473 203d 205b  ction_points = [
-00005050: 5d0a 2020 2020 2020 2020 666f 7220 7072  ].        for pr
-00005060: 696d 6974 6976 6520 696e 2073 656c 662e  imitive in self.
-00005070: 7072 696d 6974 6976 6573 3a0a 2020 2020  primitives:.    
-00005080: 2020 2020 2020 2020 696e 7465 7273 203d          inters =
-00005090: 2070 7269 6d69 7469 7665 2e6c 696e 6573   primitive.lines
-000050a0: 6567 6d65 6e74 5f69 6e74 6572 7365 6374  egment_intersect
-000050b0: 696f 6e73 286c 696e 6573 6567 6d65 6e74  ions(linesegment
-000050c0: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-000050d0: 7220 706f 696e 7420 696e 2069 6e74 6572  r point in inter
-000050e0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-000050f0: 2020 2069 6e74 6572 7365 6374 696f 6e5f     intersection_
-00005100: 706f 696e 7473 2e61 7070 656e 6428 2870  points.append((p
-00005110: 6f69 6e74 2c20 7072 696d 6974 6976 6529  oint, primitive)
-00005120: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00005130: 2069 6e74 6572 7365 6374 696f 6e5f 706f   intersection_po
-00005140: 696e 7473 0a0a 2020 2020 6465 6620 6973  ints..    def is
-00005150: 5f73 7461 7274 5f65 6e64 5f63 726f 7373  _start_end_cross
-00005160: 696e 6773 5f76 616c 6964 2873 656c 662c  ings_valid(self,
-00005170: 206c 696e 652c 2069 6e74 6572 7365 6374   line, intersect
-00005180: 696f 6e73 2c20 7072 696d 6974 6976 6529  ions, primitive)
-00005190: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000051a0: 2020 2020 2020 3a70 6172 616d 206c 696e        :param lin
-000051b0: 653a 2063 726f 7373 696e 6720 6c69 6e65  e: crossing line
-000051c0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000051d0: 696e 7465 7273 6563 7469 6f6e 733a 2069  intersections: i
-000051e0: 6e74 6572 7365 6374 696f 6e73 2072 6573  ntersections res
-000051f0: 756c 7473 0a20 2020 2020 2020 2020 666f  ults.         fo
-00005200: 7220 7072 696d 6974 6976 6520 6c69 6e65  r primitive line
-00005210: 2069 6e74 6572 7365 6374 696f 6e73 0a20   intersections. 
-00005220: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00005230: 696d 6974 6976 653a 2069 6e74 6572 7365  imitive: interse
-00005240: 6374 696e 6720 7072 696d 6974 6976 650a  cting primitive.
-00005250: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00005260: 204e 6f6e 6520 6966 2069 6e74 6572 7365   None if interse
-00005270: 6374 696f 6e20 6e6f 7420 6120 7374 6172  ction not a star
-00005280: 7420 6f72 0a20 2020 2020 2020 2065 6e64  t or.        end
-00005290: 2070 6f69 6e74 206f 6620 6120 636f 6e74   point of a cont
-000052a0: 6f75 7273 2070 7269 6d69 7469 7665 732c  ours primitives,
-000052b0: 206f 7220 6120 766f 6c6d 646c 722e 506f   or a volmdlr.Po
-000052c0: 696e 7432 4420 6966 2069 7420 6973 2e0a  int2D if it is..
-000052d0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000052e0: 2020 2020 7072 696d 6974 6976 655f 696e      primitive_in
-000052f0: 6465 7820 3d20 7365 6c66 2e70 7269 6d69  dex = self.primi
-00005300: 7469 7665 732e 696e 6465 7828 7072 696d  tives.index(prim
-00005310: 6974 6976 6529 0a20 2020 2020 2020 2070  itive).        p
-00005320: 6f69 6e74 312c 2070 6f69 6e74 3220 3d20  oint1, point2 = 
-00005330: 4e6f 6e65 2c20 4e6f 6e65 0a20 2020 2020  None, None.     
-00005340: 2020 2069 6620 696e 7465 7273 6563 7469     if intersecti
-00005350: 6f6e 735b 305d 203d 3d20 7072 696d 6974  ons[0] == primit
-00005360: 6976 652e 7374 6172 743a 0a20 2020 2020  ive.start:.     
-00005370: 2020 2020 2020 2070 6f69 6e74 3120 3d20         point1 = 
-00005380: 7072 696d 6974 6976 652e 706f 696e 745f  primitive.point_
-00005390: 6174 5f61 6273 6369 7373 6128 7072 696d  at_abscissa(prim
-000053a0: 6974 6976 652e 6c65 6e67 7468 2829 202a  itive.length() *
-000053b0: 2030 2e30 3129 0a20 2020 2020 2020 2020   0.01).         
-000053c0: 2020 2070 6f69 6e74 3220 3d20 7365 6c66     point2 = self
-000053d0: 2e70 7269 6d69 7469 7665 735b 7072 696d  .primitives[prim
-000053e0: 6974 6976 655f 696e 6465 7820 2d20 315d  itive_index - 1]
-000053f0: 2e70 6f69 6e74 5f61 745f 6162 7363 6973  .point_at_abscis
-00005400: 7361 280a 2020 2020 2020 2020 2020 2020  sa(.            
-00005410: 2020 2020 7365 6c66 2e70 7269 6d69 7469      self.primiti
-00005420: 7665 735b 7072 696d 6974 6976 655f 696e  ves[primitive_in
-00005430: 6465 7820 2d20 315d 2e6c 656e 6774 6828  dex - 1].length(
-00005440: 2920 2a20 2e39 390a 2020 2020 2020 2020  ) * .99.        
-00005450: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-00005460: 2020 2023 2070 6f69 6e74 3220 3d20 7072     # point2 = pr
-00005470: 696d 6974 6976 652e 7374 6172 7420 2b20  imitive.start + 
-00005480: 5c0a 2020 2020 2020 2020 2020 2020 2320  \.            # 
-00005490: 2020 2020 2020 2020 2073 656c 662e 7072           self.pr
-000054a0: 696d 6974 6976 6573 5b70 7269 6d69 7469  imitives[primiti
-000054b0: 7665 5f69 6e64 6578 202d 2031 5d2e 756e  ve_index - 1].un
-000054c0: 6974 5f64 6972 6563 7469 6f6e 5f76 6563  it_direction_vec
-000054d0: 746f 7228 302e 3529 0a20 2020 2020 2020  tor(0.5).       
-000054e0: 2065 6c69 6620 696e 7465 7273 6563 7469   elif intersecti
-000054f0: 6f6e 735b 305d 203d 3d20 7072 696d 6974  ons[0] == primit
-00005500: 6976 652e 656e 6420 616e 6420 5c0a 2020  ive.end and \.  
-00005510: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00005520: 696d 6974 6976 6520 213d 2073 656c 662e  imitive != self.
-00005530: 7072 696d 6974 6976 6573 5b2d 315d 3a0a  primitives[-1]:.
-00005540: 2020 2020 2020 2020 2020 2020 706f 696e              poin
-00005550: 7431 203d 2070 7269 6d69 7469 7665 2e70  t1 = primitive.p
-00005560: 6f69 6e74 5f61 745f 6162 7363 6973 7361  oint_at_abscissa
-00005570: 2870 7269 6d69 7469 7665 2e6c 656e 6774  (primitive.lengt
-00005580: 6828 2920 2a20 302e 3939 290a 2020 2020  h() * 0.99).    
-00005590: 2020 2020 2020 2020 706f 696e 7432 203d          point2 =
-000055a0: 2073 656c 662e 7072 696d 6974 6976 6573   self.primitives
-000055b0: 5b70 7269 6d69 7469 7665 5f69 6e64 6578  [primitive_index
-000055c0: 202b 2031 5d2e 706f 696e 745f 6174 5f61   + 1].point_at_a
-000055d0: 6273 6369 7373 6128 0a20 2020 2020 2020  bscissa(.       
-000055e0: 2020 2020 2020 2020 2073 656c 662e 7072           self.pr
-000055f0: 696d 6974 6976 6573 5b70 7269 6d69 7469  imitives[primiti
-00005600: 7665 5f69 6e64 6578 202b 2031 5d2e 6c65  ve_index + 1].le
-00005610: 6e67 7468 2829 202a 202e 3031 290a 0a20  ngth() * .01).. 
-00005620: 2020 2020 2020 2020 2020 2023 2070 6f69             # poi
-00005630: 6e74 3220 3d20 7072 696d 6974 6976 652e  nt2 = primitive.
-00005640: 656e 6420 2b20 5c0a 2020 2020 2020 2020  end + \.        
-00005650: 2020 2020 2320 2020 2020 2020 2020 2073      #          s
-00005660: 656c 662e 7072 696d 6974 6976 6573 5b70  elf.primitives[p
-00005670: 7269 6d69 7469 7665 5f69 6e64 6578 202b  rimitive_index +
-00005680: 2031 5d2e 756e 6974 5f64 6972 6563 7469   1].unit_directi
-00005690: 6f6e 5f76 6563 746f 7228 302e 3529 0a20  on_vector(0.5). 
-000056a0: 2020 2020 2020 2069 6620 706f 696e 7431         if point1
-000056b0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-000056c0: 2070 6f69 6e74 3220 6973 206e 6f74 204e   point2 is not N
-000056d0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-000056e0: 2072 6574 7572 6e20 6c69 6e65 2e69 735f   return line.is_
-000056f0: 6265 7477 6565 6e5f 706f 696e 7473 2870  between_points(p
-00005700: 6f69 6e74 312c 2070 6f69 6e74 3229 0a20  oint1, point2). 
-00005710: 2020 2020 2020 2072 6574 7572 6e20 4661         return Fa
-00005720: 6c73 650a 0a20 2020 2040 7374 6174 6963  lse..    @static
-00005730: 6d65 7468 6f64 0a20 2020 2064 6566 2069  method.    def i
-00005740: 735f 6372 6f73 7369 6e67 5f73 7461 7274  s_crossing_start
-00005750: 5f65 6e64 5f70 6f69 6e74 2869 6e74 6572  _end_point(inter
-00005760: 7365 6374 696f 6e73 2c20 7072 696d 6974  sections, primit
-00005770: 6976 6529 3a0a 2020 2020 2020 2020 2222  ive):.        ""
-00005780: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-00005790: 7320 5472 7565 2069 6620 7468 6520 6372  s True if the cr
-000057a0: 6f73 7369 6e67 7320 7072 6f76 6964 6564  ossings provided
-000057b0: 2061 7265 7374 6172 7420 6f72 2065 6e64   arestart or end
-000057c0: 206f 6620 7468 6520 5769 7265 3244 2e0a   of the Wire2D..
-000057d0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000057e0: 696e 7465 7273 6563 7469 6f6e 733a 2069  intersections: i
-000057f0: 6e74 6572 7365 6374 696f 6e73 2072 6573  ntersections res
-00005800: 756c 7473 0a20 2020 2020 2020 2020 666f  ults.         fo
-00005810: 7220 7072 696d 6974 6976 6520 6c69 6e65  r primitive line
-00005820: 2069 6e74 6572 7365 6374 696f 6e73 0a20   intersections. 
-00005830: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00005840: 696d 6974 6976 653a 2069 6e74 6572 7365  imitive: interse
-00005850: 6374 696e 6720 7072 696d 6974 6976 650a  cting primitive.
-00005860: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00005870: 2046 616c 7365 2069 6620 696e 7465 7273   False if inters
-00005880: 6563 7469 6f6e 206e 6f74 2061 2073 7461  ection not a sta
-00005890: 7274 206f 720a 2020 2020 2020 2020 656e  rt or.        en
-000058a0: 6420 706f 696e 7420 6f66 2061 2063 6f6e  d point of a con
-000058b0: 746f 7572 7320 7072 696d 6974 6976 6573  tours primitives
-000058c0: 2c20 6f72 2054 7275 6520 6966 2069 7420  , or True if it 
-000058d0: 6973 2e0a 2020 2020 2020 2020 2222 220a  is..        """.
-000058e0: 2020 2020 2020 2020 6966 2069 6e74 6572          if inter
-000058f0: 7365 6374 696f 6e73 5b30 5d20 3d3d 2070  sections[0] == p
-00005900: 7269 6d69 7469 7665 2e73 7461 7274 206f  rimitive.start o
-00005910: 7220 696e 7465 7273 6563 7469 6f6e 735b  r intersections[
-00005920: 305d 203d 3d20 7072 696d 6974 6976 652e  0] == primitive.
-00005930: 656e 643a 0a20 2020 2020 2020 2020 2020  end:.           
-00005940: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
-00005950: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
-00005960: 650a 0a20 2020 2064 6566 206c 696e 655f  e..    def line_
-00005970: 6372 6f73 7369 6e67 7328 7365 6c66 2c20  crossings(self, 
-00005980: 6c69 6e65 3a20 766f 6c6d 646c 722e 6564  line: volmdlr.ed
-00005990: 6765 732e 4c69 6e65 3244 293a 0a20 2020  ges.Line2D):.   
-000059a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000059b0: 2043 616c 6375 6c61 7465 7320 7661 6c69   Calculates vali
-000059c0: 6420 6372 6f73 7369 6e67 2069 6e74 6572  d crossing inter
-000059d0: 7365 6374 696f 6e73 206f 6620 6120 7769  sections of a wi
-000059e0: 7265 2061 6e64 2061 6e20 696e 6669 6e69  re and an infini
-000059f0: 7465 206c 696e 652e 0a0a 2020 2020 2020  te line...      
-00005a00: 2020 3a70 6172 616d 206c 696e 653a 206c    :param line: l
-00005a10: 696e 6520 6372 6f73 7369 6e67 2074 6865  ine crossing the
-00005a20: 2077 6972 650a 2020 2020 2020 2020 3a74   wire.        :t
-00005a30: 7970 6520 6c69 6e65 3a20 766f 6c6d 646c  ype line: volmdl
-00005a40: 722e 6564 6765 732e 4c69 6e65 3244 0a20  r.edges.Line2D. 
-00005a50: 2020 2020 2020 2072 6574 7572 6e73 2061         returns a
-00005a60: 206c 6973 7420 6f66 2054 7570 6c65 7320   list of Tuples 
-00005a70: 2870 6f69 6e74 2c20 7072 696d 6974 6976  (point, primitiv
-00005a80: 6529 0a20 2020 2020 2020 206f 6620 7468  e).        of th
-00005a90: 6520 7769 7265 2070 7269 6d69 7469 7665  e wire primitive
-00005aa0: 7320 696e 7465 7273 6563 7469 6e67 2077  s intersecting w
-00005ab0: 6974 6820 7468 6520 6c69 6e65 0a20 2020  ith the line.   
-00005ac0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00005ad0: 2069 6e74 6572 7365 6374 696f 6e5f 706f   intersection_po
-00005ae0: 696e 7473 203d 205b 5d0a 2020 2020 2020  ints = [].      
-00005af0: 2020 696e 7465 7273 6563 7469 6f6e 5f70    intersection_p
-00005b00: 6f69 6e74 735f 7072 696d 6974 6976 6573  oints_primitives
-00005b10: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-00005b20: 7220 7072 696d 6974 6976 6520 696e 2073  r primitive in s
-00005b30: 656c 662e 7072 696d 6974 6976 6573 3a0a  elf.primitives:.
-00005b40: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-00005b50: 7273 6563 7469 6f6e 7320 3d20 7072 696d  rsections = prim
-00005b60: 6974 6976 652e 6c69 6e65 5f69 6e74 6572  itive.line_inter
-00005b70: 7365 6374 696f 6e73 286c 696e 6529 0a20  sections(line). 
-00005b80: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00005b90: 6e74 6572 7365 6374 696f 6e20 696e 2069  ntersection in i
-00005ba0: 6e74 6572 7365 6374 696f 6e73 3a0a 2020  ntersections:.  
-00005bb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00005bc0: 2069 6e74 6572 7365 6374 696f 6e20 6e6f   intersection no
-00005bd0: 7420 696e 2069 6e74 6572 7365 6374 696f  t in intersectio
-00005be0: 6e5f 706f 696e 7473 3a0a 2020 2020 2020  n_points:.      
-00005bf0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00005c00: 206e 6f74 2073 656c 662e 6973 5f63 726f   not self.is_cro
-00005c10: 7373 696e 675f 7374 6172 745f 656e 645f  ssing_start_end_
-00005c20: 706f 696e 7428 696e 7465 7273 6563 7469  point(intersecti
-00005c30: 6f6e 732c 2070 7269 6d69 7469 7665 293a  ons, primitive):
-00005c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005c50: 2020 2020 2020 2020 2069 6e74 6572 7365           interse
-00005c60: 6374 696f 6e5f 706f 696e 7473 2e61 7070  ction_points.app
-00005c70: 656e 6428 696e 7465 7273 6563 7469 6f6e  end(intersection
-00005c80: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00005c90: 2020 2020 2020 2020 2020 696e 7465 7273            inters
-00005ca0: 6563 7469 6f6e 5f70 6f69 6e74 735f 7072  ection_points_pr
-00005cb0: 696d 6974 6976 6573 2e61 7070 656e 6428  imitives.append(
-00005cc0: 2869 6e74 6572 7365 6374 696f 6e2c 2070  (intersection, p
-00005cd0: 7269 6d69 7469 7665 2929 0a20 2020 2020  rimitive)).     
-00005ce0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00005cf0: 6c69 6620 7365 6c66 2e69 735f 7374 6172  lif self.is_star
-00005d00: 745f 656e 645f 6372 6f73 7369 6e67 735f  t_end_crossings_
-00005d10: 7661 6c69 6428 6c69 6e65 2c20 696e 7465  valid(line, inte
-00005d20: 7273 6563 7469 6f6e 732c 2070 7269 6d69  rsections, primi
-00005d30: 7469 7665 293a 0a20 2020 2020 2020 2020  tive):.         
-00005d40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00005d50: 6e74 6572 7365 6374 696f 6e5f 706f 696e  ntersection_poin
-00005d60: 7473 2e61 7070 656e 6428 696e 7465 7273  ts.append(inters
-00005d70: 6563 7469 6f6e 290a 2020 2020 2020 2020  ection).        
+00003bc0: 2020 706f 696e 7432 3a20 766f 6c6d 646c    point2: volmdl
+00003bd0: 722e 506f 696e 7432 442c 2069 6e73 6964  r.Point2D, insid
+00003be0: 653a 2062 6f6f 6c20 3d20 5472 7565 293a  e: bool = True):
+00003bf0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00003c00: 2020 2020 2020 3a70 6172 616d 2069 6e73        :param ins
+00003c10: 6964 653a 2065 7874 7261 6374 6564 2063  ide: extracted c
+00003c20: 6f6e 746f 7572 2069 7320 6265 7477 6565  ontour is betwee
+00003c30: 6e20 7468 6520 7477 6f20 706f 696e 7473  n the two points
+00003c40: 2069 6620 5472 7565 2061 6e64 206f 7574   if True and out
+00003c50: 7369 6465 2074 6865 7365 2070 6f69 6e74  side these point
+00003c60: 7320 6966 2046 616c 7365 2e0a 2020 2020  s if False..    
+00003c70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00003c80: 7265 7475 726e 2073 656c 662e 6578 7472  return self.extr
+00003c90: 6163 745f 7769 7468 6f75 745f 7072 696d  act_without_prim
+00003ca0: 6974 6976 6573 2870 6f69 6e74 312c 2070  itives(point1, p
+00003cb0: 6f69 6e74 322c 2069 6e73 6964 6529 0a0a  oint2, inside)..
+00003cc0: 2020 2020 2020 2020 2320 544f 444f 3a20          # TODO: 
+00003cd0: 6d65 7468 6f64 2074 6f20 6368 6563 6b20  method to check 
+00003ce0: 6966 2069 7420 6973 2061 2077 6972 650a  if it is a wire.
+00003cf0: 0a20 2020 2064 6566 2069 6e66 696e 6974  .    def infinit
+00003d00: 655f 696e 7465 7273 6563 7469 6f6e 7328  e_intersections(
+00003d10: 7365 6c66 2c20 696e 6669 6e69 7465 5f70  self, infinite_p
+00003d20: 7269 6d69 7469 7665 7329 3a0a 2020 2020  rimitives):.    
+00003d30: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00003d40: 5265 7475 726e 7320 6120 6c69 7374 2074  Returns a list t
+00003d50: 6861 7420 636f 6e74 6169 6e73 2074 6865  hat contains the
+00003d60: 2069 6e74 6572 7365 6374 696f 6e73 2062   intersections b
+00003d70: 6574 7765 656e 2061 2073 7563 6365 7373  etween a success
+00003d80: 696f 6e20 6f66 2069 6e66 696e 6974 6520  ion of infinite 
+00003d90: 7072 696d 6974 6976 6573 2e0a 0a20 2020  primitives...   
+00003da0: 2020 2020 2054 6865 7265 206d 7573 7420       There must 
+00003db0: 6265 2061 206d 6574 686f 6420 696d 706c  be a method impl
+00003dc0: 656d 656e 7465 6420 746f 2069 6e74 6572  emented to inter
+00003dd0: 7365 6374 2074 6865 2074 776f 2069 6e66  sect the two inf
+00003de0: 696e 6974 6520 7072 696d 6974 6976 6573  inite primitives
+00003df0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00003e00: 2020 2020 2020 6f66 6673 6574 5f69 6e74        offset_int
+00003e10: 6572 7365 6374 696f 6e73 203d 205b 5d0a  ersections = [].
+00003e20: 0a20 2020 2020 2020 2066 6f72 2070 7269  .        for pri
+00003e30: 6d69 7469 7665 5f31 2c20 7072 696d 6974  mitive_1, primit
+00003e40: 6976 655f 3220 696e 207a 6970 2869 6e66  ive_2 in zip(inf
+00003e50: 696e 6974 655f 7072 696d 6974 6976 6573  inite_primitives
+00003e60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00003e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003e80: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00003e90: 6669 6e69 7465 5f70 7269 6d69 7469 7665  finite_primitive
+00003ea0: 735b 313a 5d20 2b20 5b69 6e66 696e 6974  s[1:] + [infinit
+00003eb0: 655f 7072 696d 6974 6976 6573 5b30 5d5d  e_primitives[0]]
+00003ec0: 293a 0a0a 2020 2020 2020 2020 2020 2020  ):..            
+00003ed0: 6920 3d20 696e 6669 6e69 7465 5f70 7269  i = infinite_pri
+00003ee0: 6d69 7469 7665 732e 696e 6465 7828 7072  mitives.index(pr
+00003ef0: 696d 6974 6976 655f 3129 0a20 2020 2020  imitive_1).     
+00003f00: 2020 2020 2020 2023 206b 203d 2069 6e66         # k = inf
+00003f10: 696e 6974 655f 7072 696d 6974 6976 6573  inite_primitives
+00003f20: 2e69 6e64 6578 2870 7269 6d69 7469 7665  .index(primitive
+00003f30: 5f32 290a 0a20 2020 2020 2020 2020 2020  _2)..           
+00003f40: 2070 7269 6d69 7469 7665 5f6e 616d 6520   primitive_name 
+00003f50: 3d20 7072 696d 6974 6976 655f 312e 5f5f  = primitive_1.__
+00003f60: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+00003f70: 2e6c 6f77 6572 2829 2e72 6570 6c61 6365  .lower().replace
+00003f80: 2827 3264 272c 2027 2729 0a20 2020 2020  ('2d', '').     
+00003f90: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
+00003fa0: 696f 6e5f 6d65 7468 6f64 5f6e 616d 6520  ion_method_name 
+00003fb0: 3d20 277b 7d5f 696e 7465 7273 6563 7469  = '{}_intersecti
+00003fc0: 6f6e 7327 2e66 6f72 6d61 7428 7072 696d  ons'.format(prim
+00003fd0: 6974 6976 655f 6e61 6d65 290a 2020 2020  itive_name).    
+00003fe0: 2020 2020 2020 2020 6e65 7874 5f70 7269          next_pri
+00003ff0: 6d69 7469 7665 5f6e 616d 6520 3d20 7072  mitive_name = pr
+00004000: 696d 6974 6976 655f 322e 5f5f 636c 6173  imitive_2.__clas
+00004010: 735f 5f2e 5f5f 6e61 6d65 5f5f 2e6c 6f77  s__.__name__.low
+00004020: 6572 2829 2e72 6570 6c61 6365 2827 3264  er().replace('2d
+00004030: 272c 2027 2729 0a20 2020 2020 2020 2020  ', '').         
+00004040: 2020 206e 6578 745f 696e 7465 7273 6563     next_intersec
+00004050: 7469 6f6e 5f6d 6574 686f 645f 6e61 6d65  tion_method_name
+00004060: 203d 2027 7b7d 5f69 6e74 6572 7365 6374   = '{}_intersect
+00004070: 696f 6e73 272e 666f 726d 6174 286e 6578  ions'.format(nex
+00004080: 745f 7072 696d 6974 6976 655f 6e61 6d65  t_primitive_name
+00004090: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+000040a0: 6620 6861 7361 7474 7228 7072 696d 6974  f hasattr(primit
+000040b0: 6976 655f 312c 206e 6578 745f 696e 7465  ive_1, next_inte
+000040c0: 7273 6563 7469 6f6e 5f6d 6574 686f 645f  rsection_method_
+000040d0: 6e61 6d65 293a 0a20 2020 2020 2020 2020  name):.         
+000040e0: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
+000040f0: 696f 6e73 203d 2067 6574 6174 7472 2870  ions = getattr(p
+00004100: 7269 6d69 7469 7665 5f31 2c20 6e65 7874  rimitive_1, next
+00004110: 5f69 6e74 6572 7365 6374 696f 6e5f 6d65  _intersection_me
+00004120: 7468 6f64 5f6e 616d 6529 280a 2020 2020  thod_name)(.    
+00004130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004140: 7072 696d 6974 6976 655f 3229 0a20 2020  primitive_2).   
+00004150: 2020 2020 2020 2020 2020 2020 2065 6e64               end
+00004160: 203d 2073 656c 662e 7072 696d 6974 6976   = self.primitiv
+00004170: 6573 5b69 5d2e 656e 640a 2020 2020 2020  es[i].end.      
+00004180: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00004190: 2069 6e74 6572 7365 6374 696f 6e73 3a0a   intersections:.
+000041a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000041b0: 2020 2020 636f 6e74 696e 7565 0a0a 2020      continue..  
+000041c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000041d0: 206c 656e 2869 6e74 6572 7365 6374 696f   len(intersectio
+000041e0: 6e73 2920 3d3d 2031 3a0a 2020 2020 2020  ns) == 1:.      
+000041f0: 2020 2020 2020 2020 2020 2020 2020 6f66                of
+00004200: 6673 6574 5f69 6e74 6572 7365 6374 696f  fset_intersectio
+00004210: 6e73 2e61 7070 656e 6428 696e 7465 7273  ns.append(inters
+00004220: 6563 7469 6f6e 735b 305d 290a 0a20 2020  ections[0])..   
+00004230: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00004240: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00004250: 2020 2020 2020 2065 6e64 203d 2073 656c         end = sel
+00004260: 662e 7072 696d 6974 6976 6573 5b69 5d2e  f.primitives[i].
+00004270: 656e 640a 2020 2020 2020 2020 2020 2020  end.            
+00004280: 2020 2020 2020 2020 6966 2069 6e74 6572          if inter
+00004290: 7365 6374 696f 6e73 5b30 5d2e 706f 696e  sections[0].poin
+000042a0: 745f 6469 7374 616e 6365 2865 6e64 2920  t_distance(end) 
+000042b0: 3e20 696e 7465 7273 6563 7469 6f6e 735b  > intersections[
+000042c0: 315d 2e70 6f69 6e74 5f64 6973 7461 6e63  1].point_distanc
+000042d0: 6528 656e 6429 3a0a 2020 2020 2020 2020  e(end):.        
+000042e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000042f0: 696e 7465 7273 6563 7469 6f6e 732e 7265  intersections.re
+00004300: 7665 7273 6528 290a 2020 2020 2020 2020  verse().        
+00004310: 2020 2020 2020 2020 2020 2020 6f66 6673              offs
+00004320: 6574 5f69 6e74 6572 7365 6374 696f 6e73  et_intersections
+00004330: 2e61 7070 656e 6428 696e 7465 7273 6563  .append(intersec
+00004340: 7469 6f6e 735b 305d 290a 0a20 2020 2020  tions[0])..     
+00004350: 2020 2020 2020 2065 6c69 6620 6861 7361         elif hasa
+00004360: 7474 7228 7072 696d 6974 6976 655f 322c  ttr(primitive_2,
+00004370: 2069 6e74 6572 7365 6374 696f 6e5f 6d65   intersection_me
+00004380: 7468 6f64 5f6e 616d 6529 3a0a 2020 2020  thod_name):.    
+00004390: 2020 2020 2020 2020 2020 2020 696e 7465              inte
+000043a0: 7273 6563 7469 6f6e 7320 3d20 6765 7461  rsections = geta
+000043b0: 7474 7228 7072 696d 6974 6976 655f 322c  ttr(primitive_2,
+000043c0: 2069 6e74 6572 7365 6374 696f 6e5f 6d65   intersection_me
+000043d0: 7468 6f64 5f6e 616d 6529 2870 7269 6d69  thod_name)(primi
+000043e0: 7469 7665 5f31 290a 2020 2020 2020 2020  tive_1).        
+000043f0: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+00004400: 6e74 6572 7365 6374 696f 6e73 3a0a 2020  ntersections:.  
+00004410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004420: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
+00004430: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00004440: 6e28 696e 7465 7273 6563 7469 6f6e 7329  n(intersections)
+00004450: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00004460: 2020 2020 2020 2020 2020 206f 6666 7365             offse
+00004470: 745f 696e 7465 7273 6563 7469 6f6e 732e  t_intersections.
+00004480: 6170 7065 6e64 2869 6e74 6572 7365 6374  append(intersect
+00004490: 696f 6e73 5b30 5d29 0a20 2020 2020 2020  ions[0]).       
+000044a0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000044b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000044c0: 2020 2065 6e64 203d 2073 656c 662e 7072     end = self.pr
+000044d0: 696d 6974 6976 6573 5b69 5d2e 656e 640a  imitives[i].end.
+000044e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000044f0: 2020 2020 6966 2069 6e74 6572 7365 6374      if intersect
+00004500: 696f 6e73 5b30 5d2e 706f 696e 745f 6469  ions[0].point_di
+00004510: 7374 616e 6365 2865 6e64 2920 3e20 696e  stance(end) > in
+00004520: 7465 7273 6563 7469 6f6e 735b 0a20 2020  tersections[.   
+00004530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004540: 2020 2020 2020 2020 2031 5d2e 706f 696e           1].poin
+00004550: 745f 6469 7374 616e 6365 2865 6e64 293a  t_distance(end):
+00004560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004570: 2020 2020 2020 2020 2069 6e74 6572 7365           interse
+00004580: 6374 696f 6e73 2e72 6576 6572 7365 2829  ctions.reverse()
+00004590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000045a0: 2020 2020 206f 6666 7365 745f 696e 7465       offset_inte
+000045b0: 7273 6563 7469 6f6e 732e 6170 7065 6e64  rsections.append
+000045c0: 2869 6e74 6572 7365 6374 696f 6e73 5b30  (intersections[0
+000045d0: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
+000045e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000045f0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+00004600: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+00004610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004620: 2020 2020 2027 4e6f 2069 6e74 6572 7365       'No interse
+00004630: 6374 696f 6e20 6d65 7468 6f64 2062 6574  ction method bet
+00004640: 7765 656e 207b 7d20 616e 6420 7b7d 2e20  ween {} and {}. 
+00004650: 4465 6669 6e65 207b 7d20 6f6e 207b 7d20  Define {} on {} 
+00004660: 6f72 207b 7d20 6f6e 207b 7d27 2e66 6f72  or {} on {}'.for
+00004670: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
+00004680: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00004690: 6d69 7469 7665 5f31 2e5f 5f63 6c61 7373  mitive_1.__class
+000046a0: 5f5f 2e5f 5f6e 616d 655f 5f2c 0a20 2020  __.__name__,.   
+000046b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000046c0: 2020 2020 2070 7269 6d69 7469 7665 5f32       primitive_2
+000046d0: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
+000046e0: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
+000046f0: 2020 2020 2020 2020 2020 2020 206e 6578               nex
+00004700: 745f 696e 7465 7273 6563 7469 6f6e 5f6d  t_intersection_m
+00004710: 6574 686f 645f 6e61 6d65 2c0a 2020 2020  ethod_name,.    
+00004720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004730: 2020 2020 7072 696d 6974 6976 655f 312e      primitive_1.
+00004740: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
+00004750: 5f5f 2c0a 2020 2020 2020 2020 2020 2020  __,.            
+00004760: 2020 2020 2020 2020 2020 2020 696e 7465              inte
+00004770: 7273 6563 7469 6f6e 5f6d 6574 686f 645f  rsection_method_
+00004780: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00004790: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+000047a0: 696d 6974 6976 655f 322e 5f5f 636c 6173  imitive_2.__clas
+000047b0: 735f 5f2e 5f5f 6e61 6d65 5f5f 0a20 2020  s__.__name__.   
+000047c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000047d0: 2029 290a 0a20 2020 2020 2020 2072 6574   ))..        ret
+000047e0: 7572 6e20 6f66 6673 6574 5f69 6e74 6572  urn offset_inter
+000047f0: 7365 6374 696f 6e73 0a0a 2020 2020 6465  sections..    de
+00004800: 6620 6f66 6673 6574 2873 656c 662c 206f  f offset(self, o
+00004810: 6666 7365 7429 3a0a 2020 2020 2020 2020  ffset):.        
+00004820: 2222 220a 2020 2020 2020 2020 4765 6e65  """.        Gene
+00004830: 7261 7465 7320 616e 206f 6666 7365 7420  rates an offset 
+00004840: 6f66 2061 2057 6972 6532 442e 0a0a 2020  of a Wire2D...  
+00004850: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00004860: 2020 6f66 6673 6574 5f70 7269 6d69 7469    offset_primiti
+00004870: 7665 7320 3d20 5b5d 0a20 2020 2020 2020  ves = [].       
+00004880: 2069 6e66 696e 6974 655f 7072 696d 6974   infinite_primit
+00004890: 6976 6573 203d 205b 5d0a 2020 2020 2020  ives = [].      
+000048a0: 2020 6f66 6673 6574 5f69 6e74 6572 7365    offset_interse
+000048b0: 6374 696f 6e73 203d 205b 5d0a 2020 2020  ctions = [].    
+000048c0: 2020 2020 2320 6178 203d 2073 656c 662e      # ax = self.
+000048d0: 706c 6f74 2829 0a20 2020 2020 2020 2066  plot().        f
+000048e0: 6f72 2070 7269 6d69 7469 7665 2069 6e20  or primitive in 
+000048f0: 7365 6c66 2e70 7269 6d69 7469 7665 733a  self.primitives:
+00004900: 0a20 2020 2020 2020 2020 2020 2069 6e66  .            inf
+00004910: 696e 6974 655f 7072 696d 6974 6976 6520  inite_primitive 
+00004920: 3d20 7072 696d 6974 6976 652e 696e 6669  = primitive.infi
+00004930: 6e69 7465 5f70 7269 6d69 7469 7665 286f  nite_primitive(o
+00004940: 6666 7365 7429 0a20 2020 2020 2020 2020  ffset).         
+00004950: 2020 2069 6620 696e 6669 6e69 7465 5f70     if infinite_p
+00004960: 7269 6d69 7469 7665 2069 7320 6e6f 7420  rimitive is not 
+00004970: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00004980: 2020 2020 2020 696e 6669 6e69 7465 5f70        infinite_p
+00004990: 7269 6d69 7469 7665 732e 6170 7065 6e64  rimitives.append
+000049a0: 2869 6e66 696e 6974 655f 7072 696d 6974  (infinite_primit
+000049b0: 6976 6529 0a20 2020 2020 2020 206f 6666  ive).        off
+000049c0: 7365 745f 696e 7465 7273 6563 7469 6f6e  set_intersection
+000049d0: 7320 2b3d 2073 656c 662e 696e 6669 6e69  s += self.infini
+000049e0: 7465 5f69 6e74 6572 7365 6374 696f 6e73  te_intersections
+000049f0: 2869 6e66 696e 6974 655f 7072 696d 6974  (infinite_primit
+00004a00: 6976 6573 290a 2020 2020 2020 2020 666f  ives).        fo
+00004a10: 7220 692c 2028 706f 696e 7431 2c20 706f  r i, (point1, po
+00004a20: 696e 7432 2920 696e 2065 6e75 6d65 7261  int2) in enumera
+00004a30: 7465 287a 6970 286f 6666 7365 745f 696e  te(zip(offset_in
+00004a40: 7465 7273 6563 7469 6f6e 732c 0a20 2020  tersections,.   
+00004a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004a70: 2020 2020 2020 2020 2020 2020 2020 6f66                of
+00004a80: 6673 6574 5f69 6e74 6572 7365 6374 696f  fset_intersectio
+00004a90: 6e73 5b31 3a5d 202b 205b 6f66 6673 6574  ns[1:] + [offset
+00004aa0: 5f69 6e74 6572 7365 6374 696f 6e73 5b30  _intersections[0
+00004ab0: 5d5d 2929 3a0a 2020 2020 2020 2020 2020  ]])):.          
+00004ac0: 2020 6966 2069 202b 2031 203d 3d20 6c65    if i + 1 == le
+00004ad0: 6e28 6f66 6673 6574 5f69 6e74 6572 7365  n(offset_interse
+00004ae0: 6374 696f 6e73 293a 0a20 2020 2020 2020  ctions):.       
+00004af0: 2020 2020 2020 2020 2063 7574 7465 645f           cutted_
+00004b00: 7072 696d 6974 6976 6520 3d20 696e 6669  primitive = infi
+00004b10: 6e69 7465 5f70 7269 6d69 7469 7665 735b  nite_primitives[
+00004b20: 305d 2e63 7574 5f62 6574 7765 656e 5f74  0].cut_between_t
+00004b30: 776f 5f70 6f69 6e74 7328 706f 696e 7431  wo_points(point1
+00004b40: 2c20 706f 696e 7432 290a 2020 2020 2020  , point2).      
+00004b50: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00004b60: 2020 2020 2020 2020 2020 2020 6375 7474              cutt
+00004b70: 6564 5f70 7269 6d69 7469 7665 203d 2069  ed_primitive = i
+00004b80: 6e66 696e 6974 655f 7072 696d 6974 6976  nfinite_primitiv
+00004b90: 6573 5b69 202b 2031 5d2e 6375 745f 6265  es[i + 1].cut_be
+00004ba0: 7477 6565 6e5f 7477 6f5f 706f 696e 7473  tween_two_points
+00004bb0: 2870 6f69 6e74 312c 2070 6f69 6e74 3229  (point1, point2)
+00004bc0: 0a20 2020 2020 2020 2020 2020 206f 6666  .            off
+00004bd0: 7365 745f 7072 696d 6974 6976 6573 2e61  set_primitives.a
+00004be0: 7070 656e 6428 6375 7474 6564 5f70 7269  ppend(cutted_pri
+00004bf0: 6d69 7469 7665 290a 0a20 2020 2020 2020  mitive)..       
+00004c00: 2072 6574 7572 6e20 7365 6c66 2e5f 5f63   return self.__c
+00004c10: 6c61 7373 5f5f 286f 6666 7365 745f 7072  lass__(offset_pr
+00004c20: 696d 6974 6976 6573 290a 0a20 2020 2064  imitives)..    d
+00004c30: 6566 2070 6c6f 745f 6461 7461 2873 656c  ef plot_data(sel
+00004c40: 662c 206e 616d 653a 2073 7472 203d 2027  f, name: str = '
+00004c50: 272c 2066 696c 6c3d 4e6f 6e65 2c20 636f  ', fill=None, co
+00004c60: 6c6f 723d 2762 6c61 636b 272c 0a20 2020  lor='black',.   
+00004c70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00004c80: 7472 6f6b 655f 7769 6474 683a 2066 6c6f  troke_width: flo
+00004c90: 6174 203d 2031 2c20 6f70 6163 6974 793a  at = 1, opacity:
+00004ca0: 2066 6c6f 6174 203d 2031 293a 0a20 2020   float = 1):.   
+00004cb0: 2020 2020 2064 6174 6120 3d20 5b5d 0a20       data = []. 
+00004cc0: 2020 2020 2020 2066 6f72 2069 7465 6d20         for item 
+00004cd0: 696e 2073 656c 662e 7072 696d 6974 6976  in self.primitiv
+00004ce0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00004cf0: 6461 7461 2e61 7070 656e 6428 6974 656d  data.append(item
+00004d00: 2e70 6c6f 745f 6461 7461 2829 290a 2020  .plot_data()).  
+00004d10: 2020 2020 2020 7265 7475 726e 2064 6174        return dat
+00004d20: 610a 0a20 2020 2064 6566 206c 696e 655f  a..    def line_
+00004d30: 696e 7465 7273 6563 7469 6f6e 7328 7365  intersections(se
+00004d40: 6c66 2c20 6c69 6e65 3a20 2776 6f6c 6d64  lf, line: 'volmd
+00004d50: 6c72 2e65 6467 6573 2e4c 696e 6532 4427  lr.edges.Line2D'
+00004d60: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00004d70: 2020 2020 2020 2052 6574 7572 6e73 2061         Returns a
+00004d80: 206c 6973 7420 6f66 2069 6e74 6572 7365   list of interse
+00004d90: 6374 696f 6e20 6f66 2074 6865 2077 6972  ction of the wir
+00004da0: 6520 7072 696d 6974 6976 6573 2069 6e74  e primitives int
+00004db0: 6572 7365 6374 696e 6720 7769 7468 2074  ersecting with t
+00004dc0: 6865 206c 696e 652e 0a0a 2020 2020 2020  he line...      
+00004dd0: 2020 3a72 6574 7572 6e73 3a20 6120 7475    :returns: a tu
+00004de0: 706c 6520 2870 6f69 6e74 2c20 7072 696d  ple (point, prim
+00004df0: 6974 6976 6529 0a20 2020 2020 2020 2022  itive).        "
+00004e00: 2222 0a20 2020 2020 2020 2069 6e74 6572  "".        inter
+00004e10: 7365 6374 696f 6e5f 706f 696e 7473 203d  section_points =
+00004e20: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
+00004e30: 7072 696d 6974 6976 6520 696e 2073 656c  primitive in sel
+00004e40: 662e 7072 696d 6974 6976 6573 3a0a 2020  f.primitives:.  
+00004e50: 2020 2020 2020 2020 2020 666f 7220 706f            for po
+00004e60: 696e 7420 696e 2070 7269 6d69 7469 7665  int in primitive
+00004e70: 2e6c 696e 655f 696e 7465 7273 6563 7469  .line_intersecti
+00004e80: 6f6e 7328 6c69 6e65 293a 0a20 2020 2020  ons(line):.     
+00004e90: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
+00004ea0: 7365 6374 696f 6e5f 706f 696e 7473 2e61  section_points.a
+00004eb0: 7070 656e 6428 2870 6f69 6e74 2c20 7072  ppend((point, pr
+00004ec0: 696d 6974 6976 6529 290a 2020 2020 2020  imitive)).      
+00004ed0: 2020 7265 7475 726e 2069 6e74 6572 7365    return interse
+00004ee0: 6374 696f 6e5f 706f 696e 7473 0a0a 2020  ction_points..  
+00004ef0: 2020 6465 6620 6c69 6e65 7365 676d 656e    def linesegmen
+00004f00: 745f 696e 7465 7273 6563 7469 6f6e 7328  t_intersections(
+00004f10: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+00004f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f30: 2020 2020 2020 2020 6c69 6e65 7365 676d          linesegm
+00004f40: 656e 743a 2027 766f 6c6d 646c 722e 6564  ent: 'volmdlr.ed
+00004f50: 6765 732e 4c69 6e65 5365 676d 656e 7432  ges.LineSegment2
+00004f60: 4427 293a 0a20 2020 2020 2020 2022 2222  D'):.        """
+00004f70: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00004f80: 2061 206c 6973 7420 6f66 2069 6e74 6572   a list of inter
+00004f90: 7365 6374 696f 6e20 6f66 2074 6865 2077  section of the w
+00004fa0: 6972 6520 7072 696d 6974 6976 6573 2069  ire primitives i
+00004fb0: 6e74 6572 7365 6374 696e 6720 7769 7468  ntersecting with
+00004fc0: 2074 6865 206c 696e 6573 6567 6d65 6e74   the linesegment
+00004fd0: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
+00004fe0: 726e 733a 2061 2074 7570 6c65 2028 706f  rns: a tuple (po
+00004ff0: 696e 742c 2070 7269 6d69 7469 7665 290a  int, primitive).
+00005000: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00005010: 2020 2020 696e 7465 7273 6563 7469 6f6e      intersection
+00005020: 5f70 6f69 6e74 7320 3d20 5b5d 0a20 2020  _points = [].   
+00005030: 2020 2020 2066 6f72 2070 7269 6d69 7469       for primiti
+00005040: 7665 2069 6e20 7365 6c66 2e70 7269 6d69  ve in self.primi
+00005050: 7469 7665 733a 0a20 2020 2020 2020 2020  tives:.         
+00005060: 2020 2069 6e74 6572 7320 3d20 7072 696d     inters = prim
+00005070: 6974 6976 652e 6c69 6e65 7365 676d 656e  itive.linesegmen
+00005080: 745f 696e 7465 7273 6563 7469 6f6e 7328  t_intersections(
+00005090: 6c69 6e65 7365 676d 656e 7429 0a20 2020  linesegment).   
+000050a0: 2020 2020 2020 2020 2066 6f72 2070 6f69           for poi
+000050b0: 6e74 2069 6e20 696e 7465 7273 3a0a 2020  nt in inters:.  
+000050c0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000050d0: 7465 7273 6563 7469 6f6e 5f70 6f69 6e74  tersection_point
+000050e0: 732e 6170 7065 6e64 2828 706f 696e 742c  s.append((point,
+000050f0: 2070 7269 6d69 7469 7665 2929 0a20 2020   primitive)).   
+00005100: 2020 2020 2072 6574 7572 6e20 696e 7465       return inte
+00005110: 7273 6563 7469 6f6e 5f70 6f69 6e74 730a  rsection_points.
+00005120: 0a20 2020 2064 6566 2069 735f 7374 6172  .    def is_star
+00005130: 745f 656e 645f 6372 6f73 7369 6e67 735f  t_end_crossings_
+00005140: 7661 6c69 6428 7365 6c66 2c20 6c69 6e65  valid(self, line
+00005150: 2c20 696e 7465 7273 6563 7469 6f6e 732c  , intersections,
+00005160: 2070 7269 6d69 7469 7665 293a 0a20 2020   primitive):.   
+00005170: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00005180: 2052 6574 7572 6e73 2069 6620 7468 6520   Returns if the 
+00005190: 6372 6f73 7369 6e67 7320 6172 6520 7661  crossings are va
+000051a0: 6c69 642e 0a0a 2020 2020 2020 2020 3a70  lid...        :p
+000051b0: 6172 616d 206c 696e 653a 2063 726f 7373  aram line: cross
+000051c0: 696e 6720 6c69 6e65 0a20 2020 2020 2020  ing line.       
+000051d0: 203a 7061 7261 6d20 696e 7465 7273 6563   :param intersec
+000051e0: 7469 6f6e 733a 2069 6e74 6572 7365 6374  tions: intersect
+000051f0: 696f 6e73 2072 6573 756c 7473 0a20 2020  ions results.   
+00005200: 2020 2020 2020 666f 7220 7072 696d 6974        for primit
+00005210: 6976 6520 6c69 6e65 2069 6e74 6572 7365  ive line interse
+00005220: 6374 696f 6e73 0a20 2020 2020 2020 203a  ctions.        :
+00005230: 7061 7261 6d20 7072 696d 6974 6976 653a  param primitive:
+00005240: 2069 6e74 6572 7365 6374 696e 6720 7072   intersecting pr
+00005250: 696d 6974 6976 650a 2020 2020 2020 2020  imitive.        
+00005260: 3a72 6574 7572 6e3a 204e 6f6e 6520 6966  :return: None if
+00005270: 2069 6e74 6572 7365 6374 696f 6e20 6e6f   intersection no
+00005280: 7420 6120 7374 6172 7420 6f72 0a20 2020  t a start or.   
+00005290: 2020 2020 2065 6e64 2070 6f69 6e74 206f       end point o
+000052a0: 6620 6120 636f 6e74 6f75 7273 2070 7269  f a contours pri
+000052b0: 6d69 7469 7665 732c 206f 7220 6120 766f  mitives, or a vo
+000052c0: 6c6d 646c 722e 506f 696e 7432 4420 6966  lmdlr.Point2D if
+000052d0: 2069 7420 6973 2e0a 2020 2020 2020 2020   it is..        
+000052e0: 2222 220a 2020 2020 2020 2020 7072 696d  """.        prim
+000052f0: 6974 6976 655f 696e 6465 7820 3d20 7365  itive_index = se
+00005300: 6c66 2e70 7269 6d69 7469 7665 732e 696e  lf.primitives.in
+00005310: 6465 7828 7072 696d 6974 6976 6529 0a20  dex(primitive). 
+00005320: 2020 2020 2020 2070 6f69 6e74 312c 2070         point1, p
+00005330: 6f69 6e74 3220 3d20 4e6f 6e65 2c20 4e6f  oint2 = None, No
+00005340: 6e65 0a20 2020 2020 2020 2069 6620 696e  ne.        if in
+00005350: 7465 7273 6563 7469 6f6e 735b 305d 203d  tersections[0] =
+00005360: 3d20 7072 696d 6974 6976 652e 7374 6172  = primitive.star
+00005370: 743a 0a20 2020 2020 2020 2020 2020 2070  t:.            p
+00005380: 6f69 6e74 3120 3d20 7072 696d 6974 6976  oint1 = primitiv
+00005390: 652e 706f 696e 745f 6174 5f61 6273 6369  e.point_at_absci
+000053a0: 7373 6128 7072 696d 6974 6976 652e 6c65  ssa(primitive.le
+000053b0: 6e67 7468 2829 202a 2030 2e30 3129 0a20  ngth() * 0.01). 
+000053c0: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
+000053d0: 3220 3d20 7365 6c66 2e70 7269 6d69 7469  2 = self.primiti
+000053e0: 7665 735b 7072 696d 6974 6976 655f 696e  ves[primitive_in
+000053f0: 6465 7820 2d20 315d 2e70 6f69 6e74 5f61  dex - 1].point_a
+00005400: 745f 6162 7363 6973 7361 280a 2020 2020  t_abscissa(.    
+00005410: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005420: 2e70 7269 6d69 7469 7665 735b 7072 696d  .primitives[prim
+00005430: 6974 6976 655f 696e 6465 7820 2d20 315d  itive_index - 1]
+00005440: 2e6c 656e 6774 6828 2920 2a20 2e39 390a  .length() * .99.
+00005450: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00005460: 2020 2020 2020 2020 2020 2023 2070 6f69             # poi
+00005470: 6e74 3220 3d20 7072 696d 6974 6976 652e  nt2 = primitive.
+00005480: 7374 6172 7420 2b20 5c0a 2020 2020 2020  start + \.      
+00005490: 2020 2020 2020 2320 2020 2020 2020 2020        #         
+000054a0: 2073 656c 662e 7072 696d 6974 6976 6573   self.primitives
+000054b0: 5b70 7269 6d69 7469 7665 5f69 6e64 6578  [primitive_index
+000054c0: 202d 2031 5d2e 756e 6974 5f64 6972 6563   - 1].unit_direc
+000054d0: 7469 6f6e 5f76 6563 746f 7228 302e 3529  tion_vector(0.5)
+000054e0: 0a20 2020 2020 2020 2065 6c69 6620 696e  .        elif in
+000054f0: 7465 7273 6563 7469 6f6e 735b 305d 203d  tersections[0] =
+00005500: 3d20 7072 696d 6974 6976 652e 656e 6420  = primitive.end 
+00005510: 616e 6420 5c0a 2020 2020 2020 2020 2020  and \.          
+00005520: 2020 2020 2020 7072 696d 6974 6976 6520        primitive 
+00005530: 213d 2073 656c 662e 7072 696d 6974 6976  != self.primitiv
+00005540: 6573 5b2d 315d 3a0a 2020 2020 2020 2020  es[-1]:.        
+00005550: 2020 2020 706f 696e 7431 203d 2070 7269      point1 = pri
+00005560: 6d69 7469 7665 2e70 6f69 6e74 5f61 745f  mitive.point_at_
+00005570: 6162 7363 6973 7361 2870 7269 6d69 7469  abscissa(primiti
+00005580: 7665 2e6c 656e 6774 6828 2920 2a20 302e  ve.length() * 0.
+00005590: 3939 290a 2020 2020 2020 2020 2020 2020  99).            
+000055a0: 706f 696e 7432 203d 2073 656c 662e 7072  point2 = self.pr
+000055b0: 696d 6974 6976 6573 5b70 7269 6d69 7469  imitives[primiti
+000055c0: 7665 5f69 6e64 6578 202b 2031 5d2e 706f  ve_index + 1].po
+000055d0: 696e 745f 6174 5f61 6273 6369 7373 6128  int_at_abscissa(
+000055e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000055f0: 2073 656c 662e 7072 696d 6974 6976 6573   self.primitives
+00005600: 5b70 7269 6d69 7469 7665 5f69 6e64 6578  [primitive_index
+00005610: 202b 2031 5d2e 6c65 6e67 7468 2829 202a   + 1].length() *
+00005620: 202e 3031 290a 0a20 2020 2020 2020 2020   .01)..         
+00005630: 2020 2023 2070 6f69 6e74 3220 3d20 7072     # point2 = pr
+00005640: 696d 6974 6976 652e 656e 6420 2b20 5c0a  imitive.end + \.
+00005650: 2020 2020 2020 2020 2020 2020 2320 2020              #   
+00005660: 2020 2020 2020 2073 656c 662e 7072 696d         self.prim
+00005670: 6974 6976 6573 5b70 7269 6d69 7469 7665  itives[primitive
+00005680: 5f69 6e64 6578 202b 2031 5d2e 756e 6974  _index + 1].unit
+00005690: 5f64 6972 6563 7469 6f6e 5f76 6563 746f  _direction_vecto
+000056a0: 7228 302e 3529 0a20 2020 2020 2020 2069  r(0.5).        i
+000056b0: 6620 706f 696e 7431 2069 7320 6e6f 7420  f point1 is not 
+000056c0: 4e6f 6e65 2061 6e64 2070 6f69 6e74 3220  None and point2 
+000056d0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000056e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000056f0: 6c69 6e65 2e69 735f 6265 7477 6565 6e5f  line.is_between_
+00005700: 706f 696e 7473 2870 6f69 6e74 312c 2070  points(point1, p
+00005710: 6f69 6e74 3229 0a20 2020 2020 2020 2072  oint2).        r
+00005720: 6574 7572 6e20 4661 6c73 650a 0a20 2020  eturn False..   
+00005730: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+00005740: 2020 2064 6566 2069 735f 6372 6f73 7369     def is_crossi
+00005750: 6e67 5f73 7461 7274 5f65 6e64 5f70 6f69  ng_start_end_poi
+00005760: 6e74 2869 6e74 6572 7365 6374 696f 6e73  nt(intersections
+00005770: 2c20 7072 696d 6974 6976 6529 3a0a 2020  , primitive):.  
+00005780: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00005790: 2020 5265 7475 726e 7320 5472 7565 2069    Returns True i
+000057a0: 6620 7468 6520 6372 6f73 7369 6e67 7320  f the crossings 
+000057b0: 7072 6f76 6964 6564 2061 7265 7374 6172  provided arestar
+000057c0: 7420 6f72 2065 6e64 206f 6620 7468 6520  t or end of the 
+000057d0: 5769 7265 3244 2e0a 0a20 2020 2020 2020  Wire2D...       
+000057e0: 203a 7061 7261 6d20 696e 7465 7273 6563   :param intersec
+000057f0: 7469 6f6e 733a 2069 6e74 6572 7365 6374  tions: intersect
+00005800: 696f 6e73 2072 6573 756c 7473 0a20 2020  ions results.   
+00005810: 2020 2020 2020 666f 7220 7072 696d 6974        for primit
+00005820: 6976 6520 6c69 6e65 2069 6e74 6572 7365  ive line interse
+00005830: 6374 696f 6e73 0a20 2020 2020 2020 203a  ctions.        :
+00005840: 7061 7261 6d20 7072 696d 6974 6976 653a  param primitive:
+00005850: 2069 6e74 6572 7365 6374 696e 6720 7072   intersecting pr
+00005860: 696d 6974 6976 650a 2020 2020 2020 2020  imitive.        
+00005870: 3a72 6574 7572 6e3a 2046 616c 7365 2069  :return: False i
+00005880: 6620 696e 7465 7273 6563 7469 6f6e 206e  f intersection n
+00005890: 6f74 2061 2073 7461 7274 206f 720a 2020  ot a start or.  
+000058a0: 2020 2020 2020 656e 6420 706f 696e 7420        end point 
+000058b0: 6f66 2061 2063 6f6e 746f 7572 7320 7072  of a contours pr
+000058c0: 696d 6974 6976 6573 2c20 6f72 2054 7275  imitives, or Tru
+000058d0: 6520 6966 2069 7420 6973 2e0a 2020 2020  e if it is..    
+000058e0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000058f0: 6966 2069 6e74 6572 7365 6374 696f 6e73  if intersections
+00005900: 5b30 5d20 3d3d 2070 7269 6d69 7469 7665  [0] == primitive
+00005910: 2e73 7461 7274 206f 7220 696e 7465 7273  .start or inters
+00005920: 6563 7469 6f6e 735b 305d 203d 3d20 7072  ections[0] == pr
+00005930: 696d 6974 6976 652e 656e 643a 0a20 2020  imitive.end:.   
+00005940: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00005950: 5472 7565 0a20 2020 2020 2020 2072 6574  True.        ret
+00005960: 7572 6e20 4661 6c73 650a 0a20 2020 2064  urn False..    d
+00005970: 6566 206c 696e 655f 6372 6f73 7369 6e67  ef line_crossing
+00005980: 7328 7365 6c66 2c20 6c69 6e65 3a20 766f  s(self, line: vo
+00005990: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
+000059a0: 3244 293a 0a20 2020 2020 2020 2022 2222  2D):.        """
+000059b0: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
+000059c0: 7465 7320 7661 6c69 6420 6372 6f73 7369  tes valid crossi
+000059d0: 6e67 2069 6e74 6572 7365 6374 696f 6e73  ng intersections
+000059e0: 206f 6620 6120 7769 7265 2061 6e64 2061   of a wire and a
+000059f0: 6e20 696e 6669 6e69 7465 206c 696e 652e  n infinite line.
+00005a00: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00005a10: 206c 696e 653a 206c 696e 6520 6372 6f73   line: line cros
+00005a20: 7369 6e67 2074 6865 2077 6972 650a 2020  sing the wire.  
+00005a30: 2020 2020 2020 3a74 7970 6520 6c69 6e65        :type line
+00005a40: 3a20 766f 6c6d 646c 722e 6564 6765 732e  : volmdlr.edges.
+00005a50: 4c69 6e65 3244 0a20 2020 2020 2020 2072  Line2D.        r
+00005a60: 6574 7572 6e73 2061 206c 6973 7420 6f66  eturns a list of
+00005a70: 2054 7570 6c65 7320 2870 6f69 6e74 2c20   Tuples (point, 
+00005a80: 7072 696d 6974 6976 6529 0a20 2020 2020  primitive).     
+00005a90: 2020 206f 6620 7468 6520 7769 7265 2070     of the wire p
+00005aa0: 7269 6d69 7469 7665 7320 696e 7465 7273  rimitives inters
+00005ab0: 6563 7469 6e67 2077 6974 6820 7468 6520  ecting with the 
+00005ac0: 6c69 6e65 0a20 2020 2020 2020 2022 2222  line.        """
+00005ad0: 0a20 2020 2020 2020 2069 6e74 6572 7365  .        interse
+00005ae0: 6374 696f 6e5f 706f 696e 7473 203d 205b  ction_points = [
+00005af0: 5d0a 2020 2020 2020 2020 696e 7465 7273  ].        inters
+00005b00: 6563 7469 6f6e 5f70 6f69 6e74 735f 7072  ection_points_pr
+00005b10: 696d 6974 6976 6573 203d 205b 5d0a 2020  imitives = [].  
+00005b20: 2020 2020 2020 666f 7220 7072 696d 6974        for primit
+00005b30: 6976 6520 696e 2073 656c 662e 7072 696d  ive in self.prim
+00005b40: 6974 6976 6573 3a0a 2020 2020 2020 2020  itives:.        
+00005b50: 2020 2020 696e 7465 7273 6563 7469 6f6e      intersection
+00005b60: 7320 3d20 7072 696d 6974 6976 652e 6c69  s = primitive.li
+00005b70: 6e65 5f69 6e74 6572 7365 6374 696f 6e73  ne_intersections
+00005b80: 286c 696e 6529 0a20 2020 2020 2020 2020  (line).         
+00005b90: 2020 2066 6f72 2069 6e74 6572 7365 6374     for intersect
+00005ba0: 696f 6e20 696e 2069 6e74 6572 7365 6374  ion in intersect
+00005bb0: 696f 6e73 3a0a 2020 2020 2020 2020 2020  ions:.          
+00005bc0: 2020 2020 2020 6966 2069 6e74 6572 7365        if interse
+00005bd0: 6374 696f 6e20 6e6f 7420 696e 2069 6e74  ction not in int
+00005be0: 6572 7365 6374 696f 6e5f 706f 696e 7473  ersection_points
+00005bf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00005c00: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+00005c10: 662e 6973 5f63 726f 7373 696e 675f 7374  f.is_crossing_st
+00005c20: 6172 745f 656e 645f 706f 696e 7428 696e  art_end_point(in
+00005c30: 7465 7273 6563 7469 6f6e 732c 2070 7269  tersections, pri
+00005c40: 6d69 7469 7665 293a 0a20 2020 2020 2020  mitive):.       
+00005c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005c60: 2069 6e74 6572 7365 6374 696f 6e5f 706f   intersection_po
+00005c70: 696e 7473 2e61 7070 656e 6428 696e 7465  ints.append(inte
+00005c80: 7273 6563 7469 6f6e 290a 2020 2020 2020  rsection).      
+00005c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ca0: 2020 696e 7465 7273 6563 7469 6f6e 5f70    intersection_p
+00005cb0: 6f69 6e74 735f 7072 696d 6974 6976 6573  oints_primitives
+00005cc0: 2e61 7070 656e 6428 2869 6e74 6572 7365  .append((interse
+00005cd0: 6374 696f 6e2c 2070 7269 6d69 7469 7665  ction, primitive
+00005ce0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00005cf0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00005d00: 2e69 735f 7374 6172 745f 656e 645f 6372  .is_start_end_cr
+00005d10: 6f73 7369 6e67 735f 7661 6c69 6428 6c69  ossings_valid(li
+00005d20: 6e65 2c20 696e 7465 7273 6563 7469 6f6e  ne, intersection
+00005d30: 732c 2070 7269 6d69 7469 7665 293a 0a20  s, primitive):. 
+00005d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d50: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
+00005d60: 696f 6e5f 706f 696e 7473 2e61 7070 656e  ion_points.appen
+00005d70: 6428 696e 7465 7273 6563 7469 6f6e 290a  d(intersection).
 00005d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d90: 696e 7465 7273 6563 7469 6f6e 5f70 6f69  intersection_poi
-00005da0: 6e74 735f 7072 696d 6974 6976 6573 2e61  nts_primitives.a
-00005db0: 7070 656e 6428 2869 6e74 6572 7365 6374  ppend((intersect
-00005dc0: 696f 6e2c 2070 7269 6d69 7469 7665 2929  ion, primitive))
-00005dd0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00005de0: 696e 7465 7273 6563 7469 6f6e 5f70 6f69  intersection_poi
-00005df0: 6e74 735f 7072 696d 6974 6976 6573 0a0a  nts_primitives..
-00005e00: 2020 2020 6465 6620 7769 7265 5f69 6e74      def wire_int
-00005e10: 6572 7365 6374 696f 6e73 2873 656c 662c  ersections(self,
-00005e20: 2077 6972 6529 3a0a 2020 2020 2020 2020   wire):.        
-00005e30: 2222 220a 2020 2020 2020 2020 436f 6d70  """.        Comp
-00005e40: 7574 6520 696e 7465 7273 6563 7469 6f6e  ute intersection
-00005e50: 7320 6265 7477 6565 6e20 7477 6f20 7769  s between two wi
-00005e60: 7265 2032 642e 0a0a 2020 2020 2020 2020  re 2d...        
-00005e70: 3a70 6172 616d 2077 6972 6520 3a20 766f  :param wire : vo
-00005e80: 6c6d 646c 722e 7769 7265 732e 5769 7265  lmdlr.wires.Wire
-00005e90: 3244 2e0a 2020 2020 2020 2020 3a72 6574  2D..        :ret
-00005ea0: 7572 6e3a 2069 6e74 6572 7365 6374 696f  urn: intersectio
-00005eb0: 6e73 203a 204c 6973 745b 2876 6f6c 6d64  ns : List[(volmd
-00005ec0: 6c72 2e50 6f69 6e74 3244 2c20 766f 6c6d  lr.Point2D, volm
-00005ed0: 646c 722e 5072 696d 6974 6976 6532 4429  dlr.Primitive2D)
-00005ee0: 5d0a 2020 2020 2020 2020 2222 220a 2020  ].        """.  
-00005ef0: 2020 2020 2020 696e 7465 7273 6563 7469        intersecti
-00005f00: 6f6e 732c 2069 6e74 6572 7365 6374 696f  ons, intersectio
-00005f10: 6e73 5f70 6f69 6e74 7320 3d20 5b5d 2c20  ns_points = [], 
-00005f20: 5b5d 0a20 2020 2020 2020 2066 6f72 2070  [].        for p
-00005f30: 7269 6d69 7469 7665 2069 6e20 7769 7265  rimitive in wire
-00005f40: 2e70 7269 6d69 7469 7665 733a 0a20 2020  .primitives:.   
-00005f50: 2020 2020 2020 2020 206d 6574 686f 645f           method_
-00005f60: 6e61 6d65 203d 2066 277b 7072 696d 6974  name = f'{primit
-00005f70: 6976 652e 5f5f 636c 6173 735f 5f2e 5f5f  ive.__class__.__
-00005f80: 6e61 6d65 5f5f 2e6c 6f77 6572 2829 5b30  name__.lower()[0
-00005f90: 3a2d 325d 7d5f 696e 7465 7273 6563 7469  :-2]}_intersecti
-00005fa0: 6f6e 7327 0a0a 2020 2020 2020 2020 2020  ons'..          
-00005fb0: 2020 6966 2068 6173 6174 7472 2873 656c    if hasattr(sel
-00005fc0: 662c 206d 6574 686f 645f 6e61 6d65 293a  f, method_name):
-00005fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005fe0: 2061 5f70 6f69 6e74 7320 3d20 6765 7461   a_points = geta
-00005ff0: 7474 7228 7365 6c66 2c20 6d65 7468 6f64  ttr(self, method
-00006000: 5f6e 616d 6529 2870 7269 6d69 7469 7665  _name)(primitive
-00006010: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00006020: 2020 2320 615f 706f 696e 7473 203d 2073    # a_points = s
-00006030: 656c 662e 6c69 6e65 7365 676d 656e 745f  elf.linesegment_
-00006040: 696e 7465 7273 6563 7469 6f6e 7328 7072  intersections(pr
-00006050: 696d 6974 6976 6529 0a20 2020 2020 2020  imitive).       
-00006060: 2020 2020 2020 2020 2069 6620 615f 706f           if a_po
-00006070: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
-00006080: 2020 2020 2020 2020 2020 666f 7220 706f            for po
-00006090: 696e 7431 2c20 706f 696e 7432 2069 6e20  int1, point2 in 
-000060a0: 615f 706f 696e 7473 3a0a 2020 2020 2020  a_points:.      
-000060b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000060c0: 2020 6966 2070 6f69 6e74 3120 6e6f 7420    if point1 not 
-000060d0: 696e 2069 6e74 6572 7365 6374 696f 6e73  in intersections
-000060e0: 5f70 6f69 6e74 733a 0a20 2020 2020 2020  _points:.       
-000060f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006100: 2020 2020 2069 6e74 6572 7365 6374 696f       intersectio
-00006110: 6e73 2e61 7070 656e 6428 5b70 6f69 6e74  ns.append([point
-00006120: 312c 2070 6f69 6e74 325d 290a 2020 2020  1, point2]).    
-00006130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006140: 2020 2020 2020 2020 696e 7465 7273 6563          intersec
-00006150: 7469 6f6e 735f 706f 696e 7473 2e61 7070  tions_points.app
-00006160: 656e 6428 706f 696e 7431 290a 2020 2020  end(point1).    
-00006170: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00006180: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00006190: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-000061a0: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
-000061b0: 2020 2020 2020 2020 2020 2020 2066 2743               f'C
-000061c0: 6c61 7373 207b 7365 6c66 2e5f 5f63 6c61  lass {self.__cla
-000061d0: 7373 5f5f 2e5f 5f6e 616d 655f 5f7d 2064  ss__.__name__} d
-000061e0: 6f65 7320 6e6f 7420 696d 706c 656d 656e  oes not implemen
-000061f0: 7420 7b6d 6574 686f 645f 6e61 6d65 7d27  t {method_name}'
-00006200: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00006210: 6e20 696e 7465 7273 6563 7469 6f6e 730a  n intersections.
-00006220: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-00006230: 640a 2020 2020 6465 6620 6672 6f6d 5f70  d.    def from_p
-00006240: 6f69 6e74 7328 636c 732c 2070 6f69 6e74  oints(cls, point
-00006250: 733a 204c 6973 745b 766f 6c6d 646c 722e  s: List[volmdlr.
-00006260: 506f 696e 7432 445d 293a 0a20 2020 2020  Point2D]):.     
-00006270: 2020 2022 2222 0a20 2020 2020 2020 2044     """.        D
-00006280: 6566 696e 6520 6120 7769 7265 2062 6173  efine a wire bas
-00006290: 6564 206f 6e20 706f 696e 7473 3264 2077  ed on points2d w
-000062a0: 6974 6820 6c69 6e65 5f73 6567 6d65 6e74  ith line_segment
-000062b0: 7332 642e 0a0a 2020 2020 2020 2020 3a70  s2d...        :p
-000062c0: 6172 616d 2070 6f69 6e74 733a 2070 6f69  aram points: poi
-000062d0: 6e74 7320 746f 2064 6566 696e 6520 7769  nts to define wi
-000062e0: 7265 2032 642e 0a20 2020 2020 2020 2022  re 2d..        "
-000062f0: 2222 0a20 2020 2020 2020 2065 6467 6573  "".        edges
-00006300: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-00006310: 7220 6920 696e 2072 616e 6765 2830 2c20  r i in range(0, 
-00006320: 6c65 6e28 706f 696e 7473 2920 2d20 3129  len(points) - 1)
-00006330: 3a0a 2020 2020 2020 2020 2020 2020 6564  :.            ed
-00006340: 6765 732e 6170 7065 6e64 2876 6f6c 6d64  ges.append(volmd
-00006350: 6c72 2e65 6467 6573 2e4c 696e 6553 6567  lr.edges.LineSeg
-00006360: 6d65 6e74 3244 2870 6f69 6e74 735b 695d  ment2D(points[i]
-00006370: 2c20 706f 696e 7473 5b69 202b 2031 5d29  , points[i + 1])
-00006380: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00006390: 6e20 636c 7328 6564 6765 7329 0a0a 2020  n cls(edges)..  
-000063a0: 2020 6465 6620 6c69 6e65 7365 676d 656e    def linesegmen
-000063b0: 745f 6372 6f73 7369 6e67 7328 7365 6c66  t_crossings(self
-000063c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00005d90: 2020 2020 2020 2020 696e 7465 7273 6563          intersec
+00005da0: 7469 6f6e 5f70 6f69 6e74 735f 7072 696d  tion_points_prim
+00005db0: 6974 6976 6573 2e61 7070 656e 6428 2869  itives.append((i
+00005dc0: 6e74 6572 7365 6374 696f 6e2c 2070 7269  ntersection, pri
+00005dd0: 6d69 7469 7665 2929 0a20 2020 2020 2020  mitive)).       
+00005de0: 2072 6574 7572 6e20 696e 7465 7273 6563   return intersec
+00005df0: 7469 6f6e 5f70 6f69 6e74 735f 7072 696d  tion_points_prim
+00005e00: 6974 6976 6573 0a0a 2020 2020 6465 6620  itives..    def 
+00005e10: 7769 7265 5f69 6e74 6572 7365 6374 696f  wire_intersectio
+00005e20: 6e73 2873 656c 662c 2077 6972 6529 3a0a  ns(self, wire):.
+00005e30: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00005e40: 2020 2020 436f 6d70 7574 6520 696e 7465      Compute inte
+00005e50: 7273 6563 7469 6f6e 7320 6265 7477 6565  rsections betwee
+00005e60: 6e20 7477 6f20 7769 7265 2032 642e 0a0a  n two wire 2d...
+00005e70: 2020 2020 2020 2020 3a70 6172 616d 2077          :param w
+00005e80: 6972 6520 3a20 766f 6c6d 646c 722e 7769  ire : volmdlr.wi
+00005e90: 7265 732e 5769 7265 3244 2e0a 2020 2020  res.Wire2D..    
+00005ea0: 2020 2020 3a72 6574 7572 6e3a 2069 6e74      :return: int
+00005eb0: 6572 7365 6374 696f 6e73 203a 204c 6973  ersections : Lis
+00005ec0: 745b 2876 6f6c 6d64 6c72 2e50 6f69 6e74  t[(volmdlr.Point
+00005ed0: 3244 2c20 766f 6c6d 646c 722e 5072 696d  2D, volmdlr.Prim
+00005ee0: 6974 6976 6532 4429 5d0a 2020 2020 2020  itive2D)].      
+00005ef0: 2020 2222 220a 2020 2020 2020 2020 696e    """.        in
+00005f00: 7465 7273 6563 7469 6f6e 732c 2069 6e74  tersections, int
+00005f10: 6572 7365 6374 696f 6e73 5f70 6f69 6e74  ersections_point
+00005f20: 7320 3d20 5b5d 2c20 5b5d 0a20 2020 2020  s = [], [].     
+00005f30: 2020 2066 6f72 2070 7269 6d69 7469 7665     for primitive
+00005f40: 2069 6e20 7769 7265 2e70 7269 6d69 7469   in wire.primiti
+00005f50: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
+00005f60: 206d 6574 686f 645f 6e61 6d65 203d 2066   method_name = f
+00005f70: 277b 7072 696d 6974 6976 652e 5f5f 636c  '{primitive.__cl
+00005f80: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2e6c  ass__.__name__.l
+00005f90: 6f77 6572 2829 5b30 3a2d 325d 7d5f 696e  ower()[0:-2]}_in
+00005fa0: 7465 7273 6563 7469 6f6e 7327 0a0a 2020  tersections'..  
+00005fb0: 2020 2020 2020 2020 2020 6966 2068 6173            if has
+00005fc0: 6174 7472 2873 656c 662c 206d 6574 686f  attr(self, metho
+00005fd0: 645f 6e61 6d65 293a 0a20 2020 2020 2020  d_name):.       
+00005fe0: 2020 2020 2020 2020 2061 5f70 6f69 6e74           a_point
+00005ff0: 7320 3d20 6765 7461 7474 7228 7365 6c66  s = getattr(self
+00006000: 2c20 6d65 7468 6f64 5f6e 616d 6529 2870  , method_name)(p
+00006010: 7269 6d69 7469 7665 290a 2020 2020 2020  rimitive).      
+00006020: 2020 2020 2020 2020 2020 2320 615f 706f            # a_po
+00006030: 696e 7473 203d 2073 656c 662e 6c69 6e65  ints = self.line
+00006040: 7365 676d 656e 745f 696e 7465 7273 6563  segment_intersec
+00006050: 7469 6f6e 7328 7072 696d 6974 6976 6529  tions(primitive)
+00006060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006070: 2069 6620 615f 706f 696e 7473 3a0a 2020   if a_points:.  
+00006080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006090: 2020 666f 7220 706f 696e 7431 2c20 706f    for point1, po
+000060a0: 696e 7432 2069 6e20 615f 706f 696e 7473  int2 in a_points
+000060b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000060c0: 2020 2020 2020 2020 2020 6966 2070 6f69            if poi
+000060d0: 6e74 3120 6e6f 7420 696e 2069 6e74 6572  nt1 not in inter
+000060e0: 7365 6374 696f 6e73 5f70 6f69 6e74 733a  sections_points:
+000060f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006100: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+00006110: 6572 7365 6374 696f 6e73 2e61 7070 656e  ersections.appen
+00006120: 6428 5b70 6f69 6e74 312c 2070 6f69 6e74  d([point1, point
+00006130: 325d 290a 2020 2020 2020 2020 2020 2020  2]).            
+00006140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006150: 696e 7465 7273 6563 7469 6f6e 735f 706f  intersections_po
+00006160: 696e 7473 2e61 7070 656e 6428 706f 696e  ints.append(poin
+00006170: 7431 290a 2020 2020 2020 2020 2020 2020  t1).            
+00006180: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00006190: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+000061a0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+000061b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000061c0: 2020 2020 2066 2743 6c61 7373 207b 7365       f'Class {se
+000061d0: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
+000061e0: 616d 655f 5f7d 2064 6f65 7320 6e6f 7420  ame__} does not 
+000061f0: 696d 706c 656d 656e 7420 7b6d 6574 686f  implement {metho
+00006200: 645f 6e61 6d65 7d27 290a 0a20 2020 2020  d_name}')..     
+00006210: 2020 2072 6574 7572 6e20 696e 7465 7273     return inters
+00006220: 6563 7469 6f6e 730a 0a20 2020 2040 636c  ections..    @cl
+00006230: 6173 736d 6574 686f 640a 2020 2020 6465  assmethod.    de
+00006240: 6620 6672 6f6d 5f70 6f69 6e74 7328 636c  f from_points(cl
+00006250: 732c 2070 6f69 6e74 733a 204c 6973 745b  s, points: List[
+00006260: 766f 6c6d 646c 722e 506f 696e 7432 445d  volmdlr.Point2D]
+00006270: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00006280: 2020 2020 2020 2044 6566 696e 6520 6120         Define a 
+00006290: 7769 7265 2062 6173 6564 206f 6e20 706f  wire based on po
+000062a0: 696e 7473 3264 2077 6974 6820 6c69 6e65  ints2d with line
+000062b0: 5f73 6567 6d65 6e74 7332 642e 0a0a 2020  _segments2d...  
+000062c0: 2020 2020 2020 3a70 6172 616d 2070 6f69        :param poi
+000062d0: 6e74 733a 2070 6f69 6e74 7320 746f 2064  nts: points to d
+000062e0: 6566 696e 6520 7769 7265 2032 642e 0a20  efine wire 2d.. 
+000062f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00006300: 2020 2065 6467 6573 203d 205b 5d0a 2020     edges = [].  
+00006310: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00006320: 616e 6765 2830 2c20 6c65 6e28 706f 696e  ange(0, len(poin
+00006330: 7473 2920 2d20 3129 3a0a 2020 2020 2020  ts) - 1):.      
+00006340: 2020 2020 2020 6564 6765 732e 6170 7065        edges.appe
+00006350: 6e64 2876 6f6c 6d64 6c72 2e65 6467 6573  nd(volmdlr.edges
+00006360: 2e4c 696e 6553 6567 6d65 6e74 3244 2870  .LineSegment2D(p
+00006370: 6f69 6e74 735b 695d 2c20 706f 696e 7473  oints[i], points
+00006380: 5b69 202b 2031 5d29 290a 0a20 2020 2020  [i + 1]))..     
+00006390: 2020 2072 6574 7572 6e20 636c 7328 6564     return cls(ed
+000063a0: 6765 7329 0a0a 2020 2020 6465 6620 6c69  ges)..    def li
+000063b0: 6e65 7365 676d 656e 745f 6372 6f73 7369  nesegment_crossi
+000063c0: 6e67 7328 7365 6c66 2c0a 2020 2020 2020  ngs(self,.      
 000063d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000063e0: 6c69 6e65 7365 676d 656e 743a 2027 766f  linesegment: 'vo
-000063f0: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
-00006400: 5365 676d 656e 7432 4427 293a 0a20 2020  Segment2D'):.   
-00006410: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00006420: 2052 6574 7572 6e73 2061 206c 6973 7420   Returns a list 
-00006430: 6f66 2063 726f 7373 696e 6773 2069 6e20  of crossings in 
-00006440: 7468 6520 666f 726d 206f 6620 6120 7475  the form of a tu
-00006450: 706c 6520 2870 6f69 6e74 2c0a 2020 2020  ple (point,.    
-00006460: 2020 2020 7072 696d 6974 6976 6529 206f      primitive) o
-00006470: 6620 7468 6520 7769 7265 2070 7269 6d69  f the wire primi
-00006480: 7469 7665 7320 696e 7465 7273 6563 7469  tives intersecti
-00006490: 6e67 2077 6974 6820 7468 6520 6c69 6e65  ng with the line
-000064a0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000064b0: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
-000064c0: 7365 6c66 2e6c 696e 655f 6372 6f73 7369  self.line_crossi
-000064d0: 6e67 7328 6c69 6e65 7365 676d 656e 742e  ngs(linesegment.
-000064e0: 746f 5f6c 696e 6528 2929 0a20 2020 2020  to_line()).     
-000064f0: 2020 2063 726f 7373 696e 6773 5f70 6f69     crossings_poi
-00006500: 6e74 7320 3d20 5b5d 0a20 2020 2020 2020  nts = [].       
-00006510: 2066 6f72 2072 6573 756c 7420 696e 2072   for result in r
-00006520: 6573 756c 7473 3a0a 2020 2020 2020 2020  esults:.        
-00006530: 2020 2020 6966 206c 696e 6573 6567 6d65      if linesegme
-00006540: 6e74 2e70 6f69 6e74 5f62 656c 6f6e 6773  nt.point_belongs
-00006550: 2872 6573 756c 745b 305d 293a 0a20 2020  (result[0]):.   
-00006560: 2020 2020 2020 2020 2020 2020 2063 726f               cro
-00006570: 7373 696e 6773 5f70 6f69 6e74 732e 6170  ssings_points.ap
-00006580: 7065 6e64 2872 6573 756c 7429 0a20 2020  pend(result).   
-00006590: 2020 2020 2072 6574 7572 6e20 6372 6f73       return cros
-000065a0: 7369 6e67 735f 706f 696e 7473 0a0a 2020  sings_points..  
-000065b0: 2020 6465 6620 7769 7265 5f63 726f 7373    def wire_cross
-000065c0: 696e 6773 2873 656c 662c 2077 6972 6529  ings(self, wire)
-000065d0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000065e0: 2020 2020 2020 436f 6d70 7574 6520 6372        Compute cr
-000065f0: 6f73 7369 6e67 7320 6265 7477 6565 6e20  ossings between 
-00006600: 7477 6f20 7769 7265 2032 642e 0a0a 2020  two wire 2d...  
-00006610: 2020 2020 2020 3a70 6172 616d 2077 6972        :param wir
-00006620: 653a 2076 6f6c 6d64 6c72 2e77 6972 6573  e: volmdlr.wires
-00006630: 2e57 6972 6532 440a 2020 2020 2020 2020  .Wire2D.        
-00006640: 3a74 7970 6520 6372 6f73 7369 6e67 733a  :type crossings:
-00006650: 204c 6973 745b 2876 6f6c 6d64 6c72 2e50   List[(volmdlr.P
-00006660: 6f69 6e74 3244 2c20 766f 6c6d 646c 722e  oint2D, volmdlr.
-00006670: 5072 696d 6974 6976 6532 4429 5d0a 2020  Primitive2D)].  
-00006680: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00006690: 2020 6372 6f73 7369 6e67 732c 2063 726f    crossings, cro
-000066a0: 7373 696e 6773 5f70 6f69 6e74 7320 3d20  ssings_points = 
-000066b0: 5b5d 2c20 5b5d 0a20 2020 2020 2020 2066  [], [].        f
-000066c0: 6f72 2070 7269 6d69 7469 7665 2069 6e20  or primitive in 
-000066d0: 7769 7265 2e70 7269 6d69 7469 7665 733a  wire.primitives:
-000066e0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-000066f0: 686f 645f 6e61 6d65 203d 2066 277b 7072  hod_name = f'{pr
-00006700: 696d 6974 6976 652e 5f5f 636c 6173 735f  imitive.__class_
-00006710: 5f2e 5f5f 6e61 6d65 5f5f 2e6c 6f77 6572  _.__name__.lower
-00006720: 2829 5b30 3a2d 325d 7d5f 6372 6f73 7369  ()[0:-2]}_crossi
-00006730: 6e67 7327 0a0a 2020 2020 2020 2020 2020  ngs'..          
-00006740: 2020 6966 2068 6173 6174 7472 2873 656c    if hasattr(sel
-00006750: 662c 206d 6574 686f 645f 6e61 6d65 293a  f, method_name):
-00006760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006770: 2061 5f70 6f69 6e74 7320 3d20 6765 7461   a_points = geta
-00006780: 7474 7228 7365 6c66 2c20 6d65 7468 6f64  ttr(self, method
-00006790: 5f6e 616d 6529 2870 7269 6d69 7469 7665  _name)(primitive
-000067a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000067b0: 2020 2320 615f 706f 696e 7473 203d 2073    # a_points = s
-000067c0: 656c 662e 6c69 6e65 7365 676d 656e 745f  elf.linesegment_
-000067d0: 6372 6f73 7369 6e67 7328 7072 696d 6974  crossings(primit
-000067e0: 6976 6529 0a20 2020 2020 2020 2020 2020  ive).           
-000067f0: 2020 2020 2069 6620 615f 706f 696e 7473       if a_points
-00006800: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00006810: 2020 2020 2020 666f 7220 6120 696e 2061        for a in a
-00006820: 5f70 6f69 6e74 733a 0a20 2020 2020 2020  _points:.       
-00006830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006840: 2069 6620 615b 305d 206e 6f74 2069 6e20   if a[0] not in 
-00006850: 6372 6f73 7369 6e67 735f 706f 696e 7473  crossings_points
-00006860: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00006870: 2020 2020 2020 2020 2020 2020 2020 6372                cr
-00006880: 6f73 7369 6e67 732e 6170 7065 6e64 285b  ossings.append([
-00006890: 615b 305d 2c20 615b 315d 5d29 0a20 2020  a[0], a[1]]).   
-000068a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000068b0: 2020 2020 2020 2020 2063 726f 7373 696e           crossin
-000068c0: 6773 5f70 6f69 6e74 732e 6170 7065 6e64  gs_points.append
-000068d0: 2861 5b30 5d29 0a20 2020 2020 2020 2020  (a[0]).         
-000068e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000068f0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-00006900: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-00006910: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00006920: 2020 2020 2020 2020 6627 436c 6173 7320          f'Class 
-00006930: 7b73 656c 662e 5f5f 636c 6173 735f 5f2e  {self.__class__.
-00006940: 5f5f 6e61 6d65 5f5f 7d20 646f 6573 206e  __name__} does n
-00006950: 6f74 2069 6d70 6c65 6d65 6e74 207b 6d65  ot implement {me
-00006960: 7468 6f64 5f6e 616d 657d 2729 0a0a 2020  thod_name}')..  
-00006970: 2020 2020 2020 7265 7475 726e 2063 726f        return cro
-00006980: 7373 696e 6773 0a0a 2020 2020 6465 6620  ssings..    def 
-00006990: 746f 5f77 6972 655f 7769 7468 5f6c 696e  to_wire_with_lin
-000069a0: 6573 6567 6d65 6e74 7328 7365 6c66 293a  esegments(self):
-000069b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000069c0: 2020 2020 2043 6f6e 7665 7274 2061 2077       Convert a w
-000069d0: 6972 6520 7769 7468 2064 6966 6665 7265  ire with differe
-000069e0: 6e74 2070 7269 6d69 7469 7665 7320 746f  nt primitives to
-000069f0: 2061 2077 6972 6520 7769 7468 206a 7573   a wire with jus
-00006a00: 7420 6c69 6e65 7365 676d 656e 7473 2e0a  t linesegments..
-00006a10: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00006a20: 2020 2020 2077 6972 6573 203d 205b 5d0a       wires = [].
-00006a30: 2020 2020 2020 2020 666f 7220 7072 696d          for prim
-00006a40: 6974 6976 6520 696e 2073 656c 662e 7072  itive in self.pr
-00006a50: 696d 6974 6976 6573 3a0a 2020 2020 2020  imitives:.      
-00006a60: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-00006a70: 6e73 7461 6e63 6528 7072 696d 6974 6976  nstance(primitiv
-00006a80: 652c 2076 6f6c 6d64 6c72 2e65 6467 6573  e, volmdlr.edges
-00006a90: 2e4c 696e 6553 6567 6d65 6e74 3244 293a  .LineSegment2D):
-00006aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006ab0: 2077 6972 6573 2e61 7070 656e 6428 7072   wires.append(pr
-00006ac0: 696d 6974 6976 652e 746f 5f77 6972 6528  imitive.to_wire(
-00006ad0: 3130 2929 0a20 2020 2020 2020 2020 2020  10)).           
-00006ae0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00006af0: 2020 2020 2020 2077 6972 6573 2e61 7070         wires.app
-00006b00: 656e 6428 5769 7265 3244 285b 7072 696d  end(Wire2D([prim
-00006b10: 6974 6976 655d 2929 0a0a 2020 2020 2020  itive]))..      
-00006b20: 2020 7265 7475 726e 2057 6972 6532 442e    return Wire2D.
-00006b30: 6672 6f6d 5f77 6972 6573 2877 6972 6573  from_wires(wires
-00006b40: 290a 0a20 2020 2064 6566 2069 6e76 6572  )..    def inver
-00006b50: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
-00006b60: 2072 6574 7572 6e20 5769 7265 3244 2873   return Wire2D(s
-00006b70: 656c 662e 696e 7665 7274 6564 5f70 7269  elf.inverted_pri
-00006b80: 6d69 7469 7665 7328 2929 0a0a 2020 2020  mitives())..    
-00006b90: 6465 6620 6578 7465 6e64 2873 656c 662c  def extend(self,
-00006ba0: 2070 6f69 6e74 293a 0a20 2020 2020 2020   point):.       
-00006bb0: 2022 2222 0a20 2020 2020 2020 2045 7874   """.        Ext
-00006bc0: 656e 6420 6120 7769 7265 2062 7920 6164  end a wire by ad
-00006bd0: 6469 6e67 2061 206c 696e 6573 6567 6d65  ding a linesegme
-00006be0: 6e74 2063 6f6e 6e65 6374 696e 6720 7468  nt connecting th
-00006bf0: 6520 6769 7665 6e20 706f 696e 7420 746f  e given point to
-00006c00: 206e 6561 7265 7374 2077 6972 6527 7320   nearest wire's 
-00006c10: 6578 7472 656d 6974 6965 732e 0a20 2020  extremities..   
-00006c20: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00006c30: 2020 6469 7374 616e 6365 7320 3d20 5b73    distances = [s
-00006c40: 656c 662e 7072 696d 6974 6976 6573 5b30  elf.primitives[0
-00006c50: 5d2e 7374 6172 742e 706f 696e 745f 6469  ].start.point_di
-00006c60: 7374 616e 6365 2870 6f69 6e74 292c 2073  stance(point), s
-00006c70: 656c 662e 7072 696d 6974 6976 6573 5b2d  elf.primitives[-
-00006c80: 315d 2e65 6e64 2e70 6f69 6e74 5f64 6973  1].end.point_dis
-00006c90: 7461 6e63 6528 706f 696e 7429 5d0a 2020  tance(point)].  
-00006ca0: 2020 2020 2020 6966 2064 6973 7461 6e63        if distanc
-00006cb0: 6573 2e69 6e64 6578 286d 696e 2864 6973  es.index(min(dis
-00006cc0: 7461 6e63 6573 2929 203d 3d20 303a 0a20  tances)) == 0:. 
-00006cd0: 2020 2020 2020 2020 2020 2070 7269 6d69             primi
-00006ce0: 7469 7665 7320 3d20 5b76 6f6c 6d64 6c72  tives = [volmdlr
-00006cf0: 2e65 6467 6573 2e4c 696e 6553 6567 6d65  .edges.LineSegme
-00006d00: 6e74 3244 2870 6f69 6e74 2c20 7365 6c66  nt2D(point, self
-00006d10: 2e70 7269 6d69 7469 7665 735b 305d 2e73  .primitives[0].s
-00006d20: 7461 7274 295d 0a20 2020 2020 2020 2020  tart)].         
-00006d30: 2020 2070 7269 6d69 7469 7665 732e 6578     primitives.ex
-00006d40: 7465 6e64 2873 656c 662e 7072 696d 6974  tend(self.primit
-00006d50: 6976 6573 290a 2020 2020 2020 2020 656c  ives).        el
-00006d60: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00006d70: 7072 696d 6974 6976 6573 203d 2073 656c  primitives = sel
-00006d80: 662e 7072 696d 6974 6976 6573 0a20 2020  f.primitives.   
-00006d90: 2020 2020 2020 2020 2070 7269 6d69 7469           primiti
-00006da0: 7665 732e 6170 7065 6e64 2876 6f6c 6d64  ves.append(volmd
-00006db0: 6c72 2e65 6467 6573 2e4c 696e 6553 6567  lr.edges.LineSeg
-00006dc0: 6d65 6e74 3244 2873 656c 662e 7072 696d  ment2D(self.prim
-00006dd0: 6974 6976 6573 5b2d 315d 2e65 6e64 2c20  itives[-1].end, 
-00006de0: 706f 696e 7429 290a 0a20 2020 2020 2020  point))..       
-00006df0: 2072 6574 7572 6e20 5769 7265 3244 2870   return Wire2D(p
-00006e00: 7269 6d69 7469 7665 7329 0a0a 2020 2020  rimitives)..    
-00006e10: 6465 6620 706f 696e 745f 6469 7374 616e  def point_distan
-00006e20: 6365 2873 656c 662c 2070 6f69 6e74 293a  ce(self, point):
-00006e30: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00006e40: 2020 2020 2043 6f70 6965 6420 6672 6f6d       Copied from
-00006e50: 2043 6f6e 746f 7572 3244 2e0a 0a20 2020   Contour2D...   
-00006e60: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00006e70: 2020 6d69 6e5f 6469 7374 616e 6365 203d    min_distance =
-00006e80: 2073 656c 662e 7072 696d 6974 6976 6573   self.primitives
-00006e90: 5b30 5d2e 706f 696e 745f 6469 7374 616e  [0].point_distan
-00006ea0: 6365 2870 6f69 6e74 290a 2020 2020 2020  ce(point).      
-00006eb0: 2020 666f 7220 7072 696d 6974 6976 6520    for primitive 
-00006ec0: 696e 2073 656c 662e 7072 696d 6974 6976  in self.primitiv
-00006ed0: 6573 5b31 3a5d 3a0a 2020 2020 2020 2020  es[1:]:.        
-00006ee0: 2020 2020 6469 7374 616e 6365 203d 2070      distance = p
-00006ef0: 7269 6d69 7469 7665 2e70 6f69 6e74 5f64  rimitive.point_d
-00006f00: 6973 7461 6e63 6528 706f 696e 7429 0a20  istance(point). 
-00006f10: 2020 2020 2020 2020 2020 2069 6620 6469             if di
-00006f20: 7374 616e 6365 203c 206d 696e 5f64 6973  stance < min_dis
-00006f30: 7461 6e63 653a 0a20 2020 2020 2020 2020  tance:.         
-00006f40: 2020 2020 2020 206d 696e 5f64 6973 7461         min_dista
-00006f50: 6e63 6520 3d20 6469 7374 616e 6365 0a20  nce = distance. 
-00006f60: 2020 2020 2020 2072 6574 7572 6e20 6d69         return mi
-00006f70: 6e5f 6469 7374 616e 6365 0a0a 2020 2020  n_distance..    
-00006f80: 6465 6620 6e65 6172 6573 745f 7072 696d  def nearest_prim
-00006f90: 6974 6976 655f 746f 2873 656c 662c 2070  itive_to(self, p
-00006fa0: 6f69 6e74 293a 0a20 2020 2020 2020 2022  oint):.        "
-00006fb0: 2222 0a20 2020 2020 2020 2053 6561 7263  "".        Searc
-00006fc0: 6820 666f 7220 7468 6520 6e65 6172 6573  h for the neares
-00006fd0: 7420 7072 696d 6974 6976 6520 666f 7220  t primitive for 
-00006fe0: 6120 706f 696e 742e 0a0a 2020 2020 2020  a point...      
-00006ff0: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
-00007000: 7269 6d69 7469 7665 7320 3d20 7365 6c66  rimitives = self
-00007010: 2e70 7269 6d69 7469 7665 730a 2020 2020  .primitives.    
-00007020: 2020 2020 7072 696d 6974 6976 6573 5f73      primitives_s
-00007030: 6f72 7465 6420 3d20 736f 7274 6564 2870  orted = sorted(p
-00007040: 7269 6d69 7469 7665 732c 206b 6579 3d6c  rimitives, key=l
-00007050: 616d 6264 6120 7072 696d 6974 6976 653a  ambda primitive:
-00007060: 2070 7269 6d69 7469 7665 2e70 6f69 6e74   primitive.point
-00007070: 5f64 6973 7461 6e63 6528 706f 696e 7429  _distance(point)
-00007080: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00007090: 6e20 7072 696d 6974 6976 6573 5f73 6f72  n primitives_sor
-000070a0: 7465 645b 305d 0a0a 2020 2020 6465 6620  ted[0]..    def 
-000070b0: 6178 6961 6c5f 7379 6d6d 6574 7279 2873  axial_symmetry(s
-000070c0: 656c 662c 206c 696e 6529 3a0a 2020 2020  elf, line):.    
-000070d0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000070e0: 4669 6e64 7320 6f75 7420 7468 6520 7379  Finds out the sy
-000070f0: 6d6d 6574 7269 6320 7769 7265 3264 2061  mmetric wire2d a
-00007100: 6363 6f72 6469 6e67 2074 6f20 6120 6c69  ccording to a li
-00007110: 6e65 2e0a 0a20 2020 2020 2020 2022 2222  ne...        """
-00007120: 0a0a 2020 2020 2020 2020 7072 696d 6974  ..        primit
-00007130: 6976 6573 5f73 796d 6d65 7472 7920 3d20  ives_symmetry = 
-00007140: 5b5d 0a20 2020 2020 2020 2066 6f72 2070  [].        for p
-00007150: 7269 6d69 7469 7665 2069 6e20 7365 6c66  rimitive in self
-00007160: 2e70 7269 6d69 7469 7665 733a 0a20 2020  .primitives:.   
-00007170: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-00007180: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00007190: 696d 6974 6976 6573 5f73 796d 6d65 7472  imitives_symmetr
-000071a0: 792e 6170 7065 6e64 2870 7269 6d69 7469  y.append(primiti
-000071b0: 7665 2e61 7869 616c 5f73 796d 6d65 7472  ve.axial_symmetr
-000071c0: 7928 6c69 6e65 2929 0a20 2020 2020 2020  y(line)).       
-000071d0: 2020 2020 2065 7863 6570 7420 4e6f 7449       except NotI
-000071e0: 6d70 6c65 6d65 6e74 6564 4572 726f 723a  mplementedError:
-000071f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007200: 2070 7269 6e74 2866 2743 6c61 7373 207b   print(f'Class {
-00007210: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
-00007220: 5f6e 616d 655f 5f7d 2064 6f65 7320 6e6f  _name__} does no
-00007230: 7420 696d 706c 656d 656e 7420 7379 6d6d  t implement symm
-00007240: 6574 7279 206d 6574 686f 6427 290a 0a20  etry method').. 
-00007250: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00007260: 6c66 2e5f 5f63 6c61 7373 5f5f 2870 7269  lf.__class__(pri
-00007270: 6d69 7469 7665 733d 7072 696d 6974 6976  mitives=primitiv
-00007280: 6573 5f73 796d 6d65 7472 7929 0a0a 2020  es_symmetry)..  
-00007290: 2020 6465 6620 7379 6d6d 6574 7279 2873    def symmetry(s
-000072a0: 656c 662c 206c 696e 6529 3a0a 2020 2020  elf, line):.    
-000072b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000072c0: 544f 444f 3a20 636f 6465 2074 6869 730a  TODO: code this.
-000072d0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000072e0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-000072f0: 6c65 6d65 6e74 6564 4572 726f 7228 274e  lementedError('N
-00007300: 6f74 2063 6f64 6564 2079 6574 2729 0a0a  ot coded yet')..
-00007310: 2020 2020 6465 6620 6973 5f73 796d 6d65      def is_symme
-00007320: 7472 6963 2873 656c 662c 2077 6972 6532  tric(self, wire2
-00007330: 642c 206c 696e 6529 3a0a 2020 2020 2020  d, line):.      
-00007340: 2020 2222 220a 2020 2020 2020 2020 4368    """.        Ch
-00007350: 6563 6b73 2069 6620 7468 6520 7477 6f20  ecks if the two 
-00007360: 7769 7265 7332 6420 6172 6520 7379 6d6d  wires2d are symm
-00007370: 6574 7269 6320 6f72 206e 6f74 2061 6363  etric or not acc
-00007380: 6f72 6469 6e67 2074 6f20 6c69 6e65 2e0a  ording to line..
-00007390: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-000073a0: 2020 2020 2020 635f 7379 6d6d 6574 7279        c_symmetry
-000073b0: 5f30 203d 2073 656c 662e 7379 6d6d 6574  _0 = self.symmet
-000073c0: 7279 286c 696e 6529 0a20 2020 2020 2020  ry(line).       
-000073d0: 2063 5f73 796d 6d65 7472 795f 3120 3d20   c_symmetry_1 = 
-000073e0: 7769 7265 3264 2e73 796d 6d65 7472 7928  wire2d.symmetry(
-000073f0: 6c69 6e65 290a 0a20 2020 2020 2020 2069  line)..        i
-00007400: 6620 7769 7265 3264 2e69 735f 7375 7065  f wire2d.is_supe
-00007410: 7270 6f73 696e 6728 635f 7379 6d6d 6574  rposing(c_symmet
-00007420: 7279 5f30 2920 616e 6420 7365 6c66 2e69  ry_0) and self.i
-00007430: 735f 7375 7065 7270 6f73 696e 6728 635f  s_superposing(c_
-00007440: 7379 6d6d 6574 7279 5f31 293a 0a20 2020  symmetry_1):.   
-00007450: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00007460: 5472 7565 0a20 2020 2020 2020 2072 6574  True.        ret
-00007470: 7572 6e20 4661 6c73 650a 0a20 2020 2064  urn False..    d
-00007480: 6566 2062 7370 6c69 6e65 6375 7276 655f  ef bsplinecurve_
-00007490: 6372 6f73 7369 6e67 7328 7365 6c66 2c0a  crossings(self,.
-000074a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000074b0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-000074c0: 7370 6c69 6e65 6375 7276 653a 2027 766f  splinecurve: 'vo
-000074d0: 6c6d 646c 722e 6564 6765 732e 4253 706c  lmdlr.edges.BSpl
-000074e0: 696e 6543 7572 7665 3244 2729 3a0a 2020  ineCurve2D'):.  
-000074f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00007500: 2020 5265 7475 726e 7320 6120 6c69 7374    Returns a list
-00007510: 206f 6620 6372 6f73 7369 6e67 7320 696e   of crossings in
-00007520: 2074 6865 2066 6f72 6d20 6f66 2061 2074   the form of a t
-00007530: 7570 6c65 2028 706f 696e 742c 0a20 2020  uple (point,.   
-00007540: 2020 2020 2070 7269 6d69 7469 7665 2920       primitive) 
-00007550: 6f66 2074 6865 2077 6972 6520 7072 696d  of the wire prim
-00007560: 6974 6976 6573 2063 726f 7373 696e 6773  itives crossings
-00007570: 2077 6974 6820 7468 6520 6273 706c 696e   with the bsplin
-00007580: 6563 7572 7665 2e0a 0a20 2020 2020 2020  ecurve...       
-00007590: 2022 2222 0a0a 2020 2020 2020 2020 6c69   """..        li
-000075a0: 6e65 7365 676d 656e 7473 203d 2062 7370  nesegments = bsp
-000075b0: 6c69 6e65 6375 7276 652e 746f 5f77 6972  linecurve.to_wir
-000075c0: 6528 3235 292e 7072 696d 6974 6976 6573  e(25).primitives
-000075d0: 0a20 2020 2020 2020 2063 726f 7373 696e  .        crossin
-000075e0: 6773 5f70 6f69 6e74 7320 3d20 5b5d 0a20  gs_points = []. 
-000075f0: 2020 2020 2020 2066 6f72 206c 696e 6573         for lines
-00007600: 6567 6d65 6e74 2069 6e20 6c69 6e65 7365  egment in linese
-00007610: 676d 656e 7473 3a0a 2020 2020 2020 2020  gments:.        
-00007620: 2020 2020 6372 6f73 7369 6e67 735f 6c69      crossings_li
-00007630: 6e65 7365 676d 656e 7420 3d20 7365 6c66  nesegment = self
-00007640: 2e6c 696e 6573 6567 6d65 6e74 5f63 726f  .linesegment_cro
-00007650: 7373 696e 6773 286c 696e 6573 6567 6d65  ssings(linesegme
-00007660: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
-00007670: 6966 2063 726f 7373 696e 6773 5f6c 696e  if crossings_lin
-00007680: 6573 6567 6d65 6e74 2021 3d20 5b5d 3a0a  esegment != []:.
-00007690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000076a0: 6372 6f73 7369 6e67 735f 706f 696e 7473  crossings_points
-000076b0: 2e65 7874 656e 6428 6372 6f73 7369 6e67  .extend(crossing
-000076c0: 735f 6c69 6e65 7365 676d 656e 7429 0a20  s_linesegment). 
-000076d0: 2020 2020 2020 2072 6574 7572 6e20 6372         return cr
-000076e0: 6f73 7369 6e67 735f 706f 696e 7473 0a0a  ossings_points..
-000076f0: 2020 2020 6465 6620 6273 706c 696e 6563      def bsplinec
-00007700: 7572 7665 5f69 6e74 6572 7365 6374 696f  urve_intersectio
-00007710: 6e73 2873 656c 662c 0a20 2020 2020 2020  ns(self,.       
-00007720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007730: 2020 2020 2020 2020 2020 2020 6273 706c              bspl
-00007740: 696e 6563 7572 7665 3a20 2776 6f6c 6d64  inecurve: 'volmd
-00007750: 6c72 2e65 6467 6573 2e42 5370 6c69 6e65  lr.edges.BSpline
-00007760: 4375 7276 6532 4427 293a 0a20 2020 2020  Curve2D'):.     
-00007770: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-00007780: 6574 7572 6e73 2061 206c 6973 7420 6f66  eturns a list of
-00007790: 2069 6e74 6572 7365 6374 696f 6e73 2069   intersections i
-000077a0: 6e20 7468 6520 666f 726d 206f 6620 6120  n the form of a 
-000077b0: 7475 706c 6520 2870 6f69 6e74 2c0a 2020  tuple (point,.  
-000077c0: 2020 2020 2020 7072 696d 6974 6976 6529        primitive)
-000077d0: 206f 6620 7468 6520 7769 7265 2070 7269   of the wire pri
-000077e0: 6d69 7469 7665 7320 696e 7465 7273 6563  mitives intersec
-000077f0: 7469 6f6e 7320 7769 7468 2074 6865 2062  tions with the b
-00007800: 7370 6c69 6e65 6375 7276 652e 0a0a 2020  splinecurve...  
-00007810: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00007820: 2020 206c 696e 6573 6567 6d65 6e74 7320     linesegments 
-00007830: 3d20 6273 706c 696e 6563 7572 7665 2e74  = bsplinecurve.t
-00007840: 6f5f 7769 7265 2832 3529 2e70 7269 6d69  o_wire(25).primi
-00007850: 7469 7665 730a 2020 2020 2020 2020 696e  tives.        in
-00007860: 7465 7273 6563 7469 6f6e 735f 706f 696e  tersections_poin
-00007870: 7473 203d 205b 5d0a 2020 2020 2020 2020  ts = [].        
-00007880: 666f 7220 6c69 6e65 7365 676d 656e 7420  for linesegment 
-00007890: 696e 206c 696e 6573 6567 6d65 6e74 733a  in linesegments:
-000078a0: 0a20 2020 2020 2020 2020 2020 2069 6e74  .            int
-000078b0: 6572 7365 6374 696f 6e73 5f6c 696e 6573  ersections_lines
-000078c0: 6567 6d65 6e74 7320 3d20 7365 6c66 2e6c  egments = self.l
-000078d0: 696e 6573 6567 6d65 6e74 5f69 6e74 6572  inesegment_inter
-000078e0: 7365 6374 696f 6e73 286c 696e 6573 6567  sections(lineseg
-000078f0: 6d65 6e74 290a 2020 2020 2020 2020 2020  ment).          
-00007900: 2020 6966 2069 6e74 6572 7365 6374 696f    if intersectio
-00007910: 6e73 5f6c 696e 6573 6567 6d65 6e74 7320  ns_linesegments 
-00007920: 213d 205b 5d3a 0a20 2020 2020 2020 2020  != []:.         
-00007930: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
-00007940: 696f 6e73 5f70 6f69 6e74 732e 6578 7465  ions_points.exte
-00007950: 6e64 2869 6e74 6572 7365 6374 696f 6e73  nd(intersections
-00007960: 5f6c 696e 6573 6567 6d65 6e74 7329 0a20  _linesegments). 
-00007970: 2020 2020 2020 2072 6574 7572 6e20 696e         return in
-00007980: 7465 7273 6563 7469 6f6e 735f 706f 696e  tersections_poin
-00007990: 7473 0a0a 2020 2020 4070 726f 7065 7274  ts..    @propert
-000079a0: 790a 2020 2020 6465 6620 626f 756e 6469  y.    def boundi
-000079b0: 6e67 5f72 6563 7461 6e67 6c65 2873 656c  ng_rectangle(sel
-000079c0: 6629 3a0a 2020 2020 2020 2020 6966 206e  f):.        if n
-000079d0: 6f74 2073 656c 662e 5f62 6f75 6e64 696e  ot self._boundin
-000079e0: 675f 7265 6374 616e 676c 653a 0a20 2020  g_rectangle:.   
-000079f0: 2020 2020 2020 2020 2073 656c 662e 5f62           self._b
-00007a00: 6f75 6e64 696e 675f 7265 6374 616e 676c  ounding_rectangl
-00007a10: 6520 3d20 7365 6c66 2e67 6574 5f62 6f75  e = self.get_bou
-00007a20: 6469 6e67 5f72 6563 7461 6e67 6c65 2829  ding_rectangle()
-00007a30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00007a40: 7365 6c66 2e5f 626f 756e 6469 6e67 5f72  self._bounding_r
-00007a50: 6563 7461 6e67 6c65 0a0a 2020 2020 6465  ectangle..    de
-00007a60: 6620 6765 745f 626f 7564 696e 675f 7265  f get_bouding_re
-00007a70: 6374 616e 676c 6528 7365 6c66 293a 0a20  ctangle(self):. 
-00007a80: 2020 2020 2020 2078 5f6d 696e 2c20 785f         x_min, x_
-00007a90: 6d61 782c 2079 5f6d 696e 2c20 795f 6d61  max, y_min, y_ma
-00007aa0: 7820 3d20 7365 6c66 2e70 7269 6d69 7469  x = self.primiti
-00007ab0: 7665 735b 305d 2e62 6f75 6e64 696e 675f  ves[0].bounding_
-00007ac0: 7265 6374 616e 676c 652e 626f 756e 6473  rectangle.bounds
-00007ad0: 2829 0a20 2020 2020 2020 2066 6f72 2065  ().        for e
-00007ae0: 6467 6520 696e 2073 656c 662e 7072 696d  dge in self.prim
-00007af0: 6974 6976 6573 5b31 3a5d 3a0a 2020 2020  itives[1:]:.    
-00007b00: 2020 2020 2020 2020 786d 696e 5f65 6467          xmin_edg
-00007b10: 652c 2078 6d61 785f 6564 6765 2c20 796d  e, xmax_edge, ym
-00007b20: 696e 5f65 6467 652c 2079 6d61 785f 6564  in_edge, ymax_ed
-00007b30: 6765 203d 205c 0a20 2020 2020 2020 2020  ge = \.         
-00007b40: 2020 2020 2020 2065 6467 652e 626f 756e         edge.boun
-00007b50: 6469 6e67 5f72 6563 7461 6e67 6c65 2e62  ding_rectangle.b
-00007b60: 6f75 6e64 7328 290a 2020 2020 2020 2020  ounds().        
-00007b70: 2020 2020 785f 6d69 6e20 3d20 6d69 6e28      x_min = min(
-00007b80: 785f 6d69 6e2c 2078 6d69 6e5f 6564 6765  x_min, xmin_edge
-00007b90: 290a 2020 2020 2020 2020 2020 2020 785f  ).            x_
-00007ba0: 6d61 7820 3d20 6d61 7828 785f 6d61 782c  max = max(x_max,
-00007bb0: 2078 6d61 785f 6564 6765 290a 2020 2020   xmax_edge).    
-00007bc0: 2020 2020 2020 2020 795f 6d69 6e20 3d20          y_min = 
-00007bd0: 6d69 6e28 795f 6d69 6e2c 2079 6d69 6e5f  min(y_min, ymin_
-00007be0: 6564 6765 290a 2020 2020 2020 2020 2020  edge).          
-00007bf0: 2020 795f 6d61 7820 3d20 6d61 7828 795f    y_max = max(y_
-00007c00: 6d61 782c 2079 6d61 785f 6564 6765 290a  max, ymax_edge).
-00007c10: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-00007c20: 6f6c 6d64 6c72 2e63 6f72 652e 426f 756e  olmdlr.core.Boun
-00007c30: 6469 6e67 5265 6374 616e 676c 6528 785f  dingRectangle(x_
-00007c40: 6d69 6e2c 2078 5f6d 6178 2c20 795f 6d69  min, x_max, y_mi
-00007c50: 6e2c 2079 5f6d 6178 290a 0a0a 636c 6173  n, y_max)...clas
-00007c60: 7320 5769 7265 3344 2876 6f6c 6d64 6c72  s Wire3D(volmdlr
-00007c70: 2e63 6f72 652e 436f 6d70 6f73 6974 6550  .core.CompositeP
-00007c80: 7269 6d69 7469 7665 3344 2c20 5769 7265  rimitive3D, Wire
-00007c90: 4d69 7869 6e29 3a0a 2020 2020 2222 220a  Mixin):.    """.
-00007ca0: 2020 2020 4120 636f 6c6c 6563 7469 6f6e      A collection
-00007cb0: 206f 6620 7369 6d70 6c65 2070 7269 6d69   of simple primi
-00007cc0: 7469 7665 732c 2066 6f6c 6c6f 7769 6e67  tives, following
-00007cd0: 2065 6163 6820 6f74 6865 7220 6d61 6b69   each other maki
-00007ce0: 6e67 2061 2077 6972 652e 0a0a 2020 2020  ng a wire...    
-00007cf0: 2222 220a 0a20 2020 2064 6566 205f 5f69  """..    def __i
-00007d00: 6e69 745f 5f28 7365 6c66 2c20 7072 696d  nit__(self, prim
-00007d10: 6974 6976 6573 3a20 4c69 7374 5b76 6f6c  itives: List[vol
-00007d20: 6d64 6c72 2e63 6f72 652e 5072 696d 6974  mdlr.core.Primit
-00007d30: 6976 6533 445d 2c0a 2020 2020 2020 2020  ive3D],.        
-00007d40: 2020 2020 2020 2020 206e 616d 653a 2073           name: s
-00007d50: 7472 203d 2027 2729 3a0a 2020 2020 2020  tr = ''):.      
-00007d60: 2020 7365 6c66 2e5f 6262 6f78 203d 204e    self._bbox = N
-00007d70: 6f6e 650a 2020 2020 2020 2020 766f 6c6d  one.        volm
-00007d80: 646c 722e 636f 7265 2e43 6f6d 706f 7369  dlr.core.Composi
-00007d90: 7465 5072 696d 6974 6976 6533 442e 5f5f  tePrimitive3D.__
-00007da0: 696e 6974 5f5f 2873 656c 662c 2070 7269  init__(self, pri
-00007db0: 6d69 7469 7665 733d 7072 696d 6974 6976  mitives=primitiv
-00007dc0: 6573 2c20 6e61 6d65 3d6e 616d 6529 0a0a  es, name=name)..
-00007dd0: 2020 2020 6465 6620 5f62 6f75 6e64 696e      def _boundin
-00007de0: 675f 626f 7828 7365 6c66 293a 0a20 2020  g_box(self):.   
-00007df0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00007e00: 2046 6c61 7765 6420 6d65 7468 6f64 2c20   Flawed method, 
-00007e10: 746f 2062 6520 656e 666f 7263 6564 2062  to be enforced b
-00007e20: 7920 6f76 6572 6c6f 6164 696e 670a 2020  y overloading.  
-00007e30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00007e40: 2020 6e20 3d20 3230 0a20 2020 2020 2020    n = 20.       
-00007e50: 2070 6f69 6e74 7320 3d20 5b5d 0a20 2020   points = [].   
-00007e60: 2020 2020 2066 6f72 2070 7269 6d20 696e       for prim in
-00007e70: 2073 656c 662e 7072 696d 6974 6976 6573   self.primitives
-00007e80: 3a0a 2020 2020 2020 2020 2020 2020 706f  :.            po
-00007e90: 696e 7473 5f20 3d20 7072 696d 2e64 6973  ints_ = prim.dis
-00007ea0: 6372 6574 697a 6174 696f 6e5f 706f 696e  cretization_poin
-00007eb0: 7473 286e 756d 6265 725f 706f 696e 7473  ts(number_points
-00007ec0: 3d6e 290a 2020 2020 2020 2020 2020 2020  =n).            
-00007ed0: 666f 7220 706f 696e 7420 696e 2070 6f69  for point in poi
-00007ee0: 6e74 735f 3a0a 2020 2020 2020 2020 2020  nts_:.          
-00007ef0: 2020 2020 2020 6966 2070 6f69 6e74 206e        if point n
-00007f00: 6f74 2069 6e20 706f 696e 7473 3a0a 2020  ot in points:.  
-00007f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f20: 2020 706f 696e 7473 2e61 7070 656e 6428    points.append(
-00007f30: 706f 696e 7429 0a20 2020 2020 2020 2072  point).        r
-00007f40: 6574 7572 6e20 766f 6c6d 646c 722e 636f  eturn volmdlr.co
-00007f50: 7265 2e42 6f75 6e64 696e 6742 6f78 2e66  re.BoundingBox.f
-00007f60: 726f 6d5f 706f 696e 7473 2870 6f69 6e74  rom_points(point
-00007f70: 7329 0a0a 2020 2020 4070 726f 7065 7274  s)..    @propert
-00007f80: 790a 2020 2020 6465 6620 626f 756e 6469  y.    def boundi
-00007f90: 6e67 5f62 6f78 2873 656c 6629 3a0a 2020  ng_box(self):.  
-00007fa0: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-00007fb0: 662e 5f62 626f 783a 0a20 2020 2020 2020  f._bbox:.       
-00007fc0: 2020 2020 2073 656c 662e 5f62 626f 7820       self._bbox 
-00007fd0: 3d20 7365 6c66 2e5f 626f 756e 6469 6e67  = self._bounding
-00007fe0: 5f62 6f78 2829 0a20 2020 2020 2020 2072  _box().        r
-00007ff0: 6574 7572 6e20 7365 6c66 2e5f 6262 6f78  eturn self._bbox
-00008000: 0a0a 2020 2020 6465 6620 6578 7472 6163  ..    def extrac
-00008010: 7428 7365 6c66 2c20 706f 696e 7431 2c20  t(self, point1, 
-00008020: 7072 696d 6974 6976 6531 2c20 706f 696e  primitive1, poin
-00008030: 7432 2c20 7072 696d 6974 6976 6532 293a  t2, primitive2):
-00008040: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00008050: 5769 7265 3344 2873 656c 662e 6578 7472  Wire3D(self.extr
-00008060: 6163 745f 7072 696d 6974 6976 6573 2873  act_primitives(s
-00008070: 656c 662c 2070 6f69 6e74 312c 2070 7269  elf, point1, pri
-00008080: 6d69 7469 7665 312c 2070 6f69 6e74 322c  mitive1, point2,
-00008090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000063e0: 2020 2020 2020 2020 6c69 6e65 7365 676d          linesegm
+000063f0: 656e 743a 2027 766f 6c6d 646c 722e 6564  ent: 'volmdlr.ed
+00006400: 6765 732e 4c69 6e65 5365 676d 656e 7432  ges.LineSegment2
+00006410: 4427 293a 0a20 2020 2020 2020 2022 2222  D'):.        """
+00006420: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00006430: 2061 206c 6973 7420 6f66 2063 726f 7373   a list of cross
+00006440: 696e 6773 2069 6e20 7468 6520 666f 726d  ings in the form
+00006450: 206f 6620 6120 7475 706c 6520 2870 6f69   of a tuple (poi
+00006460: 6e74 2c0a 2020 2020 2020 2020 7072 696d  nt,.        prim
+00006470: 6974 6976 6529 206f 6620 7468 6520 7769  itive) of the wi
+00006480: 7265 2070 7269 6d69 7469 7665 7320 696e  re primitives in
+00006490: 7465 7273 6563 7469 6e67 2077 6974 6820  tersecting with 
+000064a0: 7468 6520 6c69 6e65 2e0a 2020 2020 2020  the line..      
+000064b0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+000064c0: 7375 6c74 7320 3d20 7365 6c66 2e6c 696e  sults = self.lin
+000064d0: 655f 6372 6f73 7369 6e67 7328 6c69 6e65  e_crossings(line
+000064e0: 7365 676d 656e 742e 746f 5f6c 696e 6528  segment.to_line(
+000064f0: 2929 0a20 2020 2020 2020 2063 726f 7373  )).        cross
+00006500: 696e 6773 5f70 6f69 6e74 7320 3d20 5b5d  ings_points = []
+00006510: 0a20 2020 2020 2020 2066 6f72 2072 6573  .        for res
+00006520: 756c 7420 696e 2072 6573 756c 7473 3a0a  ult in results:.
+00006530: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00006540: 696e 6573 6567 6d65 6e74 2e70 6f69 6e74  inesegment.point
+00006550: 5f62 656c 6f6e 6773 2872 6573 756c 745b  _belongs(result[
+00006560: 305d 293a 0a20 2020 2020 2020 2020 2020  0]):.           
+00006570: 2020 2020 2063 726f 7373 696e 6773 5f70       crossings_p
+00006580: 6f69 6e74 732e 6170 7065 6e64 2872 6573  oints.append(res
+00006590: 756c 7429 0a20 2020 2020 2020 2072 6574  ult).        ret
+000065a0: 7572 6e20 6372 6f73 7369 6e67 735f 706f  urn crossings_po
+000065b0: 696e 7473 0a0a 2020 2020 6465 6620 7769  ints..    def wi
+000065c0: 7265 5f63 726f 7373 696e 6773 2873 656c  re_crossings(sel
+000065d0: 662c 2077 6972 6529 3a0a 2020 2020 2020  f, wire):.      
+000065e0: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
+000065f0: 6d70 7574 6520 6372 6f73 7369 6e67 7320  mpute crossings 
+00006600: 6265 7477 6565 6e20 7477 6f20 7769 7265  between two wire
+00006610: 2032 642e 0a0a 2020 2020 2020 2020 3a70   2d...        :p
+00006620: 6172 616d 2077 6972 653a 2076 6f6c 6d64  aram wire: volmd
+00006630: 6c72 2e77 6972 6573 2e57 6972 6532 440a  lr.wires.Wire2D.
+00006640: 2020 2020 2020 2020 3a74 7970 6520 6372          :type cr
+00006650: 6f73 7369 6e67 733a 204c 6973 745b 2876  ossings: List[(v
+00006660: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 2c20  olmdlr.Point2D, 
+00006670: 766f 6c6d 646c 722e 5072 696d 6974 6976  volmdlr.Primitiv
+00006680: 6532 4429 5d0a 2020 2020 2020 2020 2222  e2D)].        ""
+00006690: 220a 2020 2020 2020 2020 6372 6f73 7369  ".        crossi
+000066a0: 6e67 732c 2063 726f 7373 696e 6773 5f70  ngs, crossings_p
+000066b0: 6f69 6e74 7320 3d20 5b5d 2c20 5b5d 0a20  oints = [], []. 
+000066c0: 2020 2020 2020 2066 6f72 2070 7269 6d69         for primi
+000066d0: 7469 7665 2069 6e20 7769 7265 2e70 7269  tive in wire.pri
+000066e0: 6d69 7469 7665 733a 0a20 2020 2020 2020  mitives:.       
+000066f0: 2020 2020 206d 6574 686f 645f 6e61 6d65       method_name
+00006700: 203d 2066 277b 7072 696d 6974 6976 652e   = f'{primitive.
+00006710: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
+00006720: 5f5f 2e6c 6f77 6572 2829 5b30 3a2d 325d  __.lower()[0:-2]
+00006730: 7d5f 6372 6f73 7369 6e67 7327 0a0a 2020  }_crossings'..  
+00006740: 2020 2020 2020 2020 2020 6966 2068 6173            if has
+00006750: 6174 7472 2873 656c 662c 206d 6574 686f  attr(self, metho
+00006760: 645f 6e61 6d65 293a 0a20 2020 2020 2020  d_name):.       
+00006770: 2020 2020 2020 2020 2061 5f70 6f69 6e74           a_point
+00006780: 7320 3d20 6765 7461 7474 7228 7365 6c66  s = getattr(self
+00006790: 2c20 6d65 7468 6f64 5f6e 616d 6529 2870  , method_name)(p
+000067a0: 7269 6d69 7469 7665 290a 2020 2020 2020  rimitive).      
+000067b0: 2020 2020 2020 2020 2020 2320 615f 706f            # a_po
+000067c0: 696e 7473 203d 2073 656c 662e 6c69 6e65  ints = self.line
+000067d0: 7365 676d 656e 745f 6372 6f73 7369 6e67  segment_crossing
+000067e0: 7328 7072 696d 6974 6976 6529 0a20 2020  s(primitive).   
+000067f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00006800: 615f 706f 696e 7473 3a0a 2020 2020 2020  a_points:.      
+00006810: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00006820: 7220 6120 696e 2061 5f70 6f69 6e74 733a  r a in a_points:
+00006830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006840: 2020 2020 2020 2020 2069 6620 615b 305d           if a[0]
+00006850: 206e 6f74 2069 6e20 6372 6f73 7369 6e67   not in crossing
+00006860: 735f 706f 696e 7473 3a0a 2020 2020 2020  s_points:.      
+00006870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006880: 2020 2020 2020 6372 6f73 7369 6e67 732e        crossings.
+00006890: 6170 7065 6e64 285b 615b 305d 2c20 615b  append([a[0], a[
+000068a0: 315d 5d29 0a20 2020 2020 2020 2020 2020  1]]).           
+000068b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000068c0: 2063 726f 7373 696e 6773 5f70 6f69 6e74   crossings_point
+000068d0: 732e 6170 7065 6e64 2861 5b30 5d29 0a20  s.append(a[0]). 
+000068e0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000068f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006900: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+00006910: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
+00006920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006930: 6627 436c 6173 7320 7b73 656c 662e 5f5f  f'Class {self.__
+00006940: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+00006950: 7d20 646f 6573 206e 6f74 2069 6d70 6c65  } does not imple
+00006960: 6d65 6e74 207b 6d65 7468 6f64 5f6e 616d  ment {method_nam
+00006970: 657d 2729 0a0a 2020 2020 2020 2020 7265  e}')..        re
+00006980: 7475 726e 2063 726f 7373 696e 6773 0a0a  turn crossings..
+00006990: 2020 2020 6465 6620 746f 5f77 6972 655f      def to_wire_
+000069a0: 7769 7468 5f6c 696e 6573 6567 6d65 6e74  with_linesegment
+000069b0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+000069c0: 2022 2222 0a20 2020 2020 2020 2043 6f6e   """.        Con
+000069d0: 7665 7274 2061 2077 6972 6520 7769 7468  vert a wire with
+000069e0: 2064 6966 6665 7265 6e74 2070 7269 6d69   different primi
+000069f0: 7469 7665 7320 746f 2061 2077 6972 6520  tives to a wire 
+00006a00: 7769 7468 206a 7573 7420 6c69 6e65 7365  with just linese
+00006a10: 676d 656e 7473 2e0a 2020 2020 2020 2020  gments..        
+00006a20: 2222 220a 0a20 2020 2020 2020 2077 6972  """..        wir
+00006a30: 6573 203d 205b 5d0a 2020 2020 2020 2020  es = [].        
+00006a40: 666f 7220 7072 696d 6974 6976 6520 696e  for primitive in
+00006a50: 2073 656c 662e 7072 696d 6974 6976 6573   self.primitives
+00006a60: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00006a70: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00006a80: 7072 696d 6974 6976 652c 2076 6f6c 6d64  primitive, volmd
+00006a90: 6c72 2e65 6467 6573 2e4c 696e 6553 6567  lr.edges.LineSeg
+00006aa0: 6d65 6e74 3244 293a 0a20 2020 2020 2020  ment2D):.       
+00006ab0: 2020 2020 2020 2020 2077 6972 6573 2e61           wires.a
+00006ac0: 7070 656e 6428 7072 696d 6974 6976 652e  ppend(primitive.
+00006ad0: 746f 5f77 6972 6528 3130 2929 0a20 2020  to_wire(10)).   
+00006ae0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00006af0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00006b00: 6972 6573 2e61 7070 656e 6428 5769 7265  ires.append(Wire
+00006b10: 3244 285b 7072 696d 6974 6976 655d 2929  2D([primitive]))
+00006b20: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00006b30: 2057 6972 6532 442e 6672 6f6d 5f77 6972   Wire2D.from_wir
+00006b40: 6573 2877 6972 6573 290a 0a20 2020 2064  es(wires)..    d
+00006b50: 6566 2069 6e76 6572 7428 7365 6c66 293a  ef invert(self):
+00006b60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00006b70: 5769 7265 3244 2873 656c 662e 696e 7665  Wire2D(self.inve
+00006b80: 7274 6564 5f70 7269 6d69 7469 7665 7328  rted_primitives(
+00006b90: 2929 0a0a 2020 2020 6465 6620 6578 7465  ))..    def exte
+00006ba0: 6e64 2873 656c 662c 2070 6f69 6e74 293a  nd(self, point):
+00006bb0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00006bc0: 2020 2020 2045 7874 656e 6420 6120 7769       Extend a wi
+00006bd0: 7265 2062 7920 6164 6469 6e67 2061 206c  re by adding a l
+00006be0: 696e 6573 6567 6d65 6e74 2063 6f6e 6e65  inesegment conne
+00006bf0: 6374 696e 6720 7468 6520 6769 7665 6e20  cting the given 
+00006c00: 706f 696e 7420 746f 206e 6561 7265 7374  point to nearest
+00006c10: 2077 6972 6527 7320 6578 7472 656d 6974   wire's extremit
+00006c20: 6965 732e 0a20 2020 2020 2020 2022 2222  ies..        """
+00006c30: 0a0a 2020 2020 2020 2020 6469 7374 616e  ..        distan
+00006c40: 6365 7320 3d20 5b73 656c 662e 7072 696d  ces = [self.prim
+00006c50: 6974 6976 6573 5b30 5d2e 7374 6172 742e  itives[0].start.
+00006c60: 706f 696e 745f 6469 7374 616e 6365 2870  point_distance(p
+00006c70: 6f69 6e74 292c 2073 656c 662e 7072 696d  oint), self.prim
+00006c80: 6974 6976 6573 5b2d 315d 2e65 6e64 2e70  itives[-1].end.p
+00006c90: 6f69 6e74 5f64 6973 7461 6e63 6528 706f  oint_distance(po
+00006ca0: 696e 7429 5d0a 2020 2020 2020 2020 6966  int)].        if
+00006cb0: 2064 6973 7461 6e63 6573 2e69 6e64 6578   distances.index
+00006cc0: 286d 696e 2864 6973 7461 6e63 6573 2929  (min(distances))
+00006cd0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00006ce0: 2020 2070 7269 6d69 7469 7665 7320 3d20     primitives = 
+00006cf0: 5b76 6f6c 6d64 6c72 2e65 6467 6573 2e4c  [volmdlr.edges.L
+00006d00: 696e 6553 6567 6d65 6e74 3244 2870 6f69  ineSegment2D(poi
+00006d10: 6e74 2c20 7365 6c66 2e70 7269 6d69 7469  nt, self.primiti
+00006d20: 7665 735b 305d 2e73 7461 7274 295d 0a20  ves[0].start)]. 
+00006d30: 2020 2020 2020 2020 2020 2070 7269 6d69             primi
+00006d40: 7469 7665 732e 6578 7465 6e64 2873 656c  tives.extend(sel
+00006d50: 662e 7072 696d 6974 6976 6573 290a 2020  f.primitives).  
+00006d60: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00006d70: 2020 2020 2020 2020 7072 696d 6974 6976          primitiv
+00006d80: 6573 203d 2073 656c 662e 7072 696d 6974  es = self.primit
+00006d90: 6976 6573 0a20 2020 2020 2020 2020 2020  ives.           
+00006da0: 2070 7269 6d69 7469 7665 732e 6170 7065   primitives.appe
+00006db0: 6e64 2876 6f6c 6d64 6c72 2e65 6467 6573  nd(volmdlr.edges
+00006dc0: 2e4c 696e 6553 6567 6d65 6e74 3244 2873  .LineSegment2D(s
+00006dd0: 656c 662e 7072 696d 6974 6976 6573 5b2d  elf.primitives[-
+00006de0: 315d 2e65 6e64 2c20 706f 696e 7429 290a  1].end, point)).
+00006df0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00006e00: 5769 7265 3244 2870 7269 6d69 7469 7665  Wire2D(primitive
+00006e10: 7329 0a0a 2020 2020 6465 6620 706f 696e  s)..    def poin
+00006e20: 745f 6469 7374 616e 6365 2873 656c 662c  t_distance(self,
+00006e30: 2070 6f69 6e74 293a 0a20 2020 2020 2020   point):.       
+00006e40: 2022 2222 0a20 2020 2020 2020 2043 6f70   """.        Cop
+00006e50: 6965 6420 6672 6f6d 2043 6f6e 746f 7572  ied from Contour
+00006e60: 3244 2e0a 0a20 2020 2020 2020 2022 2222  2D...        """
+00006e70: 0a0a 2020 2020 2020 2020 6d69 6e5f 6469  ..        min_di
+00006e80: 7374 616e 6365 203d 2073 656c 662e 7072  stance = self.pr
+00006e90: 696d 6974 6976 6573 5b30 5d2e 706f 696e  imitives[0].poin
+00006ea0: 745f 6469 7374 616e 6365 2870 6f69 6e74  t_distance(point
+00006eb0: 290a 2020 2020 2020 2020 666f 7220 7072  ).        for pr
+00006ec0: 696d 6974 6976 6520 696e 2073 656c 662e  imitive in self.
+00006ed0: 7072 696d 6974 6976 6573 5b31 3a5d 3a0a  primitives[1:]:.
+00006ee0: 2020 2020 2020 2020 2020 2020 6469 7374              dist
+00006ef0: 616e 6365 203d 2070 7269 6d69 7469 7665  ance = primitive
+00006f00: 2e70 6f69 6e74 5f64 6973 7461 6e63 6528  .point_distance(
+00006f10: 706f 696e 7429 0a20 2020 2020 2020 2020  point).         
+00006f20: 2020 2069 6620 6469 7374 616e 6365 203c     if distance <
+00006f30: 206d 696e 5f64 6973 7461 6e63 653a 0a20   min_distance:. 
+00006f40: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00006f50: 696e 5f64 6973 7461 6e63 6520 3d20 6469  in_distance = di
+00006f60: 7374 616e 6365 0a20 2020 2020 2020 2072  stance.        r
+00006f70: 6574 7572 6e20 6d69 6e5f 6469 7374 616e  eturn min_distan
+00006f80: 6365 0a0a 2020 2020 6465 6620 6e65 6172  ce..    def near
+00006f90: 6573 745f 7072 696d 6974 6976 655f 746f  est_primitive_to
+00006fa0: 2873 656c 662c 2070 6f69 6e74 293a 0a20  (self, point):. 
+00006fb0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00006fc0: 2020 2053 6561 7263 6820 666f 7220 7468     Search for th
+00006fd0: 6520 6e65 6172 6573 7420 7072 696d 6974  e nearest primit
+00006fe0: 6976 6520 666f 7220 6120 706f 696e 742e  ive for a point.
+00006ff0: 0a0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00007000: 2020 2020 2020 2070 7269 6d69 7469 7665         primitive
+00007010: 7320 3d20 7365 6c66 2e70 7269 6d69 7469  s = self.primiti
+00007020: 7665 730a 2020 2020 2020 2020 7072 696d  ves.        prim
+00007030: 6974 6976 6573 5f73 6f72 7465 6420 3d20  itives_sorted = 
+00007040: 736f 7274 6564 2870 7269 6d69 7469 7665  sorted(primitive
+00007050: 732c 206b 6579 3d6c 616d 6264 6120 7072  s, key=lambda pr
+00007060: 696d 6974 6976 653a 2070 7269 6d69 7469  imitive: primiti
+00007070: 7665 2e70 6f69 6e74 5f64 6973 7461 6e63  ve.point_distanc
+00007080: 6528 706f 696e 7429 290a 0a20 2020 2020  e(point))..     
+00007090: 2020 2072 6574 7572 6e20 7072 696d 6974     return primit
+000070a0: 6976 6573 5f73 6f72 7465 645b 305d 0a0a  ives_sorted[0]..
+000070b0: 2020 2020 6465 6620 6178 6961 6c5f 7379      def axial_sy
+000070c0: 6d6d 6574 7279 2873 656c 662c 206c 696e  mmetry(self, lin
+000070d0: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
+000070e0: 2020 2020 2020 2020 4669 6e64 7320 6f75          Finds ou
+000070f0: 7420 7468 6520 7379 6d6d 6574 7269 6320  t the symmetric 
+00007100: 7769 7265 3264 2061 6363 6f72 6469 6e67  wire2d according
+00007110: 2074 6f20 6120 6c69 6e65 2e0a 0a20 2020   to a line...   
+00007120: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00007130: 2020 7072 696d 6974 6976 6573 5f73 796d    primitives_sym
+00007140: 6d65 7472 7920 3d20 5b5d 0a20 2020 2020  metry = [].     
+00007150: 2020 2066 6f72 2070 7269 6d69 7469 7665     for primitive
+00007160: 2069 6e20 7365 6c66 2e70 7269 6d69 7469   in self.primiti
+00007170: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
+00007180: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00007190: 2020 2020 2020 7072 696d 6974 6976 6573        primitives
+000071a0: 5f73 796d 6d65 7472 792e 6170 7065 6e64  _symmetry.append
+000071b0: 2870 7269 6d69 7469 7665 2e61 7869 616c  (primitive.axial
+000071c0: 5f73 796d 6d65 7472 7928 6c69 6e65 2929  _symmetry(line))
+000071d0: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+000071e0: 6570 7420 4e6f 7449 6d70 6c65 6d65 6e74  ept NotImplement
+000071f0: 6564 4572 726f 723a 0a20 2020 2020 2020  edError:.       
+00007200: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
+00007210: 2743 6c61 7373 207b 7365 6c66 2e5f 5f63  'Class {self.__c
+00007220: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f7d  lass__.__name__}
+00007230: 2064 6f65 7320 6e6f 7420 696d 706c 656d   does not implem
+00007240: 656e 7420 7379 6d6d 6574 7279 206d 6574  ent symmetry met
+00007250: 686f 6427 290a 0a20 2020 2020 2020 2072  hod')..        r
+00007260: 6574 7572 6e20 7365 6c66 2e5f 5f63 6c61  eturn self.__cla
+00007270: 7373 5f5f 2870 7269 6d69 7469 7665 733d  ss__(primitives=
+00007280: 7072 696d 6974 6976 6573 5f73 796d 6d65  primitives_symme
+00007290: 7472 7929 0a0a 2020 2020 6465 6620 7379  try)..    def sy
+000072a0: 6d6d 6574 7279 2873 656c 662c 206c 696e  mmetry(self, lin
+000072b0: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
+000072c0: 2020 2020 2020 2020 544f 444f 3a20 636f          TODO: co
+000072d0: 6465 2074 6869 730a 2020 2020 2020 2020  de this.        
+000072e0: 2222 220a 2020 2020 2020 2020 7261 6973  """.        rais
+000072f0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+00007300: 4572 726f 7228 274e 6f74 2063 6f64 6564  Error('Not coded
+00007310: 2079 6574 2729 0a0a 2020 2020 6465 6620   yet')..    def 
+00007320: 6973 5f73 796d 6d65 7472 6963 2873 656c  is_symmetric(sel
+00007330: 662c 2077 6972 6532 642c 206c 696e 6529  f, wire2d, line)
+00007340: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00007350: 2020 2020 2020 4368 6563 6b73 2069 6620        Checks if 
+00007360: 7468 6520 7477 6f20 7769 7265 7332 6420  the two wires2d 
+00007370: 6172 6520 7379 6d6d 6574 7269 6320 6f72  are symmetric or
+00007380: 206e 6f74 2061 6363 6f72 6469 6e67 2074   not according t
+00007390: 6f20 6c69 6e65 2e0a 0a20 2020 2020 2020  o line...       
+000073a0: 2022 2222 0a0a 2020 2020 2020 2020 635f   """..        c_
+000073b0: 7379 6d6d 6574 7279 5f30 203d 2073 656c  symmetry_0 = sel
+000073c0: 662e 7379 6d6d 6574 7279 286c 696e 6529  f.symmetry(line)
+000073d0: 0a20 2020 2020 2020 2063 5f73 796d 6d65  .        c_symme
+000073e0: 7472 795f 3120 3d20 7769 7265 3264 2e73  try_1 = wire2d.s
+000073f0: 796d 6d65 7472 7928 6c69 6e65 290a 0a20  ymmetry(line).. 
+00007400: 2020 2020 2020 2069 6620 7769 7265 3264         if wire2d
+00007410: 2e69 735f 7375 7065 7270 6f73 696e 6728  .is_superposing(
+00007420: 635f 7379 6d6d 6574 7279 5f30 2920 616e  c_symmetry_0) an
+00007430: 6420 7365 6c66 2e69 735f 7375 7065 7270  d self.is_superp
+00007440: 6f73 696e 6728 635f 7379 6d6d 6574 7279  osing(c_symmetry
+00007450: 5f31 293a 0a20 2020 2020 2020 2020 2020  _1):.           
+00007460: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
+00007470: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
+00007480: 650a 0a20 2020 2064 6566 2062 7370 6c69  e..    def bspli
+00007490: 6e65 6375 7276 655f 6372 6f73 7369 6e67  necurve_crossing
+000074a0: 7328 7365 6c66 2c0a 2020 2020 2020 2020  s(self,.        
+000074b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074c0: 2020 2020 2020 2062 7370 6c69 6e65 6375         bsplinecu
+000074d0: 7276 653a 2027 766f 6c6d 646c 722e 6564  rve: 'volmdlr.ed
+000074e0: 6765 732e 4253 706c 696e 6543 7572 7665  ges.BSplineCurve
+000074f0: 3244 2729 3a0a 2020 2020 2020 2020 2222  2D'):.        ""
+00007500: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
+00007510: 7320 6120 6c69 7374 206f 6620 6372 6f73  s a list of cros
+00007520: 7369 6e67 7320 696e 2074 6865 2066 6f72  sings in the for
+00007530: 6d20 6f66 2061 2074 7570 6c65 2028 706f  m of a tuple (po
+00007540: 696e 742c 0a20 2020 2020 2020 2070 7269  int,.        pri
+00007550: 6d69 7469 7665 2920 6f66 2074 6865 2077  mitive) of the w
+00007560: 6972 6520 7072 696d 6974 6976 6573 2063  ire primitives c
+00007570: 726f 7373 696e 6773 2077 6974 6820 7468  rossings with th
+00007580: 6520 6273 706c 696e 6563 7572 7665 2e0a  e bsplinecurve..
+00007590: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+000075a0: 2020 2020 2020 6c69 6e65 7365 676d 656e        linesegmen
+000075b0: 7473 203d 2062 7370 6c69 6e65 6375 7276  ts = bsplinecurv
+000075c0: 652e 746f 5f77 6972 6528 3235 292e 7072  e.to_wire(25).pr
+000075d0: 696d 6974 6976 6573 0a20 2020 2020 2020  imitives.       
+000075e0: 2063 726f 7373 696e 6773 5f70 6f69 6e74   crossings_point
+000075f0: 7320 3d20 5b5d 0a20 2020 2020 2020 2066  s = [].        f
+00007600: 6f72 206c 696e 6573 6567 6d65 6e74 2069  or linesegment i
+00007610: 6e20 6c69 6e65 7365 676d 656e 7473 3a0a  n linesegments:.
+00007620: 2020 2020 2020 2020 2020 2020 6372 6f73              cros
+00007630: 7369 6e67 735f 6c69 6e65 7365 676d 656e  sings_linesegmen
+00007640: 7420 3d20 7365 6c66 2e6c 696e 6573 6567  t = self.lineseg
+00007650: 6d65 6e74 5f63 726f 7373 696e 6773 286c  ment_crossings(l
+00007660: 696e 6573 6567 6d65 6e74 290a 2020 2020  inesegment).    
+00007670: 2020 2020 2020 2020 6966 2063 726f 7373          if cross
+00007680: 696e 6773 5f6c 696e 6573 6567 6d65 6e74  ings_linesegment
+00007690: 2021 3d20 5b5d 3a0a 2020 2020 2020 2020   != []:.        
+000076a0: 2020 2020 2020 2020 6372 6f73 7369 6e67          crossing
+000076b0: 735f 706f 696e 7473 2e65 7874 656e 6428  s_points.extend(
+000076c0: 6372 6f73 7369 6e67 735f 6c69 6e65 7365  crossings_linese
+000076d0: 676d 656e 7429 0a20 2020 2020 2020 2072  gment).        r
+000076e0: 6574 7572 6e20 6372 6f73 7369 6e67 735f  eturn crossings_
+000076f0: 706f 696e 7473 0a0a 2020 2020 6465 6620  points..    def 
+00007700: 6273 706c 696e 6563 7572 7665 5f69 6e74  bsplinecurve_int
+00007710: 6572 7365 6374 696f 6e73 2873 656c 662c  ersections(self,
+00007720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007740: 2020 2020 6273 706c 696e 6563 7572 7665      bsplinecurve
+00007750: 3a20 2776 6f6c 6d64 6c72 2e65 6467 6573  : 'volmdlr.edges
+00007760: 2e42 5370 6c69 6e65 4375 7276 6532 4427  .BSplineCurve2D'
+00007770: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00007780: 2020 2020 2020 2052 6574 7572 6e73 2061         Returns a
+00007790: 206c 6973 7420 6f66 2069 6e74 6572 7365   list of interse
+000077a0: 6374 696f 6e73 2069 6e20 7468 6520 666f  ctions in the fo
+000077b0: 726d 206f 6620 6120 7475 706c 6520 2870  rm of a tuple (p
+000077c0: 6f69 6e74 2c0a 2020 2020 2020 2020 7072  oint,.        pr
+000077d0: 696d 6974 6976 6529 206f 6620 7468 6520  imitive) of the 
+000077e0: 7769 7265 2070 7269 6d69 7469 7665 7320  wire primitives 
+000077f0: 696e 7465 7273 6563 7469 6f6e 7320 7769  intersections wi
+00007800: 7468 2074 6865 2062 7370 6c69 6e65 6375  th the bsplinecu
+00007810: 7276 652e 0a0a 2020 2020 2020 2020 2222  rve...        ""
+00007820: 220a 0a20 2020 2020 2020 206c 696e 6573  "..        lines
+00007830: 6567 6d65 6e74 7320 3d20 6273 706c 696e  egments = bsplin
+00007840: 6563 7572 7665 2e74 6f5f 7769 7265 2832  ecurve.to_wire(2
+00007850: 3529 2e70 7269 6d69 7469 7665 730a 2020  5).primitives.  
+00007860: 2020 2020 2020 696e 7465 7273 6563 7469        intersecti
+00007870: 6f6e 735f 706f 696e 7473 203d 205b 5d0a  ons_points = [].
+00007880: 2020 2020 2020 2020 666f 7220 6c69 6e65          for line
+00007890: 7365 676d 656e 7420 696e 206c 696e 6573  segment in lines
+000078a0: 6567 6d65 6e74 733a 0a20 2020 2020 2020  egments:.       
+000078b0: 2020 2020 2069 6e74 6572 7365 6374 696f       intersectio
+000078c0: 6e73 5f6c 696e 6573 6567 6d65 6e74 7320  ns_linesegments 
+000078d0: 3d20 7365 6c66 2e6c 696e 6573 6567 6d65  = self.linesegme
+000078e0: 6e74 5f69 6e74 6572 7365 6374 696f 6e73  nt_intersections
+000078f0: 286c 696e 6573 6567 6d65 6e74 290a 2020  (linesegment).  
+00007900: 2020 2020 2020 2020 2020 6966 2069 6e74            if int
+00007910: 6572 7365 6374 696f 6e73 5f6c 696e 6573  ersections_lines
+00007920: 6567 6d65 6e74 7320 213d 205b 5d3a 0a20  egments != []:. 
+00007930: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00007940: 6e74 6572 7365 6374 696f 6e73 5f70 6f69  ntersections_poi
+00007950: 6e74 732e 6578 7465 6e64 2869 6e74 6572  nts.extend(inter
+00007960: 7365 6374 696f 6e73 5f6c 696e 6573 6567  sections_lineseg
+00007970: 6d65 6e74 7329 0a20 2020 2020 2020 2072  ments).        r
+00007980: 6574 7572 6e20 696e 7465 7273 6563 7469  eturn intersecti
+00007990: 6f6e 735f 706f 696e 7473 0a0a 2020 2020  ons_points..    
+000079a0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+000079b0: 6620 626f 756e 6469 6e67 5f72 6563 7461  f bounding_recta
+000079c0: 6e67 6c65 2873 656c 6629 3a0a 2020 2020  ngle(self):.    
+000079d0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+000079e0: 5f62 6f75 6e64 696e 675f 7265 6374 616e  _bounding_rectan
+000079f0: 676c 653a 0a20 2020 2020 2020 2020 2020  gle:.           
+00007a00: 2073 656c 662e 5f62 6f75 6e64 696e 675f   self._bounding_
+00007a10: 7265 6374 616e 676c 6520 3d20 7365 6c66  rectangle = self
+00007a20: 2e67 6574 5f62 6f75 6469 6e67 5f72 6563  .get_bouding_rec
+00007a30: 7461 6e67 6c65 2829 0a20 2020 2020 2020  tangle().       
+00007a40: 2072 6574 7572 6e20 7365 6c66 2e5f 626f   return self._bo
+00007a50: 756e 6469 6e67 5f72 6563 7461 6e67 6c65  unding_rectangle
+00007a60: 0a0a 2020 2020 6465 6620 6765 745f 626f  ..    def get_bo
+00007a70: 7564 696e 675f 7265 6374 616e 676c 6528  uding_rectangle(
+00007a80: 7365 6c66 293a 0a20 2020 2020 2020 2078  self):.        x
+00007a90: 5f6d 696e 2c20 785f 6d61 782c 2079 5f6d  _min, x_max, y_m
+00007aa0: 696e 2c20 795f 6d61 7820 3d20 7365 6c66  in, y_max = self
+00007ab0: 2e70 7269 6d69 7469 7665 735b 305d 2e62  .primitives[0].b
+00007ac0: 6f75 6e64 696e 675f 7265 6374 616e 676c  ounding_rectangl
+00007ad0: 652e 626f 756e 6473 2829 0a20 2020 2020  e.bounds().     
+00007ae0: 2020 2066 6f72 2065 6467 6520 696e 2073     for edge in s
+00007af0: 656c 662e 7072 696d 6974 6976 6573 5b31  elf.primitives[1
+00007b00: 3a5d 3a0a 2020 2020 2020 2020 2020 2020  :]:.            
+00007b10: 786d 696e 5f65 6467 652c 2078 6d61 785f  xmin_edge, xmax_
+00007b20: 6564 6765 2c20 796d 696e 5f65 6467 652c  edge, ymin_edge,
+00007b30: 2079 6d61 785f 6564 6765 203d 205c 0a20   ymax_edge = \. 
+00007b40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00007b50: 6467 652e 626f 756e 6469 6e67 5f72 6563  dge.bounding_rec
+00007b60: 7461 6e67 6c65 2e62 6f75 6e64 7328 290a  tangle.bounds().
+00007b70: 2020 2020 2020 2020 2020 2020 785f 6d69              x_mi
+00007b80: 6e20 3d20 6d69 6e28 785f 6d69 6e2c 2078  n = min(x_min, x
+00007b90: 6d69 6e5f 6564 6765 290a 2020 2020 2020  min_edge).      
+00007ba0: 2020 2020 2020 785f 6d61 7820 3d20 6d61        x_max = ma
+00007bb0: 7828 785f 6d61 782c 2078 6d61 785f 6564  x(x_max, xmax_ed
+00007bc0: 6765 290a 2020 2020 2020 2020 2020 2020  ge).            
+00007bd0: 795f 6d69 6e20 3d20 6d69 6e28 795f 6d69  y_min = min(y_mi
+00007be0: 6e2c 2079 6d69 6e5f 6564 6765 290a 2020  n, ymin_edge).  
+00007bf0: 2020 2020 2020 2020 2020 795f 6d61 7820            y_max 
+00007c00: 3d20 6d61 7828 795f 6d61 782c 2079 6d61  = max(y_max, yma
+00007c10: 785f 6564 6765 290a 2020 2020 2020 2020  x_edge).        
+00007c20: 7265 7475 726e 2076 6f6c 6d64 6c72 2e63  return volmdlr.c
+00007c30: 6f72 652e 426f 756e 6469 6e67 5265 6374  ore.BoundingRect
+00007c40: 616e 676c 6528 785f 6d69 6e2c 2078 5f6d  angle(x_min, x_m
+00007c50: 6178 2c20 795f 6d69 6e2c 2079 5f6d 6178  ax, y_min, y_max
+00007c60: 290a 0a0a 636c 6173 7320 5769 7265 3344  )...class Wire3D
+00007c70: 2876 6f6c 6d64 6c72 2e63 6f72 652e 436f  (volmdlr.core.Co
+00007c80: 6d70 6f73 6974 6550 7269 6d69 7469 7665  mpositePrimitive
+00007c90: 3344 2c20 5769 7265 4d69 7869 6e29 3a0a  3D, WireMixin):.
+00007ca0: 2020 2020 2222 220a 2020 2020 4120 636f      """.    A co
+00007cb0: 6c6c 6563 7469 6f6e 206f 6620 7369 6d70  llection of simp
+00007cc0: 6c65 2070 7269 6d69 7469 7665 732c 2066  le primitives, f
+00007cd0: 6f6c 6c6f 7769 6e67 2065 6163 6820 6f74  ollowing each ot
+00007ce0: 6865 7220 6d61 6b69 6e67 2061 2077 6972  her making a wir
+00007cf0: 652e 0a0a 2020 2020 2222 220a 0a20 2020  e...    """..   
+00007d00: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+00007d10: 6c66 2c20 7072 696d 6974 6976 6573 3a20  lf, primitives: 
+00007d20: 4c69 7374 5b76 6f6c 6d64 6c72 2e63 6f72  List[volmdlr.cor
+00007d30: 652e 5072 696d 6974 6976 6533 445d 2c0a  e.Primitive3D],.
+00007d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d50: 206e 616d 653a 2073 7472 203d 2027 2729   name: str = '')
+00007d60: 3a0a 2020 2020 2020 2020 7365 6c66 2e5f  :.        self._
+00007d70: 6262 6f78 203d 204e 6f6e 650a 2020 2020  bbox = None.    
+00007d80: 2020 2020 766f 6c6d 646c 722e 636f 7265      volmdlr.core
+00007d90: 2e43 6f6d 706f 7369 7465 5072 696d 6974  .CompositePrimit
+00007da0: 6976 6533 442e 5f5f 696e 6974 5f5f 2873  ive3D.__init__(s
+00007db0: 656c 662c 2070 7269 6d69 7469 7665 733d  elf, primitives=
+00007dc0: 7072 696d 6974 6976 6573 2c20 6e61 6d65  primitives, name
+00007dd0: 3d6e 616d 6529 0a0a 2020 2020 6465 6620  =name)..    def 
+00007de0: 5f62 6f75 6e64 696e 675f 626f 7828 7365  _bounding_box(se
+00007df0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00007e00: 0a20 2020 2020 2020 2046 6c61 7765 6420  .        Flawed 
+00007e10: 6d65 7468 6f64 2c20 746f 2062 6520 656e  method, to be en
+00007e20: 666f 7263 6564 2062 7920 6f76 6572 6c6f  forced by overlo
+00007e30: 6164 696e 670a 2020 2020 2020 2020 2222  ading.        ""
+00007e40: 220a 2020 2020 2020 2020 6e20 3d20 3230  ".        n = 20
+00007e50: 0a20 2020 2020 2020 2070 6f69 6e74 7320  .        points 
+00007e60: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
+00007e70: 2070 7269 6d20 696e 2073 656c 662e 7072   prim in self.pr
+00007e80: 696d 6974 6976 6573 3a0a 2020 2020 2020  imitives:.      
+00007e90: 2020 2020 2020 706f 696e 7473 5f20 3d20        points_ = 
+00007ea0: 7072 696d 2e64 6973 6372 6574 697a 6174  prim.discretizat
+00007eb0: 696f 6e5f 706f 696e 7473 286e 756d 6265  ion_points(numbe
+00007ec0: 725f 706f 696e 7473 3d6e 290a 2020 2020  r_points=n).    
+00007ed0: 2020 2020 2020 2020 666f 7220 706f 696e          for poin
+00007ee0: 7420 696e 2070 6f69 6e74 735f 3a0a 2020  t in points_:.  
+00007ef0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00007f00: 2070 6f69 6e74 206e 6f74 2069 6e20 706f   point not in po
+00007f10: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
+00007f20: 2020 2020 2020 2020 2020 706f 696e 7473            points
+00007f30: 2e61 7070 656e 6428 706f 696e 7429 0a20  .append(point). 
+00007f40: 2020 2020 2020 2072 6574 7572 6e20 766f         return vo
+00007f50: 6c6d 646c 722e 636f 7265 2e42 6f75 6e64  lmdlr.core.Bound
+00007f60: 696e 6742 6f78 2e66 726f 6d5f 706f 696e  ingBox.from_poin
+00007f70: 7473 2870 6f69 6e74 7329 0a0a 2020 2020  ts(points)..    
+00007f80: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00007f90: 6620 626f 756e 6469 6e67 5f62 6f78 2873  f bounding_box(s
+00007fa0: 656c 6629 3a0a 2020 2020 2020 2020 6966  elf):.        if
+00007fb0: 206e 6f74 2073 656c 662e 5f62 626f 783a   not self._bbox:
+00007fc0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00007fd0: 662e 5f62 626f 7820 3d20 7365 6c66 2e5f  f._bbox = self._
+00007fe0: 626f 756e 6469 6e67 5f62 6f78 2829 0a20  bounding_box(). 
+00007ff0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00008000: 6c66 2e5f 6262 6f78 0a0a 2020 2020 6465  lf._bbox..    de
+00008010: 6620 6578 7472 6163 7428 7365 6c66 2c20  f extract(self, 
+00008020: 706f 696e 7431 2c20 7072 696d 6974 6976  point1, primitiv
+00008030: 6531 2c20 706f 696e 7432 2c20 7072 696d  e1, point2, prim
+00008040: 6974 6976 6532 293a 0a20 2020 2020 2020  itive2):.       
+00008050: 2072 6574 7572 6e20 5769 7265 3344 2873   return Wire3D(s
+00008060: 656c 662e 6578 7472 6163 745f 7072 696d  elf.extract_prim
+00008070: 6974 6976 6573 2873 656c 662c 2070 6f69  itives(self, poi
+00008080: 6e74 312c 2070 7269 6d69 7469 7665 312c  nt1, primitive1,
+00008090: 2070 6f69 6e74 322c 0a20 2020 2020 2020   point2,.       
 000080a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000080b0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000080c0: 7269 6d69 7469 7665 3229 290a 0a20 2020  rimitive2))..   
-000080d0: 2064 6566 2065 7874 7261 6374 5f77 6974   def extract_wit
-000080e0: 685f 706f 696e 7473 2873 656c 662c 2070  h_points(self, p
-000080f0: 6f69 6e74 313a 2076 6f6c 6d64 6c72 2e50  oint1: volmdlr.P
-00008100: 6f69 6e74 3344 2c0a 2020 2020 2020 2020  oint3D,.        
+000080b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000080c0: 2020 2020 2020 2070 7269 6d69 7469 7665         primitive
+000080d0: 3229 290a 0a20 2020 2064 6566 2065 7874  2))..    def ext
+000080e0: 7261 6374 5f77 6974 685f 706f 696e 7473  ract_with_points
+000080f0: 2873 656c 662c 2070 6f69 6e74 313a 2076  (self, point1: v
+00008100: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 2c0a  olmdlr.Point3D,.
 00008110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008120: 2020 2020 706f 696e 7432 3a20 766f 6c6d      point2: volm
-00008130: 646c 722e 506f 696e 7433 442c 2069 6e73  dlr.Point3D, ins
-00008140: 6964 6529 3a0a 2020 2020 2020 2020 7265  ide):.        re
-00008150: 7475 726e 2073 656c 662e 6578 7472 6163  turn self.extrac
-00008160: 745f 7769 7468 6f75 745f 7072 696d 6974  t_without_primit
-00008170: 6976 6573 2870 6f69 6e74 312c 2070 6f69  ives(point1, poi
-00008180: 6e74 322c 2069 6e73 6964 6529 0a0a 2020  nt2, inside)..  
-00008190: 2020 6465 6620 6672 616d 655f 6d61 7070    def frame_mapp
-000081a0: 696e 6728 7365 6c66 2c20 6672 616d 653a  ing(self, frame:
-000081b0: 2076 6f6c 6d64 6c72 2e46 7261 6d65 3344   volmdlr.Frame3D
-000081c0: 2c20 7369 6465 3a20 7374 7229 3a0a 2020  , side: str):.  
-000081d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000081e0: 2020 4368 616e 6765 7320 6672 616d 655f    Changes frame_
-000081f0: 6d61 7070 696e 6720 616e 6420 7265 7475  mapping and retu
-00008200: 726e 2061 206e 6577 2057 6972 6533 442e  rn a new Wire3D.
-00008210: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00008220: 2073 6964 653a 2027 6f6c 6427 206f 7220   side: 'old' or 
-00008230: 276e 6577 270a 2020 2020 2020 2020 2222  'new'.        ""
-00008240: 220a 2020 2020 2020 2020 6e65 775f 7769  ".        new_wi
-00008250: 7265 203d 205b 5d0a 2020 2020 2020 2020  re = [].        
-00008260: 666f 7220 7072 696d 6974 6976 6520 696e  for primitive in
-00008270: 2073 656c 662e 7072 696d 6974 6976 6573   self.primitives
-00008280: 3a0a 2020 2020 2020 2020 2020 2020 6e65  :.            ne
-00008290: 775f 7769 7265 2e61 7070 656e 6428 7072  w_wire.append(pr
-000082a0: 696d 6974 6976 652e 6672 616d 655f 6d61  imitive.frame_ma
-000082b0: 7070 696e 6728 6672 616d 652c 2073 6964  pping(frame, sid
-000082c0: 6529 290a 2020 2020 2020 2020 7265 7475  e)).        retu
-000082d0: 726e 2057 6972 6533 4428 6e65 775f 7769  rn Wire3D(new_wi
-000082e0: 7265 290a 0a20 2020 2064 6566 2066 7261  re)..    def fra
-000082f0: 6d65 5f6d 6170 7069 6e67 5f69 6e70 6c61  me_mapping_inpla
-00008300: 6365 2873 656c 662c 2066 7261 6d65 3a20  ce(self, frame: 
-00008310: 766f 6c6d 646c 722e 4672 616d 6533 442c  volmdlr.Frame3D,
-00008320: 2073 6964 653a 2073 7472 293a 0a20 2020   side: str):.   
-00008330: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00008340: 2043 6861 6e67 6573 2066 7261 6d65 5f6d   Changes frame_m
-00008350: 6170 7069 6e67 2061 6e64 2074 6865 206f  apping and the o
-00008360: 626a 6563 7420 6973 2075 7064 6174 6564  bject is updated
-00008370: 2069 6e70 6c61 6365 2e0a 0a20 2020 2020   inplace...     
-00008380: 2020 203a 7061 7261 6d20 7369 6465 3a20     :param side: 
-00008390: 276f 6c64 2720 6f72 2027 6e65 7727 0a20  'old' or 'new'. 
-000083a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000083b0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-000083c0: 2822 2769 6e70 6c61 6365 2720 6d65 7468  ("'inplace' meth
-000083d0: 6f64 7320 6172 6520 6465 7072 6563 6174  ods are deprecat
-000083e0: 6564 2e20 5573 6520 6120 6e6f 7420 696e  ed. Use a not in
-000083f0: 706c 6163 6520 6d65 7468 6f64 2069 6e73  place method ins
-00008400: 7465 6164 2e22 2c20 4465 7072 6563 6174  tead.", Deprecat
-00008410: 696f 6e57 6172 6e69 6e67 290a 0a20 2020  ionWarning)..   
-00008420: 2020 2020 2066 6f72 2070 7269 6d69 7469       for primiti
-00008430: 7665 2069 6e20 7365 6c66 2e70 7269 6d69  ve in self.primi
-00008440: 7469 7665 733a 0a20 2020 2020 2020 2020  tives:.         
-00008450: 2020 2070 7269 6d69 7469 7665 2e66 7261     primitive.fra
-00008460: 6d65 5f6d 6170 7069 6e67 5f69 6e70 6c61  me_mapping_inpla
-00008470: 6365 2866 7261 6d65 2c20 7369 6465 290a  ce(frame, side).
-00008480: 0a20 2020 2064 6566 206d 696e 696d 756d  .    def minimum
-00008490: 5f64 6973 7461 6e63 6528 7365 6c66 2c20  _distance(self, 
-000084a0: 7769 7265 3229 3a0a 2020 2020 2020 2020  wire2):.        
-000084b0: 6469 7374 616e 6365 203d 205b 5d0a 2020  distance = [].  
-000084c0: 2020 2020 2020 666f 7220 656c 656d 656e        for elemen
-000084d0: 7420 696e 2073 656c 662e 7072 696d 6974  t in self.primit
-000084e0: 6976 6573 3a0a 2020 2020 2020 2020 2020  ives:.          
-000084f0: 2020 666f 7220 656c 656d 656e 7432 2069    for element2 i
-00008500: 6e20 7769 7265 322e 7072 696d 6974 6976  n wire2.primitiv
-00008510: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00008520: 2020 2020 6469 7374 616e 6365 2e61 7070      distance.app
-00008530: 656e 6428 656c 656d 656e 742e 6d69 6e69  end(element.mini
-00008540: 6d75 6d5f 6469 7374 616e 6365 2865 6c65  mum_distance(ele
-00008550: 6d65 6e74 3229 290a 0a20 2020 2020 2020  ment2))..       
-00008560: 2072 6574 7572 6e20 6d69 6e28 6469 7374   return min(dist
-00008570: 616e 6365 290a 0a20 2020 2064 6566 2070  ance)..    def p
-00008580: 6f69 6e74 5f64 6973 7461 6e63 6528 7365  oint_distance(se
-00008590: 6c66 2c20 706f 696e 7429 3a0a 2020 2020  lf, point):.    
-000085a0: 2020 2020 6469 7374 616e 6365 2c20 6469      distance, di
-000085b0: 7374 616e 6365 5f70 6f69 6e74 203d 206d  stance_point = m
-000085c0: 6174 682e 696e 662c 204e 6f6e 650a 2020  ath.inf, None.  
-000085d0: 2020 2020 2020 666f 7220 7072 696d 2069        for prim i
-000085e0: 6e20 7365 6c66 2e70 7269 6d69 7469 7665  n self.primitive
-000085f0: 733a 0a20 2020 2020 2020 2020 2020 2070  s:.            p
-00008600: 7269 6d5f 6469 7374 616e 6365 2c20 7072  rim_distance, pr
-00008610: 696d 5f70 6f69 6e74 203d 2070 7269 6d2e  im_point = prim.
-00008620: 706f 696e 745f 6469 7374 616e 6365 2870  point_distance(p
-00008630: 6f69 6e74 290a 2020 2020 2020 2020 2020  oint).          
-00008640: 2020 6966 2070 7269 6d5f 6469 7374 616e    if prim_distan
-00008650: 6365 203c 2064 6973 7461 6e63 653a 0a20  ce < distance:. 
-00008660: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00008670: 6973 7461 6e63 6520 3d20 7072 696d 5f64  istance = prim_d
-00008680: 6973 7461 6e63 650a 2020 2020 2020 2020  istance.        
-00008690: 2020 2020 2020 2020 6469 7374 616e 6365          distance
-000086a0: 5f70 6f69 6e74 203d 2070 7269 6d5f 706f  _point = prim_po
-000086b0: 696e 740a 2020 2020 2020 2020 7265 7475  int.        retu
-000086c0: 726e 2064 6973 7461 6e63 652c 2064 6973  rn distance, dis
-000086d0: 7461 6e63 655f 706f 696e 740a 0a20 2020  tance_point..   
-000086e0: 2064 6566 2065 7874 7275 7369 6f6e 2873   def extrusion(s
-000086f0: 656c 662c 2065 7874 7275 7369 6f6e 5f76  elf, extrusion_v
-00008700: 6563 746f 7229 3a0a 2020 2020 2020 2020  ector):.        
-00008710: 6661 6365 7320 3d20 5b5d 0a20 2020 2020  faces = [].     
-00008720: 2020 2066 6f72 2070 7269 6d69 7469 7665     for primitive
-00008730: 2069 6e20 7365 6c66 2e70 7269 6d69 7469   in self.primiti
-00008740: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
-00008750: 2066 6163 6573 2e65 7874 656e 6428 7072   faces.extend(pr
-00008760: 696d 6974 6976 652e 6578 7472 7573 696f  imitive.extrusio
-00008770: 6e28 6578 7472 7573 696f 6e5f 7665 6374  n(extrusion_vect
-00008780: 6f72 2929 0a20 2020 2020 2020 2072 6574  or)).        ret
-00008790: 7572 6e20 6661 6365 730a 0a20 2020 2064  urn faces..    d
-000087a0: 6566 2074 6f5f 6273 706c 696e 6528 7365  ef to_bspline(se
-000087b0: 6c66 2c20 6469 7363 7265 7469 7a61 7469  lf, discretizati
-000087c0: 6f6e 5f70 6172 616d 6574 6572 2c20 6465  on_parameter, de
-000087d0: 6772 6565 293a 0a20 2020 2020 2020 2022  gree):.        "
-000087e0: 2222 0a20 2020 2020 2020 2043 6f6e 7665  "".        Conve
-000087f0: 7274 2061 2077 6972 6533 6420 746f 2061  rt a wire3d to a
-00008800: 2062 7370 6c69 6e65 2063 7572 7665 3364   bspline curve3d
-00008810: 2e0a 0a20 2020 2020 2020 2022 2222 0a0a  ...        """..
-00008820: 2020 2020 2020 2020 6469 7363 7265 7469          discreti
-00008830: 7a65 645f 706f 696e 7473 203d 2073 656c  zed_points = sel
-00008840: 662e 6469 7363 7265 7469 7a61 7469 6f6e  f.discretization
-00008850: 5f70 6f69 6e74 7328 6469 7363 7265 7469  _points(discreti
-00008860: 7a61 7469 6f6e 5f70 6172 616d 6574 6572  zation_parameter
-00008870: 290a 2020 2020 2020 2020 6273 706c 696e  ).        bsplin
-00008880: 655f 6375 7276 6520 3d20 766f 6c6d 646c  e_curve = volmdl
-00008890: 722e 6564 6765 732e 4253 706c 696e 6543  r.edges.BSplineC
-000088a0: 7572 7665 3344 2e66 726f 6d5f 706f 696e  urve3D.from_poin
-000088b0: 7473 5f69 6e74 6572 706f 6c61 7469 6f6e  ts_interpolation
-000088c0: 2864 6973 6372 6574 697a 6564 5f70 6f69  (discretized_poi
-000088d0: 6e74 732c 2064 6567 7265 6529 0a0a 2020  nts, degree)..  
-000088e0: 2020 2020 2020 7265 7475 726e 2062 7370        return bsp
-000088f0: 6c69 6e65 5f63 7572 7665 0a0a 2020 2020  line_curve..    
-00008900: 6465 6620 7472 6961 6e67 756c 6174 696f  def triangulatio
-00008910: 6e28 7365 6c66 293a 0a20 2020 2020 2020  n(self):.       
-00008920: 2072 6574 7572 6e20 4e6f 6e65 0a0a 2020   return None..  
-00008930: 2020 6465 6620 6765 745f 7072 696d 6974    def get_primit
-00008940: 6976 6573 5f32 6428 7365 6c66 2c20 706c  ives_2d(self, pl
-00008950: 616e 655f 6f72 6967 696e 2c20 782c 2079  ane_origin, x, y
-00008960: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00008970: 2020 2020 2020 2050 6173 7320 7072 696d         Pass prim
-00008980: 6974 6976 6573 2074 6f20 3264 0a20 2020  itives to 2d.   
-00008990: 2020 2020 203a 7061 7261 6d20 706c 616e       :param plan
-000089a0: 655f 6f72 6967 696e 3a20 706c 616e 6520  e_origin: plane 
-000089b0: 6f72 6967 696e 0a20 2020 2020 2020 203a  origin.        :
-000089c0: 7061 7261 6d20 783a 2076 6563 746f 7220  param x: vector 
-000089d0: 750a 2020 2020 2020 2020 3a70 6172 616d  u.        :param
-000089e0: 2079 3a20 7665 6374 6f72 2076 0a20 2020   y: vector v.   
-000089f0: 2020 2020 203a 7265 7475 726e 3a20 6c69       :return: li
-00008a00: 7374 206f 6620 3264 2070 7269 6d69 7469  st of 2d primiti
-00008a10: 7665 730a 2020 2020 2020 2020 2222 220a  ves.        """.
-00008a20: 2020 2020 2020 2020 7a20 3d20 782e 6372          z = x.cr
-00008a30: 6f73 7328 7929 0a20 2020 2020 2020 2070  oss(y).        p
-00008a40: 6c61 6e65 3364 203d 2076 6f6c 6d64 6c72  lane3d = volmdlr
-00008a50: 2e66 6163 6573 2e50 6c61 6e65 3344 2876  .faces.Plane3D(v
-00008a60: 6f6c 6d64 6c72 2e46 7261 6d65 3344 2870  olmdlr.Frame3D(p
-00008a70: 6c61 6e65 5f6f 7269 6769 6e2c 2078 2c20  lane_origin, x, 
-00008a80: 792c 207a 2929 0a20 2020 2020 2020 2070  y, z)).        p
-00008a90: 7269 6d69 7469 7665 7332 6420 3d20 5b5d  rimitives2d = []
-00008aa0: 0a20 2020 2020 2020 2066 6f72 2070 7269  .        for pri
-00008ab0: 6d69 7469 7665 2069 6e20 7365 6c66 2e70  mitive in self.p
-00008ac0: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
-00008ad0: 2020 2020 2020 2070 7269 6d69 7469 7665         primitive
-00008ae0: 3264 203d 2070 6c61 6e65 3364 2e70 6f69  2d = plane3d.poi
-00008af0: 6e74 3364 5f74 6f5f 3264 2870 7269 6d69  nt3d_to_2d(primi
-00008b00: 7469 7665 290a 2020 2020 2020 2020 2020  tive).          
-00008b10: 2020 6966 2070 7269 6d69 7469 7665 3264    if primitive2d
-00008b20: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00008b30: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00008b40: 696d 6974 6976 6573 3264 2e61 7070 656e  imitives2d.appen
-00008b50: 6428 7072 696d 6974 6976 6532 6429 0a20  d(primitive2d). 
-00008b60: 2020 2020 2020 2072 6574 7572 6e20 7072         return pr
-00008b70: 696d 6974 6976 6573 3264 0a0a 2020 2020  imitives2d..    
-00008b80: 6465 6620 746f 5f32 6428 7365 6c66 2c20  def to_2d(self, 
-00008b90: 706c 616e 655f 6f72 6967 696e 2c20 782c  plane_origin, x,
-00008ba0: 2079 293a 0a20 2020 2020 2020 2070 7269   y):.        pri
-00008bb0: 6d69 7469 7665 7332 6420 3d20 7365 6c66  mitives2d = self
-00008bc0: 2e67 6574 5f70 7269 6d69 7469 7665 735f  .get_primitives_
-00008bd0: 3264 2870 6c61 6e65 5f6f 7269 6769 6e2c  2d(plane_origin,
-00008be0: 2078 2c20 7929 0a20 2020 2020 2020 2072   x, y).        r
-00008bf0: 6574 7572 6e20 5769 7265 3244 2870 7269  eturn Wire2D(pri
-00008c00: 6d69 7469 7665 733d 7072 696d 6974 6976  mitives=primitiv
-00008c10: 6573 3264 290a 0a20 2020 2064 6566 2072  es2d)..    def r
-00008c20: 6f74 6174 696f 6e28 7365 6c66 2c20 6365  otation(self, ce
-00008c30: 6e74 6572 3a20 766f 6c6d 646c 722e 506f  nter: volmdlr.Po
-00008c40: 696e 7433 442c 2061 7869 733a 2076 6f6c  int3D, axis: vol
-00008c50: 6d64 6c72 2e56 6563 746f 7233 442c 0a20  mdlr.Vector3D,. 
-00008c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c70: 616e 676c 653a 2066 6c6f 6174 293a 0a20  angle: float):. 
-00008c80: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00008c90: 2020 2057 6972 6533 4420 726f 7461 7469     Wire3D rotati
-00008ca0: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
-00008cb0: 7261 6d20 6365 6e74 6572 3a20 726f 7461  ram center: rota
-00008cc0: 7469 6f6e 2063 656e 7465 722e 0a20 2020  tion center..   
-00008cd0: 2020 2020 203a 7061 7261 6d20 6178 6973       :param axis
-00008ce0: 3a20 726f 7461 7469 6f6e 2061 7869 732e  : rotation axis.
-00008cf0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00008d00: 616e 676c 653a 2061 6e67 6c65 2072 6f74  angle: angle rot
-00008d10: 6174 696f 6e2e 0a20 2020 2020 2020 203a  ation..        :
-00008d20: 7265 7475 726e 3a20 6120 6e65 7720 726f  return: a new ro
-00008d30: 7461 7465 6420 5769 7265 3344 2e0a 2020  tated Wire3D..  
-00008d40: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00008d50: 2020 6e65 775f 6564 6765 7320 3d20 5b65    new_edges = [e
-00008d60: 6467 652e 726f 7461 7469 6f6e 2863 656e  dge.rotation(cen
-00008d70: 7465 722c 2061 7869 732c 2061 6e67 6c65  ter, axis, angle
-00008d80: 2920 666f 7220 6564 6765 0a20 2020 2020  ) for edge.     
-00008d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008da0: 696e 2073 656c 662e 7072 696d 6974 6976  in self.primitiv
-00008db0: 6573 5d0a 2020 2020 2020 2020 7265 7475  es].        retu
-00008dc0: 726e 2057 6972 6533 4428 6e65 775f 6564  rn Wire3D(new_ed
-00008dd0: 6765 732c 2073 656c 662e 6e61 6d65 290a  ges, self.name).
-00008de0: 0a0a 2320 544f 444f 3a20 6465 6669 6e65  ..# TODO: define
-00008df0: 2061 6e20 6564 6765 2061 7320 616e 206f   an edge as an o
-00008e00: 7065 6e65 6420 706f 6c79 676f 6e20 616e  pened polygon an
-00008e10: 6420 616c 6c6f 7720 746f 2063 6f6d 7075  d allow to compu
-00008e20: 7465 2061 7265 6120 6672 6f6d 2074 6869  te area from thi
-00008e30: 7320 7265 6665 7265 6e63 650a 0a63 6c61  s reference..cla
-00008e40: 7373 2043 6f6e 746f 7572 4d69 7869 6e28  ss ContourMixin(
-00008e50: 5769 7265 4d69 7869 6e29 3a0a 2020 2020  WireMixin):.    
-00008e60: 2222 220a 2020 2020 4162 7374 7261 6374  """.    Abstract
-00008e70: 2063 6c61 7373 2066 6f72 2043 6f6e 746f   class for Conto
-00008e80: 7572 2c20 7374 6f72 696e 6720 6d65 7468  ur, storing meth
-00008e90: 6f64 7320 616e 6420 6174 7472 6962 7574  ods and attribut
-00008ea0: 6573 2075 7365 6420 6279 2043 6f6e 746f  es used by Conto
-00008eb0: 7572 3244 2061 6e64 2043 6f6e 746f 7572  ur2D and Contour
-00008ec0: 3344 2e0a 0a20 2020 2022 2222 0a0a 2020  3D...    """..  
-00008ed0: 2020 6465 6620 6973 5f6f 7264 6572 6564    def is_ordered
-00008ee0: 2873 656c 662c 2074 6f6c 3d31 652d 3629  (self, tol=1e-6)
-00008ef0: 3a0a 2020 2020 2020 2020 666f 7220 7072  :.        for pr
-00008f00: 696d 312c 2070 7269 6d32 2069 6e20 7a69  im1, prim2 in zi
-00008f10: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
-00008f20: 2020 2073 656c 662e 7072 696d 6974 6976     self.primitiv
-00008f30: 6573 2c20 7365 6c66 2e70 7269 6d69 7469  es, self.primiti
-00008f40: 7665 735b 313a 5d20 2b20 5b73 656c 662e  ves[1:] + [self.
-00008f50: 7072 696d 6974 6976 6573 5b30 5d5d 293a  primitives[0]]):
-00008f60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00008f70: 6e6f 7420 7072 696d 312e 656e 642e 6973  not prim1.end.is
-00008f80: 5f63 6c6f 7365 2870 7269 6d32 2e73 7461  _close(prim2.sta
-00008f90: 7274 2c20 746f 6c29 3a0a 2020 2020 2020  rt, tol):.      
-00008fa0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00008fb0: 2046 616c 7365 0a20 2020 2020 2020 2072   False.        r
-00008fc0: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
-00008fd0: 6465 6620 6f72 6465 7269 6e67 5f63 6f6e  def ordering_con
-00008fe0: 746f 7572 2873 656c 662c 2074 6f6c 3d31  tour(self, tol=1
-00008ff0: 652d 3629 3a0a 2020 2020 2020 2020 2222  e-6):.        ""
-00009000: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-00009010: 7320 7468 6520 706f 696e 7473 206f 6620  s the points of 
-00009020: 7468 6520 636f 6e74 6f75 7220 6f72 6465  the contour orde
-00009030: 7265 642e 0a0a 2020 2020 2020 2020 2222  red...        ""
-00009040: 220a 2020 2020 2020 2020 6c69 7374 5f70  ".        list_p
-00009050: 6f69 6e74 5f70 6169 7273 203d 205b 2870  oint_pairs = [(p
-00009060: 7269 6d2e 7374 6172 742c 2070 7269 6d2e  rim.start, prim.
-00009070: 656e 6429 2066 6f72 2070 7269 6d20 696e  end) for prim in
-00009080: 2073 656c 662e 7072 696d 6974 6976 6573   self.primitives
-00009090: 5d0a 2020 2020 2020 2020 6c65 6e67 7468  ].        length
-000090a0: 5f6c 6973 745f 706f 696e 7473 203d 206c  _list_points = l
-000090b0: 656e 286c 6973 745f 706f 696e 745f 7061  en(list_point_pa
-000090c0: 6972 7329 0a20 2020 2020 2020 2070 6f69  irs).        poi
-000090d0: 6e74 7320 3d20 5b6c 6973 745f 706f 696e  nts = [list_poin
-000090e0: 745f 7061 6972 735b 305d 5d0a 2020 2020  t_pairs[0]].    
-000090f0: 2020 2020 7072 696d 6974 6976 6573 203d      primitives =
-00009100: 2073 656c 662e 7072 696d 6974 6976 6573   self.primitives
-00009110: 5b3a 5d0a 2020 2020 2020 2020 6e65 775f  [:].        new_
-00009120: 7072 696d 6974 6976 6573 203d 205b 7072  primitives = [pr
-00009130: 696d 6974 6976 6573 5b30 5d5d 0a20 2020  imitives[0]].   
-00009140: 2020 2020 2070 7269 6d69 7469 7665 732e       primitives.
-00009150: 7265 6d6f 7665 2870 7269 6d69 7469 7665  remove(primitive
-00009160: 735b 305d 290a 2020 2020 2020 2020 6c69  s[0]).        li
-00009170: 7374 5f70 6f69 6e74 5f70 6169 7273 2e72  st_point_pairs.r
-00009180: 656d 6f76 6528 0a20 2020 2020 2020 2020  emove(.         
-00009190: 2020 2028 6c69 7374 5f70 6f69 6e74 5f70     (list_point_p
-000091a0: 6169 7273 5b30 5d5b 305d 2c20 6c69 7374  airs[0][0], list
-000091b0: 5f70 6f69 6e74 5f70 6169 7273 5b30 5d5b  _point_pairs[0][
-000091c0: 315d 2929 0a20 2020 2020 2020 2066 696e  1])).        fin
-000091d0: 6973 6865 6420 3d20 4661 6c73 650a 2020  ished = False.  
-000091e0: 2020 2020 2020 636f 756e 7465 7220 3d20        counter = 
-000091f0: 300a 2020 2020 2020 2020 636f 756e 7465  0.        counte
-00009200: 7231 203d 2030 0a0a 2020 2020 2020 2020  r1 = 0..        
-00009210: 7768 696c 6520 6e6f 7420 6669 6e69 7368  while not finish
-00009220: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
-00009230: 666f 7220 692c 2028 7031 2c20 7032 2920  for i, (p1, p2) 
-00009240: 696e 2065 6e75 6d65 7261 7465 286c 6973  in enumerate(lis
-00009250: 745f 706f 696e 745f 7061 6972 7329 3a0a  t_point_pairs):.
-00009260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009270: 6966 2070 312e 706f 696e 745f 6469 7374  if p1.point_dist
-00009280: 616e 6365 2870 3229 203c 2074 6f6c 3a0a  ance(p2) < tol:.
-00009290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000092a0: 2020 2020 6c69 7374 5f70 6f69 6e74 5f70      list_point_p
-000092b0: 6169 7273 2e72 656d 6f76 6528 2870 312c  airs.remove((p1,
-000092c0: 2070 3229 290a 2020 2020 2020 2020 2020   p2)).          
-000092d0: 2020 2020 2020 2020 2020 7072 696d 6974            primit
-000092e0: 6976 6573 2e72 656d 6f76 6528 7072 696d  ives.remove(prim
-000092f0: 6974 6976 6573 5b69 5d29 0a20 2020 2020  itives[i]).     
-00009300: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00009310: 7031 2e70 6f69 6e74 5f64 6973 7461 6e63  p1.point_distanc
-00009320: 6528 706f 696e 7473 5b2d 315d 5b2d 315d  e(points[-1][-1]
-00009330: 2920 3c20 746f 6c3a 0a20 2020 2020 2020  ) < tol:.       
-00009340: 2020 2020 2020 2020 2020 2020 2070 6f69               poi
-00009350: 6e74 732e 6170 7065 6e64 2828 7031 2c20  nts.append((p1, 
-00009360: 7032 2929 0a20 2020 2020 2020 2020 2020  p2)).           
-00009370: 2020 2020 2020 2020 206e 6577 5f70 7269           new_pri
-00009380: 6d69 7469 7665 732e 6170 7065 6e64 2870  mitives.append(p
-00009390: 7269 6d69 7469 7665 735b 695d 290a 2020  rimitives[i]).  
-000093a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000093b0: 2020 7072 696d 6974 6976 6573 2e72 656d    primitives.rem
-000093c0: 6f76 6528 7072 696d 6974 6976 6573 5b69  ove(primitives[i
-000093d0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-000093e0: 2020 2020 2020 206c 6973 745f 706f 696e         list_poin
-000093f0: 745f 7061 6972 732e 7265 6d6f 7665 2828  t_pairs.remove((
-00009400: 7031 2c20 7032 2929 0a20 2020 2020 2020  p1, p2)).       
-00009410: 2020 2020 2020 2020 2065 6c69 6620 7032           elif p2
-00009420: 2e70 6f69 6e74 5f64 6973 7461 6e63 6528  .point_distance(
-00009430: 706f 696e 7473 5b2d 315d 5b2d 315d 2920  points[-1][-1]) 
-00009440: 3c20 746f 6c3a 0a20 2020 2020 2020 2020  < tol:.         
-00009450: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-00009460: 732e 6170 7065 6e64 2828 7032 2c20 7031  s.append((p2, p1
-00009470: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00009480: 2020 2020 2020 206e 6577 5f70 7269 6d69         new_primi
-00009490: 7469 7665 732e 6170 7065 6e64 2870 7269  tives.append(pri
-000094a0: 6d69 7469 7665 735b 695d 2e72 6576 6572  mitives[i].rever
-000094b0: 7365 2829 290a 2020 2020 2020 2020 2020  se()).          
-000094c0: 2020 2020 2020 2020 2020 7072 696d 6974            primit
-000094d0: 6976 6573 2e72 656d 6f76 6528 7072 696d  ives.remove(prim
-000094e0: 6974 6976 6573 5b69 5d29 0a20 2020 2020  itives[i]).     
-000094f0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00009500: 6973 745f 706f 696e 745f 7061 6972 732e  ist_point_pairs.
-00009510: 7265 6d6f 7665 2828 7031 2c20 7032 2929  remove((p1, p2))
-00009520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009530: 2065 6c69 6620 7031 2e70 6f69 6e74 5f64   elif p1.point_d
-00009540: 6973 7461 6e63 6528 706f 696e 7473 5b30  istance(points[0
-00009550: 5d5b 305d 2920 3c20 746f 6c3a 0a20 2020  ][0]) < tol:.   
-00009560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009570: 2070 6f69 6e74 7320 3d20 5b28 7032 2c20   points = [(p2, 
-00009580: 7031 295d 202b 2070 6f69 6e74 730a 2020  p1)] + points.  
-00009590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000095a0: 2020 6e65 775f 7072 696d 6974 6976 6573    new_primitives
-000095b0: 203d 205b 7072 696d 6974 6976 6573 5b69   = [primitives[i
-000095c0: 5d2e 7265 7665 7273 6528 295d 202b 206e  ].reverse()] + n
-000095d0: 6577 5f70 7269 6d69 7469 7665 730a 2020  ew_primitives.  
-000095e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000095f0: 2020 7072 696d 6974 6976 6573 2e72 656d    primitives.rem
-00009600: 6f76 6528 7072 696d 6974 6976 6573 5b69  ove(primitives[i
-00009610: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-00009620: 2020 2020 2020 206c 6973 745f 706f 696e         list_poin
-00009630: 745f 7061 6972 732e 7265 6d6f 7665 2828  t_pairs.remove((
-00009640: 7031 2c20 7032 2929 0a20 2020 2020 2020  p1, p2)).       
-00009650: 2020 2020 2020 2020 2065 6c69 6620 7032           elif p2
-00009660: 2e70 6f69 6e74 5f64 6973 7461 6e63 6528  .point_distance(
-00009670: 706f 696e 7473 5b30 5d5b 305d 2920 3c20  points[0][0]) < 
-00009680: 746f 6c3a 0a20 2020 2020 2020 2020 2020  tol:.           
-00009690: 2020 2020 2020 2020 2070 6f69 6e74 7320           points 
-000096a0: 3d20 5b28 7031 2c20 7032 295d 202b 2070  = [(p1, p2)] + p
-000096b0: 6f69 6e74 730a 2020 2020 2020 2020 2020  oints.          
-000096c0: 2020 2020 2020 2020 2020 6e65 775f 7072            new_pr
-000096d0: 696d 6974 6976 6573 203d 205b 7072 696d  imitives = [prim
-000096e0: 6974 6976 6573 5b69 5d5d 202b 206e 6577  itives[i]] + new
-000096f0: 5f70 7269 6d69 7469 7665 730a 2020 2020  _primitives.    
-00009700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009710: 7072 696d 6974 6976 6573 2e72 656d 6f76  primitives.remov
-00009720: 6528 7072 696d 6974 6976 6573 5b69 5d29  e(primitives[i])
-00009730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009740: 2020 2020 206c 6973 745f 706f 696e 745f       list_point_
-00009750: 7061 6972 732e 7265 6d6f 7665 2828 7031  pairs.remove((p1
-00009760: 2c20 7032 2929 0a20 2020 2020 2020 2020  , p2)).         
-00009770: 2020 2069 6620 6c65 6e28 6c69 7374 5f70     if len(list_p
-00009780: 6f69 6e74 5f70 6169 7273 2920 3d3d 2030  oint_pairs) == 0
-00009790: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000097a0: 2020 6669 6e69 7368 6564 203d 2054 7275    finished = Tru
-000097b0: 650a 2020 2020 2020 2020 2020 2020 636f  e.            co
-000097c0: 756e 7465 7231 202b 3d20 310a 2020 2020  unter1 += 1.    
-000097d0: 2020 2020 2020 2020 6966 2063 6f75 6e74          if count
-000097e0: 6572 3120 3e3d 2031 3030 202a 206c 656e  er1 >= 100 * len
-000097f0: 6774 685f 6c69 7374 5f70 6f69 6e74 733a  gth_list_points:
-00009800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009810: 2073 656c 662e 706c 6f74 2829 0a20 2020   self.plot().   
-00009820: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00009830: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-00009840: 6445 7272 6f72 0a20 2020 2020 2020 2020  dError.         
-00009850: 2020 2069 6620 6c65 6e28 6c69 7374 5f70     if len(list_p
-00009860: 6f69 6e74 5f70 6169 7273 2920 3d3d 2031  oint_pairs) == 1
-00009870: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00009880: 2020 636f 756e 7465 7220 2b3d 2031 0a20    counter += 1. 
-00009890: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000098a0: 6620 636f 756e 7465 7220 3e20 333a 0a20  f counter > 3:. 
-000098b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000098c0: 2020 2023 2066 6f72 2070 6f69 6e74 5f70     # for point_p
-000098d0: 6169 7220 696e 206c 6973 745f 706f 696e  air in list_poin
-000098e0: 745f 7061 6972 733a 0a20 2020 2020 2020  t_pairs:.       
-000098f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00009900: 6c69 7374 5f70 6f69 6e74 5f70 6169 7273  list_point_pairs
-00009910: 5b30 5d5b 305d 2069 6e20 706f 696e 7473  [0][0] in points
-00009920: 206f 7220 6c69 7374 5f70 6f69 6e74 5f70   or list_point_p
-00009930: 6169 7273 5b30 5d5b 3a3a 2d31 5d20 696e  airs[0][::-1] in
-00009940: 2070 6f69 6e74 733a 0a20 2020 2020 2020   points:.       
-00009950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009960: 2066 696e 6973 6865 6420 3d20 5472 7565   finished = True
-00009970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009980: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-00009990: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-000099a0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-000099b0: 6172 6e28 2754 6865 7265 206d 6179 2065  arn('There may e
-000099c0: 7869 7374 2061 2070 726f 626c 656d 2077  xist a problem w
-000099d0: 6974 6820 7468 6973 270a 2020 2020 2020  ith this'.      
-000099e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000099f0: 2020 2020 2020 2020 2020 2020 2720 636f              ' co
-00009a00: 6e74 6f75 722c 2069 7420 7365 656d 7320  ntour, it seems 
-00009a10: 6974 2063 616e 6e6f 7420 6265 2072 656f  it cannot be reo
-00009a20: 7264 6572 6564 2e27 0a20 2020 2020 2020  rdered.'.       
-00009a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009a40: 2020 2020 2020 2020 2020 2027 2050 6c65             ' Ple
-00009a50: 6173 652c 2076 6572 6966 7920 6974 7320  ase, verify its 
-00009a60: 706f 696e 7473 2729 0a20 2020 2020 2020  points').       
-00009a70: 2020 2020 2020 2020 2020 2020 2066 696e               fin
-00009a80: 6973 6865 6420 3d20 5472 7565 0a20 2020  ished = True.   
-00009a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009aa0: 2023 2061 7820 3d20 7365 6c66 2e70 6c6f   # ax = self.plo
-00009ab0: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-00009ac0: 2020 2020 2020 2020 2320 666f 7220 706f          # for po
-00009ad0: 696e 745f 7061 6972 2069 6e20 6c69 7374  int_pair in list
-00009ae0: 5f70 6f69 6e74 5f70 6169 7273 3a0a 2020  _point_pairs:.  
-00009af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b00: 2020 2320 2020 2020 706f 696e 745f 7061    #     point_pa
-00009b10: 6972 5b30 5d2e 706c 6f74 2861 783d 6178  ir[0].plot(ax=ax
-00009b20: 2c20 636f 6c6f 723d 2772 2729 0a20 2020  , color='r').   
-00009b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b40: 2023 2020 2020 2070 6f69 6e74 5f70 6169   #     point_pai
-00009b50: 725b 315d 2e70 6c6f 7428 6178 3d61 782c  r[1].plot(ax=ax,
-00009b60: 2063 6f6c 6f72 3d27 7227 290a 2020 2020   color='r').    
-00009b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b80: 2320 7261 6973 6520 4e6f 7449 6d70 6c65  # raise NotImple
-00009b90: 6d65 6e74 6564 4572 726f 720a 2020 2020  mentedError.    
-00009ba0: 2020 2020 7265 7475 726e 206e 6577 5f70      return new_p
-00009bb0: 7269 6d69 7469 7665 730a 0a20 2020 2040  rimitives..    @
-00009bc0: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
-00009bd0: 2064 6566 2074 6f75 6368 696e 675f 6564   def touching_ed
-00009be0: 6765 735f 7061 6972 7328 6564 6765 7329  ges_pairs(edges)
-00009bf0: 3a20 2023 2054 4f20 444f 3a20 6d6f 7665  :  # TO DO: move
-00009c00: 2074 6869 7320 746f 2065 6467 6573 3f0a   this to edges?.
-00009c10: 2020 2020 2020 2020 746f 7563 6869 6e67          touching
-00009c20: 5f70 7269 6d69 7469 7665 7320 3d20 5b5d  _primitives = []
-00009c30: 0a20 2020 2020 2020 2066 6f72 2069 2c20  .        for i, 
-00009c40: 7072 696d 6974 6976 6531 2069 6e20 656e  primitive1 in en
-00009c50: 756d 6572 6174 6528 6564 6765 7329 3a0a  umerate(edges):.
-00009c60: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00009c70: 6a2c 2070 7269 6d69 7469 7665 3220 696e  j, primitive2 in
-00009c80: 2065 6e75 6d65 7261 7465 2865 6467 6573   enumerate(edges
-00009c90: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00009ca0: 2020 2069 6620 6a20 3e20 693a 0a20 2020     if j > i:.   
-00009cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009cc0: 2069 6620 7072 696d 6974 6976 6532 2e65   if primitive2.e
-00009cd0: 6e64 2021 3d20 7072 696d 6974 6976 6531  nd != primitive1
-00009ce0: 2e73 7461 7274 2021 3d20 7072 696d 6974  .start != primit
-00009cf0: 6976 6532 2e73 7461 7274 2061 6e64 205c  ive2.start and \
-00009d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009d10: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00009d20: 6d69 7469 7665 322e 656e 6420 213d 2070  mitive2.end != p
-00009d30: 7269 6d69 7469 7665 312e 656e 6420 213d  rimitive1.end !=
-00009d40: 2070 7269 6d69 7469 7665 322e 7374 6172   primitive2.star
-00009d50: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-00009d60: 2020 2020 2020 2020 2020 2069 6620 7072             if pr
-00009d70: 696d 6974 6976 6531 2e75 6e69 745f 6469  imitive1.unit_di
-00009d80: 7265 6374 696f 6e5f 7665 6374 6f72 2861  rection_vector(a
-00009d90: 6273 6369 7373 613d 3029 2e69 735f 636f  bscissa=0).is_co
-00009da0: 6c69 6e65 6172 5f74 6f28 0a20 2020 2020  linear_to(.     
-00009db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009dc0: 2020 2020 2020 2020 2020 2070 7269 6d69             primi
-00009dd0: 7469 7665 322e 756e 6974 5f64 6972 6563  tive2.unit_direc
-00009de0: 7469 6f6e 5f76 6563 746f 7228 6162 7363  tion_vector(absc
-00009df0: 6973 7361 3d30 2929 3a0a 2020 2020 2020  issa=0)):.      
-00009e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e10: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
-00009e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e30: 2020 2020 2020 2069 6620 7072 696d 6974         if primit
-00009e40: 6976 6531 2e70 6f69 6e74 5f62 656c 6f6e  ive1.point_belon
-00009e50: 6773 2870 7269 6d69 7469 7665 322e 7374  gs(primitive2.st
-00009e60: 6172 7429 206f 7220 7072 696d 6974 6976  art) or primitiv
-00009e70: 6531 2e70 6f69 6e74 5f62 656c 6f6e 6773  e1.point_belongs
-00009e80: 2870 7269 6d69 7469 7665 322e 656e 6429  (primitive2.end)
-00009e90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00009ea0: 2020 2020 2020 2020 2020 2020 2020 746f                to
-00009eb0: 7563 6869 6e67 5f70 7269 6d69 7469 7665  uching_primitive
-00009ec0: 732e 6170 7065 6e64 285b 7072 696d 6974  s.append([primit
-00009ed0: 6976 6532 2c20 7072 696d 6974 6976 6531  ive2, primitive1
-00009ee0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-00009ef0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00009f00: 7072 696d 6974 6976 6532 2e70 6f69 6e74  primitive2.point
-00009f10: 5f62 656c 6f6e 6773 2870 7269 6d69 7469  _belongs(primiti
-00009f20: 7665 312e 7374 6172 7429 206f 7220 7072  ve1.start) or pr
-00009f30: 696d 6974 6976 6532 2e70 6f69 6e74 5f62  imitive2.point_b
-00009f40: 656c 6f6e 6773 2870 7269 6d69 7469 7665  elongs(primitive
-00009f50: 312e 656e 6429 3a0a 2020 2020 2020 2020  1.end):.        
+00008120: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+00008130: 7432 3a20 766f 6c6d 646c 722e 506f 696e  t2: volmdlr.Poin
+00008140: 7433 442c 2069 6e73 6964 6529 3a0a 2020  t3D, inside):.  
+00008150: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00008160: 662e 6578 7472 6163 745f 7769 7468 6f75  f.extract_withou
+00008170: 745f 7072 696d 6974 6976 6573 2870 6f69  t_primitives(poi
+00008180: 6e74 312c 2070 6f69 6e74 322c 2069 6e73  nt1, point2, ins
+00008190: 6964 6529 0a0a 2020 2020 6465 6620 6672  ide)..    def fr
+000081a0: 616d 655f 6d61 7070 696e 6728 7365 6c66  ame_mapping(self
+000081b0: 2c20 6672 616d 653a 2076 6f6c 6d64 6c72  , frame: volmdlr
+000081c0: 2e46 7261 6d65 3344 2c20 7369 6465 3a20  .Frame3D, side: 
+000081d0: 7374 7229 3a0a 2020 2020 2020 2020 2222  str):.        ""
+000081e0: 220a 2020 2020 2020 2020 4368 616e 6765  ".        Change
+000081f0: 7320 6672 616d 655f 6d61 7070 696e 6720  s frame_mapping 
+00008200: 616e 6420 7265 7475 726e 2061 206e 6577  and return a new
+00008210: 2057 6972 6533 442e 0a0a 2020 2020 2020   Wire3D...      
+00008220: 2020 3a70 6172 616d 2073 6964 653a 2027    :param side: '
+00008230: 6f6c 6427 206f 7220 276e 6577 270a 2020  old' or 'new'.  
+00008240: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00008250: 2020 6e65 775f 7769 7265 203d 205b 5d0a    new_wire = [].
+00008260: 2020 2020 2020 2020 666f 7220 7072 696d          for prim
+00008270: 6974 6976 6520 696e 2073 656c 662e 7072  itive in self.pr
+00008280: 696d 6974 6976 6573 3a0a 2020 2020 2020  imitives:.      
+00008290: 2020 2020 2020 6e65 775f 7769 7265 2e61        new_wire.a
+000082a0: 7070 656e 6428 7072 696d 6974 6976 652e  ppend(primitive.
+000082b0: 6672 616d 655f 6d61 7070 696e 6728 6672  frame_mapping(fr
+000082c0: 616d 652c 2073 6964 6529 290a 2020 2020  ame, side)).    
+000082d0: 2020 2020 7265 7475 726e 2057 6972 6533      return Wire3
+000082e0: 4428 6e65 775f 7769 7265 290a 0a20 2020  D(new_wire)..   
+000082f0: 2064 6566 2066 7261 6d65 5f6d 6170 7069   def frame_mappi
+00008300: 6e67 5f69 6e70 6c61 6365 2873 656c 662c  ng_inplace(self,
+00008310: 2066 7261 6d65 3a20 766f 6c6d 646c 722e   frame: volmdlr.
+00008320: 4672 616d 6533 442c 2073 6964 653a 2073  Frame3D, side: s
+00008330: 7472 293a 0a20 2020 2020 2020 2022 2222  tr):.        """
+00008340: 0a20 2020 2020 2020 2043 6861 6e67 6573  .        Changes
+00008350: 2066 7261 6d65 5f6d 6170 7069 6e67 2061   frame_mapping a
+00008360: 6e64 2074 6865 206f 626a 6563 7420 6973  nd the object is
+00008370: 2075 7064 6174 6564 2069 6e70 6c61 6365   updated inplace
+00008380: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00008390: 6d20 7369 6465 3a20 276f 6c64 2720 6f72  m side: 'old' or
+000083a0: 2027 6e65 7727 0a20 2020 2020 2020 2022   'new'.        "
+000083b0: 2222 0a20 2020 2020 2020 2077 6172 6e69  "".        warni
+000083c0: 6e67 732e 7761 726e 2822 2769 6e70 6c61  ngs.warn("'inpla
+000083d0: 6365 2720 6d65 7468 6f64 7320 6172 6520  ce' methods are 
+000083e0: 6465 7072 6563 6174 6564 2e20 5573 6520  deprecated. Use 
+000083f0: 6120 6e6f 7420 696e 706c 6163 6520 6d65  a not inplace me
+00008400: 7468 6f64 2069 6e73 7465 6164 2e22 2c20  thod instead.", 
+00008410: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
+00008420: 6e67 290a 0a20 2020 2020 2020 2066 6f72  ng)..        for
+00008430: 2070 7269 6d69 7469 7665 2069 6e20 7365   primitive in se
+00008440: 6c66 2e70 7269 6d69 7469 7665 733a 0a20  lf.primitives:. 
+00008450: 2020 2020 2020 2020 2020 2070 7269 6d69             primi
+00008460: 7469 7665 2e66 7261 6d65 5f6d 6170 7069  tive.frame_mappi
+00008470: 6e67 5f69 6e70 6c61 6365 2866 7261 6d65  ng_inplace(frame
+00008480: 2c20 7369 6465 290a 0a20 2020 2064 6566  , side)..    def
+00008490: 206d 696e 696d 756d 5f64 6973 7461 6e63   minimum_distanc
+000084a0: 6528 7365 6c66 2c20 7769 7265 3229 3a0a  e(self, wire2):.
+000084b0: 2020 2020 2020 2020 6469 7374 616e 6365          distance
+000084c0: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
+000084d0: 7220 656c 656d 656e 7420 696e 2073 656c  r element in sel
+000084e0: 662e 7072 696d 6974 6976 6573 3a0a 2020  f.primitives:.  
+000084f0: 2020 2020 2020 2020 2020 666f 7220 656c            for el
+00008500: 656d 656e 7432 2069 6e20 7769 7265 322e  ement2 in wire2.
+00008510: 7072 696d 6974 6976 6573 3a0a 2020 2020  primitives:.    
+00008520: 2020 2020 2020 2020 2020 2020 6469 7374              dist
+00008530: 616e 6365 2e61 7070 656e 6428 656c 656d  ance.append(elem
+00008540: 656e 742e 6d69 6e69 6d75 6d5f 6469 7374  ent.minimum_dist
+00008550: 616e 6365 2865 6c65 6d65 6e74 3229 290a  ance(element2)).
+00008560: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00008570: 6d69 6e28 6469 7374 616e 6365 290a 0a20  min(distance).. 
+00008580: 2020 2064 6566 2070 6f69 6e74 5f64 6973     def point_dis
+00008590: 7461 6e63 6528 7365 6c66 2c20 706f 696e  tance(self, poin
+000085a0: 7429 3a0a 2020 2020 2020 2020 6469 7374  t):.        dist
+000085b0: 616e 6365 2c20 6469 7374 616e 6365 5f70  ance, distance_p
+000085c0: 6f69 6e74 203d 206d 6174 682e 696e 662c  oint = math.inf,
+000085d0: 204e 6f6e 650a 2020 2020 2020 2020 666f   None.        fo
+000085e0: 7220 7072 696d 2069 6e20 7365 6c66 2e70  r prim in self.p
+000085f0: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
+00008600: 2020 2020 2020 2070 7269 6d5f 6469 7374         prim_dist
+00008610: 616e 6365 2c20 7072 696d 5f70 6f69 6e74  ance, prim_point
+00008620: 203d 2070 7269 6d2e 706f 696e 745f 6469   = prim.point_di
+00008630: 7374 616e 6365 2870 6f69 6e74 290a 2020  stance(point).  
+00008640: 2020 2020 2020 2020 2020 6966 2070 7269            if pri
+00008650: 6d5f 6469 7374 616e 6365 203c 2064 6973  m_distance < dis
+00008660: 7461 6e63 653a 0a20 2020 2020 2020 2020  tance:.         
+00008670: 2020 2020 2020 2064 6973 7461 6e63 6520         distance 
+00008680: 3d20 7072 696d 5f64 6973 7461 6e63 650a  = prim_distance.
+00008690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000086a0: 6469 7374 616e 6365 5f70 6f69 6e74 203d  distance_point =
+000086b0: 2070 7269 6d5f 706f 696e 740a 2020 2020   prim_point.    
+000086c0: 2020 2020 7265 7475 726e 2064 6973 7461      return dista
+000086d0: 6e63 652c 2064 6973 7461 6e63 655f 706f  nce, distance_po
+000086e0: 696e 740a 0a20 2020 2064 6566 2065 7874  int..    def ext
+000086f0: 7275 7369 6f6e 2873 656c 662c 2065 7874  rusion(self, ext
+00008700: 7275 7369 6f6e 5f76 6563 746f 7229 3a0a  rusion_vector):.
+00008710: 2020 2020 2020 2020 6661 6365 7320 3d20          faces = 
+00008720: 5b5d 0a20 2020 2020 2020 2066 6f72 2070  [].        for p
+00008730: 7269 6d69 7469 7665 2069 6e20 7365 6c66  rimitive in self
+00008740: 2e70 7269 6d69 7469 7665 733a 0a20 2020  .primitives:.   
+00008750: 2020 2020 2020 2020 2066 6163 6573 2e65           faces.e
+00008760: 7874 656e 6428 7072 696d 6974 6976 652e  xtend(primitive.
+00008770: 6578 7472 7573 696f 6e28 6578 7472 7573  extrusion(extrus
+00008780: 696f 6e5f 7665 6374 6f72 2929 0a20 2020  ion_vector)).   
+00008790: 2020 2020 2072 6574 7572 6e20 6661 6365       return face
+000087a0: 730a 0a20 2020 2064 6566 2074 6f5f 6273  s..    def to_bs
+000087b0: 706c 696e 6528 7365 6c66 2c20 6469 7363  pline(self, disc
+000087c0: 7265 7469 7a61 7469 6f6e 5f70 6172 616d  retization_param
+000087d0: 6574 6572 2c20 6465 6772 6565 293a 0a20  eter, degree):. 
+000087e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000087f0: 2020 2043 6f6e 7665 7274 2061 2077 6972     Convert a wir
+00008800: 6533 6420 746f 2061 2062 7370 6c69 6e65  e3d to a bspline
+00008810: 2063 7572 7665 3364 2e0a 0a20 2020 2020   curve3d...     
+00008820: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00008830: 6469 7363 7265 7469 7a65 645f 706f 696e  discretized_poin
+00008840: 7473 203d 2073 656c 662e 6469 7363 7265  ts = self.discre
+00008850: 7469 7a61 7469 6f6e 5f70 6f69 6e74 7328  tization_points(
+00008860: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
+00008870: 6172 616d 6574 6572 290a 2020 2020 2020  arameter).      
+00008880: 2020 6273 706c 696e 655f 6375 7276 6520    bspline_curve 
+00008890: 3d20 766f 6c6d 646c 722e 6564 6765 732e  = volmdlr.edges.
+000088a0: 4253 706c 696e 6543 7572 7665 3344 2e66  BSplineCurve3D.f
+000088b0: 726f 6d5f 706f 696e 7473 5f69 6e74 6572  rom_points_inter
+000088c0: 706f 6c61 7469 6f6e 2864 6973 6372 6574  polation(discret
+000088d0: 697a 6564 5f70 6f69 6e74 732c 2064 6567  ized_points, deg
+000088e0: 7265 6529 0a0a 2020 2020 2020 2020 7265  ree)..        re
+000088f0: 7475 726e 2062 7370 6c69 6e65 5f63 7572  turn bspline_cur
+00008900: 7665 0a0a 2020 2020 6465 6620 7472 6961  ve..    def tria
+00008910: 6e67 756c 6174 696f 6e28 7365 6c66 293a  ngulation(self):
+00008920: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00008930: 4e6f 6e65 0a0a 2020 2020 6465 6620 6765  None..    def ge
+00008940: 745f 7072 696d 6974 6976 6573 5f32 6428  t_primitives_2d(
+00008950: 7365 6c66 2c20 706c 616e 655f 6f72 6967  self, plane_orig
+00008960: 696e 2c20 782c 2079 293a 0a20 2020 2020  in, x, y):.     
+00008970: 2020 2022 2222 0a20 2020 2020 2020 2050     """.        P
+00008980: 6173 7320 7072 696d 6974 6976 6573 2074  ass primitives t
+00008990: 6f20 3264 0a20 2020 2020 2020 203a 7061  o 2d.        :pa
+000089a0: 7261 6d20 706c 616e 655f 6f72 6967 696e  ram plane_origin
+000089b0: 3a20 706c 616e 6520 6f72 6967 696e 0a20  : plane origin. 
+000089c0: 2020 2020 2020 203a 7061 7261 6d20 783a         :param x:
+000089d0: 2076 6563 746f 7220 750a 2020 2020 2020   vector u.      
+000089e0: 2020 3a70 6172 616d 2079 3a20 7665 6374    :param y: vect
+000089f0: 6f72 2076 0a20 2020 2020 2020 203a 7265  or v.        :re
+00008a00: 7475 726e 3a20 6c69 7374 206f 6620 3264  turn: list of 2d
+00008a10: 2070 7269 6d69 7469 7665 730a 2020 2020   primitives.    
+00008a20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00008a30: 7a20 3d20 782e 6372 6f73 7328 7929 0a20  z = x.cross(y). 
+00008a40: 2020 2020 2020 2070 6c61 6e65 3364 203d         plane3d =
+00008a50: 2076 6f6c 6d64 6c72 2e66 6163 6573 2e50   volmdlr.faces.P
+00008a60: 6c61 6e65 3344 2876 6f6c 6d64 6c72 2e46  lane3D(volmdlr.F
+00008a70: 7261 6d65 3344 2870 6c61 6e65 5f6f 7269  rame3D(plane_ori
+00008a80: 6769 6e2c 2078 2c20 792c 207a 2929 0a20  gin, x, y, z)). 
+00008a90: 2020 2020 2020 2070 7269 6d69 7469 7665         primitive
+00008aa0: 7332 6420 3d20 5b5d 0a20 2020 2020 2020  s2d = [].       
+00008ab0: 2066 6f72 2070 7269 6d69 7469 7665 2069   for primitive i
+00008ac0: 6e20 7365 6c66 2e70 7269 6d69 7469 7665  n self.primitive
+00008ad0: 733a 0a20 2020 2020 2020 2020 2020 2070  s:.            p
+00008ae0: 7269 6d69 7469 7665 3264 203d 2070 6c61  rimitive2d = pla
+00008af0: 6e65 3364 2e70 6f69 6e74 3364 5f74 6f5f  ne3d.point3d_to_
+00008b00: 3264 2870 7269 6d69 7469 7665 290a 2020  2d(primitive).  
+00008b10: 2020 2020 2020 2020 2020 6966 2070 7269            if pri
+00008b20: 6d69 7469 7665 3264 2069 7320 6e6f 7420  mitive2d is not 
+00008b30: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00008b40: 2020 2020 2020 7072 696d 6974 6976 6573        primitives
+00008b50: 3264 2e61 7070 656e 6428 7072 696d 6974  2d.append(primit
+00008b60: 6976 6532 6429 0a20 2020 2020 2020 2072  ive2d).        r
+00008b70: 6574 7572 6e20 7072 696d 6974 6976 6573  eturn primitives
+00008b80: 3264 0a0a 2020 2020 6465 6620 746f 5f32  2d..    def to_2
+00008b90: 6428 7365 6c66 2c20 706c 616e 655f 6f72  d(self, plane_or
+00008ba0: 6967 696e 2c20 782c 2079 293a 0a20 2020  igin, x, y):.   
+00008bb0: 2020 2020 2070 7269 6d69 7469 7665 7332       primitives2
+00008bc0: 6420 3d20 7365 6c66 2e67 6574 5f70 7269  d = self.get_pri
+00008bd0: 6d69 7469 7665 735f 3264 2870 6c61 6e65  mitives_2d(plane
+00008be0: 5f6f 7269 6769 6e2c 2078 2c20 7929 0a20  _origin, x, y). 
+00008bf0: 2020 2020 2020 2072 6574 7572 6e20 5769         return Wi
+00008c00: 7265 3244 2870 7269 6d69 7469 7665 733d  re2D(primitives=
+00008c10: 7072 696d 6974 6976 6573 3264 290a 0a20  primitives2d).. 
+00008c20: 2020 2064 6566 2072 6f74 6174 696f 6e28     def rotation(
+00008c30: 7365 6c66 2c20 6365 6e74 6572 3a20 766f  self, center: vo
+00008c40: 6c6d 646c 722e 506f 696e 7433 442c 2061  lmdlr.Point3D, a
+00008c50: 7869 733a 2076 6f6c 6d64 6c72 2e56 6563  xis: volmdlr.Vec
+00008c60: 746f 7233 442c 0a20 2020 2020 2020 2020  tor3D,.         
+00008c70: 2020 2020 2020 2020 616e 676c 653a 2066          angle: f
+00008c80: 6c6f 6174 293a 0a20 2020 2020 2020 2022  loat):.        "
+00008c90: 2222 0a20 2020 2020 2020 2057 6972 6533  "".        Wire3
+00008ca0: 4420 726f 7461 7469 6f6e 2e0a 0a20 2020  D rotation...   
+00008cb0: 2020 2020 203a 7061 7261 6d20 6365 6e74       :param cent
+00008cc0: 6572 3a20 726f 7461 7469 6f6e 2063 656e  er: rotation cen
+00008cd0: 7465 722e 0a20 2020 2020 2020 203a 7061  ter..        :pa
+00008ce0: 7261 6d20 6178 6973 3a20 726f 7461 7469  ram axis: rotati
+00008cf0: 6f6e 2061 7869 732e 0a20 2020 2020 2020  on axis..       
+00008d00: 203a 7061 7261 6d20 616e 676c 653a 2061   :param angle: a
+00008d10: 6e67 6c65 2072 6f74 6174 696f 6e2e 0a20  ngle rotation.. 
+00008d20: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+00008d30: 6120 6e65 7720 726f 7461 7465 6420 5769  a new rotated Wi
+00008d40: 7265 3344 2e0a 2020 2020 2020 2020 2222  re3D..        ""
+00008d50: 220a 2020 2020 2020 2020 6e65 775f 6564  ".        new_ed
+00008d60: 6765 7320 3d20 5b65 6467 652e 726f 7461  ges = [edge.rota
+00008d70: 7469 6f6e 2863 656e 7465 722c 2061 7869  tion(center, axi
+00008d80: 732c 2061 6e67 6c65 2920 666f 7220 6564  s, angle) for ed
+00008d90: 6765 0a20 2020 2020 2020 2020 2020 2020  ge.             
+00008da0: 2020 2020 2020 2020 696e 2073 656c 662e          in self.
+00008db0: 7072 696d 6974 6976 6573 5d0a 2020 2020  primitives].    
+00008dc0: 2020 2020 7265 7475 726e 2057 6972 6533      return Wire3
+00008dd0: 4428 6e65 775f 6564 6765 732c 2073 656c  D(new_edges, sel
+00008de0: 662e 6e61 6d65 290a 0a0a 2320 544f 444f  f.name)...# TODO
+00008df0: 3a20 6465 6669 6e65 2061 6e20 6564 6765  : define an edge
+00008e00: 2061 7320 616e 206f 7065 6e65 6420 706f   as an opened po
+00008e10: 6c79 676f 6e20 616e 6420 616c 6c6f 7720  lygon and allow 
+00008e20: 746f 2063 6f6d 7075 7465 2061 7265 6120  to compute area 
+00008e30: 6672 6f6d 2074 6869 7320 7265 6665 7265  from this refere
+00008e40: 6e63 650a 0a63 6c61 7373 2043 6f6e 746f  nce..class Conto
+00008e50: 7572 4d69 7869 6e28 5769 7265 4d69 7869  urMixin(WireMixi
+00008e60: 6e29 3a0a 2020 2020 2222 220a 2020 2020  n):.    """.    
+00008e70: 4162 7374 7261 6374 2063 6c61 7373 2066  Abstract class f
+00008e80: 6f72 2043 6f6e 746f 7572 2c20 7374 6f72  or Contour, stor
+00008e90: 696e 6720 6d65 7468 6f64 7320 616e 6420  ing methods and 
+00008ea0: 6174 7472 6962 7574 6573 2075 7365 6420  attributes used 
+00008eb0: 6279 2043 6f6e 746f 7572 3244 2061 6e64  by Contour2D and
+00008ec0: 2043 6f6e 746f 7572 3344 2e0a 0a20 2020   Contour3D...   
+00008ed0: 2022 2222 0a0a 2020 2020 6465 6620 6973   """..    def is
+00008ee0: 5f6f 7264 6572 6564 2873 656c 662c 2074  _ordered(self, t
+00008ef0: 6f6c 3d31 652d 3629 3a0a 2020 2020 2020  ol=1e-6):.      
+00008f00: 2020 666f 7220 7072 696d 312c 2070 7269    for prim1, pri
+00008f10: 6d32 2069 6e20 7a69 7028 0a20 2020 2020  m2 in zip(.     
+00008f20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00008f30: 7072 696d 6974 6976 6573 2c20 7365 6c66  primitives, self
+00008f40: 2e70 7269 6d69 7469 7665 735b 313a 5d20  .primitives[1:] 
+00008f50: 2b20 5b73 656c 662e 7072 696d 6974 6976  + [self.primitiv
+00008f60: 6573 5b30 5d5d 293a 0a20 2020 2020 2020  es[0]]):.       
+00008f70: 2020 2020 2069 6620 6e6f 7420 7072 696d       if not prim
+00008f80: 312e 656e 642e 6973 5f63 6c6f 7365 2870  1.end.is_close(p
+00008f90: 7269 6d32 2e73 7461 7274 2c20 746f 6c29  rim2.start, tol)
+00008fa0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00008fb0: 2020 7265 7475 726e 2046 616c 7365 0a20    return False. 
+00008fc0: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+00008fd0: 7565 0a0a 2020 2020 6465 6620 6f72 6465  ue..    def orde
+00008fe0: 7269 6e67 5f63 6f6e 746f 7572 2873 656c  ring_contour(sel
+00008ff0: 662c 2074 6f6c 3d31 652d 3629 3a0a 2020  f, tol=1e-6):.  
+00009000: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00009010: 2020 5265 7475 726e 7320 7468 6520 706f    Returns the po
+00009020: 696e 7473 206f 6620 7468 6520 636f 6e74  ints of the cont
+00009030: 6f75 7220 6f72 6465 7265 642e 0a0a 2020  our ordered...  
+00009040: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00009050: 2020 6c69 7374 5f70 6f69 6e74 5f70 6169    list_point_pai
+00009060: 7273 203d 205b 2870 7269 6d2e 7374 6172  rs = [(prim.star
+00009070: 742c 2070 7269 6d2e 656e 6429 2066 6f72  t, prim.end) for
+00009080: 2070 7269 6d20 696e 2073 656c 662e 7072   prim in self.pr
+00009090: 696d 6974 6976 6573 5d0a 2020 2020 2020  imitives].      
+000090a0: 2020 6c65 6e67 7468 5f6c 6973 745f 706f    length_list_po
+000090b0: 696e 7473 203d 206c 656e 286c 6973 745f  ints = len(list_
+000090c0: 706f 696e 745f 7061 6972 7329 0a20 2020  point_pairs).   
+000090d0: 2020 2020 2070 6f69 6e74 7320 3d20 5b6c       points = [l
+000090e0: 6973 745f 706f 696e 745f 7061 6972 735b  ist_point_pairs[
+000090f0: 305d 5d0a 2020 2020 2020 2020 7072 696d  0]].        prim
+00009100: 6974 6976 6573 203d 2073 656c 662e 7072  itives = self.pr
+00009110: 696d 6974 6976 6573 5b3a 5d0a 2020 2020  imitives[:].    
+00009120: 2020 2020 6e65 775f 7072 696d 6974 6976      new_primitiv
+00009130: 6573 203d 205b 7072 696d 6974 6976 6573  es = [primitives
+00009140: 5b30 5d5d 0a20 2020 2020 2020 2070 7269  [0]].        pri
+00009150: 6d69 7469 7665 732e 7265 6d6f 7665 2870  mitives.remove(p
+00009160: 7269 6d69 7469 7665 735b 305d 290a 2020  rimitives[0]).  
+00009170: 2020 2020 2020 6c69 7374 5f70 6f69 6e74        list_point
+00009180: 5f70 6169 7273 2e72 656d 6f76 6528 0a20  _pairs.remove(. 
+00009190: 2020 2020 2020 2020 2020 2028 6c69 7374             (list
+000091a0: 5f70 6f69 6e74 5f70 6169 7273 5b30 5d5b  _point_pairs[0][
+000091b0: 305d 2c20 6c69 7374 5f70 6f69 6e74 5f70  0], list_point_p
+000091c0: 6169 7273 5b30 5d5b 315d 2929 0a20 2020  airs[0][1])).   
+000091d0: 2020 2020 2066 696e 6973 6865 6420 3d20       finished = 
+000091e0: 4661 6c73 650a 2020 2020 2020 2020 636f  False.        co
+000091f0: 756e 7465 7220 3d20 300a 2020 2020 2020  unter = 0.      
+00009200: 2020 636f 756e 7465 7231 203d 2030 0a0a    counter1 = 0..
+00009210: 2020 2020 2020 2020 7768 696c 6520 6e6f          while no
+00009220: 7420 6669 6e69 7368 6564 3a0a 2020 2020  t finished:.    
+00009230: 2020 2020 2020 2020 666f 7220 692c 2028          for i, (
+00009240: 7031 2c20 7032 2920 696e 2065 6e75 6d65  p1, p2) in enume
+00009250: 7261 7465 286c 6973 745f 706f 696e 745f  rate(list_point_
+00009260: 7061 6972 7329 3a0a 2020 2020 2020 2020  pairs):.        
+00009270: 2020 2020 2020 2020 6966 2070 312e 706f          if p1.po
+00009280: 696e 745f 6469 7374 616e 6365 2870 3229  int_distance(p2)
+00009290: 203c 2074 6f6c 3a0a 2020 2020 2020 2020   < tol:.        
+000092a0: 2020 2020 2020 2020 2020 2020 6c69 7374              list
+000092b0: 5f70 6f69 6e74 5f70 6169 7273 2e72 656d  _point_pairs.rem
+000092c0: 6f76 6528 2870 312c 2070 3229 290a 2020  ove((p1, p2)).  
+000092d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092e0: 2020 7072 696d 6974 6976 6573 2e72 656d    primitives.rem
+000092f0: 6f76 6528 7072 696d 6974 6976 6573 5b69  ove(primitives[i
+00009300: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+00009310: 2020 2065 6c69 6620 7031 2e70 6f69 6e74     elif p1.point
+00009320: 5f64 6973 7461 6e63 6528 706f 696e 7473  _distance(points
+00009330: 5b2d 315d 5b2d 315d 2920 3c20 746f 6c3a  [-1][-1]) < tol:
+00009340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009350: 2020 2020 2070 6f69 6e74 732e 6170 7065       points.appe
+00009360: 6e64 2828 7031 2c20 7032 2929 0a20 2020  nd((p1, p2)).   
+00009370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009380: 206e 6577 5f70 7269 6d69 7469 7665 732e   new_primitives.
+00009390: 6170 7065 6e64 2870 7269 6d69 7469 7665  append(primitive
+000093a0: 735b 695d 290a 2020 2020 2020 2020 2020  s[i]).          
+000093b0: 2020 2020 2020 2020 2020 7072 696d 6974            primit
+000093c0: 6976 6573 2e72 656d 6f76 6528 7072 696d  ives.remove(prim
+000093d0: 6974 6976 6573 5b69 5d29 0a20 2020 2020  itives[i]).     
+000093e0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000093f0: 6973 745f 706f 696e 745f 7061 6972 732e  ist_point_pairs.
+00009400: 7265 6d6f 7665 2828 7031 2c20 7032 2929  remove((p1, p2))
+00009410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009420: 2065 6c69 6620 7032 2e70 6f69 6e74 5f64   elif p2.point_d
+00009430: 6973 7461 6e63 6528 706f 696e 7473 5b2d  istance(points[-
+00009440: 315d 5b2d 315d 2920 3c20 746f 6c3a 0a20  1][-1]) < tol:. 
+00009450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009460: 2020 2070 6f69 6e74 732e 6170 7065 6e64     points.append
+00009470: 2828 7032 2c20 7031 2929 0a20 2020 2020  ((p2, p1)).     
+00009480: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00009490: 6577 5f70 7269 6d69 7469 7665 732e 6170  ew_primitives.ap
+000094a0: 7065 6e64 2870 7269 6d69 7469 7665 735b  pend(primitives[
+000094b0: 695d 2e72 6576 6572 7365 2829 290a 2020  i].reverse()).  
+000094c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000094d0: 2020 7072 696d 6974 6976 6573 2e72 656d    primitives.rem
+000094e0: 6f76 6528 7072 696d 6974 6976 6573 5b69  ove(primitives[i
+000094f0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+00009500: 2020 2020 2020 206c 6973 745f 706f 696e         list_poin
+00009510: 745f 7061 6972 732e 7265 6d6f 7665 2828  t_pairs.remove((
+00009520: 7031 2c20 7032 2929 0a20 2020 2020 2020  p1, p2)).       
+00009530: 2020 2020 2020 2020 2065 6c69 6620 7031           elif p1
+00009540: 2e70 6f69 6e74 5f64 6973 7461 6e63 6528  .point_distance(
+00009550: 706f 696e 7473 5b30 5d5b 305d 2920 3c20  points[0][0]) < 
+00009560: 746f 6c3a 0a20 2020 2020 2020 2020 2020  tol:.           
+00009570: 2020 2020 2020 2020 2070 6f69 6e74 7320           points 
+00009580: 3d20 5b28 7032 2c20 7031 295d 202b 2070  = [(p2, p1)] + p
+00009590: 6f69 6e74 730a 2020 2020 2020 2020 2020  oints.          
+000095a0: 2020 2020 2020 2020 2020 6e65 775f 7072            new_pr
+000095b0: 696d 6974 6976 6573 203d 205b 7072 696d  imitives = [prim
+000095c0: 6974 6976 6573 5b69 5d2e 7265 7665 7273  itives[i].revers
+000095d0: 6528 295d 202b 206e 6577 5f70 7269 6d69  e()] + new_primi
+000095e0: 7469 7665 730a 2020 2020 2020 2020 2020  tives.          
+000095f0: 2020 2020 2020 2020 2020 7072 696d 6974            primit
+00009600: 6976 6573 2e72 656d 6f76 6528 7072 696d  ives.remove(prim
+00009610: 6974 6976 6573 5b69 5d29 0a20 2020 2020  itives[i]).     
+00009620: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00009630: 6973 745f 706f 696e 745f 7061 6972 732e  ist_point_pairs.
+00009640: 7265 6d6f 7665 2828 7031 2c20 7032 2929  remove((p1, p2))
+00009650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009660: 2065 6c69 6620 7032 2e70 6f69 6e74 5f64   elif p2.point_d
+00009670: 6973 7461 6e63 6528 706f 696e 7473 5b30  istance(points[0
+00009680: 5d5b 305d 2920 3c20 746f 6c3a 0a20 2020  ][0]) < tol:.   
+00009690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000096a0: 2070 6f69 6e74 7320 3d20 5b28 7031 2c20   points = [(p1, 
+000096b0: 7032 295d 202b 2070 6f69 6e74 730a 2020  p2)] + points.  
+000096c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000096d0: 2020 6e65 775f 7072 696d 6974 6976 6573    new_primitives
+000096e0: 203d 205b 7072 696d 6974 6976 6573 5b69   = [primitives[i
+000096f0: 5d5d 202b 206e 6577 5f70 7269 6d69 7469  ]] + new_primiti
+00009700: 7665 730a 2020 2020 2020 2020 2020 2020  ves.            
+00009710: 2020 2020 2020 2020 7072 696d 6974 6976          primitiv
+00009720: 6573 2e72 656d 6f76 6528 7072 696d 6974  es.remove(primit
+00009730: 6976 6573 5b69 5d29 0a20 2020 2020 2020  ives[i]).       
+00009740: 2020 2020 2020 2020 2020 2020 206c 6973               lis
+00009750: 745f 706f 696e 745f 7061 6972 732e 7265  t_point_pairs.re
+00009760: 6d6f 7665 2828 7031 2c20 7032 2929 0a20  move((p1, p2)). 
+00009770: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00009780: 6e28 6c69 7374 5f70 6f69 6e74 5f70 6169  n(list_point_pai
+00009790: 7273 2920 3d3d 2030 3a0a 2020 2020 2020  rs) == 0:.      
+000097a0: 2020 2020 2020 2020 2020 6669 6e69 7368            finish
+000097b0: 6564 203d 2054 7275 650a 2020 2020 2020  ed = True.      
+000097c0: 2020 2020 2020 636f 756e 7465 7231 202b        counter1 +
+000097d0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+000097e0: 6966 2063 6f75 6e74 6572 3120 3e3d 2031  if counter1 >= 1
+000097f0: 3030 202a 206c 656e 6774 685f 6c69 7374  00 * length_list
+00009800: 5f70 6f69 6e74 733a 0a20 2020 2020 2020  _points:.       
+00009810: 2020 2020 2020 2020 2073 656c 662e 706c           self.pl
+00009820: 6f74 2829 0a20 2020 2020 2020 2020 2020  ot().           
+00009830: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00009840: 706c 656d 656e 7465 6445 7272 6f72 0a20  plementedError. 
+00009850: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00009860: 6e28 6c69 7374 5f70 6f69 6e74 5f70 6169  n(list_point_pai
+00009870: 7273 2920 3d3d 2031 3a0a 2020 2020 2020  rs) == 1:.      
+00009880: 2020 2020 2020 2020 2020 636f 756e 7465            counte
+00009890: 7220 2b3d 2031 0a20 2020 2020 2020 2020  r += 1.         
+000098a0: 2020 2020 2020 2069 6620 636f 756e 7465         if counte
+000098b0: 7220 3e20 333a 0a20 2020 2020 2020 2020  r > 3:.         
+000098c0: 2020 2020 2020 2020 2020 2023 2066 6f72             # for
+000098d0: 2070 6f69 6e74 5f70 6169 7220 696e 206c   point_pair in l
+000098e0: 6973 745f 706f 696e 745f 7061 6972 733a  ist_point_pairs:
+000098f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009900: 2020 2020 2069 6620 6c69 7374 5f70 6f69       if list_poi
+00009910: 6e74 5f70 6169 7273 5b30 5d5b 305d 2069  nt_pairs[0][0] i
+00009920: 6e20 706f 696e 7473 206f 7220 6c69 7374  n points or list
+00009930: 5f70 6f69 6e74 5f70 6169 7273 5b30 5d5b  _point_pairs[0][
+00009940: 3a3a 2d31 5d20 696e 2070 6f69 6e74 733a  ::-1] in points:
+00009950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009960: 2020 2020 2020 2020 2066 696e 6973 6865           finishe
+00009970: 6420 3d20 5472 7565 0a20 2020 2020 2020  d = True.       
+00009980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009990: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
+000099a0: 2020 2020 2020 2020 2020 2020 2020 7761                wa
+000099b0: 726e 696e 6773 2e77 6172 6e28 2754 6865  rnings.warn('The
+000099c0: 7265 206d 6179 2065 7869 7374 2061 2070  re may exist a p
+000099d0: 726f 626c 656d 2077 6974 6820 7468 6973  roblem with this
+000099e0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
+000099f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009a00: 2020 2020 2720 636f 6e74 6f75 722c 2069      ' contour, i
+00009a10: 7420 7365 656d 7320 6974 2063 616e 6e6f  t seems it canno
+00009a20: 7420 6265 2072 656f 7264 6572 6564 2e27  t be reordered.'
+00009a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009a50: 2020 2027 2050 6c65 6173 652c 2076 6572     ' Please, ver
+00009a60: 6966 7920 6974 7320 706f 696e 7473 2729  ify its points')
+00009a70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009a80: 2020 2020 2066 696e 6973 6865 6420 3d20       finished = 
+00009a90: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00009aa0: 2020 2020 2020 2020 2023 2061 7820 3d20           # ax = 
+00009ab0: 7365 6c66 2e70 6c6f 7428 290a 2020 2020  self.plot().    
+00009ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ad0: 2320 666f 7220 706f 696e 745f 7061 6972  # for point_pair
+00009ae0: 2069 6e20 6c69 7374 5f70 6f69 6e74 5f70   in list_point_p
+00009af0: 6169 7273 3a0a 2020 2020 2020 2020 2020  airs:.          
+00009b00: 2020 2020 2020 2020 2020 2320 2020 2020            #     
+00009b10: 706f 696e 745f 7061 6972 5b30 5d2e 706c  point_pair[0].pl
+00009b20: 6f74 2861 783d 6178 2c20 636f 6c6f 723d  ot(ax=ax, color=
+00009b30: 2772 2729 0a20 2020 2020 2020 2020 2020  'r').           
+00009b40: 2020 2020 2020 2020 2023 2020 2020 2070           #     p
+00009b50: 6f69 6e74 5f70 6169 725b 315d 2e70 6c6f  oint_pair[1].plo
+00009b60: 7428 6178 3d61 782c 2063 6f6c 6f72 3d27  t(ax=ax, color='
+00009b70: 7227 290a 2020 2020 2020 2020 2020 2020  r').            
+00009b80: 2020 2020 2020 2020 2320 7261 6973 6520          # raise 
+00009b90: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+00009ba0: 726f 720a 2020 2020 2020 2020 7265 7475  ror.        retu
+00009bb0: 726e 206e 6577 5f70 7269 6d69 7469 7665  rn new_primitive
+00009bc0: 730a 0a20 2020 2040 7374 6174 6963 6d65  s..    @staticme
+00009bd0: 7468 6f64 0a20 2020 2064 6566 2074 6f75  thod.    def tou
+00009be0: 6368 696e 675f 6564 6765 735f 7061 6972  ching_edges_pair
+00009bf0: 7328 6564 6765 7329 3a20 2023 2054 4f20  s(edges):  # TO 
+00009c00: 444f 3a20 6d6f 7665 2074 6869 7320 746f  DO: move this to
+00009c10: 2065 6467 6573 3f0a 2020 2020 2020 2020   edges?.        
+00009c20: 746f 7563 6869 6e67 5f70 7269 6d69 7469  touching_primiti
+00009c30: 7665 7320 3d20 5b5d 0a20 2020 2020 2020  ves = [].       
+00009c40: 2066 6f72 2069 2c20 7072 696d 6974 6976   for i, primitiv
+00009c50: 6531 2069 6e20 656e 756d 6572 6174 6528  e1 in enumerate(
+00009c60: 6564 6765 7329 3a0a 2020 2020 2020 2020  edges):.        
+00009c70: 2020 2020 666f 7220 6a2c 2070 7269 6d69      for j, primi
+00009c80: 7469 7665 3220 696e 2065 6e75 6d65 7261  tive2 in enumera
+00009c90: 7465 2865 6467 6573 293a 0a20 2020 2020  te(edges):.     
+00009ca0: 2020 2020 2020 2020 2020 2069 6620 6a20             if j 
+00009cb0: 3e20 693a 0a20 2020 2020 2020 2020 2020  > i:.           
+00009cc0: 2020 2020 2020 2020 2069 6620 7072 696d           if prim
+00009cd0: 6974 6976 6532 2e65 6e64 2021 3d20 7072  itive2.end != pr
+00009ce0: 696d 6974 6976 6531 2e73 7461 7274 2021  imitive1.start !
+00009cf0: 3d20 7072 696d 6974 6976 6532 2e73 7461  = primitive2.sta
+00009d00: 7274 2061 6e64 205c 0a20 2020 2020 2020  rt and \.       
+00009d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d20: 2020 2020 2070 7269 6d69 7469 7665 322e       primitive2.
+00009d30: 656e 6420 213d 2070 7269 6d69 7469 7665  end != primitive
+00009d40: 312e 656e 6420 213d 2070 7269 6d69 7469  1.end != primiti
+00009d50: 7665 322e 7374 6172 743a 0a20 2020 2020  ve2.start:.     
+00009d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d70: 2020 2069 6620 7072 696d 6974 6976 6531     if primitive1
+00009d80: 2e75 6e69 745f 6469 7265 6374 696f 6e5f  .unit_direction_
+00009d90: 7665 6374 6f72 2861 6273 6369 7373 613d  vector(abscissa=
+00009da0: 3029 2e69 735f 636f 6c69 6e65 6172 5f74  0).is_colinear_t
+00009db0: 6f28 0a20 2020 2020 2020 2020 2020 2020  o(.             
+00009dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009dd0: 2020 2070 7269 6d69 7469 7665 322e 756e     primitive2.un
+00009de0: 6974 5f64 6972 6563 7469 6f6e 5f76 6563  it_direction_vec
+00009df0: 746f 7228 6162 7363 6973 7361 3d30 2929  tor(abscissa=0))
+00009e00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00009e10: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00009e20: 6e74 696e 7565 0a20 2020 2020 2020 2020  ntinue.         
+00009e30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00009e40: 6620 7072 696d 6974 6976 6531 2e70 6f69  f primitive1.poi
+00009e50: 6e74 5f62 656c 6f6e 6773 2870 7269 6d69  nt_belongs(primi
+00009e60: 7469 7665 322e 7374 6172 7429 206f 7220  tive2.start) or 
+00009e70: 7072 696d 6974 6976 6531 2e70 6f69 6e74  primitive1.point
+00009e80: 5f62 656c 6f6e 6773 2870 7269 6d69 7469  _belongs(primiti
+00009e90: 7665 322e 656e 6429 3a0a 2020 2020 2020  ve2.end):.      
+00009ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009eb0: 2020 2020 2020 746f 7563 6869 6e67 5f70        touching_p
+00009ec0: 7269 6d69 7469 7665 732e 6170 7065 6e64  rimitives.append
+00009ed0: 285b 7072 696d 6974 6976 6532 2c20 7072  ([primitive2, pr
+00009ee0: 696d 6974 6976 6531 5d29 0a20 2020 2020  imitive1]).     
+00009ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f00: 2020 2065 6c69 6620 7072 696d 6974 6976     elif primitiv
+00009f10: 6532 2e70 6f69 6e74 5f62 656c 6f6e 6773  e2.point_belongs
+00009f20: 2870 7269 6d69 7469 7665 312e 7374 6172  (primitive1.star
+00009f30: 7429 206f 7220 7072 696d 6974 6976 6532  t) or primitive2
+00009f40: 2e70 6f69 6e74 5f62 656c 6f6e 6773 2870  .point_belongs(p
+00009f50: 7269 6d69 7469 7665 312e 656e 6429 3a0a  rimitive1.end):.
 00009f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f70: 2020 2020 746f 7563 6869 6e67 5f70 7269      touching_pri
-00009f80: 6d69 7469 7665 732e 6170 7065 6e64 285b  mitives.append([
-00009f90: 7072 696d 6974 6976 6531 2c20 7072 696d  primitive1, prim
-00009fa0: 6974 6976 6532 5d29 0a20 2020 2020 2020  itive2]).       
-00009fb0: 2072 6574 7572 6e20 746f 7563 6869 6e67   return touching
-00009fc0: 5f70 7269 6d69 7469 7665 730a 0a20 2020  _primitives..   
-00009fd0: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
-00009fe0: 2020 2064 6566 2063 6f6e 746f 7572 735f     def contours_
-00009ff0: 7072 696d 6974 6976 6573 5f74 6f75 6368  primitives_touch
-0000a000: 696e 675f 7072 696d 6974 6976 6573 2874  ing_primitives(t
-0000a010: 6f75 6368 696e 675f 7072 696d 6974 6976  ouching_primitiv
-0000a020: 6573 293a 0a20 2020 2020 2020 2063 6f6e  es):.        con
-0000a030: 746f 7572 735f 7072 696d 6974 6976 6573  tours_primitives
-0000a040: 5f6c 6973 7473 203d 205b 5d0a 2020 2020  _lists = [].    
-0000a050: 2020 2020 666f 7220 7072 696d 312c 2070      for prim1, p
-0000a060: 7269 6d32 2069 6e20 746f 7563 6869 6e67  rim2 in touching
-0000a070: 5f70 7269 6d69 7469 7665 733a 0a20 2020  _primitives:.   
-0000a080: 2020 2020 2020 2020 2069 6620 7072 696d           if prim
-0000a090: 322e 706f 696e 745f 6265 6c6f 6e67 7328  2.point_belongs(
-0000a0a0: 7072 696d 312e 7374 6172 7429 3a0a 2020  prim1.start):.  
-0000a0b0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0000a0c0: 7465 7273 6563 7469 6f6e 203d 2070 7269  tersection = pri
-0000a0d0: 6d31 2e73 7461 7274 0a20 2020 2020 2020  m1.start.       
-0000a0e0: 2020 2020 2065 6c69 6620 7072 696d 322e       elif prim2.
-0000a0f0: 706f 696e 745f 6265 6c6f 6e67 7328 7072  point_belongs(pr
-0000a100: 696d 312e 656e 6429 3a0a 2020 2020 2020  im1.end):.      
-0000a110: 2020 2020 2020 2020 2020 696e 7465 7273            inters
-0000a120: 6563 7469 6f6e 203d 2070 7269 6d31 2e65  ection = prim1.e
-0000a130: 6e64 0a20 2020 2020 2020 2020 2020 2070  nd.            p
-0000a140: 7269 6d32 5f73 706c 6974 203d 2070 7269  rim2_split = pri
-0000a150: 6d32 2e73 706c 6974 2869 6e74 6572 7365  m2.split(interse
-0000a160: 6374 696f 6e29 0a20 2020 2020 2020 2020  ction).         
-0000a170: 2020 2066 6f72 2070 7269 6d20 696e 2070     for prim in p
-0000a180: 7269 6d32 5f73 706c 6974 3a0a 2020 2020  rim2_split:.    
-0000a190: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-0000a1a0: 7269 6d31 2e73 7461 7274 203d 3d20 7072  rim1.start == pr
-0000a1b0: 696d 2e73 7461 7274 206f 7220 7072 696d  im.start or prim
-0000a1c0: 312e 656e 6420 3d3d 2070 7269 6d2e 656e  1.end == prim.en
-0000a1d0: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
-0000a1e0: 2020 2020 2020 2070 7269 6d20 3d20 7072         prim = pr
-0000a1f0: 696d 2e72 6576 6572 7365 2829 0a20 2020  im.reverse().   
-0000a200: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000a210: 5b70 7269 6d31 2c20 7072 696d 5d20 6e6f  [prim1, prim] no
-0000a220: 7420 696e 2063 6f6e 746f 7572 735f 7072  t in contours_pr
-0000a230: 696d 6974 6976 6573 5f6c 6973 7473 3a0a  imitives_lists:.
-0000a240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a250: 2020 2020 636f 6e74 6f75 7273 5f70 7269      contours_pri
-0000a260: 6d69 7469 7665 735f 6c69 7374 732e 6170  mitives_lists.ap
-0000a270: 7065 6e64 285b 7072 696d 312c 2070 7269  pend([prim1, pri
-0000a280: 6d5d 290a 2020 2020 2020 2020 7265 7475  m]).        retu
-0000a290: 726e 2063 6f6e 746f 7572 735f 7072 696d  rn contours_prim
-0000a2a0: 6974 6976 6573 5f6c 6973 7473 0a0a 2020  itives_lists..  
-0000a2b0: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
-0000a2c0: 2020 2020 6465 6620 636f 6e6e 6563 7465      def connecte
-0000a2d0: 645f 746f 5f73 706c 6974 6564 5f70 7269  d_to_splited_pri
-0000a2e0: 6d69 7469 7665 7328 6564 6765 2c20 636f  mitives(edge, co
-0000a2f0: 6e74 6f75 7273 5f6c 6973 7429 3a0a 2020  ntours_list):.  
-0000a300: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000a310: 2020 5665 7269 6669 6573 2069 6620 6564    Verifies if ed
-0000a320: 6765 2069 7320 636f 6e6e 6563 7465 6420  ge is connected 
-0000a330: 746f 206f 6e65 206f 6620 7468 6520 7072  to one of the pr
-0000a340: 696d 6974 6976 6573 2069 6e73 6964 6520  imitives inside 
-0000a350: 636f 6e74 6f75 7273 2e0a 0a20 2020 2020  contours...     
-0000a360: 2020 203a 7061 7261 6d20 6564 6765 3a20     :param edge: 
-0000a370: 6564 6765 2066 6f72 2076 6572 6966 6963  edge for verific
-0000a380: 6174 696f 6e2e 0a20 2020 2020 2020 203a  ation..        :
-0000a390: 7061 7261 6d20 636f 6e74 6f75 7273 5f6c  param contours_l
-0000a3a0: 6973 743a 2063 6f6e 746f 7572 7320 6c69  ist: contours li
-0000a3b0: 7374 732e 0a20 2020 2020 2020 203a 7265  sts..        :re
-0000a3c0: 7475 726e 3a20 7570 6461 7465 2063 6f6e  turn: update con
-0000a3d0: 746f 7572 735f 7072 696d 6974 6976 6573  tours_primitives
-0000a3e0: 5f6c 6973 7473 2061 6e64 2061 2062 6f6f  _lists and a boo
-0000a3f0: 6c65 616e 2074 6f20 696e 6469 6361 7465  lean to indicate
-0000a400: 2069 6620 7468 6520 6564 6765 2073 686f   if the edge sho
-0000a410: 756c 6420 6265 2072 656d 6f76 6564 206f  uld be removed o
-0000a420: 7220 6e6f 742e 0a20 2020 2020 2020 2022  r not..        "
-0000a430: 2222 0a20 2020 2020 2020 2072 656d 6f76  "".        remov
-0000a440: 6520 3d20 4661 6c73 650a 2020 2020 2020  e = False.      
-0000a450: 2020 666f 7220 692c 2063 6f6e 746f 7572    for i, contour
-0000a460: 2069 6e20 656e 756d 6572 6174 6528 636f   in enumerate(co
-0000a470: 6e74 6f75 7273 5f6c 6973 7429 3a0a 2020  ntours_list):.  
-0000a480: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0000a490: 2063 6f6e 746f 7572 2e70 7269 6d69 7469   contour.primiti
-0000a4a0: 7665 5f6f 7665 725f 636f 6e74 6f75 7228  ve_over_contour(
-0000a4b0: 6564 6765 293a 0a20 2020 2020 2020 2020  edge):.         
-0000a4c0: 2020 2020 2020 2069 6620 636f 6e74 6f75         if contou
-0000a4d0: 722e 7072 696d 6974 6976 6573 5b30 5d2e  r.primitives[0].
-0000a4e0: 7374 6172 7420 696e 2028 6564 6765 2e65  start in (edge.e
-0000a4f0: 6e64 2c20 6564 6765 2e73 7461 7274 293a  nd, edge.start):
-0000a500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a510: 2020 2020 2063 6f6e 746f 7572 735f 6c69       contours_li
-0000a520: 7374 5b69 5d2e 7072 696d 6974 6976 6573  st[i].primitives
-0000a530: 203d 205b 6564 6765 2e63 6f70 7928 6465   = [edge.copy(de
-0000a540: 6570 3d54 7275 6529 5d20 2b20 636f 6e74  ep=True)] + cont
-0000a550: 6f75 722e 7072 696d 6974 6976 6573 0a20  our.primitives. 
-0000a560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a570: 2020 2072 656d 6f76 6520 3d20 5472 7565     remove = True
-0000a580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a590: 2065 6c69 6620 636f 6e74 6f75 722e 7072   elif contour.pr
-0000a5a0: 696d 6974 6976 6573 5b2d 315d 2e65 6e64  imitives[-1].end
-0000a5b0: 2069 6e20 2865 6467 652e 7374 6172 742c   in (edge.start,
-0000a5c0: 2065 6467 652e 656e 6429 3a0a 2020 2020   edge.end):.    
-0000a5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a5e0: 636f 6e74 6f75 7273 5f6c 6973 745b 695d  contours_list[i]
-0000a5f0: 2e70 7269 6d69 7469 7665 7320 3d20 636f  .primitives = co
-0000a600: 6e74 6f75 722e 7072 696d 6974 6976 6573  ntour.primitives
-0000a610: 202b 205b 6564 6765 2e63 6f70 7928 6465   + [edge.copy(de
-0000a620: 6570 3d54 7275 6529 5d0a 2020 2020 2020  ep=True)].      
-0000a630: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000a640: 6d6f 7665 203d 2054 7275 650a 2020 2020  move = True.    
-0000a650: 2020 2020 7265 7475 726e 2063 6f6e 746f      return conto
-0000a660: 7572 735f 6c69 7374 2c20 7265 6d6f 7665  urs_list, remove
-0000a670: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-0000a680: 686f 640a 2020 2020 6465 6620 6973 5f65  hod.    def is_e
-0000a690: 6467 655f 636f 6e6e 6563 7465 6428 636f  dge_connected(co
-0000a6a0: 6e74 6f75 725f 7072 696d 6974 6976 6573  ntour_primitives
-0000a6b0: 2c20 6564 6765 2c20 746f 6c29 3a0a 2020  , edge, tol):.  
-0000a6c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000a6d0: 2020 5665 7269 6669 6573 2069 6620 6564    Verifies if ed
-0000a6e0: 6765 2069 7320 636f 6e6e 6563 7465 6420  ge is connected 
-0000a6f0: 746f 206f 6e65 206f 6620 7468 6520 7072  to one of the pr
-0000a700: 696d 6974 6976 6573 2069 6e73 6964 6520  imitives inside 
-0000a710: 636f 6e74 6f75 725f 7072 696d 6974 6976  contour_primitiv
-0000a720: 6573 2e0a 0a20 2020 2020 2020 203a 7061  es...        :pa
-0000a730: 7261 6d20 636f 6e74 6f75 725f 7072 696d  ram contour_prim
-0000a740: 6974 6976 6573 3a20 6c69 7374 206f 6620  itives: list of 
-0000a750: 7072 696d 6974 6976 6573 2074 6f20 6372  primitives to cr
-0000a760: 6561 7465 2061 2063 6f6e 746f 7572 2e0a  eate a contour..
-0000a770: 2020 2020 2020 2020 3a70 6172 616d 2065          :param e
-0000a780: 6467 653a 2065 6467 6520 666f 7220 7665  dge: edge for ve
-0000a790: 7269 6669 6361 7469 6f6e 2e0a 2020 2020  rification..    
-0000a7a0: 2020 2020 3a70 6172 616d 2074 6f6c 3a20      :param tol: 
-0000a7b0: 746f 6c65 7261 6e63 6520 7573 6520 696e  tolerance use in
-0000a7c0: 2076 6572 6966 6963 6174 696f 6e2e 0a20   verification.. 
-0000a7d0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-0000a7e0: 7265 7475 726e 7320 7468 6520 6564 6765  returns the edge
-0000a7f0: 2069 6620 7472 7565 2c20 616e 6420 4e6f   if true, and No
-0000a800: 6e65 2069 6620 6e6f 7420 636f 6e6e 6563  ne if not connec
-0000a810: 7465 642e 0a20 2020 2020 2020 2022 2222  ted..        """
-0000a820: 0a20 2020 2020 2020 2065 6467 655f 636f  .        edge_co
-0000a830: 6e6e 6563 7465 6420 3d20 4e6f 6e65 0a20  nnected = None. 
-0000a840: 2020 2020 2020 2070 6f69 6e74 7320 3d20         points = 
-0000a850: 5b70 2066 6f72 2070 7269 6d20 696e 2063  [p for prim in c
-0000a860: 6f6e 746f 7572 5f70 7269 6d69 7469 7665  ontour_primitive
-0000a870: 7320 666f 7220 7020 696e 2070 7269 6d5d  s for p in prim]
-0000a880: 0a20 2020 2020 2020 2069 6620 2865 6467  .        if (edg
-0000a890: 652e 7374 6172 7420 696e 2070 6f69 6e74  e.start in point
-0000a8a0: 7320 6f72 2065 6467 652e 656e 6420 696e  s or edge.end in
-0000a8b0: 2070 6f69 6e74 7329 2061 6e64 2065 6467   points) and edg
-0000a8c0: 6520 6e6f 7420 696e 2063 6f6e 746f 7572  e not in contour
-0000a8d0: 5f70 7269 6d69 7469 7665 733a 0a20 2020  _primitives:.   
-0000a8e0: 2020 2020 2020 2020 2065 6467 655f 636f           edge_co
-0000a8f0: 6e6e 6563 7465 6420 3d20 6564 6765 0a20  nnected = edge. 
-0000a900: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000a910: 6e20 6564 6765 5f63 6f6e 6e65 6374 6564  n edge_connected
-0000a920: 0a0a 2020 2020 2020 2020 666f 7220 706f  ..        for po
-0000a930: 696e 7420 696e 2070 6f69 6e74 733a 0a20  int in points:. 
-0000a940: 2020 2020 2020 2020 2020 2069 6620 706f             if po
-0000a950: 696e 742e 6973 5f63 6c6f 7365 2865 6467  int.is_close(edg
-0000a960: 652e 7374 6172 742c 2074 6f6c 3d74 6f6c  e.start, tol=tol
-0000a970: 2920 616e 6420 5c0a 2020 2020 2020 2020  ) and \.        
-0000a980: 2020 2020 2020 2020 2020 2020 6564 6765              edge
-0000a990: 206e 6f74 2069 6e20 636f 6e74 6f75 725f   not in contour_
-0000a9a0: 7072 696d 6974 6976 6573 3a0a 2020 2020  primitives:.    
-0000a9b0: 2020 2020 2020 2020 2020 2020 6564 6765              edge
-0000a9c0: 2e73 7461 7274 203d 2070 6f69 6e74 0a20  .start = point. 
-0000a9d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000a9e0: 6467 655f 636f 6e6e 6563 7465 6420 3d20  dge_connected = 
-0000a9f0: 6564 6765 0a20 2020 2020 2020 2020 2020  edge.           
-0000aa00: 2020 2020 2072 6574 7572 6e20 6564 6765       return edge
-0000aa10: 5f63 6f6e 6e65 6374 6564 0a20 2020 2020  _connected.     
-0000aa20: 2020 2020 2020 2069 6620 706f 696e 742e         if point.
-0000aa30: 6973 5f63 6c6f 7365 2865 6467 652e 656e  is_close(edge.en
-0000aa40: 642c 2074 6f6c 3d74 6f6c 2920 616e 6420  d, tol=tol) and 
-0000aa50: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0000aa60: 2020 2020 2020 6564 6765 206e 6f74 2069        edge not i
-0000aa70: 6e20 636f 6e74 6f75 725f 7072 696d 6974  n contour_primit
-0000aa80: 6976 6573 3a0a 2020 2020 2020 2020 2020  ives:.          
-0000aa90: 2020 2020 2020 6564 6765 2e65 6e64 203d        edge.end =
-0000aaa0: 2070 6f69 6e74 0a20 2020 2020 2020 2020   point.         
-0000aab0: 2020 2020 2020 2065 6467 655f 636f 6e6e         edge_conn
-0000aac0: 6563 7465 6420 3d20 6564 6765 0a20 2020  ected = edge.   
-0000aad0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0000aae0: 7572 6e20 6564 6765 5f63 6f6e 6e65 6374  urn edge_connect
-0000aaf0: 6564 0a20 2020 2020 2020 2072 6574 7572  ed.        retur
-0000ab00: 6e20 6564 6765 5f63 6f6e 6e65 6374 6564  n edge_connected
-0000ab10: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-0000ab20: 686f 640a 2020 2020 6465 6620 6669 6e64  hod.    def find
-0000ab30: 5f63 6f6e 6e65 6374 6564 5f65 6467 6573  _connected_edges
-0000ab40: 2865 6467 6573 2c20 636f 6e74 6f75 7273  (edges, contours
-0000ab50: 5f6c 6973 742c 2063 6f6e 746f 7572 5f70  _list, contour_p
-0000ab60: 7269 6d69 7469 7665 732c 2074 6f6c 293a  rimitives, tol):
-0000ab70: 0a20 2020 2020 2020 2066 6f72 206c 696e  .        for lin
-0000ab80: 6520 696e 2065 6467 6573 3a0a 2020 2020  e in edges:.    
-0000ab90: 2020 2020 2020 2020 6966 2063 6f6e 746f          if conto
-0000aba0: 7572 735f 6c69 7374 3a0a 2020 2020 2020  urs_list:.      
-0000abb0: 2020 2020 2020 2020 2020 636f 6e74 6f75            contou
-0000abc0: 7273 5f6c 6973 742c 2072 656d 6f76 6520  rs_list, remove 
-0000abd0: 3d20 436f 6e74 6f75 724d 6978 696e 2e63  = ContourMixin.c
-0000abe0: 6f6e 6e65 6374 6564 5f74 6f5f 7370 6c69  onnected_to_spli
-0000abf0: 7465 645f 7072 696d 6974 6976 6573 286c  ted_primitives(l
-0000ac00: 696e 652c 2063 6f6e 746f 7572 735f 6c69  ine, contours_li
-0000ac10: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
-0000ac20: 2020 2020 6966 2072 656d 6f76 653a 0a20      if remove:. 
-0000ac30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac40: 2020 2065 6467 6573 2e72 656d 6f76 6528     edges.remove(
-0000ac50: 6c69 6e65 290a 2020 2020 2020 2020 2020  line).          
-0000ac60: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-0000ac70: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0000ac80: 6f74 2063 6f6e 746f 7572 5f70 7269 6d69  ot contour_primi
-0000ac90: 7469 7665 733a 0a20 2020 2020 2020 2020  tives:.         
-0000aca0: 2020 2020 2020 2063 6f6e 746f 7572 5f70         contour_p
-0000acb0: 7269 6d69 7469 7665 732e 6170 7065 6e64  rimitives.append
-0000acc0: 286c 696e 6529 0a20 2020 2020 2020 2020  (line).         
-0000acd0: 2020 2020 2020 2065 6467 6573 2e72 656d         edges.rem
-0000ace0: 6f76 6528 6c69 6e65 290a 2020 2020 2020  ove(line).      
-0000acf0: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-0000ad00: 2020 2020 2020 2020 2020 2020 6564 6765              edge
-0000ad10: 5f63 6f6e 6e65 6374 6564 203d 2043 6f6e  _connected = Con
-0000ad20: 746f 7572 4d69 7869 6e2e 6973 5f65 6467  tourMixin.is_edg
-0000ad30: 655f 636f 6e6e 6563 7465 6428 636f 6e74  e_connected(cont
-0000ad40: 6f75 725f 7072 696d 6974 6976 6573 2c20  our_primitives, 
-0000ad50: 6c69 6e65 2c20 746f 6c29 0a20 2020 2020  line, tol).     
-0000ad60: 2020 2020 2020 2069 6620 6564 6765 5f63         if edge_c
-0000ad70: 6f6e 6e65 6374 6564 2069 7320 6e6f 7420  onnected is not 
-0000ad80: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000ad90: 2020 2020 2020 636f 6e74 6f75 725f 7072        contour_pr
-0000ada0: 696d 6974 6976 6573 2e61 7070 656e 6428  imitives.append(
-0000adb0: 6564 6765 5f63 6f6e 6e65 6374 6564 290a  edge_connected).
-0000adc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000add0: 6564 6765 732e 7265 6d6f 7665 2865 6467  edges.remove(edg
-0000ade0: 655f 636f 6e6e 6563 7465 6429 0a20 2020  e_connected).   
-0000adf0: 2020 2020 2020 2020 2020 2020 2062 7265               bre
-0000ae00: 616b 0a20 2020 2020 2020 2072 6574 7572  ak.        retur
-0000ae10: 6e20 6564 6765 732c 2063 6f6e 746f 7572  n edges, contour
-0000ae20: 5f70 7269 6d69 7469 7665 732c 2063 6f6e  _primitives, con
-0000ae30: 746f 7572 735f 6c69 7374 0a0a 2020 2020  tours_list..    
-0000ae40: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-0000ae50: 2020 6465 6620 6765 745f 6564 6765 735f    def get_edges_
-0000ae60: 6269 6675 7263 6174 696f 6e73 2863 6f6e  bifurcations(con
-0000ae70: 746f 7572 5f70 7269 6d69 7469 7665 732c  tour_primitives,
-0000ae80: 2065 6467 6573 2c20 6669 6e69 7368 6564   edges, finished
-0000ae90: 5f6c 6f6f 7029 3a0a 2020 2020 2020 2020  _loop):.        
-0000aea0: 6772 6170 6820 3d20 6e78 2e47 7261 7068  graph = nx.Graph
-0000aeb0: 2829 0a20 2020 2020 2020 2066 6f72 2070  ().        for p
-0000aec0: 7269 6d20 696e 2063 6f6e 746f 7572 5f70  rim in contour_p
-0000aed0: 7269 6d69 7469 7665 735b 3a5d 3a0a 2020  rimitives[:]:.  
-0000aee0: 2020 2020 2020 2020 2020 6772 6170 682e            graph.
-0000aef0: 6164 645f 6564 6765 2870 7269 6d2e 7374  add_edge(prim.st
-0000af00: 6172 742c 2070 7269 6d2e 656e 6429 0a20  art, prim.end). 
-0000af10: 2020 2020 2020 2066 6f72 206e 6f64 6520         for node 
-0000af20: 696e 2067 7261 7068 2e6e 6f64 6573 3a0a  in graph.nodes:.
-0000af30: 2020 2020 2020 2020 2020 2020 6465 6772              degr
-0000af40: 6565 203d 2067 7261 7068 2e64 6567 7265  ee = graph.degre
-0000af50: 6528 6e6f 6465 290a 2020 2020 2020 2020  e(node).        
-0000af60: 2020 2020 6966 2064 6567 7265 6520 3c3d      if degree <=
-0000af70: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-0000af80: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
-0000af90: 2020 2020 2020 2020 2066 6f72 2069 2c20           for i, 
-0000afa0: 6e65 6968 6762 6f72 2069 6e20 656e 756d  neihgbor in enum
-0000afb0: 6572 6174 6528 6772 6170 682e 6e65 6967  erate(graph.neig
-0000afc0: 6862 6f72 7328 6e6f 6465 2929 3a0a 2020  hbors(node)):.  
-0000afd0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000afe0: 2067 7261 7068 2e64 6567 7265 6528 6e65   graph.degree(ne
-0000aff0: 6968 6762 6f72 2920 3d3d 2031 3a0a 2020  ihgbor) == 1:.  
-0000b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b010: 2020 695f 6564 6765 203d 2076 6f6c 6d64    i_edge = volmd
-0000b020: 6c72 2e65 6467 6573 2e4c 696e 6553 6567  lr.edges.LineSeg
-0000b030: 6d65 6e74 3244 286e 6f64 652c 206e 6569  ment2D(node, nei
-0000b040: 6867 626f 7229 0a20 2020 2020 2020 2020  hgbor).         
-0000b050: 2020 2020 2020 2020 2020 2069 6620 695f             if i_
-0000b060: 6564 6765 2069 6e20 636f 6e74 6f75 725f  edge in contour_
-0000b070: 7072 696d 6974 6976 6573 3a0a 2020 2020  primitives:.    
-0000b080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b090: 2020 2020 636f 6e74 6f75 725f 7072 696d      contour_prim
-0000b0a0: 6974 6976 6573 2e72 656d 6f76 6528 695f  itives.remove(i_
-0000b0b0: 6564 6765 290a 2020 2020 2020 2020 2020  edge).          
-0000b0c0: 2020 2020 2020 2020 2020 2020 2020 6564                ed
-0000b0d0: 6765 732e 6170 7065 6e64 2876 6f6c 6d64  ges.append(volmd
-0000b0e0: 6c72 2e65 6467 6573 2e4c 696e 6553 6567  lr.edges.LineSeg
-0000b0f0: 6d65 6e74 3244 286e 6f64 652c 206e 6569  ment2D(node, nei
-0000b100: 6867 626f 7229 290a 2020 2020 2020 2020  hgbor)).        
+00009f70: 2020 2020 2020 2020 2020 2020 746f 7563              touc
+00009f80: 6869 6e67 5f70 7269 6d69 7469 7665 732e  hing_primitives.
+00009f90: 6170 7065 6e64 285b 7072 696d 6974 6976  append([primitiv
+00009fa0: 6531 2c20 7072 696d 6974 6976 6532 5d29  e1, primitive2])
+00009fb0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00009fc0: 746f 7563 6869 6e67 5f70 7269 6d69 7469  touching_primiti
+00009fd0: 7665 730a 0a20 2020 2040 7374 6174 6963  ves..    @static
+00009fe0: 6d65 7468 6f64 0a20 2020 2064 6566 2063  method.    def c
+00009ff0: 6f6e 746f 7572 735f 7072 696d 6974 6976  ontours_primitiv
+0000a000: 6573 5f74 6f75 6368 696e 675f 7072 696d  es_touching_prim
+0000a010: 6974 6976 6573 2874 6f75 6368 696e 675f  itives(touching_
+0000a020: 7072 696d 6974 6976 6573 293a 0a20 2020  primitives):.   
+0000a030: 2020 2020 2063 6f6e 746f 7572 735f 7072       contours_pr
+0000a040: 696d 6974 6976 6573 5f6c 6973 7473 203d  imitives_lists =
+0000a050: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
+0000a060: 7072 696d 312c 2070 7269 6d32 2069 6e20  prim1, prim2 in 
+0000a070: 746f 7563 6869 6e67 5f70 7269 6d69 7469  touching_primiti
+0000a080: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
+0000a090: 2069 6620 7072 696d 322e 706f 696e 745f   if prim2.point_
+0000a0a0: 6265 6c6f 6e67 7328 7072 696d 312e 7374  belongs(prim1.st
+0000a0b0: 6172 7429 3a0a 2020 2020 2020 2020 2020  art):.          
+0000a0c0: 2020 2020 2020 696e 7465 7273 6563 7469        intersecti
+0000a0d0: 6f6e 203d 2070 7269 6d31 2e73 7461 7274  on = prim1.start
+0000a0e0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0000a0f0: 6620 7072 696d 322e 706f 696e 745f 6265  f prim2.point_be
+0000a100: 6c6f 6e67 7328 7072 696d 312e 656e 6429  longs(prim1.end)
+0000a110: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000a120: 2020 696e 7465 7273 6563 7469 6f6e 203d    intersection =
+0000a130: 2070 7269 6d31 2e65 6e64 0a20 2020 2020   prim1.end.     
+0000a140: 2020 2020 2020 2070 7269 6d32 5f73 706c         prim2_spl
+0000a150: 6974 203d 2070 7269 6d32 2e73 706c 6974  it = prim2.split
+0000a160: 2869 6e74 6572 7365 6374 696f 6e29 0a20  (intersection). 
+0000a170: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
+0000a180: 7269 6d20 696e 2070 7269 6d32 5f73 706c  rim in prim2_spl
+0000a190: 6974 3a0a 2020 2020 2020 2020 2020 2020  it:.            
+0000a1a0: 2020 2020 6966 2070 7269 6d31 2e73 7461      if prim1.sta
+0000a1b0: 7274 203d 3d20 7072 696d 2e73 7461 7274  rt == prim.start
+0000a1c0: 206f 7220 7072 696d 312e 656e 6420 3d3d   or prim1.end ==
+0000a1d0: 2070 7269 6d2e 656e 643a 0a20 2020 2020   prim.end:.     
+0000a1e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000a1f0: 7269 6d20 3d20 7072 696d 2e72 6576 6572  rim = prim.rever
+0000a200: 7365 2829 0a20 2020 2020 2020 2020 2020  se().           
+0000a210: 2020 2020 2069 6620 5b70 7269 6d31 2c20       if [prim1, 
+0000a220: 7072 696d 5d20 6e6f 7420 696e 2063 6f6e  prim] not in con
+0000a230: 746f 7572 735f 7072 696d 6974 6976 6573  tours_primitives
+0000a240: 5f6c 6973 7473 3a0a 2020 2020 2020 2020  _lists:.        
+0000a250: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0000a260: 6f75 7273 5f70 7269 6d69 7469 7665 735f  ours_primitives_
+0000a270: 6c69 7374 732e 6170 7065 6e64 285b 7072  lists.append([pr
+0000a280: 696d 312c 2070 7269 6d5d 290a 2020 2020  im1, prim]).    
+0000a290: 2020 2020 7265 7475 726e 2063 6f6e 746f      return conto
+0000a2a0: 7572 735f 7072 696d 6974 6976 6573 5f6c  urs_primitives_l
+0000a2b0: 6973 7473 0a0a 2020 2020 4073 7461 7469  ists..    @stati
+0000a2c0: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
+0000a2d0: 636f 6e6e 6563 7465 645f 746f 5f73 706c  connected_to_spl
+0000a2e0: 6974 6564 5f70 7269 6d69 7469 7665 7328  ited_primitives(
+0000a2f0: 6564 6765 2c20 636f 6e74 6f75 7273 5f6c  edge, contours_l
+0000a300: 6973 7429 3a0a 2020 2020 2020 2020 2222  ist):.        ""
+0000a310: 220a 2020 2020 2020 2020 5665 7269 6669  ".        Verifi
+0000a320: 6573 2069 6620 6564 6765 2069 7320 636f  es if edge is co
+0000a330: 6e6e 6563 7465 6420 746f 206f 6e65 206f  nnected to one o
+0000a340: 6620 7468 6520 7072 696d 6974 6976 6573  f the primitives
+0000a350: 2069 6e73 6964 6520 636f 6e74 6f75 7273   inside contours
+0000a360: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0000a370: 6d20 6564 6765 3a20 6564 6765 2066 6f72  m edge: edge for
+0000a380: 2076 6572 6966 6963 6174 696f 6e2e 0a20   verification.. 
+0000a390: 2020 2020 2020 203a 7061 7261 6d20 636f         :param co
+0000a3a0: 6e74 6f75 7273 5f6c 6973 743a 2063 6f6e  ntours_list: con
+0000a3b0: 746f 7572 7320 6c69 7374 732e 0a20 2020  tours lists..   
+0000a3c0: 2020 2020 203a 7265 7475 726e 3a20 7570       :return: up
+0000a3d0: 6461 7465 2063 6f6e 746f 7572 735f 7072  date contours_pr
+0000a3e0: 696d 6974 6976 6573 5f6c 6973 7473 2061  imitives_lists a
+0000a3f0: 6e64 2061 2062 6f6f 6c65 616e 2074 6f20  nd a boolean to 
+0000a400: 696e 6469 6361 7465 2069 6620 7468 6520  indicate if the 
+0000a410: 6564 6765 2073 686f 756c 6420 6265 2072  edge should be r
+0000a420: 656d 6f76 6564 206f 7220 6e6f 742e 0a20  emoved or not.. 
+0000a430: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000a440: 2020 2072 656d 6f76 6520 3d20 4661 6c73     remove = Fals
+0000a450: 650a 2020 2020 2020 2020 666f 7220 692c  e.        for i,
+0000a460: 2063 6f6e 746f 7572 2069 6e20 656e 756d   contour in enum
+0000a470: 6572 6174 6528 636f 6e74 6f75 7273 5f6c  erate(contours_l
+0000a480: 6973 7429 3a0a 2020 2020 2020 2020 2020  ist):.          
+0000a490: 2020 6966 206e 6f74 2063 6f6e 746f 7572    if not contour
+0000a4a0: 2e70 7269 6d69 7469 7665 5f6f 7665 725f  .primitive_over_
+0000a4b0: 636f 6e74 6f75 7228 6564 6765 293a 0a20  contour(edge):. 
+0000a4c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000a4d0: 6620 636f 6e74 6f75 722e 7072 696d 6974  f contour.primit
+0000a4e0: 6976 6573 5b30 5d2e 7374 6172 7420 696e  ives[0].start in
+0000a4f0: 2028 6564 6765 2e65 6e64 2c20 6564 6765   (edge.end, edge
+0000a500: 2e73 7461 7274 293a 0a20 2020 2020 2020  .start):.       
+0000a510: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0000a520: 746f 7572 735f 6c69 7374 5b69 5d2e 7072  tours_list[i].pr
+0000a530: 696d 6974 6976 6573 203d 205b 6564 6765  imitives = [edge
+0000a540: 2e63 6f70 7928 6465 6570 3d54 7275 6529  .copy(deep=True)
+0000a550: 5d20 2b20 636f 6e74 6f75 722e 7072 696d  ] + contour.prim
+0000a560: 6974 6976 6573 0a20 2020 2020 2020 2020  itives.         
+0000a570: 2020 2020 2020 2020 2020 2072 656d 6f76             remov
+0000a580: 6520 3d20 5472 7565 0a20 2020 2020 2020  e = True.       
+0000a590: 2020 2020 2020 2020 2065 6c69 6620 636f           elif co
+0000a5a0: 6e74 6f75 722e 7072 696d 6974 6976 6573  ntour.primitives
+0000a5b0: 5b2d 315d 2e65 6e64 2069 6e20 2865 6467  [-1].end in (edg
+0000a5c0: 652e 7374 6172 742c 2065 6467 652e 656e  e.start, edge.en
+0000a5d0: 6429 3a0a 2020 2020 2020 2020 2020 2020  d):.            
+0000a5e0: 2020 2020 2020 2020 636f 6e74 6f75 7273          contours
+0000a5f0: 5f6c 6973 745b 695d 2e70 7269 6d69 7469  _list[i].primiti
+0000a600: 7665 7320 3d20 636f 6e74 6f75 722e 7072  ves = contour.pr
+0000a610: 696d 6974 6976 6573 202b 205b 6564 6765  imitives + [edge
+0000a620: 2e63 6f70 7928 6465 6570 3d54 7275 6529  .copy(deep=True)
+0000a630: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0000a640: 2020 2020 2020 7265 6d6f 7665 203d 2054        remove = T
+0000a650: 7275 650a 2020 2020 2020 2020 7265 7475  rue.        retu
+0000a660: 726e 2063 6f6e 746f 7572 735f 6c69 7374  rn contours_list
+0000a670: 2c20 7265 6d6f 7665 0a0a 2020 2020 4073  , remove..    @s
+0000a680: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+0000a690: 6465 6620 6973 5f65 6467 655f 636f 6e6e  def is_edge_conn
+0000a6a0: 6563 7465 6428 636f 6e74 6f75 725f 7072  ected(contour_pr
+0000a6b0: 696d 6974 6976 6573 2c20 6564 6765 2c20  imitives, edge, 
+0000a6c0: 746f 6c29 3a0a 2020 2020 2020 2020 2222  tol):.        ""
+0000a6d0: 220a 2020 2020 2020 2020 5665 7269 6669  ".        Verifi
+0000a6e0: 6573 2069 6620 6564 6765 2069 7320 636f  es if edge is co
+0000a6f0: 6e6e 6563 7465 6420 746f 206f 6e65 206f  nnected to one o
+0000a700: 6620 7468 6520 7072 696d 6974 6976 6573  f the primitives
+0000a710: 2069 6e73 6964 6520 636f 6e74 6f75 725f   inside contour_
+0000a720: 7072 696d 6974 6976 6573 2e0a 0a20 2020  primitives...   
+0000a730: 2020 2020 203a 7061 7261 6d20 636f 6e74       :param cont
+0000a740: 6f75 725f 7072 696d 6974 6976 6573 3a20  our_primitives: 
+0000a750: 6c69 7374 206f 6620 7072 696d 6974 6976  list of primitiv
+0000a760: 6573 2074 6f20 6372 6561 7465 2061 2063  es to create a c
+0000a770: 6f6e 746f 7572 2e0a 2020 2020 2020 2020  ontour..        
+0000a780: 3a70 6172 616d 2065 6467 653a 2065 6467  :param edge: edg
+0000a790: 6520 666f 7220 7665 7269 6669 6361 7469  e for verificati
+0000a7a0: 6f6e 2e0a 2020 2020 2020 2020 3a70 6172  on..        :par
+0000a7b0: 616d 2074 6f6c 3a20 746f 6c65 7261 6e63  am tol: toleranc
+0000a7c0: 6520 7573 6520 696e 2076 6572 6966 6963  e use in verific
+0000a7d0: 6174 696f 6e2e 0a20 2020 2020 2020 203a  ation..        :
+0000a7e0: 7265 7475 726e 3a20 7265 7475 726e 7320  return: returns 
+0000a7f0: 7468 6520 6564 6765 2069 6620 7472 7565  the edge if true
+0000a800: 2c20 616e 6420 4e6f 6e65 2069 6620 6e6f  , and None if no
+0000a810: 7420 636f 6e6e 6563 7465 642e 0a20 2020  t connected..   
+0000a820: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000a830: 2065 6467 655f 636f 6e6e 6563 7465 6420   edge_connected 
+0000a840: 3d20 4e6f 6e65 0a20 2020 2020 2020 2070  = None.        p
+0000a850: 6f69 6e74 7320 3d20 5b70 2066 6f72 2070  oints = [p for p
+0000a860: 7269 6d20 696e 2063 6f6e 746f 7572 5f70  rim in contour_p
+0000a870: 7269 6d69 7469 7665 7320 666f 7220 7020  rimitives for p 
+0000a880: 696e 2070 7269 6d5d 0a20 2020 2020 2020  in prim].       
+0000a890: 2069 6620 2865 6467 652e 7374 6172 7420   if (edge.start 
+0000a8a0: 696e 2070 6f69 6e74 7320 6f72 2065 6467  in points or edg
+0000a8b0: 652e 656e 6420 696e 2070 6f69 6e74 7329  e.end in points)
+0000a8c0: 2061 6e64 2065 6467 6520 6e6f 7420 696e   and edge not in
+0000a8d0: 2063 6f6e 746f 7572 5f70 7269 6d69 7469   contour_primiti
+0000a8e0: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
+0000a8f0: 2065 6467 655f 636f 6e6e 6563 7465 6420   edge_connected 
+0000a900: 3d20 6564 6765 0a20 2020 2020 2020 2020  = edge.         
+0000a910: 2020 2072 6574 7572 6e20 6564 6765 5f63     return edge_c
+0000a920: 6f6e 6e65 6374 6564 0a0a 2020 2020 2020  onnected..      
+0000a930: 2020 666f 7220 706f 696e 7420 696e 2070    for point in p
+0000a940: 6f69 6e74 733a 0a20 2020 2020 2020 2020  oints:.         
+0000a950: 2020 2069 6620 706f 696e 742e 6973 5f63     if point.is_c
+0000a960: 6c6f 7365 2865 6467 652e 7374 6172 742c  lose(edge.start,
+0000a970: 2074 6f6c 3d74 6f6c 2920 616e 6420 5c0a   tol=tol) and \.
+0000a980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a990: 2020 2020 6564 6765 206e 6f74 2069 6e20      edge not in 
+0000a9a0: 636f 6e74 6f75 725f 7072 696d 6974 6976  contour_primitiv
+0000a9b0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+0000a9c0: 2020 2020 6564 6765 2e73 7461 7274 203d      edge.start =
+0000a9d0: 2070 6f69 6e74 0a20 2020 2020 2020 2020   point.         
+0000a9e0: 2020 2020 2020 2065 6467 655f 636f 6e6e         edge_conn
+0000a9f0: 6563 7465 6420 3d20 6564 6765 0a20 2020  ected = edge.   
+0000aa00: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0000aa10: 7572 6e20 6564 6765 5f63 6f6e 6e65 6374  urn edge_connect
+0000aa20: 6564 0a20 2020 2020 2020 2020 2020 2069  ed.            i
+0000aa30: 6620 706f 696e 742e 6973 5f63 6c6f 7365  f point.is_close
+0000aa40: 2865 6467 652e 656e 642c 2074 6f6c 3d74  (edge.end, tol=t
+0000aa50: 6f6c 2920 616e 6420 5c0a 2020 2020 2020  ol) and \.      
+0000aa60: 2020 2020 2020 2020 2020 2020 2020 6564                ed
+0000aa70: 6765 206e 6f74 2069 6e20 636f 6e74 6f75  ge not in contou
+0000aa80: 725f 7072 696d 6974 6976 6573 3a0a 2020  r_primitives:.  
+0000aa90: 2020 2020 2020 2020 2020 2020 2020 6564                ed
+0000aaa0: 6765 2e65 6e64 203d 2070 6f69 6e74 0a20  ge.end = point. 
+0000aab0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0000aac0: 6467 655f 636f 6e6e 6563 7465 6420 3d20  dge_connected = 
+0000aad0: 6564 6765 0a20 2020 2020 2020 2020 2020  edge.           
+0000aae0: 2020 2020 2072 6574 7572 6e20 6564 6765       return edge
+0000aaf0: 5f63 6f6e 6e65 6374 6564 0a20 2020 2020  _connected.     
+0000ab00: 2020 2072 6574 7572 6e20 6564 6765 5f63     return edge_c
+0000ab10: 6f6e 6e65 6374 6564 0a0a 2020 2020 4073  onnected..    @s
+0000ab20: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+0000ab30: 6465 6620 6669 6e64 5f63 6f6e 6e65 6374  def find_connect
+0000ab40: 6564 5f65 6467 6573 2865 6467 6573 2c20  ed_edges(edges, 
+0000ab50: 636f 6e74 6f75 7273 5f6c 6973 742c 2063  contours_list, c
+0000ab60: 6f6e 746f 7572 5f70 7269 6d69 7469 7665  ontour_primitive
+0000ab70: 732c 2074 6f6c 293a 0a20 2020 2020 2020  s, tol):.       
+0000ab80: 2066 6f72 206c 696e 6520 696e 2065 6467   for line in edg
+0000ab90: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+0000aba0: 6966 2063 6f6e 746f 7572 735f 6c69 7374  if contours_list
+0000abb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000abc0: 2020 636f 6e74 6f75 7273 5f6c 6973 742c    contours_list,
+0000abd0: 2072 656d 6f76 6520 3d20 436f 6e74 6f75   remove = Contou
+0000abe0: 724d 6978 696e 2e63 6f6e 6e65 6374 6564  rMixin.connected
+0000abf0: 5f74 6f5f 7370 6c69 7465 645f 7072 696d  _to_splited_prim
+0000ac00: 6974 6976 6573 286c 696e 652c 2063 6f6e  itives(line, con
+0000ac10: 746f 7572 735f 6c69 7374 290a 2020 2020  tours_list).    
+0000ac20: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+0000ac30: 656d 6f76 653a 0a20 2020 2020 2020 2020  emove:.         
+0000ac40: 2020 2020 2020 2020 2020 2065 6467 6573             edges
+0000ac50: 2e72 656d 6f76 6528 6c69 6e65 290a 2020  .remove(line).  
+0000ac60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac70: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+0000ac80: 2020 2020 6966 206e 6f74 2063 6f6e 746f      if not conto
+0000ac90: 7572 5f70 7269 6d69 7469 7665 733a 0a20  ur_primitives:. 
+0000aca0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000acb0: 6f6e 746f 7572 5f70 7269 6d69 7469 7665  ontour_primitive
+0000acc0: 732e 6170 7065 6e64 286c 696e 6529 0a20  s.append(line). 
+0000acd0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0000ace0: 6467 6573 2e72 656d 6f76 6528 6c69 6e65  dges.remove(line
+0000acf0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000ad00: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+0000ad10: 2020 2020 6564 6765 5f63 6f6e 6e65 6374      edge_connect
+0000ad20: 6564 203d 2043 6f6e 746f 7572 4d69 7869  ed = ContourMixi
+0000ad30: 6e2e 6973 5f65 6467 655f 636f 6e6e 6563  n.is_edge_connec
+0000ad40: 7465 6428 636f 6e74 6f75 725f 7072 696d  ted(contour_prim
+0000ad50: 6974 6976 6573 2c20 6c69 6e65 2c20 746f  itives, line, to
+0000ad60: 6c29 0a20 2020 2020 2020 2020 2020 2069  l).            i
+0000ad70: 6620 6564 6765 5f63 6f6e 6e65 6374 6564  f edge_connected
+0000ad80: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0000ad90: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0000ada0: 6e74 6f75 725f 7072 696d 6974 6976 6573  ntour_primitives
+0000adb0: 2e61 7070 656e 6428 6564 6765 5f63 6f6e  .append(edge_con
+0000adc0: 6e65 6374 6564 290a 2020 2020 2020 2020  nected).        
+0000add0: 2020 2020 2020 2020 6564 6765 732e 7265          edges.re
+0000ade0: 6d6f 7665 2865 6467 655f 636f 6e6e 6563  move(edge_connec
+0000adf0: 7465 6429 0a20 2020 2020 2020 2020 2020  ted).           
+0000ae00: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
+0000ae10: 2020 2072 6574 7572 6e20 6564 6765 732c     return edges,
+0000ae20: 2063 6f6e 746f 7572 5f70 7269 6d69 7469   contour_primiti
+0000ae30: 7665 732c 2063 6f6e 746f 7572 735f 6c69  ves, contours_li
+0000ae40: 7374 0a0a 2020 2020 4073 7461 7469 636d  st..    @staticm
+0000ae50: 6574 686f 640a 2020 2020 6465 6620 6765  ethod.    def ge
+0000ae60: 745f 6564 6765 735f 6269 6675 7263 6174  t_edges_bifurcat
+0000ae70: 696f 6e73 2863 6f6e 746f 7572 5f70 7269  ions(contour_pri
+0000ae80: 6d69 7469 7665 732c 2065 6467 6573 2c20  mitives, edges, 
+0000ae90: 6669 6e69 7368 6564 5f6c 6f6f 7029 3a0a  finished_loop):.
+0000aea0: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
+0000aeb0: 6e78 2e47 7261 7068 2829 0a20 2020 2020  nx.Graph().     
+0000aec0: 2020 2066 6f72 2070 7269 6d20 696e 2063     for prim in c
+0000aed0: 6f6e 746f 7572 5f70 7269 6d69 7469 7665  ontour_primitive
+0000aee0: 735b 3a5d 3a0a 2020 2020 2020 2020 2020  s[:]:.          
+0000aef0: 2020 6772 6170 682e 6164 645f 6564 6765    graph.add_edge
+0000af00: 2870 7269 6d2e 7374 6172 742c 2070 7269  (prim.start, pri
+0000af10: 6d2e 656e 6429 0a20 2020 2020 2020 2066  m.end).        f
+0000af20: 6f72 206e 6f64 6520 696e 2067 7261 7068  or node in graph
+0000af30: 2e6e 6f64 6573 3a0a 2020 2020 2020 2020  .nodes:.        
+0000af40: 2020 2020 6465 6772 6565 203d 2067 7261      degree = gra
+0000af50: 7068 2e64 6567 7265 6528 6e6f 6465 290a  ph.degree(node).
+0000af60: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+0000af70: 6567 7265 6520 3c3d 2032 3a0a 2020 2020  egree <= 2:.    
+0000af80: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0000af90: 696e 7565 0a20 2020 2020 2020 2020 2020  inue.           
+0000afa0: 2066 6f72 2069 2c20 6e65 6968 6762 6f72   for i, neihgbor
+0000afb0: 2069 6e20 656e 756d 6572 6174 6528 6772   in enumerate(gr
+0000afc0: 6170 682e 6e65 6967 6862 6f72 7328 6e6f  aph.neighbors(no
+0000afd0: 6465 2929 3a0a 2020 2020 2020 2020 2020  de)):.          
+0000afe0: 2020 2020 2020 6966 2067 7261 7068 2e64        if graph.d
+0000aff0: 6567 7265 6528 6e65 6968 6762 6f72 2920  egree(neihgbor) 
+0000b000: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+0000b010: 2020 2020 2020 2020 2020 695f 6564 6765            i_edge
+0000b020: 203d 2076 6f6c 6d64 6c72 2e65 6467 6573   = volmdlr.edges
+0000b030: 2e4c 696e 6553 6567 6d65 6e74 3244 286e  .LineSegment2D(n
+0000b040: 6f64 652c 206e 6569 6867 626f 7229 0a20  ode, neihgbor). 
+0000b050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b060: 2020 2069 6620 695f 6564 6765 2069 6e20     if i_edge in 
+0000b070: 636f 6e74 6f75 725f 7072 696d 6974 6976  contour_primitiv
+0000b080: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+0000b090: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0000b0a0: 6f75 725f 7072 696d 6974 6976 6573 2e72  our_primitives.r
+0000b0b0: 656d 6f76 6528 695f 6564 6765 290a 2020  emove(i_edge).  
+0000b0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0d0: 2020 2020 2020 6564 6765 732e 6170 7065        edges.appe
+0000b0e0: 6e64 2876 6f6c 6d64 6c72 2e65 6467 6573  nd(volmdlr.edges
+0000b0f0: 2e4c 696e 6553 6567 6d65 6e74 3244 286e  .LineSegment2D(n
+0000b100: 6f64 652c 206e 6569 6867 626f 7229 290a  ode, neihgbor)).
 0000b110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b120: 6669 6e69 7368 6564 5f6c 6f6f 7020 3d20  finished_loop = 
-0000b130: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-0000b140: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000b150: 2069 202b 2031 203d 3d20 6465 6772 6565   i + 1 == degree
-0000b160: 202d 2032 3a0a 2020 2020 2020 2020 2020   - 2:.          
+0000b120: 2020 2020 2020 2020 6669 6e69 7368 6564          finished
+0000b130: 5f6c 6f6f 7020 3d20 4661 6c73 650a 2020  _loop = False.  
+0000b140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b150: 2020 2020 2020 6966 2069 202b 2031 203d        if i + 1 =
+0000b160: 3d20 6465 6772 6565 202d 2032 3a0a 2020  = degree - 2:.  
 0000b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b180: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
-0000b190: 7265 7475 726e 2063 6f6e 746f 7572 5f70  return contour_p
-0000b1a0: 7269 6d69 7469 7665 732c 2065 6467 6573  rimitives, edges
-0000b1b0: 2c20 6669 6e69 7368 6564 5f6c 6f6f 700a  , finished_loop.
-0000b1c0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-0000b1d0: 640a 2020 2020 6465 6620 636f 6e74 6f75  d.    def contou
-0000b1e0: 7273 5f66 726f 6d5f 6564 6765 7328 636c  rs_from_edges(cl
-0000b1f0: 732c 2065 6467 6573 2c20 746f 6c3d 3165  s, edges, tol=1e
-0000b200: 2d37 293a 0a20 2020 2020 2020 2069 6620  -7):.        if 
-0000b210: 6e6f 7420 6564 6765 733a 0a20 2020 2020  not edges:.     
-0000b220: 2020 2020 2020 2072 6574 7572 6e20 5b5d         return []
-0000b230: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-0000b240: 6564 6765 7329 203d 3d20 313a 0a20 2020  edges) == 1:.   
-0000b250: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000b260: 5b63 6c73 2865 6467 6573 295d 0a20 2020  [cls(edges)].   
-0000b270: 2020 2020 2074 6f75 6368 696e 675f 7072       touching_pr
-0000b280: 696d 6974 6976 6573 203d 2063 6c73 2e74  imitives = cls.t
-0000b290: 6f75 6368 696e 675f 6564 6765 735f 7061  ouching_edges_pa
-0000b2a0: 6972 7328 6564 6765 7329 0a20 2020 2020  irs(edges).     
-0000b2b0: 2020 2066 6f72 2070 7269 6d73 2069 6e20     for prims in 
-0000b2c0: 746f 7563 6869 6e67 5f70 7269 6d69 7469  touching_primiti
-0000b2d0: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
-0000b2e0: 2069 6620 7072 696d 735b 305d 2069 6e20   if prims[0] in 
-0000b2f0: 6564 6765 733a 0a20 2020 2020 2020 2020  edges:.         
-0000b300: 2020 2020 2020 2065 6467 6573 2e72 656d         edges.rem
-0000b310: 6f76 6528 7072 696d 735b 305d 290a 2020  ove(prims[0]).  
-0000b320: 2020 2020 2020 2020 2020 6966 2070 7269            if pri
-0000b330: 6d73 5b31 5d20 696e 2065 6467 6573 3a0a  ms[1] in edges:.
-0000b340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b350: 6564 6765 732e 7265 6d6f 7665 2870 7269  edges.remove(pri
-0000b360: 6d73 5b31 5d29 0a20 2020 2020 2020 2063  ms[1]).        c
-0000b370: 6f6e 746f 7572 735f 7072 696d 6974 6976  ontours_primitiv
-0000b380: 6573 5f6c 6973 7473 203d 2063 6c73 2e63  es_lists = cls.c
-0000b390: 6f6e 746f 7572 735f 7072 696d 6974 6976  ontours_primitiv
-0000b3a0: 6573 5f74 6f75 6368 696e 675f 7072 696d  es_touching_prim
-0000b3b0: 6974 6976 6573 2874 6f75 6368 696e 675f  itives(touching_
-0000b3c0: 7072 696d 6974 6976 6573 290a 2020 2020  primitives).    
-0000b3d0: 2020 2020 636f 6e74 6f75 7273 5f6c 6973      contours_lis
-0000b3e0: 7420 3d20 5b63 6c73 2870 7269 6d69 7469  t = [cls(primiti
-0000b3f0: 7665 7329 2066 6f72 2070 7269 6d69 7469  ves) for primiti
-0000b400: 7665 7320 696e 2063 6f6e 746f 7572 735f  ves in contours_
-0000b410: 7072 696d 6974 6976 6573 5f6c 6973 7473  primitives_lists
-0000b420: 5d0a 2020 2020 2020 2020 6966 206e 6f74  ].        if not
-0000b430: 2065 6467 6573 3a0a 2020 2020 2020 2020   edges:.        
-0000b440: 2020 2020 7265 7475 726e 2063 6f6e 746f      return conto
-0000b450: 7572 735f 6c69 7374 0a20 2020 2020 2020  urs_list.       
-0000b460: 206c 6973 745f 636f 6e74 6f75 7273 203d   list_contours =
-0000b470: 205b 5d0a 2020 2020 2020 2020 6669 6e69   [].        fini
-0000b480: 7368 6564 203d 2046 616c 7365 0a20 2020  shed = False.   
-0000b490: 2020 2020 2063 6f6e 746f 7572 5f70 7269       contour_pri
-0000b4a0: 6d69 7469 7665 7320 3d20 5b5d 0a0a 2020  mitives = []..  
-0000b4b0: 2020 2020 2020 7768 696c 6520 6e6f 7420        while not 
-0000b4c0: 6669 6e69 7368 6564 3a0a 2020 2020 2020  finished:.      
-0000b4d0: 2020 2020 2020 6c65 6e31 203d 206c 656e        len1 = len
-0000b4e0: 2865 6467 6573 290a 2020 2020 2020 2020  (edges).        
-0000b4f0: 2020 2020 6564 6765 732c 2063 6f6e 746f      edges, conto
-0000b500: 7572 5f70 7269 6d69 7469 7665 732c 2063  ur_primitives, c
-0000b510: 6f6e 746f 7572 735f 6c69 7374 203d 2063  ontours_list = c
-0000b520: 6c73 2e66 696e 645f 636f 6e6e 6563 7465  ls.find_connecte
-0000b530: 645f 6564 6765 7328 0a20 2020 2020 2020  d_edges(.       
-0000b540: 2020 2020 2020 2020 2065 6467 6573 2c20           edges, 
-0000b550: 636f 6e74 6f75 7273 5f6c 6973 742c 2063  contours_list, c
-0000b560: 6f6e 746f 7572 5f70 7269 6d69 7469 7665  ontour_primitive
-0000b570: 732c 2074 6f6c 290a 2020 2020 2020 2020  s, tol).        
-0000b580: 2020 2020 6966 206e 6f74 2065 6467 6573      if not edges
-0000b590: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000b5a0: 2020 6669 6e69 7368 6564 203d 2054 7275    finished = Tru
-0000b5b0: 650a 2020 2020 2020 2020 2020 2020 7661  e.            va
-0000b5c0: 6c69 6420 3d20 4661 6c73 650a 0a20 2020  lid = False..   
-0000b5d0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-0000b5e0: 6564 6765 7329 2021 3d20 3020 616e 6420  edges) != 0 and 
-0000b5f0: 6c65 6e28 6564 6765 7329 203d 3d20 6c65  len(edges) == le
-0000b600: 6e31 2061 6e64 206c 656e 2863 6f6e 746f  n1 and len(conto
-0000b610: 7572 5f70 7269 6d69 7469 7665 7329 2021  ur_primitives) !
-0000b620: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0000b630: 2020 2020 2076 616c 6964 203d 2054 7275       valid = Tru
-0000b640: 650a 2020 2020 2020 2020 2020 2020 656c  e.            el
-0000b650: 6966 206c 656e 2865 6467 6573 2920 3d3d  if len(edges) ==
-0000b660: 2030 2061 6e64 206c 656e 2863 6f6e 746f   0 and len(conto
-0000b670: 7572 5f70 7269 6d69 7469 7665 7329 2021  ur_primitives) !
-0000b680: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0000b690: 2020 2020 2076 616c 6964 203d 2054 7275       valid = Tru
-0000b6a0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0000b6b0: 2020 6669 6e69 7368 6564 203d 2054 7275    finished = Tru
-0000b6c0: 650a 2020 2020 2020 2020 2020 2020 6966  e.            if
-0000b6d0: 2076 616c 6964 3a0a 2020 2020 2020 2020   valid:.        
-0000b6e0: 2020 2020 2020 2020 636f 6e74 6f75 725f          contour_
-0000b6f0: 7072 696d 6974 6976 6573 2c20 6564 6765  primitives, edge
-0000b700: 732c 2066 696e 6973 6865 6420 3d20 636c  s, finished = cl
-0000b710: 732e 6765 745f 6564 6765 735f 6269 6675  s.get_edges_bifu
-0000b720: 7263 6174 696f 6e73 2863 6f6e 746f 7572  rcations(contour
-0000b730: 5f70 7269 6d69 7469 7665 732c 0a20 2020  _primitives,.   
-0000b740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b180: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
+0000b190: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+0000b1a0: 6f6e 746f 7572 5f70 7269 6d69 7469 7665  ontour_primitive
+0000b1b0: 732c 2065 6467 6573 2c20 6669 6e69 7368  s, edges, finish
+0000b1c0: 6564 5f6c 6f6f 700a 0a20 2020 2040 636c  ed_loop..    @cl
+0000b1d0: 6173 736d 6574 686f 640a 2020 2020 6465  assmethod.    de
+0000b1e0: 6620 636f 6e74 6f75 7273 5f66 726f 6d5f  f contours_from_
+0000b1f0: 6564 6765 7328 636c 732c 2065 6467 6573  edges(cls, edges
+0000b200: 2c20 746f 6c3d 3165 2d37 293a 0a20 2020  , tol=1e-7):.   
+0000b210: 2020 2020 2069 6620 6e6f 7420 6564 6765       if not edge
+0000b220: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+0000b230: 6574 7572 6e20 5b5d 0a20 2020 2020 2020  eturn [].       
+0000b240: 2069 6620 6c65 6e28 6564 6765 7329 203d   if len(edges) =
+0000b250: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+0000b260: 2072 6574 7572 6e20 5b63 6c73 2865 6467   return [cls(edg
+0000b270: 6573 295d 0a20 2020 2020 2020 2074 6f75  es)].        tou
+0000b280: 6368 696e 675f 7072 696d 6974 6976 6573  ching_primitives
+0000b290: 203d 2063 6c73 2e74 6f75 6368 696e 675f   = cls.touching_
+0000b2a0: 6564 6765 735f 7061 6972 7328 6564 6765  edges_pairs(edge
+0000b2b0: 7329 0a20 2020 2020 2020 2066 6f72 2070  s).        for p
+0000b2c0: 7269 6d73 2069 6e20 746f 7563 6869 6e67  rims in touching
+0000b2d0: 5f70 7269 6d69 7469 7665 733a 0a20 2020  _primitives:.   
+0000b2e0: 2020 2020 2020 2020 2069 6620 7072 696d           if prim
+0000b2f0: 735b 305d 2069 6e20 6564 6765 733a 0a20  s[0] in edges:. 
+0000b300: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0000b310: 6467 6573 2e72 656d 6f76 6528 7072 696d  dges.remove(prim
+0000b320: 735b 305d 290a 2020 2020 2020 2020 2020  s[0]).          
+0000b330: 2020 6966 2070 7269 6d73 5b31 5d20 696e    if prims[1] in
+0000b340: 2065 6467 6573 3a0a 2020 2020 2020 2020   edges:.        
+0000b350: 2020 2020 2020 2020 6564 6765 732e 7265          edges.re
+0000b360: 6d6f 7665 2870 7269 6d73 5b31 5d29 0a20  move(prims[1]). 
+0000b370: 2020 2020 2020 2063 6f6e 746f 7572 735f         contours_
+0000b380: 7072 696d 6974 6976 6573 5f6c 6973 7473  primitives_lists
+0000b390: 203d 2063 6c73 2e63 6f6e 746f 7572 735f   = cls.contours_
+0000b3a0: 7072 696d 6974 6976 6573 5f74 6f75 6368  primitives_touch
+0000b3b0: 696e 675f 7072 696d 6974 6976 6573 2874  ing_primitives(t
+0000b3c0: 6f75 6368 696e 675f 7072 696d 6974 6976  ouching_primitiv
+0000b3d0: 6573 290a 2020 2020 2020 2020 636f 6e74  es).        cont
+0000b3e0: 6f75 7273 5f6c 6973 7420 3d20 5b63 6c73  ours_list = [cls
+0000b3f0: 2870 7269 6d69 7469 7665 7329 2066 6f72  (primitives) for
+0000b400: 2070 7269 6d69 7469 7665 7320 696e 2063   primitives in c
+0000b410: 6f6e 746f 7572 735f 7072 696d 6974 6976  ontours_primitiv
+0000b420: 6573 5f6c 6973 7473 5d0a 2020 2020 2020  es_lists].      
+0000b430: 2020 6966 206e 6f74 2065 6467 6573 3a0a    if not edges:.
+0000b440: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000b450: 726e 2063 6f6e 746f 7572 735f 6c69 7374  rn contours_list
+0000b460: 0a20 2020 2020 2020 206c 6973 745f 636f  .        list_co
+0000b470: 6e74 6f75 7273 203d 205b 5d0a 2020 2020  ntours = [].    
+0000b480: 2020 2020 6669 6e69 7368 6564 203d 2046      finished = F
+0000b490: 616c 7365 0a20 2020 2020 2020 2063 6f6e  alse.        con
+0000b4a0: 746f 7572 5f70 7269 6d69 7469 7665 7320  tour_primitives 
+0000b4b0: 3d20 5b5d 0a0a 2020 2020 2020 2020 7768  = []..        wh
+0000b4c0: 696c 6520 6e6f 7420 6669 6e69 7368 6564  ile not finished
+0000b4d0: 3a0a 2020 2020 2020 2020 2020 2020 6c65  :.            le
+0000b4e0: 6e31 203d 206c 656e 2865 6467 6573 290a  n1 = len(edges).
+0000b4f0: 2020 2020 2020 2020 2020 2020 6564 6765              edge
+0000b500: 732c 2063 6f6e 746f 7572 5f70 7269 6d69  s, contour_primi
+0000b510: 7469 7665 732c 2063 6f6e 746f 7572 735f  tives, contours_
+0000b520: 6c69 7374 203d 2063 6c73 2e66 696e 645f  list = cls.find_
+0000b530: 636f 6e6e 6563 7465 645f 6564 6765 7328  connected_edges(
+0000b540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b550: 2065 6467 6573 2c20 636f 6e74 6f75 7273   edges, contours
+0000b560: 5f6c 6973 742c 2063 6f6e 746f 7572 5f70  _list, contour_p
+0000b570: 7269 6d69 7469 7665 732c 2074 6f6c 290a  rimitives, tol).
+0000b580: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0000b590: 6f74 2065 6467 6573 3a0a 2020 2020 2020  ot edges:.      
+0000b5a0: 2020 2020 2020 2020 2020 6669 6e69 7368            finish
+0000b5b0: 6564 203d 2054 7275 650a 2020 2020 2020  ed = True.      
+0000b5c0: 2020 2020 2020 7661 6c69 6420 3d20 4661        valid = Fa
+0000b5d0: 6c73 650a 0a20 2020 2020 2020 2020 2020  lse..           
+0000b5e0: 2069 6620 6c65 6e28 6564 6765 7329 2021   if len(edges) !
+0000b5f0: 3d20 3020 616e 6420 6c65 6e28 6564 6765  = 0 and len(edge
+0000b600: 7329 203d 3d20 6c65 6e31 2061 6e64 206c  s) == len1 and l
+0000b610: 656e 2863 6f6e 746f 7572 5f70 7269 6d69  en(contour_primi
+0000b620: 7469 7665 7329 2021 3d20 303a 0a20 2020  tives) != 0:.   
+0000b630: 2020 2020 2020 2020 2020 2020 2076 616c               val
+0000b640: 6964 203d 2054 7275 650a 2020 2020 2020  id = True.      
+0000b650: 2020 2020 2020 656c 6966 206c 656e 2865        elif len(e
+0000b660: 6467 6573 2920 3d3d 2030 2061 6e64 206c  dges) == 0 and l
+0000b670: 656e 2863 6f6e 746f 7572 5f70 7269 6d69  en(contour_primi
+0000b680: 7469 7665 7329 2021 3d20 303a 0a20 2020  tives) != 0:.   
+0000b690: 2020 2020 2020 2020 2020 2020 2076 616c               val
+0000b6a0: 6964 203d 2054 7275 650a 2020 2020 2020  id = True.      
+0000b6b0: 2020 2020 2020 2020 2020 6669 6e69 7368            finish
+0000b6c0: 6564 203d 2054 7275 650a 2020 2020 2020  ed = True.      
+0000b6d0: 2020 2020 2020 6966 2076 616c 6964 3a0a        if valid:.
+0000b6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b6f0: 636f 6e74 6f75 725f 7072 696d 6974 6976  contour_primitiv
+0000b700: 6573 2c20 6564 6765 732c 2066 696e 6973  es, edges, finis
+0000b710: 6865 6420 3d20 636c 732e 6765 745f 6564  hed = cls.get_ed
+0000b720: 6765 735f 6269 6675 7263 6174 696f 6e73  ges_bifurcations
+0000b730: 2863 6f6e 746f 7572 5f70 7269 6d69 7469  (contour_primiti
+0000b740: 7665 732c 0a20 2020 2020 2020 2020 2020  ves,.           
 0000b750: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000b760: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000b770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b780: 2020 2020 2020 2020 2020 2020 2020 6564                ed
-0000b790: 6765 732c 2066 696e 6973 6865 6429 0a20  ges, finished). 
-0000b7a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000b7b0: 6620 6c65 6e28 636f 6e74 6f75 725f 7072  f len(contour_pr
-0000b7c0: 696d 6974 6976 6573 5b3a 5d29 2021 3d20  imitives[:]) != 
-0000b7d0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0000b7e0: 2020 2020 2020 2063 6f6e 746f 7572 5f6e         contour_n
-0000b7f0: 203d 2063 6c73 2863 6f6e 746f 7572 5f70   = cls(contour_p
-0000b800: 7269 6d69 7469 7665 735b 3a5d 290a 2020  rimitives[:]).  
-0000b810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b820: 2020 636f 6e74 6f75 725f 6e2e 6f72 6465    contour_n.orde
-0000b830: 725f 636f 6e74 6f75 7228 290a 2020 2020  r_contour().    
-0000b840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b850: 6c69 7374 5f63 6f6e 746f 7572 732e 6170  list_contours.ap
-0000b860: 7065 6e64 2863 6f6e 746f 7572 5f6e 290a  pend(contour_n).
-0000b870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b880: 636f 6e74 6f75 725f 7072 696d 6974 6976  contour_primitiv
-0000b890: 6573 203d 205b 5d0a 2020 2020 2020 2020  es = [].        
-0000b8a0: 6c69 7374 5f63 6f6e 746f 7572 7320 3d20  list_contours = 
-0000b8b0: 6c69 7374 5f63 6f6e 746f 7572 7320 2b20  list_contours + 
-0000b8c0: 5b63 6c73 2870 7269 6d69 7469 7665 7329  [cls(primitives)
-0000b8d0: 2e6f 7264 6572 5f63 6f6e 746f 7572 2829  .order_contour()
-0000b8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b790: 2020 2020 2020 6564 6765 732c 2066 696e        edges, fin
+0000b7a0: 6973 6865 6429 0a20 2020 2020 2020 2020  ished).         
+0000b7b0: 2020 2020 2020 2069 6620 6c65 6e28 636f         if len(co
+0000b7c0: 6e74 6f75 725f 7072 696d 6974 6976 6573  ntour_primitives
+0000b7d0: 5b3a 5d29 2021 3d20 303a 0a20 2020 2020  [:]) != 0:.     
+0000b7e0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000b7f0: 6f6e 746f 7572 5f6e 203d 2063 6c73 2863  ontour_n = cls(c
+0000b800: 6f6e 746f 7572 5f70 7269 6d69 7469 7665  ontour_primitive
+0000b810: 735b 3a5d 290a 2020 2020 2020 2020 2020  s[:]).          
+0000b820: 2020 2020 2020 2020 2020 636f 6e74 6f75            contou
+0000b830: 725f 6e2e 6f72 6465 725f 636f 6e74 6f75  r_n.order_contou
+0000b840: 7228 290a 2020 2020 2020 2020 2020 2020  r().            
+0000b850: 2020 2020 2020 2020 6c69 7374 5f63 6f6e          list_con
+0000b860: 746f 7572 732e 6170 7065 6e64 2863 6f6e  tours.append(con
+0000b870: 746f 7572 5f6e 290a 2020 2020 2020 2020  tour_n).        
+0000b880: 2020 2020 2020 2020 636f 6e74 6f75 725f          contour_
+0000b890: 7072 696d 6974 6976 6573 203d 205b 5d0a  primitives = [].
+0000b8a0: 2020 2020 2020 2020 6c69 7374 5f63 6f6e          list_con
+0000b8b0: 746f 7572 7320 3d20 6c69 7374 5f63 6f6e  tours = list_con
+0000b8c0: 746f 7572 7320 2b20 5b63 6c73 2870 7269  tours + [cls(pri
+0000b8d0: 6d69 7469 7665 7329 2e6f 7264 6572 5f63  mitives).order_c
+0000b8e0: 6f6e 746f 7572 2829 0a20 2020 2020 2020  ontour().       
 0000b8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b900: 2020 2020 2020 2020 2020 666f 7220 7072            for pr
-0000b910: 696d 6974 6976 6573 0a20 2020 2020 2020  imitives.       
-0000b920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b910: 2020 666f 7220 7072 696d 6974 6976 6573    for primitives
+0000b920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0000b930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b940: 2020 696e 2063 6f6e 746f 7572 735f 7072    in contours_pr
-0000b950: 696d 6974 6976 6573 5f6c 6973 7473 5d0a  imitives_lists].
-0000b960: 2020 2020 2020 2020 7661 6c69 645f 636f          valid_co
-0000b970: 6e74 6f75 7273 203d 205b 6c69 7374 5f63  ntours = [list_c
-0000b980: 6f6e 746f 7572 735b 305d 5d0a 2020 2020  ontours[0]].    
-0000b990: 2020 2020 6c69 7374 5f63 6f6e 746f 7572      list_contour
-0000b9a0: 732e 7265 6d6f 7665 286c 6973 745f 636f  s.remove(list_co
-0000b9b0: 6e74 6f75 7273 5b30 5d29 0a20 2020 2020  ntours[0]).     
-0000b9c0: 2020 2066 6f72 2063 6f6e 746f 7572 2069     for contour i
-0000b9d0: 6e20 6c69 7374 5f63 6f6e 746f 7572 733a  n list_contours:
-0000b9e0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0000b9f0: 2063 6f6e 746f 7572 3220 696e 2076 616c   contour2 in val
-0000ba00: 6964 5f63 6f6e 746f 7572 733a 0a20 2020  id_contours:.   
-0000ba10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000ba20: 636f 6e74 6f75 722e 6973 5f73 7570 6572  contour.is_super
-0000ba30: 706f 7369 6e67 2863 6f6e 746f 7572 3229  posing(contour2)
-0000ba40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000ba50: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-0000ba60: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000ba70: 2020 2020 2020 2020 2020 2020 2020 7661                va
-0000ba80: 6c69 645f 636f 6e74 6f75 7273 2e61 7070  lid_contours.app
-0000ba90: 656e 6428 636f 6e74 6f75 7229 0a20 2020  end(contour).   
-0000baa0: 2020 2020 2072 6574 7572 6e20 7661 6c69       return vali
-0000bab0: 645f 636f 6e74 6f75 7273 0a0a 2020 2020  d_contours..    
-0000bac0: 6465 6620 6469 7363 7265 7469 7a65 645f  def discretized_
-0000bad0: 7072 696d 6974 6976 6573 2873 656c 662c  primitives(self,
-0000bae0: 206e 756d 6265 725f 706f 696e 7473 3a20   number_points: 
-0000baf0: 666c 6f61 7429 3a0a 2020 2020 2020 2020  float):.        
-0000bb00: 2222 220a 2020 2020 2020 2020 4469 7363  """.        Disc
-0000bb10: 7265 7469 7a65 2065 6163 6820 636f 6e74  retize each cont
-0000bb20: 6f75 7227 7320 7072 696d 6974 6976 6520  our's primitive 
-0000bb30: 616e 6420 7265 7475 726e 2061 206c 6973  and return a lis
-0000bb40: 7420 6f66 2064 6973 6372 6574 697a 6564  t of discretized
-0000bb50: 2070 7269 6d69 7469 7665 732e 0a0a 2020   primitives...  
-0000bb60: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000bb70: 2020 6564 6765 7320 3d20 5b5d 0a20 2020    edges = [].   
-0000bb80: 2020 2020 2066 6f72 2070 7269 6d69 7469       for primiti
-0000bb90: 7665 2069 6e20 7365 6c66 2e70 7269 6d69  ve in self.primi
-0000bba0: 7469 7665 733a 0a20 2020 2020 2020 2020  tives:.         
-0000bbb0: 2020 2061 7574 6f5f 6e62 5f70 7473 203d     auto_nb_pts =
-0000bbc0: 206d 696e 286e 756d 6265 725f 706f 696e   min(number_poin
-0000bbd0: 7473 2c20 6d61 7828 322c 2069 6e74 2870  ts, max(2, int(p
-0000bbe0: 7269 6d69 7469 7665 2e6c 656e 6774 6828  rimitive.length(
-0000bbf0: 2920 2f20 3165 2d36 2929 290a 2020 2020  ) / 1e-6))).    
-0000bc00: 2020 2020 2020 2020 706f 696e 7473 203d          points =
-0000bc10: 2070 7269 6d69 7469 7665 2e64 6973 6372   primitive.discr
-0000bc20: 6574 697a 6174 696f 6e5f 706f 696e 7473  etization_points
-0000bc30: 286e 756d 6265 725f 706f 696e 7473 3d61  (number_points=a
-0000bc40: 7574 6f5f 6e62 5f70 7473 290a 2020 2020  uto_nb_pts).    
-0000bc50: 2020 2020 2020 2020 666f 7220 7031 2c20          for p1, 
-0000bc60: 7032 2069 6e20 7a69 7028 706f 696e 7473  p2 in zip(points
-0000bc70: 5b3a 2d31 5d2c 2070 6f69 6e74 735b 313a  [:-1], points[1:
-0000bc80: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-0000bc90: 2020 2020 6564 6765 732e 6170 7065 6e64      edges.append
-0000bca0: 2876 6f6c 6d64 6c72 2e65 6467 6573 2e4c  (volmdlr.edges.L
-0000bcb0: 696e 6553 6567 6d65 6e74 3244 2870 312c  ineSegment2D(p1,
-0000bcc0: 2070 3229 290a 2020 2020 2020 2020 7265   p2)).        re
-0000bcd0: 7475 726e 2065 6467 6573 0a0a 2020 2020  turn edges..    
-0000bce0: 6465 6620 7368 6172 6573 5f70 7269 6d69  def shares_primi
-0000bcf0: 7469 7665 7328 7365 6c66 2c20 636f 6e74  tives(self, cont
-0000bd00: 6f75 7229 3a0a 2020 2020 2020 2020 2222  our):.        ""
-0000bd10: 220a 2020 2020 2020 2020 4368 6563 6b73  ".        Checks
-0000bd20: 2069 6620 7477 6f20 636f 6e74 6f75 7220   if two contour 
-0000bd30: 7368 6172 6520 7072 696d 6974 6976 6573  share primitives
-0000bd40: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-0000bd50: 2020 2020 2020 2066 6f72 2070 7269 6d31         for prim1
-0000bd60: 2069 6e20 7365 6c66 2e70 7269 6d69 7469   in self.primiti
-0000bd70: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
-0000bd80: 2069 6620 636f 6e74 6f75 722e 7072 696d   if contour.prim
-0000bd90: 6974 6976 655f 6f76 6572 5f63 6f6e 746f  itive_over_conto
-0000bda0: 7572 2870 7269 6d31 293a 0a20 2020 2020  ur(prim1):.     
-0000bdb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000bdc0: 6e20 5472 7565 0a20 2020 2020 2020 2072  n True.        r
-0000bdd0: 6574 7572 6e20 4661 6c73 650a 0a20 2020  eturn False..   
-0000bde0: 2064 6566 2069 735f 7375 7065 7270 6f73   def is_superpos
-0000bdf0: 696e 6728 7365 6c66 2c20 636f 6e74 6f75  ing(self, contou
-0000be00: 7232 293a 0a20 2020 2020 2020 2022 2222  r2):.        """
-0000be10: 0a20 2020 2020 2020 2043 6865 636b 2069  .        Check i
-0000be20: 6620 7468 6520 636f 6e74 6f75 7273 2061  f the contours a
-0000be30: 7265 2073 7570 6572 706f 7369 6e67 2028  re superposing (
-0000be40: 6f6e 6520 6f6e 2074 6865 206f 7468 6572  one on the other
-0000be50: 2077 6974 686f 7574 206e 6563 6573 7361   without necessa
-0000be60: 7269 6c79 2068 6176 696e 6720 616e 2061  rily having an a
-0000be70: 6273 6f6c 7574 6520 6571 7561 6c69 7479  bsolute equality
-0000be80: 292e 0a0a 2020 2020 2020 2020 2222 220a  )...        """.
-0000be90: 0a20 2020 2020 2020 2066 6f72 2070 7269  .        for pri
-0000bea0: 6d69 7469 7665 5f32 2069 6e20 636f 6e74  mitive_2 in cont
-0000beb0: 6f75 7232 2e70 7269 6d69 7469 7665 733a  our2.primitives:
-0000bec0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000bed0: 6e6f 7420 7365 6c66 2e70 7269 6d69 7469  not self.primiti
-0000bee0: 7665 5f6f 7665 725f 636f 6e74 6f75 7228  ve_over_contour(
-0000bef0: 7072 696d 6974 6976 655f 3229 3a0a 2020  primitive_2):.  
-0000bf00: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000bf10: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
-0000bf20: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
-0000bf30: 2020 2020 6465 6620 6973 5f6f 7665 726c      def is_overl
-0000bf40: 6170 7069 6e67 2873 656c 662c 2063 6f6e  apping(self, con
-0000bf50: 746f 7572 322c 2069 6e74 6572 7365 6374  tour2, intersect
-0000bf60: 696e 675f 706f 696e 7473 3d4e 6f6e 6529  ing_points=None)
-0000bf70: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000bf80: 2020 2020 2020 4368 6563 6b20 6966 2074        Check if t
-0000bf90: 6865 2063 6f6e 746f 7572 7320 6172 6520  he contours are 
-0000bfa0: 6f76 6572 6c61 7070 696e 6720 2861 2070  overlapping (a p
-0000bfb0: 6172 7420 6f66 206f 6e65 2069 7320 6f6e  art of one is on
-0000bfc0: 2074 6865 206f 7468 6572 292e 0a0a 2020   the other)...  
-0000bfd0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-0000bfe0: 2020 2069 6620 6e6f 7420 696e 7465 7273     if not inters
-0000bff0: 6563 7469 6e67 5f70 6f69 6e74 733a 0a20  ecting_points:. 
-0000c000: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
-0000c010: 7365 6374 696e 675f 706f 696e 7473 203d  secting_points =
-0000c020: 2073 656c 662e 636f 6e74 6f75 725f 696e   self.contour_in
-0000c030: 7465 7273 6563 7469 6f6e 7328 636f 6e74  tersections(cont
-0000c040: 6f75 7232 290a 0a20 2020 2020 2020 2069  our2)..        i
-0000c050: 6620 6c65 6e28 696e 7465 7273 6563 7469  f len(intersecti
-0000c060: 6e67 5f70 6f69 6e74 7329 203c 2032 3a0a  ng_points) < 2:.
-0000c070: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000c080: 726e 2046 616c 7365 0a0a 2020 2020 2020  rn False..      
-0000c090: 2020 7665 6331 5f32 203d 2076 6f6c 6d64    vec1_2 = volmd
-0000c0a0: 6c72 2e65 6467 6573 2e4c 696e 6553 6567  lr.edges.LineSeg
-0000c0b0: 6d65 6e74 3244 2869 6e74 6572 7365 6374  ment2D(intersect
-0000c0c0: 696e 675f 706f 696e 7473 5b30 5d2c 0a20  ing_points[0],. 
-0000c0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b940: 2020 2020 2020 2020 2020 696e 2063 6f6e            in con
+0000b950: 746f 7572 735f 7072 696d 6974 6976 6573  tours_primitives
+0000b960: 5f6c 6973 7473 5d0a 2020 2020 2020 2020  _lists].        
+0000b970: 7661 6c69 645f 636f 6e74 6f75 7273 203d  valid_contours =
+0000b980: 205b 6c69 7374 5f63 6f6e 746f 7572 735b   [list_contours[
+0000b990: 305d 5d0a 2020 2020 2020 2020 6c69 7374  0]].        list
+0000b9a0: 5f63 6f6e 746f 7572 732e 7265 6d6f 7665  _contours.remove
+0000b9b0: 286c 6973 745f 636f 6e74 6f75 7273 5b30  (list_contours[0
+0000b9c0: 5d29 0a20 2020 2020 2020 2066 6f72 2063  ]).        for c
+0000b9d0: 6f6e 746f 7572 2069 6e20 6c69 7374 5f63  ontour in list_c
+0000b9e0: 6f6e 746f 7572 733a 0a20 2020 2020 2020  ontours:.       
+0000b9f0: 2020 2020 2066 6f72 2063 6f6e 746f 7572       for contour
+0000ba00: 3220 696e 2076 616c 6964 5f63 6f6e 746f  2 in valid_conto
+0000ba10: 7572 733a 0a20 2020 2020 2020 2020 2020  urs:.           
+0000ba20: 2020 2020 2069 6620 636f 6e74 6f75 722e       if contour.
+0000ba30: 6973 5f73 7570 6572 706f 7369 6e67 2863  is_superposing(c
+0000ba40: 6f6e 746f 7572 3229 3a0a 2020 2020 2020  ontour2):.      
+0000ba50: 2020 2020 2020 2020 2020 2020 2020 6272                br
+0000ba60: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
+0000ba70: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000ba80: 2020 2020 2020 7661 6c69 645f 636f 6e74        valid_cont
+0000ba90: 6f75 7273 2e61 7070 656e 6428 636f 6e74  ours.append(cont
+0000baa0: 6f75 7229 0a20 2020 2020 2020 2072 6574  our).        ret
+0000bab0: 7572 6e20 7661 6c69 645f 636f 6e74 6f75  urn valid_contou
+0000bac0: 7273 0a0a 2020 2020 6465 6620 6469 7363  rs..    def disc
+0000bad0: 7265 7469 7a65 645f 7072 696d 6974 6976  retized_primitiv
+0000bae0: 6573 2873 656c 662c 206e 756d 6265 725f  es(self, number_
+0000baf0: 706f 696e 7473 3a20 666c 6f61 7429 3a0a  points: float):.
+0000bb00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000bb10: 2020 2020 4469 7363 7265 7469 7a65 2065      Discretize e
+0000bb20: 6163 6820 636f 6e74 6f75 7227 7320 7072  ach contour's pr
+0000bb30: 696d 6974 6976 6520 616e 6420 7265 7475  imitive and retu
+0000bb40: 726e 2061 206c 6973 7420 6f66 2064 6973  rn a list of dis
+0000bb50: 6372 6574 697a 6564 2070 7269 6d69 7469  cretized primiti
+0000bb60: 7665 732e 0a0a 2020 2020 2020 2020 2222  ves...        ""
+0000bb70: 220a 2020 2020 2020 2020 6564 6765 7320  ".        edges 
+0000bb80: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
+0000bb90: 2070 7269 6d69 7469 7665 2069 6e20 7365   primitive in se
+0000bba0: 6c66 2e70 7269 6d69 7469 7665 733a 0a20  lf.primitives:. 
+0000bbb0: 2020 2020 2020 2020 2020 2061 7574 6f5f             auto_
+0000bbc0: 6e62 5f70 7473 203d 206d 696e 286e 756d  nb_pts = min(num
+0000bbd0: 6265 725f 706f 696e 7473 2c20 6d61 7828  ber_points, max(
+0000bbe0: 322c 2069 6e74 2870 7269 6d69 7469 7665  2, int(primitive
+0000bbf0: 2e6c 656e 6774 6828 2920 2f20 3165 2d36  .length() / 1e-6
+0000bc00: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+0000bc10: 706f 696e 7473 203d 2070 7269 6d69 7469  points = primiti
+0000bc20: 7665 2e64 6973 6372 6574 697a 6174 696f  ve.discretizatio
+0000bc30: 6e5f 706f 696e 7473 286e 756d 6265 725f  n_points(number_
+0000bc40: 706f 696e 7473 3d61 7574 6f5f 6e62 5f70  points=auto_nb_p
+0000bc50: 7473 290a 2020 2020 2020 2020 2020 2020  ts).            
+0000bc60: 666f 7220 7031 2c20 7032 2069 6e20 7a69  for p1, p2 in zi
+0000bc70: 7028 706f 696e 7473 5b3a 2d31 5d2c 2070  p(points[:-1], p
+0000bc80: 6f69 6e74 735b 313a 5d29 3a0a 2020 2020  oints[1:]):.    
+0000bc90: 2020 2020 2020 2020 2020 2020 6564 6765              edge
+0000bca0: 732e 6170 7065 6e64 2876 6f6c 6d64 6c72  s.append(volmdlr
+0000bcb0: 2e65 6467 6573 2e4c 696e 6553 6567 6d65  .edges.LineSegme
+0000bcc0: 6e74 3244 2870 312c 2070 3229 290a 2020  nt2D(p1, p2)).  
+0000bcd0: 2020 2020 2020 7265 7475 726e 2065 6467        return edg
+0000bce0: 6573 0a0a 2020 2020 6465 6620 7368 6172  es..    def shar
+0000bcf0: 6573 5f70 7269 6d69 7469 7665 7328 7365  es_primitives(se
+0000bd00: 6c66 2c20 636f 6e74 6f75 7229 3a0a 2020  lf, contour):.  
+0000bd10: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000bd20: 2020 4368 6563 6b73 2069 6620 7477 6f20    Checks if two 
+0000bd30: 636f 6e74 6f75 7220 7368 6172 6520 7072  contour share pr
+0000bd40: 696d 6974 6976 6573 2e0a 0a20 2020 2020  imitives...     
+0000bd50: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+0000bd60: 6f72 2070 7269 6d31 2069 6e20 7365 6c66  or prim1 in self
+0000bd70: 2e70 7269 6d69 7469 7665 733a 0a20 2020  .primitives:.   
+0000bd80: 2020 2020 2020 2020 2069 6620 636f 6e74           if cont
+0000bd90: 6f75 722e 7072 696d 6974 6976 655f 6f76  our.primitive_ov
+0000bda0: 6572 5f63 6f6e 746f 7572 2870 7269 6d31  er_contour(prim1
+0000bdb0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0000bdc0: 2020 2072 6574 7572 6e20 5472 7565 0a20     return True. 
+0000bdd0: 2020 2020 2020 2072 6574 7572 6e20 4661         return Fa
+0000bde0: 6c73 650a 0a20 2020 2064 6566 2069 735f  lse..    def is_
+0000bdf0: 7375 7065 7270 6f73 696e 6728 7365 6c66  superposing(self
+0000be00: 2c20 636f 6e74 6f75 7232 293a 0a20 2020  , contour2):.   
+0000be10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000be20: 2043 6865 636b 2069 6620 7468 6520 636f   Check if the co
+0000be30: 6e74 6f75 7273 2061 7265 2073 7570 6572  ntours are super
+0000be40: 706f 7369 6e67 2028 6f6e 6520 6f6e 2074  posing (one on t
+0000be50: 6865 206f 7468 6572 2077 6974 686f 7574  he other without
+0000be60: 206e 6563 6573 7361 7269 6c79 2068 6176   necessarily hav
+0000be70: 696e 6720 616e 2061 6273 6f6c 7574 6520  ing an absolute 
+0000be80: 6571 7561 6c69 7479 292e 0a0a 2020 2020  equality)...    
+0000be90: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0000bea0: 2066 6f72 2070 7269 6d69 7469 7665 5f32   for primitive_2
+0000beb0: 2069 6e20 636f 6e74 6f75 7232 2e70 7269   in contour2.pri
+0000bec0: 6d69 7469 7665 733a 0a20 2020 2020 2020  mitives:.       
+0000bed0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0000bee0: 2e70 7269 6d69 7469 7665 5f6f 7665 725f  .primitive_over_
+0000bef0: 636f 6e74 6f75 7228 7072 696d 6974 6976  contour(primitiv
+0000bf00: 655f 3229 3a0a 2020 2020 2020 2020 2020  e_2):.          
+0000bf10: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+0000bf20: 7365 0a20 2020 2020 2020 2072 6574 7572  se.        retur
+0000bf30: 6e20 5472 7565 0a0a 2020 2020 6465 6620  n True..    def 
+0000bf40: 6973 5f6f 7665 726c 6170 7069 6e67 2873  is_overlapping(s
+0000bf50: 656c 662c 2063 6f6e 746f 7572 322c 2069  elf, contour2, i
+0000bf60: 6e74 6572 7365 6374 696e 675f 706f 696e  ntersecting_poin
+0000bf70: 7473 3d4e 6f6e 6529 3a0a 2020 2020 2020  ts=None):.      
+0000bf80: 2020 2222 220a 2020 2020 2020 2020 4368    """.        Ch
+0000bf90: 6563 6b20 6966 2074 6865 2063 6f6e 746f  eck if the conto
+0000bfa0: 7572 7320 6172 6520 6f76 6572 6c61 7070  urs are overlapp
+0000bfb0: 696e 6720 2861 2070 6172 7420 6f66 206f  ing (a part of o
+0000bfc0: 6e65 2069 7320 6f6e 2074 6865 206f 7468  ne is on the oth
+0000bfd0: 6572 292e 0a0a 2020 2020 2020 2020 2222  er)...        ""
+0000bfe0: 220a 0a20 2020 2020 2020 2069 6620 6e6f  "..        if no
+0000bff0: 7420 696e 7465 7273 6563 7469 6e67 5f70  t intersecting_p
+0000c000: 6f69 6e74 733a 0a20 2020 2020 2020 2020  oints:.         
+0000c010: 2020 2069 6e74 6572 7365 6374 696e 675f     intersecting_
+0000c020: 706f 696e 7473 203d 2073 656c 662e 636f  points = self.co
+0000c030: 6e74 6f75 725f 696e 7465 7273 6563 7469  ntour_intersecti
+0000c040: 6f6e 7328 636f 6e74 6f75 7232 290a 0a20  ons(contour2).. 
+0000c050: 2020 2020 2020 2069 6620 6c65 6e28 696e         if len(in
+0000c060: 7465 7273 6563 7469 6e67 5f70 6f69 6e74  tersecting_point
+0000c070: 7329 203c 2032 3a0a 2020 2020 2020 2020  s) < 2:.        
+0000c080: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+0000c090: 0a0a 2020 2020 2020 2020 7665 6331 5f32  ..        vec1_2
+0000c0a0: 203d 2076 6f6c 6d64 6c72 2e65 6467 6573   = volmdlr.edges
+0000c0b0: 2e4c 696e 6553 6567 6d65 6e74 3244 2869  .LineSegment2D(i
+0000c0c0: 6e74 6572 7365 6374 696e 675f 706f 696e  ntersecting_poin
+0000c0d0: 7473 5b30 5d2c 0a20 2020 2020 2020 2020  ts[0],.         
 0000c0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c0f0: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-0000c100: 7273 6563 7469 6e67 5f70 6f69 6e74 735b  rsecting_points[
-0000c110: 315d 290a 2020 2020 2020 2020 6d69 6464  1]).        midd
-0000c120: 6c65 5f70 6f69 6e74 203d 2076 6563 315f  le_point = vec1_
-0000c130: 322e 6d69 6464 6c65 5f70 6f69 6e74 2829  2.middle_point()
-0000c140: 0a20 2020 2020 2020 206e 6f72 6d61 6c20  .        normal 
-0000c150: 3d20 7665 6331 5f32 2e6e 6f72 6d61 6c5f  = vec1_2.normal_
-0000c160: 7665 6374 6f72 2829 0a20 2020 2020 2020  vector().       
-0000c170: 2070 6f69 6e74 3120 3d20 6d69 6464 6c65   point1 = middle
-0000c180: 5f70 6f69 6e74 202b 206e 6f72 6d61 6c20  _point + normal 
-0000c190: 2a20 302e 3030 3030 310a 2020 2020 2020  * 0.00001.      
-0000c1a0: 2020 706f 696e 7432 203d 206d 6964 646c    point2 = middl
-0000c1b0: 655f 706f 696e 7420 2d20 6e6f 726d 616c  e_point - normal
-0000c1c0: 202a 2030 2e30 3030 3031 0a20 2020 2020   * 0.00001.     
-0000c1d0: 2020 2069 6620 2873 656c 662e 706f 696e     if (self.poin
-0000c1e0: 745f 6265 6c6f 6e67 7328 706f 696e 7431  t_belongs(point1
-0000c1f0: 2920 616e 6420 636f 6e74 6f75 7232 2e70  ) and contour2.p
-0000c200: 6f69 6e74 5f62 656c 6f6e 6773 2870 6f69  oint_belongs(poi
-0000c210: 6e74 3129 2920 6f72 5c0a 2020 2020 2020  nt1)) or\.      
-0000c220: 2020 2020 2020 2020 2020 286e 6f74 2073            (not s
-0000c230: 656c 662e 706f 696e 745f 6265 6c6f 6e67  elf.point_belong
-0000c240: 7328 706f 696e 7431 2920 616e 6420 6e6f  s(point1) and no
-0000c250: 7420 636f 6e74 6f75 7232 2e70 6f69 6e74  t contour2.point
-0000c260: 5f62 656c 6f6e 6773 2870 6f69 6e74 3129  _belongs(point1)
-0000c270: 2920 6f72 5c0a 2020 2020 2020 2020 2020  ) or\.          
-0000c280: 2020 2020 2020 2873 656c 662e 706f 696e        (self.poin
-0000c290: 745f 6265 6c6f 6e67 7328 706f 696e 7431  t_belongs(point1
-0000c2a0: 2920 616e 6420 7365 6c66 2e70 6f69 6e74  ) and self.point
-0000c2b0: 5f62 656c 6f6e 6773 2870 6f69 6e74 3229  _belongs(point2)
-0000c2c0: 2920 6f72 5c0a 2020 2020 2020 2020 2020  ) or\.          
-0000c2d0: 2020 2020 2020 2863 6f6e 746f 7572 322e        (contour2.
-0000c2e0: 706f 696e 745f 6265 6c6f 6e67 7328 706f  point_belongs(po
-0000c2f0: 696e 7431 2920 616e 6420 636f 6e74 6f75  int1) and contou
-0000c300: 7232 2e70 6f69 6e74 5f62 656c 6f6e 6773  r2.point_belongs
-0000c310: 2870 6f69 6e74 3229 293a 0a20 2020 2020  (point2)):.     
-0000c320: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-0000c330: 7565 0a20 2020 2020 2020 2072 6574 7572  ue.        retur
-0000c340: 6e20 4661 6c73 650a 0a20 2020 2064 6566  n False..    def
-0000c350: 2069 735f 7368 6172 696e 675f 7072 696d   is_sharing_prim
-0000c360: 6974 6976 6573 5f77 6974 6828 7365 6c66  itives_with(self
-0000c370: 2c20 636f 6e74 6f75 7229 3a0a 2020 2020  , contour):.    
-0000c380: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000c390: 4368 6563 6b20 6966 2074 776f 2063 6f6e  Check if two con
-0000c3a0: 746f 7572 2061 7265 2073 6861 7269 6e67  tour are sharing
-0000c3b0: 2070 7269 6d69 7469 7665 732e 0a0a 2020   primitives...  
-0000c3c0: 2020 2020 2020 2261 6c6c 5f70 6f69 6e74        "all_point
-0000c3d0: 7322 2069 7320 6279 2064 6566 6175 6c74  s" is by default
-0000c3e0: 2046 616c 7365 2e20 5475 726e 2069 7420   False. Turn it 
-0000c3f0: 5472 7565 2069 6620 796f 7520 6e65 6564  True if you need
-0000c400: 2074 6f20 6765 740a 2020 2020 2020 2020   to get.        
-0000c410: 706f 696e 7473 2061 6e64 2065 6467 6573  points and edges
-0000c420: 2075 7365 6420 746f 2066 696e 6420 6f75   used to find ou
-0000c430: 7420 7368 6172 6564 2070 7269 6d69 7469  t shared primiti
-0000c440: 7665 732e 0a20 2020 2020 2020 2022 2222  ves..        """
-0000c450: 0a0a 2020 2020 2020 2020 6c69 7374 5f70  ..        list_p
-0000c460: 203d 205b 5d0a 0a20 2020 2020 2020 2066   = []..        f
-0000c470: 6f72 2065 6467 655f 312c 2065 6467 655f  or edge_1, edge_
-0000c480: 3220 696e 2069 7465 7274 6f6f 6c73 2e70  2 in itertools.p
-0000c490: 726f 6475 6374 2873 656c 662e 7072 696d  roduct(self.prim
-0000c4a0: 6974 6976 6573 2c0a 2020 2020 2020 2020  itives,.        
+0000c0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c100: 2020 2020 696e 7465 7273 6563 7469 6e67      intersecting
+0000c110: 5f70 6f69 6e74 735b 315d 290a 2020 2020  _points[1]).    
+0000c120: 2020 2020 6d69 6464 6c65 5f70 6f69 6e74      middle_point
+0000c130: 203d 2076 6563 315f 322e 6d69 6464 6c65   = vec1_2.middle
+0000c140: 5f70 6f69 6e74 2829 0a20 2020 2020 2020  _point().       
+0000c150: 206e 6f72 6d61 6c20 3d20 7665 6331 5f32   normal = vec1_2
+0000c160: 2e6e 6f72 6d61 6c5f 7665 6374 6f72 2829  .normal_vector()
+0000c170: 0a20 2020 2020 2020 2070 6f69 6e74 3120  .        point1 
+0000c180: 3d20 6d69 6464 6c65 5f70 6f69 6e74 202b  = middle_point +
+0000c190: 206e 6f72 6d61 6c20 2a20 302e 3030 3030   normal * 0.0000
+0000c1a0: 310a 2020 2020 2020 2020 706f 696e 7432  1.        point2
+0000c1b0: 203d 206d 6964 646c 655f 706f 696e 7420   = middle_point 
+0000c1c0: 2d20 6e6f 726d 616c 202a 2030 2e30 3030  - normal * 0.000
+0000c1d0: 3031 0a20 2020 2020 2020 2069 6620 2873  01.        if (s
+0000c1e0: 656c 662e 706f 696e 745f 6265 6c6f 6e67  elf.point_belong
+0000c1f0: 7328 706f 696e 7431 2920 616e 6420 636f  s(point1) and co
+0000c200: 6e74 6f75 7232 2e70 6f69 6e74 5f62 656c  ntour2.point_bel
+0000c210: 6f6e 6773 2870 6f69 6e74 3129 2920 6f72  ongs(point1)) or
+0000c220: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+0000c230: 2020 286e 6f74 2073 656c 662e 706f 696e    (not self.poin
+0000c240: 745f 6265 6c6f 6e67 7328 706f 696e 7431  t_belongs(point1
+0000c250: 2920 616e 6420 6e6f 7420 636f 6e74 6f75  ) and not contou
+0000c260: 7232 2e70 6f69 6e74 5f62 656c 6f6e 6773  r2.point_belongs
+0000c270: 2870 6f69 6e74 3129 2920 6f72 5c0a 2020  (point1)) or\.  
+0000c280: 2020 2020 2020 2020 2020 2020 2020 2873                (s
+0000c290: 656c 662e 706f 696e 745f 6265 6c6f 6e67  elf.point_belong
+0000c2a0: 7328 706f 696e 7431 2920 616e 6420 7365  s(point1) and se
+0000c2b0: 6c66 2e70 6f69 6e74 5f62 656c 6f6e 6773  lf.point_belongs
+0000c2c0: 2870 6f69 6e74 3229 2920 6f72 5c0a 2020  (point2)) or\.  
+0000c2d0: 2020 2020 2020 2020 2020 2020 2020 2863                (c
+0000c2e0: 6f6e 746f 7572 322e 706f 696e 745f 6265  ontour2.point_be
+0000c2f0: 6c6f 6e67 7328 706f 696e 7431 2920 616e  longs(point1) an
+0000c300: 6420 636f 6e74 6f75 7232 2e70 6f69 6e74  d contour2.point
+0000c310: 5f62 656c 6f6e 6773 2870 6f69 6e74 3229  _belongs(point2)
+0000c320: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0000c330: 6574 7572 6e20 5472 7565 0a20 2020 2020  eturn True.     
+0000c340: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
+0000c350: 0a20 2020 2064 6566 2069 735f 7368 6172  .    def is_shar
+0000c360: 696e 675f 7072 696d 6974 6976 6573 5f77  ing_primitives_w
+0000c370: 6974 6828 7365 6c66 2c20 636f 6e74 6f75  ith(self, contou
+0000c380: 7229 3a0a 2020 2020 2020 2020 2222 220a  r):.        """.
+0000c390: 2020 2020 2020 2020 4368 6563 6b20 6966          Check if
+0000c3a0: 2074 776f 2063 6f6e 746f 7572 2061 7265   two contour are
+0000c3b0: 2073 6861 7269 6e67 2070 7269 6d69 7469   sharing primiti
+0000c3c0: 7665 732e 0a0a 2020 2020 2020 2020 2261  ves...        "a
+0000c3d0: 6c6c 5f70 6f69 6e74 7322 2069 7320 6279  ll_points" is by
+0000c3e0: 2064 6566 6175 6c74 2046 616c 7365 2e20   default False. 
+0000c3f0: 5475 726e 2069 7420 5472 7565 2069 6620  Turn it True if 
+0000c400: 796f 7520 6e65 6564 2074 6f20 6765 740a  you need to get.
+0000c410: 2020 2020 2020 2020 706f 696e 7473 2061          points a
+0000c420: 6e64 2065 6467 6573 2075 7365 6420 746f  nd edges used to
+0000c430: 2066 696e 6420 6f75 7420 7368 6172 6564   find out shared
+0000c440: 2070 7269 6d69 7469 7665 732e 0a20 2020   primitives..   
+0000c450: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+0000c460: 2020 6c69 7374 5f70 203d 205b 5d0a 0a20    list_p = [].. 
+0000c470: 2020 2020 2020 2066 6f72 2065 6467 655f         for edge_
+0000c480: 312c 2065 6467 655f 3220 696e 2069 7465  1, edge_2 in ite
+0000c490: 7274 6f6f 6c73 2e70 726f 6475 6374 2873  rtools.product(s
+0000c4a0: 656c 662e 7072 696d 6974 6976 6573 2c0a  elf.primitives,.
 0000c4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000c4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c4d0: 2020 2020 2020 2020 636f 6e74 6f75 722e          contour.
-0000c4e0: 7072 696d 6974 6976 6573 293a 0a20 2020  primitives):.   
-0000c4f0: 2020 2020 2020 2020 2065 6467 6573 203d           edges =
-0000c500: 205b 6564 6765 5f31 2c20 6564 6765 5f32   [edge_1, edge_2
-0000c510: 2c20 6564 6765 5f31 5d0a 2020 2020 2020  , edge_1].      
-0000c520: 2020 2020 2020 666f 7220 6564 6765 312c        for edge1,
-0000c530: 2065 6467 6532 2069 6e20 7a69 7028 6564   edge2 in zip(ed
-0000c540: 6765 732c 2065 6467 6573 5b31 3a5d 293a  ges, edges[1:]):
-0000c550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c560: 2066 6f72 2070 6f69 6e74 2069 6e20 5b65   for point in [e
-0000c570: 6467 6532 2e73 7461 7274 2c20 6564 6765  dge2.start, edge
-0000c580: 322e 656e 645d 3a0a 2020 2020 2020 2020  2.end]:.        
-0000c590: 2020 2020 2020 2020 2020 2020 6966 2065              if e
-0000c5a0: 6467 6531 2e70 6f69 6e74 5f62 656c 6f6e  dge1.point_belon
-0000c5b0: 6773 2870 6f69 6e74 2c20 3165 2d36 293a  gs(point, 1e-6):
-0000c5c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c5d0: 2020 2020 2020 2020 2023 206c 6973 745f           # list_
-0000c5e0: 702e 6170 7065 6e64 2870 6f69 6e74 290a  p.append(point).
-0000c5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c600: 2020 2020 2020 2020 2320 696e 7374 6561          # instea
-0000c610: 6420 6f66 2070 6f69 6e74 206e 6f74 2069  d of point not i
-0000c620: 6e20 6c69 7374 5f70 2028 6475 6520 746f  n list_p (due to
-0000c630: 2065 7272 6f72 7329 0a20 2020 2020 2020   errors).       
-0000c640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c650: 2069 6620 6c69 7374 5f70 203d 3d20 5b5d   if list_p == []
-0000c660: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000c670: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-0000c680: 7374 5f70 2e61 7070 656e 6428 706f 696e  st_p.append(poin
-0000c690: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-0000c6a0: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
-0000c6b0: 7374 5f70 2021 3d20 5b5d 2061 6e64 2070  st_p != [] and p
-0000c6c0: 6f69 6e74 2e70 6f69 6e74 5f64 6973 7461  oint.point_dista
-0000c6d0: 6e63 6528 706f 696e 742e 6e65 6172 6573  nce(point.neares
-0000c6e0: 745f 706f 696e 7428 6c69 7374 5f70 2929  t_point(list_p))
-0000c6f0: 203e 2031 652d 343a 0a20 2020 2020 2020   > 1e-4:.       
-0000c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c710: 2020 2020 206c 6973 745f 702e 6170 7065       list_p.appe
-0000c720: 6e64 2870 6f69 6e74 290a 0a20 2020 2020  nd(point)..     
-0000c730: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000c740: 6620 6c65 6e28 6c69 7374 5f70 2920 3d3d  f len(list_p) ==
-0000c750: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-0000c760: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0000c770: 7369 6e73 7461 6e63 6528 7365 6c66 2c20  sinstance(self, 
-0000c780: 436f 6e74 6f75 7232 4429 3a0a 2020 2020  Contour2D):.    
-0000c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c7a0: 2020 2020 2020 2020 6c69 6e65 7365 676d          linesegm
-0000c7b0: 656e 7420 3d20 766f 6c6d 646c 722e 6564  ent = volmdlr.ed
-0000c7c0: 6765 732e 4c69 6e65 5365 676d 656e 7432  ges.LineSegment2
-0000c7d0: 4428 6c69 7374 5f70 5b30 5d2c 206c 6973  D(list_p[0], lis
-0000c7e0: 745f 705b 315d 290a 2020 2020 2020 2020  t_p[1]).        
+0000c4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c4e0: 636f 6e74 6f75 722e 7072 696d 6974 6976  contour.primitiv
+0000c4f0: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+0000c500: 2065 6467 6573 203d 205b 6564 6765 5f31   edges = [edge_1
+0000c510: 2c20 6564 6765 5f32 2c20 6564 6765 5f31  , edge_2, edge_1
+0000c520: 5d0a 2020 2020 2020 2020 2020 2020 666f  ].            fo
+0000c530: 7220 6564 6765 312c 2065 6467 6532 2069  r edge1, edge2 i
+0000c540: 6e20 7a69 7028 6564 6765 732c 2065 6467  n zip(edges, edg
+0000c550: 6573 5b31 3a5d 293a 0a20 2020 2020 2020  es[1:]):.       
+0000c560: 2020 2020 2020 2020 2066 6f72 2070 6f69           for poi
+0000c570: 6e74 2069 6e20 5b65 6467 6532 2e73 7461  nt in [edge2.sta
+0000c580: 7274 2c20 6564 6765 322e 656e 645d 3a0a  rt, edge2.end]:.
+0000c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c5a0: 2020 2020 6966 2065 6467 6531 2e70 6f69      if edge1.poi
+0000c5b0: 6e74 5f62 656c 6f6e 6773 2870 6f69 6e74  nt_belongs(point
+0000c5c0: 2c20 3165 2d36 293a 0a20 2020 2020 2020  , 1e-6):.       
+0000c5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c5e0: 2023 206c 6973 745f 702e 6170 7065 6e64   # list_p.append
+0000c5f0: 2870 6f69 6e74 290a 2020 2020 2020 2020  (point).        
+0000c600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c610: 2320 696e 7374 6561 6420 6f66 2070 6f69  # instead of poi
+0000c620: 6e74 206e 6f74 2069 6e20 6c69 7374 5f70  nt not in list_p
+0000c630: 2028 6475 6520 746f 2065 7272 6f72 7329   (due to errors)
+0000c640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c650: 2020 2020 2020 2020 2069 6620 6c69 7374           if list
+0000c660: 5f70 203d 3d20 5b5d 3a0a 2020 2020 2020  _p == []:.      
+0000c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c680: 2020 2020 2020 6c69 7374 5f70 2e61 7070        list_p.app
+0000c690: 656e 6428 706f 696e 7429 0a20 2020 2020  end(point).     
+0000c6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c6b0: 2020 2069 6620 6c69 7374 5f70 2021 3d20     if list_p != 
+0000c6c0: 5b5d 2061 6e64 2070 6f69 6e74 2e70 6f69  [] and point.poi
+0000c6d0: 6e74 5f64 6973 7461 6e63 6528 706f 696e  nt_distance(poin
+0000c6e0: 742e 6e65 6172 6573 745f 706f 696e 7428  t.nearest_point(
+0000c6f0: 6c69 7374 5f70 2929 203e 2031 652d 343a  list_p)) > 1e-4:
+0000c700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c710: 2020 2020 2020 2020 2020 2020 206c 6973               lis
+0000c720: 745f 702e 6170 7065 6e64 2870 6f69 6e74  t_p.append(point
+0000c730: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000c740: 2020 2020 2020 2069 6620 6c65 6e28 6c69         if len(li
+0000c750: 7374 5f70 2920 3d3d 2032 3a0a 2020 2020  st_p) == 2:.    
+0000c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c770: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0000c780: 6528 7365 6c66 2c20 436f 6e74 6f75 7232  e(self, Contour2
+0000c790: 4429 3a0a 2020 2020 2020 2020 2020 2020  D):.            
+0000c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c7b0: 6c69 6e65 7365 676d 656e 7420 3d20 766f  linesegment = vo
+0000c7c0: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
+0000c7d0: 5365 676d 656e 7432 4428 6c69 7374 5f70  Segment2D(list_p
+0000c7e0: 5b30 5d2c 206c 6973 745f 705b 315d 290a  [0], list_p[1]).
 0000c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c800: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000c800: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
 0000c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c820: 2020 6c69 6e65 7365 676d 656e 7420 3d20    linesegment = 
-0000c830: 766f 6c6d 646c 722e 6564 6765 732e 4c69  volmdlr.edges.Li
-0000c840: 6e65 5365 676d 656e 7433 4428 6c69 7374  neSegment3D(list
-0000c850: 5f70 5b30 5d2c 206c 6973 745f 705b 315d  _p[0], list_p[1]
-0000c860: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000c870: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0000c880: 662e 7072 696d 6974 6976 655f 6f76 6572  f.primitive_over
-0000c890: 5f63 6f6e 746f 7572 286c 696e 6573 6567  _contour(lineseg
-0000c8a0: 6d65 6e74 2920 616e 6420 5c0a 2020 2020  ment) and \.    
-0000c8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c8c0: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-0000c8d0: 6f75 722e 7072 696d 6974 6976 655f 6f76  our.primitive_ov
-0000c8e0: 6572 5f63 6f6e 746f 7572 286c 696e 6573  er_contour(lines
-0000c8f0: 6567 6d65 6e74 293a 0a20 2020 2020 2020  egment):.       
-0000c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c910: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-0000c920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c930: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000c940: 4661 6c73 650a 2020 2020 2020 2020 7265  False.        re
-0000c950: 7475 726e 2046 616c 7365 0a0a 2020 2020  turn False..    
-0000c960: 6465 6620 7368 6172 6564 5f70 7269 6d69  def shared_primi
-0000c970: 7469 7665 735f 6578 7472 656d 6974 6965  tives_extremitie
-0000c980: 7328 7365 6c66 2c20 636f 6e74 6f75 7229  s(self, contour)
-0000c990: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000c9a0: 2020 2020 2020 2374 6f64 6f3a 2069 7320        #todo: is 
-0000c9b0: 7468 6973 2064 6573 6372 6970 7469 6f6e  this description
-0000c9c0: 2063 6f72 7265 6374 3f0a 2020 2020 2020   correct?.      
-0000c9d0: 2020 4578 7472 6163 7420 7368 6172 6564    Extract shared
-0000c9e0: 2070 7269 6d69 7469 7665 7320 6578 7472   primitives extr
-0000c9f0: 656d 6974 6965 7320 6265 7477 6565 6e20  emities between 
-0000ca00: 7477 6f20 6164 6a61 6365 6e74 2063 6f6e  two adjacent con
-0000ca10: 746f 7572 732e 0a0a 2020 2020 2020 2020  tours...        
-0000ca20: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-0000ca30: 7365 6c66 2e69 735f 7375 7065 7270 6f73  self.is_superpos
-0000ca40: 696e 6728 636f 6e74 6f75 7229 3a0a 2020  ing(contour):.  
-0000ca50: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-0000ca60: 6773 2e77 6172 6e28 2754 6865 2063 6f6e  gs.warn('The con
-0000ca70: 746f 7572 7320 6172 6520 7375 7065 7270  tours are superp
-0000ca80: 6f73 696e 6727 290a 2020 2020 2020 2020  osing').        
-0000ca90: 2020 2020 7265 7475 726e 205b 5d0a 0a20      return [].. 
-0000caa0: 2020 2020 2020 206c 6973 745f 702c 2065         list_p, e
-0000cab0: 6467 6573 3120 3d20 5b5d 2c20 7365 7428  dges1 = [], set(
-0000cac0: 290a 2020 2020 2020 2020 666f 7220 6564  ).        for ed
-0000cad0: 6765 5f31 2c20 6564 6765 5f32 2069 6e20  ge_1, edge_2 in 
-0000cae0: 6974 6572 746f 6f6c 732e 7072 6f64 7563  itertools.produc
-0000caf0: 7428 7365 6c66 2e70 7269 6d69 7469 7665  t(self.primitive
-0000cb00: 732c 2063 6f6e 746f 7572 2e70 7269 6d69  s, contour.primi
-0000cb10: 7469 7665 7329 3a0a 2020 2020 2020 2020  tives):.        
-0000cb20: 2020 2020 6564 6765 7320 3d20 5b65 6467      edges = [edg
-0000cb30: 655f 312c 2065 6467 655f 322c 2065 6467  e_1, edge_2, edg
-0000cb40: 655f 315d 0a20 2020 2020 2020 2020 2020  e_1].           
-0000cb50: 2066 6f72 2065 6467 6531 2c20 6564 6765   for edge1, edge
-0000cb60: 3220 696e 207a 6970 2865 6467 6573 2c20  2 in zip(edges, 
-0000cb70: 6564 6765 735b 313a 5d29 3a0a 2020 2020  edges[1:]):.    
-0000cb80: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0000cb90: 706f 696e 7420 696e 205b 6564 6765 322e  point in [edge2.
-0000cba0: 7374 6172 742c 2065 6467 6532 2e65 6e64  start, edge2.end
-0000cbb0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-0000cbc0: 2020 2020 2020 2069 6620 6564 6765 312e         if edge1.
-0000cbd0: 706f 696e 745f 6265 6c6f 6e67 7328 706f  point_belongs(po
-0000cbe0: 696e 742c 2031 652d 3629 3a0a 2020 2020  int, 1e-6):.    
-0000cbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc00: 2020 2020 6966 206e 6f74 206c 6973 745f      if not list_
-0000cc10: 703a 0a20 2020 2020 2020 2020 2020 2020  p:.             
-0000cc20: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0000cc30: 6973 745f 702e 6170 7065 6e64 2870 6f69  ist_p.append(poi
-0000cc40: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
-0000cc50: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0000cc60: 6973 745f 7020 213d 205b 5d20 616e 6420  ist_p != [] and 
-0000cc70: 706f 696e 742e 706f 696e 745f 6469 7374  point.point_dist
-0000cc80: 616e 6365 2870 6f69 6e74 2e6e 6561 7265  ance(point.neare
-0000cc90: 7374 5f70 6f69 6e74 286c 6973 745f 7029  st_point(list_p)
-0000cca0: 2920 3e20 3165 2d34 3a0a 2020 2020 2020  ) > 1e-4:.      
-0000ccb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ccc0: 2020 2020 2020 6c69 7374 5f70 2e61 7070        list_p.app
-0000ccd0: 656e 6428 706f 696e 7429 0a20 2020 2020  end(point).     
-0000cce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ccf0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+0000c820: 2020 2020 2020 2020 2020 6c69 6e65 7365            linese
+0000c830: 676d 656e 7420 3d20 766f 6c6d 646c 722e  gment = volmdlr.
+0000c840: 6564 6765 732e 4c69 6e65 5365 676d 656e  edges.LineSegmen
+0000c850: 7433 4428 6c69 7374 5f70 5b30 5d2c 206c  t3D(list_p[0], l
+0000c860: 6973 745f 705b 315d 290a 2020 2020 2020  ist_p[1]).      
+0000c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c880: 2020 6966 2073 656c 662e 7072 696d 6974    if self.primit
+0000c890: 6976 655f 6f76 6572 5f63 6f6e 746f 7572  ive_over_contour
+0000c8a0: 286c 696e 6573 6567 6d65 6e74 2920 616e  (linesegment) an
+0000c8b0: 6420 5c0a 2020 2020 2020 2020 2020 2020  d \.            
+0000c8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c8d0: 2020 2020 636f 6e74 6f75 722e 7072 696d      contour.prim
+0000c8e0: 6974 6976 655f 6f76 6572 5f63 6f6e 746f  itive_over_conto
+0000c8f0: 7572 286c 696e 6573 6567 6d65 6e74 293a  ur(linesegment):
+0000c900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c910: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0000c920: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
+0000c930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c940: 2072 6574 7572 6e20 4661 6c73 650a 2020   return False.  
+0000c950: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+0000c960: 7365 0a0a 2020 2020 6465 6620 7368 6172  se..    def shar
+0000c970: 6564 5f70 7269 6d69 7469 7665 735f 6578  ed_primitives_ex
+0000c980: 7472 656d 6974 6965 7328 7365 6c66 2c20  tremities(self, 
+0000c990: 636f 6e74 6f75 7229 3a0a 2020 2020 2020  contour):.      
+0000c9a0: 2020 2222 220a 2020 2020 2020 2020 2374    """.        #t
+0000c9b0: 6f64 6f3a 2069 7320 7468 6973 2064 6573  odo: is this des
+0000c9c0: 6372 6970 7469 6f6e 2063 6f72 7265 6374  cription correct
+0000c9d0: 3f0a 2020 2020 2020 2020 4578 7472 6163  ?.        Extrac
+0000c9e0: 7420 7368 6172 6564 2070 7269 6d69 7469  t shared primiti
+0000c9f0: 7665 7320 6578 7472 656d 6974 6965 7320  ves extremities 
+0000ca00: 6265 7477 6565 6e20 7477 6f20 6164 6a61  between two adja
+0000ca10: 6365 6e74 2063 6f6e 746f 7572 732e 0a0a  cent contours...
+0000ca20: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+0000ca30: 2020 2020 2069 6620 7365 6c66 2e69 735f       if self.is_
+0000ca40: 7375 7065 7270 6f73 696e 6728 636f 6e74  superposing(cont
+0000ca50: 6f75 7229 3a0a 2020 2020 2020 2020 2020  our):.          
+0000ca60: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+0000ca70: 2754 6865 2063 6f6e 746f 7572 7320 6172  'The contours ar
+0000ca80: 6520 7375 7065 7270 6f73 696e 6727 290a  e superposing').
+0000ca90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000caa0: 726e 205b 5d0a 0a20 2020 2020 2020 206c  rn []..        l
+0000cab0: 6973 745f 702c 2065 6467 6573 3120 3d20  ist_p, edges1 = 
+0000cac0: 5b5d 2c20 7365 7428 290a 2020 2020 2020  [], set().      
+0000cad0: 2020 666f 7220 6564 6765 5f31 2c20 6564    for edge_1, ed
+0000cae0: 6765 5f32 2069 6e20 6974 6572 746f 6f6c  ge_2 in itertool
+0000caf0: 732e 7072 6f64 7563 7428 7365 6c66 2e70  s.product(self.p
+0000cb00: 7269 6d69 7469 7665 732c 2063 6f6e 746f  rimitives, conto
+0000cb10: 7572 2e70 7269 6d69 7469 7665 7329 3a0a  ur.primitives):.
+0000cb20: 2020 2020 2020 2020 2020 2020 6564 6765              edge
+0000cb30: 7320 3d20 5b65 6467 655f 312c 2065 6467  s = [edge_1, edg
+0000cb40: 655f 322c 2065 6467 655f 315d 0a20 2020  e_2, edge_1].   
+0000cb50: 2020 2020 2020 2020 2066 6f72 2065 6467           for edg
+0000cb60: 6531 2c20 6564 6765 3220 696e 207a 6970  e1, edge2 in zip
+0000cb70: 2865 6467 6573 2c20 6564 6765 735b 313a  (edges, edges[1:
+0000cb80: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+0000cb90: 2020 2020 666f 7220 706f 696e 7420 696e      for point in
+0000cba0: 205b 6564 6765 322e 7374 6172 742c 2065   [edge2.start, e
+0000cbb0: 6467 6532 2e65 6e64 5d3a 0a20 2020 2020  dge2.end]:.     
+0000cbc0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000cbd0: 6620 6564 6765 312e 706f 696e 745f 6265  f edge1.point_be
+0000cbe0: 6c6f 6e67 7328 706f 696e 742c 2031 652d  longs(point, 1e-
+0000cbf0: 3629 3a0a 2020 2020 2020 2020 2020 2020  6):.            
+0000cc00: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0000cc10: 6f74 206c 6973 745f 703a 0a20 2020 2020  ot list_p:.     
+0000cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc30: 2020 2020 2020 206c 6973 745f 702e 6170         list_p.ap
+0000cc40: 7065 6e64 2870 6f69 6e74 290a 2020 2020  pend(point).    
+0000cc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc60: 2020 2020 6966 206c 6973 745f 7020 213d      if list_p !=
+0000cc70: 205b 5d20 616e 6420 706f 696e 742e 706f   [] and point.po
+0000cc80: 696e 745f 6469 7374 616e 6365 2870 6f69  int_distance(poi
+0000cc90: 6e74 2e6e 6561 7265 7374 5f70 6f69 6e74  nt.nearest_point
+0000cca0: 286c 6973 745f 7029 2920 3e20 3165 2d34  (list_p)) > 1e-4
+0000ccb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000ccc0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+0000ccd0: 7374 5f70 2e61 7070 656e 6428 706f 696e  st_p.append(poin
+0000cce0: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
+0000ccf0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
 0000cd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cd10: 2020 2020 7365 6c66 2e70 7269 6d69 7469      self.primiti
-0000cd20: 7665 5f74 6f5f 696e 6465 7828 6564 6765  ve_to_index(edge
-0000cd30: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
-0000cd40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000cd50: 6467 6573 312e 6164 6428 6564 6765 3129  dges1.add(edge1)
-0000cd60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cd70: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-0000cd80: 4b65 7945 7272 6f72 3a0a 2020 2020 2020  KeyError:.      
-0000cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cda0: 2020 2020 2020 6564 6765 7331 2e61 6464        edges1.add
-0000cdb0: 2865 6467 6532 290a 0a20 2020 2020 2020  (edge2)..       
-0000cdc0: 2069 6620 6c65 6e28 6c69 7374 5f70 2920   if len(list_p) 
-0000cdd0: 3c20 323a 0a20 2020 2020 2020 2020 2020  < 2:.           
-0000cde0: 2077 6172 6e69 6e67 732e 7761 726e 2827   warnings.warn('
-0000cdf0: 5468 6520 636f 6e74 6f75 7273 2061 7265  The contours are
-0000ce00: 206e 6f74 2061 646a 6163 656e 7427 290a   not adjacent').
-0000ce10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000ce20: 726e 205b 5d0a 0a20 2020 2020 2020 2069  rn []..        i
-0000ce30: 6620 6c65 6e28 6c69 7374 5f70 2920 3d3d  f len(list_p) ==
-0000ce40: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-0000ce50: 7265 7475 726e 206c 6973 745f 700a 0a20  return list_p.. 
-0000ce60: 2020 2020 2020 2063 6f6e 746f 7572 7320         contours 
-0000ce70: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
-0000ce80: 2e63 6f6e 746f 7572 735f 6672 6f6d 5f65  .contours_from_e
-0000ce90: 6467 6573 2865 6467 6573 3129 0a20 2020  dges(edges1).   
-0000cea0: 2020 2020 2070 6f69 6e74 7320 3d20 5b5d       points = []
-0000ceb0: 0a20 2020 2020 2020 2066 6f72 2063 6f6e  .        for con
-0000cec0: 746f 7572 5f69 2069 6e20 636f 6e74 6f75  tour_i in contou
-0000ced0: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
-0000cee0: 706f 696e 7473 2e65 7874 656e 6428 636f  points.extend(co
-0000cef0: 6e74 6f75 725f 692e 6578 7472 656d 6974  ntour_i.extremit
-0000cf00: 6965 735f 706f 696e 7473 286c 6973 745f  ies_points(list_
-0000cf10: 7029 290a 0a20 2020 2020 2020 2072 6574  p))..        ret
-0000cf20: 7572 6e20 706f 696e 7473 0a0a 2020 2020  urn points..    
-0000cf30: 6465 6620 7368 6172 6564 5f70 7269 6d69  def shared_primi
-0000cf40: 7469 7665 735f 7769 7468 2873 656c 662c  tives_with(self,
-0000cf50: 2063 6f6e 746f 7572 293a 0a20 2020 2020   contour):.     
-0000cf60: 2020 2022 2222 0a20 2020 2020 2020 2045     """.        E
-0000cf70: 7874 7261 6374 2073 6861 7265 6420 7072  xtract shared pr
-0000cf80: 696d 6974 6976 6573 2062 6574 7765 656e  imitives between
-0000cf90: 2074 776f 2061 646a 6163 656e 7420 636f   two adjacent co
-0000cfa0: 6e74 6f75 7273 2e0a 0a20 2020 2020 2020  ntours...       
-0000cfb0: 2022 2222 0a0a 2020 2020 2020 2020 7368   """..        sh
-0000cfc0: 6172 6564 5f70 7269 6d69 7469 7665 735f  ared_primitives_
-0000cfd0: 3120 3d20 5b5d 0a20 2020 2020 2020 2073  1 = [].        s
-0000cfe0: 6861 7265 645f 7072 696d 6974 6976 6573  hared_primitives
-0000cff0: 5f32 203d 205b 5d0a 0a20 2020 2020 2020  _2 = []..       
-0000d000: 2070 6f69 6e74 7320 3d20 7365 6c66 2e73   points = self.s
-0000d010: 6861 7265 645f 7072 696d 6974 6976 6573  hared_primitives
-0000d020: 5f65 7874 7265 6d69 7469 6573 2863 6f6e  _extremities(con
-0000d030: 746f 7572 290a 2020 2020 2020 2020 666f  tour).        fo
-0000d040: 7220 6920 696e 2072 616e 6765 2830 2c20  r i in range(0, 
-0000d050: 6c65 6e28 706f 696e 7473 292c 2032 293a  len(points), 2):
-0000d060: 0a20 2020 2020 2020 2020 2020 2070 6f69  .            poi
-0000d070: 6e74 312c 2070 6f69 6e74 3220 3d20 706f  nt1, point2 = po
-0000d080: 696e 7473 5b69 5d2c 2070 6f69 6e74 735b  ints[i], points[
-0000d090: 6920 2b20 315d 0a0a 2020 2020 2020 2020  i + 1]..        
-0000d0a0: 2020 2020 7368 6172 6564 5f70 7269 6d69      shared_primi
-0000d0b0: 7469 7665 735f 7072 696d 203d 2073 656c  tives_prim = sel
-0000d0c0: 662e 6578 7472 6163 745f 7769 7468 6f75  f.extract_withou
-0000d0d0: 745f 7072 696d 6974 6976 6573 2870 6f69  t_primitives(poi
-0000d0e0: 6e74 312c 2070 6f69 6e74 322c 2046 616c  nt1, point2, Fal
-0000d0f0: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
-0000d100: 6966 2061 6e79 286e 6f74 2063 6f6e 746f  if any(not conto
-0000d110: 7572 2e70 6f69 6e74 5f6f 7665 725f 636f  ur.point_over_co
-0000d120: 6e74 6f75 7228 7072 696d 2e6d 6964 646c  ntour(prim.middl
-0000d130: 655f 706f 696e 7428 292c 2031 652d 3429  e_point(), 1e-4)
-0000d140: 2066 6f72 2070 7269 6d20 696e 2073 6861   for prim in sha
-0000d150: 7265 645f 7072 696d 6974 6976 6573 5f70  red_primitives_p
-0000d160: 7269 6d29 3a0a 2020 2020 2020 2020 2020  rim):.          
-0000d170: 2020 2020 2020 7368 6172 6564 5f70 7269        shared_pri
-0000d180: 6d69 7469 7665 735f 312e 6578 7465 6e64  mitives_1.extend
-0000d190: 2873 656c 662e 6578 7472 6163 745f 7769  (self.extract_wi
-0000d1a0: 7468 6f75 745f 7072 696d 6974 6976 6573  thout_primitives
-0000d1b0: 2870 6f69 6e74 312c 2070 6f69 6e74 322c  (point1, point2,
-0000d1c0: 2054 7275 6529 290a 2020 2020 2020 2020   True)).        
-0000d1d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000d1e0: 2020 2020 2020 2020 2020 7368 6172 6564            shared
-0000d1f0: 5f70 7269 6d69 7469 7665 735f 312e 6578  _primitives_1.ex
-0000d200: 7465 6e64 2873 6861 7265 645f 7072 696d  tend(shared_prim
-0000d210: 6974 6976 6573 5f70 7269 6d29 0a0a 2020  itives_prim)..  
-0000d220: 2020 2020 2020 2020 2020 7368 6172 6564            shared
-0000d230: 5f70 7269 6d69 7469 7665 735f 7072 696d  _primitives_prim
-0000d240: 203d 2063 6f6e 746f 7572 2e65 7874 7261   = contour.extra
-0000d250: 6374 5f77 6974 686f 7574 5f70 7269 6d69  ct_without_primi
-0000d260: 7469 7665 7328 706f 696e 7431 2c20 706f  tives(point1, po
-0000d270: 696e 7432 2c20 4661 6c73 6529 0a20 2020  int2, False).   
-0000d280: 2020 2020 2020 2020 2069 6620 616e 7928           if any(
-0000d290: 6e6f 7420 7365 6c66 2e70 6f69 6e74 5f6f  not self.point_o
-0000d2a0: 7665 725f 636f 6e74 6f75 7228 7072 696d  ver_contour(prim
-0000d2b0: 2e6d 6964 646c 655f 706f 696e 7428 292c  .middle_point(),
-0000d2c0: 2031 652d 3429 2066 6f72 2070 7269 6d20   1e-4) for prim 
-0000d2d0: 696e 2073 6861 7265 645f 7072 696d 6974  in shared_primit
-0000d2e0: 6976 6573 5f70 7269 6d29 3a0a 2020 2020  ives_prim):.    
-0000d2f0: 2020 2020 2020 2020 2020 2020 7368 6172              shar
-0000d300: 6564 5f70 7269 6d69 7469 7665 735f 322e  ed_primitives_2.
-0000d310: 6578 7465 6e64 2863 6f6e 746f 7572 2e65  extend(contour.e
-0000d320: 7874 7261 6374 5f77 6974 686f 7574 5f70  xtract_without_p
-0000d330: 7269 6d69 7469 7665 7328 706f 696e 7431  rimitives(point1
-0000d340: 2c20 706f 696e 7432 2c20 5472 7565 2929  , point2, True))
-0000d350: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0000d360: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0000d370: 2020 2073 6861 7265 645f 7072 696d 6974     shared_primit
-0000d380: 6976 6573 5f32 2e65 7874 656e 6428 7368  ives_2.extend(sh
-0000d390: 6172 6564 5f70 7269 6d69 7469 7665 735f  ared_primitives_
-0000d3a0: 7072 696d 290a 0a20 2020 2020 2020 2072  prim)..        r
-0000d3b0: 6574 7572 6e20 5b73 6861 7265 645f 7072  eturn [shared_pr
-0000d3c0: 696d 6974 6976 6573 5f31 2c20 7368 6172  imitives_1, shar
-0000d3d0: 6564 5f70 7269 6d69 7469 7665 735f 325d  ed_primitives_2]
-0000d3e0: 0a0a 2020 2020 6465 6620 6d65 7267 655f  ..    def merge_
-0000d3f0: 7072 696d 6974 6976 6573 5f77 6974 6828  primitives_with(
-0000d400: 7365 6c66 2c20 636f 6e74 6f75 7229 3a0a  self, contour):.
-0000d410: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000d420: 2020 2020 4578 7472 6163 7420 6e6f 7420      Extract not 
-0000d430: 7368 6172 6564 2070 7269 6d69 7469 7665  shared primitive
-0000d440: 7320 6265 7477 6565 6e20 7477 6f20 6164  s between two ad
-0000d450: 6a61 6365 6e74 2063 6f6e 746f 7572 732c  jacent contours,
-0000d460: 2074 6f20 6265 206d 6572 6765 642e 0a0a   to be merged...
-0000d470: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000d480: 2020 2020 636f 6e74 6f75 7231 203d 2073      contour1 = s
-0000d490: 656c 660a 2020 2020 2020 2020 636f 6e74  elf.        cont
-0000d4a0: 6f75 7232 203d 2063 6f6e 746f 7572 0a20  our2 = contour. 
-0000d4b0: 2020 2020 2020 2070 6f69 6e74 7320 3d20         points = 
-0000d4c0: 7365 6c66 2e73 6861 7265 645f 7072 696d  self.shared_prim
-0000d4d0: 6974 6976 6573 5f65 7874 7265 6d69 7469  itives_extremiti
-0000d4e0: 6573 2863 6f6e 746f 7572 290a 2020 2020  es(contour).    
-0000d4f0: 2020 2020 706f 696e 7473 203d 2073 656c      points = sel
-0000d500: 662e 736f 7274 5f70 6f69 6e74 735f 616c  f.sort_points_al
-0000d510: 6f6e 675f 7769 7265 2870 6f69 6e74 7329  ong_wire(points)
-0000d520: 0a20 2020 2020 2020 206d 6572 6765 5f70  .        merge_p
-0000d530: 7269 6d69 7469 7665 7331 203d 205b 5d0a  rimitives1 = [].
-0000d540: 2020 2020 2020 2020 6d65 7267 655f 7072          merge_pr
-0000d550: 696d 6974 6976 6573 3220 3d20 5b5d 0a20  imitives2 = []. 
-0000d560: 2020 2020 2020 2066 6f72 2070 6f69 6e74         for point
-0000d570: 312c 2070 6f69 6e74 3220 696e 207a 6970  1, point2 in zip
-0000d580: 2870 6f69 6e74 735b 3a2d 315d 2c20 706f  (points[:-1], po
-0000d590: 696e 7473 5b31 3a5d 293a 0a20 2020 2020  ints[1:]):.     
-0000d5a0: 2020 2020 2020 206d 6572 6765 5f70 7269         merge_pri
-0000d5b0: 6d69 7469 7665 735f 7072 696d 3120 3d20  mitives_prim1 = 
-0000d5c0: 636f 6e74 6f75 7231 2e65 7874 7261 6374  contour1.extract
-0000d5d0: 5f77 6974 686f 7574 5f70 7269 6d69 7469  _without_primiti
-0000d5e0: 7665 7328 706f 696e 7431 2c20 706f 696e  ves(point1, poin
-0000d5f0: 7432 2c20 4661 6c73 6529 0a20 2020 2020  t2, False).     
-0000d600: 2020 2020 2020 206d 6572 6765 5f70 7269         merge_pri
-0000d610: 6d69 7469 7665 735f 7072 696d 3220 3d20  mitives_prim2 = 
-0000d620: 636f 6e74 6f75 7231 2e65 7874 7261 6374  contour1.extract
-0000d630: 5f77 6974 686f 7574 5f70 7269 6d69 7469  _without_primiti
-0000d640: 7665 7328 706f 696e 7431 2c20 706f 696e  ves(point1, poin
-0000d650: 7432 2c20 5472 7565 290a 2020 2020 2020  t2, True).      
-0000d660: 2020 2020 2020 666f 7220 7072 696d 7320        for prims 
-0000d670: 696e 205b 6d65 7267 655f 7072 696d 6974  in [merge_primit
-0000d680: 6976 6573 5f70 7269 6d31 2c20 6d65 7267  ives_prim1, merg
-0000d690: 655f 7072 696d 6974 6976 6573 5f70 7269  e_primitives_pri
-0000d6a0: 6d32 5d3a 0a20 2020 2020 2020 2020 2020  m2]:.           
-0000d6b0: 2020 2020 2069 6620 616c 6c28 636f 6e74       if all(cont
-0000d6c0: 6f75 722e 706f 696e 745f 6f76 6572 5f63  our.point_over_c
-0000d6d0: 6f6e 746f 7572 2870 7269 6d2e 6d69 6464  ontour(prim.midd
-0000d6e0: 6c65 5f70 6f69 6e74 2829 2c20 3165 2d34  le_point(), 1e-4
-0000d6f0: 2920 666f 7220 7072 696d 2069 6e20 7072  ) for prim in pr
-0000d700: 696d 7329 3a0a 2020 2020 2020 2020 2020  ims):.          
-0000d710: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-0000d720: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-0000d730: 2020 2069 6620 6e6f 7420 616c 6c28 6e6f     if not all(no
-0000d740: 7420 636f 6e74 6f75 722e 706f 696e 745f  t contour.point_
-0000d750: 6f76 6572 5f63 6f6e 746f 7572 2870 7269  over_contour(pri
-0000d760: 6d2e 6d69 6464 6c65 5f70 6f69 6e74 2829  m.middle_point()
-0000d770: 2c20 3165 2d34 2920 666f 7220 7072 696d  , 1e-4) for prim
-0000d780: 2069 6e20 7072 696d 7329 3a0a 2020 2020   in prims):.    
-0000d790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d7a0: 636f 6e74 6f75 7231 203d 2067 6574 6174  contour1 = getat
-0000d7b0: 7472 2873 7973 2e6d 6f64 756c 6573 5b5f  tr(sys.modules[_
-0000d7c0: 5f6e 616d 655f 5f5d 2c20 2743 6f6e 746f  _name__], 'Conto
-0000d7d0: 7572 2720 2b20 7365 6c66 2e5f 5f63 6c61  ur' + self.__cla
-0000d7e0: 7373 5f5f 2e5f 5f6e 616d 655f 5f5b 2d32  ss__.__name__[-2
-0000d7f0: 3a5d 2928 7072 696d 7329 0a20 2020 2020  :])(prims).     
-0000d800: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0000d810: 616c 6c28 6e6f 7420 636f 6e74 6f75 722e  all(not contour.
-0000d820: 706f 696e 745f 6f76 6572 5f63 6f6e 746f  point_over_conto
-0000d830: 7572 2870 7269 6d2e 6d69 6464 6c65 5f70  ur(prim.middle_p
-0000d840: 6f69 6e74 2829 2c20 3165 2d34 2920 666f  oint(), 1e-4) fo
-0000d850: 7220 7072 696d 2069 6e20 7072 696d 7329  r prim in prims)
-0000d860: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000d870: 2020 2020 2020 6d65 7267 655f 7072 696d        merge_prim
-0000d880: 6974 6976 6573 312e 6578 7465 6e64 2870  itives1.extend(p
-0000d890: 7269 6d73 290a 2020 2020 2020 2020 2020  rims).          
-0000d8a0: 2020 6d65 7267 655f 7072 696d 6974 6976    merge_primitiv
-0000d8b0: 6573 5f70 7269 6d33 203d 2063 6f6e 746f  es_prim3 = conto
-0000d8c0: 7572 322e 6578 7472 6163 745f 7769 7468  ur2.extract_with
-0000d8d0: 6f75 745f 7072 696d 6974 6976 6573 2870  out_primitives(p
-0000d8e0: 6f69 6e74 312c 2070 6f69 6e74 322c 2046  oint1, point2, F
-0000d8f0: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
-0000d900: 2020 6d65 7267 655f 7072 696d 6974 6976    merge_primitiv
-0000d910: 6573 5f70 7269 6d34 203d 2063 6f6e 746f  es_prim4 = conto
-0000d920: 7572 322e 6578 7472 6163 745f 7769 7468  ur2.extract_with
-0000d930: 6f75 745f 7072 696d 6974 6976 6573 2870  out_primitives(p
-0000d940: 6f69 6e74 312c 2070 6f69 6e74 322c 2054  oint1, point2, T
-0000d950: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
-0000d960: 2066 6f72 2070 7269 6d73 2069 6e20 5b6d   for prims in [m
-0000d970: 6572 6765 5f70 7269 6d69 7469 7665 735f  erge_primitives_
-0000d980: 7072 696d 332c 206d 6572 6765 5f70 7269  prim3, merge_pri
-0000d990: 6d69 7469 7665 735f 7072 696d 345d 3a0a  mitives_prim4]:.
-0000d9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d9b0: 6966 2061 6c6c 2873 656c 662e 706f 696e  if all(self.poin
-0000d9c0: 745f 6f76 6572 5f63 6f6e 746f 7572 2870  t_over_contour(p
-0000d9d0: 7269 6d2e 6d69 6464 6c65 5f70 6f69 6e74  rim.middle_point
-0000d9e0: 2829 2c20 3165 2d34 2920 666f 7220 7072  (), 1e-4) for pr
-0000d9f0: 696d 2069 6e20 7072 696d 7329 3a0a 2020  im in prims):.  
-0000da00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da10: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
-0000da20: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-0000da30: 7420 616c 6c28 6e6f 7420 7365 6c66 2e70  t all(not self.p
-0000da40: 6f69 6e74 5f6f 7665 725f 636f 6e74 6f75  oint_over_contou
-0000da50: 7228 7072 696d 2e6d 6964 646c 655f 706f  r(prim.middle_po
-0000da60: 696e 7428 292c 2031 652d 3429 2066 6f72  int(), 1e-4) for
-0000da70: 2070 7269 6d20 696e 2070 7269 6d73 293a   prim in prims):
-0000da80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000da90: 2020 2020 2063 6f6e 746f 7572 3220 3d20       contour2 = 
-0000daa0: 6765 7461 7474 7228 7379 732e 6d6f 6475  getattr(sys.modu
-0000dab0: 6c65 735b 5f5f 6e61 6d65 5f5f 5d2c 2027  les[__name__], '
-0000dac0: 436f 6e74 6f75 7227 202b 2073 656c 662e  Contour' + self.
-0000dad0: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-0000dae0: 5f5f 5b2d 323a 5d29 2870 7269 6d73 290a  __[-2:])(prims).
-0000daf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db00: 656c 6966 2061 6c6c 286e 6f74 2073 656c  elif all(not sel
-0000db10: 662e 706f 696e 745f 6f76 6572 5f63 6f6e  f.point_over_con
-0000db20: 746f 7572 2870 7269 6d2e 6d69 6464 6c65  tour(prim.middle
-0000db30: 5f70 6f69 6e74 2829 2c20 3165 2d34 2920  _point(), 1e-4) 
-0000db40: 666f 7220 7072 696d 2069 6e20 7072 696d  for prim in prim
-0000db50: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0000db60: 2020 2020 2020 2020 6d65 7267 655f 7072          merge_pr
-0000db70: 696d 6974 6976 6573 322e 6578 7465 6e64  imitives2.extend
-0000db80: 2870 7269 6d73 290a 2020 2020 2020 2020  (prims).        
-0000db90: 6d65 7267 655f 7072 696d 6974 6976 6573  merge_primitives
-0000dba0: 203d 206d 6572 6765 5f70 7269 6d69 7469   = merge_primiti
-0000dbb0: 7665 7331 202b 206d 6572 6765 5f70 7269  ves1 + merge_pri
-0000dbc0: 6d69 7469 7665 7332 0a20 2020 2020 2020  mitives2.       
-0000dbd0: 2072 6574 7572 6e20 6d65 7267 655f 7072   return merge_pr
-0000dbe0: 696d 6974 6976 6573 0a0a 2020 2020 6465  imitives..    de
-0000dbf0: 6620 6564 6765 735f 6f72 6465 725f 7769  f edges_order_wi
-0000dc00: 7468 5f61 646a 6163 656e 745f 636f 6e74  th_adjacent_cont
-0000dc10: 6f75 7228 7365 6c66 2c20 636f 6e74 6f75  our(self, contou
-0000dc20: 7229 3a0a 2020 2020 2020 2020 2222 220a  r):.        """.
-0000dc30: 2020 2020 2020 2020 4368 6563 6b20 6966          Check if
-0000dc40: 2074 6865 2073 6861 7265 6420 6564 6765   the shared edge
-0000dc50: 7320 6265 7477 6565 6e20 7477 6f20 6164  s between two ad
-0000dc60: 6a61 6365 6e74 2063 6f6e 746f 7572 7320  jacent contours 
-0000dc70: 6172 6520 7472 6176 6572 7365 6420 7769  are traversed wi
-0000dc80: 7468 2074 776f 0a20 2020 2020 2020 2064  th two.        d
-0000dc90: 6966 6665 7265 6e74 2064 6972 6563 7469  ifferent directi
-0000dca0: 6f6e 7320 616c 6f6e 6720 6561 6368 2063  ons along each c
-0000dcb0: 6f6e 746f 7572 2e0a 0a20 2020 2020 2020  ontour...       
-0000dcc0: 2022 2222 0a0a 2020 2020 2020 2020 636f   """..        co
-0000dcd0: 6e74 6f75 7231 203d 2073 656c 660a 2020  ntour1 = self.  
-0000dce0: 2020 2020 2020 636f 6e74 6f75 7232 203d        contour2 =
-0000dcf0: 2063 6f6e 746f 7572 0a0a 2020 2020 2020   contour..      
-0000dd00: 2020 2320 7368 6172 6564 5f74 7570 6c65    # shared_tuple
-0000dd10: 203d 2063 6f6e 746f 7572 312e 7368 6172   = contour1.shar
-0000dd20: 6564 5f65 6467 6573 5f62 6574 7765 656e  ed_edges_between
-0000dd30: 3263 6f6e 746f 7572 7328 636f 6e74 6f75  2contours(contou
-0000dd40: 7232 290a 2020 2020 2020 2020 7368 6172  r2).        shar
-0000dd50: 6564 5f74 7570 6c65 203d 2063 6f6e 746f  ed_tuple = conto
-0000dd60: 7572 312e 7368 6172 6564 5f70 7269 6d69  ur1.shared_primi
-0000dd70: 7469 7665 735f 7769 7468 2863 6f6e 746f  tives_with(conto
-0000dd80: 7572 3229 0a20 2020 2020 2020 2023 205b  ur2).        # [
-0000dd90: 7368 6172 6564 5f70 7269 6d69 7469 7665  shared_primitive
-0000dda0: 735f 312c 2073 6861 7265 645f 7072 696d  s_1, shared_prim
-0000ddb0: 6974 6976 6573 5f32 5d20 3d20 636f 6e74  itives_2] = cont
-0000ddc0: 6f75 7231 2e73 6861 7265 645f 7072 696d  our1.shared_prim
-0000ddd0: 6974 6976 6573 5f77 6974 6828 636f 6e74  itives_with(cont
-0000dde0: 6f75 7232 290a 0a20 2020 2020 2020 2023  our2)..        #
-0000ddf0: 2070 315f 7374 6172 7420 3d20 636f 6e74   p1_start = cont
-0000de00: 6f75 7231 2e70 7269 6d69 7469 7665 735b  our1.primitives[
-0000de10: 7368 6172 6564 5f74 7570 6c65 5b30 5d5b  shared_tuple[0][
-0000de20: 305d 5d2e 7374 6172 740a 2020 2020 2020  0]].start.      
-0000de30: 2020 2320 7032 5f73 7461 7274 203d 2063    # p2_start = c
-0000de40: 6f6e 746f 7572 322e 7072 696d 6974 6976  ontour2.primitiv
-0000de50: 6573 5b73 6861 7265 645f 7475 706c 655b  es[shared_tuple[
-0000de60: 305d 5b31 5d5d 2e73 7461 7274 0a20 2020  0][1]].start.   
-0000de70: 2020 2020 2023 2070 325f 656e 6420 3d20       # p2_end = 
-0000de80: 636f 6e74 6f75 7232 2e70 7269 6d69 7469  contour2.primiti
-0000de90: 7665 735b 7368 6172 6564 5f74 7570 6c65  ves[shared_tuple
-0000dea0: 5b30 5d5b 315d 5d2e 656e 640a 0a20 2020  [0][1]].end..   
-0000deb0: 2020 2020 2070 315f 7374 6172 7420 3d20       p1_start = 
-0000dec0: 7368 6172 6564 5f74 7570 6c65 5b30 5d5b  shared_tuple[0][
-0000ded0: 305d 2e73 7461 7274 0a20 2020 2020 2020  0].start.       
-0000dee0: 2070 325f 7374 6172 7420 3d20 7368 6172   p2_start = shar
-0000def0: 6564 5f74 7570 6c65 5b31 5d5b 2d31 5d2e  ed_tuple[1][-1].
-0000df00: 7374 6172 740a 2020 2020 2020 2020 7032  start.        p2
-0000df10: 5f65 6e64 203d 2073 6861 7265 645f 7475  _end = shared_tu
-0000df20: 706c 655b 315d 5b2d 315d 2e65 6e64 0a0a  ple[1][-1].end..
-0000df30: 2020 2020 2020 2020 6966 2028 7031 5f73          if (p1_s
-0000df40: 7461 7274 2e70 6f69 6e74 5f64 6973 7461  tart.point_dista
-0000df50: 6e63 6528 7032 5f73 7461 7274 2929 203c  nce(p2_start)) <
-0000df60: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
-0000df70: 2020 2028 7031 5f73 7461 7274 2e70 6f69     (p1_start.poi
-0000df80: 6e74 5f64 6973 7461 6e63 6528 7032 5f65  nt_distance(p2_e
-0000df90: 6e64 2929 3a0a 2020 2020 2020 2020 2020  nd)):.          
-0000dfa0: 2020 7265 7475 726e 2046 616c 7365 0a20    return False. 
-0000dfb0: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-0000dfc0: 7565 0a0a 2020 2020 6465 6620 6578 7472  ue..    def extr
-0000dfd0: 656d 6974 6965 735f 706f 696e 7473 2873  emities_points(s
-0000dfe0: 656c 662c 206c 6973 745f 7029 3a0a 2020  elf, list_p):.  
-0000dff0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000e000: 2020 5265 7475 726e 2065 7874 7265 6d69    Return extremi
-0000e010: 7469 6573 2070 6f69 6e74 7320 6f66 2061  ties points of a
-0000e020: 206c 6973 7420 6f66 2070 6f69 6e74 7320   list of points 
-0000e030: 6f6e 2061 2063 6f6e 746f 7572 2e0a 0a20  on a contour... 
-0000e040: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000e050: 2020 2023 2054 4f44 4f3a 2072 6577 7269     # TODO: rewri
-0000e060: 7465 2074 6869 7320 6177 6675 6c6c 2063  te this awfull c
-0000e070: 6f64 6521 0a20 2020 2020 2020 2070 6f69  ode!.        poi
-0000e080: 6e74 7320 3d20 5b5d 0a20 2020 2020 2020  nts = [].       
-0000e090: 2070 7269 6d69 7469 7665 7320 3d20 7365   primitives = se
-0000e0a0: 6c66 2e70 7269 6d69 7469 7665 730a 2020  lf.primitives.  
-0000e0b0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-0000e0c0: 616e 6765 2830 2c20 6c65 6e28 7072 696d  ange(0, len(prim
-0000e0d0: 6974 6976 6573 2929 3a0a 2020 2020 2020  itives)):.      
-0000e0e0: 2020 2020 2020 7074 7320 3d20 5b5d 0a20        pts = []. 
-0000e0f0: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-0000e100: 6f69 6e74 2069 6e20 6c69 7374 5f70 3a20  oint in list_p: 
-0000e110: 2023 2064 7565 2074 6f20 6572 726f 7273   # due to errors
-0000e120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e130: 2069 6620 7072 696d 6974 6976 6573 5b69   if primitives[i
-0000e140: 5d2e 706f 696e 745f 6265 6c6f 6e67 7328  ].point_belongs(
-0000e150: 706f 696e 7429 3a0a 2020 2020 2020 2020  point):.        
-0000e160: 2020 2020 2020 2020 2020 2020 7074 732e              pts.
-0000e170: 6170 7065 6e64 2870 6f69 6e74 290a 2020  append(point).  
-0000e180: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-0000e190: 2870 7473 2920 3d3d 2031 3a0a 2020 2020  (pts) == 1:.    
-0000e1a0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
-0000e1b0: 7473 2e61 7070 656e 6428 7074 735b 305d  ts.append(pts[0]
-0000e1c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000e1d0: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
-0000e1e0: 2020 2020 656c 6966 206c 656e 2870 7473      elif len(pts
-0000e1f0: 2920 3e20 313a 0a20 2020 2020 2020 2020  ) > 1:.         
-0000e200: 2020 2020 2020 2070 6f69 6e74 732e 6170         points.ap
-0000e210: 7065 6e64 2870 7269 6d69 7469 7665 735b  pend(primitives[
-0000e220: 695d 2e73 7461 7274 2e6e 6561 7265 7374  i].start.nearest
-0000e230: 5f70 6f69 6e74 2870 7473 2929 0a20 2020  _point(pts)).   
-0000e240: 2020 2020 2020 2020 2020 2020 2062 7265               bre
-0000e250: 616b 0a0a 2020 2020 2020 2020 666f 7220  ak..        for 
-0000e260: 6920 696e 2072 616e 6765 286c 656e 2870  i in range(len(p
-0000e270: 7269 6d69 7469 7665 7329 202d 2031 2c20  rimitives) - 1, 
-0000e280: 2d31 2c20 2d31 293a 0a20 2020 2020 2020  -1, -1):.       
-0000e290: 2020 2020 2070 7473 203d 205b 5d0a 2020       pts = [].  
-0000e2a0: 2020 2020 2020 2020 2020 666f 7220 706f            for po
-0000e2b0: 696e 7420 696e 206c 6973 745f 703a 2020  int in list_p:  
-0000e2c0: 2320 6475 6520 746f 2065 7272 6f72 730a  # due to errors.
-0000e2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e2e0: 6966 2070 7269 6d69 7469 7665 735b 695d  if primitives[i]
-0000e2f0: 2e70 6f69 6e74 5f62 656c 6f6e 6773 2870  .point_belongs(p
-0000e300: 6f69 6e74 293a 0a20 2020 2020 2020 2020  oint):.         
-0000e310: 2020 2020 2020 2020 2020 2070 7473 2e61             pts.a
-0000e320: 7070 656e 6428 706f 696e 7429 0a20 2020  ppend(point).   
-0000e330: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-0000e340: 7074 7329 203d 3d20 313a 0a20 2020 2020  pts) == 1:.     
-0000e350: 2020 2020 2020 2020 2020 2069 6620 7074             if pt
-0000e360: 735b 305d 206e 6f74 2069 6e20 706f 696e  s[0] not in poin
-0000e370: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-0000e380: 2020 2020 2020 2020 706f 696e 7473 2e61          points.a
-0000e390: 7070 656e 6428 7074 735b 305d 290a 2020  ppend(pts[0]).  
-0000e3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e3b0: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
-0000e3c0: 2020 2020 656c 6966 206c 656e 2870 7473      elif len(pts
-0000e3d0: 2920 3e20 313a 0a20 2020 2020 2020 2020  ) > 1:.         
-0000e3e0: 2020 2020 2020 2070 6f69 6e74 203d 2070         point = p
-0000e3f0: 7269 6d69 7469 7665 735b 695d 2e65 6e64  rimitives[i].end
-0000e400: 2e6e 6561 7265 7374 5f70 6f69 6e74 2870  .nearest_point(p
-0000e410: 7473 290a 2020 2020 2020 2020 2020 2020  ts).            
-0000e420: 2020 2020 6966 2070 6f69 6e74 206e 6f74      if point not
-0000e430: 2069 6e20 706f 696e 7473 3a0a 2020 2020   in points:.    
-0000e440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e450: 706f 696e 7473 2e61 7070 656e 6428 706f  points.append(po
-0000e460: 696e 7429 0a20 2020 2020 2020 2020 2020  int).           
-0000e470: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
-0000e480: 2020 2020 2020 2072 6574 7572 6e20 706f         return po
-0000e490: 696e 7473 0a0a 2020 2020 6465 6620 7072  ints..    def pr
-0000e4a0: 696d 6974 6976 655f 6f76 6572 5f63 6f6e  imitive_over_con
-0000e4b0: 746f 7572 2873 656c 662c 2070 7269 6d69  tour(self, primi
-0000e4c0: 7469 7665 2c20 746f 6c3a 2066 6c6f 6174  tive, tol: float
-0000e4d0: 203d 2031 652d 3629 3a0a 2020 2020 2020   = 1e-6):.      
-0000e4e0: 2020 7265 7475 726e 2073 656c 662e 7072    return self.pr
-0000e4f0: 696d 6974 6976 655f 6f76 6572 5f77 6972  imitive_over_wir
-0000e500: 6528 7072 696d 6974 6976 652c 2074 6f6c  e(primitive, tol
-0000e510: 290a 0a20 2020 2064 6566 2070 6f69 6e74  )..    def point
-0000e520: 5f6f 7665 725f 636f 6e74 6f75 7228 7365  _over_contour(se
-0000e530: 6c66 2c20 706f 696e 742c 2061 6273 5f74  lf, point, abs_t
-0000e540: 6f6c 3d31 652d 3629 3a0a 2020 2020 2020  ol=1e-6):.      
-0000e550: 2020 7265 7475 726e 2073 656c 662e 706f    return self.po
-0000e560: 696e 745f 6f76 6572 5f77 6972 6528 706f  int_over_wire(po
-0000e570: 696e 742c 2061 6273 5f74 6f6c 290a 0a20  int, abs_tol).. 
-0000e580: 2020 2064 6566 2067 6574 5f67 656f 5f6c     def get_geo_l
-0000e590: 696e 6573 2873 656c 662c 2074 6167 3a20  ines(self, tag: 
-0000e5a0: 696e 742c 2070 7269 6d69 7469 7665 735f  int, primitives_
-0000e5b0: 7461 6773 3a20 4c69 7374 5b69 6e74 5d29  tags: List[int])
-0000e5c0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000e5d0: 2020 2020 2020 4765 7473 2074 6865 206c        Gets the l
-0000e5e0: 696e 6573 2074 6861 7420 6465 6669 6e65  ines that define
-0000e5f0: 2061 2043 6f6e 746f 7572 2069 6e20 6120   a Contour in a 
-0000e600: 2e67 656f 2066 696c 652e 0a0a 2020 2020  .geo file...    
-0000e610: 2020 2020 3a70 6172 616d 2074 6167 3a20      :param tag: 
-0000e620: 5468 6520 636f 6e74 6f75 7220 696e 6465  The contour inde
-0000e630: 780a 2020 2020 2020 2020 3a74 7970 6520  x.        :type 
-0000e640: 7461 673a 2069 6e74 0a20 2020 2020 2020  tag: int.       
-0000e650: 203a 7061 7261 6d20 7072 696d 6974 6976   :param primitiv
-0000e660: 6573 5f74 6167 733a 2054 6865 2063 6f6e  es_tags: The con
-0000e670: 746f 7572 2720 7072 696d 6974 6976 6573  tour' primitives
-0000e680: 2069 6e64 6578 0a20 2020 2020 2020 203a   index.        :
-0000e690: 7479 7065 2070 7269 6d69 7469 7665 735f  type primitives_
-0000e6a0: 7461 6773 3a20 4c69 7374 5b69 6e74 5d0a  tags: List[int].
-0000e6b0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0000e6c0: 3a20 4120 6c69 6e65 0a20 2020 2020 2020  : A line.       
-0000e6d0: 203a 7274 7970 653a 2073 7472 0a20 2020   :rtype: str.   
-0000e6e0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0000e6f0: 2020 7265 7475 726e 2027 4c69 6e65 204c    return 'Line L
-0000e700: 6f6f 7028 2720 2b20 7374 7228 7461 6729  oop(' + str(tag)
-0000e710: 202b 2027 2920 3d20 7b27 202b 2073 7472   + ') = {' + str
-0000e720: 2870 7269 6d69 7469 7665 735f 7461 6773  (primitives_tags
-0000e730: 295b 313a 2d31 5d20 2b20 277d 3b27 0a0a  )[1:-1] + '};'..
-0000e740: 2020 2020 6465 6620 6765 745f 6765 6f5f      def get_geo_
-0000e750: 706f 696e 7473 2873 656c 6629 3a0a 2020  points(self):.  
-0000e760: 2020 2020 2020 706f 696e 7473 203d 2073        points = s
-0000e770: 6574 2829 0a20 2020 2020 2020 2066 6f72  et().        for
-0000e780: 2070 7269 6d69 7469 7665 2069 6e20 7365   primitive in se
-0000e790: 6c66 2e70 7269 6d69 7469 7665 733a 0a20  lf.primitives:. 
-0000e7a0: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-0000e7b0: 732e 7570 6461 7465 2870 7269 6d69 7469  s.update(primiti
-0000e7c0: 7665 2e67 6574 5f67 656f 5f70 6f69 6e74  ve.get_geo_point
-0000e7d0: 7328 2929 0a20 2020 2020 2020 2072 6574  s()).        ret
-0000e7e0: 7572 6e20 706f 696e 7473 0a0a 0a63 6c61  urn points...cla
-0000e7f0: 7373 2043 6f6e 746f 7572 3244 2843 6f6e  ss Contour2D(Con
-0000e800: 746f 7572 4d69 7869 6e2c 2057 6972 6532  tourMixin, Wire2
-0000e810: 4429 3a0a 2020 2020 2222 220a 2020 2020  D):.    """.    
-0000e820: 4120 636f 6c6c 6563 7469 6f6e 206f 6620  A collection of 
-0000e830: 3244 2070 7269 6d69 7469 7665 7320 666f  2D primitives fo
-0000e840: 726d 696e 6720 6120 636c 6f73 6564 2077  rming a closed w
-0000e850: 6972 6532 442e 0a0a 2020 2020 544f 444f  ire2D...    TODO
-0000e860: 203a 2063 656e 7465 725f 6f66 5f6d 6173   : center_of_mas
-0000e870: 7320 616e 6420 7365 636f 6e64 5f6d 6f6d  s and second_mom
-0000e880: 656e 745f 6172 6561 2073 686f 756c 6420  ent_area should 
-0000e890: 6265 2063 6861 6e67 6564 2061 6363 6f72  be changed accor
-0000e8a0: 6469 6e67 6c79 0a20 2020 2074 6f20 6172  dingly.    to ar
-0000e8b0: 6561 2063 6f6e 7369 6465 7269 6e67 2074  ea considering t
-0000e8c0: 6865 2074 7269 616e 676c 6520 6472 6177  he triangle draw
-0000e8d0: 6e20 6279 2074 6865 2061 7263 730a 2020  n by the arcs.  
-0000e8e0: 2020 2222 220a 2020 2020 5f6e 6f6e 5f64    """.    _non_d
-0000e8f0: 6174 615f 6861 7368 5f61 7474 7269 6275  ata_hash_attribu
-0000e900: 7465 7320 3d20 5b27 5f69 6e74 6572 6e61  tes = ['_interna
-0000e910: 6c5f 6172 6373 272c 2027 5f65 7874 6572  l_arcs', '_exter
-0000e920: 6e61 6c5f 6172 6373 272c 0a20 2020 2020  nal_arcs',.     
-0000e930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e940: 2020 2020 2020 2020 2020 2020 275f 706f              '_po
-0000e950: 6c79 676f 6e27 2c20 275f 7374 7261 6967  lygon', '_straig
-0000e960: 6874 5f6c 696e 655f 636f 6e74 6f75 725f  ht_line_contour_
-0000e970: 706f 6c79 676f 6e27 2c0a 2020 2020 2020  polygon',.      
-0000e980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e990: 2020 2020 2020 2020 2020 2027 7072 696d             'prim
-0000e9a0: 6974 6976 655f 746f 5f69 6e64 6578 272c  itive_to_index',
-0000e9b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cd10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000cd20: 2e70 7269 6d69 7469 7665 5f74 6f5f 696e  .primitive_to_in
+0000cd30: 6465 7828 6564 6765 3129 0a20 2020 2020  dex(edge1).     
+0000cd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cd50: 2020 2020 2020 2065 6467 6573 312e 6164         edges1.ad
+0000cd60: 6428 6564 6765 3129 0a20 2020 2020 2020  d(edge1).       
+0000cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cd80: 2065 7863 6570 7420 4b65 7945 7272 6f72   except KeyError
+0000cd90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000cda0: 2020 2020 2020 2020 2020 2020 2020 6564                ed
+0000cdb0: 6765 7331 2e61 6464 2865 6467 6532 290a  ges1.add(edge2).
+0000cdc0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+0000cdd0: 6c69 7374 5f70 2920 3c20 323a 0a20 2020  list_p) < 2:.   
+0000cde0: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+0000cdf0: 732e 7761 726e 2827 5468 6520 636f 6e74  s.warn('The cont
+0000ce00: 6f75 7273 2061 7265 206e 6f74 2061 646a  ours are not adj
+0000ce10: 6163 656e 7427 290a 2020 2020 2020 2020  acent').        
+0000ce20: 2020 2020 7265 7475 726e 205b 5d0a 0a20      return [].. 
+0000ce30: 2020 2020 2020 2069 6620 6c65 6e28 6c69         if len(li
+0000ce40: 7374 5f70 2920 3d3d 2032 3a0a 2020 2020  st_p) == 2:.    
+0000ce50: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+0000ce60: 6973 745f 700a 0a20 2020 2020 2020 2063  ist_p..        c
+0000ce70: 6f6e 746f 7572 7320 3d20 7365 6c66 2e5f  ontours = self._
+0000ce80: 5f63 6c61 7373 5f5f 2e63 6f6e 746f 7572  _class__.contour
+0000ce90: 735f 6672 6f6d 5f65 6467 6573 2865 6467  s_from_edges(edg
+0000cea0: 6573 3129 0a20 2020 2020 2020 2070 6f69  es1).        poi
+0000ceb0: 6e74 7320 3d20 5b5d 0a20 2020 2020 2020  nts = [].       
+0000cec0: 2066 6f72 2063 6f6e 746f 7572 5f69 2069   for contour_i i
+0000ced0: 6e20 636f 6e74 6f75 7273 3a0a 2020 2020  n contours:.    
+0000cee0: 2020 2020 2020 2020 706f 696e 7473 2e65          points.e
+0000cef0: 7874 656e 6428 636f 6e74 6f75 725f 692e  xtend(contour_i.
+0000cf00: 6578 7472 656d 6974 6965 735f 706f 696e  extremities_poin
+0000cf10: 7473 286c 6973 745f 7029 290a 0a20 2020  ts(list_p))..   
+0000cf20: 2020 2020 2072 6574 7572 6e20 706f 696e       return poin
+0000cf30: 7473 0a0a 2020 2020 6465 6620 7368 6172  ts..    def shar
+0000cf40: 6564 5f70 7269 6d69 7469 7665 735f 7769  ed_primitives_wi
+0000cf50: 7468 2873 656c 662c 2063 6f6e 746f 7572  th(self, contour
+0000cf60: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0000cf70: 2020 2020 2020 2045 7874 7261 6374 2073         Extract s
+0000cf80: 6861 7265 6420 7072 696d 6974 6976 6573  hared primitives
+0000cf90: 2062 6574 7765 656e 2074 776f 2061 646a   between two adj
+0000cfa0: 6163 656e 7420 636f 6e74 6f75 7273 2e0a  acent contours..
+0000cfb0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+0000cfc0: 2020 2020 2020 7368 6172 6564 5f70 7269        shared_pri
+0000cfd0: 6d69 7469 7665 735f 3120 3d20 5b5d 0a20  mitives_1 = []. 
+0000cfe0: 2020 2020 2020 2073 6861 7265 645f 7072         shared_pr
+0000cff0: 696d 6974 6976 6573 5f32 203d 205b 5d0a  imitives_2 = [].
+0000d000: 0a20 2020 2020 2020 2070 6f69 6e74 7320  .        points 
+0000d010: 3d20 7365 6c66 2e73 6861 7265 645f 7072  = self.shared_pr
+0000d020: 696d 6974 6976 6573 5f65 7874 7265 6d69  imitives_extremi
+0000d030: 7469 6573 2863 6f6e 746f 7572 290a 2020  ties(contour).  
+0000d040: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+0000d050: 616e 6765 2830 2c20 6c65 6e28 706f 696e  ange(0, len(poin
+0000d060: 7473 292c 2032 293a 0a20 2020 2020 2020  ts), 2):.       
+0000d070: 2020 2020 2070 6f69 6e74 312c 2070 6f69       point1, poi
+0000d080: 6e74 3220 3d20 706f 696e 7473 5b69 5d2c  nt2 = points[i],
+0000d090: 2070 6f69 6e74 735b 6920 2b20 315d 0a0a   points[i + 1]..
+0000d0a0: 2020 2020 2020 2020 2020 2020 7368 6172              shar
+0000d0b0: 6564 5f70 7269 6d69 7469 7665 735f 7072  ed_primitives_pr
+0000d0c0: 696d 203d 2073 656c 662e 6578 7472 6163  im = self.extrac
+0000d0d0: 745f 7769 7468 6f75 745f 7072 696d 6974  t_without_primit
+0000d0e0: 6976 6573 2870 6f69 6e74 312c 2070 6f69  ives(point1, poi
+0000d0f0: 6e74 322c 2046 616c 7365 290a 2020 2020  nt2, False).    
+0000d100: 2020 2020 2020 2020 6966 2061 6e79 286e          if any(n
+0000d110: 6f74 2063 6f6e 746f 7572 2e70 6f69 6e74  ot contour.point
+0000d120: 5f6f 7665 725f 636f 6e74 6f75 7228 7072  _over_contour(pr
+0000d130: 696d 2e6d 6964 646c 655f 706f 696e 7428  im.middle_point(
+0000d140: 292c 2031 652d 3429 2066 6f72 2070 7269  ), 1e-4) for pri
+0000d150: 6d20 696e 2073 6861 7265 645f 7072 696d  m in shared_prim
+0000d160: 6974 6976 6573 5f70 7269 6d29 3a0a 2020  itives_prim):.  
+0000d170: 2020 2020 2020 2020 2020 2020 2020 7368                sh
+0000d180: 6172 6564 5f70 7269 6d69 7469 7665 735f  ared_primitives_
+0000d190: 312e 6578 7465 6e64 2873 656c 662e 6578  1.extend(self.ex
+0000d1a0: 7472 6163 745f 7769 7468 6f75 745f 7072  tract_without_pr
+0000d1b0: 696d 6974 6976 6573 2870 6f69 6e74 312c  imitives(point1,
+0000d1c0: 2070 6f69 6e74 322c 2054 7275 6529 290a   point2, True)).
+0000d1d0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000d1e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000d1f0: 2020 7368 6172 6564 5f70 7269 6d69 7469    shared_primiti
+0000d200: 7665 735f 312e 6578 7465 6e64 2873 6861  ves_1.extend(sha
+0000d210: 7265 645f 7072 696d 6974 6976 6573 5f70  red_primitives_p
+0000d220: 7269 6d29 0a0a 2020 2020 2020 2020 2020  rim)..          
+0000d230: 2020 7368 6172 6564 5f70 7269 6d69 7469    shared_primiti
+0000d240: 7665 735f 7072 696d 203d 2063 6f6e 746f  ves_prim = conto
+0000d250: 7572 2e65 7874 7261 6374 5f77 6974 686f  ur.extract_witho
+0000d260: 7574 5f70 7269 6d69 7469 7665 7328 706f  ut_primitives(po
+0000d270: 696e 7431 2c20 706f 696e 7432 2c20 4661  int1, point2, Fa
+0000d280: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
+0000d290: 2069 6620 616e 7928 6e6f 7420 7365 6c66   if any(not self
+0000d2a0: 2e70 6f69 6e74 5f6f 7665 725f 636f 6e74  .point_over_cont
+0000d2b0: 6f75 7228 7072 696d 2e6d 6964 646c 655f  our(prim.middle_
+0000d2c0: 706f 696e 7428 292c 2031 652d 3429 2066  point(), 1e-4) f
+0000d2d0: 6f72 2070 7269 6d20 696e 2073 6861 7265  or prim in share
+0000d2e0: 645f 7072 696d 6974 6976 6573 5f70 7269  d_primitives_pri
+0000d2f0: 6d29 3a0a 2020 2020 2020 2020 2020 2020  m):.            
+0000d300: 2020 2020 7368 6172 6564 5f70 7269 6d69      shared_primi
+0000d310: 7469 7665 735f 322e 6578 7465 6e64 2863  tives_2.extend(c
+0000d320: 6f6e 746f 7572 2e65 7874 7261 6374 5f77  ontour.extract_w
+0000d330: 6974 686f 7574 5f70 7269 6d69 7469 7665  ithout_primitive
+0000d340: 7328 706f 696e 7431 2c20 706f 696e 7432  s(point1, point2
+0000d350: 2c20 5472 7565 2929 0a20 2020 2020 2020  , True)).       
+0000d360: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000d370: 2020 2020 2020 2020 2020 2073 6861 7265             share
+0000d380: 645f 7072 696d 6974 6976 6573 5f32 2e65  d_primitives_2.e
+0000d390: 7874 656e 6428 7368 6172 6564 5f70 7269  xtend(shared_pri
+0000d3a0: 6d69 7469 7665 735f 7072 696d 290a 0a20  mitives_prim).. 
+0000d3b0: 2020 2020 2020 2072 6574 7572 6e20 5b73         return [s
+0000d3c0: 6861 7265 645f 7072 696d 6974 6976 6573  hared_primitives
+0000d3d0: 5f31 2c20 7368 6172 6564 5f70 7269 6d69  _1, shared_primi
+0000d3e0: 7469 7665 735f 325d 0a0a 2020 2020 6465  tives_2]..    de
+0000d3f0: 6620 6d65 7267 655f 7072 696d 6974 6976  f merge_primitiv
+0000d400: 6573 5f77 6974 6828 7365 6c66 2c20 636f  es_with(self, co
+0000d410: 6e74 6f75 7229 3a0a 2020 2020 2020 2020  ntour):.        
+0000d420: 2222 220a 2020 2020 2020 2020 4578 7472  """.        Extr
+0000d430: 6163 7420 6e6f 7420 7368 6172 6564 2070  act not shared p
+0000d440: 7269 6d69 7469 7665 7320 6265 7477 6565  rimitives betwee
+0000d450: 6e20 7477 6f20 6164 6a61 6365 6e74 2063  n two adjacent c
+0000d460: 6f6e 746f 7572 732c 2074 6f20 6265 206d  ontours, to be m
+0000d470: 6572 6765 642e 0a0a 2020 2020 2020 2020  erged...        
+0000d480: 2222 220a 2020 2020 2020 2020 636f 6e74  """.        cont
+0000d490: 6f75 7231 203d 2073 656c 660a 2020 2020  our1 = self.    
+0000d4a0: 2020 2020 636f 6e74 6f75 7232 203d 2063      contour2 = c
+0000d4b0: 6f6e 746f 7572 0a20 2020 2020 2020 2070  ontour.        p
+0000d4c0: 6f69 6e74 7320 3d20 7365 6c66 2e73 6861  oints = self.sha
+0000d4d0: 7265 645f 7072 696d 6974 6976 6573 5f65  red_primitives_e
+0000d4e0: 7874 7265 6d69 7469 6573 2863 6f6e 746f  xtremities(conto
+0000d4f0: 7572 290a 2020 2020 2020 2020 706f 696e  ur).        poin
+0000d500: 7473 203d 2073 656c 662e 736f 7274 5f70  ts = self.sort_p
+0000d510: 6f69 6e74 735f 616c 6f6e 675f 7769 7265  oints_along_wire
+0000d520: 2870 6f69 6e74 7329 0a20 2020 2020 2020  (points).       
+0000d530: 206d 6572 6765 5f70 7269 6d69 7469 7665   merge_primitive
+0000d540: 7331 203d 205b 5d0a 2020 2020 2020 2020  s1 = [].        
+0000d550: 6d65 7267 655f 7072 696d 6974 6976 6573  merge_primitives
+0000d560: 3220 3d20 5b5d 0a20 2020 2020 2020 2066  2 = [].        f
+0000d570: 6f72 2070 6f69 6e74 312c 2070 6f69 6e74  or point1, point
+0000d580: 3220 696e 207a 6970 2870 6f69 6e74 735b  2 in zip(points[
+0000d590: 3a2d 315d 2c20 706f 696e 7473 5b31 3a5d  :-1], points[1:]
+0000d5a0: 293a 0a20 2020 2020 2020 2020 2020 206d  ):.            m
+0000d5b0: 6572 6765 5f70 7269 6d69 7469 7665 735f  erge_primitives_
+0000d5c0: 7072 696d 3120 3d20 636f 6e74 6f75 7231  prim1 = contour1
+0000d5d0: 2e65 7874 7261 6374 5f77 6974 686f 7574  .extract_without
+0000d5e0: 5f70 7269 6d69 7469 7665 7328 706f 696e  _primitives(poin
+0000d5f0: 7431 2c20 706f 696e 7432 2c20 4661 6c73  t1, point2, Fals
+0000d600: 6529 0a20 2020 2020 2020 2020 2020 206d  e).            m
+0000d610: 6572 6765 5f70 7269 6d69 7469 7665 735f  erge_primitives_
+0000d620: 7072 696d 3220 3d20 636f 6e74 6f75 7231  prim2 = contour1
+0000d630: 2e65 7874 7261 6374 5f77 6974 686f 7574  .extract_without
+0000d640: 5f70 7269 6d69 7469 7665 7328 706f 696e  _primitives(poin
+0000d650: 7431 2c20 706f 696e 7432 2c20 5472 7565  t1, point2, True
+0000d660: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+0000d670: 7220 7072 696d 7320 696e 205b 6d65 7267  r prims in [merg
+0000d680: 655f 7072 696d 6974 6976 6573 5f70 7269  e_primitives_pri
+0000d690: 6d31 2c20 6d65 7267 655f 7072 696d 6974  m1, merge_primit
+0000d6a0: 6976 6573 5f70 7269 6d32 5d3a 0a20 2020  ives_prim2]:.   
+0000d6b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000d6c0: 616c 6c28 636f 6e74 6f75 722e 706f 696e  all(contour.poin
+0000d6d0: 745f 6f76 6572 5f63 6f6e 746f 7572 2870  t_over_contour(p
+0000d6e0: 7269 6d2e 6d69 6464 6c65 5f70 6f69 6e74  rim.middle_point
+0000d6f0: 2829 2c20 3165 2d34 2920 666f 7220 7072  (), 1e-4) for pr
+0000d700: 696d 2069 6e20 7072 696d 7329 3a0a 2020  im in prims):.  
+0000d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d720: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
+0000d730: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0000d740: 7420 616c 6c28 6e6f 7420 636f 6e74 6f75  t all(not contou
+0000d750: 722e 706f 696e 745f 6f76 6572 5f63 6f6e  r.point_over_con
+0000d760: 746f 7572 2870 7269 6d2e 6d69 6464 6c65  tour(prim.middle
+0000d770: 5f70 6f69 6e74 2829 2c20 3165 2d34 2920  _point(), 1e-4) 
+0000d780: 666f 7220 7072 696d 2069 6e20 7072 696d  for prim in prim
+0000d790: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+0000d7a0: 2020 2020 2020 2020 636f 6e74 6f75 7231          contour1
+0000d7b0: 203d 2067 6574 6174 7472 2873 7973 2e6d   = getattr(sys.m
+0000d7c0: 6f64 756c 6573 5b5f 5f6e 616d 655f 5f5d  odules[__name__]
+0000d7d0: 2c20 2743 6f6e 746f 7572 2720 2b20 7365  , 'Contour' + se
+0000d7e0: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
+0000d7f0: 616d 655f 5f5b 2d32 3a5d 2928 7072 696d  ame__[-2:])(prim
+0000d800: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+0000d810: 2020 2065 6c69 6620 616c 6c28 6e6f 7420     elif all(not 
+0000d820: 636f 6e74 6f75 722e 706f 696e 745f 6f76  contour.point_ov
+0000d830: 6572 5f63 6f6e 746f 7572 2870 7269 6d2e  er_contour(prim.
+0000d840: 6d69 6464 6c65 5f70 6f69 6e74 2829 2c20  middle_point(), 
+0000d850: 3165 2d34 2920 666f 7220 7072 696d 2069  1e-4) for prim i
+0000d860: 6e20 7072 696d 7329 3a0a 2020 2020 2020  n prims):.      
+0000d870: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0000d880: 7267 655f 7072 696d 6974 6976 6573 312e  rge_primitives1.
+0000d890: 6578 7465 6e64 2870 7269 6d73 290a 2020  extend(prims).  
+0000d8a0: 2020 2020 2020 2020 2020 6d65 7267 655f            merge_
+0000d8b0: 7072 696d 6974 6976 6573 5f70 7269 6d33  primitives_prim3
+0000d8c0: 203d 2063 6f6e 746f 7572 322e 6578 7472   = contour2.extr
+0000d8d0: 6163 745f 7769 7468 6f75 745f 7072 696d  act_without_prim
+0000d8e0: 6974 6976 6573 2870 6f69 6e74 312c 2070  itives(point1, p
+0000d8f0: 6f69 6e74 322c 2046 616c 7365 290a 2020  oint2, False).  
+0000d900: 2020 2020 2020 2020 2020 6d65 7267 655f            merge_
+0000d910: 7072 696d 6974 6976 6573 5f70 7269 6d34  primitives_prim4
+0000d920: 203d 2063 6f6e 746f 7572 322e 6578 7472   = contour2.extr
+0000d930: 6163 745f 7769 7468 6f75 745f 7072 696d  act_without_prim
+0000d940: 6974 6976 6573 2870 6f69 6e74 312c 2070  itives(point1, p
+0000d950: 6f69 6e74 322c 2054 7275 6529 0a20 2020  oint2, True).   
+0000d960: 2020 2020 2020 2020 2066 6f72 2070 7269           for pri
+0000d970: 6d73 2069 6e20 5b6d 6572 6765 5f70 7269  ms in [merge_pri
+0000d980: 6d69 7469 7665 735f 7072 696d 332c 206d  mitives_prim3, m
+0000d990: 6572 6765 5f70 7269 6d69 7469 7665 735f  erge_primitives_
+0000d9a0: 7072 696d 345d 3a0a 2020 2020 2020 2020  prim4]:.        
+0000d9b0: 2020 2020 2020 2020 6966 2061 6c6c 2873          if all(s
+0000d9c0: 656c 662e 706f 696e 745f 6f76 6572 5f63  elf.point_over_c
+0000d9d0: 6f6e 746f 7572 2870 7269 6d2e 6d69 6464  ontour(prim.midd
+0000d9e0: 6c65 5f70 6f69 6e74 2829 2c20 3165 2d34  le_point(), 1e-4
+0000d9f0: 2920 666f 7220 7072 696d 2069 6e20 7072  ) for prim in pr
+0000da00: 696d 7329 3a0a 2020 2020 2020 2020 2020  ims):.          
+0000da10: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
+0000da20: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
+0000da30: 2020 2069 6620 6e6f 7420 616c 6c28 6e6f     if not all(no
+0000da40: 7420 7365 6c66 2e70 6f69 6e74 5f6f 7665  t self.point_ove
+0000da50: 725f 636f 6e74 6f75 7228 7072 696d 2e6d  r_contour(prim.m
+0000da60: 6964 646c 655f 706f 696e 7428 292c 2031  iddle_point(), 1
+0000da70: 652d 3429 2066 6f72 2070 7269 6d20 696e  e-4) for prim in
+0000da80: 2070 7269 6d73 293a 0a20 2020 2020 2020   prims):.       
+0000da90: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0000daa0: 746f 7572 3220 3d20 6765 7461 7474 7228  tour2 = getattr(
+0000dab0: 7379 732e 6d6f 6475 6c65 735b 5f5f 6e61  sys.modules[__na
+0000dac0: 6d65 5f5f 5d2c 2027 436f 6e74 6f75 7227  me__], 'Contour'
+0000dad0: 202b 2073 656c 662e 5f5f 636c 6173 735f   + self.__class_
+0000dae0: 5f2e 5f5f 6e61 6d65 5f5f 5b2d 323a 5d29  _.__name__[-2:])
+0000daf0: 2870 7269 6d73 290a 2020 2020 2020 2020  (prims).        
+0000db00: 2020 2020 2020 2020 656c 6966 2061 6c6c          elif all
+0000db10: 286e 6f74 2073 656c 662e 706f 696e 745f  (not self.point_
+0000db20: 6f76 6572 5f63 6f6e 746f 7572 2870 7269  over_contour(pri
+0000db30: 6d2e 6d69 6464 6c65 5f70 6f69 6e74 2829  m.middle_point()
+0000db40: 2c20 3165 2d34 2920 666f 7220 7072 696d  , 1e-4) for prim
+0000db50: 2069 6e20 7072 696d 7329 3a0a 2020 2020   in prims):.    
+0000db60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000db70: 6d65 7267 655f 7072 696d 6974 6976 6573  merge_primitives
+0000db80: 322e 6578 7465 6e64 2870 7269 6d73 290a  2.extend(prims).
+0000db90: 2020 2020 2020 2020 6d65 7267 655f 7072          merge_pr
+0000dba0: 696d 6974 6976 6573 203d 206d 6572 6765  imitives = merge
+0000dbb0: 5f70 7269 6d69 7469 7665 7331 202b 206d  _primitives1 + m
+0000dbc0: 6572 6765 5f70 7269 6d69 7469 7665 7332  erge_primitives2
+0000dbd0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000dbe0: 6d65 7267 655f 7072 696d 6974 6976 6573  merge_primitives
+0000dbf0: 0a0a 2020 2020 6465 6620 6564 6765 735f  ..    def edges_
+0000dc00: 6f72 6465 725f 7769 7468 5f61 646a 6163  order_with_adjac
+0000dc10: 656e 745f 636f 6e74 6f75 7228 7365 6c66  ent_contour(self
+0000dc20: 2c20 636f 6e74 6f75 7229 3a0a 2020 2020  , contour):.    
+0000dc30: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000dc40: 4368 6563 6b20 6966 2074 6865 2073 6861  Check if the sha
+0000dc50: 7265 6420 6564 6765 7320 6265 7477 6565  red edges betwee
+0000dc60: 6e20 7477 6f20 6164 6a61 6365 6e74 2063  n two adjacent c
+0000dc70: 6f6e 746f 7572 7320 6172 6520 7472 6176  ontours are trav
+0000dc80: 6572 7365 6420 7769 7468 2074 776f 0a20  ersed with two. 
+0000dc90: 2020 2020 2020 2064 6966 6665 7265 6e74         different
+0000dca0: 2064 6972 6563 7469 6f6e 7320 616c 6f6e   directions alon
+0000dcb0: 6720 6561 6368 2063 6f6e 746f 7572 2e0a  g each contour..
+0000dcc0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+0000dcd0: 2020 2020 2020 636f 6e74 6f75 7231 203d        contour1 =
+0000dce0: 2073 656c 660a 2020 2020 2020 2020 636f   self.        co
+0000dcf0: 6e74 6f75 7232 203d 2063 6f6e 746f 7572  ntour2 = contour
+0000dd00: 0a0a 2020 2020 2020 2020 2320 7368 6172  ..        # shar
+0000dd10: 6564 5f74 7570 6c65 203d 2063 6f6e 746f  ed_tuple = conto
+0000dd20: 7572 312e 7368 6172 6564 5f65 6467 6573  ur1.shared_edges
+0000dd30: 5f62 6574 7765 656e 3263 6f6e 746f 7572  _between2contour
+0000dd40: 7328 636f 6e74 6f75 7232 290a 2020 2020  s(contour2).    
+0000dd50: 2020 2020 7368 6172 6564 5f74 7570 6c65      shared_tuple
+0000dd60: 203d 2063 6f6e 746f 7572 312e 7368 6172   = contour1.shar
+0000dd70: 6564 5f70 7269 6d69 7469 7665 735f 7769  ed_primitives_wi
+0000dd80: 7468 2863 6f6e 746f 7572 3229 0a20 2020  th(contour2).   
+0000dd90: 2020 2020 2023 205b 7368 6172 6564 5f70       # [shared_p
+0000dda0: 7269 6d69 7469 7665 735f 312c 2073 6861  rimitives_1, sha
+0000ddb0: 7265 645f 7072 696d 6974 6976 6573 5f32  red_primitives_2
+0000ddc0: 5d20 3d20 636f 6e74 6f75 7231 2e73 6861  ] = contour1.sha
+0000ddd0: 7265 645f 7072 696d 6974 6976 6573 5f77  red_primitives_w
+0000dde0: 6974 6828 636f 6e74 6f75 7232 290a 0a20  ith(contour2).. 
+0000ddf0: 2020 2020 2020 2023 2070 315f 7374 6172         # p1_star
+0000de00: 7420 3d20 636f 6e74 6f75 7231 2e70 7269  t = contour1.pri
+0000de10: 6d69 7469 7665 735b 7368 6172 6564 5f74  mitives[shared_t
+0000de20: 7570 6c65 5b30 5d5b 305d 5d2e 7374 6172  uple[0][0]].star
+0000de30: 740a 2020 2020 2020 2020 2320 7032 5f73  t.        # p2_s
+0000de40: 7461 7274 203d 2063 6f6e 746f 7572 322e  tart = contour2.
+0000de50: 7072 696d 6974 6976 6573 5b73 6861 7265  primitives[share
+0000de60: 645f 7475 706c 655b 305d 5b31 5d5d 2e73  d_tuple[0][1]].s
+0000de70: 7461 7274 0a20 2020 2020 2020 2023 2070  tart.        # p
+0000de80: 325f 656e 6420 3d20 636f 6e74 6f75 7232  2_end = contour2
+0000de90: 2e70 7269 6d69 7469 7665 735b 7368 6172  .primitives[shar
+0000dea0: 6564 5f74 7570 6c65 5b30 5d5b 315d 5d2e  ed_tuple[0][1]].
+0000deb0: 656e 640a 0a20 2020 2020 2020 2070 315f  end..        p1_
+0000dec0: 7374 6172 7420 3d20 7368 6172 6564 5f74  start = shared_t
+0000ded0: 7570 6c65 5b30 5d5b 305d 2e73 7461 7274  uple[0][0].start
+0000dee0: 0a20 2020 2020 2020 2070 325f 7374 6172  .        p2_star
+0000def0: 7420 3d20 7368 6172 6564 5f74 7570 6c65  t = shared_tuple
+0000df00: 5b31 5d5b 2d31 5d2e 7374 6172 740a 2020  [1][-1].start.  
+0000df10: 2020 2020 2020 7032 5f65 6e64 203d 2073        p2_end = s
+0000df20: 6861 7265 645f 7475 706c 655b 315d 5b2d  hared_tuple[1][-
+0000df30: 315d 2e65 6e64 0a0a 2020 2020 2020 2020  1].end..        
+0000df40: 6966 2028 7031 5f73 7461 7274 2e70 6f69  if (p1_start.poi
+0000df50: 6e74 5f64 6973 7461 6e63 6528 7032 5f73  nt_distance(p2_s
+0000df60: 7461 7274 2929 203c 205c 0a20 2020 2020  tart)) < \.     
+0000df70: 2020 2020 2020 2020 2020 2028 7031 5f73             (p1_s
+0000df80: 7461 7274 2e70 6f69 6e74 5f64 6973 7461  tart.point_dista
+0000df90: 6e63 6528 7032 5f65 6e64 2929 3a0a 2020  nce(p2_end)):.  
+0000dfa0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000dfb0: 2046 616c 7365 0a20 2020 2020 2020 2072   False.        r
+0000dfc0: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+0000dfd0: 6465 6620 6578 7472 656d 6974 6965 735f  def extremities_
+0000dfe0: 706f 696e 7473 2873 656c 662c 206c 6973  points(self, lis
+0000dff0: 745f 7029 3a0a 2020 2020 2020 2020 2222  t_p):.        ""
+0000e000: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
+0000e010: 2065 7874 7265 6d69 7469 6573 2070 6f69   extremities poi
+0000e020: 6e74 7320 6f66 2061 206c 6973 7420 6f66  nts of a list of
+0000e030: 2070 6f69 6e74 7320 6f6e 2061 2063 6f6e   points on a con
+0000e040: 746f 7572 2e0a 0a20 2020 2020 2020 2022  tour...        "
+0000e050: 2222 0a20 2020 2020 2020 2023 2054 4f44  "".        # TOD
+0000e060: 4f3a 2072 6577 7269 7465 2074 6869 7320  O: rewrite this 
+0000e070: 6177 6675 6c6c 2063 6f64 6521 0a20 2020  awfull code!.   
+0000e080: 2020 2020 2070 6f69 6e74 7320 3d20 5b5d       points = []
+0000e090: 0a20 2020 2020 2020 2070 7269 6d69 7469  .        primiti
+0000e0a0: 7665 7320 3d20 7365 6c66 2e70 7269 6d69  ves = self.primi
+0000e0b0: 7469 7665 730a 2020 2020 2020 2020 666f  tives.        fo
+0000e0c0: 7220 6920 696e 2072 616e 6765 2830 2c20  r i in range(0, 
+0000e0d0: 6c65 6e28 7072 696d 6974 6976 6573 2929  len(primitives))
+0000e0e0: 3a0a 2020 2020 2020 2020 2020 2020 7074  :.            pt
+0000e0f0: 7320 3d20 5b5d 0a20 2020 2020 2020 2020  s = [].         
+0000e100: 2020 2066 6f72 2070 6f69 6e74 2069 6e20     for point in 
+0000e110: 6c69 7374 5f70 3a20 2023 2064 7565 2074  list_p:  # due t
+0000e120: 6f20 6572 726f 7273 0a20 2020 2020 2020  o errors.       
+0000e130: 2020 2020 2020 2020 2069 6620 7072 696d           if prim
+0000e140: 6974 6976 6573 5b69 5d2e 706f 696e 745f  itives[i].point_
+0000e150: 6265 6c6f 6e67 7328 706f 696e 7429 3a0a  belongs(point):.
+0000e160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e170: 2020 2020 7074 732e 6170 7065 6e64 2870      pts.append(p
+0000e180: 6f69 6e74 290a 2020 2020 2020 2020 2020  oint).          
+0000e190: 2020 6966 206c 656e 2870 7473 2920 3d3d    if len(pts) ==
+0000e1a0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+0000e1b0: 2020 2020 706f 696e 7473 2e61 7070 656e      points.appen
+0000e1c0: 6428 7074 735b 305d 290a 2020 2020 2020  d(pts[0]).      
+0000e1d0: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
+0000e1e0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0000e1f0: 206c 656e 2870 7473 2920 3e20 313a 0a20   len(pts) > 1:. 
+0000e200: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000e210: 6f69 6e74 732e 6170 7065 6e64 2870 7269  oints.append(pri
+0000e220: 6d69 7469 7665 735b 695d 2e73 7461 7274  mitives[i].start
+0000e230: 2e6e 6561 7265 7374 5f70 6f69 6e74 2870  .nearest_point(p
+0000e240: 7473 2929 0a20 2020 2020 2020 2020 2020  ts)).           
+0000e250: 2020 2020 2062 7265 616b 0a0a 2020 2020       break..    
+0000e260: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+0000e270: 6765 286c 656e 2870 7269 6d69 7469 7665  ge(len(primitive
+0000e280: 7329 202d 2031 2c20 2d31 2c20 2d31 293a  s) - 1, -1, -1):
+0000e290: 0a20 2020 2020 2020 2020 2020 2070 7473  .            pts
+0000e2a0: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
+0000e2b0: 2020 666f 7220 706f 696e 7420 696e 206c    for point in l
+0000e2c0: 6973 745f 703a 2020 2320 6475 6520 746f  ist_p:  # due to
+0000e2d0: 2065 7272 6f72 730a 2020 2020 2020 2020   errors.        
+0000e2e0: 2020 2020 2020 2020 6966 2070 7269 6d69          if primi
+0000e2f0: 7469 7665 735b 695d 2e70 6f69 6e74 5f62  tives[i].point_b
+0000e300: 656c 6f6e 6773 2870 6f69 6e74 293a 0a20  elongs(point):. 
+0000e310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e320: 2020 2070 7473 2e61 7070 656e 6428 706f     pts.append(po
+0000e330: 696e 7429 0a20 2020 2020 2020 2020 2020  int).           
+0000e340: 2069 6620 6c65 6e28 7074 7329 203d 3d20   if len(pts) == 
+0000e350: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+0000e360: 2020 2069 6620 7074 735b 305d 206e 6f74     if pts[0] not
+0000e370: 2069 6e20 706f 696e 7473 3a0a 2020 2020   in points:.    
+0000e380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e390: 706f 696e 7473 2e61 7070 656e 6428 7074  points.append(pt
+0000e3a0: 735b 305d 290a 2020 2020 2020 2020 2020  s[0]).          
+0000e3b0: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
+0000e3c0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0000e3d0: 206c 656e 2870 7473 2920 3e20 313a 0a20   len(pts) > 1:. 
+0000e3e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000e3f0: 6f69 6e74 203d 2070 7269 6d69 7469 7665  oint = primitive
+0000e400: 735b 695d 2e65 6e64 2e6e 6561 7265 7374  s[i].end.nearest
+0000e410: 5f70 6f69 6e74 2870 7473 290a 2020 2020  _point(pts).    
+0000e420: 2020 2020 2020 2020 2020 2020 6966 2070              if p
+0000e430: 6f69 6e74 206e 6f74 2069 6e20 706f 696e  oint not in poin
+0000e440: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
+0000e450: 2020 2020 2020 2020 706f 696e 7473 2e61          points.a
+0000e460: 7070 656e 6428 706f 696e 7429 0a20 2020  ppend(point).   
+0000e470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e480: 2062 7265 616b 0a20 2020 2020 2020 2072   break.        r
+0000e490: 6574 7572 6e20 706f 696e 7473 0a0a 2020  eturn points..  
+0000e4a0: 2020 6465 6620 7072 696d 6974 6976 655f    def primitive_
+0000e4b0: 6f76 6572 5f63 6f6e 746f 7572 2873 656c  over_contour(sel
+0000e4c0: 662c 2070 7269 6d69 7469 7665 2c20 746f  f, primitive, to
+0000e4d0: 6c3a 2066 6c6f 6174 203d 2031 652d 3629  l: float = 1e-6)
+0000e4e0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000e4f0: 2073 656c 662e 7072 696d 6974 6976 655f   self.primitive_
+0000e500: 6f76 6572 5f77 6972 6528 7072 696d 6974  over_wire(primit
+0000e510: 6976 652c 2074 6f6c 290a 0a20 2020 2064  ive, tol)..    d
+0000e520: 6566 2070 6f69 6e74 5f6f 7665 725f 636f  ef point_over_co
+0000e530: 6e74 6f75 7228 7365 6c66 2c20 706f 696e  ntour(self, poin
+0000e540: 742c 2061 6273 5f74 6f6c 3d31 652d 3629  t, abs_tol=1e-6)
+0000e550: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000e560: 2073 656c 662e 706f 696e 745f 6f76 6572   self.point_over
+0000e570: 5f77 6972 6528 706f 696e 742c 2061 6273  _wire(point, abs
+0000e580: 5f74 6f6c 290a 0a20 2020 2064 6566 2067  _tol)..    def g
+0000e590: 6574 5f67 656f 5f6c 696e 6573 2873 656c  et_geo_lines(sel
+0000e5a0: 662c 2074 6167 3a20 696e 742c 2070 7269  f, tag: int, pri
+0000e5b0: 6d69 7469 7665 735f 7461 6773 3a20 4c69  mitives_tags: Li
+0000e5c0: 7374 5b69 6e74 5d29 3a0a 2020 2020 2020  st[int]):.      
+0000e5d0: 2020 2222 220a 2020 2020 2020 2020 4765    """.        Ge
+0000e5e0: 7473 2074 6865 206c 696e 6573 2074 6861  ts the lines tha
+0000e5f0: 7420 6465 6669 6e65 2061 2043 6f6e 746f  t define a Conto
+0000e600: 7572 2069 6e20 6120 2e67 656f 2066 696c  ur in a .geo fil
+0000e610: 652e 0a0a 2020 2020 2020 2020 3a70 6172  e...        :par
+0000e620: 616d 2074 6167 3a20 5468 6520 636f 6e74  am tag: The cont
+0000e630: 6f75 7220 696e 6465 780a 2020 2020 2020  our index.      
+0000e640: 2020 3a74 7970 6520 7461 673a 2069 6e74    :type tag: int
+0000e650: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000e660: 7072 696d 6974 6976 6573 5f74 6167 733a  primitives_tags:
+0000e670: 2054 6865 2063 6f6e 746f 7572 2720 7072   The contour' pr
+0000e680: 696d 6974 6976 6573 2069 6e64 6578 0a20  imitives index. 
+0000e690: 2020 2020 2020 203a 7479 7065 2070 7269         :type pri
+0000e6a0: 6d69 7469 7665 735f 7461 6773 3a20 4c69  mitives_tags: Li
+0000e6b0: 7374 5b69 6e74 5d0a 0a20 2020 2020 2020  st[int]..       
+0000e6c0: 203a 7265 7475 726e 3a20 4120 6c69 6e65   :return: A line
+0000e6d0: 0a20 2020 2020 2020 203a 7274 7970 653a  .        :rtype:
+0000e6e0: 2073 7472 0a20 2020 2020 2020 2022 2222   str.        """
+0000e6f0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000e700: 2027 4c69 6e65 204c 6f6f 7028 2720 2b20   'Line Loop(' + 
+0000e710: 7374 7228 7461 6729 202b 2027 2920 3d20  str(tag) + ') = 
+0000e720: 7b27 202b 2073 7472 2870 7269 6d69 7469  {' + str(primiti
+0000e730: 7665 735f 7461 6773 295b 313a 2d31 5d20  ves_tags)[1:-1] 
+0000e740: 2b20 277d 3b27 0a0a 2020 2020 6465 6620  + '};'..    def 
+0000e750: 6765 745f 6765 6f5f 706f 696e 7473 2873  get_geo_points(s
+0000e760: 656c 6629 3a0a 2020 2020 2020 2020 706f  elf):.        po
+0000e770: 696e 7473 203d 2073 6574 2829 0a20 2020  ints = set().   
+0000e780: 2020 2020 2066 6f72 2070 7269 6d69 7469       for primiti
+0000e790: 7665 2069 6e20 7365 6c66 2e70 7269 6d69  ve in self.primi
+0000e7a0: 7469 7665 733a 0a20 2020 2020 2020 2020  tives:.         
+0000e7b0: 2020 2070 6f69 6e74 732e 7570 6461 7465     points.update
+0000e7c0: 2870 7269 6d69 7469 7665 2e67 6574 5f67  (primitive.get_g
+0000e7d0: 656f 5f70 6f69 6e74 7328 2929 0a20 2020  eo_points()).   
+0000e7e0: 2020 2020 2072 6574 7572 6e20 706f 696e       return poin
+0000e7f0: 7473 0a0a 0a63 6c61 7373 2043 6f6e 746f  ts...class Conto
+0000e800: 7572 3244 2843 6f6e 746f 7572 4d69 7869  ur2D(ContourMixi
+0000e810: 6e2c 2057 6972 6532 4429 3a0a 2020 2020  n, Wire2D):.    
+0000e820: 2222 220a 2020 2020 4120 636f 6c6c 6563  """.    A collec
+0000e830: 7469 6f6e 206f 6620 3244 2070 7269 6d69  tion of 2D primi
+0000e840: 7469 7665 7320 666f 726d 696e 6720 6120  tives forming a 
+0000e850: 636c 6f73 6564 2077 6972 6532 442e 0a0a  closed wire2D...
+0000e860: 2020 2020 544f 444f 203a 2063 656e 7465      TODO : cente
+0000e870: 725f 6f66 5f6d 6173 7320 616e 6420 7365  r_of_mass and se
+0000e880: 636f 6e64 5f6d 6f6d 656e 745f 6172 6561  cond_moment_area
+0000e890: 2073 686f 756c 6420 6265 2063 6861 6e67   should be chang
+0000e8a0: 6564 2061 6363 6f72 6469 6e67 6c79 0a20  ed accordingly. 
+0000e8b0: 2020 2074 6f20 6172 6561 2063 6f6e 7369     to area consi
+0000e8c0: 6465 7269 6e67 2074 6865 2074 7269 616e  dering the trian
+0000e8d0: 676c 6520 6472 6177 6e20 6279 2074 6865  gle drawn by the
+0000e8e0: 2061 7263 730a 2020 2020 2222 220a 2020   arcs.    """.  
+0000e8f0: 2020 5f6e 6f6e 5f64 6174 615f 6861 7368    _non_data_hash
+0000e900: 5f61 7474 7269 6275 7465 7320 3d20 5b27  _attributes = ['
+0000e910: 5f69 6e74 6572 6e61 6c5f 6172 6373 272c  _internal_arcs',
+0000e920: 2027 5f65 7874 6572 6e61 6c5f 6172 6373   '_external_arcs
+0000e930: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0000e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e950: 2020 2020 275f 706f 6c79 676f 6e27 2c20      '_polygon', 
+0000e960: 275f 7374 7261 6967 6874 5f6c 696e 655f  '_straight_line_
+0000e970: 636f 6e74 6f75 725f 706f 6c79 676f 6e27  contour_polygon'
+0000e980: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000e990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e9a0: 2020 2027 7072 696d 6974 6976 655f 746f     'primitive_to
+0000e9b0: 5f69 6e64 6578 272c 0a20 2020 2020 2020  _index',.       
 0000e9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e9d0: 2020 2762 6173 6973 5f70 7269 6d69 7469    'basis_primiti
-0000e9e0: 7665 7327 2c20 275f 7574 645f 616e 616c  ves', '_utd_anal
-0000e9f0: 7973 6973 275d 0a20 2020 205f 6e6f 6e5f  ysis'].    _non_
-0000ea00: 7365 7269 616c 697a 6162 6c65 5f61 7474  serializable_att
-0000ea10: 7269 6275 7465 7320 3d20 5b27 5f69 6e74  ributes = ['_int
-0000ea20: 6572 6e61 6c5f 6172 6373 272c 2027 5f65  ernal_arcs', '_e
-0000ea30: 7874 6572 6e61 6c5f 6172 6373 272c 0a20  xternal_arcs',. 
-0000ea40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e9d0: 2020 2020 2020 2020 2020 2762 6173 6973            'basis
+0000e9e0: 5f70 7269 6d69 7469 7665 7327 2c20 275f  _primitives', '_
+0000e9f0: 7574 645f 616e 616c 7973 6973 275d 0a20  utd_analysis']. 
+0000ea00: 2020 205f 6e6f 6e5f 7365 7269 616c 697a     _non_serializ
+0000ea10: 6162 6c65 5f61 7474 7269 6275 7465 7320  able_attributes 
+0000ea20: 3d20 5b27 5f69 6e74 6572 6e61 6c5f 6172  = ['_internal_ar
+0000ea30: 6373 272c 2027 5f65 7874 6572 6e61 6c5f  cs', '_external_
+0000ea40: 6172 6373 272c 0a20 2020 2020 2020 2020  arcs',.         
 0000ea50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea60: 2020 2027 5f70 6f6c 7967 6f6e 272c 0a20     '_polygon',. 
-0000ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ea60: 2020 2020 2020 2020 2020 2027 5f70 6f6c             '_pol
+0000ea70: 7967 6f6e 272c 0a20 2020 2020 2020 2020  ygon',.         
 0000ea80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea90: 2020 2027 5f73 7472 6169 6768 745f 6c69     '_straight_li
-0000eaa0: 6e65 5f63 6f6e 746f 7572 5f70 6f6c 7967  ne_contour_polyg
-0000eab0: 6f6e 272c 0a20 2020 2020 2020 2020 2020  on',.           
+0000ea90: 2020 2020 2020 2020 2020 2027 5f73 7472             '_str
+0000eaa0: 6169 6768 745f 6c69 6e65 5f63 6f6e 746f  aight_line_conto
+0000eab0: 7572 5f70 6f6c 7967 6f6e 272c 0a20 2020  ur_polygon',.   
 0000eac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ead0: 2020 2020 2020 2020 2027 7072 696d 6974           'primit
-0000eae0: 6976 655f 746f 5f69 6e64 6578 272c 0a20  ive_to_index',. 
-0000eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ead0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eae0: 2027 7072 696d 6974 6976 655f 746f 5f69   'primitive_to_i
+0000eaf0: 6e64 6578 272c 0a20 2020 2020 2020 2020  ndex',.         
 0000eb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb10: 2020 2027 6261 7369 735f 7072 696d 6974     'basis_primit
-0000eb20: 6976 6573 272c 2027 5f75 7464 5f61 6e61  ives', '_utd_ana
-0000eb30: 6c79 7369 7327 5d0a 0a20 2020 2064 6566  lysis']..    def
-0000eb40: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-0000eb50: 7072 696d 6974 6976 6573 3a20 4c69 7374  primitives: List
-0000eb60: 5b76 6f6c 6d64 6c72 2e65 6467 6573 2e45  [volmdlr.edges.E
-0000eb70: 6467 655d 2c0a 2020 2020 2020 2020 2020  dge],.          
-0000eb80: 2020 2020 2020 206e 616d 653a 2073 7472         name: str
-0000eb90: 203d 2027 2729 3a0a 2020 2020 2020 2020   = ''):.        
-0000eba0: 5769 7265 3244 2e5f 5f69 6e69 745f 5f28  Wire2D.__init__(
-0000ebb0: 7365 6c66 2c20 7072 696d 6974 6976 6573  self, primitives
-0000ebc0: 2c20 6e61 6d65 290a 2020 2020 2020 2020  , name).        
-0000ebd0: 7365 6c66 2e5f 6564 6765 5f70 6f6c 7967  self._edge_polyg
-0000ebe0: 6f6e 203d 204e 6f6e 650a 2020 2020 2020  on = None.      
-0000ebf0: 2020 7365 6c66 2e5f 706f 6c79 676f 6e5f    self._polygon_
-0000ec00: 3130 305f 706f 696e 7473 203d 204e 6f6e  100_points = Non
-0000ec10: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
-0000ec20: 6172 6561 203d 204e 6f6e 650a 0a20 2020  area = None..   
-0000ec30: 2064 6566 205f 5f68 6173 685f 5f28 7365   def __hash__(se
-0000ec40: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-0000ec50: 7572 6e20 7375 6d28 6861 7368 2865 2920  urn sum(hash(e) 
-0000ec60: 666f 7220 6520 696e 2073 656c 662e 7072  for e in self.pr
-0000ec70: 696d 6974 6976 6573 290a 0a20 2020 2064  imitives)..    d
-0000ec80: 6566 205f 5f65 715f 5f28 7365 6c66 2c20  ef __eq__(self, 
-0000ec90: 6f74 6865 725f 293a 0a20 2020 2020 2020  other_):.       
-0000eca0: 2069 6620 6f74 6865 725f 2e5f 5f63 6c61   if other_.__cla
-0000ecb0: 7373 5f5f 2e5f 5f6e 616d 655f 5f20 213d  ss__.__name__ !=
-0000ecc0: 2073 656c 662e 5f5f 636c 6173 735f 5f2e   self.__class__.
-0000ecd0: 5f5f 6e61 6d65 5f5f 3a0a 2020 2020 2020  __name__:.      
-0000ece0: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
-0000ecf0: 7365 0a20 2020 2020 2020 2069 6620 6c65  se.        if le
-0000ed00: 6e28 7365 6c66 2e70 7269 6d69 7469 7665  n(self.primitive
-0000ed10: 7329 2021 3d20 6c65 6e28 6f74 6865 725f  s) != len(other_
-0000ed20: 2e70 7269 6d69 7469 7665 7329 3a0a 2020  .primitives):.  
-0000ed30: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000ed40: 2046 616c 7365 0a20 2020 2020 2020 2069   False.        i
-0000ed50: 6620 7365 6c66 2e6c 656e 6774 6828 2920  f self.length() 
-0000ed60: 213d 206f 7468 6572 5f2e 6c65 6e67 7468  != other_.length
-0000ed70: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0000ed80: 7265 7475 726e 2046 616c 7365 0a20 2020  return False.   
-0000ed90: 2020 2020 2065 7175 616c 203d 2030 0a20       equal = 0. 
-0000eda0: 2020 2020 2020 2066 6f72 2070 7269 6d31         for prim1
-0000edb0: 2069 6e20 7365 6c66 2e70 7269 6d69 7469   in self.primiti
-0000edc0: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
-0000edd0: 2072 6576 6572 7365 3120 3d20 7072 696d   reverse1 = prim
-0000ede0: 312e 7265 7665 7273 6528 290a 2020 2020  1.reverse().    
-0000edf0: 2020 2020 2020 2020 666f 756e 6420 3d20          found = 
-0000ee00: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-0000ee10: 2020 666f 7220 7072 696d 3220 696e 206f    for prim2 in o
-0000ee20: 7468 6572 5f2e 7072 696d 6974 6976 6573  ther_.primitives
-0000ee30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000ee40: 2020 7265 7665 7273 6532 203d 2070 7269    reverse2 = pri
-0000ee50: 6d32 2e72 6576 6572 7365 2829 0a20 2020  m2.reverse().   
-0000ee60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000ee70: 2870 7269 6d31 203d 3d20 7072 696d 3220  (prim1 == prim2 
-0000ee80: 6f72 2072 6576 6572 7365 3120 3d3d 2070  or reverse1 == p
-0000ee90: 7269 6d32 0a20 2020 2020 2020 2020 2020  rim2.           
-0000eea0: 2020 2020 2020 2020 2020 2020 206f 7220               or 
-0000eeb0: 7265 7665 7273 6532 203d 3d20 7072 696d  reverse2 == prim
-0000eec0: 3120 6f72 2072 6576 6572 7365 3120 3d3d  1 or reverse1 ==
-0000eed0: 2072 6576 6572 7365 3229 3a0a 2020 2020   reverse2):.    
-0000eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eef0: 6571 7561 6c20 2b3d 2031 0a20 2020 2020  equal += 1.     
-0000ef00: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000ef10: 6f75 6e64 203d 2054 7275 650a 2020 2020  ound = True.    
-0000ef20: 2020 2020 2020 2020 6966 206e 6f74 2066          if not f
-0000ef30: 6f75 6e64 3a0a 2020 2020 2020 2020 2020  ound:.          
-0000ef40: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
-0000ef50: 7365 0a20 2020 2020 2020 2069 6620 6571  se.        if eq
-0000ef60: 7561 6c20 3d3d 206c 656e 2873 656c 662e  ual == len(self.
-0000ef70: 7072 696d 6974 6976 6573 293a 0a20 2020  primitives):.   
-0000ef80: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000ef90: 5472 7565 0a20 2020 2020 2020 2072 6574  True.        ret
-0000efa0: 7572 6e20 4661 6c73 650a 0a20 2020 2040  urn False..    @
-0000efb0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0000efc0: 2065 6467 655f 706f 6c79 676f 6e28 7365   edge_polygon(se
-0000efd0: 6c66 293a 0a20 2020 2020 2020 2069 6620  lf):.        if 
-0000efe0: 7365 6c66 2e5f 6564 6765 5f70 6f6c 7967  self._edge_polyg
-0000eff0: 6f6e 2069 7320 4e6f 6e65 3a0a 2020 2020  on is None:.    
-0000f000: 2020 2020 2020 2020 7365 6c66 2e5f 6564          self._ed
-0000f010: 6765 5f70 6f6c 7967 6f6e 203d 2073 656c  ge_polygon = sel
-0000f020: 662e 5f67 6574 5f65 6467 655f 706f 6c79  f._get_edge_poly
-0000f030: 676f 6e28 290a 2020 2020 2020 2020 7265  gon().        re
-0000f040: 7475 726e 2073 656c 662e 5f65 6467 655f  turn self._edge_
-0000f050: 706f 6c79 676f 6e0a 0a20 2020 2064 6566  polygon..    def
-0000f060: 205f 6765 745f 6564 6765 5f70 6f6c 7967   _get_edge_polyg
-0000f070: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
-0000f080: 2020 706f 696e 7473 203d 205b 5d0a 2020    points = [].  
-0000f090: 2020 2020 2020 666f 7220 6564 6765 2069        for edge i
-0000f0a0: 6e20 7365 6c66 2e70 7269 6d69 7469 7665  n self.primitive
-0000f0b0: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
-0000f0c0: 6620 706f 696e 7473 3a0a 2020 2020 2020  f points:.      
-0000f0d0: 2020 2020 2020 2020 2020 6966 2065 6467            if edg
-0000f0e0: 652e 7374 6172 7420 213d 2070 6f69 6e74  e.start != point
-0000f0f0: 735b 2d31 5d3a 0a20 2020 2020 2020 2020  s[-1]:.         
-0000f100: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-0000f110: 732e 6170 7065 6e64 2865 6467 652e 7374  s.append(edge.st
-0000f120: 6172 7429 0a20 2020 2020 2020 2020 2020  art).           
-0000f130: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000f140: 2020 2020 2020 2070 6f69 6e74 732e 6170         points.ap
-0000f150: 7065 6e64 2865 6467 652e 7374 6172 7429  pend(edge.start)
-0000f160: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000f170: 436c 6f73 6564 506f 6c79 676f 6e32 4428  ClosedPolygon2D(
-0000f180: 706f 696e 7473 290a 0a20 2020 2064 6566  points)..    def
-0000f190: 2074 6f5f 3364 2873 656c 662c 2070 6c61   to_3d(self, pla
-0000f1a0: 6e65 5f6f 7269 6769 6e2c 2078 2c20 7929  ne_origin, x, y)
-0000f1b0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000f1c0: 2020 2020 2020 5472 616e 7366 6f72 6d73        Transforms
-0000f1d0: 2061 2043 6f6e 746f 7572 3244 2069 6e74   a Contour2D int
-0000f1e0: 6f20 616e 2043 6f6e 746f 7572 3344 2c20  o an Contour3D, 
-0000f1f0: 6769 7665 6e20 6120 706c 616e 6520 6f72  given a plane or
-0000f200: 6967 696e 2061 6e64 2061 6e20 7520 616e  igin and an u an
-0000f210: 6420 7620 706c 616e 6520 7665 6374 6f72  d v plane vector
-0000f220: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0000f230: 6d20 706c 616e 655f 6f72 6967 696e 3a20  m plane_origin: 
-0000f240: 706c 616e 6520 6f72 6967 696e 2e0a 2020  plane origin..  
-0000f250: 2020 2020 2020 3a70 6172 616d 2078 3a20        :param x: 
-0000f260: 706c 616e 6520 7520 7665 6374 6f72 2e0a  plane u vector..
-0000f270: 2020 2020 2020 2020 3a70 6172 616d 2079          :param y
-0000f280: 3a20 706c 616e 6520 7620 7665 6374 6f72  : plane v vector
-0000f290: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-0000f2a0: 6e3a 2043 6f6e 746f 7572 3344 2e0a 2020  n: Contour3D..  
-0000f2b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000f2c0: 2020 7033 6420 3d20 5b5d 0a20 2020 2020    p3d = [].     
-0000f2d0: 2020 2066 6f72 2065 6467 6520 696e 2073     for edge in s
-0000f2e0: 656c 662e 7072 696d 6974 6976 6573 3a0a  elf.primitives:.
-0000f2f0: 2020 2020 2020 2020 2020 2020 7033 642e              p3d.
-0000f300: 6170 7065 6e64 2865 6467 652e 746f 5f33  append(edge.to_3
-0000f310: 6428 706c 616e 655f 6f72 6967 696e 2c20  d(plane_origin, 
-0000f320: 782c 2079 2929 0a0a 2020 2020 2020 2020  x, y))..        
-0000f330: 7265 7475 726e 2043 6f6e 746f 7572 3344  return Contour3D
-0000f340: 2870 3364 290a 0a20 2020 2064 6566 2070  (p3d)..    def p
-0000f350: 6f69 6e74 5f62 656c 6f6e 6773 2873 656c  oint_belongs(sel
-0000f360: 662c 2070 6f69 6e74 2c20 696e 636c 7564  f, point, includ
-0000f370: 655f 6564 6765 5f70 6f69 6e74 733a 2062  e_edge_points: b
-0000f380: 6f6f 6c20 3d20 4661 6c73 6529 3a0a 2020  ool = False):.  
-0000f390: 2020 2020 2020 2320 544f 444f 3a20 5468        # TODO: Th
-0000f3a0: 6973 2069 7320 696e 636f 6d70 6c65 7465  is is incomplete
-0000f3b0: 2121 210a 2020 2020 2020 2020 785f 6d69  !!!.        x_mi
-0000f3c0: 6e2c 2078 5f6d 6178 2c20 795f 6d69 6e2c  n, x_max, y_min,
-0000f3d0: 2079 5f6d 6178 203d 2073 656c 662e 626f   y_max = self.bo
-0000f3e0: 756e 6469 6e67 5f72 6563 7461 6e67 6c65  unding_rectangle
-0000f3f0: 0a20 2020 2020 2020 2069 6620 706f 696e  .        if poin
-0000f400: 742e 7820 3c20 785f 6d69 6e20 6f72 2070  t.x < x_min or p
-0000f410: 6f69 6e74 2e78 203e 2078 5f6d 6178 206f  oint.x > x_max o
-0000f420: 7220 706f 696e 742e 7920 3c20 795f 6d69  r point.y < y_mi
-0000f430: 6e20 6f72 2070 6f69 6e74 2e79 203e 2079  n or point.y > y
-0000f440: 5f6d 6178 3a0a 2020 2020 2020 2020 2020  _max:.          
-0000f450: 2020 7265 7475 726e 2046 616c 7365 0a20    return False. 
-0000f460: 2020 2020 2020 2023 2069 6620 7365 6c66         # if self
-0000f470: 2e65 6467 655f 706f 6c79 676f 6e2e 706f  .edge_polygon.po
-0000f480: 696e 745f 6265 6c6f 6e67 7328 706f 696e  int_belongs(poin
-0000f490: 7429 3a0a 2020 2020 2020 2020 2320 2020  t):.        #   
-0000f4a0: 2020 7265 7475 726e 2054 7275 650a 2020    return True.  
-0000f4b0: 2020 2020 2020 2320 666f 7220 6564 6765        # for edge
-0000f4c0: 2069 6e20 7365 6c66 2e70 7269 6d69 7469   in self.primiti
-0000f4d0: 7665 733a 0a20 2020 2020 2020 2023 2020  ves:.        #  
-0000f4e0: 2020 2069 6620 6861 7361 7474 7228 6564     if hasattr(ed
-0000f4f0: 6765 2c20 2773 7472 6169 6768 745f 6c69  ge, 'straight_li
-0000f500: 6e65 5f70 6f69 6e74 5f62 656c 6f6e 6773  ne_point_belongs
-0000f510: 2729 3a0a 2020 2020 2020 2020 2320 2020  '):.        #   
-0000f520: 2020 2020 2020 6966 2065 6467 652e 7374        if edge.st
-0000f530: 7261 6967 6874 5f6c 696e 655f 706f 696e  raight_line_poin
-0000f540: 745f 6265 6c6f 6e67 7328 706f 696e 7429  t_belongs(point)
-0000f550: 3a0a 2020 2020 2020 2020 2320 2020 2020  :.        #     
-0000f560: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-0000f570: 7275 650a 2020 2020 2020 2020 2320 2020  rue.        #   
-0000f580: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-0000f590: 6627 7b65 6467 652e 5f5f 636c 6173 735f  f'{edge.__class_
-0000f5a0: 5f2e 5f5f 6e61 6d65 5f5f 7d20 646f 6573  _.__name__} does
-0000f5b0: 206e 6f74 2069 6d70 6c65 6d65 6e74 2073   not implement s
-0000f5c0: 7472 6169 6768 745f 6c69 6e65 5f70 6f69  traight_line_poi
-0000f5d0: 6e74 5f62 656c 6f6e 6773 2079 6574 2729  nt_belongs yet')
-0000f5e0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0000f5f0: 7365 6c66 2e5f 706f 6c79 676f 6e5f 3130  self._polygon_10
-0000f600: 305f 706f 696e 7473 3a0a 2020 2020 2020  0_points:.      
-0000f610: 2020 2020 2020 7365 6c66 2e5f 706f 6c79        self._poly
-0000f620: 676f 6e5f 3130 305f 706f 696e 7473 203d  gon_100_points =
-0000f630: 2073 656c 662e 746f 5f70 6f6c 7967 6f6e   self.to_polygon
-0000f640: 2831 3030 290a 2020 2020 2020 2020 6966  (100).        if
-0000f650: 2073 656c 662e 5f70 6f6c 7967 6f6e 5f31   self._polygon_1
-0000f660: 3030 5f70 6f69 6e74 732e 706f 696e 745f  00_points.point_
-0000f670: 6265 6c6f 6e67 7328 706f 696e 7429 3a0a  belongs(point):.
-0000f680: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000f690: 726e 2054 7275 650a 2020 2020 2020 2020  rn True.        
-0000f6a0: 7265 7475 726e 2046 616c 7365 0a0a 2020  return False..  
-0000f6b0: 2020 6465 6620 6d69 6464 6c65 5f70 6f69    def middle_poi
-0000f6c0: 6e74 2873 656c 6629 3a0a 2020 2020 2020  nt(self):.      
-0000f6d0: 2020 7265 7475 726e 2073 656c 662e 706f    return self.po
-0000f6e0: 696e 745f 6174 5f61 6273 6369 7373 6128  int_at_abscissa(
-0000f6f0: 7365 6c66 2e6c 656e 6774 6828 2920 2f20  self.length() / 
-0000f700: 3229 0a0a 2020 2020 6465 6620 706f 696e  2)..    def poin
-0000f710: 745f 6469 7374 616e 6365 2873 656c 662c  t_distance(self,
-0000f720: 2070 6f69 6e74 293a 0a20 2020 2020 2020   point):.       
-0000f730: 206d 696e 5f64 6973 7461 6e63 6520 3d20   min_distance = 
-0000f740: 7365 6c66 2e70 7269 6d69 7469 7665 735b  self.primitives[
-0000f750: 305d 2e70 6f69 6e74 5f64 6973 7461 6e63  0].point_distanc
-0000f760: 6528 706f 696e 7429 0a20 2020 2020 2020  e(point).       
-0000f770: 2066 6f72 2070 7269 6d69 7469 7665 2069   for primitive i
-0000f780: 6e20 7365 6c66 2e70 7269 6d69 7469 7665  n self.primitive
-0000f790: 735b 313a 5d3a 0a20 2020 2020 2020 2020  s[1:]:.         
-0000f7a0: 2020 2064 6973 7461 6e63 6520 3d20 7072     distance = pr
-0000f7b0: 696d 6974 6976 652e 706f 696e 745f 6469  imitive.point_di
-0000f7c0: 7374 616e 6365 2870 6f69 6e74 290a 2020  stance(point).  
-0000f7d0: 2020 2020 2020 2020 2020 6966 2064 6973            if dis
-0000f7e0: 7461 6e63 6520 3c20 6d69 6e5f 6469 7374  tance < min_dist
-0000f7f0: 616e 6365 3a0a 2020 2020 2020 2020 2020  ance:.          
-0000f800: 2020 2020 2020 6d69 6e5f 6469 7374 616e        min_distan
-0000f810: 6365 203d 2064 6973 7461 6e63 650a 2020  ce = distance.  
-0000f820: 2020 2020 2020 7265 7475 726e 206d 696e        return min
-0000f830: 5f64 6973 7461 6e63 650a 0a20 2020 2064  _distance..    d
-0000f840: 6566 2062 6f75 6e64 696e 675f 706f 696e  ef bounding_poin
-0000f850: 7473 2873 656c 6629 3a0a 2020 2020 2020  ts(self):.      
-0000f860: 2020 706f 696e 7473 203d 2073 656c 662e    points = self.
-0000f870: 6564 6765 5f70 6f6c 7967 6f6e 2e70 6f69  edge_polygon.poi
-0000f880: 6e74 735b 3a5d 0a20 2020 2020 2020 2066  nts[:].        f
-0000f890: 6f72 2070 7269 6d69 7469 7665 2069 6e20  or primitive in 
-0000f8a0: 7365 6c66 2e70 7269 6d69 7469 7665 733a  self.primitives:
-0000f8b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000f8c0: 6861 7361 7474 7228 7072 696d 6974 6976  hasattr(primitiv
-0000f8d0: 652c 2027 6469 7363 7265 7469 7a61 7469  e, 'discretizati
-0000f8e0: 6f6e 5f70 6f69 6e74 7327 293a 0a20 2020  on_points'):.   
-0000f8f0: 2020 2020 2020 2020 2020 2020 2070 6f69               poi
-0000f900: 6e74 732e 6578 7465 6e64 2870 7269 6d69  nts.extend(primi
-0000f910: 7469 7665 2e64 6973 6372 6574 697a 6174  tive.discretizat
-0000f920: 696f 6e5f 706f 696e 7473 286e 756d 6265  ion_points(numbe
-0000f930: 725f 706f 696e 7473 3d31 3029 290a 2020  r_points=10)).  
-0000f940: 2020 2020 2020 785f 6d69 6e20 3d20 6d69        x_min = mi
-0000f950: 6e28 705b 305d 2066 6f72 2070 2069 6e20  n(p[0] for p in 
-0000f960: 706f 696e 7473 290a 2020 2020 2020 2020  points).        
-0000f970: 785f 6d61 7820 3d20 6d61 7828 705b 305d  x_max = max(p[0]
-0000f980: 2066 6f72 2070 2069 6e20 706f 696e 7473   for p in points
-0000f990: 290a 2020 2020 2020 2020 795f 6d69 6e20  ).        y_min 
-0000f9a0: 3d20 6d69 6e28 705b 315d 2066 6f72 2070  = min(p[1] for p
-0000f9b0: 2069 6e20 706f 696e 7473 290a 2020 2020   in points).    
-0000f9c0: 2020 2020 795f 6d61 7820 3d20 6d61 7828      y_max = max(
-0000f9d0: 705b 315d 2066 6f72 2070 2069 6e20 706f  p[1] for p in po
-0000f9e0: 696e 7473 290a 2020 2020 2020 2020 7265  ints).        re
-0000f9f0: 7475 726e 2028 766f 6c6d 646c 722e 506f  turn (volmdlr.Po
-0000fa00: 696e 7432 4428 785f 6d69 6e2c 2079 5f6d  int2D(x_min, y_m
-0000fa10: 696e 292c 2076 6f6c 6d64 6c72 2e50 6f69  in), volmdlr.Poi
-0000fa20: 6e74 3244 2878 5f6d 6178 2c20 795f 6d61  nt2D(x_max, y_ma
-0000fa30: 7829 290a 0a20 2020 2064 6566 2061 7265  x))..    def are
-0000fa40: 6128 7365 6c66 293a 0a20 2020 2020 2020  a(self):.       
-0000fa50: 2069 6620 6e6f 7420 7365 6c66 2e5f 6172   if not self._ar
-0000fa60: 6561 3a0a 2020 2020 2020 2020 2020 2020  ea:.            
-0000fa70: 6172 6561 203d 2073 656c 662e 6564 6765  area = self.edge
-0000fa80: 5f70 6f6c 7967 6f6e 2e61 7265 6128 290a  _polygon.area().
-0000fa90: 2020 2020 2020 2020 2020 2020 636c 6173              clas
-0000faa0: 7365 7320 3d20 7b70 7269 6d2e 5f5f 636c  ses = {prim.__cl
-0000fab0: 6173 735f 5f20 666f 7220 7072 696d 2069  ass__ for prim i
-0000fac0: 6e20 7365 6c66 2e70 7269 6d69 7469 7665  n self.primitive
-0000fad0: 737d 0a20 2020 2020 2020 2020 2020 2076  s}.            v
-0000fae0: 6572 6966 795f 636c 6173 7365 7320 3d20  erify_classes = 
-0000faf0: 636c 6173 7365 732e 6973 7375 6273 6574  classes.issubset
-0000fb00: 287b 766f 6c6d 646c 722e 6564 6765 732e  ({volmdlr.edges.
-0000fb10: 4c69 6e65 5365 676d 656e 7432 442c 2076  LineSegment2D, v
-0000fb20: 6f6c 6d64 6c72 2e65 6467 6573 2e41 7263  olmdlr.edges.Arc
-0000fb30: 3244 7d29 0a20 2020 2020 2020 2020 2020  2D}).           
-0000fb40: 2069 6620 7665 7269 6679 5f63 6c61 7373   if verify_class
-0000fb50: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-0000fb60: 2020 2020 6966 2073 656c 662e 6564 6765      if self.edge
-0000fb70: 5f70 6f6c 7967 6f6e 2e69 735f 7472 6967  _polygon.is_trig
-0000fb80: 6f3a 0a20 2020 2020 2020 2020 2020 2020  o:.             
-0000fb90: 2020 2020 2020 2074 7269 676f 203d 2031         trigo = 1
-0000fba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fbb0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000fbc0: 2020 2020 2020 2020 2020 2074 7269 676f             trigo
-0000fbd0: 203d 202d 310a 2020 2020 2020 2020 2020   = -1.          
-0000fbe0: 2020 2020 2020 666f 7220 6564 6765 2069        for edge i
-0000fbf0: 6e20 7365 6c66 2e70 7269 6d69 7469 7665  n self.primitive
-0000fc00: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-0000fc10: 2020 2020 2020 2061 7265 6120 2b3d 2074         area += t
-0000fc20: 7269 676f 202a 2065 6467 652e 7374 7261  rigo * edge.stra
-0000fc30: 6967 6874 5f6c 696e 655f 6172 6561 2829  ight_line_area()
-0000fc40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fc50: 2020 2020 2073 656c 662e 5f61 7265 6120       self._area 
-0000fc60: 3d20 6162 7328 6172 6561 290a 2020 2020  = abs(area).    
-0000fc70: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000fc80: 2020 2020 2020 2020 2020 2020 2020 706f                po
-0000fc90: 6c79 676f 6e20 3d20 7365 6c66 2e74 6f5f  lygon = self.to_
-0000fca0: 706f 6c79 676f 6e28 616e 676c 655f 7265  polygon(angle_re
-0000fcb0: 736f 6c75 7469 6f6e 3d35 3029 0a20 2020  solution=50).   
-0000fcc0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000fcd0: 662e 5f61 7265 6120 3d20 706f 6c79 676f  f._area = polygo
-0000fce0: 6e2e 7472 6961 6e67 756c 6174 696f 6e28  n.triangulation(
-0000fcf0: 292e 6172 6561 2829 0a20 2020 2020 2020  ).area().       
-0000fd00: 2072 6574 7572 6e20 7365 6c66 2e5f 6172   return self._ar
-0000fd10: 6561 0a0a 2020 2020 6465 6620 6365 6e74  ea..    def cent
-0000fd20: 6572 5f6f 665f 6d61 7373 2873 656c 6629  er_of_mass(self)
-0000fd30: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000fd40: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
-0000fd50: 2074 6865 2063 656e 7465 7220 6f66 206d   the center of m
-0000fd60: 6173 7320 6f66 2074 6865 2043 6f6e 746f  ass of the Conto
-0000fd70: 7572 3244 2e0a 0a20 2020 2020 2020 203a  ur2D...        :
-0000fd80: 7265 7475 726e 3a20 436f 6e74 6f75 7227  return: Contour'
-0000fd90: 7320 6365 6e74 6572 206f 6620 6d61 7373  s center of mass
-0000fda0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000fdb0: 2020 2020 2020 6365 6e74 6572 203d 2073        center = s
-0000fdc0: 656c 662e 6564 6765 5f70 6f6c 7967 6f6e  elf.edge_polygon
-0000fdd0: 2e61 7265 6128 2920 2a20 7365 6c66 2e65  .area() * self.e
-0000fde0: 6467 655f 706f 6c79 676f 6e2e 6365 6e74  dge_polygon.cent
-0000fdf0: 6572 5f6f 665f 6d61 7373 2829 0a20 2020  er_of_mass().   
-0000fe00: 2020 2020 2023 2061 7820 3d20 7365 6c66       # ax = self
-0000fe10: 2e70 6c6f 7428 290a 2020 2020 2020 2020  .plot().        
-0000fe20: 2320 7365 6c66 2e65 6467 655f 706f 6c79  # self.edge_poly
-0000fe30: 676f 6e2e 6365 6e74 6572 5f6f 665f 6d61  gon.center_of_ma
-0000fe40: 7373 2829 2e70 6c6f 7428 6178 3d61 782c  ss().plot(ax=ax,
-0000fe50: 2063 6f6c 6f72 3d27 6227 290a 2020 2020   color='b').    
-0000fe60: 2020 2020 6966 2073 656c 662e 6564 6765      if self.edge
-0000fe70: 5f70 6f6c 7967 6f6e 2e69 735f 7472 6967  _polygon.is_trig
-0000fe80: 6f3a 0a20 2020 2020 2020 2020 2020 2074  o:.            t
-0000fe90: 7269 676f 203d 2031 0a20 2020 2020 2020  rigo = 1.       
-0000fea0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000feb0: 2020 2074 7269 676f 203d 202d 310a 2020     trigo = -1.  
-0000fec0: 2020 2020 2020 666f 7220 6564 6765 2069        for edge i
-0000fed0: 6e20 7365 6c66 2e70 7269 6d69 7469 7665  n self.primitive
-0000fee0: 733a 0a20 2020 2020 2020 2020 2020 2023  s:.            #
-0000fef0: 2065 6467 652e 7374 7261 6967 6874 5f6c   edge.straight_l
-0000ff00: 696e 655f 6365 6e74 6572 5f6f 665f 6d61  ine_center_of_ma
-0000ff10: 7373 2829 2e70 6c6f 7428 6178 3d61 782c  ss().plot(ax=ax,
-0000ff20: 2063 6f6c 6f72 3d27 6727 290a 2020 2020   color='g').    
-0000ff30: 2020 2020 2020 2020 6365 6e74 6572 202b          center +
-0000ff40: 3d20 7472 6967 6f20 2a20 6564 6765 2e73  = trigo * edge.s
-0000ff50: 7472 6169 6768 745f 6c69 6e65 5f61 7265  traight_line_are
-0000ff60: 6128 2920 5c0a 2020 2020 2020 2020 2020  a() \.          
-0000ff70: 2020 2020 2020 2020 2020 2020 2a20 6564              * ed
-0000ff80: 6765 2e73 7472 6169 6768 745f 6c69 6e65  ge.straight_line
-0000ff90: 5f63 656e 7465 725f 6f66 5f6d 6173 7328  _center_of_mass(
-0000ffa0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-0000ffb0: 6e20 6365 6e74 6572 202f 2073 656c 662e  n center / self.
-0000ffc0: 6172 6561 2829 0a0a 2020 2020 6465 6620  area()..    def 
-0000ffd0: 7365 636f 6e64 5f6d 6f6d 656e 745f 6172  second_moment_ar
-0000ffe0: 6561 2873 656c 662c 2070 6f69 6e74 293a  ea(self, point):
-0000fff0: 0a0a 2020 2020 2020 2020 4978 2c20 4979  ..        Ix, Iy
-00010000: 2c20 4978 7920 3d20 7365 6c66 2e65 6467  , Ixy = self.edg
-00010010: 655f 706f 6c79 676f 6e2e 7365 636f 6e64  e_polygon.second
-00010020: 5f6d 6f6d 656e 745f 6172 6561 2870 6f69  _moment_area(poi
-00010030: 6e74 290a 2020 2020 2020 2020 666f 7220  nt).        for 
-00010040: 6564 6765 2069 6e20 7365 6c66 2e70 7269  edge in self.pri
-00010050: 6d69 7469 7665 733a 0a20 2020 2020 2020  mitives:.       
-00010060: 2020 2020 2049 785f 652c 2049 795f 652c       Ix_e, Iy_e,
-00010070: 2049 7879 5f65 203d 2065 6467 652e 7374   Ixy_e = edge.st
-00010080: 7261 6967 6874 5f6c 696e 655f 7365 636f  raight_line_seco
-00010090: 6e64 5f6d 6f6d 656e 745f 6172 6561 2870  nd_moment_area(p
-000100a0: 6f69 6e74 290a 2020 2020 2020 2020 2020  oint).          
-000100b0: 2020 6966 2073 656c 662e 6564 6765 5f70    if self.edge_p
-000100c0: 6f6c 7967 6f6e 2e69 735f 7472 6967 6f3a  olygon.is_trigo:
-000100d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000100e0: 2049 7820 2b3d 2049 785f 650a 2020 2020   Ix += Ix_e.    
-000100f0: 2020 2020 2020 2020 2020 2020 4979 202b              Iy +
-00010100: 3d20 4979 5f65 0a20 2020 2020 2020 2020  = Iy_e.         
-00010110: 2020 2020 2020 2049 7879 202b 3d20 4978         Ixy += Ix
-00010120: 795f 650a 2020 2020 2020 2020 2020 2020  y_e.            
-00010130: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00010140: 2020 2020 2020 4978 202d 3d20 4978 5f65        Ix -= Ix_e
-00010150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010160: 2049 7920 2d3d 2049 795f 650a 2020 2020   Iy -= Iy_e.    
-00010170: 2020 2020 2020 2020 2020 2020 4978 7920              Ixy 
-00010180: 2d3d 2049 7879 5f65 0a0a 2020 2020 2020  -= Ixy_e..      
-00010190: 2020 7265 7475 726e 2049 782c 2049 792c    return Ix, Iy,
-000101a0: 2049 7879 0a0a 2020 2020 6465 6620 706c   Ixy..    def pl
-000101b0: 6f74 5f64 6174 6128 7365 6c66 2c20 6564  ot_data(self, ed
-000101c0: 6765 5f73 7479 6c65 3a20 706c 6f74 5f64  ge_style: plot_d
-000101d0: 6174 612e 4564 6765 5374 796c 6520 3d20  ata.EdgeStyle = 
-000101e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-000101f0: 2020 2020 2020 2020 7375 7266 6163 655f          surface_
-00010200: 7374 796c 653a 2070 6c6f 745f 6461 7461  style: plot_data
-00010210: 2e53 7572 6661 6365 5374 796c 6520 3d20  .SurfaceStyle = 
-00010220: 4e6f 6e65 293a 0a20 2020 2020 2020 2070  None):.        p
-00010230: 6c6f 745f 6461 7461 5f70 7269 6d69 7469  lot_data_primiti
-00010240: 7665 7320 3d20 5b69 7465 6d2e 706c 6f74  ves = [item.plot
-00010250: 5f64 6174 6128 2920 666f 7220 6974 656d  _data() for item
-00010260: 2069 6e20 7365 6c66 2e70 7269 6d69 7469   in self.primiti
-00010270: 7665 735d 0a20 2020 2020 2020 2072 6574  ves].        ret
-00010280: 7572 6e20 706c 6f74 5f64 6174 612e 436f  urn plot_data.Co
-00010290: 6e74 6f75 7232 4428 706c 6f74 5f64 6174  ntour2D(plot_dat
-000102a0: 615f 7072 696d 6974 6976 6573 3d70 6c6f  a_primitives=plo
-000102b0: 745f 6461 7461 5f70 7269 6d69 7469 7665  t_data_primitive
-000102c0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0000eb10: 2020 2020 2020 2020 2020 2027 6261 7369             'basi
+0000eb20: 735f 7072 696d 6974 6976 6573 272c 2027  s_primitives', '
+0000eb30: 5f75 7464 5f61 6e61 6c79 7369 7327 5d0a  _utd_analysis'].
+0000eb40: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+0000eb50: 5f28 7365 6c66 2c20 7072 696d 6974 6976  _(self, primitiv
+0000eb60: 6573 3a20 4c69 7374 5b76 6f6c 6d64 6c72  es: List[volmdlr
+0000eb70: 2e65 6467 6573 2e45 6467 655d 2c0a 2020  .edges.Edge],.  
+0000eb80: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000eb90: 616d 653a 2073 7472 203d 2027 2729 3a0a  ame: str = ''):.
+0000eba0: 2020 2020 2020 2020 5769 7265 3244 2e5f          Wire2D._
+0000ebb0: 5f69 6e69 745f 5f28 7365 6c66 2c20 7072  _init__(self, pr
+0000ebc0: 696d 6974 6976 6573 2c20 6e61 6d65 290a  imitives, name).
+0000ebd0: 2020 2020 2020 2020 7365 6c66 2e5f 6564          self._ed
+0000ebe0: 6765 5f70 6f6c 7967 6f6e 203d 204e 6f6e  ge_polygon = Non
+0000ebf0: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+0000ec00: 706f 6c79 676f 6e5f 3130 305f 706f 696e  polygon_100_poin
+0000ec10: 7473 203d 204e 6f6e 650a 2020 2020 2020  ts = None.      
+0000ec20: 2020 7365 6c66 2e5f 6172 6561 203d 204e    self._area = N
+0000ec30: 6f6e 650a 0a20 2020 2064 6566 205f 5f68  one..    def __h
+0000ec40: 6173 685f 5f28 7365 6c66 293a 0a20 2020  ash__(self):.   
+0000ec50: 2020 2020 2072 6574 7572 6e20 7375 6d28       return sum(
+0000ec60: 6861 7368 2865 2920 666f 7220 6520 696e  hash(e) for e in
+0000ec70: 2073 656c 662e 7072 696d 6974 6976 6573   self.primitives
+0000ec80: 290a 0a20 2020 2064 6566 205f 5f65 715f  )..    def __eq_
+0000ec90: 5f28 7365 6c66 2c20 6f74 6865 725f 293a  _(self, other_):
+0000eca0: 0a20 2020 2020 2020 2069 6620 6f74 6865  .        if othe
+0000ecb0: 725f 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  r_.__class__.__n
+0000ecc0: 616d 655f 5f20 213d 2073 656c 662e 5f5f  ame__ != self.__
+0000ecd0: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+0000ece0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000ecf0: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
+0000ed00: 2020 2069 6620 6c65 6e28 7365 6c66 2e70     if len(self.p
+0000ed10: 7269 6d69 7469 7665 7329 2021 3d20 6c65  rimitives) != le
+0000ed20: 6e28 6f74 6865 725f 2e70 7269 6d69 7469  n(other_.primiti
+0000ed30: 7665 7329 3a0a 2020 2020 2020 2020 2020  ves):.          
+0000ed40: 2020 7265 7475 726e 2046 616c 7365 0a20    return False. 
+0000ed50: 2020 2020 2020 2069 6620 7365 6c66 2e6c         if self.l
+0000ed60: 656e 6774 6828 2920 213d 206f 7468 6572  ength() != other
+0000ed70: 5f2e 6c65 6e67 7468 2829 3a0a 2020 2020  _.length():.    
+0000ed80: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+0000ed90: 616c 7365 0a20 2020 2020 2020 2065 7175  alse.        equ
+0000eda0: 616c 203d 2030 0a20 2020 2020 2020 2066  al = 0.        f
+0000edb0: 6f72 2070 7269 6d31 2069 6e20 7365 6c66  or prim1 in self
+0000edc0: 2e70 7269 6d69 7469 7665 733a 0a20 2020  .primitives:.   
+0000edd0: 2020 2020 2020 2020 2072 6576 6572 7365           reverse
+0000ede0: 3120 3d20 7072 696d 312e 7265 7665 7273  1 = prim1.revers
+0000edf0: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+0000ee00: 666f 756e 6420 3d20 4661 6c73 650a 2020  found = False.  
+0000ee10: 2020 2020 2020 2020 2020 666f 7220 7072            for pr
+0000ee20: 696d 3220 696e 206f 7468 6572 5f2e 7072  im2 in other_.pr
+0000ee30: 696d 6974 6976 6573 3a0a 2020 2020 2020  imitives:.      
+0000ee40: 2020 2020 2020 2020 2020 7265 7665 7273            revers
+0000ee50: 6532 203d 2070 7269 6d32 2e72 6576 6572  e2 = prim2.rever
+0000ee60: 7365 2829 0a20 2020 2020 2020 2020 2020  se().           
+0000ee70: 2020 2020 2069 6620 2870 7269 6d31 203d       if (prim1 =
+0000ee80: 3d20 7072 696d 3220 6f72 2072 6576 6572  = prim2 or rever
+0000ee90: 7365 3120 3d3d 2070 7269 6d32 0a20 2020  se1 == prim2.   
+0000eea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eeb0: 2020 2020 206f 7220 7265 7665 7273 6532       or reverse2
+0000eec0: 203d 3d20 7072 696d 3120 6f72 2072 6576   == prim1 or rev
+0000eed0: 6572 7365 3120 3d3d 2072 6576 6572 7365  erse1 == reverse
+0000eee0: 3229 3a0a 2020 2020 2020 2020 2020 2020  2):.            
+0000eef0: 2020 2020 2020 2020 6571 7561 6c20 2b3d          equal +=
+0000ef00: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
+0000ef10: 2020 2020 2020 2066 6f75 6e64 203d 2054         found = T
+0000ef20: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+0000ef30: 6966 206e 6f74 2066 6f75 6e64 3a0a 2020  if not found:.  
+0000ef40: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000ef50: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
+0000ef60: 2020 2069 6620 6571 7561 6c20 3d3d 206c     if equal == l
+0000ef70: 656e 2873 656c 662e 7072 696d 6974 6976  en(self.primitiv
+0000ef80: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+0000ef90: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
+0000efa0: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
+0000efb0: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
+0000efc0: 0a20 2020 2064 6566 2065 6467 655f 706f  .    def edge_po
+0000efd0: 6c79 676f 6e28 7365 6c66 293a 0a20 2020  lygon(self):.   
+0000efe0: 2020 2020 2069 6620 7365 6c66 2e5f 6564       if self._ed
+0000eff0: 6765 5f70 6f6c 7967 6f6e 2069 7320 4e6f  ge_polygon is No
+0000f000: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000f010: 7365 6c66 2e5f 6564 6765 5f70 6f6c 7967  self._edge_polyg
+0000f020: 6f6e 203d 2073 656c 662e 5f67 6574 5f65  on = self._get_e
+0000f030: 6467 655f 706f 6c79 676f 6e28 290a 2020  dge_polygon().  
+0000f040: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000f050: 662e 5f65 6467 655f 706f 6c79 676f 6e0a  f._edge_polygon.
+0000f060: 0a20 2020 2064 6566 205f 6765 745f 6564  .    def _get_ed
+0000f070: 6765 5f70 6f6c 7967 6f6e 2873 656c 6629  ge_polygon(self)
+0000f080: 3a0a 2020 2020 2020 2020 706f 696e 7473  :.        points
+0000f090: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
+0000f0a0: 7220 6564 6765 2069 6e20 7365 6c66 2e70  r edge in self.p
+0000f0b0: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
+0000f0c0: 2020 2020 2020 2069 6620 706f 696e 7473         if points
+0000f0d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000f0e0: 2020 6966 2065 6467 652e 7374 6172 7420    if edge.start 
+0000f0f0: 213d 2070 6f69 6e74 735b 2d31 5d3a 0a20  != points[-1]:. 
+0000f100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f110: 2020 2070 6f69 6e74 732e 6170 7065 6e64     points.append
+0000f120: 2865 6467 652e 7374 6172 7429 0a20 2020  (edge.start).   
+0000f130: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000f140: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000f150: 6f69 6e74 732e 6170 7065 6e64 2865 6467  oints.append(edg
+0000f160: 652e 7374 6172 7429 0a20 2020 2020 2020  e.start).       
+0000f170: 2072 6574 7572 6e20 436c 6f73 6564 506f   return ClosedPo
+0000f180: 6c79 676f 6e32 4428 706f 696e 7473 290a  lygon2D(points).
+0000f190: 0a20 2020 2064 6566 2074 6f5f 3364 2873  .    def to_3d(s
+0000f1a0: 656c 662c 2070 6c61 6e65 5f6f 7269 6769  elf, plane_origi
+0000f1b0: 6e2c 2078 2c20 7929 3a0a 2020 2020 2020  n, x, y):.      
+0000f1c0: 2020 2222 220a 2020 2020 2020 2020 5472    """.        Tr
+0000f1d0: 616e 7366 6f72 6d73 2061 2043 6f6e 746f  ansforms a Conto
+0000f1e0: 7572 3244 2069 6e74 6f20 616e 2043 6f6e  ur2D into an Con
+0000f1f0: 746f 7572 3344 2c20 6769 7665 6e20 6120  tour3D, given a 
+0000f200: 706c 616e 6520 6f72 6967 696e 2061 6e64  plane origin and
+0000f210: 2061 6e20 7520 616e 6420 7620 706c 616e   an u and v plan
+0000f220: 6520 7665 6374 6f72 2e0a 0a20 2020 2020  e vector...     
+0000f230: 2020 203a 7061 7261 6d20 706c 616e 655f     :param plane_
+0000f240: 6f72 6967 696e 3a20 706c 616e 6520 6f72  origin: plane or
+0000f250: 6967 696e 2e0a 2020 2020 2020 2020 3a70  igin..        :p
+0000f260: 6172 616d 2078 3a20 706c 616e 6520 7520  aram x: plane u 
+0000f270: 7665 6374 6f72 2e0a 2020 2020 2020 2020  vector..        
+0000f280: 3a70 6172 616d 2079 3a20 706c 616e 6520  :param y: plane 
+0000f290: 7620 7665 6374 6f72 2e0a 2020 2020 2020  v vector..      
+0000f2a0: 2020 3a72 6574 7572 6e3a 2043 6f6e 746f    :return: Conto
+0000f2b0: 7572 3344 2e0a 2020 2020 2020 2020 2222  ur3D..        ""
+0000f2c0: 220a 2020 2020 2020 2020 7033 6420 3d20  ".        p3d = 
+0000f2d0: 5b5d 0a20 2020 2020 2020 2066 6f72 2065  [].        for e
+0000f2e0: 6467 6520 696e 2073 656c 662e 7072 696d  dge in self.prim
+0000f2f0: 6974 6976 6573 3a0a 2020 2020 2020 2020  itives:.        
+0000f300: 2020 2020 7033 642e 6170 7065 6e64 2865      p3d.append(e
+0000f310: 6467 652e 746f 5f33 6428 706c 616e 655f  dge.to_3d(plane_
+0000f320: 6f72 6967 696e 2c20 782c 2079 2929 0a0a  origin, x, y))..
+0000f330: 2020 2020 2020 2020 7265 7475 726e 2043          return C
+0000f340: 6f6e 746f 7572 3344 2870 3364 290a 0a20  ontour3D(p3d).. 
+0000f350: 2020 2064 6566 2070 6f69 6e74 5f62 656c     def point_bel
+0000f360: 6f6e 6773 2873 656c 662c 2070 6f69 6e74  ongs(self, point
+0000f370: 2c20 696e 636c 7564 655f 6564 6765 5f70  , include_edge_p
+0000f380: 6f69 6e74 733a 2062 6f6f 6c20 3d20 4661  oints: bool = Fa
+0000f390: 6c73 6529 3a0a 2020 2020 2020 2020 2320  lse):.        # 
+0000f3a0: 544f 444f 3a20 5468 6973 2069 7320 696e  TODO: This is in
+0000f3b0: 636f 6d70 6c65 7465 2121 210a 2020 2020  complete!!!.    
+0000f3c0: 2020 2020 785f 6d69 6e2c 2078 5f6d 6178      x_min, x_max
+0000f3d0: 2c20 795f 6d69 6e2c 2079 5f6d 6178 203d  , y_min, y_max =
+0000f3e0: 2073 656c 662e 626f 756e 6469 6e67 5f72   self.bounding_r
+0000f3f0: 6563 7461 6e67 6c65 0a20 2020 2020 2020  ectangle.       
+0000f400: 2069 6620 706f 696e 742e 7820 3c20 785f   if point.x < x_
+0000f410: 6d69 6e20 6f72 2070 6f69 6e74 2e78 203e  min or point.x >
+0000f420: 2078 5f6d 6178 206f 7220 706f 696e 742e   x_max or point.
+0000f430: 7920 3c20 795f 6d69 6e20 6f72 2070 6f69  y < y_min or poi
+0000f440: 6e74 2e79 203e 2079 5f6d 6178 3a0a 2020  nt.y > y_max:.  
+0000f450: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000f460: 2046 616c 7365 0a20 2020 2020 2020 2023   False.        #
+0000f470: 2069 6620 7365 6c66 2e65 6467 655f 706f   if self.edge_po
+0000f480: 6c79 676f 6e2e 706f 696e 745f 6265 6c6f  lygon.point_belo
+0000f490: 6e67 7328 706f 696e 7429 3a0a 2020 2020  ngs(point):.    
+0000f4a0: 2020 2020 2320 2020 2020 7265 7475 726e      #     return
+0000f4b0: 2054 7275 650a 2020 2020 2020 2020 2320   True.        # 
+0000f4c0: 666f 7220 6564 6765 2069 6e20 7365 6c66  for edge in self
+0000f4d0: 2e70 7269 6d69 7469 7665 733a 0a20 2020  .primitives:.   
+0000f4e0: 2020 2020 2023 2020 2020 2069 6620 6861       #     if ha
+0000f4f0: 7361 7474 7228 6564 6765 2c20 2773 7472  sattr(edge, 'str
+0000f500: 6169 6768 745f 6c69 6e65 5f70 6f69 6e74  aight_line_point
+0000f510: 5f62 656c 6f6e 6773 2729 3a0a 2020 2020  _belongs'):.    
+0000f520: 2020 2020 2320 2020 2020 2020 2020 6966      #         if
+0000f530: 2065 6467 652e 7374 7261 6967 6874 5f6c   edge.straight_l
+0000f540: 696e 655f 706f 696e 745f 6265 6c6f 6e67  ine_point_belong
+0000f550: 7328 706f 696e 7429 3a0a 2020 2020 2020  s(point):.      
+0000f560: 2020 2320 2020 2020 2020 2020 2020 2020    #             
+0000f570: 7265 7475 726e 2054 7275 650a 2020 2020  return True.    
+0000f580: 2020 2020 2320 2020 2020 7761 726e 696e      #     warnin
+0000f590: 6773 2e77 6172 6e28 6627 7b65 6467 652e  gs.warn(f'{edge.
+0000f5a0: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
+0000f5b0: 5f5f 7d20 646f 6573 206e 6f74 2069 6d70  __} does not imp
+0000f5c0: 6c65 6d65 6e74 2073 7472 6169 6768 745f  lement straight_
+0000f5d0: 6c69 6e65 5f70 6f69 6e74 5f62 656c 6f6e  line_point_belon
+0000f5e0: 6773 2079 6574 2729 0a20 2020 2020 2020  gs yet').       
+0000f5f0: 2069 6620 6e6f 7420 7365 6c66 2e5f 706f   if not self._po
+0000f600: 6c79 676f 6e5f 3130 305f 706f 696e 7473  lygon_100_points
+0000f610: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0000f620: 6c66 2e5f 706f 6c79 676f 6e5f 3130 305f  lf._polygon_100_
+0000f630: 706f 696e 7473 203d 2073 656c 662e 746f  points = self.to
+0000f640: 5f70 6f6c 7967 6f6e 2831 3030 290a 2020  _polygon(100).  
+0000f650: 2020 2020 2020 6966 2073 656c 662e 5f70        if self._p
+0000f660: 6f6c 7967 6f6e 5f31 3030 5f70 6f69 6e74  olygon_100_point
+0000f670: 732e 706f 696e 745f 6265 6c6f 6e67 7328  s.point_belongs(
+0000f680: 706f 696e 7429 3a0a 2020 2020 2020 2020  point):.        
+0000f690: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
+0000f6a0: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+0000f6b0: 616c 7365 0a0a 2020 2020 6465 6620 6d69  alse..    def mi
+0000f6c0: 6464 6c65 5f70 6f69 6e74 2873 656c 6629  ddle_point(self)
+0000f6d0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000f6e0: 2073 656c 662e 706f 696e 745f 6174 5f61   self.point_at_a
+0000f6f0: 6273 6369 7373 6128 7365 6c66 2e6c 656e  bscissa(self.len
+0000f700: 6774 6828 2920 2f20 3229 0a0a 2020 2020  gth() / 2)..    
+0000f710: 6465 6620 706f 696e 745f 6469 7374 616e  def point_distan
+0000f720: 6365 2873 656c 662c 2070 6f69 6e74 293a  ce(self, point):
+0000f730: 0a20 2020 2020 2020 206d 696e 5f64 6973  .        min_dis
+0000f740: 7461 6e63 6520 3d20 7365 6c66 2e70 7269  tance = self.pri
+0000f750: 6d69 7469 7665 735b 305d 2e70 6f69 6e74  mitives[0].point
+0000f760: 5f64 6973 7461 6e63 6528 706f 696e 7429  _distance(point)
+0000f770: 0a20 2020 2020 2020 2066 6f72 2070 7269  .        for pri
+0000f780: 6d69 7469 7665 2069 6e20 7365 6c66 2e70  mitive in self.p
+0000f790: 7269 6d69 7469 7665 735b 313a 5d3a 0a20  rimitives[1:]:. 
+0000f7a0: 2020 2020 2020 2020 2020 2064 6973 7461             dista
+0000f7b0: 6e63 6520 3d20 7072 696d 6974 6976 652e  nce = primitive.
+0000f7c0: 706f 696e 745f 6469 7374 616e 6365 2870  point_distance(p
+0000f7d0: 6f69 6e74 290a 2020 2020 2020 2020 2020  oint).          
+0000f7e0: 2020 6966 2064 6973 7461 6e63 6520 3c20    if distance < 
+0000f7f0: 6d69 6e5f 6469 7374 616e 6365 3a0a 2020  min_distance:.  
+0000f800: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
+0000f810: 6e5f 6469 7374 616e 6365 203d 2064 6973  n_distance = dis
+0000f820: 7461 6e63 650a 2020 2020 2020 2020 7265  tance.        re
+0000f830: 7475 726e 206d 696e 5f64 6973 7461 6e63  turn min_distanc
+0000f840: 650a 0a20 2020 2064 6566 2062 6f75 6e64  e..    def bound
+0000f850: 696e 675f 706f 696e 7473 2873 656c 6629  ing_points(self)
+0000f860: 3a0a 2020 2020 2020 2020 706f 696e 7473  :.        points
+0000f870: 203d 2073 656c 662e 6564 6765 5f70 6f6c   = self.edge_pol
+0000f880: 7967 6f6e 2e70 6f69 6e74 735b 3a5d 0a20  ygon.points[:]. 
+0000f890: 2020 2020 2020 2066 6f72 2070 7269 6d69         for primi
+0000f8a0: 7469 7665 2069 6e20 7365 6c66 2e70 7269  tive in self.pri
+0000f8b0: 6d69 7469 7665 733a 0a20 2020 2020 2020  mitives:.       
+0000f8c0: 2020 2020 2069 6620 6861 7361 7474 7228       if hasattr(
+0000f8d0: 7072 696d 6974 6976 652c 2027 6469 7363  primitive, 'disc
+0000f8e0: 7265 7469 7a61 7469 6f6e 5f70 6f69 6e74  retization_point
+0000f8f0: 7327 293a 0a20 2020 2020 2020 2020 2020  s'):.           
+0000f900: 2020 2020 2070 6f69 6e74 732e 6578 7465       points.exte
+0000f910: 6e64 2870 7269 6d69 7469 7665 2e64 6973  nd(primitive.dis
+0000f920: 6372 6574 697a 6174 696f 6e5f 706f 696e  cretization_poin
+0000f930: 7473 286e 756d 6265 725f 706f 696e 7473  ts(number_points
+0000f940: 3d31 3029 290a 2020 2020 2020 2020 785f  =10)).        x_
+0000f950: 6d69 6e20 3d20 6d69 6e28 705b 305d 2066  min = min(p[0] f
+0000f960: 6f72 2070 2069 6e20 706f 696e 7473 290a  or p in points).
+0000f970: 2020 2020 2020 2020 785f 6d61 7820 3d20          x_max = 
+0000f980: 6d61 7828 705b 305d 2066 6f72 2070 2069  max(p[0] for p i
+0000f990: 6e20 706f 696e 7473 290a 2020 2020 2020  n points).      
+0000f9a0: 2020 795f 6d69 6e20 3d20 6d69 6e28 705b    y_min = min(p[
+0000f9b0: 315d 2066 6f72 2070 2069 6e20 706f 696e  1] for p in poin
+0000f9c0: 7473 290a 2020 2020 2020 2020 795f 6d61  ts).        y_ma
+0000f9d0: 7820 3d20 6d61 7828 705b 315d 2066 6f72  x = max(p[1] for
+0000f9e0: 2070 2069 6e20 706f 696e 7473 290a 2020   p in points).  
+0000f9f0: 2020 2020 2020 7265 7475 726e 2028 766f        return (vo
+0000fa00: 6c6d 646c 722e 506f 696e 7432 4428 785f  lmdlr.Point2D(x_
+0000fa10: 6d69 6e2c 2079 5f6d 696e 292c 2076 6f6c  min, y_min), vol
+0000fa20: 6d64 6c72 2e50 6f69 6e74 3244 2878 5f6d  mdlr.Point2D(x_m
+0000fa30: 6178 2c20 795f 6d61 7829 290a 0a20 2020  ax, y_max))..   
+0000fa40: 2064 6566 2061 7265 6128 7365 6c66 293a   def area(self):
+0000fa50: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0000fa60: 7365 6c66 2e5f 6172 6561 3a0a 2020 2020  self._area:.    
+0000fa70: 2020 2020 2020 2020 6172 6561 203d 2073          area = s
+0000fa80: 656c 662e 6564 6765 5f70 6f6c 7967 6f6e  elf.edge_polygon
+0000fa90: 2e61 7265 6128 290a 2020 2020 2020 2020  .area().        
+0000faa0: 2020 2020 636c 6173 7365 7320 3d20 7b70      classes = {p
+0000fab0: 7269 6d2e 5f5f 636c 6173 735f 5f20 666f  rim.__class__ fo
+0000fac0: 7220 7072 696d 2069 6e20 7365 6c66 2e70  r prim in self.p
+0000fad0: 7269 6d69 7469 7665 737d 0a20 2020 2020  rimitives}.     
+0000fae0: 2020 2020 2020 2076 6572 6966 795f 636c         verify_cl
+0000faf0: 6173 7365 7320 3d20 636c 6173 7365 732e  asses = classes.
+0000fb00: 6973 7375 6273 6574 287b 766f 6c6d 646c  issubset({volmdl
+0000fb10: 722e 6564 6765 732e 4c69 6e65 5365 676d  r.edges.LineSegm
+0000fb20: 656e 7432 442c 2076 6f6c 6d64 6c72 2e65  ent2D, volmdlr.e
+0000fb30: 6467 6573 2e41 7263 3244 7d29 0a20 2020  dges.Arc2D}).   
+0000fb40: 2020 2020 2020 2020 2069 6620 7665 7269           if veri
+0000fb50: 6679 5f63 6c61 7373 6573 3a0a 2020 2020  fy_classes:.    
+0000fb60: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0000fb70: 656c 662e 6564 6765 5f70 6f6c 7967 6f6e  elf.edge_polygon
+0000fb80: 2e69 735f 7472 6967 6f3a 0a20 2020 2020  .is_trigo:.     
+0000fb90: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0000fba0: 7269 676f 203d 2031 0a20 2020 2020 2020  rigo = 1.       
+0000fbb0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000fbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fbd0: 2020 2074 7269 676f 203d 202d 310a 2020     trigo = -1.  
+0000fbe0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000fbf0: 7220 6564 6765 2069 6e20 7365 6c66 2e70  r edge in self.p
+0000fc00: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
+0000fc10: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0000fc20: 7265 6120 2b3d 2074 7269 676f 202a 2065  rea += trigo * e
+0000fc30: 6467 652e 7374 7261 6967 6874 5f6c 696e  dge.straight_lin
+0000fc40: 655f 6172 6561 2829 0a20 2020 2020 2020  e_area().       
+0000fc50: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000fc60: 662e 5f61 7265 6120 3d20 6162 7328 6172  f._area = abs(ar
+0000fc70: 6561 290a 2020 2020 2020 2020 2020 2020  ea).            
+0000fc80: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000fc90: 2020 2020 2020 706f 6c79 676f 6e20 3d20        polygon = 
+0000fca0: 7365 6c66 2e74 6f5f 706f 6c79 676f 6e28  self.to_polygon(
+0000fcb0: 616e 676c 655f 7265 736f 6c75 7469 6f6e  angle_resolution
+0000fcc0: 3d35 3029 0a20 2020 2020 2020 2020 2020  =50).           
+0000fcd0: 2020 2020 2073 656c 662e 5f61 7265 6120       self._area 
+0000fce0: 3d20 706f 6c79 676f 6e2e 7472 6961 6e67  = polygon.triang
+0000fcf0: 756c 6174 696f 6e28 292e 6172 6561 2829  ulation().area()
+0000fd00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000fd10: 7365 6c66 2e5f 6172 6561 0a0a 2020 2020  self._area..    
+0000fd20: 6465 6620 6365 6e74 6572 5f6f 665f 6d61  def center_of_ma
+0000fd30: 7373 2873 656c 6629 3a0a 2020 2020 2020  ss(self):.      
+0000fd40: 2020 2222 220a 2020 2020 2020 2020 4361    """.        Ca
+0000fd50: 6c63 756c 6174 6573 2074 6865 2063 656e  lculates the cen
+0000fd60: 7465 7220 6f66 206d 6173 7320 6f66 2074  ter of mass of t
+0000fd70: 6865 2043 6f6e 746f 7572 3244 2e0a 0a20  he Contour2D... 
+0000fd80: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+0000fd90: 436f 6e74 6f75 7227 7320 6365 6e74 6572  Contour's center
+0000fda0: 206f 6620 6d61 7373 2e0a 2020 2020 2020   of mass..      
+0000fdb0: 2020 2222 220a 2020 2020 2020 2020 6365    """.        ce
+0000fdc0: 6e74 6572 203d 2073 656c 662e 6564 6765  nter = self.edge
+0000fdd0: 5f70 6f6c 7967 6f6e 2e61 7265 6128 2920  _polygon.area() 
+0000fde0: 2a20 7365 6c66 2e65 6467 655f 706f 6c79  * self.edge_poly
+0000fdf0: 676f 6e2e 6365 6e74 6572 5f6f 665f 6d61  gon.center_of_ma
+0000fe00: 7373 2829 0a20 2020 2020 2020 2023 2061  ss().        # a
+0000fe10: 7820 3d20 7365 6c66 2e70 6c6f 7428 290a  x = self.plot().
+0000fe20: 2020 2020 2020 2020 2320 7365 6c66 2e65          # self.e
+0000fe30: 6467 655f 706f 6c79 676f 6e2e 6365 6e74  dge_polygon.cent
+0000fe40: 6572 5f6f 665f 6d61 7373 2829 2e70 6c6f  er_of_mass().plo
+0000fe50: 7428 6178 3d61 782c 2063 6f6c 6f72 3d27  t(ax=ax, color='
+0000fe60: 6227 290a 2020 2020 2020 2020 6966 2073  b').        if s
+0000fe70: 656c 662e 6564 6765 5f70 6f6c 7967 6f6e  elf.edge_polygon
+0000fe80: 2e69 735f 7472 6967 6f3a 0a20 2020 2020  .is_trigo:.     
+0000fe90: 2020 2020 2020 2074 7269 676f 203d 2031         trigo = 1
+0000fea0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000feb0: 2020 2020 2020 2020 2020 2074 7269 676f             trigo
+0000fec0: 203d 202d 310a 2020 2020 2020 2020 666f   = -1.        fo
+0000fed0: 7220 6564 6765 2069 6e20 7365 6c66 2e70  r edge in self.p
+0000fee0: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
+0000fef0: 2020 2020 2020 2023 2065 6467 652e 7374         # edge.st
+0000ff00: 7261 6967 6874 5f6c 696e 655f 6365 6e74  raight_line_cent
+0000ff10: 6572 5f6f 665f 6d61 7373 2829 2e70 6c6f  er_of_mass().plo
+0000ff20: 7428 6178 3d61 782c 2063 6f6c 6f72 3d27  t(ax=ax, color='
+0000ff30: 6727 290a 2020 2020 2020 2020 2020 2020  g').            
+0000ff40: 6365 6e74 6572 202b 3d20 7472 6967 6f20  center += trigo 
+0000ff50: 2a20 6564 6765 2e73 7472 6169 6768 745f  * edge.straight_
+0000ff60: 6c69 6e65 5f61 7265 6128 2920 5c0a 2020  line_area() \.  
+0000ff70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ff80: 2020 2020 2a20 6564 6765 2e73 7472 6169      * edge.strai
+0000ff90: 6768 745f 6c69 6e65 5f63 656e 7465 725f  ght_line_center_
+0000ffa0: 6f66 5f6d 6173 7328 290a 0a20 2020 2020  of_mass()..     
+0000ffb0: 2020 2072 6574 7572 6e20 6365 6e74 6572     return center
+0000ffc0: 202f 2073 656c 662e 6172 6561 2829 0a0a   / self.area()..
+0000ffd0: 2020 2020 6465 6620 7365 636f 6e64 5f6d      def second_m
+0000ffe0: 6f6d 656e 745f 6172 6561 2873 656c 662c  oment_area(self,
+0000fff0: 2070 6f69 6e74 293a 0a0a 2020 2020 2020   point):..      
+00010000: 2020 4978 2c20 4979 2c20 4978 7920 3d20    Ix, Iy, Ixy = 
+00010010: 7365 6c66 2e65 6467 655f 706f 6c79 676f  self.edge_polygo
+00010020: 6e2e 7365 636f 6e64 5f6d 6f6d 656e 745f  n.second_moment_
+00010030: 6172 6561 2870 6f69 6e74 290a 2020 2020  area(point).    
+00010040: 2020 2020 666f 7220 6564 6765 2069 6e20      for edge in 
+00010050: 7365 6c66 2e70 7269 6d69 7469 7665 733a  self.primitives:
+00010060: 0a20 2020 2020 2020 2020 2020 2049 785f  .            Ix_
+00010070: 652c 2049 795f 652c 2049 7879 5f65 203d  e, Iy_e, Ixy_e =
+00010080: 2065 6467 652e 7374 7261 6967 6874 5f6c   edge.straight_l
+00010090: 696e 655f 7365 636f 6e64 5f6d 6f6d 656e  ine_second_momen
+000100a0: 745f 6172 6561 2870 6f69 6e74 290a 2020  t_area(point).  
+000100b0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+000100c0: 662e 6564 6765 5f70 6f6c 7967 6f6e 2e69  f.edge_polygon.i
+000100d0: 735f 7472 6967 6f3a 0a20 2020 2020 2020  s_trigo:.       
+000100e0: 2020 2020 2020 2020 2049 7820 2b3d 2049           Ix += I
+000100f0: 785f 650a 2020 2020 2020 2020 2020 2020  x_e.            
+00010100: 2020 2020 4979 202b 3d20 4979 5f65 0a20      Iy += Iy_e. 
+00010110: 2020 2020 2020 2020 2020 2020 2020 2049                 I
+00010120: 7879 202b 3d20 4978 795f 650a 2020 2020  xy += Ixy_e.    
+00010130: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00010140: 2020 2020 2020 2020 2020 2020 2020 4978                Ix
+00010150: 202d 3d20 4978 5f65 0a20 2020 2020 2020   -= Ix_e.       
+00010160: 2020 2020 2020 2020 2049 7920 2d3d 2049           Iy -= I
+00010170: 795f 650a 2020 2020 2020 2020 2020 2020  y_e.            
+00010180: 2020 2020 4978 7920 2d3d 2049 7879 5f65      Ixy -= Ixy_e
+00010190: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000101a0: 2049 782c 2049 792c 2049 7879 0a0a 2020   Ix, Iy, Ixy..  
+000101b0: 2020 6465 6620 706c 6f74 5f64 6174 6128    def plot_data(
+000101c0: 7365 6c66 2c20 6564 6765 5f73 7479 6c65  self, edge_style
+000101d0: 3a20 706c 6f74 5f64 6174 612e 4564 6765  : plot_data.Edge
+000101e0: 5374 796c 6520 3d20 4e6f 6e65 2c0a 2020  Style = None,.  
+000101f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010200: 7375 7266 6163 655f 7374 796c 653a 2070  surface_style: p
+00010210: 6c6f 745f 6461 7461 2e53 7572 6661 6365  lot_data.Surface
+00010220: 5374 796c 6520 3d20 4e6f 6e65 293a 0a20  Style = None):. 
+00010230: 2020 2020 2020 2070 6c6f 745f 6461 7461         plot_data
+00010240: 5f70 7269 6d69 7469 7665 7320 3d20 5b69  _primitives = [i
+00010250: 7465 6d2e 706c 6f74 5f64 6174 6128 2920  tem.plot_data() 
+00010260: 666f 7220 6974 656d 2069 6e20 7365 6c66  for item in self
+00010270: 2e70 7269 6d69 7469 7665 735d 0a20 2020  .primitives].   
+00010280: 2020 2020 2072 6574 7572 6e20 706c 6f74       return plot
+00010290: 5f64 6174 612e 436f 6e74 6f75 7232 4428  _data.Contour2D(
+000102a0: 706c 6f74 5f64 6174 615f 7072 696d 6974  plot_data_primit
+000102b0: 6976 6573 3d70 6c6f 745f 6461 7461 5f70  ives=plot_data_p
+000102c0: 7269 6d69 7469 7665 732c 0a20 2020 2020  rimitives,.     
 000102d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000102e0: 2020 2020 2020 6564 6765 5f73 7479 6c65        edge_style
-000102f0: 3d65 6467 655f 7374 796c 652c 0a20 2020  =edge_style,.   
-00010300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000102e0: 2020 2020 2020 2020 2020 2020 2020 6564                ed
+000102f0: 6765 5f73 7479 6c65 3d65 6467 655f 7374  ge_style=edge_st
+00010300: 796c 652c 0a20 2020 2020 2020 2020 2020  yle,.           
 00010310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010320: 7375 7266 6163 655f 7374 796c 653d 7375  surface_style=su
-00010330: 7266 6163 655f 7374 796c 652c 0a20 2020  rface_style,.   
-00010340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010320: 2020 2020 2020 2020 7375 7266 6163 655f          surface_
+00010330: 7374 796c 653d 7375 7266 6163 655f 7374  style=surface_st
+00010340: 796c 652c 0a20 2020 2020 2020 2020 2020  yle,.           
 00010350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010360: 6e61 6d65 3d73 656c 662e 6e61 6d65 290a  name=self.name).
-00010370: 0a20 2020 2064 6566 2069 735f 696e 7369  .    def is_insi
-00010380: 6465 2873 656c 662c 2063 6f6e 746f 7572  de(self, contour
-00010390: 3229 3a0a 2020 2020 2020 2020 2222 220a  2):.        """.
-000103a0: 2020 2020 2020 2020 5665 7269 6669 6573          Verifies
-000103b0: 2069 6620 6120 636f 6e74 6f75 7220 6973   if a contour is
-000103c0: 2069 6e73 6964 6520 616e 6f74 6865 7220   inside another 
-000103d0: 636f 6e74 6f75 7220 7065 7269 6d69 7465  contour perimite
-000103e0: 722c 2069 6e63 6c75 6469 6e67 2074 6865  r, including the
-000103f0: 2065 6467 6573 2e0a 0a20 2020 2020 2020   edges...       
-00010400: 203a 7265 7475 726e 733a 2054 7275 6520   :returns: True 
-00010410: 6f72 2046 616c 7365 0a20 2020 2020 2020  or False.       
-00010420: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-00010430: 636f 6e74 6f75 7232 2e61 7265 6128 2920  contour2.area() 
-00010440: 3e20 7365 6c66 2e61 7265 6128 293a 0a20  > self.area():. 
-00010450: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00010460: 6e20 4661 6c73 650a 2020 2020 2020 2020  n False.        
-00010470: 706f 696e 7473 5f63 6f6e 746f 7572 3220  points_contour2 
-00010480: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
-00010490: 2070 7269 6d20 696e 2063 6f6e 746f 7572   prim in contour
-000104a0: 322e 7072 696d 6974 6976 6573 3a0a 2020  2.primitives:.  
-000104b0: 2020 2020 2020 2020 2020 6966 2070 7269            if pri
-000104c0: 6d2e 7374 6172 7420 6e6f 7420 696e 2070  m.start not in p
-000104d0: 6f69 6e74 735f 636f 6e74 6f75 7232 3a0a  oints_contour2:.
-000104e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000104f0: 706f 696e 7473 5f63 6f6e 746f 7572 322e  points_contour2.
-00010500: 6170 7065 6e64 2870 7269 6d2e 7374 6172  append(prim.star
-00010510: 7429 0a20 2020 2020 2020 2020 2020 2069  t).            i
-00010520: 6620 7072 696d 2e65 6e64 206e 6f74 2069  f prim.end not i
-00010530: 6e20 706f 696e 7473 5f63 6f6e 746f 7572  n points_contour
-00010540: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
-00010550: 2020 2070 6f69 6e74 735f 636f 6e74 6f75     points_contou
-00010560: 7232 2e61 7070 656e 6428 7072 696d 2e65  r2.append(prim.e
-00010570: 6e64 290a 2020 2020 2020 2020 2020 2020  nd).            
-00010580: 706f 696e 7473 5f63 6f6e 746f 7572 322e  points_contour2.
-00010590: 6578 7465 6e64 2870 7269 6d2e 6469 7363  extend(prim.disc
-000105a0: 7265 7469 7a61 7469 6f6e 5f70 6f69 6e74  retization_point
-000105b0: 7328 6e75 6d62 6572 5f70 6f69 6e74 733d  s(number_points=
-000105c0: 3130 2929 0a20 2020 2020 2020 2066 6f72  10)).        for
-000105d0: 2070 6f69 6e74 2069 6e20 706f 696e 7473   point in points
-000105e0: 5f63 6f6e 746f 7572 323a 0a20 2020 2020  _contour2:.     
-000105f0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00010600: 6c66 2e70 6f69 6e74 5f62 656c 6f6e 6773  lf.point_belongs
-00010610: 2870 6f69 6e74 2920 616e 6420 6e6f 7420  (point) and not 
-00010620: 7365 6c66 2e70 6f69 6e74 5f6f 7665 725f  self.point_over_
-00010630: 636f 6e74 6f75 7228 706f 696e 742c 2061  contour(point, a
-00010640: 6273 5f74 6f6c 3d31 652d 3729 3a0a 2020  bs_tol=1e-7):.  
-00010650: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00010660: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
-00010670: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
-00010680: 2020 2020 6465 6620 696e 7665 7274 6564      def inverted
-00010690: 5f70 7269 6d69 7469 7665 7328 7365 6c66  _primitives(self
-000106a0: 293a 0a20 2020 2020 2020 206e 6577 5f70  ):.        new_p
-000106b0: 7269 6d69 7469 7665 7320 3d20 5b5d 0a20  rimitives = []. 
-000106c0: 2020 2020 2020 2066 6f72 2070 7269 6d20         for prim 
-000106d0: 696e 2073 656c 662e 7072 696d 6974 6976  in self.primitiv
-000106e0: 6573 5b3a 3a2d 315d 3a0a 2020 2020 2020  es[::-1]:.      
-000106f0: 2020 2020 2020 6e65 775f 7072 696d 6974        new_primit
-00010700: 6976 6573 2e61 7070 656e 6428 7072 696d  ives.append(prim
-00010710: 2e72 6576 6572 7365 2829 290a 2020 2020  .reverse()).    
-00010720: 2020 2020 7265 7475 726e 206e 6577 5f70      return new_p
-00010730: 7269 6d69 7469 7665 730a 0a20 2020 2064  rimitives..    d
-00010740: 6566 2069 6e76 6572 7428 7365 6c66 293a  ef invert(self):
-00010750: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00010760: 436f 6e74 6f75 7232 4428 7365 6c66 2e69  Contour2D(self.i
-00010770: 6e76 6572 7465 645f 7072 696d 6974 6976  nverted_primitiv
-00010780: 6573 2829 290a 0a20 2020 2064 6566 2069  es())..    def i
-00010790: 6e76 6572 745f 696e 706c 6163 6528 7365  nvert_inplace(se
-000107a0: 6c66 293a 0a20 2020 2020 2020 2077 6172  lf):.        war
-000107b0: 6e69 6e67 732e 7761 726e 2822 2769 6e70  nings.warn("'inp
-000107c0: 6c61 6365 2720 6d65 7468 6f64 7320 6172  lace' methods ar
-000107d0: 6520 6465 7072 6563 6174 6564 2e20 5573  e deprecated. Us
-000107e0: 6520 6120 6e6f 7420 696e 706c 6163 6520  e a not inplace 
-000107f0: 6d65 7468 6f64 2069 6e73 7465 6164 2e22  method instead."
-00010800: 2c20 4465 7072 6563 6174 696f 6e57 6172  , DeprecationWar
-00010810: 6e69 6e67 290a 0a20 2020 2020 2020 2073  ning)..        s
-00010820: 656c 662e 7072 696d 6974 6976 6573 203d  elf.primitives =
-00010830: 2073 656c 662e 696e 7665 7274 6564 5f70   self.inverted_p
-00010840: 7269 6d69 7469 7665 7328 290a 0a20 2020  rimitives()..   
-00010850: 2064 6566 2072 616e 646f 6d5f 706f 696e   def random_poin
-00010860: 745f 696e 7369 6465 2873 656c 662c 2069  t_inside(self, i
-00010870: 6e63 6c75 6465 5f65 6467 655f 706f 696e  nclude_edge_poin
-00010880: 7473 3a20 626f 6f6c 203d 2046 616c 7365  ts: bool = False
-00010890: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-000108a0: 2020 2020 2020 2046 696e 6473 2061 2072         Finds a r
-000108b0: 616e 646f 6d20 706f 696e 7420 696e 7369  andom point insi
-000108c0: 6465 2074 6865 2070 6f6c 7967 6f6e 2e0a  de the polygon..
-000108d0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000108e0: 696e 636c 7564 655f 6564 6765 5f70 6f69  include_edge_poi
-000108f0: 6e74 733a 2043 686f 6f73 6520 5472 7565  nts: Choose True
-00010900: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
-00010910: 636f 6e73 6964 6572 2061 2070 6f69 6e74  consider a point
-00010920: 206f 6e20 7468 6520 706f 6c79 676f 6e20   on the polygon 
-00010930: 696e 7369 6465 2e0a 2020 2020 2020 2020  inside..        
-00010940: 3a74 7970 6520 696e 636c 7564 655f 6564  :type include_ed
-00010950: 6765 5f70 6f69 6e74 733a 2062 6f6f 6c0a  ge_points: bool.
-00010960: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00010970: 2041 2072 616e 646f 6d20 706f 696e 7420   A random point 
-00010980: 696e 7369 6465 2074 6865 2070 6f6c 7967  inside the polyg
-00010990: 6f6e 0a20 2020 2020 2020 203a 7274 7970  on.        :rtyp
-000109a0: 653a 2060 766f 6c6d 646c 722e 506f 696e  e: `volmdlr.Poin
-000109b0: 7432 4460 0a20 2020 2020 2020 2022 2222  t2D`.        """
-000109c0: 0a20 2020 2020 2020 2078 5f6d 696e 2c20  .        x_min, 
-000109d0: 785f 6d61 782c 2079 5f6d 696e 2c20 795f  x_max, y_min, y_
-000109e0: 6d61 7820 3d20 7365 6c66 2e62 6f75 6e64  max = self.bound
-000109f0: 696e 675f 7265 6374 616e 676c 652e 626f  ing_rectangle.bo
-00010a00: 756e 6473 2829 0a20 2020 2020 2020 2066  unds().        f
-00010a10: 6f72 205f 2069 6e20 7261 6e67 6528 3230  or _ in range(20
-00010a20: 3030 293a 0a20 2020 2020 2020 2020 2020  00):.           
-00010a30: 2070 203d 2076 6f6c 6d64 6c72 2e50 6f69   p = volmdlr.Poi
-00010a40: 6e74 3244 2e72 616e 646f 6d28 785f 6d69  nt2D.random(x_mi
-00010a50: 6e2c 2078 5f6d 6178 2c20 795f 6d69 6e2c  n, x_max, y_min,
-00010a60: 2079 5f6d 6178 290a 2020 2020 2020 2020   y_max).        
-00010a70: 2020 2020 6966 2073 656c 662e 706f 696e      if self.poin
-00010a80: 745f 6265 6c6f 6e67 7328 702c 2069 6e63  t_belongs(p, inc
-00010a90: 6c75 6465 5f65 6467 655f 706f 696e 7473  lude_edge_points
-00010aa0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00010ab0: 2020 2072 6574 7572 6e20 700a 2020 2020     return p.    
-00010ac0: 2020 2020 7072 696e 7428 5472 7565 290a      print(True).
-00010ad0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00010ae0: 6c75 6545 7272 6f72 2827 436f 756c 6420  lueError('Could 
-00010af0: 6e6f 7420 6669 6e64 2061 2070 6f69 6e74  not find a point
-00010b00: 2069 6e73 6964 6527 290a 0a20 2020 2064   inside')..    d
-00010b10: 6566 206f 7264 6572 5f63 6f6e 746f 7572  ef order_contour
-00010b20: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00010b30: 6966 2073 656c 662e 6973 5f6f 7264 6572  if self.is_order
-00010b40: 6564 2829 206f 7220 6c65 6e28 7365 6c66  ed() or len(self
-00010b50: 2e70 7269 6d69 7469 7665 7329 203c 2032  .primitives) < 2
-00010b60: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00010b70: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
-00010b80: 2020 6e65 775f 7072 696d 6974 6976 6573    new_primitives
-00010b90: 203d 2073 656c 662e 6f72 6465 7269 6e67   = self.ordering
-00010ba0: 5f63 6f6e 746f 7572 2829 0a20 2020 2020  _contour().     
-00010bb0: 2020 2073 656c 662e 7072 696d 6974 6976     self.primitiv
-00010bc0: 6573 203d 206e 6577 5f70 7269 6d69 7469  es = new_primiti
-00010bd0: 7665 730a 0a20 2020 2020 2020 2072 6574  ves..        ret
-00010be0: 7572 6e20 7365 6c66 0a0a 2020 2020 4063  urn self..    @c
-00010bf0: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
-00010c00: 6566 2065 7874 7261 6374 5f63 6f6e 746f  ef extract_conto
-00010c10: 7572 7328 636c 732c 2063 6f6e 746f 7572  urs(cls, contour
-00010c20: 2c20 706f 696e 7431 3a20 766f 6c6d 646c  , point1: volmdl
-00010c30: 722e 506f 696e 7433 442c 0a20 2020 2020  r.Point3D,.     
-00010c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010c50: 2020 2020 706f 696e 7432 3a20 766f 6c6d      point2: volm
-00010c60: 646c 722e 506f 696e 7433 442c 2069 6e73  dlr.Point3D, ins
-00010c70: 6964 653d 4661 6c73 6529 3a0a 0a20 2020  ide=False):..   
-00010c80: 2020 2020 206e 6577 5f70 7269 6d69 7469       new_primiti
-00010c90: 7665 7320 3d20 636f 6e74 6f75 722e 6578  ves = contour.ex
-00010ca0: 7472 6163 745f 7769 7468 5f70 6f69 6e74  tract_with_point
-00010cb0: 7328 706f 696e 7431 2c20 706f 696e 7432  s(point1, point2
-00010cc0: 2c20 696e 7369 6465 290a 2020 2020 2020  , inside).      
-00010cd0: 2020 636f 6e74 6f75 7273 203d 205b 636c    contours = [cl
-00010ce0: 7328 6e65 775f 7072 696d 6974 6976 6573  s(new_primitives
-00010cf0: 295d 0a20 2020 2020 2020 2072 6574 7572  )].        retur
-00010d00: 6e20 636f 6e74 6f75 7273 0a0a 2020 2020  n contours..    
-00010d10: 6465 6620 6375 745f 6279 5f6c 696e 6573  def cut_by_lines
-00010d20: 6567 6d65 6e74 7328 7365 6c66 2c20 6c69  egments(self, li
-00010d30: 6e65 733a 204c 6973 745b 766f 6c6d 646c  nes: List[volmdl
-00010d40: 722e 6564 6765 732e 4c69 6e65 5365 676d  r.edges.LineSegm
-00010d50: 656e 7432 445d 293a 0a20 2020 2020 2020  ent2D]):.       
-00010d60: 2023 2066 6f72 2063 2069 6e20 6c69 6e65   # for c in line
-00010d70: 733a 0a20 2020 2020 2020 2023 2020 2020  s:.        #    
-00010d80: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-00010d90: 6365 2863 2c20 766f 6c6d 646c 722e 6564  ce(c, volmdlr.ed
-00010da0: 6765 732e 4c69 6e65 5365 676d 656e 7432  ges.LineSegment2
-00010db0: 4429 3a0a 2020 2020 2020 2020 2320 2020  D):.        #   
-00010dc0: 2020 2020 2020 7261 6973 6520 4b65 7945        raise KeyE
-00010dd0: 7272 6f72 280a 2020 2020 2020 2020 2320  rror(.        # 
-00010de0: 2020 2020 2020 2020 2020 2020 2763 6f6e              'con
-00010df0: 746f 7572 206d 7573 7420 6265 2061 206c  tour must be a l
-00010e00: 6973 7420 6f66 204c 696e 6553 6567 6d65  ist of LineSegme
-00010e10: 6e74 3244 206f 626a 6563 7427 290a 0a20  nt2D object').. 
-00010e20: 2020 2020 2020 2063 7574 5f6c 696e 6573         cut_lines
-00010e30: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-00010e40: 7220 6375 745f 6c73 2069 6e20 6c69 6e65  r cut_ls in line
-00010e50: 733a 0a20 2020 2020 2020 2020 2020 2063  s:.            c
-00010e60: 7574 5f6c 696e 6573 2e61 7070 656e 6428  ut_lines.append(
-00010e70: 6375 745f 6c73 2e74 6f5f 6c69 6e65 2829  cut_ls.to_line()
-00010e80: 290a 0a20 2020 2020 2020 2063 6f6e 746f  )..        conto
-00010e90: 7572 5f74 6f5f 6375 7420 3d20 5b73 656c  ur_to_cut = [sel
-00010ea0: 665d 0a20 2020 2020 2020 2066 6f72 206c  f].        for l
-00010eb0: 696e 6520 696e 2063 7574 5f6c 696e 6573  ine in cut_lines
-00010ec0: 3a0a 2020 2020 2020 2020 2020 2020 6e65  :.            ne
-00010ed0: 775f 636f 6e74 6f75 725f 746f 5f63 7574  w_contour_to_cut
-00010ee0: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
-00010ef0: 2020 666f 7220 636f 6e74 6f75 7220 696e    for contour in
-00010f00: 2063 6f6e 746f 7572 5f74 6f5f 6375 743a   contour_to_cut:
-00010f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010f20: 2063 7320 3d20 636f 6e74 6f75 722e 6375   cs = contour.cu
-00010f30: 745f 6279 5f6c 696e 6528 6c69 6e65 290a  t_by_line(line).
-00010f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f50: 6e65 775f 636f 6e74 6f75 725f 746f 5f63  new_contour_to_c
-00010f60: 7574 2e65 7874 656e 6428 6373 290a 2020  ut.extend(cs).  
-00010f70: 2020 2020 2020 2020 2020 636f 6e74 6f75            contou
-00010f80: 725f 746f 5f63 7574 2e65 7874 656e 6428  r_to_cut.extend(
-00010f90: 6e65 775f 636f 6e74 6f75 725f 746f 5f63  new_contour_to_c
-00010fa0: 7574 290a 0a20 2020 2020 2020 2070 3120  ut)..        p1 
-00010fb0: 3d20 436f 6e74 6f75 7232 4428 6c69 6e65  = Contour2D(line
-00010fc0: 7329 2e63 656e 7465 725f 6f66 5f6d 6173  s).center_of_mas
-00010fd0: 7328 290a 2020 2020 2020 2020 6469 7374  s().        dist
-00010fe0: 5f6d 696e 203d 206d 6174 682e 696e 660a  _min = math.inf.
-00010ff0: 2020 2020 2020 2020 666f 7220 636f 6e74          for cont
-00011000: 6f75 7220 696e 2063 6f6e 746f 7572 5f74  our in contour_t
-00011010: 6f5f 6375 743a 0a20 2020 2020 2020 2020  o_cut:.         
-00011020: 2020 2069 6620 636f 6e74 6f75 722e 6172     if contour.ar
-00011030: 6561 2829 203e 2031 652d 3130 3a0a 2020  ea() > 1e-10:.  
-00011040: 2020 2020 2020 2020 2020 2020 2020 7030                p0
-00011050: 203d 2063 6f6e 746f 7572 2e63 656e 7465   = contour.cente
-00011060: 725f 6f66 5f6d 6173 7328 290a 2020 2020  r_of_mass().    
-00011070: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-00011080: 302e 706f 696e 745f 6469 7374 616e 6365  0.point_distance
-00011090: 2870 3129 203c 2064 6973 745f 6d69 6e3a  (p1) < dist_min:
-000110a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000110b0: 2020 2020 2063 5f6f 7074 6920 3d20 636f       c_opti = co
-000110c0: 6e74 6f75 720a 2020 2020 2020 2020 2020  ntour.          
-000110d0: 2020 2020 2020 2020 2020 6469 7374 5f6d            dist_m
-000110e0: 696e 203d 2070 302e 706f 696e 745f 6469  in = p0.point_di
-000110f0: 7374 616e 6365 2870 3129 0a20 2020 2020  stance(p1).     
-00011100: 2020 2072 6574 7572 6e20 635f 6f70 7469     return c_opti
-00011110: 0a0a 2020 2020 6465 6620 7265 7061 6972  ..    def repair
-00011120: 5f63 7574 5f63 6f6e 746f 7572 2873 656c  _cut_contour(sel
-00011130: 662c 206e 2c20 696e 7465 7273 6563 7469  f, n, intersecti
-00011140: 6f6e 732c 206c 696e 6529 3a0a 2020 2020  ons, line):.    
-00011150: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00011160: 4368 6f6f 7365 3a0a 2020 2020 2020 2020  Choose:.        
-00011170: 6e3d 3020 666f 7220 5369 6465 2031 3a20  n=0 for Side 1: 
-00011180: 6f70 706f 7369 7465 2073 6964 6520 6f66  opposite side of
-00011190: 2062 6567 696e 6e69 6e67 206f 6620 636f   beginning of co
-000111a0: 6e74 6f75 720a 2020 2020 2020 2020 6e3d  ntour.        n=
-000111b0: 3120 666f 7220 5369 6465 2032 3a20 7374  1 for Side 2: st
-000111c0: 6172 7420 6f66 2063 6f6e 746f 7572 2074  art of contour t
-000111d0: 6f20 6669 7273 7420 696e 7465 7273 6563  o first intersec
-000111e0: 7420 2869 3d30 2920 616e 640a 2020 2020  t (i=0) and.    
-000111f0: 2020 2020 2069 206f 6464 2074 6f20 692b       i odd to i+
-00011200: 3120 6576 656e 0a20 2020 2020 2020 2022  1 even.        "
-00011210: 2222 0a20 2020 2020 2020 2069 6620 6e20  "".        if n 
-00011220: 6e6f 7420 696e 205b 302c 2031 5d3a 0a20  not in [0, 1]:. 
-00011230: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00011240: 2056 616c 7565 4572 726f 720a 0a20 2020   ValueError..   
-00011250: 2020 2020 206e 5f69 6e74 6572 203d 206c       n_inter = l
-00011260: 656e 2869 6e74 6572 7365 6374 696f 6e73  en(intersections
-00011270: 290a 2020 2020 2020 2020 636f 6e74 6f75  ).        contou
-00011280: 7273 203d 205b 5d0a 2020 2020 2020 2020  rs = [].        
-00011290: 2320 7072 696d 6974 6976 6573 5f73 706c  # primitives_spl
-000112a0: 6974 203d 205b 7072 696d 6974 6976 652e  it = [primitive.
-000112b0: 7370 6c69 7428 706f 696e 7429 0a20 2020  split(point).   
-000112c0: 2020 2020 2023 2020 2020 2020 2020 2020       #          
-000112d0: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-000112e0: 6f69 6e74 2c20 7072 696d 6974 6976 6520  oint, primitive 
-000112f0: 696e 2069 6e74 6572 7365 6374 696f 6e73  in intersections
-00011300: 5d0a 2020 2020 2020 2020 7820 3d20 5b28  ].        x = [(
-00011310: 6970 2c20 6c69 6e65 2e61 6273 6369 7373  ip, line.absciss
-00011320: 6128 706f 696e 7429 290a 2020 2020 2020  a(point)).      
-00011330: 2020 2020 2020 2066 6f72 2069 702c 2028         for ip, (
-00011340: 706f 696e 742c 205f 2920 696e 2065 6e75  point, _) in enu
-00011350: 6d65 7261 7465 2869 6e74 6572 7365 6374  merate(intersect
-00011360: 696f 6e73 295d 0a20 2020 2020 2020 2023  ions)].        #
-00011370: 2069 6e74 6572 7365 6374 696f 6e5f 746f   intersection_to
-00011380: 5f70 7269 6d69 7469 7665 735f 696e 6465  _primitives_inde
-00011390: 7820 3d20 7b0a 2020 2020 2020 2020 2320  x = {.        # 
-000113a0: 2020 2020 693a 2073 656c 662e 7072 696d      i: self.prim
-000113b0: 6974 6976 6573 2e69 6e64 6578 2870 7269  itives.index(pri
-000113c0: 6d69 7469 7665 290a 2020 2020 2020 2020  mitive).        
-000113d0: 2320 2020 2020 666f 7220 692c 2028 5f2c  #     for i, (_,
-000113e0: 2070 7269 6d69 7469 7665 2920 696e 2065   primitive) in e
-000113f0: 6e75 6d65 7261 7465 2869 6e74 6572 7365  numerate(interse
-00011400: 6374 696f 6e73 297d 0a20 2020 2020 2020  ctions)}.       
-00011410: 2073 6f72 7465 645f 696e 7465 725f 696e   sorted_inter_in
-00011420: 6465 7820 3d20 5b78 5b30 5d20 666f 7220  dex = [x[0] for 
-00011430: 7820 696e 2073 6f72 7465 6428 782c 206b  x in sorted(x, k
-00011440: 6579 3d6c 616d 6264 6120 703a 2070 5b31  ey=lambda p: p[1
-00011450: 5d29 5d0a 2020 2020 2020 2020 736f 7274  ])].        sort
-00011460: 6564 5f69 6e74 6572 5f69 6e64 6578 5f64  ed_inter_index_d
-00011470: 6963 7420 3d20 7b69 3a20 6969 2066 6f72  ict = {i: ii for
-00011480: 2069 692c 2069 2069 6e0a 2020 2020 2020   ii, i in.      
-00011490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114a0: 2020 2020 2020 2020 2020 2020 2065 6e75               enu
-000114b0: 6d65 7261 7465 2873 6f72 7465 645f 696e  merate(sorted_in
-000114c0: 7465 725f 696e 6465 7829 7d0a 2020 2020  ter_index)}.    
-000114d0: 2020 2020 736f 7274 6564 5f69 6e74 6572      sorted_inter
-000114e0: 5f69 6e64 6578 5f64 6963 745b 6e5f 696e  _index_dict[n_in
-000114f0: 7465 725d 203d 2073 6f72 7465 645f 696e  ter] = sorted_in
-00011500: 7465 725f 696e 6465 785f 6469 6374 5b30  ter_index_dict[0
-00011510: 5d0a 2020 2020 2020 2020 6966 206e 203d  ].        if n =
-00011520: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00011530: 2069 6e74 6572 7365 6374 696f 6e73 2e61   intersections.a
-00011540: 7070 656e 6428 696e 7465 7273 6563 7469  ppend(intersecti
-00011550: 6f6e 735b 305d 290a 0a20 2020 2020 2020  ons[0])..       
-00011560: 2072 656d 6169 6e69 6e67 5f74 7261 6e73   remaining_trans
-00011570: 6974 696f 6e73 203d 206c 6973 7428 7261  itions = list(ra
-00011580: 6e67 6528 6e5f 696e 7465 7220 2f2f 2032  nge(n_inter // 2
-00011590: 2929 0a20 2020 2020 2020 2023 2065 6e63  )).        # enc
-000115a0: 6c6f 7369 6e67 5f74 7261 6e73 6974 696f  losing_transitio
-000115b0: 6e73 203d 207b 7d0a 2020 2020 2020 2020  ns = {}.        
-000115c0: 7768 696c 6520 6c65 6e28 7265 6d61 696e  while len(remain
-000115d0: 696e 675f 7472 616e 7369 7469 6f6e 7329  ing_transitions)
-000115e0: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-000115f0: 2020 6e62 5f6d 6178 5f65 6e63 6c6f 7365    nb_max_enclose
-00011600: 645f 7472 616e 7369 7469 6f6e 7320 3d20  d_transitions = 
-00011610: 2d31 0a20 2020 2020 2020 2020 2020 2065  -1.            e
-00011620: 6e63 6c6f 7365 645f 7472 616e 7369 7469  nclosed_transiti
-00011630: 6f6e 7320 3d20 7b7d 0a20 2020 2020 2020  ons = {}.       
-00011640: 2020 2020 2066 6f72 2069 7420 696e 2072       for it in r
-00011650: 656d 6169 6e69 6e67 5f74 7261 6e73 6974  emaining_transit
-00011660: 696f 6e73 3a0a 2020 2020 2020 2020 2020  ions:.          
-00011670: 2020 2020 2020 6931 203d 2073 6f72 7465        i1 = sorte
-00011680: 645f 696e 7465 725f 696e 6465 785f 6469  d_inter_index_di
-00011690: 6374 5b32 202a 2069 7420 2b20 6e5d 0a20  ct[2 * it + n]. 
-000116a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000116b0: 3220 3d20 736f 7274 6564 5f69 6e74 6572  2 = sorted_inter
-000116c0: 5f69 6e64 6578 5f64 6963 745b 3220 2a20  _index_dict[2 * 
-000116d0: 6974 202b 2031 202b 206e 5d0a 2020 2020  it + 1 + n].    
-000116e0: 2020 2020 2020 2020 2020 2020 6e65 7420              net 
-000116f0: 3d20 6162 7328 6932 202d 2069 3129 202d  = abs(i2 - i1) -
-00011700: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
-00011710: 2020 2069 6620 6e65 7420 3e20 6e62 5f6d     if net > nb_m
-00011720: 6178 5f65 6e63 6c6f 7365 645f 7472 616e  ax_enclosed_tran
-00011730: 7369 7469 6f6e 733a 0a20 2020 2020 2020  sitions:.       
-00011740: 2020 2020 2020 2020 2020 2020 206e 625f               nb_
-00011750: 6d61 785f 656e 636c 6f73 6564 5f74 7261  max_enclosed_tra
-00011760: 6e73 6974 696f 6e73 203d 206e 6574 0a20  nsitions = net. 
-00011770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011780: 2020 2062 6573 745f 7472 616e 7369 7469     best_transiti
-00011790: 6f6e 203d 2069 740a 2020 2020 2020 2020  on = it.        
-000117a0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-000117b0: 3120 3c20 6932 3a0a 2020 2020 2020 2020  1 < i2:.        
+00010360: 2020 2020 2020 2020 6e61 6d65 3d73 656c          name=sel
+00010370: 662e 6e61 6d65 290a 0a20 2020 2064 6566  f.name)..    def
+00010380: 2069 735f 696e 7369 6465 2873 656c 662c   is_inside(self,
+00010390: 2063 6f6e 746f 7572 3229 3a0a 2020 2020   contour2):.    
+000103a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000103b0: 5665 7269 6669 6573 2069 6620 6120 636f  Verifies if a co
+000103c0: 6e74 6f75 7220 6973 2069 6e73 6964 6520  ntour is inside 
+000103d0: 616e 6f74 6865 7220 636f 6e74 6f75 7220  another contour 
+000103e0: 7065 7269 6d69 7465 722c 2069 6e63 6c75  perimiter, inclu
+000103f0: 6469 6e67 2074 6865 2065 6467 6573 2e0a  ding the edges..
+00010400: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00010410: 733a 2054 7275 6520 6f72 2046 616c 7365  s: True or False
+00010420: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00010430: 2020 2020 2069 6620 636f 6e74 6f75 7232       if contour2
+00010440: 2e61 7265 6128 2920 3e20 7365 6c66 2e61  .area() > self.a
+00010450: 7265 6128 293a 0a20 2020 2020 2020 2020  rea():.         
+00010460: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
+00010470: 2020 2020 2020 2020 706f 696e 7473 5f63          points_c
+00010480: 6f6e 746f 7572 3220 3d20 5b5d 0a20 2020  ontour2 = [].   
+00010490: 2020 2020 2066 6f72 2070 7269 6d20 696e       for prim in
+000104a0: 2063 6f6e 746f 7572 322e 7072 696d 6974   contour2.primit
+000104b0: 6976 6573 3a0a 2020 2020 2020 2020 2020  ives:.          
+000104c0: 2020 6966 2070 7269 6d2e 7374 6172 7420    if prim.start 
+000104d0: 6e6f 7420 696e 2070 6f69 6e74 735f 636f  not in points_co
+000104e0: 6e74 6f75 7232 3a0a 2020 2020 2020 2020  ntour2:.        
+000104f0: 2020 2020 2020 2020 706f 696e 7473 5f63          points_c
+00010500: 6f6e 746f 7572 322e 6170 7065 6e64 2870  ontour2.append(p
+00010510: 7269 6d2e 7374 6172 7429 0a20 2020 2020  rim.start).     
+00010520: 2020 2020 2020 2069 6620 7072 696d 2e65         if prim.e
+00010530: 6e64 206e 6f74 2069 6e20 706f 696e 7473  nd not in points
+00010540: 5f63 6f6e 746f 7572 323a 0a20 2020 2020  _contour2:.     
+00010550: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
+00010560: 735f 636f 6e74 6f75 7232 2e61 7070 656e  s_contour2.appen
+00010570: 6428 7072 696d 2e65 6e64 290a 2020 2020  d(prim.end).    
+00010580: 2020 2020 2020 2020 706f 696e 7473 5f63          points_c
+00010590: 6f6e 746f 7572 322e 6578 7465 6e64 2870  ontour2.extend(p
+000105a0: 7269 6d2e 6469 7363 7265 7469 7a61 7469  rim.discretizati
+000105b0: 6f6e 5f70 6f69 6e74 7328 6e75 6d62 6572  on_points(number
+000105c0: 5f70 6f69 6e74 733d 3130 2929 0a20 2020  _points=10)).   
+000105d0: 2020 2020 2066 6f72 2070 6f69 6e74 2069       for point i
+000105e0: 6e20 706f 696e 7473 5f63 6f6e 746f 7572  n points_contour
+000105f0: 323a 0a20 2020 2020 2020 2020 2020 2069  2:.            i
+00010600: 6620 6e6f 7420 7365 6c66 2e70 6f69 6e74  f not self.point
+00010610: 5f62 656c 6f6e 6773 2870 6f69 6e74 2920  _belongs(point) 
+00010620: 616e 6420 6e6f 7420 7365 6c66 2e70 6f69  and not self.poi
+00010630: 6e74 5f6f 7665 725f 636f 6e74 6f75 7228  nt_over_contour(
+00010640: 706f 696e 742c 2061 6273 5f74 6f6c 3d31  point, abs_tol=1
+00010650: 652d 3729 3a0a 2020 2020 2020 2020 2020  e-7):.          
+00010660: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+00010670: 7365 0a20 2020 2020 2020 2072 6574 7572  se.        retur
+00010680: 6e20 5472 7565 0a0a 2020 2020 6465 6620  n True..    def 
+00010690: 696e 7665 7274 6564 5f70 7269 6d69 7469  inverted_primiti
+000106a0: 7665 7328 7365 6c66 293a 0a20 2020 2020  ves(self):.     
+000106b0: 2020 206e 6577 5f70 7269 6d69 7469 7665     new_primitive
+000106c0: 7320 3d20 5b5d 0a20 2020 2020 2020 2066  s = [].        f
+000106d0: 6f72 2070 7269 6d20 696e 2073 656c 662e  or prim in self.
+000106e0: 7072 696d 6974 6976 6573 5b3a 3a2d 315d  primitives[::-1]
+000106f0: 3a0a 2020 2020 2020 2020 2020 2020 6e65  :.            ne
+00010700: 775f 7072 696d 6974 6976 6573 2e61 7070  w_primitives.app
+00010710: 656e 6428 7072 696d 2e72 6576 6572 7365  end(prim.reverse
+00010720: 2829 290a 2020 2020 2020 2020 7265 7475  ()).        retu
+00010730: 726e 206e 6577 5f70 7269 6d69 7469 7665  rn new_primitive
+00010740: 730a 0a20 2020 2064 6566 2069 6e76 6572  s..    def inver
+00010750: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
+00010760: 2072 6574 7572 6e20 436f 6e74 6f75 7232   return Contour2
+00010770: 4428 7365 6c66 2e69 6e76 6572 7465 645f  D(self.inverted_
+00010780: 7072 696d 6974 6976 6573 2829 290a 0a20  primitives()).. 
+00010790: 2020 2064 6566 2069 6e76 6572 745f 696e     def invert_in
+000107a0: 706c 6163 6528 7365 6c66 293a 0a20 2020  place(self):.   
+000107b0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+000107c0: 726e 2822 2769 6e70 6c61 6365 2720 6d65  rn("'inplace' me
+000107d0: 7468 6f64 7320 6172 6520 6465 7072 6563  thods are deprec
+000107e0: 6174 6564 2e20 5573 6520 6120 6e6f 7420  ated. Use a not 
+000107f0: 696e 706c 6163 6520 6d65 7468 6f64 2069  inplace method i
+00010800: 6e73 7465 6164 2e22 2c20 4465 7072 6563  nstead.", Deprec
+00010810: 6174 696f 6e57 6172 6e69 6e67 290a 0a20  ationWarning).. 
+00010820: 2020 2020 2020 2073 656c 662e 7072 696d         self.prim
+00010830: 6974 6976 6573 203d 2073 656c 662e 696e  itives = self.in
+00010840: 7665 7274 6564 5f70 7269 6d69 7469 7665  verted_primitive
+00010850: 7328 290a 0a20 2020 2064 6566 2072 616e  s()..    def ran
+00010860: 646f 6d5f 706f 696e 745f 696e 7369 6465  dom_point_inside
+00010870: 2873 656c 662c 2069 6e63 6c75 6465 5f65  (self, include_e
+00010880: 6467 655f 706f 696e 7473 3a20 626f 6f6c  dge_points: bool
+00010890: 203d 2046 616c 7365 293a 0a20 2020 2020   = False):.     
+000108a0: 2020 2022 2222 0a20 2020 2020 2020 2046     """.        F
+000108b0: 696e 6473 2061 2072 616e 646f 6d20 706f  inds a random po
+000108c0: 696e 7420 696e 7369 6465 2074 6865 2070  int inside the p
+000108d0: 6f6c 7967 6f6e 2e0a 0a20 2020 2020 2020  olygon...       
+000108e0: 203a 7061 7261 6d20 696e 636c 7564 655f   :param include_
+000108f0: 6564 6765 5f70 6f69 6e74 733a 2043 686f  edge_points: Cho
+00010900: 6f73 6520 5472 7565 2069 6620 796f 7520  ose True if you 
+00010910: 7761 6e74 2074 6f20 636f 6e73 6964 6572  want to consider
+00010920: 2061 2070 6f69 6e74 206f 6e20 7468 6520   a point on the 
+00010930: 706f 6c79 676f 6e20 696e 7369 6465 2e0a  polygon inside..
+00010940: 2020 2020 2020 2020 3a74 7970 6520 696e          :type in
+00010950: 636c 7564 655f 6564 6765 5f70 6f69 6e74  clude_edge_point
+00010960: 733a 2062 6f6f 6c0a 2020 2020 2020 2020  s: bool.        
+00010970: 3a72 6574 7572 6e3a 2041 2072 616e 646f  :return: A rando
+00010980: 6d20 706f 696e 7420 696e 7369 6465 2074  m point inside t
+00010990: 6865 2070 6f6c 7967 6f6e 0a20 2020 2020  he polygon.     
+000109a0: 2020 203a 7274 7970 653a 2060 766f 6c6d     :rtype: `volm
+000109b0: 646c 722e 506f 696e 7432 4460 0a20 2020  dlr.Point2D`.   
+000109c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000109d0: 2078 5f6d 696e 2c20 785f 6d61 782c 2079   x_min, x_max, y
+000109e0: 5f6d 696e 2c20 795f 6d61 7820 3d20 7365  _min, y_max = se
+000109f0: 6c66 2e62 6f75 6e64 696e 675f 7265 6374  lf.bounding_rect
+00010a00: 616e 676c 652e 626f 756e 6473 2829 0a20  angle.bounds(). 
+00010a10: 2020 2020 2020 2066 6f72 205f 2069 6e20         for _ in 
+00010a20: 7261 6e67 6528 3230 3030 293a 0a20 2020  range(2000):.   
+00010a30: 2020 2020 2020 2020 2070 203d 2076 6f6c           p = vol
+00010a40: 6d64 6c72 2e50 6f69 6e74 3244 2e72 616e  mdlr.Point2D.ran
+00010a50: 646f 6d28 785f 6d69 6e2c 2078 5f6d 6178  dom(x_min, x_max
+00010a60: 2c20 795f 6d69 6e2c 2079 5f6d 6178 290a  , y_min, y_max).
+00010a70: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00010a80: 656c 662e 706f 696e 745f 6265 6c6f 6e67  elf.point_belong
+00010a90: 7328 702c 2069 6e63 6c75 6465 5f65 6467  s(p, include_edg
+00010aa0: 655f 706f 696e 7473 293a 0a20 2020 2020  e_points):.     
+00010ab0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00010ac0: 6e20 700a 2020 2020 2020 2020 7072 696e  n p.        prin
+00010ad0: 7428 5472 7565 290a 2020 2020 2020 2020  t(True).        
+00010ae0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00010af0: 2827 436f 756c 6420 6e6f 7420 6669 6e64  ('Could not find
+00010b00: 2061 2070 6f69 6e74 2069 6e73 6964 6527   a point inside'
+00010b10: 290a 0a20 2020 2064 6566 206f 7264 6572  )..    def order
+00010b20: 5f63 6f6e 746f 7572 2873 656c 6629 3a0a  _contour(self):.
+00010b30: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00010b40: 6973 5f6f 7264 6572 6564 2829 206f 7220  is_ordered() or 
+00010b50: 6c65 6e28 7365 6c66 2e70 7269 6d69 7469  len(self.primiti
+00010b60: 7665 7329 203c 2032 3a0a 2020 2020 2020  ves) < 2:.      
+00010b70: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00010b80: 660a 2020 2020 2020 2020 6e65 775f 7072  f.        new_pr
+00010b90: 696d 6974 6976 6573 203d 2073 656c 662e  imitives = self.
+00010ba0: 6f72 6465 7269 6e67 5f63 6f6e 746f 7572  ordering_contour
+00010bb0: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+00010bc0: 7072 696d 6974 6976 6573 203d 206e 6577  primitives = new
+00010bd0: 5f70 7269 6d69 7469 7665 730a 0a20 2020  _primitives..   
+00010be0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00010bf0: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+00010c00: 6f64 0a20 2020 2064 6566 2065 7874 7261  od.    def extra
+00010c10: 6374 5f63 6f6e 746f 7572 7328 636c 732c  ct_contours(cls,
+00010c20: 2063 6f6e 746f 7572 2c20 706f 696e 7431   contour, point1
+00010c30: 3a20 766f 6c6d 646c 722e 506f 696e 7433  : volmdlr.Point3
+00010c40: 442c 0a20 2020 2020 2020 2020 2020 2020  D,.             
+00010c50: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+00010c60: 7432 3a20 766f 6c6d 646c 722e 506f 696e  t2: volmdlr.Poin
+00010c70: 7433 442c 2069 6e73 6964 653d 4661 6c73  t3D, inside=Fals
+00010c80: 6529 3a0a 0a20 2020 2020 2020 206e 6577  e):..        new
+00010c90: 5f70 7269 6d69 7469 7665 7320 3d20 636f  _primitives = co
+00010ca0: 6e74 6f75 722e 6578 7472 6163 745f 7769  ntour.extract_wi
+00010cb0: 7468 5f70 6f69 6e74 7328 706f 696e 7431  th_points(point1
+00010cc0: 2c20 706f 696e 7432 2c20 696e 7369 6465  , point2, inside
+00010cd0: 290a 2020 2020 2020 2020 636f 6e74 6f75  ).        contou
+00010ce0: 7273 203d 205b 636c 7328 6e65 775f 7072  rs = [cls(new_pr
+00010cf0: 696d 6974 6976 6573 295d 0a20 2020 2020  imitives)].     
+00010d00: 2020 2072 6574 7572 6e20 636f 6e74 6f75     return contou
+00010d10: 7273 0a0a 2020 2020 6465 6620 6375 745f  rs..    def cut_
+00010d20: 6279 5f6c 696e 6573 6567 6d65 6e74 7328  by_linesegments(
+00010d30: 7365 6c66 2c20 6c69 6e65 733a 204c 6973  self, lines: Lis
+00010d40: 745b 766f 6c6d 646c 722e 6564 6765 732e  t[volmdlr.edges.
+00010d50: 4c69 6e65 5365 676d 656e 7432 445d 293a  LineSegment2D]):
+00010d60: 0a20 2020 2020 2020 2023 2066 6f72 2063  .        # for c
+00010d70: 2069 6e20 6c69 6e65 733a 0a20 2020 2020   in lines:.     
+00010d80: 2020 2023 2020 2020 2069 6620 6e6f 7420     #     if not 
+00010d90: 6973 696e 7374 616e 6365 2863 2c20 766f  isinstance(c, vo
+00010da0: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
+00010db0: 5365 676d 656e 7432 4429 3a0a 2020 2020  Segment2D):.    
+00010dc0: 2020 2020 2320 2020 2020 2020 2020 7261      #         ra
+00010dd0: 6973 6520 4b65 7945 7272 6f72 280a 2020  ise KeyError(.  
+00010de0: 2020 2020 2020 2320 2020 2020 2020 2020        #         
+00010df0: 2020 2020 2763 6f6e 746f 7572 206d 7573      'contour mus
+00010e00: 7420 6265 2061 206c 6973 7420 6f66 204c  t be a list of L
+00010e10: 696e 6553 6567 6d65 6e74 3244 206f 626a  ineSegment2D obj
+00010e20: 6563 7427 290a 0a20 2020 2020 2020 2063  ect')..        c
+00010e30: 7574 5f6c 696e 6573 203d 205b 5d0a 2020  ut_lines = [].  
+00010e40: 2020 2020 2020 666f 7220 6375 745f 6c73        for cut_ls
+00010e50: 2069 6e20 6c69 6e65 733a 0a20 2020 2020   in lines:.     
+00010e60: 2020 2020 2020 2063 7574 5f6c 696e 6573         cut_lines
+00010e70: 2e61 7070 656e 6428 6375 745f 6c73 2e74  .append(cut_ls.t
+00010e80: 6f5f 6c69 6e65 2829 290a 0a20 2020 2020  o_line())..     
+00010e90: 2020 2063 6f6e 746f 7572 5f74 6f5f 6375     contour_to_cu
+00010ea0: 7420 3d20 5b73 656c 665d 0a20 2020 2020  t = [self].     
+00010eb0: 2020 2066 6f72 206c 696e 6520 696e 2063     for line in c
+00010ec0: 7574 5f6c 696e 6573 3a0a 2020 2020 2020  ut_lines:.      
+00010ed0: 2020 2020 2020 6e65 775f 636f 6e74 6f75        new_contou
+00010ee0: 725f 746f 5f63 7574 203d 205b 5d0a 2020  r_to_cut = [].  
+00010ef0: 2020 2020 2020 2020 2020 666f 7220 636f            for co
+00010f00: 6e74 6f75 7220 696e 2063 6f6e 746f 7572  ntour in contour
+00010f10: 5f74 6f5f 6375 743a 0a20 2020 2020 2020  _to_cut:.       
+00010f20: 2020 2020 2020 2020 2063 7320 3d20 636f           cs = co
+00010f30: 6e74 6f75 722e 6375 745f 6279 5f6c 696e  ntour.cut_by_lin
+00010f40: 6528 6c69 6e65 290a 2020 2020 2020 2020  e(line).        
+00010f50: 2020 2020 2020 2020 6e65 775f 636f 6e74          new_cont
+00010f60: 6f75 725f 746f 5f63 7574 2e65 7874 656e  our_to_cut.exten
+00010f70: 6428 6373 290a 2020 2020 2020 2020 2020  d(cs).          
+00010f80: 2020 636f 6e74 6f75 725f 746f 5f63 7574    contour_to_cut
+00010f90: 2e65 7874 656e 6428 6e65 775f 636f 6e74  .extend(new_cont
+00010fa0: 6f75 725f 746f 5f63 7574 290a 0a20 2020  our_to_cut)..   
+00010fb0: 2020 2020 2070 3120 3d20 436f 6e74 6f75       p1 = Contou
+00010fc0: 7232 4428 6c69 6e65 7329 2e63 656e 7465  r2D(lines).cente
+00010fd0: 725f 6f66 5f6d 6173 7328 290a 2020 2020  r_of_mass().    
+00010fe0: 2020 2020 6469 7374 5f6d 696e 203d 206d      dist_min = m
+00010ff0: 6174 682e 696e 660a 2020 2020 2020 2020  ath.inf.        
+00011000: 666f 7220 636f 6e74 6f75 7220 696e 2063  for contour in c
+00011010: 6f6e 746f 7572 5f74 6f5f 6375 743a 0a20  ontour_to_cut:. 
+00011020: 2020 2020 2020 2020 2020 2069 6620 636f             if co
+00011030: 6e74 6f75 722e 6172 6561 2829 203e 2031  ntour.area() > 1
+00011040: 652d 3130 3a0a 2020 2020 2020 2020 2020  e-10:.          
+00011050: 2020 2020 2020 7030 203d 2063 6f6e 746f        p0 = conto
+00011060: 7572 2e63 656e 7465 725f 6f66 5f6d 6173  ur.center_of_mas
+00011070: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+00011080: 2020 2020 6966 2070 302e 706f 696e 745f      if p0.point_
+00011090: 6469 7374 616e 6365 2870 3129 203c 2064  distance(p1) < d
+000110a0: 6973 745f 6d69 6e3a 0a20 2020 2020 2020  ist_min:.       
+000110b0: 2020 2020 2020 2020 2020 2020 2063 5f6f               c_o
+000110c0: 7074 6920 3d20 636f 6e74 6f75 720a 2020  pti = contour.  
+000110d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000110e0: 2020 6469 7374 5f6d 696e 203d 2070 302e    dist_min = p0.
+000110f0: 706f 696e 745f 6469 7374 616e 6365 2870  point_distance(p
+00011100: 3129 0a20 2020 2020 2020 2072 6574 7572  1).        retur
+00011110: 6e20 635f 6f70 7469 0a0a 2020 2020 6465  n c_opti..    de
+00011120: 6620 7265 7061 6972 5f63 7574 5f63 6f6e  f repair_cut_con
+00011130: 746f 7572 2873 656c 662c 206e 2c20 696e  tour(self, n, in
+00011140: 7465 7273 6563 7469 6f6e 732c 206c 696e  tersections, lin
+00011150: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
+00011160: 2020 2020 2020 2020 4368 6f6f 7365 3a0a          Choose:.
+00011170: 2020 2020 2020 2020 6e3d 3020 666f 7220          n=0 for 
+00011180: 5369 6465 2031 3a20 6f70 706f 7369 7465  Side 1: opposite
+00011190: 2073 6964 6520 6f66 2062 6567 696e 6e69   side of beginni
+000111a0: 6e67 206f 6620 636f 6e74 6f75 720a 2020  ng of contour.  
+000111b0: 2020 2020 2020 6e3d 3120 666f 7220 5369        n=1 for Si
+000111c0: 6465 2032 3a20 7374 6172 7420 6f66 2063  de 2: start of c
+000111d0: 6f6e 746f 7572 2074 6f20 6669 7273 7420  ontour to first 
+000111e0: 696e 7465 7273 6563 7420 2869 3d30 2920  intersect (i=0) 
+000111f0: 616e 640a 2020 2020 2020 2020 2069 206f  and.         i o
+00011200: 6464 2074 6f20 692b 3120 6576 656e 0a20  dd to i+1 even. 
+00011210: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00011220: 2020 2069 6620 6e20 6e6f 7420 696e 205b     if n not in [
+00011230: 302c 2031 5d3a 0a20 2020 2020 2020 2020  0, 1]:.         
+00011240: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00011250: 726f 720a 0a20 2020 2020 2020 206e 5f69  ror..        n_i
+00011260: 6e74 6572 203d 206c 656e 2869 6e74 6572  nter = len(inter
+00011270: 7365 6374 696f 6e73 290a 2020 2020 2020  sections).      
+00011280: 2020 636f 6e74 6f75 7273 203d 205b 5d0a    contours = [].
+00011290: 2020 2020 2020 2020 2320 7072 696d 6974          # primit
+000112a0: 6976 6573 5f73 706c 6974 203d 205b 7072  ives_split = [pr
+000112b0: 696d 6974 6976 652e 7370 6c69 7428 706f  imitive.split(po
+000112c0: 696e 7429 0a20 2020 2020 2020 2023 2020  int).        #  
+000112d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000112e0: 2020 2066 6f72 2070 6f69 6e74 2c20 7072     for point, pr
+000112f0: 696d 6974 6976 6520 696e 2069 6e74 6572  imitive in inter
+00011300: 7365 6374 696f 6e73 5d0a 2020 2020 2020  sections].      
+00011310: 2020 7820 3d20 5b28 6970 2c20 6c69 6e65    x = [(ip, line
+00011320: 2e61 6273 6369 7373 6128 706f 696e 7429  .abscissa(point)
+00011330: 290a 2020 2020 2020 2020 2020 2020 2066  ).             f
+00011340: 6f72 2069 702c 2028 706f 696e 742c 205f  or ip, (point, _
+00011350: 2920 696e 2065 6e75 6d65 7261 7465 2869  ) in enumerate(i
+00011360: 6e74 6572 7365 6374 696f 6e73 295d 0a20  ntersections)]. 
+00011370: 2020 2020 2020 2023 2069 6e74 6572 7365         # interse
+00011380: 6374 696f 6e5f 746f 5f70 7269 6d69 7469  ction_to_primiti
+00011390: 7665 735f 696e 6465 7820 3d20 7b0a 2020  ves_index = {.  
+000113a0: 2020 2020 2020 2320 2020 2020 693a 2073        #     i: s
+000113b0: 656c 662e 7072 696d 6974 6976 6573 2e69  elf.primitives.i
+000113c0: 6e64 6578 2870 7269 6d69 7469 7665 290a  ndex(primitive).
+000113d0: 2020 2020 2020 2020 2320 2020 2020 666f          #     fo
+000113e0: 7220 692c 2028 5f2c 2070 7269 6d69 7469  r i, (_, primiti
+000113f0: 7665 2920 696e 2065 6e75 6d65 7261 7465  ve) in enumerate
+00011400: 2869 6e74 6572 7365 6374 696f 6e73 297d  (intersections)}
+00011410: 0a20 2020 2020 2020 2073 6f72 7465 645f  .        sorted_
+00011420: 696e 7465 725f 696e 6465 7820 3d20 5b78  inter_index = [x
+00011430: 5b30 5d20 666f 7220 7820 696e 2073 6f72  [0] for x in sor
+00011440: 7465 6428 782c 206b 6579 3d6c 616d 6264  ted(x, key=lambd
+00011450: 6120 703a 2070 5b31 5d29 5d0a 2020 2020  a p: p[1])].    
+00011460: 2020 2020 736f 7274 6564 5f69 6e74 6572      sorted_inter
+00011470: 5f69 6e64 6578 5f64 6963 7420 3d20 7b69  _index_dict = {i
+00011480: 3a20 6969 2066 6f72 2069 692c 2069 2069  : ii for ii, i i
+00011490: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+000114a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000114b0: 2020 2020 2065 6e75 6d65 7261 7465 2873       enumerate(s
+000114c0: 6f72 7465 645f 696e 7465 725f 696e 6465  orted_inter_inde
+000114d0: 7829 7d0a 2020 2020 2020 2020 736f 7274  x)}.        sort
+000114e0: 6564 5f69 6e74 6572 5f69 6e64 6578 5f64  ed_inter_index_d
+000114f0: 6963 745b 6e5f 696e 7465 725d 203d 2073  ict[n_inter] = s
+00011500: 6f72 7465 645f 696e 7465 725f 696e 6465  orted_inter_inde
+00011510: 785f 6469 6374 5b30 5d0a 2020 2020 2020  x_dict[0].      
+00011520: 2020 6966 206e 203d 3d20 313a 0a20 2020    if n == 1:.   
+00011530: 2020 2020 2020 2020 2069 6e74 6572 7365           interse
+00011540: 6374 696f 6e73 2e61 7070 656e 6428 696e  ctions.append(in
+00011550: 7465 7273 6563 7469 6f6e 735b 305d 290a  tersections[0]).
+00011560: 0a20 2020 2020 2020 2072 656d 6169 6e69  .        remaini
+00011570: 6e67 5f74 7261 6e73 6974 696f 6e73 203d  ng_transitions =
+00011580: 206c 6973 7428 7261 6e67 6528 6e5f 696e   list(range(n_in
+00011590: 7465 7220 2f2f 2032 2929 0a20 2020 2020  ter // 2)).     
+000115a0: 2020 2023 2065 6e63 6c6f 7369 6e67 5f74     # enclosing_t
+000115b0: 7261 6e73 6974 696f 6e73 203d 207b 7d0a  ransitions = {}.
+000115c0: 2020 2020 2020 2020 7768 696c 6520 6c65          while le
+000115d0: 6e28 7265 6d61 696e 696e 675f 7472 616e  n(remaining_tran
+000115e0: 7369 7469 6f6e 7329 203e 2030 3a0a 2020  sitions) > 0:.  
+000115f0: 2020 2020 2020 2020 2020 6e62 5f6d 6178            nb_max
+00011600: 5f65 6e63 6c6f 7365 645f 7472 616e 7369  _enclosed_transi
+00011610: 7469 6f6e 7320 3d20 2d31 0a20 2020 2020  tions = -1.     
+00011620: 2020 2020 2020 2065 6e63 6c6f 7365 645f         enclosed_
+00011630: 7472 616e 7369 7469 6f6e 7320 3d20 7b7d  transitions = {}
+00011640: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00011650: 2069 7420 696e 2072 656d 6169 6e69 6e67   it in remaining
+00011660: 5f74 7261 6e73 6974 696f 6e73 3a0a 2020  _transitions:.  
+00011670: 2020 2020 2020 2020 2020 2020 2020 6931                i1
+00011680: 203d 2073 6f72 7465 645f 696e 7465 725f   = sorted_inter_
+00011690: 696e 6465 785f 6469 6374 5b32 202a 2069  index_dict[2 * i
+000116a0: 7420 2b20 6e5d 0a20 2020 2020 2020 2020  t + n].         
+000116b0: 2020 2020 2020 2069 3220 3d20 736f 7274         i2 = sort
+000116c0: 6564 5f69 6e74 6572 5f69 6e64 6578 5f64  ed_inter_index_d
+000116d0: 6963 745b 3220 2a20 6974 202b 2031 202b  ict[2 * it + 1 +
+000116e0: 206e 5d0a 2020 2020 2020 2020 2020 2020   n].            
+000116f0: 2020 2020 6e65 7420 3d20 6162 7328 6932      net = abs(i2
+00011700: 202d 2069 3129 202d 2031 0a20 2020 2020   - i1) - 1.     
+00011710: 2020 2020 2020 2020 2020 2069 6620 6e65             if ne
+00011720: 7420 3e20 6e62 5f6d 6178 5f65 6e63 6c6f  t > nb_max_enclo
+00011730: 7365 645f 7472 616e 7369 7469 6f6e 733a  sed_transitions:
+00011740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011750: 2020 2020 206e 625f 6d61 785f 656e 636c       nb_max_encl
+00011760: 6f73 6564 5f74 7261 6e73 6974 696f 6e73  osed_transitions
+00011770: 203d 206e 6574 0a20 2020 2020 2020 2020   = net.         
+00011780: 2020 2020 2020 2020 2020 2062 6573 745f             best_
+00011790: 7472 616e 7369 7469 6f6e 203d 2069 740a  transition = it.
+000117a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000117b0: 2020 2020 6966 2069 3120 3c20 6932 3a0a      if i1 < i2:.
 000117c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000117d0: 656e 636c 6f73 6564 5f74 7261 6e73 6974  enclosed_transit
-000117e0: 696f 6e73 5b69 745d 203d 205b 2869 202b  ions[it] = [(i +
-000117f0: 2061 6273 286e 202d 2031 2929 202f 2f20   abs(n - 1)) // 
-00011800: 3220 666f 7220 690a 2020 2020 2020 2020  2 for i.        
+000117d0: 2020 2020 2020 2020 656e 636c 6f73 6564          enclosed
+000117e0: 5f74 7261 6e73 6974 696f 6e73 5b69 745d  _transitions[it]
+000117f0: 203d 205b 2869 202b 2061 6273 286e 202d   = [(i + abs(n -
+00011800: 2031 2929 202f 2f20 3220 666f 7220 690a   1)) // 2 for i.
 00011810: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00011820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011830: 2020 2020 2020 2020 2020 2020 696e 2073              in s
-00011840: 6f72 7465 645f 696e 7465 725f 696e 6465  orted_inter_inde
-00011850: 785b 0a20 2020 2020 2020 2020 2020 2020  x[.             
+00011830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011840: 2020 2020 696e 2073 6f72 7465 645f 696e      in sorted_in
+00011850: 7465 725f 696e 6465 785b 0a20 2020 2020  ter_index[.     
 00011860: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00011870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011880: 2020 2020 2020 2069 3220 2d20 313a 6931         i2 - 1:i1
-00011890: 3a2d 325d 5d0a 2020 2020 2020 2020 2020  :-2]].          
-000118a0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-000118b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000118c0: 2020 2020 2020 2020 656e 636c 6f73 6564          enclosed
-000118d0: 5f74 7261 6e73 6974 696f 6e73 5b69 745d  _transitions[it]
-000118e0: 203d 205b 2869 202b 2061 6273 286e 202d   = [(i + abs(n -
-000118f0: 2031 2929 202f 2f20 3220 666f 7220 690a   1)) // 2 for i.
-00011900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011880: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00011890: 3220 2d20 313a 6931 3a2d 325d 5d0a 2020  2 - 1:i1:-2]].  
+000118a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000118b0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000118c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000118d0: 656e 636c 6f73 6564 5f74 7261 6e73 6974  enclosed_transit
+000118e0: 696f 6e73 5b69 745d 203d 205b 2869 202b  ions[it] = [(i +
+000118f0: 2061 6273 286e 202d 2031 2929 202f 2f20   abs(n - 1)) // 
+00011900: 3220 666f 7220 690a 2020 2020 2020 2020  2 for i.        
 00011910: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00011920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011930: 2020 2020 696e 2073 6f72 7465 645f 696e      in sorted_in
-00011940: 7465 725f 696e 6465 785b 0a20 2020 2020  ter_index[.     
-00011950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011930: 2020 2020 2020 2020 2020 2020 696e 2073              in s
+00011940: 6f72 7465 645f 696e 7465 725f 696e 6465  orted_inter_inde
+00011950: 785b 0a20 2020 2020 2020 2020 2020 2020  x[.             
 00011960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011970: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00011980: 3220 2b20 313a 6931 3a32 5d5d 0a0a 2020  2 + 1:i1:2]]..  
-00011990: 2020 2020 2020 2020 2020 7265 6d61 696e            remain
-000119a0: 696e 675f 7472 616e 7369 7469 6f6e 732e  ing_transitions.
-000119b0: 7265 6d6f 7665 2862 6573 745f 7472 616e  remove(best_tran
-000119c0: 7369 7469 6f6e 290a 2020 2020 2020 2020  sition).        
-000119d0: 2020 2020 706f 696e 745f 7374 6172 742c      point_start,
-000119e0: 2070 7269 6d69 7469 7665 3120 3d20 696e   primitive1 = in
-000119f0: 7465 7273 6563 7469 6f6e 735b 3220 2a20  tersections[2 * 
-00011a00: 6265 7374 5f74 7261 6e73 6974 696f 6e20  best_transition 
-00011a10: 2b20 6e5d 0a20 2020 2020 2020 2020 2020  + n].           
-00011a20: 2070 6f69 6e74 322c 2070 7269 6d69 7469   point2, primiti
-00011a30: 7665 3220 3d20 696e 7465 7273 6563 7469  ve2 = intersecti
-00011a40: 6f6e 735b 3220 2a20 6265 7374 5f74 7261  ons[2 * best_tra
-00011a50: 6e73 6974 696f 6e20 2b20 3120 2b20 6e5d  nsition + 1 + n]
-00011a60: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00011a70: 6d69 7469 7665 7320 3d20 7365 6c66 2e65  mitives = self.e
-00011a80: 7874 7261 6374 5f70 7269 6d69 7469 7665  xtract_primitive
-00011a90: 7328 706f 696e 745f 7374 6172 742c 2070  s(point_start, p
-00011aa0: 7269 6d69 7469 7665 312c 0a20 2020 2020  rimitive1,.     
-00011ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011980: 2020 2020 2020 2069 3220 2b20 313a 6931         i2 + 1:i1
+00011990: 3a32 5d5d 0a0a 2020 2020 2020 2020 2020  :2]]..          
+000119a0: 2020 7265 6d61 696e 696e 675f 7472 616e    remaining_tran
+000119b0: 7369 7469 6f6e 732e 7265 6d6f 7665 2862  sitions.remove(b
+000119c0: 6573 745f 7472 616e 7369 7469 6f6e 290a  est_transition).
+000119d0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+000119e0: 745f 7374 6172 742c 2070 7269 6d69 7469  t_start, primiti
+000119f0: 7665 3120 3d20 696e 7465 7273 6563 7469  ve1 = intersecti
+00011a00: 6f6e 735b 3220 2a20 6265 7374 5f74 7261  ons[2 * best_tra
+00011a10: 6e73 6974 696f 6e20 2b20 6e5d 0a20 2020  nsition + n].   
+00011a20: 2020 2020 2020 2020 2070 6f69 6e74 322c           point2,
+00011a30: 2070 7269 6d69 7469 7665 3220 3d20 696e   primitive2 = in
+00011a40: 7465 7273 6563 7469 6f6e 735b 3220 2a20  tersections[2 * 
+00011a50: 6265 7374 5f74 7261 6e73 6974 696f 6e20  best_transition 
+00011a60: 2b20 3120 2b20 6e5d 0a20 2020 2020 2020  + 1 + n].       
+00011a70: 2020 2020 2070 7269 6d69 7469 7665 7320       primitives 
+00011a80: 3d20 7365 6c66 2e65 7874 7261 6374 5f70  = self.extract_p
+00011a90: 7269 6d69 7469 7665 7328 706f 696e 745f  rimitives(point_
+00011aa0: 7374 6172 742c 2070 7269 6d69 7469 7665  start, primitive
+00011ab0: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
 00011ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ad0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
-00011ae0: 7432 2c20 7072 696d 6974 6976 6532 2c0a  t2, primitive2,.
-00011af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ae0: 2020 2020 706f 696e 7432 2c20 7072 696d      point2, prim
+00011af0: 6974 6976 6532 2c0a 2020 2020 2020 2020  itive2,.        
 00011b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00011b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011b20: 2069 6e73 6964 653d 6e6f 7420 6e29 0a20   inside=not n). 
-00011b30: 2020 2020 2020 2020 2020 206c 6173 745f             last_
-00011b40: 706f 696e 7420 3d20 706f 696e 7432 0a20  point = point2. 
-00011b50: 2020 2020 2020 2020 2020 2066 6f72 2074             for t
-00011b60: 7261 6e73 6974 696f 6e20 696e 2065 6e63  ransition in enc
-00011b70: 6c6f 7365 645f 7472 616e 7369 7469 6f6e  losed_transition
-00011b80: 735b 6265 7374 5f74 7261 6e73 6974 696f  s[best_transitio
-00011b90: 6e5d 3a0a 2020 2020 2020 2020 2020 2020  n]:.            
-00011ba0: 2020 2020 706f 696e 7431 2c20 7072 696d      point1, prim
-00011bb0: 6974 6976 6531 203d 2069 6e74 6572 7365  itive1 = interse
-00011bc0: 6374 696f 6e73 5b32 202a 2074 7261 6e73  ctions[2 * trans
-00011bd0: 6974 696f 6e20 2b20 6e5d 0a20 2020 2020  ition + n].     
-00011be0: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-00011bf0: 322c 2070 7269 6d69 7469 7665 3220 3d20  2, primitive2 = 
-00011c00: 696e 7465 7273 6563 7469 6f6e 735b 3220  intersections[2 
-00011c10: 2a20 7472 616e 7369 7469 6f6e 202b 2031  * transition + 1
-00011c20: 202b 206e 5d0a 2020 2020 2020 2020 2020   + n].          
-00011c30: 2020 2020 2020 7072 696d 6974 6976 6573        primitives
-00011c40: 2e61 7070 656e 6428 0a20 2020 2020 2020  .append(.       
-00011c50: 2020 2020 2020 2020 2020 2020 2076 6f6c               vol
-00011c60: 6d64 6c72 2e65 6467 6573 2e4c 696e 6553  mdlr.edges.LineS
-00011c70: 6567 6d65 6e74 3244 286c 6173 745f 706f  egment2D(last_po
-00011c80: 696e 742c 2070 6f69 6e74 3129 290a 2020  int, point1)).  
-00011c90: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00011ca0: 696d 6974 6976 6573 2e65 7874 656e 6428  imitives.extend(
-00011cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011cc0: 2020 2020 2073 656c 662e 6578 7472 6163       self.extrac
-00011cd0: 745f 7072 696d 6974 6976 6573 2870 6f69  t_primitives(poi
-00011ce0: 6e74 312c 2070 7269 6d69 7469 7665 312c  nt1, primitive1,
-00011cf0: 2070 6f69 6e74 322c 0a20 2020 2020 2020   point2,.       
-00011d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b20: 2020 2020 2020 2020 2069 6e73 6964 653d           inside=
+00011b30: 6e6f 7420 6e29 0a20 2020 2020 2020 2020  not n).         
+00011b40: 2020 206c 6173 745f 706f 696e 7420 3d20     last_point = 
+00011b50: 706f 696e 7432 0a20 2020 2020 2020 2020  point2.         
+00011b60: 2020 2066 6f72 2074 7261 6e73 6974 696f     for transitio
+00011b70: 6e20 696e 2065 6e63 6c6f 7365 645f 7472  n in enclosed_tr
+00011b80: 616e 7369 7469 6f6e 735b 6265 7374 5f74  ansitions[best_t
+00011b90: 7261 6e73 6974 696f 6e5d 3a0a 2020 2020  ransition]:.    
+00011ba0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+00011bb0: 7431 2c20 7072 696d 6974 6976 6531 203d  t1, primitive1 =
+00011bc0: 2069 6e74 6572 7365 6374 696f 6e73 5b32   intersections[2
+00011bd0: 202a 2074 7261 6e73 6974 696f 6e20 2b20   * transition + 
+00011be0: 6e5d 0a20 2020 2020 2020 2020 2020 2020  n].             
+00011bf0: 2020 2070 6f69 6e74 322c 2070 7269 6d69     point2, primi
+00011c00: 7469 7665 3220 3d20 696e 7465 7273 6563  tive2 = intersec
+00011c10: 7469 6f6e 735b 3220 2a20 7472 616e 7369  tions[2 * transi
+00011c20: 7469 6f6e 202b 2031 202b 206e 5d0a 2020  tion + 1 + n].  
+00011c30: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00011c40: 696d 6974 6976 6573 2e61 7070 656e 6428  imitives.append(
+00011c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011c60: 2020 2020 2076 6f6c 6d64 6c72 2e65 6467       volmdlr.edg
+00011c70: 6573 2e4c 696e 6553 6567 6d65 6e74 3244  es.LineSegment2D
+00011c80: 286c 6173 745f 706f 696e 742c 2070 6f69  (last_point, poi
+00011c90: 6e74 3129 290a 2020 2020 2020 2020 2020  nt1)).          
+00011ca0: 2020 2020 2020 7072 696d 6974 6976 6573        primitives
+00011cb0: 2e65 7874 656e 6428 0a20 2020 2020 2020  .extend(.       
+00011cc0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00011cd0: 662e 6578 7472 6163 745f 7072 696d 6974  f.extract_primit
+00011ce0: 6976 6573 2870 6f69 6e74 312c 2070 7269  ives(point1, pri
+00011cf0: 6d69 7469 7665 312c 2070 6f69 6e74 322c  mitive1, point2,
+00011d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00011d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d20: 2020 2020 2070 7269 6d69 7469 7665 322c       primitive2,
-00011d30: 2069 6e73 6964 653d 6e6f 7420 6e29 290a   inside=not n)).
-00011d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d50: 6c61 7374 5f70 6f69 6e74 203d 2070 6f69  last_point = poi
-00011d60: 6e74 320a 2020 2020 2020 2020 2020 2020  nt2.            
-00011d70: 2020 2020 6966 2074 7261 6e73 6974 696f      if transitio
-00011d80: 6e20 696e 2072 656d 6169 6e69 6e67 5f74  n in remaining_t
-00011d90: 7261 6e73 6974 696f 6e73 3a0a 2020 2020  ransitions:.    
-00011da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011db0: 7265 6d61 696e 696e 675f 7472 616e 7369  remaining_transi
-00011dc0: 7469 6f6e 732e 7265 6d6f 7665 2874 7261  tions.remove(tra
-00011dd0: 6e73 6974 696f 6e29 0a0a 2020 2020 2020  nsition)..      
-00011de0: 2020 2020 2020 7072 696d 6974 6976 6573        primitives
-00011df0: 2e61 7070 656e 6428 0a20 2020 2020 2020  .append(.       
-00011e00: 2020 2020 2020 2020 2076 6f6c 6d64 6c72           volmdlr
-00011e10: 2e65 6467 6573 2e4c 696e 6553 6567 6d65  .edges.LineSegme
-00011e20: 6e74 3244 286c 6173 745f 706f 696e 742c  nt2D(last_point,
-00011e30: 2070 6f69 6e74 5f73 7461 7274 2929 0a0a   point_start))..
-00011e40: 2020 2020 2020 2020 2020 2020 2320 706f              # po
-00011e50: 696e 7473 203d 2028 766f 6c6d 646c 722e  ints = (volmdlr.
-00011e60: 6564 6765 732e 4c69 6e65 5365 676d 656e  edges.LineSegmen
-00011e70: 7432 4428 6c61 7374 5f70 6f69 6e74 2c20  t2D(last_point, 
-00011e80: 706f 696e 745f 7374 6172 7429 292e 6469  point_start)).di
-00011e90: 7363 7265 7469 7365 2835 290a 2020 2020  scretise(5).    
-00011ea0: 2020 2020 2020 2020 2320 6c69 6e65 5f73          # line_s
-00011eb0: 6567 6d65 6e74 3d76 6f6c 6d64 6c72 2e65  egment=volmdlr.e
-00011ec0: 6467 6573 2e4c 696e 6553 6567 6d65 6e74  dges.LineSegment
-00011ed0: 3244 286c 6173 745f 706f 696e 742c 2070  2D(last_point, p
-00011ee0: 6f69 6e74 5f73 7461 7274 290a 2020 2020  oint_start).    
-00011ef0: 2020 2020 2020 2020 2320 666f 7220 7020          # for p 
-00011f00: 696e 2070 6f69 6e74 735b 313a 2d31 5d3a  in points[1:-1]:
-00011f10: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
-00011f20: 2020 2072 203d 206c 696e 655f 7365 676d     r = line_segm
-00011f30: 656e 742e 7370 6c69 7428 7029 0a20 2020  ent.split(p).   
-00011f40: 2020 2020 2020 2020 2023 2020 2020 2070           #     p
-00011f50: 7269 6d69 7469 7665 732e 6170 7065 6e64  rimitives.append
-00011f60: 2872 5b30 5d29 0a20 2020 2020 2020 2020  (r[0]).         
-00011f70: 2020 2023 2020 2020 206c 696e 655f 7365     #     line_se
-00011f80: 676d 656e 7420 3d20 725b 315d 0a20 2020  gment = r[1].   
-00011f90: 2020 2020 2020 2020 2023 2020 2020 2069           #     i
-00011fa0: 6620 7020 3d3d 2070 6f69 6e74 735b 2d32  f p == points[-2
-00011fb0: 5d3a 0a20 2020 2020 2020 2020 2020 2023  ]:.            #
-00011fc0: 2020 2020 2020 2020 2070 7269 6d69 7469           primiti
-00011fd0: 7665 732e 6170 7065 6e64 2872 5b31 5d29  ves.append(r[1])
-00011fe0: 0a0a 2020 2020 2020 2020 2020 2020 636f  ..            co
-00011ff0: 6e74 6f75 7220 3d20 436f 6e74 6f75 7232  ntour = Contour2
-00012000: 4428 7072 696d 6974 6976 6573 290a 2020  D(primitives).  
-00012010: 2020 2020 2020 2020 2020 636f 6e74 6f75            contou
-00012020: 722e 6f72 6465 725f 636f 6e74 6f75 7228  r.order_contour(
-00012030: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-00012040: 6e74 6f75 7273 2e61 7070 656e 6428 636f  ntours.append(co
-00012050: 6e74 6f75 7229 0a20 2020 2020 2020 2072  ntour).        r
-00012060: 6574 7572 6e20 636f 6e74 6f75 7273 0a0a  eturn contours..
-00012070: 2020 2020 6465 6620 6375 745f 6279 5f6c      def cut_by_l
-00012080: 696e 6528 7365 6c66 2c20 6c69 6e65 3a20  ine(self, line: 
-00012090: 766f 6c6d 646c 722e 6564 6765 732e 4c69  volmdlr.edges.Li
-000120a0: 6e65 3244 2920 2d3e 204c 6973 745b 2743  ne2D) -> List['C
-000120b0: 6f6e 746f 7572 3244 275d 3a0a 2020 2020  ontour2D']:.    
-000120c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000120d0: 3a70 6172 616d 206c 696e 653a 2054 6865  :param line: The
-000120e0: 206c 696e 6520 7573 6564 2074 6f20 6375   line used to cu
-000120f0: 7420 7468 6520 636f 6e74 6f75 722e 0a0a  t the contour...
-00012100: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00012110: 2041 206c 6973 7420 6f66 2072 6573 756c   A list of resul
-00012120: 7469 6e67 2063 6f6e 746f 7572 730a 2020  ting contours.  
-00012130: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00012140: 2020 696e 7465 7273 6563 7469 6f6e 7320    intersections 
-00012150: 3d20 7365 6c66 2e6c 696e 655f 6372 6f73  = self.line_cros
-00012160: 7369 6e67 7328 6c69 6e65 290a 2020 2020  sings(line).    
-00012170: 2020 2020 6966 206e 6f74 2069 6e74 6572      if not inter
-00012180: 7365 6374 696f 6e73 206f 7220 6c65 6e28  sections or len(
-00012190: 696e 7465 7273 6563 7469 6f6e 7329 203c  intersections) <
-000121a0: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-000121b0: 7265 7475 726e 205b 7365 6c66 5d0a 2020  return [self].  
-000121c0: 2020 2020 2020 706f 696e 7473 5f69 6e74        points_int
-000121d0: 6572 7365 6374 696f 6e73 203d 205b 706f  ersections = [po
-000121e0: 696e 7420 666f 7220 706f 696e 742c 2070  int for point, p
-000121f0: 7269 6d20 696e 2069 6e74 6572 7365 6374  rim in intersect
-00012200: 696f 6e73 5d0a 2020 2020 2020 2020 736f  ions].        so
-00012210: 7274 6564 5f70 6f69 6e74 7320 3d20 6c69  rted_points = li
-00012220: 6e65 2e73 6f72 745f 706f 696e 7473 5f61  ne.sort_points_a
-00012230: 6c6f 6e67 5f6c 696e 6528 706f 696e 7473  long_line(points
-00012240: 5f69 6e74 6572 7365 6374 696f 6e73 290a  _intersections).
-00012250: 2020 2020 2020 2020 6c69 7374 5f63 6f6e          list_con
-00012260: 746f 7572 7320 3d20 5b5d 0a20 2020 2020  tours = [].     
-00012270: 2020 2063 6f6e 746f 7572 5f74 6f5f 6375     contour_to_cu
-00012280: 7420 3d20 7365 6c66 0a0a 2020 2020 2020  t = self..      
-00012290: 2020 666f 7220 706f 696e 7431 2c20 706f    for point1, po
-000122a0: 696e 7432 2069 6e20 7a69 7028 736f 7274  int2 in zip(sort
-000122b0: 6564 5f70 6f69 6e74 735b 3a2d 315d 2c20  ed_points[:-1], 
-000122c0: 736f 7274 6564 5f70 6f69 6e74 735b 313a  sorted_points[1:
-000122d0: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-000122e0: 636c 6f73 696e 675f 6c69 6e65 203d 2076  closing_line = v
-000122f0: 6f6c 6d64 6c72 2e65 6467 6573 2e4c 696e  olmdlr.edges.Lin
-00012300: 6553 6567 6d65 6e74 3244 2870 6f69 6e74  eSegment2D(point
-00012310: 312c 2070 6f69 6e74 3229 0a20 2020 2020  1, point2).     
-00012320: 2020 2020 2020 2069 6620 6e6f 7420 636f         if not co
-00012330: 6e74 6f75 725f 746f 5f63 7574 2e70 6f69  ntour_to_cut.poi
-00012340: 6e74 5f62 656c 6f6e 6773 2863 6c6f 7369  nt_belongs(closi
-00012350: 6e67 5f6c 696e 652e 6d69 6464 6c65 5f70  ng_line.middle_p
-00012360: 6f69 6e74 2829 293a 0a20 2020 2020 2020  oint()):.       
-00012370: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-00012380: 650a 2020 2020 2020 2020 2020 2020 636c  e.            cl
-00012390: 6f73 696e 675f 636f 6e74 6f75 7220 3d20  osing_contour = 
-000123a0: 436f 6e74 6f75 7232 4428 5b63 6c6f 7369  Contour2D([closi
-000123b0: 6e67 5f6c 696e 655d 290a 2020 2020 2020  ng_line]).      
-000123c0: 2020 2020 2020 636f 6e74 6f75 7231 2c20        contour1, 
-000123d0: 636f 6e74 6f75 7232 203d 2063 6f6e 746f  contour2 = conto
-000123e0: 7572 5f74 6f5f 6375 742e 6765 745f 6469  ur_to_cut.get_di
-000123f0: 7669 6465 645f 636f 6e74 6f75 7273 2870  vided_contours(p
-00012400: 6f69 6e74 312c 2070 6f69 6e74 322c 2063  oint1, point2, c
-00012410: 6c6f 7369 6e67 5f63 6f6e 746f 7572 2c20  losing_contour, 
-00012420: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
-00012430: 2020 6966 2073 6f72 7465 645f 706f 696e    if sorted_poin
-00012440: 7473 2e69 6e64 6578 2870 6f69 6e74 3129  ts.index(point1)
-00012450: 202b 2032 203c 3d20 6c65 6e28 736f 7274   + 2 <= len(sort
-00012460: 6564 5f70 6f69 6e74 7329 202d 2031 3a0a  ed_points) - 1:.
-00012470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012480: 6966 2063 6f6e 746f 7572 312e 706f 696e  if contour1.poin
-00012490: 745f 6f76 6572 5f63 6f6e 746f 7572 2873  t_over_contour(s
-000124a0: 6f72 7465 645f 706f 696e 7473 5b73 6f72  orted_points[sor
-000124b0: 7465 645f 706f 696e 7473 2e69 6e64 6578  ted_points.index
-000124c0: 2870 6f69 6e74 3129 202b 2032 5d29 3a0a  (point1) + 2]):.
-000124d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000124e0: 2020 2020 636f 6e74 6f75 725f 746f 5f63      contour_to_c
-000124f0: 7574 203d 2063 6f6e 746f 7572 310a 2020  ut = contour1.  
-00012500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012510: 2020 6c69 7374 5f63 6f6e 746f 7572 732e    list_contours.
-00012520: 6170 7065 6e64 2863 6f6e 746f 7572 3229  append(contour2)
-00012530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012540: 2065 6c69 6620 636f 6e74 6f75 7232 2e70   elif contour2.p
-00012550: 6f69 6e74 5f6f 7665 725f 636f 6e74 6f75  oint_over_contou
-00012560: 7228 736f 7274 6564 5f70 6f69 6e74 735b  r(sorted_points[
-00012570: 736f 7274 6564 5f70 6f69 6e74 732e 696e  sorted_points.in
-00012580: 6465 7828 706f 696e 7431 2920 2b20 325d  dex(point1) + 2]
-00012590: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000125a0: 2020 2020 2020 2063 6f6e 746f 7572 5f74         contour_t
-000125b0: 6f5f 6375 7420 3d20 636f 6e74 6f75 7232  o_cut = contour2
-000125c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000125d0: 2020 2020 206c 6973 745f 636f 6e74 6f75       list_contou
-000125e0: 7273 2e61 7070 656e 6428 636f 6e74 6f75  rs.append(contou
-000125f0: 7231 290a 2020 2020 2020 2020 2020 2020  r1).            
-00012600: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00012610: 2020 2020 2020 6c69 7374 5f63 6f6e 746f        list_conto
-00012620: 7572 732e 6578 7465 6e64 285b 636f 6e74  urs.extend([cont
-00012630: 6f75 7231 2c20 636f 6e74 6f75 7232 5d29  our1, contour2])
-00012640: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00012650: 206c 6973 745f 636f 6e74 6f75 7273 0a0a   list_contours..
-00012660: 2020 2020 6465 6620 7370 6c69 745f 6279      def split_by
-00012670: 5f6c 696e 6528 7365 6c66 2c20 6c69 6e65  _line(self, line
-00012680: 3a20 766f 6c6d 646c 722e 6564 6765 732e  : volmdlr.edges.
-00012690: 4c69 6e65 3244 2920 2d3e 204c 6973 745b  Line2D) -> List[
-000126a0: 2743 6f6e 746f 7572 3244 275d 3a0a 2020  'Contour2D']:.  
-000126b0: 2020 2020 2020 696e 7465 7273 6563 7469        intersecti
-000126c0: 6f6e 7320 3d20 7365 6c66 2e6c 696e 655f  ons = self.line_
-000126d0: 6372 6f73 7369 6e67 7328 6c69 6e65 290a  crossings(line).
-000126e0: 2020 2020 2020 2020 696e 7465 7273 6563          intersec
-000126f0: 7469 6f6e 7320 3d20 5b70 6f69 6e74 2066  tions = [point f
-00012700: 6f72 2070 6f69 6e74 2c20 7072 696d 2069  or point, prim i
-00012710: 6e20 696e 7465 7273 6563 7469 6f6e 735d  n intersections]
-00012720: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00012730: 696e 7465 7273 6563 7469 6f6e 733a 0a20  intersections:. 
-00012740: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00012750: 6e20 5b73 656c 665d 0a20 2020 2020 2020  n [self].       
-00012760: 2069 6620 6c65 6e28 696e 7465 7273 6563   if len(intersec
-00012770: 7469 6f6e 7329 203c 2032 3a0a 2020 2020  tions) < 2:.    
-00012780: 2020 2020 2020 2020 6578 7472 6163 7465          extracte
-00012790: 645f 6f75 7465 7270 6f69 6e74 735f 636f  d_outerpoints_co
-000127a0: 6e74 6f75 7231 203d 205c 0a20 2020 2020  ntour1 = \.     
-000127b0: 2020 2020 2020 2020 2020 2076 6f6c 6d64             volmd
-000127c0: 6c72 2e77 6972 6573 2e43 6f6e 746f 7572  lr.wires.Contour
-000127d0: 3244 2e65 7874 7261 6374 5f63 6f6e 746f  2D.extract_conto
-000127e0: 7572 7328 7365 6c66 2c20 7365 6c66 2e70  urs(self, self.p
-000127f0: 7269 6d69 7469 7665 735b 305d 2e73 7461  rimitives[0].sta
-00012800: 7274 2c20 696e 7465 7273 6563 7469 6f6e  rt, intersection
-00012810: 735b 305d 2c20 5472 7565 295b 305d 0a20  s[0], True)[0]. 
-00012820: 2020 2020 2020 2020 2020 2065 7874 7261             extra
-00012830: 6374 6564 5f69 6e6e 6572 706f 696e 7473  cted_innerpoints
-00012840: 5f63 6f6e 746f 7572 3120 3d20 5c0a 2020  _contour1 = \.  
-00012850: 2020 2020 2020 2020 2020 2020 2020 766f                vo
-00012860: 6c6d 646c 722e 7769 7265 732e 436f 6e74  lmdlr.wires.Cont
-00012870: 6f75 7232 442e 6578 7472 6163 745f 636f  our2D.extract_co
-00012880: 6e74 6f75 7273 2873 656c 662c 2069 6e74  ntours(self, int
-00012890: 6572 7365 6374 696f 6e73 5b30 5d2c 2073  ersections[0], s
-000128a0: 656c 662e 7072 696d 6974 6976 6573 5b30  elf.primitives[0
-000128b0: 5d2e 656e 642c 2054 7275 6529 5b30 5d0a  ].end, True)[0].
-000128c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000128d0: 726e 2065 7874 7261 6374 6564 5f6f 7574  rn extracted_out
-000128e0: 6572 706f 696e 7473 5f63 6f6e 746f 7572  erpoints_contour
-000128f0: 312c 2065 7874 7261 6374 6564 5f69 6e6e  1, extracted_inn
-00012900: 6572 706f 696e 7473 5f63 6f6e 746f 7572  erpoints_contour
-00012910: 310a 2020 2020 2020 2020 656c 6966 206c  1.        elif l
-00012920: 656e 2869 6e74 6572 7365 6374 696f 6e73  en(intersections
-00012930: 2920 3d3d 2032 3a0a 2020 2020 2020 2020  ) == 2:.        
-00012940: 2020 2020 6578 7472 6163 7465 645f 6f75      extracted_ou
-00012950: 7465 7270 6f69 6e74 735f 636f 6e74 6f75  terpoints_contou
-00012960: 7231 203d 205c 0a20 2020 2020 2020 2020  r1 = \.         
-00012970: 2020 2020 2020 2076 6f6c 6d64 6c72 2e77         volmdlr.w
-00012980: 6972 6573 2e43 6f6e 746f 7572 3244 2e65  ires.Contour2D.e
-00012990: 7874 7261 6374 5f63 6f6e 746f 7572 7328  xtract_contours(
-000129a0: 7365 6c66 2c20 696e 7465 7273 6563 7469  self, intersecti
-000129b0: 6f6e 735b 305d 2c20 696e 7465 7273 6563  ons[0], intersec
-000129c0: 7469 6f6e 735b 315d 2c20 5472 7565 295b  tions[1], True)[
-000129d0: 305d 0a20 2020 2020 2020 2020 2020 2065  0].            e
-000129e0: 7874 7261 6374 6564 5f69 6e6e 6572 706f  xtracted_innerpo
-000129f0: 696e 7473 5f63 6f6e 746f 7572 3120 3d20  ints_contour1 = 
-00012a00: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-00012a10: 2020 766f 6c6d 646c 722e 7769 7265 732e    volmdlr.wires.
-00012a20: 436f 6e74 6f75 7232 442e 6578 7472 6163  Contour2D.extrac
-00012a30: 745f 636f 6e74 6f75 7273 2873 656c 662c  t_contours(self,
-00012a40: 2069 6e74 6572 7365 6374 696f 6e73 5b30   intersections[0
-00012a50: 5d2c 2069 6e74 6572 7365 6374 696f 6e73  ], intersections
-00012a60: 5b31 5d2c 2046 616c 7365 295b 305d 0a20  [1], False)[0]. 
-00012a70: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00012a80: 6e20 6578 7472 6163 7465 645f 696e 6e65  n extracted_inne
-00012a90: 7270 6f69 6e74 735f 636f 6e74 6f75 7231  rpoints_contour1
-00012aa0: 2c20 6578 7472 6163 7465 645f 6f75 7465  , extracted_oute
-00012ab0: 7270 6f69 6e74 735f 636f 6e74 6f75 7231  rpoints_contour1
-00012ac0: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
-00012ad0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-00012ae0: 6f72 0a0a 2020 2020 6465 6620 7370 6c69  or..    def spli
-00012af0: 745f 7265 6775 6c61 726c 7928 7365 6c66  t_regularly(self
-00012b00: 2c20 6e29 3a0a 2020 2020 2020 2020 2222  , n):.        ""
-00012b10: 220a 2020 2020 2020 2020 5370 6c69 7420  ".        Split 
-00012b20: 696e 206e 2073 6c69 6365 732e 0a0a 2020  in n slices...  
-00012b30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00012b40: 2020 785f 6d69 6e2c 2078 5f6d 6178 2c20    x_min, x_max, 
-00012b50: 5f2c 205f 203d 2073 656c 662e 626f 756e  _, _ = self.boun
-00012b60: 6469 6e67 5f72 6563 7461 6e67 6c65 2e62  ding_rectangle.b
-00012b70: 6f75 6e64 7328 290a 2020 2020 2020 2020  ounds().        
-00012b80: 6375 7474 6564 5f63 6f6e 746f 7572 7320  cutted_contours 
-00012b90: 3d20 5b5d 0a20 2020 2020 2020 2069 7465  = [].        ite
-00012ba0: 7261 7469 6f6e 5f63 6f6e 746f 7572 7320  ration_contours 
-00012bb0: 3d20 5b73 656c 665d 0a20 2020 2020 2020  = [self].       
-00012bc0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00012bd0: 6e20 2d20 3129 3a0a 2020 2020 2020 2020  n - 1):.        
-00012be0: 2020 2020 7869 203d 2078 5f6d 696e 202b      xi = x_min +
-00012bf0: 2028 6920 2b20 3129 202a 2028 785f 6d61   (i + 1) * (x_ma
-00012c00: 7820 2d20 785f 6d69 6e29 202f 206e 0a20  x - x_min) / n. 
-00012c10: 2020 2020 2020 2020 2020 2063 7574 5f6c             cut_l
-00012c20: 696e 6520 3d20 766f 6c6d 646c 722e 6564  ine = volmdlr.ed
-00012c30: 6765 732e 4c69 6e65 3244 2876 6f6c 6d64  ges.Line2D(volmd
-00012c40: 6c72 2e50 6f69 6e74 3244 2878 692c 2030  lr.Point2D(xi, 0
-00012c50: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00011d20: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00011d30: 6d69 7469 7665 322c 2069 6e73 6964 653d  mitive2, inside=
+00011d40: 6e6f 7420 6e29 290a 2020 2020 2020 2020  not n)).        
+00011d50: 2020 2020 2020 2020 6c61 7374 5f70 6f69          last_poi
+00011d60: 6e74 203d 2070 6f69 6e74 320a 2020 2020  nt = point2.    
+00011d70: 2020 2020 2020 2020 2020 2020 6966 2074              if t
+00011d80: 7261 6e73 6974 696f 6e20 696e 2072 656d  ransition in rem
+00011d90: 6169 6e69 6e67 5f74 7261 6e73 6974 696f  aining_transitio
+00011da0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+00011db0: 2020 2020 2020 2020 7265 6d61 696e 696e          remainin
+00011dc0: 675f 7472 616e 7369 7469 6f6e 732e 7265  g_transitions.re
+00011dd0: 6d6f 7665 2874 7261 6e73 6974 696f 6e29  move(transition)
+00011de0: 0a0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00011df0: 696d 6974 6976 6573 2e61 7070 656e 6428  imitives.append(
+00011e00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011e10: 2076 6f6c 6d64 6c72 2e65 6467 6573 2e4c   volmdlr.edges.L
+00011e20: 696e 6553 6567 6d65 6e74 3244 286c 6173  ineSegment2D(las
+00011e30: 745f 706f 696e 742c 2070 6f69 6e74 5f73  t_point, point_s
+00011e40: 7461 7274 2929 0a0a 2020 2020 2020 2020  tart))..        
+00011e50: 2020 2020 2320 706f 696e 7473 203d 2028      # points = (
+00011e60: 766f 6c6d 646c 722e 6564 6765 732e 4c69  volmdlr.edges.Li
+00011e70: 6e65 5365 676d 656e 7432 4428 6c61 7374  neSegment2D(last
+00011e80: 5f70 6f69 6e74 2c20 706f 696e 745f 7374  _point, point_st
+00011e90: 6172 7429 292e 6469 7363 7265 7469 7365  art)).discretise
+00011ea0: 2835 290a 2020 2020 2020 2020 2020 2020  (5).            
+00011eb0: 2320 6c69 6e65 5f73 6567 6d65 6e74 3d76  # line_segment=v
+00011ec0: 6f6c 6d64 6c72 2e65 6467 6573 2e4c 696e  olmdlr.edges.Lin
+00011ed0: 6553 6567 6d65 6e74 3244 286c 6173 745f  eSegment2D(last_
+00011ee0: 706f 696e 742c 2070 6f69 6e74 5f73 7461  point, point_sta
+00011ef0: 7274 290a 2020 2020 2020 2020 2020 2020  rt).            
+00011f00: 2320 666f 7220 7020 696e 2070 6f69 6e74  # for p in point
+00011f10: 735b 313a 2d31 5d3a 0a20 2020 2020 2020  s[1:-1]:.       
+00011f20: 2020 2020 2023 2020 2020 2072 203d 206c       #     r = l
+00011f30: 696e 655f 7365 676d 656e 742e 7370 6c69  ine_segment.spli
+00011f40: 7428 7029 0a20 2020 2020 2020 2020 2020  t(p).           
+00011f50: 2023 2020 2020 2070 7269 6d69 7469 7665   #     primitive
+00011f60: 732e 6170 7065 6e64 2872 5b30 5d29 0a20  s.append(r[0]). 
+00011f70: 2020 2020 2020 2020 2020 2023 2020 2020             #    
+00011f80: 206c 696e 655f 7365 676d 656e 7420 3d20   line_segment = 
+00011f90: 725b 315d 0a20 2020 2020 2020 2020 2020  r[1].           
+00011fa0: 2023 2020 2020 2069 6620 7020 3d3d 2070   #     if p == p
+00011fb0: 6f69 6e74 735b 2d32 5d3a 0a20 2020 2020  oints[-2]:.     
+00011fc0: 2020 2020 2020 2023 2020 2020 2020 2020         #        
+00011fd0: 2070 7269 6d69 7469 7665 732e 6170 7065   primitives.appe
+00011fe0: 6e64 2872 5b31 5d29 0a0a 2020 2020 2020  nd(r[1])..      
+00011ff0: 2020 2020 2020 636f 6e74 6f75 7220 3d20        contour = 
+00012000: 436f 6e74 6f75 7232 4428 7072 696d 6974  Contour2D(primit
+00012010: 6976 6573 290a 2020 2020 2020 2020 2020  ives).          
+00012020: 2020 636f 6e74 6f75 722e 6f72 6465 725f    contour.order_
+00012030: 636f 6e74 6f75 7228 290a 2020 2020 2020  contour().      
+00012040: 2020 2020 2020 636f 6e74 6f75 7273 2e61        contours.a
+00012050: 7070 656e 6428 636f 6e74 6f75 7229 0a20  ppend(contour). 
+00012060: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
+00012070: 6e74 6f75 7273 0a0a 2020 2020 6465 6620  ntours..    def 
+00012080: 6375 745f 6279 5f6c 696e 6528 7365 6c66  cut_by_line(self
+00012090: 2c20 6c69 6e65 3a20 766f 6c6d 646c 722e  , line: volmdlr.
+000120a0: 6564 6765 732e 4c69 6e65 3244 2920 2d3e  edges.Line2D) ->
+000120b0: 204c 6973 745b 2743 6f6e 746f 7572 3244   List['Contour2D
+000120c0: 275d 3a0a 2020 2020 2020 2020 2222 220a  ']:.        """.
+000120d0: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
+000120e0: 696e 653a 2054 6865 206c 696e 6520 7573  ine: The line us
+000120f0: 6564 2074 6f20 6375 7420 7468 6520 636f  ed to cut the co
+00012100: 6e74 6f75 722e 0a0a 2020 2020 2020 2020  ntour...        
+00012110: 3a72 6574 7572 6e3a 2041 206c 6973 7420  :return: A list 
+00012120: 6f66 2072 6573 756c 7469 6e67 2063 6f6e  of resulting con
+00012130: 746f 7572 730a 2020 2020 2020 2020 2222  tours.        ""
+00012140: 220a 2020 2020 2020 2020 696e 7465 7273  ".        inters
+00012150: 6563 7469 6f6e 7320 3d20 7365 6c66 2e6c  ections = self.l
+00012160: 696e 655f 6372 6f73 7369 6e67 7328 6c69  ine_crossings(li
+00012170: 6e65 290a 2020 2020 2020 2020 6966 206e  ne).        if n
+00012180: 6f74 2069 6e74 6572 7365 6374 696f 6e73  ot intersections
+00012190: 206f 7220 6c65 6e28 696e 7465 7273 6563   or len(intersec
+000121a0: 7469 6f6e 7329 203c 2032 3a0a 2020 2020  tions) < 2:.    
+000121b0: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+000121c0: 7365 6c66 5d0a 2020 2020 2020 2020 706f  self].        po
+000121d0: 696e 7473 5f69 6e74 6572 7365 6374 696f  ints_intersectio
+000121e0: 6e73 203d 205b 706f 696e 7420 666f 7220  ns = [point for 
+000121f0: 706f 696e 742c 2070 7269 6d20 696e 2069  point, prim in i
+00012200: 6e74 6572 7365 6374 696f 6e73 5d0a 2020  ntersections].  
+00012210: 2020 2020 2020 736f 7274 6564 5f70 6f69        sorted_poi
+00012220: 6e74 7320 3d20 6c69 6e65 2e73 6f72 745f  nts = line.sort_
+00012230: 706f 696e 7473 5f61 6c6f 6e67 5f6c 696e  points_along_lin
+00012240: 6528 706f 696e 7473 5f69 6e74 6572 7365  e(points_interse
+00012250: 6374 696f 6e73 290a 2020 2020 2020 2020  ctions).        
+00012260: 6c69 7374 5f63 6f6e 746f 7572 7320 3d20  list_contours = 
+00012270: 5b5d 0a20 2020 2020 2020 2063 6f6e 746f  [].        conto
+00012280: 7572 5f74 6f5f 6375 7420 3d20 7365 6c66  ur_to_cut = self
+00012290: 0a0a 2020 2020 2020 2020 666f 7220 706f  ..        for po
+000122a0: 696e 7431 2c20 706f 696e 7432 2069 6e20  int1, point2 in 
+000122b0: 7a69 7028 736f 7274 6564 5f70 6f69 6e74  zip(sorted_point
+000122c0: 735b 3a2d 315d 2c20 736f 7274 6564 5f70  s[:-1], sorted_p
+000122d0: 6f69 6e74 735b 313a 5d29 3a0a 2020 2020  oints[1:]):.    
+000122e0: 2020 2020 2020 2020 636c 6f73 696e 675f          closing_
+000122f0: 6c69 6e65 203d 2076 6f6c 6d64 6c72 2e65  line = volmdlr.e
+00012300: 6467 6573 2e4c 696e 6553 6567 6d65 6e74  dges.LineSegment
+00012310: 3244 2870 6f69 6e74 312c 2070 6f69 6e74  2D(point1, point
+00012320: 3229 0a20 2020 2020 2020 2020 2020 2069  2).            i
+00012330: 6620 6e6f 7420 636f 6e74 6f75 725f 746f  f not contour_to
+00012340: 5f63 7574 2e70 6f69 6e74 5f62 656c 6f6e  _cut.point_belon
+00012350: 6773 2863 6c6f 7369 6e67 5f6c 696e 652e  gs(closing_line.
+00012360: 6d69 6464 6c65 5f70 6f69 6e74 2829 293a  middle_point()):
+00012370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012380: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
+00012390: 2020 2020 2020 636c 6f73 696e 675f 636f        closing_co
+000123a0: 6e74 6f75 7220 3d20 436f 6e74 6f75 7232  ntour = Contour2
+000123b0: 4428 5b63 6c6f 7369 6e67 5f6c 696e 655d  D([closing_line]
+000123c0: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+000123d0: 6e74 6f75 7231 2c20 636f 6e74 6f75 7232  ntour1, contour2
+000123e0: 203d 2063 6f6e 746f 7572 5f74 6f5f 6375   = contour_to_cu
+000123f0: 742e 6765 745f 6469 7669 6465 645f 636f  t.get_divided_co
+00012400: 6e74 6f75 7273 2870 6f69 6e74 312c 2070  ntours(point1, p
+00012410: 6f69 6e74 322c 2063 6c6f 7369 6e67 5f63  oint2, closing_c
+00012420: 6f6e 746f 7572 2c20 5472 7565 290a 2020  ontour, True).  
+00012430: 2020 2020 2020 2020 2020 6966 2073 6f72            if sor
+00012440: 7465 645f 706f 696e 7473 2e69 6e64 6578  ted_points.index
+00012450: 2870 6f69 6e74 3129 202b 2032 203c 3d20  (point1) + 2 <= 
+00012460: 6c65 6e28 736f 7274 6564 5f70 6f69 6e74  len(sorted_point
+00012470: 7329 202d 2031 3a0a 2020 2020 2020 2020  s) - 1:.        
+00012480: 2020 2020 2020 2020 6966 2063 6f6e 746f          if conto
+00012490: 7572 312e 706f 696e 745f 6f76 6572 5f63  ur1.point_over_c
+000124a0: 6f6e 746f 7572 2873 6f72 7465 645f 706f  ontour(sorted_po
+000124b0: 696e 7473 5b73 6f72 7465 645f 706f 696e  ints[sorted_poin
+000124c0: 7473 2e69 6e64 6578 2870 6f69 6e74 3129  ts.index(point1)
+000124d0: 202b 2032 5d29 3a0a 2020 2020 2020 2020   + 2]):.        
+000124e0: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+000124f0: 6f75 725f 746f 5f63 7574 203d 2063 6f6e  our_to_cut = con
+00012500: 746f 7572 310a 2020 2020 2020 2020 2020  tour1.          
+00012510: 2020 2020 2020 2020 2020 6c69 7374 5f63            list_c
+00012520: 6f6e 746f 7572 732e 6170 7065 6e64 2863  ontours.append(c
+00012530: 6f6e 746f 7572 3229 0a20 2020 2020 2020  ontour2).       
+00012540: 2020 2020 2020 2020 2065 6c69 6620 636f           elif co
+00012550: 6e74 6f75 7232 2e70 6f69 6e74 5f6f 7665  ntour2.point_ove
+00012560: 725f 636f 6e74 6f75 7228 736f 7274 6564  r_contour(sorted
+00012570: 5f70 6f69 6e74 735b 736f 7274 6564 5f70  _points[sorted_p
+00012580: 6f69 6e74 732e 696e 6465 7828 706f 696e  oints.index(poin
+00012590: 7431 2920 2b20 325d 293a 0a20 2020 2020  t1) + 2]):.     
+000125a0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000125b0: 6f6e 746f 7572 5f74 6f5f 6375 7420 3d20  ontour_to_cut = 
+000125c0: 636f 6e74 6f75 7232 0a20 2020 2020 2020  contour2.       
+000125d0: 2020 2020 2020 2020 2020 2020 206c 6973               lis
+000125e0: 745f 636f 6e74 6f75 7273 2e61 7070 656e  t_contours.appen
+000125f0: 6428 636f 6e74 6f75 7231 290a 2020 2020  d(contour1).    
+00012600: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00012610: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00012620: 7374 5f63 6f6e 746f 7572 732e 6578 7465  st_contours.exte
+00012630: 6e64 285b 636f 6e74 6f75 7231 2c20 636f  nd([contour1, co
+00012640: 6e74 6f75 7232 5d29 0a0a 2020 2020 2020  ntour2])..      
+00012650: 2020 7265 7475 726e 206c 6973 745f 636f    return list_co
+00012660: 6e74 6f75 7273 0a0a 2020 2020 6465 6620  ntours..    def 
+00012670: 7370 6c69 745f 6279 5f6c 696e 6528 7365  split_by_line(se
+00012680: 6c66 2c20 6c69 6e65 3a20 766f 6c6d 646c  lf, line: volmdl
+00012690: 722e 6564 6765 732e 4c69 6e65 3244 2920  r.edges.Line2D) 
+000126a0: 2d3e 204c 6973 745b 2743 6f6e 746f 7572  -> List['Contour
+000126b0: 3244 275d 3a0a 2020 2020 2020 2020 696e  2D']:.        in
+000126c0: 7465 7273 6563 7469 6f6e 7320 3d20 7365  tersections = se
+000126d0: 6c66 2e6c 696e 655f 6372 6f73 7369 6e67  lf.line_crossing
+000126e0: 7328 6c69 6e65 290a 2020 2020 2020 2020  s(line).        
+000126f0: 696e 7465 7273 6563 7469 6f6e 7320 3d20  intersections = 
+00012700: 5b70 6f69 6e74 2066 6f72 2070 6f69 6e74  [point for point
+00012710: 2c20 7072 696d 2069 6e20 696e 7465 7273  , prim in inters
+00012720: 6563 7469 6f6e 735d 0a20 2020 2020 2020  ections].       
+00012730: 2069 6620 6e6f 7420 696e 7465 7273 6563   if not intersec
+00012740: 7469 6f6e 733a 0a20 2020 2020 2020 2020  tions:.         
+00012750: 2020 2072 6574 7572 6e20 5b73 656c 665d     return [self]
+00012760: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00012770: 696e 7465 7273 6563 7469 6f6e 7329 203c  intersections) <
+00012780: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
+00012790: 6578 7472 6163 7465 645f 6f75 7465 7270  extracted_outerp
+000127a0: 6f69 6e74 735f 636f 6e74 6f75 7231 203d  oints_contour1 =
+000127b0: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+000127c0: 2020 2076 6f6c 6d64 6c72 2e77 6972 6573     volmdlr.wires
+000127d0: 2e43 6f6e 746f 7572 3244 2e65 7874 7261  .Contour2D.extra
+000127e0: 6374 5f63 6f6e 746f 7572 7328 7365 6c66  ct_contours(self
+000127f0: 2c20 7365 6c66 2e70 7269 6d69 7469 7665  , self.primitive
+00012800: 735b 305d 2e73 7461 7274 2c20 696e 7465  s[0].start, inte
+00012810: 7273 6563 7469 6f6e 735b 305d 2c20 5472  rsections[0], Tr
+00012820: 7565 295b 305d 0a20 2020 2020 2020 2020  ue)[0].         
+00012830: 2020 2065 7874 7261 6374 6564 5f69 6e6e     extracted_inn
+00012840: 6572 706f 696e 7473 5f63 6f6e 746f 7572  erpoints_contour
+00012850: 3120 3d20 5c0a 2020 2020 2020 2020 2020  1 = \.          
+00012860: 2020 2020 2020 766f 6c6d 646c 722e 7769        volmdlr.wi
+00012870: 7265 732e 436f 6e74 6f75 7232 442e 6578  res.Contour2D.ex
+00012880: 7472 6163 745f 636f 6e74 6f75 7273 2873  tract_contours(s
+00012890: 656c 662c 2069 6e74 6572 7365 6374 696f  elf, intersectio
+000128a0: 6e73 5b30 5d2c 2073 656c 662e 7072 696d  ns[0], self.prim
+000128b0: 6974 6976 6573 5b30 5d2e 656e 642c 2054  itives[0].end, T
+000128c0: 7275 6529 5b30 5d0a 2020 2020 2020 2020  rue)[0].        
+000128d0: 2020 2020 7265 7475 726e 2065 7874 7261      return extra
+000128e0: 6374 6564 5f6f 7574 6572 706f 696e 7473  cted_outerpoints
+000128f0: 5f63 6f6e 746f 7572 312c 2065 7874 7261  _contour1, extra
+00012900: 6374 6564 5f69 6e6e 6572 706f 696e 7473  cted_innerpoints
+00012910: 5f63 6f6e 746f 7572 310a 2020 2020 2020  _contour1.      
+00012920: 2020 656c 6966 206c 656e 2869 6e74 6572    elif len(inter
+00012930: 7365 6374 696f 6e73 2920 3d3d 2032 3a0a  sections) == 2:.
+00012940: 2020 2020 2020 2020 2020 2020 6578 7472              extr
+00012950: 6163 7465 645f 6f75 7465 7270 6f69 6e74  acted_outerpoint
+00012960: 735f 636f 6e74 6f75 7231 203d 205c 0a20  s_contour1 = \. 
+00012970: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00012980: 6f6c 6d64 6c72 2e77 6972 6573 2e43 6f6e  olmdlr.wires.Con
+00012990: 746f 7572 3244 2e65 7874 7261 6374 5f63  tour2D.extract_c
+000129a0: 6f6e 746f 7572 7328 7365 6c66 2c20 696e  ontours(self, in
+000129b0: 7465 7273 6563 7469 6f6e 735b 305d 2c20  tersections[0], 
+000129c0: 696e 7465 7273 6563 7469 6f6e 735b 315d  intersections[1]
+000129d0: 2c20 5472 7565 295b 305d 0a20 2020 2020  , True)[0].     
+000129e0: 2020 2020 2020 2065 7874 7261 6374 6564         extracted
+000129f0: 5f69 6e6e 6572 706f 696e 7473 5f63 6f6e  _innerpoints_con
+00012a00: 746f 7572 3120 3d20 5c0a 2020 2020 2020  tour1 = \.      
+00012a10: 2020 2020 2020 2020 2020 766f 6c6d 646c            volmdl
+00012a20: 722e 7769 7265 732e 436f 6e74 6f75 7232  r.wires.Contour2
+00012a30: 442e 6578 7472 6163 745f 636f 6e74 6f75  D.extract_contou
+00012a40: 7273 2873 656c 662c 2069 6e74 6572 7365  rs(self, interse
+00012a50: 6374 696f 6e73 5b30 5d2c 2069 6e74 6572  ctions[0], inter
+00012a60: 7365 6374 696f 6e73 5b31 5d2c 2046 616c  sections[1], Fal
+00012a70: 7365 295b 305d 0a20 2020 2020 2020 2020  se)[0].         
+00012a80: 2020 2072 6574 7572 6e20 6578 7472 6163     return extrac
+00012a90: 7465 645f 696e 6e65 7270 6f69 6e74 735f  ted_innerpoints_
+00012aa0: 636f 6e74 6f75 7231 2c20 6578 7472 6163  contour1, extrac
+00012ab0: 7465 645f 6f75 7465 7270 6f69 6e74 735f  ted_outerpoints_
+00012ac0: 636f 6e74 6f75 7231 0a20 2020 2020 2020  contour1.       
+00012ad0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+00012ae0: 656e 7465 6445 7272 6f72 0a0a 2020 2020  entedError..    
+00012af0: 6465 6620 7370 6c69 745f 7265 6775 6c61  def split_regula
+00012b00: 726c 7928 7365 6c66 2c20 6e29 3a0a 2020  rly(self, n):.  
+00012b10: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00012b20: 2020 5370 6c69 7420 696e 206e 2073 6c69    Split in n sli
+00012b30: 6365 732e 0a0a 2020 2020 2020 2020 2222  ces...        ""
+00012b40: 220a 2020 2020 2020 2020 785f 6d69 6e2c  ".        x_min,
+00012b50: 2078 5f6d 6178 2c20 5f2c 205f 203d 2073   x_max, _, _ = s
+00012b60: 656c 662e 626f 756e 6469 6e67 5f72 6563  elf.bounding_rec
+00012b70: 7461 6e67 6c65 2e62 6f75 6e64 7328 290a  tangle.bounds().
+00012b80: 2020 2020 2020 2020 6375 7474 6564 5f63          cutted_c
+00012b90: 6f6e 746f 7572 7320 3d20 5b5d 0a20 2020  ontours = [].   
+00012ba0: 2020 2020 2069 7465 7261 7469 6f6e 5f63       iteration_c
+00012bb0: 6f6e 746f 7572 7320 3d20 5b73 656c 665d  ontours = [self]
+00012bc0: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+00012bd0: 6e20 7261 6e67 6528 6e20 2d20 3129 3a0a  n range(n - 1):.
+00012be0: 2020 2020 2020 2020 2020 2020 7869 203d              xi =
+00012bf0: 2078 5f6d 696e 202b 2028 6920 2b20 3129   x_min + (i + 1)
+00012c00: 202a 2028 785f 6d61 7820 2d20 785f 6d69   * (x_max - x_mi
+00012c10: 6e29 202f 206e 0a20 2020 2020 2020 2020  n) / n.         
+00012c20: 2020 2063 7574 5f6c 696e 6520 3d20 766f     cut_line = vo
+00012c30: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
+00012c40: 3244 2876 6f6c 6d64 6c72 2e50 6f69 6e74  2D(volmdlr.Point
+00012c50: 3244 2878 692c 2030 292c 0a20 2020 2020  2D(xi, 0),.     
 00012c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c70: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00012c80: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 2878  olmdlr.Point2D(x
-00012c90: 692c 2031 2929 0a0a 2020 2020 2020 2020  i, 1))..        
-00012ca0: 2020 2020 6974 6572 6174 696f 6e5f 636f      iteration_co
-00012cb0: 6e74 6f75 7273 3220 3d20 5b5d 0a20 2020  ntours2 = [].   
-00012cc0: 2020 2020 2020 2020 2066 6f72 2063 2069           for c i
-00012cd0: 6e20 6974 6572 6174 696f 6e5f 636f 6e74  n iteration_cont
-00012ce0: 6f75 7273 3a0a 2020 2020 2020 2020 2020  ours:.          
-00012cf0: 2020 2020 2020 7363 203d 2063 2e63 7574        sc = c.cut
-00012d00: 5f62 795f 6c69 6e65 2863 7574 5f6c 696e  _by_line(cut_lin
-00012d10: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-00012d20: 2020 206c 7363 203d 206c 656e 2873 6329     lsc = len(sc)
-00012d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012d40: 2069 6620 6c73 6320 3d3d 2031 3a0a 2020   if lsc == 1:.  
-00012d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d60: 2020 6375 7474 6564 5f63 6f6e 746f 7572    cutted_contour
-00012d70: 732e 6170 7065 6e64 2863 290a 2020 2020  s.append(c).    
-00012d80: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00012d90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00012da0: 2020 2020 2020 6974 6572 6174 696f 6e5f        iteration_
-00012db0: 636f 6e74 6f75 7273 322e 6578 7465 6e64  contours2.extend
-00012dc0: 2873 6329 0a0a 2020 2020 2020 2020 2020  (sc)..          
-00012dd0: 2020 6974 6572 6174 696f 6e5f 636f 6e74    iteration_cont
-00012de0: 6f75 7273 203d 2069 7465 7261 7469 6f6e  ours = iteration
-00012df0: 5f63 6f6e 746f 7572 7332 5b3a 5d0a 2020  _contours2[:].  
-00012e00: 2020 2020 2020 6375 7474 6564 5f63 6f6e        cutted_con
-00012e10: 746f 7572 732e 6578 7465 6e64 2869 7465  tours.extend(ite
-00012e20: 7261 7469 6f6e 5f63 6f6e 746f 7572 7329  ration_contours)
-00012e30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00012e40: 6375 7474 6564 5f63 6f6e 746f 7572 730a  cutted_contours.
-00012e50: 0a20 2020 2064 6566 2074 7269 616e 6775  .    def triangu
-00012e60: 6c61 7469 6f6e 2873 656c 6629 3a0a 2020  lation(self):.  
-00012e70: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00012e80: 662e 6772 6964 5f74 7269 616e 6775 6c61  f.grid_triangula
-00012e90: 7469 6f6e 286e 756d 6265 725f 706f 696e  tion(number_poin
-00012ea0: 7473 5f78 3d32 302c 0a20 2020 2020 2020  ts_x=20,.       
-00012eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012c80: 2020 2020 2020 2076 6f6c 6d64 6c72 2e50         volmdlr.P
+00012c90: 6f69 6e74 3244 2878 692c 2031 2929 0a0a  oint2D(xi, 1))..
+00012ca0: 2020 2020 2020 2020 2020 2020 6974 6572              iter
+00012cb0: 6174 696f 6e5f 636f 6e74 6f75 7273 3220  ation_contours2 
+00012cc0: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+00012cd0: 2066 6f72 2063 2069 6e20 6974 6572 6174   for c in iterat
+00012ce0: 696f 6e5f 636f 6e74 6f75 7273 3a0a 2020  ion_contours:.  
+00012cf0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+00012d00: 203d 2063 2e63 7574 5f62 795f 6c69 6e65   = c.cut_by_line
+00012d10: 2863 7574 5f6c 696e 6529 0a20 2020 2020  (cut_line).     
+00012d20: 2020 2020 2020 2020 2020 206c 7363 203d             lsc =
+00012d30: 206c 656e 2873 6329 0a20 2020 2020 2020   len(sc).       
+00012d40: 2020 2020 2020 2020 2069 6620 6c73 6320           if lsc 
+00012d50: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+00012d60: 2020 2020 2020 2020 2020 6375 7474 6564            cutted
+00012d70: 5f63 6f6e 746f 7572 732e 6170 7065 6e64  _contours.append
+00012d80: 2863 290a 2020 2020 2020 2020 2020 2020  (c).            
+00012d90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00012da0: 2020 2020 2020 2020 2020 2020 2020 6974                it
+00012db0: 6572 6174 696f 6e5f 636f 6e74 6f75 7273  eration_contours
+00012dc0: 322e 6578 7465 6e64 2873 6329 0a0a 2020  2.extend(sc)..  
+00012dd0: 2020 2020 2020 2020 2020 6974 6572 6174            iterat
+00012de0: 696f 6e5f 636f 6e74 6f75 7273 203d 2069  ion_contours = i
+00012df0: 7465 7261 7469 6f6e 5f63 6f6e 746f 7572  teration_contour
+00012e00: 7332 5b3a 5d0a 2020 2020 2020 2020 6375  s2[:].        cu
+00012e10: 7474 6564 5f63 6f6e 746f 7572 732e 6578  tted_contours.ex
+00012e20: 7465 6e64 2869 7465 7261 7469 6f6e 5f63  tend(iteration_c
+00012e30: 6f6e 746f 7572 7329 0a20 2020 2020 2020  ontours).       
+00012e40: 2072 6574 7572 6e20 6375 7474 6564 5f63   return cutted_c
+00012e50: 6f6e 746f 7572 730a 0a20 2020 2064 6566  ontours..    def
+00012e60: 2074 7269 616e 6775 6c61 7469 6f6e 2873   triangulation(s
+00012e70: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00012e80: 7475 726e 2073 656c 662e 6772 6964 5f74  turn self.grid_t
+00012e90: 7269 616e 6775 6c61 7469 6f6e 286e 756d  riangulation(num
+00012ea0: 6265 725f 706f 696e 7473 5f78 3d32 302c  ber_points_x=20,
+00012eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00012ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ed0: 6e75 6d62 6572 5f70 6f69 6e74 735f 793d  number_points_y=
-00012ee0: 3230 290a 0a20 2020 2064 6566 2074 6f5f  20)..    def to_
-00012ef0: 706f 6c79 676f 6e28 7365 6c66 2c20 616e  polygon(self, an
-00012f00: 676c 655f 7265 736f 6c75 7469 6f6e 2c20  gle_resolution, 
-00012f10: 6469 7363 7265 7469 7a65 5f6c 696e 653a  discretize_line:
-00012f20: 2062 6f6f 6c20 3d20 4661 6c73 6529 3a0a   bool = False):.
-00012f30: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00012f40: 2020 2020 5472 616e 7366 6f72 6d20 7468      Transform th
-00012f50: 6520 636f 6e74 6f75 7220 746f 2061 2070  e contour to a p
-00012f60: 6f6c 7967 6f6e 2e0a 0a20 2020 2020 2020  olygon...       
-00012f70: 203a 7061 7261 6d20 616e 676c 655f 7265   :param angle_re
-00012f80: 736f 6c75 7469 6f6e 3a20 4e75 6d62 6572  solution: Number
-00012f90: 206f 6620 706f 696e 7473 2070 6572 2072   of points per r
-00012fa0: 6164 6961 6e73 2e0a 2020 2020 2020 2020  adians..        
-00012fb0: 3a74 7970 6520 616e 676c 655f 7265 736f  :type angle_reso
-00012fc0: 6c75 7469 6f6e 3a20 666c 6f61 740a 2020  lution: float.  
-00012fd0: 2020 2020 2020 3a70 6172 616d 2064 6973        :param dis
-00012fe0: 6372 6574 697a 655f 6c69 6e65 3a20 426f  cretize_line: Bo
-00012ff0: 6f6c 6561 6e20 696e 6469 6361 7469 6e67  olean indicating
-00013000: 2077 6865 7468 6572 2074 6865 206c 696e   whether the lin
-00013010: 6520 7365 676d 656e 7473 2073 686f 756c  e segments shoul
-00013020: 6420 6265 2064 6973 6372 6574 697a 6564  d be discretized
-00013030: 206f 7220 6e6f 742e 0a20 2020 2020 2020   or not..       
-00013040: 203a 7479 7065 2064 6973 6372 6574 697a   :type discretiz
-00013050: 655f 6c69 6e65 3a20 626f 6f6c 0a20 2020  e_line: bool.   
-00013060: 2020 2020 203a 7265 7475 726e 3a20 5468       :return: Th
-00013070: 6520 6469 7363 7265 7469 7a65 6420 7665  e discretized ve
-00013080: 7273 696f 6e20 6f66 2074 6865 2063 6f6e  rsion of the con
-00013090: 746f 7572 2e0a 2020 2020 2020 2020 3a72  tour..        :r
-000130a0: 7479 7065 3a20 436c 6f73 6564 506f 6c79  type: ClosedPoly
-000130b0: 676f 6e32 440a 2020 2020 2020 2020 2222  gon2D.        ""
-000130c0: 220a 0a20 2020 2020 2020 2070 6f6c 7967  "..        polyg
-000130d0: 6f6e 5f70 6f69 6e74 7320 3d20 5b5d 0a0a  on_points = []..
-000130e0: 2020 2020 2020 2020 666f 7220 7072 696d          for prim
-000130f0: 6974 6976 6520 696e 2073 656c 662e 7072  itive in self.pr
-00013100: 696d 6974 6976 6573 3a0a 2020 2020 2020  imitives:.      
-00013110: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00013120: 6e63 6528 7072 696d 6974 6976 652c 2076  nce(primitive, v
-00013130: 6f6c 6d64 6c72 2e65 6467 6573 2e4c 696e  olmdlr.edges.Lin
-00013140: 6553 6567 6d65 6e74 3244 2920 616e 6420  eSegment2D) and 
-00013150: 6e6f 7420 6469 7363 7265 7469 7a65 5f6c  not discretize_l
-00013160: 696e 653a 0a20 2020 2020 2020 2020 2020  ine:.           
-00013170: 2020 2020 2070 6f6c 7967 6f6e 5f70 6f69       polygon_poi
-00013180: 6e74 732e 6170 7065 6e64 2870 7269 6d69  nts.append(primi
-00013190: 7469 7665 2e73 7461 7274 290a 2020 2020  tive.start).    
-000131a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000131b0: 2020 2020 2020 2020 2020 2020 2020 706f                po
-000131c0: 6c79 676f 6e5f 706f 696e 7473 2e65 7874  lygon_points.ext
-000131d0: 656e 6428 7072 696d 6974 6976 652e 6469  end(primitive.di
-000131e0: 7363 7265 7469 7a61 7469 6f6e 5f70 6f69  scretization_poi
-000131f0: 6e74 7328 616e 676c 655f 7265 736f 6c75  nts(angle_resolu
-00013200: 7469 6f6e 3d61 6e67 6c65 5f72 6573 6f6c  tion=angle_resol
-00013210: 7574 696f 6e29 5b3a 2d31 5d29 0a20 2020  ution)[:-1]).   
-00013220: 2020 2020 2072 6574 7572 6e20 436c 6f73       return Clos
-00013230: 6564 506f 6c79 676f 6e32 4428 706f 6c79  edPolygon2D(poly
-00013240: 676f 6e5f 706f 696e 7473 290a 0a20 2020  gon_points)..   
-00013250: 2064 6566 2067 7269 645f 7472 6961 6e67   def grid_triang
-00013260: 756c 6174 696f 6e28 7365 6c66 2c20 785f  ulation(self, x_
-00013270: 6465 6e73 6974 793a 2066 6c6f 6174 203d  density: float =
-00013280: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+00012ed0: 2020 2020 2020 2020 6e75 6d62 6572 5f70          number_p
+00012ee0: 6f69 6e74 735f 793d 3230 290a 0a20 2020  oints_y=20)..   
+00012ef0: 2064 6566 2074 6f5f 706f 6c79 676f 6e28   def to_polygon(
+00012f00: 7365 6c66 2c20 616e 676c 655f 7265 736f  self, angle_reso
+00012f10: 6c75 7469 6f6e 2c20 6469 7363 7265 7469  lution, discreti
+00012f20: 7a65 5f6c 696e 653a 2062 6f6f 6c20 3d20  ze_line: bool = 
+00012f30: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00012f40: 2222 220a 2020 2020 2020 2020 5472 616e  """.        Tran
+00012f50: 7366 6f72 6d20 7468 6520 636f 6e74 6f75  sform the contou
+00012f60: 7220 746f 2061 2070 6f6c 7967 6f6e 2e0a  r to a polygon..
+00012f70: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00012f80: 616e 676c 655f 7265 736f 6c75 7469 6f6e  angle_resolution
+00012f90: 3a20 4e75 6d62 6572 206f 6620 706f 696e  : Number of poin
+00012fa0: 7473 2070 6572 2072 6164 6961 6e73 2e0a  ts per radians..
+00012fb0: 2020 2020 2020 2020 3a74 7970 6520 616e          :type an
+00012fc0: 676c 655f 7265 736f 6c75 7469 6f6e 3a20  gle_resolution: 
+00012fd0: 666c 6f61 740a 2020 2020 2020 2020 3a70  float.        :p
+00012fe0: 6172 616d 2064 6973 6372 6574 697a 655f  aram discretize_
+00012ff0: 6c69 6e65 3a20 426f 6f6c 6561 6e20 696e  line: Boolean in
+00013000: 6469 6361 7469 6e67 2077 6865 7468 6572  dicating whether
+00013010: 2074 6865 206c 696e 6520 7365 676d 656e   the line segmen
+00013020: 7473 2073 686f 756c 6420 6265 2064 6973  ts should be dis
+00013030: 6372 6574 697a 6564 206f 7220 6e6f 742e  cretized or not.
+00013040: 0a20 2020 2020 2020 203a 7479 7065 2064  .        :type d
+00013050: 6973 6372 6574 697a 655f 6c69 6e65 3a20  iscretize_line: 
+00013060: 626f 6f6c 0a20 2020 2020 2020 203a 7265  bool.        :re
+00013070: 7475 726e 3a20 5468 6520 6469 7363 7265  turn: The discre
+00013080: 7469 7a65 6420 7665 7273 696f 6e20 6f66  tized version of
+00013090: 2074 6865 2063 6f6e 746f 7572 2e0a 2020   the contour..  
+000130a0: 2020 2020 2020 3a72 7479 7065 3a20 436c        :rtype: Cl
+000130b0: 6f73 6564 506f 6c79 676f 6e32 440a 2020  osedPolygon2D.  
+000130c0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+000130d0: 2020 2070 6f6c 7967 6f6e 5f70 6f69 6e74     polygon_point
+000130e0: 7320 3d20 5b5d 0a0a 2020 2020 2020 2020  s = []..        
+000130f0: 666f 7220 7072 696d 6974 6976 6520 696e  for primitive in
+00013100: 2073 656c 662e 7072 696d 6974 6976 6573   self.primitives
+00013110: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00013120: 2069 7369 6e73 7461 6e63 6528 7072 696d   isinstance(prim
+00013130: 6974 6976 652c 2076 6f6c 6d64 6c72 2e65  itive, volmdlr.e
+00013140: 6467 6573 2e4c 696e 6553 6567 6d65 6e74  dges.LineSegment
+00013150: 3244 2920 616e 6420 6e6f 7420 6469 7363  2D) and not disc
+00013160: 7265 7469 7a65 5f6c 696e 653a 0a20 2020  retize_line:.   
+00013170: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
+00013180: 7967 6f6e 5f70 6f69 6e74 732e 6170 7065  ygon_points.appe
+00013190: 6e64 2870 7269 6d69 7469 7665 2e73 7461  nd(primitive.sta
+000131a0: 7274 290a 2020 2020 2020 2020 2020 2020  rt).            
+000131b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000131c0: 2020 2020 2020 706f 6c79 676f 6e5f 706f        polygon_po
+000131d0: 696e 7473 2e65 7874 656e 6428 7072 696d  ints.extend(prim
+000131e0: 6974 6976 652e 6469 7363 7265 7469 7a61  itive.discretiza
+000131f0: 7469 6f6e 5f70 6f69 6e74 7328 616e 676c  tion_points(angl
+00013200: 655f 7265 736f 6c75 7469 6f6e 3d61 6e67  e_resolution=ang
+00013210: 6c65 5f72 6573 6f6c 7574 696f 6e29 5b3a  le_resolution)[:
+00013220: 2d31 5d29 0a20 2020 2020 2020 2072 6574  -1]).        ret
+00013230: 7572 6e20 436c 6f73 6564 506f 6c79 676f  urn ClosedPolygo
+00013240: 6e32 4428 706f 6c79 676f 6e5f 706f 696e  n2D(polygon_poin
+00013250: 7473 290a 0a20 2020 2064 6566 2067 7269  ts)..    def gri
+00013260: 645f 7472 6961 6e67 756c 6174 696f 6e28  d_triangulation(
+00013270: 7365 6c66 2c20 785f 6465 6e73 6974 793a  self, x_density:
+00013280: 2066 6c6f 6174 203d 204e 6f6e 652c 0a20   float = None,. 
 00013290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132a0: 2020 795f 6465 6e73 6974 793a 2066 6c6f    y_density: flo
-000132b0: 6174 203d 204e 6f6e 652c 0a20 2020 2020  at = None,.     
-000132c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132d0: 2020 2020 2020 6d69 6e5f 706f 696e 7473        min_points
-000132e0: 5f78 3a20 696e 7420 3d20 3230 2c0a 2020  _x: int = 20,.  
-000132f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013300: 2020 2020 2020 2020 206d 696e 5f70 6f69           min_poi
-00013310: 6e74 735f 793a 2069 6e74 203d 2032 302c  nts_y: int = 20,
-00013320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013330: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-00013340: 6572 5f70 6f69 6e74 735f 783a 2069 6e74  er_points_x: int
-00013350: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00013360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013370: 2020 2020 6e75 6d62 6572 5f70 6f69 6e74      number_point
-00013380: 735f 793a 2069 6e74 203d 204e 6f6e 6529  s_y: int = None)
-00013390: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000133a0: 2020 2020 2020 436f 6d70 7574 6520 6120        Compute a 
-000133b0: 7472 6961 6e67 756c 6174 696f 6e20 7573  triangulation us
-000133c0: 696e 6720 6120 6e2d 6279 2d6d 2067 7269  ing a n-by-m gri
-000133d0: 6420 746f 2074 7269 616e 6775 6c69 7a65  d to triangulize
-000133e0: 2074 6865 2063 6f6e 746f 7572 2e0a 2020   the contour..  
-000133f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00013400: 2020 626f 756e 6469 6e67 5f72 6563 7461    bounding_recta
-00013410: 6e67 6c65 203d 2073 656c 662e 626f 756e  ngle = self.boun
-00013420: 6469 6e67 5f72 6563 7461 6e67 6c65 0a20  ding_rectangle. 
-00013430: 2020 2020 2020 2023 2078 6d69 6e2c 2078         # xmin, x
-00013440: 6d61 782c 2079 6d69 6e2c 2079 6d61 7820  max, ymin, ymax 
-00013450: 3d20 7365 6c66 2e62 6f75 6e64 696e 675f  = self.bounding_
-00013460: 7265 6374 616e 676c 650a 2020 2020 2020  rectangle.      
-00013470: 2020 6478 203d 2062 6f75 6e64 696e 675f    dx = bounding_
-00013480: 7265 6374 616e 676c 655b 315d 202d 2062  rectangle[1] - b
-00013490: 6f75 6e64 696e 675f 7265 6374 616e 676c  ounding_rectangl
-000134a0: 655b 305d 2020 2320 786d 6178 202d 2078  e[0]  # xmax - x
-000134b0: 6d69 6e0a 2020 2020 2020 2020 6479 203d  min.        dy =
-000134c0: 2062 6f75 6e64 696e 675f 7265 6374 616e   bounding_rectan
-000134d0: 676c 655b 335d 202d 2062 6f75 6e64 696e  gle[3] - boundin
-000134e0: 675f 7265 6374 616e 676c 655b 325d 2020  g_rectangle[2]  
-000134f0: 2320 796d 6178 202d 2079 6d69 6e0a 2020  # ymax - ymin.  
-00013500: 2020 2020 2020 6966 206e 756d 6265 725f        if number_
-00013510: 706f 696e 7473 5f78 2069 7320 4e6f 6e65  points_x is None
-00013520: 3a0a 2020 2020 2020 2020 2020 2020 6e20  :.            n 
-00013530: 3d20 6d61 7828 6d61 7468 2e63 6569 6c28  = max(math.ceil(
-00013540: 785f 6465 6e73 6974 7920 2a20 6478 292c  x_density * dx),
-00013550: 206d 696e 5f70 6f69 6e74 735f 7829 0a20   min_points_x). 
-00013560: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00013570: 2020 2020 2020 2020 206e 203d 206e 756d           n = num
-00013580: 6265 725f 706f 696e 7473 5f78 0a20 2020  ber_points_x.   
-00013590: 2020 2020 2069 6620 6e75 6d62 6572 5f70       if number_p
-000135a0: 6f69 6e74 735f 7920 6973 204e 6f6e 653a  oints_y is None:
-000135b0: 0a20 2020 2020 2020 2020 2020 206d 203d  .            m =
-000135c0: 206d 6178 286d 6174 682e 6365 696c 2879   max(math.ceil(y
-000135d0: 5f64 656e 7369 7479 202a 2064 7929 2c20  _density * dy), 
-000135e0: 6d69 6e5f 706f 696e 7473 5f79 290a 2020  min_points_y).  
-000135f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00013600: 2020 2020 2020 2020 6d20 3d20 6e75 6d62          m = numb
-00013610: 6572 5f70 6f69 6e74 735f 790a 2020 2020  er_points_y.    
-00013620: 2020 2020 7820 3d20 5b62 6f75 6e64 696e      x = [boundin
-00013630: 675f 7265 6374 616e 676c 655b 305d 202b  g_rectangle[0] +
-00013640: 2069 202a 2064 7820 2f20 6e20 666f 7220   i * dx / n for 
-00013650: 6920 696e 2072 616e 6765 286e 202b 2031  i in range(n + 1
-00013660: 295d 0a20 2020 2020 2020 2079 203d 205b  )].        y = [
-00013670: 626f 756e 6469 6e67 5f72 6563 7461 6e67  bounding_rectang
-00013680: 6c65 5b32 5d20 2b20 6920 2a20 6479 202f  le[2] + i * dy /
-00013690: 206d 2066 6f72 2069 2069 6e20 7261 6e67   m for i in rang
-000136a0: 6528 6d20 2b20 3129 5d0a 0a20 2020 2020  e(m + 1)]..     
-000136b0: 2020 2070 6f69 6e74 5f69 6e64 6578 203d     point_index =
-000136c0: 207b 7d0a 2020 2020 2020 2020 6e75 6d62   {}.        numb
-000136d0: 6572 5f70 6f69 6e74 7320 3d20 300a 2020  er_points = 0.  
-000136e0: 2020 2020 2020 706f 696e 7473 203d 205b        points = [
-000136f0: 5d0a 2020 2020 2020 2020 7472 6961 6e67  ].        triang
-00013700: 6c65 7320 3d20 5b5d 0a20 2020 2020 2020  les = [].       
-00013710: 2066 6f72 2078 6920 696e 2078 3a0a 2020   for xi in x:.  
-00013720: 2020 2020 2020 2020 2020 666f 7220 7969            for yi
-00013730: 2069 6e20 793a 0a20 2020 2020 2020 2020   in y:.         
-00013740: 2020 2020 2020 2070 6f69 6e74 203d 2076         point = v
-00013750: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 2878  olmdlr.Point2D(x
-00013760: 692c 2079 6929 0a20 2020 2020 2020 2020  i, yi).         
-00013770: 2020 2020 2020 2069 6620 7365 6c66 2e70         if self.p
-00013780: 6f69 6e74 5f62 656c 6f6e 6773 2870 6f69  oint_belongs(poi
-00013790: 6e74 293a 0a20 2020 2020 2020 2020 2020  nt):.           
-000137a0: 2020 2020 2020 2020 2070 6f69 6e74 5f69           point_i
-000137b0: 6e64 6578 5b70 6f69 6e74 5d20 3d20 6e75  ndex[point] = nu
-000137c0: 6d62 6572 5f70 6f69 6e74 730a 2020 2020  mber_points.    
-000137d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000137e0: 706f 696e 7473 2e61 7070 656e 6428 706f  points.append(po
-000137f0: 696e 7429 0a20 2020 2020 2020 2020 2020  int).           
-00013800: 2020 2020 2020 2020 206e 756d 6265 725f           number_
-00013810: 706f 696e 7473 202b 3d20 310a 0a20 2020  points += 1..   
-00013820: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00013830: 6e67 6528 6e29 3a0a 2020 2020 2020 2020  nge(n):.        
-00013840: 2020 2020 666f 7220 6a20 696e 2072 616e      for j in ran
-00013850: 6765 286d 293a 0a20 2020 2020 2020 2020  ge(m):.         
-00013860: 2020 2020 2020 2070 3120 3d20 766f 6c6d         p1 = volm
-00013870: 646c 722e 506f 696e 7432 4428 785b 695d  dlr.Point2D(x[i]
-00013880: 2c20 795b 6a5d 290a 2020 2020 2020 2020  , y[j]).        
-00013890: 2020 2020 2020 2020 7032 203d 2076 6f6c          p2 = vol
-000138a0: 6d64 6c72 2e50 6f69 6e74 3244 2878 5b69  mdlr.Point2D(x[i
-000138b0: 202b 2031 5d2c 2079 5b6a 5d29 0a20 2020   + 1], y[j]).   
-000138c0: 2020 2020 2020 2020 2020 2020 2070 3320               p3 
-000138d0: 3d20 766f 6c6d 646c 722e 506f 696e 7432  = volmdlr.Point2
-000138e0: 4428 785b 6920 2b20 315d 2c20 795b 6a20  D(x[i + 1], y[j 
-000138f0: 2b20 315d 290a 2020 2020 2020 2020 2020  + 1]).          
-00013900: 2020 2020 2020 7034 203d 2076 6f6c 6d64        p4 = volmd
-00013910: 6c72 2e50 6f69 6e74 3244 2878 5b69 5d2c  lr.Point2D(x[i],
-00013920: 2079 5b6a 202b 2031 5d29 0a20 2020 2020   y[j + 1]).     
-00013930: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-00013940: 735f 696e 203d 205b 5d0a 2020 2020 2020  s_in = [].      
-00013950: 2020 2020 2020 2020 2020 666f 7220 7020            for p 
-00013960: 696e 205b 7031 2c20 7032 2c20 7033 2c20  in [p1, p2, p3, 
-00013970: 7034 5d3a 0a20 2020 2020 2020 2020 2020  p4]:.           
-00013980: 2020 2020 2020 2020 2069 6620 7020 696e           if p in
-00013990: 2070 6f69 6e74 5f69 6e64 6578 3a0a 2020   point_index:.  
-000139a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139b0: 2020 2020 2020 706f 696e 7473 5f69 6e2e        points_in.
-000139c0: 6170 7065 6e64 2870 290a 2020 2020 2020  append(p).      
-000139d0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-000139e0: 2870 6f69 6e74 735f 696e 2920 3d3d 2034  (points_in) == 4
-000139f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00013a00: 2020 2020 2020 7472 6961 6e67 6c65 732e        triangles.
-00013a10: 6170 7065 6e64 280a 2020 2020 2020 2020  append(.        
+000132a0: 2020 2020 2020 2020 2020 795f 6465 6e73            y_dens
+000132b0: 6974 793a 2066 6c6f 6174 203d 204e 6f6e  ity: float = Non
+000132c0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+000132d0: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
+000132e0: 6e5f 706f 696e 7473 5f78 3a20 696e 7420  n_points_x: int 
+000132f0: 3d20 3230 2c0a 2020 2020 2020 2020 2020  = 20,.          
+00013300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013310: 206d 696e 5f70 6f69 6e74 735f 793a 2069   min_points_y: i
+00013320: 6e74 203d 2032 302c 0a20 2020 2020 2020  nt = 20,.       
+00013330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013340: 2020 2020 6e75 6d62 6572 5f70 6f69 6e74      number_point
+00013350: 735f 783a 2069 6e74 203d 204e 6f6e 652c  s_x: int = None,
+00013360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013370: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+00013380: 6572 5f70 6f69 6e74 735f 793a 2069 6e74  er_points_y: int
+00013390: 203d 204e 6f6e 6529 3a0a 2020 2020 2020   = None):.      
+000133a0: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
+000133b0: 6d70 7574 6520 6120 7472 6961 6e67 756c  mpute a triangul
+000133c0: 6174 696f 6e20 7573 696e 6720 6120 6e2d  ation using a n-
+000133d0: 6279 2d6d 2067 7269 6420 746f 2074 7269  by-m grid to tri
+000133e0: 616e 6775 6c69 7a65 2074 6865 2063 6f6e  angulize the con
+000133f0: 746f 7572 2e0a 2020 2020 2020 2020 2222  tour..        ""
+00013400: 220a 2020 2020 2020 2020 626f 756e 6469  ".        boundi
+00013410: 6e67 5f72 6563 7461 6e67 6c65 203d 2073  ng_rectangle = s
+00013420: 656c 662e 626f 756e 6469 6e67 5f72 6563  elf.bounding_rec
+00013430: 7461 6e67 6c65 0a20 2020 2020 2020 2023  tangle.        #
+00013440: 2078 6d69 6e2c 2078 6d61 782c 2079 6d69   xmin, xmax, ymi
+00013450: 6e2c 2079 6d61 7820 3d20 7365 6c66 2e62  n, ymax = self.b
+00013460: 6f75 6e64 696e 675f 7265 6374 616e 676c  ounding_rectangl
+00013470: 650a 2020 2020 2020 2020 6478 203d 2062  e.        dx = b
+00013480: 6f75 6e64 696e 675f 7265 6374 616e 676c  ounding_rectangl
+00013490: 655b 315d 202d 2062 6f75 6e64 696e 675f  e[1] - bounding_
+000134a0: 7265 6374 616e 676c 655b 305d 2020 2320  rectangle[0]  # 
+000134b0: 786d 6178 202d 2078 6d69 6e0a 2020 2020  xmax - xmin.    
+000134c0: 2020 2020 6479 203d 2062 6f75 6e64 696e      dy = boundin
+000134d0: 675f 7265 6374 616e 676c 655b 335d 202d  g_rectangle[3] -
+000134e0: 2062 6f75 6e64 696e 675f 7265 6374 616e   bounding_rectan
+000134f0: 676c 655b 325d 2020 2320 796d 6178 202d  gle[2]  # ymax -
+00013500: 2079 6d69 6e0a 2020 2020 2020 2020 6966   ymin.        if
+00013510: 206e 756d 6265 725f 706f 696e 7473 5f78   number_points_x
+00013520: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00013530: 2020 2020 2020 6e20 3d20 6d61 7828 6d61        n = max(ma
+00013540: 7468 2e63 6569 6c28 785f 6465 6e73 6974  th.ceil(x_densit
+00013550: 7920 2a20 6478 292c 206d 696e 5f70 6f69  y * dx), min_poi
+00013560: 6e74 735f 7829 0a20 2020 2020 2020 2065  nts_x).        e
+00013570: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00013580: 206e 203d 206e 756d 6265 725f 706f 696e   n = number_poin
+00013590: 7473 5f78 0a20 2020 2020 2020 2069 6620  ts_x.        if 
+000135a0: 6e75 6d62 6572 5f70 6f69 6e74 735f 7920  number_points_y 
+000135b0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+000135c0: 2020 2020 206d 203d 206d 6178 286d 6174       m = max(mat
+000135d0: 682e 6365 696c 2879 5f64 656e 7369 7479  h.ceil(y_density
+000135e0: 202a 2064 7929 2c20 6d69 6e5f 706f 696e   * dy), min_poin
+000135f0: 7473 5f79 290a 2020 2020 2020 2020 656c  ts_y).        el
+00013600: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00013610: 6d20 3d20 6e75 6d62 6572 5f70 6f69 6e74  m = number_point
+00013620: 735f 790a 2020 2020 2020 2020 7820 3d20  s_y.        x = 
+00013630: 5b62 6f75 6e64 696e 675f 7265 6374 616e  [bounding_rectan
+00013640: 676c 655b 305d 202b 2069 202a 2064 7820  gle[0] + i * dx 
+00013650: 2f20 6e20 666f 7220 6920 696e 2072 616e  / n for i in ran
+00013660: 6765 286e 202b 2031 295d 0a20 2020 2020  ge(n + 1)].     
+00013670: 2020 2079 203d 205b 626f 756e 6469 6e67     y = [bounding
+00013680: 5f72 6563 7461 6e67 6c65 5b32 5d20 2b20  _rectangle[2] + 
+00013690: 6920 2a20 6479 202f 206d 2066 6f72 2069  i * dy / m for i
+000136a0: 2069 6e20 7261 6e67 6528 6d20 2b20 3129   in range(m + 1)
+000136b0: 5d0a 0a20 2020 2020 2020 2070 6f69 6e74  ]..        point
+000136c0: 5f69 6e64 6578 203d 207b 7d0a 2020 2020  _index = {}.    
+000136d0: 2020 2020 6e75 6d62 6572 5f70 6f69 6e74      number_point
+000136e0: 7320 3d20 300a 2020 2020 2020 2020 706f  s = 0.        po
+000136f0: 696e 7473 203d 205b 5d0a 2020 2020 2020  ints = [].      
+00013700: 2020 7472 6961 6e67 6c65 7320 3d20 5b5d    triangles = []
+00013710: 0a20 2020 2020 2020 2066 6f72 2078 6920  .        for xi 
+00013720: 696e 2078 3a0a 2020 2020 2020 2020 2020  in x:.          
+00013730: 2020 666f 7220 7969 2069 6e20 793a 0a20    for yi in y:. 
+00013740: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00013750: 6f69 6e74 203d 2076 6f6c 6d64 6c72 2e50  oint = volmdlr.P
+00013760: 6f69 6e74 3244 2878 692c 2079 6929 0a20  oint2D(xi, yi). 
+00013770: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00013780: 6620 7365 6c66 2e70 6f69 6e74 5f62 656c  f self.point_bel
+00013790: 6f6e 6773 2870 6f69 6e74 293a 0a20 2020  ongs(point):.   
+000137a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000137b0: 2070 6f69 6e74 5f69 6e64 6578 5b70 6f69   point_index[poi
+000137c0: 6e74 5d20 3d20 6e75 6d62 6572 5f70 6f69  nt] = number_poi
+000137d0: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
+000137e0: 2020 2020 2020 2020 706f 696e 7473 2e61          points.a
+000137f0: 7070 656e 6428 706f 696e 7429 0a20 2020  ppend(point).   
+00013800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013810: 206e 756d 6265 725f 706f 696e 7473 202b   number_points +
+00013820: 3d20 310a 0a20 2020 2020 2020 2066 6f72  = 1..        for
+00013830: 2069 2069 6e20 7261 6e67 6528 6e29 3a0a   i in range(n):.
+00013840: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00013850: 6a20 696e 2072 616e 6765 286d 293a 0a20  j in range(m):. 
+00013860: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00013870: 3120 3d20 766f 6c6d 646c 722e 506f 696e  1 = volmdlr.Poin
+00013880: 7432 4428 785b 695d 2c20 795b 6a5d 290a  t2D(x[i], y[j]).
+00013890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138a0: 7032 203d 2076 6f6c 6d64 6c72 2e50 6f69  p2 = volmdlr.Poi
+000138b0: 6e74 3244 2878 5b69 202b 2031 5d2c 2079  nt2D(x[i + 1], y
+000138c0: 5b6a 5d29 0a20 2020 2020 2020 2020 2020  [j]).           
+000138d0: 2020 2020 2070 3320 3d20 766f 6c6d 646c       p3 = volmdl
+000138e0: 722e 506f 696e 7432 4428 785b 6920 2b20  r.Point2D(x[i + 
+000138f0: 315d 2c20 795b 6a20 2b20 315d 290a 2020  1], y[j + 1]).  
+00013900: 2020 2020 2020 2020 2020 2020 2020 7034                p4
+00013910: 203d 2076 6f6c 6d64 6c72 2e50 6f69 6e74   = volmdlr.Point
+00013920: 3244 2878 5b69 5d2c 2079 5b6a 202b 2031  2D(x[i], y[j + 1
+00013930: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+00013940: 2020 2070 6f69 6e74 735f 696e 203d 205b     points_in = [
+00013950: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00013960: 2020 666f 7220 7020 696e 205b 7031 2c20    for p in [p1, 
+00013970: 7032 2c20 7033 2c20 7034 5d3a 0a20 2020  p2, p3, p4]:.   
+00013980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013990: 2069 6620 7020 696e 2070 6f69 6e74 5f69   if p in point_i
+000139a0: 6e64 6578 3a0a 2020 2020 2020 2020 2020  ndex:.          
+000139b0: 2020 2020 2020 2020 2020 2020 2020 706f                po
+000139c0: 696e 7473 5f69 6e2e 6170 7065 6e64 2870  ints_in.append(p
+000139d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000139e0: 2020 6966 206c 656e 2870 6f69 6e74 735f    if len(points_
+000139f0: 696e 2920 3d3d 2034 3a0a 2020 2020 2020  in) == 4:.      
+00013a00: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00013a10: 6961 6e67 6c65 732e 6170 7065 6e64 280a  iangles.append(.
 00013a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a30: 5b70 6f69 6e74 5f69 6e64 6578 5b70 315d  [point_index[p1]
-00013a40: 2c20 706f 696e 745f 696e 6465 785b 7032  , point_index[p2
-00013a50: 5d2c 2070 6f69 6e74 5f69 6e64 6578 5b70  ], point_index[p
-00013a60: 335d 5d29 0a20 2020 2020 2020 2020 2020  3]]).           
-00013a70: 2020 2020 2020 2020 2074 7269 616e 676c           triangl
-00013a80: 6573 2e61 7070 656e 6428 0a20 2020 2020  es.append(.     
-00013a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013aa0: 2020 205b 706f 696e 745f 696e 6465 785b     [point_index[
-00013ab0: 7031 5d2c 2070 6f69 6e74 5f69 6e64 6578  p1], point_index
-00013ac0: 5b70 335d 2c20 706f 696e 745f 696e 6465  [p3], point_inde
-00013ad0: 785b 7034 5d5d 290a 0a20 2020 2020 2020  x[p4]])..       
-00013ae0: 2020 2020 2020 2020 2065 6c69 6620 6c65           elif le
-00013af0: 6e28 706f 696e 7473 5f69 6e29 203d 3d20  n(points_in) == 
-00013b00: 333a 0a20 2020 2020 2020 2020 2020 2020  3:.             
-00013b10: 2020 2020 2020 2074 7269 616e 676c 6573         triangles
-00013b20: 2e61 7070 656e 6428 5b70 6f69 6e74 5f69  .append([point_i
-00013b30: 6e64 6578 5b70 5d20 666f 7220 7020 696e  ndex[p] for p in
-00013b40: 2070 6f69 6e74 735f 696e 5d29 0a0a 2020   points_in])..  
-00013b50: 2020 2020 2020 7265 7475 726e 2076 6d64        return vmd
-00013b60: 2e44 6973 706c 6179 4d65 7368 3244 2870  .DisplayMesh2D(p
-00013b70: 6f69 6e74 732c 2074 7269 616e 676c 6573  oints, triangles
-00013b80: 290a 0a20 2020 2064 6566 2063 6f6e 746f  )..    def conto
-00013b90: 7572 5f69 6e74 6572 7365 6374 696f 6e73  ur_intersections
-00013ba0: 2873 656c 662c 2063 6f6e 746f 7572 3264  (self, contour2d
-00013bb0: 293a 0a20 2020 2020 2020 2069 6e74 6572  ):.        inter
-00013bc0: 7365 6374 696e 675f 706f 696e 7473 203d  secting_points =
-00013bd0: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
-00013be0: 7072 696d 6974 6976 6531 2069 6e20 7365  primitive1 in se
-00013bf0: 6c66 2e70 7269 6d69 7469 7665 733a 0a20  lf.primitives:. 
-00013c00: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-00013c10: 7269 6d69 7469 7665 3220 696e 2063 6f6e  rimitive2 in con
-00013c20: 746f 7572 3264 2e70 7269 6d69 7469 7665  tour2d.primitive
-00013c30: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00013c40: 2020 206c 696e 655f 696e 7465 7273 6563     line_intersec
-00013c50: 7469 6f6e 203d 2070 7269 6d69 7469 7665  tion = primitive
-00013c60: 312e 6c69 6e65 7365 676d 656e 745f 696e  1.linesegment_in
-00013c70: 7465 7273 6563 7469 6f6e 7328 7072 696d  tersections(prim
-00013c80: 6974 6976 6532 290a 2020 2020 2020 2020  itive2).        
-00013c90: 2020 2020 2020 2020 6966 206c 696e 655f          if line_
-00013ca0: 696e 7465 7273 6563 7469 6f6e 3a0a 2020  intersection:.  
-00013cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013cc0: 2020 6966 206c 696e 655f 696e 7465 7273    if line_inters
-00013cd0: 6563 7469 6f6e 5b30 5d20 6e6f 7420 696e  ection[0] not in
-00013ce0: 2069 6e74 6572 7365 6374 696e 675f 706f   intersecting_po
-00013cf0: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
-00013d00: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00013d10: 7465 7273 6563 7469 6e67 5f70 6f69 6e74  tersecting_point
-00013d20: 732e 6578 7465 6e64 286c 696e 655f 696e  s.extend(line_in
-00013d30: 7465 7273 6563 7469 6f6e 290a 2020 2020  tersection).    
-00013d40: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00013d50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00013d60: 2020 2020 2020 746f 7563 6869 6e67 5f70        touching_p
-00013d70: 6f69 6e74 7320 3d20 7072 696d 6974 6976  oints = primitiv
-00013d80: 6531 2e74 6f75 6368 696e 675f 706f 696e  e1.touching_poin
-00013d90: 7473 2870 7269 6d69 7469 7665 3229 0a20  ts(primitive2). 
-00013da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013db0: 2020 2066 6f72 2070 6f69 6e74 2069 6e20     for point in 
-00013dc0: 746f 7563 6869 6e67 5f70 6f69 6e74 733a  touching_points:
-00013dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013de0: 2020 2020 2020 2020 2069 6620 706f 696e           if poin
-00013df0: 7420 6e6f 7420 696e 2069 6e74 6572 7365  t not in interse
-00013e00: 6374 696e 675f 706f 696e 7473 3a0a 2020  cting_points:.  
-00013e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e20: 2020 2020 2020 2020 2020 696e 7465 7273            inters
-00013e30: 6563 7469 6e67 5f70 6f69 6e74 732e 6170  ecting_points.ap
-00013e40: 7065 6e64 2870 6f69 6e74 290a 2020 2020  pend(point).    
-00013e50: 2020 2020 2020 2020 6966 206c 656e 2869          if len(i
-00013e60: 6e74 6572 7365 6374 696e 675f 706f 696e  ntersecting_poin
-00013e70: 7473 2920 3d3d 2032 3a0a 2020 2020 2020  ts) == 2:.      
-00013e80: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-00013e90: 2020 2020 2020 2020 7265 7475 726e 2069          return i
-00013ea0: 6e74 6572 7365 6374 696e 675f 706f 696e  ntersecting_poin
-00013eb0: 7473 0a0a 2020 2020 6465 6620 6765 745f  ts..    def get_
-00013ec0: 6469 7669 6465 645f 636f 6e74 6f75 7273  divided_contours
-00013ed0: 2873 656c 662c 2063 7574 7469 6e67 5f70  (self, cutting_p
-00013ee0: 6f69 6e74 313a 2076 6f6c 6d64 6c72 2e50  oint1: volmdlr.P
-00013ef0: 6f69 6e74 3244 2c0a 2020 2020 2020 2020  oint2D,.        
+00013a30: 2020 2020 2020 2020 5b70 6f69 6e74 5f69          [point_i
+00013a40: 6e64 6578 5b70 315d 2c20 706f 696e 745f  ndex[p1], point_
+00013a50: 696e 6465 785b 7032 5d2c 2070 6f69 6e74  index[p2], point
+00013a60: 5f69 6e64 6578 5b70 335d 5d29 0a20 2020  _index[p3]]).   
+00013a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a80: 2074 7269 616e 676c 6573 2e61 7070 656e   triangles.appen
+00013a90: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
+00013aa0: 2020 2020 2020 2020 2020 205b 706f 696e             [poin
+00013ab0: 745f 696e 6465 785b 7031 5d2c 2070 6f69  t_index[p1], poi
+00013ac0: 6e74 5f69 6e64 6578 5b70 335d 2c20 706f  nt_index[p3], po
+00013ad0: 696e 745f 696e 6465 785b 7034 5d5d 290a  int_index[p4]]).
+00013ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013af0: 2065 6c69 6620 6c65 6e28 706f 696e 7473   elif len(points
+00013b00: 5f69 6e29 203d 3d20 333a 0a20 2020 2020  _in) == 3:.     
+00013b10: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00013b20: 7269 616e 676c 6573 2e61 7070 656e 6428  riangles.append(
+00013b30: 5b70 6f69 6e74 5f69 6e64 6578 5b70 5d20  [point_index[p] 
+00013b40: 666f 7220 7020 696e 2070 6f69 6e74 735f  for p in points_
+00013b50: 696e 5d29 0a0a 2020 2020 2020 2020 7265  in])..        re
+00013b60: 7475 726e 2076 6d64 2e44 6973 706c 6179  turn vmd.Display
+00013b70: 4d65 7368 3244 2870 6f69 6e74 732c 2074  Mesh2D(points, t
+00013b80: 7269 616e 676c 6573 290a 0a20 2020 2064  riangles)..    d
+00013b90: 6566 2063 6f6e 746f 7572 5f69 6e74 6572  ef contour_inter
+00013ba0: 7365 6374 696f 6e73 2873 656c 662c 2063  sections(self, c
+00013bb0: 6f6e 746f 7572 3264 293a 0a20 2020 2020  ontour2d):.     
+00013bc0: 2020 2069 6e74 6572 7365 6374 696e 675f     intersecting_
+00013bd0: 706f 696e 7473 203d 205b 5d0a 2020 2020  points = [].    
+00013be0: 2020 2020 666f 7220 7072 696d 6974 6976      for primitiv
+00013bf0: 6531 2069 6e20 7365 6c66 2e70 7269 6d69  e1 in self.primi
+00013c00: 7469 7665 733a 0a20 2020 2020 2020 2020  tives:.         
+00013c10: 2020 2066 6f72 2070 7269 6d69 7469 7665     for primitive
+00013c20: 3220 696e 2063 6f6e 746f 7572 3264 2e70  2 in contour2d.p
+00013c30: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
+00013c40: 2020 2020 2020 2020 2020 206c 696e 655f             line_
+00013c50: 696e 7465 7273 6563 7469 6f6e 203d 2070  intersection = p
+00013c60: 7269 6d69 7469 7665 312e 6c69 6e65 7365  rimitive1.linese
+00013c70: 676d 656e 745f 696e 7465 7273 6563 7469  gment_intersecti
+00013c80: 6f6e 7328 7072 696d 6974 6976 6532 290a  ons(primitive2).
+00013c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ca0: 6966 206c 696e 655f 696e 7465 7273 6563  if line_intersec
+00013cb0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
+00013cc0: 2020 2020 2020 2020 2020 6966 206c 696e            if lin
+00013cd0: 655f 696e 7465 7273 6563 7469 6f6e 5b30  e_intersection[0
+00013ce0: 5d20 6e6f 7420 696e 2069 6e74 6572 7365  ] not in interse
+00013cf0: 6374 696e 675f 706f 696e 7473 3a0a 2020  cting_points:.  
+00013d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d10: 2020 2020 2020 696e 7465 7273 6563 7469        intersecti
+00013d20: 6e67 5f70 6f69 6e74 732e 6578 7465 6e64  ng_points.extend
+00013d30: 286c 696e 655f 696e 7465 7273 6563 7469  (line_intersecti
+00013d40: 6f6e 290a 2020 2020 2020 2020 2020 2020  on).            
+00013d50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00013d60: 2020 2020 2020 2020 2020 2020 2020 746f                to
+00013d70: 7563 6869 6e67 5f70 6f69 6e74 7320 3d20  uching_points = 
+00013d80: 7072 696d 6974 6976 6531 2e74 6f75 6368  primitive1.touch
+00013d90: 696e 675f 706f 696e 7473 2870 7269 6d69  ing_points(primi
+00013da0: 7469 7665 3229 0a20 2020 2020 2020 2020  tive2).         
+00013db0: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
+00013dc0: 6f69 6e74 2069 6e20 746f 7563 6869 6e67  oint in touching
+00013dd0: 5f70 6f69 6e74 733a 0a20 2020 2020 2020  _points:.       
+00013de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013df0: 2069 6620 706f 696e 7420 6e6f 7420 696e   if point not in
+00013e00: 2069 6e74 6572 7365 6374 696e 675f 706f   intersecting_po
+00013e10: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
+00013e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013e30: 2020 696e 7465 7273 6563 7469 6e67 5f70    intersecting_p
+00013e40: 6f69 6e74 732e 6170 7065 6e64 2870 6f69  oints.append(poi
+00013e50: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
+00013e60: 6966 206c 656e 2869 6e74 6572 7365 6374  if len(intersect
+00013e70: 696e 675f 706f 696e 7473 2920 3d3d 2032  ing_points) == 2
+00013e80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00013e90: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+00013ea0: 7265 7475 726e 2069 6e74 6572 7365 6374  return intersect
+00013eb0: 696e 675f 706f 696e 7473 0a0a 2020 2020  ing_points..    
+00013ec0: 6465 6620 6765 745f 6469 7669 6465 645f  def get_divided_
+00013ed0: 636f 6e74 6f75 7273 2873 656c 662c 2063  contours(self, c
+00013ee0: 7574 7469 6e67 5f70 6f69 6e74 313a 2076  utting_point1: v
+00013ef0: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 2c0a  olmdlr.Point2D,.
 00013f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f10: 2020 2020 2063 7574 7469 6e67 5f70 6f69       cutting_poi
-00013f20: 6e74 323a 2076 6f6c 6d64 6c72 2e50 6f69  nt2: volmdlr.Poi
-00013f30: 6e74 3244 2c0a 2020 2020 2020 2020 2020  nt2D,.          
+00013f10: 2020 2020 2020 2020 2020 2020 2063 7574               cut
+00013f20: 7469 6e67 5f70 6f69 6e74 323a 2076 6f6c  ting_point2: vol
+00013f30: 6d64 6c72 2e50 6f69 6e74 3244 2c0a 2020  mdlr.Point2D,.  
 00013f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f50: 2020 2063 6c6f 7369 6e67 5f63 6f6e 746f     closing_conto
-00013f60: 7572 2c0a 2020 2020 2020 2020 2020 2020  ur,.            
+00013f50: 2020 2020 2020 2020 2020 2063 6c6f 7369             closi
+00013f60: 6e67 5f63 6f6e 746f 7572 2c0a 2020 2020  ng_contour,.    
 00013f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f80: 2069 6e73 6964 653a 2062 6f6f 6c29 3a0a   inside: bool):.
-00013f90: 2020 2020 2020 2020 6578 7472 6163 7465          extracte
-00013fa0: 645f 6f75 7465 7270 6f69 6e74 735f 636f  d_outerpoints_co
-00013fb0: 6e74 6f75 7231 203d 205c 0a20 2020 2020  ntour1 = \.     
-00013fc0: 2020 2020 2020 2076 6f6c 6d64 6c72 2e77         volmdlr.w
-00013fd0: 6972 6573 2e43 6f6e 746f 7572 3244 2e65  ires.Contour2D.e
-00013fe0: 7874 7261 6374 5f63 6f6e 746f 7572 7328  xtract_contours(
-00013ff0: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+00013f80: 2020 2020 2020 2020 2069 6e73 6964 653a           inside:
+00013f90: 2062 6f6f 6c29 3a0a 2020 2020 2020 2020   bool):.        
+00013fa0: 6578 7472 6163 7465 645f 6f75 7465 7270  extracted_outerp
+00013fb0: 6f69 6e74 735f 636f 6e74 6f75 7231 203d  oints_contour1 =
+00013fc0: 205c 0a20 2020 2020 2020 2020 2020 2076   \.            v
+00013fd0: 6f6c 6d64 6c72 2e77 6972 6573 2e43 6f6e  olmdlr.wires.Con
+00013fe0: 746f 7572 3244 2e65 7874 7261 6374 5f63  tour2D.extract_c
+00013ff0: 6f6e 746f 7572 7328 7365 6c66 2c0a 2020  ontours(self,.  
 00014000: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00014010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014020: 2020 2020 2020 2020 2020 2063 7574 7469             cutti
-00014030: 6e67 5f70 6f69 6e74 312c 0a20 2020 2020  ng_point1,.     
-00014040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014030: 2020 2063 7574 7469 6e67 5f70 6f69 6e74     cutting_point
+00014040: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
 00014050: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00014060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014070: 6375 7474 696e 675f 706f 696e 7432 2c0a  cutting_point2,.
-00014080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014070: 2020 2020 2020 2020 6375 7474 696e 675f          cutting_
+00014080: 706f 696e 7432 2c0a 2020 2020 2020 2020  point2,.        
 00014090: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000140a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000140b0: 2020 2020 2069 6e73 6964 6529 5b30 5d0a       inside)[0].
-000140c0: 2020 2020 2020 2020 6578 7472 6163 7465          extracte
-000140d0: 645f 696e 6e65 7270 6f69 6e74 735f 636f  d_innerpoints_co
-000140e0: 6e74 6f75 7231 203d 205c 0a20 2020 2020  ntour1 = \.     
-000140f0: 2020 2020 2020 2076 6f6c 6d64 6c72 2e77         volmdlr.w
-00014100: 6972 6573 2e43 6f6e 746f 7572 3244 2e65  ires.Contour2D.e
-00014110: 7874 7261 6374 5f63 6f6e 746f 7572 7328  xtract_contours(
-00014120: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+000140b0: 2020 2020 2020 2020 2020 2020 2069 6e73               ins
+000140c0: 6964 6529 5b30 5d0a 2020 2020 2020 2020  ide)[0].        
+000140d0: 6578 7472 6163 7465 645f 696e 6e65 7270  extracted_innerp
+000140e0: 6f69 6e74 735f 636f 6e74 6f75 7231 203d  oints_contour1 =
+000140f0: 205c 0a20 2020 2020 2020 2020 2020 2076   \.            v
+00014100: 6f6c 6d64 6c72 2e77 6972 6573 2e43 6f6e  olmdlr.wires.Con
+00014110: 746f 7572 3244 2e65 7874 7261 6374 5f63  tour2D.extract_c
+00014120: 6f6e 746f 7572 7328 7365 6c66 2c0a 2020  ontours(self,.  
 00014130: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00014140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014150: 2020 2020 2020 2020 2020 2063 7574 7469             cutti
-00014160: 6e67 5f70 6f69 6e74 312c 0a20 2020 2020  ng_point1,.     
-00014170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014160: 2020 2063 7574 7469 6e67 5f70 6f69 6e74     cutting_point
+00014170: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
 00014180: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00014190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000141a0: 6375 7474 696e 675f 706f 696e 7432 2c0a  cutting_point2,.
-000141b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000141a0: 2020 2020 2020 2020 6375 7474 696e 675f          cutting_
+000141b0: 706f 696e 7432 2c0a 2020 2020 2020 2020  point2,.        
 000141c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000141d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000141e0: 2020 2020 206e 6f74 2069 6e73 6964 6529       not inside)
-000141f0: 5b30 5d0a 2020 2020 2020 2020 7072 696d  [0].        prim
-00014200: 6974 6976 6573 3120 3d20 6578 7472 6163  itives1 = extrac
-00014210: 7465 645f 6f75 7465 7270 6f69 6e74 735f  ted_outerpoints_
-00014220: 636f 6e74 6f75 7231 2e70 7269 6d69 7469  contour1.primiti
-00014230: 7665 7320 2b20 636c 6f73 696e 675f 636f  ves + closing_co
-00014240: 6e74 6f75 722e 7072 696d 6974 6976 6573  ntour.primitives
-00014250: 0a20 2020 2020 2020 2070 7269 6d69 7469  .        primiti
-00014260: 7665 7332 203d 2065 7874 7261 6374 6564  ves2 = extracted
-00014270: 5f69 6e6e 6572 706f 696e 7473 5f63 6f6e  _innerpoints_con
-00014280: 746f 7572 312e 7072 696d 6974 6976 6573  tour1.primitives
-00014290: 202b 2063 6c6f 7369 6e67 5f63 6f6e 746f   + closing_conto
-000142a0: 7572 2e70 7269 6d69 7469 7665 730a 2020  ur.primitives.  
-000142b0: 2020 2020 2020 6966 2065 7874 7261 6374        if extract
-000142c0: 6564 5f6f 7574 6572 706f 696e 7473 5f63  ed_outerpoints_c
-000142d0: 6f6e 746f 7572 312e 7072 696d 6974 6976  ontour1.primitiv
-000142e0: 6573 5b30 5d2e 7374 6172 7420 3d3d 205c  es[0].start == \
-000142f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014300: 2063 6c6f 7369 6e67 5f63 6f6e 746f 7572   closing_contour
-00014310: 2e70 7269 6d69 7469 7665 735b 305d 2e73  .primitives[0].s
-00014320: 7461 7274 3a0a 2020 2020 2020 2020 2020  tart:.          
-00014330: 2020 6375 7474 696e 675f 636f 6e74 6f75    cutting_contou
-00014340: 725f 6e65 7720 3d20 636c 6f73 696e 675f  r_new = closing_
-00014350: 636f 6e74 6f75 722e 696e 7665 7274 2829  contour.invert()
-00014360: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00014370: 6d69 7469 7665 7331 203d 2063 7574 7469  mitives1 = cutti
-00014380: 6e67 5f63 6f6e 746f 7572 5f6e 6577 2e70  ng_contour_new.p
-00014390: 7269 6d69 7469 7665 7320 2b20 5c0a 2020  rimitives + \.  
-000143a0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-000143b0: 7472 6163 7465 645f 6f75 7465 7270 6f69  tracted_outerpoi
-000143c0: 6e74 735f 636f 6e74 6f75 7231 2e70 7269  nts_contour1.pri
-000143d0: 6d69 7469 7665 730a 2020 2020 2020 2020  mitives.        
-000143e0: 656c 6966 2065 7874 7261 6374 6564 5f6f  elif extracted_o
-000143f0: 7574 6572 706f 696e 7473 5f63 6f6e 746f  uterpoints_conto
-00014400: 7572 312e 7072 696d 6974 6976 6573 5b30  ur1.primitives[0
-00014410: 5d2e 7374 6172 7420 3d3d 205c 0a20 2020  ].start == \.   
-00014420: 2020 2020 2020 2020 2020 2020 2063 6c6f               clo
-00014430: 7369 6e67 5f63 6f6e 746f 7572 2e70 7269  sing_contour.pri
-00014440: 6d69 7469 7665 735b 2d31 5d2e 656e 643a  mitives[-1].end:
-00014450: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00014460: 6d69 7469 7665 7331 203d 2063 6c6f 7369  mitives1 = closi
-00014470: 6e67 5f63 6f6e 746f 7572 2e70 7269 6d69  ng_contour.primi
-00014480: 7469 7665 7320 2b20 5c0a 2020 2020 2020  tives + \.      
-00014490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000144a0: 2020 2020 6578 7472 6163 7465 645f 6f75      extracted_ou
-000144b0: 7465 7270 6f69 6e74 735f 636f 6e74 6f75  terpoints_contou
-000144c0: 7231 2e70 7269 6d69 7469 7665 730a 0a20  r1.primitives.. 
-000144d0: 2020 2020 2020 2069 6620 6578 7472 6163         if extrac
-000144e0: 7465 645f 696e 6e65 7270 6f69 6e74 735f  ted_innerpoints_
-000144f0: 636f 6e74 6f75 7231 2e70 7269 6d69 7469  contour1.primiti
-00014500: 7665 735b 305d 2e73 7461 7274 203d 3d20  ves[0].start == 
-00014510: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-00014520: 2020 636c 6f73 696e 675f 636f 6e74 6f75    closing_contou
-00014530: 722e 7072 696d 6974 6976 6573 5b30 5d2e  r.primitives[0].
-00014540: 7374 6172 743a 0a20 2020 2020 2020 2020  start:.         
-00014550: 2020 2063 7574 7469 6e67 5f63 6f6e 746f     cutting_conto
-00014560: 7572 5f6e 6577 203d 205c 0a20 2020 2020  ur_new = \.     
-00014570: 2020 2020 2020 2020 2020 2063 6c6f 7369             closi
-00014580: 6e67 5f63 6f6e 746f 7572 2e69 6e76 6572  ng_contour.inver
-00014590: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-000145a0: 7072 696d 6974 6976 6573 3220 3d20 6375  primitives2 = cu
-000145b0: 7474 696e 675f 636f 6e74 6f75 725f 6e65  tting_contour_ne
-000145c0: 772e 7072 696d 6974 6976 6573 202b 205c  w.primitives + \
-000145d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000145e0: 2065 7874 7261 6374 6564 5f69 6e6e 6572   extracted_inner
-000145f0: 706f 696e 7473 5f63 6f6e 746f 7572 312e  points_contour1.
-00014600: 7072 696d 6974 6976 6573 0a20 2020 2020  primitives.     
-00014610: 2020 2065 6c69 6620 6578 7472 6163 7465     elif extracte
-00014620: 645f 696e 6e65 7270 6f69 6e74 735f 636f  d_innerpoints_co
-00014630: 6e74 6f75 7231 2e70 7269 6d69 7469 7665  ntour1.primitive
-00014640: 735b 0a20 2020 2020 2020 2020 2020 2020  s[.             
-00014650: 2020 2030 5d2e 7374 6172 7420 3d3d 2063     0].start == c
-00014660: 6c6f 7369 6e67 5f63 6f6e 746f 7572 2e70  losing_contour.p
-00014670: 7269 6d69 7469 7665 735b 2d31 5d2e 656e  rimitives[-1].en
-00014680: 643a 0a20 2020 2020 2020 2020 2020 2070  d:.            p
-00014690: 7269 6d69 7469 7665 7332 203d 2063 6c6f  rimitives2 = clo
-000146a0: 7369 6e67 5f63 6f6e 746f 7572 2e70 7269  sing_contour.pri
-000146b0: 6d69 7469 7665 7320 2b20 5c0a 2020 2020  mitives + \.    
-000146c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146d0: 2020 2020 2020 6578 7472 6163 7465 645f        extracted_
-000146e0: 696e 6e65 7270 6f69 6e74 735f 636f 6e74  innerpoints_cont
-000146f0: 6f75 7231 2e70 7269 6d69 7469 7665 730a  our1.primitives.
-00014700: 2020 2020 2020 2020 636f 6e74 6f75 7231          contour1
-00014710: 203d 2043 6f6e 746f 7572 3244 2870 7269   = Contour2D(pri
-00014720: 6d69 7469 7665 7331 290a 2020 2020 2020  mitives1).      
-00014730: 2020 636f 6e74 6f75 7231 2e6f 7264 6572    contour1.order
-00014740: 5f63 6f6e 746f 7572 2829 0a20 2020 2020  _contour().     
-00014750: 2020 2063 6f6e 746f 7572 3220 3d20 436f     contour2 = Co
-00014760: 6e74 6f75 7232 4428 7072 696d 6974 6976  ntour2D(primitiv
-00014770: 6573 3229 0a20 2020 2020 2020 2063 6f6e  es2).        con
-00014780: 746f 7572 322e 6f72 6465 725f 636f 6e74  tour2.order_cont
-00014790: 6f75 7228 290a 2020 2020 2020 2020 7265  our().        re
-000147a0: 7475 726e 2063 6f6e 746f 7572 312c 2063  turn contour1, c
-000147b0: 6f6e 746f 7572 320a 0a20 2020 2064 6566  ontour2..    def
-000147c0: 2064 6976 6964 6528 7365 6c66 2c20 636f   divide(self, co
-000147d0: 6e74 6f75 7273 2c20 696e 7369 6465 293a  ntours, inside):
-000147e0: 0a20 2020 2020 2020 2023 2054 4f44 4f3a  .        # TODO:
-000147f0: 2054 6869 7320 6d65 7468 6f64 2068 6173   This method has
-00014800: 2061 206d 6f64 6966 6965 642d 6974 6572   a modified-iter
-00014810: 6174 696e 672d 6c69 7374 2070 796c 696e  ating-list pylin
-00014820: 7420 6572 726f 7220 746f 2062 6520 6669  t error to be fi
-00014830: 7865 640a 2020 2020 2020 2020 6e65 775f  xed.        new_
-00014840: 6261 7365 5f63 6f6e 746f 7572 7320 3d20  base_contours = 
-00014850: 5b73 656c 665d 0a20 2020 2020 2020 2066  [self].        f
-00014860: 696e 6973 6865 6420 3d20 4661 6c73 650a  inished = False.
-00014870: 2020 2020 2020 2020 636f 756e 7465 7220          counter 
-00014880: 3d20 300a 2020 2020 2020 2020 6c69 7374  = 0.        list
-00014890: 5f63 6f6e 746f 7572 203d 2063 6f6e 746f  _contour = conto
-000148a0: 7572 735b 3a5d 0a20 2020 2020 2020 206c  urs[:].        l
-000148b0: 6973 745f 6375 7474 696e 675f 636f 6e74  ist_cutting_cont
-000148c0: 6f75 7273 203d 2063 6f6e 746f 7572 735b  ours = contours[
-000148d0: 3a5d 0a20 2020 2020 2020 206c 6973 745f  :].        list_
-000148e0: 7661 6c69 645f 636f 6e74 6f75 7273 203d  valid_contours =
-000148f0: 205b 5d0a 2020 2020 2020 2020 7768 696c   [].        whil
-00014900: 6520 6e6f 7420 6669 6e69 7368 6564 3a0a  e not finished:.
-00014910: 2020 2020 2020 2020 2020 2020 6375 7474              cutt
-00014920: 696e 675f 636f 6e74 6f75 7220 3d20 636f  ing_contour = co
-00014930: 6e74 6f75 7273 5b30 5d0a 2020 2020 2020  ntours[0].      
-00014940: 2020 2020 2020 666f 7220 6261 7365 5f63        for base_c
-00014950: 6f6e 746f 7572 2069 6e20 6e65 775f 6261  ontour in new_ba
-00014960: 7365 5f63 6f6e 746f 7572 733a 0a20 2020  se_contours:.   
-00014970: 2020 2020 2020 2020 2020 2020 2063 7574               cut
-00014980: 7469 6e67 5f70 6f69 6e74 7320 3d20 5b5d  ting_points = []
-00014990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000149a0: 2070 6f69 6e74 312c 2070 6f69 6e74 3220   point1, point2 
-000149b0: 3d20 5b63 7574 7469 6e67 5f63 6f6e 746f  = [cutting_conto
-000149c0: 7572 2e70 7269 6d69 7469 7665 735b 305d  ur.primitives[0]
-000149d0: 2e73 7461 7274 2c0a 2020 2020 2020 2020  .start,.        
+000141e0: 2020 2020 2020 2020 2020 2020 206e 6f74               not
+000141f0: 2069 6e73 6964 6529 5b30 5d0a 2020 2020   inside)[0].    
+00014200: 2020 2020 7072 696d 6974 6976 6573 3120      primitives1 
+00014210: 3d20 6578 7472 6163 7465 645f 6f75 7465  = extracted_oute
+00014220: 7270 6f69 6e74 735f 636f 6e74 6f75 7231  rpoints_contour1
+00014230: 2e70 7269 6d69 7469 7665 7320 2b20 636c  .primitives + cl
+00014240: 6f73 696e 675f 636f 6e74 6f75 722e 7072  osing_contour.pr
+00014250: 696d 6974 6976 6573 0a20 2020 2020 2020  imitives.       
+00014260: 2070 7269 6d69 7469 7665 7332 203d 2065   primitives2 = e
+00014270: 7874 7261 6374 6564 5f69 6e6e 6572 706f  xtracted_innerpo
+00014280: 696e 7473 5f63 6f6e 746f 7572 312e 7072  ints_contour1.pr
+00014290: 696d 6974 6976 6573 202b 2063 6c6f 7369  imitives + closi
+000142a0: 6e67 5f63 6f6e 746f 7572 2e70 7269 6d69  ng_contour.primi
+000142b0: 7469 7665 730a 2020 2020 2020 2020 6966  tives.        if
+000142c0: 2065 7874 7261 6374 6564 5f6f 7574 6572   extracted_outer
+000142d0: 706f 696e 7473 5f63 6f6e 746f 7572 312e  points_contour1.
+000142e0: 7072 696d 6974 6976 6573 5b30 5d2e 7374  primitives[0].st
+000142f0: 6172 7420 3d3d 205c 0a20 2020 2020 2020  art == \.       
+00014300: 2020 2020 2020 2020 2063 6c6f 7369 6e67           closing
+00014310: 5f63 6f6e 746f 7572 2e70 7269 6d69 7469  _contour.primiti
+00014320: 7665 735b 305d 2e73 7461 7274 3a0a 2020  ves[0].start:.  
+00014330: 2020 2020 2020 2020 2020 6375 7474 696e            cuttin
+00014340: 675f 636f 6e74 6f75 725f 6e65 7720 3d20  g_contour_new = 
+00014350: 636c 6f73 696e 675f 636f 6e74 6f75 722e  closing_contour.
+00014360: 696e 7665 7274 2829 0a20 2020 2020 2020  invert().       
+00014370: 2020 2020 2070 7269 6d69 7469 7665 7331       primitives1
+00014380: 203d 2063 7574 7469 6e67 5f63 6f6e 746f   = cutting_conto
+00014390: 7572 5f6e 6577 2e70 7269 6d69 7469 7665  ur_new.primitive
+000143a0: 7320 2b20 5c0a 2020 2020 2020 2020 2020  s + \.          
+000143b0: 2020 2020 2020 6578 7472 6163 7465 645f        extracted_
+000143c0: 6f75 7465 7270 6f69 6e74 735f 636f 6e74  outerpoints_cont
+000143d0: 6f75 7231 2e70 7269 6d69 7469 7665 730a  our1.primitives.
+000143e0: 2020 2020 2020 2020 656c 6966 2065 7874          elif ext
+000143f0: 7261 6374 6564 5f6f 7574 6572 706f 696e  racted_outerpoin
+00014400: 7473 5f63 6f6e 746f 7572 312e 7072 696d  ts_contour1.prim
+00014410: 6974 6976 6573 5b30 5d2e 7374 6172 7420  itives[0].start 
+00014420: 3d3d 205c 0a20 2020 2020 2020 2020 2020  == \.           
+00014430: 2020 2020 2063 6c6f 7369 6e67 5f63 6f6e       closing_con
+00014440: 746f 7572 2e70 7269 6d69 7469 7665 735b  tour.primitives[
+00014450: 2d31 5d2e 656e 643a 0a20 2020 2020 2020  -1].end:.       
+00014460: 2020 2020 2070 7269 6d69 7469 7665 7331       primitives1
+00014470: 203d 2063 6c6f 7369 6e67 5f63 6f6e 746f   = closing_conto
+00014480: 7572 2e70 7269 6d69 7469 7665 7320 2b20  ur.primitives + 
+00014490: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+000144a0: 2020 2020 2020 2020 2020 2020 6578 7472              extr
+000144b0: 6163 7465 645f 6f75 7465 7270 6f69 6e74  acted_outerpoint
+000144c0: 735f 636f 6e74 6f75 7231 2e70 7269 6d69  s_contour1.primi
+000144d0: 7469 7665 730a 0a20 2020 2020 2020 2069  tives..        i
+000144e0: 6620 6578 7472 6163 7465 645f 696e 6e65  f extracted_inne
+000144f0: 7270 6f69 6e74 735f 636f 6e74 6f75 7231  rpoints_contour1
+00014500: 2e70 7269 6d69 7469 7665 735b 305d 2e73  .primitives[0].s
+00014510: 7461 7274 203d 3d20 5c0a 2020 2020 2020  tart == \.      
+00014520: 2020 2020 2020 2020 2020 636c 6f73 696e            closin
+00014530: 675f 636f 6e74 6f75 722e 7072 696d 6974  g_contour.primit
+00014540: 6976 6573 5b30 5d2e 7374 6172 743a 0a20  ives[0].start:. 
+00014550: 2020 2020 2020 2020 2020 2063 7574 7469             cutti
+00014560: 6e67 5f63 6f6e 746f 7572 5f6e 6577 203d  ng_contour_new =
+00014570: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+00014580: 2020 2063 6c6f 7369 6e67 5f63 6f6e 746f     closing_conto
+00014590: 7572 2e69 6e76 6572 7428 290a 2020 2020  ur.invert().    
+000145a0: 2020 2020 2020 2020 7072 696d 6974 6976          primitiv
+000145b0: 6573 3220 3d20 6375 7474 696e 675f 636f  es2 = cutting_co
+000145c0: 6e74 6f75 725f 6e65 772e 7072 696d 6974  ntour_new.primit
+000145d0: 6976 6573 202b 205c 0a20 2020 2020 2020  ives + \.       
+000145e0: 2020 2020 2020 2020 2065 7874 7261 6374           extract
+000145f0: 6564 5f69 6e6e 6572 706f 696e 7473 5f63  ed_innerpoints_c
+00014600: 6f6e 746f 7572 312e 7072 696d 6974 6976  ontour1.primitiv
+00014610: 6573 0a20 2020 2020 2020 2065 6c69 6620  es.        elif 
+00014620: 6578 7472 6163 7465 645f 696e 6e65 7270  extracted_innerp
+00014630: 6f69 6e74 735f 636f 6e74 6f75 7231 2e70  oints_contour1.p
+00014640: 7269 6d69 7469 7665 735b 0a20 2020 2020  rimitives[.     
+00014650: 2020 2020 2020 2020 2020 2030 5d2e 7374             0].st
+00014660: 6172 7420 3d3d 2063 6c6f 7369 6e67 5f63  art == closing_c
+00014670: 6f6e 746f 7572 2e70 7269 6d69 7469 7665  ontour.primitive
+00014680: 735b 2d31 5d2e 656e 643a 0a20 2020 2020  s[-1].end:.     
+00014690: 2020 2020 2020 2070 7269 6d69 7469 7665         primitive
+000146a0: 7332 203d 2063 6c6f 7369 6e67 5f63 6f6e  s2 = closing_con
+000146b0: 746f 7572 2e70 7269 6d69 7469 7665 7320  tour.primitives 
+000146c0: 2b20 5c0a 2020 2020 2020 2020 2020 2020  + \.            
+000146d0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+000146e0: 7472 6163 7465 645f 696e 6e65 7270 6f69  tracted_innerpoi
+000146f0: 6e74 735f 636f 6e74 6f75 7231 2e70 7269  nts_contour1.pri
+00014700: 6d69 7469 7665 730a 2020 2020 2020 2020  mitives.        
+00014710: 636f 6e74 6f75 7231 203d 2043 6f6e 746f  contour1 = Conto
+00014720: 7572 3244 2870 7269 6d69 7469 7665 7331  ur2D(primitives1
+00014730: 290a 2020 2020 2020 2020 636f 6e74 6f75  ).        contou
+00014740: 7231 2e6f 7264 6572 5f63 6f6e 746f 7572  r1.order_contour
+00014750: 2829 0a20 2020 2020 2020 2063 6f6e 746f  ().        conto
+00014760: 7572 3220 3d20 436f 6e74 6f75 7232 4428  ur2 = Contour2D(
+00014770: 7072 696d 6974 6976 6573 3229 0a20 2020  primitives2).   
+00014780: 2020 2020 2063 6f6e 746f 7572 322e 6f72       contour2.or
+00014790: 6465 725f 636f 6e74 6f75 7228 290a 2020  der_contour().  
+000147a0: 2020 2020 2020 7265 7475 726e 2063 6f6e        return con
+000147b0: 746f 7572 312c 2063 6f6e 746f 7572 320a  tour1, contour2.
+000147c0: 0a20 2020 2064 6566 2064 6976 6964 6528  .    def divide(
+000147d0: 7365 6c66 2c20 636f 6e74 6f75 7273 2c20  self, contours, 
+000147e0: 696e 7369 6465 293a 0a20 2020 2020 2020  inside):.       
+000147f0: 2023 2054 4f44 4f3a 2054 6869 7320 6d65   # TODO: This me
+00014800: 7468 6f64 2068 6173 2061 206d 6f64 6966  thod has a modif
+00014810: 6965 642d 6974 6572 6174 696e 672d 6c69  ied-iterating-li
+00014820: 7374 2070 796c 696e 7420 6572 726f 7220  st pylint error 
+00014830: 746f 2062 6520 6669 7865 640a 2020 2020  to be fixed.    
+00014840: 2020 2020 6e65 775f 6261 7365 5f63 6f6e      new_base_con
+00014850: 746f 7572 7320 3d20 5b73 656c 665d 0a20  tours = [self]. 
+00014860: 2020 2020 2020 2066 696e 6973 6865 6420         finished 
+00014870: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+00014880: 636f 756e 7465 7220 3d20 300a 2020 2020  counter = 0.    
+00014890: 2020 2020 6c69 7374 5f63 6f6e 746f 7572      list_contour
+000148a0: 203d 2063 6f6e 746f 7572 735b 3a5d 0a20   = contours[:]. 
+000148b0: 2020 2020 2020 206c 6973 745f 6375 7474         list_cutt
+000148c0: 696e 675f 636f 6e74 6f75 7273 203d 2063  ing_contours = c
+000148d0: 6f6e 746f 7572 735b 3a5d 0a20 2020 2020  ontours[:].     
+000148e0: 2020 206c 6973 745f 7661 6c69 645f 636f     list_valid_co
+000148f0: 6e74 6f75 7273 203d 205b 5d0a 2020 2020  ntours = [].    
+00014900: 2020 2020 7768 696c 6520 6e6f 7420 6669      while not fi
+00014910: 6e69 7368 6564 3a0a 2020 2020 2020 2020  nished:.        
+00014920: 2020 2020 6375 7474 696e 675f 636f 6e74      cutting_cont
+00014930: 6f75 7220 3d20 636f 6e74 6f75 7273 5b30  our = contours[0
+00014940: 5d0a 2020 2020 2020 2020 2020 2020 666f  ].            fo
+00014950: 7220 6261 7365 5f63 6f6e 746f 7572 2069  r base_contour i
+00014960: 6e20 6e65 775f 6261 7365 5f63 6f6e 746f  n new_base_conto
+00014970: 7572 733a 0a20 2020 2020 2020 2020 2020  urs:.           
+00014980: 2020 2020 2063 7574 7469 6e67 5f70 6f69       cutting_poi
+00014990: 6e74 7320 3d20 5b5d 0a20 2020 2020 2020  nts = [].       
+000149a0: 2020 2020 2020 2020 2070 6f69 6e74 312c           point1,
+000149b0: 2070 6f69 6e74 3220 3d20 5b63 7574 7469   point2 = [cutti
+000149c0: 6e67 5f63 6f6e 746f 7572 2e70 7269 6d69  ng_contour.primi
+000149d0: 7469 7665 735b 305d 2e73 7461 7274 2c0a  tives[0].start,.
 000149e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000149f0: 2020 2020 2020 2020 2020 6375 7474 696e            cuttin
-00014a00: 675f 636f 6e74 6f75 722e 7072 696d 6974  g_contour.primit
-00014a10: 6976 6573 5b2d 315d 2e65 6e64 5d0a 2020  ives[-1].end].  
-00014a20: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00014a30: 206e 6f74 2061 6e79 2862 6173 655f 636f   not any(base_co
-00014a40: 6e74 6f75 722e 706f 696e 745f 6265 6c6f  ntour.point_belo
-00014a50: 6e67 7328 7072 696d 2e6d 6964 646c 655f  ngs(prim.middle_
-00014a60: 706f 696e 7428 2929 2066 6f72 2070 7269  point()) for pri
-00014a70: 6d20 696e 2063 7574 7469 6e67 5f63 6f6e  m in cutting_con
-00014a80: 746f 7572 2e70 7269 6d69 7469 7665 7329  tour.primitives)
-00014a90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00014aa0: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
-00014ab0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00014ac0: 6620 6261 7365 5f63 6f6e 746f 7572 2e70  f base_contour.p
-00014ad0: 6f69 6e74 5f6f 7665 725f 636f 6e74 6f75  oint_over_contou
-00014ae0: 7228 706f 696e 7431 2920 616e 6420 6261  r(point1) and ba
-00014af0: 7365 5f63 6f6e 746f 7572 2e70 6f69 6e74  se_contour.point
-00014b00: 5f6f 7665 725f 636f 6e74 6f75 7228 706f  _over_contour(po
-00014b10: 696e 7432 293a 0a20 2020 2020 2020 2020  int2):.         
-00014b20: 2020 2020 2020 2020 2020 2063 7574 7469             cutti
-00014b30: 6e67 5f70 6f69 6e74 7320 3d20 5b70 6f69  ng_points = [poi
-00014b40: 6e74 312c 2070 6f69 6e74 325d 0a20 2020  nt1, point2].   
-00014b50: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00014b60: 6620 6c65 6e28 6e65 775f 6261 7365 5f63  f len(new_base_c
-00014b70: 6f6e 746f 7572 7329 203d 3d20 313a 0a20  ontours) == 1:. 
-00014b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b90: 2020 2063 6f6e 746f 7572 732e 7265 6d6f     contours.remo
-00014ba0: 7665 2863 7574 7469 6e67 5f63 6f6e 746f  ve(cutting_conto
-00014bb0: 7572 290a 2020 2020 2020 2020 2020 2020  ur).            
-00014bc0: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
-00014bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014be0: 2069 6620 6375 7474 696e 675f 706f 696e   if cutting_poin
-00014bf0: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-00014c00: 2020 2020 2020 2020 636f 6e74 6f75 7231          contour1
-00014c10: 2c20 636f 6e74 6f75 7232 203d 2062 6173  , contour2 = bas
-00014c20: 655f 636f 6e74 6f75 722e 6765 745f 6469  e_contour.get_di
-00014c30: 7669 6465 645f 636f 6e74 6f75 7273 280a  vided_contours(.
-00014c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c50: 2020 2020 2020 2020 6375 7474 696e 675f          cutting_
-00014c60: 706f 696e 7473 5b30 5d2c 2063 7574 7469  points[0], cutti
-00014c70: 6e67 5f70 6f69 6e74 735b 315d 2c20 6375  ng_points[1], cu
-00014c80: 7474 696e 675f 636f 6e74 6f75 722c 2069  tting_contour, i
-00014c90: 6e73 6964 6529 0a0a 2020 2020 2020 2020  nside)..        
-00014ca0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00014cb0: 6261 7365 5f63 6f6e 746f 7572 732e 7265  base_contours.re
-00014cc0: 6d6f 7665 2862 6173 655f 636f 6e74 6f75  move(base_contou
-00014cd0: 7229 0a20 2020 2020 2020 2020 2020 2020  r).             
-00014ce0: 2020 2020 2020 2066 6f72 2063 6e74 7220         for cntr 
-00014cf0: 696e 205b 636f 6e74 6f75 7231 2c20 636f  in [contour1, co
-00014d00: 6e74 6f75 7232 5d3a 0a20 2020 2020 2020  ntour2]:.       
-00014d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d20: 2061 6c6c 5f64 6976 6964 6564 5f63 6f6e   all_divided_con
-00014d30: 746f 7572 203d 2054 7275 650a 2020 2020  tour = True.    
-00014d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d50: 2020 2020 666f 7220 6375 745f 636f 6e74      for cut_cont
-00014d60: 6f75 7220 696e 206c 6973 745f 6375 7474  our in list_cutt
-00014d70: 696e 675f 636f 6e74 6f75 7273 3a0a 2020  ing_contours:.  
-00014d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d90: 2020 2020 2020 2020 2020 706f 696e 7473            points
-00014da0: 5f61 745f 6162 7320 3d20 5b70 7269 6d2e  _at_abs = [prim.
-00014db0: 6d69 6464 6c65 5f70 6f69 6e74 2829 2066  middle_point() f
-00014dc0: 6f72 2070 7269 6d20 696e 2063 7574 5f63  or prim in cut_c
-00014dd0: 6f6e 746f 7572 2e70 7269 6d69 7469 7665  ontour.primitive
-00014de0: 735d 0a20 2020 2020 2020 2020 2020 2020  s].             
-00014df0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00014e00: 6f72 2070 6f69 6e74 5f61 745f 6162 7320  or point_at_abs 
-00014e10: 696e 2070 6f69 6e74 735f 6174 5f61 6273  in points_at_abs
-00014e20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000149f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a00: 2020 6375 7474 696e 675f 636f 6e74 6f75    cutting_contou
+00014a10: 722e 7072 696d 6974 6976 6573 5b2d 315d  r.primitives[-1]
+00014a20: 2e65 6e64 5d0a 2020 2020 2020 2020 2020  .end].          
+00014a30: 2020 2020 2020 6966 206e 6f74 2061 6e79        if not any
+00014a40: 2862 6173 655f 636f 6e74 6f75 722e 706f  (base_contour.po
+00014a50: 696e 745f 6265 6c6f 6e67 7328 7072 696d  int_belongs(prim
+00014a60: 2e6d 6964 646c 655f 706f 696e 7428 2929  .middle_point())
+00014a70: 2066 6f72 2070 7269 6d20 696e 2063 7574   for prim in cut
+00014a80: 7469 6e67 5f63 6f6e 746f 7572 2e70 7269  ting_contour.pri
+00014a90: 6d69 7469 7665 7329 3a0a 2020 2020 2020  mitives):.      
+00014aa0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00014ab0: 6e74 696e 7565 0a20 2020 2020 2020 2020  ntinue.         
+00014ac0: 2020 2020 2020 2069 6620 6261 7365 5f63         if base_c
+00014ad0: 6f6e 746f 7572 2e70 6f69 6e74 5f6f 7665  ontour.point_ove
+00014ae0: 725f 636f 6e74 6f75 7228 706f 696e 7431  r_contour(point1
+00014af0: 2920 616e 6420 6261 7365 5f63 6f6e 746f  ) and base_conto
+00014b00: 7572 2e70 6f69 6e74 5f6f 7665 725f 636f  ur.point_over_co
+00014b10: 6e74 6f75 7228 706f 696e 7432 293a 0a20  ntour(point2):. 
+00014b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014b30: 2020 2063 7574 7469 6e67 5f70 6f69 6e74     cutting_point
+00014b40: 7320 3d20 5b70 6f69 6e74 312c 2070 6f69  s = [point1, poi
+00014b50: 6e74 325d 0a20 2020 2020 2020 2020 2020  nt2].           
+00014b60: 2020 2020 2065 6c69 6620 6c65 6e28 6e65       elif len(ne
+00014b70: 775f 6261 7365 5f63 6f6e 746f 7572 7329  w_base_contours)
+00014b80: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00014b90: 2020 2020 2020 2020 2020 2063 6f6e 746f             conto
+00014ba0: 7572 732e 7265 6d6f 7665 2863 7574 7469  urs.remove(cutti
+00014bb0: 6e67 5f63 6f6e 746f 7572 290a 2020 2020  ng_contour).    
+00014bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014bd0: 636f 6e74 696e 7565 0a20 2020 2020 2020  continue.       
+00014be0: 2020 2020 2020 2020 2069 6620 6375 7474           if cutt
+00014bf0: 696e 675f 706f 696e 7473 3a0a 2020 2020  ing_points:.    
+00014c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014c10: 636f 6e74 6f75 7231 2c20 636f 6e74 6f75  contour1, contou
+00014c20: 7232 203d 2062 6173 655f 636f 6e74 6f75  r2 = base_contou
+00014c30: 722e 6765 745f 6469 7669 6465 645f 636f  r.get_divided_co
+00014c40: 6e74 6f75 7273 280a 2020 2020 2020 2020  ntours(.        
+00014c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014c60: 6375 7474 696e 675f 706f 696e 7473 5b30  cutting_points[0
+00014c70: 5d2c 2063 7574 7469 6e67 5f70 6f69 6e74  ], cutting_point
+00014c80: 735b 315d 2c20 6375 7474 696e 675f 636f  s[1], cutting_co
+00014c90: 6e74 6f75 722c 2069 6e73 6964 6529 0a0a  ntour, inside)..
+00014ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014cb0: 2020 2020 6e65 775f 6261 7365 5f63 6f6e      new_base_con
+00014cc0: 746f 7572 732e 7265 6d6f 7665 2862 6173  tours.remove(bas
+00014cd0: 655f 636f 6e74 6f75 7229 0a20 2020 2020  e_contour).     
+00014ce0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00014cf0: 6f72 2063 6e74 7220 696e 205b 636f 6e74  or cntr in [cont
+00014d00: 6f75 7231 2c20 636f 6e74 6f75 7232 5d3a  our1, contour2]:
+00014d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014d20: 2020 2020 2020 2020 2061 6c6c 5f64 6976           all_div
+00014d30: 6964 6564 5f63 6f6e 746f 7572 203d 2054  ided_contour = T
+00014d40: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+00014d50: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00014d60: 6375 745f 636f 6e74 6f75 7220 696e 206c  cut_contour in l
+00014d70: 6973 745f 6375 7474 696e 675f 636f 6e74  ist_cutting_cont
+00014d80: 6f75 7273 3a0a 2020 2020 2020 2020 2020  ours:.          
+00014d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014da0: 2020 706f 696e 7473 5f61 745f 6162 7320    points_at_abs 
+00014db0: 3d20 5b70 7269 6d2e 6d69 6464 6c65 5f70  = [prim.middle_p
+00014dc0: 6f69 6e74 2829 2066 6f72 2070 7269 6d20  oint() for prim 
+00014dd0: 696e 2063 7574 5f63 6f6e 746f 7572 2e70  in cut_contour.p
+00014de0: 7269 6d69 7469 7665 735d 0a20 2020 2020  rimitives].     
+00014df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e00: 2020 2020 2020 2066 6f72 2070 6f69 6e74         for point
+00014e10: 5f61 745f 6162 7320 696e 2070 6f69 6e74  _at_abs in point
+00014e20: 735f 6174 5f61 6273 3a0a 2020 2020 2020  s_at_abs:.      
 00014e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e40: 2020 6966 2063 6e74 722e 706f 696e 745f    if cntr.point_
-00014e50: 6265 6c6f 6e67 7328 706f 696e 745f 6174  belongs(point_at
-00014e60: 5f61 6273 2920 616e 6420 5c0a 2020 2020  _abs) and \.    
-00014e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e40: 2020 2020 2020 2020 2020 6966 2063 6e74            if cnt
+00014e50: 722e 706f 696e 745f 6265 6c6f 6e67 7328  r.point_belongs(
+00014e60: 706f 696e 745f 6174 5f61 6273 2920 616e  point_at_abs) an
+00014e70: 6420 5c0a 2020 2020 2020 2020 2020 2020  d \.            
 00014e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e90: 2020 2020 286e 6f74 2063 6e74 722e 706f      (not cntr.po
-00014ea0: 696e 745f 6f76 6572 5f63 6f6e 746f 7572  int_over_contour
-00014eb0: 2870 6f69 6e74 5f61 745f 6162 7329 2061  (point_at_abs) a
-00014ec0: 6e64 0a20 2020 2020 2020 2020 2020 2020  nd.             
+00014e90: 2020 2020 2020 2020 2020 2020 286e 6f74              (not
+00014ea0: 2063 6e74 722e 706f 696e 745f 6f76 6572   cntr.point_over
+00014eb0: 5f63 6f6e 746f 7572 2870 6f69 6e74 5f61  _contour(point_a
+00014ec0: 745f 6162 7329 2061 6e64 0a20 2020 2020  t_abs) and.     
 00014ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ee0: 2020 2020 2020 2020 2020 2020 5472 7565              True
-00014ef0: 206e 6f74 2069 6e20 5b63 6e74 722e 7072   not in [cntr.pr
-00014f00: 696d 6974 6976 655f 6f76 6572 5f63 6f6e  imitive_over_con
-00014f10: 746f 7572 2870 7269 6d29 0a20 2020 2020  tour(prim).     
-00014f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ef0: 2020 2020 5472 7565 206e 6f74 2069 6e20      True not in 
+00014f00: 5b63 6e74 722e 7072 696d 6974 6976 655f  [cntr.primitive_
+00014f10: 6f76 6572 5f63 6f6e 746f 7572 2870 7269  over_contour(pri
+00014f20: 6d29 0a20 2020 2020 2020 2020 2020 2020  m).             
 00014f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00014f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f50: 2066 6f72 2070 7269 6d20 696e 2063 7574   for prim in cut
-00014f60: 5f63 6f6e 746f 7572 2e70 7269 6d69 7469  _contour.primiti
-00014f70: 7665 735d 293a 0a20 2020 2020 2020 2020  ves]):.         
+00014f50: 2020 2020 2020 2020 2066 6f72 2070 7269           for pri
+00014f60: 6d20 696e 2063 7574 5f63 6f6e 746f 7572  m in cut_contour
+00014f70: 2e70 7269 6d69 7469 7665 735d 293a 0a20  .primitives]):. 
 00014f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f90: 2020 2020 2020 2020 2020 2061 6c6c 5f64             all_d
-00014fa0: 6976 6964 6564 5f63 6f6e 746f 7572 203d  ivided_contour =
-00014fb0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00014f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014fa0: 2020 2061 6c6c 5f64 6976 6964 6564 5f63     all_divided_c
+00014fb0: 6f6e 746f 7572 203d 2046 616c 7365 0a20  ontour = False. 
 00014fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014fd0: 2020 2020 2020 2020 2020 2062 7265 616b             break
-00014fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014ff0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00015000: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00014fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014fe0: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
+00014ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015000: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
 00015010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015020: 2020 2063 6f6e 7469 6e75 650a 2020 2020     continue.    
-00015030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015040: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
-00015050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015060: 2020 2020 2020 6966 2061 6c6c 5f64 6976        if all_div
-00015070: 6964 6564 5f63 6f6e 746f 7572 2061 6e64  ided_contour and
-00015080: 2063 6e74 722e 6172 6561 2829 2021 3d20   cntr.area() != 
-00015090: 302e 303a 0a20 2020 2020 2020 2020 2020  0.0:.           
+00015020: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+00015030: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
+00015040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015050: 6272 6561 6b0a 2020 2020 2020 2020 2020  break.          
+00015060: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00015070: 2061 6c6c 5f64 6976 6964 6564 5f63 6f6e   all_divided_con
+00015080: 746f 7572 2061 6e64 2063 6e74 722e 6172  tour and cntr.ar
+00015090: 6561 2829 2021 3d20 302e 303a 0a20 2020  ea() != 0.0:.   
 000150a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000150b0: 206c 6973 745f 7661 6c69 645f 636f 6e74   list_valid_cont
-000150c0: 6f75 7273 2e61 7070 656e 6428 636e 7472  ours.append(cntr
-000150d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000150e0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-000150f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015100: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00015110: 6261 7365 5f63 6f6e 746f 7572 732e 6170  base_contours.ap
-00015120: 7065 6e64 2863 6e74 7229 0a20 2020 2020  pend(cntr).     
-00015130: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00015140: 6f6e 746f 7572 732e 7265 6d6f 7665 2863  ontours.remove(c
-00015150: 7574 7469 6e67 5f63 6f6e 746f 7572 290a  utting_contour).
-00015160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015170: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
-00015180: 2020 2020 2020 6966 206c 656e 2863 6f6e        if len(con
-00015190: 746f 7572 7329 203d 3d20 303a 0a20 2020  tours) == 0:.   
-000151a0: 2020 2020 2020 2020 2020 2020 2066 696e               fin
-000151b0: 6973 6865 6420 3d20 5472 7565 0a20 2020  ished = True.   
-000151c0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-000151d0: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
-000151e0: 2020 6966 206c 656e 2863 6f6e 746f 7572    if len(contour
-000151f0: 7329 203d 3d20 3120 616e 6420 6e6f 7420  s) == 1 and not 
-00015200: 6e65 775f 6261 7365 5f63 6f6e 746f 7572  new_base_contour
-00015210: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00015220: 2020 2066 696e 6973 6865 6420 3d20 5472     finished = Tr
-00015230: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-00015240: 2020 2063 6f6e 7469 6e75 650a 2020 2020     continue.    
-00015250: 2020 2020 2020 2020 636f 756e 7465 7220          counter 
-00015260: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
-00015270: 2069 6620 636f 756e 7465 7220 3e3d 2031   if counter >= 1
-00015280: 3030 202a 206c 656e 286c 6973 745f 636f  00 * len(list_co
-00015290: 6e74 6f75 7229 3a0a 2020 2020 2020 2020  ntour):.        
-000152a0: 2020 2020 2020 2020 2320 6966 2062 6173          # if bas
-000152b0: 655f 636f 6e74 6f75 722e 6973 5f69 6e73  e_contour.is_ins
-000152c0: 6964 6528 636f 6e74 6f75 7273 5b30 5d29  ide(contours[0])
-000152d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000152e0: 2020 2320 2020 2020 636f 6e74 6f75 7273    #     contours
-000152f0: 2e72 656d 6f76 6528 6375 7474 696e 675f  .remove(cutting_
-00015300: 636f 6e74 6f75 7229 0a20 2020 2020 2020  contour).       
-00015310: 2020 2020 2020 2020 2023 2020 2020 2063           #     c
-00015320: 6f6e 7469 6e75 650a 2020 2020 2020 2020  ontinue.        
-00015330: 2020 2020 2020 2020 2320 6c69 7374 5f76          # list_v
-00015340: 616c 6964 5f63 6f6e 746f 7572 732e 6170  alid_contours.ap
-00015350: 7065 6e64 2862 6173 655f 636f 6e74 6f75  pend(base_contou
-00015360: 7229 0a20 2020 2020 2020 2020 2020 2020  r).             
-00015370: 2020 2023 2066 696e 6973 6865 6420 3d20     # finished = 
-00015380: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
-00015390: 2020 2020 2063 6f6e 746f 7572 7320 3d20       contours = 
-000153a0: 636f 6e74 6f75 7273 5b3a 3a2d 315d 0a20  contours[::-1]. 
-000153b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000153c0: 6620 636f 756e 7465 7220 3e20 3130 3020  f counter > 100 
-000153d0: 2a20 6c65 6e28 6c69 7374 5f63 6f6e 746f  * len(list_conto
-000153e0: 7572 2920 2b20 6c65 6e28 636f 6e74 6f75  ur) + len(contou
-000153f0: 7273 293a 0a20 2020 2020 2020 2020 2020  rs):.           
-00015400: 2020 2020 2020 2020 2023 2070 7269 6e74           # print
-00015410: 2827 6e65 775f 6261 7365 5f63 6f6e 746f  ('new_base_conto
-00015420: 7572 733a 272c 206c 656e 286e 6577 5f62  urs:', len(new_b
-00015430: 6173 655f 636f 6e74 6f75 7273 2929 0a20  ase_contours)). 
-00015440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015450: 2020 2023 2070 7269 6e74 2827 6c65 6e28     # print('len(
-00015460: 636f 6e74 6f75 7273 293a 272c 206c 656e  contours):', len
-00015470: 2863 6f6e 746f 7572 7329 290a 2020 2020  (contours)).    
-00015480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015490: 2320 6178 203d 2063 6f6e 746f 7572 735b  # ax = contours[
-000154a0: 305d 2e70 6c6f 7428 290a 2020 2020 2020  0].plot().      
-000154b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000154c0: 6261 7365 5f63 6f6e 746f 7572 2e70 6c6f  base_contour.plo
-000154d0: 7428 6178 3d61 782c 2063 6f6c 6f72 3d27  t(ax=ax, color='
-000154e0: 6227 290a 2020 2020 2020 2020 2020 2020  b').            
-000154f0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-00015500: 2e77 6172 6e28 2754 6865 7265 2070 726f  .warn('There pro
-00015510: 6261 626c 7920 6578 6973 7473 2061 6e20  bably exists an 
-00015520: 6f70 656e 2063 6f6e 746f 7572 2028 7477  open contour (tw
-00015530: 6f20 7769 7265 7320 7468 6174 2063 6f75  o wires that cou
-00015540: 6c64 206e 6f74 2062 6520 636f 6e6e 6563  ld not be connec
-00015550: 7465 6429 2729 0a20 2020 2020 2020 2020  ted)').         
-00015560: 2020 2020 2020 2020 2020 2066 696e 6973             finis
-00015570: 6865 6420 3d20 5472 7565 0a0a 2020 2020  hed = True..    
-00015580: 2020 2020 7265 7475 726e 206c 6973 745f      return list_
-00015590: 7661 6c69 645f 636f 6e74 6f75 7273 0a0a  valid_contours..
-000155a0: 2020 2020 6465 6620 6469 7363 7265 7469      def discreti
-000155b0: 7a65 645f 636f 6e74 6f75 7228 7365 6c66  zed_contour(self
-000155c0: 2c20 6e3a 2066 6c6f 6174 293a 0a20 2020  , n: float):.   
-000155d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000155e0: 2044 6973 6372 6574 697a 6520 6561 6368   Discretize each
-000155f0: 2063 6f6e 746f 7572 2773 2070 7269 6d69   contour's primi
-00015600: 7469 7665 2061 6e64 2072 6574 7572 6e20  tive and return 
-00015610: 6120 6e65 7720 636f 6e74 6f75 7220 7769  a new contour wi
-00015620: 7468 2074 6573 6573 2064 6973 6372 6574  th teses discret
-00015630: 697a 6564 2070 7269 6d69 7469 7665 732e  ized primitives.
-00015640: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00015650: 2020 2020 2063 6f6e 746f 7572 203d 2043       contour = C
-00015660: 6f6e 746f 7572 3244 2828 7365 6c66 2e64  ontour2D((self.d
-00015670: 6973 6372 6574 697a 6564 5f70 7269 6d69  iscretized_primi
-00015680: 7469 7665 7328 6e29 2929 0a0a 2020 2020  tives(n)))..    
-00015690: 2020 2020 7265 7475 726e 2063 6f6e 746f      return conto
-000156a0: 7572 2e6f 7264 6572 5f63 6f6e 746f 7572  ur.order_contour
-000156b0: 2829 0a0a 2020 2020 4063 6c61 7373 6d65  ()..    @classme
-000156c0: 7468 6f64 0a20 2020 2064 6566 2066 726f  thod.    def fro
-000156d0: 6d5f 626f 756e 6469 6e67 5f72 6563 7461  m_bounding_recta
-000156e0: 6e67 6c65 2863 6c73 2c20 785f 6d69 6e2c  ngle(cls, x_min,
-000156f0: 2078 5f6d 6178 2c20 795f 6d69 6e2c 2079   x_max, y_min, y
-00015700: 5f6d 6178 293a 0a20 2020 2020 2020 2022  _max):.        "
-00015710: 2222 0a20 2020 2020 2020 2043 7265 6174  "".        Creat
-00015720: 6520 6120 636f 6e74 6f75 7232 6420 7769  e a contour2d wi
-00015730: 7468 2062 6f75 6e64 696e 675f 626f 7820  th bounding_box 
-00015740: 7061 7261 6d65 7465 7273 2c20 7573 696e  parameters, usin
-00015750: 6720 6c69 6e65 7365 676d 656e 7473 3264  g linesegments2d
-00015760: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00015770: 2020 2020 2020 2065 6467 6530 203d 2076         edge0 = v
-00015780: 6f6c 6d64 6c72 2e65 6467 6573 2e4c 696e  olmdlr.edges.Lin
-00015790: 6553 6567 6d65 6e74 3244 2876 6f6c 6d64  eSegment2D(volmd
-000157a0: 6c72 2e50 6f69 6e74 3244 2878 5f6d 696e  lr.Point2D(x_min
-000157b0: 2c20 795f 6d69 6e29 2c20 766f 6c6d 646c  , y_min), volmdl
-000157c0: 722e 506f 696e 7432 4428 785f 6d61 782c  r.Point2D(x_max,
-000157d0: 2079 5f6d 696e 2929 0a20 2020 2020 2020   y_min)).       
-000157e0: 2065 6467 6531 203d 2076 6f6c 6d64 6c72   edge1 = volmdlr
-000157f0: 2e65 6467 6573 2e4c 696e 6553 6567 6d65  .edges.LineSegme
-00015800: 6e74 3244 2876 6f6c 6d64 6c72 2e50 6f69  nt2D(volmdlr.Poi
-00015810: 6e74 3244 2878 5f6d 6178 2c20 795f 6d69  nt2D(x_max, y_mi
-00015820: 6e29 2c20 766f 6c6d 646c 722e 506f 696e  n), volmdlr.Poin
-00015830: 7432 4428 785f 6d61 782c 2079 5f6d 6178  t2D(x_max, y_max
-00015840: 2929 0a20 2020 2020 2020 2065 6467 6532  )).        edge2
-00015850: 203d 2076 6f6c 6d64 6c72 2e65 6467 6573   = volmdlr.edges
-00015860: 2e4c 696e 6553 6567 6d65 6e74 3244 2876  .LineSegment2D(v
-00015870: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 2878  olmdlr.Point2D(x
-00015880: 5f6d 6178 2c20 795f 6d61 7829 2c20 766f  _max, y_max), vo
-00015890: 6c6d 646c 722e 506f 696e 7432 4428 785f  lmdlr.Point2D(x_
-000158a0: 6d69 6e2c 2079 5f6d 6178 2929 0a20 2020  min, y_max)).   
-000158b0: 2020 2020 2065 6467 6533 203d 2076 6f6c       edge3 = vol
-000158c0: 6d64 6c72 2e65 6467 6573 2e4c 696e 6553  mdlr.edges.LineS
-000158d0: 6567 6d65 6e74 3244 2876 6f6c 6d64 6c72  egment2D(volmdlr
-000158e0: 2e50 6f69 6e74 3244 2878 5f6d 696e 2c20  .Point2D(x_min, 
-000158f0: 795f 6d61 7829 2c20 766f 6c6d 646c 722e  y_max), volmdlr.
-00015900: 506f 696e 7432 4428 785f 6d69 6e2c 2079  Point2D(x_min, y
-00015910: 5f6d 696e 2929 0a0a 2020 2020 2020 2020  _min))..        
-00015920: 6564 6765 7320 3d20 5b65 6467 6530 2c20  edges = [edge0, 
-00015930: 6564 6765 312c 2065 6467 6532 2c20 6564  edge1, edge2, ed
-00015940: 6765 335d 0a0a 2020 2020 2020 2020 7265  ge3]..        re
-00015950: 7475 726e 2043 6f6e 746f 7572 3244 2865  turn Contour2D(e
-00015960: 6467 6573 290a 0a20 2020 2064 6566 2063  dges)..    def c
-00015970: 7574 5f62 795f 6273 706c 696e 655f 6375  ut_by_bspline_cu
-00015980: 7276 6528 7365 6c66 2c20 6273 706c 696e  rve(self, bsplin
-00015990: 655f 6375 7276 6532 643a 2076 6f6c 6d64  e_curve2d: volmd
-000159a0: 6c72 2e65 6467 6573 2e42 5370 6c69 6e65  lr.edges.BSpline
-000159b0: 4375 7276 6532 4429 3a0a 2020 2020 2020  Curve2D):.      
-000159c0: 2020 2222 220a 2020 2020 2020 2020 4375    """.        Cu
-000159d0: 7420 6120 636f 6e74 6f75 3264 2077 6974  t a contou2d wit
-000159e0: 6820 6273 706c 696e 655f 6375 7276 6532  h bspline_curve2
-000159f0: 6420 746f 2064 6566 696e 6520 7477 6f20  d to define two 
-00015a00: 6469 6666 6572 656e 7420 636f 6e74 6f75  different contou
-00015a10: 7273 2e0a 2020 2020 2020 2020 2222 220a  rs..        """.
-00015a20: 2020 2020 2020 2020 2320 544f 444f 3a20          # TODO: 
-00015a30: 4273 706c 696e 6543 7572 7665 2069 7320  BsplineCurve is 
-00015a40: 6465 7363 7265 7469 7a65 6420 616e 6420  descretized and 
-00015a50: 6465 6669 6e65 6420 7769 7468 2061 2077  defined with a w
-00015a60: 6972 652e 2054 6f20 6265 2069 6d70 726f  ire. To be impro
-00015a70: 7665 6421 0a0a 2020 2020 2020 2020 636f  ved!..        co
-00015a80: 6e74 6f75 7273 203d 2073 656c 662e 6375  ntours = self.cu
-00015a90: 745f 6279 5f77 6972 6528 6273 706c 696e  t_by_wire(bsplin
-00015aa0: 655f 6375 7276 6532 642e 746f 5f77 6972  e_curve2d.to_wir
-00015ab0: 6528 3230 2929 0a0a 2020 2020 2020 2020  e(20))..        
-00015ac0: 7265 7475 726e 2063 6f6e 746f 7572 730a  return contours.
-00015ad0: 0a20 2020 2064 6566 2063 6c65 616e 5f70  .    def clean_p
-00015ae0: 7269 6d69 7469 7665 7328 7365 6c66 293a  rimitives(self):
-00015af0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00015b00: 2020 2020 2044 656c 6574 6520 7072 696d       Delete prim
-00015b10: 6974 6976 6573 2077 6974 6820 7374 6172  itives with star
-00015b20: 743d 656e 642c 2061 6e64 2072 6574 7572  t=end, and retur
-00015b30: 6e20 6120 6e65 7720 636f 6e74 6f75 722e  n a new contour.
-00015b40: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00015b50: 2020 2020 2020 6e65 775f 7072 696d 6974        new_primit
-00015b60: 6976 6573 203d 205b 5d0a 2020 2020 2020  ives = [].      
-00015b70: 2020 666f 7220 7020 696e 2073 656c 662e    for p in self.
-00015b80: 7072 696d 6974 6976 6573 3a0a 2020 2020  primitives:.    
-00015b90: 2020 2020 2020 2020 6966 2070 2e73 7461          if p.sta
-00015ba0: 7274 2021 3d20 702e 656e 643a 0a20 2020  rt != p.end:.   
-00015bb0: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00015bc0: 5f70 7269 6d69 7469 7665 732e 6170 7065  _primitives.appe
-00015bd0: 6e64 2870 290a 0a20 2020 2020 2020 2072  nd(p)..        r
-00015be0: 6574 7572 6e20 436f 6e74 6f75 7232 4428  eturn Contour2D(
-00015bf0: 6e65 775f 7072 696d 6974 6976 6573 290a  new_primitives).
-00015c00: 0a20 2020 2064 6566 206d 6572 6765 5f77  .    def merge_w
-00015c10: 6974 6828 7365 6c66 2c20 636f 6e74 6f75  ith(self, contou
-00015c20: 7232 6429 3a0a 2020 2020 2020 2020 2222  r2d):.        ""
-00015c30: 220a 2020 2020 2020 2020 4d65 7267 6520  ".        Merge 
-00015c40: 7477 6f20 6164 6a61 6365 6e74 2063 6f6e  two adjacent con
-00015c50: 746f 7572 732c 2073 6861 7269 6e67 2070  tours, sharing p
-00015c60: 7269 6d69 7469 7665 732c 2061 6e64 2072  rimitives, and r
-00015c70: 6574 7572 6e73 206f 6e65 206f 7574 6572  eturns one outer
-00015c80: 2063 6f6e 746f 7572 2061 6e64 2069 6e6e   contour and inn
-00015c90: 6572 2063 6f6e 746f 7572 730a 2020 2020  er contours.    
-00015ca0: 2020 2020 2869 6620 7468 6572 6520 6172      (if there ar
-00015cb0: 6520 616e 7929 2e0a 0a20 2020 2020 2020  e any)...       
-00015cc0: 203a 7061 7261 6d20 636f 6e74 6f75 7232   :param contour2
-00015cd0: 643a 2063 6f6e 746f 7572 2074 6f20 6d65  d: contour to me
-00015ce0: 7267 6520 7769 7468 0a20 2020 2020 2020  rge with.       
-00015cf0: 203a 7265 7475 726e 3a20 6d65 7267 6564   :return: merged
-00015d00: 2063 6f6e 746f 7572 730a 2020 2020 2020   contours.      
-00015d10: 2020 2222 220a 2020 2020 2020 2020 6973    """.        is
-00015d20: 5f73 6861 7269 6e67 5f70 7269 6d69 7469  _sharing_primiti
-00015d30: 7665 203d 2073 656c 662e 6973 5f73 6861  ve = self.is_sha
-00015d40: 7269 6e67 5f70 7269 6d69 7469 7665 735f  ring_primitives_
-00015d50: 7769 7468 2863 6f6e 746f 7572 3264 290a  with(contour2d).
-00015d60: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00015d70: 6973 5f69 6e73 6964 6528 636f 6e74 6f75  is_inside(contou
-00015d80: 7232 6429 2061 6e64 206e 6f74 2069 735f  r2d) and not is_
-00015d90: 7368 6172 696e 675f 7072 696d 6974 6976  sharing_primitiv
-00015da0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00015db0: 6574 7572 6e20 5b73 656c 665d 0a20 2020  eturn [self].   
-00015dc0: 2020 2020 2069 6620 636f 6e74 6f75 7232       if contour2
-00015dd0: 642e 6973 5f69 6e73 6964 6528 7365 6c66  d.is_inside(self
-00015de0: 2920 616e 6420 6e6f 7420 6973 5f73 6861  ) and not is_sha
-00015df0: 7269 6e67 5f70 7269 6d69 7469 7665 3a0a  ring_primitive:.
-00015e00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00015e10: 726e 205b 636f 6e74 6f75 7232 645d 0a0a  rn [contour2d]..
-00015e20: 2020 2020 2020 2020 6d65 7267 6564 5f70          merged_p
-00015e30: 7269 6d69 7469 7665 7320 3d20 7365 6c66  rimitives = self
-00015e40: 2e6d 6572 6765 5f70 7269 6d69 7469 7665  .merge_primitive
-00015e50: 735f 7769 7468 2863 6f6e 746f 7572 3264  s_with(contour2d
-00015e60: 290a 2020 2020 2020 2020 636f 6e74 6f75  ).        contou
-00015e70: 7273 203d 2043 6f6e 746f 7572 3244 2e63  rs = Contour2D.c
-00015e80: 6f6e 746f 7572 735f 6672 6f6d 5f65 6467  ontours_from_edg
-00015e90: 6573 286d 6572 6765 645f 7072 696d 6974  es(merged_primit
-00015ea0: 6976 6573 290a 2020 2020 2020 2020 636f  ives).        co
-00015eb0: 6e74 6f75 7273 203d 2073 6f72 7465 6428  ntours = sorted(
-00015ec0: 636f 6e74 6f75 7273 2c20 6b65 793d 6c61  contours, key=la
-00015ed0: 6d62 6461 2063 6f6e 746f 7572 3a20 636f  mbda contour: co
-00015ee0: 6e74 6f75 722e 6172 6561 2829 2c0a 2020  ntour.area(),.  
-00015ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f00: 2020 2020 2020 2020 7265 7665 7273 653d          reverse=
-00015f10: 5472 7565 290a 2020 2020 2020 2020 7265  True).        re
-00015f20: 7475 726e 2063 6f6e 746f 7572 730a 0a20  turn contours.. 
-00015f30: 2020 2064 6566 2075 6e69 6f6e 2873 656c     def union(sel
-00015f40: 662c 2063 6f6e 746f 7572 323a 2027 436f  f, contour2: 'Co
-00015f50: 6e74 6f75 7232 4427 293a 0a20 2020 2020  ntour2D'):.     
-00015f60: 2020 2022 2222 0a20 2020 2020 2020 2055     """.        U
-00015f70: 6e69 6f6e 2074 776f 2063 6f6e 746f 7572  nion two contour
-00015f80: 732c 2069 6620 7468 6579 2061 646a 6163  s, if they adjac
-00015f90: 656e 742c 206f 7220 6f76 6572 6c61 7020  ent, or overlap 
-00015fa0: 736f 6d65 686f 770a 2020 2020 2020 2020  somehow.        
-00015fb0: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
-00015fc0: 656c 662e 6973 5f69 6e73 6964 6528 636f  elf.is_inside(co
-00015fd0: 6e74 6f75 7232 293a 0a20 2020 2020 2020  ntour2):.       
-00015fe0: 2020 2020 2072 6574 7572 6e20 5b73 656c       return [sel
-00015ff0: 665d 0a20 2020 2020 2020 2069 6620 636f  f].        if co
-00016000: 6e74 6f75 7232 2e69 735f 696e 7369 6465  ntour2.is_inside
-00016010: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00016020: 2020 2020 7265 7475 726e 205b 636f 6e74      return [cont
-00016030: 6f75 7232 5d0a 2020 2020 2020 2020 636f  our2].        co
-00016040: 6e74 6f75 7273 5f69 6e74 6572 7365 6374  ntours_intersect
-00016050: 696f 6e73 203d 2073 656c 662e 636f 6e74  ions = self.cont
-00016060: 6f75 725f 696e 7465 7273 6563 7469 6f6e  our_intersection
-00016070: 7328 636f 6e74 6f75 7232 290a 2020 2020  s(contour2).    
-00016080: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-00016090: 6973 5f73 6861 7269 6e67 5f70 7269 6d69  is_sharing_primi
-000160a0: 7469 7665 735f 7769 7468 2863 6f6e 746f  tives_with(conto
-000160b0: 7572 3229 2061 6e64 2063 6f6e 746f 7572  ur2) and contour
-000160c0: 735f 696e 7465 7273 6563 7469 6f6e 733a  s_intersections:
-000160d0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-000160e0: 756c 7469 6e67 5f70 7269 6d69 7469 7665  ulting_primitive
-000160f0: 7320 3d20 5b5d 0a20 2020 2020 2020 2020  s = [].         
-00016100: 2020 2070 7269 6d69 7469 7665 7331 5f69     primitives1_i
-00016110: 6e73 6964 6520 3d20 7365 6c66 2e65 7874  nside = self.ext
-00016120: 7261 6374 5f77 6974 685f 706f 696e 7473  ract_with_points
-00016130: 2863 6f6e 746f 7572 735f 696e 7465 7273  (contours_inters
-00016140: 6563 7469 6f6e 735b 305d 2c20 636f 6e74  ections[0], cont
-00016150: 6f75 7273 5f69 6e74 6572 7365 6374 696f  ours_intersectio
-00016160: 6e73 5b31 5d2c 2054 7275 6529 0a20 2020  ns[1], True).   
-00016170: 2020 2020 2020 2020 2070 7269 6d69 7469           primiti
-00016180: 7665 7331 5f6f 7574 7369 6465 203d 2073  ves1_outside = s
-00016190: 656c 662e 6578 7472 6163 745f 7769 7468  elf.extract_with
-000161a0: 5f70 6f69 6e74 7328 636f 6e74 6f75 7273  _points(contours
-000161b0: 5f69 6e74 6572 7365 6374 696f 6e73 5b30  _intersections[0
-000161c0: 5d2c 2063 6f6e 746f 7572 735f 696e 7465  ], contours_inte
-000161d0: 7273 6563 7469 6f6e 735b 315d 2c20 4661  rsections[1], Fa
-000161e0: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
-000161f0: 2070 7269 6d69 7469 7665 7332 5f69 6e73   primitives2_ins
-00016200: 6964 6520 3d20 636f 6e74 6f75 7232 2e65  ide = contour2.e
-00016210: 7874 7261 6374 5f77 6974 685f 706f 696e  xtract_with_poin
-00016220: 7473 2863 6f6e 746f 7572 735f 696e 7465  ts(contours_inte
-00016230: 7273 6563 7469 6f6e 735b 305d 2c0a 2020  rsections[0],.  
-00016240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000150b0: 2020 2020 2020 2020 206c 6973 745f 7661           list_va
+000150c0: 6c69 645f 636f 6e74 6f75 7273 2e61 7070  lid_contours.app
+000150d0: 656e 6428 636e 7472 290a 2020 2020 2020  end(cntr).      
+000150e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000150f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00015100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015110: 2020 2020 6e65 775f 6261 7365 5f63 6f6e      new_base_con
+00015120: 746f 7572 732e 6170 7065 6e64 2863 6e74  tours.append(cnt
+00015130: 7229 0a20 2020 2020 2020 2020 2020 2020  r).             
+00015140: 2020 2020 2020 2063 6f6e 746f 7572 732e         contours.
+00015150: 7265 6d6f 7665 2863 7574 7469 6e67 5f63  remove(cutting_c
+00015160: 6f6e 746f 7572 290a 2020 2020 2020 2020  ontour).        
+00015170: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00015180: 6b0a 2020 2020 2020 2020 2020 2020 6966  k.            if
+00015190: 206c 656e 2863 6f6e 746f 7572 7329 203d   len(contours) =
+000151a0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+000151b0: 2020 2020 2066 696e 6973 6865 6420 3d20       finished = 
+000151c0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+000151d0: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
+000151e0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+000151f0: 2863 6f6e 746f 7572 7329 203d 3d20 3120  (contours) == 1 
+00015200: 616e 6420 6e6f 7420 6e65 775f 6261 7365  and not new_base
+00015210: 5f63 6f6e 746f 7572 733a 0a20 2020 2020  _contours:.     
+00015220: 2020 2020 2020 2020 2020 2066 696e 6973             finis
+00015230: 6865 6420 3d20 5472 7565 0a20 2020 2020  hed = True.     
+00015240: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+00015250: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
+00015260: 636f 756e 7465 7220 2b3d 2031 0a20 2020  counter += 1.   
+00015270: 2020 2020 2020 2020 2069 6620 636f 756e           if coun
+00015280: 7465 7220 3e3d 2031 3030 202a 206c 656e  ter >= 100 * len
+00015290: 286c 6973 745f 636f 6e74 6f75 7229 3a0a  (list_contour):.
+000152a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000152b0: 2320 6966 2062 6173 655f 636f 6e74 6f75  # if base_contou
+000152c0: 722e 6973 5f69 6e73 6964 6528 636f 6e74  r.is_inside(cont
+000152d0: 6f75 7273 5b30 5d29 3a0a 2020 2020 2020  ours[0]):.      
+000152e0: 2020 2020 2020 2020 2020 2320 2020 2020            #     
+000152f0: 636f 6e74 6f75 7273 2e72 656d 6f76 6528  contours.remove(
+00015300: 6375 7474 696e 675f 636f 6e74 6f75 7229  cutting_contour)
+00015310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015320: 2023 2020 2020 2063 6f6e 7469 6e75 650a   #     continue.
+00015330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015340: 2320 6c69 7374 5f76 616c 6964 5f63 6f6e  # list_valid_con
+00015350: 746f 7572 732e 6170 7065 6e64 2862 6173  tours.append(bas
+00015360: 655f 636f 6e74 6f75 7229 0a20 2020 2020  e_contour).     
+00015370: 2020 2020 2020 2020 2020 2023 2066 696e             # fin
+00015380: 6973 6865 6420 3d20 5472 7565 0a20 2020  ished = True.   
+00015390: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+000153a0: 746f 7572 7320 3d20 636f 6e74 6f75 7273  tours = contours
+000153b0: 5b3a 3a2d 315d 0a20 2020 2020 2020 2020  [::-1].         
+000153c0: 2020 2020 2020 2069 6620 636f 756e 7465         if counte
+000153d0: 7220 3e20 3130 3020 2a20 6c65 6e28 6c69  r > 100 * len(li
+000153e0: 7374 5f63 6f6e 746f 7572 2920 2b20 6c65  st_contour) + le
+000153f0: 6e28 636f 6e74 6f75 7273 293a 0a20 2020  n(contours):.   
+00015400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015410: 2023 2070 7269 6e74 2827 6e65 775f 6261   # print('new_ba
+00015420: 7365 5f63 6f6e 746f 7572 733a 272c 206c  se_contours:', l
+00015430: 656e 286e 6577 5f62 6173 655f 636f 6e74  en(new_base_cont
+00015440: 6f75 7273 2929 0a20 2020 2020 2020 2020  ours)).         
+00015450: 2020 2020 2020 2020 2020 2023 2070 7269             # pri
+00015460: 6e74 2827 6c65 6e28 636f 6e74 6f75 7273  nt('len(contours
+00015470: 293a 272c 206c 656e 2863 6f6e 746f 7572  ):', len(contour
+00015480: 7329 290a 2020 2020 2020 2020 2020 2020  s)).            
+00015490: 2020 2020 2020 2020 2320 6178 203d 2063          # ax = c
+000154a0: 6f6e 746f 7572 735b 305d 2e70 6c6f 7428  ontours[0].plot(
+000154b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000154c0: 2020 2020 2020 2320 6261 7365 5f63 6f6e        # base_con
+000154d0: 746f 7572 2e70 6c6f 7428 6178 3d61 782c  tour.plot(ax=ax,
+000154e0: 2063 6f6c 6f72 3d27 6227 290a 2020 2020   color='b').    
+000154f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015500: 7761 726e 696e 6773 2e77 6172 6e28 2754  warnings.warn('T
+00015510: 6865 7265 2070 726f 6261 626c 7920 6578  here probably ex
+00015520: 6973 7473 2061 6e20 6f70 656e 2063 6f6e  ists an open con
+00015530: 746f 7572 2028 7477 6f20 7769 7265 7320  tour (two wires 
+00015540: 7468 6174 2063 6f75 6c64 206e 6f74 2062  that could not b
+00015550: 6520 636f 6e6e 6563 7465 6429 2729 0a20  e connected)'). 
+00015560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015570: 2020 2066 696e 6973 6865 6420 3d20 5472     finished = Tr
+00015580: 7565 0a0a 2020 2020 2020 2020 7265 7475  ue..        retu
+00015590: 726e 206c 6973 745f 7661 6c69 645f 636f  rn list_valid_co
+000155a0: 6e74 6f75 7273 0a0a 2020 2020 6465 6620  ntours..    def 
+000155b0: 6469 7363 7265 7469 7a65 645f 636f 6e74  discretized_cont
+000155c0: 6f75 7228 7365 6c66 2c20 6e3a 2066 6c6f  our(self, n: flo
+000155d0: 6174 293a 0a20 2020 2020 2020 2022 2222  at):.        """
+000155e0: 0a20 2020 2020 2020 2044 6973 6372 6574  .        Discret
+000155f0: 697a 6520 6561 6368 2063 6f6e 746f 7572  ize each contour
+00015600: 2773 2070 7269 6d69 7469 7665 2061 6e64  's primitive and
+00015610: 2072 6574 7572 6e20 6120 6e65 7720 636f   return a new co
+00015620: 6e74 6f75 7220 7769 7468 2074 6573 6573  ntour with teses
+00015630: 2064 6973 6372 6574 697a 6564 2070 7269   discretized pri
+00015640: 6d69 7469 7665 732e 0a20 2020 2020 2020  mitives..       
+00015650: 2022 2222 0a20 2020 2020 2020 2063 6f6e   """.        con
+00015660: 746f 7572 203d 2043 6f6e 746f 7572 3244  tour = Contour2D
+00015670: 2828 7365 6c66 2e64 6973 6372 6574 697a  ((self.discretiz
+00015680: 6564 5f70 7269 6d69 7469 7665 7328 6e29  ed_primitives(n)
+00015690: 2929 0a0a 2020 2020 2020 2020 7265 7475  ))..        retu
+000156a0: 726e 2063 6f6e 746f 7572 2e6f 7264 6572  rn contour.order
+000156b0: 5f63 6f6e 746f 7572 2829 0a0a 2020 2020  _contour()..    
+000156c0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
+000156d0: 2064 6566 2066 726f 6d5f 626f 756e 6469   def from_boundi
+000156e0: 6e67 5f72 6563 7461 6e67 6c65 2863 6c73  ng_rectangle(cls
+000156f0: 2c20 785f 6d69 6e2c 2078 5f6d 6178 2c20  , x_min, x_max, 
+00015700: 795f 6d69 6e2c 2079 5f6d 6178 293a 0a20  y_min, y_max):. 
+00015710: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00015720: 2020 2043 7265 6174 6520 6120 636f 6e74     Create a cont
+00015730: 6f75 7232 6420 7769 7468 2062 6f75 6e64  our2d with bound
+00015740: 696e 675f 626f 7820 7061 7261 6d65 7465  ing_box paramete
+00015750: 7273 2c20 7573 696e 6720 6c69 6e65 7365  rs, using linese
+00015760: 676d 656e 7473 3264 2e0a 2020 2020 2020  gments2d..      
+00015770: 2020 2222 220a 0a20 2020 2020 2020 2065    """..        e
+00015780: 6467 6530 203d 2076 6f6c 6d64 6c72 2e65  dge0 = volmdlr.e
+00015790: 6467 6573 2e4c 696e 6553 6567 6d65 6e74  dges.LineSegment
+000157a0: 3244 2876 6f6c 6d64 6c72 2e50 6f69 6e74  2D(volmdlr.Point
+000157b0: 3244 2878 5f6d 696e 2c20 795f 6d69 6e29  2D(x_min, y_min)
+000157c0: 2c20 766f 6c6d 646c 722e 506f 696e 7432  , volmdlr.Point2
+000157d0: 4428 785f 6d61 782c 2079 5f6d 696e 2929  D(x_max, y_min))
+000157e0: 0a20 2020 2020 2020 2065 6467 6531 203d  .        edge1 =
+000157f0: 2076 6f6c 6d64 6c72 2e65 6467 6573 2e4c   volmdlr.edges.L
+00015800: 696e 6553 6567 6d65 6e74 3244 2876 6f6c  ineSegment2D(vol
+00015810: 6d64 6c72 2e50 6f69 6e74 3244 2878 5f6d  mdlr.Point2D(x_m
+00015820: 6178 2c20 795f 6d69 6e29 2c20 766f 6c6d  ax, y_min), volm
+00015830: 646c 722e 506f 696e 7432 4428 785f 6d61  dlr.Point2D(x_ma
+00015840: 782c 2079 5f6d 6178 2929 0a20 2020 2020  x, y_max)).     
+00015850: 2020 2065 6467 6532 203d 2076 6f6c 6d64     edge2 = volmd
+00015860: 6c72 2e65 6467 6573 2e4c 696e 6553 6567  lr.edges.LineSeg
+00015870: 6d65 6e74 3244 2876 6f6c 6d64 6c72 2e50  ment2D(volmdlr.P
+00015880: 6f69 6e74 3244 2878 5f6d 6178 2c20 795f  oint2D(x_max, y_
+00015890: 6d61 7829 2c20 766f 6c6d 646c 722e 506f  max), volmdlr.Po
+000158a0: 696e 7432 4428 785f 6d69 6e2c 2079 5f6d  int2D(x_min, y_m
+000158b0: 6178 2929 0a20 2020 2020 2020 2065 6467  ax)).        edg
+000158c0: 6533 203d 2076 6f6c 6d64 6c72 2e65 6467  e3 = volmdlr.edg
+000158d0: 6573 2e4c 696e 6553 6567 6d65 6e74 3244  es.LineSegment2D
+000158e0: 2876 6f6c 6d64 6c72 2e50 6f69 6e74 3244  (volmdlr.Point2D
+000158f0: 2878 5f6d 696e 2c20 795f 6d61 7829 2c20  (x_min, y_max), 
+00015900: 766f 6c6d 646c 722e 506f 696e 7432 4428  volmdlr.Point2D(
+00015910: 785f 6d69 6e2c 2079 5f6d 696e 2929 0a0a  x_min, y_min))..
+00015920: 2020 2020 2020 2020 6564 6765 7320 3d20          edges = 
+00015930: 5b65 6467 6530 2c20 6564 6765 312c 2065  [edge0, edge1, e
+00015940: 6467 6532 2c20 6564 6765 335d 0a0a 2020  dge2, edge3]..  
+00015950: 2020 2020 2020 7265 7475 726e 2043 6f6e        return Con
+00015960: 746f 7572 3244 2865 6467 6573 290a 0a20  tour2D(edges).. 
+00015970: 2020 2064 6566 2063 7574 5f62 795f 6273     def cut_by_bs
+00015980: 706c 696e 655f 6375 7276 6528 7365 6c66  pline_curve(self
+00015990: 2c20 6273 706c 696e 655f 6375 7276 6532  , bspline_curve2
+000159a0: 643a 2076 6f6c 6d64 6c72 2e65 6467 6573  d: volmdlr.edges
+000159b0: 2e42 5370 6c69 6e65 4375 7276 6532 4429  .BSplineCurve2D)
+000159c0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000159d0: 2020 2020 2020 4375 7420 6120 636f 6e74        Cut a cont
+000159e0: 6f75 3264 2077 6974 6820 6273 706c 696e  ou2d with bsplin
+000159f0: 655f 6375 7276 6532 6420 746f 2064 6566  e_curve2d to def
+00015a00: 696e 6520 7477 6f20 6469 6666 6572 656e  ine two differen
+00015a10: 7420 636f 6e74 6f75 7273 2e0a 2020 2020  t contours..    
+00015a20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00015a30: 2320 544f 444f 3a20 4273 706c 696e 6543  # TODO: BsplineC
+00015a40: 7572 7665 2069 7320 6465 7363 7265 7469  urve is descreti
+00015a50: 7a65 6420 616e 6420 6465 6669 6e65 6420  zed and defined 
+00015a60: 7769 7468 2061 2077 6972 652e 2054 6f20  with a wire. To 
+00015a70: 6265 2069 6d70 726f 7665 6421 0a0a 2020  be improved!..  
+00015a80: 2020 2020 2020 636f 6e74 6f75 7273 203d        contours =
+00015a90: 2073 656c 662e 6375 745f 6279 5f77 6972   self.cut_by_wir
+00015aa0: 6528 6273 706c 696e 655f 6375 7276 6532  e(bspline_curve2
+00015ab0: 642e 746f 5f77 6972 6528 3230 2929 0a0a  d.to_wire(20))..
+00015ac0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+00015ad0: 6f6e 746f 7572 730a 0a20 2020 2064 6566  ontours..    def
+00015ae0: 2063 6c65 616e 5f70 7269 6d69 7469 7665   clean_primitive
+00015af0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+00015b00: 2022 2222 0a20 2020 2020 2020 2044 656c   """.        Del
+00015b10: 6574 6520 7072 696d 6974 6976 6573 2077  ete primitives w
+00015b20: 6974 6820 7374 6172 743d 656e 642c 2061  ith start=end, a
+00015b30: 6e64 2072 6574 7572 6e20 6120 6e65 7720  nd return a new 
+00015b40: 636f 6e74 6f75 722e 0a20 2020 2020 2020  contour..       
+00015b50: 2022 2222 0a0a 2020 2020 2020 2020 6e65   """..        ne
+00015b60: 775f 7072 696d 6974 6976 6573 203d 205b  w_primitives = [
+00015b70: 5d0a 2020 2020 2020 2020 666f 7220 7020  ].        for p 
+00015b80: 696e 2073 656c 662e 7072 696d 6974 6976  in self.primitiv
+00015b90: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00015ba0: 6966 2070 2e73 7461 7274 2021 3d20 702e  if p.start != p.
+00015bb0: 656e 643a 0a20 2020 2020 2020 2020 2020  end:.           
+00015bc0: 2020 2020 206e 6577 5f70 7269 6d69 7469       new_primiti
+00015bd0: 7665 732e 6170 7065 6e64 2870 290a 0a20  ves.append(p).. 
+00015be0: 2020 2020 2020 2072 6574 7572 6e20 436f         return Co
+00015bf0: 6e74 6f75 7232 4428 6e65 775f 7072 696d  ntour2D(new_prim
+00015c00: 6974 6976 6573 290a 0a20 2020 2064 6566  itives)..    def
+00015c10: 206d 6572 6765 5f77 6974 6828 7365 6c66   merge_with(self
+00015c20: 2c20 636f 6e74 6f75 7232 6429 3a0a 2020  , contour2d):.  
+00015c30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00015c40: 2020 4d65 7267 6520 7477 6f20 6164 6a61    Merge two adja
+00015c50: 6365 6e74 2063 6f6e 746f 7572 732c 2073  cent contours, s
+00015c60: 6861 7269 6e67 2070 7269 6d69 7469 7665  haring primitive
+00015c70: 732c 2061 6e64 2072 6574 7572 6e73 206f  s, and returns o
+00015c80: 6e65 206f 7574 6572 2063 6f6e 746f 7572  ne outer contour
+00015c90: 2061 6e64 2069 6e6e 6572 2063 6f6e 746f   and inner conto
+00015ca0: 7572 730a 2020 2020 2020 2020 2869 6620  urs.        (if 
+00015cb0: 7468 6572 6520 6172 6520 616e 7929 2e0a  there are any)..
+00015cc0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00015cd0: 636f 6e74 6f75 7232 643a 2063 6f6e 746f  contour2d: conto
+00015ce0: 7572 2074 6f20 6d65 7267 6520 7769 7468  ur to merge with
+00015cf0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00015d00: 3a20 6d65 7267 6564 2063 6f6e 746f 7572  : merged contour
+00015d10: 730a 2020 2020 2020 2020 2222 220a 2020  s.        """.  
+00015d20: 2020 2020 2020 6973 5f73 6861 7269 6e67        is_sharing
+00015d30: 5f70 7269 6d69 7469 7665 203d 2073 656c  _primitive = sel
+00015d40: 662e 6973 5f73 6861 7269 6e67 5f70 7269  f.is_sharing_pri
+00015d50: 6d69 7469 7665 735f 7769 7468 2863 6f6e  mitives_with(con
+00015d60: 746f 7572 3264 290a 2020 2020 2020 2020  tour2d).        
+00015d70: 6966 2073 656c 662e 6973 5f69 6e73 6964  if self.is_insid
+00015d80: 6528 636f 6e74 6f75 7232 6429 2061 6e64  e(contour2d) and
+00015d90: 206e 6f74 2069 735f 7368 6172 696e 675f   not is_sharing_
+00015da0: 7072 696d 6974 6976 653a 0a20 2020 2020  primitive:.     
+00015db0: 2020 2020 2020 2072 6574 7572 6e20 5b73         return [s
+00015dc0: 656c 665d 0a20 2020 2020 2020 2069 6620  elf].        if 
+00015dd0: 636f 6e74 6f75 7232 642e 6973 5f69 6e73  contour2d.is_ins
+00015de0: 6964 6528 7365 6c66 2920 616e 6420 6e6f  ide(self) and no
+00015df0: 7420 6973 5f73 6861 7269 6e67 5f70 7269  t is_sharing_pri
+00015e00: 6d69 7469 7665 3a0a 2020 2020 2020 2020  mitive:.        
+00015e10: 2020 2020 7265 7475 726e 205b 636f 6e74      return [cont
+00015e20: 6f75 7232 645d 0a0a 2020 2020 2020 2020  our2d]..        
+00015e30: 6d65 7267 6564 5f70 7269 6d69 7469 7665  merged_primitive
+00015e40: 7320 3d20 7365 6c66 2e6d 6572 6765 5f70  s = self.merge_p
+00015e50: 7269 6d69 7469 7665 735f 7769 7468 2863  rimitives_with(c
+00015e60: 6f6e 746f 7572 3264 290a 2020 2020 2020  ontour2d).      
+00015e70: 2020 636f 6e74 6f75 7273 203d 2043 6f6e    contours = Con
+00015e80: 746f 7572 3244 2e63 6f6e 746f 7572 735f  tour2D.contours_
+00015e90: 6672 6f6d 5f65 6467 6573 286d 6572 6765  from_edges(merge
+00015ea0: 645f 7072 696d 6974 6976 6573 290a 2020  d_primitives).  
+00015eb0: 2020 2020 2020 636f 6e74 6f75 7273 203d        contours =
+00015ec0: 2073 6f72 7465 6428 636f 6e74 6f75 7273   sorted(contours
+00015ed0: 2c20 6b65 793d 6c61 6d62 6461 2063 6f6e  , key=lambda con
+00015ee0: 746f 7572 3a20 636f 6e74 6f75 722e 6172  tour: contour.ar
+00015ef0: 6561 2829 2c0a 2020 2020 2020 2020 2020  ea(),.          
+00015f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f10: 7265 7665 7273 653d 5472 7565 290a 2020  reverse=True).  
+00015f20: 2020 2020 2020 7265 7475 726e 2063 6f6e        return con
+00015f30: 746f 7572 730a 0a20 2020 2064 6566 2075  tours..    def u
+00015f40: 6e69 6f6e 2873 656c 662c 2063 6f6e 746f  nion(self, conto
+00015f50: 7572 323a 2027 436f 6e74 6f75 7232 4427  ur2: 'Contour2D'
+00015f60: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00015f70: 2020 2020 2020 2055 6e69 6f6e 2074 776f         Union two
+00015f80: 2063 6f6e 746f 7572 732c 2069 6620 7468   contours, if th
+00015f90: 6579 2061 646a 6163 656e 742c 206f 7220  ey adjacent, or 
+00015fa0: 6f76 6572 6c61 7020 736f 6d65 686f 770a  overlap somehow.
+00015fb0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00015fc0: 2020 2020 6966 2073 656c 662e 6973 5f69      if self.is_i
+00015fd0: 6e73 6964 6528 636f 6e74 6f75 7232 293a  nside(contour2):
+00015fe0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00015ff0: 7572 6e20 5b73 656c 665d 0a20 2020 2020  urn [self].     
+00016000: 2020 2069 6620 636f 6e74 6f75 7232 2e69     if contour2.i
+00016010: 735f 696e 7369 6465 2873 656c 6629 3a0a  s_inside(self):.
+00016020: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00016030: 726e 205b 636f 6e74 6f75 7232 5d0a 2020  rn [contour2].  
+00016040: 2020 2020 2020 636f 6e74 6f75 7273 5f69        contours_i
+00016050: 6e74 6572 7365 6374 696f 6e73 203d 2073  ntersections = s
+00016060: 656c 662e 636f 6e74 6f75 725f 696e 7465  elf.contour_inte
+00016070: 7273 6563 7469 6f6e 7328 636f 6e74 6f75  rsections(contou
+00016080: 7232 290a 2020 2020 2020 2020 6966 206e  r2).        if n
+00016090: 6f74 2073 656c 662e 6973 5f73 6861 7269  ot self.is_shari
+000160a0: 6e67 5f70 7269 6d69 7469 7665 735f 7769  ng_primitives_wi
+000160b0: 7468 2863 6f6e 746f 7572 3229 2061 6e64  th(contour2) and
+000160c0: 2063 6f6e 746f 7572 735f 696e 7465 7273   contours_inters
+000160d0: 6563 7469 6f6e 733a 0a20 2020 2020 2020  ections:.       
+000160e0: 2020 2020 2072 6573 756c 7469 6e67 5f70       resulting_p
+000160f0: 7269 6d69 7469 7665 7320 3d20 5b5d 0a20  rimitives = []. 
+00016100: 2020 2020 2020 2020 2020 2070 7269 6d69             primi
+00016110: 7469 7665 7331 5f69 6e73 6964 6520 3d20  tives1_inside = 
+00016120: 7365 6c66 2e65 7874 7261 6374 5f77 6974  self.extract_wit
+00016130: 685f 706f 696e 7473 2863 6f6e 746f 7572  h_points(contour
+00016140: 735f 696e 7465 7273 6563 7469 6f6e 735b  s_intersections[
+00016150: 305d 2c20 636f 6e74 6f75 7273 5f69 6e74  0], contours_int
+00016160: 6572 7365 6374 696f 6e73 5b31 5d2c 2054  ersections[1], T
+00016170: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
+00016180: 2070 7269 6d69 7469 7665 7331 5f6f 7574   primitives1_out
+00016190: 7369 6465 203d 2073 656c 662e 6578 7472  side = self.extr
+000161a0: 6163 745f 7769 7468 5f70 6f69 6e74 7328  act_with_points(
+000161b0: 636f 6e74 6f75 7273 5f69 6e74 6572 7365  contours_interse
+000161c0: 6374 696f 6e73 5b30 5d2c 2063 6f6e 746f  ctions[0], conto
+000161d0: 7572 735f 696e 7465 7273 6563 7469 6f6e  urs_intersection
+000161e0: 735b 315d 2c20 4661 6c73 6529 0a20 2020  s[1], False).   
+000161f0: 2020 2020 2020 2020 2070 7269 6d69 7469           primiti
+00016200: 7665 7332 5f69 6e73 6964 6520 3d20 636f  ves2_inside = co
+00016210: 6e74 6f75 7232 2e65 7874 7261 6374 5f77  ntour2.extract_w
+00016220: 6974 685f 706f 696e 7473 2863 6f6e 746f  ith_points(conto
+00016230: 7572 735f 696e 7465 7273 6563 7469 6f6e  urs_intersection
+00016240: 735b 305d 2c0a 2020 2020 2020 2020 2020  s[0],.          
 00016250: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016270: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-00016280: 6f75 7273 5f69 6e74 6572 7365 6374 696f  ours_intersectio
-00016290: 6e73 5b31 5d2c 2054 7275 6529 0a20 2020  ns[1], True).   
-000162a0: 2020 2020 2020 2020 2070 7269 6d69 7469           primiti
-000162b0: 7665 7332 5f6f 7574 7369 6465 203d 2063  ves2_outside = c
-000162c0: 6f6e 746f 7572 322e 6578 7472 6163 745f  ontour2.extract_
-000162d0: 7769 7468 5f70 6f69 6e74 7328 636f 6e74  with_points(cont
-000162e0: 6f75 7273 5f69 6e74 6572 7365 6374 696f  ours_intersectio
-000162f0: 6e73 5b30 5d2c 0a20 2020 2020 2020 2020  ns[0],.         
+00016270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016280: 2020 2020 636f 6e74 6f75 7273 5f69 6e74      contours_int
+00016290: 6572 7365 6374 696f 6e73 5b31 5d2c 2054  ersections[1], T
+000162a0: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
+000162b0: 2070 7269 6d69 7469 7665 7332 5f6f 7574   primitives2_out
+000162c0: 7369 6465 203d 2063 6f6e 746f 7572 322e  side = contour2.
+000162d0: 6578 7472 6163 745f 7769 7468 5f70 6f69  extract_with_poi
+000162e0: 6e74 7328 636f 6e74 6f75 7273 5f69 6e74  nts(contours_int
+000162f0: 6572 7365 6374 696f 6e73 5b30 5d2c 0a20  ersections[0],. 
 00016300: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016310: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016330: 2020 2020 2020 636f 6e74 6f75 7273 5f69        contours_i
-00016340: 6e74 6572 7365 6374 696f 6e73 5b31 5d2c  ntersections[1],
-00016350: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
-00016360: 2020 2020 6966 2063 6f6e 746f 7572 322e      if contour2.
-00016370: 706f 696e 745f 6265 6c6f 6e67 7328 7072  point_belongs(pr
-00016380: 696d 6974 6976 6573 315f 696e 7369 6465  imitives1_inside
-00016390: 5b30 5d2e 6d69 6464 6c65 5f70 6f69 6e74  [0].middle_point
-000163a0: 2829 293a 0a20 2020 2020 2020 2020 2020  ()):.           
-000163b0: 2020 2020 2072 6573 756c 7469 6e67 5f70       resulting_p
-000163c0: 7269 6d69 7469 7665 732e 6578 7465 6e64  rimitives.extend
-000163d0: 2870 7269 6d69 7469 7665 7331 5f6f 7574  (primitives1_out
-000163e0: 7369 6465 290a 2020 2020 2020 2020 2020  side).          
-000163f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00016400: 2020 2020 2020 2020 7265 7375 6c74 696e          resultin
-00016410: 675f 7072 696d 6974 6976 6573 2e65 7874  g_primitives.ext
-00016420: 656e 6428 7072 696d 6974 6976 6573 315f  end(primitives1_
-00016430: 696e 7369 6465 290a 2020 2020 2020 2020  inside).        
-00016440: 2020 2020 6966 2073 656c 662e 706f 696e      if self.poin
-00016450: 745f 6265 6c6f 6e67 7328 7072 696d 6974  t_belongs(primit
-00016460: 6976 6573 325f 696e 7369 6465 5b30 5d2e  ives2_inside[0].
-00016470: 6d69 6464 6c65 5f70 6f69 6e74 2829 293a  middle_point()):
-00016480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016490: 2072 6573 756c 7469 6e67 5f70 7269 6d69   resulting_primi
-000164a0: 7469 7665 732e 6578 7465 6e64 2870 7269  tives.extend(pri
-000164b0: 6d69 7469 7665 7332 5f6f 7574 7369 6465  mitives2_outside
-000164c0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-000164d0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000164e0: 2020 2020 7265 7375 6c74 696e 675f 7072      resulting_pr
-000164f0: 696d 6974 6976 6573 2e65 7874 656e 6428  imitives.extend(
-00016500: 7072 696d 6974 6976 6573 325f 696e 7369  primitives2_insi
-00016510: 6465 290a 2020 2020 2020 2020 2020 2020  de).            
-00016520: 7265 7475 726e 205b 436f 6e74 6f75 7232  return [Contour2
-00016530: 4428 7265 7375 6c74 696e 675f 7072 696d  D(resulting_prim
-00016540: 6974 6976 6573 292e 6f72 6465 725f 636f  itives).order_co
-00016550: 6e74 6f75 7228 295d 0a0a 2020 2020 2020  ntour()]..      
-00016560: 2020 7265 7475 726e 2073 656c 662e 6d65    return self.me
-00016570: 7267 655f 7769 7468 2863 6f6e 746f 7572  rge_with(contour
-00016580: 3229 0a0a 2020 2020 6465 6620 6375 745f  2)..    def cut_
-00016590: 6279 5f77 6972 6528 7365 6c66 2c20 7769  by_wire(self, wi
-000165a0: 7265 3a20 5769 7265 3244 293a 0a20 2020  re: Wire2D):.   
-000165b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000165c0: 2043 7574 2061 2063 6f6e 746f 7572 3264   Cut a contour2d
-000165d0: 2077 6974 6820 6120 7769 7265 3264 2061   with a wire2d a
-000165e0: 6e64 2072 6574 7572 6e20 6120 6c69 7374  nd return a list
-000165f0: 206f 6620 636f 6e74 6f75 7273 2032 642e   of contours 2d.
-00016600: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00016610: 2077 6972 653a 2076 6f6c 6d64 6c72 2e77   wire: volmdlr.w
-00016620: 6972 6573 2e57 6972 6532 440a 2020 2020  ires.Wire2D.    
-00016630: 2020 2020 3a72 7479 7065 3a20 6c69 7374      :rtype: list
-00016640: 5b76 6f6c 6d64 6c72 2e77 6972 6573 2e43  [volmdlr.wires.C
-00016650: 6f6e 746f 7572 3244 5d0a 0a20 2020 2020  ontour2D]..     
-00016660: 2020 203a 7061 7261 6d20 7769 7265 3a20     :param wire: 
-00016670: 766f 6c6d 646c 722e 7769 7265 732e 5769  volmdlr.wires.Wi
-00016680: 7265 3244 2e0a 2020 2020 2020 2020 3a72  re2D..        :r
-00016690: 6574 7572 6e3a 2063 6f6e 746f 7572 7332  eturn: contours2
-000166a0: 6420 3a20 6c69 7374 5b76 6f6c 6d64 6c72  d : list[volmdlr
-000166b0: 2e77 6972 6573 2e43 6f6e 746f 7572 3244  .wires.Contour2D
-000166c0: 5d2e 0a20 2020 2020 2020 2022 2222 0a0a  ]..        """..
-000166d0: 2020 2020 2020 2020 696e 7465 7273 6563          intersec
-000166e0: 7469 6f6e 7320 3d20 7365 6c66 2e77 6972  tions = self.wir
-000166f0: 655f 6372 6f73 7369 6e67 7328 7769 7265  e_crossings(wire
-00016700: 2920 2023 2063 726f 7373 696e 6773 204f  )  # crossings O
-00016710: 5220 696e 7465 7273 6563 7469 6f6e 7320  R intersections 
-00016720: 283f 290a 2020 2020 2020 2020 6966 206e  (?).        if n
-00016730: 6f74 2069 6e74 6572 7365 6374 696f 6e73  ot intersections
-00016740: 206f 7220 6c65 6e28 696e 7465 7273 6563   or len(intersec
-00016750: 7469 6f6e 7329 203c 2032 3a0a 2020 2020  tions) < 2:.    
-00016760: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-00016770: 7365 6c66 5d0a 2020 2020 2020 2020 706f  self].        po
-00016780: 696e 7473 5f69 6e74 6572 7365 6374 696f  ints_intersectio
-00016790: 6e73 203d 205b 5d0a 2020 2020 2020 2020  ns = [].        
-000167a0: 666f 7220 696e 7465 7273 6563 7469 6f6e  for intersection
-000167b0: 2c20 7072 696d 2069 6e20 696e 7465 7273  , prim in inters
-000167c0: 6563 7469 6f6e 733a 0a20 2020 2020 2020  ections:.       
-000167d0: 2020 2020 2069 6620 696e 7465 7273 6563       if intersec
-000167e0: 7469 6f6e 206e 6f74 2069 6e20 706f 696e  tion not in poin
-000167f0: 7473 5f69 6e74 6572 7365 6374 696f 6e73  ts_intersections
-00016800: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00016810: 2020 706f 696e 7473 5f69 6e74 6572 7365    points_interse
-00016820: 6374 696f 6e73 2e61 7070 656e 6428 696e  ctions.append(in
-00016830: 7465 7273 6563 7469 6f6e 290a 2020 2020  tersection).    
-00016840: 2020 2020 6966 206c 656e 2870 6f69 6e74      if len(point
-00016850: 735f 696e 7465 7273 6563 7469 6f6e 7329  s_intersections)
-00016860: 2025 2032 2021 3d20 303a 0a20 2020 2020   % 2 != 0:.     
-00016870: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-00016880: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-00016890: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000168a0: 2020 6627 7b6c 656e 2870 6f69 6e74 735f    f'{len(points_
-000168b0: 696e 7465 7273 6563 7469 6f6e 7329 7d20  intersections)} 
-000168c0: 696e 7465 7273 6563 7469 6f6e 7320 6e6f  intersections no
-000168d0: 7420 7375 7070 6f72 7465 6420 7965 7427  t supported yet'
-000168e0: 290a 0a20 2020 2020 2020 2023 2070 6f69  )..        # poi
-000168f0: 6e74 735f 696e 7465 7273 6563 7469 6f6e  nts_intersection
-00016900: 7320 3d20 5b70 6f69 6e74 2066 6f72 2070  s = [point for p
-00016910: 6f69 6e74 2c20 7072 696d 2069 6e20 696e  oint, prim in in
-00016920: 7465 7273 6563 7469 6f6e 735d 0a0a 2020  tersections]..  
-00016930: 2020 2020 2020 736f 7274 6564 5f70 6f69        sorted_poi
-00016940: 6e74 7320 3d20 7769 7265 2e73 6f72 745f  nts = wire.sort_
-00016950: 706f 696e 7473 5f61 6c6f 6e67 5f77 6972  points_along_wir
-00016960: 6528 706f 696e 7473 5f69 6e74 6572 7365  e(points_interse
-00016970: 6374 696f 6e73 290a 2020 2020 2020 2020  ctions).        
-00016980: 6c69 7374 5f63 6f6e 746f 7572 7320 3d20  list_contours = 
-00016990: 5b5d 0a20 2020 2020 2020 2063 6f6e 746f  [].        conto
-000169a0: 7572 5f74 6f5f 6375 7420 3d20 7365 6c66  ur_to_cut = self
-000169b0: 0a20 2020 2020 2020 2063 7574 7469 6e67  .        cutting
-000169c0: 5f70 6f69 6e74 735f 636f 756e 7465 7220  _points_counter 
-000169d0: 3d20 300a 2020 2020 2020 2020 7768 696c  = 0.        whil
-000169e0: 6520 6375 7474 696e 675f 706f 696e 7473  e cutting_points
-000169f0: 5f63 6f75 6e74 6572 2021 3d20 6c65 6e28  _counter != len(
-00016a00: 736f 7274 6564 5f70 6f69 6e74 7329 3a0a  sorted_points):.
-00016a10: 0a20 2020 2020 2020 2020 2020 2070 6f69  .            poi
-00016a20: 6e74 3120 3d20 736f 7274 6564 5f70 6f69  nt1 = sorted_poi
-00016a30: 6e74 735b 6375 7474 696e 675f 706f 696e  nts[cutting_poin
-00016a40: 7473 5f63 6f75 6e74 6572 5d0a 2020 2020  ts_counter].    
-00016a50: 2020 2020 2020 2020 706f 696e 7432 203d          point2 =
-00016a60: 2073 6f72 7465 645f 706f 696e 7473 5b63   sorted_points[c
-00016a70: 7574 7469 6e67 5f70 6f69 6e74 735f 636f  utting_points_co
-00016a80: 756e 7465 7220 2b20 315d 0a0a 2020 2020  unter + 1]..    
-00016a90: 2020 2020 2020 2020 636c 6f73 696e 675f          closing_
-00016aa0: 7769 7265 203d 2077 6972 652e 6578 7472  wire = wire.extr
-00016ab0: 6163 745f 7769 7468 6f75 745f 7072 696d  act_without_prim
-00016ac0: 6974 6976 6573 2870 6f69 6e74 312c 2070  itives(point1, p
-00016ad0: 6f69 6e74 322c 2054 7275 6529 0a0a 2020  oint2, True)..  
-00016ae0: 2020 2020 2020 2020 2020 666f 7220 706f            for po
-00016af0: 696e 7420 696e 2070 6f69 6e74 735f 696e  int in points_in
-00016b00: 7465 7273 6563 7469 6f6e 733a 0a20 2020  tersections:.   
-00016b10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00016b20: 706f 696e 7420 6e6f 7420 696e 205b 706f  point not in [po
-00016b30: 696e 7431 2c20 706f 696e 7432 5d20 616e  int1, point2] an
-00016b40: 6420 5769 7265 3244 2863 6c6f 7369 6e67  d Wire2D(closing
-00016b50: 5f77 6972 6529 2e70 6f69 6e74 5f6f 7665  _wire).point_ove
-00016b60: 725f 7769 7265 2870 6f69 6e74 293a 0a20  r_wire(point):. 
-00016b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b80: 2020 2063 6c6f 7369 6e67 5f77 6972 6520     closing_wire 
-00016b90: 3d20 7769 7265 2e65 7874 7261 6374 5f77  = wire.extract_w
-00016ba0: 6974 686f 7574 5f70 7269 6d69 7469 7665  ithout_primitive
-00016bb0: 7328 706f 696e 7431 2c20 706f 696e 7432  s(point1, point2
-00016bc0: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
-00016bd0: 2020 2020 2020 2020 2020 2020 2062 7265               bre
-00016be0: 616b 0a0a 2020 2020 2020 2020 2020 2020  ak..            
-00016bf0: 636c 6f73 696e 675f 7769 7265 5f70 7269  closing_wire_pri
-00016c00: 6d20 3d20 5b63 6c6f 7369 6e67 5f77 2066  m = [closing_w f
-00016c10: 6f72 2063 6c6f 7369 6e67 5f77 2069 6e20  or closing_w in 
-00016c20: 636c 6f73 696e 675f 7769 7265 2069 6620  closing_wire if 
-00016c30: 636c 6f73 696e 675f 775d 0a20 2020 2020  closing_w].     
-00016c40: 2020 2020 2020 2063 6c6f 7369 6e67 5f63         closing_c
-00016c50: 6f6e 746f 7572 203d 2043 6f6e 746f 7572  ontour = Contour
-00016c60: 3244 2863 6c6f 7369 6e67 5f77 6972 655f  2D(closing_wire_
-00016c70: 7072 696d 290a 2020 2020 2020 2020 2020  prim).          
-00016c80: 2020 636f 6e74 6f75 7231 2c20 636f 6e74    contour1, cont
-00016c90: 6f75 7232 203d 2063 6f6e 746f 7572 5f74  our2 = contour_t
-00016ca0: 6f5f 6375 742e 6765 745f 6469 7669 6465  o_cut.get_divide
-00016cb0: 645f 636f 6e74 6f75 7273 2870 6f69 6e74  d_contours(point
-00016cc0: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
+00016330: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00016340: 6e74 6f75 7273 5f69 6e74 6572 7365 6374  ntours_intersect
+00016350: 696f 6e73 5b31 5d2c 2046 616c 7365 290a  ions[1], False).
+00016360: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00016370: 6f6e 746f 7572 322e 706f 696e 745f 6265  ontour2.point_be
+00016380: 6c6f 6e67 7328 7072 696d 6974 6976 6573  longs(primitives
+00016390: 315f 696e 7369 6465 5b30 5d2e 6d69 6464  1_inside[0].midd
+000163a0: 6c65 5f70 6f69 6e74 2829 293a 0a20 2020  le_point()):.   
+000163b0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+000163c0: 756c 7469 6e67 5f70 7269 6d69 7469 7665  ulting_primitive
+000163d0: 732e 6578 7465 6e64 2870 7269 6d69 7469  s.extend(primiti
+000163e0: 7665 7331 5f6f 7574 7369 6465 290a 2020  ves1_outside).  
+000163f0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00016400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016410: 7265 7375 6c74 696e 675f 7072 696d 6974  resulting_primit
+00016420: 6976 6573 2e65 7874 656e 6428 7072 696d  ives.extend(prim
+00016430: 6974 6976 6573 315f 696e 7369 6465 290a  itives1_inside).
+00016440: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00016450: 656c 662e 706f 696e 745f 6265 6c6f 6e67  elf.point_belong
+00016460: 7328 7072 696d 6974 6976 6573 325f 696e  s(primitives2_in
+00016470: 7369 6465 5b30 5d2e 6d69 6464 6c65 5f70  side[0].middle_p
+00016480: 6f69 6e74 2829 293a 0a20 2020 2020 2020  oint()):.       
+00016490: 2020 2020 2020 2020 2072 6573 756c 7469           resulti
+000164a0: 6e67 5f70 7269 6d69 7469 7665 732e 6578  ng_primitives.ex
+000164b0: 7465 6e64 2870 7269 6d69 7469 7665 7332  tend(primitives2
+000164c0: 5f6f 7574 7369 6465 290a 2020 2020 2020  _outside).      
+000164d0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000164e0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+000164f0: 6c74 696e 675f 7072 696d 6974 6976 6573  lting_primitives
+00016500: 2e65 7874 656e 6428 7072 696d 6974 6976  .extend(primitiv
+00016510: 6573 325f 696e 7369 6465 290a 2020 2020  es2_inside).    
+00016520: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+00016530: 436f 6e74 6f75 7232 4428 7265 7375 6c74  Contour2D(result
+00016540: 696e 675f 7072 696d 6974 6976 6573 292e  ing_primitives).
+00016550: 6f72 6465 725f 636f 6e74 6f75 7228 295d  order_contour()]
+00016560: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00016570: 2073 656c 662e 6d65 7267 655f 7769 7468   self.merge_with
+00016580: 2863 6f6e 746f 7572 3229 0a0a 2020 2020  (contour2)..    
+00016590: 6465 6620 6375 745f 6279 5f77 6972 6528  def cut_by_wire(
+000165a0: 7365 6c66 2c20 7769 7265 3a20 5769 7265  self, wire: Wire
+000165b0: 3244 293a 0a20 2020 2020 2020 2022 2222  2D):.        """
+000165c0: 0a20 2020 2020 2020 2043 7574 2061 2063  .        Cut a c
+000165d0: 6f6e 746f 7572 3264 2077 6974 6820 6120  ontour2d with a 
+000165e0: 7769 7265 3264 2061 6e64 2072 6574 7572  wire2d and retur
+000165f0: 6e20 6120 6c69 7374 206f 6620 636f 6e74  n a list of cont
+00016600: 6f75 7273 2032 642e 0a0a 2020 2020 2020  ours 2d...      
+00016610: 2020 3a70 6172 616d 2077 6972 653a 2076    :param wire: v
+00016620: 6f6c 6d64 6c72 2e77 6972 6573 2e57 6972  olmdlr.wires.Wir
+00016630: 6532 440a 2020 2020 2020 2020 3a72 7479  e2D.        :rty
+00016640: 7065 3a20 6c69 7374 5b76 6f6c 6d64 6c72  pe: list[volmdlr
+00016650: 2e77 6972 6573 2e43 6f6e 746f 7572 3244  .wires.Contour2D
+00016660: 5d0a 0a20 2020 2020 2020 203a 7061 7261  ]..        :para
+00016670: 6d20 7769 7265 3a20 766f 6c6d 646c 722e  m wire: volmdlr.
+00016680: 7769 7265 732e 5769 7265 3244 2e0a 2020  wires.Wire2D..  
+00016690: 2020 2020 2020 3a72 6574 7572 6e3a 2063        :return: c
+000166a0: 6f6e 746f 7572 7332 6420 3a20 6c69 7374  ontours2d : list
+000166b0: 5b76 6f6c 6d64 6c72 2e77 6972 6573 2e43  [volmdlr.wires.C
+000166c0: 6f6e 746f 7572 3244 5d2e 0a20 2020 2020  ontour2D]..     
+000166d0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+000166e0: 696e 7465 7273 6563 7469 6f6e 7320 3d20  intersections = 
+000166f0: 7365 6c66 2e77 6972 655f 6372 6f73 7369  self.wire_crossi
+00016700: 6e67 7328 7769 7265 2920 2023 2063 726f  ngs(wire)  # cro
+00016710: 7373 696e 6773 204f 5220 696e 7465 7273  ssings OR inters
+00016720: 6563 7469 6f6e 7320 283f 290a 2020 2020  ections (?).    
+00016730: 2020 2020 6966 206e 6f74 2069 6e74 6572      if not inter
+00016740: 7365 6374 696f 6e73 206f 7220 6c65 6e28  sections or len(
+00016750: 696e 7465 7273 6563 7469 6f6e 7329 203c  intersections) <
+00016760: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
+00016770: 7265 7475 726e 205b 7365 6c66 5d0a 2020  return [self].  
+00016780: 2020 2020 2020 706f 696e 7473 5f69 6e74        points_int
+00016790: 6572 7365 6374 696f 6e73 203d 205b 5d0a  ersections = [].
+000167a0: 2020 2020 2020 2020 666f 7220 696e 7465          for inte
+000167b0: 7273 6563 7469 6f6e 2c20 7072 696d 2069  rsection, prim i
+000167c0: 6e20 696e 7465 7273 6563 7469 6f6e 733a  n intersections:
+000167d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000167e0: 696e 7465 7273 6563 7469 6f6e 206e 6f74  intersection not
+000167f0: 2069 6e20 706f 696e 7473 5f69 6e74 6572   in points_inter
+00016800: 7365 6374 696f 6e73 3a0a 2020 2020 2020  sections:.      
+00016810: 2020 2020 2020 2020 2020 706f 696e 7473            points
+00016820: 5f69 6e74 6572 7365 6374 696f 6e73 2e61  _intersections.a
+00016830: 7070 656e 6428 696e 7465 7273 6563 7469  ppend(intersecti
+00016840: 6f6e 290a 2020 2020 2020 2020 6966 206c  on).        if l
+00016850: 656e 2870 6f69 6e74 735f 696e 7465 7273  en(points_inters
+00016860: 6563 7469 6f6e 7329 2025 2032 2021 3d20  ections) % 2 != 
+00016870: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
+00016880: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+00016890: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+000168a0: 2020 2020 2020 2020 2020 6627 7b6c 656e            f'{len
+000168b0: 2870 6f69 6e74 735f 696e 7465 7273 6563  (points_intersec
+000168c0: 7469 6f6e 7329 7d20 696e 7465 7273 6563  tions)} intersec
+000168d0: 7469 6f6e 7320 6e6f 7420 7375 7070 6f72  tions not suppor
+000168e0: 7465 6420 7965 7427 290a 0a20 2020 2020  ted yet')..     
+000168f0: 2020 2023 2070 6f69 6e74 735f 696e 7465     # points_inte
+00016900: 7273 6563 7469 6f6e 7320 3d20 5b70 6f69  rsections = [poi
+00016910: 6e74 2066 6f72 2070 6f69 6e74 2c20 7072  nt for point, pr
+00016920: 696d 2069 6e20 696e 7465 7273 6563 7469  im in intersecti
+00016930: 6f6e 735d 0a0a 2020 2020 2020 2020 736f  ons]..        so
+00016940: 7274 6564 5f70 6f69 6e74 7320 3d20 7769  rted_points = wi
+00016950: 7265 2e73 6f72 745f 706f 696e 7473 5f61  re.sort_points_a
+00016960: 6c6f 6e67 5f77 6972 6528 706f 696e 7473  long_wire(points
+00016970: 5f69 6e74 6572 7365 6374 696f 6e73 290a  _intersections).
+00016980: 2020 2020 2020 2020 6c69 7374 5f63 6f6e          list_con
+00016990: 746f 7572 7320 3d20 5b5d 0a20 2020 2020  tours = [].     
+000169a0: 2020 2063 6f6e 746f 7572 5f74 6f5f 6375     contour_to_cu
+000169b0: 7420 3d20 7365 6c66 0a20 2020 2020 2020  t = self.       
+000169c0: 2063 7574 7469 6e67 5f70 6f69 6e74 735f   cutting_points_
+000169d0: 636f 756e 7465 7220 3d20 300a 2020 2020  counter = 0.    
+000169e0: 2020 2020 7768 696c 6520 6375 7474 696e      while cuttin
+000169f0: 675f 706f 696e 7473 5f63 6f75 6e74 6572  g_points_counter
+00016a00: 2021 3d20 6c65 6e28 736f 7274 6564 5f70   != len(sorted_p
+00016a10: 6f69 6e74 7329 3a0a 0a20 2020 2020 2020  oints):..       
+00016a20: 2020 2020 2070 6f69 6e74 3120 3d20 736f       point1 = so
+00016a30: 7274 6564 5f70 6f69 6e74 735b 6375 7474  rted_points[cutt
+00016a40: 696e 675f 706f 696e 7473 5f63 6f75 6e74  ing_points_count
+00016a50: 6572 5d0a 2020 2020 2020 2020 2020 2020  er].            
+00016a60: 706f 696e 7432 203d 2073 6f72 7465 645f  point2 = sorted_
+00016a70: 706f 696e 7473 5b63 7574 7469 6e67 5f70  points[cutting_p
+00016a80: 6f69 6e74 735f 636f 756e 7465 7220 2b20  oints_counter + 
+00016a90: 315d 0a0a 2020 2020 2020 2020 2020 2020  1]..            
+00016aa0: 636c 6f73 696e 675f 7769 7265 203d 2077  closing_wire = w
+00016ab0: 6972 652e 6578 7472 6163 745f 7769 7468  ire.extract_with
+00016ac0: 6f75 745f 7072 696d 6974 6976 6573 2870  out_primitives(p
+00016ad0: 6f69 6e74 312c 2070 6f69 6e74 322c 2054  oint1, point2, T
+00016ae0: 7275 6529 0a0a 2020 2020 2020 2020 2020  rue)..          
+00016af0: 2020 666f 7220 706f 696e 7420 696e 2070    for point in p
+00016b00: 6f69 6e74 735f 696e 7465 7273 6563 7469  oints_intersecti
+00016b10: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
+00016b20: 2020 2020 2069 6620 706f 696e 7420 6e6f       if point no
+00016b30: 7420 696e 205b 706f 696e 7431 2c20 706f  t in [point1, po
+00016b40: 696e 7432 5d20 616e 6420 5769 7265 3244  int2] and Wire2D
+00016b50: 2863 6c6f 7369 6e67 5f77 6972 6529 2e70  (closing_wire).p
+00016b60: 6f69 6e74 5f6f 7665 725f 7769 7265 2870  oint_over_wire(p
+00016b70: 6f69 6e74 293a 0a20 2020 2020 2020 2020  oint):.         
+00016b80: 2020 2020 2020 2020 2020 2063 6c6f 7369             closi
+00016b90: 6e67 5f77 6972 6520 3d20 7769 7265 2e65  ng_wire = wire.e
+00016ba0: 7874 7261 6374 5f77 6974 686f 7574 5f70  xtract_without_p
+00016bb0: 7269 6d69 7469 7665 7328 706f 696e 7431  rimitives(point1
+00016bc0: 2c20 706f 696e 7432 2c20 4661 6c73 6529  , point2, False)
+00016bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016be0: 2020 2020 2062 7265 616b 0a0a 2020 2020       break..    
+00016bf0: 2020 2020 2020 2020 636c 6f73 696e 675f          closing_
+00016c00: 7769 7265 5f70 7269 6d20 3d20 5b63 6c6f  wire_prim = [clo
+00016c10: 7369 6e67 5f77 2066 6f72 2063 6c6f 7369  sing_w for closi
+00016c20: 6e67 5f77 2069 6e20 636c 6f73 696e 675f  ng_w in closing_
+00016c30: 7769 7265 2069 6620 636c 6f73 696e 675f  wire if closing_
+00016c40: 775d 0a20 2020 2020 2020 2020 2020 2063  w].            c
+00016c50: 6c6f 7369 6e67 5f63 6f6e 746f 7572 203d  losing_contour =
+00016c60: 2043 6f6e 746f 7572 3244 2863 6c6f 7369   Contour2D(closi
+00016c70: 6e67 5f77 6972 655f 7072 696d 290a 2020  ng_wire_prim).  
+00016c80: 2020 2020 2020 2020 2020 636f 6e74 6f75            contou
+00016c90: 7231 2c20 636f 6e74 6f75 7232 203d 2063  r1, contour2 = c
+00016ca0: 6f6e 746f 7572 5f74 6f5f 6375 742e 6765  ontour_to_cut.ge
+00016cb0: 745f 6469 7669 6465 645f 636f 6e74 6f75  t_divided_contou
+00016cc0: 7273 2870 6f69 6e74 312c 0a20 2020 2020  rs(point1,.     
 00016cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d00: 2020 2020 2020 2020 706f 696e 7432 2c0a          point2,.
-00016d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d10: 706f 696e 7432 2c0a 2020 2020 2020 2020  point2,.        
 00016d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d50: 2020 2020 2063 6c6f 7369 6e67 5f63 6f6e       closing_con
-00016d60: 746f 7572 2c0a 2020 2020 2020 2020 2020  tour,.          
+00016d50: 2020 2020 2020 2020 2020 2020 2063 6c6f               clo
+00016d60: 7369 6e67 5f63 6f6e 746f 7572 2c0a 2020  sing_contour,.  
 00016d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00016d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016da0: 2020 2020 2020 2020 2020 2054 7275 6529             True)
-00016db0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00016dc0: 2073 6f72 7465 645f 706f 696e 7473 2e69   sorted_points.i
-00016dd0: 6e64 6578 2870 6f69 6e74 3129 202b 2032  ndex(point1) + 2
-00016de0: 203c 206c 656e 2873 6f72 7465 645f 706f   < len(sorted_po
-00016df0: 696e 7473 2920 2d20 313a 0a20 2020 2020  ints) - 1:.     
-00016e00: 2020 2020 2020 2020 2020 2069 6620 636f             if co
-00016e10: 6e74 6f75 7231 2e70 6f69 6e74 5f6f 7665  ntour1.point_ove
-00016e20: 725f 636f 6e74 6f75 7228 0a20 2020 2020  r_contour(.     
-00016e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e40: 2020 2073 6f72 7465 645f 706f 696e 7473     sorted_points
-00016e50: 5b73 6f72 7465 645f 706f 696e 7473 2e69  [sorted_points.i
-00016e60: 6e64 6578 2870 6f69 6e74 3129 202b 2032  ndex(point1) + 2
-00016e70: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-00016e80: 2020 2020 2020 2020 636f 6e74 6f75 725f          contour_
-00016e90: 746f 5f63 7574 203d 2063 6f6e 746f 7572  to_cut = contour
-00016ea0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00016eb0: 2020 2020 2020 6c69 7374 5f63 6f6e 746f        list_conto
-00016ec0: 7572 732e 6170 7065 6e64 2863 6f6e 746f  urs.append(conto
-00016ed0: 7572 3229 0a20 2020 2020 2020 2020 2020  ur2).           
-00016ee0: 2020 2020 2065 6c69 6620 636f 6e74 6f75       elif contou
-00016ef0: 7232 2e70 6f69 6e74 5f6f 7665 725f 636f  r2.point_over_co
-00016f00: 6e74 6f75 7228 0a20 2020 2020 2020 2020  ntour(.         
-00016f10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00016f20: 6f72 7465 645f 706f 696e 7473 5b73 6f72  orted_points[sor
-00016f30: 7465 645f 706f 696e 7473 2e69 6e64 6578  ted_points.index
-00016f40: 2870 6f69 6e74 3129 202b 2032 5d29 3a0a  (point1) + 2]):.
-00016f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f60: 2020 2020 636f 6e74 6f75 725f 746f 5f63      contour_to_c
-00016f70: 7574 203d 2063 6f6e 746f 7572 320a 2020  ut = contour2.  
-00016f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f90: 2020 6c69 7374 5f63 6f6e 746f 7572 732e    list_contours.
-00016fa0: 6170 7065 6e64 2863 6f6e 746f 7572 3129  append(contour1)
-00016fb0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00016fc0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00016fd0: 2020 206c 6973 745f 636f 6e74 6f75 7273     list_contours
-00016fe0: 2e65 7874 656e 6428 5b63 6f6e 746f 7572  .extend([contour
-00016ff0: 312c 2063 6f6e 746f 7572 325d 290a 2020  1, contour2]).  
-00017000: 2020 2020 2020 2020 2020 6375 7474 696e            cuttin
-00017010: 675f 706f 696e 7473 5f63 6f75 6e74 6572  g_points_counter
-00017020: 202b 3d20 320a 0a20 2020 2020 2020 2072   += 2..        r
-00017030: 6574 7572 6e20 6c69 7374 5f63 6f6e 746f  eturn list_conto
-00017040: 7572 730a 0a0a 636c 6173 7320 436c 6f73  urs...class Clos
-00017050: 6564 506f 6c79 676f 6e4d 6978 696e 3a0a  edPolygonMixin:.
-00017060: 2020 2020 2222 220a 2020 2020 4162 7374      """.    Abst
-00017070: 7261 6374 2063 6c61 7373 2066 6f72 2043  ract class for C
-00017080: 6c6f 7365 6450 6f6c 7967 6f6e 2c20 7374  losedPolygon, st
-00017090: 6f72 696e 6720 6d65 7468 6f64 7320 7573  oring methods us
-000170a0: 6564 2062 7920 436c 6f73 6564 506f 6c79  ed by ClosedPoly
-000170b0: 676f 6e32 4420 616e 6420 436c 6f73 6564  gon2D and Closed
-000170c0: 506f 6c79 676f 6e33 442e 0a0a 2020 2020  Polygon3D...    
-000170d0: 2222 220a 0a20 2020 2064 6566 206c 656e  """..    def len
-000170e0: 6774 6828 7365 6c66 293a 0a20 2020 2020  gth(self):.     
-000170f0: 2020 206c 6973 745f 203d 205b 5d0a 2020     list_ = [].  
-00017100: 2020 2020 2020 666f 7220 6b20 696e 2072        for k in r
-00017110: 616e 6765 286c 656e 2873 656c 662e 6c69  ange(len(self.li
-00017120: 6e65 5f73 6567 6d65 6e74 7329 293a 0a20  ne_segments)):. 
-00017130: 2020 2020 2020 2020 2020 206c 6973 745f             list_
-00017140: 2e61 7070 656e 6428 7365 6c66 2e6c 696e  .append(self.lin
-00017150: 655f 7365 676d 656e 7473 5b6b 5d2e 6c65  e_segments[k].le
-00017160: 6e67 7468 2829 290a 2020 2020 2020 2020  ngth()).        
-00017170: 7265 7475 726e 2073 756d 286c 6973 745f  return sum(list_
-00017180: 290a 0a20 2020 2064 6566 206d 696e 5f6c  )..    def min_l
-00017190: 656e 6774 6828 7365 6c66 293a 0a20 2020  ength(self):.   
-000171a0: 2020 2020 206c 6973 745f 203d 205b 5d0a       list_ = [].
-000171b0: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
-000171c0: 2072 616e 6765 286c 656e 2873 656c 662e   range(len(self.
-000171d0: 6c69 6e65 5f73 6567 6d65 6e74 7329 293a  line_segments)):
-000171e0: 0a20 2020 2020 2020 2020 2020 206c 6973  .            lis
-000171f0: 745f 2e61 7070 656e 6428 7365 6c66 2e6c  t_.append(self.l
-00017200: 696e 655f 7365 676d 656e 7473 5b6b 5d2e  ine_segments[k].
-00017210: 6c65 6e67 7468 2829 290a 2020 2020 2020  length()).      
-00017220: 2020 7265 7475 726e 206d 696e 286c 6973    return min(lis
-00017230: 745f 290a 0a20 2020 2064 6566 206d 6178  t_)..    def max
-00017240: 5f6c 656e 6774 6828 7365 6c66 293a 0a20  _length(self):. 
-00017250: 2020 2020 2020 206c 6973 745f 203d 205b         list_ = [
-00017260: 5d0a 2020 2020 2020 2020 666f 7220 6b20  ].        for k 
-00017270: 696e 2072 616e 6765 286c 656e 2873 656c  in range(len(sel
-00017280: 662e 6c69 6e65 5f73 6567 6d65 6e74 7329  f.line_segments)
-00017290: 293a 0a20 2020 2020 2020 2020 2020 206c  ):.            l
-000172a0: 6973 745f 2e61 7070 656e 6428 7365 6c66  ist_.append(self
-000172b0: 2e6c 696e 655f 7365 676d 656e 7473 5b6b  .line_segments[k
-000172c0: 5d2e 6c65 6e67 7468 2829 290a 2020 2020  ].length()).    
-000172d0: 2020 2020 7265 7475 726e 206d 6178 286c      return max(l
-000172e0: 6973 745f 290a 0a20 2020 2064 6566 2065  ist_)..    def e
-000172f0: 6467 655f 7374 6174 6973 7469 6373 2873  dge_statistics(s
-00017300: 656c 6629 3a0a 2020 2020 2020 2020 6469  elf):.        di
-00017310: 7374 616e 6365 7320 3d20 5b5d 0a20 2020  stances = [].   
-00017320: 2020 2020 2066 6f72 2069 2c20 706f 696e       for i, poin
-00017330: 7420 696e 2065 6e75 6d65 7261 7465 2873  t in enumerate(s
-00017340: 656c 662e 706f 696e 7473 293a 0a20 2020  elf.points):.   
-00017350: 2020 2020 2020 2020 2069 6620 6920 213d           if i !=
-00017360: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-00017370: 2020 2020 6469 7374 616e 6365 732e 6170      distances.ap
-00017380: 7065 6e64 2870 6f69 6e74 2e70 6f69 6e74  pend(point.point
-00017390: 5f64 6973 7461 6e63 6528 7365 6c66 2e70  _distance(self.p
-000173a0: 6f69 6e74 735b 6920 2d20 315d 2929 0a20  oints[i - 1])). 
-000173b0: 2020 2020 2020 206d 6561 6e5f 6469 7374         mean_dist
-000173c0: 616e 6365 203d 206d 6561 6e28 6469 7374  ance = mean(dist
-000173d0: 616e 6365 7329 0a20 2020 2020 2020 2073  ances).        s
-000173e0: 7464 203d 206e 7079 2e73 7464 2864 6973  td = npy.std(dis
-000173f0: 7461 6e63 6573 290a 2020 2020 2020 2020  tances).        
-00017400: 7265 7475 726e 206d 6561 6e5f 6469 7374  return mean_dist
-00017410: 616e 6365 2c20 7374 640a 0a20 2020 2064  ance, std..    d
-00017420: 6566 2073 696d 706c 6966 795f 706f 6c79  ef simplify_poly
-00017430: 676f 6e28 7365 6c66 2c20 6d69 6e5f 6469  gon(self, min_di
-00017440: 7374 616e 6365 3a20 666c 6f61 7420 3d20  stance: float = 
-00017450: 302e 3031 2c0a 2020 2020 2020 2020 2020  0.01,.          
-00017460: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00017470: 6178 5f64 6973 7461 6e63 653a 2066 6c6f  ax_distance: flo
-00017480: 6174 203d 2030 2e30 352c 2061 6e67 6c65  at = 0.05, angle
-00017490: 3a20 666c 6f61 7420 3d20 3135 293a 0a20  : float = 15):. 
-000174a0: 2020 2020 2020 2070 6f69 6e74 7320 3d20         points = 
-000174b0: 5b73 656c 662e 706f 696e 7473 5b30 5d5d  [self.points[0]]
-000174c0: 0a20 2020 2020 2020 2070 7265 7669 6f75  .        previou
-000174d0: 735f 706f 696e 7420 3d20 4e6f 6e65 0a20  s_point = None. 
-000174e0: 2020 2020 2020 2066 6f72 2070 6f69 6e74         for point
-000174f0: 2069 6e20 7365 6c66 2e70 6f69 6e74 735b   in self.points[
-00017500: 313a 5d3a 0a20 2020 2020 2020 2020 2020  1:]:.           
-00017510: 2064 6973 7461 6e63 6520 3d20 706f 696e   distance = poin
-00017520: 742e 706f 696e 745f 6469 7374 616e 6365  t.point_distance
-00017530: 2870 6f69 6e74 735b 2d31 5d29 0a20 2020  (points[-1]).   
-00017540: 2020 2020 2020 2020 2069 6620 6469 7374           if dist
-00017550: 616e 6365 203e 206d 696e 5f64 6973 7461  ance > min_dista
-00017560: 6e63 653a 0a20 2020 2020 2020 2020 2020  nce:.           
-00017570: 2020 2020 2069 6620 6469 7374 616e 6365       if distance
-00017580: 203e 206d 6178 5f64 6973 7461 6e63 653a   > max_distance:
-00017590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000175a0: 2020 2020 206e 756d 6265 725f 7365 676d       number_segm
-000175b0: 6e74 7320 3d20 726f 756e 6428 6469 7374  nts = round(dist
-000175c0: 616e 6365 202f 206d 6178 5f64 6973 7461  ance / max_dista
-000175d0: 6e63 6529 202b 2032 0a20 2020 2020 2020  nce) + 2.       
-000175e0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-000175f0: 206e 2069 6e20 7261 6e67 6528 6e75 6d62   n in range(numb
-00017600: 6572 5f73 6567 6d6e 7473 293a 0a20 2020  er_segmnts):.   
-00017610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017620: 2020 2020 206e 6577 5f70 6f69 6e74 203d       new_point =
-00017630: 2070 6f69 6e74 735b 2d31 5d20 2b20 2870   points[-1] + (p
-00017640: 6f69 6e74 202d 2070 6f69 6e74 735b 2d31  oint - points[-1
-00017650: 5d29 202a 2028 0a20 2020 2020 2020 2020  ]) * (.         
+00016da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016db0: 2020 2054 7275 6529 0a0a 2020 2020 2020     True)..      
+00016dc0: 2020 2020 2020 6966 2073 6f72 7465 645f        if sorted_
+00016dd0: 706f 696e 7473 2e69 6e64 6578 2870 6f69  points.index(poi
+00016de0: 6e74 3129 202b 2032 203c 206c 656e 2873  nt1) + 2 < len(s
+00016df0: 6f72 7465 645f 706f 696e 7473 2920 2d20  orted_points) - 
+00016e00: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+00016e10: 2020 2069 6620 636f 6e74 6f75 7231 2e70     if contour1.p
+00016e20: 6f69 6e74 5f6f 7665 725f 636f 6e74 6f75  oint_over_contou
+00016e30: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00016e40: 2020 2020 2020 2020 2020 2073 6f72 7465             sorte
+00016e50: 645f 706f 696e 7473 5b73 6f72 7465 645f  d_points[sorted_
+00016e60: 706f 696e 7473 2e69 6e64 6578 2870 6f69  points.index(poi
+00016e70: 6e74 3129 202b 2032 5d29 3a0a 2020 2020  nt1) + 2]):.    
+00016e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e90: 636f 6e74 6f75 725f 746f 5f63 7574 203d  contour_to_cut =
+00016ea0: 2063 6f6e 746f 7572 310a 2020 2020 2020   contour1.      
+00016eb0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00016ec0: 7374 5f63 6f6e 746f 7572 732e 6170 7065  st_contours.appe
+00016ed0: 6e64 2863 6f6e 746f 7572 3229 0a20 2020  nd(contour2).   
+00016ee0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00016ef0: 6620 636f 6e74 6f75 7232 2e70 6f69 6e74  f contour2.point
+00016f00: 5f6f 7665 725f 636f 6e74 6f75 7228 0a20  _over_contour(. 
+00016f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f20: 2020 2020 2020 2073 6f72 7465 645f 706f         sorted_po
+00016f30: 696e 7473 5b73 6f72 7465 645f 706f 696e  ints[sorted_poin
+00016f40: 7473 2e69 6e64 6578 2870 6f69 6e74 3129  ts.index(point1)
+00016f50: 202b 2032 5d29 3a0a 2020 2020 2020 2020   + 2]):.        
+00016f60: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+00016f70: 6f75 725f 746f 5f63 7574 203d 2063 6f6e  our_to_cut = con
+00016f80: 746f 7572 320a 2020 2020 2020 2020 2020  tour2.          
+00016f90: 2020 2020 2020 2020 2020 6c69 7374 5f63            list_c
+00016fa0: 6f6e 746f 7572 732e 6170 7065 6e64 2863  ontours.append(c
+00016fb0: 6f6e 746f 7572 3129 0a20 2020 2020 2020  ontour1).       
+00016fc0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00016fd0: 2020 2020 2020 2020 2020 206c 6973 745f             list_
+00016fe0: 636f 6e74 6f75 7273 2e65 7874 656e 6428  contours.extend(
+00016ff0: 5b63 6f6e 746f 7572 312c 2063 6f6e 746f  [contour1, conto
+00017000: 7572 325d 290a 2020 2020 2020 2020 2020  ur2]).          
+00017010: 2020 6375 7474 696e 675f 706f 696e 7473    cutting_points
+00017020: 5f63 6f75 6e74 6572 202b 3d20 320a 0a20  _counter += 2.. 
+00017030: 2020 2020 2020 2072 6574 7572 6e20 6c69         return li
+00017040: 7374 5f63 6f6e 746f 7572 730a 0a0a 636c  st_contours...cl
+00017050: 6173 7320 436c 6f73 6564 506f 6c79 676f  ass ClosedPolygo
+00017060: 6e4d 6978 696e 3a0a 2020 2020 2222 220a  nMixin:.    """.
+00017070: 2020 2020 4162 7374 7261 6374 2063 6c61      Abstract cla
+00017080: 7373 2066 6f72 2043 6c6f 7365 6450 6f6c  ss for ClosedPol
+00017090: 7967 6f6e 2c20 7374 6f72 696e 6720 6d65  ygon, storing me
+000170a0: 7468 6f64 7320 7573 6564 2062 7920 436c  thods used by Cl
+000170b0: 6f73 6564 506f 6c79 676f 6e32 4420 616e  osedPolygon2D an
+000170c0: 6420 436c 6f73 6564 506f 6c79 676f 6e33  d ClosedPolygon3
+000170d0: 442e 0a0a 2020 2020 2222 220a 0a20 2020  D...    """..   
+000170e0: 2064 6566 206c 656e 6774 6828 7365 6c66   def length(self
+000170f0: 293a 0a20 2020 2020 2020 206c 6973 745f  ):.        list_
+00017100: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
+00017110: 7220 6b20 696e 2072 616e 6765 286c 656e  r k in range(len
+00017120: 2873 656c 662e 6c69 6e65 5f73 6567 6d65  (self.line_segme
+00017130: 6e74 7329 293a 0a20 2020 2020 2020 2020  nts)):.         
+00017140: 2020 206c 6973 745f 2e61 7070 656e 6428     list_.append(
+00017150: 7365 6c66 2e6c 696e 655f 7365 676d 656e  self.line_segmen
+00017160: 7473 5b6b 5d2e 6c65 6e67 7468 2829 290a  ts[k].length()).
+00017170: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00017180: 756d 286c 6973 745f 290a 0a20 2020 2064  um(list_)..    d
+00017190: 6566 206d 696e 5f6c 656e 6774 6828 7365  ef min_length(se
+000171a0: 6c66 293a 0a20 2020 2020 2020 206c 6973  lf):.        lis
+000171b0: 745f 203d 205b 5d0a 2020 2020 2020 2020  t_ = [].        
+000171c0: 666f 7220 6b20 696e 2072 616e 6765 286c  for k in range(l
+000171d0: 656e 2873 656c 662e 6c69 6e65 5f73 6567  en(self.line_seg
+000171e0: 6d65 6e74 7329 293a 0a20 2020 2020 2020  ments)):.       
+000171f0: 2020 2020 206c 6973 745f 2e61 7070 656e       list_.appen
+00017200: 6428 7365 6c66 2e6c 696e 655f 7365 676d  d(self.line_segm
+00017210: 656e 7473 5b6b 5d2e 6c65 6e67 7468 2829  ents[k].length()
+00017220: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00017230: 206d 696e 286c 6973 745f 290a 0a20 2020   min(list_)..   
+00017240: 2064 6566 206d 6178 5f6c 656e 6774 6828   def max_length(
+00017250: 7365 6c66 293a 0a20 2020 2020 2020 206c  self):.        l
+00017260: 6973 745f 203d 205b 5d0a 2020 2020 2020  ist_ = [].      
+00017270: 2020 666f 7220 6b20 696e 2072 616e 6765    for k in range
+00017280: 286c 656e 2873 656c 662e 6c69 6e65 5f73  (len(self.line_s
+00017290: 6567 6d65 6e74 7329 293a 0a20 2020 2020  egments)):.     
+000172a0: 2020 2020 2020 206c 6973 745f 2e61 7070         list_.app
+000172b0: 656e 6428 7365 6c66 2e6c 696e 655f 7365  end(self.line_se
+000172c0: 676d 656e 7473 5b6b 5d2e 6c65 6e67 7468  gments[k].length
+000172d0: 2829 290a 2020 2020 2020 2020 7265 7475  ()).        retu
+000172e0: 726e 206d 6178 286c 6973 745f 290a 0a20  rn max(list_).. 
+000172f0: 2020 2064 6566 2065 6467 655f 7374 6174     def edge_stat
+00017300: 6973 7469 6373 2873 656c 6629 3a0a 2020  istics(self):.  
+00017310: 2020 2020 2020 6469 7374 616e 6365 7320        distances 
+00017320: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
+00017330: 2069 2c20 706f 696e 7420 696e 2065 6e75   i, point in enu
+00017340: 6d65 7261 7465 2873 656c 662e 706f 696e  merate(self.poin
+00017350: 7473 293a 0a20 2020 2020 2020 2020 2020  ts):.           
+00017360: 2069 6620 6920 213d 2030 3a0a 2020 2020   if i != 0:.    
+00017370: 2020 2020 2020 2020 2020 2020 6469 7374              dist
+00017380: 616e 6365 732e 6170 7065 6e64 2870 6f69  ances.append(poi
+00017390: 6e74 2e70 6f69 6e74 5f64 6973 7461 6e63  nt.point_distanc
+000173a0: 6528 7365 6c66 2e70 6f69 6e74 735b 6920  e(self.points[i 
+000173b0: 2d20 315d 2929 0a20 2020 2020 2020 206d  - 1])).        m
+000173c0: 6561 6e5f 6469 7374 616e 6365 203d 206d  ean_distance = m
+000173d0: 6561 6e28 6469 7374 616e 6365 7329 0a20  ean(distances). 
+000173e0: 2020 2020 2020 2073 7464 203d 206e 7079         std = npy
+000173f0: 2e73 7464 2864 6973 7461 6e63 6573 290a  .std(distances).
+00017400: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+00017410: 6561 6e5f 6469 7374 616e 6365 2c20 7374  ean_distance, st
+00017420: 640a 0a20 2020 2064 6566 2073 696d 706c  d..    def simpl
+00017430: 6966 795f 706f 6c79 676f 6e28 7365 6c66  ify_polygon(self
+00017440: 2c20 6d69 6e5f 6469 7374 616e 6365 3a20  , min_distance: 
+00017450: 666c 6f61 7420 3d20 302e 3031 2c0a 2020  float = 0.01,.  
+00017460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017470: 2020 2020 2020 206d 6178 5f64 6973 7461         max_dista
+00017480: 6e63 653a 2066 6c6f 6174 203d 2030 2e30  nce: float = 0.0
+00017490: 352c 2061 6e67 6c65 3a20 666c 6f61 7420  5, angle: float 
+000174a0: 3d20 3135 293a 0a20 2020 2020 2020 2070  = 15):.        p
+000174b0: 6f69 6e74 7320 3d20 5b73 656c 662e 706f  oints = [self.po
+000174c0: 696e 7473 5b30 5d5d 0a20 2020 2020 2020  ints[0]].       
+000174d0: 2070 7265 7669 6f75 735f 706f 696e 7420   previous_point 
+000174e0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2066  = None.        f
+000174f0: 6f72 2070 6f69 6e74 2069 6e20 7365 6c66  or point in self
+00017500: 2e70 6f69 6e74 735b 313a 5d3a 0a20 2020  .points[1:]:.   
+00017510: 2020 2020 2020 2020 2064 6973 7461 6e63           distanc
+00017520: 6520 3d20 706f 696e 742e 706f 696e 745f  e = point.point_
+00017530: 6469 7374 616e 6365 2870 6f69 6e74 735b  distance(points[
+00017540: 2d31 5d29 0a20 2020 2020 2020 2020 2020  -1]).           
+00017550: 2069 6620 6469 7374 616e 6365 203e 206d   if distance > m
+00017560: 696e 5f64 6973 7461 6e63 653a 0a20 2020  in_distance:.   
+00017570: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00017580: 6469 7374 616e 6365 203e 206d 6178 5f64  distance > max_d
+00017590: 6973 7461 6e63 653a 0a20 2020 2020 2020  istance:.       
+000175a0: 2020 2020 2020 2020 2020 2020 206e 756d               num
+000175b0: 6265 725f 7365 676d 6e74 7320 3d20 726f  ber_segmnts = ro
+000175c0: 756e 6428 6469 7374 616e 6365 202f 206d  und(distance / m
+000175d0: 6178 5f64 6973 7461 6e63 6529 202b 2032  ax_distance) + 2
+000175e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000175f0: 2020 2020 2066 6f72 206e 2069 6e20 7261       for n in ra
+00017600: 6e67 6528 6e75 6d62 6572 5f73 6567 6d6e  nge(number_segmn
+00017610: 7473 293a 0a20 2020 2020 2020 2020 2020  ts):.           
+00017620: 2020 2020 2020 2020 2020 2020 206e 6577               new
+00017630: 5f70 6f69 6e74 203d 2070 6f69 6e74 735b  _point = points[
+00017640: 2d31 5d20 2b20 2870 6f69 6e74 202d 2070  -1] + (point - p
+00017650: 6f69 6e74 735b 2d31 5d29 202a 2028 0a20  oints[-1]) * (. 
 00017660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017670: 2020 2020 2020 206e 202b 2031 2920 2f20         n + 1) / 
-00017680: 6e75 6d62 6572 5f73 6567 6d6e 7473 0a20  number_segmnts. 
-00017690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000176a0: 2020 2020 2020 2069 6620 6e65 775f 706f         if new_po
-000176b0: 696e 742e 706f 696e 745f 6469 7374 616e  int.point_distan
-000176c0: 6365 2870 6f69 6e74 735b 2d31 5d29 203e  ce(points[-1]) >
-000176d0: 206d 6178 5f64 6973 7461 6e63 653a 0a20   max_distance:. 
-000176e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000176f0: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-00017700: 732e 6170 7065 6e64 286e 6577 5f70 6f69  s.append(new_poi
-00017710: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
-00017720: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00017730: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00017740: 2070 6f69 6e74 206e 6f74 2069 6e20 706f   point not in po
-00017750: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
-00017760: 2020 2020 2020 2020 2020 2020 2020 706f                po
-00017770: 696e 7473 2e61 7070 656e 6428 706f 696e  ints.append(poin
-00017780: 7429 0a20 2020 2020 2020 2020 2020 2069  t).            i
-00017790: 6620 6c65 6e28 706f 696e 7473 2920 3e20  f len(points) > 
-000177a0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-000177b0: 2020 2076 6563 746f 7231 203d 2070 6f69     vector1 = poi
-000177c0: 6e74 735b 2d31 5d20 2d20 706f 696e 7473  nts[-1] - points
-000177d0: 5b2d 325d 0a20 2020 2020 2020 2020 2020  [-2].           
-000177e0: 2020 2020 2076 6563 746f 7232 203d 2070       vector2 = p
-000177f0: 6f69 6e74 202d 2070 6f69 6e74 735b 2d32  oint - points[-2
-00017800: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00017810: 2020 636f 7320 3d20 7665 6374 6f72 312e    cos = vector1.
-00017820: 646f 7428 7665 6374 6f72 3229 202f 2028  dot(vector2) / (
-00017830: 7665 6374 6f72 312e 6e6f 726d 2829 202a  vector1.norm() *
-00017840: 2076 6563 746f 7232 2e6e 6f72 6d28 2929   vector2.norm())
-00017850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017860: 2063 6f73 203d 206d 6174 682e 6465 6772   cos = math.degr
-00017870: 6565 7328 6d61 7468 2e61 636f 7328 726f  ees(math.acos(ro
-00017880: 756e 6428 636f 732c 2036 2929 290a 2020  und(cos, 6))).  
-00017890: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000178a0: 2061 6273 2863 6f73 2920 3e20 616e 676c   abs(cos) > angl
-000178b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000178c0: 2020 2020 2020 2069 6620 7072 6576 696f         if previo
-000178d0: 7573 5f70 6f69 6e74 206e 6f74 2069 6e20  us_point not in 
-000178e0: 706f 696e 7473 3a0a 2020 2020 2020 2020  points:.        
+00017670: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00017680: 202b 2031 2920 2f20 6e75 6d62 6572 5f73   + 1) / number_s
+00017690: 6567 6d6e 7473 0a20 2020 2020 2020 2020  egmnts.         
+000176a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000176b0: 6620 6e65 775f 706f 696e 742e 706f 696e  f new_point.poin
+000176c0: 745f 6469 7374 616e 6365 2870 6f69 6e74  t_distance(point
+000176d0: 735b 2d31 5d29 203e 206d 6178 5f64 6973  s[-1]) > max_dis
+000176e0: 7461 6e63 653a 0a20 2020 2020 2020 2020  tance:.         
+000176f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017700: 2020 2070 6f69 6e74 732e 6170 7065 6e64     points.append
+00017710: 286e 6577 5f70 6f69 6e74 290a 2020 2020  (new_point).    
+00017720: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00017730: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00017740: 2020 2020 2020 6966 2070 6f69 6e74 206e        if point n
+00017750: 6f74 2069 6e20 706f 696e 7473 3a0a 2020  ot in points:.  
+00017760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017770: 2020 2020 2020 706f 696e 7473 2e61 7070        points.app
+00017780: 656e 6428 706f 696e 7429 0a20 2020 2020  end(point).     
+00017790: 2020 2020 2020 2069 6620 6c65 6e28 706f         if len(po
+000177a0: 696e 7473 2920 3e20 313a 0a20 2020 2020  ints) > 1:.     
+000177b0: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
+000177c0: 7231 203d 2070 6f69 6e74 735b 2d31 5d20  r1 = points[-1] 
+000177d0: 2d20 706f 696e 7473 5b2d 325d 0a20 2020  - points[-2].   
+000177e0: 2020 2020 2020 2020 2020 2020 2076 6563               vec
+000177f0: 746f 7232 203d 2070 6f69 6e74 202d 2070  tor2 = point - p
+00017800: 6f69 6e74 735b 2d32 5d0a 2020 2020 2020  oints[-2].      
+00017810: 2020 2020 2020 2020 2020 636f 7320 3d20            cos = 
+00017820: 7665 6374 6f72 312e 646f 7428 7665 6374  vector1.dot(vect
+00017830: 6f72 3229 202f 2028 7665 6374 6f72 312e  or2) / (vector1.
+00017840: 6e6f 726d 2829 202a 2076 6563 746f 7232  norm() * vector2
+00017850: 2e6e 6f72 6d28 2929 0a20 2020 2020 2020  .norm()).       
+00017860: 2020 2020 2020 2020 2063 6f73 203d 206d           cos = m
+00017870: 6174 682e 6465 6772 6565 7328 6d61 7468  ath.degrees(math
+00017880: 2e61 636f 7328 726f 756e 6428 636f 732c  .acos(round(cos,
+00017890: 2036 2929 290a 2020 2020 2020 2020 2020   6))).          
+000178a0: 2020 2020 2020 6966 2061 6273 2863 6f73        if abs(cos
+000178b0: 2920 3e20 616e 676c 653a 0a20 2020 2020  ) > angle:.     
+000178c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000178d0: 6620 7072 6576 696f 7573 5f70 6f69 6e74  f previous_point
+000178e0: 206e 6f74 2069 6e20 706f 696e 7473 3a0a   not in points:.
 000178f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017900: 706f 696e 7473 2e61 7070 656e 6428 7072  points.append(pr
-00017910: 6576 696f 7573 5f70 6f69 6e74 290a 2020  evious_point).  
-00017920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017930: 2020 6966 2070 6f69 6e74 206e 6f74 2069    if point not i
-00017940: 6e20 706f 696e 7473 3a0a 2020 2020 2020  n points:.      
-00017950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017960: 2020 706f 696e 7473 2e61 7070 656e 6428    points.append(
-00017970: 706f 696e 7429 0a20 2020 2020 2020 2020  point).         
-00017980: 2020 2069 6620 6c65 6e28 706f 696e 7473     if len(points
-00017990: 2920 3e20 323a 0a20 2020 2020 2020 2020  ) > 2:.         
-000179a0: 2020 2020 2020 2076 6563 746f 7231 203d         vector1 =
-000179b0: 2070 6f69 6e74 735b 2d32 5d20 2d20 706f   points[-2] - po
-000179c0: 696e 7473 5b2d 335d 0a20 2020 2020 2020  ints[-3].       
-000179d0: 2020 2020 2020 2020 2076 6563 746f 7232           vector2
-000179e0: 203d 2070 6f69 6e74 735b 2d31 5d20 2d20   = points[-1] - 
-000179f0: 706f 696e 7473 5b2d 335d 0a20 2020 2020  points[-3].     
-00017a00: 2020 2020 2020 2020 2020 2063 6f73 203d             cos =
-00017a10: 2076 6563 746f 7231 2e64 6f74 2876 6563   vector1.dot(vec
-00017a20: 746f 7232 2920 2f20 2876 6563 746f 7231  tor2) / (vector1
-00017a30: 2e6e 6f72 6d28 2920 2a20 7665 6374 6f72  .norm() * vector
-00017a40: 322e 6e6f 726d 2829 290a 2020 2020 2020  2.norm()).      
-00017a50: 2020 2020 2020 2020 2020 636f 7320 3d20            cos = 
-00017a60: 6d61 7468 2e64 6567 7265 6573 286d 6174  math.degrees(mat
-00017a70: 682e 6163 6f73 2872 6f75 6e64 2863 6f73  h.acos(round(cos
-00017a80: 2c20 3629 2929 0a20 2020 2020 2020 2020  , 6))).         
-00017a90: 2020 2020 2020 2069 6620 706f 696e 7473         if points
-00017aa0: 5b2d 335d 2e70 6f69 6e74 5f64 6973 7461  [-3].point_dista
-00017ab0: 6e63 6528 706f 696e 7473 5b2d 325d 2920  nce(points[-2]) 
-00017ac0: 3c20 6d69 6e5f 6469 7374 616e 6365 2061  < min_distance a
-00017ad0: 6e64 2063 6f73 203c 2061 6e67 6c65 3a0a  nd cos < angle:.
-00017ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017af0: 2020 2020 706f 696e 7473 203d 2070 6f69      points = poi
-00017b00: 6e74 735b 3a2d 325d 202b 205b 706f 696e  nts[:-2] + [poin
-00017b10: 7473 5b2d 315d 5d0a 2020 2020 2020 2020  ts[-1]].        
-00017b20: 2020 2020 7072 6576 696f 7573 5f70 6f69      previous_poi
-00017b30: 6e74 203d 2070 6f69 6e74 0a20 2020 2020  nt = point.     
-00017b40: 2020 2069 6620 706f 696e 7473 5b30 5d2e     if points[0].
-00017b50: 706f 696e 745f 6469 7374 616e 6365 2870  point_distance(p
-00017b60: 6f69 6e74 735b 2d31 5d29 203c 206d 696e  oints[-1]) < min
-00017b70: 5f64 6973 7461 6e63 653a 0a20 2020 2020  _distance:.     
-00017b80: 2020 2020 2020 2070 6f69 6e74 732e 7265         points.re
-00017b90: 6d6f 7665 2870 6f69 6e74 735b 2d31 5d29  move(points[-1])
-00017ba0: 0a0a 2020 2020 2020 2020 6966 2076 6f6c  ..        if vol
-00017bb0: 6d64 6c72 2e77 6972 6573 2e43 6c6f 7365  mdlr.wires.Close
-00017bc0: 6450 6f6c 7967 6f6e 3244 2870 6f69 6e74  dPolygon2D(point
-00017bd0: 7329 2e61 7265 6128 2920 3d3d 2030 2e30  s).area() == 0.0
-00017be0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00017bf0: 7475 726e 2073 656c 660a 0a20 2020 2020  turn self..     
-00017c00: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00017c10: 5f63 6c61 7373 5f5f 2870 6f69 6e74 7329  _class__(points)
-00017c20: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00017c30: 2020 2020 6465 6620 6c69 6e65 5f73 6567      def line_seg
-00017c40: 6d65 6e74 7328 7365 6c66 293a 0a20 2020  ments(self):.   
-00017c50: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-00017c60: 2e5f 6c69 6e65 5f73 6567 6d65 6e74 733a  ._line_segments:
-00017c70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00017c80: 662e 5f6c 696e 655f 7365 676d 656e 7473  f._line_segments
-00017c90: 203d 2073 656c 662e 6765 745f 6c69 6e65   = self.get_line
-00017ca0: 5f73 6567 6d65 6e74 7328 290a 2020 2020  _segments().    
-00017cb0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00017cc0: 5f6c 696e 655f 7365 676d 656e 7473 0a0a  _line_segments..
-00017cd0: 2020 2020 6465 6620 6765 745f 6c69 6e65      def get_line
-00017ce0: 5f73 6567 6d65 6e74 7328 7365 6c66 293a  _segments(self):
-00017cf0: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
-00017d00: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-00017d10: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00017d20: 6622 6765 745f 6c69 6e65 5f73 6567 6d65  f"get_line_segme
-00017d30: 6e74 7320 6d65 7468 6f64 206d 7573 7420  nts method must 
-00017d40: 6265 206f 7665 726c 6f61 6465 6420 6279  be overloaded by
-00017d50: 207b 7365 6c66 2e5f 5f63 6c61 7373 5f5f   {self.__class__
-00017d60: 2e5f 5f6e 616d 655f 5f7d 2229 0a0a 0a63  .__name__}")...c
-00017d70: 6c61 7373 2043 6c6f 7365 6450 6f6c 7967  lass ClosedPolyg
-00017d80: 6f6e 3244 2843 6f6e 746f 7572 3244 2c20  on2D(Contour2D, 
-00017d90: 436c 6f73 6564 506f 6c79 676f 6e4d 6978  ClosedPolygonMix
-00017da0: 696e 293a 0a20 2020 2022 2222 0a20 2020  in):.    """.   
-00017db0: 2041 2063 6f6c 6c65 6374 696f 6e20 6f66   A collection of
-00017dc0: 2070 6f69 6e74 732c 2063 6f6e 6e65 6374   points, connect
-00017dd0: 6564 2062 7920 6c69 6e65 7365 676d 656e  ed by linesegmen
-00017de0: 7473 2c20 666f 6c6c 6f77 696e 6720 6561  ts, following ea
-00017df0: 6368 206f 7468 6572 2e0a 0a20 2020 2022  ch other...    "
-00017e00: 2222 0a20 2020 205f 6e6f 6e5f 7365 7269  "".    _non_seri
-00017e10: 616c 697a 6162 6c65 5f61 7474 7269 6275  alizable_attribu
-00017e20: 7465 7320 3d20 5b27 6c69 6e65 5f73 6567  tes = ['line_seg
-00017e30: 6d65 6e74 7327 2c20 2770 7269 6d69 7469  ments', 'primiti
-00017e40: 7665 7327 2c0a 2020 2020 2020 2020 2020  ves',.          
+00017900: 2020 2020 2020 2020 706f 696e 7473 2e61          points.a
+00017910: 7070 656e 6428 7072 6576 696f 7573 5f70  ppend(previous_p
+00017920: 6f69 6e74 290a 2020 2020 2020 2020 2020  oint).          
+00017930: 2020 2020 2020 2020 2020 6966 2070 6f69            if poi
+00017940: 6e74 206e 6f74 2069 6e20 706f 696e 7473  nt not in points
+00017950: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00017960: 2020 2020 2020 2020 2020 706f 696e 7473            points
+00017970: 2e61 7070 656e 6428 706f 696e 7429 0a20  .append(point). 
+00017980: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00017990: 6e28 706f 696e 7473 2920 3e20 323a 0a20  n(points) > 2:. 
+000179a0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+000179b0: 6563 746f 7231 203d 2070 6f69 6e74 735b  ector1 = points[
+000179c0: 2d32 5d20 2d20 706f 696e 7473 5b2d 335d  -2] - points[-3]
+000179d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000179e0: 2076 6563 746f 7232 203d 2070 6f69 6e74   vector2 = point
+000179f0: 735b 2d31 5d20 2d20 706f 696e 7473 5b2d  s[-1] - points[-
+00017a00: 335d 0a20 2020 2020 2020 2020 2020 2020  3].             
+00017a10: 2020 2063 6f73 203d 2076 6563 746f 7231     cos = vector1
+00017a20: 2e64 6f74 2876 6563 746f 7232 2920 2f20  .dot(vector2) / 
+00017a30: 2876 6563 746f 7231 2e6e 6f72 6d28 2920  (vector1.norm() 
+00017a40: 2a20 7665 6374 6f72 322e 6e6f 726d 2829  * vector2.norm()
+00017a50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00017a60: 2020 636f 7320 3d20 6d61 7468 2e64 6567    cos = math.deg
+00017a70: 7265 6573 286d 6174 682e 6163 6f73 2872  rees(math.acos(r
+00017a80: 6f75 6e64 2863 6f73 2c20 3629 2929 0a20  ound(cos, 6))). 
+00017a90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00017aa0: 6620 706f 696e 7473 5b2d 335d 2e70 6f69  f points[-3].poi
+00017ab0: 6e74 5f64 6973 7461 6e63 6528 706f 696e  nt_distance(poin
+00017ac0: 7473 5b2d 325d 2920 3c20 6d69 6e5f 6469  ts[-2]) < min_di
+00017ad0: 7374 616e 6365 2061 6e64 2063 6f73 203c  stance and cos <
+00017ae0: 2061 6e67 6c65 3a0a 2020 2020 2020 2020   angle:.        
+00017af0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+00017b00: 7473 203d 2070 6f69 6e74 735b 3a2d 325d  ts = points[:-2]
+00017b10: 202b 205b 706f 696e 7473 5b2d 315d 5d0a   + [points[-1]].
+00017b20: 2020 2020 2020 2020 2020 2020 7072 6576              prev
+00017b30: 696f 7573 5f70 6f69 6e74 203d 2070 6f69  ious_point = poi
+00017b40: 6e74 0a20 2020 2020 2020 2069 6620 706f  nt.        if po
+00017b50: 696e 7473 5b30 5d2e 706f 696e 745f 6469  ints[0].point_di
+00017b60: 7374 616e 6365 2870 6f69 6e74 735b 2d31  stance(points[-1
+00017b70: 5d29 203c 206d 696e 5f64 6973 7461 6e63  ]) < min_distanc
+00017b80: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
+00017b90: 6f69 6e74 732e 7265 6d6f 7665 2870 6f69  oints.remove(poi
+00017ba0: 6e74 735b 2d31 5d29 0a0a 2020 2020 2020  nts[-1])..      
+00017bb0: 2020 6966 2076 6f6c 6d64 6c72 2e77 6972    if volmdlr.wir
+00017bc0: 6573 2e43 6c6f 7365 6450 6f6c 7967 6f6e  es.ClosedPolygon
+00017bd0: 3244 2870 6f69 6e74 7329 2e61 7265 6128  2D(points).area(
+00017be0: 2920 3d3d 2030 2e30 3a0a 2020 2020 2020  ) == 0.0:.      
+00017bf0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00017c00: 660a 0a20 2020 2020 2020 2072 6574 7572  f..        retur
+00017c10: 6e20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  n self.__class__
+00017c20: 2870 6f69 6e74 7329 0a0a 2020 2020 4070  (points)..    @p
+00017c30: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00017c40: 6c69 6e65 5f73 6567 6d65 6e74 7328 7365  line_segments(se
+00017c50: 6c66 293a 0a20 2020 2020 2020 2069 6620  lf):.        if 
+00017c60: 6e6f 7420 7365 6c66 2e5f 6c69 6e65 5f73  not self._line_s
+00017c70: 6567 6d65 6e74 733a 0a20 2020 2020 2020  egments:.       
+00017c80: 2020 2020 2073 656c 662e 5f6c 696e 655f       self._line_
+00017c90: 7365 676d 656e 7473 203d 2073 656c 662e  segments = self.
+00017ca0: 6765 745f 6c69 6e65 5f73 6567 6d65 6e74  get_line_segment
+00017cb0: 7328 290a 2020 2020 2020 2020 7265 7475  s().        retu
+00017cc0: 726e 2073 656c 662e 5f6c 696e 655f 7365  rn self._line_se
+00017cd0: 676d 656e 7473 0a0a 2020 2020 6465 6620  gments..    def 
+00017ce0: 6765 745f 6c69 6e65 5f73 6567 6d65 6e74  get_line_segment
+00017cf0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+00017d00: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+00017d10: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
+00017d20: 2020 2020 2020 2020 6622 6765 745f 6c69          f"get_li
+00017d30: 6e65 5f73 6567 6d65 6e74 7320 6d65 7468  ne_segments meth
+00017d40: 6f64 206d 7573 7420 6265 206f 7665 726c  od must be overl
+00017d50: 6f61 6465 6420 6279 207b 7365 6c66 2e5f  oaded by {self._
+00017d60: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+00017d70: 5f7d 2229 0a0a 0a63 6c61 7373 2043 6c6f  _}")...class Clo
+00017d80: 7365 6450 6f6c 7967 6f6e 3244 2843 6f6e  sedPolygon2D(Con
+00017d90: 746f 7572 3244 2c20 436c 6f73 6564 506f  tour2D, ClosedPo
+00017da0: 6c79 676f 6e4d 6978 696e 293a 0a20 2020  lygonMixin):.   
+00017db0: 2022 2222 0a20 2020 2041 2063 6f6c 6c65   """.    A colle
+00017dc0: 6374 696f 6e20 6f66 2070 6f69 6e74 732c  ction of points,
+00017dd0: 2063 6f6e 6e65 6374 6564 2062 7920 6c69   connected by li
+00017de0: 6e65 7365 676d 656e 7473 2c20 666f 6c6c  nesegments, foll
+00017df0: 6f77 696e 6720 6561 6368 206f 7468 6572  owing each other
+00017e00: 2e0a 0a20 2020 2022 2222 0a20 2020 205f  ...    """.    _
+00017e10: 6e6f 6e5f 7365 7269 616c 697a 6162 6c65  non_serializable
+00017e20: 5f61 7474 7269 6275 7465 7320 3d20 5b27  _attributes = ['
+00017e30: 6c69 6e65 5f73 6567 6d65 6e74 7327 2c20  line_segments', 
+00017e40: 2770 7269 6d69 7469 7665 7327 2c0a 2020  'primitives',.  
 00017e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e60: 2020 2020 2020 2020 2020 2762 6173 6973            'basis
-00017e70: 5f70 7269 6d69 7469 7665 7327 5d0a 0a20  _primitives'].. 
-00017e80: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00017e90: 7365 6c66 2c20 706f 696e 7473 3a20 4c69  self, points: Li
-00017ea0: 7374 5b76 6f6c 6d64 6c72 2e50 6f69 6e74  st[volmdlr.Point
-00017eb0: 3244 5d2c 206e 616d 653a 2073 7472 203d  2D], name: str =
-00017ec0: 2027 2729 3a0a 2020 2020 2020 2020 7365   ''):.        se
-00017ed0: 6c66 2e70 6f69 6e74 7320 3d20 706f 696e  lf.points = poin
-00017ee0: 7473 0a20 2020 2020 2020 2073 656c 662e  ts.        self.
-00017ef0: 5f6c 696e 655f 7365 676d 656e 7473 203d  _line_segments =
-00017f00: 204e 6f6e 650a 0a20 2020 2020 2020 2043   None..        C
-00017f10: 6f6e 746f 7572 3244 2e5f 5f69 6e69 745f  ontour2D.__init_
-00017f20: 5f28 7365 6c66 2c20 7365 6c66 2e6c 696e  _(self, self.lin
-00017f30: 655f 7365 676d 656e 7473 2c20 6e61 6d65  e_segments, name
-00017f40: 290a 0a20 2020 2064 6566 2063 6f70 7928  )..    def copy(
-00017f50: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00017f60: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00017f70: 706f 696e 7473 203d 205b 702e 636f 7079  points = [p.copy
-00017f80: 2829 2066 6f72 2070 2069 6e20 7365 6c66  () for p in self
-00017f90: 2e70 6f69 6e74 735d 0a20 2020 2020 2020  .points].       
-00017fa0: 2072 6574 7572 6e20 436c 6f73 6564 506f   return ClosedPo
-00017fb0: 6c79 676f 6e32 4428 706f 696e 7473 2c20  lygon2D(points, 
-00017fc0: 7365 6c66 2e6e 616d 6529 0a0a 2020 2020  self.name)..    
-00017fd0: 6465 6620 5f5f 6861 7368 5f5f 2873 656c  def __hash__(sel
-00017fe0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00017ff0: 726e 2073 756d 2868 6173 6828 7029 2066  rn sum(hash(p) f
-00018000: 6f72 2070 2069 6e20 7365 6c66 2e70 6f69  or p in self.poi
-00018010: 6e74 7329 0a0a 2020 2020 6465 6620 5f5f  nts)..    def __
-00018020: 6571 5f5f 2873 656c 662c 206f 7468 6572  eq__(self, other
-00018030: 5f29 3a0a 2020 2020 2020 2020 6966 206e  _):.        if n
-00018040: 6f74 2069 7369 6e73 7461 6e63 6528 6f74  ot isinstance(ot
-00018050: 6865 725f 2c20 7365 6c66 2e5f 5f63 6c61  her_, self.__cla
-00018060: 7373 5f5f 293a 0a20 2020 2020 2020 2020  ss__):.         
-00018070: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
-00018080: 2020 2020 2020 2020 6571 7561 6c20 3d20          equal = 
-00018090: 5472 7565 0a20 2020 2020 2020 2066 6f72  True.        for
-000180a0: 2070 6f69 6e74 2c20 6f74 6865 725f 706f   point, other_po
-000180b0: 696e 7420 696e 207a 6970 2873 656c 662e  int in zip(self.
-000180c0: 706f 696e 7473 2c20 6f74 6865 725f 2e70  points, other_.p
-000180d0: 6f69 6e74 7329 3a0a 2020 2020 2020 2020  oints):.        
-000180e0: 2020 2020 6571 7561 6c20 3d20 2865 7175      equal = (equ
-000180f0: 616c 2061 6e64 2070 6f69 6e74 203d 3d20  al and point == 
-00018100: 6f74 6865 725f 706f 696e 7429 0a20 2020  other_point).   
-00018110: 2020 2020 2072 6574 7572 6e20 6571 7561       return equa
-00018120: 6c0a 0a20 2020 2064 6566 2061 7265 6128  l..    def area(
-00018130: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
-00018140: 2054 4f44 4f3a 2070 6572 663a 2063 6163   TODO: perf: cac
-00018150: 6865 206e 756d 6265 7220 6f66 2070 6f69  he number of poi
-00018160: 6e74 730a 2020 2020 2020 2020 6966 206c  nts.        if l
-00018170: 656e 2873 656c 662e 706f 696e 7473 2920  en(self.points) 
-00018180: 3c20 333a 0a20 2020 2020 2020 2020 2020  < 3:.           
-00018190: 2072 6574 7572 6e20 302e 0a0a 2020 2020   return 0...    
-000181a0: 2020 2020 7820 3d20 5b70 6f69 6e74 2e78      x = [point.x
-000181b0: 2066 6f72 2070 6f69 6e74 2069 6e20 7365   for point in se
-000181c0: 6c66 2e70 6f69 6e74 735d 0a20 2020 2020  lf.points].     
-000181d0: 2020 2079 203d 205b 706f 696e 742e 7920     y = [point.y 
-000181e0: 666f 7220 706f 696e 7420 696e 2073 656c  for point in sel
-000181f0: 662e 706f 696e 7473 5d0a 0a20 2020 2020  f.points]..     
-00018200: 2020 2078 3120 3d20 5b78 5b2d 315d 5d20     x1 = [x[-1]] 
-00018210: 2b20 785b 303a 2d31 5d0a 2020 2020 2020  + x[0:-1].      
-00018220: 2020 7931 203d 205b 795b 2d31 5d5d 202b    y1 = [y[-1]] +
-00018230: 2079 5b30 3a2d 315d 0a20 2020 2020 2020   y[0:-1].       
-00018240: 2072 6574 7572 6e20 302e 3520 2a20 6162   return 0.5 * ab
-00018250: 7328 7375 6d28 6920 2a20 6a20 666f 7220  s(sum(i * j for 
-00018260: 692c 206a 2069 6e20 7a69 7028 782c 2079  i, j in zip(x, y
-00018270: 3129 290a 2020 2020 2020 2020 2020 2020  1)).            
-00018280: 2020 2020 2020 2020 2020 2020 202d 2073               - s
-00018290: 756d 2869 202a 206a 2066 6f72 2069 2c20  um(i * j for i, 
-000182a0: 6a20 696e 207a 6970 2879 2c20 7831 2929  j in zip(y, x1))
-000182b0: 290a 2020 2020 2020 2020 2320 7265 7475  ).        # retu
-000182c0: 726e 2030 2e35 202a 206e 7079 2e61 6273  rn 0.5 * npy.abs
-000182d0: 280a 2020 2020 2020 2020 2320 2020 2020  (.        #     
-000182e0: 6e70 792e 646f 7428 782c 206e 7079 2e72  npy.dot(x, npy.r
-000182f0: 6f6c 6c28 792c 2031 2929 202d 206e 7079  oll(y, 1)) - npy
-00018300: 2e64 6f74 2879 2c20 6e70 792e 726f 6c6c  .dot(y, npy.roll
-00018310: 2878 2c20 3129 2929 0a0a 2020 2020 6465  (x, 1)))..    de
-00018320: 6620 6365 6e74 6572 5f6f 665f 6d61 7373  f center_of_mass
-00018330: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00018340: 6c70 203d 206c 656e 2873 656c 662e 706f  lp = len(self.po
-00018350: 696e 7473 290a 2020 2020 2020 2020 6966  ints).        if
-00018360: 206c 7020 3d3d 2030 3a0a 2020 2020 2020   lp == 0:.      
-00018370: 2020 2020 2020 7265 7475 726e 2076 6f6c        return vol
-00018380: 6d64 6c72 2e4f 3244 0a20 2020 2020 2020  mdlr.O2D.       
-00018390: 2069 6620 6c70 203d 3d20 313a 0a20 2020   if lp == 1:.   
-000183a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000183b0: 7365 6c66 2e70 6f69 6e74 735b 305d 0a20  self.points[0]. 
-000183c0: 2020 2020 2020 2069 6620 6c70 203d 3d20         if lp == 
-000183d0: 323a 0a20 2020 2020 2020 2020 2020 2072  2:.            r
-000183e0: 6574 7572 6e20 302e 3520 2a20 2873 656c  eturn 0.5 * (sel
-000183f0: 662e 706f 696e 7473 5b30 5d20 2b20 7365  f.points[0] + se
-00018400: 6c66 2e70 6f69 6e74 735b 315d 290a 0a20  lf.points[1]).. 
-00018410: 2020 2020 2020 2078 203d 205b 706f 696e         x = [poin
-00018420: 742e 7820 666f 7220 706f 696e 7420 696e  t.x for point in
-00018430: 2073 656c 662e 706f 696e 7473 5d0a 2020   self.points].  
-00018440: 2020 2020 2020 7920 3d20 5b70 6f69 6e74        y = [point
-00018450: 2e79 2066 6f72 2070 6f69 6e74 2069 6e20  .y for point in 
-00018460: 7365 6c66 2e70 6f69 6e74 735d 0a0a 2020  self.points]..  
-00018470: 2020 2020 2020 7869 5f78 6931 203d 2078        xi_xi1 = x
-00018480: 202b 206e 7079 2e72 6f6c 6c28 782c 202d   + npy.roll(x, -
-00018490: 3129 0a20 2020 2020 2020 2079 695f 7969  1).        yi_yi
-000184a0: 3120 3d20 7920 2b20 6e70 792e 726f 6c6c  1 = y + npy.roll
-000184b0: 2879 2c20 2d31 290a 2020 2020 2020 2020  (y, -1).        
-000184c0: 7869 5f79 6931 203d 206e 7079 2e6d 756c  xi_yi1 = npy.mul
-000184d0: 7469 706c 7928 782c 206e 7079 2e72 6f6c  tiply(x, npy.rol
-000184e0: 6c28 792c 202d 3129 290a 2020 2020 2020  l(y, -1)).      
-000184f0: 2020 7869 315f 7969 203d 206e 7079 2e6d    xi1_yi = npy.m
-00018500: 756c 7469 706c 7928 6e70 792e 726f 6c6c  ultiply(npy.roll
-00018510: 2878 2c20 2d31 292c 2079 290a 0a20 2020  (x, -1), y)..   
-00018520: 2020 2020 2061 203d 2030 2e35 202a 206e       a = 0.5 * n
-00018530: 7079 2e73 756d 2878 695f 7969 3120 2d20  py.sum(xi_yi1 - 
-00018540: 7869 315f 7969 2920 2023 2073 6967 6e65  xi1_yi)  # signe
-00018550: 6420 6172 6561 210a 2020 2020 2020 2020  d area!.        
-00018560: 2320 7072 696e 7428 2761 203a 272c 2061  # print('a :', a
-00018570: 290a 2020 2020 2020 2020 2320 2020 2020  ).        #     
-00018580: 2020 2061 3d73 656c 662e 6172 6561 2829     a=self.area()
-00018590: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-000185a0: 6d61 7468 2e69 7363 6c6f 7365 2861 2c20  math.isclose(a, 
-000185b0: 302c 2061 6273 5f74 6f6c 3d31 652d 3038  0, abs_tol=1e-08
-000185c0: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
-000185d0: 7820 3d20 6e70 792e 7375 6d28 6e70 792e  x = npy.sum(npy.
-000185e0: 6d75 6c74 6970 6c79 2878 695f 7869 312c  multiply(xi_xi1,
-000185f0: 2028 7869 5f79 6931 202d 2078 6931 5f79   (xi_yi1 - xi1_y
-00018600: 6929 2929 202f 2036 2e20 2f20 610a 2020  i))) / 6. / a.  
-00018610: 2020 2020 2020 2020 2020 6379 203d 206e            cy = n
-00018620: 7079 2e73 756d 286e 7079 2e6d 756c 7469  py.sum(npy.multi
-00018630: 706c 7928 7969 5f79 6931 2c20 2878 695f  ply(yi_yi1, (xi_
-00018640: 7969 3120 2d20 7869 315f 7969 2929 2920  yi1 - xi1_yi))) 
-00018650: 2f20 362e 202f 2061 0a20 2020 2020 2020  / 6. / a.       
-00018660: 2020 2020 2072 6574 7572 6e20 766f 6c6d       return volm
-00018670: 646c 722e 506f 696e 7432 4428 6378 2c20  dlr.Point2D(cx, 
-00018680: 6379 290a 0a20 2020 2020 2020 2073 656c  cy)..        sel
-00018690: 662e 706c 6f74 2829 0a20 2020 2020 2020  f.plot().       
-000186a0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-000186b0: 656e 7465 6445 7272 6f72 0a0a 2020 2020  entedError..    
-000186c0: 6465 6620 6261 7279 6365 6e74 6572 2873  def barycenter(s
-000186d0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000186e0: 220a 2020 2020 2020 2020 4361 6c63 756c  ".        Calcul
-000186f0: 6174 6573 2074 6865 2067 656f 6d65 7472  ates the geometr
-00018700: 6963 2063 656e 7465 7220 6f66 2074 6865  ic center of the
-00018710: 2070 6f6c 7967 6f6e 2c20 7768 6963 6820   polygon, which 
-00018720: 6973 2074 6865 2061 7665 7261 6765 2070  is the average p
-00018730: 6f73 6974 696f 6e20 6f66 2061 6c6c 2074  osition of all t
-00018740: 6865 2070 6f69 6e74 7320 696e 2069 742e  he points in it.
-00018750: 0a0a 2020 2020 2020 2020 3a72 7479 7065  ..        :rtype
-00018760: 3a20 766f 6c6d 646c 722e 506f 696e 7432  : volmdlr.Point2
-00018770: 440a 2020 2020 2020 2020 2222 220a 2020  D.        """.  
-00018780: 2020 2020 2020 6261 7279 6365 6e74 6572        barycenter
-00018790: 315f 3264 203d 2073 656c 662e 706f 696e  1_2d = self.poin
-000187a0: 7473 5b30 5d0a 2020 2020 2020 2020 666f  ts[0].        fo
-000187b0: 7220 706f 696e 7420 696e 2073 656c 662e  r point in self.
-000187c0: 706f 696e 7473 5b31 3a5d 3a0a 2020 2020  points[1:]:.    
-000187d0: 2020 2020 2020 2020 6261 7279 6365 6e74          barycent
-000187e0: 6572 315f 3264 202b 3d20 706f 696e 740a  er1_2d += point.
-000187f0: 2020 2020 2020 2020 7265 7475 726e 2062          return b
-00018800: 6172 7963 656e 7465 7231 5f32 6420 2f20  arycenter1_2d / 
-00018810: 6c65 6e28 7365 6c66 2e70 6f69 6e74 7329  len(self.points)
-00018820: 0a0a 2020 2020 6465 6620 706f 696e 745f  ..    def point_
-00018830: 6265 6c6f 6e67 7328 7365 6c66 2c20 706f  belongs(self, po
-00018840: 696e 742c 2069 6e63 6c75 6465 5f65 6467  int, include_edg
-00018850: 655f 706f 696e 7473 3a20 626f 6f6c 203d  e_points: bool =
-00018860: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
-00018870: 2022 2222 0a20 2020 2020 2020 2052 6179   """.        Ray
-00018880: 2063 6173 7469 6e67 2061 6c67 6f72 6974   casting algorit
-00018890: 686d 2063 6f70 6965 6420 6672 6f6d 2069  hm copied from i
-000188a0: 6e74 6572 6e65 742e 0a20 2020 2020 2020  nternet..       
-000188b0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-000188c0: 7572 6e20 706f 6c79 676f 6e5f 706f 696e  urn polygon_poin
-000188d0: 745f 6265 6c6f 6e67 7328 2870 6f69 6e74  t_belongs((point
-000188e0: 2e78 2c20 706f 696e 742e 7929 2c0a 2020  .x, point.y),.  
-000188f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017e70: 2020 2762 6173 6973 5f70 7269 6d69 7469    'basis_primiti
+00017e80: 7665 7327 5d0a 0a20 2020 2064 6566 205f  ves']..    def _
+00017e90: 5f69 6e69 745f 5f28 7365 6c66 2c20 706f  _init__(self, po
+00017ea0: 696e 7473 3a20 4c69 7374 5b76 6f6c 6d64  ints: List[volmd
+00017eb0: 6c72 2e50 6f69 6e74 3244 5d2c 206e 616d  lr.Point2D], nam
+00017ec0: 653a 2073 7472 203d 2027 2729 3a0a 2020  e: str = ''):.  
+00017ed0: 2020 2020 2020 7365 6c66 2e70 6f69 6e74        self.point
+00017ee0: 7320 3d20 706f 696e 7473 0a20 2020 2020  s = points.     
+00017ef0: 2020 2073 656c 662e 5f6c 696e 655f 7365     self._line_se
+00017f00: 676d 656e 7473 203d 204e 6f6e 650a 0a20  gments = None.. 
+00017f10: 2020 2020 2020 2043 6f6e 746f 7572 3244         Contour2D
+00017f20: 2e5f 5f69 6e69 745f 5f28 7365 6c66 2c20  .__init__(self, 
+00017f30: 7365 6c66 2e6c 696e 655f 7365 676d 656e  self.line_segmen
+00017f40: 7473 2c20 6e61 6d65 290a 0a20 2020 2064  ts, name)..    d
+00017f50: 6566 2063 6f70 7928 7365 6c66 2c20 2a61  ef copy(self, *a
+00017f60: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+00017f70: 2020 2020 2020 2020 706f 696e 7473 203d          points =
+00017f80: 205b 702e 636f 7079 2829 2066 6f72 2070   [p.copy() for p
+00017f90: 2069 6e20 7365 6c66 2e70 6f69 6e74 735d   in self.points]
+00017fa0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00017fb0: 436c 6f73 6564 506f 6c79 676f 6e32 4428  ClosedPolygon2D(
+00017fc0: 706f 696e 7473 2c20 7365 6c66 2e6e 616d  points, self.nam
+00017fd0: 6529 0a0a 2020 2020 6465 6620 5f5f 6861  e)..    def __ha
+00017fe0: 7368 5f5f 2873 656c 6629 3a0a 2020 2020  sh__(self):.    
+00017ff0: 2020 2020 7265 7475 726e 2073 756d 2868      return sum(h
+00018000: 6173 6828 7029 2066 6f72 2070 2069 6e20  ash(p) for p in 
+00018010: 7365 6c66 2e70 6f69 6e74 7329 0a0a 2020  self.points)..  
+00018020: 2020 6465 6620 5f5f 6571 5f5f 2873 656c    def __eq__(sel
+00018030: 662c 206f 7468 6572 5f29 3a0a 2020 2020  f, other_):.    
+00018040: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00018050: 7461 6e63 6528 6f74 6865 725f 2c20 7365  tance(other_, se
+00018060: 6c66 2e5f 5f63 6c61 7373 5f5f 293a 0a20  lf.__class__):. 
+00018070: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00018080: 6e20 4661 6c73 650a 2020 2020 2020 2020  n False.        
+00018090: 6571 7561 6c20 3d20 5472 7565 0a20 2020  equal = True.   
+000180a0: 2020 2020 2066 6f72 2070 6f69 6e74 2c20       for point, 
+000180b0: 6f74 6865 725f 706f 696e 7420 696e 207a  other_point in z
+000180c0: 6970 2873 656c 662e 706f 696e 7473 2c20  ip(self.points, 
+000180d0: 6f74 6865 725f 2e70 6f69 6e74 7329 3a0a  other_.points):.
+000180e0: 2020 2020 2020 2020 2020 2020 6571 7561              equa
+000180f0: 6c20 3d20 2865 7175 616c 2061 6e64 2070  l = (equal and p
+00018100: 6f69 6e74 203d 3d20 6f74 6865 725f 706f  oint == other_po
+00018110: 696e 7429 0a20 2020 2020 2020 2072 6574  int).        ret
+00018120: 7572 6e20 6571 7561 6c0a 0a20 2020 2064  urn equal..    d
+00018130: 6566 2061 7265 6128 7365 6c66 293a 0a20  ef area(self):. 
+00018140: 2020 2020 2020 2023 2054 4f44 4f3a 2070         # TODO: p
+00018150: 6572 663a 2063 6163 6865 206e 756d 6265  erf: cache numbe
+00018160: 7220 6f66 2070 6f69 6e74 730a 2020 2020  r of points.    
+00018170: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
+00018180: 706f 696e 7473 2920 3c20 333a 0a20 2020  points) < 3:.   
+00018190: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000181a0: 302e 0a0a 2020 2020 2020 2020 7820 3d20  0...        x = 
+000181b0: 5b70 6f69 6e74 2e78 2066 6f72 2070 6f69  [point.x for poi
+000181c0: 6e74 2069 6e20 7365 6c66 2e70 6f69 6e74  nt in self.point
+000181d0: 735d 0a20 2020 2020 2020 2079 203d 205b  s].        y = [
+000181e0: 706f 696e 742e 7920 666f 7220 706f 696e  point.y for poin
+000181f0: 7420 696e 2073 656c 662e 706f 696e 7473  t in self.points
+00018200: 5d0a 0a20 2020 2020 2020 2078 3120 3d20  ]..        x1 = 
+00018210: 5b78 5b2d 315d 5d20 2b20 785b 303a 2d31  [x[-1]] + x[0:-1
+00018220: 5d0a 2020 2020 2020 2020 7931 203d 205b  ].        y1 = [
+00018230: 795b 2d31 5d5d 202b 2079 5b30 3a2d 315d  y[-1]] + y[0:-1]
+00018240: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00018250: 302e 3520 2a20 6162 7328 7375 6d28 6920  0.5 * abs(sum(i 
+00018260: 2a20 6a20 666f 7220 692c 206a 2069 6e20  * j for i, j in 
+00018270: 7a69 7028 782c 2079 3129 290a 2020 2020  zip(x, y1)).    
+00018280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018290: 2020 2020 202d 2073 756d 2869 202a 206a       - sum(i * j
+000182a0: 2066 6f72 2069 2c20 6a20 696e 207a 6970   for i, j in zip
+000182b0: 2879 2c20 7831 2929 290a 2020 2020 2020  (y, x1))).      
+000182c0: 2020 2320 7265 7475 726e 2030 2e35 202a    # return 0.5 *
+000182d0: 206e 7079 2e61 6273 280a 2020 2020 2020   npy.abs(.      
+000182e0: 2020 2320 2020 2020 6e70 792e 646f 7428    #     npy.dot(
+000182f0: 782c 206e 7079 2e72 6f6c 6c28 792c 2031  x, npy.roll(y, 1
+00018300: 2929 202d 206e 7079 2e64 6f74 2879 2c20  )) - npy.dot(y, 
+00018310: 6e70 792e 726f 6c6c 2878 2c20 3129 2929  npy.roll(x, 1)))
+00018320: 0a0a 2020 2020 6465 6620 6365 6e74 6572  ..    def center
+00018330: 5f6f 665f 6d61 7373 2873 656c 6629 3a0a  _of_mass(self):.
+00018340: 2020 2020 2020 2020 6c70 203d 206c 656e          lp = len
+00018350: 2873 656c 662e 706f 696e 7473 290a 2020  (self.points).  
+00018360: 2020 2020 2020 6966 206c 7020 3d3d 2030        if lp == 0
+00018370: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00018380: 7475 726e 2076 6f6c 6d64 6c72 2e4f 3244  turn volmdlr.O2D
+00018390: 0a20 2020 2020 2020 2069 6620 6c70 203d  .        if lp =
+000183a0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+000183b0: 2072 6574 7572 6e20 7365 6c66 2e70 6f69   return self.poi
+000183c0: 6e74 735b 305d 0a20 2020 2020 2020 2069  nts[0].        i
+000183d0: 6620 6c70 203d 3d20 323a 0a20 2020 2020  f lp == 2:.     
+000183e0: 2020 2020 2020 2072 6574 7572 6e20 302e         return 0.
+000183f0: 3520 2a20 2873 656c 662e 706f 696e 7473  5 * (self.points
+00018400: 5b30 5d20 2b20 7365 6c66 2e70 6f69 6e74  [0] + self.point
+00018410: 735b 315d 290a 0a20 2020 2020 2020 2078  s[1])..        x
+00018420: 203d 205b 706f 696e 742e 7820 666f 7220   = [point.x for 
+00018430: 706f 696e 7420 696e 2073 656c 662e 706f  point in self.po
+00018440: 696e 7473 5d0a 2020 2020 2020 2020 7920  ints].        y 
+00018450: 3d20 5b70 6f69 6e74 2e79 2066 6f72 2070  = [point.y for p
+00018460: 6f69 6e74 2069 6e20 7365 6c66 2e70 6f69  oint in self.poi
+00018470: 6e74 735d 0a0a 2020 2020 2020 2020 7869  nts]..        xi
+00018480: 5f78 6931 203d 2078 202b 206e 7079 2e72  _xi1 = x + npy.r
+00018490: 6f6c 6c28 782c 202d 3129 0a20 2020 2020  oll(x, -1).     
+000184a0: 2020 2079 695f 7969 3120 3d20 7920 2b20     yi_yi1 = y + 
+000184b0: 6e70 792e 726f 6c6c 2879 2c20 2d31 290a  npy.roll(y, -1).
+000184c0: 2020 2020 2020 2020 7869 5f79 6931 203d          xi_yi1 =
+000184d0: 206e 7079 2e6d 756c 7469 706c 7928 782c   npy.multiply(x,
+000184e0: 206e 7079 2e72 6f6c 6c28 792c 202d 3129   npy.roll(y, -1)
+000184f0: 290a 2020 2020 2020 2020 7869 315f 7969  ).        xi1_yi
+00018500: 203d 206e 7079 2e6d 756c 7469 706c 7928   = npy.multiply(
+00018510: 6e70 792e 726f 6c6c 2878 2c20 2d31 292c  npy.roll(x, -1),
+00018520: 2079 290a 0a20 2020 2020 2020 2061 203d   y)..        a =
+00018530: 2030 2e35 202a 206e 7079 2e73 756d 2878   0.5 * npy.sum(x
+00018540: 695f 7969 3120 2d20 7869 315f 7969 2920  i_yi1 - xi1_yi) 
+00018550: 2023 2073 6967 6e65 6420 6172 6561 210a   # signed area!.
+00018560: 2020 2020 2020 2020 2320 7072 696e 7428          # print(
+00018570: 2761 203a 272c 2061 290a 2020 2020 2020  'a :', a).      
+00018580: 2020 2320 2020 2020 2020 2061 3d73 656c    #        a=sel
+00018590: 662e 6172 6561 2829 0a20 2020 2020 2020  f.area().       
+000185a0: 2069 6620 6e6f 7420 6d61 7468 2e69 7363   if not math.isc
+000185b0: 6c6f 7365 2861 2c20 302c 2061 6273 5f74  lose(a, 0, abs_t
+000185c0: 6f6c 3d31 652d 3038 293a 0a20 2020 2020  ol=1e-08):.     
+000185d0: 2020 2020 2020 2063 7820 3d20 6e70 792e         cx = npy.
+000185e0: 7375 6d28 6e70 792e 6d75 6c74 6970 6c79  sum(npy.multiply
+000185f0: 2878 695f 7869 312c 2028 7869 5f79 6931  (xi_xi1, (xi_yi1
+00018600: 202d 2078 6931 5f79 6929 2929 202f 2036   - xi1_yi))) / 6
+00018610: 2e20 2f20 610a 2020 2020 2020 2020 2020  . / a.          
+00018620: 2020 6379 203d 206e 7079 2e73 756d 286e    cy = npy.sum(n
+00018630: 7079 2e6d 756c 7469 706c 7928 7969 5f79  py.multiply(yi_y
+00018640: 6931 2c20 2878 695f 7969 3120 2d20 7869  i1, (xi_yi1 - xi
+00018650: 315f 7969 2929 2920 2f20 362e 202f 2061  1_yi))) / 6. / a
+00018660: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00018670: 7572 6e20 766f 6c6d 646c 722e 506f 696e  urn volmdlr.Poin
+00018680: 7432 4428 6378 2c20 6379 290a 0a20 2020  t2D(cx, cy)..   
+00018690: 2020 2020 2073 656c 662e 706c 6f74 2829       self.plot()
+000186a0: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
+000186b0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+000186c0: 6f72 0a0a 2020 2020 6465 6620 6261 7279  or..    def bary
+000186d0: 6365 6e74 6572 2873 656c 6629 3a0a 2020  center(self):.  
+000186e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000186f0: 2020 4361 6c63 756c 6174 6573 2074 6865    Calculates the
+00018700: 2067 656f 6d65 7472 6963 2063 656e 7465   geometric cente
+00018710: 7220 6f66 2074 6865 2070 6f6c 7967 6f6e  r of the polygon
+00018720: 2c20 7768 6963 6820 6973 2074 6865 2061  , which is the a
+00018730: 7665 7261 6765 2070 6f73 6974 696f 6e20  verage position 
+00018740: 6f66 2061 6c6c 2074 6865 2070 6f69 6e74  of all the point
+00018750: 7320 696e 2069 742e 0a0a 2020 2020 2020  s in it...      
+00018760: 2020 3a72 7479 7065 3a20 766f 6c6d 646c    :rtype: volmdl
+00018770: 722e 506f 696e 7432 440a 2020 2020 2020  r.Point2D.      
+00018780: 2020 2222 220a 2020 2020 2020 2020 6261    """.        ba
+00018790: 7279 6365 6e74 6572 315f 3264 203d 2073  rycenter1_2d = s
+000187a0: 656c 662e 706f 696e 7473 5b30 5d0a 2020  elf.points[0].  
+000187b0: 2020 2020 2020 666f 7220 706f 696e 7420        for point 
+000187c0: 696e 2073 656c 662e 706f 696e 7473 5b31  in self.points[1
+000187d0: 3a5d 3a0a 2020 2020 2020 2020 2020 2020  :]:.            
+000187e0: 6261 7279 6365 6e74 6572 315f 3264 202b  barycenter1_2d +
+000187f0: 3d20 706f 696e 740a 2020 2020 2020 2020  = point.        
+00018800: 7265 7475 726e 2062 6172 7963 656e 7465  return barycente
+00018810: 7231 5f32 6420 2f20 6c65 6e28 7365 6c66  r1_2d / len(self
+00018820: 2e70 6f69 6e74 7329 0a0a 2020 2020 6465  .points)..    de
+00018830: 6620 706f 696e 745f 6265 6c6f 6e67 7328  f point_belongs(
+00018840: 7365 6c66 2c20 706f 696e 742c 2069 6e63  self, point, inc
+00018850: 6c75 6465 5f65 6467 655f 706f 696e 7473  lude_edge_points
+00018860: 3a20 626f 6f6c 203d 2046 616c 7365 293a  : bool = False):
+00018870: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00018880: 2020 2020 2052 6179 2063 6173 7469 6e67       Ray casting
+00018890: 2061 6c67 6f72 6974 686d 2063 6f70 6965   algorithm copie
+000188a0: 6420 6672 6f6d 2069 6e74 6572 6e65 742e  d from internet.
+000188b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000188c0: 2020 2020 2072 6574 7572 6e20 706f 6c79       return poly
+000188d0: 676f 6e5f 706f 696e 745f 6265 6c6f 6e67  gon_point_belong
+000188e0: 7328 2870 6f69 6e74 2e78 2c20 706f 696e  s((point.x, poin
+000188f0: 742e 7929 2c0a 2020 2020 2020 2020 2020  t.y),.          
 00018900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018910: 2020 205b 2870 2e78 2c20 702e 7929 2066     [(p.x, p.y) f
-00018920: 6f72 2070 2069 6e20 7365 6c66 2e70 6f69  or p in self.poi
-00018930: 6e74 735d 2c20 696e 636c 7564 655f 6564  nts], include_ed
-00018940: 6765 5f70 6f69 6e74 733d 696e 636c 7564  ge_points=includ
-00018950: 655f 6564 6765 5f70 6f69 6e74 7329 0a0a  e_edge_points)..
-00018960: 2020 2020 6465 6620 7365 636f 6e64 5f6d      def second_m
-00018970: 6f6d 656e 745f 6172 6561 2873 656c 662c  oment_area(self,
-00018980: 2070 6f69 6e74 293a 0a20 2020 2020 2020   point):.       
-00018990: 2049 782c 2049 792c 2049 7879 203d 2030   Ix, Iy, Ixy = 0
-000189a0: 2e2c 2030 2e2c 2030 2e0a 2020 2020 2020  ., 0., 0..      
-000189b0: 2020 666f 7220 7069 2c20 706a 2069 6e20    for pi, pj in 
-000189c0: 7a69 7028 7365 6c66 2e70 6f69 6e74 732c  zip(self.points,
-000189d0: 2073 656c 662e 706f 696e 7473 5b31 3a5d   self.points[1:]
-000189e0: 202b 205b 7365 6c66 2e70 6f69 6e74 735b   + [self.points[
-000189f0: 305d 5d29 3a0a 2020 2020 2020 2020 2020  0]]):.          
-00018a00: 2020 7869 2c20 7969 203d 2070 6920 2d20    xi, yi = pi - 
-00018a10: 706f 696e 740a 2020 2020 2020 2020 2020  point.          
-00018a20: 2020 786a 2c20 796a 203d 2070 6a20 2d20    xj, yj = pj - 
-00018a30: 706f 696e 740a 2020 2020 2020 2020 2020  point.          
-00018a40: 2020 4978 202b 3d20 2879 6920 2a2a 2032    Ix += (yi ** 2
-00018a50: 202b 2079 6920 2a20 796a 202b 2079 6a20   + yi * yj + yj 
-00018a60: 2a2a 2032 2920 2a20 2878 6920 2a20 796a  ** 2) * (xi * yj
-00018a70: 202d 2078 6a20 2a20 7969 290a 2020 2020   - xj * yi).    
-00018a80: 2020 2020 2020 2020 4979 202b 3d20 2878          Iy += (x
-00018a90: 6920 2a2a 2032 202b 2078 6920 2a20 786a  i ** 2 + xi * xj
-00018aa0: 202b 2078 6a20 2a2a 2032 2920 2a20 2878   + xj ** 2) * (x
-00018ab0: 6920 2a20 796a 202d 2078 6a20 2a20 7969  i * yj - xj * yi
-00018ac0: 290a 2020 2020 2020 2020 2020 2020 4978  ).            Ix
-00018ad0: 7920 2b3d 2028 7869 202a 2079 6a20 2b20  y += (xi * yj + 
-00018ae0: 3220 2a20 7869 202a 2079 6920 2b20 3220  2 * xi * yi + 2 
-00018af0: 2a20 786a 202a 2079 6a20 2b20 786a 202a  * xj * yj + xj *
-00018b00: 2079 6929 202a 2028 0a20 2020 2020 2020   yi) * (.       
-00018b10: 2020 2020 2020 2020 2020 2020 2078 6920               xi 
-00018b20: 2a20 796a 202d 2078 6a20 2a20 7969 290a  * yj - xj * yi).
-00018b30: 2020 2020 2020 2020 6966 2049 7820 3c20          if Ix < 
-00018b40: 303a 0a20 2020 2020 2020 2020 2020 2049  0:.            I
-00018b50: 7820 3d20 2d20 4978 0a20 2020 2020 2020  x = - Ix.       
-00018b60: 2020 2020 2049 7920 3d20 2d20 4979 0a20       Iy = - Iy. 
-00018b70: 2020 2020 2020 2020 2020 2049 7879 203d             Ixy =
-00018b80: 202d 2049 7879 0a20 2020 2020 2020 2072   - Ixy.        r
-00018b90: 6574 7572 6e20 4978 202f 2031 322e 2c20  eturn Ix / 12., 
-00018ba0: 4979 202f 2031 322e 2c20 4978 7920 2f20  Iy / 12., Ixy / 
-00018bb0: 3234 2e0a 0a20 2020 2064 6566 2067 6574  24...    def get
-00018bc0: 5f6c 696e 655f 7365 676d 656e 7473 2873  _line_segments(s
-00018bd0: 656c 6629 3a0a 2020 2020 2020 2020 6c69  elf):.        li
-00018be0: 6e65 7320 3d20 5b5d 0a20 2020 2020 2020  nes = [].       
-00018bf0: 2069 6620 6c65 6e28 7365 6c66 2e70 6f69   if len(self.poi
-00018c00: 6e74 7329 203e 2031 3a0a 2020 2020 2020  nts) > 1:.      
-00018c10: 2020 2020 2020 666f 7220 7031 2c20 7032        for p1, p2
-00018c20: 2069 6e20 7a69 7028 7365 6c66 2e70 6f69   in zip(self.poi
-00018c30: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
+00018910: 2020 2020 2020 2020 2020 205b 2870 2e78             [(p.x
+00018920: 2c20 702e 7929 2066 6f72 2070 2069 6e20  , p.y) for p in 
+00018930: 7365 6c66 2e70 6f69 6e74 735d 2c20 696e  self.points], in
+00018940: 636c 7564 655f 6564 6765 5f70 6f69 6e74  clude_edge_point
+00018950: 733d 696e 636c 7564 655f 6564 6765 5f70  s=include_edge_p
+00018960: 6f69 6e74 7329 0a0a 2020 2020 6465 6620  oints)..    def 
+00018970: 7365 636f 6e64 5f6d 6f6d 656e 745f 6172  second_moment_ar
+00018980: 6561 2873 656c 662c 2070 6f69 6e74 293a  ea(self, point):
+00018990: 0a20 2020 2020 2020 2049 782c 2049 792c  .        Ix, Iy,
+000189a0: 2049 7879 203d 2030 2e2c 2030 2e2c 2030   Ixy = 0., 0., 0
+000189b0: 2e0a 2020 2020 2020 2020 666f 7220 7069  ..        for pi
+000189c0: 2c20 706a 2069 6e20 7a69 7028 7365 6c66  , pj in zip(self
+000189d0: 2e70 6f69 6e74 732c 2073 656c 662e 706f  .points, self.po
+000189e0: 696e 7473 5b31 3a5d 202b 205b 7365 6c66  ints[1:] + [self
+000189f0: 2e70 6f69 6e74 735b 305d 5d29 3a0a 2020  .points[0]]):.  
+00018a00: 2020 2020 2020 2020 2020 7869 2c20 7969            xi, yi
+00018a10: 203d 2070 6920 2d20 706f 696e 740a 2020   = pi - point.  
+00018a20: 2020 2020 2020 2020 2020 786a 2c20 796a            xj, yj
+00018a30: 203d 2070 6a20 2d20 706f 696e 740a 2020   = pj - point.  
+00018a40: 2020 2020 2020 2020 2020 4978 202b 3d20            Ix += 
+00018a50: 2879 6920 2a2a 2032 202b 2079 6920 2a20  (yi ** 2 + yi * 
+00018a60: 796a 202b 2079 6a20 2a2a 2032 2920 2a20  yj + yj ** 2) * 
+00018a70: 2878 6920 2a20 796a 202d 2078 6a20 2a20  (xi * yj - xj * 
+00018a80: 7969 290a 2020 2020 2020 2020 2020 2020  yi).            
+00018a90: 4979 202b 3d20 2878 6920 2a2a 2032 202b  Iy += (xi ** 2 +
+00018aa0: 2078 6920 2a20 786a 202b 2078 6a20 2a2a   xi * xj + xj **
+00018ab0: 2032 2920 2a20 2878 6920 2a20 796a 202d   2) * (xi * yj -
+00018ac0: 2078 6a20 2a20 7969 290a 2020 2020 2020   xj * yi).      
+00018ad0: 2020 2020 2020 4978 7920 2b3d 2028 7869        Ixy += (xi
+00018ae0: 202a 2079 6a20 2b20 3220 2a20 7869 202a   * yj + 2 * xi *
+00018af0: 2079 6920 2b20 3220 2a20 786a 202a 2079   yi + 2 * xj * y
+00018b00: 6a20 2b20 786a 202a 2079 6929 202a 2028  j + xj * yi) * (
+00018b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018b20: 2020 2020 2078 6920 2a20 796a 202d 2078       xi * yj - x
+00018b30: 6a20 2a20 7969 290a 2020 2020 2020 2020  j * yi).        
+00018b40: 6966 2049 7820 3c20 303a 0a20 2020 2020  if Ix < 0:.     
+00018b50: 2020 2020 2020 2049 7820 3d20 2d20 4978         Ix = - Ix
+00018b60: 0a20 2020 2020 2020 2020 2020 2049 7920  .            Iy 
+00018b70: 3d20 2d20 4979 0a20 2020 2020 2020 2020  = - Iy.         
+00018b80: 2020 2049 7879 203d 202d 2049 7879 0a20     Ixy = - Ixy. 
+00018b90: 2020 2020 2020 2072 6574 7572 6e20 4978         return Ix
+00018ba0: 202f 2031 322e 2c20 4979 202f 2031 322e   / 12., Iy / 12.
+00018bb0: 2c20 4978 7920 2f20 3234 2e0a 0a20 2020  , Ixy / 24...   
+00018bc0: 2064 6566 2067 6574 5f6c 696e 655f 7365   def get_line_se
+00018bd0: 676d 656e 7473 2873 656c 6629 3a0a 2020  gments(self):.  
+00018be0: 2020 2020 2020 6c69 6e65 7320 3d20 5b5d        lines = []
+00018bf0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00018c00: 7365 6c66 2e70 6f69 6e74 7329 203e 2031  self.points) > 1
+00018c10: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+00018c20: 7220 7031 2c20 7032 2069 6e20 7a69 7028  r p1, p2 in zip(
+00018c30: 7365 6c66 2e70 6f69 6e74 732c 0a20 2020  self.points,.   
 00018c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018c50: 2020 206c 6973 7428 7365 6c66 2e70 6f69     list(self.poi
-00018c60: 6e74 735b 313a 5d29 202b 205b 7365 6c66  nts[1:]) + [self
-00018c70: 2e70 6f69 6e74 735b 305d 5d29 3a0a 2020  .points[0]]):.  
-00018c80: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00018c90: 2070 3120 213d 2070 323a 0a20 2020 2020   p1 != p2:.     
-00018ca0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00018cb0: 696e 6573 2e61 7070 656e 6428 766f 6c6d  ines.append(volm
-00018cc0: 646c 722e 6564 6765 732e 4c69 6e65 5365  dlr.edges.LineSe
-00018cd0: 676d 656e 7432 4428 7031 2c20 7032 2929  gment2D(p1, p2))
-00018ce0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00018cf0: 6c69 6e65 730a 0a20 2020 2064 6566 2072  lines..    def r
-00018d00: 6f74 6174 696f 6e28 7365 6c66 2c20 6365  otation(self, ce
-00018d10: 6e74 6572 3a20 766f 6c6d 646c 722e 506f  nter: volmdlr.Po
-00018d20: 696e 7432 442c 2061 6e67 6c65 3a20 666c  int2D, angle: fl
-00018d30: 6f61 7429 3a0a 2020 2020 2020 2020 2222  oat):.        ""
-00018d40: 220a 2020 2020 2020 2020 436c 6f73 6564  ".        Closed
-00018d50: 506f 6c79 676f 6e32 4420 726f 7461 7469  Polygon2D rotati
-00018d60: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
-00018d70: 7261 6d20 6365 6e74 6572 3a20 726f 7461  ram center: rota
-00018d80: 7469 6f6e 2063 656e 7465 720a 2020 2020  tion center.    
-00018d90: 2020 2020 3a70 6172 616d 2061 6e67 6c65      :param angle
-00018da0: 3a20 616e 676c 6520 726f 7461 7469 6f6e  : angle rotation
-00018db0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00018dc0: 3a20 6120 6e65 7720 726f 7461 7465 6420  : a new rotated 
-00018dd0: 436c 6f73 6564 506f 6c79 676f 6e32 440a  ClosedPolygon2D.
-00018de0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00018df0: 2020 2020 7265 7475 726e 2043 6c6f 7365      return Close
-00018e00: 6450 6f6c 7967 6f6e 3244 280a 2020 2020  dPolygon2D(.    
-00018e10: 2020 2020 2020 2020 5b70 6f69 6e74 2e72          [point.r
-00018e20: 6f74 6174 696f 6e28 6365 6e74 6572 2c20  otation(center, 
-00018e30: 616e 676c 6529 2066 6f72 2070 6f69 6e74  angle) for point
-00018e40: 2069 6e20 7365 6c66 2e70 6f69 6e74 735d   in self.points]
-00018e50: 290a 0a20 2020 2064 6566 2072 6f74 6174  )..    def rotat
-00018e60: 696f 6e5f 696e 706c 6163 6528 7365 6c66  ion_inplace(self
-00018e70: 2c20 6365 6e74 6572 3a20 766f 6c6d 646c  , center: volmdl
-00018e80: 722e 506f 696e 7432 442c 2061 6e67 6c65  r.Point2D, angle
-00018e90: 3a20 666c 6f61 7429 3a0a 2020 2020 2020  : float):.      
-00018ea0: 2020 2222 220a 2020 2020 2020 2020 4c69    """.        Li
-00018eb0: 6e65 3244 2072 6f74 6174 696f 6e2c 204f  ne2D rotation, O
-00018ec0: 626a 6563 7420 6973 2075 7064 6174 6564  bject is updated
-00018ed0: 2069 6e70 6c61 6365 2e0a 0a20 2020 2020   inplace...     
-00018ee0: 2020 203a 7061 7261 6d20 6365 6e74 6572     :param center
-00018ef0: 3a20 726f 7461 7469 6f6e 2063 656e 7465  : rotation cente
-00018f00: 720a 2020 2020 2020 2020 3a70 6172 616d  r.        :param
-00018f10: 2061 6e67 6c65 3a20 726f 7461 7469 6f6e   angle: rotation
-00018f20: 2061 6e67 6c65 0a20 2020 2020 2020 2022   angle.        "
-00018f30: 2222 0a20 2020 2020 2020 2077 6172 6e69  "".        warni
-00018f40: 6e67 732e 7761 726e 2822 2769 6e70 6c61  ngs.warn("'inpla
-00018f50: 6365 2720 6d65 7468 6f64 7320 6172 6520  ce' methods are 
-00018f60: 6465 7072 6563 6174 6564 2e20 5573 6520  deprecated. Use 
-00018f70: 6120 6e6f 7420 696e 706c 6163 6520 6d65  a not inplace me
-00018f80: 7468 6f64 2069 6e73 7465 6164 2e22 2c20  thod instead.", 
-00018f90: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
-00018fa0: 6e67 290a 0a20 2020 2020 2020 2066 6f72  ng)..        for
-00018fb0: 2070 6f69 6e74 2069 6e20 7365 6c66 2e70   point in self.p
-00018fc0: 6f69 6e74 733a 0a20 2020 2020 2020 2020  oints:.         
-00018fd0: 2020 2070 6f69 6e74 2e72 6f74 6174 696f     point.rotatio
-00018fe0: 6e5f 696e 706c 6163 6528 6365 6e74 6572  n_inplace(center
-00018ff0: 2c20 616e 676c 6529 0a0a 2020 2020 6465  , angle)..    de
-00019000: 6620 7472 616e 736c 6174 696f 6e28 7365  f translation(se
-00019010: 6c66 2c20 6f66 6673 6574 3a20 766f 6c6d  lf, offset: volm
-00019020: 646c 722e 5665 6374 6f72 3244 293a 0a20  dlr.Vector2D):. 
-00019030: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00019040: 2020 2043 6c6f 7365 6450 6f6c 7967 6f6e     ClosedPolygon
-00019050: 3244 2074 7261 6e73 6c61 7469 6f6e 2e0a  2D translation..
-00019060: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00019070: 6f66 6673 6574 3a20 7472 616e 736c 6174  offset: translat
-00019080: 696f 6e20 7665 6374 6f72 0a20 2020 2020  ion vector.     
-00019090: 2020 203a 7265 7475 726e 3a20 4120 6e65     :return: A ne
-000190a0: 7720 7472 616e 736c 6174 6564 2043 6c6f  w translated Clo
-000190b0: 7365 6450 6f6c 7967 6f6e 3244 0a20 2020  sedPolygon2D.   
-000190c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000190d0: 2072 6574 7572 6e20 436c 6f73 6564 506f   return ClosedPo
-000190e0: 6c79 676f 6e32 4428 0a20 2020 2020 2020  lygon2D(.       
-000190f0: 2020 2020 205b 706f 696e 742e 7472 616e       [point.tran
-00019100: 736c 6174 696f 6e28 6f66 6673 6574 2920  slation(offset) 
-00019110: 666f 7220 706f 696e 7420 696e 2073 656c  for point in sel
-00019120: 662e 706f 696e 7473 5d29 0a0a 2020 2020  f.points])..    
-00019130: 6465 6620 7472 616e 736c 6174 696f 6e5f  def translation_
-00019140: 696e 706c 6163 6528 7365 6c66 2c20 6f66  inplace(self, of
-00019150: 6673 6574 3a20 766f 6c6d 646c 722e 5665  fset: volmdlr.Ve
-00019160: 6374 6f72 3244 293a 0a20 2020 2020 2020  ctor2D):.       
-00019170: 2022 2222 0a20 2020 2020 2020 2043 6c6f   """.        Clo
-00019180: 7365 6450 6f6c 7967 6f6e 3244 2074 7261  sedPolygon2D tra
-00019190: 6e73 6c61 7469 6f6e 2e20 4f62 6a65 6374  nslation. Object
-000191a0: 2069 7320 7570 6461 7465 6420 696e 706c   is updated inpl
-000191b0: 6163 652e 0a0a 2020 2020 2020 2020 3a70  ace...        :p
-000191c0: 6172 616d 206f 6666 7365 743a 2074 7261  aram offset: tra
-000191d0: 6e73 6c61 7469 6f6e 2076 6563 746f 720a  nslation vector.
-000191e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000191f0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00019200: 6e28 2227 696e 706c 6163 6527 206d 6574  n("'inplace' met
-00019210: 686f 6473 2061 7265 2064 6570 7265 6361  hods are depreca
-00019220: 7465 642e 2055 7365 2061 206e 6f74 2069  ted. Use a not i
-00019230: 6e70 6c61 6365 206d 6574 686f 6420 696e  nplace method in
-00019240: 7374 6561 642e 222c 2044 6570 7265 6361  stead.", Depreca
-00019250: 7469 6f6e 5761 726e 696e 6729 0a0a 2020  tionWarning)..  
-00019260: 2020 2020 2020 666f 7220 706f 696e 7420        for point 
-00019270: 696e 2073 656c 662e 706f 696e 7473 3a0a  in self.points:.
-00019280: 2020 2020 2020 2020 2020 2020 706f 696e              poin
-00019290: 742e 7472 616e 736c 6174 696f 6e5f 696e  t.translation_in
-000192a0: 706c 6163 6528 6f66 6673 6574 290a 0a20  place(offset).. 
-000192b0: 2020 2064 6566 2066 7261 6d65 5f6d 6170     def frame_map
-000192c0: 7069 6e67 2873 656c 662c 2066 7261 6d65  ping(self, frame
-000192d0: 3a20 766f 6c6d 646c 722e 4672 616d 6532  : volmdlr.Frame2
-000192e0: 442c 2073 6964 653a 2073 7472 293a 0a20  D, side: str):. 
-000192f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00019300: 6c66 2e5f 5f63 6c61 7373 5f5f 285b 706f  lf.__class__([po
-00019310: 696e 742e 6672 616d 655f 6d61 7070 696e  int.frame_mappin
-00019320: 6728 6672 616d 652c 2073 6964 6529 2066  g(frame, side) f
-00019330: 6f72 2070 6f69 6e74 2069 6e20 7365 6c66  or point in self
-00019340: 2e70 6f69 6e74 735d 290a 0a20 2020 2064  .points])..    d
-00019350: 6566 2066 7261 6d65 5f6d 6170 7069 6e67  ef frame_mapping
-00019360: 5f69 6e70 6c61 6365 2873 656c 662c 2066  _inplace(self, f
-00019370: 7261 6d65 3a20 766f 6c6d 646c 722e 4672  rame: volmdlr.Fr
-00019380: 616d 6532 442c 2073 6964 653a 2073 7472  ame2D, side: str
-00019390: 293a 0a20 2020 2020 2020 2077 6172 6e69  ):.        warni
-000193a0: 6e67 732e 7761 726e 2822 2769 6e70 6c61  ngs.warn("'inpla
-000193b0: 6365 2720 6d65 7468 6f64 7320 6172 6520  ce' methods are 
-000193c0: 6465 7072 6563 6174 6564 2e20 5573 6520  deprecated. Use 
-000193d0: 6120 6e6f 7420 696e 706c 6163 6520 6d65  a not inplace me
-000193e0: 7468 6f64 2069 6e73 7465 6164 2e22 2c20  thod instead.", 
-000193f0: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
-00019400: 6e67 290a 0a20 2020 2020 2020 2066 6f72  ng)..        for
-00019410: 2070 6f69 6e74 2069 6e20 7365 6c66 2e70   point in self.p
-00019420: 6f69 6e74 733a 0a20 2020 2020 2020 2020  oints:.         
-00019430: 2020 2070 6f69 6e74 2e66 7261 6d65 5f6d     point.frame_m
-00019440: 6170 7069 6e67 5f69 6e70 6c61 6365 2866  apping_inplace(f
-00019450: 7261 6d65 2c20 7369 6465 290a 0a20 2020  rame, side)..   
-00019460: 2064 6566 2070 6f6c 7967 6f6e 5f64 6973   def polygon_dis
-00019470: 7461 6e63 6528 7365 6c66 2c0a 2020 2020  tance(self,.    
-00019480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019490: 2020 2020 2070 6f6c 7967 6f6e 3a20 2776       polygon: 'v
-000194a0: 6f6c 6d64 6c72 2e77 6972 6573 2e43 6c6f  olmdlr.wires.Clo
-000194b0: 7365 6450 6f6c 7967 6f6e 3244 2729 3a0a  sedPolygon2D'):.
-000194c0: 2020 2020 2020 2020 7020 3d20 7365 6c66          p = self
-000194d0: 2e70 6f69 6e74 735b 305d 0a20 2020 2020  .points[0].     
-000194e0: 2020 2064 203d 205b 5d0a 2020 2020 2020     d = [].      
-000194f0: 2020 666f 7220 706f 696e 7420 696e 2070    for point in p
-00019500: 6f6c 7967 6f6e 2e70 6f69 6e74 733a 0a20  olygon.points:. 
-00019510: 2020 2020 2020 2020 2020 2064 2e61 7070             d.app
-00019520: 656e 6428 702e 706f 696e 745f 6469 7374  end(p.point_dist
-00019530: 616e 6365 2870 6f69 6e74 2929 0a20 2020  ance(point)).   
-00019540: 2020 2020 2069 6e64 6578 203d 2064 2e69       index = d.i
-00019550: 6e64 6578 286d 696e 2864 2929 0a20 2020  ndex(min(d)).   
-00019560: 2020 2020 2072 6574 7572 6e20 645b 696e       return d[in
-00019570: 6465 785d 0a0a 2020 2020 4063 6163 6865  dex]..    @cache
-00019580: 645f 7072 6f70 6572 7479 0a20 2020 2064  d_property.    d
-00019590: 6566 2069 735f 7472 6967 6f28 7365 6c66  ef is_trigo(self
-000195a0: 293a 0a20 2020 2020 2020 2069 6620 6c65  ):.        if le
-000195b0: 6e28 7365 6c66 2e70 6f69 6e74 7329 203c  n(self.points) <
-000195c0: 2033 3a0a 2020 2020 2020 2020 2020 2020   3:.            
-000195d0: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-000195e0: 2020 2020 2061 6e67 6c65 203d 2030 2e0a       angle = 0..
-000195f0: 2020 2020 2020 2020 666f 7220 6c73 312c          for ls1,
-00019600: 206c 7332 2069 6e20 7a69 7028 7365 6c66   ls2 in zip(self
-00019610: 2e6c 696e 655f 7365 676d 656e 7473 2c0a  .line_segments,.
-00019620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019630: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00019640: 2e6c 696e 655f 7365 676d 656e 7473 5b31  .line_segments[1
-00019650: 3a5d 202b 205b 7365 6c66 2e6c 696e 655f  :] + [self.line_
-00019660: 7365 676d 656e 7473 5b30 5d5d 293a 0a20  segments[0]]):. 
-00019670: 2020 2020 2020 2020 2020 2075 203d 206c             u = l
-00019680: 7332 2e75 6e69 745f 6469 7265 6374 696f  s2.unit_directio
-00019690: 6e5f 7665 6374 6f72 2829 0a20 2020 2020  n_vector().     
-000196a0: 2020 2020 2020 2078 203d 2075 2e64 6f74         x = u.dot
-000196b0: 286c 7331 2e75 6e69 745f 6469 7265 6374  (ls1.unit_direct
-000196c0: 696f 6e5f 7665 6374 6f72 2829 290a 2020  ion_vector()).  
-000196d0: 2020 2020 2020 2020 2020 7920 3d20 752e            y = u.
-000196e0: 646f 7428 6c73 312e 6e6f 726d 616c 5f76  dot(ls1.normal_v
-000196f0: 6563 746f 7228 2929 0a20 2020 2020 2020  ector()).       
-00019700: 2020 2020 2061 6e67 6c65 202b 3d20 6d61       angle += ma
-00019710: 7468 2e61 7461 6e32 2879 2c20 7829 0a20  th.atan2(y, x). 
-00019720: 2020 2020 2020 2072 6574 7572 6e20 616e         return an
-00019730: 676c 6520 3e20 300a 0a20 2020 2064 6566  gle > 0..    def
-00019740: 2064 656c 6175 6e61 795f 7472 6961 6e67   delaunay_triang
-00019750: 756c 6174 696f 6e28 7365 6c66 293a 0a20  ulation(self):. 
-00019760: 2020 2020 2020 2070 6f69 6e74 7320 3d20         points = 
-00019770: 7365 6c66 2e70 6f69 6e74 730a 2020 2020  self.points.    
-00019780: 2020 2020 6e65 775f 706f 696e 7473 203d      new_points =
-00019790: 205b 5d0a 2020 2020 2020 2020 6465 6c61   [].        dela
-000197a0: 756e 6179 5f74 7269 616e 676c 6573 203d  unay_triangles =
-000197b0: 205b 5d0a 2020 2020 2020 2020 2320 6178   [].        # ax
-000197c0: 3d70 6c74 2e73 7562 706c 6f74 2829 0a20  =plt.subplot(). 
-000197d0: 2020 2020 2020 2066 6f72 2070 6f69 6e74         for point
-000197e0: 2069 6e20 706f 696e 7473 3a0a 2020 2020   in points:.    
-000197f0: 2020 2020 2020 2020 6e65 775f 706f 696e          new_poin
-00019800: 7473 2e61 7070 656e 6428 5b70 6f69 6e74  ts.append([point
-00019810: 5b30 5d2c 2070 6f69 6e74 5b31 5d5d 290a  [0], point[1]]).
-00019820: 0a20 2020 2020 2020 2064 656c 6175 6e61  .        delauna
-00019830: 7920 3d20 6e70 792e 6172 7261 7928 6e65  y = npy.array(ne
-00019840: 775f 706f 696e 7473 290a 0a20 2020 2020  w_points)..     
-00019850: 2020 2074 7269 203d 2044 656c 6175 6e61     tri = Delauna
-00019860: 7928 6465 6c61 756e 6179 290a 0a20 2020  y(delaunay)..   
-00019870: 2020 2020 2066 6f72 2073 696d 706c 6963       for simplic
-00019880: 6520 696e 2064 656c 6175 6e61 795b 7472  e in delaunay[tr
-00019890: 692e 7369 6d70 6c69 6365 735d 3a0a 2020  i.simplices]:.  
-000198a0: 2020 2020 2020 2020 2020 7472 6961 6e67            triang
-000198b0: 6c65 203d 2054 7269 616e 676c 6532 4428  le = Triangle2D(
-000198c0: 766f 6c6d 646c 722e 506f 696e 7432 4428  volmdlr.Point2D(
-000198d0: 7369 6d70 6c69 6365 5b30 5d29 2c0a 2020  simplice[0]),.  
-000198e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018c50: 2020 2020 2020 2020 2020 206c 6973 7428             list(
+00018c60: 7365 6c66 2e70 6f69 6e74 735b 313a 5d29  self.points[1:])
+00018c70: 202b 205b 7365 6c66 2e70 6f69 6e74 735b   + [self.points[
+00018c80: 305d 5d29 3a0a 2020 2020 2020 2020 2020  0]]):.          
+00018c90: 2020 2020 2020 6966 2070 3120 213d 2070        if p1 != p
+00018ca0: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
+00018cb0: 2020 2020 2020 206c 696e 6573 2e61 7070         lines.app
+00018cc0: 656e 6428 766f 6c6d 646c 722e 6564 6765  end(volmdlr.edge
+00018cd0: 732e 4c69 6e65 5365 676d 656e 7432 4428  s.LineSegment2D(
+00018ce0: 7031 2c20 7032 2929 0a20 2020 2020 2020  p1, p2)).       
+00018cf0: 2072 6574 7572 6e20 6c69 6e65 730a 0a20   return lines.. 
+00018d00: 2020 2064 6566 2072 6f74 6174 696f 6e28     def rotation(
+00018d10: 7365 6c66 2c20 6365 6e74 6572 3a20 766f  self, center: vo
+00018d20: 6c6d 646c 722e 506f 696e 7432 442c 2061  lmdlr.Point2D, a
+00018d30: 6e67 6c65 3a20 666c 6f61 7429 3a0a 2020  ngle: float):.  
+00018d40: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00018d50: 2020 436c 6f73 6564 506f 6c79 676f 6e32    ClosedPolygon2
+00018d60: 4420 726f 7461 7469 6f6e 2e0a 0a20 2020  D rotation...   
+00018d70: 2020 2020 203a 7061 7261 6d20 6365 6e74       :param cent
+00018d80: 6572 3a20 726f 7461 7469 6f6e 2063 656e  er: rotation cen
+00018d90: 7465 720a 2020 2020 2020 2020 3a70 6172  ter.        :par
+00018da0: 616d 2061 6e67 6c65 3a20 616e 676c 6520  am angle: angle 
+00018db0: 726f 7461 7469 6f6e 0a20 2020 2020 2020  rotation.       
+00018dc0: 203a 7265 7475 726e 3a20 6120 6e65 7720   :return: a new 
+00018dd0: 726f 7461 7465 6420 436c 6f73 6564 506f  rotated ClosedPo
+00018de0: 6c79 676f 6e32 440a 2020 2020 2020 2020  lygon2D.        
+00018df0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+00018e00: 726e 2043 6c6f 7365 6450 6f6c 7967 6f6e  rn ClosedPolygon
+00018e10: 3244 280a 2020 2020 2020 2020 2020 2020  2D(.            
+00018e20: 5b70 6f69 6e74 2e72 6f74 6174 696f 6e28  [point.rotation(
+00018e30: 6365 6e74 6572 2c20 616e 676c 6529 2066  center, angle) f
+00018e40: 6f72 2070 6f69 6e74 2069 6e20 7365 6c66  or point in self
+00018e50: 2e70 6f69 6e74 735d 290a 0a20 2020 2064  .points])..    d
+00018e60: 6566 2072 6f74 6174 696f 6e5f 696e 706c  ef rotation_inpl
+00018e70: 6163 6528 7365 6c66 2c20 6365 6e74 6572  ace(self, center
+00018e80: 3a20 766f 6c6d 646c 722e 506f 696e 7432  : volmdlr.Point2
+00018e90: 442c 2061 6e67 6c65 3a20 666c 6f61 7429  D, angle: float)
+00018ea0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00018eb0: 2020 2020 2020 4c69 6e65 3244 2072 6f74        Line2D rot
+00018ec0: 6174 696f 6e2c 204f 626a 6563 7420 6973  ation, Object is
+00018ed0: 2075 7064 6174 6564 2069 6e70 6c61 6365   updated inplace
+00018ee0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00018ef0: 6d20 6365 6e74 6572 3a20 726f 7461 7469  m center: rotati
+00018f00: 6f6e 2063 656e 7465 720a 2020 2020 2020  on center.      
+00018f10: 2020 3a70 6172 616d 2061 6e67 6c65 3a20    :param angle: 
+00018f20: 726f 7461 7469 6f6e 2061 6e67 6c65 0a20  rotation angle. 
+00018f30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00018f40: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+00018f50: 2822 2769 6e70 6c61 6365 2720 6d65 7468  ("'inplace' meth
+00018f60: 6f64 7320 6172 6520 6465 7072 6563 6174  ods are deprecat
+00018f70: 6564 2e20 5573 6520 6120 6e6f 7420 696e  ed. Use a not in
+00018f80: 706c 6163 6520 6d65 7468 6f64 2069 6e73  place method ins
+00018f90: 7465 6164 2e22 2c20 4465 7072 6563 6174  tead.", Deprecat
+00018fa0: 696f 6e57 6172 6e69 6e67 290a 0a20 2020  ionWarning)..   
+00018fb0: 2020 2020 2066 6f72 2070 6f69 6e74 2069       for point i
+00018fc0: 6e20 7365 6c66 2e70 6f69 6e74 733a 0a20  n self.points:. 
+00018fd0: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
+00018fe0: 2e72 6f74 6174 696f 6e5f 696e 706c 6163  .rotation_inplac
+00018ff0: 6528 6365 6e74 6572 2c20 616e 676c 6529  e(center, angle)
+00019000: 0a0a 2020 2020 6465 6620 7472 616e 736c  ..    def transl
+00019010: 6174 696f 6e28 7365 6c66 2c20 6f66 6673  ation(self, offs
+00019020: 6574 3a20 766f 6c6d 646c 722e 5665 6374  et: volmdlr.Vect
+00019030: 6f72 3244 293a 0a20 2020 2020 2020 2022  or2D):.        "
+00019040: 2222 0a20 2020 2020 2020 2043 6c6f 7365  "".        Close
+00019050: 6450 6f6c 7967 6f6e 3244 2074 7261 6e73  dPolygon2D trans
+00019060: 6c61 7469 6f6e 2e0a 0a20 2020 2020 2020  lation...       
+00019070: 203a 7061 7261 6d20 6f66 6673 6574 3a20   :param offset: 
+00019080: 7472 616e 736c 6174 696f 6e20 7665 6374  translation vect
+00019090: 6f72 0a20 2020 2020 2020 203a 7265 7475  or.        :retu
+000190a0: 726e 3a20 4120 6e65 7720 7472 616e 736c  rn: A new transl
+000190b0: 6174 6564 2043 6c6f 7365 6450 6f6c 7967  ated ClosedPolyg
+000190c0: 6f6e 3244 0a20 2020 2020 2020 2022 2222  on2D.        """
+000190d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000190e0: 436c 6f73 6564 506f 6c79 676f 6e32 4428  ClosedPolygon2D(
+000190f0: 0a20 2020 2020 2020 2020 2020 205b 706f  .            [po
+00019100: 696e 742e 7472 616e 736c 6174 696f 6e28  int.translation(
+00019110: 6f66 6673 6574 2920 666f 7220 706f 696e  offset) for poin
+00019120: 7420 696e 2073 656c 662e 706f 696e 7473  t in self.points
+00019130: 5d29 0a0a 2020 2020 6465 6620 7472 616e  ])..    def tran
+00019140: 736c 6174 696f 6e5f 696e 706c 6163 6528  slation_inplace(
+00019150: 7365 6c66 2c20 6f66 6673 6574 3a20 766f  self, offset: vo
+00019160: 6c6d 646c 722e 5665 6374 6f72 3244 293a  lmdlr.Vector2D):
+00019170: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00019180: 2020 2020 2043 6c6f 7365 6450 6f6c 7967       ClosedPolyg
+00019190: 6f6e 3244 2074 7261 6e73 6c61 7469 6f6e  on2D translation
+000191a0: 2e20 4f62 6a65 6374 2069 7320 7570 6461  . Object is upda
+000191b0: 7465 6420 696e 706c 6163 652e 0a0a 2020  ted inplace...  
+000191c0: 2020 2020 2020 3a70 6172 616d 206f 6666        :param off
+000191d0: 7365 743a 2074 7261 6e73 6c61 7469 6f6e  set: translation
+000191e0: 2076 6563 746f 720a 2020 2020 2020 2020   vector.        
+000191f0: 2222 220a 2020 2020 2020 2020 7761 726e  """.        warn
+00019200: 696e 6773 2e77 6172 6e28 2227 696e 706c  ings.warn("'inpl
+00019210: 6163 6527 206d 6574 686f 6473 2061 7265  ace' methods are
+00019220: 2064 6570 7265 6361 7465 642e 2055 7365   deprecated. Use
+00019230: 2061 206e 6f74 2069 6e70 6c61 6365 206d   a not inplace m
+00019240: 6574 686f 6420 696e 7374 6561 642e 222c  ethod instead.",
+00019250: 2044 6570 7265 6361 7469 6f6e 5761 726e   DeprecationWarn
+00019260: 696e 6729 0a0a 2020 2020 2020 2020 666f  ing)..        fo
+00019270: 7220 706f 696e 7420 696e 2073 656c 662e  r point in self.
+00019280: 706f 696e 7473 3a0a 2020 2020 2020 2020  points:.        
+00019290: 2020 2020 706f 696e 742e 7472 616e 736c      point.transl
+000192a0: 6174 696f 6e5f 696e 706c 6163 6528 6f66  ation_inplace(of
+000192b0: 6673 6574 290a 0a20 2020 2064 6566 2066  fset)..    def f
+000192c0: 7261 6d65 5f6d 6170 7069 6e67 2873 656c  rame_mapping(sel
+000192d0: 662c 2066 7261 6d65 3a20 766f 6c6d 646c  f, frame: volmdl
+000192e0: 722e 4672 616d 6532 442c 2073 6964 653a  r.Frame2D, side:
+000192f0: 2073 7472 293a 0a20 2020 2020 2020 2072   str):.        r
+00019300: 6574 7572 6e20 7365 6c66 2e5f 5f63 6c61  eturn self.__cla
+00019310: 7373 5f5f 285b 706f 696e 742e 6672 616d  ss__([point.fram
+00019320: 655f 6d61 7070 696e 6728 6672 616d 652c  e_mapping(frame,
+00019330: 2073 6964 6529 2066 6f72 2070 6f69 6e74   side) for point
+00019340: 2069 6e20 7365 6c66 2e70 6f69 6e74 735d   in self.points]
+00019350: 290a 0a20 2020 2064 6566 2066 7261 6d65  )..    def frame
+00019360: 5f6d 6170 7069 6e67 5f69 6e70 6c61 6365  _mapping_inplace
+00019370: 2873 656c 662c 2066 7261 6d65 3a20 766f  (self, frame: vo
+00019380: 6c6d 646c 722e 4672 616d 6532 442c 2073  lmdlr.Frame2D, s
+00019390: 6964 653a 2073 7472 293a 0a20 2020 2020  ide: str):.     
+000193a0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+000193b0: 2822 2769 6e70 6c61 6365 2720 6d65 7468  ("'inplace' meth
+000193c0: 6f64 7320 6172 6520 6465 7072 6563 6174  ods are deprecat
+000193d0: 6564 2e20 5573 6520 6120 6e6f 7420 696e  ed. Use a not in
+000193e0: 706c 6163 6520 6d65 7468 6f64 2069 6e73  place method ins
+000193f0: 7465 6164 2e22 2c20 4465 7072 6563 6174  tead.", Deprecat
+00019400: 696f 6e57 6172 6e69 6e67 290a 0a20 2020  ionWarning)..   
+00019410: 2020 2020 2066 6f72 2070 6f69 6e74 2069       for point i
+00019420: 6e20 7365 6c66 2e70 6f69 6e74 733a 0a20  n self.points:. 
+00019430: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
+00019440: 2e66 7261 6d65 5f6d 6170 7069 6e67 5f69  .frame_mapping_i
+00019450: 6e70 6c61 6365 2866 7261 6d65 2c20 7369  nplace(frame, si
+00019460: 6465 290a 0a20 2020 2064 6566 2070 6f6c  de)..    def pol
+00019470: 7967 6f6e 5f64 6973 7461 6e63 6528 7365  ygon_distance(se
+00019480: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00019490: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
+000194a0: 7967 6f6e 3a20 2776 6f6c 6d64 6c72 2e77  ygon: 'volmdlr.w
+000194b0: 6972 6573 2e43 6c6f 7365 6450 6f6c 7967  ires.ClosedPolyg
+000194c0: 6f6e 3244 2729 3a0a 2020 2020 2020 2020  on2D'):.        
+000194d0: 7020 3d20 7365 6c66 2e70 6f69 6e74 735b  p = self.points[
+000194e0: 305d 0a20 2020 2020 2020 2064 203d 205b  0].        d = [
+000194f0: 5d0a 2020 2020 2020 2020 666f 7220 706f  ].        for po
+00019500: 696e 7420 696e 2070 6f6c 7967 6f6e 2e70  int in polygon.p
+00019510: 6f69 6e74 733a 0a20 2020 2020 2020 2020  oints:.         
+00019520: 2020 2064 2e61 7070 656e 6428 702e 706f     d.append(p.po
+00019530: 696e 745f 6469 7374 616e 6365 2870 6f69  int_distance(poi
+00019540: 6e74 2929 0a20 2020 2020 2020 2069 6e64  nt)).        ind
+00019550: 6578 203d 2064 2e69 6e64 6578 286d 696e  ex = d.index(min
+00019560: 2864 2929 0a20 2020 2020 2020 2072 6574  (d)).        ret
+00019570: 7572 6e20 645b 696e 6465 785d 0a0a 2020  urn d[index]..  
+00019580: 2020 4063 6163 6865 645f 7072 6f70 6572    @cached_proper
+00019590: 7479 0a20 2020 2064 6566 2069 735f 7472  ty.    def is_tr
+000195a0: 6967 6f28 7365 6c66 293a 0a20 2020 2020  igo(self):.     
+000195b0: 2020 2069 6620 6c65 6e28 7365 6c66 2e70     if len(self.p
+000195c0: 6f69 6e74 7329 203c 2033 3a0a 2020 2020  oints) < 3:.    
+000195d0: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+000195e0: 7275 650a 0a20 2020 2020 2020 2061 6e67  rue..        ang
+000195f0: 6c65 203d 2030 2e0a 2020 2020 2020 2020  le = 0..        
+00019600: 666f 7220 6c73 312c 206c 7332 2069 6e20  for ls1, ls2 in 
+00019610: 7a69 7028 7365 6c66 2e6c 696e 655f 7365  zip(self.line_se
+00019620: 676d 656e 7473 2c0a 2020 2020 2020 2020  gments,.        
+00019630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019640: 2020 2020 7365 6c66 2e6c 696e 655f 7365      self.line_se
+00019650: 676d 656e 7473 5b31 3a5d 202b 205b 7365  gments[1:] + [se
+00019660: 6c66 2e6c 696e 655f 7365 676d 656e 7473  lf.line_segments
+00019670: 5b30 5d5d 293a 0a20 2020 2020 2020 2020  [0]]):.         
+00019680: 2020 2075 203d 206c 7332 2e75 6e69 745f     u = ls2.unit_
+00019690: 6469 7265 6374 696f 6e5f 7665 6374 6f72  direction_vector
+000196a0: 2829 0a20 2020 2020 2020 2020 2020 2078  ().            x
+000196b0: 203d 2075 2e64 6f74 286c 7331 2e75 6e69   = u.dot(ls1.uni
+000196c0: 745f 6469 7265 6374 696f 6e5f 7665 6374  t_direction_vect
+000196d0: 6f72 2829 290a 2020 2020 2020 2020 2020  or()).          
+000196e0: 2020 7920 3d20 752e 646f 7428 6c73 312e    y = u.dot(ls1.
+000196f0: 6e6f 726d 616c 5f76 6563 746f 7228 2929  normal_vector())
+00019700: 0a20 2020 2020 2020 2020 2020 2061 6e67  .            ang
+00019710: 6c65 202b 3d20 6d61 7468 2e61 7461 6e32  le += math.atan2
+00019720: 2879 2c20 7829 0a20 2020 2020 2020 2072  (y, x).        r
+00019730: 6574 7572 6e20 616e 676c 6520 3e20 300a  eturn angle > 0.
+00019740: 0a20 2020 2064 6566 2064 656c 6175 6e61  .    def delauna
+00019750: 795f 7472 6961 6e67 756c 6174 696f 6e28  y_triangulation(
+00019760: 7365 6c66 293a 0a20 2020 2020 2020 2070  self):.        p
+00019770: 6f69 6e74 7320 3d20 7365 6c66 2e70 6f69  oints = self.poi
+00019780: 6e74 730a 2020 2020 2020 2020 6e65 775f  nts.        new_
+00019790: 706f 696e 7473 203d 205b 5d0a 2020 2020  points = [].    
+000197a0: 2020 2020 6465 6c61 756e 6179 5f74 7269      delaunay_tri
+000197b0: 616e 676c 6573 203d 205b 5d0a 2020 2020  angles = [].    
+000197c0: 2020 2020 2320 6178 3d70 6c74 2e73 7562      # ax=plt.sub
+000197d0: 706c 6f74 2829 0a20 2020 2020 2020 2066  plot().        f
+000197e0: 6f72 2070 6f69 6e74 2069 6e20 706f 696e  or point in poin
+000197f0: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
+00019800: 6e65 775f 706f 696e 7473 2e61 7070 656e  new_points.appen
+00019810: 6428 5b70 6f69 6e74 5b30 5d2c 2070 6f69  d([point[0], poi
+00019820: 6e74 5b31 5d5d 290a 0a20 2020 2020 2020  nt[1]])..       
+00019830: 2064 656c 6175 6e61 7920 3d20 6e70 792e   delaunay = npy.
+00019840: 6172 7261 7928 6e65 775f 706f 696e 7473  array(new_points
+00019850: 290a 0a20 2020 2020 2020 2074 7269 203d  )..        tri =
+00019860: 2044 656c 6175 6e61 7928 6465 6c61 756e   Delaunay(delaun
+00019870: 6179 290a 0a20 2020 2020 2020 2066 6f72  ay)..        for
+00019880: 2073 696d 706c 6963 6520 696e 2064 656c   simplice in del
+00019890: 6175 6e61 795b 7472 692e 7369 6d70 6c69  aunay[tri.simpli
+000198a0: 6365 735d 3a0a 2020 2020 2020 2020 2020  ces]:.          
+000198b0: 2020 7472 6961 6e67 6c65 203d 2054 7269    triangle = Tri
+000198c0: 616e 676c 6532 4428 766f 6c6d 646c 722e  angle2D(volmdlr.
+000198d0: 506f 696e 7432 4428 7369 6d70 6c69 6365  Point2D(simplice
+000198e0: 5b30 5d29 2c0a 2020 2020 2020 2020 2020  [0]),.          
 000198f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019900: 766f 6c6d 646c 722e 506f 696e 7432 4428  volmdlr.Point2D(
-00019910: 7369 6d70 6c69 6365 5b31 5d29 2c0a 2020  simplice[1]),.  
-00019920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019900: 2020 2020 2020 2020 766f 6c6d 646c 722e          volmdlr.
+00019910: 506f 696e 7432 4428 7369 6d70 6c69 6365  Point2D(simplice
+00019920: 5b31 5d29 2c0a 2020 2020 2020 2020 2020  [1]),.          
 00019930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019940: 766f 6c6d 646c 722e 506f 696e 7432 4428  volmdlr.Point2D(
-00019950: 7369 6d70 6c69 6365 5b32 5d29 290a 2020  simplice[2])).  
-00019960: 2020 2020 2020 2020 2020 6465 6c61 756e            delaun
-00019970: 6179 5f74 7269 616e 676c 6573 2e61 7070  ay_triangles.app
-00019980: 656e 6428 7472 6961 6e67 6c65 290a 0a20  end(triangle).. 
-00019990: 2020 2020 2020 2072 6574 7572 6e20 6465         return de
-000199a0: 6c61 756e 6179 5f74 7269 616e 676c 6573  launay_triangles
-000199b0: 0a0a 2020 2020 6465 6620 6f66 6673 6574  ..    def offset
-000199c0: 2873 656c 662c 206f 6666 7365 7429 3a0a  (self, offset):.
-000199d0: 2020 2020 2020 2020 785f 6d69 6e2c 2078          x_min, x
-000199e0: 5f6d 6178 2c20 795f 6d69 6e2c 2079 5f6d  _max, y_min, y_m
-000199f0: 6178 203d 2073 656c 662e 626f 756e 6469  ax = self.boundi
-00019a00: 6e67 5f72 6563 7461 6e67 6c65 2e62 6f75  ng_rectangle.bou
-00019a10: 6e64 7328 290a 0a20 2020 2020 2020 206d  nds()..        m
-00019a20: 6178 5f6f 6666 7365 745f 6c65 6e20 3d20  ax_offset_len = 
-00019a30: 6d69 6e28 785f 6d61 7820 2d20 785f 6d69  min(x_max - x_mi
-00019a40: 6e2c 2079 5f6d 6178 202d 2079 5f6d 696e  n, y_max - y_min
-00019a50: 2920 2f20 320a 2020 2020 2020 2020 6966  ) / 2.        if
-00019a60: 206f 6666 7365 7420 3c3d 202d 6d61 785f   offset <= -max_
-00019a70: 6f66 6673 6574 5f6c 656e 3a0a 2020 2020  offset_len:.    
-00019a80: 2020 2020 2020 2020 7072 696e 7428 2749          print('I
-00019a90: 6e61 6461 7074 6564 206f 6666 7365 742c  nadapted offset,
-00019aa0: 2027 0a20 2020 2020 2020 2020 2020 2020   '.             
-00019ab0: 2020 2020 2027 706f 6c79 676f 6e20 6d69       'polygon mi
-00019ac0: 6768 7420 7475 726e 206f 7665 722e 204f  ght turn over. O
-00019ad0: 6666 7365 7420 6d75 7374 2062 6520 6772  ffset must be gr
-00019ae0: 6561 7465 7220 7468 616e 272c 0a20 2020  eater than',.   
-00019af0: 2020 2020 2020 2020 2020 2020 2020 202d                 -
-00019b00: 6d61 785f 6f66 6673 6574 5f6c 656e 290a  max_offset_len).
-00019b10: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00019b20: 6520 5661 6c75 6545 7272 6f72 2827 696e  e ValueError('in
-00019b30: 6164 6170 7465 6420 6f66 6673 6574 2729  adapted offset')
-00019b40: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00019b50: 2020 2020 2020 2020 2020 206e 6220 3d20             nb = 
-00019b60: 6c65 6e28 7365 6c66 2e70 6f69 6e74 7329  len(self.points)
-00019b70: 0a20 2020 2020 2020 2020 2020 2076 6563  .            vec
-00019b80: 746f 7273 203d 205b 5d0a 2020 2020 2020  tors = [].      
-00019b90: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00019ba0: 616e 6765 286e 6220 2d20 3129 3a0a 2020  ange(nb - 1):.  
-00019bb0: 2020 2020 2020 2020 2020 2020 2020 7631                v1
-00019bc0: 203d 2073 656c 662e 706f 696e 7473 5b69   = self.points[i
-00019bd0: 202b 2031 5d20 2d20 7365 6c66 2e70 6f69   + 1] - self.poi
-00019be0: 6e74 735b 695d 0a20 2020 2020 2020 2020  nts[i].         
-00019bf0: 2020 2020 2020 2076 3220 3d20 7365 6c66         v2 = self
-00019c00: 2e70 6f69 6e74 735b 695d 202d 2073 656c  .points[i] - sel
-00019c10: 662e 706f 696e 7473 5b69 202b 2031 5d0a  f.points[i + 1].
-00019c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019c30: 7631 2e6e 6f72 6d61 6c69 7a65 2829 0a20  v1.normalize(). 
-00019c40: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00019c50: 322e 6e6f 726d 616c 697a 6528 290a 2020  2.normalize().  
-00019c60: 2020 2020 2020 2020 2020 2020 2020 7665                ve
-00019c70: 6374 6f72 732e 6170 7065 6e64 2876 3129  ctors.append(v1)
-00019c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019c90: 2076 6563 746f 7273 2e61 7070 656e 6428   vectors.append(
-00019ca0: 7632 290a 0a20 2020 2020 2020 2076 3120  v2)..        v1 
-00019cb0: 3d20 7365 6c66 2e70 6f69 6e74 735b 305d  = self.points[0]
-00019cc0: 202d 2073 656c 662e 706f 696e 7473 5b2d   - self.points[-
-00019cd0: 315d 0a20 2020 2020 2020 2076 3220 3d20  1].        v2 = 
-00019ce0: 7365 6c66 2e70 6f69 6e74 735b 2d31 5d20  self.points[-1] 
-00019cf0: 2d20 7365 6c66 2e70 6f69 6e74 735b 305d  - self.points[0]
-00019d00: 0a20 2020 2020 2020 2076 312e 6e6f 726d  .        v1.norm
-00019d10: 616c 697a 6528 290a 2020 2020 2020 2020  alize().        
-00019d20: 7632 2e6e 6f72 6d61 6c69 7a65 2829 0a20  v2.normalize(). 
-00019d30: 2020 2020 2020 2076 6563 746f 7273 2e61         vectors.a
-00019d40: 7070 656e 6428 7631 290a 2020 2020 2020  ppend(v1).      
-00019d50: 2020 7665 6374 6f72 732e 6170 7065 6e64    vectors.append
-00019d60: 2876 3229 0a0a 2020 2020 2020 2020 6f66  (v2)..        of
-00019d70: 6673 6574 5f76 6563 746f 7273 203d 205b  fset_vectors = [
-00019d80: 5d0a 2020 2020 2020 2020 6f66 6673 6574  ].        offset
-00019d90: 5f70 6f69 6e74 7320 3d20 5b5d 0a0a 2020  _points = []..  
-00019da0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00019db0: 616e 6765 286e 6229 3a0a 0a20 2020 2020  ange(nb):..     
-00019dc0: 2020 2020 2020 2023 2063 6865 636b 203d         # check =
-00019dd0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-00019de0: 2020 206e 6920 3d20 7665 6374 6f72 735b     ni = vectors[
-00019df0: 3220 2a20 6920 2d20 315d 202b 2076 6563  2 * i - 1] + vec
-00019e00: 746f 7273 5b32 202a 2069 5d0a 2020 2020  tors[2 * i].    
-00019e10: 2020 2020 2020 2020 6966 206e 6920 3d3d          if ni ==
-00019e20: 2076 6f6c 6d64 6c72 2e56 6563 746f 7232   volmdlr.Vector2
-00019e30: 4428 302c 2030 293a 0a20 2020 2020 2020  D(0, 0):.       
-00019e40: 2020 2020 2020 2020 206e 6920 3d20 7665           ni = ve
-00019e50: 6374 6f72 735b 3220 2a20 695d 0a20 2020  ctors[2 * i].   
-00019e60: 2020 2020 2020 2020 2020 2020 206e 6920               ni 
-00019e70: 3d20 6e69 2e6e 6f72 6d61 6c5f 7665 6374  = ni.normal_vect
-00019e80: 6f72 2829 0a20 2020 2020 2020 2020 2020  or().           
-00019e90: 2020 2020 206f 6666 7365 745f 7665 6374       offset_vect
-00019ea0: 6f72 732e 6170 7065 6e64 286e 6929 0a20  ors.append(ni). 
-00019eb0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00019ec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019ed0: 206e 692e 6e6f 726d 616c 697a 6528 290a   ni.normalize().
-00019ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019ef0: 6966 206e 692e 646f 7428 7665 6374 6f72  if ni.dot(vector
-00019f00: 735b 3220 2a20 6920 2d20 315d 2e6e 6f72  s[2 * i - 1].nor
-00019f10: 6d61 6c5f 7665 6374 6f72 2829 2920 3e20  mal_vector()) > 
-00019f20: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-00019f30: 2020 2020 2020 206e 6920 3d20 2d20 6e69         ni = - ni
-00019f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019f50: 2020 2020 2023 2063 6865 636b 203d 2054       # check = T
-00019f60: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-00019f70: 2020 2020 6f66 6673 6574 5f76 6563 746f      offset_vecto
-00019f80: 7273 2e61 7070 656e 6428 6e69 290a 0a20  rs.append(ni).. 
-00019f90: 2020 2020 2020 2020 2020 206e 6f72 6d61             norma
-00019fa0: 6c5f 7665 6374 6f72 3120 3d20 2d20 7665  l_vector1 = - ve
-00019fb0: 6374 6f72 735b 3220 2a20 6920 2d20 315d  ctors[2 * i - 1]
-00019fc0: 2e6e 6f72 6d61 6c5f 7665 6374 6f72 2829  .normal_vector()
-00019fd0: 0a20 2020 2020 2020 2020 2020 206e 6f72  .            nor
-00019fe0: 6d61 6c5f 7665 6374 6f72 3220 3d20 7665  mal_vector2 = ve
-00019ff0: 6374 6f72 735b 3220 2a20 695d 2e6e 6f72  ctors[2 * i].nor
-0001a000: 6d61 6c5f 7665 6374 6f72 2829 0a20 2020  mal_vector().   
-0001a010: 2020 2020 2020 2020 206e 6f72 6d61 6c5f           normal_
-0001a020: 7665 6374 6f72 312e 6e6f 726d 616c 697a  vector1.normaliz
-0001a030: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-0001a040: 6e6f 726d 616c 5f76 6563 746f 7232 2e6e  normal_vector2.n
-0001a050: 6f72 6d61 6c69 7a65 2829 0a20 2020 2020  ormalize().     
-0001a060: 2020 2020 2020 2061 6c70 6861 203d 206d         alpha = m
-0001a070: 6174 682e 6163 6f73 286e 6f72 6d61 6c5f  ath.acos(normal_
-0001a080: 7665 6374 6f72 312e 646f 7428 6e6f 726d  vector1.dot(norm
-0001a090: 616c 5f76 6563 746f 7232 2929 0a0a 2020  al_vector2))..  
-0001a0a0: 2020 2020 2020 2020 2020 6f66 6673 6574            offset
-0001a0b0: 5f70 6f69 6e74 203d 2073 656c 662e 706f  _point = self.po
-0001a0c0: 696e 7473 5b69 5d20 2b20 6f66 6673 6574  ints[i] + offset
-0001a0d0: 202f 206d 6174 682e 636f 7328 616c 7068   / math.cos(alph
-0001a0e0: 6120 2f20 3229 202a 205c 0a20 2020 2020  a / 2) * \.     
-0001a0f0: 2020 2020 2020 2020 2020 2028 2d6f 6666             (-off
-0001a100: 7365 745f 7665 6374 6f72 735b 695d 290a  set_vectors[i]).
-0001a110: 0a20 2020 2020 2020 2020 2020 2023 2061  .            # a
-0001a120: 783d 7365 6c66 2e70 6c6f 7428 290a 2020  x=self.plot().  
-0001a130: 2020 2020 2020 2020 2020 2320 6f66 6673            # offs
-0001a140: 6574 5f70 6f69 6e74 2e70 6c6f 7428 6178  et_point.plot(ax
-0001a150: 3d61 782c 2063 6f6c 6f72 3d27 6727 290a  =ax, color='g').
-0001a160: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
-0001a170: 6620 7365 6c66 2e70 6f69 6e74 5f62 656c  f self.point_bel
-0001a180: 6f6e 6773 286f 6666 7365 745f 706f 696e  ongs(offset_poin
-0001a190: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-0001a1a0: 2320 2020 2020 6f66 6673 6574 5f70 6f69  #     offset_poi
-0001a1b0: 6e74 203d 2073 656c 662e 706f 696e 7473  nt = self.points
-0001a1c0: 5b69 5d20 2b20 6f66 6673 6574 202f 206d  [i] + offset / m
-0001a1d0: 6174 682e 636f 7328 616c 7068 6120 2f20  ath.cos(alpha / 
-0001a1e0: 3229 202a 205c 0a20 2020 2020 2020 2020  2) * \.         
-0001a1f0: 2020 2023 2020 2020 2020 2020 2020 2020     #            
-0001a200: 2020 2020 2020 2020 282d 6f66 6673 6574          (-offset
-0001a210: 5f76 6563 746f 7273 5b69 5d29 0a0a 2020  _vectors[i])..  
-0001a220: 2020 2020 2020 2020 2020 6f66 6673 6574            offset
-0001a230: 5f70 6f69 6e74 732e 6170 7065 6e64 286f  _points.append(o
-0001a240: 6666 7365 745f 706f 696e 7429 0a0a 2020  ffset_point)..  
-0001a250: 2020 2020 2020 2020 2020 2320 7365 6c66            # self
-0001a260: 2e70 6f69 6e74 735b 695d 2e70 6c6f 7428  .points[i].plot(
-0001a270: 6178 3d61 782c 2063 6f6c 6f72 3d27 6227  ax=ax, color='b'
-0001a280: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-0001a290: 6f66 6673 6574 5f70 6f69 6e74 2e70 6c6f  offset_point.plo
-0001a2a0: 7428 6178 3d61 782c 2063 6f6c 6f72 3d27  t(ax=ax, color='
-0001a2b0: 7227 290a 0a20 2020 2020 2020 2072 6574  r')..        ret
-0001a2c0: 7572 6e20 7365 6c66 2e5f 5f63 6c61 7373  urn self.__class
-0001a2d0: 5f5f 286f 6666 7365 745f 706f 696e 7473  __(offset_points
-0001a2e0: 290a 0a20 2020 2064 6566 2070 6f69 6e74  )..    def point
-0001a2f0: 5f62 6f72 6465 725f 6469 7374 616e 6365  _border_distance
-0001a300: 2873 656c 662c 2070 6f69 6e74 2c20 7265  (self, point, re
-0001a310: 7475 726e 5f6f 7468 6572 5f70 6f69 6e74  turn_other_point
-0001a320: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
-0001a330: 2022 2222 0a20 2020 2020 2020 2043 6f6d   """.        Com
-0001a340: 7075 7465 2074 6865 2064 6973 7461 6e63  pute the distanc
-0001a350: 6520 746f 2074 6865 2062 6f72 6465 7220  e to the border 
-0001a360: 6469 7374 616e 6365 206f 6620 706f 6c79  distance of poly
-0001a370: 676f 6e2e 0a20 2020 2020 2020 204f 7574  gon..        Out
-0001a380: 7075 7420 6973 2061 6c77 6179 7320 706f  put is always po
-0001a390: 7369 7469 7665 2c20 6576 656e 2069 6620  sitive, even if 
-0001a3a0: 7468 6520 706f 696e 7420 6265 6c6f 6e67  the point belong
-0001a3b0: 7320 746f 2074 6865 2070 6f6c 7967 6f6e  s to the polygon
-0001a3c0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0001a3d0: 2020 2020 2020 645f 6d69 6e2c 206f 7468        d_min, oth
-0001a3e0: 6572 5f70 6f69 6e74 5f6d 696e 203d 2073  er_point_min = s
-0001a3f0: 656c 662e 6c69 6e65 5f73 6567 6d65 6e74  elf.line_segment
-0001a400: 735b 305d 2e70 6f69 6e74 5f64 6973 7461  s[0].point_dista
-0001a410: 6e63 6528 0a20 2020 2020 2020 2020 2020  nce(.           
-0001a420: 2070 6f69 6e74 2c20 7265 7475 726e 5f6f   point, return_o
-0001a430: 7468 6572 5f70 6f69 6e74 3d54 7275 6529  ther_point=True)
-0001a440: 0a20 2020 2020 2020 2066 6f72 206c 696e  .        for lin
-0001a450: 6520 696e 2073 656c 662e 6c69 6e65 5f73  e in self.line_s
-0001a460: 6567 6d65 6e74 735b 313a 5d3a 0a20 2020  egments[1:]:.   
-0001a470: 2020 2020 2020 2020 2064 2c20 6f74 6865           d, othe
-0001a480: 725f 706f 696e 7420 3d20 6c69 6e65 2e70  r_point = line.p
-0001a490: 6f69 6e74 5f64 6973 7461 6e63 6528 0a20  oint_distance(. 
-0001a4a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001a4b0: 6f69 6e74 2c20 7265 7475 726e 5f6f 7468  oint, return_oth
-0001a4c0: 6572 5f70 6f69 6e74 3d54 7275 6529 0a20  er_point=True). 
-0001a4d0: 2020 2020 2020 2020 2020 2069 6620 6420             if d 
-0001a4e0: 3c20 645f 6d69 6e3a 0a20 2020 2020 2020  < d_min:.       
-0001a4f0: 2020 2020 2020 2020 2064 5f6d 696e 203d           d_min =
-0001a500: 2064 0a20 2020 2020 2020 2020 2020 2020   d.             
-0001a510: 2020 206f 7468 6572 5f70 6f69 6e74 5f6d     other_point_m
-0001a520: 696e 203d 206f 7468 6572 5f70 6f69 6e74  in = other_point
-0001a530: 0a20 2020 2020 2020 2069 6620 7265 7475  .        if retu
-0001a540: 726e 5f6f 7468 6572 5f70 6f69 6e74 3a0a  rn_other_point:.
-0001a550: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001a560: 726e 2064 5f6d 696e 2c20 6f74 6865 725f  rn d_min, other_
-0001a570: 706f 696e 745f 6d69 6e0a 2020 2020 2020  point_min.      
-0001a580: 2020 7265 7475 726e 2064 5f6d 696e 0a0a    return d_min..
-0001a590: 2020 2020 6465 6620 7365 6c66 5f69 6e74      def self_int
-0001a5a0: 6572 7365 6374 7328 7365 6c66 293a 0a20  ersects(self):. 
-0001a5b0: 2020 2020 2020 2065 7073 696c 6f6e 203d         epsilon =
-0001a5c0: 2030 0a20 2020 2020 2020 2023 2042 454e   0.        # BEN
-0001a5d0: 544c 4559 2d4f 5454 4d41 4e4e 2041 4c47  TLEY-OTTMANN ALG
-0001a5e0: 4f52 4954 484d 0a20 2020 2020 2020 2023  ORITHM.        #
-0001a5f0: 2053 6f72 7420 7468 6520 706f 696e 7473   Sort the points
-0001a600: 2061 6c6f 6e67 2061 7363 656e 6469 6e67   along ascending
-0001a610: 2078 2066 6f72 2074 6865 2053 7765 6570   x for the Sweep
-0001a620: 204c 696e 6520 6d65 7468 6f64 0a20 2020   Line method.   
-0001a630: 2020 2020 2073 6f72 7465 645f 696e 6465       sorted_inde
-0001a640: 7820 3d20 736f 7274 6564 2872 616e 6765  x = sorted(range
-0001a650: 286c 656e 2873 656c 662e 706f 696e 7473  (len(self.points
-0001a660: 2929 2c20 6b65 793d 6c61 6d62 6461 2070  )), key=lambda p
-0001a670: 3a20 280a 2020 2020 2020 2020 2020 2020  : (.            
-0001a680: 7365 6c66 2e70 6f69 6e74 735b 705d 5b30  self.points[p][0
-0001a690: 5d2c 2073 656c 662e 706f 696e 7473 5b70  ], self.points[p
-0001a6a0: 5d5b 315d 2929 0a20 2020 2020 2020 206e  ][1])).        n
-0001a6b0: 6220 3d20 6c65 6e28 736f 7274 6564 5f69  b = len(sorted_i
-0001a6c0: 6e64 6578 290a 2020 2020 2020 2020 7365  ndex).        se
-0001a6d0: 676d 656e 7473 203d 205b 5d0a 2020 2020  gments = [].    
-0001a6e0: 2020 2020 6465 6c65 7465 6420 3d20 5b5d      deleted = []
-0001a6f0: 0a0a 2020 2020 2020 2020 7768 696c 6520  ..        while 
-0001a700: 6c65 6e28 0a20 2020 2020 2020 2020 2020  len(.           
-0001a710: 2020 2020 2073 6f72 7465 645f 696e 6465       sorted_inde
-0001a720: 7829 2021 3d20 303a 2020 2320 5768 696c  x) != 0:  # Whil
-0001a730: 6520 616c 6c20 7468 6520 706f 696e 7473  e all the points
-0001a740: 2068 6176 656e 2774 2062 6565 6e20 7377   haven't been sw
-0001a750: 6570 740a 2020 2020 2020 2020 2020 2020  ept.            
-0001a760: 2320 5374 6f63 6b20 7468 6520 7365 676d  # Stock the segm
-0001a770: 656e 7473 2062 6574 7765 656e 2032 2063  ents between 2 c
-0001a780: 6f6e 7365 6375 7469 7665 2065 6467 6573  onsecutive edges
-0001a790: 0a20 2020 2020 2020 2020 2020 2023 2045  .            # E
-0001a7a0: 783a 2066 6f72 2074 6865 2041 4243 4445  x: for the ABCDE
-0001a7b0: 2070 6f6c 7967 6f6e 2c20 6966 2053 7765   polygon, if Swe
-0001a7c0: 6570 204c 696e 6520 6973 206f 6e20 432c  ep Line is on C,
-0001a7d0: 2074 6865 2073 6567 6d65 6e74 730a 2020   the segments.  
-0001a7e0: 2020 2020 2020 2020 2020 2320 2020 7769            #   wi
-0001a7f0: 6c6c 2062 6520 2843 2c42 2920 616e 6420  ll be (C,B) and 
-0001a800: 2843 2c44 290a 2020 2020 2020 2020 2020  (C,D).          
-0001a810: 2020 6966 2073 6f72 7465 645f 696e 6465    if sorted_inde
-0001a820: 785b 305d 202d 2031 203c 2030 3a0a 2020  x[0] - 1 < 0:.  
-0001a830: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001a840: 676d 656e 7473 2e61 7070 656e 6428 2873  gments.append((s
-0001a850: 6f72 7465 645f 696e 6465 785b 305d 2c20  orted_index[0], 
-0001a860: 6e62 202d 2031 2929 0a20 2020 2020 2020  nb - 1)).       
-0001a870: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001a880: 2020 2020 2020 2020 2020 2073 6567 6d65             segme
-0001a890: 6e74 732e 6170 7065 6e64 2828 736f 7274  nts.append((sort
-0001a8a0: 6564 5f69 6e64 6578 5b30 5d2c 2073 6f72  ed_index[0], sor
-0001a8b0: 7465 645f 696e 6465 785b 305d 202d 2031  ted_index[0] - 1
-0001a8c0: 2929 0a20 2020 2020 2020 2020 2020 2069  )).            i
-0001a8d0: 6620 736f 7274 6564 5f69 6e64 6578 5b30  f sorted_index[0
-0001a8e0: 5d20 3e3d 206c 656e 2873 656c 662e 706f  ] >= len(self.po
-0001a8f0: 696e 7473 2920 2d20 313a 0a20 2020 2020  ints) - 1:.     
-0001a900: 2020 2020 2020 2020 2020 2073 6567 6d65             segme
-0001a910: 6e74 732e 6170 7065 6e64 2828 736f 7274  nts.append((sort
-0001a920: 6564 5f69 6e64 6578 5b30 5d2c 2030 2929  ed_index[0], 0))
-0001a930: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0001a940: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0001a950: 2020 2073 6567 6d65 6e74 732e 6170 7065     segments.appe
-0001a960: 6e64 2828 736f 7274 6564 5f69 6e64 6578  nd((sorted_index
-0001a970: 5b30 5d2c 2073 6f72 7465 645f 696e 6465  [0], sorted_inde
-0001a980: 785b 305d 202b 2031 2929 0a0a 2020 2020  x[0] + 1))..    
-0001a990: 2020 2020 2020 2020 2320 4f6e 6365 2074          # Once t
-0001a9a0: 776f 2065 6467 6573 206c 696e 6b65 6420  wo edges linked 
-0001a9b0: 6279 2061 2073 6567 6d65 6e74 2068 6176  by a segment hav
-0001a9c0: 6520 6265 656e 2073 7765 7074 2c20 6465  e been swept, de
-0001a9d0: 6c65 7465 2074 6865 0a20 2020 2020 2020  lete the.       
-0001a9e0: 2020 2020 2023 2073 6567 6d65 6e74 2066       # segment f
-0001a9f0: 726f 6d20 7468 6520 6c69 7374 0a20 2020  rom the list.   
-0001aa00: 2020 2020 2020 2020 2074 6f5f 6465 6c20           to_del 
-0001aa10: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
-0001aa20: 2066 6f72 2069 6e64 6578 2069 6e20 6465   for index in de
-0001aa30: 6c65 7465 643a 0a20 2020 2020 2020 2020  leted:.         
-0001aa40: 2020 2020 2020 2069 6620 6162 7328 696e         if abs(in
-0001aa50: 6465 7820 2d20 736f 7274 6564 5f69 6e64  dex - sorted_ind
-0001aa60: 6578 5b30 5d29 203d 3d20 3120 6f72 2061  ex[0]) == 1 or a
-0001aa70: 6273 280a 2020 2020 2020 2020 2020 2020  bs(.            
-0001aa80: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-0001aa90: 7820 2d20 736f 7274 6564 5f69 6e64 6578  x - sorted_index
-0001aaa0: 5b30 5d29 203d 3d20 6e62 202d 2031 3a0a  [0]) == nb - 1:.
-0001aab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aac0: 2020 2020 746f 5f64 656c 2e61 7070 656e      to_del.appen
-0001aad0: 6428 2869 6e64 6578 2c20 736f 7274 6564  d((index, sorted
-0001aae0: 5f69 6e64 6578 5b30 5d29 290a 2020 2020  _index[0])).    
-0001aaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ab00: 746f 5f64 656c 2e61 7070 656e 6428 2873  to_del.append((s
-0001ab10: 6f72 7465 645f 696e 6465 785b 305d 2c20  orted_index[0], 
-0001ab20: 696e 6465 7829 290a 0a20 2020 2020 2020  index))..       
-0001ab30: 2020 2020 2023 204b 6565 7020 7472 6163       # Keep trac
-0001ab40: 6b20 6f66 2077 6869 6368 2065 6467 6573  k of which edges
-0001ab50: 2068 6176 6520 6265 656e 2073 7765 7074   have been swept
-0001ab60: 0a20 2020 2020 2020 2020 2020 2064 656c  .            del
-0001ab70: 6574 6564 2e61 7070 656e 6428 736f 7274  eted.append(sort
-0001ab80: 6564 5f69 6e64 6578 5b30 5d29 0a20 2020  ed_index[0]).   
-0001ab90: 2020 2020 2020 2020 2073 6f72 7465 645f           sorted_
-0001aba0: 696e 6465 782e 706f 7028 3029 0a0a 2020  index.pop(0)..  
-0001abb0: 2020 2020 2020 2020 2020 2320 4465 6c65            # Dele
-0001abc0: 7465 2074 6865 2073 6567 6d65 6e74 7320  te the segments 
-0001abd0: 7468 6174 2068 6176 6520 6a75 7374 2062  that have just b
-0001abe0: 6565 6e20 7377 6570 740a 2020 2020 2020  een swept.      
-0001abf0: 2020 2020 2020 696e 6465 785f 746f 5f64        index_to_d
-0001ac00: 656c 203d 205b 5d0a 2020 2020 2020 2020  el = [].        
-0001ac10: 2020 2020 666f 7220 692c 2073 6567 6d65      for i, segme
-0001ac20: 6e74 2069 6e20 656e 756d 6572 6174 6528  nt in enumerate(
-0001ac30: 7365 676d 656e 7473 293a 0a20 2020 2020  segments):.     
-0001ac40: 2020 2020 2020 2020 2020 2066 6f72 2073             for s
-0001ac50: 6567 5f74 6f5f 6465 6c20 696e 2074 6f5f  eg_to_del in to_
-0001ac60: 6465 6c3a 0a20 2020 2020 2020 2020 2020  del:.           
-0001ac70: 2020 2020 2020 2020 2069 6620 7365 676d           if segm
-0001ac80: 656e 7420 3d3d 2073 6567 5f74 6f5f 6465  ent == seg_to_de
-0001ac90: 6c3a 0a20 2020 2020 2020 2020 2020 2020  l:.             
-0001aca0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-0001acb0: 5f74 6f5f 6465 6c2e 6170 7065 6e64 2869  _to_del.append(i
-0001acc0: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-0001acd0: 7220 696e 6465 7820 696e 2069 6e64 6578  r index in index
-0001ace0: 5f74 6f5f 6465 6c5b 3a3a 2d31 5d3a 0a20  _to_del[::-1]:. 
-0001acf0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001ad00: 6567 6d65 6e74 732e 706f 7028 696e 6465  egments.pop(inde
-0001ad10: 7829 0a0a 2020 2020 2020 2020 2020 2020  x)..            
-0001ad20: 2320 4368 6563 6b73 2069 6620 7477 6f20  # Checks if two 
-0001ad30: 7365 676d 656e 7473 2061 7265 2069 6e74  segments are int
-0001ad40: 6572 7365 6374 696e 6720 6561 6368 206f  ersecting each o
-0001ad50: 7468 6572 2c20 7265 7475 726e 7320 5472  ther, returns Tr
-0001ad60: 7565 0a20 2020 2020 2020 2020 2020 2023  ue.            #
-0001ad70: 2069 6620 7965 732c 206f 7468 6572 7769   if yes, otherwi
-0001ad80: 7365 2074 6865 2061 6c67 6f72 6974 686d  se the algorithm
-0001ad90: 2063 6f6e 7469 6e75 6573 2061 7420 5748   continues at WH
-0001ada0: 494c 450a 2020 2020 2020 2020 2020 2020  ILE.            
-0001adb0: 666f 7220 7365 676d 656e 7431 2069 6e20  for segment1 in 
-0001adc0: 7365 676d 656e 7473 3a0a 2020 2020 2020  segments:.      
-0001add0: 2020 2020 2020 2020 2020 666f 7220 7365            for se
-0001ade0: 676d 656e 7432 2069 6e20 7365 676d 656e  gment2 in segmen
-0001adf0: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-0001ae00: 2020 2020 2020 2020 6966 2073 6567 6d65          if segme
-0001ae10: 6e74 315b 305d 2021 3d20 7365 676d 656e  nt1[0] != segmen
-0001ae20: 7432 5b30 5d20 616e 6420 7365 676d 656e  t2[0] and segmen
-0001ae30: 7431 5b31 5d20 213d 2073 6567 6d65 6e74  t1[1] != segment
-0001ae40: 325b 0a20 2020 2020 2020 2020 2020 2020  2[.             
-0001ae50: 2020 2020 2020 2020 2020 2031 5d20 616e             1] an
-0001ae60: 6420 7365 676d 656e 7431 5b30 5d20 213d  d segment1[0] !=
-0001ae70: 2073 6567 6d65 6e74 325b 315d 2061 6e64   segment2[1] and
-0001ae80: 2073 6567 6d65 6e74 315b 315d 2021 3d20   segment1[1] != 
-0001ae90: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0001aea0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001aeb0: 676d 656e 7432 5b30 5d3a 0a0a 2020 2020  gment2[0]:..    
-0001aec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aed0: 2020 2020 6c69 6e65 3120 3d20 766f 6c6d      line1 = volm
-0001aee0: 646c 722e 6564 6765 732e 4c69 6e65 5365  dlr.edges.LineSe
-0001aef0: 676d 656e 7432 4428 0a20 2020 2020 2020  gment2D(.       
-0001af00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af10: 2020 2020 2073 656c 662e 706f 696e 7473       self.points
-0001af20: 5b73 6567 6d65 6e74 315b 305d 5d2c 0a20  [segment1[0]],. 
-0001af30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001af50: 706f 696e 7473 5b73 6567 6d65 6e74 315b  points[segment1[
-0001af60: 315d 5d29 0a20 2020 2020 2020 2020 2020  1]]).           
-0001af70: 2020 2020 2020 2020 2020 2020 206c 696e               lin
-0001af80: 6532 203d 2076 6f6c 6d64 6c72 2e65 6467  e2 = volmdlr.edg
-0001af90: 6573 2e4c 696e 6553 6567 6d65 6e74 3244  es.LineSegment2D
-0001afa0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001afb0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001afc0: 6c66 2e70 6f69 6e74 735b 7365 676d 656e  lf.points[segmen
-0001afd0: 7432 5b30 5d5d 2c0a 2020 2020 2020 2020  t2[0]],.        
+00019940: 2020 2020 2020 2020 766f 6c6d 646c 722e          volmdlr.
+00019950: 506f 696e 7432 4428 7369 6d70 6c69 6365  Point2D(simplice
+00019960: 5b32 5d29 290a 2020 2020 2020 2020 2020  [2])).          
+00019970: 2020 6465 6c61 756e 6179 5f74 7269 616e    delaunay_trian
+00019980: 676c 6573 2e61 7070 656e 6428 7472 6961  gles.append(tria
+00019990: 6e67 6c65 290a 0a20 2020 2020 2020 2072  ngle)..        r
+000199a0: 6574 7572 6e20 6465 6c61 756e 6179 5f74  eturn delaunay_t
+000199b0: 7269 616e 676c 6573 0a0a 2020 2020 6465  riangles..    de
+000199c0: 6620 6f66 6673 6574 2873 656c 662c 206f  f offset(self, o
+000199d0: 6666 7365 7429 3a0a 2020 2020 2020 2020  ffset):.        
+000199e0: 785f 6d69 6e2c 2078 5f6d 6178 2c20 795f  x_min, x_max, y_
+000199f0: 6d69 6e2c 2079 5f6d 6178 203d 2073 656c  min, y_max = sel
+00019a00: 662e 626f 756e 6469 6e67 5f72 6563 7461  f.bounding_recta
+00019a10: 6e67 6c65 2e62 6f75 6e64 7328 290a 0a20  ngle.bounds().. 
+00019a20: 2020 2020 2020 206d 6178 5f6f 6666 7365         max_offse
+00019a30: 745f 6c65 6e20 3d20 6d69 6e28 785f 6d61  t_len = min(x_ma
+00019a40: 7820 2d20 785f 6d69 6e2c 2079 5f6d 6178  x - x_min, y_max
+00019a50: 202d 2079 5f6d 696e 2920 2f20 320a 2020   - y_min) / 2.  
+00019a60: 2020 2020 2020 6966 206f 6666 7365 7420        if offset 
+00019a70: 3c3d 202d 6d61 785f 6f66 6673 6574 5f6c  <= -max_offset_l
+00019a80: 656e 3a0a 2020 2020 2020 2020 2020 2020  en:.            
+00019a90: 7072 696e 7428 2749 6e61 6461 7074 6564  print('Inadapted
+00019aa0: 206f 6666 7365 742c 2027 0a20 2020 2020   offset, '.     
+00019ab0: 2020 2020 2020 2020 2020 2020 2027 706f               'po
+00019ac0: 6c79 676f 6e20 6d69 6768 7420 7475 726e  lygon might turn
+00019ad0: 206f 7665 722e 204f 6666 7365 7420 6d75   over. Offset mu
+00019ae0: 7374 2062 6520 6772 6561 7465 7220 7468  st be greater th
+00019af0: 616e 272c 0a20 2020 2020 2020 2020 2020  an',.           
+00019b00: 2020 2020 2020 202d 6d61 785f 6f66 6673         -max_offs
+00019b10: 6574 5f6c 656e 290a 2020 2020 2020 2020  et_len).        
+00019b20: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00019b30: 7272 6f72 2827 696e 6164 6170 7465 6420  rror('inadapted 
+00019b40: 6f66 6673 6574 2729 0a20 2020 2020 2020  offset').       
+00019b50: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00019b60: 2020 206e 6220 3d20 6c65 6e28 7365 6c66     nb = len(self
+00019b70: 2e70 6f69 6e74 7329 0a20 2020 2020 2020  .points).       
+00019b80: 2020 2020 2076 6563 746f 7273 203d 205b       vectors = [
+00019b90: 5d0a 2020 2020 2020 2020 2020 2020 666f  ].            fo
+00019ba0: 7220 6920 696e 2072 616e 6765 286e 6220  r i in range(nb 
+00019bb0: 2d20 3129 3a0a 2020 2020 2020 2020 2020  - 1):.          
+00019bc0: 2020 2020 2020 7631 203d 2073 656c 662e        v1 = self.
+00019bd0: 706f 696e 7473 5b69 202b 2031 5d20 2d20  points[i + 1] - 
+00019be0: 7365 6c66 2e70 6f69 6e74 735b 695d 0a20  self.points[i]. 
+00019bf0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00019c00: 3220 3d20 7365 6c66 2e70 6f69 6e74 735b  2 = self.points[
+00019c10: 695d 202d 2073 656c 662e 706f 696e 7473  i] - self.points
+00019c20: 5b69 202b 2031 5d0a 2020 2020 2020 2020  [i + 1].        
+00019c30: 2020 2020 2020 2020 7631 2e6e 6f72 6d61          v1.norma
+00019c40: 6c69 7a65 2829 0a20 2020 2020 2020 2020  lize().         
+00019c50: 2020 2020 2020 2076 322e 6e6f 726d 616c         v2.normal
+00019c60: 697a 6528 290a 2020 2020 2020 2020 2020  ize().          
+00019c70: 2020 2020 2020 7665 6374 6f72 732e 6170        vectors.ap
+00019c80: 7065 6e64 2876 3129 0a20 2020 2020 2020  pend(v1).       
+00019c90: 2020 2020 2020 2020 2076 6563 746f 7273           vectors
+00019ca0: 2e61 7070 656e 6428 7632 290a 0a20 2020  .append(v2)..   
+00019cb0: 2020 2020 2076 3120 3d20 7365 6c66 2e70       v1 = self.p
+00019cc0: 6f69 6e74 735b 305d 202d 2073 656c 662e  oints[0] - self.
+00019cd0: 706f 696e 7473 5b2d 315d 0a20 2020 2020  points[-1].     
+00019ce0: 2020 2076 3220 3d20 7365 6c66 2e70 6f69     v2 = self.poi
+00019cf0: 6e74 735b 2d31 5d20 2d20 7365 6c66 2e70  nts[-1] - self.p
+00019d00: 6f69 6e74 735b 305d 0a20 2020 2020 2020  oints[0].       
+00019d10: 2076 312e 6e6f 726d 616c 697a 6528 290a   v1.normalize().
+00019d20: 2020 2020 2020 2020 7632 2e6e 6f72 6d61          v2.norma
+00019d30: 6c69 7a65 2829 0a20 2020 2020 2020 2076  lize().        v
+00019d40: 6563 746f 7273 2e61 7070 656e 6428 7631  ectors.append(v1
+00019d50: 290a 2020 2020 2020 2020 7665 6374 6f72  ).        vector
+00019d60: 732e 6170 7065 6e64 2876 3229 0a0a 2020  s.append(v2)..  
+00019d70: 2020 2020 2020 6f66 6673 6574 5f76 6563        offset_vec
+00019d80: 746f 7273 203d 205b 5d0a 2020 2020 2020  tors = [].      
+00019d90: 2020 6f66 6673 6574 5f70 6f69 6e74 7320    offset_points 
+00019da0: 3d20 5b5d 0a0a 2020 2020 2020 2020 666f  = []..        fo
+00019db0: 7220 6920 696e 2072 616e 6765 286e 6229  r i in range(nb)
+00019dc0: 3a0a 0a20 2020 2020 2020 2020 2020 2023  :..            #
+00019dd0: 2063 6865 636b 203d 2046 616c 7365 0a20   check = False. 
+00019de0: 2020 2020 2020 2020 2020 206e 6920 3d20             ni = 
+00019df0: 7665 6374 6f72 735b 3220 2a20 6920 2d20  vectors[2 * i - 
+00019e00: 315d 202b 2076 6563 746f 7273 5b32 202a  1] + vectors[2 *
+00019e10: 2069 5d0a 2020 2020 2020 2020 2020 2020   i].            
+00019e20: 6966 206e 6920 3d3d 2076 6f6c 6d64 6c72  if ni == volmdlr
+00019e30: 2e56 6563 746f 7232 4428 302c 2030 293a  .Vector2D(0, 0):
+00019e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019e50: 206e 6920 3d20 7665 6374 6f72 735b 3220   ni = vectors[2 
+00019e60: 2a20 695d 0a20 2020 2020 2020 2020 2020  * i].           
+00019e70: 2020 2020 206e 6920 3d20 6e69 2e6e 6f72       ni = ni.nor
+00019e80: 6d61 6c5f 7665 6374 6f72 2829 0a20 2020  mal_vector().   
+00019e90: 2020 2020 2020 2020 2020 2020 206f 6666               off
+00019ea0: 7365 745f 7665 6374 6f72 732e 6170 7065  set_vectors.appe
+00019eb0: 6e64 286e 6929 0a20 2020 2020 2020 2020  nd(ni).         
+00019ec0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00019ed0: 2020 2020 2020 2020 206e 692e 6e6f 726d           ni.norm
+00019ee0: 616c 697a 6528 290a 2020 2020 2020 2020  alize().        
+00019ef0: 2020 2020 2020 2020 6966 206e 692e 646f          if ni.do
+00019f00: 7428 7665 6374 6f72 735b 3220 2a20 6920  t(vectors[2 * i 
+00019f10: 2d20 315d 2e6e 6f72 6d61 6c5f 7665 6374  - 1].normal_vect
+00019f20: 6f72 2829 2920 3e20 303a 0a20 2020 2020  or()) > 0:.     
+00019f30: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00019f40: 6920 3d20 2d20 6e69 0a20 2020 2020 2020  i = - ni.       
+00019f50: 2020 2020 2020 2020 2020 2020 2023 2063               # c
+00019f60: 6865 636b 203d 2054 7275 650a 2020 2020  heck = True.    
+00019f70: 2020 2020 2020 2020 2020 2020 6f66 6673              offs
+00019f80: 6574 5f76 6563 746f 7273 2e61 7070 656e  et_vectors.appen
+00019f90: 6428 6e69 290a 0a20 2020 2020 2020 2020  d(ni)..         
+00019fa0: 2020 206e 6f72 6d61 6c5f 7665 6374 6f72     normal_vector
+00019fb0: 3120 3d20 2d20 7665 6374 6f72 735b 3220  1 = - vectors[2 
+00019fc0: 2a20 6920 2d20 315d 2e6e 6f72 6d61 6c5f  * i - 1].normal_
+00019fd0: 7665 6374 6f72 2829 0a20 2020 2020 2020  vector().       
+00019fe0: 2020 2020 206e 6f72 6d61 6c5f 7665 6374       normal_vect
+00019ff0: 6f72 3220 3d20 7665 6374 6f72 735b 3220  or2 = vectors[2 
+0001a000: 2a20 695d 2e6e 6f72 6d61 6c5f 7665 6374  * i].normal_vect
+0001a010: 6f72 2829 0a20 2020 2020 2020 2020 2020  or().           
+0001a020: 206e 6f72 6d61 6c5f 7665 6374 6f72 312e   normal_vector1.
+0001a030: 6e6f 726d 616c 697a 6528 290a 2020 2020  normalize().    
+0001a040: 2020 2020 2020 2020 6e6f 726d 616c 5f76          normal_v
+0001a050: 6563 746f 7232 2e6e 6f72 6d61 6c69 7a65  ector2.normalize
+0001a060: 2829 0a20 2020 2020 2020 2020 2020 2061  ().            a
+0001a070: 6c70 6861 203d 206d 6174 682e 6163 6f73  lpha = math.acos
+0001a080: 286e 6f72 6d61 6c5f 7665 6374 6f72 312e  (normal_vector1.
+0001a090: 646f 7428 6e6f 726d 616c 5f76 6563 746f  dot(normal_vecto
+0001a0a0: 7232 2929 0a0a 2020 2020 2020 2020 2020  r2))..          
+0001a0b0: 2020 6f66 6673 6574 5f70 6f69 6e74 203d    offset_point =
+0001a0c0: 2073 656c 662e 706f 696e 7473 5b69 5d20   self.points[i] 
+0001a0d0: 2b20 6f66 6673 6574 202f 206d 6174 682e  + offset / math.
+0001a0e0: 636f 7328 616c 7068 6120 2f20 3229 202a  cos(alpha / 2) *
+0001a0f0: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+0001a100: 2020 2028 2d6f 6666 7365 745f 7665 6374     (-offset_vect
+0001a110: 6f72 735b 695d 290a 0a20 2020 2020 2020  ors[i])..       
+0001a120: 2020 2020 2023 2061 783d 7365 6c66 2e70       # ax=self.p
+0001a130: 6c6f 7428 290a 2020 2020 2020 2020 2020  lot().          
+0001a140: 2020 2320 6f66 6673 6574 5f70 6f69 6e74    # offset_point
+0001a150: 2e70 6c6f 7428 6178 3d61 782c 2063 6f6c  .plot(ax=ax, col
+0001a160: 6f72 3d27 6727 290a 0a20 2020 2020 2020  or='g')..       
+0001a170: 2020 2020 2023 2069 6620 7365 6c66 2e70       # if self.p
+0001a180: 6f69 6e74 5f62 656c 6f6e 6773 286f 6666  oint_belongs(off
+0001a190: 7365 745f 706f 696e 7429 3a0a 2020 2020  set_point):.    
+0001a1a0: 2020 2020 2020 2020 2320 2020 2020 6f66          #     of
+0001a1b0: 6673 6574 5f70 6f69 6e74 203d 2073 656c  fset_point = sel
+0001a1c0: 662e 706f 696e 7473 5b69 5d20 2b20 6f66  f.points[i] + of
+0001a1d0: 6673 6574 202f 206d 6174 682e 636f 7328  fset / math.cos(
+0001a1e0: 616c 7068 6120 2f20 3229 202a 205c 0a20  alpha / 2) * \. 
+0001a1f0: 2020 2020 2020 2020 2020 2023 2020 2020             #    
+0001a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a210: 282d 6f66 6673 6574 5f76 6563 746f 7273  (-offset_vectors
+0001a220: 5b69 5d29 0a0a 2020 2020 2020 2020 2020  [i])..          
+0001a230: 2020 6f66 6673 6574 5f70 6f69 6e74 732e    offset_points.
+0001a240: 6170 7065 6e64 286f 6666 7365 745f 706f  append(offset_po
+0001a250: 696e 7429 0a0a 2020 2020 2020 2020 2020  int)..          
+0001a260: 2020 2320 7365 6c66 2e70 6f69 6e74 735b    # self.points[
+0001a270: 695d 2e70 6c6f 7428 6178 3d61 782c 2063  i].plot(ax=ax, c
+0001a280: 6f6c 6f72 3d27 6227 290a 2020 2020 2020  olor='b').      
+0001a290: 2020 2020 2020 2320 6f66 6673 6574 5f70        # offset_p
+0001a2a0: 6f69 6e74 2e70 6c6f 7428 6178 3d61 782c  oint.plot(ax=ax,
+0001a2b0: 2063 6f6c 6f72 3d27 7227 290a 0a20 2020   color='r')..   
+0001a2c0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001a2d0: 2e5f 5f63 6c61 7373 5f5f 286f 6666 7365  .__class__(offse
+0001a2e0: 745f 706f 696e 7473 290a 0a20 2020 2064  t_points)..    d
+0001a2f0: 6566 2070 6f69 6e74 5f62 6f72 6465 725f  ef point_border_
+0001a300: 6469 7374 616e 6365 2873 656c 662c 2070  distance(self, p
+0001a310: 6f69 6e74 2c20 7265 7475 726e 5f6f 7468  oint, return_oth
+0001a320: 6572 5f70 6f69 6e74 3d46 616c 7365 293a  er_point=False):
+0001a330: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001a340: 2020 2020 2043 6f6d 7075 7465 2074 6865       Compute the
+0001a350: 2064 6973 7461 6e63 6520 746f 2074 6865   distance to the
+0001a360: 2062 6f72 6465 7220 6469 7374 616e 6365   border distance
+0001a370: 206f 6620 706f 6c79 676f 6e2e 0a20 2020   of polygon..   
+0001a380: 2020 2020 204f 7574 7075 7420 6973 2061       Output is a
+0001a390: 6c77 6179 7320 706f 7369 7469 7665 2c20  lways positive, 
+0001a3a0: 6576 656e 2069 6620 7468 6520 706f 696e  even if the poin
+0001a3b0: 7420 6265 6c6f 6e67 7320 746f 2074 6865  t belongs to the
+0001a3c0: 2070 6f6c 7967 6f6e 2e0a 2020 2020 2020   polygon..      
+0001a3d0: 2020 2222 220a 2020 2020 2020 2020 645f    """.        d_
+0001a3e0: 6d69 6e2c 206f 7468 6572 5f70 6f69 6e74  min, other_point
+0001a3f0: 5f6d 696e 203d 2073 656c 662e 6c69 6e65  _min = self.line
+0001a400: 5f73 6567 6d65 6e74 735b 305d 2e70 6f69  _segments[0].poi
+0001a410: 6e74 5f64 6973 7461 6e63 6528 0a20 2020  nt_distance(.   
+0001a420: 2020 2020 2020 2020 2070 6f69 6e74 2c20           point, 
+0001a430: 7265 7475 726e 5f6f 7468 6572 5f70 6f69  return_other_poi
+0001a440: 6e74 3d54 7275 6529 0a20 2020 2020 2020  nt=True).       
+0001a450: 2066 6f72 206c 696e 6520 696e 2073 656c   for line in sel
+0001a460: 662e 6c69 6e65 5f73 6567 6d65 6e74 735b  f.line_segments[
+0001a470: 313a 5d3a 0a20 2020 2020 2020 2020 2020  1:]:.           
+0001a480: 2064 2c20 6f74 6865 725f 706f 696e 7420   d, other_point 
+0001a490: 3d20 6c69 6e65 2e70 6f69 6e74 5f64 6973  = line.point_dis
+0001a4a0: 7461 6e63 6528 0a20 2020 2020 2020 2020  tance(.         
+0001a4b0: 2020 2020 2020 2070 6f69 6e74 2c20 7265         point, re
+0001a4c0: 7475 726e 5f6f 7468 6572 5f70 6f69 6e74  turn_other_point
+0001a4d0: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
+0001a4e0: 2020 2069 6620 6420 3c20 645f 6d69 6e3a     if d < d_min:
+0001a4f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a500: 2064 5f6d 696e 203d 2064 0a20 2020 2020   d_min = d.     
+0001a510: 2020 2020 2020 2020 2020 206f 7468 6572             other
+0001a520: 5f70 6f69 6e74 5f6d 696e 203d 206f 7468  _point_min = oth
+0001a530: 6572 5f70 6f69 6e74 0a20 2020 2020 2020  er_point.       
+0001a540: 2069 6620 7265 7475 726e 5f6f 7468 6572   if return_other
+0001a550: 5f70 6f69 6e74 3a0a 2020 2020 2020 2020  _point:.        
+0001a560: 2020 2020 7265 7475 726e 2064 5f6d 696e      return d_min
+0001a570: 2c20 6f74 6865 725f 706f 696e 745f 6d69  , other_point_mi
+0001a580: 6e0a 2020 2020 2020 2020 7265 7475 726e  n.        return
+0001a590: 2064 5f6d 696e 0a0a 2020 2020 6465 6620   d_min..    def 
+0001a5a0: 7365 6c66 5f69 6e74 6572 7365 6374 7328  self_intersects(
+0001a5b0: 7365 6c66 293a 0a20 2020 2020 2020 2065  self):.        e
+0001a5c0: 7073 696c 6f6e 203d 2030 0a20 2020 2020  psilon = 0.     
+0001a5d0: 2020 2023 2042 454e 544c 4559 2d4f 5454     # BENTLEY-OTT
+0001a5e0: 4d41 4e4e 2041 4c47 4f52 4954 484d 0a20  MANN ALGORITHM. 
+0001a5f0: 2020 2020 2020 2023 2053 6f72 7420 7468         # Sort th
+0001a600: 6520 706f 696e 7473 2061 6c6f 6e67 2061  e points along a
+0001a610: 7363 656e 6469 6e67 2078 2066 6f72 2074  scending x for t
+0001a620: 6865 2053 7765 6570 204c 696e 6520 6d65  he Sweep Line me
+0001a630: 7468 6f64 0a20 2020 2020 2020 2073 6f72  thod.        sor
+0001a640: 7465 645f 696e 6465 7820 3d20 736f 7274  ted_index = sort
+0001a650: 6564 2872 616e 6765 286c 656e 2873 656c  ed(range(len(sel
+0001a660: 662e 706f 696e 7473 2929 2c20 6b65 793d  f.points)), key=
+0001a670: 6c61 6d62 6461 2070 3a20 280a 2020 2020  lambda p: (.    
+0001a680: 2020 2020 2020 2020 7365 6c66 2e70 6f69          self.poi
+0001a690: 6e74 735b 705d 5b30 5d2c 2073 656c 662e  nts[p][0], self.
+0001a6a0: 706f 696e 7473 5b70 5d5b 315d 2929 0a20  points[p][1])). 
+0001a6b0: 2020 2020 2020 206e 6220 3d20 6c65 6e28         nb = len(
+0001a6c0: 736f 7274 6564 5f69 6e64 6578 290a 2020  sorted_index).  
+0001a6d0: 2020 2020 2020 7365 676d 656e 7473 203d        segments =
+0001a6e0: 205b 5d0a 2020 2020 2020 2020 6465 6c65   [].        dele
+0001a6f0: 7465 6420 3d20 5b5d 0a0a 2020 2020 2020  ted = []..      
+0001a700: 2020 7768 696c 6520 6c65 6e28 0a20 2020    while len(.   
+0001a710: 2020 2020 2020 2020 2020 2020 2073 6f72               sor
+0001a720: 7465 645f 696e 6465 7829 2021 3d20 303a  ted_index) != 0:
+0001a730: 2020 2320 5768 696c 6520 616c 6c20 7468    # While all th
+0001a740: 6520 706f 696e 7473 2068 6176 656e 2774  e points haven't
+0001a750: 2062 6565 6e20 7377 6570 740a 2020 2020   been swept.    
+0001a760: 2020 2020 2020 2020 2320 5374 6f63 6b20          # Stock 
+0001a770: 7468 6520 7365 676d 656e 7473 2062 6574  the segments bet
+0001a780: 7765 656e 2032 2063 6f6e 7365 6375 7469  ween 2 consecuti
+0001a790: 7665 2065 6467 6573 0a20 2020 2020 2020  ve edges.       
+0001a7a0: 2020 2020 2023 2045 783a 2066 6f72 2074       # Ex: for t
+0001a7b0: 6865 2041 4243 4445 2070 6f6c 7967 6f6e  he ABCDE polygon
+0001a7c0: 2c20 6966 2053 7765 6570 204c 696e 6520  , if Sweep Line 
+0001a7d0: 6973 206f 6e20 432c 2074 6865 2073 6567  is on C, the seg
+0001a7e0: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
+0001a7f0: 2020 2320 2020 7769 6c6c 2062 6520 2843    #   will be (C
+0001a800: 2c42 2920 616e 6420 2843 2c44 290a 2020  ,B) and (C,D).  
+0001a810: 2020 2020 2020 2020 2020 6966 2073 6f72            if sor
+0001a820: 7465 645f 696e 6465 785b 305d 202d 2031  ted_index[0] - 1
+0001a830: 203c 2030 3a0a 2020 2020 2020 2020 2020   < 0:.          
+0001a840: 2020 2020 2020 7365 676d 656e 7473 2e61        segments.a
+0001a850: 7070 656e 6428 2873 6f72 7465 645f 696e  ppend((sorted_in
+0001a860: 6465 785b 305d 2c20 6e62 202d 2031 2929  dex[0], nb - 1))
+0001a870: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0001a880: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001a890: 2020 2073 6567 6d65 6e74 732e 6170 7065     segments.appe
+0001a8a0: 6e64 2828 736f 7274 6564 5f69 6e64 6578  nd((sorted_index
+0001a8b0: 5b30 5d2c 2073 6f72 7465 645f 696e 6465  [0], sorted_inde
+0001a8c0: 785b 305d 202d 2031 2929 0a20 2020 2020  x[0] - 1)).     
+0001a8d0: 2020 2020 2020 2069 6620 736f 7274 6564         if sorted
+0001a8e0: 5f69 6e64 6578 5b30 5d20 3e3d 206c 656e  _index[0] >= len
+0001a8f0: 2873 656c 662e 706f 696e 7473 2920 2d20  (self.points) - 
+0001a900: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+0001a910: 2020 2073 6567 6d65 6e74 732e 6170 7065     segments.appe
+0001a920: 6e64 2828 736f 7274 6564 5f69 6e64 6578  nd((sorted_index
+0001a930: 5b30 5d2c 2030 2929 0a20 2020 2020 2020  [0], 0)).       
+0001a940: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001a950: 2020 2020 2020 2020 2020 2073 6567 6d65             segme
+0001a960: 6e74 732e 6170 7065 6e64 2828 736f 7274  nts.append((sort
+0001a970: 6564 5f69 6e64 6578 5b30 5d2c 2073 6f72  ed_index[0], sor
+0001a980: 7465 645f 696e 6465 785b 305d 202b 2031  ted_index[0] + 1
+0001a990: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
+0001a9a0: 2320 4f6e 6365 2074 776f 2065 6467 6573  # Once two edges
+0001a9b0: 206c 696e 6b65 6420 6279 2061 2073 6567   linked by a seg
+0001a9c0: 6d65 6e74 2068 6176 6520 6265 656e 2073  ment have been s
+0001a9d0: 7765 7074 2c20 6465 6c65 7465 2074 6865  wept, delete the
+0001a9e0: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
+0001a9f0: 6567 6d65 6e74 2066 726f 6d20 7468 6520  egment from the 
+0001aa00: 6c69 7374 0a20 2020 2020 2020 2020 2020  list.           
+0001aa10: 2074 6f5f 6465 6c20 3d20 5b5d 0a20 2020   to_del = [].   
+0001aa20: 2020 2020 2020 2020 2066 6f72 2069 6e64           for ind
+0001aa30: 6578 2069 6e20 6465 6c65 7465 643a 0a20  ex in deleted:. 
+0001aa40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001aa50: 6620 6162 7328 696e 6465 7820 2d20 736f  f abs(index - so
+0001aa60: 7274 6564 5f69 6e64 6578 5b30 5d29 203d  rted_index[0]) =
+0001aa70: 3d20 3120 6f72 2061 6273 280a 2020 2020  = 1 or abs(.    
+0001aa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aa90: 2020 2020 696e 6465 7820 2d20 736f 7274      index - sort
+0001aaa0: 6564 5f69 6e64 6578 5b30 5d29 203d 3d20  ed_index[0]) == 
+0001aab0: 6e62 202d 2031 3a0a 2020 2020 2020 2020  nb - 1:.        
+0001aac0: 2020 2020 2020 2020 2020 2020 746f 5f64              to_d
+0001aad0: 656c 2e61 7070 656e 6428 2869 6e64 6578  el.append((index
+0001aae0: 2c20 736f 7274 6564 5f69 6e64 6578 5b30  , sorted_index[0
+0001aaf0: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
+0001ab00: 2020 2020 2020 2020 746f 5f64 656c 2e61          to_del.a
+0001ab10: 7070 656e 6428 2873 6f72 7465 645f 696e  ppend((sorted_in
+0001ab20: 6465 785b 305d 2c20 696e 6465 7829 290a  dex[0], index)).
+0001ab30: 0a20 2020 2020 2020 2020 2020 2023 204b  .            # K
+0001ab40: 6565 7020 7472 6163 6b20 6f66 2077 6869  eep track of whi
+0001ab50: 6368 2065 6467 6573 2068 6176 6520 6265  ch edges have be
+0001ab60: 656e 2073 7765 7074 0a20 2020 2020 2020  en swept.       
+0001ab70: 2020 2020 2064 656c 6574 6564 2e61 7070       deleted.app
+0001ab80: 656e 6428 736f 7274 6564 5f69 6e64 6578  end(sorted_index
+0001ab90: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
+0001aba0: 2073 6f72 7465 645f 696e 6465 782e 706f   sorted_index.po
+0001abb0: 7028 3029 0a0a 2020 2020 2020 2020 2020  p(0)..          
+0001abc0: 2020 2320 4465 6c65 7465 2074 6865 2073    # Delete the s
+0001abd0: 6567 6d65 6e74 7320 7468 6174 2068 6176  egments that hav
+0001abe0: 6520 6a75 7374 2062 6565 6e20 7377 6570  e just been swep
+0001abf0: 740a 2020 2020 2020 2020 2020 2020 696e  t.            in
+0001ac00: 6465 785f 746f 5f64 656c 203d 205b 5d0a  dex_to_del = [].
+0001ac10: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0001ac20: 692c 2073 6567 6d65 6e74 2069 6e20 656e  i, segment in en
+0001ac30: 756d 6572 6174 6528 7365 676d 656e 7473  umerate(segments
+0001ac40: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0001ac50: 2020 2066 6f72 2073 6567 5f74 6f5f 6465     for seg_to_de
+0001ac60: 6c20 696e 2074 6f5f 6465 6c3a 0a20 2020  l in to_del:.   
+0001ac70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ac80: 2069 6620 7365 676d 656e 7420 3d3d 2073   if segment == s
+0001ac90: 6567 5f74 6f5f 6465 6c3a 0a20 2020 2020  eg_to_del:.     
+0001aca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001acb0: 2020 2069 6e64 6578 5f74 6f5f 6465 6c2e     index_to_del.
+0001acc0: 6170 7065 6e64 2869 290a 2020 2020 2020  append(i).      
+0001acd0: 2020 2020 2020 666f 7220 696e 6465 7820        for index 
+0001ace0: 696e 2069 6e64 6578 5f74 6f5f 6465 6c5b  in index_to_del[
+0001acf0: 3a3a 2d31 5d3a 0a20 2020 2020 2020 2020  ::-1]:.         
+0001ad00: 2020 2020 2020 2073 6567 6d65 6e74 732e         segments.
+0001ad10: 706f 7028 696e 6465 7829 0a0a 2020 2020  pop(index)..    
+0001ad20: 2020 2020 2020 2020 2320 4368 6563 6b73          # Checks
+0001ad30: 2069 6620 7477 6f20 7365 676d 656e 7473   if two segments
+0001ad40: 2061 7265 2069 6e74 6572 7365 6374 696e   are intersectin
+0001ad50: 6720 6561 6368 206f 7468 6572 2c20 7265  g each other, re
+0001ad60: 7475 726e 7320 5472 7565 0a20 2020 2020  turns True.     
+0001ad70: 2020 2020 2020 2023 2069 6620 7965 732c         # if yes,
+0001ad80: 206f 7468 6572 7769 7365 2074 6865 2061   otherwise the a
+0001ad90: 6c67 6f72 6974 686d 2063 6f6e 7469 6e75  lgorithm continu
+0001ada0: 6573 2061 7420 5748 494c 450a 2020 2020  es at WHILE.    
+0001adb0: 2020 2020 2020 2020 666f 7220 7365 676d          for segm
+0001adc0: 656e 7431 2069 6e20 7365 676d 656e 7473  ent1 in segments
+0001add0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001ade0: 2020 666f 7220 7365 676d 656e 7432 2069    for segment2 i
+0001adf0: 6e20 7365 676d 656e 7473 3a0a 2020 2020  n segments:.    
+0001ae00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae10: 6966 2073 6567 6d65 6e74 315b 305d 2021  if segment1[0] !
+0001ae20: 3d20 7365 676d 656e 7432 5b30 5d20 616e  = segment2[0] an
+0001ae30: 6420 7365 676d 656e 7431 5b31 5d20 213d  d segment1[1] !=
+0001ae40: 2073 6567 6d65 6e74 325b 0a20 2020 2020   segment2[.     
+0001ae50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae60: 2020 2031 5d20 616e 6420 7365 676d 656e     1] and segmen
+0001ae70: 7431 5b30 5d20 213d 2073 6567 6d65 6e74  t1[0] != segment
+0001ae80: 325b 315d 2061 6e64 2073 6567 6d65 6e74  2[1] and segment
+0001ae90: 315b 315d 2021 3d20 5c0a 2020 2020 2020  1[1] != \.      
+0001aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aeb0: 2020 2020 2020 7365 676d 656e 7432 5b30        segment2[0
+0001aec0: 5d3a 0a0a 2020 2020 2020 2020 2020 2020  ]:..            
+0001aed0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+0001aee0: 3120 3d20 766f 6c6d 646c 722e 6564 6765  1 = volmdlr.edge
+0001aef0: 732e 4c69 6e65 5365 676d 656e 7432 4428  s.LineSegment2D(
+0001af00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001af10: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001af20: 662e 706f 696e 7473 5b73 6567 6d65 6e74  f.points[segment
+0001af30: 315b 305d 5d2c 0a20 2020 2020 2020 2020  1[0]],.         
+0001af40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af50: 2020 2073 656c 662e 706f 696e 7473 5b73     self.points[s
+0001af60: 6567 6d65 6e74 315b 315d 5d29 0a20 2020  egment1[1]]).   
+0001af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af80: 2020 2020 206c 696e 6532 203d 2076 6f6c       line2 = vol
+0001af90: 6d64 6c72 2e65 6467 6573 2e4c 696e 6553  mdlr.edges.LineS
+0001afa0: 6567 6d65 6e74 3244 280a 2020 2020 2020  egment2D(.      
+0001afb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001afc0: 2020 2020 2020 7365 6c66 2e70 6f69 6e74        self.point
+0001afd0: 735b 7365 676d 656e 7432 5b30 5d5d 2c0a  s[segment2[0]],.
 0001afe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aff0: 2020 2020 7365 6c66 2e70 6f69 6e74 735b      self.points[
-0001b000: 7365 676d 656e 7432 5b31 5d5d 290a 0a20  segment2[1]]).. 
-0001b010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b020: 2020 2020 2020 2070 2c20 612c 2062 203d         p, a, b =
-0001b030: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3244   volmdlr.Point2D
-0001b040: 2e6c 696e 655f 696e 7465 7273 6563 7469  .line_intersecti
-0001b050: 6f6e 286c 696e 6531 2c0a 2020 2020 2020  on(line1,.      
-0001b060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aff0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001b000: 2e70 6f69 6e74 735b 7365 676d 656e 7432  .points[segment2
+0001b010: 5b31 5d5d 290a 0a20 2020 2020 2020 2020  [1]])..         
+0001b020: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001b030: 2c20 612c 2062 203d 2076 6f6c 6d64 6c72  , a, b = volmdlr
+0001b040: 2e50 6f69 6e74 3244 2e6c 696e 655f 696e  .Point2D.line_in
+0001b050: 7465 7273 6563 7469 6f6e 286c 696e 6531  tersection(line1
+0001b060: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 0001b070: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b090: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-0001b0a0: 6e65 322c 0a20 2020 2020 2020 2020 2020  ne2,.           
+0001b090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b0a0: 2020 2020 2020 6c69 6e65 322c 0a20 2020        line2,.   
 0001b0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b0e0: 2020 2020 2020 2020 2054 7275 6529 0a20           True). 
-0001b0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b100: 2020 2020 2020 2069 6620 7020 6973 206e         if p is n
-0001b110: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0001b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b130: 2020 2020 2069 6620 3020 2b20 6570 7369       if 0 + epsi
-0001b140: 6c6f 6e20 3c3d 2061 203c 3d20 3120 2d20  lon <= a <= 1 - 
-0001b150: 6570 7369 6c6f 6e20 5c0a 2020 2020 2020  epsilon \.      
-0001b160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b170: 2020 2020 2020 2020 2020 2020 2020 616e                an
-0001b180: 6420 3020 2b20 6570 7369 6c6f 6e20 3c3d  d 0 + epsilon <=
-0001b190: 2062 203c 3d20 3120 2d20 6570 7369 6c6f   b <= 1 - epsilo
-0001b1a0: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
+0001b0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b0f0: 2054 7275 6529 0a20 2020 2020 2020 2020   True).         
+0001b100: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001b110: 6620 7020 6973 206e 6f74 204e 6f6e 653a  f p is not None:
+0001b120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b130: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001b140: 3020 2b20 6570 7369 6c6f 6e20 3c3d 2061  0 + epsilon <= a
+0001b150: 203c 3d20 3120 2d20 6570 7369 6c6f 6e20   <= 1 - epsilon 
+0001b160: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+0001b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b180: 2020 2020 2020 616e 6420 3020 2b20 6570        and 0 + ep
+0001b190: 7369 6c6f 6e20 3c3d 2062 203c 3d20 3120  silon <= b <= 1 
+0001b1a0: 2d20 6570 7369 6c6f 6e3a 0a20 2020 2020  - epsilon:.     
 0001b1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b1c0: 2020 2072 6574 7572 6e20 5472 7565 2c20     return True, 
-0001b1d0: 6c69 6e65 312c 206c 696e 6532 0a0a 2020  line1, line2..  
-0001b1e0: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
-0001b1f0: 7365 2c20 4e6f 6e65 2c20 4e6f 6e65 0a0a  se, None, None..
-0001b200: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-0001b210: 0a20 2020 2064 6566 2070 6f69 6e74 735f  .    def points_
-0001b220: 636f 6e76 6578 5f68 756c 6c28 636c 732c  convex_hull(cls,
-0001b230: 2070 6f69 6e74 7329 3a0a 2020 2020 2020   points):.      
-0001b240: 2020 6966 206c 656e 2870 6f69 6e74 7329    if len(points)
-0001b250: 203c 2033 3a0a 2020 2020 2020 2020 2020   < 3:.          
-0001b260: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
-0001b270: 2020 706f 696e 7473 5f68 756c 6c20 3d20    points_hull = 
-0001b280: 5b70 742e 636f 7079 2829 2066 6f72 2070  [pt.copy() for p
-0001b290: 7420 696e 2070 6f69 6e74 735d 0a0a 2020  t in points]..  
-0001b2a0: 2020 2020 2020 5f2c 2070 6f73 5f79 6d61        _, pos_yma
-0001b2b0: 7820 3d20 6172 676d 6178 285b 7074 2e79  x = argmax([pt.y
-0001b2c0: 2066 6f72 2070 7420 696e 2070 6f69 6e74   for pt in point
-0001b2d0: 735f 6875 6c6c 5d29 0a20 2020 2020 2020  s_hull]).       
-0001b2e0: 2070 6f69 6e74 5f73 7461 7274 203d 2070   point_start = p
-0001b2f0: 6f69 6e74 735f 6875 6c6c 5b70 6f73 5f79  oints_hull[pos_y
-0001b300: 6d61 785d 0a20 2020 2020 2020 2068 756c  max].        hul
-0001b310: 6c20 3d20 5b70 6f69 6e74 5f73 7461 7274  l = [point_start
-0001b320: 5d0a 0a20 2020 2020 2020 2062 6172 7963  ]..        baryc
-0001b330: 656e 7465 7220 3d20 706f 696e 7473 5f68  enter = points_h
-0001b340: 756c 6c5b 305d 0a20 2020 2020 2020 2066  ull[0].        f
-0001b350: 6f72 2070 7420 696e 2070 6f69 6e74 735f  or pt in points_
-0001b360: 6875 6c6c 5b31 3a5d 3a0a 2020 2020 2020  hull[1:]:.      
-0001b370: 2020 2020 2020 6261 7279 6365 6e74 6572        barycenter
-0001b380: 202b 3d20 7074 0a20 2020 2020 2020 2062   += pt.        b
-0001b390: 6172 7963 656e 7465 7220 3d20 6261 7279  arycenter = bary
-0001b3a0: 6365 6e74 6572 202f 2028 6c65 6e28 706f  center / (len(po
-0001b3b0: 696e 7473 5f68 756c 6c29 290a 2020 2020  ints_hull)).    
-0001b3c0: 2020 2020 2320 7365 636f 6e64 2070 6f69      # second poi
-0001b3d0: 6e74 206f 6620 6875 6c6c 0a20 2020 2020  nt of hull.     
-0001b3e0: 2020 2074 6865 7461 203d 205b 5d0a 2020     theta = [].  
-0001b3f0: 2020 2020 2020 7265 6d61 696e 696e 675f        remaining_
-0001b400: 706f 696e 7473 203d 2070 6f69 6e74 735f  points = points_
-0001b410: 6875 6c6c 0a20 2020 2020 2020 2064 656c  hull.        del
-0001b420: 2072 656d 6169 6e69 6e67 5f70 6f69 6e74   remaining_point
-0001b430: 735b 706f 735f 796d 6178 5d0a 0a20 2020  s[pos_ymax]..   
-0001b440: 2020 2020 2076 6563 3120 3d20 706f 696e       vec1 = poin
-0001b450: 745f 7374 6172 7420 2d20 6261 7279 6365  t_start - baryce
-0001b460: 6e74 6572 0a20 2020 2020 2020 2066 6f72  nter.        for
-0001b470: 2070 7420 696e 2072 656d 6169 6e69 6e67   pt in remaining
-0001b480: 5f70 6f69 6e74 733a 0a20 2020 2020 2020  _points:.       
-0001b490: 2020 2020 2076 6563 3220 3d20 7074 202d       vec2 = pt -
-0001b4a0: 2070 6f69 6e74 5f73 7461 7274 0a20 2020   point_start.   
-0001b4b0: 2020 2020 2020 2020 2074 6865 7461 5f69           theta_i
-0001b4c0: 203d 202d 766f 6c6d 646c 722e 6765 6f6d   = -volmdlr.geom
-0001b4d0: 6574 7279 2e63 6c6f 636b 7769 7365 5f61  etry.clockwise_a
-0001b4e0: 6e67 6c65 2876 6563 312c 2076 6563 3229  ngle(vec1, vec2)
-0001b4f0: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-0001b500: 7461 2e61 7070 656e 6428 7468 6574 615f  ta.append(theta_
-0001b510: 6929 0a0a 2020 2020 2020 2020 6d69 6e5f  i)..        min_
-0001b520: 7468 6574 612c 2070 6f73 6d69 6e5f 7468  theta, posmin_th
-0001b530: 6574 6120 3d20 6172 676d 696e 2874 6865  eta = argmin(the
-0001b540: 7461 290a 2020 2020 2020 2020 6e65 7874  ta).        next
-0001b550: 5f70 6f69 6e74 203d 2072 656d 6169 6e69  _point = remaini
-0001b560: 6e67 5f70 6f69 6e74 735b 706f 736d 696e  ng_points[posmin
-0001b570: 5f74 6865 7461 5d0a 2020 2020 2020 2020  _theta].        
-0001b580: 6875 6c6c 2e61 7070 656e 6428 6e65 7874  hull.append(next
-0001b590: 5f70 6f69 6e74 290a 2020 2020 2020 2020  _point).        
-0001b5a0: 6465 6c20 7265 6d61 696e 696e 675f 706f  del remaining_po
-0001b5b0: 696e 7473 5b70 6f73 6d69 6e5f 7468 6574  ints[posmin_thet
-0001b5c0: 615d 0a20 2020 2020 2020 2023 2041 6464  a].        # Add
-0001b5d0: 696e 6720 6669 7273 7420 706f 696e 7420  ing first point 
-0001b5e0: 746f 2063 6c6f 7365 2074 6865 206c 6f6f  to close the loo
-0001b5f0: 7020 6174 2074 6865 2065 6e64 0a20 2020  p at the end.   
-0001b600: 2020 2020 2072 656d 6169 6e69 6e67 5f70       remaining_p
-0001b610: 6f69 6e74 732e 6170 7065 6e64 2868 756c  oints.append(hul
-0001b620: 6c5b 305d 290a 0a20 2020 2020 2020 2069  l[0])..        i
-0001b630: 6e69 7469 616c 5f76 6563 746f 7220 3d20  nitial_vector = 
-0001b640: 7665 6331 2e63 6f70 7928 290a 2020 2020  vec1.copy().    
-0001b650: 2020 2020 746f 7461 6c5f 616e 676c 6520      total_angle 
-0001b660: 3d20 300a 2020 2020 2020 2020 7768 696c  = 0.        whil
-0001b670: 6520 6e65 7874 5f70 6f69 6e74 2021 3d20  e next_point != 
-0001b680: 706f 696e 745f 7374 6172 743a 0a20 2020  point_start:.   
-0001b690: 2020 2020 2020 2020 2076 6563 3120 3d20           vec1 = 
-0001b6a0: 6e65 7874 5f70 6f69 6e74 202d 2068 756c  next_point - hul
-0001b6b0: 6c5b 2d32 5d0a 2020 2020 2020 2020 2020  l[-2].          
-0001b6c0: 2020 7468 6574 6120 3d20 5b5d 0a20 2020    theta = [].   
-0001b6d0: 2020 2020 2020 2020 2066 6f72 2070 7420           for pt 
-0001b6e0: 696e 2072 656d 6169 6e69 6e67 5f70 6f69  in remaining_poi
-0001b6f0: 6e74 733a 0a20 2020 2020 2020 2020 2020  nts:.           
-0001b700: 2020 2020 2076 6563 3220 3d20 7074 202d       vec2 = pt -
-0001b710: 206e 6578 745f 706f 696e 740a 2020 2020   next_point.    
-0001b720: 2020 2020 2020 2020 2020 2020 7468 6574              thet
-0001b730: 615f 6920 3d20 2d76 6f6c 6d64 6c72 2e67  a_i = -volmdlr.g
-0001b740: 656f 6d65 7472 792e 636c 6f63 6b77 6973  eometry.clockwis
-0001b750: 655f 616e 676c 6528 7665 6331 2c20 7665  e_angle(vec1, ve
-0001b760: 6332 290a 2020 2020 2020 2020 2020 2020  c2).            
-0001b770: 2020 2020 7468 6574 612e 6170 7065 6e64      theta.append
-0001b780: 2874 6865 7461 5f69 290a 0a20 2020 2020  (theta_i)..     
-0001b790: 2020 2020 2020 206d 696e 5f74 6865 7461         min_theta
-0001b7a0: 2c20 706f 736d 696e 5f74 6865 7461 203d  , posmin_theta =
-0001b7b0: 2061 7267 6d69 6e28 7468 6574 6129 0a20   argmin(theta). 
-0001b7c0: 2020 2020 2020 2020 2020 2069 6620 6d61             if ma
-0001b7d0: 7468 2e69 7363 6c6f 7365 286d 696e 5f74  th.isclose(min_t
-0001b7e0: 6865 7461 2c20 2d32 202a 206d 6174 682e  heta, -2 * math.
-0001b7f0: 7069 2c20 6162 735f 746f 6c3d 3165 2d36  pi, abs_tol=1e-6
-0001b800: 2920 5c0a 2020 2020 2020 2020 2020 2020  ) \.            
-0001b810: 2020 2020 2020 2020 6f72 206d 6174 682e          or math.
-0001b820: 6973 636c 6f73 6528 6d69 6e5f 7468 6574  isclose(min_thet
-0001b830: 612c 2030 2c20 6162 735f 746f 6c3d 3165  a, 0, abs_tol=1e
-0001b840: 2d36 293a 0a20 2020 2020 2020 2020 2020  -6):.           
-0001b850: 2020 2020 2069 6620 7265 6d61 696e 696e       if remainin
-0001b860: 675f 706f 696e 7473 5b70 6f73 6d69 6e5f  g_points[posmin_
-0001b870: 7468 6574 615d 203d 3d20 706f 696e 745f  theta] == point_
-0001b880: 7374 6172 743a 0a20 2020 2020 2020 2020  start:.         
-0001b890: 2020 2020 2020 2020 2020 2062 7265 616b             break
-0001b8a0: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0001b8b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001b8c0: 2020 2020 6e65 7874 5f70 6f69 6e74 203d      next_point =
-0001b8d0: 2072 656d 6169 6e69 6e67 5f70 6f69 6e74   remaining_point
-0001b8e0: 735b 706f 736d 696e 5f74 6865 7461 5d0a  s[posmin_theta].
-0001b8f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b900: 2076 6563 5f6e 6578 745f 706f 696e 7420   vec_next_point 
-0001b910: 3d20 6e65 7874 5f70 6f69 6e74 202d 2062  = next_point - b
-0001b920: 6172 7963 656e 7465 720a 2020 2020 2020  arycenter.      
-0001b930: 2020 2020 2020 2020 2020 746f 7461 6c5f            total_
-0001b940: 616e 676c 6520 2b3d 2028 3220 2a20 6d61  angle += (2 * ma
-0001b950: 7468 2e70 6920 2d20 766f 6c6d 646c 722e  th.pi - volmdlr.
-0001b960: 6765 6f6d 6574 7279 2e63 6c6f 636b 7769  geometry.clockwi
-0001b970: 7365 5f61 6e67 6c65 2869 6e69 7469 616c  se_angle(initial
-0001b980: 5f76 6563 746f 722c 2076 6563 5f6e 6578  _vector, vec_nex
-0001b990: 745f 706f 696e 7429 290a 0a20 2020 2020  t_point))..     
-0001b9a0: 2020 2020 2020 2020 2020 2069 6620 746f             if to
-0001b9b0: 7461 6c5f 616e 676c 6520 3e20 3220 2a20  tal_angle > 2 * 
-0001b9c0: 6d61 7468 2e70 693a 0a20 2020 2020 2020  math.pi:.       
-0001b9d0: 2020 2020 2020 2020 2020 2020 2062 7265               bre
-0001b9e0: 616b 0a20 2020 2020 2020 2020 2020 2020  ak.             
-0001b9f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001ba00: 2020 2020 2020 2020 2020 2020 2069 6e69               ini
-0001ba10: 7469 616c 5f76 6563 746f 7220 3d20 7665  tial_vector = ve
-0001ba20: 635f 6e65 7874 5f70 6f69 6e74 0a0a 2020  c_next_point..  
-0001ba30: 2020 2020 2020 2020 2020 2020 2020 6875                hu
-0001ba40: 6c6c 2e61 7070 656e 6428 6e65 7874 5f70  ll.append(next_p
-0001ba50: 6f69 6e74 290a 0a20 2020 2020 2020 2020  oint)..         
-0001ba60: 2020 2064 656c 2072 656d 6169 6e69 6e67     del remaining
-0001ba70: 5f70 6f69 6e74 735b 706f 736d 696e 5f74  _points[posmin_t
-0001ba80: 6865 7461 5d0a 0a20 2020 2020 2020 2068  heta]..        h
-0001ba90: 756c 6c2e 706f 7028 290a 0a20 2020 2020  ull.pop()..     
-0001baa0: 2020 2072 6574 7572 6e20 636c 7328 6875     return cls(hu
-0001bab0: 6c6c 290a 0a20 2020 2040 636c 6173 736d  ll)..    @classm
-0001bac0: 6574 686f 640a 2020 2020 6465 6620 636f  ethod.    def co
-0001bad0: 6e63 6176 655f 6875 6c6c 2863 6c73 2c20  ncave_hull(cls, 
-0001bae0: 706f 696e 7473 2c20 636f 6e63 6176 6974  points, concavit
-0001baf0: 792c 2073 6361 6c65 5f66 6163 746f 7229  y, scale_factor)
-0001bb00: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0001bb10: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
-0001bb20: 2074 6865 2063 6f6e 6361 7665 2068 756c   the concave hul
-0001bb30: 6c20 6672 6f6d 2061 2063 6c6f 7564 206f  l from a cloud o
-0001bb40: 6620 706f 696e 7473 2c20 692e 652e 2c20  f points, i.e., 
-0001bb50: 6974 2055 6e69 7465 7320 616c 6c20 706f  it Unites all po
-0001bb60: 696e 7473 2075 6e64 6572 2074 6865 2073  ints under the s
-0001bb70: 6d61 6c6c 6573 7420 706f 7373 6962 6c65  mallest possible
-0001bb80: 2061 7265 612e 0a0a 2020 2020 2020 2020   area...        
-0001bb90: 3a70 6172 616d 2070 6f69 6e74 733a 206c  :param points: l
-0001bba0: 6973 7420 6f66 2070 6f69 6e74 7320 636f  ist of points co
-0001bbb0: 7272 6573 706f 6e64 696e 6720 746f 2074  rresponding to t
-0001bbc0: 6865 2063 6c6f 7564 206f 6620 706f 696e  he cloud of poin
-0001bbd0: 7473 0a20 2020 2020 2020 203a 7479 7065  ts.        :type
-0001bbe0: 2070 6f69 6e74 733a 2063 6c61 7373 3a20   points: class: 
-0001bbf0: 2776 6f6c 6d64 6c72 2e50 6f69 6e74 3244  'volmdlr.Point2D
-0001bc00: 270a 2020 2020 2020 2020 3a70 6172 616d  '.        :param
-0001bc10: 2063 6f6e 6361 7669 7479 3a20 5365 7473   concavity: Sets
-0001bc20: 2068 6f77 2073 6861 7270 2074 6865 2063   how sharp the c
-0001bc30: 6f6e 6361 7665 2061 6e67 6c65 7320 6361  oncave angles ca
-0001bc40: 6e20 6265 2e20 4974 2067 6f65 7320 6672  n be. It goes fr
-0001bc50: 6f6d 202d 3120 286e 6f74 2063 6f6e 6361  om -1 (not conca
-0001bc60: 7665 2061 7420 616c 6c2e 2069 6e20 6661  ve at all. in fa
-0001bc70: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
-0001bc80: 2020 2020 2020 2020 2020 2020 2020 7468                th
-0001bc90: 6520 6875 6c6c 2077 696c 6c20 6265 206c  e hull will be l
-0001bca0: 6566 7420 636f 6e76 6578 2920 7570 2074  eft convex) up t
-0001bcb0: 6f20 2b31 2028 7665 7279 2073 6861 7270  o +1 (very sharp
-0001bcc0: 2061 6e67 6c65 7320 6361 6e20 6f63 6375   angles can occu
-0001bcd0: 722e 2053 6574 7469 6e67 2063 6f6e 6361  r. Setting conca
-0001bce0: 7669 7479 2074 6f0a 2020 2020 2020 2020  vity to.        
+0001b1c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001b1d0: 6e20 5472 7565 2c20 6c69 6e65 312c 206c  n True, line1, l
+0001b1e0: 696e 6532 0a0a 2020 2020 2020 2020 7265  ine2..        re
+0001b1f0: 7475 726e 2046 616c 7365 2c20 4e6f 6e65  turn False, None
+0001b200: 2c20 4e6f 6e65 0a0a 2020 2020 4063 6c61  , None..    @cla
+0001b210: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+0001b220: 2070 6f69 6e74 735f 636f 6e76 6578 5f68   points_convex_h
+0001b230: 756c 6c28 636c 732c 2070 6f69 6e74 7329  ull(cls, points)
+0001b240: 3a0a 2020 2020 2020 2020 6966 206c 656e  :.        if len
+0001b250: 2870 6f69 6e74 7329 203c 2033 3a0a 2020  (points) < 3:.  
+0001b260: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001b270: 0a0a 2020 2020 2020 2020 706f 696e 7473  ..        points
+0001b280: 5f68 756c 6c20 3d20 5b70 742e 636f 7079  _hull = [pt.copy
+0001b290: 2829 2066 6f72 2070 7420 696e 2070 6f69  () for pt in poi
+0001b2a0: 6e74 735d 0a0a 2020 2020 2020 2020 5f2c  nts]..        _,
+0001b2b0: 2070 6f73 5f79 6d61 7820 3d20 6172 676d   pos_ymax = argm
+0001b2c0: 6178 285b 7074 2e79 2066 6f72 2070 7420  ax([pt.y for pt 
+0001b2d0: 696e 2070 6f69 6e74 735f 6875 6c6c 5d29  in points_hull])
+0001b2e0: 0a20 2020 2020 2020 2070 6f69 6e74 5f73  .        point_s
+0001b2f0: 7461 7274 203d 2070 6f69 6e74 735f 6875  tart = points_hu
+0001b300: 6c6c 5b70 6f73 5f79 6d61 785d 0a20 2020  ll[pos_ymax].   
+0001b310: 2020 2020 2068 756c 6c20 3d20 5b70 6f69       hull = [poi
+0001b320: 6e74 5f73 7461 7274 5d0a 0a20 2020 2020  nt_start]..     
+0001b330: 2020 2062 6172 7963 656e 7465 7220 3d20     barycenter = 
+0001b340: 706f 696e 7473 5f68 756c 6c5b 305d 0a20  points_hull[0]. 
+0001b350: 2020 2020 2020 2066 6f72 2070 7420 696e         for pt in
+0001b360: 2070 6f69 6e74 735f 6875 6c6c 5b31 3a5d   points_hull[1:]
+0001b370: 3a0a 2020 2020 2020 2020 2020 2020 6261  :.            ba
+0001b380: 7279 6365 6e74 6572 202b 3d20 7074 0a20  rycenter += pt. 
+0001b390: 2020 2020 2020 2062 6172 7963 656e 7465         barycente
+0001b3a0: 7220 3d20 6261 7279 6365 6e74 6572 202f  r = barycenter /
+0001b3b0: 2028 6c65 6e28 706f 696e 7473 5f68 756c   (len(points_hul
+0001b3c0: 6c29 290a 2020 2020 2020 2020 2320 7365  l)).        # se
+0001b3d0: 636f 6e64 2070 6f69 6e74 206f 6620 6875  cond point of hu
+0001b3e0: 6c6c 0a20 2020 2020 2020 2074 6865 7461  ll.        theta
+0001b3f0: 203d 205b 5d0a 2020 2020 2020 2020 7265   = [].        re
+0001b400: 6d61 696e 696e 675f 706f 696e 7473 203d  maining_points =
+0001b410: 2070 6f69 6e74 735f 6875 6c6c 0a20 2020   points_hull.   
+0001b420: 2020 2020 2064 656c 2072 656d 6169 6e69       del remaini
+0001b430: 6e67 5f70 6f69 6e74 735b 706f 735f 796d  ng_points[pos_ym
+0001b440: 6178 5d0a 0a20 2020 2020 2020 2076 6563  ax]..        vec
+0001b450: 3120 3d20 706f 696e 745f 7374 6172 7420  1 = point_start 
+0001b460: 2d20 6261 7279 6365 6e74 6572 0a20 2020  - barycenter.   
+0001b470: 2020 2020 2066 6f72 2070 7420 696e 2072       for pt in r
+0001b480: 656d 6169 6e69 6e67 5f70 6f69 6e74 733a  emaining_points:
+0001b490: 0a20 2020 2020 2020 2020 2020 2076 6563  .            vec
+0001b4a0: 3220 3d20 7074 202d 2070 6f69 6e74 5f73  2 = pt - point_s
+0001b4b0: 7461 7274 0a20 2020 2020 2020 2020 2020  tart.           
+0001b4c0: 2074 6865 7461 5f69 203d 202d 766f 6c6d   theta_i = -volm
+0001b4d0: 646c 722e 6765 6f6d 6574 7279 2e63 6c6f  dlr.geometry.clo
+0001b4e0: 636b 7769 7365 5f61 6e67 6c65 2876 6563  ckwise_angle(vec
+0001b4f0: 312c 2076 6563 3229 0a20 2020 2020 2020  1, vec2).       
+0001b500: 2020 2020 2074 6865 7461 2e61 7070 656e       theta.appen
+0001b510: 6428 7468 6574 615f 6929 0a0a 2020 2020  d(theta_i)..    
+0001b520: 2020 2020 6d69 6e5f 7468 6574 612c 2070      min_theta, p
+0001b530: 6f73 6d69 6e5f 7468 6574 6120 3d20 6172  osmin_theta = ar
+0001b540: 676d 696e 2874 6865 7461 290a 2020 2020  gmin(theta).    
+0001b550: 2020 2020 6e65 7874 5f70 6f69 6e74 203d      next_point =
+0001b560: 2072 656d 6169 6e69 6e67 5f70 6f69 6e74   remaining_point
+0001b570: 735b 706f 736d 696e 5f74 6865 7461 5d0a  s[posmin_theta].
+0001b580: 2020 2020 2020 2020 6875 6c6c 2e61 7070          hull.app
+0001b590: 656e 6428 6e65 7874 5f70 6f69 6e74 290a  end(next_point).
+0001b5a0: 2020 2020 2020 2020 6465 6c20 7265 6d61          del rema
+0001b5b0: 696e 696e 675f 706f 696e 7473 5b70 6f73  ining_points[pos
+0001b5c0: 6d69 6e5f 7468 6574 615d 0a20 2020 2020  min_theta].     
+0001b5d0: 2020 2023 2041 6464 696e 6720 6669 7273     # Adding firs
+0001b5e0: 7420 706f 696e 7420 746f 2063 6c6f 7365  t point to close
+0001b5f0: 2074 6865 206c 6f6f 7020 6174 2074 6865   the loop at the
+0001b600: 2065 6e64 0a20 2020 2020 2020 2072 656d   end.        rem
+0001b610: 6169 6e69 6e67 5f70 6f69 6e74 732e 6170  aining_points.ap
+0001b620: 7065 6e64 2868 756c 6c5b 305d 290a 0a20  pend(hull[0]).. 
+0001b630: 2020 2020 2020 2069 6e69 7469 616c 5f76         initial_v
+0001b640: 6563 746f 7220 3d20 7665 6331 2e63 6f70  ector = vec1.cop
+0001b650: 7928 290a 2020 2020 2020 2020 746f 7461  y().        tota
+0001b660: 6c5f 616e 676c 6520 3d20 300a 2020 2020  l_angle = 0.    
+0001b670: 2020 2020 7768 696c 6520 6e65 7874 5f70      while next_p
+0001b680: 6f69 6e74 2021 3d20 706f 696e 745f 7374  oint != point_st
+0001b690: 6172 743a 0a20 2020 2020 2020 2020 2020  art:.           
+0001b6a0: 2076 6563 3120 3d20 6e65 7874 5f70 6f69   vec1 = next_poi
+0001b6b0: 6e74 202d 2068 756c 6c5b 2d32 5d0a 2020  nt - hull[-2].  
+0001b6c0: 2020 2020 2020 2020 2020 7468 6574 6120            theta 
+0001b6d0: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+0001b6e0: 2066 6f72 2070 7420 696e 2072 656d 6169   for pt in remai
+0001b6f0: 6e69 6e67 5f70 6f69 6e74 733a 0a20 2020  ning_points:.   
+0001b700: 2020 2020 2020 2020 2020 2020 2076 6563               vec
+0001b710: 3220 3d20 7074 202d 206e 6578 745f 706f  2 = pt - next_po
+0001b720: 696e 740a 2020 2020 2020 2020 2020 2020  int.            
+0001b730: 2020 2020 7468 6574 615f 6920 3d20 2d76      theta_i = -v
+0001b740: 6f6c 6d64 6c72 2e67 656f 6d65 7472 792e  olmdlr.geometry.
+0001b750: 636c 6f63 6b77 6973 655f 616e 676c 6528  clockwise_angle(
+0001b760: 7665 6331 2c20 7665 6332 290a 2020 2020  vec1, vec2).    
+0001b770: 2020 2020 2020 2020 2020 2020 7468 6574              thet
+0001b780: 612e 6170 7065 6e64 2874 6865 7461 5f69  a.append(theta_i
+0001b790: 290a 0a20 2020 2020 2020 2020 2020 206d  )..            m
+0001b7a0: 696e 5f74 6865 7461 2c20 706f 736d 696e  in_theta, posmin
+0001b7b0: 5f74 6865 7461 203d 2061 7267 6d69 6e28  _theta = argmin(
+0001b7c0: 7468 6574 6129 0a20 2020 2020 2020 2020  theta).         
+0001b7d0: 2020 2069 6620 6d61 7468 2e69 7363 6c6f     if math.isclo
+0001b7e0: 7365 286d 696e 5f74 6865 7461 2c20 2d32  se(min_theta, -2
+0001b7f0: 202a 206d 6174 682e 7069 2c20 6162 735f   * math.pi, abs_
+0001b800: 746f 6c3d 3165 2d36 2920 5c0a 2020 2020  tol=1e-6) \.    
+0001b810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b820: 6f72 206d 6174 682e 6973 636c 6f73 6528  or math.isclose(
+0001b830: 6d69 6e5f 7468 6574 612c 2030 2c20 6162  min_theta, 0, ab
+0001b840: 735f 746f 6c3d 3165 2d36 293a 0a20 2020  s_tol=1e-6):.   
+0001b850: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001b860: 7265 6d61 696e 696e 675f 706f 696e 7473  remaining_points
+0001b870: 5b70 6f73 6d69 6e5f 7468 6574 615d 203d  [posmin_theta] =
+0001b880: 3d20 706f 696e 745f 7374 6172 743a 0a20  = point_start:. 
+0001b890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b8a0: 2020 2062 7265 616b 0a0a 2020 2020 2020     break..      
+0001b8b0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001b8c0: 2020 2020 2020 2020 2020 2020 6e65 7874              next
+0001b8d0: 5f70 6f69 6e74 203d 2072 656d 6169 6e69  _point = remaini
+0001b8e0: 6e67 5f70 6f69 6e74 735b 706f 736d 696e  ng_points[posmin
+0001b8f0: 5f74 6865 7461 5d0a 0a20 2020 2020 2020  _theta]..       
+0001b900: 2020 2020 2020 2020 2076 6563 5f6e 6578           vec_nex
+0001b910: 745f 706f 696e 7420 3d20 6e65 7874 5f70  t_point = next_p
+0001b920: 6f69 6e74 202d 2062 6172 7963 656e 7465  oint - barycente
+0001b930: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+0001b940: 2020 746f 7461 6c5f 616e 676c 6520 2b3d    total_angle +=
+0001b950: 2028 3220 2a20 6d61 7468 2e70 6920 2d20   (2 * math.pi - 
+0001b960: 766f 6c6d 646c 722e 6765 6f6d 6574 7279  volmdlr.geometry
+0001b970: 2e63 6c6f 636b 7769 7365 5f61 6e67 6c65  .clockwise_angle
+0001b980: 2869 6e69 7469 616c 5f76 6563 746f 722c  (initial_vector,
+0001b990: 2076 6563 5f6e 6578 745f 706f 696e 7429   vec_next_point)
+0001b9a0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0001b9b0: 2020 2069 6620 746f 7461 6c5f 616e 676c     if total_angl
+0001b9c0: 6520 3e20 3220 2a20 6d61 7468 2e70 693a  e > 2 * math.pi:
+0001b9d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b9e0: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
+0001b9f0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0001ba00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ba10: 2020 2020 2069 6e69 7469 616c 5f76 6563       initial_vec
+0001ba20: 746f 7220 3d20 7665 635f 6e65 7874 5f70  tor = vec_next_p
+0001ba30: 6f69 6e74 0a0a 2020 2020 2020 2020 2020  oint..          
+0001ba40: 2020 2020 2020 6875 6c6c 2e61 7070 656e        hull.appen
+0001ba50: 6428 6e65 7874 5f70 6f69 6e74 290a 0a20  d(next_point).. 
+0001ba60: 2020 2020 2020 2020 2020 2064 656c 2072             del r
+0001ba70: 656d 6169 6e69 6e67 5f70 6f69 6e74 735b  emaining_points[
+0001ba80: 706f 736d 696e 5f74 6865 7461 5d0a 0a20  posmin_theta].. 
+0001ba90: 2020 2020 2020 2068 756c 6c2e 706f 7028         hull.pop(
+0001baa0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0001bab0: 6e20 636c 7328 6875 6c6c 290a 0a20 2020  n cls(hull)..   
+0001bac0: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+0001bad0: 2020 6465 6620 636f 6e63 6176 655f 6875    def concave_hu
+0001bae0: 6c6c 2863 6c73 2c20 706f 696e 7473 2c20  ll(cls, points, 
+0001baf0: 636f 6e63 6176 6974 792c 2073 6361 6c65  concavity, scale
+0001bb00: 5f66 6163 746f 7229 3a0a 2020 2020 2020  _factor):.      
+0001bb10: 2020 2222 220a 2020 2020 2020 2020 4361    """.        Ca
+0001bb20: 6c63 756c 6174 6573 2074 6865 2063 6f6e  lculates the con
+0001bb30: 6361 7665 2068 756c 6c20 6672 6f6d 2061  cave hull from a
+0001bb40: 2063 6c6f 7564 206f 6620 706f 696e 7473   cloud of points
+0001bb50: 2c20 692e 652e 2c20 6974 2055 6e69 7465  , i.e., it Unite
+0001bb60: 7320 616c 6c20 706f 696e 7473 2075 6e64  s all points und
+0001bb70: 6572 2074 6865 2073 6d61 6c6c 6573 7420  er the smallest 
+0001bb80: 706f 7373 6962 6c65 2061 7265 612e 0a0a  possible area...
+0001bb90: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0001bba0: 6f69 6e74 733a 206c 6973 7420 6f66 2070  oints: list of p
+0001bbb0: 6f69 6e74 7320 636f 7272 6573 706f 6e64  oints correspond
+0001bbc0: 696e 6720 746f 2074 6865 2063 6c6f 7564  ing to the cloud
+0001bbd0: 206f 6620 706f 696e 7473 0a20 2020 2020   of points.     
+0001bbe0: 2020 203a 7479 7065 2070 6f69 6e74 733a     :type points:
+0001bbf0: 2063 6c61 7373 3a20 2776 6f6c 6d64 6c72   class: 'volmdlr
+0001bc00: 2e50 6f69 6e74 3244 270a 2020 2020 2020  .Point2D'.      
+0001bc10: 2020 3a70 6172 616d 2063 6f6e 6361 7669    :param concavi
+0001bc20: 7479 3a20 5365 7473 2068 6f77 2073 6861  ty: Sets how sha
+0001bc30: 7270 2074 6865 2063 6f6e 6361 7665 2061  rp the concave a
+0001bc40: 6e67 6c65 7320 6361 6e20 6265 2e20 4974  ngles can be. It
+0001bc50: 2067 6f65 7320 6672 6f6d 202d 3120 286e   goes from -1 (n
+0001bc60: 6f74 2063 6f6e 6361 7665 2061 7420 616c  ot concave at al
+0001bc70: 6c2e 2069 6e20 6661 6374 2c0a 2020 2020  l. in fact,.    
+0001bc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bc90: 2020 2020 2020 7468 6520 6875 6c6c 2077        the hull w
+0001bca0: 696c 6c20 6265 206c 6566 7420 636f 6e76  ill be left conv
+0001bcb0: 6578 2920 7570 2074 6f20 2b31 2028 7665  ex) up to +1 (ve
+0001bcc0: 7279 2073 6861 7270 2061 6e67 6c65 7320  ry sharp angles 
+0001bcd0: 6361 6e20 6f63 6375 722e 2053 6574 7469  can occur. Setti
+0001bce0: 6e67 2063 6f6e 6361 7669 7479 2074 6f0a  ng concavity to.
 0001bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bd00: 2020 2b31 206d 6967 6874 2072 6573 756c    +1 might resul
-0001bd10: 7420 696e 2030 c2ba 2061 6e67 6c65 7321  t in 0.. angles!
-0001bd20: 2920 636f 6e63 6176 6974 7920 6973 2064  ) concavity is d
-0001bd30: 6566 696e 6564 2061 7320 7468 6520 636f  efined as the co
-0001bd40: 7369 6e65 206f 6620 7468 6520 636f 6e63  sine of the conc
-0001bd50: 6176 6520 616e 676c 6573 2e0a 2020 2020  ave angles..    
-0001bd60: 2020 2020 3a74 7970 6520 636f 6e63 6176      :type concav
-0001bd70: 6974 793a 2066 6c6f 6174 0a20 2020 2020  ity: float.     
-0001bd80: 2020 203a 7061 7261 6d20 7363 616c 655f     :param scale_
-0001bd90: 6661 6374 6f72 3a20 5365 7473 2068 6f77  factor: Sets how
-0001bda0: 2062 6967 2069 7320 7468 6520 6172 6561   big is the area
-0001bdb0: 2077 6865 7265 2063 6f6e 6361 7669 7469   where concaviti
-0001bdc0: 6573 2061 7265 2067 6f69 6e67 2074 6f20  es are going to 
-0001bdd0: 6265 2073 6561 7263 6865 642e 0a20 2020  be searched..   
-0001bde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bdf0: 2020 2020 2020 2020 2020 5468 6520 6269            The bi
-0001be00: 6767 6572 2c20 7468 6520 6d6f 7265 2073  gger, the more s
-0001be10: 6861 7270 2074 6865 2061 6e67 6c65 7320  harp the angles 
-0001be20: 6361 6e20 6265 2e20 5365 7474 696e 6720  can be. Setting 
-0001be30: 6974 2074 6f20 6120 7665 7279 2068 6967  it to a very hig
-0001be40: 6820 7661 6c75 6520 6d69 6768 740a 2020  h value might.  
-0001be50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001be60: 2020 2020 2020 2020 2020 2061 6666 6563             affec
-0001be70: 7420 7468 6520 7065 7266 6f72 6d61 6e63  t the performanc
-0001be80: 6520 6f66 2074 6865 2070 726f 6772 616d  e of the program
-0001be90: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001bea0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-0001beb0: 6869 7320 7661 6c75 6520 7368 6f75 6c64  his value should
-0001bec0: 2062 6520 7265 6c61 7469 7665 2074 6f20   be relative to 
-0001bed0: 686f 7720 636c 6f73 6520 746f 2065 6163  how close to eac
-0001bee0: 6820 6f74 6865 7220 7468 6520 706f 696e  h other the poin
-0001bef0: 7473 2074 6f20 6265 2063 6f6e 6e65 6374  ts to be connect
-0001bf00: 6564 2061 7265 2e0a 2020 2020 2020 2020  ed are..        
-0001bf10: 3a74 7970 6520 7363 616c 655f 6661 6374  :type scale_fact
-0001bf20: 6f72 3a20 666c 6f61 740a 0a20 2020 2020  or: float..     
-0001bf30: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0001bf40: 6465 6620 6765 745f 6e65 6172 6279 5f70  def get_nearby_p
-0001bf50: 6f69 6e74 7328 6c69 6e65 2c20 706f 696e  oints(line, poin
-0001bf60: 7473 2c20 7363 616c 655f 6661 6374 6f72  ts, scale_factor
-0001bf70: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
-0001bf80: 6f69 6e74 735f 6875 6c6c 203d 205b 7074  oints_hull = [pt
-0001bf90: 2e63 6f70 7928 2920 666f 7220 7074 2069  .copy() for pt i
-0001bfa0: 6e20 706f 696e 7473 5d0a 0a20 2020 2020  n points]..     
-0001bfb0: 2020 2020 2020 2023 2070 7269 6e74 2827         # print('
-0001bfc0: 6920 656e 7465 7220 6865 7265 2729 0a20  i enter here'). 
-0001bfd0: 2020 2020 2020 2020 2020 206e 6561 7262             nearb
-0001bfe0: 795f 706f 696e 7473 203d 205b 5d0a 2020  y_points = [].  
-0001bff0: 2020 2020 2020 2020 2020 6c69 6e65 5f6d            line_m
-0001c000: 6964 706f 696e 7420 3d20 302e 3520 2a20  idpoint = 0.5 * 
-0001c010: 286c 696e 652e 7374 6172 7420 2b20 6c69  (line.start + li
-0001c020: 6e65 2e65 6e64 290a 2020 2020 2020 2020  ne.end).        
-0001c030: 2020 2020 2320 7072 696e 7428 6c69 6e65      # print(line
-0001c040: 5f6d 6964 706f 696e 7429 0a20 2020 2020  _midpoint).     
-0001c050: 2020 2020 2020 2074 7269 6573 203d 2030         tries = 0
-0001c060: 0a20 2020 2020 2020 2020 2020 206e 203d  .            n =
-0001c070: 2035 0a20 2020 2020 2020 2020 2020 2062   5.            b
-0001c080: 6f75 6e64 696e 675f 626f 7820 3d20 5b6c  ounding_box = [l
-0001c090: 696e 655f 6d69 6470 6f69 6e74 2e78 202d  ine_midpoint.x -
-0001c0a0: 206c 696e 652e 6c65 6e67 7468 2829 202f   line.length() /
-0001c0b0: 2032 2c0a 2020 2020 2020 2020 2020 2020   2,.            
+0001bd00: 2020 2020 2020 2020 2020 2b31 206d 6967            +1 mig
+0001bd10: 6874 2072 6573 756c 7420 696e 2030 c2ba  ht result in 0..
+0001bd20: 2061 6e67 6c65 7321 2920 636f 6e63 6176   angles!) concav
+0001bd30: 6974 7920 6973 2064 6566 696e 6564 2061  ity is defined a
+0001bd40: 7320 7468 6520 636f 7369 6e65 206f 6620  s the cosine of 
+0001bd50: 7468 6520 636f 6e63 6176 6520 616e 676c  the concave angl
+0001bd60: 6573 2e0a 2020 2020 2020 2020 3a74 7970  es..        :typ
+0001bd70: 6520 636f 6e63 6176 6974 793a 2066 6c6f  e concavity: flo
+0001bd80: 6174 0a20 2020 2020 2020 203a 7061 7261  at.        :para
+0001bd90: 6d20 7363 616c 655f 6661 6374 6f72 3a20  m scale_factor: 
+0001bda0: 5365 7473 2068 6f77 2062 6967 2069 7320  Sets how big is 
+0001bdb0: 7468 6520 6172 6561 2077 6865 7265 2063  the area where c
+0001bdc0: 6f6e 6361 7669 7469 6573 2061 7265 2067  oncavities are g
+0001bdd0: 6f69 6e67 2074 6f20 6265 2073 6561 7263  oing to be searc
+0001bde0: 6865 642e 0a20 2020 2020 2020 2020 2020  hed..           
+0001bdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be00: 2020 5468 6520 6269 6767 6572 2c20 7468    The bigger, th
+0001be10: 6520 6d6f 7265 2073 6861 7270 2074 6865  e more sharp the
+0001be20: 2061 6e67 6c65 7320 6361 6e20 6265 2e20   angles can be. 
+0001be30: 5365 7474 696e 6720 6974 2074 6f20 6120  Setting it to a 
+0001be40: 7665 7279 2068 6967 6820 7661 6c75 6520  very high value 
+0001be50: 6d69 6768 740a 2020 2020 2020 2020 2020  might.          
+0001be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be70: 2020 2061 6666 6563 7420 7468 6520 7065     affect the pe
+0001be80: 7266 6f72 6d61 6e63 6520 6f66 2074 6865  rformance of the
+0001be90: 2070 726f 6772 616d 2e0a 2020 2020 2020   program..      
+0001bea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001beb0: 2020 2020 2020 2054 6869 7320 7661 6c75         This valu
+0001bec0: 6520 7368 6f75 6c64 2062 6520 7265 6c61  e should be rela
+0001bed0: 7469 7665 2074 6f20 686f 7720 636c 6f73  tive to how clos
+0001bee0: 6520 746f 2065 6163 6820 6f74 6865 7220  e to each other 
+0001bef0: 7468 6520 706f 696e 7473 2074 6f20 6265  the points to be
+0001bf00: 2063 6f6e 6e65 6374 6564 2061 7265 2e0a   connected are..
+0001bf10: 2020 2020 2020 2020 3a74 7970 6520 7363          :type sc
+0001bf20: 616c 655f 6661 6374 6f72 3a20 666c 6f61  ale_factor: floa
+0001bf30: 740a 0a20 2020 2020 2020 2022 2222 0a0a  t..        """..
+0001bf40: 2020 2020 2020 2020 6465 6620 6765 745f          def get_
+0001bf50: 6e65 6172 6279 5f70 6f69 6e74 7328 6c69  nearby_points(li
+0001bf60: 6e65 2c20 706f 696e 7473 2c20 7363 616c  ne, points, scal
+0001bf70: 655f 6661 6374 6f72 293a 0a20 2020 2020  e_factor):.     
+0001bf80: 2020 2020 2020 2070 6f69 6e74 735f 6875         points_hu
+0001bf90: 6c6c 203d 205b 7074 2e63 6f70 7928 2920  ll = [pt.copy() 
+0001bfa0: 666f 7220 7074 2069 6e20 706f 696e 7473  for pt in points
+0001bfb0: 5d0a 0a20 2020 2020 2020 2020 2020 2023  ]..            #
+0001bfc0: 2070 7269 6e74 2827 6920 656e 7465 7220   print('i enter 
+0001bfd0: 6865 7265 2729 0a20 2020 2020 2020 2020  here').         
+0001bfe0: 2020 206e 6561 7262 795f 706f 696e 7473     nearby_points
+0001bff0: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
+0001c000: 2020 6c69 6e65 5f6d 6964 706f 696e 7420    line_midpoint 
+0001c010: 3d20 302e 3520 2a20 286c 696e 652e 7374  = 0.5 * (line.st
+0001c020: 6172 7420 2b20 6c69 6e65 2e65 6e64 290a  art + line.end).
+0001c030: 2020 2020 2020 2020 2020 2020 2320 7072              # pr
+0001c040: 696e 7428 6c69 6e65 5f6d 6964 706f 696e  int(line_midpoin
+0001c050: 7429 0a20 2020 2020 2020 2020 2020 2074  t).            t
+0001c060: 7269 6573 203d 2030 0a20 2020 2020 2020  ries = 0.       
+0001c070: 2020 2020 206e 203d 2035 0a20 2020 2020       n = 5.     
+0001c080: 2020 2020 2020 2062 6f75 6e64 696e 675f         bounding_
+0001c090: 626f 7820 3d20 5b6c 696e 655f 6d69 6470  box = [line_midp
+0001c0a0: 6f69 6e74 2e78 202d 206c 696e 652e 6c65  oint.x - line.le
+0001c0b0: 6e67 7468 2829 202f 2032 2c0a 2020 2020  ngth() / 2,.    
 0001c0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c0d0: 6c69 6e65 5f6d 6964 706f 696e 742e 7820  line_midpoint.x 
-0001c0e0: 2b20 6c69 6e65 2e6c 656e 6774 6828 2920  + line.length() 
-0001c0f0: 2f20 322c 0a20 2020 2020 2020 2020 2020  / 2,.           
+0001c0d0: 2020 2020 2020 2020 6c69 6e65 5f6d 6964          line_mid
+0001c0e0: 706f 696e 742e 7820 2b20 6c69 6e65 2e6c  point.x + line.l
+0001c0f0: 656e 6774 6828 2920 2f20 322c 0a20 2020  ength() / 2,.   
 0001c100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c110: 206c 696e 655f 6d69 6470 6f69 6e74 2e79   line_midpoint.y
-0001c120: 202d 206c 696e 652e 6c65 6e67 7468 2829   - line.length()
-0001c130: 202f 2032 2c0a 2020 2020 2020 2020 2020   / 2,.          
+0001c110: 2020 2020 2020 2020 206c 696e 655f 6d69           line_mi
+0001c120: 6470 6f69 6e74 2e79 202d 206c 696e 652e  dpoint.y - line.
+0001c130: 6c65 6e67 7468 2829 202f 2032 2c0a 2020  length() / 2,.  
 0001c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c150: 2020 6c69 6e65 5f6d 6964 706f 696e 742e    line_midpoint.
-0001c160: 7920 2b20 6c69 6e65 2e6c 656e 6774 6828  y + line.length(
-0001c170: 2920 2f20 325d 0a20 2020 2020 2020 2020  ) / 2].         
-0001c180: 2020 2062 6f75 6e64 6172 7920 3d20 5b69     boundary = [i
-0001c190: 6e74 2862 6f75 6e64 696e 6720 2f20 7363  nt(bounding / sc
-0001c1a0: 616c 655f 6661 6374 6f72 2920 666f 7220  ale_factor) for 
-0001c1b0: 626f 756e 6469 6e67 2069 6e0a 2020 2020  bounding in.    
-0001c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c1d0: 2020 2020 626f 756e 6469 6e67 5f62 6f78      bounding_box
-0001c1e0: 5d0a 2020 2020 2020 2020 2020 2020 7768  ].            wh
-0001c1f0: 696c 6520 7472 6965 7320 3c20 6e20 616e  ile tries < n an
-0001c200: 6420 6c65 6e28 6e65 6172 6279 5f70 6f69  d len(nearby_poi
-0001c210: 6e74 7329 203d 3d20 303a 0a20 2020 2020  nts) == 0:.     
-0001c220: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-0001c230: 6f69 6e74 2069 6e20 706f 696e 7473 5f68  oint in points_h
-0001c240: 756c 6c3a 0a20 2020 2020 2020 2020 2020  ull:.           
-0001c250: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0001c260: 2828 0a20 2020 2020 2020 2020 2020 2020  ((.             
+0001c150: 2020 2020 2020 2020 2020 6c69 6e65 5f6d            line_m
+0001c160: 6964 706f 696e 742e 7920 2b20 6c69 6e65  idpoint.y + line
+0001c170: 2e6c 656e 6774 6828 2920 2f20 325d 0a20  .length() / 2]. 
+0001c180: 2020 2020 2020 2020 2020 2062 6f75 6e64             bound
+0001c190: 6172 7920 3d20 5b69 6e74 2862 6f75 6e64  ary = [int(bound
+0001c1a0: 696e 6720 2f20 7363 616c 655f 6661 6374  ing / scale_fact
+0001c1b0: 6f72 2920 666f 7220 626f 756e 6469 6e67  or) for bounding
+0001c1c0: 2069 6e0a 2020 2020 2020 2020 2020 2020   in.            
+0001c1d0: 2020 2020 2020 2020 2020 2020 626f 756e              boun
+0001c1e0: 6469 6e67 5f62 6f78 5d0a 2020 2020 2020  ding_box].      
+0001c1f0: 2020 2020 2020 7768 696c 6520 7472 6965        while trie
+0001c200: 7320 3c20 6e20 616e 6420 6c65 6e28 6e65  s < n and len(ne
+0001c210: 6172 6279 5f70 6f69 6e74 7329 203d 3d20  arby_points) == 
+0001c220: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0001c230: 2020 2066 6f72 2070 6f69 6e74 2069 6e20     for point in 
+0001c240: 706f 696e 7473 5f68 756c 6c3a 0a20 2020  points_hull:.   
+0001c250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c260: 2069 6620 6e6f 7420 2828 0a20 2020 2020   if not ((.     
 0001c270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c280: 2020 2020 2020 2070 6f69 6e74 2e78 203d         point.x =
-0001c290: 3d20 6c69 6e65 2e73 7461 7274 2e78 2061  = line.start.x a
-0001c2a0: 6e64 2070 6f69 6e74 2e79 203d 3d20 6c69  nd point.y == li
-0001c2b0: 6e65 2e73 7461 7274 2e79 2920 6f72 2028  ne.start.y) or (
-0001c2c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c280: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001c290: 6f69 6e74 2e78 203d 3d20 6c69 6e65 2e73  oint.x == line.s
+0001c2a0: 7461 7274 2e78 2061 6e64 2070 6f69 6e74  tart.x and point
+0001c2b0: 2e79 203d 3d20 6c69 6e65 2e73 7461 7274  .y == line.start
+0001c2c0: 2e79 2920 6f72 2028 0a20 2020 2020 2020  .y) or (.       
 0001c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2e0: 2020 2020 2070 6f69 6e74 2e78 203d 3d20       point.x == 
-0001c2f0: 6c69 6e65 2e65 6e64 2e78 2061 6e64 2070  line.end.x and p
-0001c300: 6f69 6e74 2e79 203d 3d20 6c69 6e65 2e65  oint.y == line.e
-0001c310: 6e64 2e79 2929 3a0a 2020 2020 2020 2020  nd.y)):.        
+0001c2e0: 2020 2020 2020 2020 2020 2020 2070 6f69               poi
+0001c2f0: 6e74 2e78 203d 3d20 6c69 6e65 2e65 6e64  nt.x == line.end
+0001c300: 2e78 2061 6e64 2070 6f69 6e74 2e79 203d  .x and point.y =
+0001c310: 3d20 6c69 6e65 2e65 6e64 2e79 2929 3a0a  = line.end.y)):.
 0001c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c330: 706f 696e 745f 785f 7265 6c5f 706f 7320  point_x_rel_pos 
-0001c340: 3d20 696e 7428 706f 696e 742e 7820 2f20  = int(point.x / 
-0001c350: 7363 616c 655f 6661 6374 6f72 290a 2020  scale_factor).  
-0001c360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c370: 2020 2020 2020 706f 696e 745f 795f 7265        point_y_re
-0001c380: 6c5f 706f 7320 3d20 696e 7428 706f 696e  l_pos = int(poin
-0001c390: 742e 7920 2f20 7363 616c 655f 6661 6374  t.y / scale_fact
-0001c3a0: 6f72 290a 2020 2020 2020 2020 2020 2020  or).            
-0001c3b0: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-0001c3c0: 6f69 6e74 5f78 5f72 656c 5f70 6f73 203e  oint_x_rel_pos >
-0001c3d0: 3d20 626f 756e 6461 7279 5b0a 2020 2020  = boundary[.    
-0001c3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c3f0: 2020 2020 2020 2020 2020 2020 305d 2061              0] a
-0001c400: 6e64 2070 6f69 6e74 5f78 5f72 656c 5f70  nd point_x_rel_p
-0001c410: 6f73 203c 3d20 626f 756e 6461 7279 5b0a  os <= boundary[.
-0001c420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c330: 2020 2020 2020 2020 706f 696e 745f 785f          point_x_
+0001c340: 7265 6c5f 706f 7320 3d20 696e 7428 706f  rel_pos = int(po
+0001c350: 696e 742e 7820 2f20 7363 616c 655f 6661  int.x / scale_fa
+0001c360: 6374 6f72 290a 2020 2020 2020 2020 2020  ctor).          
+0001c370: 2020 2020 2020 2020 2020 2020 2020 706f                po
+0001c380: 696e 745f 795f 7265 6c5f 706f 7320 3d20  int_y_rel_pos = 
+0001c390: 696e 7428 706f 696e 742e 7920 2f20 7363  int(point.y / sc
+0001c3a0: 616c 655f 6661 6374 6f72 290a 2020 2020  ale_factor).    
+0001c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c3c0: 2020 2020 6966 2070 6f69 6e74 5f78 5f72      if point_x_r
+0001c3d0: 656c 5f70 6f73 203e 3d20 626f 756e 6461  el_pos >= bounda
+0001c3e0: 7279 5b0a 2020 2020 2020 2020 2020 2020  ry[.            
+0001c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c400: 2020 2020 305d 2061 6e64 2070 6f69 6e74      0] and point
+0001c410: 5f78 5f72 656c 5f70 6f73 203c 3d20 626f  _x_rel_pos <= bo
+0001c420: 756e 6461 7279 5b0a 2020 2020 2020 2020  undary[.        
 0001c430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c440: 315d 2061 6e64 2070 6f69 6e74 5f79 5f72  1] and point_y_r
-0001c450: 656c 5f70 6f73 203e 3d20 626f 756e 6461  el_pos >= bounda
-0001c460: 7279 5b0a 2020 2020 2020 2020 2020 2020  ry[.            
+0001c440: 2020 2020 2020 2020 315d 2061 6e64 2070          1] and p
+0001c450: 6f69 6e74 5f79 5f72 656c 5f70 6f73 203e  oint_y_rel_pos >
+0001c460: 3d20 626f 756e 6461 7279 5b0a 2020 2020  = boundary[.    
 0001c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c480: 2020 2020 325d 2061 6e64 2070 6f69 6e74      2] and point
-0001c490: 5f79 5f72 656c 5f70 6f73 203c 3d20 626f  _y_rel_pos <= bo
-0001c4a0: 756e 6461 7279 5b33 5d3a 0a20 2020 2020  undary[3]:.     
-0001c4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4c0: 2020 2020 2020 206e 6561 7262 795f 706f         nearby_po
-0001c4d0: 696e 7473 2e61 7070 656e 6428 706f 696e  ints.append(poin
-0001c4e0: 7429 0a0a 2020 2020 2020 2020 2020 2020  t)..            
-0001c4f0: 2020 2020 7363 616c 655f 6661 6374 6f72      scale_factor
-0001c500: 202a 3d20 3420 2f20 330a 2020 2020 2020   *= 4 / 3.      
-0001c510: 2020 2020 2020 2020 2020 7472 6965 7320            tries 
-0001c520: 2b3d 2031 0a0a 2020 2020 2020 2020 2020  += 1..          
-0001c530: 2020 7265 7475 726e 206e 6561 7262 795f    return nearby_
-0001c540: 706f 696e 7473 0a0a 2020 2020 2020 2020  points..        
-0001c550: 6465 6620 6c69 6e65 5f63 6f6c 6964 6573  def line_colides
-0001c560: 5f77 6974 685f 6875 6c6c 286c 696e 652c  _with_hull(line,
-0001c570: 2063 6f6e 6361 7665 5f68 756c 6c29 3a0a   concave_hull):.
-0001c580: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001c590: 6875 6c6c 5f6c 696e 6520 696e 2063 6f6e  hull_line in con
-0001c5a0: 6361 7665 5f68 756c 6c3a 0a20 2020 2020  cave_hull:.     
-0001c5b0: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
-0001c5c0: 6e65 2e73 7461 7274 2021 3d20 6875 6c6c  ne.start != hull
-0001c5d0: 5f6c 696e 652e 7374 6172 7420 616e 6420  _line.start and 
-0001c5e0: 6c69 6e65 2e73 7461 7274 2021 3d20 6875  line.start != hu
-0001c5f0: 6c6c 5f6c 696e 652e 656e 6420 616e 6420  ll_line.end and 
-0001c600: 6c69 6e65 2e65 6e64 2021 3d20 6875 6c6c  line.end != hull
-0001c610: 5f6c 696e 652e 7374 6172 7420 616e 645c  _line.start and\
-0001c620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c630: 2020 2020 2020 2020 206c 696e 652e 656e           line.en
-0001c640: 6420 213d 2068 756c 6c5f 6c69 6e65 2e65  d != hull_line.e
-0001c650: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
-0001c660: 2020 2020 2020 2020 6966 206c 696e 652e          if line.
-0001c670: 6c69 6e65 5f69 6e74 6572 7365 6374 696f  line_intersectio
-0001c680: 6e73 2868 756c 6c5f 6c69 6e65 2e74 6f5f  ns(hull_line.to_
-0001c690: 6c69 6e65 2829 293a 0a20 2020 2020 2020  line()):.       
-0001c6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6b0: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
-0001c6c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001c6d0: 4661 6c73 650a 0a20 2020 2020 2020 2064  False..        d
-0001c6e0: 6566 2067 6574 5f64 6976 6964 6564 5f6c  ef get_divided_l
-0001c6f0: 696e 6528 6c69 6e65 2c20 6e65 6172 6279  ine(line, nearby
-0001c700: 5f70 6f69 6e74 732c 2068 756c 6c5f 636f  _points, hull_co
-0001c710: 6e63 6176 655f 6564 6765 732c 0a20 2020  ncave_edges,.   
-0001c720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c730: 2020 2020 2020 2020 2020 636f 6e63 6176            concav
-0001c740: 6974 7929 3a0a 2020 2020 2020 2020 2020  ity):.          
-0001c750: 2020 6469 7669 6465 645f 6c69 6e65 203d    divided_line =
-0001c760: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-0001c770: 6f6b 5f6d 6964 646c 655f 706f 696e 7473  ok_middle_points
-0001c780: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
-0001c790: 2020 6c69 7374 5f63 6f73 7369 6e65 7320    list_cossines 
-0001c7a0: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
-0001c7b0: 2066 6f72 206d 6964 646c 655f 706f 696e   for middle_poin
-0001c7c0: 7420 696e 206e 6561 7262 795f 706f 696e  t in nearby_poin
-0001c7d0: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-0001c7e0: 2020 2020 7665 6374 3120 3d20 6c69 6e65      vect1 = line
-0001c7f0: 2e73 7461 7274 202d 206d 6964 646c 655f  .start - middle_
-0001c800: 706f 696e 740a 2020 2020 2020 2020 2020  point.          
-0001c810: 2020 2020 2020 7665 6374 3220 3d20 6c69        vect2 = li
-0001c820: 6e65 2e65 6e64 202d 206d 6964 646c 655f  ne.end - middle_
-0001c830: 706f 696e 740a 2020 2020 2020 2020 2020  point.          
-0001c840: 2020 2020 2020 6966 206d 6964 646c 655f        if middle_
-0001c850: 706f 696e 7420 696e 2028 6c69 6e65 2e73  point in (line.s
-0001c860: 7461 7274 2c20 6c69 6e65 2e65 6e64 293a  tart, line.end):
-0001c870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c880: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
-0001c890: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0001c8a0: 7320 3d20 726f 756e 6428 7665 6374 312e  s = round(vect1.
-0001c8b0: 646f 7428 7665 6374 3229 202f 2028 7665  dot(vect2) / (ve
-0001c8c0: 6374 312e 6e6f 726d 2829 202a 2076 6563  ct1.norm() * vec
-0001c8d0: 7432 2e6e 6f72 6d28 2929 2c0a 2020 2020  t2.norm()),.    
-0001c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8f0: 2020 2020 2020 2020 3429 0a20 2020 2020          4).     
-0001c900: 2020 2020 2020 2020 2020 2069 6620 636f             if co
-0001c910: 7320 3c20 636f 6e63 6176 6974 793a 0a20  s < concavity:. 
-0001c920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c930: 2020 206e 6577 5f6c 696e 655f 6120 3d20     new_line_a = 
-0001c940: 766f 6c6d 646c 722e 6564 6765 732e 4c69  volmdlr.edges.Li
-0001c950: 6e65 5365 676d 656e 7432 4428 7374 6172  neSegment2D(star
-0001c960: 743d 6c69 6e65 2e73 7461 7274 2c20 656e  t=line.start, en
-0001c970: 643d 6d69 6464 6c65 5f70 6f69 6e74 290a  d=middle_point).
-0001c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c990: 2020 2020 6e65 775f 6c69 6e65 5f62 203d      new_line_b =
-0001c9a0: 2076 6f6c 6d64 6c72 2e65 6467 6573 2e4c   volmdlr.edges.L
-0001c9b0: 696e 6553 6567 6d65 6e74 3244 2873 7461  ineSegment2D(sta
-0001c9c0: 7274 3d6d 6964 646c 655f 706f 696e 742c  rt=middle_point,
-0001c9d0: 2065 6e64 3d6c 696e 652e 656e 6429 0a20   end=line.end). 
-0001c9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c9f0: 2020 2069 6620 6e6f 7420 286c 696e 655f     if not (line_
-0001ca00: 636f 6c69 6465 735f 7769 7468 5f68 756c  colides_with_hul
-0001ca10: 6c28 6c69 6e65 3d6e 6577 5f6c 696e 655f  l(line=new_line_
-0001ca20: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+0001c480: 2020 2020 2020 2020 2020 2020 325d 2061              2] a
+0001c490: 6e64 2070 6f69 6e74 5f79 5f72 656c 5f70  nd point_y_rel_p
+0001c4a0: 6f73 203c 3d20 626f 756e 6461 7279 5b33  os <= boundary[3
+0001c4b0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+0001c4c0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0001c4d0: 6561 7262 795f 706f 696e 7473 2e61 7070  earby_points.app
+0001c4e0: 656e 6428 706f 696e 7429 0a0a 2020 2020  end(point)..    
+0001c4f0: 2020 2020 2020 2020 2020 2020 7363 616c              scal
+0001c500: 655f 6661 6374 6f72 202a 3d20 3420 2f20  e_factor *= 4 / 
+0001c510: 330a 2020 2020 2020 2020 2020 2020 2020  3.              
+0001c520: 2020 7472 6965 7320 2b3d 2031 0a0a 2020    tries += 1..  
+0001c530: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001c540: 206e 6561 7262 795f 706f 696e 7473 0a0a   nearby_points..
+0001c550: 2020 2020 2020 2020 6465 6620 6c69 6e65          def line
+0001c560: 5f63 6f6c 6964 6573 5f77 6974 685f 6875  _colides_with_hu
+0001c570: 6c6c 286c 696e 652c 2063 6f6e 6361 7665  ll(line, concave
+0001c580: 5f68 756c 6c29 3a0a 2020 2020 2020 2020  _hull):.        
+0001c590: 2020 2020 666f 7220 6875 6c6c 5f6c 696e      for hull_lin
+0001c5a0: 6520 696e 2063 6f6e 6361 7665 5f68 756c  e in concave_hul
+0001c5b0: 6c3a 0a20 2020 2020 2020 2020 2020 2020  l:.             
+0001c5c0: 2020 2069 6620 6c69 6e65 2e73 7461 7274     if line.start
+0001c5d0: 2021 3d20 6875 6c6c 5f6c 696e 652e 7374   != hull_line.st
+0001c5e0: 6172 7420 616e 6420 6c69 6e65 2e73 7461  art and line.sta
+0001c5f0: 7274 2021 3d20 6875 6c6c 5f6c 696e 652e  rt != hull_line.
+0001c600: 656e 6420 616e 6420 6c69 6e65 2e65 6e64  end and line.end
+0001c610: 2021 3d20 6875 6c6c 5f6c 696e 652e 7374   != hull_line.st
+0001c620: 6172 7420 616e 645c 0a20 2020 2020 2020  art and\.       
+0001c630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c640: 206c 696e 652e 656e 6420 213d 2068 756c   line.end != hul
+0001c650: 6c5f 6c69 6e65 2e65 6e64 3a0a 2020 2020  l_line.end:.    
+0001c660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c670: 6966 206c 696e 652e 6c69 6e65 5f69 6e74  if line.line_int
+0001c680: 6572 7365 6374 696f 6e73 2868 756c 6c5f  ersections(hull_
+0001c690: 6c69 6e65 2e74 6f5f 6c69 6e65 2829 293a  line.to_line()):
+0001c6a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c6b0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001c6c0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+0001c6d0: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
+0001c6e0: 2020 2020 2020 2064 6566 2067 6574 5f64         def get_d
+0001c6f0: 6976 6964 6564 5f6c 696e 6528 6c69 6e65  ivided_line(line
+0001c700: 2c20 6e65 6172 6279 5f70 6f69 6e74 732c  , nearby_points,
+0001c710: 2068 756c 6c5f 636f 6e63 6176 655f 6564   hull_concave_ed
+0001c720: 6765 732c 0a20 2020 2020 2020 2020 2020  ges,.           
+0001c730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c740: 2020 636f 6e63 6176 6974 7929 3a0a 2020    concavity):.  
+0001c750: 2020 2020 2020 2020 2020 6469 7669 6465            divide
+0001c760: 645f 6c69 6e65 203d 205b 5d0a 2020 2020  d_line = [].    
+0001c770: 2020 2020 2020 2020 6f6b 5f6d 6964 646c          ok_middl
+0001c780: 655f 706f 696e 7473 203d 205b 5d0a 2020  e_points = [].  
+0001c790: 2020 2020 2020 2020 2020 6c69 7374 5f63            list_c
+0001c7a0: 6f73 7369 6e65 7320 3d20 5b5d 0a20 2020  ossines = [].   
+0001c7b0: 2020 2020 2020 2020 2066 6f72 206d 6964           for mid
+0001c7c0: 646c 655f 706f 696e 7420 696e 206e 6561  dle_point in nea
+0001c7d0: 7262 795f 706f 696e 7473 3a0a 2020 2020  rby_points:.    
+0001c7e0: 2020 2020 2020 2020 2020 2020 7665 6374              vect
+0001c7f0: 3120 3d20 6c69 6e65 2e73 7461 7274 202d  1 = line.start -
+0001c800: 206d 6964 646c 655f 706f 696e 740a 2020   middle_point.  
+0001c810: 2020 2020 2020 2020 2020 2020 2020 7665                ve
+0001c820: 6374 3220 3d20 6c69 6e65 2e65 6e64 202d  ct2 = line.end -
+0001c830: 206d 6964 646c 655f 706f 696e 740a 2020   middle_point.  
+0001c840: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001c850: 206d 6964 646c 655f 706f 696e 7420 696e   middle_point in
+0001c860: 2028 6c69 6e65 2e73 7461 7274 2c20 6c69   (line.start, li
+0001c870: 6e65 2e65 6e64 293a 0a20 2020 2020 2020  ne.end):.       
+0001c880: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0001c890: 7469 6e75 650a 2020 2020 2020 2020 2020  tinue.          
+0001c8a0: 2020 2020 2020 636f 7320 3d20 726f 756e        cos = roun
+0001c8b0: 6428 7665 6374 312e 646f 7428 7665 6374  d(vect1.dot(vect
+0001c8c0: 3229 202f 2028 7665 6374 312e 6e6f 726d  2) / (vect1.norm
+0001c8d0: 2829 202a 2076 6563 7432 2e6e 6f72 6d28  () * vect2.norm(
+0001c8e0: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
+0001c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c900: 3429 0a20 2020 2020 2020 2020 2020 2020  4).             
+0001c910: 2020 2069 6620 636f 7320 3c20 636f 6e63     if cos < conc
+0001c920: 6176 6974 793a 0a20 2020 2020 2020 2020  avity:.         
+0001c930: 2020 2020 2020 2020 2020 206e 6577 5f6c             new_l
+0001c940: 696e 655f 6120 3d20 766f 6c6d 646c 722e  ine_a = volmdlr.
+0001c950: 6564 6765 732e 4c69 6e65 5365 676d 656e  edges.LineSegmen
+0001c960: 7432 4428 7374 6172 743d 6c69 6e65 2e73  t2D(start=line.s
+0001c970: 7461 7274 2c20 656e 643d 6d69 6464 6c65  tart, end=middle
+0001c980: 5f70 6f69 6e74 290a 2020 2020 2020 2020  _point).        
+0001c990: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+0001c9a0: 6c69 6e65 5f62 203d 2076 6f6c 6d64 6c72  line_b = volmdlr
+0001c9b0: 2e65 6467 6573 2e4c 696e 6553 6567 6d65  .edges.LineSegme
+0001c9c0: 6e74 3244 2873 7461 7274 3d6d 6964 646c  nt2D(start=middl
+0001c9d0: 655f 706f 696e 742c 2065 6e64 3d6c 696e  e_point, end=lin
+0001c9e0: 652e 656e 6429 0a20 2020 2020 2020 2020  e.end).         
+0001c9f0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0001ca00: 7420 286c 696e 655f 636f 6c69 6465 735f  t (line_colides_
+0001ca10: 7769 7468 5f68 756c 6c28 6c69 6e65 3d6e  with_hull(line=n
+0001ca20: 6577 5f6c 696e 655f 612c 0a20 2020 2020  ew_line_a,.     
 0001ca30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001ca40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca50: 2020 2020 2020 636f 6e63 6176 655f 6875        concave_hu
-0001ca60: 6c6c 3d68 756c 6c5f 636f 6e63 6176 655f  ll=hull_concave_
-0001ca70: 6564 6765 7329 2061 6e64 206c 696e 655f  edges) and line_
-0001ca80: 636f 6c69 6465 735f 7769 7468 5f68 756c  colides_with_hul
-0001ca90: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-0001caa0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0001cab0: 696e 653d 6e65 775f 6c69 6e65 5f62 2c20  ine=new_line_b, 
-0001cac0: 636f 6e63 6176 655f 6875 6c6c 3d68 756c  concave_hull=hul
-0001cad0: 6c5f 636f 6e63 6176 655f 6564 6765 7329  l_concave_edges)
-0001cae0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001caf0: 2020 2020 2020 2020 2020 206f 6b5f 6d69             ok_mi
-0001cb00: 6464 6c65 5f70 6f69 6e74 732e 6170 7065  ddle_points.appe
-0001cb10: 6e64 286d 6964 646c 655f 706f 696e 7429  nd(middle_point)
-0001cb20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001cb30: 2020 2020 2020 2020 206c 6973 745f 636f           list_co
-0001cb40: 7373 696e 6573 2e61 7070 656e 6428 636f  ssines.append(co
-0001cb50: 7329 0a20 2020 2020 2020 2020 2020 2069  s).            i
-0001cb60: 6620 6c65 6e28 6f6b 5f6d 6964 646c 655f  f len(ok_middle_
-0001cb70: 706f 696e 7473 2920 3e20 303a 0a20 2020  points) > 0:.   
-0001cb80: 2020 2020 2020 2020 2020 2020 2023 2020               #  
-0001cb90: 5765 2077 616e 7420 7468 6520 6d69 6464  We want the midd
-0001cba0: 6c65 706f 696e 7420 746f 2062 6520 7468  lepoint to be th
-0001cbb0: 6520 6f6e 6520 7769 7468 2077 6964 6573  e one with wides
-0001cbc0: 7420 616e 676c 6520 2873 6d61 6c6c 6573  t angle (smalles
-0001cbd0: 7420 636f 7373 696e 6529 0a20 2020 2020  t cossine).     
-0001cbe0: 2020 2020 2020 2020 2020 206d 696e 5f63             min_c
-0001cbf0: 6f73 7369 6e65 5f69 6e64 6578 203d 206c  ossine_index = l
-0001cc00: 6973 745f 636f 7373 696e 6573 2e69 6e64  ist_cossines.ind
-0001cc10: 6578 286d 696e 286c 6973 745f 636f 7373  ex(min(list_coss
-0001cc20: 696e 6573 2929 0a20 2020 2020 2020 2020  ines)).         
-0001cc30: 2020 2020 2020 2064 6976 6964 6564 5f6c         divided_l
-0001cc40: 696e 652e 6170 7065 6e64 2876 6f6c 6d64  ine.append(volmd
-0001cc50: 6c72 2e65 6467 6573 2e4c 696e 6553 6567  lr.edges.LineSeg
-0001cc60: 6d65 6e74 3244 286c 696e 652e 7374 6172  ment2D(line.star
-0001cc70: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+0001ca50: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0001ca60: 6e63 6176 655f 6875 6c6c 3d68 756c 6c5f  ncave_hull=hull_
+0001ca70: 636f 6e63 6176 655f 6564 6765 7329 2061  concave_edges) a
+0001ca80: 6e64 206c 696e 655f 636f 6c69 6465 735f  nd line_colides_
+0001ca90: 7769 7468 5f68 756c 6c28 0a20 2020 2020  with_hull(.     
+0001caa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cab0: 2020 2020 2020 206c 696e 653d 6e65 775f         line=new_
+0001cac0: 6c69 6e65 5f62 2c20 636f 6e63 6176 655f  line_b, concave_
+0001cad0: 6875 6c6c 3d68 756c 6c5f 636f 6e63 6176  hull=hull_concav
+0001cae0: 655f 6564 6765 7329 293a 0a20 2020 2020  e_edges)):.     
+0001caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb00: 2020 206f 6b5f 6d69 6464 6c65 5f70 6f69     ok_middle_poi
+0001cb10: 6e74 732e 6170 7065 6e64 286d 6964 646c  nts.append(middl
+0001cb20: 655f 706f 696e 7429 0a20 2020 2020 2020  e_point).       
+0001cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb40: 206c 6973 745f 636f 7373 696e 6573 2e61   list_cossines.a
+0001cb50: 7070 656e 6428 636f 7329 0a20 2020 2020  ppend(cos).     
+0001cb60: 2020 2020 2020 2069 6620 6c65 6e28 6f6b         if len(ok
+0001cb70: 5f6d 6964 646c 655f 706f 696e 7473 2920  _middle_points) 
+0001cb80: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
+0001cb90: 2020 2020 2023 2020 5765 2077 616e 7420       #  We want 
+0001cba0: 7468 6520 6d69 6464 6c65 706f 696e 7420  the middlepoint 
+0001cbb0: 746f 2062 6520 7468 6520 6f6e 6520 7769  to be the one wi
+0001cbc0: 7468 2077 6964 6573 7420 616e 676c 6520  th widest angle 
+0001cbd0: 2873 6d61 6c6c 6573 7420 636f 7373 696e  (smallest cossin
+0001cbe0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+0001cbf0: 2020 206d 696e 5f63 6f73 7369 6e65 5f69     min_cossine_i
+0001cc00: 6e64 6578 203d 206c 6973 745f 636f 7373  ndex = list_coss
+0001cc10: 696e 6573 2e69 6e64 6578 286d 696e 286c  ines.index(min(l
+0001cc20: 6973 745f 636f 7373 696e 6573 2929 0a20  ist_cossines)). 
+0001cc30: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0001cc40: 6976 6964 6564 5f6c 696e 652e 6170 7065  ivided_line.appe
+0001cc50: 6e64 2876 6f6c 6d64 6c72 2e65 6467 6573  nd(volmdlr.edges
+0001cc60: 2e4c 696e 6553 6567 6d65 6e74 3244 286c  .LineSegment2D(l
+0001cc70: 696e 652e 7374 6172 742c 0a20 2020 2020  ine.start,.     
 0001cc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001cc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ccb0: 2020 206f 6b5f 6d69 6464 6c65 5f70 6f69     ok_middle_poi
-0001ccc0: 6e74 735b 0a20 2020 2020 2020 2020 2020  nts[.           
+0001ccb0: 2020 2020 2020 2020 2020 206f 6b5f 6d69             ok_mi
+0001ccc0: 6464 6c65 5f70 6f69 6e74 735b 0a20 2020  ddle_points[.   
 0001ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001cce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001ccf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd00: 2020 2020 2020 2020 206d 696e 5f63 6f73           min_cos
-0001cd10: 7369 6e65 5f69 6e64 6578 5d29 290a 2020  sine_index])).  
-0001cd20: 2020 2020 2020 2020 2020 2020 2020 6469                di
-0001cd30: 7669 6465 645f 6c69 6e65 2e61 7070 656e  vided_line.appen
-0001cd40: 6428 766f 6c6d 646c 722e 6564 6765 732e  d(volmdlr.edges.
-0001cd50: 4c69 6e65 5365 676d 656e 7432 4428 0a20  LineSegment2D(. 
-0001cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd70: 2020 206f 6b5f 6d69 6464 6c65 5f70 6f69     ok_middle_poi
-0001cd80: 6e74 735b 6d69 6e5f 636f 7373 696e 655f  nts[min_cossine_
-0001cd90: 696e 6465 785d 2c20 6c69 6e65 2e65 6e64  index], line.end
-0001cda0: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
-0001cdb0: 6574 7572 6e20 6469 7669 6465 645f 6c69  eturn divided_li
-0001cdc0: 6e65 0a0a 2020 2020 2020 2020 6875 6c6c  ne..        hull
-0001cdd0: 5f63 6f6e 7665 785f 6564 6765 7320 3d20  _convex_edges = 
-0001cde0: 636c 732e 706f 696e 7473 5f63 6f6e 7665  cls.points_conve
-0001cdf0: 785f 6875 6c6c 2870 6f69 6e74 7329 2e6c  x_hull(points).l
-0001ce00: 696e 655f 7365 676d 656e 7473 0a20 2020  ine_segments.   
-0001ce10: 2020 2020 2068 756c 6c5f 636f 6e76 6578       hull_convex
-0001ce20: 5f65 6467 6573 2e73 6f72 7428 6b65 793d  _edges.sort(key=
-0001ce30: 6c61 6d62 6461 2078 3a20 782e 6c65 6e67  lambda x: x.leng
-0001ce40: 7468 2829 2c20 7265 7665 7273 653d 5472  th(), reverse=Tr
-0001ce50: 7565 290a 2020 2020 2020 2020 6875 6c6c  ue).        hull
-0001ce60: 5f63 6f6e 6361 7665 5f65 6467 6573 203d  _concave_edges =
-0001ce70: 205b 5d0a 2020 2020 2020 2020 6875 6c6c   [].        hull
-0001ce80: 5f63 6f6e 6361 7665 5f65 6467 6573 2e65  _concave_edges.e
-0001ce90: 7874 656e 6428 6875 6c6c 5f63 6f6e 7665  xtend(hull_conve
-0001cea0: 785f 6564 6765 7329 0a20 2020 2020 2020  x_edges).       
-0001ceb0: 2068 756c 6c5f 706f 696e 7473 203d 206c   hull_points = l
-0001cec0: 6973 7428 7b70 7420 666f 7220 6c69 6e65  ist({pt for line
-0001ced0: 2069 6e20 6875 6c6c 5f63 6f6e 6361 7665   in hull_concave
-0001cee0: 5f65 6467 6573 2066 6f72 2070 7420 696e  _edges for pt in
-0001cef0: 205b 6c69 6e65 5b30 5d2c 206c 696e 655b   [line[0], line[
-0001cf00: 315d 5d7d 290a 2020 2020 2020 2020 756e  1]]}).        un
-0001cf10: 7573 6564 5f70 6f69 6e74 7320 3d20 5b5d  used_points = []
-0001cf20: 0a20 2020 2020 2020 2066 6f72 2070 6f69  .        for poi
-0001cf30: 6e74 2069 6e20 706f 696e 7473 3a0a 2020  nt in points:.  
-0001cf40: 2020 2020 2020 2020 2020 6966 2070 6f69            if poi
-0001cf50: 6e74 206e 6f74 2069 6e20 6875 6c6c 5f70  nt not in hull_p
-0001cf60: 6f69 6e74 733a 0a20 2020 2020 2020 2020  oints:.         
-0001cf70: 2020 2020 2020 2075 6e75 7365 645f 706f         unused_po
-0001cf80: 696e 7473 2e61 7070 656e 6428 706f 696e  ints.append(poin
-0001cf90: 7429 0a0a 2020 2020 2020 2020 615f 6c69  t)..        a_li
-0001cfa0: 6e65 5f77 6173 5f64 6976 6964 6564 5f69  ne_was_divided_i
-0001cfb0: 6e5f 7468 655f 6974 6572 6174 696f 6e20  n_the_iteration 
-0001cfc0: 3d20 5472 7565 0a20 2020 2020 2020 2077  = True.        w
-0001cfd0: 6869 6c65 2061 5f6c 696e 655f 7761 735f  hile a_line_was_
-0001cfe0: 6469 7669 6465 645f 696e 5f74 6865 5f69  divided_in_the_i
-0001cff0: 7465 7261 7469 6f6e 3a0a 2020 2020 2020  teration:.      
-0001d000: 2020 2020 2020 615f 6c69 6e65 5f77 6173        a_line_was
-0001d010: 5f64 6976 6964 6564 5f69 6e5f 7468 655f  _divided_in_the_
-0001d020: 6974 6572 6174 696f 6e20 3d20 4661 6c73  iteration = Fals
-0001d030: 650a 2020 2020 2020 2020 2020 2020 666f  e.            fo
-0001d040: 7220 6c69 6e65 5f70 6f73 6974 696f 6e5f  r line_position_
-0001d050: 6875 6c6c 2069 6e20 7261 6e67 6528 6c65  hull in range(le
-0001d060: 6e28 6875 6c6c 5f63 6f6e 6361 7665 5f65  n(hull_concave_e
-0001d070: 6467 6573 2929 3a0a 0a20 2020 2020 2020  dges)):..       
-0001d080: 2020 2020 2020 2020 206c 696e 6520 3d20           line = 
-0001d090: 6875 6c6c 5f63 6f6e 6361 7665 5f65 6467  hull_concave_edg
-0001d0a0: 6573 5b6c 696e 655f 706f 7369 7469 6f6e  es[line_position
-0001d0b0: 5f68 756c 6c5d 0a20 2020 2020 2020 2020  _hull].         
-0001d0c0: 2020 2020 2020 206e 6561 7262 795f 706f         nearby_po
-0001d0d0: 696e 7473 203d 2067 6574 5f6e 6561 7262  ints = get_nearb
-0001d0e0: 795f 706f 696e 7473 286c 696e 652c 2075  y_points(line, u
-0001d0f0: 6e75 7365 645f 706f 696e 7473 2c0a 2020  nused_points,.  
-0001d100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd10: 206d 696e 5f63 6f73 7369 6e65 5f69 6e64   min_cossine_ind
+0001cd20: 6578 5d29 290a 2020 2020 2020 2020 2020  ex])).          
+0001cd30: 2020 2020 2020 6469 7669 6465 645f 6c69        divided_li
+0001cd40: 6e65 2e61 7070 656e 6428 766f 6c6d 646c  ne.append(volmdl
+0001cd50: 722e 6564 6765 732e 4c69 6e65 5365 676d  r.edges.LineSegm
+0001cd60: 656e 7432 4428 0a20 2020 2020 2020 2020  ent2D(.         
+0001cd70: 2020 2020 2020 2020 2020 206f 6b5f 6d69             ok_mi
+0001cd80: 6464 6c65 5f70 6f69 6e74 735b 6d69 6e5f  ddle_points[min_
+0001cd90: 636f 7373 696e 655f 696e 6465 785d 2c20  cossine_index], 
+0001cda0: 6c69 6e65 2e65 6e64 2929 0a20 2020 2020  line.end)).     
+0001cdb0: 2020 2020 2020 2072 6574 7572 6e20 6469         return di
+0001cdc0: 7669 6465 645f 6c69 6e65 0a0a 2020 2020  vided_line..    
+0001cdd0: 2020 2020 6875 6c6c 5f63 6f6e 7665 785f      hull_convex_
+0001cde0: 6564 6765 7320 3d20 636c 732e 706f 696e  edges = cls.poin
+0001cdf0: 7473 5f63 6f6e 7665 785f 6875 6c6c 2870  ts_convex_hull(p
+0001ce00: 6f69 6e74 7329 2e6c 696e 655f 7365 676d  oints).line_segm
+0001ce10: 656e 7473 0a20 2020 2020 2020 2068 756c  ents.        hul
+0001ce20: 6c5f 636f 6e76 6578 5f65 6467 6573 2e73  l_convex_edges.s
+0001ce30: 6f72 7428 6b65 793d 6c61 6d62 6461 2078  ort(key=lambda x
+0001ce40: 3a20 782e 6c65 6e67 7468 2829 2c20 7265  : x.length(), re
+0001ce50: 7665 7273 653d 5472 7565 290a 2020 2020  verse=True).    
+0001ce60: 2020 2020 6875 6c6c 5f63 6f6e 6361 7665      hull_concave
+0001ce70: 5f65 6467 6573 203d 205b 5d0a 2020 2020  _edges = [].    
+0001ce80: 2020 2020 6875 6c6c 5f63 6f6e 6361 7665      hull_concave
+0001ce90: 5f65 6467 6573 2e65 7874 656e 6428 6875  _edges.extend(hu
+0001cea0: 6c6c 5f63 6f6e 7665 785f 6564 6765 7329  ll_convex_edges)
+0001ceb0: 0a20 2020 2020 2020 2068 756c 6c5f 706f  .        hull_po
+0001cec0: 696e 7473 203d 206c 6973 7428 7b70 7420  ints = list({pt 
+0001ced0: 666f 7220 6c69 6e65 2069 6e20 6875 6c6c  for line in hull
+0001cee0: 5f63 6f6e 6361 7665 5f65 6467 6573 2066  _concave_edges f
+0001cef0: 6f72 2070 7420 696e 205b 6c69 6e65 5b30  or pt in [line[0
+0001cf00: 5d2c 206c 696e 655b 315d 5d7d 290a 2020  ], line[1]]}).  
+0001cf10: 2020 2020 2020 756e 7573 6564 5f70 6f69        unused_poi
+0001cf20: 6e74 7320 3d20 5b5d 0a20 2020 2020 2020  nts = [].       
+0001cf30: 2066 6f72 2070 6f69 6e74 2069 6e20 706f   for point in po
+0001cf40: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
+0001cf50: 2020 6966 2070 6f69 6e74 206e 6f74 2069    if point not i
+0001cf60: 6e20 6875 6c6c 5f70 6f69 6e74 733a 0a20  n hull_points:. 
+0001cf70: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+0001cf80: 6e75 7365 645f 706f 696e 7473 2e61 7070  nused_points.app
+0001cf90: 656e 6428 706f 696e 7429 0a0a 2020 2020  end(point)..    
+0001cfa0: 2020 2020 615f 6c69 6e65 5f77 6173 5f64      a_line_was_d
+0001cfb0: 6976 6964 6564 5f69 6e5f 7468 655f 6974  ivided_in_the_it
+0001cfc0: 6572 6174 696f 6e20 3d20 5472 7565 0a20  eration = True. 
+0001cfd0: 2020 2020 2020 2077 6869 6c65 2061 5f6c         while a_l
+0001cfe0: 696e 655f 7761 735f 6469 7669 6465 645f  ine_was_divided_
+0001cff0: 696e 5f74 6865 5f69 7465 7261 7469 6f6e  in_the_iteration
+0001d000: 3a0a 2020 2020 2020 2020 2020 2020 615f  :.            a_
+0001d010: 6c69 6e65 5f77 6173 5f64 6976 6964 6564  line_was_divided
+0001d020: 5f69 6e5f 7468 655f 6974 6572 6174 696f  _in_the_iteratio
+0001d030: 6e20 3d20 4661 6c73 650a 2020 2020 2020  n = False.      
+0001d040: 2020 2020 2020 666f 7220 6c69 6e65 5f70        for line_p
+0001d050: 6f73 6974 696f 6e5f 6875 6c6c 2069 6e20  osition_hull in 
+0001d060: 7261 6e67 6528 6c65 6e28 6875 6c6c 5f63  range(len(hull_c
+0001d070: 6f6e 6361 7665 5f65 6467 6573 2929 3a0a  oncave_edges)):.
+0001d080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d090: 206c 696e 6520 3d20 6875 6c6c 5f63 6f6e   line = hull_con
+0001d0a0: 6361 7665 5f65 6467 6573 5b6c 696e 655f  cave_edges[line_
+0001d0b0: 706f 7369 7469 6f6e 5f68 756c 6c5d 0a20  position_hull]. 
+0001d0c0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0001d0d0: 6561 7262 795f 706f 696e 7473 203d 2067  earby_points = g
+0001d0e0: 6574 5f6e 6561 7262 795f 706f 696e 7473  et_nearby_points
+0001d0f0: 286c 696e 652c 2075 6e75 7365 645f 706f  (line, unused_po
+0001d100: 696e 7473 2c0a 2020 2020 2020 2020 2020  ints,.          
 0001d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001d120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d130: 7363 616c 655f 6661 6374 6f72 290a 2020  scale_factor).  
-0001d140: 2020 2020 2020 2020 2020 2020 2020 6469                di
-0001d150: 7669 6465 645f 6c69 6e65 203d 2067 6574  vided_line = get
-0001d160: 5f64 6976 6964 6564 5f6c 696e 6528 6c69  _divided_line(li
-0001d170: 6e65 2c20 6e65 6172 6279 5f70 6f69 6e74  ne, nearby_point
-0001d180: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0001d130: 2020 2020 2020 2020 7363 616c 655f 6661          scale_fa
+0001d140: 6374 6f72 290a 2020 2020 2020 2020 2020  ctor).          
+0001d150: 2020 2020 2020 6469 7669 6465 645f 6c69        divided_li
+0001d160: 6e65 203d 2067 6574 5f64 6976 6964 6564  ne = get_divided
+0001d170: 5f6c 696e 6528 6c69 6e65 2c20 6e65 6172  _line(line, near
+0001d180: 6279 5f70 6f69 6e74 732c 0a20 2020 2020  by_points,.     
 0001d190: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d1b0: 2020 2068 756c 6c5f 636f 6e63 6176 655f     hull_concave_
-0001d1c0: 6564 6765 732c 2063 6f6e 6361 7669 7479  edges, concavity
-0001d1d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001d1e0: 2020 6966 206c 656e 2864 6976 6964 6564    if len(divided
-0001d1f0: 5f6c 696e 6529 203e 2030 3a0a 2020 2020  _line) > 0:.    
-0001d200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d210: 615f 6c69 6e65 5f77 6173 5f64 6976 6964  a_line_was_divid
-0001d220: 6564 5f69 6e5f 7468 655f 6974 6572 6174  ed_in_the_iterat
-0001d230: 696f 6e20 3d20 5472 7565 0a20 2020 2020  ion = True.     
-0001d240: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-0001d250: 6e75 7365 645f 706f 696e 7473 2e72 656d  nused_points.rem
-0001d260: 6f76 6528 6469 7669 6465 645f 6c69 6e65  ove(divided_line
-0001d270: 5b30 5d2e 656e 6429 0a20 2020 2020 2020  [0].end).       
-0001d280: 2020 2020 2020 2020 2020 2020 2068 756c               hul
-0001d290: 6c5f 636f 6e63 6176 655f 6564 6765 732e  l_concave_edges.
-0001d2a0: 7265 6d6f 7665 286c 696e 6529 0a20 2020  remove(line).   
-0001d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2c0: 2068 756c 6c5f 636f 6e63 6176 655f 6564   hull_concave_ed
-0001d2d0: 6765 732e 6578 7465 6e64 2864 6976 6964  ges.extend(divid
-0001d2e0: 6564 5f6c 696e 6529 0a20 2020 2020 2020  ed_line).       
-0001d2f0: 2020 2020 2020 2020 2020 2020 2062 7265               bre
-0001d300: 616b 0a0a 2020 2020 2020 2020 2020 2020  ak..            
-0001d310: 6875 6c6c 5f63 6f6e 6361 7665 5f65 6467  hull_concave_edg
-0001d320: 6573 2e73 6f72 7428 6b65 793d 6c61 6d62  es.sort(key=lamb
-0001d330: 6461 2078 3a20 782e 6c65 6e67 7468 2829  da x: x.length()
-0001d340: 2c20 7265 7665 7273 653d 5472 7565 290a  , reverse=True).
-0001d350: 0a20 2020 2020 2020 2023 206c 696e 6520  .        # line 
-0001d360: 203d 2068 756c 6c5f 636f 6e63 6176 655f   = hull_concave_
-0001d370: 6564 6765 735b 305d 0a20 2020 2020 2020  edges[0].       
-0001d380: 2023 2070 7269 6e74 2827 6669 7273 7420   # print('first 
-0001d390: 6c69 6e65 206c 656e 6774 6820 3a27 2c20  line length :', 
-0001d3a0: 6c69 6e65 2e6c 656e 6774 6828 2929 0a20  line.length()). 
-0001d3b0: 2020 2020 2020 2023 206e 6561 7262 795f         # nearby_
-0001d3c0: 706f 696e 7473 203d 2067 6574 5f6e 6561  points = get_nea
-0001d3d0: 7262 795f 706f 696e 7473 286c 696e 652c  rby_points(line,
-0001d3e0: 2075 6e75 7365 645f 706f 696e 7473 2c20   unused_points, 
-0001d3f0: 7363 616c 655f 6661 6374 6f72 290a 2020  scale_factor).  
-0001d400: 2020 2020 2020 2320 7072 696e 7428 2770        # print('p
-0001d410: 6f69 6e74 7320 6e65 7874 2074 6865 2066  oints next the f
-0001d420: 6972 7374 206c 696e 6520 696e 2074 6865  irst line in the
-0001d430: 2065 6e64 3a20 272c 206e 6561 7262 795f   end: ', nearby_
-0001d440: 706f 696e 7473 290a 2020 2020 2020 2020  points).        
-0001d450: 2320 6469 7669 6465 645f 6c69 6e65 203d  # divided_line =
-0001d460: 2067 6574 5f64 6976 6964 6564 5f6c 696e   get_divided_lin
-0001d470: 6528 6c69 6e65 2c20 6e65 6172 6279 5f70  e(line, nearby_p
-0001d480: 6f69 6e74 732c 2068 756c 6c5f 636f 6e63  oints, hull_conc
-0001d490: 6176 655f 6564 6765 732c 2063 6f6e 6361  ave_edges, conca
-0001d4a0: 7669 7479 290a 2020 2020 2020 2020 2320  vity).        # 
-0001d4b0: 7072 696e 7428 276c 656e 2064 6976 6964  print('len divid
-0001d4c0: 6564 206c 696e 6520 3a27 2c20 6c65 6e28  ed line :', len(
-0001d4d0: 6469 7669 6465 645f 6c69 6e65 2929 0a20  divided_line)). 
-0001d4e0: 2020 2020 2020 2070 6f6c 7967 6f6e 5f70         polygon_p
-0001d4f0: 6f69 6e74 7320 3d20 5b28 6c69 6e65 2e73  oints = [(line.s
-0001d500: 7461 7274 2c20 6c69 6e65 2e65 6e64 2920  tart, line.end) 
-0001d510: 666f 7220 6c69 6e65 2069 6e20 6875 6c6c  for line in hull
-0001d520: 5f63 6f6e 6361 7665 5f65 6467 6573 5d0a  _concave_edges].
-0001d530: 2020 2020 2020 2020 2320 706f 6c79 676f          # polygo
-0001d540: 6e5f 706f 696e 7473 203d 205b 286c 696e  n_points = [(lin
-0001d550: 652e 7374 6172 742c 206c 696e 652e 656e  e.start, line.en
-0001d560: 6429 2066 6f72 206c 696e 6520 696e 2068  d) for line in h
-0001d570: 756c 6c5f 636f 6e63 6176 655f 6564 6765  ull_concave_edge
-0001d580: 730a 2020 2020 2020 2020 2320 2020 2020  s.        #     
-0001d590: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001d5a0: 206c 696e 652e 6c65 6e67 7468 2829 2021   line.length() !
-0001d5b0: 3d20 305d 0a0a 2020 2020 2020 2020 706f  = 0]..        po
-0001d5c0: 696e 7473 203d 205b 706f 6c79 676f 6e5f  ints = [polygon_
-0001d5d0: 706f 696e 7473 5b30 5d5b 305d 2c20 706f  points[0][0], po
-0001d5e0: 6c79 676f 6e5f 706f 696e 7473 5b30 5d5b  lygon_points[0][
-0001d5f0: 315d 5d0a 2020 2020 2020 2020 706f 6c79  1]].        poly
-0001d600: 676f 6e5f 706f 696e 7473 2e72 656d 6f76  gon_points.remov
-0001d610: 6528 2870 6f6c 7967 6f6e 5f70 6f69 6e74  e((polygon_point
-0001d620: 735b 305d 5b30 5d2c 2070 6f6c 7967 6f6e  s[0][0], polygon
-0001d630: 5f70 6f69 6e74 735b 305d 5b31 5d29 290a  _points[0][1])).
-0001d640: 2020 2020 2020 2020 6669 6e69 7368 6564          finished
-0001d650: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
-0001d660: 2020 7768 696c 6520 6e6f 7420 6669 6e69    while not fini
-0001d670: 7368 6564 3a0a 2020 2020 2020 2020 2020  shed:.          
-0001d680: 2020 666f 7220 7031 2c20 7032 2069 6e20    for p1, p2 in 
-0001d690: 706f 6c79 676f 6e5f 706f 696e 7473 3a0a  polygon_points:.
-0001d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d6b0: 6966 2070 3120 3d3d 2070 6f69 6e74 735b  if p1 == points[
-0001d6c0: 2d31 5d20 616e 6420 7032 206e 6f74 2069  -1] and p2 not i
-0001d6d0: 6e20 706f 696e 7473 3a0a 2020 2020 2020  n points:.      
-0001d6e0: 2020 2020 2020 2020 2020 2020 2020 706f                po
-0001d6f0: 696e 7473 2e61 7070 656e 6428 7032 290a  ints.append(p2).
-0001d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d710: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
-0001d720: 2020 2020 2020 2020 2020 656c 6966 2070            elif p
-0001d730: 3220 3d3d 2070 6f69 6e74 735b 2d31 5d20  2 == points[-1] 
-0001d740: 616e 6420 7031 206e 6f74 2069 6e20 706f  and p1 not in po
-0001d750: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
-0001d760: 2020 2020 2020 2020 2020 706f 696e 7473            points
-0001d770: 2e61 7070 656e 6428 7031 290a 2020 2020  .append(p1).    
-0001d780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d790: 6272 6561 6b0a 2020 2020 2020 2020 2020  break.          
-0001d7a0: 2020 706f 6c79 676f 6e5f 706f 696e 7473    polygon_points
-0001d7b0: 2e72 656d 6f76 6528 2870 312c 2070 3229  .remove((p1, p2)
-0001d7c0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-0001d7d0: 206c 656e 2870 6f6c 7967 6f6e 5f70 6f69   len(polygon_poi
-0001d7e0: 6e74 7329 203d 3d20 303a 0a20 2020 2020  nts) == 0:.     
-0001d7f0: 2020 2020 2020 2020 2020 2066 696e 6973             finis
-0001d800: 6865 6420 3d20 5472 7565 0a0a 2020 2020  hed = True..    
-0001d810: 2020 2020 7265 7475 726e 2063 6c73 2870      return cls(p
-0001d820: 6f69 6e74 7329 2020 2320 2c20 6e65 6172  oints)  # , near
-0001d830: 6279 5f70 6f69 6e74 730a 0a20 2020 2040  by_points..    @
-0001d840: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
-0001d850: 6465 6620 636f 6e76 6578 5f68 756c 6c5f  def convex_hull_
-0001d860: 706f 696e 7473 2863 6c73 2c20 706f 696e  points(cls, poin
-0001d870: 7473 293a 0a20 2020 2020 2020 2022 2222  ts):.        """
-0001d880: 0a20 2020 2020 2020 2055 7365 7320 7468  .        Uses th
-0001d890: 6520 7363 6970 7920 6d65 7468 6f64 2043  e scipy method C
-0001d8a0: 6f6e 7665 7848 756c 6c20 746f 2063 616c  onvexHull to cal
-0001d8b0: 6375 6c61 7465 2074 6865 2063 6f6e 7665  culate the conve
-0001d8c0: 7820 6875 6c6c 2066 726f 6d0a 2020 2020  x hull from.    
-0001d8d0: 2020 2020 6120 636c 6f75 6420 6f66 2070      a cloud of p
-0001d8e0: 6f69 6e74 730a 2020 2020 2020 2020 2222  oints.        ""
-0001d8f0: 220a 0a20 2020 2020 2020 2070 6f69 6e74  "..        point
-0001d900: 735f 6875 6c6c 203d 205b 7074 2e63 6f70  s_hull = [pt.cop
-0001d910: 7928 2920 666f 7220 7074 2069 6e20 706f  y() for pt in po
-0001d920: 696e 7473 5d0a 0a20 2020 2020 2020 206e  ints]..        n
-0001d930: 756d 7079 5f70 6f69 6e74 7320 3d20 6e70  umpy_points = np
-0001d940: 792e 6172 7261 7928 5b28 702e 782c 2070  y.array([(p.x, p
-0001d950: 2e79 2920 666f 7220 7020 696e 2070 6f69  .y) for p in poi
-0001d960: 6e74 735f 6875 6c6c 5d29 0a20 2020 2020  nts_hull]).     
-0001d970: 2020 2068 756c 6c20 3d20 436f 6e76 6578     hull = Convex
-0001d980: 4875 6c6c 286e 756d 7079 5f70 6f69 6e74  Hull(numpy_point
-0001d990: 7329 0a20 2020 2020 2020 2070 6f6c 7967  s).        polyg
-0001d9a0: 6f6e 5f70 6f69 6e74 7320 3d20 5b5d 0a20  on_points = []. 
-0001d9b0: 2020 2020 2020 2066 6f72 2073 696d 706c         for simpl
-0001d9c0: 6578 2069 6e20 6875 6c6c 2e73 696d 706c  ex in hull.simpl
-0001d9d0: 6963 6573 3a0a 2020 2020 2020 2020 2020  ices:.          
-0001d9e0: 2020 706f 6c79 676f 6e5f 706f 696e 7473    polygon_points
-0001d9f0: 2e61 7070 656e 6428 2870 6f69 6e74 735f  .append((points_
-0001da00: 6875 6c6c 5b73 696d 706c 6578 5b30 5d5d  hull[simplex[0]]
-0001da10: 2c20 706f 696e 7473 5f68 756c 6c5b 7369  , points_hull[si
-0001da20: 6d70 6c65 785b 315d 5d29 290a 0a20 2020  mplex[1]]))..   
-0001da30: 2020 2020 2070 6f69 6e74 735f 6875 6c6c       points_hull
-0001da40: 203d 205b 706f 6c79 676f 6e5f 706f 696e   = [polygon_poin
-0001da50: 7473 5b30 5d5b 305d 2c20 706f 6c79 676f  ts[0][0], polygo
-0001da60: 6e5f 706f 696e 7473 5b30 5d5b 315d 5d0a  n_points[0][1]].
-0001da70: 2020 2020 2020 2020 706f 6c79 676f 6e5f          polygon_
-0001da80: 706f 696e 7473 2e72 656d 6f76 6528 2870  points.remove((p
-0001da90: 6f6c 7967 6f6e 5f70 6f69 6e74 735b 305d  olygon_points[0]
-0001daa0: 5b30 5d2c 2070 6f6c 7967 6f6e 5f70 6f69  [0], polygon_poi
-0001dab0: 6e74 735b 305d 5b31 5d29 290a 2020 2020  nts[0][1])).    
-0001dac0: 2020 2020 6669 6e69 7368 6564 203d 2046      finished = F
-0001dad0: 616c 7365 0a0a 2020 2020 2020 2020 7768  alse..        wh
-0001dae0: 696c 6520 6e6f 7420 6669 6e69 7368 6564  ile not finished
-0001daf0: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
-0001db00: 7220 7031 2c20 7032 2069 6e20 706f 6c79  r p1, p2 in poly
-0001db10: 676f 6e5f 706f 696e 7473 3a0a 2020 2020  gon_points:.    
-0001db20: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-0001db30: 3120 3d3d 2070 6f69 6e74 735f 6875 6c6c  1 == points_hull
-0001db40: 5b2d 315d 3a0a 2020 2020 2020 2020 2020  [-1]:.          
-0001db50: 2020 2020 2020 2020 2020 706f 696e 7473            points
-0001db60: 5f68 756c 6c2e 6170 7065 6e64 2870 3229  _hull.append(p2)
-0001db70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001db80: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
-0001db90: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0001dba0: 7032 203d 3d20 706f 696e 7473 5f68 756c  p2 == points_hul
-0001dbb0: 6c5b 2d31 5d3a 0a20 2020 2020 2020 2020  l[-1]:.         
-0001dbc0: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-0001dbd0: 735f 6875 6c6c 2e61 7070 656e 6428 7031  s_hull.append(p1
-0001dbe0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001dbf0: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-0001dc00: 2020 2020 2020 2020 706f 6c79 676f 6e5f          polygon_
-0001dc10: 706f 696e 7473 2e72 656d 6f76 6528 2870  points.remove((p
-0001dc20: 312c 2070 3229 290a 2020 2020 2020 2020  1, p2)).        
-0001dc30: 2020 2020 6966 206c 656e 2870 6f6c 7967      if len(polyg
-0001dc40: 6f6e 5f70 6f69 6e74 7329 203d 3d20 303a  on_points) == 0:
-0001dc50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001dc60: 2066 696e 6973 6865 6420 3d20 5472 7565   finished = True
-0001dc70: 0a0a 2020 2020 2020 2020 706f 696e 7473  ..        points
-0001dc80: 5f68 756c 6c2e 706f 7028 2d31 290a 0a20  _hull.pop(-1).. 
-0001dc90: 2020 2020 2020 2023 2074 6865 2066 6972         # the fir
-0001dca0: 7374 2070 6f69 6e74 2069 7320 7468 6520  st point is the 
-0001dcb0: 6f6e 6520 7769 7468 2074 6865 206c 6f77  one with the low
-0001dcc0: 6573 7420 7820 7661 6c75 650a 2020 2020  est x value.    
-0001dcd0: 2020 2020 695f 6d69 6e20 3d20 300a 2020      i_min = 0.  
-0001dce0: 2020 2020 2020 6d69 6e5f 7820 3d20 706f        min_x = po
-0001dcf0: 696e 7473 5f68 756c 6c5b 305d 2e78 0a20  ints_hull[0].x. 
-0001dd00: 2020 2020 2020 2066 6f72 2069 2c20 706f         for i, po
-0001dd10: 696e 7420 696e 2065 6e75 6d65 7261 7465  int in enumerate
-0001dd20: 2870 6f69 6e74 735f 6875 6c6c 293a 0a20  (points_hull):. 
-0001dd30: 2020 2020 2020 2020 2020 2069 6620 706f             if po
-0001dd40: 696e 742e 7820 3c20 6d69 6e5f 783a 0a20  int.x < min_x:. 
-0001dd50: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0001dd60: 696e 5f78 203d 2070 6f69 6e74 2e78 0a20  in_x = point.x. 
-0001dd70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001dd80: 5f6d 696e 203d 2069 0a0a 2020 2020 2020  _min = i..      
-0001dd90: 2020 706f 696e 7473 5f68 756c 6c20 3d20    points_hull = 
-0001dda0: 706f 696e 7473 5f68 756c 6c5b 695f 6d69  points_hull[i_mi
-0001ddb0: 6e3a 5d20 2b20 706f 696e 7473 5f68 756c  n:] + points_hul
-0001ddc0: 6c5b 3a69 5f6d 696e 5d0a 0a20 2020 2020  l[:i_min]..     
-0001ddd0: 2020 2023 2077 6520 6d61 6b65 2073 7572     # we make sur
-0001dde0: 6520 7468 6174 2074 6865 2070 6f69 6e74  e that the point
-0001ddf0: 7320 6172 6520 6f72 6465 7265 6420 696e  s are ordered in
-0001de00: 2074 6865 2074 7269 676f 6e6f 6d65 7472   the trigonometr
-0001de10: 6963 2064 6972 6563 7469 6f6e 0a20 2020  ic direction.   
-0001de20: 2020 2020 2069 6620 706f 696e 7473 5f68       if points_h
-0001de30: 756c 6c5b 305d 2e79 203c 2070 6f69 6e74  ull[0].y < point
-0001de40: 735f 6875 6c6c 5b31 5d2e 793a 0a20 2020  s_hull[1].y:.   
-0001de50: 2020 2020 2020 2020 2070 6f69 6e74 735f           points_
-0001de60: 6875 6c6c 2e72 6576 6572 7365 2829 0a0a  hull.reverse()..
-0001de70: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-0001de80: 6c73 2870 6f69 6e74 735f 6875 6c6c 290a  ls(points_hull).
-0001de90: 0a20 2020 2064 6566 2074 6f5f 3364 2873  .    def to_3d(s
-0001dea0: 656c 662c 2070 6c61 6e65 5f6f 7269 6769  elf, plane_origi
-0001deb0: 6e2c 2078 2c20 7929 3a0a 2020 2020 2020  n, x, y):.      
-0001dec0: 2020 2222 220a 2020 2020 2020 2020 5472    """.        Tr
-0001ded0: 616e 7366 6f72 6d73 2061 2043 6c6f 7365  ansforms a Close
-0001dee0: 6450 6f6c 7967 6f6e 3244 2069 6e74 6f20  dPolygon2D into 
-0001def0: 616e 2043 6c6f 7365 6450 6f6c 7967 6f6e  an ClosedPolygon
-0001df00: 3344 2c20 6769 7665 6e20 6120 706c 616e  3D, given a plan
-0001df10: 6520 6f72 6967 696e 2061 6e64 2061 6e20  e origin and an 
-0001df20: 7520 616e 6420 7620 706c 616e 6520 7665  u and v plane ve
-0001df30: 6374 6f72 2e0a 0a20 2020 2020 2020 203a  ctor...        :
-0001df40: 7061 7261 6d20 706c 616e 655f 6f72 6967  param plane_orig
-0001df50: 696e 3a20 706c 616e 6520 6f72 6967 696e  in: plane origin
-0001df60: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001df70: 2078 3a20 706c 616e 6520 7520 7665 6374   x: plane u vect
-0001df80: 6f72 2e0a 2020 2020 2020 2020 3a70 6172  or..        :par
-0001df90: 616d 2079 3a20 706c 616e 6520 7620 7665  am y: plane v ve
-0001dfa0: 6374 6f72 2e0a 2020 2020 2020 2020 3a72  ctor..        :r
-0001dfb0: 6574 7572 6e3a 2043 6c6f 7365 6450 6f6c  eturn: ClosedPol
-0001dfc0: 7967 6f6e 3344 2e0a 2020 2020 2020 2020  ygon3D..        
-0001dfd0: 2222 220a 2020 2020 2020 2020 706f 696e  """.        poin
-0001dfe0: 7473 3364 203d 205b 706f 696e 742e 746f  ts3d = [point.to
-0001dff0: 5f33 6428 706c 616e 655f 6f72 6967 696e  _3d(plane_origin
-0001e000: 2c20 782c 2079 2920 666f 7220 706f 696e  , x, y) for poin
-0001e010: 7420 696e 2073 656c 662e 706f 696e 7473  t in self.points
-0001e020: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
-0001e030: 2043 6c6f 7365 6450 6f6c 7967 6f6e 3344   ClosedPolygon3D
-0001e040: 2870 6f69 6e74 7333 6429 0a0a 2020 2020  (points3d)..    
-0001e050: 6465 6620 706c 6f74 2873 656c 662c 2061  def plot(self, a
-0001e060: 783d 4e6f 6e65 2c20 636f 6c6f 723d 276b  x=None, color='k
-0001e070: 272c 2061 6c70 6861 3d31 2c0a 2020 2020  ', alpha=1,.    
-0001e080: 2020 2020 2020 2020 2070 6c6f 745f 706f           plot_po
-0001e090: 696e 7473 3d46 616c 7365 2c20 706f 696e  ints=False, poin
-0001e0a0: 745f 6e75 6d62 6572 696e 673d 4661 6c73  t_numbering=Fals
-0001e0b0: 652c 2061 7272 6f77 3d46 616c 7365 2c0a  e, arrow=False,.
-0001e0c0: 2020 2020 2020 2020 2020 2020 2066 696c               fil
-0001e0d0: 6c3d 4661 6c73 652c 2066 696c 6c5f 636f  l=False, fill_co
-0001e0e0: 6c6f 723d 2777 272c 2065 7175 616c 5f61  lor='w', equal_a
-0001e0f0: 7370 6563 743d 5472 7565 293a 0a20 2020  spect=True):.   
-0001e100: 2020 2020 2069 6620 6178 2069 7320 4e6f       if ax is No
-0001e110: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0001e120: 5f2c 2061 7820 3d20 706c 742e 7375 6270  _, ax = plt.subp
-0001e130: 6c6f 7473 2829 0a20 2020 2020 2020 2020  lots().         
-0001e140: 2020 2061 782e 7365 745f 6173 7065 6374     ax.set_aspect
-0001e150: 2827 6571 7561 6c27 290a 0a20 2020 2020  ('equal')..     
-0001e160: 2020 2069 6620 6669 6c6c 3a0a 2020 2020     if fill:.    
-0001e170: 2020 2020 2020 2020 6178 2e66 696c 6c28          ax.fill(
-0001e180: 5b70 5b30 5d20 666f 7220 7020 696e 2073  [p[0] for p in s
-0001e190: 656c 662e 706f 696e 7473 5d2c 205b 705b  elf.points], [p[
-0001e1a0: 315d 2066 6f72 2070 2069 6e20 7365 6c66  1] for p in self
-0001e1b0: 2e70 6f69 6e74 735d 2c0a 2020 2020 2020  .points],.      
-0001e1c0: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-0001e1d0: 6365 636f 6c6f 723d 6669 6c6c 5f63 6f6c  cecolor=fill_col
-0001e1e0: 6f72 290a 2020 2020 2020 2020 666f 7220  or).        for 
-0001e1f0: 6c69 6e65 5f73 6567 6d65 6e74 2069 6e20  line_segment in 
-0001e200: 7365 6c66 2e6c 696e 655f 7365 676d 656e  self.line_segmen
-0001e210: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-0001e220: 6c69 6e65 5f73 6567 6d65 6e74 2e70 6c6f  line_segment.plo
-0001e230: 7428 6178 3d61 782c 2063 6f6c 6f72 3d63  t(ax=ax, color=c
-0001e240: 6f6c 6f72 2c20 616c 7068 613d 616c 7068  olor, alpha=alph
-0001e250: 612c 2061 7272 6f77 3d61 7272 6f77 290a  a, arrow=arrow).
-0001e260: 0a20 2020 2020 2020 2069 6620 706c 6f74  .        if plot
-0001e270: 5f70 6f69 6e74 7320 6f72 2070 6f69 6e74  _points or point
-0001e280: 5f6e 756d 6265 7269 6e67 3a0a 2020 2020  _numbering:.    
-0001e290: 2020 2020 2020 2020 666f 7220 706f 696e          for poin
-0001e2a0: 7420 696e 2073 656c 662e 706f 696e 7473  t in self.points
-0001e2b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001e2c0: 2020 706f 696e 742e 706c 6f74 2861 783d    point.plot(ax=
-0001e2d0: 6178 2c20 636f 6c6f 723d 636f 6c6f 722c  ax, color=color,
-0001e2e0: 2061 6c70 6861 3d61 6c70 6861 290a 0a20   alpha=alpha).. 
-0001e2f0: 2020 2020 2020 2069 6620 706f 696e 745f         if point_
-0001e300: 6e75 6d62 6572 696e 673a 0a20 2020 2020  numbering:.     
-0001e310: 2020 2020 2020 2066 6f72 2069 702c 2070         for ip, p
-0001e320: 6f69 6e74 2069 6e20 656e 756d 6572 6174  oint in enumerat
-0001e330: 6528 7365 6c66 2e70 6f69 6e74 7329 3a0a  e(self.points):.
-0001e340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e350: 6178 2e74 6578 7428 2a70 6f69 6e74 2c20  ax.text(*point, 
-0001e360: 2770 6f69 6e74 207b 7d27 2e66 6f72 6d61  'point {}'.forma
-0001e370: 7428 6970 202b 2031 292c 0a20 2020 2020  t(ip + 1),.     
-0001e380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e390: 2020 2068 613d 2763 656e 7465 7227 2c20     ha='center', 
-0001e3a0: 7661 3d27 746f 7027 290a 0a20 2020 2020  va='top')..     
-0001e3b0: 2020 2069 6620 6571 7561 6c5f 6173 7065     if equal_aspe
-0001e3c0: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
-0001e3d0: 6178 2e73 6574 5f61 7370 6563 7428 2765  ax.set_aspect('e
-0001e3e0: 7175 616c 2729 0a20 2020 2020 2020 2065  qual').        e
-0001e3f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001e400: 2061 782e 7365 745f 6173 7065 6374 2827   ax.set_aspect('
-0001e410: 6175 746f 2729 0a0a 2020 2020 2020 2020  auto')..        
-0001e420: 6178 2e6d 6172 6769 6e73 2830 2e31 290a  ax.margins(0.1).
-0001e430: 2020 2020 2020 2020 706c 742e 7368 6f77          plt.show
-0001e440: 2829 0a0a 2020 2020 2020 2020 7265 7475  ()..        retu
-0001e450: 726e 2061 780a 0a20 2020 2064 6566 2074  rn ax..    def t
-0001e460: 7269 616e 6775 6c61 7469 6f6e 2873 656c  riangulation(sel
-0001e470: 662c 2074 7269 5f6f 7074 3a20 7374 7220  f, tri_opt: str 
-0001e480: 3d20 2770 6427 293a 0a20 2020 2020 2020  = 'pd'):.       
-0001e490: 2022 2222 0a20 2020 2020 2020 2050 6572   """.        Per
-0001e4a0: 666f 726d 2074 7269 616e 6775 6c61 7469  form triangulati
-0001e4b0: 6f6e 206f 6e20 7468 6520 706f 6c79 676f  on on the polygo
-0001e4c0: 6e2e 0a0a 2020 2020 2020 2020 546f 2064  n...        To d
-0001e4d0: 6574 6169 6c20 646f 6375 6d65 6e74 6174  etail documentat
-0001e4e0: 696f 6e2c 2070 6c65 6173 6520 7265 6665  ion, please refe
-0001e4f0: 7220 746f 2068 7474 7073 3a2f 2f72 7566  r to https://ruf
-0001e500: 6174 2e62 652f 7472 6961 6e67 6c65 2f41  at.be/triangle/A
-0001e510: 5049 2e68 746d 6c0a 0a20 2020 2020 2020  PI.html..       
-0001e520: 203a 7061 7261 6d20 7472 695f 6f70 743a   :param tri_opt:
-0001e530: 2028 4f70 7469 6f6e 616c 2920 5472 6961   (Optional) Tria
-0001e540: 6e67 756c 6174 696f 6e20 7072 6566 6572  ngulation prefer
-0001e550: 656e 6365 732e 0a20 2020 2020 2020 203a  ences..        :
-0001e560: 7479 7065 2074 7269 5f6f 7074 3a20 7374  type tri_opt: st
-0001e570: 720a 2020 2020 2020 2020 3a72 6574 7572  r.        :retur
-0001e580: 6e3a 2041 2032 4420 6d65 7368 2e0a 2020  n: A 2D mesh..  
-0001e590: 2020 2020 2020 3a72 7479 7065 3a20 3a63        :rtype: :c
-0001e5a0: 6c61 7373 3a60 766d 642e 4469 7370 6c61  lass:`vmd.Displa
-0001e5b0: 794d 6573 6832 4460 0a20 2020 2020 2020  yMesh2D`.       
-0001e5c0: 2022 2222 0a20 2020 2020 2020 2023 2043   """.        # C
-0001e5d0: 6f6e 7665 7274 696e 6720 706f 696e 7473  onverting points
-0001e5e0: 2074 6f20 6e6f 6465 7320 666f 7220 7065   to nodes for pe
-0001e5f0: 7266 6f72 6d61 6e63 650a 2020 2020 2020  rformance.      
-0001e600: 2020 6e6f 6465 7320 3d20 5b76 6d64 2e4e    nodes = [vmd.N
-0001e610: 6f64 6532 442e 6672 6f6d 5f70 6f69 6e74  ode2D.from_point
-0001e620: 2870 2920 666f 7220 7020 696e 2073 656c  (p) for p in sel
-0001e630: 662e 706f 696e 7473 5d0a 2020 2020 2020  f.points].      
-0001e640: 2020 7665 7274 6963 6573 203d 205b 2870    vertices = [(p
-0001e650: 2e78 2c20 702e 7929 2066 6f72 2070 2069  .x, p.y) for p i
-0001e660: 6e20 6e6f 6465 735d 0a20 2020 2020 2020  n nodes].       
-0001e670: 206e 203d 206c 656e 286e 6f64 6573 290a   n = len(nodes).
-0001e680: 2020 2020 2020 2020 7365 676d 656e 7473          segments
-0001e690: 203d 205b 2869 2c20 6920 2b20 3129 2066   = [(i, i + 1) f
-0001e6a0: 6f72 2069 2069 6e20 7261 6e67 6528 6e20  or i in range(n 
-0001e6b0: 2d20 3129 5d0a 2020 2020 2020 2020 7365  - 1)].        se
-0001e6c0: 676d 656e 7473 2e61 7070 656e 6428 286e  gments.append((n
-0001e6d0: 202d 2031 2c20 3029 290a 0a20 2020 2020   - 1, 0))..     
-0001e6e0: 2020 2074 7269 203d 207b 2776 6572 7469     tri = {'verti
-0001e6f0: 6365 7327 3a20 6e70 792e 6172 7261 7928  ces': npy.array(
-0001e700: 7665 7274 6963 6573 292e 7265 7368 6170  vertices).reshap
-0001e710: 6528 282d 312c 2032 2929 2c0a 2020 2020  e((-1, 2)),.    
-0001e720: 2020 2020 2020 2020 2020 2027 7365 676d             'segm
-0001e730: 656e 7473 273a 206e 7079 2e61 7272 6179  ents': npy.array
-0001e740: 2873 6567 6d65 6e74 7329 2e72 6573 6861  (segments).resha
-0001e750: 7065 2828 2d31 2c20 3229 292c 0a20 2020  pe((-1, 2)),.   
-0001e760: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-0001e770: 2020 2020 2020 7420 3d20 7472 6961 6e67        t = triang
-0001e780: 756c 6174 6528 7472 692c 2074 7269 5f6f  ulate(tri, tri_o
-0001e790: 7074 290a 2020 2020 2020 2020 7472 6961  pt).        tria
-0001e7a0: 6e67 6c65 7320 3d20 745b 2774 7269 616e  ngles = t['trian
-0001e7b0: 676c 6573 275d 2e74 6f6c 6973 7428 290a  gles'].tolist().
-0001e7c0: 2020 2020 2020 2020 6e70 203d 2074 5b27          np = t['
-0001e7d0: 7665 7274 6963 6573 275d 2e73 6861 7065  vertices'].shape
-0001e7e0: 5b30 5d0a 2020 2020 2020 2020 706f 696e  [0].        poin
-0001e7f0: 7473 203d 205b 766d 642e 4e6f 6465 3244  ts = [vmd.Node2D
-0001e800: 282a 745b 2776 6572 7469 6365 7327 5d5b  (*t['vertices'][
-0001e810: 692c 203a 5d29 2066 6f72 2069 2069 6e20  i, :]) for i in 
-0001e820: 7261 6e67 6528 6e70 295d 0a20 2020 2020  range(np)].     
-0001e830: 2020 2072 6574 7572 6e20 766d 642e 4469     return vmd.Di
-0001e840: 7370 6c61 794d 6573 6832 4428 706f 696e  splayMesh2D(poin
-0001e850: 7473 2c20 7472 6961 6e67 6c65 733d 7472  ts, triangles=tr
-0001e860: 6961 6e67 6c65 732c 2065 6467 6573 3d4e  iangles, edges=N
-0001e870: 6f6e 6529 0a0a 2020 2020 6465 6620 6772  one)..    def gr
-0001e880: 6964 5f74 7269 616e 6775 6c61 7469 6f6e  id_triangulation
-0001e890: 5f70 6f69 6e74 7328 7365 6c66 2c20 6e75  _points(self, nu
-0001e8a0: 6d62 6572 5f70 6f69 6e74 735f 783a 2069  mber_points_x: i
-0001e8b0: 6e74 203d 2032 352c 206e 756d 6265 725f  nt = 25, number_
-0001e8c0: 706f 696e 7473 5f79 3a20 696e 7420 3d20  points_y: int = 
-0001e8d0: 3235 293a 0a20 2020 2020 2020 2022 2222  25):.        """
-0001e8e0: 0a20 2020 2020 2020 2055 7365 2061 206e  .        Use a n
-0001e8f0: 2062 7920 6d20 6772 6964 2074 6f20 7472   by m grid to tr
-0001e900: 6961 6e67 756c 697a 6520 7468 6520 636f  iangulize the co
-0001e910: 6e74 6f75 722e 0a0a 2020 2020 2020 2020  ntour...        
-0001e920: 3a70 6172 616d 206e 756d 6265 725f 706f  :param number_po
-0001e930: 696e 7473 5f78 3a20 4e75 6d62 6572 206f  ints_x: Number o
-0001e940: 6620 6469 7363 7265 7469 7a61 7469 6f6e  f discretization
-0001e950: 2070 6f69 6e74 7320 696e 2078 2064 6972   points in x dir
-0001e960: 6563 7469 6f6e 2e0a 2020 2020 2020 2020  ection..        
-0001e970: 3a74 7970 6520 6e75 6d62 6572 5f70 6f69  :type number_poi
-0001e980: 6e74 735f 783a 2069 6e74 0a20 2020 2020  nts_x: int.     
-0001e990: 2020 203a 7061 7261 6d20 6e75 6d62 6572     :param number
-0001e9a0: 5f70 6f69 6e74 735f 793a 204e 756d 6265  _points_y: Numbe
-0001e9b0: 7220 6f66 2064 6973 6372 6574 697a 6174  r of discretizat
-0001e9c0: 696f 6e20 706f 696e 7473 2069 6e20 7920  ion points in y 
-0001e9d0: 6469 7265 6374 696f 6e2e 0a20 2020 2020  direction..     
-0001e9e0: 2020 203a 7479 7065 206e 756d 6265 725f     :type number_
-0001e9f0: 706f 696e 7473 5f79 3a20 696e 740a 2020  points_y: int.  
-0001ea00: 2020 2020 2020 3a72 6574 7572 6e3a 2044        :return: D
-0001ea10: 6973 6372 6574 697a 6174 696f 6e20 6461  iscretization da
-0001ea20: 7461 2e0a 2020 2020 2020 2020 3a72 7479  ta..        :rty
-0001ea30: 7065 3a20 6c69 7374 0a20 2020 2020 2020  pe: list.       
-0001ea40: 2022 2222 0a20 2020 2020 2020 2078 5f6d   """.        x_m
-0001ea50: 696e 2c20 785f 6d61 782c 2079 5f6d 696e  in, x_max, y_min
-0001ea60: 2c20 795f 6d61 7820 3d20 7365 6c66 2e62  , y_max = self.b
-0001ea70: 6f75 6e64 696e 675f 7265 6374 616e 676c  ounding_rectangl
-0001ea80: 652e 626f 756e 6473 2829 0a0a 2020 2020  e.bounds()..    
-0001ea90: 2020 2020 6e20 3d20 6e75 6d62 6572 5f70      n = number_p
-0001eaa0: 6f69 6e74 735f 7820 2b20 320a 2020 2020  oints_x + 2.    
-0001eab0: 2020 2020 6d20 3d20 6e75 6d62 6572 5f70      m = number_p
-0001eac0: 6f69 6e74 735f 7920 2b20 320a 0a20 2020  oints_y + 2..   
-0001ead0: 2020 2020 2078 203d 206e 7079 2e6c 696e       x = npy.lin
-0001eae0: 7370 6163 6528 785f 6d69 6e2c 2078 5f6d  space(x_min, x_m
-0001eaf0: 6178 2c20 6e75 6d3d 6e29 0a20 2020 2020  ax, num=n).     
-0001eb00: 2020 2079 203d 206e 7079 2e6c 696e 7370     y = npy.linsp
-0001eb10: 6163 6528 795f 6d69 6e2c 2079 5f6d 6178  ace(y_min, y_max
-0001eb20: 2c20 6e75 6d3d 6d29 0a0a 2020 2020 2020  , num=m)..      
-0001eb30: 2020 6772 6964 5f70 6f69 6e74 5f69 6e64    grid_point_ind
-0001eb40: 6578 203d 207b 7d0a 0a20 2020 2020 2020  ex = {}..       
-0001eb50: 2070 6f6c 7967 6f6e 5f70 6f69 6e74 7320   polygon_points 
-0001eb60: 3d20 7b76 6d64 2e4e 6f64 6532 442e 6672  = {vmd.Node2D.fr
-0001eb70: 6f6d 5f70 6f69 6e74 2870 2920 666f 7220  om_point(p) for 
-0001eb80: 7020 696e 2073 656c 662e 706f 696e 7473  p in self.points
-0001eb90: 7d0a 2020 2020 2020 2020 706f 696e 7473  }.        points
-0001eba0: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-0001ebb0: 7220 692c 2078 6920 696e 2065 6e75 6d65  r i, xi in enume
-0001ebc0: 7261 7465 2878 293a 0a20 2020 2020 2020  rate(x):.       
-0001ebd0: 2020 2020 2066 6f72 206a 2c20 7969 2069       for j, yi i
-0001ebe0: 6e20 656e 756d 6572 6174 6528 7929 3a0a  n enumerate(y):.
-0001ebf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec00: 706f 696e 7420 3d20 766d 642e 4e6f 6465  point = vmd.Node
-0001ec10: 3244 2878 692c 2079 6929 0a20 2020 2020  2D(xi, yi).     
-0001ec20: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0001ec30: 6c66 2e70 6f69 6e74 5f62 656c 6f6e 6773  lf.point_belongs
-0001ec40: 2870 6f69 6e74 2c20 696e 636c 7564 655f  (point, include_
-0001ec50: 6564 6765 5f70 6f69 6e74 733d 5472 7565  edge_points=True
-0001ec60: 2920 616e 6420 706f 696e 7420 6e6f 7420  ) and point not 
-0001ec70: 696e 2070 6f6c 7967 6f6e 5f70 6f69 6e74  in polygon_point
-0001ec80: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-0001ec90: 2020 2020 2020 2067 7269 645f 706f 696e         grid_poin
-0001eca0: 745f 696e 6465 785b 2869 2c20 6a29 5d20  t_index[(i, j)] 
-0001ecb0: 3d20 706f 696e 740a 2020 2020 2020 2020  = point.        
-0001ecc0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
-0001ecd0: 7473 2e61 7070 656e 6428 706f 696e 7429  ts.append(point)
-0001ece0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0001ecf0: 2070 6f69 6e74 732c 2078 2c20 792c 2067   points, x, y, g
-0001ed00: 7269 645f 706f 696e 745f 696e 6465 780a  rid_point_index.
-0001ed10: 0a20 2020 2064 6566 2065 6172 5f63 6c69  .    def ear_cli
-0001ed20: 7070 696e 675f 7472 6961 6e67 756c 6174  pping_triangulat
-0001ed30: 696f 6e28 7365 6c66 293a 0a20 2020 2020  ion(self):.     
-0001ed40: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-0001ed50: 6f6d 7075 7465 7320 7468 6520 7472 6961  omputes the tria
-0001ed60: 6e67 756c 6174 696f 6e20 6f66 2074 6865  ngulation of the
-0001ed70: 2070 6f6c 7967 6f6e 2075 7369 6e67 2065   polygon using e
-0001ed80: 6172 2063 6c69 7070 696e 6720 616c 676f  ar clipping algo
-0001ed90: 7269 7468 6d2e 0a20 2020 2020 2020 204e  rithm..        N
-0001eda0: 6f74 653a 2074 7269 616e 676c 6573 2068  ote: triangles h
-0001edb0: 6176 6520 6265 656e 2069 6e76 6572 7465  ave been inverte
-0001edc0: 6420 666f 7220 6120 6265 7474 6572 2072  d for a better r
-0001edd0: 656e 6465 7269 6e67 2069 6e20 6261 6279  endering in baby
-0001ede0: 6c6f 6e6a 730a 2020 2020 2020 2020 2222  lonjs.        ""
-0001edf0: 220a 2020 2020 2020 2020 2320 436f 6e76  ".        # Conv
-0001ee00: 6572 7469 6e67 2074 6f20 6e6f 6465 7320  erting to nodes 
-0001ee10: 666f 7220 7065 7266 6f72 6d61 6e63 650a  for performance.
-0001ee20: 2020 2020 2020 2020 6e6f 6465 7320 3d20          nodes = 
-0001ee30: 5b76 6d64 2e4e 6f64 6532 442e 6672 6f6d  [vmd.Node2D.from
-0001ee40: 5f70 6f69 6e74 2870 2920 666f 7220 7020  _point(p) for p 
-0001ee50: 696e 2073 656c 662e 706f 696e 7473 5d0a  in self.points].
-0001ee60: 0a20 2020 2020 2020 2069 6e69 7469 616c  .        initial
-0001ee70: 5f70 6f69 6e74 5f74 6f5f 696e 6465 7820  _point_to_index 
-0001ee80: 3d20 7b70 3a20 6920 666f 7220 692c 2070  = {p: i for i, p
-0001ee90: 2069 6e20 656e 756d 6572 6174 6528 6e6f   in enumerate(no
-0001eea0: 6465 7329 7d0a 2020 2020 2020 2020 7472  des)}.        tr
-0001eeb0: 6961 6e67 6c65 7320 3d20 5b5d 0a0a 2020  iangles = []..  
-0001eec0: 2020 2020 2020 7265 6d61 696e 696e 675f        remaining_
-0001eed0: 706f 696e 7473 203d 206e 6f64 6573 5b3a  points = nodes[:
-0001eee0: 5d0a 0a20 2020 2020 2020 206e 756d 6265  ]..        numbe
-0001eef0: 725f 7265 6d61 696e 696e 675f 706f 696e  r_remaining_poin
-0001ef00: 7473 203d 206c 656e 2872 656d 6169 6e69  ts = len(remaini
-0001ef10: 6e67 5f70 6f69 6e74 7329 0a20 2020 2020  ng_points).     
-0001ef20: 2020 2077 6869 6c65 206e 756d 6265 725f     while number_
-0001ef30: 7265 6d61 696e 696e 675f 706f 696e 7473  remaining_points
-0001ef40: 203e 2033 3a0a 2020 2020 2020 2020 2020   > 3:.          
-0001ef50: 2020 6375 7272 656e 745f 706f 6c79 676f    current_polygo
-0001ef60: 6e20 3d20 436c 6f73 6564 506f 6c79 676f  n = ClosedPolygo
-0001ef70: 6e32 4428 7265 6d61 696e 696e 675f 706f  n2D(remaining_po
-0001ef80: 696e 7473 290a 0a20 2020 2020 2020 2020  ints)..         
-0001ef90: 2020 2066 6f75 6e64 5f65 6172 203d 2046     found_ear = F
-0001efa0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-0001efb0: 2066 6f72 2070 312c 2070 322c 2070 3320   for p1, p2, p3 
-0001efc0: 696e 207a 6970 2872 656d 6169 6e69 6e67  in zip(remaining
-0001efd0: 5f70 6f69 6e74 732c 0a20 2020 2020 2020  _points,.       
-0001efe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eff0: 2020 2020 2020 2020 2020 2072 656d 6169             remai
-0001f000: 6e69 6e67 5f70 6f69 6e74 735b 313a 5d20  ning_points[1:] 
-0001f010: 2b20 7265 6d61 696e 696e 675f 706f 696e  + remaining_poin
-0001f020: 7473 5b30 3a31 5d2c 0a20 2020 2020 2020  ts[0:1],.       
-0001f030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f040: 2020 2020 2020 2020 2020 2072 656d 6169             remai
-0001f050: 6e69 6e67 5f70 6f69 6e74 735b 323a 5d20  ning_points[2:] 
-0001f060: 2b20 7265 6d61 696e 696e 675f 706f 696e  + remaining_poin
-0001f070: 7473 5b30 3a32 5d29 3a0a 2020 2020 2020  ts[0:2]):.      
-0001f080: 2020 2020 2020 2020 2020 6966 2070 3120            if p1 
-0001f090: 213d 2070 333a 0a20 2020 2020 2020 2020  != p3:.         
-0001f0a0: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-0001f0b0: 7365 676d 656e 7420 3d20 766f 6c6d 646c  segment = volmdl
-0001f0c0: 722e 6564 6765 732e 4c69 6e65 5365 676d  r.edges.LineSegm
-0001f0d0: 656e 7432 4428 7031 2c20 7033 290a 0a20  ent2D(p1, p3).. 
-0001f0e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0001f0f0: 2043 6865 636b 696e 6720 6966 2069 6e74   Checking if int
-0001f100: 6572 7365 6374 696f 6e73 2064 6f65 7320  ersections does 
-0001f110: 6e6f 7420 636f 6e74 6169 6e20 7468 6520  not contain the 
-0001f120: 7665 7274 6963 6573 0a20 2020 2020 2020  vertices.       
-0001f130: 2020 2020 2020 2020 2023 206f 6620 6c69           # of li
-0001f140: 6e65 5f73 6567 6d65 6e74 0a20 2020 2020  ne_segment.     
-0001f150: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
-0001f160: 7365 6374 203d 2046 616c 7365 0a20 2020  sect = False.   
-0001f170: 2020 2020 2020 2020 2020 2020 2069 6e74               int
-0001f180: 6572 7365 6374 696f 6e73 203d 2063 7572  ersections = cur
-0001f190: 7265 6e74 5f70 6f6c 7967 6f6e 2e6c 696e  rent_polygon.lin
-0001f1a0: 6573 6567 6d65 6e74 5f69 6e74 6572 7365  esegment_interse
-0001f1b0: 6374 696f 6e73 286c 696e 655f 7365 676d  ctions(line_segm
-0001f1c0: 656e 7429 0a20 2020 2020 2020 2020 2020  ent).           
-0001f1d0: 2020 2020 2069 6620 696e 7465 7273 6563       if intersec
-0001f1e0: 7469 6f6e 733a 0a20 2020 2020 2020 2020  tions:.         
-0001f1f0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-0001f200: 6e74 6572 2069 6e20 696e 7465 7273 6563  nter in intersec
-0001f210: 7469 6f6e 733a 0a20 2020 2020 2020 2020  tions:.         
-0001f220: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001f230: 6620 696e 7465 725b 305d 206e 6f74 2069  f inter[0] not i
-0001f240: 6e20 5b6c 696e 655f 7365 676d 656e 742e  n [line_segment.
-0001f250: 7374 6172 742c 0a20 2020 2020 2020 2020  start,.         
+0001d1b0: 2020 2020 2020 2020 2020 2068 756c 6c5f             hull_
+0001d1c0: 636f 6e63 6176 655f 6564 6765 732c 2063  concave_edges, c
+0001d1d0: 6f6e 6361 7669 7479 290a 2020 2020 2020  oncavity).      
+0001d1e0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0001d1f0: 2864 6976 6964 6564 5f6c 696e 6529 203e  (divided_line) >
+0001d200: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0001d210: 2020 2020 2020 2020 615f 6c69 6e65 5f77          a_line_w
+0001d220: 6173 5f64 6976 6964 6564 5f69 6e5f 7468  as_divided_in_th
+0001d230: 655f 6974 6572 6174 696f 6e20 3d20 5472  e_iteration = Tr
+0001d240: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
+0001d250: 2020 2020 2020 2075 6e75 7365 645f 706f         unused_po
+0001d260: 696e 7473 2e72 656d 6f76 6528 6469 7669  ints.remove(divi
+0001d270: 6465 645f 6c69 6e65 5b30 5d2e 656e 6429  ded_line[0].end)
+0001d280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d290: 2020 2020 2068 756c 6c5f 636f 6e63 6176       hull_concav
+0001d2a0: 655f 6564 6765 732e 7265 6d6f 7665 286c  e_edges.remove(l
+0001d2b0: 696e 6529 0a20 2020 2020 2020 2020 2020  ine).           
+0001d2c0: 2020 2020 2020 2020 2068 756c 6c5f 636f           hull_co
+0001d2d0: 6e63 6176 655f 6564 6765 732e 6578 7465  ncave_edges.exte
+0001d2e0: 6e64 2864 6976 6964 6564 5f6c 696e 6529  nd(divided_line)
+0001d2f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d300: 2020 2020 2062 7265 616b 0a0a 2020 2020       break..    
+0001d310: 2020 2020 2020 2020 6875 6c6c 5f63 6f6e          hull_con
+0001d320: 6361 7665 5f65 6467 6573 2e73 6f72 7428  cave_edges.sort(
+0001d330: 6b65 793d 6c61 6d62 6461 2078 3a20 782e  key=lambda x: x.
+0001d340: 6c65 6e67 7468 2829 2c20 7265 7665 7273  length(), revers
+0001d350: 653d 5472 7565 290a 0a20 2020 2020 2020  e=True)..       
+0001d360: 2023 206c 696e 6520 203d 2068 756c 6c5f   # line  = hull_
+0001d370: 636f 6e63 6176 655f 6564 6765 735b 305d  concave_edges[0]
+0001d380: 0a20 2020 2020 2020 2023 2070 7269 6e74  .        # print
+0001d390: 2827 6669 7273 7420 6c69 6e65 206c 656e  ('first line len
+0001d3a0: 6774 6820 3a27 2c20 6c69 6e65 2e6c 656e  gth :', line.len
+0001d3b0: 6774 6828 2929 0a20 2020 2020 2020 2023  gth()).        #
+0001d3c0: 206e 6561 7262 795f 706f 696e 7473 203d   nearby_points =
+0001d3d0: 2067 6574 5f6e 6561 7262 795f 706f 696e   get_nearby_poin
+0001d3e0: 7473 286c 696e 652c 2075 6e75 7365 645f  ts(line, unused_
+0001d3f0: 706f 696e 7473 2c20 7363 616c 655f 6661  points, scale_fa
+0001d400: 6374 6f72 290a 2020 2020 2020 2020 2320  ctor).        # 
+0001d410: 7072 696e 7428 2770 6f69 6e74 7320 6e65  print('points ne
+0001d420: 7874 2074 6865 2066 6972 7374 206c 696e  xt the first lin
+0001d430: 6520 696e 2074 6865 2065 6e64 3a20 272c  e in the end: ',
+0001d440: 206e 6561 7262 795f 706f 696e 7473 290a   nearby_points).
+0001d450: 2020 2020 2020 2020 2320 6469 7669 6465          # divide
+0001d460: 645f 6c69 6e65 203d 2067 6574 5f64 6976  d_line = get_div
+0001d470: 6964 6564 5f6c 696e 6528 6c69 6e65 2c20  ided_line(line, 
+0001d480: 6e65 6172 6279 5f70 6f69 6e74 732c 2068  nearby_points, h
+0001d490: 756c 6c5f 636f 6e63 6176 655f 6564 6765  ull_concave_edge
+0001d4a0: 732c 2063 6f6e 6361 7669 7479 290a 2020  s, concavity).  
+0001d4b0: 2020 2020 2020 2320 7072 696e 7428 276c        # print('l
+0001d4c0: 656e 2064 6976 6964 6564 206c 696e 6520  en divided line 
+0001d4d0: 3a27 2c20 6c65 6e28 6469 7669 6465 645f  :', len(divided_
+0001d4e0: 6c69 6e65 2929 0a20 2020 2020 2020 2070  line)).        p
+0001d4f0: 6f6c 7967 6f6e 5f70 6f69 6e74 7320 3d20  olygon_points = 
+0001d500: 5b28 6c69 6e65 2e73 7461 7274 2c20 6c69  [(line.start, li
+0001d510: 6e65 2e65 6e64 2920 666f 7220 6c69 6e65  ne.end) for line
+0001d520: 2069 6e20 6875 6c6c 5f63 6f6e 6361 7665   in hull_concave
+0001d530: 5f65 6467 6573 5d0a 2020 2020 2020 2020  _edges].        
+0001d540: 2320 706f 6c79 676f 6e5f 706f 696e 7473  # polygon_points
+0001d550: 203d 205b 286c 696e 652e 7374 6172 742c   = [(line.start,
+0001d560: 206c 696e 652e 656e 6429 2066 6f72 206c   line.end) for l
+0001d570: 696e 6520 696e 2068 756c 6c5f 636f 6e63  ine in hull_conc
+0001d580: 6176 655f 6564 6765 730a 2020 2020 2020  ave_edges.      
+0001d590: 2020 2320 2020 2020 2020 2020 2020 2020    #             
+0001d5a0: 2020 2020 2020 6966 206c 696e 652e 6c65        if line.le
+0001d5b0: 6e67 7468 2829 2021 3d20 305d 0a0a 2020  ngth() != 0]..  
+0001d5c0: 2020 2020 2020 706f 696e 7473 203d 205b        points = [
+0001d5d0: 706f 6c79 676f 6e5f 706f 696e 7473 5b30  polygon_points[0
+0001d5e0: 5d5b 305d 2c20 706f 6c79 676f 6e5f 706f  ][0], polygon_po
+0001d5f0: 696e 7473 5b30 5d5b 315d 5d0a 2020 2020  ints[0][1]].    
+0001d600: 2020 2020 706f 6c79 676f 6e5f 706f 696e      polygon_poin
+0001d610: 7473 2e72 656d 6f76 6528 2870 6f6c 7967  ts.remove((polyg
+0001d620: 6f6e 5f70 6f69 6e74 735b 305d 5b30 5d2c  on_points[0][0],
+0001d630: 2070 6f6c 7967 6f6e 5f70 6f69 6e74 735b   polygon_points[
+0001d640: 305d 5b31 5d29 290a 2020 2020 2020 2020  0][1])).        
+0001d650: 6669 6e69 7368 6564 203d 2046 616c 7365  finished = False
+0001d660: 0a0a 2020 2020 2020 2020 7768 696c 6520  ..        while 
+0001d670: 6e6f 7420 6669 6e69 7368 6564 3a0a 2020  not finished:.  
+0001d680: 2020 2020 2020 2020 2020 666f 7220 7031            for p1
+0001d690: 2c20 7032 2069 6e20 706f 6c79 676f 6e5f  , p2 in polygon_
+0001d6a0: 706f 696e 7473 3a0a 2020 2020 2020 2020  points:.        
+0001d6b0: 2020 2020 2020 2020 6966 2070 3120 3d3d          if p1 ==
+0001d6c0: 2070 6f69 6e74 735b 2d31 5d20 616e 6420   points[-1] and 
+0001d6d0: 7032 206e 6f74 2069 6e20 706f 696e 7473  p2 not in points
+0001d6e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001d6f0: 2020 2020 2020 706f 696e 7473 2e61 7070        points.app
+0001d700: 656e 6428 7032 290a 2020 2020 2020 2020  end(p2).        
+0001d710: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+0001d720: 6b0a 2020 2020 2020 2020 2020 2020 2020  k.              
+0001d730: 2020 656c 6966 2070 3220 3d3d 2070 6f69    elif p2 == poi
+0001d740: 6e74 735b 2d31 5d20 616e 6420 7031 206e  nts[-1] and p1 n
+0001d750: 6f74 2069 6e20 706f 696e 7473 3a0a 2020  ot in points:.  
+0001d760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d770: 2020 706f 696e 7473 2e61 7070 656e 6428    points.append(
+0001d780: 7031 290a 2020 2020 2020 2020 2020 2020  p1).            
+0001d790: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
+0001d7a0: 2020 2020 2020 2020 2020 706f 6c79 676f            polygo
+0001d7b0: 6e5f 706f 696e 7473 2e72 656d 6f76 6528  n_points.remove(
+0001d7c0: 2870 312c 2070 3229 290a 2020 2020 2020  (p1, p2)).      
+0001d7d0: 2020 2020 2020 6966 206c 656e 2870 6f6c        if len(pol
+0001d7e0: 7967 6f6e 5f70 6f69 6e74 7329 203d 3d20  ygon_points) == 
+0001d7f0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0001d800: 2020 2066 696e 6973 6865 6420 3d20 5472     finished = Tr
+0001d810: 7565 0a0a 2020 2020 2020 2020 7265 7475  ue..        retu
+0001d820: 726e 2063 6c73 2870 6f69 6e74 7329 2020  rn cls(points)  
+0001d830: 2320 2c20 6e65 6172 6279 5f70 6f69 6e74  # , nearby_point
+0001d840: 730a 0a20 2020 2040 636c 6173 736d 6574  s..    @classmet
+0001d850: 686f 640a 2020 2020 6465 6620 636f 6e76  hod.    def conv
+0001d860: 6578 5f68 756c 6c5f 706f 696e 7473 2863  ex_hull_points(c
+0001d870: 6c73 2c20 706f 696e 7473 293a 0a20 2020  ls, points):.   
+0001d880: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001d890: 2055 7365 7320 7468 6520 7363 6970 7920   Uses the scipy 
+0001d8a0: 6d65 7468 6f64 2043 6f6e 7665 7848 756c  method ConvexHul
+0001d8b0: 6c20 746f 2063 616c 6375 6c61 7465 2074  l to calculate t
+0001d8c0: 6865 2063 6f6e 7665 7820 6875 6c6c 2066  he convex hull f
+0001d8d0: 726f 6d0a 2020 2020 2020 2020 6120 636c  rom.        a cl
+0001d8e0: 6f75 6420 6f66 2070 6f69 6e74 730a 2020  oud of points.  
+0001d8f0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0001d900: 2020 2070 6f69 6e74 735f 6875 6c6c 203d     points_hull =
+0001d910: 205b 7074 2e63 6f70 7928 2920 666f 7220   [pt.copy() for 
+0001d920: 7074 2069 6e20 706f 696e 7473 5d0a 0a20  pt in points].. 
+0001d930: 2020 2020 2020 206e 756d 7079 5f70 6f69         numpy_poi
+0001d940: 6e74 7320 3d20 6e70 792e 6172 7261 7928  nts = npy.array(
+0001d950: 5b28 702e 782c 2070 2e79 2920 666f 7220  [(p.x, p.y) for 
+0001d960: 7020 696e 2070 6f69 6e74 735f 6875 6c6c  p in points_hull
+0001d970: 5d29 0a20 2020 2020 2020 2068 756c 6c20  ]).        hull 
+0001d980: 3d20 436f 6e76 6578 4875 6c6c 286e 756d  = ConvexHull(num
+0001d990: 7079 5f70 6f69 6e74 7329 0a20 2020 2020  py_points).     
+0001d9a0: 2020 2070 6f6c 7967 6f6e 5f70 6f69 6e74     polygon_point
+0001d9b0: 7320 3d20 5b5d 0a20 2020 2020 2020 2066  s = [].        f
+0001d9c0: 6f72 2073 696d 706c 6578 2069 6e20 6875  or simplex in hu
+0001d9d0: 6c6c 2e73 696d 706c 6963 6573 3a0a 2020  ll.simplices:.  
+0001d9e0: 2020 2020 2020 2020 2020 706f 6c79 676f            polygo
+0001d9f0: 6e5f 706f 696e 7473 2e61 7070 656e 6428  n_points.append(
+0001da00: 2870 6f69 6e74 735f 6875 6c6c 5b73 696d  (points_hull[sim
+0001da10: 706c 6578 5b30 5d5d 2c20 706f 696e 7473  plex[0]], points
+0001da20: 5f68 756c 6c5b 7369 6d70 6c65 785b 315d  _hull[simplex[1]
+0001da30: 5d29 290a 0a20 2020 2020 2020 2070 6f69  ]))..        poi
+0001da40: 6e74 735f 6875 6c6c 203d 205b 706f 6c79  nts_hull = [poly
+0001da50: 676f 6e5f 706f 696e 7473 5b30 5d5b 305d  gon_points[0][0]
+0001da60: 2c20 706f 6c79 676f 6e5f 706f 696e 7473  , polygon_points
+0001da70: 5b30 5d5b 315d 5d0a 2020 2020 2020 2020  [0][1]].        
+0001da80: 706f 6c79 676f 6e5f 706f 696e 7473 2e72  polygon_points.r
+0001da90: 656d 6f76 6528 2870 6f6c 7967 6f6e 5f70  emove((polygon_p
+0001daa0: 6f69 6e74 735b 305d 5b30 5d2c 2070 6f6c  oints[0][0], pol
+0001dab0: 7967 6f6e 5f70 6f69 6e74 735b 305d 5b31  ygon_points[0][1
+0001dac0: 5d29 290a 2020 2020 2020 2020 6669 6e69  ])).        fini
+0001dad0: 7368 6564 203d 2046 616c 7365 0a0a 2020  shed = False..  
+0001dae0: 2020 2020 2020 7768 696c 6520 6e6f 7420        while not 
+0001daf0: 6669 6e69 7368 6564 3a0a 2020 2020 2020  finished:.      
+0001db00: 2020 2020 2020 666f 7220 7031 2c20 7032        for p1, p2
+0001db10: 2069 6e20 706f 6c79 676f 6e5f 706f 696e   in polygon_poin
+0001db20: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
+0001db30: 2020 2020 6966 2070 3120 3d3d 2070 6f69      if p1 == poi
+0001db40: 6e74 735f 6875 6c6c 5b2d 315d 3a0a 2020  nts_hull[-1]:.  
+0001db50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001db60: 2020 706f 696e 7473 5f68 756c 6c2e 6170    points_hull.ap
+0001db70: 7065 6e64 2870 3229 0a20 2020 2020 2020  pend(p2).       
+0001db80: 2020 2020 2020 2020 2020 2020 2062 7265               bre
+0001db90: 616b 0a20 2020 2020 2020 2020 2020 2020  ak.             
+0001dba0: 2020 2065 6c69 6620 7032 203d 3d20 706f     elif p2 == po
+0001dbb0: 696e 7473 5f68 756c 6c5b 2d31 5d3a 0a20  ints_hull[-1]:. 
+0001dbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dbd0: 2020 2070 6f69 6e74 735f 6875 6c6c 2e61     points_hull.a
+0001dbe0: 7070 656e 6428 7031 290a 2020 2020 2020  ppend(p1).      
+0001dbf0: 2020 2020 2020 2020 2020 2020 2020 6272                br
+0001dc00: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
+0001dc10: 706f 6c79 676f 6e5f 706f 696e 7473 2e72  polygon_points.r
+0001dc20: 656d 6f76 6528 2870 312c 2070 3229 290a  emove((p1, p2)).
+0001dc30: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0001dc40: 656e 2870 6f6c 7967 6f6e 5f70 6f69 6e74  en(polygon_point
+0001dc50: 7329 203d 3d20 303a 0a20 2020 2020 2020  s) == 0:.       
+0001dc60: 2020 2020 2020 2020 2066 696e 6973 6865           finishe
+0001dc70: 6420 3d20 5472 7565 0a0a 2020 2020 2020  d = True..      
+0001dc80: 2020 706f 696e 7473 5f68 756c 6c2e 706f    points_hull.po
+0001dc90: 7028 2d31 290a 0a20 2020 2020 2020 2023  p(-1)..        #
+0001dca0: 2074 6865 2066 6972 7374 2070 6f69 6e74   the first point
+0001dcb0: 2069 7320 7468 6520 6f6e 6520 7769 7468   is the one with
+0001dcc0: 2074 6865 206c 6f77 6573 7420 7820 7661   the lowest x va
+0001dcd0: 6c75 650a 2020 2020 2020 2020 695f 6d69  lue.        i_mi
+0001dce0: 6e20 3d20 300a 2020 2020 2020 2020 6d69  n = 0.        mi
+0001dcf0: 6e5f 7820 3d20 706f 696e 7473 5f68 756c  n_x = points_hul
+0001dd00: 6c5b 305d 2e78 0a20 2020 2020 2020 2066  l[0].x.        f
+0001dd10: 6f72 2069 2c20 706f 696e 7420 696e 2065  or i, point in e
+0001dd20: 6e75 6d65 7261 7465 2870 6f69 6e74 735f  numerate(points_
+0001dd30: 6875 6c6c 293a 0a20 2020 2020 2020 2020  hull):.         
+0001dd40: 2020 2069 6620 706f 696e 742e 7820 3c20     if point.x < 
+0001dd50: 6d69 6e5f 783a 0a20 2020 2020 2020 2020  min_x:.         
+0001dd60: 2020 2020 2020 206d 696e 5f78 203d 2070         min_x = p
+0001dd70: 6f69 6e74 2e78 0a20 2020 2020 2020 2020  oint.x.         
+0001dd80: 2020 2020 2020 2069 5f6d 696e 203d 2069         i_min = i
+0001dd90: 0a0a 2020 2020 2020 2020 706f 696e 7473  ..        points
+0001dda0: 5f68 756c 6c20 3d20 706f 696e 7473 5f68  _hull = points_h
+0001ddb0: 756c 6c5b 695f 6d69 6e3a 5d20 2b20 706f  ull[i_min:] + po
+0001ddc0: 696e 7473 5f68 756c 6c5b 3a69 5f6d 696e  ints_hull[:i_min
+0001ddd0: 5d0a 0a20 2020 2020 2020 2023 2077 6520  ]..        # we 
+0001dde0: 6d61 6b65 2073 7572 6520 7468 6174 2074  make sure that t
+0001ddf0: 6865 2070 6f69 6e74 7320 6172 6520 6f72  he points are or
+0001de00: 6465 7265 6420 696e 2074 6865 2074 7269  dered in the tri
+0001de10: 676f 6e6f 6d65 7472 6963 2064 6972 6563  gonometric direc
+0001de20: 7469 6f6e 0a20 2020 2020 2020 2069 6620  tion.        if 
+0001de30: 706f 696e 7473 5f68 756c 6c5b 305d 2e79  points_hull[0].y
+0001de40: 203c 2070 6f69 6e74 735f 6875 6c6c 5b31   < points_hull[1
+0001de50: 5d2e 793a 0a20 2020 2020 2020 2020 2020  ].y:.           
+0001de60: 2070 6f69 6e74 735f 6875 6c6c 2e72 6576   points_hull.rev
+0001de70: 6572 7365 2829 0a0a 2020 2020 2020 2020  erse()..        
+0001de80: 7265 7475 726e 2063 6c73 2870 6f69 6e74  return cls(point
+0001de90: 735f 6875 6c6c 290a 0a20 2020 2064 6566  s_hull)..    def
+0001dea0: 2074 6f5f 3364 2873 656c 662c 2070 6c61   to_3d(self, pla
+0001deb0: 6e65 5f6f 7269 6769 6e2c 2078 2c20 7929  ne_origin, x, y)
+0001dec0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0001ded0: 2020 2020 2020 5472 616e 7366 6f72 6d73        Transforms
+0001dee0: 2061 2043 6c6f 7365 6450 6f6c 7967 6f6e   a ClosedPolygon
+0001def0: 3244 2069 6e74 6f20 616e 2043 6c6f 7365  2D into an Close
+0001df00: 6450 6f6c 7967 6f6e 3344 2c20 6769 7665  dPolygon3D, give
+0001df10: 6e20 6120 706c 616e 6520 6f72 6967 696e  n a plane origin
+0001df20: 2061 6e64 2061 6e20 7520 616e 6420 7620   and an u and v 
+0001df30: 706c 616e 6520 7665 6374 6f72 2e0a 0a20  plane vector... 
+0001df40: 2020 2020 2020 203a 7061 7261 6d20 706c         :param pl
+0001df50: 616e 655f 6f72 6967 696e 3a20 706c 616e  ane_origin: plan
+0001df60: 6520 6f72 6967 696e 2e0a 2020 2020 2020  e origin..      
+0001df70: 2020 3a70 6172 616d 2078 3a20 706c 616e    :param x: plan
+0001df80: 6520 7520 7665 6374 6f72 2e0a 2020 2020  e u vector..    
+0001df90: 2020 2020 3a70 6172 616d 2079 3a20 706c      :param y: pl
+0001dfa0: 616e 6520 7620 7665 6374 6f72 2e0a 2020  ane v vector..  
+0001dfb0: 2020 2020 2020 3a72 6574 7572 6e3a 2043        :return: C
+0001dfc0: 6c6f 7365 6450 6f6c 7967 6f6e 3344 2e0a  losedPolygon3D..
+0001dfd0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001dfe0: 2020 2020 706f 696e 7473 3364 203d 205b      points3d = [
+0001dff0: 706f 696e 742e 746f 5f33 6428 706c 616e  point.to_3d(plan
+0001e000: 655f 6f72 6967 696e 2c20 782c 2079 2920  e_origin, x, y) 
+0001e010: 666f 7220 706f 696e 7420 696e 2073 656c  for point in sel
+0001e020: 662e 706f 696e 7473 5d0a 2020 2020 2020  f.points].      
+0001e030: 2020 7265 7475 726e 2043 6c6f 7365 6450    return ClosedP
+0001e040: 6f6c 7967 6f6e 3344 2870 6f69 6e74 7333  olygon3D(points3
+0001e050: 6429 0a0a 2020 2020 6465 6620 706c 6f74  d)..    def plot
+0001e060: 2873 656c 662c 2061 783d 4e6f 6e65 2c20  (self, ax=None, 
+0001e070: 636f 6c6f 723d 276b 272c 2061 6c70 6861  color='k', alpha
+0001e080: 3d31 2c0a 2020 2020 2020 2020 2020 2020  =1,.            
+0001e090: 2070 6c6f 745f 706f 696e 7473 3d46 616c   plot_points=Fal
+0001e0a0: 7365 2c20 706f 696e 745f 6e75 6d62 6572  se, point_number
+0001e0b0: 696e 673d 4661 6c73 652c 2061 7272 6f77  ing=False, arrow
+0001e0c0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+0001e0d0: 2020 2020 2066 696c 6c3d 4661 6c73 652c       fill=False,
+0001e0e0: 2066 696c 6c5f 636f 6c6f 723d 2777 272c   fill_color='w',
+0001e0f0: 2065 7175 616c 5f61 7370 6563 743d 5472   equal_aspect=Tr
+0001e100: 7565 293a 0a20 2020 2020 2020 2069 6620  ue):.        if 
+0001e110: 6178 2069 7320 4e6f 6e65 3a0a 2020 2020  ax is None:.    
+0001e120: 2020 2020 2020 2020 5f2c 2061 7820 3d20          _, ax = 
+0001e130: 706c 742e 7375 6270 6c6f 7473 2829 0a20  plt.subplots(). 
+0001e140: 2020 2020 2020 2020 2020 2061 782e 7365             ax.se
+0001e150: 745f 6173 7065 6374 2827 6571 7561 6c27  t_aspect('equal'
+0001e160: 290a 0a20 2020 2020 2020 2069 6620 6669  )..        if fi
+0001e170: 6c6c 3a0a 2020 2020 2020 2020 2020 2020  ll:.            
+0001e180: 6178 2e66 696c 6c28 5b70 5b30 5d20 666f  ax.fill([p[0] fo
+0001e190: 7220 7020 696e 2073 656c 662e 706f 696e  r p in self.poin
+0001e1a0: 7473 5d2c 205b 705b 315d 2066 6f72 2070  ts], [p[1] for p
+0001e1b0: 2069 6e20 7365 6c66 2e70 6f69 6e74 735d   in self.points]
+0001e1c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001e1d0: 2020 2020 2020 6661 6365 636f 6c6f 723d        facecolor=
+0001e1e0: 6669 6c6c 5f63 6f6c 6f72 290a 2020 2020  fill_color).    
+0001e1f0: 2020 2020 666f 7220 6c69 6e65 5f73 6567      for line_seg
+0001e200: 6d65 6e74 2069 6e20 7365 6c66 2e6c 696e  ment in self.lin
+0001e210: 655f 7365 676d 656e 7473 3a0a 2020 2020  e_segments:.    
+0001e220: 2020 2020 2020 2020 6c69 6e65 5f73 6567          line_seg
+0001e230: 6d65 6e74 2e70 6c6f 7428 6178 3d61 782c  ment.plot(ax=ax,
+0001e240: 2063 6f6c 6f72 3d63 6f6c 6f72 2c20 616c   color=color, al
+0001e250: 7068 613d 616c 7068 612c 2061 7272 6f77  pha=alpha, arrow
+0001e260: 3d61 7272 6f77 290a 0a20 2020 2020 2020  =arrow)..       
+0001e270: 2069 6620 706c 6f74 5f70 6f69 6e74 7320   if plot_points 
+0001e280: 6f72 2070 6f69 6e74 5f6e 756d 6265 7269  or point_numberi
+0001e290: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+0001e2a0: 666f 7220 706f 696e 7420 696e 2073 656c  for point in sel
+0001e2b0: 662e 706f 696e 7473 3a0a 2020 2020 2020  f.points:.      
+0001e2c0: 2020 2020 2020 2020 2020 706f 696e 742e            point.
+0001e2d0: 706c 6f74 2861 783d 6178 2c20 636f 6c6f  plot(ax=ax, colo
+0001e2e0: 723d 636f 6c6f 722c 2061 6c70 6861 3d61  r=color, alpha=a
+0001e2f0: 6c70 6861 290a 0a20 2020 2020 2020 2069  lpha)..        i
+0001e300: 6620 706f 696e 745f 6e75 6d62 6572 696e  f point_numberin
+0001e310: 673a 0a20 2020 2020 2020 2020 2020 2066  g:.            f
+0001e320: 6f72 2069 702c 2070 6f69 6e74 2069 6e20  or ip, point in 
+0001e330: 656e 756d 6572 6174 6528 7365 6c66 2e70  enumerate(self.p
+0001e340: 6f69 6e74 7329 3a0a 2020 2020 2020 2020  oints):.        
+0001e350: 2020 2020 2020 2020 6178 2e74 6578 7428          ax.text(
+0001e360: 2a70 6f69 6e74 2c20 2770 6f69 6e74 207b  *point, 'point {
+0001e370: 7d27 2e66 6f72 6d61 7428 6970 202b 2031  }'.format(ip + 1
+0001e380: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0001e390: 2020 2020 2020 2020 2020 2068 613d 2763             ha='c
+0001e3a0: 656e 7465 7227 2c20 7661 3d27 746f 7027  enter', va='top'
+0001e3b0: 290a 0a20 2020 2020 2020 2069 6620 6571  )..        if eq
+0001e3c0: 7561 6c5f 6173 7065 6374 3a0a 2020 2020  ual_aspect:.    
+0001e3d0: 2020 2020 2020 2020 6178 2e73 6574 5f61          ax.set_a
+0001e3e0: 7370 6563 7428 2765 7175 616c 2729 0a20  spect('equal'). 
+0001e3f0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001e400: 2020 2020 2020 2020 2061 782e 7365 745f           ax.set_
+0001e410: 6173 7065 6374 2827 6175 746f 2729 0a0a  aspect('auto')..
+0001e420: 2020 2020 2020 2020 6178 2e6d 6172 6769          ax.margi
+0001e430: 6e73 2830 2e31 290a 2020 2020 2020 2020  ns(0.1).        
+0001e440: 706c 742e 7368 6f77 2829 0a0a 2020 2020  plt.show()..    
+0001e450: 2020 2020 7265 7475 726e 2061 780a 0a20      return ax.. 
+0001e460: 2020 2064 6566 2074 7269 616e 6775 6c61     def triangula
+0001e470: 7469 6f6e 2873 656c 662c 2074 7269 5f6f  tion(self, tri_o
+0001e480: 7074 3a20 7374 7220 3d20 2770 6427 293a  pt: str = 'pd'):
+0001e490: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001e4a0: 2020 2020 2050 6572 666f 726d 2074 7269       Perform tri
+0001e4b0: 616e 6775 6c61 7469 6f6e 206f 6e20 7468  angulation on th
+0001e4c0: 6520 706f 6c79 676f 6e2e 0a0a 2020 2020  e polygon...    
+0001e4d0: 2020 2020 546f 2064 6574 6169 6c20 646f      To detail do
+0001e4e0: 6375 6d65 6e74 6174 696f 6e2c 2070 6c65  cumentation, ple
+0001e4f0: 6173 6520 7265 6665 7220 746f 2068 7474  ase refer to htt
+0001e500: 7073 3a2f 2f72 7566 6174 2e62 652f 7472  ps://rufat.be/tr
+0001e510: 6961 6e67 6c65 2f41 5049 2e68 746d 6c0a  iangle/API.html.
+0001e520: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001e530: 7472 695f 6f70 743a 2028 4f70 7469 6f6e  tri_opt: (Option
+0001e540: 616c 2920 5472 6961 6e67 756c 6174 696f  al) Triangulatio
+0001e550: 6e20 7072 6566 6572 656e 6365 732e 0a20  n preferences.. 
+0001e560: 2020 2020 2020 203a 7479 7065 2074 7269         :type tri
+0001e570: 5f6f 7074 3a20 7374 720a 2020 2020 2020  _opt: str.      
+0001e580: 2020 3a72 6574 7572 6e3a 2041 2032 4420    :return: A 2D 
+0001e590: 6d65 7368 2e0a 2020 2020 2020 2020 3a72  mesh..        :r
+0001e5a0: 7479 7065 3a20 3a63 6c61 7373 3a60 766d  type: :class:`vm
+0001e5b0: 642e 4469 7370 6c61 794d 6573 6832 4460  d.DisplayMesh2D`
+0001e5c0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001e5d0: 2020 2020 2023 2043 6f6e 7665 7274 696e       # Convertin
+0001e5e0: 6720 706f 696e 7473 2074 6f20 6e6f 6465  g points to node
+0001e5f0: 7320 666f 7220 7065 7266 6f72 6d61 6e63  s for performanc
+0001e600: 650a 2020 2020 2020 2020 6e6f 6465 7320  e.        nodes 
+0001e610: 3d20 5b76 6d64 2e4e 6f64 6532 442e 6672  = [vmd.Node2D.fr
+0001e620: 6f6d 5f70 6f69 6e74 2870 2920 666f 7220  om_point(p) for 
+0001e630: 7020 696e 2073 656c 662e 706f 696e 7473  p in self.points
+0001e640: 5d0a 2020 2020 2020 2020 7665 7274 6963  ].        vertic
+0001e650: 6573 203d 205b 2870 2e78 2c20 702e 7929  es = [(p.x, p.y)
+0001e660: 2066 6f72 2070 2069 6e20 6e6f 6465 735d   for p in nodes]
+0001e670: 0a20 2020 2020 2020 206e 203d 206c 656e  .        n = len
+0001e680: 286e 6f64 6573 290a 2020 2020 2020 2020  (nodes).        
+0001e690: 7365 676d 656e 7473 203d 205b 2869 2c20  segments = [(i, 
+0001e6a0: 6920 2b20 3129 2066 6f72 2069 2069 6e20  i + 1) for i in 
+0001e6b0: 7261 6e67 6528 6e20 2d20 3129 5d0a 2020  range(n - 1)].  
+0001e6c0: 2020 2020 2020 7365 676d 656e 7473 2e61        segments.a
+0001e6d0: 7070 656e 6428 286e 202d 2031 2c20 3029  ppend((n - 1, 0)
+0001e6e0: 290a 0a20 2020 2020 2020 2074 7269 203d  )..        tri =
+0001e6f0: 207b 2776 6572 7469 6365 7327 3a20 6e70   {'vertices': np
+0001e700: 792e 6172 7261 7928 7665 7274 6963 6573  y.array(vertices
+0001e710: 292e 7265 7368 6170 6528 282d 312c 2032  ).reshape((-1, 2
+0001e720: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
+0001e730: 2020 2027 7365 676d 656e 7473 273a 206e     'segments': n
+0001e740: 7079 2e61 7272 6179 2873 6567 6d65 6e74  py.array(segment
+0001e750: 7329 2e72 6573 6861 7065 2828 2d31 2c20  s).reshape((-1, 
+0001e760: 3229 292c 0a20 2020 2020 2020 2020 2020  2)),.           
+0001e770: 2020 2020 7d0a 2020 2020 2020 2020 7420      }.        t 
+0001e780: 3d20 7472 6961 6e67 756c 6174 6528 7472  = triangulate(tr
+0001e790: 692c 2074 7269 5f6f 7074 290a 2020 2020  i, tri_opt).    
+0001e7a0: 2020 2020 7472 6961 6e67 6c65 7320 3d20      triangles = 
+0001e7b0: 745b 2774 7269 616e 676c 6573 275d 2e74  t['triangles'].t
+0001e7c0: 6f6c 6973 7428 290a 2020 2020 2020 2020  olist().        
+0001e7d0: 6e70 203d 2074 5b27 7665 7274 6963 6573  np = t['vertices
+0001e7e0: 275d 2e73 6861 7065 5b30 5d0a 2020 2020  '].shape[0].    
+0001e7f0: 2020 2020 706f 696e 7473 203d 205b 766d      points = [vm
+0001e800: 642e 4e6f 6465 3244 282a 745b 2776 6572  d.Node2D(*t['ver
+0001e810: 7469 6365 7327 5d5b 692c 203a 5d29 2066  tices'][i, :]) f
+0001e820: 6f72 2069 2069 6e20 7261 6e67 6528 6e70  or i in range(np
+0001e830: 295d 0a20 2020 2020 2020 2072 6574 7572  )].        retur
+0001e840: 6e20 766d 642e 4469 7370 6c61 794d 6573  n vmd.DisplayMes
+0001e850: 6832 4428 706f 696e 7473 2c20 7472 6961  h2D(points, tria
+0001e860: 6e67 6c65 733d 7472 6961 6e67 6c65 732c  ngles=triangles,
+0001e870: 2065 6467 6573 3d4e 6f6e 6529 0a0a 2020   edges=None)..  
+0001e880: 2020 6465 6620 6772 6964 5f74 7269 616e    def grid_trian
+0001e890: 6775 6c61 7469 6f6e 5f70 6f69 6e74 7328  gulation_points(
+0001e8a0: 7365 6c66 2c20 6e75 6d62 6572 5f70 6f69  self, number_poi
+0001e8b0: 6e74 735f 783a 2069 6e74 203d 2032 352c  nts_x: int = 25,
+0001e8c0: 206e 756d 6265 725f 706f 696e 7473 5f79   number_points_y
+0001e8d0: 3a20 696e 7420 3d20 3235 293a 0a20 2020  : int = 25):.   
+0001e8e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001e8f0: 2055 7365 2061 206e 2062 7920 6d20 6772   Use a n by m gr
+0001e900: 6964 2074 6f20 7472 6961 6e67 756c 697a  id to trianguliz
+0001e910: 6520 7468 6520 636f 6e74 6f75 722e 0a0a  e the contour...
+0001e920: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+0001e930: 756d 6265 725f 706f 696e 7473 5f78 3a20  umber_points_x: 
+0001e940: 4e75 6d62 6572 206f 6620 6469 7363 7265  Number of discre
+0001e950: 7469 7a61 7469 6f6e 2070 6f69 6e74 7320  tization points 
+0001e960: 696e 2078 2064 6972 6563 7469 6f6e 2e0a  in x direction..
+0001e970: 2020 2020 2020 2020 3a74 7970 6520 6e75          :type nu
+0001e980: 6d62 6572 5f70 6f69 6e74 735f 783a 2069  mber_points_x: i
+0001e990: 6e74 0a20 2020 2020 2020 203a 7061 7261  nt.        :para
+0001e9a0: 6d20 6e75 6d62 6572 5f70 6f69 6e74 735f  m number_points_
+0001e9b0: 793a 204e 756d 6265 7220 6f66 2064 6973  y: Number of dis
+0001e9c0: 6372 6574 697a 6174 696f 6e20 706f 696e  cretization poin
+0001e9d0: 7473 2069 6e20 7920 6469 7265 6374 696f  ts in y directio
+0001e9e0: 6e2e 0a20 2020 2020 2020 203a 7479 7065  n..        :type
+0001e9f0: 206e 756d 6265 725f 706f 696e 7473 5f79   number_points_y
+0001ea00: 3a20 696e 740a 2020 2020 2020 2020 3a72  : int.        :r
+0001ea10: 6574 7572 6e3a 2044 6973 6372 6574 697a  eturn: Discretiz
+0001ea20: 6174 696f 6e20 6461 7461 2e0a 2020 2020  ation data..    
+0001ea30: 2020 2020 3a72 7479 7065 3a20 6c69 7374      :rtype: list
+0001ea40: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001ea50: 2020 2020 2078 5f6d 696e 2c20 785f 6d61       x_min, x_ma
+0001ea60: 782c 2079 5f6d 696e 2c20 795f 6d61 7820  x, y_min, y_max 
+0001ea70: 3d20 7365 6c66 2e62 6f75 6e64 696e 675f  = self.bounding_
+0001ea80: 7265 6374 616e 676c 652e 626f 756e 6473  rectangle.bounds
+0001ea90: 2829 0a0a 2020 2020 2020 2020 6e20 3d20  ()..        n = 
+0001eaa0: 6e75 6d62 6572 5f70 6f69 6e74 735f 7820  number_points_x 
+0001eab0: 2b20 320a 2020 2020 2020 2020 6d20 3d20  + 2.        m = 
+0001eac0: 6e75 6d62 6572 5f70 6f69 6e74 735f 7920  number_points_y 
+0001ead0: 2b20 320a 0a20 2020 2020 2020 2078 203d  + 2..        x =
+0001eae0: 206e 7079 2e6c 696e 7370 6163 6528 785f   npy.linspace(x_
+0001eaf0: 6d69 6e2c 2078 5f6d 6178 2c20 6e75 6d3d  min, x_max, num=
+0001eb00: 6e29 0a20 2020 2020 2020 2079 203d 206e  n).        y = n
+0001eb10: 7079 2e6c 696e 7370 6163 6528 795f 6d69  py.linspace(y_mi
+0001eb20: 6e2c 2079 5f6d 6178 2c20 6e75 6d3d 6d29  n, y_max, num=m)
+0001eb30: 0a0a 2020 2020 2020 2020 6772 6964 5f70  ..        grid_p
+0001eb40: 6f69 6e74 5f69 6e64 6578 203d 207b 7d0a  oint_index = {}.
+0001eb50: 0a20 2020 2020 2020 2070 6f6c 7967 6f6e  .        polygon
+0001eb60: 5f70 6f69 6e74 7320 3d20 7b76 6d64 2e4e  _points = {vmd.N
+0001eb70: 6f64 6532 442e 6672 6f6d 5f70 6f69 6e74  ode2D.from_point
+0001eb80: 2870 2920 666f 7220 7020 696e 2073 656c  (p) for p in sel
+0001eb90: 662e 706f 696e 7473 7d0a 2020 2020 2020  f.points}.      
+0001eba0: 2020 706f 696e 7473 203d 205b 5d0a 2020    points = [].  
+0001ebb0: 2020 2020 2020 666f 7220 692c 2078 6920        for i, xi 
+0001ebc0: 696e 2065 6e75 6d65 7261 7465 2878 293a  in enumerate(x):
+0001ebd0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0001ebe0: 206a 2c20 7969 2069 6e20 656e 756d 6572   j, yi in enumer
+0001ebf0: 6174 6528 7929 3a0a 2020 2020 2020 2020  ate(y):.        
+0001ec00: 2020 2020 2020 2020 706f 696e 7420 3d20          point = 
+0001ec10: 766d 642e 4e6f 6465 3244 2878 692c 2079  vmd.Node2D(xi, y
+0001ec20: 6929 0a20 2020 2020 2020 2020 2020 2020  i).             
+0001ec30: 2020 2069 6620 7365 6c66 2e70 6f69 6e74     if self.point
+0001ec40: 5f62 656c 6f6e 6773 2870 6f69 6e74 2c20  _belongs(point, 
+0001ec50: 696e 636c 7564 655f 6564 6765 5f70 6f69  include_edge_poi
+0001ec60: 6e74 733d 5472 7565 2920 616e 6420 706f  nts=True) and po
+0001ec70: 696e 7420 6e6f 7420 696e 2070 6f6c 7967  int not in polyg
+0001ec80: 6f6e 5f70 6f69 6e74 733a 0a20 2020 2020  on_points:.     
+0001ec90: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+0001eca0: 7269 645f 706f 696e 745f 696e 6465 785b  rid_point_index[
+0001ecb0: 2869 2c20 6a29 5d20 3d20 706f 696e 740a  (i, j)] = point.
+0001ecc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ecd0: 2020 2020 706f 696e 7473 2e61 7070 656e      points.appen
+0001ece0: 6428 706f 696e 7429 0a0a 2020 2020 2020  d(point)..      
+0001ecf0: 2020 7265 7475 726e 2070 6f69 6e74 732c    return points,
+0001ed00: 2078 2c20 792c 2067 7269 645f 706f 696e   x, y, grid_poin
+0001ed10: 745f 696e 6465 780a 0a20 2020 2064 6566  t_index..    def
+0001ed20: 2065 6172 5f63 6c69 7070 696e 675f 7472   ear_clipping_tr
+0001ed30: 6961 6e67 756c 6174 696f 6e28 7365 6c66  iangulation(self
+0001ed40: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0001ed50: 2020 2020 2020 2043 6f6d 7075 7465 7320         Computes 
+0001ed60: 7468 6520 7472 6961 6e67 756c 6174 696f  the triangulatio
+0001ed70: 6e20 6f66 2074 6865 2070 6f6c 7967 6f6e  n of the polygon
+0001ed80: 2075 7369 6e67 2065 6172 2063 6c69 7070   using ear clipp
+0001ed90: 696e 6720 616c 676f 7269 7468 6d2e 0a20  ing algorithm.. 
+0001eda0: 2020 2020 2020 204e 6f74 653a 2074 7269         Note: tri
+0001edb0: 616e 676c 6573 2068 6176 6520 6265 656e  angles have been
+0001edc0: 2069 6e76 6572 7465 6420 666f 7220 6120   inverted for a 
+0001edd0: 6265 7474 6572 2072 656e 6465 7269 6e67  better rendering
+0001ede0: 2069 6e20 6261 6279 6c6f 6e6a 730a 2020   in babylonjs.  
+0001edf0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001ee00: 2020 2320 436f 6e76 6572 7469 6e67 2074    # Converting t
+0001ee10: 6f20 6e6f 6465 7320 666f 7220 7065 7266  o nodes for perf
+0001ee20: 6f72 6d61 6e63 650a 2020 2020 2020 2020  ormance.        
+0001ee30: 6e6f 6465 7320 3d20 5b76 6d64 2e4e 6f64  nodes = [vmd.Nod
+0001ee40: 6532 442e 6672 6f6d 5f70 6f69 6e74 2870  e2D.from_point(p
+0001ee50: 2920 666f 7220 7020 696e 2073 656c 662e  ) for p in self.
+0001ee60: 706f 696e 7473 5d0a 0a20 2020 2020 2020  points]..       
+0001ee70: 2069 6e69 7469 616c 5f70 6f69 6e74 5f74   initial_point_t
+0001ee80: 6f5f 696e 6465 7820 3d20 7b70 3a20 6920  o_index = {p: i 
+0001ee90: 666f 7220 692c 2070 2069 6e20 656e 756d  for i, p in enum
+0001eea0: 6572 6174 6528 6e6f 6465 7329 7d0a 2020  erate(nodes)}.  
+0001eeb0: 2020 2020 2020 7472 6961 6e67 6c65 7320        triangles 
+0001eec0: 3d20 5b5d 0a0a 2020 2020 2020 2020 7265  = []..        re
+0001eed0: 6d61 696e 696e 675f 706f 696e 7473 203d  maining_points =
+0001eee0: 206e 6f64 6573 5b3a 5d0a 0a20 2020 2020   nodes[:]..     
+0001eef0: 2020 206e 756d 6265 725f 7265 6d61 696e     number_remain
+0001ef00: 696e 675f 706f 696e 7473 203d 206c 656e  ing_points = len
+0001ef10: 2872 656d 6169 6e69 6e67 5f70 6f69 6e74  (remaining_point
+0001ef20: 7329 0a20 2020 2020 2020 2077 6869 6c65  s).        while
+0001ef30: 206e 756d 6265 725f 7265 6d61 696e 696e   number_remainin
+0001ef40: 675f 706f 696e 7473 203e 2033 3a0a 2020  g_points > 3:.  
+0001ef50: 2020 2020 2020 2020 2020 6375 7272 656e            curren
+0001ef60: 745f 706f 6c79 676f 6e20 3d20 436c 6f73  t_polygon = Clos
+0001ef70: 6564 506f 6c79 676f 6e32 4428 7265 6d61  edPolygon2D(rema
+0001ef80: 696e 696e 675f 706f 696e 7473 290a 0a20  ining_points).. 
+0001ef90: 2020 2020 2020 2020 2020 2066 6f75 6e64             found
+0001efa0: 5f65 6172 203d 2046 616c 7365 0a20 2020  _ear = False.   
+0001efb0: 2020 2020 2020 2020 2066 6f72 2070 312c           for p1,
+0001efc0: 2070 322c 2070 3320 696e 207a 6970 2872   p2, p3 in zip(r
+0001efd0: 656d 6169 6e69 6e67 5f70 6f69 6e74 732c  emaining_points,
+0001efe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001eff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f000: 2020 2072 656d 6169 6e69 6e67 5f70 6f69     remaining_poi
+0001f010: 6e74 735b 313a 5d20 2b20 7265 6d61 696e  nts[1:] + remain
+0001f020: 696e 675f 706f 696e 7473 5b30 3a31 5d2c  ing_points[0:1],
+0001f030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f050: 2020 2072 656d 6169 6e69 6e67 5f70 6f69     remaining_poi
+0001f060: 6e74 735b 323a 5d20 2b20 7265 6d61 696e  nts[2:] + remain
+0001f070: 696e 675f 706f 696e 7473 5b30 3a32 5d29  ing_points[0:2])
+0001f080: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001f090: 2020 6966 2070 3120 213d 2070 333a 0a20    if p1 != p3:. 
+0001f0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f0b0: 2020 206c 696e 655f 7365 676d 656e 7420     line_segment 
+0001f0c0: 3d20 766f 6c6d 646c 722e 6564 6765 732e  = volmdlr.edges.
+0001f0d0: 4c69 6e65 5365 676d 656e 7432 4428 7031  LineSegment2D(p1
+0001f0e0: 2c20 7033 290a 0a20 2020 2020 2020 2020  , p3)..         
+0001f0f0: 2020 2020 2020 2023 2043 6865 636b 696e         # Checkin
+0001f100: 6720 6966 2069 6e74 6572 7365 6374 696f  g if intersectio
+0001f110: 6e73 2064 6f65 7320 6e6f 7420 636f 6e74  ns does not cont
+0001f120: 6169 6e20 7468 6520 7665 7274 6963 6573  ain the vertices
+0001f130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f140: 2023 206f 6620 6c69 6e65 5f73 6567 6d65   # of line_segme
+0001f150: 6e74 0a20 2020 2020 2020 2020 2020 2020  nt.             
+0001f160: 2020 2069 6e74 6572 7365 6374 203d 2046     intersect = F
+0001f170: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+0001f180: 2020 2020 2069 6e74 6572 7365 6374 696f       intersectio
+0001f190: 6e73 203d 2063 7572 7265 6e74 5f70 6f6c  ns = current_pol
+0001f1a0: 7967 6f6e 2e6c 696e 6573 6567 6d65 6e74  ygon.linesegment
+0001f1b0: 5f69 6e74 6572 7365 6374 696f 6e73 286c  _intersections(l
+0001f1c0: 696e 655f 7365 676d 656e 7429 0a20 2020  ine_segment).   
+0001f1d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001f1e0: 696e 7465 7273 6563 7469 6f6e 733a 0a20  intersections:. 
+0001f1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f200: 2020 2066 6f72 2069 6e74 6572 2069 6e20     for inter in 
+0001f210: 696e 7465 7273 6563 7469 6f6e 733a 0a20  intersections:. 
+0001f220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f230: 2020 2020 2020 2069 6620 696e 7465 725b         if inter[
+0001f240: 305d 206e 6f74 2069 6e20 5b6c 696e 655f  0] not in [line_
+0001f250: 7365 676d 656e 742e 7374 6172 742c 0a20  segment.start,. 
 0001f260: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001f270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f280: 2020 206c 696e 655f 7365 676d 656e 742e     line_segment.
-0001f290: 656e 645d 3a0a 2020 2020 2020 2020 2020  end]:.          
+0001f280: 2020 2020 2020 2020 2020 206c 696e 655f             line_
+0001f290: 7365 676d 656e 742e 656e 645d 3a0a 2020  segment.end]:.  
 0001f2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f2b0: 2020 696e 7465 7273 6563 7420 3d20 5472    intersect = Tr
-0001f2c0: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-0001f2d0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0001f2e0: 7265 616b 0a0a 2020 2020 2020 2020 2020  reak..          
-0001f2f0: 2020 2020 2020 6966 206e 6f74 2069 6e74        if not int
-0001f300: 6572 7365 6374 3a0a 2020 2020 2020 2020  ersect:.        
-0001f310: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-0001f320: 7572 7265 6e74 5f70 6f6c 7967 6f6e 2e70  urrent_polygon.p
-0001f330: 6f69 6e74 5f62 656c 6f6e 6773 286c 696e  oint_belongs(lin
-0001f340: 655f 7365 676d 656e 742e 6d69 6464 6c65  e_segment.middle
-0001f350: 5f70 6f69 6e74 2829 293a 0a0a 2020 2020  _point()):..    
-0001f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f370: 2020 2020 7472 6961 6e67 6c65 732e 6170      triangles.ap
-0001f380: 7065 6e64 2828 696e 6974 6961 6c5f 706f  pend((initial_po
-0001f390: 696e 745f 746f 5f69 6e64 6578 5b70 315d  int_to_index[p1]
-0001f3a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001f2b0: 2020 2020 2020 2020 2020 696e 7465 7273            inters
+0001f2c0: 6563 7420 3d20 5472 7565 0a20 2020 2020  ect = True.     
+0001f2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f2e0: 2020 2020 2020 2062 7265 616b 0a0a 2020         break..  
+0001f2f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001f300: 206e 6f74 2069 6e74 6572 7365 6374 3a0a   not intersect:.
+0001f310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f320: 2020 2020 6966 2063 7572 7265 6e74 5f70      if current_p
+0001f330: 6f6c 7967 6f6e 2e70 6f69 6e74 5f62 656c  olygon.point_bel
+0001f340: 6f6e 6773 286c 696e 655f 7365 676d 656e  ongs(line_segmen
+0001f350: 742e 6d69 6464 6c65 5f70 6f69 6e74 2829  t.middle_point()
+0001f360: 293a 0a0a 2020 2020 2020 2020 2020 2020  ):..            
+0001f370: 2020 2020 2020 2020 2020 2020 7472 6961              tria
+0001f380: 6e67 6c65 732e 6170 7065 6e64 2828 696e  ngles.append((in
+0001f390: 6974 6961 6c5f 706f 696e 745f 746f 5f69  itial_point_to_i
+0001f3a0: 6e64 6578 5b70 315d 2c0a 2020 2020 2020  ndex[p1],.      
 0001f3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f3c0: 2020 2020 2020 2020 2020 2020 696e 6974              init
-0001f3d0: 6961 6c5f 706f 696e 745f 746f 5f69 6e64  ial_point_to_ind
-0001f3e0: 6578 5b70 335d 2c0a 2020 2020 2020 2020  ex[p3],.        
+0001f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f3d0: 2020 2020 696e 6974 6961 6c5f 706f 696e      initial_poin
+0001f3e0: 745f 746f 5f69 6e64 6578 5b70 335d 2c0a  t_to_index[p3],.
 0001f3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001f400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f410: 2020 696e 6974 6961 6c5f 706f 696e 745f    initial_point_
-0001f420: 746f 5f69 6e64 6578 5b70 325d 2929 0a20  to_index[p2])). 
-0001f430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f440: 2020 2020 2020 2072 656d 6169 6e69 6e67         remaining
-0001f450: 5f70 6f69 6e74 732e 7265 6d6f 7665 2870  _points.remove(p
-0001f460: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
-0001f470: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-0001f480: 725f 7265 6d61 696e 696e 675f 706f 696e  r_remaining_poin
-0001f490: 7473 202d 3d20 310a 2020 2020 2020 2020  ts -= 1.        
+0001f410: 2020 2020 2020 2020 2020 696e 6974 6961            initia
+0001f420: 6c5f 706f 696e 745f 746f 5f69 6e64 6578  l_point_to_index
+0001f430: 5b70 325d 2929 0a20 2020 2020 2020 2020  [p2])).         
+0001f440: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001f450: 656d 6169 6e69 6e67 5f70 6f69 6e74 732e  emaining_points.
+0001f460: 7265 6d6f 7665 2870 3229 0a20 2020 2020  remove(p2).     
+0001f470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f480: 2020 206e 756d 6265 725f 7265 6d61 696e     number_remain
+0001f490: 696e 675f 706f 696e 7473 202d 3d20 310a  ing_points -= 1.
 0001f4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f4b0: 666f 756e 645f 6561 7220 3d20 5472 7565  found_ear = True
-0001f4c0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001f4d0: 2020 2020 2020 2020 2020 2320 526f 6c6c            # Roll
-0001f4e0: 696e 6720 7468 6520 7265 6d61 696e 696e  ing the remainin
-0001f4f0: 6720 6c69 7374 0a20 2020 2020 2020 2020  g list.         
-0001f500: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001f510: 6620 6e75 6d62 6572 5f72 656d 6169 6e69  f number_remaini
-0001f520: 6e67 5f70 6f69 6e74 7320 3e20 343a 0a20  ng_points > 4:. 
-0001f530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f540: 2020 2020 2020 2020 2020 2064 6571 203d             deq =
-0001f550: 2064 6571 7565 2872 656d 6169 6e69 6e67   deque(remaining
-0001f560: 5f70 6f69 6e74 7329 0a20 2020 2020 2020  _points).       
-0001f570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f580: 2020 2020 2023 2072 616e 646f 6d2e 7261       # random.ra
-0001f590: 6e64 696e 7428 312c 206e 756d 6265 725f  ndint(1, number_
-0001f5a0: 7265 6d61 696e 696e 675f 706f 696e 7473  remaining_points
-0001f5b0: 2d31 2929 0a20 2020 2020 2020 2020 2020  -1)).           
+0001f4b0: 2020 2020 2020 2020 666f 756e 645f 6561          found_ea
+0001f4c0: 7220 3d20 5472 7565 0a0a 2020 2020 2020  r = True..      
+0001f4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f4e0: 2020 2320 526f 6c6c 696e 6720 7468 6520    # Rolling the 
+0001f4f0: 7265 6d61 696e 696e 6720 6c69 7374 0a20  remaining list. 
+0001f500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f510: 2020 2020 2020 2069 6620 6e75 6d62 6572         if number
+0001f520: 5f72 656d 6169 6e69 6e67 5f70 6f69 6e74  _remaining_point
+0001f530: 7320 3e20 343a 0a20 2020 2020 2020 2020  s > 4:.         
+0001f540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f550: 2020 2064 6571 203d 2064 6571 7565 2872     deq = deque(r
+0001f560: 656d 6169 6e69 6e67 5f70 6f69 6e74 7329  emaining_points)
+0001f570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f580: 2020 2020 2020 2020 2020 2020 2023 2072               # r
+0001f590: 616e 646f 6d2e 7261 6e64 696e 7428 312c  andom.randint(1,
+0001f5a0: 206e 756d 6265 725f 7265 6d61 696e 696e   number_remainin
+0001f5b0: 675f 706f 696e 7473 2d31 2929 0a20 2020  g_points-1)).   
 0001f5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f5d0: 2064 6571 2e72 6f74 6174 6528 696e 7428   deq.rotate(int(
-0001f5e0: 302e 3320 2a20 6e75 6d62 6572 5f72 656d  0.3 * number_rem
-0001f5f0: 6169 6e69 6e67 5f70 6f69 6e74 7329 290a  aining_points)).
-0001f600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f610: 2020 2020 2020 2020 2020 2020 7265 6d61              rema
-0001f620: 696e 696e 675f 706f 696e 7473 203d 206c  ining_points = l
-0001f630: 6973 7428 6465 7129 0a0a 2020 2020 2020  ist(deq)..      
-0001f640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f650: 2020 6272 6561 6b0a 0a20 2020 2020 2020    break..       
-0001f660: 2020 2020 2023 2053 6561 7263 6869 6e67       # Searching
-0001f670: 2066 6f72 2061 2066 6c61 7420 6561 720a   for a flat ear.
-0001f680: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0001f690: 6f74 2066 6f75 6e64 5f65 6172 3a0a 2020  ot found_ear:.  
-0001f6a0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001f6b0: 6d61 696e 696e 675f 706f 6c79 676f 6e20  maining_polygon 
-0001f6c0: 3d20 436c 6f73 6564 506f 6c79 676f 6e32  = ClosedPolygon2
-0001f6d0: 4428 7265 6d61 696e 696e 675f 706f 696e  D(remaining_poin
-0001f6e0: 7473 290a 2020 2020 2020 2020 2020 2020  ts).            
-0001f6f0: 2020 2020 6966 2072 656d 6169 6e69 6e67      if remaining
-0001f700: 5f70 6f6c 7967 6f6e 2e61 7265 6128 2920  _polygon.area() 
-0001f710: 3e20 302e 3a0a 0a20 2020 2020 2020 2020  > 0.:..         
-0001f720: 2020 2020 2020 2020 2020 2066 6f75 6e64             found
-0001f730: 5f66 6c61 745f 6561 7220 3d20 4661 6c73  _flat_ear = Fals
-0001f740: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0001f750: 2020 2020 2020 666f 7220 7031 2c20 7032        for p1, p2
-0001f760: 2c20 7033 2069 6e20 7a69 7028 7265 6d61  , p3 in zip(rema
-0001f770: 696e 696e 675f 706f 696e 7473 2c0a 2020  ining_points,.  
-0001f780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f5d0: 2020 2020 2020 2020 2064 6571 2e72 6f74           deq.rot
+0001f5e0: 6174 6528 696e 7428 302e 3320 2a20 6e75  ate(int(0.3 * nu
+0001f5f0: 6d62 6572 5f72 656d 6169 6e69 6e67 5f70  mber_remaining_p
+0001f600: 6f69 6e74 7329 290a 2020 2020 2020 2020  oints)).        
+0001f610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f620: 2020 2020 7265 6d61 696e 696e 675f 706f      remaining_po
+0001f630: 696e 7473 203d 206c 6973 7428 6465 7129  ints = list(deq)
+0001f640: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001f650: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
+0001f660: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
+0001f670: 6561 7263 6869 6e67 2066 6f72 2061 2066  earching for a f
+0001f680: 6c61 7420 6561 720a 2020 2020 2020 2020  lat ear.        
+0001f690: 2020 2020 6966 206e 6f74 2066 6f75 6e64      if not found
+0001f6a0: 5f65 6172 3a0a 2020 2020 2020 2020 2020  _ear:.          
+0001f6b0: 2020 2020 2020 7265 6d61 696e 696e 675f        remaining_
+0001f6c0: 706f 6c79 676f 6e20 3d20 436c 6f73 6564  polygon = Closed
+0001f6d0: 506f 6c79 676f 6e32 4428 7265 6d61 696e  Polygon2D(remain
+0001f6e0: 696e 675f 706f 696e 7473 290a 2020 2020  ing_points).    
+0001f6f0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+0001f700: 656d 6169 6e69 6e67 5f70 6f6c 7967 6f6e  emaining_polygon
+0001f710: 2e61 7265 6128 2920 3e20 302e 3a0a 0a20  .area() > 0.:.. 
+0001f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f730: 2020 2066 6f75 6e64 5f66 6c61 745f 6561     found_flat_ea
+0001f740: 7220 3d20 4661 6c73 650a 2020 2020 2020  r = False.      
+0001f750: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0001f760: 7220 7031 2c20 7032 2c20 7033 2069 6e20  r p1, p2, p3 in 
+0001f770: 7a69 7028 7265 6d61 696e 696e 675f 706f  zip(remaining_po
+0001f780: 696e 7473 2c0a 2020 2020 2020 2020 2020  ints,.          
 0001f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f7a0: 2020 2020 2020 2020 7265 6d61 696e 696e          remainin
-0001f7b0: 675f 706f 696e 7473 5b31 3a5d 202b 2072  g_points[1:] + r
-0001f7c0: 656d 6169 6e69 6e67 5f70 6f69 6e74 735b  emaining_points[
-0001f7d0: 303a 315d 2c0a 2020 2020 2020 2020 2020  0:1],.          
+0001f7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f7b0: 7265 6d61 696e 696e 675f 706f 696e 7473  remaining_points
+0001f7c0: 5b31 3a5d 202b 2072 656d 6169 6e69 6e67  [1:] + remaining
+0001f7d0: 5f70 6f69 6e74 735b 303a 315d 2c0a 2020  _points[0:1],.  
 0001f7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001f7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f800: 7265 6d61 696e 696e 675f 706f 696e 7473  remaining_points
-0001f810: 5b32 3a5d 202b 2072 656d 6169 6e69 6e67  [2:] + remaining
-0001f820: 5f70 6f69 6e74 735b 303a 325d 293a 0a20  _points[0:2]):. 
-0001f830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f840: 2020 2020 2020 2074 7269 616e 676c 6520         triangle 
-0001f850: 3d20 5472 6961 6e67 6c65 3244 2870 312c  = Triangle2D(p1,
-0001f860: 2070 322c 2070 3329 0a20 2020 2020 2020   p2, p3).       
-0001f870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f880: 2069 6620 7472 6961 6e67 6c65 2e61 7265   if triangle.are
-0001f890: 6128 2920 3d3d 2030 3a0a 2020 2020 2020  a() == 0:.      
-0001f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f8b0: 2020 2020 2020 7265 6d61 696e 696e 675f        remaining_
-0001f8c0: 706f 696e 7473 2e72 656d 6f76 6528 7032  points.remove(p2
-0001f8d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001f8e0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0001f8f0: 756e 645f 666c 6174 5f65 6172 203d 2054  und_flat_ear = T
-0001f900: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+0001f800: 2020 2020 2020 2020 7265 6d61 696e 696e          remainin
+0001f810: 675f 706f 696e 7473 5b32 3a5d 202b 2072  g_points[2:] + r
+0001f820: 656d 6169 6e69 6e67 5f70 6f69 6e74 735b  emaining_points[
+0001f830: 303a 325d 293a 0a20 2020 2020 2020 2020  0:2]):.         
+0001f840: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0001f850: 7269 616e 676c 6520 3d20 5472 6961 6e67  riangle = Triang
+0001f860: 6c65 3244 2870 312c 2070 322c 2070 3329  le2D(p1, p2, p3)
+0001f870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f880: 2020 2020 2020 2020 2069 6620 7472 6961           if tria
+0001f890: 6e67 6c65 2e61 7265 6128 2920 3d3d 2030  ngle.area() == 0
+0001f8a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001f8b0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001f8c0: 6d61 696e 696e 675f 706f 696e 7473 2e72  maining_points.r
+0001f8d0: 656d 6f76 6528 7032 290a 2020 2020 2020  emove(p2).      
+0001f8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f8f0: 2020 2020 2020 666f 756e 645f 666c 6174        found_flat
+0001f900: 5f65 6172 203d 2054 7275 650a 2020 2020  _ear = True.    
 0001f910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f920: 6272 6561 6b0a 0a20 2020 2020 2020 2020  break..         
-0001f930: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-0001f940: 7420 666f 756e 645f 666c 6174 5f65 6172  t found_flat_ear
-0001f950: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001f960: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0001f970: 2757 6172 6e69 6e67 203a 2054 6865 7265  'Warning : There
-0001f980: 2061 7265 206e 6f20 6561 7220 696e 2074   are no ear in t
-0001f990: 6865 2070 6f6c 7967 6f6e 2c20 6974 2073  he polygon, it s
-0001f9a0: 6565 6d73 206d 616c 666f 726d 6564 3a20  eems malformed: 
-0001f9b0: 736b 6970 7069 6e67 2074 7269 616e 6775  skipping triangu
-0001f9c0: 6c61 7469 6f6e 2729 0a20 2020 2020 2020  lation').       
-0001f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f9e0: 2072 6574 7572 6e20 766d 642e 4469 7370   return vmd.Disp
-0001f9f0: 6c61 794d 6573 6832 4428 6e6f 6465 732c  layMesh2D(nodes,
-0001fa00: 2074 7269 616e 676c 6573 290a 2020 2020   triangles).    
-0001fa10: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001fa20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001fa30: 2020 2020 2020 7265 7475 726e 2076 6d64        return vmd
-0001fa40: 2e44 6973 706c 6179 4d65 7368 3244 286e  .DisplayMesh2D(n
-0001fa50: 6f64 6573 2c20 7472 6961 6e67 6c65 7329  odes, triangles)
-0001fa60: 0a0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
-0001fa70: 2872 656d 6169 6e69 6e67 5f70 6f69 6e74  (remaining_point
-0001fa80: 7329 203d 3d20 333a 0a20 2020 2020 2020  s) == 3:.       
-0001fa90: 2020 2020 2070 312c 2070 322c 2070 3320       p1, p2, p3 
-0001faa0: 3d20 7265 6d61 696e 696e 675f 706f 696e  = remaining_poin
-0001fab0: 7473 0a20 2020 2020 2020 2020 2020 2074  ts.            t
-0001fac0: 7269 616e 676c 6573 2e61 7070 656e 6428  riangles.append(
-0001fad0: 2869 6e69 7469 616c 5f70 6f69 6e74 5f74  (initial_point_t
-0001fae0: 6f5f 696e 6465 785b 7031 5d2c 0a20 2020  o_index[p1],.   
-0001faf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fb00: 2020 2020 2020 2020 2020 2069 6e69 7469             initi
-0001fb10: 616c 5f70 6f69 6e74 5f74 6f5f 696e 6465  al_point_to_inde
-0001fb20: 785b 7033 5d2c 0a20 2020 2020 2020 2020  x[p3],.         
+0001f920: 2020 2020 2020 2020 6272 6561 6b0a 0a20          break.. 
+0001f930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f940: 2020 2069 6620 6e6f 7420 666f 756e 645f     if not found_
+0001f950: 666c 6174 5f65 6172 3a0a 2020 2020 2020  flat_ear:.      
+0001f960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f970: 2020 7072 696e 7428 2757 6172 6e69 6e67    print('Warning
+0001f980: 203a 2054 6865 7265 2061 7265 206e 6f20   : There are no 
+0001f990: 6561 7220 696e 2074 6865 2070 6f6c 7967  ear in the polyg
+0001f9a0: 6f6e 2c20 6974 2073 6565 6d73 206d 616c  on, it seems mal
+0001f9b0: 666f 726d 6564 3a20 736b 6970 7069 6e67  formed: skipping
+0001f9c0: 2074 7269 616e 6775 6c61 7469 6f6e 2729   triangulation')
+0001f9d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f9e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001f9f0: 766d 642e 4469 7370 6c61 794d 6573 6832  vmd.DisplayMesh2
+0001fa00: 4428 6e6f 6465 732c 2074 7269 616e 676c  D(nodes, triangl
+0001fa10: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+0001fa20: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001fa30: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001fa40: 7475 726e 2076 6d64 2e44 6973 706c 6179  turn vmd.Display
+0001fa50: 4d65 7368 3244 286e 6f64 6573 2c20 7472  Mesh2D(nodes, tr
+0001fa60: 6961 6e67 6c65 7329 0a0a 2020 2020 2020  iangles)..      
+0001fa70: 2020 6966 206c 656e 2872 656d 6169 6e69    if len(remaini
+0001fa80: 6e67 5f70 6f69 6e74 7329 203d 3d20 333a  ng_points) == 3:
+0001fa90: 0a20 2020 2020 2020 2020 2020 2070 312c  .            p1,
+0001faa0: 2070 322c 2070 3320 3d20 7265 6d61 696e   p2, p3 = remain
+0001fab0: 696e 675f 706f 696e 7473 0a20 2020 2020  ing_points.     
+0001fac0: 2020 2020 2020 2074 7269 616e 676c 6573         triangles
+0001fad0: 2e61 7070 656e 6428 2869 6e69 7469 616c  .append((initial
+0001fae0: 5f70 6f69 6e74 5f74 6f5f 696e 6465 785b  _point_to_index[
+0001faf0: 7031 5d2c 0a20 2020 2020 2020 2020 2020  p1],.           
+0001fb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb10: 2020 2069 6e69 7469 616c 5f70 6f69 6e74     initial_point
+0001fb20: 5f74 6f5f 696e 6465 785b 7033 5d2c 0a20  _to_index[p3],. 
 0001fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fb40: 2020 2020 2069 6e69 7469 616c 5f70 6f69       initial_poi
-0001fb50: 6e74 5f74 6f5f 696e 6465 785b 7032 5d29  nt_to_index[p2])
-0001fb60: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-0001fb70: 6e20 766d 642e 4469 7370 6c61 794d 6573  n vmd.DisplayMes
-0001fb80: 6832 4428 6e6f 6465 732c 2074 7269 616e  h2D(nodes, trian
-0001fb90: 676c 6573 290a 0a20 2020 2064 6566 2073  gles)..    def s
-0001fba0: 696d 706c 6966 7928 7365 6c66 2c20 6d69  implify(self, mi
-0001fbb0: 6e5f 6469 7374 616e 6365 3a20 666c 6f61  n_distance: floa
-0001fbc0: 7420 3d20 302e 3031 2c20 6d61 785f 6469  t = 0.01, max_di
-0001fbd0: 7374 616e 6365 3a20 666c 6f61 7420 3d20  stance: float = 
-0001fbe0: 302e 3035 293a 0a20 2020 2020 2020 2072  0.05):.        r
-0001fbf0: 6574 7572 6e20 436c 6f73 6564 506f 6c79  eturn ClosedPoly
-0001fc00: 676f 6e32 4428 7365 6c66 2e73 696d 706c  gon2D(self.simpl
-0001fc10: 6966 795f 706f 6c79 676f 6e28 6d69 6e5f  ify_polygon(min_
-0001fc20: 6469 7374 616e 6365 3d6d 696e 5f64 6973  distance=min_dis
-0001fc30: 7461 6e63 652c 0a20 2020 2020 2020 2020  tance,.         
+0001fb40: 2020 2020 2020 2020 2020 2020 2069 6e69               ini
+0001fb50: 7469 616c 5f70 6f69 6e74 5f74 6f5f 696e  tial_point_to_in
+0001fb60: 6465 785b 7032 5d29 290a 0a20 2020 2020  dex[p2]))..     
+0001fb70: 2020 2072 6574 7572 6e20 766d 642e 4469     return vmd.Di
+0001fb80: 7370 6c61 794d 6573 6832 4428 6e6f 6465  splayMesh2D(node
+0001fb90: 732c 2074 7269 616e 676c 6573 290a 0a20  s, triangles).. 
+0001fba0: 2020 2064 6566 2073 696d 706c 6966 7928     def simplify(
+0001fbb0: 7365 6c66 2c20 6d69 6e5f 6469 7374 616e  self, min_distan
+0001fbc0: 6365 3a20 666c 6f61 7420 3d20 302e 3031  ce: float = 0.01
+0001fbd0: 2c20 6d61 785f 6469 7374 616e 6365 3a20  , max_distance: 
+0001fbe0: 666c 6f61 7420 3d20 302e 3035 293a 0a20  float = 0.05):. 
+0001fbf0: 2020 2020 2020 2072 6574 7572 6e20 436c         return Cl
+0001fc00: 6f73 6564 506f 6c79 676f 6e32 4428 7365  osedPolygon2D(se
+0001fc10: 6c66 2e73 696d 706c 6966 795f 706f 6c79  lf.simplify_poly
+0001fc20: 676f 6e28 6d69 6e5f 6469 7374 616e 6365  gon(min_distance
+0001fc30: 3d6d 696e 5f64 6973 7461 6e63 652c 0a20  =min_distance,. 
 0001fc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc60: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
-0001fc70: 6469 7374 616e 6365 3d6d 6178 5f64 6973  distance=max_dis
-0001fc80: 7461 6e63 6529 2e70 6f69 6e74 7329 0a0a  tance).points)..
-0001fc90: 2020 2020 6465 6620 6c69 6e65 5f69 6e74      def line_int
-0001fca0: 6572 7365 6374 696e 675f 636c 6f73 696e  ersecting_closin
-0001fcb0: 675f 706f 696e 7428 7365 6c66 2c20 6372  g_point(self, cr
-0001fcc0: 6f73 7369 6e67 5f70 6f69 6e74 293a 0a20  ossing_point):. 
-0001fcd0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001fce0: 2020 2046 696e 6473 2063 6c6f 7369 6e67     Finds closing
-0001fcf0: 2070 6f69 6e74 2066 6f72 2074 6865 2073   point for the s
-0001fd00: 6577 696e 6720 6d65 7468 6f64 2075 7369  ewing method usi
-0001fd10: 6e67 2069 6e74 6572 7365 6374 696f 6e20  ng intersection 
-0001fd20: 6f66 206c 696e 6573 0a20 2020 2020 2020  of lines.       
-0001fd30: 2064 7261 776e 2066 726f 6d20 7468 6520   drawn from the 
-0001fd40: 6261 7279 6365 6e74 6572 2e0a 0a20 2020  barycenter...   
-0001fd50: 2020 2020 2072 6574 7572 6e73 2074 6865       returns the
-0001fd60: 2063 6c6f 7369 6e67 2070 6f69 6e74 0a20   closing point. 
-0001fd70: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001fd80: 2020 2076 6563 5f64 6972 203d 2063 726f     vec_dir = cro
-0001fd90: 7373 696e 675f 706f 696e 742e 636f 7079  ssing_point.copy
-0001fda0: 2829 0a20 2020 2020 2020 2076 6563 5f64  ().        vec_d
-0001fdb0: 6972 2e6e 6f72 6d61 6c69 7a65 2829 0a0a  ir.normalize()..
-0001fdc0: 2020 2020 2020 2020 6c69 6e65 203d 2076          line = v
-0001fdd0: 6f6c 6d64 6c72 2e65 6467 6573 2e4c 696e  olmdlr.edges.Lin
-0001fde0: 6553 6567 6d65 6e74 3244 2876 6f6c 6d64  eSegment2D(volmd
-0001fdf0: 6c72 2e4f 3244 2c0a 2020 2020 2020 2020  lr.O2D,.        
+0001fc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc70: 2020 2020 6d61 785f 6469 7374 616e 6365      max_distance
+0001fc80: 3d6d 6178 5f64 6973 7461 6e63 6529 2e70  =max_distance).p
+0001fc90: 6f69 6e74 7329 0a0a 2020 2020 6465 6620  oints)..    def 
+0001fca0: 6c69 6e65 5f69 6e74 6572 7365 6374 696e  line_intersectin
+0001fcb0: 675f 636c 6f73 696e 675f 706f 696e 7428  g_closing_point(
+0001fcc0: 7365 6c66 2c20 6372 6f73 7369 6e67 5f70  self, crossing_p
+0001fcd0: 6f69 6e74 293a 0a20 2020 2020 2020 2022  oint):.        "
+0001fce0: 2222 0a20 2020 2020 2020 2046 696e 6473  "".        Finds
+0001fcf0: 2063 6c6f 7369 6e67 2070 6f69 6e74 2066   closing point f
+0001fd00: 6f72 2074 6865 2073 6577 696e 6720 6d65  or the sewing me
+0001fd10: 7468 6f64 2075 7369 6e67 2069 6e74 6572  thod using inter
+0001fd20: 7365 6374 696f 6e20 6f66 206c 696e 6573  section of lines
+0001fd30: 0a20 2020 2020 2020 2064 7261 776e 2066  .        drawn f
+0001fd40: 726f 6d20 7468 6520 6261 7279 6365 6e74  rom the barycent
+0001fd50: 6572 2e0a 0a20 2020 2020 2020 2072 6574  er...        ret
+0001fd60: 7572 6e73 2074 6865 2063 6c6f 7369 6e67  urns the closing
+0001fd70: 2070 6f69 6e74 0a20 2020 2020 2020 2022   point.        "
+0001fd80: 2222 0a20 2020 2020 2020 2076 6563 5f64  "".        vec_d
+0001fd90: 6972 203d 2063 726f 7373 696e 675f 706f  ir = crossing_po
+0001fda0: 696e 742e 636f 7079 2829 0a20 2020 2020  int.copy().     
+0001fdb0: 2020 2076 6563 5f64 6972 2e6e 6f72 6d61     vec_dir.norma
+0001fdc0: 6c69 7a65 2829 0a0a 2020 2020 2020 2020  lize()..        
+0001fdd0: 6c69 6e65 203d 2076 6f6c 6d64 6c72 2e65  line = volmdlr.e
+0001fde0: 6467 6573 2e4c 696e 6553 6567 6d65 6e74  dges.LineSegment
+0001fdf0: 3244 2876 6f6c 6d64 6c72 2e4f 3244 2c0a  2D(volmdlr.O2D,.
 0001fe00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001fe10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fe20: 2020 2063 726f 7373 696e 675f 706f 696e     crossing_poin
-0001fe30: 7420 2b20 7665 635f 6469 7220 2a20 3529  t + vec_dir * 5)
-0001fe40: 0a20 2020 2020 2020 2023 206c 696e 652e  .        # line.
-0001fe50: 706c 6f74 2861 783d 6178 3264 2c20 636f  plot(ax=ax2d, co
-0001fe60: 6c6f 723d 2762 2729 0a0a 2020 2020 2020  lor='b')..      
-0001fe70: 2020 706f 696e 745f 696e 7465 7273 6563    point_intersec
-0001fe80: 7469 6f6e 7320 3d20 7b7d 0a20 2020 2020  tions = {}.     
-0001fe90: 2020 2066 6f72 206c 696e 655f 7365 676d     for line_segm
-0001fea0: 656e 7420 696e 2073 656c 662e 6c69 6e65  ent in self.line
-0001feb0: 5f73 6567 6d65 6e74 733a 0a20 2020 2020  _segments:.     
-0001fec0: 2020 2020 2020 2070 6f69 6e74 5f69 6e74         point_int
-0001fed0: 6572 7365 6374 696f 6e20 3d20 6c69 6e65  ersection = line
-0001fee0: 5f73 6567 6d65 6e74 2e6c 696e 6573 6567  _segment.lineseg
-0001fef0: 6d65 6e74 5f69 6e74 6572 7365 6374 696f  ment_intersectio
-0001ff00: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-0001ff10: 2020 2020 6c69 6e65 290a 2020 2020 2020      line).      
-0001ff20: 2020 2020 2020 6966 2070 6f69 6e74 5f69        if point_i
-0001ff30: 6e74 6572 7365 6374 696f 6e3a 0a20 2020  ntersection:.   
-0001ff40: 2020 2020 2020 2020 2020 2020 2070 6f69               poi
-0001ff50: 6e74 5f69 6e74 6572 7365 6374 696f 6e73  nt_intersections
-0001ff60: 5b6c 696e 655f 7365 676d 656e 745d 203d  [line_segment] =
-0001ff70: 2070 6f69 6e74 5f69 6e74 6572 7365 6374   point_intersect
-0001ff80: 696f 6e5b 0a20 2020 2020 2020 2020 2020  ion[.           
-0001ff90: 2020 2020 2020 2020 2030 5d0a 2020 2020           0].    
-0001ffa0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001ffb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001ffc0: 206c 696e 652e 706f 696e 745f 6265 6c6f   line.point_belo
-0001ffd0: 6e67 7328 6c69 6e65 5f73 6567 6d65 6e74  ngs(line_segment
-0001ffe0: 2e73 7461 7274 293a 0a20 2020 2020 2020  .start):.       
-0001fff0: 2020 2020 2020 2020 2020 2020 2070 6f69               poi
-00020000: 6e74 5f69 6e74 6572 7365 6374 696f 6e73  nt_intersections
-00020010: 5b6c 696e 655f 7365 676d 656e 745d 203d  [line_segment] =
-00020020: 206c 696e 655f 7365 676d 656e 742e 7374   line_segment.st
-00020030: 6172 740a 2020 2020 2020 2020 2020 2020  art.            
-00020040: 2020 2020 6966 206c 696e 652e 706f 696e      if line.poin
-00020050: 745f 6265 6c6f 6e67 7328 6c69 6e65 5f73  t_belongs(line_s
-00020060: 6567 6d65 6e74 2e65 6e64 293a 0a20 2020  egment.end):.   
-00020070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020080: 2070 6f69 6e74 5f69 6e74 6572 7365 6374   point_intersect
-00020090: 696f 6e73 5b6c 696e 655f 7365 676d 656e  ions[line_segmen
-000200a0: 745d 203d 206c 696e 655f 7365 676d 656e  t] = line_segmen
-000200b0: 742e 656e 640a 2020 2020 2020 2020 706f  t.end.        po
-000200c0: 696e 745f 6469 7374 616e 6365 203d 206c  int_distance = l
-000200d0: 6973 7428 706f 696e 745f 696e 7465 7273  ist(point_inters
-000200e0: 6563 7469 6f6e 732e 7661 6c75 6573 2829  ections.values()
-000200f0: 295b 0a20 2020 2020 2020 2020 2020 2030  )[.            0
-00020100: 5d2e 706f 696e 745f 6469 7374 616e 6365  ].point_distance
-00020110: 2863 726f 7373 696e 675f 706f 696e 7429  (crossing_point)
-00020120: 0a20 2020 2020 2020 2070 6f69 6e74 5f69  .        point_i
-00020130: 6e74 6572 7365 6374 696f 6e20 3d20 6c69  ntersection = li
-00020140: 7374 2870 6f69 6e74 5f69 6e74 6572 7365  st(point_interse
-00020150: 6374 696f 6e73 2e76 616c 7565 7328 2929  ctions.values())
-00020160: 5b30 5d0a 2020 2020 2020 2020 6c69 6e65  [0].        line
-00020170: 5f73 6567 6d65 6e74 203d 206c 6973 7428  _segment = list(
-00020180: 706f 696e 745f 696e 7465 7273 6563 7469  point_intersecti
-00020190: 6f6e 732e 6b65 7973 2829 295b 305d 0a20  ons.keys())[0]. 
-000201a0: 2020 2020 2020 2066 6f72 206c 696e 652c         for line,
-000201b0: 2070 6f69 6e74 2069 6e20 6c69 7374 2870   point in list(p
-000201c0: 6f69 6e74 5f69 6e74 6572 7365 6374 696f  oint_intersectio
-000201d0: 6e73 2e69 7465 6d73 2829 295b 313a 5d3a  ns.items())[1:]:
-000201e0: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
-000201f0: 7420 3d20 6372 6f73 7369 6e67 5f70 6f69  t = crossing_poi
-00020200: 6e74 2e70 6f69 6e74 5f64 6973 7461 6e63  nt.point_distanc
-00020210: 6528 706f 696e 7429 0a20 2020 2020 2020  e(point).       
-00020220: 2020 2020 2069 6620 6469 7374 203c 2070       if dist < p
-00020230: 6f69 6e74 5f64 6973 7461 6e63 653a 0a20  oint_distance:. 
-00020240: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00020250: 6f69 6e74 5f64 6973 7461 6e63 6520 3d20  oint_distance = 
-00020260: 6469 7374 0a20 2020 2020 2020 2020 2020  dist.           
-00020270: 2020 2020 2070 6f69 6e74 5f69 6e74 6572       point_inter
-00020280: 7365 6374 696f 6e20 3d20 706f 696e 740a  section = point.
-00020290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000202a0: 6c69 6e65 5f73 6567 6d65 6e74 203d 206c  line_segment = l
-000202b0: 696e 650a 0a20 2020 2020 2020 2023 2070  ine..        # p
-000202c0: 6f69 6e74 5f69 6e74 6572 7365 6374 696f  oint_intersectio
-000202d0: 6e2e 706c 6f74 2861 783d 6178 3264 290a  n.plot(ax=ax2d).
-000202e0: 0a20 2020 2020 2020 2069 6620 706f 696e  .        if poin
-000202f0: 745f 696e 7465 7273 6563 7469 6f6e 2e70  t_intersection.p
-00020300: 6f69 6e74 5f64 6973 7461 6e63 6528 0a20  oint_distance(. 
-00020310: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00020320: 696e 655f 7365 676d 656e 742e 7374 6172  ine_segment.star
-00020330: 7429 203c 2070 6f69 6e74 5f69 6e74 6572  t) < point_inter
-00020340: 7365 6374 696f 6e2e 706f 696e 745f 6469  section.point_di
-00020350: 7374 616e 6365 280a 2020 2020 2020 2020  stance(.        
+0001fe20: 2020 2020 2020 2020 2020 2063 726f 7373             cross
+0001fe30: 696e 675f 706f 696e 7420 2b20 7665 635f  ing_point + vec_
+0001fe40: 6469 7220 2a20 3529 0a20 2020 2020 2020  dir * 5).       
+0001fe50: 2023 206c 696e 652e 706c 6f74 2861 783d   # line.plot(ax=
+0001fe60: 6178 3264 2c20 636f 6c6f 723d 2762 2729  ax2d, color='b')
+0001fe70: 0a0a 2020 2020 2020 2020 706f 696e 745f  ..        point_
+0001fe80: 696e 7465 7273 6563 7469 6f6e 7320 3d20  intersections = 
+0001fe90: 7b7d 0a20 2020 2020 2020 2066 6f72 206c  {}.        for l
+0001fea0: 696e 655f 7365 676d 656e 7420 696e 2073  ine_segment in s
+0001feb0: 656c 662e 6c69 6e65 5f73 6567 6d65 6e74  elf.line_segment
+0001fec0: 733a 0a20 2020 2020 2020 2020 2020 2070  s:.            p
+0001fed0: 6f69 6e74 5f69 6e74 6572 7365 6374 696f  oint_intersectio
+0001fee0: 6e20 3d20 6c69 6e65 5f73 6567 6d65 6e74  n = line_segment
+0001fef0: 2e6c 696e 6573 6567 6d65 6e74 5f69 6e74  .linesegment_int
+0001ff00: 6572 7365 6374 696f 6e73 280a 2020 2020  ersections(.    
+0001ff10: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+0001ff20: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0001ff30: 2070 6f69 6e74 5f69 6e74 6572 7365 6374   point_intersect
+0001ff40: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
+0001ff50: 2020 2020 2070 6f69 6e74 5f69 6e74 6572       point_inter
+0001ff60: 7365 6374 696f 6e73 5b6c 696e 655f 7365  sections[line_se
+0001ff70: 676d 656e 745d 203d 2070 6f69 6e74 5f69  gment] = point_i
+0001ff80: 6e74 6572 7365 6374 696f 6e5b 0a20 2020  ntersection[.   
+0001ff90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ffa0: 2030 5d0a 2020 2020 2020 2020 2020 2020   0].            
+0001ffb0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001ffc0: 2020 2020 2020 6966 206c 696e 652e 706f        if line.po
+0001ffd0: 696e 745f 6265 6c6f 6e67 7328 6c69 6e65  int_belongs(line
+0001ffe0: 5f73 6567 6d65 6e74 2e73 7461 7274 293a  _segment.start):
+0001fff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020000: 2020 2020 2070 6f69 6e74 5f69 6e74 6572       point_inter
+00020010: 7365 6374 696f 6e73 5b6c 696e 655f 7365  sections[line_se
+00020020: 676d 656e 745d 203d 206c 696e 655f 7365  gment] = line_se
+00020030: 676d 656e 742e 7374 6172 740a 2020 2020  gment.start.    
+00020040: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00020050: 696e 652e 706f 696e 745f 6265 6c6f 6e67  ine.point_belong
+00020060: 7328 6c69 6e65 5f73 6567 6d65 6e74 2e65  s(line_segment.e
+00020070: 6e64 293a 0a20 2020 2020 2020 2020 2020  nd):.           
+00020080: 2020 2020 2020 2020 2070 6f69 6e74 5f69           point_i
+00020090: 6e74 6572 7365 6374 696f 6e73 5b6c 696e  ntersections[lin
+000200a0: 655f 7365 676d 656e 745d 203d 206c 696e  e_segment] = lin
+000200b0: 655f 7365 676d 656e 742e 656e 640a 2020  e_segment.end.  
+000200c0: 2020 2020 2020 706f 696e 745f 6469 7374        point_dist
+000200d0: 616e 6365 203d 206c 6973 7428 706f 696e  ance = list(poin
+000200e0: 745f 696e 7465 7273 6563 7469 6f6e 732e  t_intersections.
+000200f0: 7661 6c75 6573 2829 295b 0a20 2020 2020  values())[.     
+00020100: 2020 2020 2020 2030 5d2e 706f 696e 745f         0].point_
+00020110: 6469 7374 616e 6365 2863 726f 7373 696e  distance(crossin
+00020120: 675f 706f 696e 7429 0a20 2020 2020 2020  g_point).       
+00020130: 2070 6f69 6e74 5f69 6e74 6572 7365 6374   point_intersect
+00020140: 696f 6e20 3d20 6c69 7374 2870 6f69 6e74  ion = list(point
+00020150: 5f69 6e74 6572 7365 6374 696f 6e73 2e76  _intersections.v
+00020160: 616c 7565 7328 2929 5b30 5d0a 2020 2020  alues())[0].    
+00020170: 2020 2020 6c69 6e65 5f73 6567 6d65 6e74      line_segment
+00020180: 203d 206c 6973 7428 706f 696e 745f 696e   = list(point_in
+00020190: 7465 7273 6563 7469 6f6e 732e 6b65 7973  tersections.keys
+000201a0: 2829 295b 305d 0a20 2020 2020 2020 2066  ())[0].        f
+000201b0: 6f72 206c 696e 652c 2070 6f69 6e74 2069  or line, point i
+000201c0: 6e20 6c69 7374 2870 6f69 6e74 5f69 6e74  n list(point_int
+000201d0: 6572 7365 6374 696f 6e73 2e69 7465 6d73  ersections.items
+000201e0: 2829 295b 313a 5d3a 0a20 2020 2020 2020  ())[1:]:.       
+000201f0: 2020 2020 2064 6973 7420 3d20 6372 6f73       dist = cros
+00020200: 7369 6e67 5f70 6f69 6e74 2e70 6f69 6e74  sing_point.point
+00020210: 5f64 6973 7461 6e63 6528 706f 696e 7429  _distance(point)
+00020220: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00020230: 6469 7374 203c 2070 6f69 6e74 5f64 6973  dist < point_dis
+00020240: 7461 6e63 653a 0a20 2020 2020 2020 2020  tance:.         
+00020250: 2020 2020 2020 2070 6f69 6e74 5f64 6973         point_dis
+00020260: 7461 6e63 6520 3d20 6469 7374 0a20 2020  tance = dist.   
+00020270: 2020 2020 2020 2020 2020 2020 2070 6f69               poi
+00020280: 6e74 5f69 6e74 6572 7365 6374 696f 6e20  nt_intersection 
+00020290: 3d20 706f 696e 740a 2020 2020 2020 2020  = point.        
+000202a0: 2020 2020 2020 2020 6c69 6e65 5f73 6567          line_seg
+000202b0: 6d65 6e74 203d 206c 696e 650a 0a20 2020  ment = line..   
+000202c0: 2020 2020 2023 2070 6f69 6e74 5f69 6e74       # point_int
+000202d0: 6572 7365 6374 696f 6e2e 706c 6f74 2861  ersection.plot(a
+000202e0: 783d 6178 3264 290a 0a20 2020 2020 2020  x=ax2d)..       
+000202f0: 2069 6620 706f 696e 745f 696e 7465 7273   if point_inters
+00020300: 6563 7469 6f6e 2e70 6f69 6e74 5f64 6973  ection.point_dis
+00020310: 7461 6e63 6528 0a20 2020 2020 2020 2020  tance(.         
+00020320: 2020 2020 2020 206c 696e 655f 7365 676d         line_segm
+00020330: 656e 742e 7374 6172 7429 203c 2070 6f69  ent.start) < poi
+00020340: 6e74 5f69 6e74 6572 7365 6374 696f 6e2e  nt_intersection.
+00020350: 706f 696e 745f 6469 7374 616e 6365 280a  point_distance(.
 00020360: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00020370: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00020380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020390: 2020 2020 6c69 6e65 5f73 6567 6d65 6e74      line_segment
-000203a0: 2e65 6e64 293a 0a20 2020 2020 2020 2020  .end):.         
-000203b0: 2020 2063 6c6f 7369 6e67 5f70 6f69 6e74     closing_point
-000203c0: 203d 206c 696e 655f 7365 676d 656e 742e   = line_segment.
-000203d0: 7374 6172 740a 2020 2020 2020 2020 656c  start.        el
-000203e0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000203f0: 636c 6f73 696e 675f 706f 696e 7420 3d20  closing_point = 
-00020400: 6c69 6e65 5f73 6567 6d65 6e74 2e65 6e64  line_segment.end
-00020410: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00020420: 2063 6c6f 7369 6e67 5f70 6f69 6e74 0a0a   closing_point..
-00020430: 2020 2020 6465 6620 706f 696e 745f 696e      def point_in
-00020440: 5f70 6f6c 7967 6f6e 2873 656c 6629 3a0a  _polygon(self):.
-00020450: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00020460: 2020 2020 496e 2063 6173 6520 7468 6520      In case the 
-00020470: 6261 7279 6365 6e74 6572 206f 6620 7468  barycenter of th
-00020480: 6520 706f 6c79 676f 6e20 6973 206f 7574  e polygon is out
-00020490: 7369 6465 2c20 7468 6973 206d 6574 686f  side, this metho
-000204a0: 640a 2020 2020 2020 2020 6669 6e64 7320  d.        finds 
-000204b0: 616e 6f74 6865 7220 706f 696e 7420 696e  another point in
-000204c0: 7369 6465 2074 6865 2070 6f6c 7967 6f6e  side the polygon
-000204d0: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-000204e0: 2020 2020 2020 2062 6172 7963 656e 7465         barycente
-000204f0: 7220 3d20 7365 6c66 2e62 6172 7963 656e  r = self.barycen
-00020500: 7465 7228 290a 2020 2020 2020 2020 6966  ter().        if
-00020510: 2073 656c 662e 706f 696e 745f 6265 6c6f   self.point_belo
-00020520: 6e67 7328 6261 7279 6365 6e74 6572 293a  ngs(barycenter):
-00020530: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00020540: 7572 6e20 6261 7279 6365 6e74 6572 0a20  urn barycenter. 
-00020550: 2020 2020 2020 2069 6e74 6572 7365 7469         interseti
-00020560: 6f6e 7331 203d 207b 7d0a 2020 2020 2020  ons1 = {}.      
-00020570: 2020 6c69 6e65 785f 706f 7320 3d20 766f    linex_pos = vo
-00020580: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
-00020590: 5365 676d 656e 7432 4428 766f 6c6d 646c  Segment2D(volmdl
-000205a0: 722e 4f32 442c 2076 6f6c 6d64 6c72 2e58  r.O2D, volmdlr.X
-000205b0: 3244 202a 2035 290a 2020 2020 2020 2020  2D * 5).        
-000205c0: 6c69 6e65 785f 6e65 6720 3d20 766f 6c6d  linex_neg = volm
-000205d0: 646c 722e 6564 6765 732e 4c69 6e65 5365  dlr.edges.LineSe
-000205e0: 676d 656e 7432 4428 766f 6c6d 646c 722e  gment2D(volmdlr.
-000205f0: 4f32 442c 202d 766f 6c6d 646c 722e 5832  O2D, -volmdlr.X2
-00020600: 4420 2a20 3529 0a20 2020 2020 2020 206c  D * 5).        l
-00020610: 696e 6579 5f70 6f73 203d 2076 6f6c 6d64  iney_pos = volmd
-00020620: 6c72 2e65 6467 6573 2e4c 696e 6553 6567  lr.edges.LineSeg
-00020630: 6d65 6e74 3244 2876 6f6c 6d64 6c72 2e4f  ment2D(volmdlr.O
-00020640: 3244 2c20 766f 6c6d 646c 722e 5932 4420  2D, volmdlr.Y2D 
-00020650: 2a20 3529 0a20 2020 2020 2020 206c 696e  * 5).        lin
-00020660: 6579 5f6e 6567 203d 2076 6f6c 6d64 6c72  ey_neg = volmdlr
-00020670: 2e65 6467 6573 2e4c 696e 6553 6567 6d65  .edges.LineSegme
-00020680: 6e74 3244 2876 6f6c 6d64 6c72 2e4f 3244  nt2D(volmdlr.O2D
-00020690: 2c20 2d76 6f6c 6d64 6c72 2e59 3244 202a  , -volmdlr.Y2D *
-000206a0: 2035 290a 2020 2020 2020 2020 666f 7220   5).        for 
-000206b0: 6c69 6e65 2069 6e20 5b6c 696e 6578 5f70  line in [linex_p
-000206c0: 6f73 2c20 6c69 6e65 785f 6e65 672c 206c  os, linex_neg, l
-000206d0: 696e 6579 5f70 6f73 2c20 6c69 6e65 795f  iney_pos, liney_
-000206e0: 6e65 675d 3a0a 2020 2020 2020 2020 2020  neg]:.          
-000206f0: 2020 696e 7465 7273 6563 7469 6f6e 7320    intersections 
-00020700: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
-00020710: 2066 6f72 206c 696e 655f 7365 676d 656e   for line_segmen
-00020720: 7420 696e 2073 656c 662e 6c69 6e65 5f73  t in self.line_s
-00020730: 6567 6d65 6e74 733a 0a20 2020 2020 2020  egments:.       
-00020740: 2020 2020 2020 2020 2070 6f69 6e74 5f69           point_i
-00020750: 6e74 6572 7365 6374 696f 6e20 3d20 6c69  ntersection = li
-00020760: 6e65 5f73 6567 6d65 6e74 2e6c 696e 6573  ne_segment.lines
-00020770: 6567 6d65 6e74 5f69 6e74 6572 7365 6374  egment_intersect
-00020780: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
-00020790: 2020 2020 2020 2020 2020 6c69 6e65 290a            line).
-000207a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000207b0: 696e 7465 7273 6563 7469 6f6e 732e 6578  intersections.ex
-000207c0: 7465 6e64 2870 6f69 6e74 5f69 6e74 6572  tend(point_inter
-000207d0: 7365 6374 696f 6e29 0a20 2020 2020 2020  section).       
-000207e0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-000207f0: 706f 696e 745f 696e 7465 7273 6563 7469  point_intersecti
-00020800: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00020810: 2020 2020 2020 2020 6966 206c 696e 652e          if line.
-00020820: 706f 696e 745f 6265 6c6f 6e67 7328 6c69  point_belongs(li
-00020830: 6e65 5f73 6567 6d65 6e74 2e73 7461 7274  ne_segment.start
-00020840: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00020850: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
-00020860: 7365 6374 696f 6e73 2e61 7070 656e 6428  sections.append(
-00020870: 6c69 6e65 5f73 6567 6d65 6e74 2e73 7461  line_segment.sta
-00020880: 7274 290a 2020 2020 2020 2020 2020 2020  rt).            
-00020890: 2020 2020 2020 2020 6966 206c 696e 652e          if line.
-000208a0: 706f 696e 745f 6265 6c6f 6e67 7328 6c69  point_belongs(li
-000208b0: 6e65 5f73 6567 6d65 6e74 2e65 6e64 293a  ne_segment.end):
-000208c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000208d0: 2020 2020 2020 2020 2069 6e74 6572 7365           interse
-000208e0: 6374 696f 6e73 2e61 7070 656e 6428 6c69  ctions.append(li
-000208f0: 6e65 5f73 6567 6d65 6e74 2e65 6e64 290a  ne_segment.end).
-00020900: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-00020910: 7273 6574 696f 6e73 315b 6c69 6e65 5d20  rsetions1[line] 
-00020920: 3d20 696e 7465 7273 6563 7469 6f6e 735b  = intersections[
-00020930: 3a5d 0a20 2020 2020 2020 2066 6f72 2069  :].        for i
-00020940: 2c20 7661 6c75 6520 696e 2065 6e75 6d65  , value in enume
-00020950: 7261 7465 2869 6e74 6572 7365 7469 6f6e  rate(intersetion
-00020960: 7331 2e76 616c 7565 7328 2929 3a0a 2020  s1.values()):.  
-00020970: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00020980: 2076 616c 7565 3a0a 2020 2020 2020 2020   value:.        
-00020990: 2020 2020 2020 2020 6966 2069 2025 2032          if i % 2
-000209a0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-000209b0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-000209c0: 6e28 6c69 7374 2869 6e74 6572 7365 7469  n(list(interseti
-000209d0: 6f6e 7331 2e76 616c 7565 7328 2929 5b69  ons1.values())[i
-000209e0: 202b 2031 5d29 203d 3d20 323a 0a20 2020   + 1]) == 2:.   
-000209f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020a00: 2020 2020 2074 7261 6e73 6c61 7469 6f6e       translation
-00020a10: 3120 3d20 286c 6973 7428 696e 7465 7273  1 = (list(inters
-00020a20: 6574 696f 6e73 312e 7661 6c75 6573 2829  etions1.values()
-00020a30: 295b 6920 2b20 315d 5b30 5d20 2b0a 2020  )[i + 1][0] +.  
-00020a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020390: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+000203a0: 5f73 6567 6d65 6e74 2e65 6e64 293a 0a20  _segment.end):. 
+000203b0: 2020 2020 2020 2020 2020 2063 6c6f 7369             closi
+000203c0: 6e67 5f70 6f69 6e74 203d 206c 696e 655f  ng_point = line_
+000203d0: 7365 676d 656e 742e 7374 6172 740a 2020  segment.start.  
+000203e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000203f0: 2020 2020 2020 2020 636c 6f73 696e 675f          closing_
+00020400: 706f 696e 7420 3d20 6c69 6e65 5f73 6567  point = line_seg
+00020410: 6d65 6e74 2e65 6e64 0a0a 2020 2020 2020  ment.end..      
+00020420: 2020 7265 7475 726e 2063 6c6f 7369 6e67    return closing
+00020430: 5f70 6f69 6e74 0a0a 2020 2020 6465 6620  _point..    def 
+00020440: 706f 696e 745f 696e 5f70 6f6c 7967 6f6e  point_in_polygon
+00020450: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00020460: 2222 220a 2020 2020 2020 2020 496e 2063  """.        In c
+00020470: 6173 6520 7468 6520 6261 7279 6365 6e74  ase the barycent
+00020480: 6572 206f 6620 7468 6520 706f 6c79 676f  er of the polygo
+00020490: 6e20 6973 206f 7574 7369 6465 2c20 7468  n is outside, th
+000204a0: 6973 206d 6574 686f 640a 2020 2020 2020  is method.      
+000204b0: 2020 6669 6e64 7320 616e 6f74 6865 7220    finds another 
+000204c0: 706f 696e 7420 696e 7369 6465 2074 6865  point inside the
+000204d0: 2070 6f6c 7967 6f6e 2e0a 0a20 2020 2020   polygon...     
+000204e0: 2020 2022 2222 0a20 2020 2020 2020 2062     """.        b
+000204f0: 6172 7963 656e 7465 7220 3d20 7365 6c66  arycenter = self
+00020500: 2e62 6172 7963 656e 7465 7228 290a 2020  .barycenter().  
+00020510: 2020 2020 2020 6966 2073 656c 662e 706f        if self.po
+00020520: 696e 745f 6265 6c6f 6e67 7328 6261 7279  int_belongs(bary
+00020530: 6365 6e74 6572 293a 0a20 2020 2020 2020  center):.       
+00020540: 2020 2020 2072 6574 7572 6e20 6261 7279       return bary
+00020550: 6365 6e74 6572 0a20 2020 2020 2020 2069  center.        i
+00020560: 6e74 6572 7365 7469 6f6e 7331 203d 207b  ntersetions1 = {
+00020570: 7d0a 2020 2020 2020 2020 6c69 6e65 785f  }.        linex_
+00020580: 706f 7320 3d20 766f 6c6d 646c 722e 6564  pos = volmdlr.ed
+00020590: 6765 732e 4c69 6e65 5365 676d 656e 7432  ges.LineSegment2
+000205a0: 4428 766f 6c6d 646c 722e 4f32 442c 2076  D(volmdlr.O2D, v
+000205b0: 6f6c 6d64 6c72 2e58 3244 202a 2035 290a  olmdlr.X2D * 5).
+000205c0: 2020 2020 2020 2020 6c69 6e65 785f 6e65          linex_ne
+000205d0: 6720 3d20 766f 6c6d 646c 722e 6564 6765  g = volmdlr.edge
+000205e0: 732e 4c69 6e65 5365 676d 656e 7432 4428  s.LineSegment2D(
+000205f0: 766f 6c6d 646c 722e 4f32 442c 202d 766f  volmdlr.O2D, -vo
+00020600: 6c6d 646c 722e 5832 4420 2a20 3529 0a20  lmdlr.X2D * 5). 
+00020610: 2020 2020 2020 206c 696e 6579 5f70 6f73         liney_pos
+00020620: 203d 2076 6f6c 6d64 6c72 2e65 6467 6573   = volmdlr.edges
+00020630: 2e4c 696e 6553 6567 6d65 6e74 3244 2876  .LineSegment2D(v
+00020640: 6f6c 6d64 6c72 2e4f 3244 2c20 766f 6c6d  olmdlr.O2D, volm
+00020650: 646c 722e 5932 4420 2a20 3529 0a20 2020  dlr.Y2D * 5).   
+00020660: 2020 2020 206c 696e 6579 5f6e 6567 203d       liney_neg =
+00020670: 2076 6f6c 6d64 6c72 2e65 6467 6573 2e4c   volmdlr.edges.L
+00020680: 696e 6553 6567 6d65 6e74 3244 2876 6f6c  ineSegment2D(vol
+00020690: 6d64 6c72 2e4f 3244 2c20 2d76 6f6c 6d64  mdlr.O2D, -volmd
+000206a0: 6c72 2e59 3244 202a 2035 290a 2020 2020  lr.Y2D * 5).    
+000206b0: 2020 2020 666f 7220 6c69 6e65 2069 6e20      for line in 
+000206c0: 5b6c 696e 6578 5f70 6f73 2c20 6c69 6e65  [linex_pos, line
+000206d0: 785f 6e65 672c 206c 696e 6579 5f70 6f73  x_neg, liney_pos
+000206e0: 2c20 6c69 6e65 795f 6e65 675d 3a0a 2020  , liney_neg]:.  
+000206f0: 2020 2020 2020 2020 2020 696e 7465 7273            inters
+00020700: 6563 7469 6f6e 7320 3d20 5b5d 0a20 2020  ections = [].   
+00020710: 2020 2020 2020 2020 2066 6f72 206c 696e           for lin
+00020720: 655f 7365 676d 656e 7420 696e 2073 656c  e_segment in sel
+00020730: 662e 6c69 6e65 5f73 6567 6d65 6e74 733a  f.line_segments:
+00020740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020750: 2070 6f69 6e74 5f69 6e74 6572 7365 6374   point_intersect
+00020760: 696f 6e20 3d20 6c69 6e65 5f73 6567 6d65  ion = line_segme
+00020770: 6e74 2e6c 696e 6573 6567 6d65 6e74 5f69  nt.linesegment_i
+00020780: 6e74 6572 7365 6374 696f 6e73 280a 2020  ntersections(.  
+00020790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000207a0: 2020 6c69 6e65 290a 2020 2020 2020 2020    line).        
+000207b0: 2020 2020 2020 2020 696e 7465 7273 6563          intersec
+000207c0: 7469 6f6e 732e 6578 7465 6e64 2870 6f69  tions.extend(poi
+000207d0: 6e74 5f69 6e74 6572 7365 6374 696f 6e29  nt_intersection)
+000207e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000207f0: 2069 6620 6e6f 7420 706f 696e 745f 696e   if not point_in
+00020800: 7465 7273 6563 7469 6f6e 3a0a 2020 2020  tersection:.    
+00020810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020820: 6966 206c 696e 652e 706f 696e 745f 6265  if line.point_be
+00020830: 6c6f 6e67 7328 6c69 6e65 5f73 6567 6d65  longs(line_segme
+00020840: 6e74 2e73 7461 7274 293a 0a20 2020 2020  nt.start):.     
+00020850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020860: 2020 2069 6e74 6572 7365 6374 696f 6e73     intersections
+00020870: 2e61 7070 656e 6428 6c69 6e65 5f73 6567  .append(line_seg
+00020880: 6d65 6e74 2e73 7461 7274 290a 2020 2020  ment.start).    
+00020890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000208a0: 6966 206c 696e 652e 706f 696e 745f 6265  if line.point_be
+000208b0: 6c6f 6e67 7328 6c69 6e65 5f73 6567 6d65  longs(line_segme
+000208c0: 6e74 2e65 6e64 293a 0a20 2020 2020 2020  nt.end):.       
+000208d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000208e0: 2069 6e74 6572 7365 6374 696f 6e73 2e61   intersections.a
+000208f0: 7070 656e 6428 6c69 6e65 5f73 6567 6d65  ppend(line_segme
+00020900: 6e74 2e65 6e64 290a 2020 2020 2020 2020  nt.end).        
+00020910: 2020 2020 696e 7465 7273 6574 696f 6e73      intersetions
+00020920: 315b 6c69 6e65 5d20 3d20 696e 7465 7273  1[line] = inters
+00020930: 6563 7469 6f6e 735b 3a5d 0a20 2020 2020  ections[:].     
+00020940: 2020 2066 6f72 2069 2c20 7661 6c75 6520     for i, value 
+00020950: 696e 2065 6e75 6d65 7261 7465 2869 6e74  in enumerate(int
+00020960: 6572 7365 7469 6f6e 7331 2e76 616c 7565  ersetions1.value
+00020970: 7328 2929 3a0a 2020 2020 2020 2020 2020  s()):.          
+00020980: 2020 6966 206e 6f74 2076 616c 7565 3a0a    if not value:.
+00020990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000209a0: 6966 2069 2025 2032 203d 3d20 303a 0a20  if i % 2 == 0:. 
+000209b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000209c0: 2020 2069 6620 6c65 6e28 6c69 7374 2869     if len(list(i
+000209d0: 6e74 6572 7365 7469 6f6e 7331 2e76 616c  ntersetions1.val
+000209e0: 7565 7328 2929 5b69 202b 2031 5d29 203d  ues())[i + 1]) =
+000209f0: 3d20 323a 0a20 2020 2020 2020 2020 2020  = 2:.           
+00020a00: 2020 2020 2020 2020 2020 2020 2074 7261               tra
+00020a10: 6e73 6c61 7469 6f6e 3120 3d20 286c 6973  nslation1 = (lis
+00020a20: 7428 696e 7465 7273 6574 696f 6e73 312e  t(intersetions1.
+00020a30: 7661 6c75 6573 2829 295b 6920 2b20 315d  values())[i + 1]
+00020a40: 5b30 5d20 2b0a 2020 2020 2020 2020 2020  [0] +.          
 00020a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020a60: 2020 2020 2020 6c69 7374 2869 6e74 6572        list(inter
-00020a70: 7365 7469 6f6e 7331 2e76 616c 7565 7328  setions1.values(
-00020a80: 2929 5b0a 2020 2020 2020 2020 2020 2020  ))[.            
+00020a60: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00020a70: 7374 2869 6e74 6572 7365 7469 6f6e 7331  st(intersetions1
+00020a80: 2e76 616c 7565 7328 2929 5b0a 2020 2020  .values())[.    
 00020a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00020aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020ab0: 6920 2b20 315d 5b31 5d29 202a 2030 2e35  i + 1][1]) * 0.5
-00020ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020ad0: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
-00020ae0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00020af0: 6620 6920 2520 3220 213d 2030 3a0a 2020  f i % 2 != 0:.  
-00020b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020b10: 2020 6966 206c 656e 286c 6973 7428 696e    if len(list(in
-00020b20: 7465 7273 6574 696f 6e73 312e 7661 6c75  tersetions1.valu
-00020b30: 6573 2829 295b 6920 2d20 315d 2920 3d3d  es())[i - 1]) ==
-00020b40: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-00020b50: 2020 2020 2020 2020 2020 2020 7472 616e              tran
-00020b60: 736c 6174 696f 6e31 203d 2028 6c69 7374  slation1 = (list
-00020b70: 2869 6e74 6572 7365 7469 6f6e 7331 2e76  (intersetions1.v
-00020b80: 616c 7565 7328 2929 5b69 202d 2031 5d5b  alues())[i - 1][
-00020b90: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+00020ab0: 2020 2020 2020 2020 6920 2b20 315d 5b31          i + 1][1
+00020ac0: 5d29 202a 2030 2e35 0a20 2020 2020 2020  ]) * 0.5.       
+00020ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ae0: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
+00020af0: 2020 2020 2020 2069 6620 6920 2520 3220         if i % 2 
+00020b00: 213d 2030 3a0a 2020 2020 2020 2020 2020  != 0:.          
+00020b10: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+00020b20: 286c 6973 7428 696e 7465 7273 6574 696f  (list(intersetio
+00020b30: 6e73 312e 7661 6c75 6573 2829 295b 6920  ns1.values())[i 
+00020b40: 2d20 315d 2920 3d3d 2032 3a0a 2020 2020  - 1]) == 2:.    
+00020b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b60: 2020 2020 7472 616e 736c 6174 696f 6e31      translation1
+00020b70: 203d 2028 6c69 7374 2869 6e74 6572 7365   = (list(interse
+00020b80: 7469 6f6e 7331 2e76 616c 7565 7328 2929  tions1.values())
+00020b90: 5b69 202d 2031 5d5b 305d 0a20 2020 2020  [i - 1][0].     
 00020ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020bb0: 2020 2020 2020 2020 2020 202b 206c 6973             + lis
-00020bc0: 7428 696e 7465 7273 6574 696f 6e73 312e  t(intersetions1.
-00020bd0: 7661 6c75 6573 2829 295b 6920 2d20 315d  values())[i - 1]
-00020be0: 5b31 5d29 202a 2030 2e35 0a20 2020 2020  [1]) * 0.5.     
-00020bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020c00: 2020 2062 7265 616b 0a0a 2020 2020 2020     break..      
-00020c10: 2020 7265 7475 726e 2074 7261 6e73 6c61    return transla
-00020c20: 7469 6f6e 310a 0a20 2020 2064 6566 2072  tion1..    def r
-00020c30: 6570 6f73 6974 696f 6e65 645f 706f 6c79  epositioned_poly
-00020c40: 676f 6e28 7365 6c66 2c20 782c 2079 293a  gon(self, x, y):
-00020c50: 0a20 2020 2020 2020 206c 696e 6578 203d  .        linex =
-00020c60: 2076 6f6c 6d64 6c72 2e65 6467 6573 2e4c   volmdlr.edges.L
-00020c70: 696e 6553 6567 6d65 6e74 3244 282d 782e  ineSegment2D(-x.
-00020c80: 746f 5f32 6428 766f 6c6d 646c 722e 4f32  to_2d(volmdlr.O2
-00020c90: 442c 2078 2c20 7929 2c0a 2020 2020 2020  D, x, y),.      
-00020ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020bc0: 2020 202b 206c 6973 7428 696e 7465 7273     + list(inters
+00020bd0: 6574 696f 6e73 312e 7661 6c75 6573 2829  etions1.values()
+00020be0: 295b 6920 2d20 315d 5b31 5d29 202a 2030  )[i - 1][1]) * 0
+00020bf0: 2e35 0a20 2020 2020 2020 2020 2020 2020  .5.             
+00020c00: 2020 2020 2020 2020 2020 2062 7265 616b             break
+00020c10: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00020c20: 2074 7261 6e73 6c61 7469 6f6e 310a 0a20   translation1.. 
+00020c30: 2020 2064 6566 2072 6570 6f73 6974 696f     def repositio
+00020c40: 6e65 645f 706f 6c79 676f 6e28 7365 6c66  ned_polygon(self
+00020c50: 2c20 782c 2079 293a 0a20 2020 2020 2020  , x, y):.       
+00020c60: 206c 696e 6578 203d 2076 6f6c 6d64 6c72   linex = volmdlr
+00020c70: 2e65 6467 6573 2e4c 696e 6553 6567 6d65  .edges.LineSegme
+00020c80: 6e74 3244 282d 782e 746f 5f32 6428 766f  nt2D(-x.to_2d(vo
+00020c90: 6c6d 646c 722e 4f32 442c 2078 2c20 7929  lmdlr.O2D, x, y)
+00020ca0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 00020cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020cc0: 2020 2020 2020 782e 746f 5f32 6428 766f        x.to_2d(vo
-00020cd0: 6c6d 646c 722e 4f32 442c 2078 2c20 7929  lmdlr.O2D, x, y)
-00020ce0: 290a 2020 2020 2020 2020 7761 795f 6261  ).        way_ba
-00020cf0: 636b 203d 2076 6f6c 6d64 6c72 2e4f 3344  ck = volmdlr.O3D
-00020d00: 0a20 2020 2020 2020 2062 6172 7963 656e  .        barycen
-00020d10: 7465 7220 3d20 7365 6c66 2e62 6172 7963  ter = self.baryc
-00020d20: 656e 7465 7228 290a 2020 2020 2020 2020  enter().        
-00020d30: 6966 206e 6f74 2073 656c 662e 706f 696e  if not self.poin
-00020d40: 745f 6265 6c6f 6e67 7328 6261 7279 6365  t_belongs(baryce
-00020d50: 6e74 6572 293a 0a20 2020 2020 2020 2020  nter):.         
-00020d60: 2020 2062 6172 7963 656e 7465 7231 5f32     barycenter1_2
-00020d70: 6420 3d20 7365 6c66 2e70 6f69 6e74 5f69  d = self.point_i
-00020d80: 6e5f 706f 6c79 676f 6e28 290a 2020 2020  n_polygon().    
-00020d90: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
-00020da0: 6e73 6c61 7469 6f6e 282d 6261 7279 6365  nslation(-baryce
-00020db0: 6e74 6572 315f 3264 2c20 4661 6c73 6529  nter1_2d, False)
-00020dc0: 0a20 2020 2020 2020 2020 2020 2077 6179  .            way
-00020dd0: 5f62 6163 6b20 3d20 6261 7279 6365 6e74  _back = barycent
-00020de0: 6572 315f 3264 2e74 6f5f 3364 2876 6f6c  er1_2d.to_3d(vol
-00020df0: 6d64 6c72 2e4f 3344 2c20 782c 2079 290a  mdlr.O3D, x, y).
-00020e00: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00020e10: 2020 2020 2020 2020 2020 696e 7465 7273            inters
-00020e20: 203d 2073 656c 662e 6c69 6e65 7365 676d   = self.linesegm
-00020e30: 656e 745f 696e 7465 7273 6563 7469 6f6e  ent_intersection
-00020e40: 7328 6c69 6e65 7829 0a20 2020 2020 2020  s(linex).       
-00020e50: 2020 2020 2064 6973 7461 6e63 6520 3d20       distance = 
-00020e60: 696e 7465 7273 5b30 5d5b 305d 2e70 6f69  inters[0][0].poi
-00020e70: 6e74 5f64 6973 7461 6e63 6528 696e 7465  nt_distance(inte
-00020e80: 7273 5b2d 315d 5b30 5d29 0a20 2020 2020  rs[-1][0]).     
-00020e90: 2020 2020 2020 2069 6620 6469 7374 616e         if distan
-00020ea0: 6365 202f 2032 203e 2033 202a 206d 696e  ce / 2 > 3 * min
-00020eb0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00020ec0: 2020 2020 2020 7365 6c66 2e70 6f69 6e74        self.point
-00020ed0: 5f64 6973 7461 6e63 6528 696e 7465 7273  _distance(inters
-00020ee0: 5b30 5d5b 305d 292c 0a20 2020 2020 2020  [0][0]),.       
-00020ef0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00020f00: 662e 706f 696e 745f 6469 7374 616e 6365  f.point_distance
-00020f10: 2869 6e74 6572 735b 2d31 5d5b 305d 2929  (inters[-1][0]))
-00020f20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020f30: 2020 6d69 645f 706f 696e 7420 3d20 2869    mid_point = (i
-00020f40: 6e74 6572 735b 305d 5b30 5d20 2b20 696e  nters[0][0] + in
-00020f50: 7465 7273 5b2d 315d 5b30 5d29 202a 2030  ters[-1][0]) * 0
-00020f60: 2e35 0a20 2020 2020 2020 2020 2020 2020  .5.             
-00020f70: 2020 2073 656c 662e 7472 616e 736c 6174     self.translat
-00020f80: 696f 6e28 2d6d 6964 5f70 6f69 6e74 290a  ion(-mid_point).
-00020f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020fa0: 7761 795f 6261 636b 203d 206d 6964 5f70  way_back = mid_p
-00020fb0: 6f69 6e74 2e74 6f5f 3364 2876 6f6c 6d64  oint.to_3d(volmd
-00020fc0: 6c72 2e4f 3344 2c20 782c 2079 290a 0a20  lr.O3D, x, y).. 
-00020fd0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00020fe0: 6c66 2c20 7761 795f 6261 636b 0a0a 2020  lf, way_back..  
-00020ff0: 2020 6465 6620 6765 745f 706f 7373 6962    def get_possib
-00021000: 6c65 5f73 6577 696e 675f 636c 6f73 696e  le_sewing_closin
-00021010: 675f 706f 696e 7473 2873 656c 662c 2070  g_points(self, p
-00021020: 6f6c 7967 6f6e 322c 2070 6f6c 7967 6f6e  olygon2, polygon
-00021030: 5f70 7269 6d69 7469 7665 2c0a 2020 2020  _primitive,.    
-00021040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020cc0: 2020 2020 2020 2020 2020 2020 2020 782e                x.
+00020cd0: 746f 5f32 6428 766f 6c6d 646c 722e 4f32  to_2d(volmdlr.O2
+00020ce0: 442c 2078 2c20 7929 290a 2020 2020 2020  D, x, y)).      
+00020cf0: 2020 7761 795f 6261 636b 203d 2076 6f6c    way_back = vol
+00020d00: 6d64 6c72 2e4f 3344 0a20 2020 2020 2020  mdlr.O3D.       
+00020d10: 2062 6172 7963 656e 7465 7220 3d20 7365   barycenter = se
+00020d20: 6c66 2e62 6172 7963 656e 7465 7228 290a  lf.barycenter().
+00020d30: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00020d40: 656c 662e 706f 696e 745f 6265 6c6f 6e67  elf.point_belong
+00020d50: 7328 6261 7279 6365 6e74 6572 293a 0a20  s(barycenter):. 
+00020d60: 2020 2020 2020 2020 2020 2062 6172 7963             baryc
+00020d70: 656e 7465 7231 5f32 6420 3d20 7365 6c66  enter1_2d = self
+00020d80: 2e70 6f69 6e74 5f69 6e5f 706f 6c79 676f  .point_in_polygo
+00020d90: 6e28 290a 2020 2020 2020 2020 2020 2020  n().            
+00020da0: 7365 6c66 2e74 7261 6e73 6c61 7469 6f6e  self.translation
+00020db0: 282d 6261 7279 6365 6e74 6572 315f 3264  (-barycenter1_2d
+00020dc0: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
+00020dd0: 2020 2020 2077 6179 5f62 6163 6b20 3d20       way_back = 
+00020de0: 6261 7279 6365 6e74 6572 315f 3264 2e74  barycenter1_2d.t
+00020df0: 6f5f 3364 2876 6f6c 6d64 6c72 2e4f 3344  o_3d(volmdlr.O3D
+00020e00: 2c20 782c 2079 290a 2020 2020 2020 2020  , x, y).        
+00020e10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00020e20: 2020 696e 7465 7273 203d 2073 656c 662e    inters = self.
+00020e30: 6c69 6e65 7365 676d 656e 745f 696e 7465  linesegment_inte
+00020e40: 7273 6563 7469 6f6e 7328 6c69 6e65 7829  rsections(linex)
+00020e50: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+00020e60: 7461 6e63 6520 3d20 696e 7465 7273 5b30  tance = inters[0
+00020e70: 5d5b 305d 2e70 6f69 6e74 5f64 6973 7461  ][0].point_dista
+00020e80: 6e63 6528 696e 7465 7273 5b2d 315d 5b30  nce(inters[-1][0
+00020e90: 5d29 0a20 2020 2020 2020 2020 2020 2069  ]).            i
+00020ea0: 6620 6469 7374 616e 6365 202f 2032 203e  f distance / 2 >
+00020eb0: 2033 202a 206d 696e 280a 2020 2020 2020   3 * min(.      
+00020ec0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00020ed0: 6c66 2e70 6f69 6e74 5f64 6973 7461 6e63  lf.point_distanc
+00020ee0: 6528 696e 7465 7273 5b30 5d5b 305d 292c  e(inters[0][0]),
+00020ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020f00: 2020 2020 2073 656c 662e 706f 696e 745f       self.point_
+00020f10: 6469 7374 616e 6365 2869 6e74 6572 735b  distance(inters[
+00020f20: 2d31 5d5b 305d 2929 3a0a 2020 2020 2020  -1][0])):.      
+00020f30: 2020 2020 2020 2020 2020 6d69 645f 706f            mid_po
+00020f40: 696e 7420 3d20 2869 6e74 6572 735b 305d  int = (inters[0]
+00020f50: 5b30 5d20 2b20 696e 7465 7273 5b2d 315d  [0] + inters[-1]
+00020f60: 5b30 5d29 202a 2030 2e35 0a20 2020 2020  [0]) * 0.5.     
+00020f70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00020f80: 7472 616e 736c 6174 696f 6e28 2d6d 6964  translation(-mid
+00020f90: 5f70 6f69 6e74 290a 2020 2020 2020 2020  _point).        
+00020fa0: 2020 2020 2020 2020 7761 795f 6261 636b          way_back
+00020fb0: 203d 206d 6964 5f70 6f69 6e74 2e74 6f5f   = mid_point.to_
+00020fc0: 3364 2876 6f6c 6d64 6c72 2e4f 3344 2c20  3d(volmdlr.O3D, 
+00020fd0: 782c 2079 290a 0a20 2020 2020 2020 2072  x, y)..        r
+00020fe0: 6574 7572 6e20 7365 6c66 2c20 7761 795f  eturn self, way_
+00020ff0: 6261 636b 0a0a 2020 2020 6465 6620 6765  back..    def ge
+00021000: 745f 706f 7373 6962 6c65 5f73 6577 696e  t_possible_sewin
+00021010: 675f 636c 6f73 696e 675f 706f 696e 7473  g_closing_points
+00021020: 2873 656c 662c 2070 6f6c 7967 6f6e 322c  (self, polygon2,
+00021030: 2070 6f6c 7967 6f6e 5f70 7269 6d69 7469   polygon_primiti
+00021040: 7665 2c0a 2020 2020 2020 2020 2020 2020  ve,.            
 00021050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021060: 2020 2020 2020 206c 696e 655f 7365 676d         line_segm
-00021070: 656e 7431 3a20 4e6f 6e65 2c20 6c69 6e65  ent1: None, line
-00021080: 5f73 6567 6d65 6e74 323a 204e 6f6e 6529  _segment2: None)
-00021090: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000210a0: 2020 2020 2020 5365 6172 6368 6573 2061        Searches a
-000210b0: 6c6c 2070 6f73 7369 626c 6573 2063 6c6f  ll possibles clo
-000210c0: 7369 6e67 2070 6f69 6e74 7320 6176 6169  sing points avai
-000210d0: 6c61 626c 6520 666f 7220 7468 6520 6769  lable for the gi
-000210e0: 7665 6e20 7072 696d 6974 6976 650a 2020  ven primitive.  
-000210f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00021100: 2020 6d69 6464 6c65 5f70 6f69 6e74 203d    middle_point =
-00021110: 2070 6f6c 7967 6f6e 5f70 7269 6d69 7469   polygon_primiti
-00021120: 7665 2e6d 6964 646c 655f 706f 696e 7428  ve.middle_point(
-00021130: 290a 2020 2020 2020 2020 6966 206c 696e  ).        if lin
-00021140: 655f 7365 676d 656e 7431 2069 7320 4e6f  e_segment1 is No
-00021150: 6e65 2061 6e64 206c 696e 655f 7365 676d  ne and line_segm
-00021160: 656e 7432 2069 7320 4e6f 6e65 3a0a 2020  ent2 is None:.  
-00021170: 2020 2020 2020 2020 2020 6e6f 726d 616c            normal
-00021180: 5f76 6563 746f 7220 3d20 706f 6c79 676f  _vector = polygo
-00021190: 6e5f 7072 696d 6974 6976 652e 756e 6974  n_primitive.unit
-000211a0: 5f6e 6f72 6d61 6c5f 7665 6374 6f72 2829  _normal_vector()
-000211b0: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
-000211c0: 655f 7365 676d 656e 7431 203d 2076 6f6c  e_segment1 = vol
-000211d0: 6d64 6c72 2e65 6467 6573 2e4c 696e 6553  mdlr.edges.LineS
-000211e0: 6567 6d65 6e74 3244 286d 6964 646c 655f  egment2D(middle_
-000211f0: 706f 696e 742c 0a20 2020 2020 2020 2020  point,.         
+00021060: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00021070: 696e 655f 7365 676d 656e 7431 3a20 4e6f  ine_segment1: No
+00021080: 6e65 2c20 6c69 6e65 5f73 6567 6d65 6e74  ne, line_segment
+00021090: 323a 204e 6f6e 6529 3a0a 2020 2020 2020  2: None):.      
+000210a0: 2020 2222 220a 2020 2020 2020 2020 5365    """.        Se
+000210b0: 6172 6368 6573 2061 6c6c 2070 6f73 7369  arches all possi
+000210c0: 626c 6573 2063 6c6f 7369 6e67 2070 6f69  bles closing poi
+000210d0: 6e74 7320 6176 6169 6c61 626c 6520 666f  nts available fo
+000210e0: 7220 7468 6520 6769 7665 6e20 7072 696d  r the given prim
+000210f0: 6974 6976 650a 2020 2020 2020 2020 2222  itive.        ""
+00021100: 220a 2020 2020 2020 2020 6d69 6464 6c65  ".        middle
+00021110: 5f70 6f69 6e74 203d 2070 6f6c 7967 6f6e  _point = polygon
+00021120: 5f70 7269 6d69 7469 7665 2e6d 6964 646c  _primitive.middl
+00021130: 655f 706f 696e 7428 290a 2020 2020 2020  e_point().      
+00021140: 2020 6966 206c 696e 655f 7365 676d 656e    if line_segmen
+00021150: 7431 2069 7320 4e6f 6e65 2061 6e64 206c  t1 is None and l
+00021160: 696e 655f 7365 676d 656e 7432 2069 7320  ine_segment2 is 
+00021170: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00021180: 2020 6e6f 726d 616c 5f76 6563 746f 7220    normal_vector 
+00021190: 3d20 706f 6c79 676f 6e5f 7072 696d 6974  = polygon_primit
+000211a0: 6976 652e 756e 6974 5f6e 6f72 6d61 6c5f  ive.unit_normal_
+000211b0: 7665 6374 6f72 2829 0a20 2020 2020 2020  vector().       
+000211c0: 2020 2020 206c 696e 655f 7365 676d 656e       line_segmen
+000211d0: 7431 203d 2076 6f6c 6d64 6c72 2e65 6467  t1 = volmdlr.edg
+000211e0: 6573 2e4c 696e 6553 6567 6d65 6e74 3244  es.LineSegment2D
+000211f0: 286d 6964 646c 655f 706f 696e 742c 0a20  (middle_point,. 
 00021200: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021220: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00021230: 6964 646c 655f 706f 696e 7420 2d20 6e6f  iddle_point - no
-00021240: 726d 616c 5f76 6563 746f 7229 0a20 2020  rmal_vector).   
-00021250: 2020 2020 2020 2020 206c 696e 655f 7365           line_se
-00021260: 676d 656e 7432 203d 2076 6f6c 6d64 6c72  gment2 = volmdlr
-00021270: 2e65 6467 6573 2e4c 696e 6553 6567 6d65  .edges.LineSegme
-00021280: 6e74 3244 286d 6964 646c 655f 706f 696e  nt2D(middle_poin
-00021290: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+00021220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021230: 2020 2020 2020 206d 6964 646c 655f 706f         middle_po
+00021240: 696e 7420 2d20 6e6f 726d 616c 5f76 6563  int - normal_vec
+00021250: 746f 7229 0a20 2020 2020 2020 2020 2020  tor).           
+00021260: 206c 696e 655f 7365 676d 656e 7432 203d   line_segment2 =
+00021270: 2076 6f6c 6d64 6c72 2e65 6467 6573 2e4c   volmdlr.edges.L
+00021280: 696e 6553 6567 6d65 6e74 3244 286d 6964  ineSegment2D(mid
+00021290: 646c 655f 706f 696e 742c 0a20 2020 2020  dle_point,.     
 000212a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000212b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000212c0: 2020 2020 2020 2020 2020 206d 6964 646c             middl
-000212d0: 655f 706f 696e 7420 2b20 6e6f 726d 616c  e_point + normal
-000212e0: 5f76 6563 746f 7229 0a0a 2020 2020 2020  _vector)..      
-000212f0: 2020 6c69 6e65 5f69 6e74 6572 7365 6374    line_intersect
-00021300: 696f 6e73 203d 207b 6c69 6e65 5f73 6567  ions = {line_seg
-00021310: 6d65 6e74 313a 205b 5d2c 206c 696e 655f  ment1: [], line_
-00021320: 7365 676d 656e 7432 3a20 5b5d 7d0a 2020  segment2: []}.  
-00021330: 2020 2020 2020 666f 7220 6c69 6e65 5f73        for line_s
-00021340: 6567 6d65 6e74 2069 6e20 5b6c 696e 655f  egment in [line_
-00021350: 7365 676d 656e 7431 2c20 6c69 6e65 5f73  segment1, line_s
-00021360: 6567 6d65 6e74 320a 2020 2020 2020 2020  egment2.        
+000212c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000212d0: 2020 206d 6964 646c 655f 706f 696e 7420     middle_point 
+000212e0: 2b20 6e6f 726d 616c 5f76 6563 746f 7229  + normal_vector)
+000212f0: 0a0a 2020 2020 2020 2020 6c69 6e65 5f69  ..        line_i
+00021300: 6e74 6572 7365 6374 696f 6e73 203d 207b  ntersections = {
+00021310: 6c69 6e65 5f73 6567 6d65 6e74 313a 205b  line_segment1: [
+00021320: 5d2c 206c 696e 655f 7365 676d 656e 7432  ], line_segment2
+00021330: 3a20 5b5d 7d0a 2020 2020 2020 2020 666f  : []}.        fo
+00021340: 7220 6c69 6e65 5f73 6567 6d65 6e74 2069  r line_segment i
+00021350: 6e20 5b6c 696e 655f 7365 676d 656e 7431  n [line_segment1
+00021360: 2c20 6c69 6e65 5f73 6567 6d65 6e74 320a  , line_segment2.
 00021370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021380: 2020 2020 205d 3a0a 2020 2020 2020 2020       ]:.        
-00021390: 2020 2020 696e 7465 725f 706f 696e 7473      inter_points
-000213a0: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
-000213b0: 2020 666f 7220 7072 696d 2069 6e20 706f    for prim in po
-000213c0: 6c79 676f 6e32 2e6c 696e 655f 7365 676d  lygon2.line_segm
-000213d0: 656e 7473 202b 2073 656c 662e 6c69 6e65  ents + self.line
-000213e0: 5f73 6567 6d65 6e74 735b 0a20 2020 2020  _segments[.     
-000213f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021380: 2020 2020 2020 2020 2020 2020 205d 3a0a               ]:.
+00021390: 2020 2020 2020 2020 2020 2020 696e 7465              inte
+000213a0: 725f 706f 696e 7473 203d 205b 5d0a 2020  r_points = [].  
+000213b0: 2020 2020 2020 2020 2020 666f 7220 7072            for pr
+000213c0: 696d 2069 6e20 706f 6c79 676f 6e32 2e6c  im in polygon2.l
+000213d0: 696e 655f 7365 676d 656e 7473 202b 2073  ine_segments + s
+000213e0: 656c 662e 6c69 6e65 5f73 6567 6d65 6e74  elf.line_segment
+000213f0: 735b 0a20 2020 2020 2020 2020 2020 2020  s[.             
 00021400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021410: 2020 2020 2020 2020 2020 2020 3a73 656c              :sel
-00021420: 662e 6c69 6e65 5f73 6567 6d65 6e74 732e  f.line_segments.
-00021430: 696e 6465 7828 0a20 2020 2020 2020 2020  index(.         
+00021410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021420: 2020 2020 3a73 656c 662e 6c69 6e65 5f73      :self.line_s
+00021430: 6567 6d65 6e74 732e 696e 6465 7828 0a20  egments.index(. 
 00021440: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021460: 2020 2020 2020 2020 2020 2020 706f 6c79              poly
-00021470: 676f 6e5f 7072 696d 6974 6976 6529 5d20  gon_primitive)] 
-00021480: 2b20 7365 6c66 2e6c 696e 655f 7365 676d  + self.line_segm
-00021490: 656e 7473 5b0a 2020 2020 2020 2020 2020  ents[.          
+00021460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021470: 2020 2020 706f 6c79 676f 6e5f 7072 696d      polygon_prim
+00021480: 6974 6976 6529 5d20 2b20 7365 6c66 2e6c  itive)] + self.l
+00021490: 696e 655f 7365 676d 656e 7473 5b0a 2020  ine_segments[.  
 000214a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000214b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000214c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000214d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000214e0: 2073 656c 662e 6c69 6e65 5f73 6567 6d65   self.line_segme
-000214f0: 6e74 732e 696e 6465 7828 0a20 2020 2020  nts.index(.     
-00021500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000214e0: 2020 2020 2020 2020 2073 656c 662e 6c69           self.li
+000214f0: 6e65 5f73 6567 6d65 6e74 732e 696e 6465  ne_segments.inde
+00021500: 7828 0a20 2020 2020 2020 2020 2020 2020  x(.             
 00021510: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021520: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021540: 2020 2020 2020 2020 2020 706f 6c79 676f            polygo
-00021550: 6e5f 7072 696d 6974 6976 6529 202b 2031  n_primitive) + 1
-00021560: 3a5d 3a0a 2020 2020 2020 2020 2020 2020  :]:.            
-00021570: 2020 2020 696e 7465 7273 203d 2070 7269      inters = pri
-00021580: 6d2e 6c69 6e65 7365 676d 656e 745f 696e  m.linesegment_in
-00021590: 7465 7273 6563 7469 6f6e 7328 6c69 6e65  tersections(line
-000215a0: 5f73 6567 6d65 6e74 290a 2020 2020 2020  _segment).      
-000215b0: 2020 2020 2020 2020 2020 6966 2069 6e74            if int
-000215c0: 6572 733a 0a20 2020 2020 2020 2020 2020  ers:.           
-000215d0: 2020 2020 2020 2020 206c 696e 655f 696e           line_in
-000215e0: 7465 7273 6563 7469 6f6e 735b 6c69 6e65  tersections[line
-000215f0: 5f73 6567 6d65 6e74 5d2e 6170 7065 6e64  _segment].append
-00021600: 2828 696e 7465 7273 5b30 5d2c 2070 7269  ((inters[0], pri
-00021610: 6d29 290a 2020 2020 2020 2020 2020 2020  m)).            
-00021620: 2020 2020 2020 2020 696e 7465 725f 706f          inter_po
-00021630: 696e 7473 2e61 7070 656e 6428 696e 7465  ints.append(inte
-00021640: 7273 5b30 5d29 0a20 2020 2020 2020 2020  rs[0]).         
-00021650: 2020 2020 2020 2065 6c69 6620 6c69 6e65         elif line
-00021660: 5f73 6567 6d65 6e74 2e70 6f69 6e74 5f62  _segment.point_b
-00021670: 656c 6f6e 6773 2870 7269 6d2e 7374 6172  elongs(prim.star
-00021680: 742c 2031 652d 3729 3a0a 2020 2020 2020  t, 1e-7):.      
-00021690: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000216a0: 2070 7269 6d2e 7374 6172 7420 6e6f 7420   prim.start not 
-000216b0: 696e 2069 6e74 6572 5f70 6f69 6e74 733a  in inter_points:
-000216c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000216d0: 2020 2020 2020 2020 206c 696e 655f 696e           line_in
-000216e0: 7465 7273 6563 7469 6f6e 735b 6c69 6e65  tersections[line
-000216f0: 5f73 6567 6d65 6e74 5d2e 6170 7065 6e64  _segment].append
-00021700: 2828 7072 696d 2e73 7461 7274 2c20 7072  ((prim.start, pr
-00021710: 696d 2929 0a20 2020 2020 2020 2020 2020  im)).           
-00021720: 2020 2020 2020 2020 2020 2020 2069 6e74               int
-00021730: 6572 5f70 6f69 6e74 732e 6170 7065 6e64  er_points.append
-00021740: 2870 7269 6d2e 7374 6172 7429 0a20 2020  (prim.start).   
-00021750: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00021760: 6620 6c69 6e65 5f73 6567 6d65 6e74 2e70  f line_segment.p
-00021770: 6f69 6e74 5f62 656c 6f6e 6773 2870 7269  oint_belongs(pri
-00021780: 6d2e 656e 642c 2031 652d 3729 3a0a 2020  m.end, 1e-7):.  
-00021790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000217a0: 2020 6966 2070 7269 6d2e 656e 6420 6e6f    if prim.end no
-000217b0: 7420 696e 2069 6e74 6572 5f70 6f69 6e74  t in inter_point
-000217c0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-000217d0: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-000217e0: 696e 7465 7273 6563 7469 6f6e 735b 6c69  intersections[li
-000217f0: 6e65 5f73 6567 6d65 6e74 5d2e 6170 7065  ne_segment].appe
-00021800: 6e64 2828 7072 696d 2e65 6e64 2c20 7072  nd((prim.end, pr
-00021810: 696d 2929 0a20 2020 2020 2020 2020 2020  im)).           
-00021820: 2020 2020 2020 2020 2020 2020 2069 6e74               int
-00021830: 6572 5f70 6f69 6e74 732e 6170 7065 6e64  er_points.append
-00021840: 2870 7269 6d2e 656e 6429 0a20 2020 2020  (prim.end).     
-00021850: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00021860: 7072 696d 2e70 6f69 6e74 5f62 656c 6f6e  prim.point_belon
-00021870: 6773 286d 6964 646c 655f 706f 696e 742c  gs(middle_point,
-00021880: 2031 652d 3729 3a0a 2020 2020 2020 2020   1e-7):.        
-00021890: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-000218a0: 5f69 6e74 6572 7365 6374 696f 6e73 5b6c  _intersections[l
-000218b0: 696e 655f 7365 676d 656e 745d 2e61 7070  ine_segment].app
-000218c0: 656e 6428 2870 7269 6d2e 6d69 6464 6c65  end((prim.middle
-000218d0: 5f70 6f69 6e74 2829 2c20 7072 696d 2929  _point(), prim))
-000218e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000218f0: 2020 2020 2069 6e74 6572 5f70 6f69 6e74       inter_point
-00021900: 732e 6170 7065 6e64 2870 7269 6d2e 6d69  s.append(prim.mi
-00021910: 6464 6c65 5f70 6f69 6e74 2829 290a 2020  ddle_point()).  
-00021920: 2020 2020 2020 7265 7475 726e 206c 696e        return lin
-00021930: 655f 696e 7465 7273 6563 7469 6f6e 730a  e_intersections.
-00021940: 0a20 2020 2064 6566 2073 656c 6563 745f  .    def select_
-00021950: 6661 7274 6865 7374 5f73 6577 696e 675f  farthest_sewing_
-00021960: 636c 6f73 696e 675f 706f 696e 7428 7365  closing_point(se
-00021970: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00021540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021550: 2020 706f 6c79 676f 6e5f 7072 696d 6974    polygon_primit
+00021560: 6976 6529 202b 2031 3a5d 3a0a 2020 2020  ive) + 1:]:.    
+00021570: 2020 2020 2020 2020 2020 2020 696e 7465              inte
+00021580: 7273 203d 2070 7269 6d2e 6c69 6e65 7365  rs = prim.linese
+00021590: 676d 656e 745f 696e 7465 7273 6563 7469  gment_intersecti
+000215a0: 6f6e 7328 6c69 6e65 5f73 6567 6d65 6e74  ons(line_segment
+000215b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000215c0: 2020 6966 2069 6e74 6572 733a 0a20 2020    if inters:.   
+000215d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000215e0: 206c 696e 655f 696e 7465 7273 6563 7469   line_intersecti
+000215f0: 6f6e 735b 6c69 6e65 5f73 6567 6d65 6e74  ons[line_segment
+00021600: 5d2e 6170 7065 6e64 2828 696e 7465 7273  ].append((inters
+00021610: 5b30 5d2c 2070 7269 6d29 290a 2020 2020  [0], prim)).    
+00021620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021630: 696e 7465 725f 706f 696e 7473 2e61 7070  inter_points.app
+00021640: 656e 6428 696e 7465 7273 5b30 5d29 0a20  end(inters[0]). 
+00021650: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00021660: 6c69 6620 6c69 6e65 5f73 6567 6d65 6e74  lif line_segment
+00021670: 2e70 6f69 6e74 5f62 656c 6f6e 6773 2870  .point_belongs(p
+00021680: 7269 6d2e 7374 6172 742c 2031 652d 3729  rim.start, 1e-7)
+00021690: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000216a0: 2020 2020 2020 6966 2070 7269 6d2e 7374        if prim.st
+000216b0: 6172 7420 6e6f 7420 696e 2069 6e74 6572  art not in inter
+000216c0: 5f70 6f69 6e74 733a 0a20 2020 2020 2020  _points:.       
+000216d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000216e0: 206c 696e 655f 696e 7465 7273 6563 7469   line_intersecti
+000216f0: 6f6e 735b 6c69 6e65 5f73 6567 6d65 6e74  ons[line_segment
+00021700: 5d2e 6170 7065 6e64 2828 7072 696d 2e73  ].append((prim.s
+00021710: 7461 7274 2c20 7072 696d 2929 0a20 2020  tart, prim)).   
+00021720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021730: 2020 2020 2069 6e74 6572 5f70 6f69 6e74       inter_point
+00021740: 732e 6170 7065 6e64 2870 7269 6d2e 7374  s.append(prim.st
+00021750: 6172 7429 0a20 2020 2020 2020 2020 2020  art).           
+00021760: 2020 2020 2065 6c69 6620 6c69 6e65 5f73       elif line_s
+00021770: 6567 6d65 6e74 2e70 6f69 6e74 5f62 656c  egment.point_bel
+00021780: 6f6e 6773 2870 7269 6d2e 656e 642c 2031  ongs(prim.end, 1
+00021790: 652d 3729 3a0a 2020 2020 2020 2020 2020  e-7):.          
+000217a0: 2020 2020 2020 2020 2020 6966 2070 7269            if pri
+000217b0: 6d2e 656e 6420 6e6f 7420 696e 2069 6e74  m.end not in int
+000217c0: 6572 5f70 6f69 6e74 733a 0a20 2020 2020  er_points:.     
+000217d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000217e0: 2020 206c 696e 655f 696e 7465 7273 6563     line_intersec
+000217f0: 7469 6f6e 735b 6c69 6e65 5f73 6567 6d65  tions[line_segme
+00021800: 6e74 5d2e 6170 7065 6e64 2828 7072 696d  nt].append((prim
+00021810: 2e65 6e64 2c20 7072 696d 2929 0a20 2020  .end, prim)).   
+00021820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021830: 2020 2020 2069 6e74 6572 5f70 6f69 6e74       inter_point
+00021840: 732e 6170 7065 6e64 2870 7269 6d2e 656e  s.append(prim.en
+00021850: 6429 0a20 2020 2020 2020 2020 2020 2020  d).             
+00021860: 2020 2065 6c69 6620 7072 696d 2e70 6f69     elif prim.poi
+00021870: 6e74 5f62 656c 6f6e 6773 286d 6964 646c  nt_belongs(middl
+00021880: 655f 706f 696e 742c 2031 652d 3729 3a0a  e_point, 1e-7):.
+00021890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000218a0: 2020 2020 6c69 6e65 5f69 6e74 6572 7365      line_interse
+000218b0: 6374 696f 6e73 5b6c 696e 655f 7365 676d  ctions[line_segm
+000218c0: 656e 745d 2e61 7070 656e 6428 2870 7269  ent].append((pri
+000218d0: 6d2e 6d69 6464 6c65 5f70 6f69 6e74 2829  m.middle_point()
+000218e0: 2c20 7072 696d 2929 0a20 2020 2020 2020  , prim)).       
+000218f0: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+00021900: 6572 5f70 6f69 6e74 732e 6170 7065 6e64  er_points.append
+00021910: 2870 7269 6d2e 6d69 6464 6c65 5f70 6f69  (prim.middle_poi
+00021920: 6e74 2829 290a 2020 2020 2020 2020 7265  nt()).        re
+00021930: 7475 726e 206c 696e 655f 696e 7465 7273  turn line_inters
+00021940: 6563 7469 6f6e 730a 0a20 2020 2064 6566  ections..    def
+00021950: 2073 656c 6563 745f 6661 7274 6865 7374   select_farthest
+00021960: 5f73 6577 696e 675f 636c 6f73 696e 675f  _sewing_closing_
+00021970: 706f 696e 7428 7365 6c66 2c0a 2020 2020  point(self,.    
 00021980: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000219a0: 206c 696e 655f 7365 676d 656e 743a 2076   line_segment: v
-000219b0: 6f6c 6d64 6c72 2e65 6467 6573 2e4c 696e  olmdlr.edges.Lin
-000219c0: 6553 6567 6d65 6e74 3244 2c0a 2020 2020  eSegment2D,.    
-000219d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219a0: 2020 2020 2020 2020 206c 696e 655f 7365           line_se
+000219b0: 676d 656e 743a 2076 6f6c 6d64 6c72 2e65  gment: volmdlr.e
+000219c0: 6467 6573 2e4c 696e 6553 6567 6d65 6e74  dges.LineSegment
+000219d0: 3244 2c0a 2020 2020 2020 2020 2020 2020  2D,.            
 000219e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000219f0: 2020 2020 2020 2020 2070 6f6c 7967 6f6e           polygon
-00021a00: 5f70 7269 6d69 7469 7665 2c0a 2020 2020  _primitive,.    
-00021a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021a00: 2070 6f6c 7967 6f6e 5f70 7269 6d69 7469   polygon_primiti
+00021a10: 7665 2c0a 2020 2020 2020 2020 2020 2020  ve,.            
 00021a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021a30: 2020 2020 2020 2020 2070 6f73 7369 626c           possibl
-00021a40: 655f 636c 6f73 696e 675f 706f 696e 7473  e_closing_points
-00021a50: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00021a60: 2020 2020 2020 2053 6561 7263 6865 7320         Searches 
-00021a70: 7468 6520 636c 6f73 6573 7420 7365 7769  the closest sewi
-00021a80: 6e67 2063 6c6f 7369 6e67 2070 6f69 6e74  ng closing point
-00021a90: 2061 7661 696c 6162 6c65 0a20 2020 2020   available.     
-00021aa0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-00021ab0: 6c6f 7369 6e67 5f70 6f69 6e74 203d 2076  losing_point = v
-00021ac0: 6f6c 6d64 6c72 2e4f 3244 0a20 2020 2020  olmdlr.O2D.     
-00021ad0: 2020 206d 6964 646c 655f 706f 696e 7420     middle_point 
-00021ae0: 3d20 706f 6c79 676f 6e5f 7072 696d 6974  = polygon_primit
-00021af0: 6976 652e 6d69 6464 6c65 5f70 6f69 6e74  ive.middle_point
-00021b00: 2829 0a20 2020 2020 2020 2064 6973 7461  ().        dista
-00021b10: 6e63 6520 3d20 300a 2020 2020 2020 2020  nce = 0.        
-00021b20: 666f 7220 696e 7472 5f6c 6973 7420 696e  for intr_list in
-00021b30: 2070 6f73 7369 626c 655f 636c 6f73 696e   possible_closin
-00021b40: 675f 706f 696e 7473 3a0a 2020 2020 2020  g_points:.      
-00021b50: 2020 2020 2020 6966 2069 6e74 725f 6c69        if intr_li
-00021b60: 7374 5b31 5d20 6e6f 7420 696e 2073 656c  st[1] not in sel
-00021b70: 662e 6c69 6e65 5f73 6567 6d65 6e74 733a  f.line_segments:
-00021b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021b90: 2064 6973 7420 3d20 696e 7472 5f6c 6973   dist = intr_lis
-00021ba0: 745b 305d 2e70 6f69 6e74 5f64 6973 7461  t[0].point_dista
-00021bb0: 6e63 6528 6c69 6e65 5f73 6567 6d65 6e74  nce(line_segment
-00021bc0: 2e73 7461 7274 290a 2020 2020 2020 2020  .start).        
-00021bd0: 2020 2020 2020 2020 6966 2064 6973 7420          if dist 
-00021be0: 3e20 6469 7374 616e 6365 3a0a 2020 2020  > distance:.    
-00021bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c00: 6469 7374 616e 6365 203d 2064 6973 740a  distance = dist.
-00021c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c20: 2020 2020 636c 6f73 696e 675f 706f 696e      closing_poin
-00021c30: 7420 3d20 2869 6e74 725f 6c69 7374 5b31  t = (intr_list[1
-00021c40: 5d2e 7374 6172 7420 6966 0a20 2020 2020  ].start if.     
-00021c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021a40: 2070 6f73 7369 626c 655f 636c 6f73 696e   possible_closin
+00021a50: 675f 706f 696e 7473 293a 0a20 2020 2020  g_points):.     
+00021a60: 2020 2022 2222 0a20 2020 2020 2020 2053     """.        S
+00021a70: 6561 7263 6865 7320 7468 6520 636c 6f73  earches the clos
+00021a80: 6573 7420 7365 7769 6e67 2063 6c6f 7369  est sewing closi
+00021a90: 6e67 2070 6f69 6e74 2061 7661 696c 6162  ng point availab
+00021aa0: 6c65 0a20 2020 2020 2020 2022 2222 0a20  le.        """. 
+00021ab0: 2020 2020 2020 2063 6c6f 7369 6e67 5f70         closing_p
+00021ac0: 6f69 6e74 203d 2076 6f6c 6d64 6c72 2e4f  oint = volmdlr.O
+00021ad0: 3244 0a20 2020 2020 2020 206d 6964 646c  2D.        middl
+00021ae0: 655f 706f 696e 7420 3d20 706f 6c79 676f  e_point = polygo
+00021af0: 6e5f 7072 696d 6974 6976 652e 6d69 6464  n_primitive.midd
+00021b00: 6c65 5f70 6f69 6e74 2829 0a20 2020 2020  le_point().     
+00021b10: 2020 2064 6973 7461 6e63 6520 3d20 300a     distance = 0.
+00021b20: 2020 2020 2020 2020 666f 7220 696e 7472          for intr
+00021b30: 5f6c 6973 7420 696e 2070 6f73 7369 626c  _list in possibl
+00021b40: 655f 636c 6f73 696e 675f 706f 696e 7473  e_closing_points
+00021b50: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00021b60: 2069 6e74 725f 6c69 7374 5b31 5d20 6e6f   intr_list[1] no
+00021b70: 7420 696e 2073 656c 662e 6c69 6e65 5f73  t in self.line_s
+00021b80: 6567 6d65 6e74 733a 0a20 2020 2020 2020  egments:.       
+00021b90: 2020 2020 2020 2020 2064 6973 7420 3d20           dist = 
+00021ba0: 696e 7472 5f6c 6973 745b 305d 2e70 6f69  intr_list[0].poi
+00021bb0: 6e74 5f64 6973 7461 6e63 6528 6c69 6e65  nt_distance(line
+00021bc0: 5f73 6567 6d65 6e74 2e73 7461 7274 290a  _segment.start).
+00021bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021be0: 6966 2064 6973 7420 3e20 6469 7374 616e  if dist > distan
+00021bf0: 6365 3a0a 2020 2020 2020 2020 2020 2020  ce:.            
+00021c00: 2020 2020 2020 2020 6469 7374 616e 6365          distance
+00021c10: 203d 2064 6973 740a 2020 2020 2020 2020   = dist.        
+00021c20: 2020 2020 2020 2020 2020 2020 636c 6f73              clos
+00021c30: 696e 675f 706f 696e 7420 3d20 2869 6e74  ing_point = (int
+00021c40: 725f 6c69 7374 5b31 5d2e 7374 6172 7420  r_list[1].start 
+00021c50: 6966 0a20 2020 2020 2020 2020 2020 2020  if.             
 00021c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c70: 696e 7472 5f6c 6973 745b 305d 2e70 6f69  intr_list[0].poi
-00021c80: 6e74 5f64 6973 7461 6e63 6528 0a20 2020  nt_distance(.   
-00021c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021c70: 2020 2020 2020 2020 696e 7472 5f6c 6973          intr_lis
+00021c80: 745b 305d 2e70 6f69 6e74 5f64 6973 7461  t[0].point_dista
+00021c90: 6e63 6528 0a20 2020 2020 2020 2020 2020  nce(.           
 00021ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021cb0: 2020 2020 2020 696e 7472 5f6c 6973 745b        intr_list[
-00021cc0: 315d 2e73 7461 7274 2920 3c0a 2020 2020  1].start) <.    
-00021cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021cb0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00021cc0: 7472 5f6c 6973 745b 315d 2e73 7461 7274  tr_list[1].start
+00021cd0: 2920 3c0a 2020 2020 2020 2020 2020 2020  ) <.            
 00021ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021cf0: 2069 6e74 725f 6c69 7374 5b30 5d2e 706f   intr_list[0].po
-00021d00: 696e 745f 6469 7374 616e 6365 280a 2020  int_distance(.  
-00021d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021cf0: 2020 2020 2020 2020 2069 6e74 725f 6c69           intr_li
+00021d00: 7374 5b30 5d2e 706f 696e 745f 6469 7374  st[0].point_dist
+00021d10: 616e 6365 280a 2020 2020 2020 2020 2020  ance(.          
 00021d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d30: 2020 2020 2020 2069 6e74 725f 6c69 7374         intr_list
-00021d40: 5b31 5d2e 656e 6429 2065 6c73 650a 2020  [1].end) else.  
-00021d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021d30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00021d40: 6e74 725f 6c69 7374 5b31 5d2e 656e 6429  ntr_list[1].end)
+00021d50: 2065 6c73 650a 2020 2020 2020 2020 2020   else.          
 00021d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d70: 2020 2069 6e74 725f 6c69 7374 5b31 5d2e     intr_list[1].
-00021d80: 656e 6429 0a0a 2020 2020 2020 2020 2020  end)..          
-00021d90: 2020 656c 6966 2069 6e74 725f 6c69 7374    elif intr_list
-00021da0: 5b30 5d20 3d3d 206d 6964 646c 655f 706f  [0] == middle_po
-00021db0: 696e 7420 616e 6420 5c0a 2020 2020 2020  int and \.      
-00021dc0: 2020 2020 2020 2020 2020 2020 2020 706f                po
-00021dd0: 6c79 676f 6e5f 7072 696d 6974 6976 652e  lygon_primitive.
-00021de0: 6c65 6e67 7468 2829 203d 3d20 696e 7472  length() == intr
-00021df0: 5f6c 6973 745b 315d 2e6c 656e 6774 6828  _list[1].length(
-00021e00: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00021e10: 2020 2063 6c6f 7369 6e67 5f70 6f69 6e74     closing_point
-00021e20: 203d 2069 6e74 725f 6c69 7374 5b31 5d2e   = intr_list[1].
-00021e30: 7374 6172 740a 2020 2020 2020 2020 2020  start.          
-00021e40: 2020 2020 2020 6469 7374 616e 6365 203d        distance =
-00021e50: 2030 0a0a 2020 2020 2020 2020 7265 7475   0..        retu
-00021e60: 726e 2063 6c6f 7369 6e67 5f70 6f69 6e74  rn closing_point
-00021e70: 0a0a 2020 2020 6465 6620 7365 6c65 6374  ..    def select
-00021e80: 5f63 6c6f 7365 7374 5f73 6577 696e 675f  _closest_sewing_
-00021e90: 636c 6f73 696e 675f 706f 696e 7428 7365  closing_point(se
-00021ea0: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00021d70: 2020 2020 2020 2020 2020 2069 6e74 725f             intr_
+00021d80: 6c69 7374 5b31 5d2e 656e 6429 0a0a 2020  list[1].end)..  
+00021d90: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+00021da0: 6e74 725f 6c69 7374 5b30 5d20 3d3d 206d  ntr_list[0] == m
+00021db0: 6964 646c 655f 706f 696e 7420 616e 6420  iddle_point and 
+00021dc0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+00021dd0: 2020 2020 2020 706f 6c79 676f 6e5f 7072        polygon_pr
+00021de0: 696d 6974 6976 652e 6c65 6e67 7468 2829  imitive.length()
+00021df0: 203d 3d20 696e 7472 5f6c 6973 745b 315d   == intr_list[1]
+00021e00: 2e6c 656e 6774 6828 293a 0a20 2020 2020  .length():.     
+00021e10: 2020 2020 2020 2020 2020 2063 6c6f 7369             closi
+00021e20: 6e67 5f70 6f69 6e74 203d 2069 6e74 725f  ng_point = intr_
+00021e30: 6c69 7374 5b31 5d2e 7374 6172 740a 2020  list[1].start.  
+00021e40: 2020 2020 2020 2020 2020 2020 2020 6469                di
+00021e50: 7374 616e 6365 203d 2030 0a0a 2020 2020  stance = 0..    
+00021e60: 2020 2020 7265 7475 726e 2063 6c6f 7369      return closi
+00021e70: 6e67 5f70 6f69 6e74 0a0a 2020 2020 6465  ng_point..    de
+00021e80: 6620 7365 6c65 6374 5f63 6c6f 7365 7374  f select_closest
+00021e90: 5f73 6577 696e 675f 636c 6f73 696e 675f  _sewing_closing_
+00021ea0: 706f 696e 7428 7365 6c66 2c0a 2020 2020  point(self,.    
 00021eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ed0: 6c69 6e65 5f73 6567 6d65 6e74 3a20 766f  line_segment: vo
-00021ee0: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
-00021ef0: 5365 676d 656e 7432 442c 0a20 2020 2020  Segment2D,.     
-00021f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ed0: 2020 2020 2020 2020 6c69 6e65 5f73 6567          line_seg
+00021ee0: 6d65 6e74 3a20 766f 6c6d 646c 722e 6564  ment: volmdlr.ed
+00021ef0: 6765 732e 4c69 6e65 5365 676d 656e 7432  ges.LineSegment2
+00021f00: 442c 0a20 2020 2020 2020 2020 2020 2020  D,.             
 00021f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021f20: 2020 2020 2020 2070 6f6c 7967 6f6e 5f70         polygon_p
-00021f30: 7269 6d69 7469 7665 2c0a 2020 2020 2020  rimitive,.      
-00021f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021f20: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00021f30: 6f6c 7967 6f6e 5f70 7269 6d69 7469 7665  olygon_primitive
+00021f40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 00021f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021f60: 2020 2020 2020 706f 7373 6962 6c65 5f63        possible_c
-00021f70: 6c6f 7369 6e67 5f70 6f69 6e74 7329 3a0a  losing_points):.
-00021f80: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00021f90: 2020 2020 5365 6172 6368 6573 2074 6865      Searches the
-00021fa0: 2063 6c6f 7365 7374 2073 6577 696e 6720   closest sewing 
-00021fb0: 636c 6f73 696e 6720 706f 696e 7420 6176  closing point av
-00021fc0: 6169 6c61 626c 650a 2020 2020 2020 2020  ailable.        
-00021fd0: 2222 220a 2020 2020 2020 2020 636c 6f73  """.        clos
-00021fe0: 696e 675f 706f 696e 7420 3d20 766f 6c6d  ing_point = volm
-00021ff0: 646c 722e 4f32 440a 2020 2020 2020 2020  dlr.O2D.        
-00022000: 6d69 6464 6c65 5f70 6f69 6e74 203d 2070  middle_point = p
-00022010: 6f6c 7967 6f6e 5f70 7269 6d69 7469 7665  olygon_primitive
-00022020: 2e6d 6964 646c 655f 706f 696e 7428 290a  .middle_point().
-00022030: 2020 2020 2020 2020 6469 7374 616e 6365          distance
-00022040: 203d 206d 6174 682e 696e 660a 2020 2020   = math.inf.    
-00022050: 2020 2020 666f 7220 696e 7472 5f6c 6973      for intr_lis
-00022060: 7420 696e 2070 6f73 7369 626c 655f 636c  t in possible_cl
-00022070: 6f73 696e 675f 706f 696e 7473 3a0a 2020  osing_points:.  
-00022080: 2020 2020 2020 2020 2020 6966 2069 6e74            if int
-00022090: 725f 6c69 7374 5b31 5d20 6e6f 7420 696e  r_list[1] not in
-000220a0: 2073 656c 662e 6c69 6e65 5f73 6567 6d65   self.line_segme
-000220b0: 6e74 733a 0a20 2020 2020 2020 2020 2020  nts:.           
-000220c0: 2020 2020 2064 6973 7420 3d20 696e 7472       dist = intr
-000220d0: 5f6c 6973 745b 305d 2e70 6f69 6e74 5f64  _list[0].point_d
-000220e0: 6973 7461 6e63 6528 6c69 6e65 5f73 6567  istance(line_seg
-000220f0: 6d65 6e74 2e73 7461 7274 290a 2020 2020  ment.start).    
-00022100: 2020 2020 2020 2020 2020 2020 6966 2064              if d
-00022110: 6973 7420 3c20 6469 7374 616e 6365 3a0a  ist < distance:.
-00022120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022130: 2020 2020 6469 7374 616e 6365 203d 2064      distance = d
-00022140: 6973 740a 2020 2020 2020 2020 2020 2020  ist.            
-00022150: 2020 2020 2020 2020 636c 6f73 696e 675f          closing_
-00022160: 706f 696e 7420 3d20 2869 6e74 725f 6c69  point = (intr_li
-00022170: 7374 5b31 5d2e 7374 6172 7420 6966 0a20  st[1].start if. 
-00022180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021f60: 2020 2020 2020 2020 2020 2020 2020 706f                po
+00021f70: 7373 6962 6c65 5f63 6c6f 7369 6e67 5f70  ssible_closing_p
+00021f80: 6f69 6e74 7329 3a0a 2020 2020 2020 2020  oints):.        
+00021f90: 2222 220a 2020 2020 2020 2020 5365 6172  """.        Sear
+00021fa0: 6368 6573 2074 6865 2063 6c6f 7365 7374  ches the closest
+00021fb0: 2073 6577 696e 6720 636c 6f73 696e 6720   sewing closing 
+00021fc0: 706f 696e 7420 6176 6169 6c61 626c 650a  point available.
+00021fd0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00021fe0: 2020 2020 636c 6f73 696e 675f 706f 696e      closing_poin
+00021ff0: 7420 3d20 766f 6c6d 646c 722e 4f32 440a  t = volmdlr.O2D.
+00022000: 2020 2020 2020 2020 6d69 6464 6c65 5f70          middle_p
+00022010: 6f69 6e74 203d 2070 6f6c 7967 6f6e 5f70  oint = polygon_p
+00022020: 7269 6d69 7469 7665 2e6d 6964 646c 655f  rimitive.middle_
+00022030: 706f 696e 7428 290a 2020 2020 2020 2020  point().        
+00022040: 6469 7374 616e 6365 203d 206d 6174 682e  distance = math.
+00022050: 696e 660a 2020 2020 2020 2020 666f 7220  inf.        for 
+00022060: 696e 7472 5f6c 6973 7420 696e 2070 6f73  intr_list in pos
+00022070: 7369 626c 655f 636c 6f73 696e 675f 706f  sible_closing_po
+00022080: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
+00022090: 2020 6966 2069 6e74 725f 6c69 7374 5b31    if intr_list[1
+000220a0: 5d20 6e6f 7420 696e 2073 656c 662e 6c69  ] not in self.li
+000220b0: 6e65 5f73 6567 6d65 6e74 733a 0a20 2020  ne_segments:.   
+000220c0: 2020 2020 2020 2020 2020 2020 2064 6973               dis
+000220d0: 7420 3d20 696e 7472 5f6c 6973 745b 305d  t = intr_list[0]
+000220e0: 2e70 6f69 6e74 5f64 6973 7461 6e63 6528  .point_distance(
+000220f0: 6c69 6e65 5f73 6567 6d65 6e74 2e73 7461  line_segment.sta
+00022100: 7274 290a 2020 2020 2020 2020 2020 2020  rt).            
+00022110: 2020 2020 6966 2064 6973 7420 3c20 6469      if dist < di
+00022120: 7374 616e 6365 3a0a 2020 2020 2020 2020  stance:.        
+00022130: 2020 2020 2020 2020 2020 2020 6469 7374              dist
+00022140: 616e 6365 203d 2064 6973 740a 2020 2020  ance = dist.    
+00022150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022160: 636c 6f73 696e 675f 706f 696e 7420 3d20  closing_point = 
+00022170: 2869 6e74 725f 6c69 7374 5b31 5d2e 7374  (intr_list[1].st
+00022180: 6172 7420 6966 0a20 2020 2020 2020 2020  art if.         
 00022190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000221a0: 2020 2020 696e 7472 5f6c 6973 745b 305d      intr_list[0]
-000221b0: 2e70 6f69 6e74 5f64 6973 7461 6e63 6528  .point_distance(
-000221c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000221a0: 2020 2020 2020 2020 2020 2020 696e 7472              intr
+000221b0: 5f6c 6973 745b 305d 2e70 6f69 6e74 5f64  _list[0].point_d
+000221c0: 6973 7461 6e63 6528 0a20 2020 2020 2020  istance(.       
 000221d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000221e0: 2020 2020 2020 2020 2020 696e 7472 5f6c            intr_l
-000221f0: 6973 745b 315d 2e73 7461 7274 2920 3c0a  ist[1].start) <.
-00022200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000221e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000221f0: 2020 696e 7472 5f6c 6973 745b 315d 2e73    intr_list[1].s
+00022200: 7461 7274 2920 3c0a 2020 2020 2020 2020  tart) <.        
 00022210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022220: 2020 2020 2069 6e74 725f 6c69 7374 5b30       intr_list[0
-00022230: 5d2e 706f 696e 745f 6469 7374 616e 6365  ].point_distance
-00022240: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00022220: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+00022230: 725f 6c69 7374 5b30 5d2e 706f 696e 745f  r_list[0].point_
+00022240: 6469 7374 616e 6365 280a 2020 2020 2020  distance(.      
 00022250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022260: 2020 2020 2020 2020 2020 2069 6e74 725f             intr_
-00022270: 6c69 7374 5b31 5d2e 656e 6429 2065 6c73  list[1].end) els
-00022280: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00022260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022270: 2020 2069 6e74 725f 6c69 7374 5b31 5d2e     intr_list[1].
+00022280: 656e 6429 2065 6c73 650a 2020 2020 2020  end) else.      
 00022290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000222a0: 2020 2020 2020 2069 6e74 725f 6c69 7374         intr_list
-000222b0: 5b31 5d2e 656e 6429 0a0a 2020 2020 2020  [1].end)..      
-000222c0: 2020 2020 2020 656c 6966 2069 6e74 725f        elif intr_
-000222d0: 6c69 7374 5b30 5d20 3d3d 206d 6964 646c  list[0] == middl
-000222e0: 655f 706f 696e 7420 616e 6420 5c0a 2020  e_point and \.  
-000222f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022300: 2020 706f 6c79 676f 6e5f 7072 696d 6974    polygon_primit
-00022310: 6976 652e 6c65 6e67 7468 2829 203d 3d20  ive.length() == 
-00022320: 696e 7472 5f6c 6973 745b 315d 2e6c 656e  intr_list[1].len
-00022330: 6774 6828 293a 0a20 2020 2020 2020 2020  gth():.         
-00022340: 2020 2020 2020 2063 6c6f 7369 6e67 5f70         closing_p
-00022350: 6f69 6e74 203d 2069 6e74 725f 6c69 7374  oint = intr_list
-00022360: 5b31 5d2e 7374 6172 740a 2020 2020 2020  [1].start.      
-00022370: 2020 2020 2020 2020 2020 6469 7374 616e            distan
-00022380: 6365 203d 2030 0a0a 2020 2020 2020 2020  ce = 0..        
-00022390: 7265 7475 726e 2063 6c6f 7369 6e67 5f70  return closing_p
-000223a0: 6f69 6e74 0a0a 2020 2020 6465 6620 7365  oint..    def se
-000223b0: 6172 6368 5f66 6172 7468 6573 7428 7365  arch_farthest(se
-000223c0: 6c66 2c20 696e 7465 7273 6574 696e 675f  lf, interseting_
-000223d0: 706f 696e 742c 2070 6f73 7369 626c 655f  point, possible_
-000223e0: 636c 6f73 696e 675f 706f 696e 7473 293a  closing_points):
-000223f0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00022400: 2020 2020 2057 6869 6c65 2053 6577 696e       While Sewin
-00022410: 6720 7477 6f20 506f 6c79 676f 6e73 2c20  g two Polygons, 
-00022420: 616e 6420 7365 6172 6368 696e 6720 6120  and searching a 
-00022430: 6661 6365 5c27 7320 636c 6f73 696e 6720  face\'s closing 
-00022440: 706f 696e 742c 2074 6869 730a 2020 2020  point, this.    
-00022450: 2020 2020 6d65 7468 6f64 2076 6572 6966      method verif
-00022460: 6965 7320 6974 2063 686f 6f73 6573 2074  ies it chooses t
-00022470: 6865 2063 6c6f 7365 7374 206f 6620 7468  he closest of th
-00022480: 6520 6661 7274 6865 7374 2061 7661 696c  e farthest avail
-00022490: 6162 6c65 0a20 2020 2020 2020 203a 7265  able.        :re
-000224a0: 7475 726e 3a20 5472 7565 2069 6620 746f  turn: True if to
-000224b0: 2073 6561 7263 6820 7468 6520 6661 7274   search the fart
-000224c0: 6865 7374 206f 6620 4661 6c73 6520 6966  hest of False if
-000224d0: 206e 6f74 0a20 2020 2020 2020 2022 2222   not.        """
-000224e0: 0a20 2020 2020 2020 2064 6973 7461 6e63  .        distanc
-000224f0: 6520 3d20 6d61 7468 2e69 6e66 0a20 2020  e = math.inf.   
-00022500: 2020 2020 2074 6172 6765 745f 7072 696d       target_prim
-00022510: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00022520: 666f 7220 696e 7465 7273 6563 7469 6f6e  for intersection
-00022530: 5f70 6f69 6e74 2c20 7072 696d 2069 6e20  _point, prim in 
-00022540: 706f 7373 6962 6c65 5f63 6c6f 7369 6e67  possible_closing
-00022550: 5f70 6f69 6e74 733a 0a20 2020 2020 2020  _points:.       
-00022560: 2020 2020 2064 6973 7420 3d20 696e 7465       dist = inte
-00022570: 7273 6574 696e 675f 706f 696e 742e 706f  rseting_point.po
-00022580: 696e 745f 6469 7374 616e 6365 2869 6e74  int_distance(int
-00022590: 6572 7365 6374 696f 6e5f 706f 696e 7429  ersection_point)
-000225a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000225b0: 6469 7374 203c 2064 6973 7461 6e63 653a  dist < distance:
-000225c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000225d0: 2064 6973 7461 6e63 6520 3d20 6469 7374   distance = dist
-000225e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000225f0: 2074 6172 6765 745f 7072 696d 203d 2070   target_prim = p
-00022600: 7269 6d0a 2020 2020 2020 2020 6966 2074  rim.        if t
-00022610: 6172 6765 745f 7072 696d 2069 6e20 7365  arget_prim in se
-00022620: 6c66 2e6c 696e 655f 7365 676d 656e 7473  lf.line_segments
-00022630: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00022640: 7475 726e 2054 7275 650a 2020 2020 2020  turn True.      
-00022650: 2020 7265 7475 726e 2046 616c 7365 0a0a    return False..
-00022660: 2020 2020 6465 6620 6765 745f 636c 6f73      def get_clos
-00022670: 696e 675f 706f 696e 7428 7365 6c66 2c20  ing_point(self, 
-00022680: 706f 6c79 676f 6e32 5f32 642c 2070 7269  polygon2_2d, pri
-00022690: 6d69 7469 7665 2c20 6178 3d4e 6f6e 6529  mitive, ax=None)
-000226a0: 3a0a 2020 2020 2020 2020 2222 2247 6574  :.        """Get
-000226b0: 7320 7365 7769 6e67 2063 6c6f 7369 6e67  s sewing closing
-000226c0: 2070 6f69 6e74 7320 666f 7220 6769 7665   points for give
-000226d0: 6e20 7072 696d 6974 6976 6520 706f 696e  n primitive poin
-000226e0: 7473 2222 220a 2020 2020 2020 2020 636c  ts""".        cl
-000226f0: 6f73 696e 675f 706f 696e 7420 3d20 766f  osing_point = vo
-00022700: 6c6d 646c 722e 4f32 440a 2020 2020 2020  lmdlr.O2D.      
-00022710: 2020 6d69 6464 6c65 5f70 6f69 6e74 203d    middle_point =
-00022720: 2070 7269 6d69 7469 7665 2e6d 6964 646c   primitive.middl
-00022730: 655f 706f 696e 7428 290a 0a20 2020 2020  e_point()..     
-00022740: 2020 206e 6f72 6d61 6c5f 7665 6374 6f72     normal_vector
-00022750: 203d 2070 7269 6d69 7469 7665 2e75 6e69   = primitive.uni
-00022760: 745f 6e6f 726d 616c 5f76 6563 746f 7228  t_normal_vector(
-00022770: 290a 2020 2020 2020 2020 6c69 6e65 5f73  ).        line_s
-00022780: 6567 6d65 6e74 3120 3d20 766f 6c6d 646c  egment1 = volmdl
-00022790: 722e 6564 6765 732e 4c69 6e65 5365 676d  r.edges.LineSegm
-000227a0: 656e 7432 4428 6d69 6464 6c65 5f70 6f69  ent2D(middle_poi
-000227b0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
+000222a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000222b0: 6e74 725f 6c69 7374 5b31 5d2e 656e 6429  ntr_list[1].end)
+000222c0: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+000222d0: 6966 2069 6e74 725f 6c69 7374 5b30 5d20  if intr_list[0] 
+000222e0: 3d3d 206d 6964 646c 655f 706f 696e 7420  == middle_point 
+000222f0: 616e 6420 5c0a 2020 2020 2020 2020 2020  and \.          
+00022300: 2020 2020 2020 2020 2020 706f 6c79 676f            polygo
+00022310: 6e5f 7072 696d 6974 6976 652e 6c65 6e67  n_primitive.leng
+00022320: 7468 2829 203d 3d20 696e 7472 5f6c 6973  th() == intr_lis
+00022330: 745b 315d 2e6c 656e 6774 6828 293a 0a20  t[1].length():. 
+00022340: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00022350: 6c6f 7369 6e67 5f70 6f69 6e74 203d 2069  losing_point = i
+00022360: 6e74 725f 6c69 7374 5b31 5d2e 7374 6172  ntr_list[1].star
+00022370: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+00022380: 2020 6469 7374 616e 6365 203d 2030 0a0a    distance = 0..
+00022390: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+000223a0: 6c6f 7369 6e67 5f70 6f69 6e74 0a0a 2020  losing_point..  
+000223b0: 2020 6465 6620 7365 6172 6368 5f66 6172    def search_far
+000223c0: 7468 6573 7428 7365 6c66 2c20 696e 7465  thest(self, inte
+000223d0: 7273 6574 696e 675f 706f 696e 742c 2070  rseting_point, p
+000223e0: 6f73 7369 626c 655f 636c 6f73 696e 675f  ossible_closing_
+000223f0: 706f 696e 7473 293a 0a20 2020 2020 2020  points):.       
+00022400: 2022 2222 0a20 2020 2020 2020 2057 6869   """.        Whi
+00022410: 6c65 2053 6577 696e 6720 7477 6f20 506f  le Sewing two Po
+00022420: 6c79 676f 6e73 2c20 616e 6420 7365 6172  lygons, and sear
+00022430: 6368 696e 6720 6120 6661 6365 5c27 7320  ching a face\'s 
+00022440: 636c 6f73 696e 6720 706f 696e 742c 2074  closing point, t
+00022450: 6869 730a 2020 2020 2020 2020 6d65 7468  his.        meth
+00022460: 6f64 2076 6572 6966 6965 7320 6974 2063  od verifies it c
+00022470: 686f 6f73 6573 2074 6865 2063 6c6f 7365  hooses the close
+00022480: 7374 206f 6620 7468 6520 6661 7274 6865  st of the farthe
+00022490: 7374 2061 7661 696c 6162 6c65 0a20 2020  st available.   
+000224a0: 2020 2020 203a 7265 7475 726e 3a20 5472       :return: Tr
+000224b0: 7565 2069 6620 746f 2073 6561 7263 6820  ue if to search 
+000224c0: 7468 6520 6661 7274 6865 7374 206f 6620  the farthest of 
+000224d0: 4661 6c73 6520 6966 206e 6f74 0a20 2020  False if not.   
+000224e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000224f0: 2064 6973 7461 6e63 6520 3d20 6d61 7468   distance = math
+00022500: 2e69 6e66 0a20 2020 2020 2020 2074 6172  .inf.        tar
+00022510: 6765 745f 7072 696d 203d 204e 6f6e 650a  get_prim = None.
+00022520: 2020 2020 2020 2020 666f 7220 696e 7465          for inte
+00022530: 7273 6563 7469 6f6e 5f70 6f69 6e74 2c20  rsection_point, 
+00022540: 7072 696d 2069 6e20 706f 7373 6962 6c65  prim in possible
+00022550: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 733a  _closing_points:
+00022560: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+00022570: 7420 3d20 696e 7465 7273 6574 696e 675f  t = interseting_
+00022580: 706f 696e 742e 706f 696e 745f 6469 7374  point.point_dist
+00022590: 616e 6365 2869 6e74 6572 7365 6374 696f  ance(intersectio
+000225a0: 6e5f 706f 696e 7429 0a20 2020 2020 2020  n_point).       
+000225b0: 2020 2020 2069 6620 6469 7374 203c 2064       if dist < d
+000225c0: 6973 7461 6e63 653a 0a20 2020 2020 2020  istance:.       
+000225d0: 2020 2020 2020 2020 2064 6973 7461 6e63           distanc
+000225e0: 6520 3d20 6469 7374 0a20 2020 2020 2020  e = dist.       
+000225f0: 2020 2020 2020 2020 2074 6172 6765 745f           target_
+00022600: 7072 696d 203d 2070 7269 6d0a 2020 2020  prim = prim.    
+00022610: 2020 2020 6966 2074 6172 6765 745f 7072      if target_pr
+00022620: 696d 2069 6e20 7365 6c66 2e6c 696e 655f  im in self.line_
+00022630: 7365 676d 656e 7473 3a0a 2020 2020 2020  segments:.      
+00022640: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+00022650: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
+00022660: 2046 616c 7365 0a0a 2020 2020 6465 6620   False..    def 
+00022670: 6765 745f 636c 6f73 696e 675f 706f 696e  get_closing_poin
+00022680: 7428 7365 6c66 2c20 706f 6c79 676f 6e32  t(self, polygon2
+00022690: 5f32 642c 2070 7269 6d69 7469 7665 2c20  _2d, primitive, 
+000226a0: 6178 3d4e 6f6e 6529 3a0a 2020 2020 2020  ax=None):.      
+000226b0: 2020 2222 2247 6574 7320 7365 7769 6e67    """Gets sewing
+000226c0: 2063 6c6f 7369 6e67 2070 6f69 6e74 7320   closing points 
+000226d0: 666f 7220 6769 7665 6e20 7072 696d 6974  for given primit
+000226e0: 6976 6520 706f 696e 7473 2222 220a 2020  ive points""".  
+000226f0: 2020 2020 2020 636c 6f73 696e 675f 706f        closing_po
+00022700: 696e 7420 3d20 766f 6c6d 646c 722e 4f32  int = volmdlr.O2
+00022710: 440a 2020 2020 2020 2020 6d69 6464 6c65  D.        middle
+00022720: 5f70 6f69 6e74 203d 2070 7269 6d69 7469  _point = primiti
+00022730: 7665 2e6d 6964 646c 655f 706f 696e 7428  ve.middle_point(
+00022740: 290a 0a20 2020 2020 2020 206e 6f72 6d61  )..        norma
+00022750: 6c5f 7665 6374 6f72 203d 2070 7269 6d69  l_vector = primi
+00022760: 7469 7665 2e75 6e69 745f 6e6f 726d 616c  tive.unit_normal
+00022770: 5f76 6563 746f 7228 290a 2020 2020 2020  _vector().      
+00022780: 2020 6c69 6e65 5f73 6567 6d65 6e74 3120    line_segment1 
+00022790: 3d20 766f 6c6d 646c 722e 6564 6765 732e  = volmdlr.edges.
+000227a0: 4c69 6e65 5365 676d 656e 7432 4428 6d69  LineSegment2D(mi
+000227b0: 6464 6c65 5f70 6f69 6e74 2c0a 2020 2020  ddle_point,.    
 000227c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000227d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000227e0: 2020 2020 2020 2020 6d69 6464 6c65 5f70          middle_p
-000227f0: 6f69 6e74 202d 206e 6f72 6d61 6c5f 7665  oint - normal_ve
-00022800: 6374 6f72 290a 2020 2020 2020 2020 6c69  ctor).        li
-00022810: 6e65 5f73 6567 6d65 6e74 3220 3d20 766f  ne_segment2 = vo
-00022820: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
-00022830: 5365 676d 656e 7432 4428 6d69 6464 6c65  Segment2D(middle
-00022840: 5f70 6f69 6e74 2c0a 2020 2020 2020 2020  _point,.        
+000227e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000227f0: 6d69 6464 6c65 5f70 6f69 6e74 202d 206e  middle_point - n
+00022800: 6f72 6d61 6c5f 7665 6374 6f72 290a 2020  ormal_vector).  
+00022810: 2020 2020 2020 6c69 6e65 5f73 6567 6d65        line_segme
+00022820: 6e74 3220 3d20 766f 6c6d 646c 722e 6564  nt2 = volmdlr.ed
+00022830: 6765 732e 4c69 6e65 5365 676d 656e 7432  ges.LineSegment2
+00022840: 4428 6d69 6464 6c65 5f70 6f69 6e74 2c0a  D(middle_point,.
 00022850: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00022860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022870: 2020 2020 2020 2020 2020 2020 6d69 6464              midd
-00022880: 6c65 5f70 6f69 6e74 202b 206e 6f72 6d61  le_point + norma
-00022890: 6c5f 7665 6374 6f72 290a 0a20 2020 2020  l_vector)..     
-000228a0: 2020 2070 6f73 7369 626c 655f 7365 7769     possible_sewi
-000228b0: 6e67 5f63 6c6f 7369 6e67 5f70 6f69 6e74  ng_closing_point
-000228c0: 735f 696e 5f6c 696e 6573 6567 6d65 6e74  s_in_linesegment
-000228d0: 203d 5c0a 2020 2020 2020 2020 2020 2020   =\.            
-000228e0: 7365 6c66 2e67 6574 5f70 6f73 7369 626c  self.get_possibl
-000228f0: 655f 7365 7769 6e67 5f63 6c6f 7369 6e67  e_sewing_closing
-00022900: 5f70 6f69 6e74 7328 706f 6c79 676f 6e32  _points(polygon2
-00022910: 5f32 642c 2070 7269 6d69 7469 7665 2c0a  _2d, primitive,.
-00022920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022880: 2020 2020 6d69 6464 6c65 5f70 6f69 6e74      middle_point
+00022890: 202b 206e 6f72 6d61 6c5f 7665 6374 6f72   + normal_vector
+000228a0: 290a 0a20 2020 2020 2020 2070 6f73 7369  )..        possi
+000228b0: 626c 655f 7365 7769 6e67 5f63 6c6f 7369  ble_sewing_closi
+000228c0: 6e67 5f70 6f69 6e74 735f 696e 5f6c 696e  ng_points_in_lin
+000228d0: 6573 6567 6d65 6e74 203d 5c0a 2020 2020  esegment =\.    
+000228e0: 2020 2020 2020 2020 7365 6c66 2e67 6574          self.get
+000228f0: 5f70 6f73 7369 626c 655f 7365 7769 6e67  _possible_sewing
+00022900: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 7328  _closing_points(
+00022910: 706f 6c79 676f 6e32 5f32 642c 2070 7269  polygon2_2d, pri
+00022920: 6d69 7469 7665 2c0a 2020 2020 2020 2020  mitive,.        
 00022930: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00022940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022950: 2020 2020 6c69 6e65 5f73 6567 6d65 6e74      line_segment
-00022960: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
+00022950: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+00022960: 5f73 6567 6d65 6e74 312c 0a20 2020 2020  _segment1,.     
 00022970: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00022980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022990: 2020 2020 2020 206c 696e 655f 7365 676d         line_segm
-000229a0: 656e 7432 290a 2020 2020 2020 2020 6966  ent2).        if
-000229b0: 2070 6f73 7369 626c 655f 7365 7769 6e67   possible_sewing
-000229c0: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 735f  _closing_points_
-000229d0: 696e 5f6c 696e 6573 6567 6d65 6e74 5b6c  in_linesegment[l
-000229e0: 696e 655f 7365 676d 656e 7431 5d20 616e  ine_segment1] an
-000229f0: 645c 0a20 2020 2020 2020 2020 2020 2020  d\.             
-00022a00: 2020 206e 6f74 2070 6f73 7369 626c 655f     not possible_
-00022a10: 7365 7769 6e67 5f63 6c6f 7369 6e67 5f70  sewing_closing_p
-00022a20: 6f69 6e74 735f 696e 5f6c 696e 6573 6567  oints_in_lineseg
-00022a30: 6d65 6e74 5b6c 696e 655f 7365 676d 656e  ment[line_segmen
-00022a40: 7432 5d3a 0a20 2020 2020 2020 2020 2020  t2]:.           
-00022a50: 2063 6c6f 7369 6e67 5f70 6f69 6e74 203d   closing_point =
-00022a60: 2073 656c 662e 7365 6c65 6374 5f63 6c6f   self.select_clo
-00022a70: 7365 7374 5f73 6577 696e 675f 636c 6f73  sest_sewing_clos
-00022a80: 696e 675f 706f 696e 7428 0a20 2020 2020  ing_point(.     
-00022a90: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-00022aa0: 7365 676d 656e 7431 2c20 7072 696d 6974  segment1, primit
-00022ab0: 6976 652c 0a20 2020 2020 2020 2020 2020  ive,.           
-00022ac0: 2020 2020 2070 6f73 7369 626c 655f 7365       possible_se
-00022ad0: 7769 6e67 5f63 6c6f 7369 6e67 5f70 6f69  wing_closing_poi
-00022ae0: 6e74 735f 696e 5f6c 696e 6573 6567 6d65  nts_in_linesegme
-00022af0: 6e74 5b6c 696e 655f 7365 676d 656e 7431  nt[line_segment1
-00022b00: 5d29 0a20 2020 2020 2020 2020 2020 2069  ]).            i
-00022b10: 6620 6178 2069 7320 6e6f 7420 4e6f 6e65  f ax is not None
-00022b20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00022b30: 2020 636c 6f73 696e 675f 706f 696e 742e    closing_point.
-00022b40: 706c 6f74 2861 783d 6178 2c20 636f 6c6f  plot(ax=ax, colo
-00022b50: 723d 2767 2729 0a20 2020 2020 2020 2069  r='g').        i
-00022b60: 6620 706f 7373 6962 6c65 5f73 6577 696e  f possible_sewin
-00022b70: 675f 636c 6f73 696e 675f 706f 696e 7473  g_closing_points
-00022b80: 5f69 6e5f 6c69 6e65 7365 676d 656e 745b  _in_linesegment[
-00022b90: 6c69 6e65 5f73 6567 6d65 6e74 325d 2061  line_segment2] a
-00022ba0: 6e64 205c 0a20 2020 2020 2020 2020 2020  nd \.           
-00022bb0: 2020 2020 206e 6f74 2070 6f73 7369 626c       not possibl
-00022bc0: 655f 7365 7769 6e67 5f63 6c6f 7369 6e67  e_sewing_closing
-00022bd0: 5f70 6f69 6e74 735f 696e 5f6c 696e 6573  _points_in_lines
-00022be0: 6567 6d65 6e74 5b0a 2020 2020 2020 2020  egment[.        
-00022bf0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-00022c00: 5f73 6567 6d65 6e74 315d 3a0a 2020 2020  _segment1]:.    
-00022c10: 2020 2020 2020 2020 636c 6f73 696e 675f          closing_
-00022c20: 706f 696e 7420 3d20 7365 6c66 2e73 656c  point = self.sel
-00022c30: 6563 745f 636c 6f73 6573 745f 7365 7769  ect_closest_sewi
-00022c40: 6e67 5f63 6c6f 7369 6e67 5f70 6f69 6e74  ng_closing_point
-00022c50: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00022c60: 2020 6c69 6e65 5f73 6567 6d65 6e74 322c    line_segment2,
-00022c70: 2070 7269 6d69 7469 7665 2c0a 2020 2020   primitive,.    
-00022c80: 2020 2020 2020 2020 2020 2020 706f 7373              poss
-00022c90: 6962 6c65 5f73 6577 696e 675f 636c 6f73  ible_sewing_clos
-00022ca0: 696e 675f 706f 696e 7473 5f69 6e5f 6c69  ing_points_in_li
-00022cb0: 6e65 7365 676d 656e 745b 6c69 6e65 5f73  nesegment[line_s
-00022cc0: 6567 6d65 6e74 325d 290a 0a20 2020 2020  egment2])..     
-00022cd0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00022ce0: 2020 2020 2069 6620 6c65 6e28 706f 7373       if len(poss
-00022cf0: 6962 6c65 5f73 6577 696e 675f 636c 6f73  ible_sewing_clos
-00022d00: 696e 675f 706f 696e 7473 5f69 6e5f 6c69  ing_points_in_li
-00022d10: 6e65 7365 676d 656e 745b 6c69 6e65 5f73  nesegment[line_s
-00022d20: 6567 6d65 6e74 315d 2920 3d3d 2031 3a0a  egment1]) == 1:.
-00022d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d40: 636c 6f73 696e 675f 706f 696e 7420 3d20  closing_point = 
-00022d50: 7365 6c66 2e73 656c 6563 745f 636c 6f73  self.select_clos
-00022d60: 6573 745f 7365 7769 6e67 5f63 6c6f 7369  est_sewing_closi
-00022d70: 6e67 5f70 6f69 6e74 280a 2020 2020 2020  ng_point(.      
-00022d80: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-00022d90: 6e65 5f73 6567 6d65 6e74 312c 2070 7269  ne_segment1, pri
-00022da0: 6d69 7469 7665 2c0a 2020 2020 2020 2020  mitive,.        
-00022db0: 2020 2020 2020 2020 2020 2020 706f 7373              poss
-00022dc0: 6962 6c65 5f73 6577 696e 675f 636c 6f73  ible_sewing_clos
-00022dd0: 696e 675f 706f 696e 7473 5f69 6e5f 6c69  ing_points_in_li
-00022de0: 6e65 7365 676d 656e 745b 0a20 2020 2020  nesegment[.     
-00022df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e00: 2020 206c 696e 655f 7365 676d 656e 7431     line_segment1
-00022e10: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-00022e20: 2020 2069 6620 636c 6f73 696e 675f 706f     if closing_po
-00022e30: 696e 7420 3d3d 2076 6f6c 6d64 6c72 2e4f  int == volmdlr.O
-00022e40: 3244 3a0a 2020 2020 2020 2020 2020 2020  2D:.            
-00022e50: 2020 2020 2020 2020 636c 6f73 696e 675f          closing_
-00022e60: 706f 696e 7420 3d20 7365 6c66 2e73 656c  point = self.sel
-00022e70: 6563 745f 6661 7274 6865 7374 5f73 6577  ect_farthest_sew
-00022e80: 696e 675f 636c 6f73 696e 675f 706f 696e  ing_closing_poin
-00022e90: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00022ea0: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-00022eb0: 7365 676d 656e 7432 2c20 7072 696d 6974  segment2, primit
-00022ec0: 6976 652c 0a20 2020 2020 2020 2020 2020  ive,.           
-00022ed0: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
-00022ee0: 7369 626c 655f 7365 7769 6e67 5f63 6c6f  sible_sewing_clo
-00022ef0: 7369 6e67 5f70 6f69 6e74 735f 696e 5f6c  sing_points_in_l
-00022f00: 696e 6573 6567 6d65 6e74 5b0a 2020 2020  inesegment[.    
-00022f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f20: 2020 2020 2020 2020 6c69 6e65 5f73 6567          line_seg
-00022f30: 6d65 6e74 325d 290a 2020 2020 2020 2020  ment2]).        
-00022f40: 2020 2020 2020 2020 6966 2061 7820 6973          if ax is
-00022f50: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00022f60: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00022f70: 6c6f 7369 6e67 5f70 6f69 6e74 2e70 6c6f  losing_point.plo
-00022f80: 7428 6178 3d61 782c 2063 6f6c 6f72 3d27  t(ax=ax, color='
-00022f90: 6327 290a 2020 2020 2020 2020 2020 2020  c').            
-00022fa0: 656c 6966 206c 656e 2870 6f73 7369 626c  elif len(possibl
-00022fb0: 655f 7365 7769 6e67 5f63 6c6f 7369 6e67  e_sewing_closing
-00022fc0: 5f70 6f69 6e74 735f 696e 5f6c 696e 6573  _points_in_lines
-00022fd0: 6567 6d65 6e74 5b6c 696e 655f 7365 676d  egment[line_segm
-00022fe0: 656e 7432 5d29 203d 3d20 313a 0a20 2020  ent2]) == 1:.   
-00022ff0: 2020 2020 2020 2020 2020 2020 2063 6c6f               clo
-00023000: 7369 6e67 5f70 6f69 6e74 203d 2073 656c  sing_point = sel
-00023010: 662e 7365 6c65 6374 5f63 6c6f 7365 7374  f.select_closest
-00023020: 5f73 6577 696e 675f 636c 6f73 696e 675f  _sewing_closing_
-00023030: 706f 696e 7428 0a20 2020 2020 2020 2020  point(.         
-00023040: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-00023050: 7365 676d 656e 7432 2c20 7072 696d 6974  segment2, primit
-00023060: 6976 652c 0a20 2020 2020 2020 2020 2020  ive,.           
-00023070: 2020 2020 2020 2020 2070 6f73 7369 626c           possibl
-00023080: 655f 7365 7769 6e67 5f63 6c6f 7369 6e67  e_sewing_closing
-00023090: 5f70 6f69 6e74 735f 696e 5f6c 696e 6573  _points_in_lines
-000230a0: 6567 6d65 6e74 5b0a 2020 2020 2020 2020  egment[.        
+00022990: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000229a0: 696e 655f 7365 676d 656e 7432 290a 2020  ine_segment2).  
+000229b0: 2020 2020 2020 6966 2070 6f73 7369 626c        if possibl
+000229c0: 655f 7365 7769 6e67 5f63 6c6f 7369 6e67  e_sewing_closing
+000229d0: 5f70 6f69 6e74 735f 696e 5f6c 696e 6573  _points_in_lines
+000229e0: 6567 6d65 6e74 5b6c 696e 655f 7365 676d  egment[line_segm
+000229f0: 656e 7431 5d20 616e 645c 0a20 2020 2020  ent1] and\.     
+00022a00: 2020 2020 2020 2020 2020 206e 6f74 2070             not p
+00022a10: 6f73 7369 626c 655f 7365 7769 6e67 5f63  ossible_sewing_c
+00022a20: 6c6f 7369 6e67 5f70 6f69 6e74 735f 696e  losing_points_in
+00022a30: 5f6c 696e 6573 6567 6d65 6e74 5b6c 696e  _linesegment[lin
+00022a40: 655f 7365 676d 656e 7432 5d3a 0a20 2020  e_segment2]:.   
+00022a50: 2020 2020 2020 2020 2063 6c6f 7369 6e67           closing
+00022a60: 5f70 6f69 6e74 203d 2073 656c 662e 7365  _point = self.se
+00022a70: 6c65 6374 5f63 6c6f 7365 7374 5f73 6577  lect_closest_sew
+00022a80: 696e 675f 636c 6f73 696e 675f 706f 696e  ing_closing_poin
+00022a90: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00022aa0: 2020 206c 696e 655f 7365 676d 656e 7431     line_segment1
+00022ab0: 2c20 7072 696d 6974 6976 652c 0a20 2020  , primitive,.   
+00022ac0: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
+00022ad0: 7369 626c 655f 7365 7769 6e67 5f63 6c6f  sible_sewing_clo
+00022ae0: 7369 6e67 5f70 6f69 6e74 735f 696e 5f6c  sing_points_in_l
+00022af0: 696e 6573 6567 6d65 6e74 5b6c 696e 655f  inesegment[line_
+00022b00: 7365 676d 656e 7431 5d29 0a20 2020 2020  segment1]).     
+00022b10: 2020 2020 2020 2069 6620 6178 2069 7320         if ax is 
+00022b20: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00022b30: 2020 2020 2020 2020 2020 636c 6f73 696e            closin
+00022b40: 675f 706f 696e 742e 706c 6f74 2861 783d  g_point.plot(ax=
+00022b50: 6178 2c20 636f 6c6f 723d 2767 2729 0a20  ax, color='g'). 
+00022b60: 2020 2020 2020 2069 6620 706f 7373 6962         if possib
+00022b70: 6c65 5f73 6577 696e 675f 636c 6f73 696e  le_sewing_closin
+00022b80: 675f 706f 696e 7473 5f69 6e5f 6c69 6e65  g_points_in_line
+00022b90: 7365 676d 656e 745b 6c69 6e65 5f73 6567  segment[line_seg
+00022ba0: 6d65 6e74 325d 2061 6e64 205c 0a20 2020  ment2] and \.   
+00022bb0: 2020 2020 2020 2020 2020 2020 206e 6f74               not
+00022bc0: 2070 6f73 7369 626c 655f 7365 7769 6e67   possible_sewing
+00022bd0: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 735f  _closing_points_
+00022be0: 696e 5f6c 696e 6573 6567 6d65 6e74 5b0a  in_linesegment[.
+00022bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c00: 2020 2020 6c69 6e65 5f73 6567 6d65 6e74      line_segment
+00022c10: 315d 3a0a 2020 2020 2020 2020 2020 2020  1]:.            
+00022c20: 636c 6f73 696e 675f 706f 696e 7420 3d20  closing_point = 
+00022c30: 7365 6c66 2e73 656c 6563 745f 636c 6f73  self.select_clos
+00022c40: 6573 745f 7365 7769 6e67 5f63 6c6f 7369  est_sewing_closi
+00022c50: 6e67 5f70 6f69 6e74 280a 2020 2020 2020  ng_point(.      
+00022c60: 2020 2020 2020 2020 2020 6c69 6e65 5f73            line_s
+00022c70: 6567 6d65 6e74 322c 2070 7269 6d69 7469  egment2, primiti
+00022c80: 7665 2c0a 2020 2020 2020 2020 2020 2020  ve,.            
+00022c90: 2020 2020 706f 7373 6962 6c65 5f73 6577      possible_sew
+00022ca0: 696e 675f 636c 6f73 696e 675f 706f 696e  ing_closing_poin
+00022cb0: 7473 5f69 6e5f 6c69 6e65 7365 676d 656e  ts_in_linesegmen
+00022cc0: 745b 6c69 6e65 5f73 6567 6d65 6e74 325d  t[line_segment2]
+00022cd0: 290a 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+00022ce0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00022cf0: 6c65 6e28 706f 7373 6962 6c65 5f73 6577  len(possible_sew
+00022d00: 696e 675f 636c 6f73 696e 675f 706f 696e  ing_closing_poin
+00022d10: 7473 5f69 6e5f 6c69 6e65 7365 676d 656e  ts_in_linesegmen
+00022d20: 745b 6c69 6e65 5f73 6567 6d65 6e74 315d  t[line_segment1]
+00022d30: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
+00022d40: 2020 2020 2020 2020 636c 6f73 696e 675f          closing_
+00022d50: 706f 696e 7420 3d20 7365 6c66 2e73 656c  point = self.sel
+00022d60: 6563 745f 636c 6f73 6573 745f 7365 7769  ect_closest_sewi
+00022d70: 6e67 5f63 6c6f 7369 6e67 5f70 6f69 6e74  ng_closing_point
+00022d80: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00022d90: 2020 2020 2020 6c69 6e65 5f73 6567 6d65        line_segme
+00022da0: 6e74 312c 2070 7269 6d69 7469 7665 2c0a  nt1, primitive,.
+00022db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022dc0: 2020 2020 706f 7373 6962 6c65 5f73 6577      possible_sew
+00022dd0: 696e 675f 636c 6f73 696e 675f 706f 696e  ing_closing_poin
+00022de0: 7473 5f69 6e5f 6c69 6e65 7365 676d 656e  ts_in_linesegmen
+00022df0: 745b 0a20 2020 2020 2020 2020 2020 2020  t[.             
+00022e00: 2020 2020 2020 2020 2020 206c 696e 655f             line_
+00022e10: 7365 676d 656e 7431 5d29 0a20 2020 2020  segment1]).     
+00022e20: 2020 2020 2020 2020 2020 2069 6620 636c             if cl
+00022e30: 6f73 696e 675f 706f 696e 7420 3d3d 2076  osing_point == v
+00022e40: 6f6c 6d64 6c72 2e4f 3244 3a0a 2020 2020  olmdlr.O2D:.    
+00022e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022e60: 636c 6f73 696e 675f 706f 696e 7420 3d20  closing_point = 
+00022e70: 7365 6c66 2e73 656c 6563 745f 6661 7274  self.select_fart
+00022e80: 6865 7374 5f73 6577 696e 675f 636c 6f73  hest_sewing_clos
+00022e90: 696e 675f 706f 696e 7428 0a20 2020 2020  ing_point(.     
+00022ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022eb0: 2020 206c 696e 655f 7365 676d 656e 7432     line_segment2
+00022ec0: 2c20 7072 696d 6974 6976 652c 0a20 2020  , primitive,.   
+00022ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022ee0: 2020 2020 2070 6f73 7369 626c 655f 7365       possible_se
+00022ef0: 7769 6e67 5f63 6c6f 7369 6e67 5f70 6f69  wing_closing_poi
+00022f00: 6e74 735f 696e 5f6c 696e 6573 6567 6d65  nts_in_linesegme
+00022f10: 6e74 5b0a 2020 2020 2020 2020 2020 2020  nt[.            
+00022f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022f30: 6c69 6e65 5f73 6567 6d65 6e74 325d 290a  line_segment2]).
+00022f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022f50: 6966 2061 7820 6973 206e 6f74 204e 6f6e  if ax is not Non
+00022f60: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00022f70: 2020 2020 2020 2063 6c6f 7369 6e67 5f70         closing_p
+00022f80: 6f69 6e74 2e70 6c6f 7428 6178 3d61 782c  oint.plot(ax=ax,
+00022f90: 2063 6f6c 6f72 3d27 6327 290a 2020 2020   color='c').    
+00022fa0: 2020 2020 2020 2020 656c 6966 206c 656e          elif len
+00022fb0: 2870 6f73 7369 626c 655f 7365 7769 6e67  (possible_sewing
+00022fc0: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 735f  _closing_points_
+00022fd0: 696e 5f6c 696e 6573 6567 6d65 6e74 5b6c  in_linesegment[l
+00022fe0: 696e 655f 7365 676d 656e 7432 5d29 203d  ine_segment2]) =
+00022ff0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00023000: 2020 2020 2063 6c6f 7369 6e67 5f70 6f69       closing_poi
+00023010: 6e74 203d 2073 656c 662e 7365 6c65 6374  nt = self.select
+00023020: 5f63 6c6f 7365 7374 5f73 6577 696e 675f  _closest_sewing_
+00023030: 636c 6f73 696e 675f 706f 696e 7428 0a20  closing_point(. 
+00023040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023050: 2020 206c 696e 655f 7365 676d 656e 7432     line_segment2
+00023060: 2c20 7072 696d 6974 6976 652c 0a20 2020  , primitive,.   
+00023070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023080: 2070 6f73 7369 626c 655f 7365 7769 6e67   possible_sewing
+00023090: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 735f  _closing_points_
+000230a0: 696e 5f6c 696e 6573 6567 6d65 6e74 5b0a  in_linesegment[.
 000230b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000230c0: 6c69 6e65 5f73 6567 6d65 6e74 325d 290a  line_segment2]).
-000230d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000230e0: 6966 2063 6c6f 7369 6e67 5f70 6f69 6e74  if closing_point
-000230f0: 203d 3d20 766f 6c6d 646c 722e 4f32 443a   == volmdlr.O2D:
-00023100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023110: 2020 2020 2063 6c6f 7369 6e67 5f70 6f69       closing_poi
-00023120: 6e74 203d 2073 656c 662e 7365 6c65 6374  nt = self.select
-00023130: 5f66 6172 7468 6573 745f 7365 7769 6e67  _farthest_sewing
-00023140: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 280a  _closing_point(.
-00023150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023160: 2020 2020 2020 2020 6c69 6e65 5f73 6567          line_seg
-00023170: 6d65 6e74 312c 2070 7269 6d69 7469 7665  ment1, primitive
-00023180: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00023190: 2020 2020 2020 2020 2020 706f 7373 6962            possib
-000231a0: 6c65 5f73 6577 696e 675f 636c 6f73 696e  le_sewing_closin
-000231b0: 675f 706f 696e 7473 5f69 6e5f 6c69 6e65  g_points_in_line
-000231c0: 7365 676d 656e 745b 0a20 2020 2020 2020  segment[.       
-000231d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000231e0: 2020 2020 206c 696e 655f 7365 676d 656e       line_segmen
-000231f0: 7431 5d29 0a20 2020 2020 2020 2020 2020  t1]).           
-00023200: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00023210: 2020 2020 2020 2069 6620 706f 7373 6962         if possib
-00023220: 6c65 5f73 6577 696e 675f 636c 6f73 696e  le_sewing_closin
-00023230: 675f 706f 696e 7473 5f69 6e5f 6c69 6e65  g_points_in_line
-00023240: 7365 676d 656e 745b 6c69 6e65 5f73 6567  segment[line_seg
-00023250: 6d65 6e74 315d 3a0a 2020 2020 2020 2020  ment1]:.        
-00023260: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00023270: 656c 662e 7365 6172 6368 5f66 6172 7468  elf.search_farth
-00023280: 6573 7428 0a20 2020 2020 2020 2020 2020  est(.           
+000230c0: 2020 2020 2020 2020 6c69 6e65 5f73 6567          line_seg
+000230d0: 6d65 6e74 325d 290a 2020 2020 2020 2020  ment2]).        
+000230e0: 2020 2020 2020 2020 6966 2063 6c6f 7369          if closi
+000230f0: 6e67 5f70 6f69 6e74 203d 3d20 766f 6c6d  ng_point == volm
+00023100: 646c 722e 4f32 443a 0a20 2020 2020 2020  dlr.O2D:.       
+00023110: 2020 2020 2020 2020 2020 2020 2063 6c6f               clo
+00023120: 7369 6e67 5f70 6f69 6e74 203d 2073 656c  sing_point = sel
+00023130: 662e 7365 6c65 6374 5f66 6172 7468 6573  f.select_farthes
+00023140: 745f 7365 7769 6e67 5f63 6c6f 7369 6e67  t_sewing_closing
+00023150: 5f70 6f69 6e74 280a 2020 2020 2020 2020  _point(.        
+00023160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023170: 6c69 6e65 5f73 6567 6d65 6e74 312c 2070  line_segment1, p
+00023180: 7269 6d69 7469 7665 2c0a 2020 2020 2020  rimitive,.      
+00023190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000231a0: 2020 706f 7373 6962 6c65 5f73 6577 696e    possible_sewin
+000231b0: 675f 636c 6f73 696e 675f 706f 696e 7473  g_closing_points
+000231c0: 5f69 6e5f 6c69 6e65 7365 676d 656e 745b  _in_linesegment[
+000231d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000231e0: 2020 2020 2020 2020 2020 2020 206c 696e               lin
+000231f0: 655f 7365 676d 656e 7431 5d29 0a20 2020  e_segment1]).   
+00023200: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00023210: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00023220: 6620 706f 7373 6962 6c65 5f73 6577 696e  f possible_sewin
+00023230: 675f 636c 6f73 696e 675f 706f 696e 7473  g_closing_points
+00023240: 5f69 6e5f 6c69 6e65 7365 676d 656e 745b  _in_linesegment[
+00023250: 6c69 6e65 5f73 6567 6d65 6e74 315d 3a0a  line_segment1]:.
+00023260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023270: 2020 2020 6966 2073 656c 662e 7365 6172      if self.sear
+00023280: 6368 5f66 6172 7468 6573 7428 0a20 2020  ch_farthest(.   
 00023290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000232a0: 206d 6964 646c 655f 706f 696e 742c 0a20   middle_point,. 
-000232b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000232c0: 2020 2020 2020 2020 2020 2070 6f73 7369             possi
-000232d0: 626c 655f 7365 7769 6e67 5f63 6c6f 7369  ble_sewing_closi
-000232e0: 6e67 5f70 6f69 6e74 735f 696e 5f6c 696e  ng_points_in_lin
-000232f0: 6573 6567 6d65 6e74 5b0a 2020 2020 2020  esegment[.      
-00023300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023310: 2020 2020 2020 2020 2020 6c69 6e65 5f73            line_s
-00023320: 6567 6d65 6e74 325d 293a 0a20 2020 2020  egment2]):.     
-00023330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023340: 2020 2063 6c6f 7369 6e67 5f70 6f69 6e74     closing_point
-00023350: 203d 5c0a 2020 2020 2020 2020 2020 2020   =\.            
+000232a0: 2020 2020 2020 2020 206d 6964 646c 655f           middle_
+000232b0: 706f 696e 742c 0a20 2020 2020 2020 2020  point,.         
+000232c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000232d0: 2020 2070 6f73 7369 626c 655f 7365 7769     possible_sewi
+000232e0: 6e67 5f63 6c6f 7369 6e67 5f70 6f69 6e74  ng_closing_point
+000232f0: 735f 696e 5f6c 696e 6573 6567 6d65 6e74  s_in_linesegment
+00023300: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00023310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023320: 2020 6c69 6e65 5f73 6567 6d65 6e74 325d    line_segment2]
+00023330: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00023340: 2020 2020 2020 2020 2020 2063 6c6f 7369             closi
+00023350: 6e67 5f70 6f69 6e74 203d 5c0a 2020 2020  ng_point =\.    
 00023360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023370: 7365 6c66 2e73 656c 6563 745f 6661 7274  self.select_fart
-00023380: 6865 7374 5f73 6577 696e 675f 636c 6f73  hest_sewing_clos
-00023390: 696e 675f 706f 696e 7428 0a20 2020 2020  ing_point(.     
-000233a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000233b0: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-000233c0: 7365 676d 656e 7431 2c20 7072 696d 6974  segment1, primit
-000233d0: 6976 652c 0a20 2020 2020 2020 2020 2020  ive,.           
+00023370: 2020 2020 2020 2020 7365 6c66 2e73 656c          self.sel
+00023380: 6563 745f 6661 7274 6865 7374 5f73 6577  ect_farthest_sew
+00023390: 696e 675f 636c 6f73 696e 675f 706f 696e  ing_closing_poin
+000233a0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+000233b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000233c0: 2020 206c 696e 655f 7365 676d 656e 7431     line_segment1
+000233d0: 2c20 7072 696d 6974 6976 652c 0a20 2020  , primitive,.   
 000233e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000233f0: 2020 2020 2070 6f73 7369 626c 655f 7365       possible_se
-00023400: 7769 6e67 5f63 6c6f 7369 6e67 5f70 6f69  wing_closing_poi
-00023410: 6e74 735f 696e 5f6c 696e 6573 6567 6d65  nts_in_linesegme
-00023420: 6e74 5b0a 2020 2020 2020 2020 2020 2020  nt[.            
+000233f0: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
+00023400: 7369 626c 655f 7365 7769 6e67 5f63 6c6f  sible_sewing_clo
+00023410: 7369 6e67 5f70 6f69 6e74 735f 696e 5f6c  sing_points_in_l
+00023420: 696e 6573 6567 6d65 6e74 5b0a 2020 2020  inesegment[.    
 00023430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023440: 2020 2020 2020 2020 6c69 6e65 5f73 6567          line_seg
-00023450: 6d65 6e74 315d 290a 2020 2020 2020 2020  ment1]).        
-00023460: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00023470: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00023480: 2020 2020 2020 2020 2020 636c 6f73 696e            closin
-00023490: 675f 706f 696e 7420 3d5c 0a20 2020 2020  g_point =\.     
-000234a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000234b0: 2020 2020 2020 2073 656c 662e 7365 6c65         self.sele
-000234c0: 6374 5f63 6c6f 7365 7374 5f73 6577 696e  ct_closest_sewin
-000234d0: 675f 636c 6f73 696e 675f 706f 696e 7428  g_closing_point(
-000234e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023450: 6c69 6e65 5f73 6567 6d65 6e74 315d 290a  line_segment1]).
+00023460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023470: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00023480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023490: 2020 636c 6f73 696e 675f 706f 696e 7420    closing_point 
+000234a0: 3d5c 0a20 2020 2020 2020 2020 2020 2020  =\.             
+000234b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000234c0: 656c 662e 7365 6c65 6374 5f63 6c6f 7365  elf.select_close
+000234d0: 7374 5f73 6577 696e 675f 636c 6f73 696e  st_sewing_closin
+000234e0: 675f 706f 696e 7428 0a20 2020 2020 2020  g_point(.       
 000234f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023500: 206c 696e 655f 7365 676d 656e 7431 2c20   line_segment1, 
-00023510: 7072 696d 6974 6976 652c 0a20 2020 2020  primitive,.     
-00023520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023530: 2020 2020 2020 2020 2020 2070 6f73 7369             possi
-00023540: 626c 655f 7365 7769 6e67 5f63 6c6f 7369  ble_sewing_closi
-00023550: 6e67 5f70 6f69 6e74 735f 696e 5f6c 696e  ng_points_in_lin
-00023560: 6573 6567 6d65 6e74 5b0a 2020 2020 2020  esegment[.      
-00023570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023580: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-00023590: 6e65 5f73 6567 6d65 6e74 315d 290a 0a20  ne_segment1]).. 
-000235a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000235b0: 6c69 6620 706f 7373 6962 6c65 5f73 6577  lif possible_sew
-000235c0: 696e 675f 636c 6f73 696e 675f 706f 696e  ing_closing_poin
-000235d0: 7473 5f69 6e5f 6c69 6e65 7365 676d 656e  ts_in_linesegmen
-000235e0: 745b 0a20 2020 2020 2020 2020 2020 2020  t[.             
-000235f0: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-00023600: 7365 676d 656e 7432 5d3a 0a20 2020 2020  segment2]:.     
-00023610: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00023620: 6c6f 7369 6e67 5f70 6f69 6e74 203d 2073  losing_point = s
-00023630: 656c 662e 7365 6c65 6374 5f63 6c6f 7365  elf.select_close
-00023640: 7374 5f73 6577 696e 675f 636c 6f73 696e  st_sewing_closin
-00023650: 675f 706f 696e 7428 0a20 2020 2020 2020  g_point(.       
-00023660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023670: 206c 696e 655f 7365 676d 656e 7432 2c20   line_segment2, 
-00023680: 7072 696d 6974 6976 652c 0a20 2020 2020  primitive,.     
-00023690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000236a0: 2020 2070 6f73 7369 626c 655f 7365 7769     possible_sewi
-000236b0: 6e67 5f63 6c6f 7369 6e67 5f70 6f69 6e74  ng_closing_point
-000236c0: 735f 696e 5f6c 696e 6573 6567 6d65 6e74  s_in_linesegment
-000236d0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-000236e0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-000236f0: 6e65 5f73 6567 6d65 6e74 325d 290a 2020  ne_segment2]).  
-00023700: 2020 2020 2020 6966 2061 7820 6973 206e        if ax is n
-00023710: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00023720: 2020 2020 206d 6964 646c 655f 706f 696e       middle_poin
-00023730: 742e 706c 6f74 2861 783d 6178 2c20 636f  t.plot(ax=ax, co
-00023740: 6c6f 723d 2772 2729 0a20 2020 2020 2020  lor='r').       
-00023750: 2020 2020 206c 696e 655f 7365 676d 656e       line_segmen
-00023760: 7431 2e70 6c6f 7428 6178 3d61 782c 2063  t1.plot(ax=ax, c
-00023770: 6f6c 6f72 3d27 7927 290a 2020 2020 2020  olor='y').      
-00023780: 2020 2020 2020 6c69 6e65 5f73 6567 6d65        line_segme
-00023790: 6e74 322e 706c 6f74 2861 783d 6178 2c20  nt2.plot(ax=ax, 
-000237a0: 636f 6c6f 723d 2762 2729 0a20 2020 2020  color='b').     
-000237b0: 2020 2020 2020 2063 6c6f 7369 6e67 5f70         closing_p
-000237c0: 6f69 6e74 2e70 6c6f 7428 6178 3d61 7829  oint.plot(ax=ax)
-000237d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000237e0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-000237f0: 6445 7272 6f72 2827 5468 6572 6520 7368  dError('There sh
-00023800: 6f75 6c64 206e 6f74 2062 6520 6120 706c  ould not be a pl
-00023810: 6f74 2069 6e73 6964 6520 7468 6973 206d  ot inside this m
-00023820: 6574 686f 6427 290a 0a20 2020 2020 2020  ethod')..       
-00023830: 2072 6574 7572 6e20 636c 6f73 696e 675f   return closing_
-00023840: 706f 696e 740a 0a20 2020 2064 6566 2067  point..    def g
-00023850: 6574 5f76 616c 6964 5f73 6577 696e 675f  et_valid_sewing_
-00023860: 706f 6c79 676f 6e5f 7072 696d 6974 6976  polygon_primitiv
-00023870: 6528 7365 6c66 2c20 706f 6c79 676f 6e32  e(self, polygon2
-00023880: 5f32 6429 3a0a 2020 2020 2020 2020 2222  _2d):.        ""
-00023890: 2247 6574 2076 616c 6964 2070 7269 6d69  "Get valid primi
-000238a0: 7469 7665 2074 6f20 7374 6172 7420 7365  tive to start se
-000238b0: 7769 6e67 2074 776f 2070 6f6c 7967 6f6e  wing two polygon
-000238c0: 7322 2222 0a20 2020 2020 2020 2066 6f72  s""".        for
-000238d0: 2070 7269 6d69 7469 7665 3120 696e 2073   primitive1 in s
-000238e0: 656c 662e 6c69 6e65 5f73 6567 6d65 6e74  elf.line_segment
-000238f0: 733a 0a20 2020 2020 2020 2020 2020 206d  s:.            m
-00023900: 6964 646c 655f 706f 696e 7420 3d20 7072  iddle_point = pr
-00023910: 696d 6974 6976 6531 2e6d 6964 646c 655f  imitive1.middle_
-00023920: 706f 696e 7428 290a 2020 2020 2020 2020  point().        
-00023930: 2020 2020 6e6f 726d 616c 5f76 6563 746f      normal_vecto
-00023940: 7220 3d20 7072 696d 6974 6976 6531 2e75  r = primitive1.u
-00023950: 6e69 745f 6e6f 726d 616c 5f76 6563 746f  nit_normal_vecto
-00023960: 7228 290a 2020 2020 2020 2020 2020 2020  r().            
-00023970: 6c69 6e65 5f73 6567 6d65 6e74 3120 3d20  line_segment1 = 
-00023980: 766f 6c6d 646c 722e 6564 6765 732e 4c69  volmdlr.edges.Li
-00023990: 6e65 5365 676d 656e 7432 4428 6d69 6464  neSegment2D(midd
-000239a0: 6c65 5f70 6f69 6e74 2c0a 2020 2020 2020  le_point,.      
-000239b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023500: 2020 2020 2020 2020 206c 696e 655f 7365           line_se
+00023510: 676d 656e 7431 2c20 7072 696d 6974 6976  gment1, primitiv
+00023520: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00023530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023540: 2020 2070 6f73 7369 626c 655f 7365 7769     possible_sewi
+00023550: 6e67 5f63 6c6f 7369 6e67 5f70 6f69 6e74  ng_closing_point
+00023560: 735f 696e 5f6c 696e 6573 6567 6d65 6e74  s_in_linesegment
+00023570: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00023580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023590: 2020 2020 2020 6c69 6e65 5f73 6567 6d65        line_segme
+000235a0: 6e74 315d 290a 0a20 2020 2020 2020 2020  nt1])..         
+000235b0: 2020 2020 2020 2065 6c69 6620 706f 7373         elif poss
+000235c0: 6962 6c65 5f73 6577 696e 675f 636c 6f73  ible_sewing_clos
+000235d0: 696e 675f 706f 696e 7473 5f69 6e5f 6c69  ing_points_in_li
+000235e0: 6e65 7365 676d 656e 745b 0a20 2020 2020  nesegment[.     
+000235f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023600: 2020 206c 696e 655f 7365 676d 656e 7432     line_segment2
+00023610: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+00023620: 2020 2020 2020 2063 6c6f 7369 6e67 5f70         closing_p
+00023630: 6f69 6e74 203d 2073 656c 662e 7365 6c65  oint = self.sele
+00023640: 6374 5f63 6c6f 7365 7374 5f73 6577 696e  ct_closest_sewin
+00023650: 675f 636c 6f73 696e 675f 706f 696e 7428  g_closing_point(
+00023660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023670: 2020 2020 2020 2020 206c 696e 655f 7365           line_se
+00023680: 676d 656e 7432 2c20 7072 696d 6974 6976  gment2, primitiv
+00023690: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+000236a0: 2020 2020 2020 2020 2020 2070 6f73 7369             possi
+000236b0: 626c 655f 7365 7769 6e67 5f63 6c6f 7369  ble_sewing_closi
+000236c0: 6e67 5f70 6f69 6e74 735f 696e 5f6c 696e  ng_points_in_lin
+000236d0: 6573 6567 6d65 6e74 5b0a 2020 2020 2020  esegment[.      
+000236e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000236f0: 2020 2020 2020 6c69 6e65 5f73 6567 6d65        line_segme
+00023700: 6e74 325d 290a 2020 2020 2020 2020 6966  nt2]).        if
+00023710: 2061 7820 6973 206e 6f74 204e 6f6e 653a   ax is not None:
+00023720: 0a20 2020 2020 2020 2020 2020 206d 6964  .            mid
+00023730: 646c 655f 706f 696e 742e 706c 6f74 2861  dle_point.plot(a
+00023740: 783d 6178 2c20 636f 6c6f 723d 2772 2729  x=ax, color='r')
+00023750: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
+00023760: 655f 7365 676d 656e 7431 2e70 6c6f 7428  e_segment1.plot(
+00023770: 6178 3d61 782c 2063 6f6c 6f72 3d27 7927  ax=ax, color='y'
+00023780: 290a 2020 2020 2020 2020 2020 2020 6c69  ).            li
+00023790: 6e65 5f73 6567 6d65 6e74 322e 706c 6f74  ne_segment2.plot
+000237a0: 2861 783d 6178 2c20 636f 6c6f 723d 2762  (ax=ax, color='b
+000237b0: 2729 0a20 2020 2020 2020 2020 2020 2063  ').            c
+000237c0: 6c6f 7369 6e67 5f70 6f69 6e74 2e70 6c6f  losing_point.plo
+000237d0: 7428 6178 3d61 7829 0a20 2020 2020 2020  t(ax=ax).       
+000237e0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+000237f0: 706c 656d 656e 7465 6445 7272 6f72 2827  plementedError('
+00023800: 5468 6572 6520 7368 6f75 6c64 206e 6f74  There should not
+00023810: 2062 6520 6120 706c 6f74 2069 6e73 6964   be a plot insid
+00023820: 6520 7468 6973 206d 6574 686f 6427 290a  e this method').
+00023830: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00023840: 636c 6f73 696e 675f 706f 696e 740a 0a20  closing_point.. 
+00023850: 2020 2064 6566 2067 6574 5f76 616c 6964     def get_valid
+00023860: 5f73 6577 696e 675f 706f 6c79 676f 6e5f  _sewing_polygon_
+00023870: 7072 696d 6974 6976 6528 7365 6c66 2c20  primitive(self, 
+00023880: 706f 6c79 676f 6e32 5f32 6429 3a0a 2020  polygon2_2d):.  
+00023890: 2020 2020 2020 2222 2247 6574 2076 616c        """Get val
+000238a0: 6964 2070 7269 6d69 7469 7665 2074 6f20  id primitive to 
+000238b0: 7374 6172 7420 7365 7769 6e67 2074 776f  start sewing two
+000238c0: 2070 6f6c 7967 6f6e 732e 2222 220a 2020   polygons.""".  
+000238d0: 2020 2020 2020 666f 7220 7072 696d 6974        for primit
+000238e0: 6976 6531 2069 6e20 7365 6c66 2e6c 696e  ive1 in self.lin
+000238f0: 655f 7365 676d 656e 7473 3a0a 2020 2020  e_segments:.    
+00023900: 2020 2020 2020 2020 6d69 6464 6c65 5f70          middle_p
+00023910: 6f69 6e74 203d 2070 7269 6d69 7469 7665  oint = primitive
+00023920: 312e 6d69 6464 6c65 5f70 6f69 6e74 2829  1.middle_point()
+00023930: 0a20 2020 2020 2020 2020 2020 206e 6f72  .            nor
+00023940: 6d61 6c5f 7665 6374 6f72 203d 2070 7269  mal_vector = pri
+00023950: 6d69 7469 7665 312e 756e 6974 5f6e 6f72  mitive1.unit_nor
+00023960: 6d61 6c5f 7665 6374 6f72 2829 0a20 2020  mal_vector().   
+00023970: 2020 2020 2020 2020 206c 696e 655f 7365           line_se
+00023980: 676d 656e 7431 203d 2076 6f6c 6d64 6c72  gment1 = volmdlr
+00023990: 2e65 6467 6573 2e4c 696e 6553 6567 6d65  .edges.LineSegme
+000239a0: 6e74 3244 286d 6964 646c 655f 706f 696e  nt2D(middle_poin
+000239b0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
 000239c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000239d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000239e0: 2020 6d69 6464 6c65 5f70 6f69 6e74 202d    middle_point -
-000239f0: 206e 6f72 6d61 6c5f 7665 6374 6f72 290a   normal_vector).
-00023a00: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-00023a10: 5f73 6567 6d65 6e74 3220 3d20 766f 6c6d  _segment2 = volm
-00023a20: 646c 722e 6564 6765 732e 4c69 6e65 5365  dlr.edges.LineSe
-00023a30: 676d 656e 7432 4428 6d69 6464 6c65 5f70  gment2D(middle_p
-00023a40: 6f69 6e74 2c0a 2020 2020 2020 2020 2020  oint,.          
+000239e0: 2020 2020 2020 2020 2020 206d 6964 646c             middl
+000239f0: 655f 706f 696e 7420 2d20 6e6f 726d 616c  e_point - normal
+00023a00: 5f76 6563 746f 7229 0a20 2020 2020 2020  _vector).       
+00023a10: 2020 2020 206c 696e 655f 7365 676d 656e       line_segmen
+00023a20: 7432 203d 2076 6f6c 6d64 6c72 2e65 6467  t2 = volmdlr.edg
+00023a30: 6573 2e4c 696e 6553 6567 6d65 6e74 3244  es.LineSegment2D
+00023a40: 286d 6964 646c 655f 706f 696e 742c 0a20  (middle_point,. 
 00023a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00023a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023a70: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
-00023a80: 6464 6c65 5f70 6f69 6e74 202b 206e 6f72  ddle_point + nor
-00023a90: 6d61 6c5f 7665 6374 6f72 290a 2020 2020  mal_vector).    
-00023aa0: 2020 2020 2020 2020 706f 7373 6962 6c65          possible
-00023ab0: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 7320  _closing_points 
-00023ac0: 3d20 7365 6c66 2e67 6574 5f70 6f73 7369  = self.get_possi
-00023ad0: 626c 655f 7365 7769 6e67 5f63 6c6f 7369  ble_sewing_closi
-00023ae0: 6e67 5f70 6f69 6e74 7328 0a20 2020 2020  ng_points(.     
-00023af0: 2020 2020 2020 2020 2020 2070 6f6c 7967             polyg
-00023b00: 6f6e 325f 3264 2c20 7072 696d 6974 6976  on2_2d, primitiv
-00023b10: 6531 2c20 6c69 6e65 5f73 6567 6d65 6e74  e1, line_segment
-00023b20: 312c 206c 696e 655f 7365 676d 656e 7432  1, line_segment2
-00023b30: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00023b40: 206c 656e 2870 6f73 7369 626c 655f 636c   len(possible_cl
-00023b50: 6f73 696e 675f 706f 696e 7473 5b6c 696e  osing_points[lin
-00023b60: 655f 7365 676d 656e 7431 5d29 203d 3d20  e_segment1]) == 
-00023b70: 3120 616e 645c 0a20 2020 2020 2020 2020  1 and\.         
-00023b80: 2020 2020 2020 2020 2020 2070 6f73 7369             possi
-00023b90: 626c 655f 636c 6f73 696e 675f 706f 696e  ble_closing_poin
-00023ba0: 7473 5b6c 696e 655f 7365 676d 656e 7431  ts[line_segment1
-00023bb0: 5d5b 305d 5b31 5d20 696e 2070 6f6c 7967  ][0][1] in polyg
-00023bc0: 6f6e 325f 3264 2e6c 696e 655f 7365 676d  on2_2d.line_segm
-00023bd0: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
-00023be0: 2020 2020 2020 636c 6f73 696e 675f 706f        closing_po
-00023bf0: 696e 7420 3d20 2870 6f73 7369 626c 655f  int = (possible_
-00023c00: 636c 6f73 696e 675f 706f 696e 7473 5b0a  closing_points[.
-00023c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023a80: 2020 2020 2020 206d 6964 646c 655f 706f         middle_po
+00023a90: 696e 7420 2b20 6e6f 726d 616c 5f76 6563  int + normal_vec
+00023aa0: 746f 7229 0a20 2020 2020 2020 2020 2020  tor).           
+00023ab0: 2070 6f73 7369 626c 655f 636c 6f73 696e   possible_closin
+00023ac0: 675f 706f 696e 7473 203d 2073 656c 662e  g_points = self.
+00023ad0: 6765 745f 706f 7373 6962 6c65 5f73 6577  get_possible_sew
+00023ae0: 696e 675f 636c 6f73 696e 675f 706f 696e  ing_closing_poin
+00023af0: 7473 280a 2020 2020 2020 2020 2020 2020  ts(.            
+00023b00: 2020 2020 706f 6c79 676f 6e32 5f32 642c      polygon2_2d,
+00023b10: 2070 7269 6d69 7469 7665 312c 206c 696e   primitive1, lin
+00023b20: 655f 7365 676d 656e 7431 2c20 6c69 6e65  e_segment1, line
+00023b30: 5f73 6567 6d65 6e74 3229 0a20 2020 2020  _segment2).     
+00023b40: 2020 2020 2020 2069 6620 6c65 6e28 706f         if len(po
+00023b50: 7373 6962 6c65 5f63 6c6f 7369 6e67 5f70  ssible_closing_p
+00023b60: 6f69 6e74 735b 6c69 6e65 5f73 6567 6d65  oints[line_segme
+00023b70: 6e74 315d 2920 3d3d 2031 2061 6e64 5c0a  nt1]) == 1 and\.
+00023b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023b90: 2020 2020 706f 7373 6962 6c65 5f63 6c6f      possible_clo
+00023ba0: 7369 6e67 5f70 6f69 6e74 735b 6c69 6e65  sing_points[line
+00023bb0: 5f73 6567 6d65 6e74 315d 5b30 5d5b 315d  _segment1][0][1]
+00023bc0: 2069 6e20 706f 6c79 676f 6e32 5f32 642e   in polygon2_2d.
+00023bd0: 6c69 6e65 5f73 6567 6d65 6e74 733a 0a20  line_segments:. 
+00023be0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00023bf0: 6c6f 7369 6e67 5f70 6f69 6e74 203d 2028  losing_point = (
+00023c00: 706f 7373 6962 6c65 5f63 6c6f 7369 6e67  possible_closing
+00023c10: 5f70 6f69 6e74 735b 0a20 2020 2020 2020  _points[.       
 00023c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c30: 2020 2020 206c 696e 655f 7365 676d 656e       line_segmen
-00023c40: 7431 5d5b 305d 5b31 5d2e 7374 6172 7420  t1][0][1].start 
-00023c50: 6966 0a20 2020 2020 2020 2020 2020 2020  if.             
+00023c30: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00023c40: 6e65 5f73 6567 6d65 6e74 315d 5b30 5d5b  ne_segment1][0][
+00023c50: 315d 2e73 7461 7274 2069 660a 2020 2020  1].start if.    
 00023c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c70: 2020 2020 706f 7373 6962 6c65 5f63 6c6f      possible_clo
-00023c80: 7369 6e67 5f70 6f69 6e74 735b 0a20 2020  sing_points[.   
-00023c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c70: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
+00023c80: 7369 626c 655f 636c 6f73 696e 675f 706f  sible_closing_po
+00023c90: 696e 7473 5b0a 2020 2020 2020 2020 2020  ints[.          
 00023ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023cb0: 2020 6c69 6e65 5f73 6567 6d65 6e74 315d    line_segment1]
-00023cc0: 5b30 5d5b 305d 2e70 6f69 6e74 5f64 6973  [0][0].point_dis
-00023cd0: 7461 6e63 6528 0a20 2020 2020 2020 2020  tance(.         
+00023cb0: 2020 2020 2020 2020 2020 206c 696e 655f             line_
+00023cc0: 7365 676d 656e 7431 5d5b 305d 5b30 5d2e  segment1][0][0].
+00023cd0: 706f 696e 745f 6469 7374 616e 6365 280a  point_distance(.
 00023ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023cf0: 2020 2020 2020 2020 2020 2020 706f 7373              poss
-00023d00: 6962 6c65 5f63 6c6f 7369 6e67 5f70 6f69  ible_closing_poi
-00023d10: 6e74 735b 0a20 2020 2020 2020 2020 2020  nts[.           
+00023cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023d00: 2020 2020 2070 6f73 7369 626c 655f 636c       possible_cl
+00023d10: 6f73 696e 675f 706f 696e 7473 5b0a 2020  osing_points[.  
 00023d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d30: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-00023d40: 6e65 5f73 6567 6d65 6e74 315d 5b30 5d5b  ne_segment1][0][
-00023d50: 315d 2e73 7461 7274 2920 3c0a 2020 2020  1].start) <.    
-00023d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d70: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
-00023d80: 7369 626c 655f 636c 6f73 696e 675f 706f  sible_closing_po
-00023d90: 696e 7473 5b0a 2020 2020 2020 2020 2020  ints[.          
+00023d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023d40: 2020 2020 2020 206c 696e 655f 7365 676d         line_segm
+00023d50: 656e 7431 5d5b 305d 5b31 5d2e 7374 6172  ent1][0][1].star
+00023d60: 7429 203c 0a20 2020 2020 2020 2020 2020  t) <.           
+00023d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023d80: 2020 2020 2020 706f 7373 6962 6c65 5f63        possible_c
+00023d90: 6c6f 7369 6e67 5f70 6f69 6e74 735b 0a20  losing_points[. 
 00023da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023db0: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-00023dc0: 7365 676d 656e 7431 5d5b 305d 5b30 5d2e  segment1][0][0].
-00023dd0: 706f 696e 745f 6469 7374 616e 6365 280a  point_distance(.
-00023de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023dc0: 2020 2020 6c69 6e65 5f73 6567 6d65 6e74      line_segment
+00023dd0: 315d 5b30 5d5b 305d 2e70 6f69 6e74 5f64  1][0][0].point_d
+00023de0: 6973 7461 6e63 6528 0a20 2020 2020 2020  istance(.       
 00023df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e00: 2020 2020 2070 6f73 7369 626c 655f 636c       possible_cl
-00023e10: 6f73 696e 675f 706f 696e 7473 5b0a 2020  osing_points[.  
-00023e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023e00: 2020 2020 2020 2020 2020 2020 2020 706f                po
+00023e10: 7373 6962 6c65 5f63 6c6f 7369 6e67 5f70  ssible_closing_p
+00023e20: 6f69 6e74 735b 0a20 2020 2020 2020 2020  oints[.         
 00023e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e40: 2020 2020 2020 206c 696e 655f 7365 676d         line_segm
-00023e50: 656e 7431 5d5b 305d 5b31 5d2e 656e 6429  ent1][0][1].end)
-00023e60: 2065 6c73 650a 2020 2020 2020 2020 2020   else.          
+00023e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023e50: 6c69 6e65 5f73 6567 6d65 6e74 315d 5b30  line_segment1][0
+00023e60: 5d5b 315d 2e65 6e64 2920 656c 7365 0a20  ][1].end) else. 
 00023e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e80: 2020 2020 2020 2070 6f73 7369 626c 655f         possible_
-00023e90: 636c 6f73 696e 675f 706f 696e 7473 5b0a  closing_points[.
-00023ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023e90: 706f 7373 6962 6c65 5f63 6c6f 7369 6e67  possible_closing
+00023ea0: 5f70 6f69 6e74 735b 0a20 2020 2020 2020  _points[.       
 00023eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ec0: 2020 2020 206c 696e 655f 7365 676d 656e       line_segmen
-00023ed0: 7431 5d5b 305d 5b31 5d2e 656e 6429 0a0a  t1][0][1].end)..
-00023ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ef0: 6966 2070 6f6c 7967 6f6e 325f 3264 2e70  if polygon2_2d.p
-00023f00: 6f69 6e74 732e 696e 6465 7828 636c 6f73  oints.index(clos
-00023f10: 696e 675f 706f 696e 7429 203e 3d20 6c65  ing_point) >= le
-00023f20: 6e28 706f 6c79 676f 6e32 5f32 642e 706f  n(polygon2_2d.po
-00023f30: 696e 7473 2920 2a20 3220 2f20 343a 0a20  ints) * 2 / 4:. 
-00023f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023f50: 2020 2072 6574 7572 6e20 7072 696d 6974     return primit
-00023f60: 6976 6531 0a0a 2020 2020 2020 2020 2020  ive1..          
-00023f70: 2020 6966 206c 656e 2870 6f73 7369 626c    if len(possibl
-00023f80: 655f 636c 6f73 696e 675f 706f 696e 7473  e_closing_points
-00023f90: 5b6c 696e 655f 7365 676d 656e 7432 5d29  [line_segment2])
-00023fa0: 203d 3d20 3120 616e 645c 0a20 2020 2020   == 1 and\.     
-00023fb0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00023fc0: 6f73 7369 626c 655f 636c 6f73 696e 675f  ossible_closing_
-00023fd0: 706f 696e 7473 5b6c 696e 655f 7365 676d  points[line_segm
-00023fe0: 656e 7432 5d5b 305d 5b31 5d20 696e 2070  ent2][0][1] in p
-00023ff0: 6f6c 7967 6f6e 325f 3264 2e6c 696e 655f  olygon2_2d.line_
-00024000: 7365 676d 656e 7473 3a0a 2020 2020 2020  segments:.      
-00024010: 2020 2020 2020 2020 2020 636c 6f73 696e            closin
-00024020: 675f 706f 696e 7420 3d20 2870 6f73 7369  g_point = (possi
-00024030: 626c 655f 636c 6f73 696e 675f 706f 696e  ble_closing_poin
-00024040: 7473 5b0a 2020 2020 2020 2020 2020 2020  ts[.            
+00023ec0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00023ed0: 6e65 5f73 6567 6d65 6e74 315d 5b30 5d5b  ne_segment1][0][
+00023ee0: 315d 2e65 6e64 290a 0a20 2020 2020 2020  1].end)..       
+00023ef0: 2020 2020 2020 2020 2069 6620 706f 6c79           if poly
+00023f00: 676f 6e32 5f32 642e 706f 696e 7473 2e69  gon2_2d.points.i
+00023f10: 6e64 6578 2863 6c6f 7369 6e67 5f70 6f69  ndex(closing_poi
+00023f20: 6e74 2920 3e3d 206c 656e 2870 6f6c 7967  nt) >= len(polyg
+00023f30: 6f6e 325f 3264 2e70 6f69 6e74 7329 202a  on2_2d.points) *
+00023f40: 2032 202f 2034 3a0a 2020 2020 2020 2020   2 / 4:.        
+00023f50: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00023f60: 726e 2070 7269 6d69 7469 7665 310a 0a20  rn primitive1.. 
+00023f70: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00023f80: 6e28 706f 7373 6962 6c65 5f63 6c6f 7369  n(possible_closi
+00023f90: 6e67 5f70 6f69 6e74 735b 6c69 6e65 5f73  ng_points[line_s
+00023fa0: 6567 6d65 6e74 325d 2920 3d3d 2031 2061  egment2]) == 1 a
+00023fb0: 6e64 5c0a 2020 2020 2020 2020 2020 2020  nd\.            
+00023fc0: 2020 2020 2020 2020 706f 7373 6962 6c65          possible
+00023fd0: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 735b  _closing_points[
+00023fe0: 6c69 6e65 5f73 6567 6d65 6e74 325d 5b30  line_segment2][0
+00023ff0: 5d5b 315d 2069 6e20 706f 6c79 676f 6e32  ][1] in polygon2
+00024000: 5f32 642e 6c69 6e65 5f73 6567 6d65 6e74  _2d.line_segment
+00024010: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00024020: 2020 2063 6c6f 7369 6e67 5f70 6f69 6e74     closing_point
+00024030: 203d 2028 706f 7373 6962 6c65 5f63 6c6f   = (possible_clo
+00024040: 7369 6e67 5f70 6f69 6e74 735b 0a20 2020  sing_points[.   
 00024050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024060: 2020 2020 2020 2020 206c 696e 655f 7365           line_se
-00024070: 676d 656e 7432 5d5b 305d 5b31 5d2e 7374  gment2][0][1].st
-00024080: 6172 7420 6966 0a20 2020 2020 2020 2020  art if.         
+00024060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024070: 2020 6c69 6e65 5f73 6567 6d65 6e74 325d    line_segment2]
+00024080: 5b30 5d5b 315d 2e73 7461 7274 2069 660a  [0][1].start if.
 00024090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000240a0: 2020 2020 2020 2020 706f 7373 6962 6c65          possible
-000240b0: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 735b  _closing_points[
-000240c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000240a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000240b0: 2070 6f73 7369 626c 655f 636c 6f73 696e   possible_closin
+000240c0: 675f 706f 696e 7473 5b0a 2020 2020 2020  g_points[.      
 000240d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000240e0: 2020 2020 2020 6c69 6e65 5f73 6567 6d65        line_segme
-000240f0: 6e74 325d 5b30 5d5b 305d 2e70 6f69 6e74  nt2][0][0].point
-00024100: 5f64 6973 7461 6e63 6528 0a20 2020 2020  _distance(.     
-00024110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000240e0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000240f0: 696e 655f 7365 676d 656e 7432 5d5b 305d  ine_segment2][0]
+00024100: 5b30 5d2e 706f 696e 745f 6469 7374 616e  [0].point_distan
+00024110: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
 00024120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024130: 706f 7373 6962 6c65 5f63 6c6f 7369 6e67  possible_closing
-00024140: 5f70 6f69 6e74 735b 0a20 2020 2020 2020  _points[.       
-00024150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024130: 2020 2020 2020 2020 2070 6f73 7369 626c           possibl
+00024140: 655f 636c 6f73 696e 675f 706f 696e 7473  e_closing_points
+00024150: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
 00024160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024170: 2020 6c69 6e65 5f73 6567 6d65 6e74 325d    line_segment2]
-00024180: 5b30 5d5b 315d 2e73 7461 7274 2920 3c0a  [0][1].start) <.
-00024190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024170: 2020 2020 2020 2020 2020 206c 696e 655f             line_
+00024180: 7365 676d 656e 7432 5d5b 305d 5b31 5d2e  segment2][0][1].
+00024190: 7374 6172 7429 203c 0a20 2020 2020 2020  start) <.       
 000241a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000241b0: 2070 6f73 7369 626c 655f 636c 6f73 696e   possible_closin
-000241c0: 675f 706f 696e 7473 5b0a 2020 2020 2020  g_points[.      
-000241d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000241e0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-000241f0: 696e 655f 7365 676d 656e 7432 5d5b 305d  ine_segment2][0]
-00024200: 5b30 5d2e 706f 696e 745f 6469 7374 616e  [0].point_distan
-00024210: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
+000241b0: 2020 2020 2020 2020 2020 706f 7373 6962            possib
+000241c0: 6c65 5f63 6c6f 7369 6e67 5f70 6f69 6e74  le_closing_point
+000241d0: 735b 0a20 2020 2020 2020 2020 2020 2020  s[.             
+000241e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000241f0: 2020 2020 2020 2020 6c69 6e65 5f73 6567          line_seg
+00024200: 6d65 6e74 325d 5b30 5d5b 305d 2e70 6f69  ment2][0][0].poi
+00024210: 6e74 5f64 6973 7461 6e63 6528 0a20 2020  nt_distance(.   
 00024220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024230: 2020 2020 2020 2020 2070 6f73 7369 626c           possibl
-00024240: 655f 636c 6f73 696e 675f 706f 696e 7473  e_closing_points
-00024250: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00024230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024240: 2020 706f 7373 6962 6c65 5f63 6c6f 7369    possible_closi
+00024250: 6e67 5f70 6f69 6e74 735b 0a20 2020 2020  ng_points[.     
 00024260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024270: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-00024280: 7365 676d 656e 7432 5d5b 305d 5b31 5d2e  segment2][0][1].
-00024290: 656e 6429 2065 6c73 650a 2020 2020 2020  end) else.      
-000242a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000242b0: 2020 2020 2020 2020 2020 2070 6f73 7369             possi
-000242c0: 626c 655f 636c 6f73 696e 675f 706f 696e  ble_closing_poin
-000242d0: 7473 5b0a 2020 2020 2020 2020 2020 2020  ts[.            
+00024270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024280: 2020 2020 6c69 6e65 5f73 6567 6d65 6e74      line_segment
+00024290: 325d 5b30 5d5b 315d 2e65 6e64 2920 656c  2][0][1].end) el
+000242a0: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
+000242b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000242c0: 2020 2020 706f 7373 6962 6c65 5f63 6c6f      possible_clo
+000242d0: 7369 6e67 5f70 6f69 6e74 735b 0a20 2020  sing_points[.   
 000242e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000242f0: 2020 2020 2020 2020 206c 696e 655f 7365           line_se
-00024300: 676d 656e 7432 5d5b 305d 5b31 5d2e 656e  gment2][0][1].en
-00024310: 6429 0a0a 2020 2020 2020 2020 2020 2020  d)..            
-00024320: 2020 2020 6966 2070 6f6c 7967 6f6e 325f      if polygon2_
-00024330: 3264 2e70 6f69 6e74 732e 696e 6465 7828  2d.points.index(
-00024340: 636c 6f73 696e 675f 706f 696e 7429 203e  closing_point) >
-00024350: 3d20 6c65 6e28 706f 6c79 676f 6e32 5f32  = len(polygon2_2
-00024360: 642e 706f 696e 7473 2920 2a20 3220 2f20  d.points) * 2 / 
-00024370: 343a 0a20 2020 2020 2020 2020 2020 2020  4:.             
-00024380: 2020 2020 2020 2072 6574 7572 6e20 7072         return pr
-00024390: 696d 6974 6976 6531 0a0a 2020 2020 2020  imitive1..      
-000243a0: 2020 666f 7220 7072 696d 6974 6976 6531    for primitive1
-000243b0: 2069 6e20 7365 6c66 2e6c 696e 655f 7365   in self.line_se
-000243c0: 676d 656e 7473 3a0a 2020 2020 2020 2020  gments:.        
-000243d0: 2020 2020 636c 6f73 696e 675f 706f 696e      closing_poin
-000243e0: 7420 3d20 7365 6c66 2e67 6574 5f63 6c6f  t = self.get_clo
-000243f0: 7369 6e67 5f70 6f69 6e74 2870 6f6c 7967  sing_point(polyg
-00024400: 6f6e 325f 3264 2c0a 2020 2020 2020 2020  on2_2d,.        
-00024410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000242f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024300: 2020 6c69 6e65 5f73 6567 6d65 6e74 325d    line_segment2]
+00024310: 5b30 5d5b 315d 2e65 6e64 290a 0a20 2020  [0][1].end)..   
+00024320: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00024330: 706f 6c79 676f 6e32 5f32 642e 706f 696e  polygon2_2d.poin
+00024340: 7473 2e69 6e64 6578 2863 6c6f 7369 6e67  ts.index(closing
+00024350: 5f70 6f69 6e74 2920 3e3d 206c 656e 2870  _point) >= len(p
+00024360: 6f6c 7967 6f6e 325f 3264 2e70 6f69 6e74  olygon2_2d.point
+00024370: 7329 202a 2032 202f 2034 3a0a 2020 2020  s) * 2 / 4:.    
+00024380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024390: 7265 7475 726e 2070 7269 6d69 7469 7665  return primitive
+000243a0: 310a 0a20 2020 2020 2020 2066 6f72 2070  1..        for p
+000243b0: 7269 6d69 7469 7665 3120 696e 2073 656c  rimitive1 in sel
+000243c0: 662e 6c69 6e65 5f73 6567 6d65 6e74 733a  f.line_segments:
+000243d0: 0a20 2020 2020 2020 2020 2020 2063 6c6f  .            clo
+000243e0: 7369 6e67 5f70 6f69 6e74 203d 2073 656c  sing_point = sel
+000243f0: 662e 6765 745f 636c 6f73 696e 675f 706f  f.get_closing_po
+00024400: 696e 7428 706f 6c79 676f 6e32 5f32 642c  int(polygon2_2d,
+00024410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00024420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024430: 2020 2020 2020 2020 2020 2070 7269 6d69             primi
-00024440: 7469 7665 3129 0a20 2020 2020 2020 2020  tive1).         
-00024450: 2020 2069 6620 636c 6f73 696e 675f 706f     if closing_po
-00024460: 696e 7420 213d 2076 6f6c 6d64 6c72 2e4f  int != volmdlr.O
-00024470: 3244 3a0a 2020 2020 2020 2020 2020 2020  2D:.            
-00024480: 2020 2020 7265 7475 726e 2070 7269 6d69      return primi
-00024490: 7469 7665 310a 0a20 2020 2020 2020 2072  tive1..        r
-000244a0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-000244b0: 7465 6445 7272 6f72 2827 6d61 6b65 2073  tedError('make s
-000244c0: 7572 6520 7468 6520 7477 6f20 706f 6c79  ure the two poly
-000244d0: 676f 6e73 2027 0a20 2020 2020 2020 2020  gons '.         
+00024430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024440: 2020 2020 7072 696d 6974 6976 6531 290a      primitive1).
+00024450: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00024460: 6c6f 7369 6e67 5f70 6f69 6e74 2021 3d20  losing_point != 
+00024470: 766f 6c6d 646c 722e 4f32 443a 0a20 2020  volmdlr.O2D:.   
+00024480: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00024490: 7572 6e20 7072 696d 6974 6976 6531 0a0a  urn primitive1..
+000244a0: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+000244b0: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+000244c0: 7228 276d 616b 6520 7375 7265 2074 6865  r('make sure the
+000244d0: 2074 776f 2070 6f6c 7967 6f6e 7320 270a   two polygons '.
 000244e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000244f0: 2020 2020 2020 2020 2027 796f 7520 6172           'you ar
-00024500: 6520 7472 7969 6e67 2074 6f20 7365 7720  e trying to sew 
-00024510: 6172 6520 7661 6c69 6420 6f6e 6573 2729  are valid ones')
-00024520: 0a0a 2020 2020 6465 6620 6973 5f63 6f6e  ..    def is_con
-00024530: 7665 7828 7365 6c66 293a 0a20 2020 2020  vex(self):.     
-00024540: 2020 2022 2222 0a20 2020 2020 2020 2056     """.        V
-00024550: 6572 6966 6965 7320 6966 2061 2070 6f6c  erifies if a pol
-00024560: 7967 6f6e 2069 7320 636f 6e76 6578 206f  ygon is convex o
-00024570: 7220 4e6f 740a 2020 2020 2020 2020 2222  r Not.        ""
-00024580: 220a 2020 2020 2020 2020 666f 7220 7072  ".        for pr
-00024590: 696d 312c 2070 7269 6d32 2069 6e20 7a69  im1, prim2 in zi
-000245a0: 7028 7365 6c66 2e6c 696e 655f 7365 676d  p(self.line_segm
-000245b0: 656e 7473 2c20 7365 6c66 2e6c 696e 655f  ents, self.line_
-000245c0: 7365 676d 656e 7473 5b31 3a5d 202b 205b  segments[1:] + [
-000245d0: 7365 6c66 2e6c 696e 655f 7365 676d 656e  self.line_segmen
-000245e0: 7473 5b30 5d5d 293a 0a20 2020 2020 2020  ts[0]]):.       
-000245f0: 2020 2020 2076 6563 746f 7231 203d 2070       vector1 = p
-00024600: 7269 6d31 2e64 6972 6563 7469 6f6e 5f76  rim1.direction_v
-00024610: 6563 746f 7228 290a 2020 2020 2020 2020  ector().        
-00024620: 2020 2020 7665 6374 6f72 3220 3d20 7072      vector2 = pr
-00024630: 696d 322e 6469 7265 6374 696f 6e5f 7665  im2.direction_ve
-00024640: 6374 6f72 2829 0a20 2020 2020 2020 2020  ctor().         
-00024650: 2020 2061 6e67 6c65 203d 2076 6f6c 6d64     angle = volmd
-00024660: 6c72 2e67 656f 6d65 7472 792e 636c 6f63  lr.geometry.cloc
-00024670: 6b77 6973 655f 616e 676c 6528 7665 6374  kwise_angle(vect
-00024680: 6f72 312c 2076 6563 746f 7232 290a 2020  or1, vector2).  
-00024690: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-000246a0: 662e 6973 5f74 7269 676f 3a0a 2020 2020  f.is_trigo:.    
-000246b0: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-000246c0: 6e67 6c65 203c 206d 6174 682e 7069 2061  ngle < math.pi a
-000246d0: 6e64 2061 6e67 6c65 2021 3d20 303a 0a20  nd angle != 0:. 
-000246e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000246f0: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
-00024700: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00024710: 2061 6e67 6c65 203e 206d 6174 682e 7069   angle > math.pi
-00024720: 2061 6e64 2061 6e67 6c65 2021 3d20 3220   and angle != 2 
-00024730: 2a20 6d61 7468 2e70 693a 0a20 2020 2020  * math.pi:.     
-00024740: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00024750: 6e20 4661 6c73 650a 2020 2020 2020 2020  n False.        
-00024760: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00024770: 2064 6566 2061 7869 616c 5f73 796d 6d65   def axial_symme
-00024780: 7472 7928 7365 6c66 2c20 6c69 6e65 293a  try(self, line):
-00024790: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000247a0: 2020 2020 2046 696e 6473 206f 7574 2074       Finds out t
-000247b0: 6865 2073 796d 6d65 7472 6963 2063 6c6f  he symmetric clo
-000247c0: 7365 645f 706f 6c79 676f 6e32 6420 6163  sed_polygon2d ac
-000247d0: 636f 7264 696e 6720 746f 2061 206c 696e  cording to a lin
-000247e0: 652e 0a0a 2020 2020 2020 2020 2222 220a  e...        """.
-000247f0: 0a20 2020 2020 2020 2061 7869 616c 5f70  .        axial_p
-00024800: 6f69 6e74 7320 3d20 5b70 6f69 6e74 2e61  oints = [point.a
-00024810: 7869 616c 5f73 796d 6d65 7472 7928 6c69  xial_symmetry(li
-00024820: 6e65 2920 666f 7220 706f 696e 7420 696e  ne) for point in
-00024830: 2073 656c 662e 706f 696e 7473 5d0a 0a20   self.points].. 
-00024840: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00024850: 6c66 2e5f 5f63 6c61 7373 5f5f 2870 6f69  lf.__class__(poi
-00024860: 6e74 733d 6178 6961 6c5f 706f 696e 7473  nts=axial_points
-00024870: 290a 0a0a 636c 6173 7320 5472 6961 6e67  )...class Triang
-00024880: 6c65 2843 6c6f 7365 6450 6f6c 7967 6f6e  le(ClosedPolygon
-00024890: 4d69 7869 6e29 3a0a 2020 2020 2222 220a  Mixin):.    """.
-000248a0: 2020 2020 4465 6669 6e65 7320 6120 7472      Defines a tr
-000248b0: 6961 6e67 6c65 2066 726f 6d20 3320 706f  iangle from 3 po
-000248c0: 696e 7473 2e20 4974 2069 7320 6120 5375  ints. It is a Su
-000248d0: 7065 7220 436c 6173 7320 666f 7220 5472  per Class for Tr
-000248e0: 6961 6e67 6c65 3244 2061 6e64 2054 7269  iangle2D and Tri
-000248f0: 616e 676c 6533 442c 0a20 2020 2073 746f  angle3D,.    sto
-00024900: 7269 6e67 2074 6865 6972 206d 6169 6e20  ring their main 
-00024910: 6174 7472 6962 7574 6520 616e 6420 6d65  attribute and me
-00024920: 7468 6f64 732e 0a0a 0a20 2020 2022 2222  thods....    """
-00024930: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
-00024940: 5f5f 2873 656c 662c 2070 6f69 6e74 312c  __(self, point1,
-00024950: 2070 6f69 6e74 322c 0a20 2020 2020 2020   point2,.       
-00024960: 2020 2020 2020 2020 2020 706f 696e 7433            point3
-00024970: 2c20 6e61 6d65 3a20 7374 7220 3d20 2727  , name: str = ''
-00024980: 293a 0a0a 2020 2020 2020 2020 7365 6c66  ):..        self
-00024990: 2e70 6f69 6e74 3120 3d20 706f 696e 7431  .point1 = point1
-000249a0: 0a20 2020 2020 2020 2073 656c 662e 706f  .        self.po
-000249b0: 696e 7432 203d 2070 6f69 6e74 320a 2020  int2 = point2.  
-000249c0: 2020 2020 2020 7365 6c66 2e70 6f69 6e74        self.point
-000249d0: 3320 3d20 706f 696e 7433 0a20 2020 2020  3 = point3.     
-000249e0: 2020 2073 656c 662e 6e61 6d65 203d 206e     self.name = n
-000249f0: 616d 650a 2020 2020 2020 2020 7365 6c66  ame.        self
-00024a00: 2e5f 6c69 6e65 5f73 6567 6d65 6e74 7320  ._line_segments 
-00024a10: 3d20 4e6f 6e65 0a0a 0a63 6c61 7373 2054  = None...class T
-00024a20: 7269 616e 676c 6532 4428 436c 6f73 6564  riangle2D(Closed
-00024a30: 506f 6c79 676f 6e32 4429 3a0a 2020 2020  Polygon2D):.    
-00024a40: 2222 220a 2020 2020 4465 6669 6e65 7320  """.    Defines 
-00024a50: 6120 7472 6961 6e67 6c65 2032 442e 0a0a  a triangle 2D...
-00024a60: 2020 2020 3a70 6172 616d 2070 6f69 6e74      :param point
-00024a70: 313a 2074 7269 616e 676c 6520 706f 696e  1: triangle poin
-00024a80: 7420 312e 0a20 2020 203a 7061 7261 6d20  t 1..    :param 
-00024a90: 706f 696e 7432 3a20 7472 6961 6e67 6c65  point2: triangle
-00024aa0: 2070 6f69 6e74 2032 2e0a 2020 2020 3a70   point 2..    :p
-00024ab0: 6172 616d 2070 6f69 6e74 333a 2074 7269  aram point3: tri
-00024ac0: 616e 676c 6520 706f 696e 7420 332e 0a20  angle point 3.. 
-00024ad0: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
-00024ae0: 5f5f 696e 6974 5f5f 2873 656c 662c 2070  __init__(self, p
-00024af0: 6f69 6e74 313a 2076 6f6c 6d64 6c72 2e50  oint1: volmdlr.P
-00024b00: 6f69 6e74 3244 2c20 706f 696e 7432 3a20  oint2D, point2: 
-00024b10: 766f 6c6d 646c 722e 506f 696e 7432 442c  volmdlr.Point2D,
-00024b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024b30: 2020 706f 696e 7433 3a20 766f 6c6d 646c    point3: volmdl
-00024b40: 722e 506f 696e 7432 442c 206e 616d 653a  r.Point2D, name:
-00024b50: 2073 7472 203d 2027 2729 3a0a 2020 2020   str = ''):.    
-00024b60: 2020 2020 2320 544f 444f 3a20 5468 6973      # TODO: This
-00024b70: 2073 6565 6d73 2062 7567 6779 2e20 4973   seems buggy. Is
-00024b80: 2069 7420 7374 696c 6c20 7573 6564 3f0a   it still used?.
-00024b90: 2020 2020 2020 2020 2320 7365 6c66 2e70          # self.p
-00024ba0: 6f69 6e74 3120 3d20 706f 696e 7431 0a20  oint1 = point1. 
-00024bb0: 2020 2020 2020 2023 2073 656c 662e 706f         # self.po
-00024bc0: 696e 7432 203d 2070 6f69 6e74 320a 2020  int2 = point2.  
-00024bd0: 2020 2020 2020 2320 7365 6c66 2e70 6f69        # self.poi
-00024be0: 6e74 3320 3d20 706f 696e 7433 0a20 2020  nt3 = point3.   
-00024bf0: 2020 2020 2023 2073 656c 662e 6e61 6d65       # self.name
-00024c00: 203d 206e 616d 650a 0a20 2020 2020 2020   = name..       
-00024c10: 2043 6c6f 7365 6450 6f6c 7967 6f6e 3244   ClosedPolygon2D
-00024c20: 2e5f 5f69 6e69 745f 5f28 7365 6c66 2c20  .__init__(self, 
-00024c30: 706f 696e 7473 3d5b 706f 696e 7431 2c20  points=[point1, 
-00024c40: 706f 696e 7432 2c20 706f 696e 7433 5d2c  point2, point3],
-00024c50: 206e 616d 653d 6e61 6d65 290a 2020 2020   name=name).    
-00024c60: 2020 2020 230a 2020 2020 2020 2020 2320      #.        # 
-00024c70: 5472 6961 6e67 6c65 2e5f 5f69 6e69 745f  Triangle.__init_
-00024c80: 5f28 7365 6c66 2c20 706f 696e 7431 2c0a  _(self, point1,.
-00024c90: 2020 2020 2020 2020 2320 2020 2020 2020          #       
-00024ca0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
-00024cb0: 7432 2c0a 2020 2020 2020 2020 2320 2020  t2,.        #   
-00024cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024cd0: 706f 696e 7433 2c0a 2020 2020 2020 2020  point3,.        
-00024ce0: 2320 2020 2020 2020 2020 2020 2020 2020  #               
-00024cf0: 2020 2020 6e61 6d65 290a 0a20 2020 2064      name)..    d
-00024d00: 6566 2061 7265 6128 7365 6c66 293a 0a20  ef area(self):. 
-00024d10: 2020 2020 2020 2075 203d 2073 656c 662e         u = self.
-00024d20: 706f 696e 7432 202d 2073 656c 662e 706f  point2 - self.po
-00024d30: 696e 7431 0a20 2020 2020 2020 2076 203d  int1.        v =
-00024d40: 2073 656c 662e 706f 696e 7433 202d 2073   self.point3 - s
-00024d50: 656c 662e 706f 696e 7431 0a20 2020 2020  elf.point1.     
-00024d60: 2020 2072 6574 7572 6e20 6162 7328 752e     return abs(u.
-00024d70: 6372 6f73 7328 7629 2920 2f20 320a 0a20  cross(v)) / 2.. 
-00024d80: 2020 2064 6566 2069 6e63 6972 636c 655f     def incircle_
-00024d90: 7261 6469 7573 2873 656c 6629 3a0a 2020  radius(self):.  
-00024da0: 2020 2020 2020 6120 3d20 7365 6c66 2e70        a = self.p
-00024db0: 6f69 6e74 312e 706f 696e 745f 6469 7374  oint1.point_dist
-00024dc0: 616e 6365 2873 656c 662e 706f 696e 7432  ance(self.point2
-00024dd0: 290a 2020 2020 2020 2020 6220 3d20 7365  ).        b = se
-00024de0: 6c66 2e70 6f69 6e74 312e 706f 696e 745f  lf.point1.point_
-00024df0: 6469 7374 616e 6365 2873 656c 662e 706f  distance(self.po
-00024e00: 696e 7433 290a 2020 2020 2020 2020 6320  int3).        c 
-00024e10: 3d20 7365 6c66 2e70 6f69 6e74 322e 706f  = self.point2.po
-00024e20: 696e 745f 6469 7374 616e 6365 2873 656c  int_distance(sel
-00024e30: 662e 706f 696e 7433 290a 2020 2020 2020  f.point3).      
-00024e40: 2020 7265 7475 726e 2032 202a 2073 656c    return 2 * sel
-00024e50: 662e 6172 6561 2829 202f 2028 6120 2b20  f.area() / (a + 
-00024e60: 6220 2b20 6329 0a0a 2020 2020 6465 6620  b + c)..    def 
-00024e70: 6369 7263 756d 6369 7263 6c65 5f72 6164  circumcircle_rad
-00024e80: 6975 7328 7365 6c66 293a 0a20 2020 2020  ius(self):.     
-00024e90: 2020 2061 203d 2073 656c 662e 706f 696e     a = self.poin
-00024ea0: 7431 2e70 6f69 6e74 5f64 6973 7461 6e63  t1.point_distanc
-00024eb0: 6528 7365 6c66 2e70 6f69 6e74 3229 0a20  e(self.point2). 
-00024ec0: 2020 2020 2020 2062 203d 2073 656c 662e         b = self.
-00024ed0: 706f 696e 7431 2e70 6f69 6e74 5f64 6973  point1.point_dis
-00024ee0: 7461 6e63 6528 7365 6c66 2e70 6f69 6e74  tance(self.point
-00024ef0: 3329 0a20 2020 2020 2020 2063 203d 2073  3).        c = s
-00024f00: 656c 662e 706f 696e 7432 2e70 6f69 6e74  elf.point2.point
-00024f10: 5f64 6973 7461 6e63 6528 7365 6c66 2e70  _distance(self.p
-00024f20: 6f69 6e74 3329 0a20 2020 2020 2020 2072  oint3).        r
-00024f30: 6574 7572 6e20 6120 2a20 6220 2a20 6320  eturn a * b * c 
-00024f40: 2f20 2873 656c 662e 6172 6561 2829 202a  / (self.area() *
-00024f50: 2034 2e30 290a 0a20 2020 2064 6566 2072   4.0)..    def r
-00024f60: 6174 696f 5f63 6972 6375 6d72 5f6c 656e  atio_circumr_len
-00024f70: 6774 6828 7365 6c66 293a 0a20 2020 2020  gth(self):.     
-00024f80: 2020 2072 6574 7572 6e20 7365 6c66 2e63     return self.c
-00024f90: 6972 6375 6d63 6972 636c 655f 7261 6469  ircumcircle_radi
-00024fa0: 7573 2829 202f 2073 656c 662e 6c65 6e67  us() / self.leng
-00024fb0: 7468 2829 0a0a 2020 2020 6465 6620 7261  th()..    def ra
-00024fc0: 7469 6f5f 696e 6369 7263 6c65 725f 6c65  tio_incircler_le
-00024fd0: 6e67 7468 2873 656c 6629 3a0a 2020 2020  ngth(self):.    
-00024fe0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00024ff0: 696e 6369 7263 6c65 5f72 6164 6975 7328  incircle_radius(
-00025000: 2920 2f20 7365 6c66 2e6c 656e 6774 6828  ) / self.length(
-00025010: 290a 0a20 2020 2064 6566 2061 7370 6563  )..    def aspec
-00025020: 745f 7261 7469 6f28 7365 6c66 293a 0a20  t_ratio(self):. 
-00025030: 2020 2020 2020 2061 203d 2073 656c 662e         a = self.
-00025040: 706f 696e 7431 2e70 6f69 6e74 5f64 6973  point1.point_dis
-00025050: 7461 6e63 6528 7365 6c66 2e70 6f69 6e74  tance(self.point
-00025060: 3229 0a20 2020 2020 2020 2062 203d 2073  2).        b = s
-00025070: 656c 662e 706f 696e 7431 2e70 6f69 6e74  elf.point1.point
-00025080: 5f64 6973 7461 6e63 6528 7365 6c66 2e70  _distance(self.p
-00025090: 6f69 6e74 3329 0a20 2020 2020 2020 2063  oint3).        c
-000250a0: 203d 2073 656c 662e 706f 696e 7432 2e70   = self.point2.p
-000250b0: 6f69 6e74 5f64 6973 7461 6e63 6528 7365  oint_distance(se
-000250c0: 6c66 2e70 6f69 6e74 3329 0a20 2020 2020  lf.point3).     
-000250d0: 2020 2073 203d 2030 2e35 202a 2028 6120     s = 0.5 * (a 
-000250e0: 2b20 6220 2b20 6329 0a20 2020 2020 2020  + b + c).       
-000250f0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-00025100: 2020 7265 7475 726e 2030 2e31 3235 202a    return 0.125 *
-00025110: 2061 202a 2062 202a 2063 202f 2028 7320   a * b * c / (s 
-00025120: 2d20 6129 202f 2028 7320 2d20 6229 202f  - a) / (s - b) /
-00025130: 2028 7320 2d20 6329 0a20 2020 2020 2020   (s - c).       
-00025140: 2065 7863 6570 7420 5a65 726f 4469 7669   except ZeroDivi
-00025150: 7369 6f6e 4572 726f 723a 0a20 2020 2020  sionError:.     
-00025160: 2020 2020 2020 2072 6574 7572 6e20 3130         return 10
-00025170: 3030 3030 302e 0a0a 2020 2020 6465 6620  00000...    def 
-00025180: 6178 6961 6c5f 7379 6d6d 6574 7279 2873  axial_symmetry(s
-00025190: 656c 662c 206c 696e 6529 3a0a 2020 2020  elf, line):.    
-000251a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000251b0: 4669 6e64 7320 6f75 7420 7468 6520 7379  Finds out the sy
-000251c0: 6d6d 6574 7269 6320 7472 6961 6e67 6c65  mmetric triangle
-000251d0: 3264 2061 6363 6f72 6469 6e67 2074 6f20  2d according to 
-000251e0: 6120 6c69 6e65 2e0a 0a20 2020 2020 2020  a line...       
-000251f0: 2022 2222 0a0a 2020 2020 2020 2020 5b70   """..        [p
-00025200: 6f69 6e74 312c 2070 6f69 6e74 322c 2070  oint1, point2, p
-00025210: 6f69 6e74 335d 203d 205b 706f 696e 742e  oint3] = [point.
-00025220: 6178 6961 6c5f 7379 6d6d 6574 7279 286c  axial_symmetry(l
-00025230: 696e 6529 0a20 2020 2020 2020 2020 2020  ine).           
+000244f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024500: 2020 2779 6f75 2061 7265 2074 7279 696e    'you are tryin
+00024510: 6720 746f 2073 6577 2061 7265 2076 616c  g to sew are val
+00024520: 6964 206f 6e65 7327 290a 0a20 2020 2064  id ones')..    d
+00024530: 6566 2069 735f 636f 6e76 6578 2873 656c  ef is_convex(sel
+00024540: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
+00024550: 2020 2020 2020 2020 5665 7269 6669 6573          Verifies
+00024560: 2069 6620 6120 706f 6c79 676f 6e20 6973   if a polygon is
+00024570: 2063 6f6e 7665 7820 6f72 204e 6f74 0a20   convex or Not. 
+00024580: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00024590: 2020 2066 6f72 2070 7269 6d31 2c20 7072     for prim1, pr
+000245a0: 696d 3220 696e 207a 6970 2873 656c 662e  im2 in zip(self.
+000245b0: 6c69 6e65 5f73 6567 6d65 6e74 732c 2073  line_segments, s
+000245c0: 656c 662e 6c69 6e65 5f73 6567 6d65 6e74  elf.line_segment
+000245d0: 735b 313a 5d20 2b20 5b73 656c 662e 6c69  s[1:] + [self.li
+000245e0: 6e65 5f73 6567 6d65 6e74 735b 305d 5d29  ne_segments[0]])
+000245f0: 3a0a 2020 2020 2020 2020 2020 2020 7665  :.            ve
+00024600: 6374 6f72 3120 3d20 7072 696d 312e 6469  ctor1 = prim1.di
+00024610: 7265 6374 696f 6e5f 7665 6374 6f72 2829  rection_vector()
+00024620: 0a20 2020 2020 2020 2020 2020 2076 6563  .            vec
+00024630: 746f 7232 203d 2070 7269 6d32 2e64 6972  tor2 = prim2.dir
+00024640: 6563 7469 6f6e 5f76 6563 746f 7228 290a  ection_vector().
+00024650: 2020 2020 2020 2020 2020 2020 616e 676c              angl
+00024660: 6520 3d20 766f 6c6d 646c 722e 6765 6f6d  e = volmdlr.geom
+00024670: 6574 7279 2e63 6c6f 636b 7769 7365 5f61  etry.clockwise_a
+00024680: 6e67 6c65 2876 6563 746f 7231 2c20 7665  ngle(vector1, ve
+00024690: 6374 6f72 3229 0a20 2020 2020 2020 2020  ctor2).         
+000246a0: 2020 2069 6620 7365 6c66 2e69 735f 7472     if self.is_tr
+000246b0: 6967 6f3a 0a20 2020 2020 2020 2020 2020  igo:.           
+000246c0: 2020 2020 2069 6620 616e 676c 6520 3c20       if angle < 
+000246d0: 6d61 7468 2e70 6920 616e 6420 616e 676c  math.pi and angl
+000246e0: 6520 213d 2030 3a0a 2020 2020 2020 2020  e != 0:.        
+000246f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00024700: 726e 2046 616c 7365 0a20 2020 2020 2020  rn False.       
+00024710: 2020 2020 2065 6c69 6620 616e 676c 6520       elif angle 
+00024720: 3e20 6d61 7468 2e70 6920 616e 6420 616e  > math.pi and an
+00024730: 676c 6520 213d 2032 202a 206d 6174 682e  gle != 2 * math.
+00024740: 7069 3a0a 2020 2020 2020 2020 2020 2020  pi:.            
+00024750: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+00024760: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00024770: 5472 7565 0a0a 2020 2020 6465 6620 6178  True..    def ax
+00024780: 6961 6c5f 7379 6d6d 6574 7279 2873 656c  ial_symmetry(sel
+00024790: 662c 206c 696e 6529 3a0a 2020 2020 2020  f, line):.      
+000247a0: 2020 2222 220a 2020 2020 2020 2020 4669    """.        Fi
+000247b0: 6e64 7320 6f75 7420 7468 6520 7379 6d6d  nds out the symm
+000247c0: 6574 7269 6320 636c 6f73 6564 5f70 6f6c  etric closed_pol
+000247d0: 7967 6f6e 3264 2061 6363 6f72 6469 6e67  ygon2d according
+000247e0: 2074 6f20 6120 6c69 6e65 2e0a 0a20 2020   to a line...   
+000247f0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00024800: 2020 6178 6961 6c5f 706f 696e 7473 203d    axial_points =
+00024810: 205b 706f 696e 742e 6178 6961 6c5f 7379   [point.axial_sy
+00024820: 6d6d 6574 7279 286c 696e 6529 2066 6f72  mmetry(line) for
+00024830: 2070 6f69 6e74 2069 6e20 7365 6c66 2e70   point in self.p
+00024840: 6f69 6e74 735d 0a0a 2020 2020 2020 2020  oints]..        
+00024850: 7265 7475 726e 2073 656c 662e 5f5f 636c  return self.__cl
+00024860: 6173 735f 5f28 706f 696e 7473 3d61 7869  ass__(points=axi
+00024870: 616c 5f70 6f69 6e74 7329 0a0a 0a63 6c61  al_points)...cla
+00024880: 7373 2054 7269 616e 676c 6528 436c 6f73  ss Triangle(Clos
+00024890: 6564 506f 6c79 676f 6e4d 6978 696e 293a  edPolygonMixin):
+000248a0: 0a20 2020 2022 2222 0a20 2020 2044 6566  .    """.    Def
+000248b0: 696e 6573 2061 2074 7269 616e 676c 6520  ines a triangle 
+000248c0: 6672 6f6d 2033 2070 6f69 6e74 732e 2049  from 3 points. I
+000248d0: 7420 6973 2061 2053 7570 6572 2043 6c61  t is a Super Cla
+000248e0: 7373 2066 6f72 2054 7269 616e 676c 6532  ss for Triangle2
+000248f0: 4420 616e 6420 5472 6961 6e67 6c65 3344  D and Triangle3D
+00024900: 2c0a 2020 2020 7374 6f72 696e 6720 7468  ,.    storing th
+00024910: 6569 7220 6d61 696e 2061 7474 7269 6275  eir main attribu
+00024920: 7465 2061 6e64 206d 6574 686f 6473 2e0a  te and methods..
+00024930: 0a0a 2020 2020 2222 220a 0a20 2020 2064  ..    """..    d
+00024940: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+00024950: 2c20 706f 696e 7431 2c20 706f 696e 7432  , point1, point2
+00024960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00024970: 2020 2070 6f69 6e74 332c 206e 616d 653a     point3, name:
+00024980: 2073 7472 203d 2027 2729 3a0a 0a20 2020   str = ''):..   
+00024990: 2020 2020 2073 656c 662e 706f 696e 7431       self.point1
+000249a0: 203d 2070 6f69 6e74 310a 2020 2020 2020   = point1.      
+000249b0: 2020 7365 6c66 2e70 6f69 6e74 3220 3d20    self.point2 = 
+000249c0: 706f 696e 7432 0a20 2020 2020 2020 2073  point2.        s
+000249d0: 656c 662e 706f 696e 7433 203d 2070 6f69  elf.point3 = poi
+000249e0: 6e74 330a 2020 2020 2020 2020 7365 6c66  nt3.        self
+000249f0: 2e6e 616d 6520 3d20 6e61 6d65 0a20 2020  .name = name.   
+00024a00: 2020 2020 2073 656c 662e 5f6c 696e 655f       self._line_
+00024a10: 7365 676d 656e 7473 203d 204e 6f6e 650a  segments = None.
+00024a20: 0a0a 636c 6173 7320 5472 6961 6e67 6c65  ..class Triangle
+00024a30: 3244 2843 6c6f 7365 6450 6f6c 7967 6f6e  2D(ClosedPolygon
+00024a40: 3244 293a 0a20 2020 2022 2222 0a20 2020  2D):.    """.   
+00024a50: 2044 6566 696e 6573 2061 2074 7269 616e   Defines a trian
+00024a60: 676c 6520 3244 2e0a 0a20 2020 203a 7061  gle 2D...    :pa
+00024a70: 7261 6d20 706f 696e 7431 3a20 7472 6961  ram point1: tria
+00024a80: 6e67 6c65 2070 6f69 6e74 2031 2e0a 2020  ngle point 1..  
+00024a90: 2020 3a70 6172 616d 2070 6f69 6e74 323a    :param point2:
+00024aa0: 2074 7269 616e 676c 6520 706f 696e 7420   triangle point 
+00024ab0: 322e 0a20 2020 203a 7061 7261 6d20 706f  2..    :param po
+00024ac0: 696e 7433 3a20 7472 6961 6e67 6c65 2070  int3: triangle p
+00024ad0: 6f69 6e74 2033 2e0a 2020 2020 2222 220a  oint 3..    """.
+00024ae0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00024af0: 5f28 7365 6c66 2c20 706f 696e 7431 3a20  _(self, point1: 
+00024b00: 766f 6c6d 646c 722e 506f 696e 7432 442c  volmdlr.Point2D,
+00024b10: 2070 6f69 6e74 323a 2076 6f6c 6d64 6c72   point2: volmdlr
+00024b20: 2e50 6f69 6e74 3244 2c0a 2020 2020 2020  .Point2D,.      
+00024b30: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
+00024b40: 333a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  3: volmdlr.Point
+00024b50: 3244 2c20 6e61 6d65 3a20 7374 7220 3d20  2D, name: str = 
+00024b60: 2727 293a 0a20 2020 2020 2020 2023 2054  ''):.        # T
+00024b70: 4f44 4f3a 2054 6869 7320 7365 656d 7320  ODO: This seems 
+00024b80: 6275 6767 792e 2049 7320 6974 2073 7469  buggy. Is it sti
+00024b90: 6c6c 2075 7365 643f 0a20 2020 2020 2020  ll used?.       
+00024ba0: 2023 2073 656c 662e 706f 696e 7431 203d   # self.point1 =
+00024bb0: 2070 6f69 6e74 310a 2020 2020 2020 2020   point1.        
+00024bc0: 2320 7365 6c66 2e70 6f69 6e74 3220 3d20  # self.point2 = 
+00024bd0: 706f 696e 7432 0a20 2020 2020 2020 2023  point2.        #
+00024be0: 2073 656c 662e 706f 696e 7433 203d 2070   self.point3 = p
+00024bf0: 6f69 6e74 330a 2020 2020 2020 2020 2320  oint3.        # 
+00024c00: 7365 6c66 2e6e 616d 6520 3d20 6e61 6d65  self.name = name
+00024c10: 0a0a 2020 2020 2020 2020 436c 6f73 6564  ..        Closed
+00024c20: 506f 6c79 676f 6e32 442e 5f5f 696e 6974  Polygon2D.__init
+00024c30: 5f5f 2873 656c 662c 2070 6f69 6e74 733d  __(self, points=
+00024c40: 5b70 6f69 6e74 312c 2070 6f69 6e74 322c  [point1, point2,
+00024c50: 2070 6f69 6e74 335d 2c20 6e61 6d65 3d6e   point3], name=n
+00024c60: 616d 6529 0a20 2020 2020 2020 2023 0a20  ame).        #. 
+00024c70: 2020 2020 2020 2023 2054 7269 616e 676c         # Triangl
+00024c80: 652e 5f5f 696e 6974 5f5f 2873 656c 662c  e.__init__(self,
+00024c90: 2070 6f69 6e74 312c 0a20 2020 2020 2020   point1,.       
+00024ca0: 2023 2020 2020 2020 2020 2020 2020 2020   #              
+00024cb0: 2020 2020 2070 6f69 6e74 322c 0a20 2020       point2,.   
+00024cc0: 2020 2020 2023 2020 2020 2020 2020 2020       #          
+00024cd0: 2020 2020 2020 2020 2070 6f69 6e74 332c           point3,
+00024ce0: 0a20 2020 2020 2020 2023 2020 2020 2020  .        #      
+00024cf0: 2020 2020 2020 2020 2020 2020 206e 616d               nam
+00024d00: 6529 0a0a 2020 2020 6465 6620 6172 6561  e)..    def area
+00024d10: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00024d20: 7520 3d20 7365 6c66 2e70 6f69 6e74 3220  u = self.point2 
+00024d30: 2d20 7365 6c66 2e70 6f69 6e74 310a 2020  - self.point1.  
+00024d40: 2020 2020 2020 7620 3d20 7365 6c66 2e70        v = self.p
+00024d50: 6f69 6e74 3320 2d20 7365 6c66 2e70 6f69  oint3 - self.poi
+00024d60: 6e74 310a 2020 2020 2020 2020 7265 7475  nt1.        retu
+00024d70: 726e 2061 6273 2875 2e63 726f 7373 2876  rn abs(u.cross(v
+00024d80: 2929 202f 2032 0a0a 2020 2020 6465 6620  )) / 2..    def 
+00024d90: 696e 6369 7263 6c65 5f72 6164 6975 7328  incircle_radius(
+00024da0: 7365 6c66 293a 0a20 2020 2020 2020 2061  self):.        a
+00024db0: 203d 2073 656c 662e 706f 696e 7431 2e70   = self.point1.p
+00024dc0: 6f69 6e74 5f64 6973 7461 6e63 6528 7365  oint_distance(se
+00024dd0: 6c66 2e70 6f69 6e74 3229 0a20 2020 2020  lf.point2).     
+00024de0: 2020 2062 203d 2073 656c 662e 706f 696e     b = self.poin
+00024df0: 7431 2e70 6f69 6e74 5f64 6973 7461 6e63  t1.point_distanc
+00024e00: 6528 7365 6c66 2e70 6f69 6e74 3329 0a20  e(self.point3). 
+00024e10: 2020 2020 2020 2063 203d 2073 656c 662e         c = self.
+00024e20: 706f 696e 7432 2e70 6f69 6e74 5f64 6973  point2.point_dis
+00024e30: 7461 6e63 6528 7365 6c66 2e70 6f69 6e74  tance(self.point
+00024e40: 3329 0a20 2020 2020 2020 2072 6574 7572  3).        retur
+00024e50: 6e20 3220 2a20 7365 6c66 2e61 7265 6128  n 2 * self.area(
+00024e60: 2920 2f20 2861 202b 2062 202b 2063 290a  ) / (a + b + c).
+00024e70: 0a20 2020 2064 6566 2063 6972 6375 6d63  .    def circumc
+00024e80: 6972 636c 655f 7261 6469 7573 2873 656c  ircle_radius(sel
+00024e90: 6629 3a0a 2020 2020 2020 2020 6120 3d20  f):.        a = 
+00024ea0: 7365 6c66 2e70 6f69 6e74 312e 706f 696e  self.point1.poin
+00024eb0: 745f 6469 7374 616e 6365 2873 656c 662e  t_distance(self.
+00024ec0: 706f 696e 7432 290a 2020 2020 2020 2020  point2).        
+00024ed0: 6220 3d20 7365 6c66 2e70 6f69 6e74 312e  b = self.point1.
+00024ee0: 706f 696e 745f 6469 7374 616e 6365 2873  point_distance(s
+00024ef0: 656c 662e 706f 696e 7433 290a 2020 2020  elf.point3).    
+00024f00: 2020 2020 6320 3d20 7365 6c66 2e70 6f69      c = self.poi
+00024f10: 6e74 322e 706f 696e 745f 6469 7374 616e  nt2.point_distan
+00024f20: 6365 2873 656c 662e 706f 696e 7433 290a  ce(self.point3).
+00024f30: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00024f40: 202a 2062 202a 2063 202f 2028 7365 6c66   * b * c / (self
+00024f50: 2e61 7265 6128 2920 2a20 342e 3029 0a0a  .area() * 4.0)..
+00024f60: 2020 2020 6465 6620 7261 7469 6f5f 6369      def ratio_ci
+00024f70: 7263 756d 725f 6c65 6e67 7468 2873 656c  rcumr_length(sel
+00024f80: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00024f90: 726e 2073 656c 662e 6369 7263 756d 6369  rn self.circumci
+00024fa0: 7263 6c65 5f72 6164 6975 7328 2920 2f20  rcle_radius() / 
+00024fb0: 7365 6c66 2e6c 656e 6774 6828 290a 0a20  self.length().. 
+00024fc0: 2020 2064 6566 2072 6174 696f 5f69 6e63     def ratio_inc
+00024fd0: 6972 636c 6572 5f6c 656e 6774 6828 7365  ircler_length(se
+00024fe0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00024ff0: 7572 6e20 7365 6c66 2e69 6e63 6972 636c  urn self.incircl
+00025000: 655f 7261 6469 7573 2829 202f 2073 656c  e_radius() / sel
+00025010: 662e 6c65 6e67 7468 2829 0a0a 2020 2020  f.length()..    
+00025020: 6465 6620 6173 7065 6374 5f72 6174 696f  def aspect_ratio
+00025030: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00025040: 6120 3d20 7365 6c66 2e70 6f69 6e74 312e  a = self.point1.
+00025050: 706f 696e 745f 6469 7374 616e 6365 2873  point_distance(s
+00025060: 656c 662e 706f 696e 7432 290a 2020 2020  elf.point2).    
+00025070: 2020 2020 6220 3d20 7365 6c66 2e70 6f69      b = self.poi
+00025080: 6e74 312e 706f 696e 745f 6469 7374 616e  nt1.point_distan
+00025090: 6365 2873 656c 662e 706f 696e 7433 290a  ce(self.point3).
+000250a0: 2020 2020 2020 2020 6320 3d20 7365 6c66          c = self
+000250b0: 2e70 6f69 6e74 322e 706f 696e 745f 6469  .point2.point_di
+000250c0: 7374 616e 6365 2873 656c 662e 706f 696e  stance(self.poin
+000250d0: 7433 290a 2020 2020 2020 2020 7320 3d20  t3).        s = 
+000250e0: 302e 3520 2a20 2861 202b 2062 202b 2063  0.5 * (a + b + c
+000250f0: 290a 2020 2020 2020 2020 7472 793a 0a20  ).        try:. 
+00025100: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00025110: 6e20 302e 3132 3520 2a20 6120 2a20 6220  n 0.125 * a * b 
+00025120: 2a20 6320 2f20 2873 202d 2061 2920 2f20  * c / (s - a) / 
+00025130: 2873 202d 2062 2920 2f20 2873 202d 2063  (s - b) / (s - c
+00025140: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+00025150: 205a 6572 6f44 6976 6973 696f 6e45 7272   ZeroDivisionErr
+00025160: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00025170: 7265 7475 726e 2031 3030 3030 3030 2e0a  return 1000000..
+00025180: 0a20 2020 2064 6566 2061 7869 616c 5f73  .    def axial_s
+00025190: 796d 6d65 7472 7928 7365 6c66 2c20 6c69  ymmetry(self, li
+000251a0: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
+000251b0: 0a20 2020 2020 2020 2046 696e 6473 206f  .        Finds o
+000251c0: 7574 2074 6865 2073 796d 6d65 7472 6963  ut the symmetric
+000251d0: 2074 7269 616e 676c 6532 6420 6163 636f   triangle2d acco
+000251e0: 7264 696e 6720 746f 2061 206c 696e 652e  rding to a line.
+000251f0: 0a0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00025200: 2020 2020 2020 205b 706f 696e 7431 2c20         [point1, 
+00025210: 706f 696e 7432 2c20 706f 696e 7433 5d20  point2, point3] 
+00025220: 3d20 5b70 6f69 6e74 2e61 7869 616c 5f73  = [point.axial_s
+00025230: 796d 6d65 7472 7928 6c69 6e65 290a 2020  ymmetry(line).  
 00025240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025250: 2020 2020 2020 2020 2066 6f72 2070 6f69           for poi
-00025260: 6e74 2069 6e20 5b73 656c 662e 706f 696e  nt in [self.poin
-00025270: 7431 2c0a 2020 2020 2020 2020 2020 2020  t1,.            
+00025250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025260: 2020 666f 7220 706f 696e 7420 696e 205b    for point in [
+00025270: 7365 6c66 2e70 6f69 6e74 312c 0a20 2020  self.point1,.   
 00025280: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00025290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000252a0: 2020 2020 2020 7365 6c66 2e70 6f69 6e74        self.point
-000252b0: 322c 0a20 2020 2020 2020 2020 2020 2020  2,.             
+000252a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000252b0: 656c 662e 706f 696e 7432 2c0a 2020 2020  elf.point2,.    
 000252c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000252d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000252e0: 2020 2020 2073 656c 662e 706f 696e 7433       self.point3
-000252f0: 5d5d 0a0a 2020 2020 2020 2020 7265 7475  ]]..        retu
-00025300: 726e 2073 656c 662e 5f5f 636c 6173 735f  rn self.__class_
-00025310: 5f28 706f 696e 7431 2c20 706f 696e 7432  _(point1, point2
-00025320: 2c20 706f 696e 7433 290a 0a0a 636c 6173  , point3)...clas
-00025330: 7320 4369 7263 6c65 3244 2843 6f6e 746f  s Circle2D(Conto
-00025340: 7572 3244 293a 0a20 2020 2022 2222 0a20  ur2D):.    """. 
-00025350: 2020 2044 6566 696e 6573 2061 2043 6972     Defines a Cir
-00025360: 636c 6520 696e 2074 776f 2064 696d 656e  cle in two dimen
-00025370: 7369 6f6e 732c 2077 6974 6820 6120 6365  sions, with a ce
-00025380: 6e74 6572 2061 6e64 2061 2072 6164 6975  nter and a radiu
-00025390: 732e 0a0a 2020 2020 2222 220a 2020 2020  s...    """.    
-000253a0: 5f6e 6f6e 5f73 6572 6961 6c69 7a61 626c  _non_serializabl
-000253b0: 655f 6174 7472 6962 7574 6573 203d 205b  e_attributes = [
-000253c0: 2769 6e74 6572 6e61 6c5f 6172 6373 272c  'internal_arcs',
-000253d0: 2027 6578 7465 726e 616c 5f61 7263 7327   'external_arcs'
-000253e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000252e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000252f0: 6c66 2e70 6f69 6e74 335d 5d0a 0a20 2020  lf.point3]]..   
+00025300: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00025310: 2e5f 5f63 6c61 7373 5f5f 2870 6f69 6e74  .__class__(point
+00025320: 312c 2070 6f69 6e74 322c 2070 6f69 6e74  1, point2, point
+00025330: 3329 0a0a 0a63 6c61 7373 2043 6972 636c  3)...class Circl
+00025340: 6532 4428 436f 6e74 6f75 7232 4429 3a0a  e2D(Contour2D):.
+00025350: 2020 2020 2222 220a 2020 2020 4465 6669      """.    Defi
+00025360: 6e65 7320 6120 4369 7263 6c65 2069 6e20  nes a Circle in 
+00025370: 7477 6f20 6469 6d65 6e73 696f 6e73 2c20  two dimensions, 
+00025380: 7769 7468 2061 2063 656e 7465 7220 616e  with a center an
+00025390: 6420 6120 7261 6469 7573 2e0a 0a20 2020  d a radius...   
+000253a0: 2022 2222 0a20 2020 205f 6e6f 6e5f 7365   """.    _non_se
+000253b0: 7269 616c 697a 6162 6c65 5f61 7474 7269  rializable_attri
+000253c0: 6275 7465 7320 3d20 5b27 696e 7465 726e  butes = ['intern
+000253d0: 616c 5f61 7263 7327 2c20 2765 7874 6572  al_arcs', 'exter
+000253e0: 6e61 6c5f 6172 6373 272c 0a20 2020 2020  nal_arcs',.     
 000253f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025400: 2020 2020 2020 2770 6f6c 7967 6f6e 272c        'polygon',
-00025410: 2027 7374 7261 6967 6874 5f6c 696e 655f   'straight_line_
-00025420: 636f 6e74 6f75 725f 706f 6c79 676f 6e27  contour_polygon'
-00025430: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00025400: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00025410: 706f 6c79 676f 6e27 2c20 2773 7472 6169  polygon', 'strai
+00025420: 6768 745f 6c69 6e65 5f63 6f6e 746f 7572  ght_line_contour
+00025430: 5f70 6f6c 7967 6f6e 272c 0a20 2020 2020  _polygon',.     
 00025440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025450: 2020 2020 2020 2770 7269 6d69 7469 7665        'primitive
-00025460: 7327 2c20 2762 6173 6973 5f70 7269 6d69  s', 'basis_primi
-00025470: 7469 7665 7327 5d0a 0a20 2020 2064 6566  tives']..    def
-00025480: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-00025490: 6365 6e74 6572 3a20 766f 6c6d 646c 722e  center: volmdlr.
-000254a0: 506f 696e 7432 442c 2072 6164 6975 733a  Point2D, radius:
-000254b0: 2066 6c6f 6174 2c20 6e61 6d65 3a20 7374   float, name: st
-000254c0: 7220 3d20 2727 293a 0a20 2020 2020 2020  r = ''):.       
-000254d0: 2073 656c 662e 6365 6e74 6572 203d 2063   self.center = c
-000254e0: 656e 7465 720a 2020 2020 2020 2020 7365  enter.        se
-000254f0: 6c66 2e72 6164 6975 7320 3d20 7261 6469  lf.radius = radi
-00025500: 7573 0a20 2020 2020 2020 2073 656c 662e  us.        self.
-00025510: 616e 676c 6520 3d20 766f 6c6d 646c 722e  angle = volmdlr.
-00025520: 5457 4f5f 5049 0a20 2020 2020 2020 2073  TWO_PI.        s
-00025530: 656c 662e 7072 696d 6974 6976 6573 203d  elf.primitives =
-00025540: 2073 656c 662e 5f70 7269 6d69 7469 7665   self._primitive
-00025550: 7328 290a 0a20 2020 2020 2020 2023 2073  s()..        # s
-00025560: 656c 662e 706f 696e 7473 203d 2073 656c  elf.points = sel
-00025570: 662e 7465 7373 656c 6c61 7469 6f6e 5f70  f.tessellation_p
-00025580: 6f69 6e74 7328 290a 0a20 2020 2020 2020  oints()..       
-00025590: 2043 6f6e 746f 7572 3244 2e5f 5f69 6e69   Contour2D.__ini
-000255a0: 745f 5f28 7365 6c66 2c20 7365 6c66 2e70  t__(self, self.p
-000255b0: 7269 6d69 7469 7665 732c 206e 616d 653d  rimitives, name=
-000255c0: 6e61 6d65 2920 2023 2021 2121 2074 6869  name)  # !!! thi
-000255d0: 7320 6973 2064 616e 6765 726f 7573 0a0a  s is dangerous..
-000255e0: 2020 2020 6465 6620 5f5f 6861 7368 5f5f      def __hash__
-000255f0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00025600: 7265 7475 726e 2069 6e74 2872 6f75 6e64  return int(round
-00025610: 2831 6536 202a 2028 7365 6c66 2e63 656e  (1e6 * (self.cen
-00025620: 7465 722e 7820 2b20 7365 6c66 2e63 656e  ter.x + self.cen
-00025630: 7465 722e 7920 2b20 7365 6c66 2e72 6164  ter.y + self.rad
-00025640: 6975 7329 2929 0a0a 2020 2020 6465 6620  ius)))..    def 
-00025650: 5f5f 6571 5f5f 2873 656c 662c 206f 7468  __eq__(self, oth
-00025660: 6572 5f63 6972 636c 6529 3a0a 2020 2020  er_circle):.    
-00025670: 2020 2020 6966 2073 656c 662e 5f5f 636c      if self.__cl
-00025680: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2021  ass__.__name__ !
-00025690: 3d20 6f74 6865 725f 6369 7263 6c65 2e5f  = other_circle._
-000256a0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
-000256b0: 5f3a 0a20 2020 2020 2020 2020 2020 2072  _:.            r
-000256c0: 6574 7572 6e20 4661 6c73 650a 0a20 2020  eturn False..   
-000256d0: 2020 2020 2072 6574 7572 6e20 6d61 7468       return math
-000256e0: 2e69 7363 6c6f 7365 2873 656c 662e 6365  .isclose(self.ce
-000256f0: 6e74 6572 2e78 2c0a 2020 2020 2020 2020  nter.x,.        
-00025700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025710: 2020 2020 6f74 6865 725f 6369 7263 6c65      other_circle
-00025720: 2e63 656e 7465 722e 782c 2061 6273 5f74  .center.x, abs_t
-00025730: 6f6c 3d31 652d 3036 2920 5c0a 2020 2020  ol=1e-06) \.    
-00025740: 2020 2020 2020 2020 616e 6420 6d61 7468          and math
-00025750: 2e69 7363 6c6f 7365 2873 656c 662e 6365  .isclose(self.ce
-00025760: 6e74 6572 2e79 2c0a 2020 2020 2020 2020  nter.y,.        
-00025770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025780: 2020 2020 206f 7468 6572 5f63 6972 636c       other_circl
-00025790: 652e 6365 6e74 6572 2e79 2c20 6162 735f  e.center.y, abs_
-000257a0: 746f 6c3d 3165 2d30 3629 205c 0a20 2020  tol=1e-06) \.   
-000257b0: 2020 2020 2020 2020 2061 6e64 206d 6174           and mat
-000257c0: 682e 6973 636c 6f73 6528 7365 6c66 2e72  h.isclose(self.r
-000257d0: 6164 6975 732c 206f 7468 6572 5f63 6972  adius, other_cir
-000257e0: 636c 652e 7261 6469 7573 2c0a 2020 2020  cle.radius,.    
-000257f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025800: 2020 2020 2020 2020 2061 6273 5f74 6f6c           abs_tol
-00025810: 3d31 652d 3036 290a 0a20 2020 2064 6566  =1e-06)..    def
-00025820: 205f 7072 696d 6974 6976 6573 2873 656c   _primitives(sel
-00025830: 6629 3a0a 2020 2020 2020 2020 706f 696e  f):.        poin
-00025840: 7473 203d 205b 0a20 2020 2020 2020 2020  ts = [.         
-00025850: 2020 2076 6f6c 6d64 6c72 2e50 6f69 6e74     volmdlr.Point
-00025860: 3244 2873 656c 662e 6365 6e74 6572 2e78  2D(self.center.x
-00025870: 202b 2073 656c 662e 7261 6469 7573 2c20   + self.radius, 
-00025880: 7365 6c66 2e63 656e 7465 722e 7929 2c0a  self.center.y),.
-00025890: 2020 2020 2020 2020 2020 2020 766f 6c6d              volm
-000258a0: 646c 722e 506f 696e 7432 4428 7365 6c66  dlr.Point2D(self
-000258b0: 2e63 656e 7465 722e 782c 2073 656c 662e  .center.x, self.
-000258c0: 6365 6e74 6572 2e79 202d 2073 656c 662e  center.y - self.
-000258d0: 7261 6469 7573 292c 0a20 2020 2020 2020  radius),.       
-000258e0: 2020 2020 2076 6f6c 6d64 6c72 2e50 6f69       volmdlr.Poi
-000258f0: 6e74 3244 2873 656c 662e 6365 6e74 6572  nt2D(self.center
-00025900: 2e78 202d 2073 656c 662e 7261 6469 7573  .x - self.radius
-00025910: 2c20 7365 6c66 2e63 656e 7465 722e 7929  , self.center.y)
-00025920: 2c0a 2020 2020 2020 2020 2020 2020 766f  ,.            vo
-00025930: 6c6d 646c 722e 506f 696e 7432 4428 7365  lmdlr.Point2D(se
-00025940: 6c66 2e63 656e 7465 722e 782c 2073 656c  lf.center.x, sel
-00025950: 662e 6365 6e74 6572 2e79 202b 2073 656c  f.center.y + sel
-00025960: 662e 7261 6469 7573 295d 0a0a 2020 2020  f.radius)]..    
-00025970: 2020 2020 7265 7475 726e 205b 766f 6c6d      return [volm
-00025980: 646c 722e 6564 6765 732e 4172 6332 4428  dlr.edges.Arc2D(
-00025990: 706f 696e 7473 5b30 5d2c 2070 6f69 6e74  points[0], point
-000259a0: 735b 315d 2c20 706f 696e 7473 5b32 5d29  s[1], points[2])
-000259b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000259c0: 2020 766f 6c6d 646c 722e 6564 6765 732e    volmdlr.edges.
-000259d0: 4172 6332 4428 706f 696e 7473 5b32 5d2c  Arc2D(points[2],
-000259e0: 2070 6f69 6e74 735b 335d 2c20 706f 696e   points[3], poin
-000259f0: 7473 5b30 5d29 5d0a 0a20 2020 2040 636c  ts[0])]..    @cl
-00025a00: 6173 736d 6574 686f 640a 2020 2020 6465  assmethod.    de
-00025a10: 6620 6672 6f6d 5f61 7263 2863 6c73 2c20  f from_arc(cls, 
-00025a20: 6172 633a 2076 6f6c 6d64 6c72 2e65 6467  arc: volmdlr.edg
-00025a30: 6573 2e41 7263 3244 293a 0a20 2020 2020  es.Arc2D):.     
-00025a40: 2020 2072 6574 7572 6e20 636c 7328 6172     return cls(ar
-00025a50: 632e 6365 6e74 6572 2c20 6172 632e 7261  c.center, arc.ra
-00025a60: 6469 7573 2c20 6172 632e 6e61 6d65 202b  dius, arc.name +
-00025a70: 2027 2074 6f20 6369 7263 6c65 2729 0a0a   ' to circle')..
-00025a80: 2020 2020 6465 6620 706f 696e 745f 6265      def point_be
-00025a90: 6c6f 6e67 7328 7365 6c66 2c20 706f 696e  longs(self, poin
-00025aa0: 742c 2069 6e63 6c75 6465 5f65 6467 655f  t, include_edge_
-00025ab0: 706f 696e 7473 3a20 626f 6f6c 203d 2046  points: bool = F
-00025ac0: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
-00025ad0: 2222 0a20 2020 2020 2020 2056 6572 6966  "".        Verif
-00025ae0: 6965 7320 6966 2061 2070 6f69 6e74 2069  ies if a point i
-00025af0: 7320 696e 7369 6465 2074 6865 2043 6972  s inside the Cir
-00025b00: 636c 6532 442e 0a0a 2020 2020 2020 2020  cle2D...        
-00025b10: 3a70 6172 616d 2070 6f69 6e74 3a20 4120  :param point: A 
-00025b20: 3244 2070 6f69 6e74 2074 6f20 6368 6563  2D point to chec
-00025b30: 6b20 6966 2069 7420 6973 2069 6e73 6964  k if it is insid
-00025b40: 6520 7468 6520 4369 7263 6c65 3244 2e0a  e the Circle2D..
-00025b50: 2020 2020 2020 2020 3a74 7970 6520 706f          :type po
-00025b60: 696e 743a 2060 766f 6c6d 646c 722e 506f  int: `volmdlr.Po
-00025b70: 696e 7432 4460 0a20 2020 2020 2020 203a  int2D`.        :
-00025b80: 7061 7261 6d20 696e 636c 7564 655f 6564  param include_ed
-00025b90: 6765 5f70 6f69 6e74 733a 2041 2062 6f6f  ge_points: A boo
-00025ba0: 6c65 616e 2069 6e64 6963 6174 696e 6720  lean indicating 
-00025bb0: 7768 6574 6865 7220 706f 696e 7473 206f  whether points o
-00025bc0: 6e20 7468 6520 6564 6765 206f 6620 7468  n the edge of th
-00025bd0: 6520 4369 7263 6c65 3244 0a20 2020 2020  e Circle2D.     
-00025be0: 2020 2020 2020 2073 686f 756c 6420 6265         should be
-00025bf0: 2063 6f6e 7369 6465 7265 6420 696e 7369   considered insi
-00025c00: 6465 2074 6865 2063 6972 636c 652e 0a20  de the circle.. 
-00025c10: 2020 2020 2020 203a 7479 7065 2069 6e63         :type inc
-00025c20: 6c75 6465 5f65 6467 655f 706f 696e 7473  lude_edge_points
-00025c30: 3a20 626f 6f6c 0a20 2020 2020 2020 203a  : bool.        :
-00025c40: 7265 7475 726e 3a20 5472 7565 2069 6620  return: True if 
-00025c50: 706f 696e 7420 696e 7369 6465 2074 6865  point inside the
-00025c60: 2063 6972 636c 6520 6f72 2066 616c 7365   circle or false
-00025c70: 206f 7468 6572 7769 7365 2e0a 2020 2020   otherwise..    
-00025c80: 2020 2020 3a72 7479 7065 3a20 626f 6f6c      :rtype: bool
-00025c90: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00025ca0: 2020 2020 2020 6966 2069 6e63 6c75 6465        if include
-00025cb0: 5f65 6467 655f 706f 696e 7473 3a0a 2020  _edge_points:.  
-00025cc0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00025cd0: 2070 6f69 6e74 2e70 6f69 6e74 5f64 6973   point.point_dis
-00025ce0: 7461 6e63 6528 7365 6c66 2e63 656e 7465  tance(self.cente
-00025cf0: 7229 203c 3d20 7365 6c66 2e72 6164 6975  r) <= self.radiu
-00025d00: 730a 2020 2020 2020 2020 7265 7475 726e  s.        return
-00025d10: 2070 6f69 6e74 2e70 6f69 6e74 5f64 6973   point.point_dis
-00025d20: 7461 6e63 6528 7365 6c66 2e63 656e 7465  tance(self.cente
-00025d30: 7229 203c 2073 656c 662e 7261 6469 7573  r) < self.radius
-00025d40: 0a0a 2020 2020 6465 6620 6765 745f 626f  ..    def get_bo
-00025d50: 756e 6469 6e67 5f72 6563 7461 6e67 6c65  unding_rectangle
-00025d60: 2873 656c 6629 3a0a 0a20 2020 2020 2020  (self):..       
-00025d70: 2078 5f6d 696e 203d 2073 656c 662e 6365   x_min = self.ce
-00025d80: 6e74 6572 2e78 202d 2073 656c 662e 7261  nter.x - self.ra
-00025d90: 6469 7573 0a20 2020 2020 2020 2078 5f6d  dius.        x_m
-00025da0: 6178 203d 2073 656c 662e 6365 6e74 6572  ax = self.center
-00025db0: 2e78 202b 2073 656c 662e 7261 6469 7573  .x + self.radius
-00025dc0: 0a20 2020 2020 2020 2079 5f6d 696e 203d  .        y_min =
-00025dd0: 2073 656c 662e 6365 6e74 6572 2e79 202d   self.center.y -
-00025de0: 2073 656c 662e 7261 6469 7573 0a20 2020   self.radius.   
-00025df0: 2020 2020 2079 5f6d 6178 203d 2073 656c       y_max = sel
-00025e00: 662e 6365 6e74 6572 2e79 202b 2073 656c  f.center.y + sel
-00025e10: 662e 7261 6469 7573 0a20 2020 2020 2020  f.radius.       
-00025e20: 2072 6574 7572 6e20 766f 6c6d 646c 722e   return volmdlr.
-00025e30: 636f 7265 2e42 6f75 6e64 696e 6752 6563  core.BoundingRec
-00025e40: 7461 6e67 6c65 2878 5f6d 696e 2c20 785f  tangle(x_min, x_
-00025e50: 6d61 782c 2079 5f6d 696e 2c20 795f 6d61  max, y_min, y_ma
-00025e60: 7829 0a0a 2020 2020 6465 6620 6c69 6e65  x)..    def line
-00025e70: 5f69 6e74 6572 7365 6374 696f 6e73 2873  _intersections(s
-00025e80: 656c 662c 206c 696e 653a 2076 6f6c 6d64  elf, line: volmd
-00025e90: 6c72 2e65 6467 6573 2e4c 696e 6532 442c  lr.edges.Line2D,
-00025ea0: 2074 6f6c 3d31 652d 3929 3a0a 2020 2020   tol=1e-9):.    
-00025eb0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00025ec0: 4361 6c63 756c 6174 6573 2074 6865 2069  Calculates the i
-00025ed0: 6e74 6572 7365 6374 696f 6e73 2062 6574  ntersections bet
-00025ee0: 7765 656e 2061 2063 6972 636c 6520 3244  ween a circle 2D
-00025ef0: 2061 6e64 204c 696e 6520 3244 2e0a 0a20   and Line 2D... 
-00025f00: 2020 2020 2020 203a 7061 7261 6d20 6c69         :param li
-00025f10: 6e65 3a20 6c69 6e65 2074 6f20 6361 6c63  ne: line to calc
-00025f20: 756c 6174 6520 696e 7465 7273 6563 7469  ulate intersecti
-00025f30: 6f6e 730a 2020 2020 2020 2020 3a70 6172  ons.        :par
-00025f40: 616d 2074 6f6c 3a20 746f 6c65 7261 6e63  am tol: toleranc
-00025f50: 6520 746f 2063 6f6e 7369 6465 7220 696e  e to consider in
-00025f60: 2063 616c 6375 6c61 7469 6f6e 732e 0a20   calculations.. 
-00025f70: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-00025f80: 6369 7263 6c65 2061 6e64 206c 696e 6520  circle and line 
-00025f90: 696e 7465 7273 6563 7469 6f6e 732e 0a20  intersections.. 
-00025fa0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00025fb0: 2020 2066 756c 6c5f 6172 635f 3264 203d     full_arc_2d =
-00025fc0: 2076 6f6c 6d64 6c72 2e65 6467 6573 2e46   volmdlr.edges.F
-00025fd0: 756c 6c41 7263 3244 280a 2020 2020 2020  ullArc2D(.      
-00025fe0: 2020 2020 2020 6365 6e74 6572 3d73 656c        center=sel
-00025ff0: 662e 6365 6e74 6572 2c20 7374 6172 745f  f.center, start_
-00026000: 656e 643d 7365 6c66 2e70 6f69 6e74 5f61  end=self.point_a
-00026010: 745f 6162 7363 6973 7361 2830 292c 0a20  t_abscissa(0),. 
-00026020: 2020 2020 2020 2020 2020 206e 616d 653d             name=
-00026030: 7365 6c66 2e6e 616d 6529 0a20 2020 2020  self.name).     
-00026040: 2020 2072 6574 7572 6e20 6675 6c6c 5f61     return full_a
-00026050: 7263 5f32 642e 6c69 6e65 5f69 6e74 6572  rc_2d.line_inter
-00026060: 7365 6374 696f 6e73 286c 696e 652c 2074  sections(line, t
-00026070: 6f6c 290a 0a20 2020 2064 6566 206c 696e  ol)..    def lin
-00026080: 6573 6567 6d65 6e74 5f69 6e74 6572 7365  esegment_interse
-00026090: 6374 696f 6e73 2873 656c 662c 206c 696e  ctions(self, lin
-000260a0: 6573 6567 6d65 6e74 3a20 766f 6c6d 646c  esegment: volmdl
-000260b0: 722e 6564 6765 732e 4c69 6e65 5365 676d  r.edges.LineSegm
-000260c0: 656e 7432 442c 2074 6f6c 3d31 652d 3929  ent2D, tol=1e-9)
-000260d0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000260e0: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
-000260f0: 2074 6865 2069 6e74 6572 7365 6374 696f   the intersectio
-00026100: 6e73 2062 6574 7765 656e 2061 2063 6972  ns between a cir
-00026110: 636c 6520 3244 2061 6e64 204c 696e 6553  cle 2D and LineS
-00026120: 6567 6d65 6e74 2032 442e 0a0a 2020 2020  egment 2D...    
-00026130: 2020 2020 3a70 6172 616d 206c 696e 6573      :param lines
-00026140: 6567 6d65 6e74 3a20 6c69 6e65 7365 676d  egment: linesegm
-00026150: 656e 7420 746f 2063 616c 6375 6c61 7465  ent to calculate
-00026160: 2069 6e74 6572 7365 6374 696f 6e73 0a20   intersections. 
-00026170: 2020 2020 2020 203a 7061 7261 6d20 746f         :param to
-00026180: 6c3a 2074 6f6c 6572 616e 6365 2074 6f20  l: tolerance to 
-00026190: 636f 6e73 6964 6572 2069 6e20 6361 6c63  consider in calc
-000261a0: 756c 6174 696f 6e73 2e0a 2020 2020 2020  ulations..      
-000261b0: 2020 3a72 6574 7572 6e3a 2063 6972 636c    :return: circl
-000261c0: 6520 616e 6420 6c69 6e65 7365 676d 656e  e and linesegmen
-000261d0: 7420 696e 7465 7273 6563 7469 6f6e 732e  t intersections.
-000261e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000261f0: 2020 2020 2066 756c 6c5f 6172 635f 3264       full_arc_2d
-00026200: 203d 2076 6f6c 6d64 6c72 2e65 6467 6573   = volmdlr.edges
-00026210: 2e46 756c 6c41 7263 3244 280a 2020 2020  .FullArc2D(.    
-00026220: 2020 2020 2020 2020 6365 6e74 6572 3d73          center=s
-00026230: 656c 662e 6365 6e74 6572 2c20 7374 6172  elf.center, star
-00026240: 745f 656e 643d 7365 6c66 2e70 6f69 6e74  t_end=self.point
-00026250: 5f61 745f 6162 7363 6973 7361 2830 292c  _at_abscissa(0),
-00026260: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00026270: 653d 7365 6c66 2e6e 616d 6529 0a20 2020  e=self.name).   
-00026280: 2020 2020 2072 6574 7572 6e20 6675 6c6c       return full
-00026290: 5f61 7263 5f32 642e 6c69 6e65 7365 676d  _arc_2d.linesegm
-000262a0: 656e 745f 696e 7465 7273 6563 7469 6f6e  ent_intersection
-000262b0: 7328 6c69 6e65 7365 676d 656e 742c 2074  s(linesegment, t
-000262c0: 6f6c 290a 0a20 2020 2064 6566 2063 7574  ol)..    def cut
-000262d0: 5f62 795f 6c69 6e65 2873 656c 662c 206c  _by_line(self, l
-000262e0: 696e 653a 2076 6f6c 6d64 6c72 2e65 6467  ine: volmdlr.edg
-000262f0: 6573 2e4c 696e 6532 4429 3a0a 2020 2020  es.Line2D):.    
-00026300: 2020 2020 696e 7465 7273 6563 7469 6f6e      intersection
-00026310: 5f70 6f69 6e74 7320 3d20 7365 6c66 2e6c  _points = self.l
-00026320: 696e 655f 696e 7465 7273 6563 7469 6f6e  ine_intersection
-00026330: 7328 6c69 6e65 290a 2020 2020 2020 2020  s(line).        
-00026340: 6966 206e 6f74 2069 6e74 6572 7365 6374  if not intersect
-00026350: 696f 6e5f 706f 696e 7473 3a0a 2020 2020  ion_points:.    
-00026360: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-00026370: 7365 6c66 5d0a 2020 2020 2020 2020 6966  self].        if
-00026380: 206c 656e 2869 6e74 6572 7365 6374 696f   len(intersectio
-00026390: 6e5f 706f 696e 7473 2920 3d3d 2031 3a0a  n_points) == 1:.
-000263a0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000263b0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-000263c0: 4572 726f 720a 2020 2020 2020 2020 6966  Error.        if
-000263d0: 206c 656e 2869 6e74 6572 7365 6374 696f   len(intersectio
-000263e0: 6e5f 706f 696e 7473 2920 3d3d 2032 3a0a  n_points) == 2:.
-000263f0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-00026400: 7365 676d 656e 7420 3d20 766f 6c6d 646c  segment = volmdl
-00026410: 722e 6564 6765 732e 4c69 6e65 5365 676d  r.edges.LineSegm
-00026420: 656e 7432 4428 696e 7465 7273 6563 7469  ent2D(intersecti
-00026430: 6f6e 5f70 6f69 6e74 735b 305d 2c0a 2020  on_points[0],.  
-00026440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025450: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00025460: 7072 696d 6974 6976 6573 272c 2027 6261  primitives', 'ba
+00025470: 7369 735f 7072 696d 6974 6976 6573 275d  sis_primitives']
+00025480: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+00025490: 5f5f 2873 656c 662c 2063 656e 7465 723a  __(self, center:
+000254a0: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3244   volmdlr.Point2D
+000254b0: 2c20 7261 6469 7573 3a20 666c 6f61 742c  , radius: float,
+000254c0: 206e 616d 653a 2073 7472 203d 2027 2729   name: str = '')
+000254d0: 3a0a 2020 2020 2020 2020 7365 6c66 2e63  :.        self.c
+000254e0: 656e 7465 7220 3d20 6365 6e74 6572 0a20  enter = center. 
+000254f0: 2020 2020 2020 2073 656c 662e 7261 6469         self.radi
+00025500: 7573 203d 2072 6164 6975 730a 2020 2020  us = radius.    
+00025510: 2020 2020 7365 6c66 2e61 6e67 6c65 203d      self.angle =
+00025520: 2076 6f6c 6d64 6c72 2e54 574f 5f50 490a   volmdlr.TWO_PI.
+00025530: 2020 2020 2020 2020 7365 6c66 2e70 7269          self.pri
+00025540: 6d69 7469 7665 7320 3d20 7365 6c66 2e5f  mitives = self._
+00025550: 7072 696d 6974 6976 6573 2829 0a0a 2020  primitives()..  
+00025560: 2020 2020 2020 2320 7365 6c66 2e70 6f69        # self.poi
+00025570: 6e74 7320 3d20 7365 6c66 2e74 6573 7365  nts = self.tesse
+00025580: 6c6c 6174 696f 6e5f 706f 696e 7473 2829  llation_points()
+00025590: 0a0a 2020 2020 2020 2020 436f 6e74 6f75  ..        Contou
+000255a0: 7232 442e 5f5f 696e 6974 5f5f 2873 656c  r2D.__init__(sel
+000255b0: 662c 2073 656c 662e 7072 696d 6974 6976  f, self.primitiv
+000255c0: 6573 2c20 6e61 6d65 3d6e 616d 6529 2020  es, name=name)  
+000255d0: 2320 2121 2120 7468 6973 2069 7320 6461  # !!! this is da
+000255e0: 6e67 6572 6f75 730a 0a20 2020 2064 6566  ngerous..    def
+000255f0: 205f 5f68 6173 685f 5f28 7365 6c66 293a   __hash__(self):
+00025600: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00025610: 696e 7428 726f 756e 6428 3165 3620 2a20  int(round(1e6 * 
+00025620: 2873 656c 662e 6365 6e74 6572 2e78 202b  (self.center.x +
+00025630: 2073 656c 662e 6365 6e74 6572 2e79 202b   self.center.y +
+00025640: 2073 656c 662e 7261 6469 7573 2929 290a   self.radius))).
+00025650: 0a20 2020 2064 6566 205f 5f65 715f 5f28  .    def __eq__(
+00025660: 7365 6c66 2c20 6f74 6865 725f 6369 7263  self, other_circ
+00025670: 6c65 293a 0a20 2020 2020 2020 2069 6620  le):.        if 
+00025680: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
+00025690: 5f6e 616d 655f 5f20 213d 206f 7468 6572  _name__ != other
+000256a0: 5f63 6972 636c 652e 5f5f 636c 6173 735f  _circle.__class_
+000256b0: 5f2e 5f5f 6e61 6d65 5f5f 3a0a 2020 2020  _.__name__:.    
+000256c0: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+000256d0: 616c 7365 0a0a 2020 2020 2020 2020 7265  alse..        re
+000256e0: 7475 726e 206d 6174 682e 6973 636c 6f73  turn math.isclos
+000256f0: 6528 7365 6c66 2e63 656e 7465 722e 782c  e(self.center.x,
+00025700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025710: 2020 2020 2020 2020 2020 2020 206f 7468               oth
+00025720: 6572 5f63 6972 636c 652e 6365 6e74 6572  er_circle.center
+00025730: 2e78 2c20 6162 735f 746f 6c3d 3165 2d30  .x, abs_tol=1e-0
+00025740: 3629 205c 0a20 2020 2020 2020 2020 2020  6) \.           
+00025750: 2061 6e64 206d 6174 682e 6973 636c 6f73   and math.isclos
+00025760: 6528 7365 6c66 2e63 656e 7465 722e 792c  e(self.center.y,
+00025770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025780: 2020 2020 2020 2020 2020 2020 2020 6f74                ot
+00025790: 6865 725f 6369 7263 6c65 2e63 656e 7465  her_circle.cente
+000257a0: 722e 792c 2061 6273 5f74 6f6c 3d31 652d  r.y, abs_tol=1e-
+000257b0: 3036 2920 5c0a 2020 2020 2020 2020 2020  06) \.          
+000257c0: 2020 616e 6420 6d61 7468 2e69 7363 6c6f    and math.isclo
+000257d0: 7365 2873 656c 662e 7261 6469 7573 2c20  se(self.radius, 
+000257e0: 6f74 6865 725f 6369 7263 6c65 2e72 6164  other_circle.rad
+000257f0: 6975 732c 0a20 2020 2020 2020 2020 2020  ius,.           
+00025800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025810: 2020 6162 735f 746f 6c3d 3165 2d30 3629    abs_tol=1e-06)
+00025820: 0a0a 2020 2020 6465 6620 5f70 7269 6d69  ..    def _primi
+00025830: 7469 7665 7328 7365 6c66 293a 0a20 2020  tives(self):.   
+00025840: 2020 2020 2070 6f69 6e74 7320 3d20 5b0a       points = [.
+00025850: 2020 2020 2020 2020 2020 2020 766f 6c6d              volm
+00025860: 646c 722e 506f 696e 7432 4428 7365 6c66  dlr.Point2D(self
+00025870: 2e63 656e 7465 722e 7820 2b20 7365 6c66  .center.x + self
+00025880: 2e72 6164 6975 732c 2073 656c 662e 6365  .radius, self.ce
+00025890: 6e74 6572 2e79 292c 0a20 2020 2020 2020  nter.y),.       
+000258a0: 2020 2020 2076 6f6c 6d64 6c72 2e50 6f69       volmdlr.Poi
+000258b0: 6e74 3244 2873 656c 662e 6365 6e74 6572  nt2D(self.center
+000258c0: 2e78 2c20 7365 6c66 2e63 656e 7465 722e  .x, self.center.
+000258d0: 7920 2d20 7365 6c66 2e72 6164 6975 7329  y - self.radius)
+000258e0: 2c0a 2020 2020 2020 2020 2020 2020 766f  ,.            vo
+000258f0: 6c6d 646c 722e 506f 696e 7432 4428 7365  lmdlr.Point2D(se
+00025900: 6c66 2e63 656e 7465 722e 7820 2d20 7365  lf.center.x - se
+00025910: 6c66 2e72 6164 6975 732c 2073 656c 662e  lf.radius, self.
+00025920: 6365 6e74 6572 2e79 292c 0a20 2020 2020  center.y),.     
+00025930: 2020 2020 2020 2076 6f6c 6d64 6c72 2e50         volmdlr.P
+00025940: 6f69 6e74 3244 2873 656c 662e 6365 6e74  oint2D(self.cent
+00025950: 6572 2e78 2c20 7365 6c66 2e63 656e 7465  er.x, self.cente
+00025960: 722e 7920 2b20 7365 6c66 2e72 6164 6975  r.y + self.radiu
+00025970: 7329 5d0a 0a20 2020 2020 2020 2072 6574  s)]..        ret
+00025980: 7572 6e20 5b76 6f6c 6d64 6c72 2e65 6467  urn [volmdlr.edg
+00025990: 6573 2e41 7263 3244 2870 6f69 6e74 735b  es.Arc2D(points[
+000259a0: 305d 2c20 706f 696e 7473 5b31 5d2c 2070  0], points[1], p
+000259b0: 6f69 6e74 735b 325d 292c 0a20 2020 2020  oints[2]),.     
+000259c0: 2020 2020 2020 2020 2020 2076 6f6c 6d64             volmd
+000259d0: 6c72 2e65 6467 6573 2e41 7263 3244 2870  lr.edges.Arc2D(p
+000259e0: 6f69 6e74 735b 325d 2c20 706f 696e 7473  oints[2], points
+000259f0: 5b33 5d2c 2070 6f69 6e74 735b 305d 295d  [3], points[0])]
+00025a00: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+00025a10: 6f64 0a20 2020 2064 6566 2066 726f 6d5f  od.    def from_
+00025a20: 6172 6328 636c 732c 2061 7263 3a20 766f  arc(cls, arc: vo
+00025a30: 6c6d 646c 722e 6564 6765 732e 4172 6332  lmdlr.edges.Arc2
+00025a40: 4429 3a0a 2020 2020 2020 2020 7265 7475  D):.        retu
+00025a50: 726e 2063 6c73 2861 7263 2e63 656e 7465  rn cls(arc.cente
+00025a60: 722c 2061 7263 2e72 6164 6975 732c 2061  r, arc.radius, a
+00025a70: 7263 2e6e 616d 6520 2b20 2720 746f 2063  rc.name + ' to c
+00025a80: 6972 636c 6527 290a 0a20 2020 2064 6566  ircle')..    def
+00025a90: 2070 6f69 6e74 5f62 656c 6f6e 6773 2873   point_belongs(s
+00025aa0: 656c 662c 2070 6f69 6e74 2c20 696e 636c  elf, point, incl
+00025ab0: 7564 655f 6564 6765 5f70 6f69 6e74 733a  ude_edge_points:
+00025ac0: 2062 6f6f 6c20 3d20 4661 6c73 6529 3a0a   bool = False):.
+00025ad0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00025ae0: 2020 2020 5665 7269 6669 6573 2069 6620      Verifies if 
+00025af0: 6120 706f 696e 7420 6973 2069 6e73 6964  a point is insid
+00025b00: 6520 7468 6520 4369 7263 6c65 3244 2e0a  e the Circle2D..
+00025b10: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00025b20: 706f 696e 743a 2041 2032 4420 706f 696e  point: A 2D poin
+00025b30: 7420 746f 2063 6865 636b 2069 6620 6974  t to check if it
+00025b40: 2069 7320 696e 7369 6465 2074 6865 2043   is inside the C
+00025b50: 6972 636c 6532 442e 0a20 2020 2020 2020  ircle2D..       
+00025b60: 203a 7479 7065 2070 6f69 6e74 3a20 6076   :type point: `v
+00025b70: 6f6c 6d64 6c72 2e50 6f69 6e74 3244 600a  olmdlr.Point2D`.
+00025b80: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
+00025b90: 6e63 6c75 6465 5f65 6467 655f 706f 696e  nclude_edge_poin
+00025ba0: 7473 3a20 4120 626f 6f6c 6561 6e20 696e  ts: A boolean in
+00025bb0: 6469 6361 7469 6e67 2077 6865 7468 6572  dicating whether
+00025bc0: 2070 6f69 6e74 7320 6f6e 2074 6865 2065   points on the e
+00025bd0: 6467 6520 6f66 2074 6865 2043 6972 636c  dge of the Circl
+00025be0: 6532 440a 2020 2020 2020 2020 2020 2020  e2D.            
+00025bf0: 7368 6f75 6c64 2062 6520 636f 6e73 6964  should be consid
+00025c00: 6572 6564 2069 6e73 6964 6520 7468 6520  ered inside the 
+00025c10: 6369 7263 6c65 2e0a 2020 2020 2020 2020  circle..        
+00025c20: 3a74 7970 6520 696e 636c 7564 655f 6564  :type include_ed
+00025c30: 6765 5f70 6f69 6e74 733a 2062 6f6f 6c0a  ge_points: bool.
+00025c40: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+00025c50: 2054 7275 6520 6966 2070 6f69 6e74 2069   True if point i
+00025c60: 6e73 6964 6520 7468 6520 6369 7263 6c65  nside the circle
+00025c70: 206f 7220 6661 6c73 6520 6f74 6865 7277   or false otherw
+00025c80: 6973 652e 0a20 2020 2020 2020 203a 7274  ise..        :rt
+00025c90: 7970 653a 2062 6f6f 6c0a 2020 2020 2020  ype: bool.      
+00025ca0: 2020 2222 220a 0a20 2020 2020 2020 2069    """..        i
+00025cb0: 6620 696e 636c 7564 655f 6564 6765 5f70  f include_edge_p
+00025cc0: 6f69 6e74 733a 0a20 2020 2020 2020 2020  oints:.         
+00025cd0: 2020 2072 6574 7572 6e20 706f 696e 742e     return point.
+00025ce0: 706f 696e 745f 6469 7374 616e 6365 2873  point_distance(s
+00025cf0: 656c 662e 6365 6e74 6572 2920 3c3d 2073  elf.center) <= s
+00025d00: 656c 662e 7261 6469 7573 0a20 2020 2020  elf.radius.     
+00025d10: 2020 2072 6574 7572 6e20 706f 696e 742e     return point.
+00025d20: 706f 696e 745f 6469 7374 616e 6365 2873  point_distance(s
+00025d30: 656c 662e 6365 6e74 6572 2920 3c20 7365  elf.center) < se
+00025d40: 6c66 2e72 6164 6975 730a 0a20 2020 2064  lf.radius..    d
+00025d50: 6566 2067 6574 5f62 6f75 6e64 696e 675f  ef get_bounding_
+00025d60: 7265 6374 616e 676c 6528 7365 6c66 293a  rectangle(self):
+00025d70: 0a0a 2020 2020 2020 2020 785f 6d69 6e20  ..        x_min 
+00025d80: 3d20 7365 6c66 2e63 656e 7465 722e 7820  = self.center.x 
+00025d90: 2d20 7365 6c66 2e72 6164 6975 730a 2020  - self.radius.  
+00025da0: 2020 2020 2020 785f 6d61 7820 3d20 7365        x_max = se
+00025db0: 6c66 2e63 656e 7465 722e 7820 2b20 7365  lf.center.x + se
+00025dc0: 6c66 2e72 6164 6975 730a 2020 2020 2020  lf.radius.      
+00025dd0: 2020 795f 6d69 6e20 3d20 7365 6c66 2e63    y_min = self.c
+00025de0: 656e 7465 722e 7920 2d20 7365 6c66 2e72  enter.y - self.r
+00025df0: 6164 6975 730a 2020 2020 2020 2020 795f  adius.        y_
+00025e00: 6d61 7820 3d20 7365 6c66 2e63 656e 7465  max = self.cente
+00025e10: 722e 7920 2b20 7365 6c66 2e72 6164 6975  r.y + self.radiu
+00025e20: 730a 2020 2020 2020 2020 7265 7475 726e  s.        return
+00025e30: 2076 6f6c 6d64 6c72 2e63 6f72 652e 426f   volmdlr.core.Bo
+00025e40: 756e 6469 6e67 5265 6374 616e 676c 6528  undingRectangle(
+00025e50: 785f 6d69 6e2c 2078 5f6d 6178 2c20 795f  x_min, x_max, y_
+00025e60: 6d69 6e2c 2079 5f6d 6178 290a 0a20 2020  min, y_max)..   
+00025e70: 2064 6566 206c 696e 655f 696e 7465 7273   def line_inters
+00025e80: 6563 7469 6f6e 7328 7365 6c66 2c20 6c69  ections(self, li
+00025e90: 6e65 3a20 766f 6c6d 646c 722e 6564 6765  ne: volmdlr.edge
+00025ea0: 732e 4c69 6e65 3244 2c20 746f 6c3d 3165  s.Line2D, tol=1e
+00025eb0: 2d39 293a 0a20 2020 2020 2020 2022 2222  -9):.        """
+00025ec0: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
+00025ed0: 7465 7320 7468 6520 696e 7465 7273 6563  tes the intersec
+00025ee0: 7469 6f6e 7320 6265 7477 6565 6e20 6120  tions between a 
+00025ef0: 6369 7263 6c65 2032 4420 616e 6420 4c69  circle 2D and Li
+00025f00: 6e65 2032 442e 0a0a 2020 2020 2020 2020  ne 2D...        
+00025f10: 3a70 6172 616d 206c 696e 653a 206c 696e  :param line: lin
+00025f20: 6520 746f 2063 616c 6375 6c61 7465 2069  e to calculate i
+00025f30: 6e74 6572 7365 6374 696f 6e73 0a20 2020  ntersections.   
+00025f40: 2020 2020 203a 7061 7261 6d20 746f 6c3a       :param tol:
+00025f50: 2074 6f6c 6572 616e 6365 2074 6f20 636f   tolerance to co
+00025f60: 6e73 6964 6572 2069 6e20 6361 6c63 756c  nsider in calcul
+00025f70: 6174 696f 6e73 2e0a 2020 2020 2020 2020  ations..        
+00025f80: 3a72 6574 7572 6e3a 2063 6972 636c 6520  :return: circle 
+00025f90: 616e 6420 6c69 6e65 2069 6e74 6572 7365  and line interse
+00025fa0: 6374 696f 6e73 2e0a 2020 2020 2020 2020  ctions..        
+00025fb0: 2222 220a 2020 2020 2020 2020 6675 6c6c  """.        full
+00025fc0: 5f61 7263 5f32 6420 3d20 766f 6c6d 646c  _arc_2d = volmdl
+00025fd0: 722e 6564 6765 732e 4675 6c6c 4172 6332  r.edges.FullArc2
+00025fe0: 4428 0a20 2020 2020 2020 2020 2020 2063  D(.            c
+00025ff0: 656e 7465 723d 7365 6c66 2e63 656e 7465  enter=self.cente
+00026000: 722c 2073 7461 7274 5f65 6e64 3d73 656c  r, start_end=sel
+00026010: 662e 706f 696e 745f 6174 5f61 6273 6369  f.point_at_absci
+00026020: 7373 6128 3029 2c0a 2020 2020 2020 2020  ssa(0),.        
+00026030: 2020 2020 6e61 6d65 3d73 656c 662e 6e61      name=self.na
+00026040: 6d65 290a 2020 2020 2020 2020 7265 7475  me).        retu
+00026050: 726e 2066 756c 6c5f 6172 635f 3264 2e6c  rn full_arc_2d.l
+00026060: 696e 655f 696e 7465 7273 6563 7469 6f6e  ine_intersection
+00026070: 7328 6c69 6e65 2c20 746f 6c29 0a0a 2020  s(line, tol)..  
+00026080: 2020 6465 6620 6c69 6e65 7365 676d 656e    def linesegmen
+00026090: 745f 696e 7465 7273 6563 7469 6f6e 7328  t_intersections(
+000260a0: 7365 6c66 2c20 6c69 6e65 7365 676d 656e  self, linesegmen
+000260b0: 743a 2076 6f6c 6d64 6c72 2e65 6467 6573  t: volmdlr.edges
+000260c0: 2e4c 696e 6553 6567 6d65 6e74 3244 2c20  .LineSegment2D, 
+000260d0: 746f 6c3d 3165 2d39 293a 0a20 2020 2020  tol=1e-9):.     
+000260e0: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+000260f0: 616c 6375 6c61 7465 7320 7468 6520 696e  alculates the in
+00026100: 7465 7273 6563 7469 6f6e 7320 6265 7477  tersections betw
+00026110: 6565 6e20 6120 6369 7263 6c65 2032 4420  een a circle 2D 
+00026120: 616e 6420 4c69 6e65 5365 676d 656e 7420  and LineSegment 
+00026130: 3244 2e0a 0a20 2020 2020 2020 203a 7061  2D...        :pa
+00026140: 7261 6d20 6c69 6e65 7365 676d 656e 743a  ram linesegment:
+00026150: 206c 696e 6573 6567 6d65 6e74 2074 6f20   linesegment to 
+00026160: 6361 6c63 756c 6174 6520 696e 7465 7273  calculate inters
+00026170: 6563 7469 6f6e 730a 2020 2020 2020 2020  ections.        
+00026180: 3a70 6172 616d 2074 6f6c 3a20 746f 6c65  :param tol: tole
+00026190: 7261 6e63 6520 746f 2063 6f6e 7369 6465  rance to conside
+000261a0: 7220 696e 2063 616c 6375 6c61 7469 6f6e  r in calculation
+000261b0: 732e 0a20 2020 2020 2020 203a 7265 7475  s..        :retu
+000261c0: 726e 3a20 6369 7263 6c65 2061 6e64 206c  rn: circle and l
+000261d0: 696e 6573 6567 6d65 6e74 2069 6e74 6572  inesegment inter
+000261e0: 7365 6374 696f 6e73 2e0a 2020 2020 2020  sections..      
+000261f0: 2020 2222 220a 2020 2020 2020 2020 6675    """.        fu
+00026200: 6c6c 5f61 7263 5f32 6420 3d20 766f 6c6d  ll_arc_2d = volm
+00026210: 646c 722e 6564 6765 732e 4675 6c6c 4172  dlr.edges.FullAr
+00026220: 6332 4428 0a20 2020 2020 2020 2020 2020  c2D(.           
+00026230: 2063 656e 7465 723d 7365 6c66 2e63 656e   center=self.cen
+00026240: 7465 722c 2073 7461 7274 5f65 6e64 3d73  ter, start_end=s
+00026250: 656c 662e 706f 696e 745f 6174 5f61 6273  elf.point_at_abs
+00026260: 6369 7373 6128 3029 2c0a 2020 2020 2020  cissa(0),.      
+00026270: 2020 2020 2020 6e61 6d65 3d73 656c 662e        name=self.
+00026280: 6e61 6d65 290a 2020 2020 2020 2020 7265  name).        re
+00026290: 7475 726e 2066 756c 6c5f 6172 635f 3264  turn full_arc_2d
+000262a0: 2e6c 696e 6573 6567 6d65 6e74 5f69 6e74  .linesegment_int
+000262b0: 6572 7365 6374 696f 6e73 286c 696e 6573  ersections(lines
+000262c0: 6567 6d65 6e74 2c20 746f 6c29 0a0a 2020  egment, tol)..  
+000262d0: 2020 6465 6620 6375 745f 6279 5f6c 696e    def cut_by_lin
+000262e0: 6528 7365 6c66 2c20 6c69 6e65 3a20 766f  e(self, line: vo
+000262f0: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
+00026300: 3244 293a 0a20 2020 2020 2020 2069 6e74  2D):.        int
+00026310: 6572 7365 6374 696f 6e5f 706f 696e 7473  ersection_points
+00026320: 203d 2073 656c 662e 6c69 6e65 5f69 6e74   = self.line_int
+00026330: 6572 7365 6374 696f 6e73 286c 696e 6529  ersections(line)
+00026340: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00026350: 696e 7465 7273 6563 7469 6f6e 5f70 6f69  intersection_poi
+00026360: 6e74 733a 0a20 2020 2020 2020 2020 2020  nts:.           
+00026370: 2072 6574 7572 6e20 5b73 656c 665d 0a20   return [self]. 
+00026380: 2020 2020 2020 2069 6620 6c65 6e28 696e         if len(in
+00026390: 7465 7273 6563 7469 6f6e 5f70 6f69 6e74  tersection_point
+000263a0: 7329 203d 3d20 313a 0a20 2020 2020 2020  s) == 1:.       
+000263b0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+000263c0: 706c 656d 656e 7465 6445 7272 6f72 0a20  plementedError. 
+000263d0: 2020 2020 2020 2069 6620 6c65 6e28 696e         if len(in
+000263e0: 7465 7273 6563 7469 6f6e 5f70 6f69 6e74  tersection_point
+000263f0: 7329 203d 3d20 323a 0a20 2020 2020 2020  s) == 2:.       
+00026400: 2020 2020 206c 696e 6573 6567 6d65 6e74       linesegment
+00026410: 203d 2076 6f6c 6d64 6c72 2e65 6467 6573   = volmdlr.edges
+00026420: 2e4c 696e 6553 6567 6d65 6e74 3244 2869  .LineSegment2D(i
+00026430: 6e74 6572 7365 6374 696f 6e5f 706f 696e  ntersection_poin
+00026440: 7473 5b30 5d2c 0a20 2020 2020 2020 2020  ts[0],.         
 00026450: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00026460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026470: 2020 2020 696e 7465 7273 6563 7469 6f6e      intersection
-00026480: 5f70 6f69 6e74 735b 315d 290a 2020 2020  _points[1]).    
-00026490: 2020 2020 2020 2020 6172 6331 2c20 6172          arc1, ar
-000264a0: 6332 203d 2073 656c 662e 7370 6c69 7428  c2 = self.split(
-000264b0: 696e 7465 7273 6563 7469 6f6e 5f70 6f69  intersection_poi
-000264c0: 6e74 735b 305d 2c0a 2020 2020 2020 2020  nts[0],.        
-000264d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000264e0: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-000264f0: 7273 6563 7469 6f6e 5f70 6f69 6e74 735b  rsection_points[
-00026500: 315d 290a 2020 2020 2020 2020 2020 2020  1]).            
-00026510: 636f 6e74 6f75 7231 203d 2043 6f6e 746f  contour1 = Conto
-00026520: 7572 3244 285b 6172 6331 2c20 6c69 6e65  ur2D([arc1, line
-00026530: 7365 676d 656e 742e 636f 7079 2829 5d29  segment.copy()])
-00026540: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00026550: 746f 7572 3220 3d20 436f 6e74 6f75 7232  tour2 = Contour2
-00026560: 4428 5b61 7263 322c 206c 696e 6573 6567  D([arc2, lineseg
-00026570: 6d65 6e74 2e63 6f70 7928 295d 290a 2020  ment.copy()]).  
-00026580: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00026590: 205b 636f 6e74 6f75 7231 2c20 636f 6e74   [contour1, cont
-000265a0: 6f75 7232 5d0a 2020 2020 2020 2020 7261  our2].        ra
-000265b0: 6973 6520 5661 6c75 6545 7272 6f72 0a0a  ise ValueError..
-000265c0: 2020 2020 6465 6620 6369 7263 6c65 5f69      def circle_i
-000265d0: 6e74 6572 7365 6374 696f 6e73 2873 656c  ntersections(sel
-000265e0: 662c 2063 6972 636c 653a 2027 766f 6c6d  f, circle: 'volm
-000265f0: 646c 722e 7769 7265 732e 4369 7263 6c65  dlr.wires.Circle
-00026600: 3244 2729 3a0a 2020 2020 2020 2020 7830  2D'):.        x0
-00026610: 2c20 7930 203d 2073 656c 662e 6365 6e74  , y0 = self.cent
-00026620: 6572 0a20 2020 2020 2020 2078 312c 2079  er.        x1, y
-00026630: 3120 3d20 6369 7263 6c65 2e63 656e 7465  1 = circle.cente
-00026640: 720a 2020 2020 2020 2020 2320 7230 203d  r.        # r0 =
-00026650: 2073 656c 662e 7261 6469 7573 0a20 2020   self.radius.   
-00026660: 2020 2020 2023 2072 3120 3d20 6369 7263       # r1 = circ
-00026670: 6c65 2e72 6164 6975 730a 0a20 2020 2020  le.radius..     
-00026680: 2020 2064 203d 206d 6174 682e 7371 7274     d = math.sqrt
-00026690: 2828 7831 202d 2078 3029 202a 2a20 3220  ((x1 - x0) ** 2 
-000266a0: 2b20 2879 3120 2d20 7930 2920 2a2a 2032  + (y1 - y0) ** 2
-000266b0: 290a 0a20 2020 2020 2020 2023 206e 6f6e  )..        # non
-000266c0: 2069 6e74 6572 7365 6374 696e 670a 2020   intersecting.  
-000266d0: 2020 2020 2020 6966 2064 203e 2073 656c        if d > sel
-000266e0: 662e 7261 6469 7573 202b 2063 6972 636c  f.radius + circl
-000266f0: 652e 7261 6469 7573 3a0a 2020 2020 2020  e.radius:.      
-00026700: 2020 2020 2020 7265 7475 726e 205b 5d0a        return [].
-00026710: 2020 2020 2020 2020 2320 4f6e 6520 6369          # One ci
-00026720: 7263 6c65 2077 6974 6869 6e20 6f74 6865  rcle within othe
-00026730: 720a 2020 2020 2020 2020 6966 2064 203c  r.        if d <
-00026740: 2061 6273 2873 656c 662e 7261 6469 7573   abs(self.radius
-00026750: 202d 2063 6972 636c 652e 7261 6469 7573   - circle.radius
-00026760: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00026770: 6574 7572 6e20 5b5d 0a20 2020 2020 2020  eturn [].       
-00026780: 2023 2063 6f69 6e63 6964 656e 7420 6369   # coincident ci
-00026790: 7263 6c65 730a 2020 2020 2020 2020 6966  rcles.        if
-000267a0: 2064 203d 3d20 3020 616e 6420 7365 6c66   d == 0 and self
-000267b0: 2e72 6164 6975 7320 3d3d 2063 6972 636c  .radius == circl
-000267c0: 652e 7261 6469 7573 3a0a 2020 2020 2020  e.radius:.      
-000267d0: 2020 2020 2020 7265 7475 726e 205b 5d0a        return [].
-000267e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000267f0: 2020 2020 2020 2020 2020 6120 3d20 2873            a = (s
-00026800: 656c 662e 7261 6469 7573 202a 2a20 3220  elf.radius ** 2 
-00026810: 2d20 6369 7263 6c65 2e72 6164 6975 7320  - circle.radius 
-00026820: 2a2a 2032 202b 2064 202a 2a20 3229 202f  ** 2 + d ** 2) /
-00026830: 2028 3220 2a20 6429 0a20 2020 2020 2020   (2 * d).       
-00026840: 2020 2020 2068 203d 206d 6174 682e 7371       h = math.sq
-00026850: 7274 2873 656c 662e 7261 6469 7573 202a  rt(self.radius *
-00026860: 2a20 3220 2d20 6120 2a2a 2032 290a 2020  * 2 - a ** 2).  
-00026870: 2020 2020 2020 2020 2020 7832 203d 2078            x2 = x
-00026880: 3020 2b20 6120 2a20 2878 3120 2d20 7830  0 + a * (x1 - x0
-00026890: 2920 2f20 640a 2020 2020 2020 2020 2020  ) / d.          
-000268a0: 2020 7932 203d 2079 3020 2b20 6120 2a20    y2 = y0 + a * 
-000268b0: 2879 3120 2d20 7930 2920 2f20 640a 2020  (y1 - y0) / d.  
-000268c0: 2020 2020 2020 2020 2020 7833 203d 2078            x3 = x
-000268d0: 3220 2b20 6820 2a20 2879 3120 2d20 7930  2 + h * (y1 - y0
-000268e0: 2920 2f20 640a 2020 2020 2020 2020 2020  ) / d.          
-000268f0: 2020 7933 203d 2079 3220 2d20 6820 2a20    y3 = y2 - h * 
-00026900: 2878 3120 2d20 7830 2920 2f20 640a 0a20  (x1 - x0) / d.. 
-00026910: 2020 2020 2020 2020 2020 2078 3420 3d20             x4 = 
-00026920: 7832 202d 2068 202a 2028 7931 202d 2079  x2 - h * (y1 - y
-00026930: 3029 202f 2064 0a20 2020 2020 2020 2020  0) / d.         
-00026940: 2020 2079 3420 3d20 7932 202b 2068 202a     y4 = y2 + h *
-00026950: 2028 7831 202d 2078 3029 202f 2064 0a0a   (x1 - x0) / d..
-00026960: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-00026970: 766f 6c6d 646c 722e 506f 696e 7432 4428  volmdlr.Point2D(
-00026980: 7833 2c20 7933 292c 2076 6f6c 6d64 6c72  x3, y3), volmdlr
-00026990: 2e50 6f69 6e74 3244 2878 342c 2079 3429  .Point2D(x4, y4)
-000269a0: 5d0a 0a20 2020 2064 6566 2061 7263 5f69  ]..    def arc_i
-000269b0: 6e74 6572 7365 6374 696f 6e73 2873 656c  ntersections(sel
-000269c0: 662c 2061 7263 3264 3a20 766f 6c6d 646c  f, arc2d: volmdl
-000269d0: 722e 6564 6765 732e 4172 6332 4429 3a0a  r.edges.Arc2D):.
-000269e0: 2020 2020 2020 2020 6369 7263 6c65 203d          circle =
-000269f0: 2043 6972 636c 6532 4428 6172 6332 642e   Circle2D(arc2d.
-00026a00: 6365 6e74 6572 2c20 6172 6332 642e 7261  center, arc2d.ra
-00026a10: 6469 7573 290a 2020 2020 2020 2020 696e  dius).        in
-00026a20: 7465 7273 6563 7469 6f6e 7320 3d20 5b5d  tersections = []
-00026a30: 0a0a 2020 2020 2020 2020 666f 7220 696e  ..        for in
-00026a40: 7465 7220 696e 2073 656c 662e 6369 7263  ter in self.circ
-00026a50: 6c65 5f69 6e74 6572 7365 6374 696f 6e73  le_intersections
-00026a60: 2863 6972 636c 6529 3a0a 2020 2020 2020  (circle):.      
-00026a70: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-00026a80: 2020 2020 2020 2020 2020 2061 7263 3264             arc2d
-00026a90: 2e61 6273 6369 7373 6128 696e 7465 7229  .abscissa(inter)
-00026aa0: 2020 2320 4920 6775 6573 7320 6974 2069    # I guess it i
-00026ab0: 7320 6120 7465 7374 3f0a 2020 2020 2020  s a test?.      
-00026ac0: 2020 2020 2020 2020 2020 696e 7465 7273            inters
-00026ad0: 6563 7469 6f6e 732e 6170 7065 6e64 2869  ections.append(i
-00026ae0: 6e74 6572 290a 2020 2020 2020 2020 2020  nter).          
-00026af0: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
-00026b00: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-00026b10: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
-00026b20: 2020 7265 7475 726e 2069 6e74 6572 7365    return interse
-00026b30: 6374 696f 6e73 0a0a 2020 2020 6465 6620  ctions..    def 
-00026b40: 6c65 6e67 7468 2873 656c 6629 3a0a 2020  length(self):.  
-00026b50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00026b60: 2020 4361 6c63 756c 6174 6573 2074 6865    Calculates the
-00026b70: 206c 656e 6774 6820 6f66 2074 6865 2043   length of the C
-00026b80: 6972 636c 6520 3244 2e0a 0a20 2020 2020  ircle 2D...     
-00026b90: 2020 203a 7265 7475 726e 3a20 7468 6520     :return: the 
-00026ba0: 6369 7263 6c65 2773 206c 656e 6774 682e  circle's length.
-00026bb0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00026bc0: 2020 2020 2020 7265 7475 726e 2076 6f6c        return vol
-00026bd0: 6d64 6c72 2e54 574f 5f50 4920 2a20 7365  mdlr.TWO_PI * se
-00026be0: 6c66 2e72 6164 6975 730a 0a20 2020 2064  lf.radius..    d
-00026bf0: 6566 2070 6c6f 7428 7365 6c66 2c20 6178  ef plot(self, ax
-00026c00: 3d4e 6f6e 652c 2063 6f6c 6f72 3d27 6b27  =None, color='k'
-00026c10: 2c20 616c 7068 613d 312c 0a20 2020 2020  , alpha=1,.     
-00026c20: 2020 2020 2020 2020 706c 6f74 5f70 6f69          plot_poi
-00026c30: 6e74 733d 4661 6c73 652c 2065 7175 616c  nts=False, equal
-00026c40: 5f61 7370 6563 743d 5472 7565 2c20 6c69  _aspect=True, li
-00026c50: 6e65 7374 796c 653d 272d 272c 206c 696e  nestyle='-', lin
-00026c60: 6577 6964 7468 3d31 293a 0a20 2020 2020  ewidth=1):.     
-00026c70: 2020 2069 6620 6178 2069 7320 4e6f 6e65     if ax is None
-00026c80: 3a0a 2020 2020 2020 2020 2020 2020 5f2c  :.            _,
-00026c90: 2061 7820 3d20 706c 742e 7375 6270 6c6f   ax = plt.subplo
-00026ca0: 7473 2829 0a20 2020 2020 2020 2023 2065  ts().        # e
-00026cb0: 6c73 653a 0a20 2020 2020 2020 2023 2020  lse:.        #  
-00026cc0: 2020 2066 6967 203d 2061 782e 6669 6775     fig = ax.figu
-00026cd0: 7265 0a20 2020 2020 2020 2069 6620 7365  re.        if se
-00026ce0: 6c66 2e72 6164 6975 7320 3e20 303a 0a20  lf.radius > 0:. 
-00026cf0: 2020 2020 2020 2020 2020 2061 782e 6164             ax.ad
-00026d00: 645f 7061 7463 6828 6d61 7470 6c6f 746c  d_patch(matplotl
-00026d10: 6962 2e70 6174 6368 6573 2e41 7263 2828  ib.patches.Arc((
-00026d20: 7365 6c66 2e63 656e 7465 722e 782c 2073  self.center.x, s
-00026d30: 656c 662e 6365 6e74 6572 2e79 292c 0a20  elf.center.y),. 
-00026d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026470: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+00026480: 6572 7365 6374 696f 6e5f 706f 696e 7473  ersection_points
+00026490: 5b31 5d29 0a20 2020 2020 2020 2020 2020  [1]).           
+000264a0: 2061 7263 312c 2061 7263 3220 3d20 7365   arc1, arc2 = se
+000264b0: 6c66 2e73 706c 6974 2869 6e74 6572 7365  lf.split(interse
+000264c0: 6374 696f 6e5f 706f 696e 7473 5b30 5d2c  ction_points[0],
+000264d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000264e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000264f0: 2020 2020 2069 6e74 6572 7365 6374 696f       intersectio
+00026500: 6e5f 706f 696e 7473 5b31 5d29 0a20 2020  n_points[1]).   
+00026510: 2020 2020 2020 2020 2063 6f6e 746f 7572           contour
+00026520: 3120 3d20 436f 6e74 6f75 7232 4428 5b61  1 = Contour2D([a
+00026530: 7263 312c 206c 696e 6573 6567 6d65 6e74  rc1, linesegment
+00026540: 2e63 6f70 7928 295d 290a 2020 2020 2020  .copy()]).      
+00026550: 2020 2020 2020 636f 6e74 6f75 7232 203d        contour2 =
+00026560: 2043 6f6e 746f 7572 3244 285b 6172 6332   Contour2D([arc2
+00026570: 2c20 6c69 6e65 7365 676d 656e 742e 636f  , linesegment.co
+00026580: 7079 2829 5d29 0a20 2020 2020 2020 2020  py()]).         
+00026590: 2020 2072 6574 7572 6e20 5b63 6f6e 746f     return [conto
+000265a0: 7572 312c 2063 6f6e 746f 7572 325d 0a20  ur1, contour2]. 
+000265b0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000265c0: 7565 4572 726f 720a 0a20 2020 2064 6566  ueError..    def
+000265d0: 2063 6972 636c 655f 696e 7465 7273 6563   circle_intersec
+000265e0: 7469 6f6e 7328 7365 6c66 2c20 6369 7263  tions(self, circ
+000265f0: 6c65 3a20 2776 6f6c 6d64 6c72 2e77 6972  le: 'volmdlr.wir
+00026600: 6573 2e43 6972 636c 6532 4427 293a 0a20  es.Circle2D'):. 
+00026610: 2020 2020 2020 2078 302c 2079 3020 3d20         x0, y0 = 
+00026620: 7365 6c66 2e63 656e 7465 720a 2020 2020  self.center.    
+00026630: 2020 2020 7831 2c20 7931 203d 2063 6972      x1, y1 = cir
+00026640: 636c 652e 6365 6e74 6572 0a20 2020 2020  cle.center.     
+00026650: 2020 2023 2072 3020 3d20 7365 6c66 2e72     # r0 = self.r
+00026660: 6164 6975 730a 2020 2020 2020 2020 2320  adius.        # 
+00026670: 7231 203d 2063 6972 636c 652e 7261 6469  r1 = circle.radi
+00026680: 7573 0a0a 2020 2020 2020 2020 6420 3d20  us..        d = 
+00026690: 6d61 7468 2e73 7172 7428 2878 3120 2d20  math.sqrt((x1 - 
+000266a0: 7830 2920 2a2a 2032 202b 2028 7931 202d  x0) ** 2 + (y1 -
+000266b0: 2079 3029 202a 2a20 3229 0a0a 2020 2020   y0) ** 2)..    
+000266c0: 2020 2020 2320 6e6f 6e20 696e 7465 7273      # non inters
+000266d0: 6563 7469 6e67 0a20 2020 2020 2020 2069  ecting.        i
+000266e0: 6620 6420 3e20 7365 6c66 2e72 6164 6975  f d > self.radiu
+000266f0: 7320 2b20 6369 7263 6c65 2e72 6164 6975  s + circle.radiu
+00026700: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00026710: 6574 7572 6e20 5b5d 0a20 2020 2020 2020  eturn [].       
+00026720: 2023 204f 6e65 2063 6972 636c 6520 7769   # One circle wi
+00026730: 7468 696e 206f 7468 6572 0a20 2020 2020  thin other.     
+00026740: 2020 2069 6620 6420 3c20 6162 7328 7365     if d < abs(se
+00026750: 6c66 2e72 6164 6975 7320 2d20 6369 7263  lf.radius - circ
+00026760: 6c65 2e72 6164 6975 7329 3a0a 2020 2020  le.radius):.    
+00026770: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+00026780: 5d0a 2020 2020 2020 2020 2320 636f 696e  ].        # coin
+00026790: 6369 6465 6e74 2063 6972 636c 6573 0a20  cident circles. 
+000267a0: 2020 2020 2020 2069 6620 6420 3d3d 2030         if d == 0
+000267b0: 2061 6e64 2073 656c 662e 7261 6469 7573   and self.radius
+000267c0: 203d 3d20 6369 7263 6c65 2e72 6164 6975   == circle.radiu
+000267d0: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+000267e0: 6574 7572 6e20 5b5d 0a20 2020 2020 2020  eturn [].       
+000267f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00026800: 2020 2061 203d 2028 7365 6c66 2e72 6164     a = (self.rad
+00026810: 6975 7320 2a2a 2032 202d 2063 6972 636c  ius ** 2 - circl
+00026820: 652e 7261 6469 7573 202a 2a20 3220 2b20  e.radius ** 2 + 
+00026830: 6420 2a2a 2032 2920 2f20 2832 202a 2064  d ** 2) / (2 * d
+00026840: 290a 2020 2020 2020 2020 2020 2020 6820  ).            h 
+00026850: 3d20 6d61 7468 2e73 7172 7428 7365 6c66  = math.sqrt(self
+00026860: 2e72 6164 6975 7320 2a2a 2032 202d 2061  .radius ** 2 - a
+00026870: 202a 2a20 3229 0a20 2020 2020 2020 2020   ** 2).         
+00026880: 2020 2078 3220 3d20 7830 202b 2061 202a     x2 = x0 + a *
+00026890: 2028 7831 202d 2078 3029 202f 2064 0a20   (x1 - x0) / d. 
+000268a0: 2020 2020 2020 2020 2020 2079 3220 3d20             y2 = 
+000268b0: 7930 202b 2061 202a 2028 7931 202d 2079  y0 + a * (y1 - y
+000268c0: 3029 202f 2064 0a20 2020 2020 2020 2020  0) / d.         
+000268d0: 2020 2078 3320 3d20 7832 202b 2068 202a     x3 = x2 + h *
+000268e0: 2028 7931 202d 2079 3029 202f 2064 0a20   (y1 - y0) / d. 
+000268f0: 2020 2020 2020 2020 2020 2079 3320 3d20             y3 = 
+00026900: 7932 202d 2068 202a 2028 7831 202d 2078  y2 - h * (x1 - x
+00026910: 3029 202f 2064 0a0a 2020 2020 2020 2020  0) / d..        
+00026920: 2020 2020 7834 203d 2078 3220 2d20 6820      x4 = x2 - h 
+00026930: 2a20 2879 3120 2d20 7930 2920 2f20 640a  * (y1 - y0) / d.
+00026940: 2020 2020 2020 2020 2020 2020 7934 203d              y4 =
+00026950: 2079 3220 2b20 6820 2a20 2878 3120 2d20   y2 + h * (x1 - 
+00026960: 7830 2920 2f20 640a 0a20 2020 2020 2020  x0) / d..       
+00026970: 2072 6574 7572 6e20 5b76 6f6c 6d64 6c72   return [volmdlr
+00026980: 2e50 6f69 6e74 3244 2878 332c 2079 3329  .Point2D(x3, y3)
+00026990: 2c20 766f 6c6d 646c 722e 506f 696e 7432  , volmdlr.Point2
+000269a0: 4428 7834 2c20 7934 295d 0a0a 2020 2020  D(x4, y4)]..    
+000269b0: 6465 6620 6172 635f 696e 7465 7273 6563  def arc_intersec
+000269c0: 7469 6f6e 7328 7365 6c66 2c20 6172 6332  tions(self, arc2
+000269d0: 643a 2076 6f6c 6d64 6c72 2e65 6467 6573  d: volmdlr.edges
+000269e0: 2e41 7263 3244 293a 0a20 2020 2020 2020  .Arc2D):.       
+000269f0: 2063 6972 636c 6520 3d20 4369 7263 6c65   circle = Circle
+00026a00: 3244 2861 7263 3264 2e63 656e 7465 722c  2D(arc2d.center,
+00026a10: 2061 7263 3264 2e72 6164 6975 7329 0a20   arc2d.radius). 
+00026a20: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
+00026a30: 696f 6e73 203d 205b 5d0a 0a20 2020 2020  ions = []..     
+00026a40: 2020 2066 6f72 2069 6e74 6572 2069 6e20     for inter in 
+00026a50: 7365 6c66 2e63 6972 636c 655f 696e 7465  self.circle_inte
+00026a60: 7273 6563 7469 6f6e 7328 6369 7263 6c65  rsections(circle
+00026a70: 293a 0a20 2020 2020 2020 2020 2020 2074  ):.            t
+00026a80: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+00026a90: 2020 2020 6172 6332 642e 6162 7363 6973      arc2d.abscis
+00026aa0: 7361 2869 6e74 6572 2920 2023 2049 2067  sa(inter)  # I g
+00026ab0: 7565 7373 2069 7420 6973 2061 2074 6573  uess it is a tes
+00026ac0: 743f 0a20 2020 2020 2020 2020 2020 2020  t?.             
+00026ad0: 2020 2069 6e74 6572 7365 6374 696f 6e73     intersections
+00026ae0: 2e61 7070 656e 6428 696e 7465 7229 0a20  .append(inter). 
+00026af0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00026b00: 7420 5661 6c75 6545 7272 6f72 3a0a 2020  t ValueError:.  
+00026b10: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00026b20: 7373 0a20 2020 2020 2020 2072 6574 7572  ss.        retur
+00026b30: 6e20 696e 7465 7273 6563 7469 6f6e 730a  n intersections.
+00026b40: 0a20 2020 2064 6566 206c 656e 6774 6828  .    def length(
+00026b50: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00026b60: 2222 0a20 2020 2020 2020 2043 616c 6375  "".        Calcu
+00026b70: 6c61 7465 7320 7468 6520 6c65 6e67 7468  lates the length
+00026b80: 206f 6620 7468 6520 4369 7263 6c65 2032   of the Circle 2
+00026b90: 442e 0a0a 2020 2020 2020 2020 3a72 6574  D...        :ret
+00026ba0: 7572 6e3a 2074 6865 2063 6972 636c 6527  urn: the circle'
+00026bb0: 7320 6c65 6e67 7468 2e0a 2020 2020 2020  s length..      
+00026bc0: 2020 2222 220a 0a20 2020 2020 2020 2072    """..        r
+00026bd0: 6574 7572 6e20 766f 6c6d 646c 722e 5457  eturn volmdlr.TW
+00026be0: 4f5f 5049 202a 2073 656c 662e 7261 6469  O_PI * self.radi
+00026bf0: 7573 0a0a 2020 2020 6465 6620 706c 6f74  us..    def plot
+00026c00: 2873 656c 662c 2061 783d 4e6f 6e65 2c20  (self, ax=None, 
+00026c10: 636f 6c6f 723d 276b 272c 2061 6c70 6861  color='k', alpha
+00026c20: 3d31 2c0a 2020 2020 2020 2020 2020 2020  =1,.            
+00026c30: 2070 6c6f 745f 706f 696e 7473 3d46 616c   plot_points=Fal
+00026c40: 7365 2c20 6571 7561 6c5f 6173 7065 6374  se, equal_aspect
+00026c50: 3d54 7275 652c 206c 696e 6573 7479 6c65  =True, linestyle
+00026c60: 3d27 2d27 2c20 6c69 6e65 7769 6474 683d  ='-', linewidth=
+00026c70: 3129 3a0a 2020 2020 2020 2020 6966 2061  1):.        if a
+00026c80: 7820 6973 204e 6f6e 653a 0a20 2020 2020  x is None:.     
+00026c90: 2020 2020 2020 205f 2c20 6178 203d 2070         _, ax = p
+00026ca0: 6c74 2e73 7562 706c 6f74 7328 290a 2020  lt.subplots().  
+00026cb0: 2020 2020 2020 2320 656c 7365 3a0a 2020        # else:.  
+00026cc0: 2020 2020 2020 2320 2020 2020 6669 6720        #     fig 
+00026cd0: 3d20 6178 2e66 6967 7572 650a 2020 2020  = ax.figure.    
+00026ce0: 2020 2020 6966 2073 656c 662e 7261 6469      if self.radi
+00026cf0: 7573 203e 2030 3a0a 2020 2020 2020 2020  us > 0:.        
+00026d00: 2020 2020 6178 2e61 6464 5f70 6174 6368      ax.add_patch
+00026d10: 286d 6174 706c 6f74 6c69 622e 7061 7463  (matplotlib.patc
+00026d20: 6865 732e 4172 6328 2873 656c 662e 6365  hes.Arc((self.ce
+00026d30: 6e74 6572 2e78 2c20 7365 6c66 2e63 656e  nter.x, self.cen
+00026d40: 7465 722e 7929 2c0a 2020 2020 2020 2020  ter.y),.        
 00026d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026d60: 2020 2020 2020 2020 2020 2020 2020 2032                 2
-00026d70: 202a 2073 656c 662e 7261 6469 7573 2c0a   * self.radius,.
-00026d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d70: 2020 2020 2020 2020 3220 2a20 7365 6c66          2 * self
+00026d80: 2e72 6164 6975 732c 0a20 2020 2020 2020  .radius,.       
 00026d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00026da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026db0: 3220 2a20 7365 6c66 2e72 6164 6975 732c  2 * self.radius,
-00026dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026db0: 2020 2020 2020 2020 2032 202a 2073 656c           2 * sel
+00026dc0: 662e 7261 6469 7573 2c0a 2020 2020 2020  f.radius,.      
 00026dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00026de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026df0: 2061 6e67 6c65 3d30 2c0a 2020 2020 2020   angle=0,.      
-00026e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026df0: 2020 2020 2020 2020 2020 616e 676c 653d            angle=
+00026e00: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
 00026e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026e20: 2020 2020 2020 2020 2020 7468 6574 6131            theta1
-00026e30: 3d30 2c0a 2020 2020 2020 2020 2020 2020  =0,.            
+00026e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026e30: 2020 2074 6865 7461 313d 302c 0a20 2020     theta1=0,.   
 00026e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00026e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026e60: 2020 2020 7468 6574 6132 3d33 3630 2c0a      theta2=360,.
-00026e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026e60: 2020 2020 2020 2020 2020 2020 2074 6865               the
+00026e70: 7461 323d 3336 302c 0a20 2020 2020 2020  ta2=360,.       
 00026e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00026e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ea0: 636f 6c6f 723d 636f 6c6f 722c 0a20 2020  color=color,.   
-00026eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026ea0: 2020 2020 2020 2020 2063 6f6c 6f72 3d63           color=c
+00026eb0: 6f6c 6f72 2c0a 2020 2020 2020 2020 2020  olor,.          
 00026ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ed0: 2020 2020 2020 2020 2020 2020 2061 6c70               alp
-00026ee0: 6861 3d61 6c70 6861 2c0a 2020 2020 2020  ha=alpha,.      
-00026ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026ee0: 2020 2020 2020 616c 7068 613d 616c 7068        alpha=alph
+00026ef0: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
 00026f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026f10: 2020 2020 2020 2020 2020 6c69 6e65 7374            linest
-00026f20: 796c 653d 6c69 6e65 7374 796c 652c 0a20  yle=linestyle,. 
-00026f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026f20: 2020 206c 696e 6573 7479 6c65 3d6c 696e     linestyle=lin
+00026f30: 6573 7479 6c65 2c0a 2020 2020 2020 2020  estyle,.        
 00026f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026f50: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00026f60: 696e 6577 6964 7468 3d6c 696e 6577 6964  inewidth=linewid
-00026f70: 7468 2929 0a20 2020 2020 2020 2069 6620  th)).        if 
-00026f80: 6571 7561 6c5f 6173 7065 6374 3a0a 2020  equal_aspect:.  
-00026f90: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
-00026fa0: 5f61 7370 6563 7428 2765 7175 616c 2729  _aspect('equal')
-00026fb0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00026fc0: 6178 0a0a 2020 2020 6465 6620 746f 5f33  ax..    def to_3
-00026fd0: 6428 7365 6c66 2c20 706c 616e 655f 6f72  d(self, plane_or
-00026fe0: 6967 696e 2c20 782c 2079 293a 0a20 2020  igin, x, y):.   
-00026ff0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00027000: 2054 7261 6e73 666f 726d 7320 6120 4369   Transforms a Ci
-00027010: 7263 6c65 3244 2069 6e74 6f20 616e 2043  rcle2D into an C
-00027020: 6972 636c 6533 442c 2067 6976 656e 2061  ircle3D, given a
-00027030: 2070 6c61 6e65 206f 7269 6769 6e20 616e   plane origin an
-00027040: 6420 616e 2075 2061 6e64 2076 2070 6c61  d an u and v pla
-00027050: 6e65 2076 6563 746f 722e 0a0a 2020 2020  ne vector...    
-00027060: 2020 2020 3a70 6172 616d 2070 6c61 6e65      :param plane
-00027070: 5f6f 7269 6769 6e3a 2070 6c61 6e65 206f  _origin: plane o
-00027080: 7269 6769 6e2e 0a20 2020 2020 2020 203a  rigin..        :
-00027090: 7061 7261 6d20 783a 2070 6c61 6e65 2075  param x: plane u
-000270a0: 2076 6563 746f 722e 0a20 2020 2020 2020   vector..       
-000270b0: 203a 7061 7261 6d20 793a 2070 6c61 6e65   :param y: plane
-000270c0: 2076 2076 6563 746f 722e 0a20 2020 2020   v vector..     
-000270d0: 2020 203a 7265 7475 726e 3a20 4369 7263     :return: Circ
-000270e0: 6c65 3344 2e0a 2020 2020 2020 2020 2222  le3D..        ""
-000270f0: 220a 2020 2020 2020 2020 6e6f 726d 616c  ".        normal
-00027100: 203d 2078 2e63 726f 7373 2879 290a 2020   = x.cross(y).  
-00027110: 2020 2020 2020 6365 6e74 6572 3364 203d        center3d =
-00027120: 2073 656c 662e 6365 6e74 6572 2e74 6f5f   self.center.to_
-00027130: 3364 2870 6c61 6e65 5f6f 7269 6769 6e2c  3d(plane_origin,
-00027140: 2078 2c20 7929 0a20 2020 2020 2020 2072   x, y).        r
-00027150: 6574 7572 6e20 4369 7263 6c65 3344 2876  eturn Circle3D(v
-00027160: 6f6c 6d64 6c72 2e46 7261 6d65 3344 2863  olmdlr.Frame3D(c
-00027170: 656e 7465 7233 642c 2078 2c20 792c 206e  enter3d, x, y, n
-00027180: 6f72 6d61 6c29 2c0a 2020 2020 2020 2020  ormal),.        
-00027190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000271a0: 7365 6c66 2e72 6164 6975 732c 2073 656c  self.radius, sel
-000271b0: 662e 6e61 6d65 290a 0a20 2020 2064 6566  f.name)..    def
-000271c0: 2072 6f74 6174 696f 6e28 7365 6c66 2c20   rotation(self, 
-000271d0: 6365 6e74 6572 3a20 766f 6c6d 646c 722e  center: volmdlr.
-000271e0: 506f 696e 7432 442c 2061 6e67 6c65 3a20  Point2D, angle: 
-000271f0: 666c 6f61 7429 3a0a 2020 2020 2020 2020  float):.        
-00027200: 2222 220a 2020 2020 2020 2020 4369 7263  """.        Circ
-00027210: 6c65 3244 2072 6f74 6174 696f 6e2e 0a0a  le2D rotation...
-00027220: 2020 2020 2020 2020 3a70 6172 616d 2063          :param c
-00027230: 656e 7465 723a 2072 6f74 6174 696f 6e20  enter: rotation 
-00027240: 6365 6e74 6572 2e0a 2020 2020 2020 2020  center..        
-00027250: 3a70 6172 616d 2061 6e67 6c65 3a20 616e  :param angle: an
-00027260: 676c 6520 726f 7461 7469 6f6e 2e0a 2020  gle rotation..  
-00027270: 2020 2020 2020 3a72 6574 7572 6e3a 2061        :return: a
-00027280: 206e 6577 2072 6f74 6174 6564 2043 6972   new rotated Cir
-00027290: 636c 6532 442e 0a20 2020 2020 2020 2022  cle2D..        "
-000272a0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-000272b0: 6e20 4369 7263 6c65 3244 2873 656c 662e  n Circle2D(self.
-000272c0: 6365 6e74 6572 2e72 6f74 6174 696f 6e28  center.rotation(
-000272d0: 6365 6e74 6572 2c20 616e 676c 6529 2c20  center, angle), 
-000272e0: 7365 6c66 2e72 6164 6975 7329 0a0a 2020  self.radius)..  
-000272f0: 2020 6465 6620 726f 7461 7469 6f6e 5f69    def rotation_i
-00027300: 6e70 6c61 6365 2873 656c 662c 2063 656e  nplace(self, cen
-00027310: 7465 723a 2076 6f6c 6d64 6c72 2e50 6f69  ter: volmdlr.Poi
-00027320: 6e74 3244 2c20 616e 676c 653a 2066 6c6f  nt2D, angle: flo
-00027330: 6174 293a 0a20 2020 2020 2020 2022 2222  at):.        """
-00027340: 0a20 2020 2020 2020 2043 6972 636c 6532  .        Circle2
-00027350: 4420 726f 7461 7469 6f6e 2e20 4f62 6a65  D rotation. Obje
-00027360: 6374 2069 7320 7570 6461 7465 6420 696e  ct is updated in
-00027370: 706c 6163 652e 0a0a 2020 2020 2020 2020  place...        
-00027380: 3a70 6172 616d 2063 656e 7465 723a 2072  :param center: r
-00027390: 6f74 6174 696f 6e20 6365 6e74 6572 0a20  otation center. 
-000273a0: 2020 2020 2020 203a 7061 7261 6d20 616e         :param an
-000273b0: 676c 653a 2072 6f74 6174 696f 6e20 616e  gle: rotation an
-000273c0: 676c 650a 2020 2020 2020 2020 2222 220a  gle.        """.
-000273d0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-000273e0: 2e77 6172 6e28 2227 696e 706c 6163 6527  .warn("'inplace'
-000273f0: 206d 6574 686f 6473 2061 7265 2064 6570   methods are dep
-00027400: 7265 6361 7465 642e 2055 7365 2061 206e  recated. Use a n
-00027410: 6f74 2069 6e70 6c61 6365 206d 6574 686f  ot inplace metho
-00027420: 6420 696e 7374 6561 642e 222c 2044 6570  d instead.", Dep
-00027430: 7265 6361 7469 6f6e 5761 726e 696e 6729  recationWarning)
-00027440: 0a0a 2020 2020 2020 2020 7365 6c66 2e63  ..        self.c
-00027450: 656e 7465 722e 726f 7461 7469 6f6e 5f69  enter.rotation_i
-00027460: 6e70 6c61 6365 2863 656e 7465 722c 2061  nplace(center, a
-00027470: 6e67 6c65 290a 0a20 2020 2064 6566 2074  ngle)..    def t
-00027480: 7261 6e73 6c61 7469 6f6e 2873 656c 662c  ranslation(self,
-00027490: 206f 6666 7365 743a 2076 6f6c 6d64 6c72   offset: volmdlr
-000274a0: 2e56 6563 746f 7232 4429 3a0a 2020 2020  .Vector2D):.    
-000274b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000274c0: 4369 7263 6c65 3244 2074 7261 6e73 6c61  Circle2D transla
-000274d0: 7469 6f6e 2e0a 0a20 2020 2020 2020 203a  tion...        :
-000274e0: 7061 7261 6d20 6f66 6673 6574 3a20 7472  param offset: tr
-000274f0: 616e 736c 6174 696f 6e20 7665 6374 6f72  anslation vector
-00027500: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00027510: 3a20 4120 6e65 7720 7472 616e 736c 6174  : A new translat
-00027520: 6564 2043 6972 636c 6532 440a 2020 2020  ed Circle2D.    
-00027530: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00027540: 7265 7475 726e 2043 6972 636c 6532 4428  return Circle2D(
-00027550: 7365 6c66 2e63 656e 7465 722e 7472 616e  self.center.tran
-00027560: 736c 6174 696f 6e28 6f66 6673 6574 292c  slation(offset),
-00027570: 2073 656c 662e 7261 6469 7573 290a 0a20   self.radius).. 
-00027580: 2020 2064 6566 2074 7261 6e73 6c61 7469     def translati
-00027590: 6f6e 5f69 6e70 6c61 6365 2873 656c 662c  on_inplace(self,
-000275a0: 206f 6666 7365 743a 2076 6f6c 6d64 6c72   offset: volmdlr
-000275b0: 2e56 6563 746f 7233 4429 3a0a 2020 2020  .Vector3D):.    
-000275c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000275d0: 4369 7263 6c65 3244 2074 7261 6e73 6c61  Circle2D transla
-000275e0: 7469 6f6e 2e20 4f62 6a65 6374 2069 7320  tion. Object is 
-000275f0: 7570 6461 7465 6420 696e 706c 6163 652e  updated inplace.
-00027600: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00027610: 206f 6666 7365 743a 2074 7261 6e73 6c61   offset: transla
-00027620: 7469 6f6e 2076 6563 746f 720a 2020 2020  tion vector.    
-00027630: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00027640: 7761 726e 696e 6773 2e77 6172 6e28 2227  warnings.warn("'
-00027650: 696e 706c 6163 6527 206d 6574 686f 6473  inplace' methods
-00027660: 2061 7265 2064 6570 7265 6361 7465 642e   are deprecated.
-00027670: 2055 7365 2061 206e 6f74 2069 6e70 6c61   Use a not inpla
-00027680: 6365 206d 6574 686f 6420 696e 7374 6561  ce method instea
-00027690: 642e 222c 2044 6570 7265 6361 7469 6f6e  d.", Deprecation
-000276a0: 5761 726e 696e 6729 0a0a 2020 2020 2020  Warning)..      
-000276b0: 2020 7365 6c66 2e63 656e 7465 722e 7472    self.center.tr
-000276c0: 616e 736c 6174 696f 6e5f 696e 706c 6163  anslation_inplac
-000276d0: 6528 6f66 6673 6574 290a 0a20 2020 2064  e(offset)..    d
-000276e0: 6566 2066 7261 6d65 5f6d 6170 7069 6e67  ef frame_mapping
-000276f0: 2873 656c 662c 2066 7261 6d65 3a20 766f  (self, frame: vo
-00027700: 6c6d 646c 722e 4672 616d 6533 442c 2073  lmdlr.Frame3D, s
-00027710: 6964 653a 2073 7472 293a 0a20 2020 2020  ide: str):.     
-00027720: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-00027730: 6861 6e67 6573 2066 7261 6d65 5f6d 6170  hanges frame_map
-00027740: 7069 6e67 2061 6e64 2072 6574 7572 6e20  ping and return 
-00027750: 6120 6e65 7720 4369 7263 6c65 3244 0a20  a new Circle2D. 
-00027760: 2020 2020 2020 2073 6964 6520 3d20 276f         side = 'o
-00027770: 6c64 2720 6f72 2027 6e65 7727 0a20 2020  ld' or 'new'.   
-00027780: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00027790: 2069 6620 7369 6465 203d 3d20 276f 6c64   if side == 'old
-000277a0: 273a 0a20 2020 2020 2020 2020 2020 2072  ':.            r
-000277b0: 6574 7572 6e20 4369 7263 6c65 3244 2866  eturn Circle2D(f
-000277c0: 7261 6d65 2e6c 6f63 616c 5f74 6f5f 676c  rame.local_to_gl
-000277d0: 6f62 616c 5f63 6f6f 7264 696e 6174 6573  obal_coordinates
-000277e0: 2873 656c 662e 6365 6e74 6572 292c 0a20  (self.center),. 
-000277f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027800: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00027810: 7261 6469 7573 290a 2020 2020 2020 2020  radius).        
-00027820: 656c 6966 2073 6964 6520 3d3d 2027 6e65  elif side == 'ne
-00027830: 7727 3a0a 2020 2020 2020 2020 2020 2020  w':.            
-00027840: 7265 7475 726e 2043 6972 636c 6532 4428  return Circle2D(
-00027850: 6672 616d 652e 676c 6f62 616c 5f74 6f5f  frame.global_to_
-00027860: 6c6f 6361 6c5f 636f 6f72 6469 6e61 7465  local_coordinate
-00027870: 7328 7365 6c66 2e63 656e 7465 7229 2c0a  s(self.center),.
-00027880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027890: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000278a0: 2e72 6164 6975 7329 0a20 2020 2020 2020  .radius).       
-000278b0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000278c0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000278d0: 726f 7228 2753 6964 6520 7368 6f75 6c64  ror('Side should
-000278e0: 2062 6520 5c27 6e65 775c 2720 5c27 6f6c   be \'new\' \'ol
-000278f0: 645c 2727 290a 0a20 2020 2064 6566 2066  d\'')..    def f
-00027900: 7261 6d65 5f6d 6170 7069 6e67 5f69 6e70  rame_mapping_inp
-00027910: 6c61 6365 2873 656c 662c 2066 7261 6d65  lace(self, frame
-00027920: 3a20 766f 6c6d 646c 722e 4672 616d 6533  : volmdlr.Frame3
-00027930: 442c 2073 6964 653a 2073 7472 293a 0a20  D, side: str):. 
-00027940: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00027950: 2020 2043 6861 6e67 6573 2066 7261 6d65     Changes frame
-00027960: 5f6d 6170 7069 6e67 2061 6e64 2074 6865  _mapping and the
-00027970: 206f 626a 6563 7420 6973 2075 7064 6174   object is updat
-00027980: 6564 2069 6e70 6c61 6365 0a20 2020 2020  ed inplace.     
-00027990: 2020 2073 6964 6520 3d20 276f 6c64 2720     side = 'old' 
-000279a0: 6f72 2027 6e65 7727 0a20 2020 2020 2020  or 'new'.       
-000279b0: 2022 2222 0a20 2020 2020 2020 2077 6172   """.        war
-000279c0: 6e69 6e67 732e 7761 726e 2822 2769 6e70  nings.warn("'inp
-000279d0: 6c61 6365 2720 6d65 7468 6f64 7320 6172  lace' methods ar
-000279e0: 6520 6465 7072 6563 6174 6564 2e20 5573  e deprecated. Us
-000279f0: 6520 6120 6e6f 7420 696e 706c 6163 6520  e a not inplace 
-00027a00: 6d65 7468 6f64 2069 6e73 7465 6164 2e22  method instead."
-00027a10: 2c20 4465 7072 6563 6174 696f 6e57 6172  , DeprecationWar
-00027a20: 6e69 6e67 290a 0a20 2020 2020 2020 2069  ning)..        i
-00027a30: 6620 7369 6465 203d 3d20 276f 6c64 273a  f side == 'old':
-00027a40: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00027a50: 662e 6365 6e74 6572 203d 2066 7261 6d65  f.center = frame
-00027a60: 2e6c 6f63 616c 5f74 6f5f 676c 6f62 616c  .local_to_global
-00027a70: 5f63 6f6f 7264 696e 6174 6573 2873 656c  _coordinates(sel
-00027a80: 662e 6365 6e74 6572 290a 2020 2020 2020  f.center).      
-00027a90: 2020 656c 6966 2073 6964 6520 3d3d 2027    elif side == '
-00027aa0: 6e65 7727 3a0a 2020 2020 2020 2020 2020  new':.          
-00027ab0: 2020 7365 6c66 2e63 656e 7465 7220 3d20    self.center = 
-00027ac0: 6672 616d 652e 676c 6f62 616c 5f74 6f5f  frame.global_to_
-00027ad0: 6c6f 6361 6c5f 636f 6f72 6469 6e61 7465  local_coordinate
-00027ae0: 7328 7365 6c66 2e63 656e 7465 7229 0a20  s(self.center). 
-00027af0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00027b00: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00027b10: 616c 7565 4572 726f 7228 2753 6964 6520  alueError('Side 
-00027b20: 7368 6f75 6c64 2062 6520 5c27 6e65 775c  should be \'new\
-00027b30: 2720 5c27 6f6c 645c 2727 290a 0a20 2020  ' \'old\'')..   
-00027b40: 2064 6566 2061 7265 6128 7365 6c66 293a   def area(self):
-00027b50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00027b60: 6d61 7468 2e70 6920 2a20 7365 6c66 2e72  math.pi * self.r
-00027b70: 6164 6975 7320 2a2a 2032 0a0a 2020 2020  adius ** 2..    
-00027b80: 6465 6620 7365 636f 6e64 5f6d 6f6d 656e  def second_momen
-00027b90: 745f 6172 6561 2873 656c 662c 2070 6f69  t_area(self, poi
-00027ba0: 6e74 293a 0a20 2020 2020 2020 2022 2222  nt):.        """
-00027bb0: 0a20 2020 2020 2020 2053 6563 6f6e 6420  .        Second 
-00027bc0: 6d6f 6d65 6e74 2061 7265 6120 6f66 2070  moment area of p
-00027bd0: 6172 7420 6f66 2064 6973 6b0a 2020 2020  art of disk.    
-00027be0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00027bf0: 736d 6120 3d20 6d61 7468 2e70 6920 2a20  sma = math.pi * 
-00027c00: 7365 6c66 2e72 6164 6975 7320 2a2a 2034  self.radius ** 4
-00027c10: 202f 2034 0a20 2020 2020 2020 2072 6574   / 4.        ret
-00027c20: 7572 6e20 766f 6c6d 646c 722e 6765 6f6d  urn volmdlr.geom
-00027c30: 6574 7279 2e68 7579 6765 6e73 3264 2873  etry.huygens2d(s
-00027c40: 6d61 2c20 736d 612c 2030 2c20 7365 6c66  ma, sma, 0, self
-00027c50: 2e61 7265 6128 292c 2073 656c 662e 6365  .area(), self.ce
-00027c60: 6e74 6572 2c20 706f 696e 7429 0a0a 2020  nter, point)..  
-00027c70: 2020 6465 6620 6365 6e74 6572 5f6f 665f    def center_of_
-00027c80: 6d61 7373 2873 656c 6629 3a0a 2020 2020  mass(self):.    
-00027c90: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00027ca0: 6365 6e74 6572 0a0a 2020 2020 6465 6620  center..    def 
-00027cb0: 706f 696e 745f 7379 6d6d 6574 7269 6328  point_symmetric(
-00027cc0: 7365 6c66 2c20 706f 696e 7429 3a0a 2020  self, point):.  
-00027cd0: 2020 2020 2020 6365 6e74 6572 203d 2032        center = 2
-00027ce0: 202a 2070 6f69 6e74 202d 2073 656c 662e   * point - self.
-00027cf0: 6365 6e74 6572 0a20 2020 2020 2020 2072  center.        r
-00027d00: 6574 7572 6e20 4369 7263 6c65 3244 2863  eturn Circle2D(c
-00027d10: 656e 7465 722c 2073 656c 662e 7261 6469  enter, self.radi
-00027d20: 7573 290a 0a20 2020 2064 6566 2070 6c6f  us)..    def plo
-00027d30: 745f 6461 7461 2873 656c 662c 2065 6467  t_data(self, edg
-00027d40: 655f 7374 796c 653a 2070 6c6f 745f 6461  e_style: plot_da
-00027d50: 7461 2e45 6467 6553 7479 6c65 203d 204e  ta.EdgeStyle = N
-00027d60: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-00027d70: 2020 2020 2020 2073 7572 6661 6365 5f73         surface_s
-00027d80: 7479 6c65 3a20 706c 6f74 5f64 6174 612e  tyle: plot_data.
-00027d90: 5375 7266 6163 6553 7479 6c65 203d 204e  SurfaceStyle = N
-00027da0: 6f6e 6529 3a0a 2020 2020 2020 2020 7265  one):.        re
-00027db0: 7475 726e 2070 6c6f 745f 6461 7461 2e43  turn plot_data.C
-00027dc0: 6972 636c 6532 4428 6378 3d73 656c 662e  ircle2D(cx=self.
-00027dd0: 6365 6e74 6572 2e78 2c20 6379 3d73 656c  center.x, cy=sel
-00027de0: 662e 6365 6e74 6572 2e79 2c0a 2020 2020  f.center.y,.    
+00026f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026f60: 2020 2020 2020 2020 6c69 6e65 7769 6474          linewidt
+00026f70: 683d 6c69 6e65 7769 6474 6829 290a 2020  h=linewidth)).  
+00026f80: 2020 2020 2020 6966 2065 7175 616c 5f61        if equal_a
+00026f90: 7370 6563 743a 0a20 2020 2020 2020 2020  spect:.         
+00026fa0: 2020 2061 782e 7365 745f 6173 7065 6374     ax.set_aspect
+00026fb0: 2827 6571 7561 6c27 290a 2020 2020 2020  ('equal').      
+00026fc0: 2020 7265 7475 726e 2061 780a 0a20 2020    return ax..   
+00026fd0: 2064 6566 2074 6f5f 3364 2873 656c 662c   def to_3d(self,
+00026fe0: 2070 6c61 6e65 5f6f 7269 6769 6e2c 2078   plane_origin, x
+00026ff0: 2c20 7929 3a0a 2020 2020 2020 2020 2222  , y):.        ""
+00027000: 220a 2020 2020 2020 2020 5472 616e 7366  ".        Transf
+00027010: 6f72 6d73 2061 2043 6972 636c 6532 4420  orms a Circle2D 
+00027020: 696e 746f 2061 6e20 4369 7263 6c65 3344  into an Circle3D
+00027030: 2c20 6769 7665 6e20 6120 706c 616e 6520  , given a plane 
+00027040: 6f72 6967 696e 2061 6e64 2061 6e20 7520  origin and an u 
+00027050: 616e 6420 7620 706c 616e 6520 7665 6374  and v plane vect
+00027060: 6f72 2e0a 0a20 2020 2020 2020 203a 7061  or...        :pa
+00027070: 7261 6d20 706c 616e 655f 6f72 6967 696e  ram plane_origin
+00027080: 3a20 706c 616e 6520 6f72 6967 696e 2e0a  : plane origin..
+00027090: 2020 2020 2020 2020 3a70 6172 616d 2078          :param x
+000270a0: 3a20 706c 616e 6520 7520 7665 6374 6f72  : plane u vector
+000270b0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000270c0: 2079 3a20 706c 616e 6520 7620 7665 6374   y: plane v vect
+000270d0: 6f72 2e0a 2020 2020 2020 2020 3a72 6574  or..        :ret
+000270e0: 7572 6e3a 2043 6972 636c 6533 442e 0a20  urn: Circle3D.. 
+000270f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00027100: 2020 206e 6f72 6d61 6c20 3d20 782e 6372     normal = x.cr
+00027110: 6f73 7328 7929 0a20 2020 2020 2020 2063  oss(y).        c
+00027120: 656e 7465 7233 6420 3d20 7365 6c66 2e63  enter3d = self.c
+00027130: 656e 7465 722e 746f 5f33 6428 706c 616e  enter.to_3d(plan
+00027140: 655f 6f72 6967 696e 2c20 782c 2079 290a  e_origin, x, y).
+00027150: 2020 2020 2020 2020 7265 7475 726e 2043          return C
+00027160: 6972 636c 6533 4428 766f 6c6d 646c 722e  ircle3D(volmdlr.
+00027170: 4672 616d 6533 4428 6365 6e74 6572 3364  Frame3D(center3d
+00027180: 2c20 782c 2079 2c20 6e6f 726d 616c 292c  , x, y, normal),
+00027190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000271a0: 2020 2020 2020 2020 2073 656c 662e 7261           self.ra
+000271b0: 6469 7573 2c20 7365 6c66 2e6e 616d 6529  dius, self.name)
+000271c0: 0a0a 2020 2020 6465 6620 726f 7461 7469  ..    def rotati
+000271d0: 6f6e 2873 656c 662c 2063 656e 7465 723a  on(self, center:
+000271e0: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3244   volmdlr.Point2D
+000271f0: 2c20 616e 676c 653a 2066 6c6f 6174 293a  , angle: float):
+00027200: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00027210: 2020 2020 2043 6972 636c 6532 4420 726f       Circle2D ro
+00027220: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
+00027230: 203a 7061 7261 6d20 6365 6e74 6572 3a20   :param center: 
+00027240: 726f 7461 7469 6f6e 2063 656e 7465 722e  rotation center.
+00027250: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00027260: 616e 676c 653a 2061 6e67 6c65 2072 6f74  angle: angle rot
+00027270: 6174 696f 6e2e 0a20 2020 2020 2020 203a  ation..        :
+00027280: 7265 7475 726e 3a20 6120 6e65 7720 726f  return: a new ro
+00027290: 7461 7465 6420 4369 7263 6c65 3244 2e0a  tated Circle2D..
+000272a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000272b0: 2020 2020 7265 7475 726e 2043 6972 636c      return Circl
+000272c0: 6532 4428 7365 6c66 2e63 656e 7465 722e  e2D(self.center.
+000272d0: 726f 7461 7469 6f6e 2863 656e 7465 722c  rotation(center,
+000272e0: 2061 6e67 6c65 292c 2073 656c 662e 7261   angle), self.ra
+000272f0: 6469 7573 290a 0a20 2020 2064 6566 2072  dius)..    def r
+00027300: 6f74 6174 696f 6e5f 696e 706c 6163 6528  otation_inplace(
+00027310: 7365 6c66 2c20 6365 6e74 6572 3a20 766f  self, center: vo
+00027320: 6c6d 646c 722e 506f 696e 7432 442c 2061  lmdlr.Point2D, a
+00027330: 6e67 6c65 3a20 666c 6f61 7429 3a0a 2020  ngle: float):.  
+00027340: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00027350: 2020 4369 7263 6c65 3244 2072 6f74 6174    Circle2D rotat
+00027360: 696f 6e2e 204f 626a 6563 7420 6973 2075  ion. Object is u
+00027370: 7064 6174 6564 2069 6e70 6c61 6365 2e0a  pdated inplace..
+00027380: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00027390: 6365 6e74 6572 3a20 726f 7461 7469 6f6e  center: rotation
+000273a0: 2063 656e 7465 720a 2020 2020 2020 2020   center.        
+000273b0: 3a70 6172 616d 2061 6e67 6c65 3a20 726f  :param angle: ro
+000273c0: 7461 7469 6f6e 2061 6e67 6c65 0a20 2020  tation angle.   
+000273d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000273e0: 2077 6172 6e69 6e67 732e 7761 726e 2822   warnings.warn("
+000273f0: 2769 6e70 6c61 6365 2720 6d65 7468 6f64  'inplace' method
+00027400: 7320 6172 6520 6465 7072 6563 6174 6564  s are deprecated
+00027410: 2e20 5573 6520 6120 6e6f 7420 696e 706c  . Use a not inpl
+00027420: 6163 6520 6d65 7468 6f64 2069 6e73 7465  ace method inste
+00027430: 6164 2e22 2c20 4465 7072 6563 6174 696f  ad.", Deprecatio
+00027440: 6e57 6172 6e69 6e67 290a 0a20 2020 2020  nWarning)..     
+00027450: 2020 2073 656c 662e 6365 6e74 6572 2e72     self.center.r
+00027460: 6f74 6174 696f 6e5f 696e 706c 6163 6528  otation_inplace(
+00027470: 6365 6e74 6572 2c20 616e 676c 6529 0a0a  center, angle)..
+00027480: 2020 2020 6465 6620 7472 616e 736c 6174      def translat
+00027490: 696f 6e28 7365 6c66 2c20 6f66 6673 6574  ion(self, offset
+000274a0: 3a20 766f 6c6d 646c 722e 5665 6374 6f72  : volmdlr.Vector
+000274b0: 3244 293a 0a20 2020 2020 2020 2022 2222  2D):.        """
+000274c0: 0a20 2020 2020 2020 2043 6972 636c 6532  .        Circle2
+000274d0: 4420 7472 616e 736c 6174 696f 6e2e 0a0a  D translation...
+000274e0: 2020 2020 2020 2020 3a70 6172 616d 206f          :param o
+000274f0: 6666 7365 743a 2074 7261 6e73 6c61 7469  ffset: translati
+00027500: 6f6e 2076 6563 746f 720a 2020 2020 2020  on vector.      
+00027510: 2020 3a72 6574 7572 6e3a 2041 206e 6577    :return: A new
+00027520: 2074 7261 6e73 6c61 7465 6420 4369 7263   translated Circ
+00027530: 6c65 3244 0a20 2020 2020 2020 2022 2222  le2D.        """
+00027540: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00027550: 4369 7263 6c65 3244 2873 656c 662e 6365  Circle2D(self.ce
+00027560: 6e74 6572 2e74 7261 6e73 6c61 7469 6f6e  nter.translation
+00027570: 286f 6666 7365 7429 2c20 7365 6c66 2e72  (offset), self.r
+00027580: 6164 6975 7329 0a0a 2020 2020 6465 6620  adius)..    def 
+00027590: 7472 616e 736c 6174 696f 6e5f 696e 706c  translation_inpl
+000275a0: 6163 6528 7365 6c66 2c20 6f66 6673 6574  ace(self, offset
+000275b0: 3a20 766f 6c6d 646c 722e 5665 6374 6f72  : volmdlr.Vector
+000275c0: 3344 293a 0a20 2020 2020 2020 2022 2222  3D):.        """
+000275d0: 0a20 2020 2020 2020 2043 6972 636c 6532  .        Circle2
+000275e0: 4420 7472 616e 736c 6174 696f 6e2e 204f  D translation. O
+000275f0: 626a 6563 7420 6973 2075 7064 6174 6564  bject is updated
+00027600: 2069 6e70 6c61 6365 2e0a 0a20 2020 2020   inplace...     
+00027610: 2020 203a 7061 7261 6d20 6f66 6673 6574     :param offset
+00027620: 3a20 7472 616e 736c 6174 696f 6e20 7665  : translation ve
+00027630: 6374 6f72 0a20 2020 2020 2020 2022 2222  ctor.        """
+00027640: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
+00027650: 732e 7761 726e 2822 2769 6e70 6c61 6365  s.warn("'inplace
+00027660: 2720 6d65 7468 6f64 7320 6172 6520 6465  ' methods are de
+00027670: 7072 6563 6174 6564 2e20 5573 6520 6120  precated. Use a 
+00027680: 6e6f 7420 696e 706c 6163 6520 6d65 7468  not inplace meth
+00027690: 6f64 2069 6e73 7465 6164 2e22 2c20 4465  od instead.", De
+000276a0: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
+000276b0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000276c0: 6365 6e74 6572 2e74 7261 6e73 6c61 7469  center.translati
+000276d0: 6f6e 5f69 6e70 6c61 6365 286f 6666 7365  on_inplace(offse
+000276e0: 7429 0a0a 2020 2020 6465 6620 6672 616d  t)..    def fram
+000276f0: 655f 6d61 7070 696e 6728 7365 6c66 2c20  e_mapping(self, 
+00027700: 6672 616d 653a 2076 6f6c 6d64 6c72 2e46  frame: volmdlr.F
+00027710: 7261 6d65 3344 2c20 7369 6465 3a20 7374  rame3D, side: st
+00027720: 7229 3a0a 2020 2020 2020 2020 2222 220a  r):.        """.
+00027730: 2020 2020 2020 2020 4368 616e 6765 7320          Changes 
+00027740: 6672 616d 655f 6d61 7070 696e 6720 616e  frame_mapping an
+00027750: 6420 7265 7475 726e 2061 206e 6577 2043  d return a new C
+00027760: 6972 636c 6532 440a 2020 2020 2020 2020  ircle2D.        
+00027770: 7369 6465 203d 2027 6f6c 6427 206f 7220  side = 'old' or 
+00027780: 276e 6577 270a 2020 2020 2020 2020 2222  'new'.        ""
+00027790: 220a 2020 2020 2020 2020 6966 2073 6964  ".        if sid
+000277a0: 6520 3d3d 2027 6f6c 6427 3a0a 2020 2020  e == 'old':.    
+000277b0: 2020 2020 2020 2020 7265 7475 726e 2043          return C
+000277c0: 6972 636c 6532 4428 6672 616d 652e 6c6f  ircle2D(frame.lo
+000277d0: 6361 6c5f 746f 5f67 6c6f 6261 6c5f 636f  cal_to_global_co
+000277e0: 6f72 6469 6e61 7465 7328 7365 6c66 2e63  ordinates(self.c
+000277f0: 656e 7465 7229 2c0a 2020 2020 2020 2020  enter),.        
+00027800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027810: 2020 2020 7365 6c66 2e72 6164 6975 7329      self.radius)
+00027820: 0a20 2020 2020 2020 2065 6c69 6620 7369  .        elif si
+00027830: 6465 203d 3d20 276e 6577 273a 0a20 2020  de == 'new':.   
+00027840: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00027850: 4369 7263 6c65 3244 2866 7261 6d65 2e67  Circle2D(frame.g
+00027860: 6c6f 6261 6c5f 746f 5f6c 6f63 616c 5f63  lobal_to_local_c
+00027870: 6f6f 7264 696e 6174 6573 2873 656c 662e  oordinates(self.
+00027880: 6365 6e74 6572 292c 0a20 2020 2020 2020  center),.       
+00027890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000278a0: 2020 2020 2073 656c 662e 7261 6469 7573       self.radius
+000278b0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+000278c0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000278d0: 6520 5661 6c75 6545 7272 6f72 2827 5369  e ValueError('Si
+000278e0: 6465 2073 686f 756c 6420 6265 205c 276e  de should be \'n
+000278f0: 6577 5c27 205c 276f 6c64 5c27 2729 0a0a  ew\' \'old\'')..
+00027900: 2020 2020 6465 6620 6672 616d 655f 6d61      def frame_ma
+00027910: 7070 696e 675f 696e 706c 6163 6528 7365  pping_inplace(se
+00027920: 6c66 2c20 6672 616d 653a 2076 6f6c 6d64  lf, frame: volmd
+00027930: 6c72 2e46 7261 6d65 3344 2c20 7369 6465  lr.Frame3D, side
+00027940: 3a20 7374 7229 3a0a 2020 2020 2020 2020  : str):.        
+00027950: 2222 220a 2020 2020 2020 2020 4368 616e  """.        Chan
+00027960: 6765 7320 6672 616d 655f 6d61 7070 696e  ges frame_mappin
+00027970: 6720 616e 6420 7468 6520 6f62 6a65 6374  g and the object
+00027980: 2069 7320 7570 6461 7465 6420 696e 706c   is updated inpl
+00027990: 6163 652e 0a0a 2020 2020 2020 2020 7369  ace...        si
+000279a0: 6465 203d 2027 6f6c 6427 206f 7220 276e  de = 'old' or 'n
+000279b0: 6577 270a 2020 2020 2020 2020 2222 220a  ew'.        """.
+000279c0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+000279d0: 2e77 6172 6e28 2227 696e 706c 6163 6527  .warn("'inplace'
+000279e0: 206d 6574 686f 6473 2061 7265 2064 6570   methods are dep
+000279f0: 7265 6361 7465 642e 2055 7365 2061 206e  recated. Use a n
+00027a00: 6f74 2069 6e70 6c61 6365 206d 6574 686f  ot inplace metho
+00027a10: 6420 696e 7374 6561 642e 222c 2044 6570  d instead.", Dep
+00027a20: 7265 6361 7469 6f6e 5761 726e 696e 6729  recationWarning)
+00027a30: 0a0a 2020 2020 2020 2020 6966 2073 6964  ..        if sid
+00027a40: 6520 3d3d 2027 6f6c 6427 3a0a 2020 2020  e == 'old':.    
+00027a50: 2020 2020 2020 2020 7365 6c66 2e63 656e          self.cen
+00027a60: 7465 7220 3d20 6672 616d 652e 6c6f 6361  ter = frame.loca
+00027a70: 6c5f 746f 5f67 6c6f 6261 6c5f 636f 6f72  l_to_global_coor
+00027a80: 6469 6e61 7465 7328 7365 6c66 2e63 656e  dinates(self.cen
+00027a90: 7465 7229 0a20 2020 2020 2020 2065 6c69  ter).        eli
+00027aa0: 6620 7369 6465 203d 3d20 276e 6577 273a  f side == 'new':
+00027ab0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00027ac0: 662e 6365 6e74 6572 203d 2066 7261 6d65  f.center = frame
+00027ad0: 2e67 6c6f 6261 6c5f 746f 5f6c 6f63 616c  .global_to_local
+00027ae0: 5f63 6f6f 7264 696e 6174 6573 2873 656c  _coordinates(sel
+00027af0: 662e 6365 6e74 6572 290a 2020 2020 2020  f.center).      
+00027b00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00027b10: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00027b20: 7272 6f72 2827 5369 6465 2073 686f 756c  rror('Side shoul
+00027b30: 6420 6265 205c 276e 6577 5c27 205c 276f  d be \'new\' \'o
+00027b40: 6c64 5c27 2729 0a0a 2020 2020 6465 6620  ld\'')..    def 
+00027b50: 6172 6561 2873 656c 6629 3a0a 2020 2020  area(self):.    
+00027b60: 2020 2020 7265 7475 726e 206d 6174 682e      return math.
+00027b70: 7069 202a 2073 656c 662e 7261 6469 7573  pi * self.radius
+00027b80: 202a 2a20 320a 0a20 2020 2064 6566 2073   ** 2..    def s
+00027b90: 6563 6f6e 645f 6d6f 6d65 6e74 5f61 7265  econd_moment_are
+00027ba0: 6128 7365 6c66 2c20 706f 696e 7429 3a0a  a(self, point):.
+00027bb0: 2020 2020 2020 2020 2222 2253 6563 6f6e          """Secon
+00027bc0: 6420 6d6f 6d65 6e74 2061 7265 6120 6f66  d moment area of
+00027bd0: 2070 6172 7420 6f66 2064 6973 6b2e 2222   part of disk.""
+00027be0: 220a 2020 2020 2020 2020 736d 6120 3d20  ".        sma = 
+00027bf0: 6d61 7468 2e70 6920 2a20 7365 6c66 2e72  math.pi * self.r
+00027c00: 6164 6975 7320 2a2a 2034 202f 2034 0a20  adius ** 4 / 4. 
+00027c10: 2020 2020 2020 2072 6574 7572 6e20 766f         return vo
+00027c20: 6c6d 646c 722e 6765 6f6d 6574 7279 2e68  lmdlr.geometry.h
+00027c30: 7579 6765 6e73 3264 2873 6d61 2c20 736d  uygens2d(sma, sm
+00027c40: 612c 2030 2c20 7365 6c66 2e61 7265 6128  a, 0, self.area(
+00027c50: 292c 2073 656c 662e 6365 6e74 6572 2c20  ), self.center, 
+00027c60: 706f 696e 7429 0a0a 2020 2020 6465 6620  point)..    def 
+00027c70: 6365 6e74 6572 5f6f 665f 6d61 7373 2873  center_of_mass(s
+00027c80: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00027c90: 7475 726e 2073 656c 662e 6365 6e74 6572  turn self.center
+00027ca0: 0a0a 2020 2020 6465 6620 706f 696e 745f  ..    def point_
+00027cb0: 7379 6d6d 6574 7269 6328 7365 6c66 2c20  symmetric(self, 
+00027cc0: 706f 696e 7429 3a0a 2020 2020 2020 2020  point):.        
+00027cd0: 6365 6e74 6572 203d 2032 202a 2070 6f69  center = 2 * poi
+00027ce0: 6e74 202d 2073 656c 662e 6365 6e74 6572  nt - self.center
+00027cf0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00027d00: 4369 7263 6c65 3244 2863 656e 7465 722c  Circle2D(center,
+00027d10: 2073 656c 662e 7261 6469 7573 290a 0a20   self.radius).. 
+00027d20: 2020 2064 6566 2070 6c6f 745f 6461 7461     def plot_data
+00027d30: 2873 656c 662c 2065 6467 655f 7374 796c  (self, edge_styl
+00027d40: 653a 2070 6c6f 745f 6461 7461 2e45 6467  e: plot_data.Edg
+00027d50: 6553 7479 6c65 203d 204e 6f6e 652c 0a20  eStyle = None,. 
+00027d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d70: 2073 7572 6661 6365 5f73 7479 6c65 3a20   surface_style: 
+00027d80: 706c 6f74 5f64 6174 612e 5375 7266 6163  plot_data.Surfac
+00027d90: 6553 7479 6c65 203d 204e 6f6e 6529 3a0a  eStyle = None):.
+00027da0: 2020 2020 2020 2020 7265 7475 726e 2070          return p
+00027db0: 6c6f 745f 6461 7461 2e43 6972 636c 6532  lot_data.Circle2
+00027dc0: 4428 6378 3d73 656c 662e 6365 6e74 6572  D(cx=self.center
+00027dd0: 2e78 2c20 6379 3d73 656c 662e 6365 6e74  .x, cy=self.cent
+00027de0: 6572 2e79 2c0a 2020 2020 2020 2020 2020  er.y,.          
 00027df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e00: 2020 2020 2020 2020 2020 2020 2020 723d                r=
-00027e10: 7365 6c66 2e72 6164 6975 732c 0a20 2020  self.radius,.   
+00027e00: 2020 2020 2020 2020 723d 7365 6c66 2e72          r=self.r
+00027e10: 6164 6975 732c 0a20 2020 2020 2020 2020  adius,.         
 00027e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e30: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00027e40: 6467 655f 7374 796c 653d 6564 6765 5f73  dge_style=edge_s
-00027e50: 7479 6c65 2c0a 2020 2020 2020 2020 2020  tyle,.          
+00027e30: 2020 2020 2020 2020 2065 6467 655f 7374           edge_st
+00027e40: 796c 653d 6564 6765 5f73 7479 6c65 2c0a  yle=edge_style,.
+00027e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00027e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e70: 2020 2020 2020 2020 7375 7266 6163 655f          surface_
-00027e80: 7374 796c 653d 7375 7266 6163 655f 7374  style=surface_st
-00027e90: 796c 6529 0a0a 2020 2020 6465 6620 636f  yle)..    def co
-00027ea0: 7079 2873 656c 662c 202a 6172 6773 2c20  py(self, *args, 
-00027eb0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-00027ec0: 2020 2072 6574 7572 6e20 4369 7263 6c65     return Circle
-00027ed0: 3244 2873 656c 662e 6365 6e74 6572 2e63  2D(self.center.c
-00027ee0: 6f70 7928 292c 2073 656c 662e 7261 6469  opy(), self.radi
-00027ef0: 7573 290a 0a20 2020 2064 6566 2070 6f69  us)..    def poi
-00027f00: 6e74 5f61 745f 6162 7363 6973 7361 2873  nt_at_abscissa(s
-00027f10: 656c 662c 2063 7572 7669 6c69 6e65 6172  elf, curvilinear
-00027f20: 5f61 6273 6369 7373 6129 3a0a 2020 2020  _abscissa):.    
-00027f30: 2020 2020 7374 6172 7420 3d20 7365 6c66      start = self
-00027f40: 2e63 656e 7465 7220 2b20 7365 6c66 2e72  .center + self.r
-00027f50: 6164 6975 7320 2a20 766f 6c6d 646c 722e  adius * volmdlr.
-00027f60: 5833 440a 2020 2020 2020 2020 7265 7475  X3D.        retu
-00027f70: 726e 2073 7461 7274 2e72 6f74 6174 696f  rn start.rotatio
-00027f80: 6e28 7365 6c66 2e63 656e 7465 722c 0a20  n(self.center,. 
+00027e70: 2020 7375 7266 6163 655f 7374 796c 653d    surface_style=
+00027e80: 7375 7266 6163 655f 7374 796c 6529 0a0a  surface_style)..
+00027e90: 2020 2020 6465 6620 636f 7079 2873 656c      def copy(sel
+00027ea0: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00027eb0: 6773 293a 0a20 2020 2020 2020 2072 6574  gs):.        ret
+00027ec0: 7572 6e20 4369 7263 6c65 3244 2873 656c  urn Circle2D(sel
+00027ed0: 662e 6365 6e74 6572 2e63 6f70 7928 292c  f.center.copy(),
+00027ee0: 2073 656c 662e 7261 6469 7573 290a 0a20   self.radius).. 
+00027ef0: 2020 2064 6566 2070 6f69 6e74 5f61 745f     def point_at_
+00027f00: 6162 7363 6973 7361 2873 656c 662c 2063  abscissa(self, c
+00027f10: 7572 7669 6c69 6e65 6172 5f61 6273 6369  urvilinear_absci
+00027f20: 7373 6129 3a0a 2020 2020 2020 2020 7374  ssa):.        st
+00027f30: 6172 7420 3d20 7365 6c66 2e63 656e 7465  art = self.cente
+00027f40: 7220 2b20 7365 6c66 2e72 6164 6975 7320  r + self.radius 
+00027f50: 2a20 766f 6c6d 646c 722e 5833 440a 2020  * volmdlr.X3D.  
+00027f60: 2020 2020 2020 7265 7475 726e 2073 7461        return sta
+00027f70: 7274 2e72 6f74 6174 696f 6e28 7365 6c66  rt.rotation(self
+00027f80: 2e63 656e 7465 722c 0a20 2020 2020 2020  .center,.       
 00027f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027fa0: 2020 2020 2020 2020 2020 2020 2063 7572               cur
-00027fb0: 7669 6c69 6e65 6172 5f61 6273 6369 7373  vilinear_absciss
-00027fc0: 6120 2f20 7365 6c66 2e72 6164 6975 7329  a / self.radius)
-00027fd0: 0a0a 2020 2020 6465 6620 7370 6c69 745f  ..    def split_
-00027fe0: 6279 5f6c 696e 6528 7365 6c66 2c20 6c69  by_line(self, li
-00027ff0: 6e65 3a20 766f 6c6d 646c 722e 6564 6765  ne: volmdlr.edge
-00028000: 732e 4c69 6e65 3244 293a 0a20 2020 2020  s.Line2D):.     
-00028010: 2020 2022 2222 0a20 2020 2020 2020 2053     """.        S
-00028020: 706c 6974 2074 6865 2043 6972 636c 6520  plit the Circle 
-00028030: 7769 7468 2061 206c 696e 6520 696e 746f  with a line into
-00028040: 2074 776f 2041 7263 3244 2e0a 2020 2020   two Arc2D..    
-00028050: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00028060: 7370 6c69 745f 706f 696e 7473 203d 2073  split_points = s
-00028070: 656c 662e 6c69 6e65 5f69 6e74 6572 7365  elf.line_interse
-00028080: 6374 696f 6e73 286c 696e 6529 0a20 2020  ctions(line).   
-00028090: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000280a0: 2e73 706c 6974 2873 706c 6974 5f70 6f69  .split(split_poi
-000280b0: 6e74 735b 305d 2c20 7370 6c69 745f 706f  nts[0], split_po
-000280c0: 696e 7473 5b31 5d29 0a0a 2020 2020 6465  ints[1])..    de
-000280d0: 6620 7370 6c69 7428 7365 6c66 2c20 7370  f split(self, sp
-000280e0: 6c69 745f 7374 6172 742c 2073 706c 6974  lit_start, split
-000280f0: 5f65 6e64 293a 0a20 2020 2020 2020 2078  _end):.        x
-00028100: 312c 2079 3120 3d20 7370 6c69 745f 7374  1, y1 = split_st
-00028110: 6172 7420 2d20 7365 6c66 2e63 656e 7465  art - self.cente
-00028120: 720a 2020 2020 2020 2020 7832 2c20 7932  r.        x2, y2
-00028130: 203d 2073 706c 6974 5f65 6e64 202d 2073   = split_end - s
-00028140: 656c 662e 6365 6e74 6572 0a0a 2020 2020  elf.center..    
-00028150: 2020 2020 616e 676c 6531 203d 206d 6174      angle1 = mat
-00028160: 682e 6174 616e 3228 7931 2c20 7831 290a  h.atan2(y1, x1).
-00028170: 2020 2020 2020 2020 616e 676c 6532 203d          angle2 =
-00028180: 206d 6174 682e 6174 616e 3228 7932 2c20   math.atan2(y2, 
-00028190: 7832 290a 2020 2020 2020 2020 616e 676c  x2).        angl
-000281a0: 655f 6931 203d 2030 2e35 202a 2028 616e  e_i1 = 0.5 * (an
-000281b0: 676c 6532 202d 2061 6e67 6c65 3129 0a20  gle2 - angle1). 
-000281c0: 2020 2020 2020 2061 6e67 6c65 5f69 3220         angle_i2 
-000281d0: 3d20 616e 676c 655f 6931 202b 206d 6174  = angle_i1 + mat
-000281e0: 682e 7069 0a20 2020 2020 2020 2069 6e74  h.pi.        int
-000281f0: 6572 696f 725f 706f 696e 7431 203d 2073  erior_point1 = s
-00028200: 706c 6974 5f73 7461 7274 2e72 6f74 6174  plit_start.rotat
-00028210: 696f 6e28 7365 6c66 2e63 656e 7465 722c  ion(self.center,
-00028220: 2061 6e67 6c65 5f69 3129 0a20 2020 2020   angle_i1).     
-00028230: 2020 2069 6e74 6572 696f 725f 706f 696e     interior_poin
-00028240: 7432 203d 2073 706c 6974 5f73 7461 7274  t2 = split_start
-00028250: 2e72 6f74 6174 696f 6e28 7365 6c66 2e63  .rotation(self.c
-00028260: 656e 7465 722c 2061 6e67 6c65 5f69 3229  enter, angle_i2)
-00028270: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00028280: 205b 766f 6c6d 646c 722e 6564 6765 732e   [volmdlr.edges.
-00028290: 4172 6332 4428 7370 6c69 745f 7374 6172  Arc2D(split_star
-000282a0: 742c 2069 6e74 6572 696f 725f 706f 696e  t, interior_poin
-000282b0: 7431 2c0a 2020 2020 2020 2020 2020 2020  t1,.            
+00027fa0: 2020 2020 2020 2063 7572 7669 6c69 6e65         curviline
+00027fb0: 6172 5f61 6273 6369 7373 6120 2f20 7365  ar_abscissa / se
+00027fc0: 6c66 2e72 6164 6975 7329 0a0a 2020 2020  lf.radius)..    
+00027fd0: 6465 6620 7370 6c69 745f 6279 5f6c 696e  def split_by_lin
+00027fe0: 6528 7365 6c66 2c20 6c69 6e65 3a20 766f  e(self, line: vo
+00027ff0: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
+00028000: 3244 293a 0a20 2020 2020 2020 2022 2222  2D):.        """
+00028010: 0a20 2020 2020 2020 2053 706c 6974 2074  .        Split t
+00028020: 6865 2043 6972 636c 6520 7769 7468 2061  he Circle with a
+00028030: 206c 696e 6520 696e 746f 2074 776f 2041   line into two A
+00028040: 7263 3244 2e0a 2020 2020 2020 2020 2222  rc2D..        ""
+00028050: 220a 2020 2020 2020 2020 7370 6c69 745f  ".        split_
+00028060: 706f 696e 7473 203d 2073 656c 662e 6c69  points = self.li
+00028070: 6e65 5f69 6e74 6572 7365 6374 696f 6e73  ne_intersections
+00028080: 286c 696e 6529 0a20 2020 2020 2020 2072  (line).        r
+00028090: 6574 7572 6e20 7365 6c66 2e73 706c 6974  eturn self.split
+000280a0: 2873 706c 6974 5f70 6f69 6e74 735b 305d  (split_points[0]
+000280b0: 2c20 7370 6c69 745f 706f 696e 7473 5b31  , split_points[1
+000280c0: 5d29 0a0a 2020 2020 6465 6620 7370 6c69  ])..    def spli
+000280d0: 7428 7365 6c66 2c20 7370 6c69 745f 7374  t(self, split_st
+000280e0: 6172 742c 2073 706c 6974 5f65 6e64 293a  art, split_end):
+000280f0: 0a20 2020 2020 2020 2078 312c 2079 3120  .        x1, y1 
+00028100: 3d20 7370 6c69 745f 7374 6172 7420 2d20  = split_start - 
+00028110: 7365 6c66 2e63 656e 7465 720a 2020 2020  self.center.    
+00028120: 2020 2020 7832 2c20 7932 203d 2073 706c      x2, y2 = spl
+00028130: 6974 5f65 6e64 202d 2073 656c 662e 6365  it_end - self.ce
+00028140: 6e74 6572 0a0a 2020 2020 2020 2020 616e  nter..        an
+00028150: 676c 6531 203d 206d 6174 682e 6174 616e  gle1 = math.atan
+00028160: 3228 7931 2c20 7831 290a 2020 2020 2020  2(y1, x1).      
+00028170: 2020 616e 676c 6532 203d 206d 6174 682e    angle2 = math.
+00028180: 6174 616e 3228 7932 2c20 7832 290a 2020  atan2(y2, x2).  
+00028190: 2020 2020 2020 616e 676c 655f 6931 203d        angle_i1 =
+000281a0: 2030 2e35 202a 2028 616e 676c 6532 202d   0.5 * (angle2 -
+000281b0: 2061 6e67 6c65 3129 0a20 2020 2020 2020   angle1).       
+000281c0: 2061 6e67 6c65 5f69 3220 3d20 616e 676c   angle_i2 = angl
+000281d0: 655f 6931 202b 206d 6174 682e 7069 0a20  e_i1 + math.pi. 
+000281e0: 2020 2020 2020 2069 6e74 6572 696f 725f         interior_
+000281f0: 706f 696e 7431 203d 2073 706c 6974 5f73  point1 = split_s
+00028200: 7461 7274 2e72 6f74 6174 696f 6e28 7365  tart.rotation(se
+00028210: 6c66 2e63 656e 7465 722c 2061 6e67 6c65  lf.center, angle
+00028220: 5f69 3129 0a20 2020 2020 2020 2069 6e74  _i1).        int
+00028230: 6572 696f 725f 706f 696e 7432 203d 2073  erior_point2 = s
+00028240: 706c 6974 5f73 7461 7274 2e72 6f74 6174  plit_start.rotat
+00028250: 696f 6e28 7365 6c66 2e63 656e 7465 722c  ion(self.center,
+00028260: 2061 6e67 6c65 5f69 3229 0a0a 2020 2020   angle_i2)..    
+00028270: 2020 2020 7265 7475 726e 205b 766f 6c6d      return [volm
+00028280: 646c 722e 6564 6765 732e 4172 6332 4428  dlr.edges.Arc2D(
+00028290: 7370 6c69 745f 7374 6172 742c 2069 6e74  split_start, int
+000282a0: 6572 696f 725f 706f 696e 7431 2c0a 2020  erior_point1,.  
+000282b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000282c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000282d0: 2020 2020 2020 2020 7370 6c69 745f 656e          split_en
-000282e0: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
-000282f0: 2020 2020 766f 6c6d 646c 722e 6564 6765      volmdlr.edge
-00028300: 732e 4172 6332 4428 7370 6c69 745f 7374  s.Arc2D(split_st
-00028310: 6172 742c 2069 6e74 6572 696f 725f 706f  art, interior_po
-00028320: 696e 7432 2c0a 2020 2020 2020 2020 2020  int2,.          
+000282d0: 2020 7370 6c69 745f 656e 6429 2c0a 2020    split_end),.  
+000282e0: 2020 2020 2020 2020 2020 2020 2020 766f                vo
+000282f0: 6c6d 646c 722e 6564 6765 732e 4172 6332  lmdlr.edges.Arc2
+00028300: 4428 7370 6c69 745f 7374 6172 742c 2069  D(split_start, i
+00028310: 6e74 6572 696f 725f 706f 696e 7432 2c0a  nterior_point2,.
+00028320: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00028330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028340: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
-00028350: 656e 6429 5d0a 0a20 2020 2064 6566 2061  end)]..    def a
-00028360: 7869 616c 5f73 796d 6d65 7472 7928 7365  xial_symmetry(se
-00028370: 6c66 2c20 6c69 6e65 293a 0a20 2020 2020  lf, line):.     
-00028380: 2020 2022 2222 0a20 2020 2020 2020 2046     """.        F
-00028390: 696e 6473 206f 7574 2074 6865 2073 796d  inds out the sym
-000283a0: 6d65 7472 6963 2063 6972 636c 6532 6420  metric circle2d 
-000283b0: 6163 636f 7264 696e 6720 746f 2061 206c  according to a l
-000283c0: 696e 652e 0a20 2020 2020 2020 2022 2222  ine..        """
-000283d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000283e0: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2863  self.__class__(c
-000283f0: 656e 7465 723d 7365 6c66 2e63 656e 7465  enter=self.cente
-00028400: 722e 6178 6961 6c5f 7379 6d6d 6574 7279  r.axial_symmetry
-00028410: 286c 696e 6529 2c0a 2020 2020 2020 2020  (line),.        
+00028340: 2020 2020 7370 6c69 745f 656e 6429 5d0a      split_end)].
+00028350: 0a20 2020 2064 6566 2061 7869 616c 5f73  .    def axial_s
+00028360: 796d 6d65 7472 7928 7365 6c66 2c20 6c69  ymmetry(self, li
+00028370: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
+00028380: 0a20 2020 2020 2020 2046 696e 6473 206f  .        Finds o
+00028390: 7574 2074 6865 2073 796d 6d65 7472 6963  ut the symmetric
+000283a0: 2063 6972 636c 6532 6420 6163 636f 7264   circle2d accord
+000283b0: 696e 6720 746f 2061 206c 696e 652e 0a20  ing to a line.. 
+000283c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000283d0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+000283e0: 5f63 6c61 7373 5f5f 2863 656e 7465 723d  _class__(center=
+000283f0: 7365 6c66 2e63 656e 7465 722e 6178 6961  self.center.axia
+00028400: 6c5f 7379 6d6d 6574 7279 286c 696e 6529  l_symmetry(line)
+00028410: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 00028420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028430: 2020 2020 2020 7261 6469 7573 3d73 656c        radius=sel
-00028440: 662e 7261 6469 7573 290a 0a20 2020 2064  f.radius)..    d
-00028450: 6566 2064 6973 6372 6574 697a 6174 696f  ef discretizatio
-00028460: 6e5f 706f 696e 7473 2873 656c 662c 202a  n_points(self, *
-00028470: 2c20 6e75 6d62 6572 5f70 6f69 6e74 733a  , number_points:
-00028480: 2069 6e74 203d 204e 6f6e 652c 2061 6e67   int = None, ang
-00028490: 6c65 5f72 6573 6f6c 7574 696f 6e3a 2069  le_resolution: i
-000284a0: 6e74 203d 2034 3029 3a0a 2020 2020 2020  nt = 40):.      
-000284b0: 2020 2222 220a 2020 2020 2020 2020 4469    """.        Di
-000284c0: 7363 7265 7469 7a65 2061 2043 6f6e 746f  scretize a Conto
-000284d0: 7572 2074 6f20 6861 7665 2022 6e22 2070  ur to have "n" p
-000284e0: 6f69 6e74 732e 0a0a 2020 2020 2020 2020  oints...        
-000284f0: 3a70 6172 616d 206e 756d 6265 725f 706f  :param number_po
-00028500: 696e 7473 3a20 7468 6520 6e75 6d62 6572  ints: the number
-00028510: 206f 6620 706f 696e 7473 2028 696e 636c   of points (incl
-00028520: 7564 696e 6720 7374 6172 7420 616e 6420  uding start and 
-00028530: 656e 6420 706f 696e 7473 290a 2020 2020  end points).    
-00028540: 2020 2020 2020 2020 2069 6620 756e 7365           if unse
-00028550: 742c 206f 6e6c 7920 7374 6172 7420 616e  t, only start an
-00028560: 6420 656e 6420 7769 6c6c 2062 6520 7265  d end will be re
-00028570: 7475 726e 6564 0a20 2020 2020 2020 203a  turned.        :
-00028580: 7061 7261 6d20 616e 676c 655f 7265 736f  param angle_reso
-00028590: 6c75 7469 6f6e 3a20 6966 2073 6574 2c20  lution: if set, 
-000285a0: 7468 6520 7361 6d70 6c69 6e67 2077 696c  the sampling wil
-000285b0: 6c20 6265 2061 6461 7074 6564 2074 6f20  l be adapted to 
-000285c0: 6861 7665 2061 2063 6f6e 7472 6f6c 6c65  have a controlle
-000285d0: 6420 616e 6775 6c61 7220 6469 7374 616e  d angular distan
-000285e0: 6365 2e20 5573 6566 756c 0a20 2020 2020  ce. Useful.     
-000285f0: 2020 2020 2020 2074 6f20 6d65 7368 2061         to mesh a
-00028600: 6e20 6172 630a 2020 2020 2020 2020 3a72  n arc.        :r
-00028610: 6574 7572 6e3a 2061 206c 6973 7420 6f66  eturn: a list of
-00028620: 2073 616d 706c 6564 2070 6f69 6e74 730a   sampled points.
-00028630: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00028640: 2020 2020 6966 206e 6f74 206e 756d 6265      if not numbe
-00028650: 725f 706f 696e 7473 2061 6e64 2061 6e67  r_points and ang
-00028660: 6c65 5f72 6573 6f6c 7574 696f 6e3a 0a20  le_resolution:. 
-00028670: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-00028680: 725f 706f 696e 7473 203d 206d 6174 682e  r_points = math.
-00028690: 6365 696c 286d 6174 682e 7069 202a 2061  ceil(math.pi * a
-000286a0: 6e67 6c65 5f72 6573 6f6c 7574 696f 6e29  ngle_resolution)
-000286b0: 202b 2032 0a20 2020 2020 2020 2073 7465   + 2.        ste
-000286c0: 7020 3d20 7365 6c66 2e6c 656e 6774 6828  p = self.length(
-000286d0: 2920 2f20 286e 756d 6265 725f 706f 696e  ) / (number_poin
-000286e0: 7473 202d 2031 290a 2020 2020 2020 2020  ts - 1).        
-000286f0: 7265 7475 726e 205b 7365 6c66 2e70 6f69  return [self.poi
-00028700: 6e74 5f61 745f 6162 7363 6973 7361 2869  nt_at_abscissa(i
-00028710: 202a 2073 7465 7029 2066 6f72 2069 2069   * step) for i i
-00028720: 6e20 7261 6e67 6528 6e75 6d62 6572 5f70  n range(number_p
-00028730: 6f69 6e74 7329 5d0a 0a20 2020 2064 6566  oints)]..    def
-00028740: 2070 6f6c 7967 6f6e 5f70 6f69 6e74 7328   polygon_points(
-00028750: 7365 6c66 2c20 6469 7363 7265 7469 7a61  self, discretiza
-00028760: 7469 6f6e 5f72 6573 6f6c 7574 696f 6e3a  tion_resolution:
-00028770: 2069 6e74 293a 0a20 2020 2020 2020 2077   int):.        w
-00028780: 6172 6e69 6e67 732e 7761 726e 2827 706f  arnings.warn('po
-00028790: 6c79 676f 6e5f 706f 696e 7473 2069 7320  lygon_points is 
-000287a0: 6465 7072 6563 6174 6564 2c5c 0a20 2020  deprecated,\.   
-000287b0: 2020 2020 2070 6c65 6173 6520 7573 6520       please use 
-000287c0: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
-000287d0: 6f69 6e74 7320 696e 7374 6561 6427 2c0a  oints instead',.
+00028430: 7261 6469 7573 3d73 656c 662e 7261 6469  radius=self.radi
+00028440: 7573 290a 0a20 2020 2064 6566 2064 6973  us)..    def dis
+00028450: 6372 6574 697a 6174 696f 6e5f 706f 696e  cretization_poin
+00028460: 7473 2873 656c 662c 202a 2c20 6e75 6d62  ts(self, *, numb
+00028470: 6572 5f70 6f69 6e74 733a 2069 6e74 203d  er_points: int =
+00028480: 204e 6f6e 652c 2061 6e67 6c65 5f72 6573   None, angle_res
+00028490: 6f6c 7574 696f 6e3a 2069 6e74 203d 2034  olution: int = 4
+000284a0: 3029 3a0a 2020 2020 2020 2020 2222 220a  0):.        """.
+000284b0: 2020 2020 2020 2020 4469 7363 7265 7469          Discreti
+000284c0: 7a65 2061 2043 6f6e 746f 7572 2074 6f20  ze a Contour to 
+000284d0: 6861 7665 2022 6e22 2070 6f69 6e74 732e  have "n" points.
+000284e0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000284f0: 206e 756d 6265 725f 706f 696e 7473 3a20   number_points: 
+00028500: 7468 6520 6e75 6d62 6572 206f 6620 706f  the number of po
+00028510: 696e 7473 2028 696e 636c 7564 696e 6720  ints (including 
+00028520: 7374 6172 7420 616e 6420 656e 6420 706f  start and end po
+00028530: 696e 7473 290a 2020 2020 2020 2020 2020  ints).          
+00028540: 2020 2069 6620 756e 7365 742c 206f 6e6c     if unset, onl
+00028550: 7920 7374 6172 7420 616e 6420 656e 6420  y start and end 
+00028560: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
+00028570: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00028580: 616e 676c 655f 7265 736f 6c75 7469 6f6e  angle_resolution
+00028590: 3a20 6966 2073 6574 2c20 7468 6520 7361  : if set, the sa
+000285a0: 6d70 6c69 6e67 2077 696c 6c20 6265 2061  mpling will be a
+000285b0: 6461 7074 6564 2074 6f20 6861 7665 2061  dapted to have a
+000285c0: 2063 6f6e 7472 6f6c 6c65 6420 616e 6775   controlled angu
+000285d0: 6c61 7220 6469 7374 616e 6365 2e20 5573  lar distance. Us
+000285e0: 6566 756c 0a20 2020 2020 2020 2020 2020  eful.           
+000285f0: 2074 6f20 6d65 7368 2061 6e20 6172 630a   to mesh an arc.
+00028600: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+00028610: 2061 206c 6973 7420 6f66 2073 616d 706c   a list of sampl
+00028620: 6564 2070 6f69 6e74 730a 2020 2020 2020  ed points.      
+00028630: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+00028640: 206e 6f74 206e 756d 6265 725f 706f 696e   not number_poin
+00028650: 7473 2061 6e64 2061 6e67 6c65 5f72 6573  ts and angle_res
+00028660: 6f6c 7574 696f 6e3a 0a20 2020 2020 2020  olution:.       
+00028670: 2020 2020 206e 756d 6265 725f 706f 696e       number_poin
+00028680: 7473 203d 206d 6174 682e 6365 696c 286d  ts = math.ceil(m
+00028690: 6174 682e 7069 202a 2061 6e67 6c65 5f72  ath.pi * angle_r
+000286a0: 6573 6f6c 7574 696f 6e29 202b 2032 0a20  esolution) + 2. 
+000286b0: 2020 2020 2020 2073 7465 7020 3d20 7365         step = se
+000286c0: 6c66 2e6c 656e 6774 6828 2920 2f20 286e  lf.length() / (n
+000286d0: 756d 6265 725f 706f 696e 7473 202d 2031  umber_points - 1
+000286e0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000286f0: 205b 7365 6c66 2e70 6f69 6e74 5f61 745f   [self.point_at_
+00028700: 6162 7363 6973 7361 2869 202a 2073 7465  abscissa(i * ste
+00028710: 7029 2066 6f72 2069 2069 6e20 7261 6e67  p) for i in rang
+00028720: 6528 6e75 6d62 6572 5f70 6f69 6e74 7329  e(number_points)
+00028730: 5d0a 0a20 2020 2064 6566 2070 6f6c 7967  ]..    def polyg
+00028740: 6f6e 5f70 6f69 6e74 7328 7365 6c66 2c20  on_points(self, 
+00028750: 6469 7363 7265 7469 7a61 7469 6f6e 5f72  discretization_r
+00028760: 6573 6f6c 7574 696f 6e3a 2069 6e74 293a  esolution: int):
+00028770: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
+00028780: 732e 7761 726e 2827 706f 6c79 676f 6e5f  s.warn('polygon_
+00028790: 706f 696e 7473 2069 7320 6465 7072 6563  points is deprec
+000287a0: 6174 6564 2c5c 0a20 2020 2020 2020 2070  ated,\.        p
+000287b0: 6c65 6173 6520 7573 6520 6469 7363 7265  lease use discre
+000287c0: 7469 7a61 7469 6f6e 5f70 6f69 6e74 7320  tization_points 
+000287d0: 696e 7374 6561 6427 2c0a 2020 2020 2020  instead',.      
 000287e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000287f0: 2020 2020 2020 4465 7072 6563 6174 696f        Deprecatio
-00028800: 6e57 6172 6e69 6e67 290a 2020 2020 2020  nWarning).      
-00028810: 2020 7265 7475 726e 2073 656c 662e 6469    return self.di
-00028820: 7363 7265 7469 7a61 7469 6f6e 5f70 6f69  scretization_poi
-00028830: 6e74 7328 616e 676c 655f 7265 736f 6c75  nts(angle_resolu
-00028840: 7469 6f6e 3d64 6973 6372 6574 697a 6174  tion=discretizat
-00028850: 696f 6e5f 7265 736f 6c75 7469 6f6e 290a  ion_resolution).
-00028860: 0a20 2020 2064 6566 2067 6574 5f67 656f  .    def get_geo
-00028870: 5f70 6f69 6e74 7328 7365 6c66 293a 0a20  _points(self):. 
-00028880: 2020 2020 2020 2072 6574 7572 6e20 5b76         return [v
-00028890: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 2873  olmdlr.Point3D(s
-000288a0: 656c 662e 7261 6469 7573 2c20 7365 6c66  elf.radius, self
-000288b0: 2e63 656e 7465 722e 792c 2030 292c 0a20  .center.y, 0),. 
-000288c0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000288d0: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 2873  olmdlr.Point3D(s
-000288e0: 656c 662e 6365 6e74 6572 2e78 2c20 7365  elf.center.x, se
-000288f0: 6c66 2e63 656e 7465 722e 792c 2030 292c  lf.center.y, 0),
-00028900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028910: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3344   volmdlr.Point3D
-00028920: 282d 7365 6c66 2e72 6164 6975 732c 2073  (-self.radius, s
-00028930: 656c 662e 6365 6e74 6572 2e79 2c20 3029  elf.center.y, 0)
-00028940: 5d0a 0a0a 636c 6173 7320 456c 6c69 7073  ]...class Ellips
-00028950: 6532 4428 436f 6e74 6f75 7232 4429 3a0a  e2D(Contour2D):.
-00028960: 2020 2020 2222 220a 2020 2020 4465 6669      """.    Defi
-00028970: 6e65 7320 616e 2045 6c6c 6970 7365 2069  nes an Ellipse i
-00028980: 6e20 7477 6f2d 6469 6d65 6e73 696f 6e73  n two-dimensions
-00028990: 2e0a 0a20 2020 2045 6c6c 6970 7365 3244  ...    Ellipse2D
-000289a0: 2064 6566 696e 6564 2062 7920 6120 6d61   defined by a ma
-000289b0: 6a6f 7220 6178 6973 2028 4129 2c20 6d69  jor axis (A), mi
-000289c0: 6e6f 7220 6178 6973 2028 4229 2c20 6120  nor axis (B), a 
-000289d0: 6365 6e74 6572 2061 6e64 2061 2076 6563  center and a vec
-000289e0: 746f 720a 2020 2020 7265 7072 6573 656e  tor.    represen
-000289f0: 7469 6e67 2074 6865 2064 6972 6563 7469  ting the directi
-00028a00: 6f6e 206f 6620 7468 6520 6d61 6a6f 7220  on of the major 
-00028a10: 6178 6973 2e0a 0a20 2020 203a 7061 7261  axis...    :para
-00028a20: 6d20 6d61 6a6f 725f 6178 6973 3a20 656c  m major_axis: el
-00028a30: 6c69 7073 6527 7320 6d61 6a6f 7220 6178  lipse's major ax
-00028a40: 6973 2028 4129 0a20 2020 203a 7479 7065  is (A).    :type
-00028a50: 206d 616a 6f72 5f61 7869 733a 2066 6c6f   major_axis: flo
-00028a60: 6174 0a20 2020 203a 7061 7261 6d20 6d69  at.    :param mi
-00028a70: 6e6f 725f 6178 6973 3a20 656c 6c69 7073  nor_axis: ellips
-00028a80: 6527 7320 6d69 6e6f 7220 6178 6973 2028  e's minor axis (
-00028a90: 4229 0a20 2020 203a 7479 7065 206d 696e  B).    :type min
-00028aa0: 6f72 5f61 7869 733a 2066 6c6f 6174 0a20  or_axis: float. 
-00028ab0: 2020 203a 7061 7261 6d20 6365 6e74 6572     :param center
-00028ac0: 3a20 656c 6c69 7073 6527 7320 6365 6e74  : ellipse's cent
-00028ad0: 6572 0a20 2020 203a 7479 7065 2063 656e  er.    :type cen
-00028ae0: 7465 723a 2076 6f6c 6d64 6c72 2e50 6f69  ter: volmdlr.Poi
-00028af0: 6e74 3344 0a20 2020 203a 7061 7261 6d20  nt3D.    :param 
-00028b00: 6d61 6a6f 725f 6469 723a 2064 6972 6563  major_dir: direc
-00028b10: 7469 6f6e 2076 6563 746f 7220 666f 7220  tion vector for 
-00028b20: 6d61 6a6f 7220 6178 6973 0a20 2020 203a  major axis.    :
-00028b30: 7479 7065 206d 616a 6f72 5f64 6972 3a20  type major_dir: 
-00028b40: 766f 6c6d 646c 722e 5665 6374 6f72 3344  volmdlr.Vector3D
-00028b50: 0a0a 2020 2020 3a45 7861 6d70 6c65 3a0a  ..    :Example:.
-00028b60: 2020 2020 3e3e 3e20 656c 6c69 7073 6532      >>> ellipse2
-00028b70: 6420 3d20 7769 7265 732e 456c 6c69 7073  d = wires.Ellips
-00028b80: 6532 4428 342c 2032 2c20 766f 6c6d 646c  e2D(4, 2, volmdl
-00028b90: 722e 4f32 442c 2076 6f6c 6d64 6c72 2e56  r.O2D, volmdlr.V
-00028ba0: 6563 746f 7232 4428 312c 2031 2929 0a20  ector2D(1, 1)). 
-00028bb0: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
-00028bc0: 5f5f 696e 6974 5f5f 2873 656c 662c 206d  __init__(self, m
-00028bd0: 616a 6f72 5f61 7869 732c 206d 696e 6f72  ajor_axis, minor
-00028be0: 5f61 7869 732c 2063 656e 7465 722c 206d  _axis, center, m
-00028bf0: 616a 6f72 5f64 6972 2c20 6e61 6d65 3d27  ajor_dir, name='
-00028c00: 2729 3a0a 2020 2020 2020 2020 7365 6c66  '):.        self
-00028c10: 2e6d 616a 6f72 5f61 7869 7320 3d20 6d61  .major_axis = ma
-00028c20: 6a6f 725f 6178 6973 0a20 2020 2020 2020  jor_axis.       
-00028c30: 2073 656c 662e 6d69 6e6f 725f 6178 6973   self.minor_axis
-00028c40: 203d 206d 696e 6f72 5f61 7869 730a 2020   = minor_axis.  
-00028c50: 2020 2020 2020 7365 6c66 2e63 656e 7465        self.cente
-00028c60: 7220 3d20 6365 6e74 6572 0a20 2020 2020  r = center.     
-00028c70: 2020 2073 656c 662e 6d61 6a6f 725f 6469     self.major_di
-00028c80: 7220 3d20 6d61 6a6f 725f 6469 720a 2020  r = major_dir.  
-00028c90: 2020 2020 2020 7365 6c66 2e6d 616a 6f72        self.major
-00028ca0: 5f64 6972 2e6e 6f72 6d61 6c69 7a65 2829  _dir.normalize()
-00028cb0: 0a20 2020 2020 2020 2073 656c 662e 6d69  .        self.mi
-00028cc0: 6e6f 725f 6469 7220 3d20 2d20 7365 6c66  nor_dir = - self
-00028cd0: 2e6d 616a 6f72 5f64 6972 2e6e 6f72 6d61  .major_dir.norma
-00028ce0: 6c5f 7665 6374 6f72 2829 0a20 2020 2020  l_vector().     
-00028cf0: 2020 2073 656c 662e 7468 6574 6120 3d20     self.theta = 
-00028d00: 766f 6c6d 646c 722e 6765 6f6d 6574 7279  volmdlr.geometry
-00028d10: 2e63 6c6f 636b 7769 7365 5f61 6e67 6c65  .clockwise_angle
-00028d20: 2873 656c 662e 6d61 6a6f 725f 6469 722c  (self.major_dir,
-00028d30: 2076 6f6c 6d64 6c72 2e58 3244 290a 2020   volmdlr.X2D).  
-00028d40: 2020 2020 2020 6966 2073 656c 662e 7468        if self.th
-00028d50: 6574 6120 3d3d 206d 6174 682e 7069 202a  eta == math.pi *
-00028d60: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-00028d70: 7365 6c66 2e74 6865 7461 203d 2030 2e30  self.theta = 0.0
-00028d80: 0a20 2020 2020 2020 2043 6f6e 746f 7572  .        Contour
-00028d90: 3244 2e5f 5f69 6e69 745f 5f28 7365 6c66  2D.__init__(self
-00028da0: 2c20 5b73 656c 665d 2c20 6e61 6d65 3d6e  , [self], name=n
-00028db0: 616d 6529 0a0a 2020 2020 6465 6620 5f5f  ame)..    def __
-00028dc0: 6861 7368 5f5f 2873 656c 6629 3a0a 2020  hash__(self):.  
-00028dd0: 2020 2020 2020 7265 7475 726e 2069 6e74        return int
-00028de0: 2872 6f75 6e64 2831 6536 202a 2028 7365  (round(1e6 * (se
-00028df0: 6c66 2e63 656e 7465 722e 7820 2b20 7365  lf.center.x + se
-00028e00: 6c66 2e63 656e 7465 722e 7920 2b20 7365  lf.center.y + se
-00028e10: 6c66 2e6d 616a 6f72 5f61 7869 7320 2b20  lf.major_axis + 
-00028e20: 7365 6c66 2e6d 696e 6f72 5f61 7869 7329  self.minor_axis)
-00028e30: 2929 0a0a 2020 2020 6465 6620 6172 6561  ))..    def area
-00028e40: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00028e50: 2222 220a 2020 2020 2020 2020 4361 6c63  """.        Calc
-00028e60: 756c 6174 6573 2074 6865 2065 6c6c 6970  ulates the ellip
-00028e70: 6527 7320 6172 6561 2e0a 0a20 2020 2020  e's area...     
-00028e80: 2020 203a 7265 7475 726e 3a20 656c 6c69     :return: elli
-00028e90: 7065 2773 2061 7265 612c 2066 6c6f 6174  pe's area, float
-00028ea0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00028eb0: 2020 2020 2020 7265 7475 726e 206d 6174        return mat
-00028ec0: 682e 7069 202a 2073 656c 662e 6d61 6a6f  h.pi * self.majo
-00028ed0: 725f 6178 6973 202a 2073 656c 662e 6d69  r_axis * self.mi
-00028ee0: 6e6f 725f 6178 6973 0a0a 2020 2020 6465  nor_axis..    de
-00028ef0: 6620 6c65 6e67 7468 2873 656c 6629 3a0a  f length(self):.
-00028f00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00028f10: 2020 2020 4361 6c63 756c 6174 6573 2074      Calculates t
-00028f20: 6865 2065 6c6c 6970 7365 2773 206c 656e  he ellipse's len
-00028f30: 6774 682e 0a0a 2020 2020 2020 2020 3a72  gth...        :r
-00028f40: 6574 7572 6e3a 2065 6c6c 6970 6527 7320  eturn: ellipe's 
-00028f50: 6c65 6e67 7468 2e0a 2020 2020 2020 2020  length..        
-00028f60: 2222 220a 2020 2020 2020 2020 6d69 645f  """.        mid_
-00028f70: 706f 696e 7420 3d20 7365 6c66 2e63 656e  point = self.cen
-00028f80: 7465 7220 2d20 7365 6c66 2e6d 616a 6f72  ter - self.major
-00028f90: 5f61 7869 7320 2a20 7365 6c66 2e6d 616a  _axis * self.maj
-00028fa0: 6f72 5f64 6972 0a20 2020 2020 2020 2069  or_dir.        i
-00028fb0: 6620 7365 6c66 2e74 6865 7461 2021 3d20  f self.theta != 
-00028fc0: 302e 303a 0a20 2020 2020 2020 2020 2020  0.0:.           
-00028fd0: 206d 6964 5f70 6f69 6e74 203d 2073 656c   mid_point = sel
-00028fe0: 662e 6365 6e74 6572 202d 2076 6f6c 6d64  f.center - volmd
-00028ff0: 6c72 2e50 6f69 6e74 3244 2873 656c 662e  lr.Point2D(self.
-00029000: 6d61 6a6f 725f 6178 6973 2c20 3029 0a20  major_axis, 0). 
-00029010: 2020 2020 2020 2020 2020 206d 6964 5f70             mid_p
-00029020: 6f69 6e74 203d 206d 6964 5f70 6f69 6e74  oint = mid_point
-00029030: 2e72 6f74 6174 696f 6e28 7365 6c66 2e63  .rotation(self.c
-00029040: 656e 7465 722c 2073 656c 662e 7468 6574  enter, self.thet
-00029050: 6129 0a20 2020 2020 2020 206c 656e 6774  a).        lengt
-00029060: 6820 3d20 3220 2a20 7365 6c66 2e61 6273  h = 2 * self.abs
-00029070: 6369 7373 6128 6d69 645f 706f 696e 7429  cissa(mid_point)
-00029080: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00029090: 6c65 6e67 7468 0a0a 2020 2020 6465 6620  length..    def 
-000290a0: 746f 5f33 6428 7365 6c66 2c20 706c 616e  to_3d(self, plan
-000290b0: 655f 6f72 6967 696e 2c20 782c 2079 293a  e_origin, x, y):
-000290c0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000290d0: 2020 2020 2054 7261 6e73 666f 726d 7320       Transforms 
-000290e0: 6120 456c 6c69 7073 6532 4420 696e 746f  a Ellipse2D into
-000290f0: 2061 6e20 456c 6c69 7073 6533 442c 2067   an Ellipse3D, g
-00029100: 6976 656e 2061 2070 6c61 6e65 206f 7269  iven a plane ori
-00029110: 6769 6e20 616e 6420 616e 2075 2061 6e64  gin and an u and
-00029120: 2076 2070 6c61 6e65 2076 6563 746f 722e   v plane vector.
-00029130: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00029140: 2070 6c61 6e65 5f6f 7269 6769 6e3a 2070   plane_origin: p
-00029150: 6c61 6e65 206f 7269 6769 6e2e 0a20 2020  lane origin..   
-00029160: 2020 2020 203a 7061 7261 6d20 783a 2070       :param x: p
-00029170: 6c61 6e65 2075 2076 6563 746f 722e 0a20  lane u vector.. 
-00029180: 2020 2020 2020 203a 7061 7261 6d20 793a         :param y:
-00029190: 2070 6c61 6e65 2076 2076 6563 746f 722e   plane v vector.
-000291a0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-000291b0: 3a20 456c 6c69 7073 6533 442e 0a20 2020  : Ellipse3D..   
-000291c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000291d0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-000291e0: 656e 7465 6445 7272 6f72 0a0a 2020 2020  entedError..    
-000291f0: 6465 6620 706f 696e 745f 6f76 6572 5f65  def point_over_e
-00029200: 6c6c 6970 7365 2873 656c 662c 2070 6f69  llipse(self, poi
-00029210: 6e74 2c20 6162 735f 746f 6c3d 3165 2d36  nt, abs_tol=1e-6
-00029220: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00029230: 2020 2020 2020 2056 6572 6966 6965 7320         Verifies 
-00029240: 6966 2061 2070 6f69 6e74 2069 7320 6f6e  if a point is on
-00029250: 2074 6865 2065 6c6c 6970 7365 2e0a 0a20   the ellipse... 
-00029260: 2020 2020 2020 203a 7061 7261 6d20 706f         :param po
-00029270: 696e 743a 2070 6f69 6e74 2074 6f20 6265  int: point to be
-00029280: 2076 6572 6966 6965 642e 0a20 2020 2020   verified..     
-00029290: 2020 2020 3a70 6172 616d 2061 6273 5f74      :param abs_t
-000292a0: 6f6c 3a20 746f 6c65 7261 6e63 652e 0a20  ol: tolerance.. 
-000292b0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-000292c0: 5472 7565 206f 7220 4661 6c73 652e 0a20  True or False.. 
-000292d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000292e0: 2020 2072 6574 7572 6e20 6d61 7468 2e69     return math.i
-000292f0: 7363 6c6f 7365 280a 2020 2020 2020 2020  sclose(.        
-00029300: 2020 2020 2828 706f 696e 742e 7820 2d20      ((point.x - 
-00029310: 7365 6c66 2e63 656e 7465 722e 7829 202a  self.center.x) *
-00029320: 206d 6174 682e 636f 7328 7365 6c66 2e74   math.cos(self.t
-00029330: 6865 7461 2920 2b0a 2020 2020 2020 2020  heta) +.        
-00029340: 2020 2020 2028 706f 696e 742e 7920 2d20       (point.y - 
-00029350: 7365 6c66 2e63 656e 7465 722e 7929 202a  self.center.y) *
-00029360: 206d 6174 682e 7369 6e28 7365 6c66 2e74   math.sin(self.t
-00029370: 6865 7461 2929 202a 2a20 3220 2f20 7365  heta)) ** 2 / se
-00029380: 6c66 2e6d 616a 6f72 5f61 7869 7320 2a2a  lf.major_axis **
-00029390: 2032 202b 0a20 2020 2020 2020 2020 2020   2 +.           
-000293a0: 2028 2870 6f69 6e74 2e78 202d 2073 656c   ((point.x - sel
-000293b0: 662e 6365 6e74 6572 2e78 2920 2a20 6d61  f.center.x) * ma
-000293c0: 7468 2e73 696e 2873 656c 662e 7468 6574  th.sin(self.thet
-000293d0: 6129 202d 0a20 2020 2020 2020 2020 2020  a) -.           
-000293e0: 2020 2870 6f69 6e74 2e79 202d 2073 656c    (point.y - sel
-000293f0: 662e 6365 6e74 6572 2e79 2920 2a20 6d61  f.center.y) * ma
-00029400: 7468 2e63 6f73 2873 656c 662e 7468 6574  th.cos(self.thet
-00029410: 6129 2920 2a2a 2032 202f 2073 656c 662e  a)) ** 2 / self.
-00029420: 6d69 6e6f 725f 6178 6973 202a 2a20 322c  minor_axis ** 2,
-00029430: 2031 2c20 6162 735f 746f 6c3d 6162 735f   1, abs_tol=abs_
-00029440: 746f 6c29 0a0a 2020 2020 6465 6620 706f  tol)..    def po
-00029450: 696e 745f 6f76 6572 5f63 6f6e 746f 7572  int_over_contour
-00029460: 2873 656c 662c 2070 6f69 6e74 2c20 6162  (self, point, ab
-00029470: 735f 746f 6c3d 3165 2d36 293a 0a20 2020  s_tol=1e-6):.   
-00029480: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00029490: 2056 6572 6966 6965 7320 6966 2061 2070   Verifies if a p
-000294a0: 6f69 6e74 2069 7320 6f6e 2074 6865 2065  oint is on the e
-000294b0: 6c6c 6970 7365 2e0a 0a20 2020 2020 2020  llipse...       
-000294c0: 203a 7061 7261 6d20 706f 696e 743a 2070   :param point: p
-000294d0: 6f69 6e74 2074 6f20 6265 2076 6572 6966  oint to be verif
-000294e0: 6965 642e 0a20 2020 2020 2020 203a 7061  ied..        :pa
-000294f0: 7261 6d20 6162 735f 746f 6c3a 2074 6f6c  ram abs_tol: tol
-00029500: 6572 616e 6365 2e0a 2020 2020 2020 2020  erance..        
-00029510: 3a72 6574 7572 6e3a 2054 7275 6520 6f72  :return: True or
-00029520: 2046 616c 7365 2e0a 2020 2020 2020 2020   False..        
-00029530: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00029540: 726e 2073 656c 662e 706f 696e 745f 6f76  rn self.point_ov
-00029550: 6572 5f65 6c6c 6970 7365 2870 6f69 6e74  er_ellipse(point
-00029560: 2c20 6162 735f 746f 6c29 0a0a 2020 2020  , abs_tol)..    
-00029570: 6465 6620 6c69 6e65 5f69 6e74 6572 7365  def line_interse
-00029580: 6374 696f 6e73 2873 656c 662c 206c 696e  ctions(self, lin
-00029590: 653a 2027 766f 6c6d 646c 722e 6564 6765  e: 'volmdlr.edge
-000295a0: 732e 4c69 6e65 3244 2729 3a0a 2020 2020  s.Line2D'):.    
-000295b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000295c0: 4361 6c63 756c 6174 6573 2074 6865 2069  Calculates the i
-000295d0: 6e74 6572 7365 6374 696f 6e73 2062 6574  ntersections bet
-000295e0: 7765 656e 2061 206c 696e 6520 616e 6420  ween a line and 
-000295f0: 616e 2065 6c6c 6970 7365 2e0a 0a20 2020  an ellipse...   
-00029600: 2020 2020 203a 7061 7261 6d20 6c69 6e65       :param line
-00029610: 3a20 6c69 6e65 2074 6f20 6361 6c63 756c  : line to calcul
-00029620: 6174 6520 696e 7465 7273 6563 7469 6f6e  ate intersection
-00029630: 730a 2020 2020 2020 2020 3a72 6574 7572  s.        :retur
-00029640: 6e3a 206c 6973 7420 6f66 2070 6f69 6e74  n: list of point
-00029650: 7320 696e 7465 7273 6563 7469 6f6e 732c  s intersections,
-00029660: 2069 6620 7468 6572 6520 6172 6520 616e   if there are an
-00029670: 790a 2020 2020 2020 2020 2222 220a 2020  y.        """.  
-00029680: 2020 2020 2020 696e 7465 7273 6563 7469        intersecti
-00029690: 6f6e 7320 3d20 766d 5f75 7469 6c73 5f69  ons = vm_utils_i
-000296a0: 6e74 6572 7365 6374 696f 6e73 2e65 6c6c  ntersections.ell
-000296b0: 6970 7365 3264 5f6c 696e 655f 696e 7465  ipse2d_line_inte
-000296c0: 7273 6563 7469 6f6e 7328 7365 6c66 2c20  rsections(self, 
-000296d0: 6c69 6e65 290a 2020 2020 2020 2020 7265  line).        re
-000296e0: 7475 726e 2069 6e74 6572 7365 6374 696f  turn intersectio
-000296f0: 6e73 0a0a 2020 2020 6465 6620 6c69 6e65  ns..    def line
-00029700: 7365 676d 656e 745f 696e 7465 7273 6563  segment_intersec
-00029710: 7469 6f6e 7328 7365 6c66 2c20 6c69 6e65  tions(self, line
-00029720: 7365 676d 656e 743a 2027 766f 6c6d 646c  segment: 'volmdl
-00029730: 722e 6564 6765 732e 4c69 6e65 5365 676d  r.edges.LineSegm
-00029740: 656e 7432 4427 293a 0a20 2020 2020 2020  ent2D'):.       
-00029750: 2022 2222 0a20 2020 2020 2020 2043 616c   """.        Cal
-00029760: 6375 6c61 7465 7320 7468 6520 696e 7465  culates the inte
-00029770: 7273 6563 7469 6f6e 7320 6265 7477 6565  rsections betwee
-00029780: 6e20 6120 6c69 6e65 7365 676d 656e 7420  n a linesegment 
-00029790: 616e 6420 616e 2065 6c6c 6970 7365 2e0a  and an ellipse..
-000297a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000297b0: 6c69 6e65 7365 676d 656e 743a 206c 696e  linesegment: lin
-000297c0: 6573 6567 6d65 6e74 2074 6f20 6361 6c63  esegment to calc
-000297d0: 756c 6174 6520 696e 7465 7273 6563 7469  ulate intersecti
-000297e0: 6f6e 732e 0a20 2020 2020 2020 203a 7265  ons..        :re
-000297f0: 7475 726e 3a20 6c69 7374 206f 6620 706f  turn: list of po
-00029800: 696e 7473 2069 6e74 6572 7365 6374 696f  ints intersectio
-00029810: 6e73 2c20 6966 2074 6865 7265 2061 7265  ns, if there are
-00029820: 2061 6e79 2e0a 2020 2020 2020 2020 2222   any..        ""
-00029830: 220a 2020 2020 2020 2020 6c69 6e65 5f69  ".        line_i
-00029840: 6e74 6572 7365 6374 696f 6e73 203d 2073  ntersections = s
-00029850: 656c 662e 6c69 6e65 5f69 6e74 6572 7365  elf.line_interse
-00029860: 6374 696f 6e73 286c 696e 6573 6567 6d65  ctions(linesegme
-00029870: 6e74 2e74 6f5f 6c69 6e65 2829 290a 2020  nt.to_line()).  
-00029880: 2020 2020 2020 696e 7465 7273 6563 7469        intersecti
-00029890: 6f6e 7320 3d20 5b5d 0a20 2020 2020 2020  ons = [].       
-000298a0: 2066 6f72 2069 6e74 6572 7365 6374 696f   for intersectio
-000298b0: 6e20 696e 206c 696e 655f 696e 7465 7273  n in line_inters
-000298c0: 6563 7469 6f6e 733a 0a20 2020 2020 2020  ections:.       
-000298d0: 2020 2020 2069 6620 6c69 6e65 7365 676d       if linesegm
-000298e0: 656e 742e 706f 696e 745f 6265 6c6f 6e67  ent.point_belong
-000298f0: 7328 696e 7465 7273 6563 7469 6f6e 293a  s(intersection):
-00029900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029910: 2069 6e74 6572 7365 6374 696f 6e73 2e61   intersections.a
-00029920: 7070 656e 6428 696e 7465 7273 6563 7469  ppend(intersecti
-00029930: 6f6e 290a 2020 2020 2020 2020 7265 7475  on).        retu
-00029940: 726e 2069 6e74 6572 7365 6374 696f 6e73  rn intersections
-00029950: 0a0a 2020 2020 6465 6620 6469 7363 7265  ..    def discre
-00029960: 7469 7a61 7469 6f6e 5f70 6f69 6e74 7328  tization_points(
-00029970: 7365 6c66 2c20 2a2c 206e 756d 6265 725f  self, *, number_
-00029980: 706f 696e 7473 3a20 696e 7420 3d20 4e6f  points: int = No
-00029990: 6e65 2c20 616e 676c 655f 7265 736f 6c75  ne, angle_resolu
-000299a0: 7469 6f6e 3a20 696e 7420 3d20 3230 293a  tion: int = 20):
-000299b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000299c0: 2020 2020 2043 616c 6375 6c61 7465 7320       Calculates 
-000299d0: 7468 6520 6469 7363 7265 7469 7a65 6420  the discretized 
-000299e0: 706f 696e 7473 2066 6f72 2074 6865 2065  points for the e
-000299f0: 6c6c 6970 7365 2e0a 0a20 2020 2020 2020  llipse...       
-00029a00: 203a 7061 7261 6d20 6e75 6d62 6572 5f70   :param number_p
-00029a10: 6f69 6e74 733a 206e 756d 6265 7220 6f66  oints: number of
-00029a20: 2070 6f69 6e74 2074 6f20 6861 7665 2069   point to have i
-00029a30: 6e20 7468 6520 6469 7363 7265 7469 7a65  n the discretize
-00029a40: 6420 706f 696e 7473 2e0a 2020 2020 2020  d points..      
-00029a50: 2020 3a70 6172 616d 2061 6e67 6c65 5f72    :param angle_r
-00029a60: 6573 6f6c 7574 696f 6e3a 2074 6865 2061  esolution: the a
-00029a70: 6e67 6c65 2072 6573 6f6c 7574 696f 6e20  ngle resolution 
-00029a80: 746f 2062 6520 7573 6564 2074 6f20 6469  to be used to di
-00029a90: 7363 7265 7469 7365 2070 6f69 6e74 732e  scretise points.
-00029aa0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00029ab0: 3a20 6469 7363 7265 7469 7a65 6420 706f  : discretized po
-00029ac0: 696e 7473 2e0a 2020 2020 2020 2020 2222  ints..        ""
-00029ad0: 220a 2020 2020 2020 2020 6966 206e 756d  ".        if num
-00029ae0: 6265 725f 706f 696e 7473 3a0a 2020 2020  ber_points:.    
-00029af0: 2020 2020 2020 2020 616e 676c 655f 7265          angle_re
-00029b00: 736f 6c75 7469 6f6e 203d 206e 756d 6265  solution = numbe
-00029b10: 725f 706f 696e 7473 0a20 2020 2020 2020  r_points.       
-00029b20: 2064 6973 6372 6574 697a 6174 696f 6e5f   discretization_
-00029b30: 706f 696e 7473 203d 205b 7365 6c66 2e63  points = [self.c
-00029b40: 656e 7465 7220 2b20 766f 6c6d 646c 722e  enter + volmdlr.
-00029b50: 506f 696e 7432 4428 7365 6c66 2e6d 616a  Point2D(self.maj
-00029b60: 6f72 5f61 7869 7320 2a20 6d61 7468 2e63  or_axis * math.c
-00029b70: 6f73 2874 6865 7461 292c 0a20 2020 2020  os(theta),.     
+000287f0: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
+00028800: 6e67 290a 2020 2020 2020 2020 7265 7475  ng).        retu
+00028810: 726e 2073 656c 662e 6469 7363 7265 7469  rn self.discreti
+00028820: 7a61 7469 6f6e 5f70 6f69 6e74 7328 616e  zation_points(an
+00028830: 676c 655f 7265 736f 6c75 7469 6f6e 3d64  gle_resolution=d
+00028840: 6973 6372 6574 697a 6174 696f 6e5f 7265  iscretization_re
+00028850: 736f 6c75 7469 6f6e 290a 0a20 2020 2064  solution)..    d
+00028860: 6566 2067 6574 5f67 656f 5f70 6f69 6e74  ef get_geo_point
+00028870: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+00028880: 2072 6574 7572 6e20 5b76 6f6c 6d64 6c72   return [volmdlr
+00028890: 2e50 6f69 6e74 3344 2873 656c 662e 7261  .Point3D(self.ra
+000288a0: 6469 7573 2c20 7365 6c66 2e63 656e 7465  dius, self.cente
+000288b0: 722e 792c 2030 292c 0a20 2020 2020 2020  r.y, 0),.       
+000288c0: 2020 2020 2020 2020 2076 6f6c 6d64 6c72           volmdlr
+000288d0: 2e50 6f69 6e74 3344 2873 656c 662e 6365  .Point3D(self.ce
+000288e0: 6e74 6572 2e78 2c20 7365 6c66 2e63 656e  nter.x, self.cen
+000288f0: 7465 722e 792c 2030 292c 0a20 2020 2020  ter.y, 0),.     
+00028900: 2020 2020 2020 2020 2020 2076 6f6c 6d64             volmd
+00028910: 6c72 2e50 6f69 6e74 3344 282d 7365 6c66  lr.Point3D(-self
+00028920: 2e72 6164 6975 732c 2073 656c 662e 6365  .radius, self.ce
+00028930: 6e74 6572 2e79 2c20 3029 5d0a 0a0a 636c  nter.y, 0)]...cl
+00028940: 6173 7320 456c 6c69 7073 6532 4428 436f  ass Ellipse2D(Co
+00028950: 6e74 6f75 7232 4429 3a0a 2020 2020 2222  ntour2D):.    ""
+00028960: 220a 2020 2020 4465 6669 6e65 7320 616e  ".    Defines an
+00028970: 2045 6c6c 6970 7365 2069 6e20 7477 6f2d   Ellipse in two-
+00028980: 6469 6d65 6e73 696f 6e73 2e0a 0a20 2020  dimensions...   
+00028990: 2045 6c6c 6970 7365 3244 2064 6566 696e   Ellipse2D defin
+000289a0: 6564 2062 7920 6120 6d61 6a6f 7220 6178  ed by a major ax
+000289b0: 6973 2028 4129 2c20 6d69 6e6f 7220 6178  is (A), minor ax
+000289c0: 6973 2028 4229 2c20 6120 6365 6e74 6572  is (B), a center
+000289d0: 2061 6e64 2061 2076 6563 746f 720a 2020   and a vector.  
+000289e0: 2020 7265 7072 6573 656e 7469 6e67 2074    representing t
+000289f0: 6865 2064 6972 6563 7469 6f6e 206f 6620  he direction of 
+00028a00: 7468 6520 6d61 6a6f 7220 6178 6973 2e0a  the major axis..
+00028a10: 0a20 2020 203a 7061 7261 6d20 6d61 6a6f  .    :param majo
+00028a20: 725f 6178 6973 3a20 656c 6c69 7073 6527  r_axis: ellipse'
+00028a30: 7320 6d61 6a6f 7220 6178 6973 2028 4129  s major axis (A)
+00028a40: 0a20 2020 203a 7479 7065 206d 616a 6f72  .    :type major
+00028a50: 5f61 7869 733a 2066 6c6f 6174 0a20 2020  _axis: float.   
+00028a60: 203a 7061 7261 6d20 6d69 6e6f 725f 6178   :param minor_ax
+00028a70: 6973 3a20 656c 6c69 7073 6527 7320 6d69  is: ellipse's mi
+00028a80: 6e6f 7220 6178 6973 2028 4229 0a20 2020  nor axis (B).   
+00028a90: 203a 7479 7065 206d 696e 6f72 5f61 7869   :type minor_axi
+00028aa0: 733a 2066 6c6f 6174 0a20 2020 203a 7061  s: float.    :pa
+00028ab0: 7261 6d20 6365 6e74 6572 3a20 656c 6c69  ram center: elli
+00028ac0: 7073 6527 7320 6365 6e74 6572 0a20 2020  pse's center.   
+00028ad0: 203a 7479 7065 2063 656e 7465 723a 2076   :type center: v
+00028ae0: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 0a20  olmdlr.Point3D. 
+00028af0: 2020 203a 7061 7261 6d20 6d61 6a6f 725f     :param major_
+00028b00: 6469 723a 2064 6972 6563 7469 6f6e 2076  dir: direction v
+00028b10: 6563 746f 7220 666f 7220 6d61 6a6f 7220  ector for major 
+00028b20: 6178 6973 0a20 2020 203a 7479 7065 206d  axis.    :type m
+00028b30: 616a 6f72 5f64 6972 3a20 766f 6c6d 646c  ajor_dir: volmdl
+00028b40: 722e 5665 6374 6f72 3344 0a0a 2020 2020  r.Vector3D..    
+00028b50: 3a45 7861 6d70 6c65 3a0a 2020 2020 3e3e  :Example:.    >>
+00028b60: 3e20 656c 6c69 7073 6532 6420 3d20 7769  > ellipse2d = wi
+00028b70: 7265 732e 456c 6c69 7073 6532 4428 342c  res.Ellipse2D(4,
+00028b80: 2032 2c20 766f 6c6d 646c 722e 4f32 442c   2, volmdlr.O2D,
+00028b90: 2076 6f6c 6d64 6c72 2e56 6563 746f 7232   volmdlr.Vector2
+00028ba0: 4428 312c 2031 2929 0a20 2020 2022 2222  D(1, 1)).    """
+00028bb0: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+00028bc0: 5f5f 2873 656c 662c 206d 616a 6f72 5f61  __(self, major_a
+00028bd0: 7869 732c 206d 696e 6f72 5f61 7869 732c  xis, minor_axis,
+00028be0: 2063 656e 7465 722c 206d 616a 6f72 5f64   center, major_d
+00028bf0: 6972 2c20 6e61 6d65 3d27 2729 3a0a 2020  ir, name=''):.  
+00028c00: 2020 2020 2020 7365 6c66 2e6d 616a 6f72        self.major
+00028c10: 5f61 7869 7320 3d20 6d61 6a6f 725f 6178  _axis = major_ax
+00028c20: 6973 0a20 2020 2020 2020 2073 656c 662e  is.        self.
+00028c30: 6d69 6e6f 725f 6178 6973 203d 206d 696e  minor_axis = min
+00028c40: 6f72 5f61 7869 730a 2020 2020 2020 2020  or_axis.        
+00028c50: 7365 6c66 2e63 656e 7465 7220 3d20 6365  self.center = ce
+00028c60: 6e74 6572 0a20 2020 2020 2020 2073 656c  nter.        sel
+00028c70: 662e 6d61 6a6f 725f 6469 7220 3d20 6d61  f.major_dir = ma
+00028c80: 6a6f 725f 6469 720a 2020 2020 2020 2020  jor_dir.        
+00028c90: 7365 6c66 2e6d 616a 6f72 5f64 6972 2e6e  self.major_dir.n
+00028ca0: 6f72 6d61 6c69 7a65 2829 0a20 2020 2020  ormalize().     
+00028cb0: 2020 2073 656c 662e 6d69 6e6f 725f 6469     self.minor_di
+00028cc0: 7220 3d20 2d20 7365 6c66 2e6d 616a 6f72  r = - self.major
+00028cd0: 5f64 6972 2e6e 6f72 6d61 6c5f 7665 6374  _dir.normal_vect
+00028ce0: 6f72 2829 0a20 2020 2020 2020 2073 656c  or().        sel
+00028cf0: 662e 7468 6574 6120 3d20 766f 6c6d 646c  f.theta = volmdl
+00028d00: 722e 6765 6f6d 6574 7279 2e63 6c6f 636b  r.geometry.clock
+00028d10: 7769 7365 5f61 6e67 6c65 2873 656c 662e  wise_angle(self.
+00028d20: 6d61 6a6f 725f 6469 722c 2076 6f6c 6d64  major_dir, volmd
+00028d30: 6c72 2e58 3244 290a 2020 2020 2020 2020  lr.X2D).        
+00028d40: 6966 2073 656c 662e 7468 6574 6120 3d3d  if self.theta ==
+00028d50: 206d 6174 682e 7069 202a 2032 3a0a 2020   math.pi * 2:.  
+00028d60: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+00028d70: 6865 7461 203d 2030 2e30 0a20 2020 2020  heta = 0.0.     
+00028d80: 2020 2043 6f6e 746f 7572 3244 2e5f 5f69     Contour2D.__i
+00028d90: 6e69 745f 5f28 7365 6c66 2c20 5b73 656c  nit__(self, [sel
+00028da0: 665d 2c20 6e61 6d65 3d6e 616d 6529 0a0a  f], name=name)..
+00028db0: 2020 2020 6465 6620 5f5f 6861 7368 5f5f      def __hash__
+00028dc0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00028dd0: 7265 7475 726e 2069 6e74 2872 6f75 6e64  return int(round
+00028de0: 2831 6536 202a 2028 7365 6c66 2e63 656e  (1e6 * (self.cen
+00028df0: 7465 722e 7820 2b20 7365 6c66 2e63 656e  ter.x + self.cen
+00028e00: 7465 722e 7920 2b20 7365 6c66 2e6d 616a  ter.y + self.maj
+00028e10: 6f72 5f61 7869 7320 2b20 7365 6c66 2e6d  or_axis + self.m
+00028e20: 696e 6f72 5f61 7869 7329 2929 0a0a 2020  inor_axis)))..  
+00028e30: 2020 6465 6620 6172 6561 2873 656c 6629    def area(self)
+00028e40: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00028e50: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
+00028e60: 2074 6865 2065 6c6c 6970 6527 7320 6172   the ellipe's ar
+00028e70: 6561 2e0a 0a20 2020 2020 2020 203a 7265  ea...        :re
+00028e80: 7475 726e 3a20 656c 6c69 7065 2773 2061  turn: ellipe's a
+00028e90: 7265 612c 2066 6c6f 6174 2e0a 2020 2020  rea, float..    
+00028ea0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00028eb0: 7265 7475 726e 206d 6174 682e 7069 202a  return math.pi *
+00028ec0: 2073 656c 662e 6d61 6a6f 725f 6178 6973   self.major_axis
+00028ed0: 202a 2073 656c 662e 6d69 6e6f 725f 6178   * self.minor_ax
+00028ee0: 6973 0a0a 2020 2020 6465 6620 6c65 6e67  is..    def leng
+00028ef0: 7468 2873 656c 6629 3a0a 2020 2020 2020  th(self):.      
+00028f00: 2020 2222 220a 2020 2020 2020 2020 4361    """.        Ca
+00028f10: 6c63 756c 6174 6573 2074 6865 2065 6c6c  lculates the ell
+00028f20: 6970 7365 2773 206c 656e 6774 682e 0a0a  ipse's length...
+00028f30: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+00028f40: 2065 6c6c 6970 6527 7320 6c65 6e67 7468   ellipe's length
+00028f50: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00028f60: 2020 2020 2020 6d69 645f 706f 696e 7420        mid_point 
+00028f70: 3d20 7365 6c66 2e63 656e 7465 7220 2d20  = self.center - 
+00028f80: 7365 6c66 2e6d 616a 6f72 5f61 7869 7320  self.major_axis 
+00028f90: 2a20 7365 6c66 2e6d 616a 6f72 5f64 6972  * self.major_dir
+00028fa0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00028fb0: 2e74 6865 7461 2021 3d20 302e 303a 0a20  .theta != 0.0:. 
+00028fc0: 2020 2020 2020 2020 2020 206d 6964 5f70             mid_p
+00028fd0: 6f69 6e74 203d 2073 656c 662e 6365 6e74  oint = self.cent
+00028fe0: 6572 202d 2076 6f6c 6d64 6c72 2e50 6f69  er - volmdlr.Poi
+00028ff0: 6e74 3244 2873 656c 662e 6d61 6a6f 725f  nt2D(self.major_
+00029000: 6178 6973 2c20 3029 0a20 2020 2020 2020  axis, 0).       
+00029010: 2020 2020 206d 6964 5f70 6f69 6e74 203d       mid_point =
+00029020: 206d 6964 5f70 6f69 6e74 2e72 6f74 6174   mid_point.rotat
+00029030: 696f 6e28 7365 6c66 2e63 656e 7465 722c  ion(self.center,
+00029040: 2073 656c 662e 7468 6574 6129 0a20 2020   self.theta).   
+00029050: 2020 2020 206c 656e 6774 6820 3d20 3220       length = 2 
+00029060: 2a20 7365 6c66 2e61 6273 6369 7373 6128  * self.abscissa(
+00029070: 6d69 645f 706f 696e 7429 0a20 2020 2020  mid_point).     
+00029080: 2020 2072 6574 7572 6e20 6c65 6e67 7468     return length
+00029090: 0a0a 2020 2020 6465 6620 746f 5f33 6428  ..    def to_3d(
+000290a0: 7365 6c66 2c20 706c 616e 655f 6f72 6967  self, plane_orig
+000290b0: 696e 2c20 782c 2079 293a 0a20 2020 2020  in, x, y):.     
+000290c0: 2020 2022 2222 0a20 2020 2020 2020 2054     """.        T
+000290d0: 7261 6e73 666f 726d 7320 6120 456c 6c69  ransforms a Elli
+000290e0: 7073 6532 4420 696e 746f 2061 6e20 456c  pse2D into an El
+000290f0: 6c69 7073 6533 442c 2067 6976 656e 2061  lipse3D, given a
+00029100: 2070 6c61 6e65 206f 7269 6769 6e20 616e   plane origin an
+00029110: 6420 616e 2075 2061 6e64 2076 2070 6c61  d an u and v pla
+00029120: 6e65 2076 6563 746f 722e 0a0a 2020 2020  ne vector...    
+00029130: 2020 2020 3a70 6172 616d 2070 6c61 6e65      :param plane
+00029140: 5f6f 7269 6769 6e3a 2070 6c61 6e65 206f  _origin: plane o
+00029150: 7269 6769 6e2e 0a20 2020 2020 2020 203a  rigin..        :
+00029160: 7061 7261 6d20 783a 2070 6c61 6e65 2075  param x: plane u
+00029170: 2076 6563 746f 722e 0a20 2020 2020 2020   vector..       
+00029180: 203a 7061 7261 6d20 793a 2070 6c61 6e65   :param y: plane
+00029190: 2076 2076 6563 746f 722e 0a20 2020 2020   v vector..     
+000291a0: 2020 203a 7265 7475 726e 3a20 456c 6c69     :return: Elli
+000291b0: 7073 6533 442e 0a20 2020 2020 2020 2022  pse3D..        "
+000291c0: 2222 0a20 2020 2020 2020 2072 6169 7365  "".        raise
+000291d0: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+000291e0: 7272 6f72 0a0a 2020 2020 6465 6620 706f  rror..    def po
+000291f0: 696e 745f 6f76 6572 5f65 6c6c 6970 7365  int_over_ellipse
+00029200: 2873 656c 662c 2070 6f69 6e74 2c20 6162  (self, point, ab
+00029210: 735f 746f 6c3d 3165 2d36 293a 0a20 2020  s_tol=1e-6):.   
+00029220: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00029230: 2056 6572 6966 6965 7320 6966 2061 2070   Verifies if a p
+00029240: 6f69 6e74 2069 7320 6f6e 2074 6865 2065  oint is on the e
+00029250: 6c6c 6970 7365 2e0a 0a20 2020 2020 2020  llipse...       
+00029260: 203a 7061 7261 6d20 706f 696e 743a 2070   :param point: p
+00029270: 6f69 6e74 2074 6f20 6265 2076 6572 6966  oint to be verif
+00029280: 6965 642e 0a20 2020 2020 2020 2020 3a70  ied..         :p
+00029290: 6172 616d 2061 6273 5f74 6f6c 3a20 746f  aram abs_tol: to
+000292a0: 6c65 7261 6e63 652e 0a20 2020 2020 2020  lerance..       
+000292b0: 203a 7265 7475 726e 3a20 5472 7565 206f   :return: True o
+000292c0: 7220 4661 6c73 652e 0a20 2020 2020 2020  r False..       
+000292d0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+000292e0: 7572 6e20 6d61 7468 2e69 7363 6c6f 7365  urn math.isclose
+000292f0: 280a 2020 2020 2020 2020 2020 2020 2828  (.            ((
+00029300: 706f 696e 742e 7820 2d20 7365 6c66 2e63  point.x - self.c
+00029310: 656e 7465 722e 7829 202a 206d 6174 682e  enter.x) * math.
+00029320: 636f 7328 7365 6c66 2e74 6865 7461 2920  cos(self.theta) 
+00029330: 2b0a 2020 2020 2020 2020 2020 2020 2028  +.             (
+00029340: 706f 696e 742e 7920 2d20 7365 6c66 2e63  point.y - self.c
+00029350: 656e 7465 722e 7929 202a 206d 6174 682e  enter.y) * math.
+00029360: 7369 6e28 7365 6c66 2e74 6865 7461 2929  sin(self.theta))
+00029370: 202a 2a20 3220 2f20 7365 6c66 2e6d 616a   ** 2 / self.maj
+00029380: 6f72 5f61 7869 7320 2a2a 2032 202b 0a20  or_axis ** 2 +. 
+00029390: 2020 2020 2020 2020 2020 2028 2870 6f69             ((poi
+000293a0: 6e74 2e78 202d 2073 656c 662e 6365 6e74  nt.x - self.cent
+000293b0: 6572 2e78 2920 2a20 6d61 7468 2e73 696e  er.x) * math.sin
+000293c0: 2873 656c 662e 7468 6574 6129 202d 0a20  (self.theta) -. 
+000293d0: 2020 2020 2020 2020 2020 2020 2870 6f69              (poi
+000293e0: 6e74 2e79 202d 2073 656c 662e 6365 6e74  nt.y - self.cent
+000293f0: 6572 2e79 2920 2a20 6d61 7468 2e63 6f73  er.y) * math.cos
+00029400: 2873 656c 662e 7468 6574 6129 2920 2a2a  (self.theta)) **
+00029410: 2032 202f 2073 656c 662e 6d69 6e6f 725f   2 / self.minor_
+00029420: 6178 6973 202a 2a20 322c 2031 2c20 6162  axis ** 2, 1, ab
+00029430: 735f 746f 6c3d 6162 735f 746f 6c29 0a0a  s_tol=abs_tol)..
+00029440: 2020 2020 6465 6620 706f 696e 745f 6f76      def point_ov
+00029450: 6572 5f63 6f6e 746f 7572 2873 656c 662c  er_contour(self,
+00029460: 2070 6f69 6e74 2c20 6162 735f 746f 6c3d   point, abs_tol=
+00029470: 3165 2d36 293a 0a20 2020 2020 2020 2022  1e-6):.        "
+00029480: 2222 0a20 2020 2020 2020 2056 6572 6966  "".        Verif
+00029490: 6965 7320 6966 2061 2070 6f69 6e74 2069  ies if a point i
+000294a0: 7320 6f6e 2074 6865 2065 6c6c 6970 7365  s on the ellipse
+000294b0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+000294c0: 6d20 706f 696e 743a 2070 6f69 6e74 2074  m point: point t
+000294d0: 6f20 6265 2076 6572 6966 6965 642e 0a20  o be verified.. 
+000294e0: 2020 2020 2020 203a 7061 7261 6d20 6162         :param ab
+000294f0: 735f 746f 6c3a 2074 6f6c 6572 616e 6365  s_tol: tolerance
+00029500: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00029510: 6e3a 2054 7275 6520 6f72 2046 616c 7365  n: True or False
+00029520: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00029530: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00029540: 662e 706f 696e 745f 6f76 6572 5f65 6c6c  f.point_over_ell
+00029550: 6970 7365 2870 6f69 6e74 2c20 6162 735f  ipse(point, abs_
+00029560: 746f 6c29 0a0a 2020 2020 6465 6620 6c69  tol)..    def li
+00029570: 6e65 5f69 6e74 6572 7365 6374 696f 6e73  ne_intersections
+00029580: 2873 656c 662c 206c 696e 653a 2027 766f  (self, line: 'vo
+00029590: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
+000295a0: 3244 2729 3a0a 2020 2020 2020 2020 2222  2D'):.        ""
+000295b0: 220a 2020 2020 2020 2020 4361 6c63 756c  ".        Calcul
+000295c0: 6174 6573 2074 6865 2069 6e74 6572 7365  ates the interse
+000295d0: 6374 696f 6e73 2062 6574 7765 656e 2061  ctions between a
+000295e0: 206c 696e 6520 616e 6420 616e 2065 6c6c   line and an ell
+000295f0: 6970 7365 2e0a 0a20 2020 2020 2020 203a  ipse...        :
+00029600: 7061 7261 6d20 6c69 6e65 3a20 6c69 6e65  param line: line
+00029610: 2074 6f20 6361 6c63 756c 6174 6520 696e   to calculate in
+00029620: 7465 7273 6563 7469 6f6e 730a 2020 2020  tersections.    
+00029630: 2020 2020 3a72 6574 7572 6e3a 206c 6973      :return: lis
+00029640: 7420 6f66 2070 6f69 6e74 7320 696e 7465  t of points inte
+00029650: 7273 6563 7469 6f6e 732c 2069 6620 7468  rsections, if th
+00029660: 6572 6520 6172 6520 616e 790a 2020 2020  ere are any.    
+00029670: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00029680: 696e 7465 7273 6563 7469 6f6e 7320 3d20  intersections = 
+00029690: 766d 5f75 7469 6c73 5f69 6e74 6572 7365  vm_utils_interse
+000296a0: 6374 696f 6e73 2e65 6c6c 6970 7365 3264  ctions.ellipse2d
+000296b0: 5f6c 696e 655f 696e 7465 7273 6563 7469  _line_intersecti
+000296c0: 6f6e 7328 7365 6c66 2c20 6c69 6e65 290a  ons(self, line).
+000296d0: 2020 2020 2020 2020 7265 7475 726e 2069          return i
+000296e0: 6e74 6572 7365 6374 696f 6e73 0a0a 2020  ntersections..  
+000296f0: 2020 6465 6620 6c69 6e65 7365 676d 656e    def linesegmen
+00029700: 745f 696e 7465 7273 6563 7469 6f6e 7328  t_intersections(
+00029710: 7365 6c66 2c20 6c69 6e65 7365 676d 656e  self, linesegmen
+00029720: 743a 2027 766f 6c6d 646c 722e 6564 6765  t: 'volmdlr.edge
+00029730: 732e 4c69 6e65 5365 676d 656e 7432 4427  s.LineSegment2D'
+00029740: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00029750: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
+00029760: 7320 7468 6520 696e 7465 7273 6563 7469  s the intersecti
+00029770: 6f6e 7320 6265 7477 6565 6e20 6120 6c69  ons between a li
+00029780: 6e65 7365 676d 656e 7420 616e 6420 616e  nesegment and an
+00029790: 2065 6c6c 6970 7365 2e0a 0a20 2020 2020   ellipse...     
+000297a0: 2020 203a 7061 7261 6d20 6c69 6e65 7365     :param linese
+000297b0: 676d 656e 743a 206c 696e 6573 6567 6d65  gment: linesegme
+000297c0: 6e74 2074 6f20 6361 6c63 756c 6174 6520  nt to calculate 
+000297d0: 696e 7465 7273 6563 7469 6f6e 732e 0a20  intersections.. 
+000297e0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+000297f0: 6c69 7374 206f 6620 706f 696e 7473 2069  list of points i
+00029800: 6e74 6572 7365 6374 696f 6e73 2c20 6966  ntersections, if
+00029810: 2074 6865 7265 2061 7265 2061 6e79 2e0a   there are any..
+00029820: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00029830: 2020 2020 6c69 6e65 5f69 6e74 6572 7365      line_interse
+00029840: 6374 696f 6e73 203d 2073 656c 662e 6c69  ctions = self.li
+00029850: 6e65 5f69 6e74 6572 7365 6374 696f 6e73  ne_intersections
+00029860: 286c 696e 6573 6567 6d65 6e74 2e74 6f5f  (linesegment.to_
+00029870: 6c69 6e65 2829 290a 2020 2020 2020 2020  line()).        
+00029880: 696e 7465 7273 6563 7469 6f6e 7320 3d20  intersections = 
+00029890: 5b5d 0a20 2020 2020 2020 2066 6f72 2069  [].        for i
+000298a0: 6e74 6572 7365 6374 696f 6e20 696e 206c  ntersection in l
+000298b0: 696e 655f 696e 7465 7273 6563 7469 6f6e  ine_intersection
+000298c0: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
+000298d0: 6620 6c69 6e65 7365 676d 656e 742e 706f  f linesegment.po
+000298e0: 696e 745f 6265 6c6f 6e67 7328 696e 7465  int_belongs(inte
+000298f0: 7273 6563 7469 6f6e 293a 0a20 2020 2020  rsection):.     
+00029900: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
+00029910: 7365 6374 696f 6e73 2e61 7070 656e 6428  sections.append(
+00029920: 696e 7465 7273 6563 7469 6f6e 290a 2020  intersection).  
+00029930: 2020 2020 2020 7265 7475 726e 2069 6e74        return int
+00029940: 6572 7365 6374 696f 6e73 0a0a 2020 2020  ersections..    
+00029950: 6465 6620 6469 7363 7265 7469 7a61 7469  def discretizati
+00029960: 6f6e 5f70 6f69 6e74 7328 7365 6c66 2c20  on_points(self, 
+00029970: 2a2c 206e 756d 6265 725f 706f 696e 7473  *, number_points
+00029980: 3a20 696e 7420 3d20 4e6f 6e65 2c20 616e  : int = None, an
+00029990: 676c 655f 7265 736f 6c75 7469 6f6e 3a20  gle_resolution: 
+000299a0: 696e 7420 3d20 3230 293a 0a20 2020 2020  int = 20):.     
+000299b0: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+000299c0: 616c 6375 6c61 7465 7320 7468 6520 6469  alculates the di
+000299d0: 7363 7265 7469 7a65 6420 706f 696e 7473  scretized points
+000299e0: 2066 6f72 2074 6865 2065 6c6c 6970 7365   for the ellipse
+000299f0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00029a00: 6d20 6e75 6d62 6572 5f70 6f69 6e74 733a  m number_points:
+00029a10: 206e 756d 6265 7220 6f66 2070 6f69 6e74   number of point
+00029a20: 2074 6f20 6861 7665 2069 6e20 7468 6520   to have in the 
+00029a30: 6469 7363 7265 7469 7a65 6420 706f 696e  discretized poin
+00029a40: 7473 2e0a 2020 2020 2020 2020 3a70 6172  ts..        :par
+00029a50: 616d 2061 6e67 6c65 5f72 6573 6f6c 7574  am angle_resolut
+00029a60: 696f 6e3a 2074 6865 2061 6e67 6c65 2072  ion: the angle r
+00029a70: 6573 6f6c 7574 696f 6e20 746f 2062 6520  esolution to be 
+00029a80: 7573 6564 2074 6f20 6469 7363 7265 7469  used to discreti
+00029a90: 7365 2070 6f69 6e74 732e 0a20 2020 2020  se points..     
+00029aa0: 2020 203a 7265 7475 726e 3a20 6469 7363     :return: disc
+00029ab0: 7265 7469 7a65 6420 706f 696e 7473 2e0a  retized points..
+00029ac0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00029ad0: 2020 2020 6966 206e 756d 6265 725f 706f      if number_po
+00029ae0: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
+00029af0: 2020 616e 676c 655f 7265 736f 6c75 7469    angle_resoluti
+00029b00: 6f6e 203d 206e 756d 6265 725f 706f 696e  on = number_poin
+00029b10: 7473 0a20 2020 2020 2020 2064 6973 6372  ts.        discr
+00029b20: 6574 697a 6174 696f 6e5f 706f 696e 7473  etization_points
+00029b30: 203d 205b 7365 6c66 2e63 656e 7465 7220   = [self.center 
+00029b40: 2b20 766f 6c6d 646c 722e 506f 696e 7432  + volmdlr.Point2
+00029b50: 4428 7365 6c66 2e6d 616a 6f72 5f61 7869  D(self.major_axi
+00029b60: 7320 2a20 6d61 7468 2e63 6f73 2874 6865  s * math.cos(the
+00029b70: 7461 292c 0a20 2020 2020 2020 2020 2020  ta),.           
 00029b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00029b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00029ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029bb0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00029bc0: 696e 6f72 5f61 7869 7320 2a20 6d61 7468  inor_axis * math
-00029bd0: 2e73 696e 2874 6865 7461 2929 0a20 2020  .sin(theta)).   
+00029bb0: 2020 2020 7365 6c66 2e6d 696e 6f72 5f61      self.minor_a
+00029bc0: 7869 7320 2a20 6d61 7468 2e73 696e 2874  xis * math.sin(t
+00029bd0: 6865 7461 2929 0a20 2020 2020 2020 2020  heta)).         
 00029be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029bf0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00029c00: 7220 7468 6574 6120 696e 206e 7079 2e6c  r theta in npy.l
-00029c10: 696e 7370 6163 6528 302c 2076 6f6c 6d64  inspace(0, volmd
-00029c20: 6c72 2e54 574f 5f50 492c 2061 6e67 6c65  lr.TWO_PI, angle
-00029c30: 5f72 6573 6f6c 7574 696f 6e20 2b20 3129  _resolution + 1)
-00029c40: 5d0a 2020 2020 2020 2020 6469 7363 7265  ].        discre
-00029c50: 7469 7a61 7469 6f6e 5f70 6f69 6e74 7320  tization_points 
-00029c60: 3d20 5b70 6f69 6e74 2e72 6f74 6174 696f  = [point.rotatio
-00029c70: 6e28 7365 6c66 2e63 656e 7465 722c 2073  n(self.center, s
-00029c80: 656c 662e 7468 6574 6129 2066 6f72 2070  elf.theta) for p
-00029c90: 6f69 6e74 2069 6e20 6469 7363 7265 7469  oint in discreti
-00029ca0: 7a61 7469 6f6e 5f70 6f69 6e74 735d 0a20  zation_points]. 
-00029cb0: 2020 2020 2020 2072 6574 7572 6e20 6469         return di
-00029cc0: 7363 7265 7469 7a61 7469 6f6e 5f70 6f69  scretization_poi
-00029cd0: 6e74 730a 0a20 2020 2064 6566 2061 6273  nts..    def abs
-00029ce0: 6369 7373 6128 7365 6c66 2c20 706f 696e  cissa(self, poin
-00029cf0: 743a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  t: volmdlr.Point
-00029d00: 3244 293a 0a20 2020 2020 2020 2022 2222  2D):.        """
-00029d10: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
-00029d20: 7465 7320 7468 6520 6162 7363 6973 7361  tes the abscissa
-00029d30: 2066 6f72 2061 2067 6976 656e 2070 6f69   for a given poi
-00029d40: 6e74 2e0a 0a20 2020 2020 2020 203a 7061  nt...        :pa
-00029d50: 7261 6d20 706f 696e 743a 2070 6f69 6e74  ram point: point
-00029d60: 2074 6f20 6361 6c63 756c 6174 6520 7468   to calculate th
-00029d70: 6520 6162 7363 6973 7361 2e0a 2020 2020  e abscissa..    
-00029d80: 2020 2020 3a72 6574 7572 6e3a 2074 6865      :return: the
-00029d90: 2063 6f72 7265 7370 6f6e 6469 6e67 2061   corresponding a
-00029da0: 6273 6369 7373 612c 2030 203c 2061 6273  bscissa, 0 < abs
-00029db0: 6369 7373 6120 3c20 656c 6c69 7073 6527  cissa < ellipse'
-00029dc0: 7320 6c65 6e67 7468 2e0a 2020 2020 2020  s length..      
-00029dd0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00029de0: 2073 656c 662e 706f 696e 745f 6f76 6572   self.point_over
-00029df0: 5f65 6c6c 6970 7365 2870 6f69 6e74 293a  _ellipse(point):
-00029e00: 0a20 2020 2020 2020 2020 2020 2061 6e67  .            ang
-00029e10: 6c65 5f61 6273 6369 7373 6120 3d20 7365  le_abscissa = se
-00029e20: 6c66 2e70 6f69 6e74 5f61 6e67 6c65 5f77  lf.point_angle_w
-00029e30: 6974 685f 6d61 6a6f 725f 6469 7228 706f  ith_major_dir(po
-00029e40: 696e 7429 0a0a 2020 2020 2020 2020 2020  int)..          
-00029e50: 2020 6465 6620 6172 635f 6c65 6e67 7468    def arc_length
-00029e60: 2874 6865 7461 293a 0a20 2020 2020 2020  (theta):.       
-00029e70: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00029e80: 6d61 7468 2e73 7172 7428 2873 656c 662e  math.sqrt((self.
-00029e90: 6d61 6a6f 725f 6178 6973 202a 2a20 3229  major_axis ** 2)
-00029ea0: 202a 206d 6174 682e 7369 6e28 7468 6574   * math.sin(thet
-00029eb0: 6129 202a 2a20 3220 2b0a 2020 2020 2020  a) ** 2 +.      
+00029bf0: 2020 2020 2020 2020 666f 7220 7468 6574          for thet
+00029c00: 6120 696e 206e 7079 2e6c 696e 7370 6163  a in npy.linspac
+00029c10: 6528 302c 2076 6f6c 6d64 6c72 2e54 574f  e(0, volmdlr.TWO
+00029c20: 5f50 492c 2061 6e67 6c65 5f72 6573 6f6c  _PI, angle_resol
+00029c30: 7574 696f 6e20 2b20 3129 5d0a 2020 2020  ution + 1)].    
+00029c40: 2020 2020 6469 7363 7265 7469 7a61 7469      discretizati
+00029c50: 6f6e 5f70 6f69 6e74 7320 3d20 5b70 6f69  on_points = [poi
+00029c60: 6e74 2e72 6f74 6174 696f 6e28 7365 6c66  nt.rotation(self
+00029c70: 2e63 656e 7465 722c 2073 656c 662e 7468  .center, self.th
+00029c80: 6574 6129 2066 6f72 2070 6f69 6e74 2069  eta) for point i
+00029c90: 6e20 6469 7363 7265 7469 7a61 7469 6f6e  n discretization
+00029ca0: 5f70 6f69 6e74 735d 0a20 2020 2020 2020  _points].       
+00029cb0: 2072 6574 7572 6e20 6469 7363 7265 7469   return discreti
+00029cc0: 7a61 7469 6f6e 5f70 6f69 6e74 730a 0a20  zation_points.. 
+00029cd0: 2020 2064 6566 2061 6273 6369 7373 6128     def abscissa(
+00029ce0: 7365 6c66 2c20 706f 696e 743a 2076 6f6c  self, point: vol
+00029cf0: 6d64 6c72 2e50 6f69 6e74 3244 293a 0a20  mdlr.Point2D):. 
+00029d00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00029d10: 2020 2043 616c 6375 6c61 7465 7320 7468     Calculates th
+00029d20: 6520 6162 7363 6973 7361 2066 6f72 2061  e abscissa for a
+00029d30: 2067 6976 656e 2070 6f69 6e74 2e0a 0a20   given point... 
+00029d40: 2020 2020 2020 203a 7061 7261 6d20 706f         :param po
+00029d50: 696e 743a 2070 6f69 6e74 2074 6f20 6361  int: point to ca
+00029d60: 6c63 756c 6174 6520 7468 6520 6162 7363  lculate the absc
+00029d70: 6973 7361 2e0a 2020 2020 2020 2020 3a72  issa..        :r
+00029d80: 6574 7572 6e3a 2074 6865 2063 6f72 7265  eturn: the corre
+00029d90: 7370 6f6e 6469 6e67 2061 6273 6369 7373  sponding absciss
+00029da0: 612c 2030 203c 2061 6273 6369 7373 6120  a, 0 < abscissa 
+00029db0: 3c20 656c 6c69 7073 6527 7320 6c65 6e67  < ellipse's leng
+00029dc0: 7468 2e0a 2020 2020 2020 2020 2222 220a  th..        """.
+00029dd0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00029de0: 706f 696e 745f 6f76 6572 5f65 6c6c 6970  point_over_ellip
+00029df0: 7365 2870 6f69 6e74 293a 0a20 2020 2020  se(point):.     
+00029e00: 2020 2020 2020 2061 6e67 6c65 5f61 6273         angle_abs
+00029e10: 6369 7373 6120 3d20 7365 6c66 2e70 6f69  cissa = self.poi
+00029e20: 6e74 5f61 6e67 6c65 5f77 6974 685f 6d61  nt_angle_with_ma
+00029e30: 6a6f 725f 6469 7228 706f 696e 7429 0a0a  jor_dir(point)..
+00029e40: 2020 2020 2020 2020 2020 2020 6465 6620              def 
+00029e50: 6172 635f 6c65 6e67 7468 2874 6865 7461  arc_length(theta
+00029e60: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00029e70: 2020 2072 6574 7572 6e20 6d61 7468 2e73     return math.s
+00029e80: 7172 7428 2873 656c 662e 6d61 6a6f 725f  qrt((self.major_
+00029e90: 6178 6973 202a 2a20 3229 202a 206d 6174  axis ** 2) * mat
+00029ea0: 682e 7369 6e28 7468 6574 6129 202a 2a20  h.sin(theta) ** 
+00029eb0: 3220 2b0a 2020 2020 2020 2020 2020 2020  2 +.            
 00029ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ed0: 2020 2020 2020 2020 2020 2028 7365 6c66             (self
-00029ee0: 2e6d 696e 6f72 5f61 7869 7320 2a2a 2032  .minor_axis ** 2
-00029ef0: 2920 2a20 6d61 7468 2e63 6f73 2874 6865  ) * math.cos(the
-00029f00: 7461 2920 2a2a 2032 290a 0a20 2020 2020  ta) ** 2)..     
-00029f10: 2020 2020 2020 2072 6573 2c20 5f20 3d20         res, _ = 
-00029f20: 7363 6970 795f 696e 7465 6772 6174 652e  scipy_integrate.
-00029f30: 7175 6164 2861 7263 5f6c 656e 6774 682c  quad(arc_length,
-00029f40: 2030 2c20 616e 676c 655f 6162 7363 6973   0, angle_abscis
-00029f50: 7361 290a 2020 2020 2020 2020 2020 2020  sa).            
-00029f60: 7265 7475 726e 2072 6573 0a20 2020 2020  return res.     
-00029f70: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00029f80: 726f 7228 6627 706f 696e 7420 7b70 6f69  ror(f'point {poi
-00029f90: 6e74 7d20 646f 6573 206e 6f74 2062 656c  nt} does not bel
-00029fa0: 6f6e 6720 746f 2065 6c6c 6970 7365 2729  ong to ellipse')
-00029fb0: 0a0a 2020 2020 6465 6620 706f 696e 745f  ..    def point_
-00029fc0: 616e 676c 655f 7769 7468 5f6d 616a 6f72  angle_with_major
-00029fd0: 5f64 6972 2873 656c 662c 2070 6f69 6e74  _dir(self, point
-00029fe0: 3264 293a 0a20 2020 2020 2020 2022 2222  2d):.        """
-00029ff0: 0a20 2020 2020 2020 2047 6976 656e 2061  .        Given a
-0002a000: 2070 6f69 6e74 2069 6e20 7468 6520 656c   point in the el
-0002a010: 6c69 7073 652c 2063 616c 6375 6c61 7465  lipse, calculate
-0002a020: 7320 6974 2061 6e67 6c65 2077 6974 6820  s it angle with 
-0002a030: 7468 6520 6d61 6a6f 7220 6469 7265 6374  the major direct
-0002a040: 696f 6e20 7665 6374 6f72 2e0a 0a20 2020  ion vector...   
-0002a050: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002a060: 2063 656e 7465 7232 645f 706f 696e 7432   center2d_point2
-0002a070: 6420 3d20 706f 696e 7432 6420 2d20 7365  d = point2d - se
-0002a080: 6c66 2e63 656e 7465 720a 2020 2020 2020  lf.center.      
-0002a090: 2020 616e 676c 655f 6162 7363 6973 7361    angle_abscissa
-0002a0a0: 203d 2076 6f6c 6d64 6c72 2e67 656f 6d65   = volmdlr.geome
-0002a0b0: 7472 792e 636c 6f63 6b77 6973 655f 616e  try.clockwise_an
-0002a0c0: 676c 6528 6365 6e74 6572 3264 5f70 6f69  gle(center2d_poi
-0002a0d0: 6e74 3264 2c20 7365 6c66 2e6d 616a 6f72  nt2d, self.major
-0002a0e0: 5f64 6972 290a 2020 2020 2020 2020 7265  _dir).        re
-0002a0f0: 7475 726e 2061 6e67 6c65 5f61 6273 6369  turn angle_absci
-0002a100: 7373 610a 0a20 2020 2064 6566 2070 6c6f  ssa..    def plo
-0002a110: 7428 7365 6c66 2c20 6178 3d4e 6f6e 652c  t(self, ax=None,
-0002a120: 2063 6f6c 6f72 3d27 6b27 2c20 616c 7068   color='k', alph
-0002a130: 613d 312c 2070 6c6f 745f 706f 696e 7473  a=1, plot_points
-0002a140: 3d46 616c 7365 2c20 6571 7561 6c5f 6173  =False, equal_as
-0002a150: 7065 6374 3d54 7275 6529 3a0a 2020 2020  pect=True):.    
-0002a160: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002a170: 4d61 7470 6c6f 746c 6962 2070 6c6f 7420  Matplotlib plot 
-0002a180: 666f 7220 616e 2065 6c6c 6970 7365 2e0a  for an ellipse..
-0002a190: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0002a1a0: 2020 2020 2069 6620 6178 2069 7320 4e6f       if ax is No
-0002a1b0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0002a1c0: 5f2c 2061 7820 3d20 706c 742e 7375 6270  _, ax = plt.subp
-0002a1d0: 6c6f 7473 2829 0a20 2020 2020 2020 2078  lots().        x
-0002a1e0: 203d 205b 5d0a 2020 2020 2020 2020 7920   = [].        y 
-0002a1f0: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
-0002a200: 2070 6f69 6e74 5f78 2c20 706f 696e 745f   point_x, point_
-0002a210: 7920 696e 2073 656c 662e 6469 7363 7265  y in self.discre
-0002a220: 7469 7a61 7469 6f6e 5f70 6f69 6e74 7328  tization_points(
-0002a230: 6e75 6d62 6572 5f70 6f69 6e74 733d 3530  number_points=50
-0002a240: 293a 0a20 2020 2020 2020 2020 2020 2078  ):.            x
-0002a250: 2e61 7070 656e 6428 706f 696e 745f 7829  .append(point_x)
-0002a260: 0a20 2020 2020 2020 2020 2020 2079 2e61  .            y.a
-0002a270: 7070 656e 6428 706f 696e 745f 7929 0a20  ppend(point_y). 
-0002a280: 2020 2020 2020 2070 6c74 2e70 6c6f 7428         plt.plot(
-0002a290: 782c 2079 2c20 636f 6c6f 723d 636f 6c6f  x, y, color=colo
-0002a2a0: 722c 2061 6c70 6861 3d61 6c70 6861 290a  r, alpha=alpha).
-0002a2b0: 2020 2020 2020 2020 6966 2065 7175 616c          if equal
-0002a2c0: 5f61 7370 6563 743a 0a20 2020 2020 2020  _aspect:.       
-0002a2d0: 2020 2020 2061 782e 7365 745f 6173 7065       ax.set_aspe
-0002a2e0: 6374 2827 6571 7561 6c27 290a 2020 2020  ct('equal').    
-0002a2f0: 2020 2020 7265 7475 726e 2061 780a 0a20      return ax.. 
-0002a300: 2020 2064 6566 2072 6f74 6174 696f 6e28     def rotation(
-0002a310: 7365 6c66 2c20 6365 6e74 6572 3a20 766f  self, center: vo
-0002a320: 6c6d 646c 722e 506f 696e 7432 442c 2061  lmdlr.Point2D, a
-0002a330: 6e67 6c65 3a20 666c 6f61 7429 3a0a 2020  ngle: float):.  
-0002a340: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002a350: 2020 526f 7461 7469 6f6e 206f 6620 656c    Rotation of el
-0002a360: 6c69 7073 6520 6172 6f75 6e64 2061 2063  lipse around a c
-0002a370: 656e 7465 7220 616e 6420 616e 2061 6e67  enter and an ang
-0002a380: 6c65 2e0a 0a20 2020 2020 2020 203a 7061  le...        :pa
-0002a390: 7261 6d20 6365 6e74 6572 3a20 6365 6e74  ram center: cent
-0002a3a0: 6572 206f 6620 7468 6520 726f 7461 7469  er of the rotati
-0002a3b0: 6f6e 2e0a 2020 2020 2020 2020 3a70 6172  on..        :par
-0002a3c0: 616d 2061 6e67 6c65 3a20 616e 676c 6520  am angle: angle 
-0002a3d0: 746f 2072 6f74 6174 6564 206f 662e 0a20  to rotated of.. 
-0002a3e0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-0002a3f0: 6120 726f 7461 7469 6f6e 6564 206e 6577  a rotationed new
-0002a400: 2065 6c6c 6970 7365 2e0a 2020 2020 2020   ellipse..      
-0002a410: 2020 2222 220a 2020 2020 2020 2020 726f    """.        ro
-0002a420: 7461 7469 6f6e 6564 5f63 656e 7465 7220  tationed_center 
-0002a430: 3d20 7365 6c66 2e63 656e 7465 722e 726f  = self.center.ro
-0002a440: 7461 7469 6f6e 2863 656e 7465 722c 2061  tation(center, a
-0002a450: 6e67 6c65 290a 2020 2020 2020 2020 706f  ngle).        po
-0002a460: 696e 745f 6d61 6a6f 725f 6469 7220 3d20  int_major_dir = 
-0002a470: 7365 6c66 2e63 656e 7465 7220 2b20 7365  self.center + se
-0002a480: 6c66 2e6d 616a 6f72 5f64 6972 202a 2073  lf.major_dir * s
-0002a490: 656c 662e 6d61 6a6f 725f 6178 6973 0a20  elf.major_axis. 
-0002a4a0: 2020 2020 2020 2072 6f74 6174 696f 6e65         rotatione
-0002a4b0: 645f 6d61 6a6f 725f 6469 725f 706f 696e  d_major_dir_poin
-0002a4c0: 7420 3d20 706f 696e 745f 6d61 6a6f 725f  t = point_major_
-0002a4d0: 6469 722e 726f 7461 7469 6f6e 2863 656e  dir.rotation(cen
-0002a4e0: 7465 722c 2061 6e67 6c65 290a 2020 2020  ter, angle).    
-0002a4f0: 2020 2020 6d61 6a6f 725f 6469 7220 3d20      major_dir = 
-0002a500: 726f 7461 7469 6f6e 6564 5f6d 616a 6f72  rotationed_major
-0002a510: 5f64 6972 5f70 6f69 6e74 202d 2072 6f74  _dir_point - rot
-0002a520: 6174 696f 6e65 645f 6365 6e74 6572 0a20  ationed_center. 
-0002a530: 2020 2020 2020 2072 6574 7572 6e20 456c         return El
-0002a540: 6c69 7073 6532 4428 7365 6c66 2e6d 616a  lipse2D(self.maj
-0002a550: 6f72 5f61 7869 732c 2073 656c 662e 6d69  or_axis, self.mi
-0002a560: 6e6f 725f 6178 6973 2c20 726f 7461 7469  nor_axis, rotati
-0002a570: 6f6e 6564 5f63 656e 7465 722c 0a20 2020  oned_center,.   
+00029ed0: 2020 2020 2028 7365 6c66 2e6d 696e 6f72       (self.minor
+00029ee0: 5f61 7869 7320 2a2a 2032 2920 2a20 6d61  _axis ** 2) * ma
+00029ef0: 7468 2e63 6f73 2874 6865 7461 2920 2a2a  th.cos(theta) **
+00029f00: 2032 290a 0a20 2020 2020 2020 2020 2020   2)..           
+00029f10: 2072 6573 2c20 5f20 3d20 7363 6970 795f   res, _ = scipy_
+00029f20: 696e 7465 6772 6174 652e 7175 6164 2861  integrate.quad(a
+00029f30: 7263 5f6c 656e 6774 682c 2030 2c20 616e  rc_length, 0, an
+00029f40: 676c 655f 6162 7363 6973 7361 290a 2020  gle_abscissa).  
+00029f50: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00029f60: 2072 6573 0a20 2020 2020 2020 2072 6169   res.        rai
+00029f70: 7365 2056 616c 7565 4572 726f 7228 6627  se ValueError(f'
+00029f80: 706f 696e 7420 7b70 6f69 6e74 7d20 646f  point {point} do
+00029f90: 6573 206e 6f74 2062 656c 6f6e 6720 746f  es not belong to
+00029fa0: 2065 6c6c 6970 7365 2729 0a0a 2020 2020   ellipse')..    
+00029fb0: 6465 6620 706f 696e 745f 616e 676c 655f  def point_angle_
+00029fc0: 7769 7468 5f6d 616a 6f72 5f64 6972 2873  with_major_dir(s
+00029fd0: 656c 662c 2070 6f69 6e74 3264 293a 0a20  elf, point2d):. 
+00029fe0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00029ff0: 2020 2047 6976 656e 2061 2070 6f69 6e74     Given a point
+0002a000: 2069 6e20 7468 6520 656c 6c69 7073 652c   in the ellipse,
+0002a010: 2063 616c 6375 6c61 7465 7320 6974 2061   calculates it a
+0002a020: 6e67 6c65 2077 6974 6820 7468 6520 6d61  ngle with the ma
+0002a030: 6a6f 7220 6469 7265 6374 696f 6e20 7665  jor direction ve
+0002a040: 6374 6f72 2e0a 0a20 2020 2020 2020 2022  ctor...        "
+0002a050: 2222 0a20 2020 2020 2020 2063 656e 7465  "".        cente
+0002a060: 7232 645f 706f 696e 7432 6420 3d20 706f  r2d_point2d = po
+0002a070: 696e 7432 6420 2d20 7365 6c66 2e63 656e  int2d - self.cen
+0002a080: 7465 720a 2020 2020 2020 2020 616e 676c  ter.        angl
+0002a090: 655f 6162 7363 6973 7361 203d 2076 6f6c  e_abscissa = vol
+0002a0a0: 6d64 6c72 2e67 656f 6d65 7472 792e 636c  mdlr.geometry.cl
+0002a0b0: 6f63 6b77 6973 655f 616e 676c 6528 6365  ockwise_angle(ce
+0002a0c0: 6e74 6572 3264 5f70 6f69 6e74 3264 2c20  nter2d_point2d, 
+0002a0d0: 7365 6c66 2e6d 616a 6f72 5f64 6972 290a  self.major_dir).
+0002a0e0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+0002a0f0: 6e67 6c65 5f61 6273 6369 7373 610a 0a20  ngle_abscissa.. 
+0002a100: 2020 2064 6566 2070 6c6f 7428 7365 6c66     def plot(self
+0002a110: 2c20 6178 3d4e 6f6e 652c 2063 6f6c 6f72  , ax=None, color
+0002a120: 3d27 6b27 2c20 616c 7068 613d 312c 2070  ='k', alpha=1, p
+0002a130: 6c6f 745f 706f 696e 7473 3d46 616c 7365  lot_points=False
+0002a140: 2c20 6571 7561 6c5f 6173 7065 6374 3d54  , equal_aspect=T
+0002a150: 7275 6529 3a0a 2020 2020 2020 2020 2222  rue):.        ""
+0002a160: 220a 2020 2020 2020 2020 4d61 7470 6c6f  ".        Matplo
+0002a170: 746c 6962 2070 6c6f 7420 666f 7220 616e  tlib plot for an
+0002a180: 2065 6c6c 6970 7365 2e0a 0a20 2020 2020   ellipse...     
+0002a190: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0002a1a0: 6620 6178 2069 7320 4e6f 6e65 3a0a 2020  f ax is None:.  
+0002a1b0: 2020 2020 2020 2020 2020 5f2c 2061 7820            _, ax 
+0002a1c0: 3d20 706c 742e 7375 6270 6c6f 7473 2829  = plt.subplots()
+0002a1d0: 0a20 2020 2020 2020 2078 203d 205b 5d0a  .        x = [].
+0002a1e0: 2020 2020 2020 2020 7920 3d20 5b5d 0a20          y = []. 
+0002a1f0: 2020 2020 2020 2066 6f72 2070 6f69 6e74         for point
+0002a200: 5f78 2c20 706f 696e 745f 7920 696e 2073  _x, point_y in s
+0002a210: 656c 662e 6469 7363 7265 7469 7a61 7469  elf.discretizati
+0002a220: 6f6e 5f70 6f69 6e74 7328 6e75 6d62 6572  on_points(number
+0002a230: 5f70 6f69 6e74 733d 3530 293a 0a20 2020  _points=50):.   
+0002a240: 2020 2020 2020 2020 2078 2e61 7070 656e           x.appen
+0002a250: 6428 706f 696e 745f 7829 0a20 2020 2020  d(point_x).     
+0002a260: 2020 2020 2020 2079 2e61 7070 656e 6428         y.append(
+0002a270: 706f 696e 745f 7929 0a20 2020 2020 2020  point_y).       
+0002a280: 2070 6c74 2e70 6c6f 7428 782c 2079 2c20   plt.plot(x, y, 
+0002a290: 636f 6c6f 723d 636f 6c6f 722c 2061 6c70  color=color, alp
+0002a2a0: 6861 3d61 6c70 6861 290a 2020 2020 2020  ha=alpha).      
+0002a2b0: 2020 6966 2065 7175 616c 5f61 7370 6563    if equal_aspec
+0002a2c0: 743a 0a20 2020 2020 2020 2020 2020 2061  t:.            a
+0002a2d0: 782e 7365 745f 6173 7065 6374 2827 6571  x.set_aspect('eq
+0002a2e0: 7561 6c27 290a 2020 2020 2020 2020 7265  ual').        re
+0002a2f0: 7475 726e 2061 780a 0a20 2020 2064 6566  turn ax..    def
+0002a300: 2072 6f74 6174 696f 6e28 7365 6c66 2c20   rotation(self, 
+0002a310: 6365 6e74 6572 3a20 766f 6c6d 646c 722e  center: volmdlr.
+0002a320: 506f 696e 7432 442c 2061 6e67 6c65 3a20  Point2D, angle: 
+0002a330: 666c 6f61 7429 3a0a 2020 2020 2020 2020  float):.        
+0002a340: 2222 220a 2020 2020 2020 2020 526f 7461  """.        Rota
+0002a350: 7469 6f6e 206f 6620 656c 6c69 7073 6520  tion of ellipse 
+0002a360: 6172 6f75 6e64 2061 2063 656e 7465 7220  around a center 
+0002a370: 616e 6420 616e 2061 6e67 6c65 2e0a 0a20  and an angle... 
+0002a380: 2020 2020 2020 203a 7061 7261 6d20 6365         :param ce
+0002a390: 6e74 6572 3a20 6365 6e74 6572 206f 6620  nter: center of 
+0002a3a0: 7468 6520 726f 7461 7469 6f6e 2e0a 2020  the rotation..  
+0002a3b0: 2020 2020 2020 3a70 6172 616d 2061 6e67        :param ang
+0002a3c0: 6c65 3a20 616e 676c 6520 746f 2072 6f74  le: angle to rot
+0002a3d0: 6174 6564 206f 662e 0a20 2020 2020 2020  ated of..       
+0002a3e0: 203a 7265 7475 726e 3a20 6120 726f 7461   :return: a rota
+0002a3f0: 7469 6f6e 6564 206e 6577 2065 6c6c 6970  tioned new ellip
+0002a400: 7365 2e0a 2020 2020 2020 2020 2222 220a  se..        """.
+0002a410: 2020 2020 2020 2020 726f 7461 7469 6f6e          rotation
+0002a420: 6564 5f63 656e 7465 7220 3d20 7365 6c66  ed_center = self
+0002a430: 2e63 656e 7465 722e 726f 7461 7469 6f6e  .center.rotation
+0002a440: 2863 656e 7465 722c 2061 6e67 6c65 290a  (center, angle).
+0002a450: 2020 2020 2020 2020 706f 696e 745f 6d61          point_ma
+0002a460: 6a6f 725f 6469 7220 3d20 7365 6c66 2e63  jor_dir = self.c
+0002a470: 656e 7465 7220 2b20 7365 6c66 2e6d 616a  enter + self.maj
+0002a480: 6f72 5f64 6972 202a 2073 656c 662e 6d61  or_dir * self.ma
+0002a490: 6a6f 725f 6178 6973 0a20 2020 2020 2020  jor_axis.       
+0002a4a0: 2072 6f74 6174 696f 6e65 645f 6d61 6a6f   rotationed_majo
+0002a4b0: 725f 6469 725f 706f 696e 7420 3d20 706f  r_dir_point = po
+0002a4c0: 696e 745f 6d61 6a6f 725f 6469 722e 726f  int_major_dir.ro
+0002a4d0: 7461 7469 6f6e 2863 656e 7465 722c 2061  tation(center, a
+0002a4e0: 6e67 6c65 290a 2020 2020 2020 2020 6d61  ngle).        ma
+0002a4f0: 6a6f 725f 6469 7220 3d20 726f 7461 7469  jor_dir = rotati
+0002a500: 6f6e 6564 5f6d 616a 6f72 5f64 6972 5f70  oned_major_dir_p
+0002a510: 6f69 6e74 202d 2072 6f74 6174 696f 6e65  oint - rotatione
+0002a520: 645f 6365 6e74 6572 0a20 2020 2020 2020  d_center.       
+0002a530: 2072 6574 7572 6e20 456c 6c69 7073 6532   return Ellipse2
+0002a540: 4428 7365 6c66 2e6d 616a 6f72 5f61 7869  D(self.major_axi
+0002a550: 732c 2073 656c 662e 6d69 6e6f 725f 6178  s, self.minor_ax
+0002a560: 6973 2c20 726f 7461 7469 6f6e 6564 5f63  is, rotationed_c
+0002a570: 656e 7465 722c 0a20 2020 2020 2020 2020  enter,.         
 0002a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a590: 2020 2020 2020 6d61 6a6f 725f 6469 7229        major_dir)
-0002a5a0: 0a0a 2020 2020 6465 6620 7472 616e 736c  ..    def transl
-0002a5b0: 6174 696f 6e28 7365 6c66 2c20 6f66 6673  ation(self, offs
-0002a5c0: 6574 3a20 766f 6c6d 646c 722e 5665 6374  et: volmdlr.Vect
-0002a5d0: 6f72 3244 293a 0a20 2020 2020 2020 2022  or2D):.        "
-0002a5e0: 2222 0a20 2020 2020 2020 2054 7261 6e73  "".        Trans
-0002a5f0: 6c61 7469 6f6e 206f 6620 656c 6c69 7073  lation of ellips
-0002a600: 6520 6672 6f6d 2061 6e20 6f66 6673 6574  e from an offset
-0002a610: 2076 6563 746f 722e 0a0a 2020 2020 2020   vector...      
-0002a620: 2020 3a70 6172 616d 206f 6666 7365 743a    :param offset:
-0002a630: 2063 6f72 7265 7370 6f6e 6469 6e67 2074   corresponding t
-0002a640: 7261 6e73 6c61 7469 6f6e 2076 6563 746f  ranslation vecto
-0002a650: 722e 0a20 2020 2020 2020 203a 7265 7475  r..        :retu
-0002a660: 726e 3a20 7472 616e 736c 6174 6564 206e  rn: translated n
-0002a670: 6577 2065 6c6c 6970 7365 3264 2e0a 2020  ew ellipse2d..  
-0002a680: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002a690: 2020 7265 7475 726e 2045 6c6c 6970 7365    return Ellipse
-0002a6a0: 3244 2873 656c 662e 6d61 6a6f 725f 6178  2D(self.major_ax
-0002a6b0: 6973 2c20 7365 6c66 2e6d 696e 6f72 5f61  is, self.minor_a
-0002a6c0: 7869 732c 2073 656c 662e 6365 6e74 6572  xis, self.center
-0002a6d0: 2e74 7261 6e73 6c61 7469 6f6e 286f 6666  .translation(off
-0002a6e0: 7365 7429 2c20 7365 6c66 2e6d 616a 6f72  set), self.major
-0002a6f0: 5f64 6972 290a 0a20 2020 2064 6566 2066  _dir)..    def f
-0002a700: 7261 6d65 5f6d 6170 7069 6e67 2873 656c  rame_mapping(sel
-0002a710: 662c 2066 7261 6d65 3a20 766f 6c6d 646c  f, frame: volmdl
-0002a720: 722e 4672 616d 6532 442c 2073 6964 653a  r.Frame2D, side:
-0002a730: 2073 7472 293a 0a20 2020 2020 2020 2022   str):.        "
-0002a740: 2222 0a20 2020 2020 2020 2043 6861 6e67  "".        Chang
-0002a750: 6573 2066 7261 6d65 5f6d 6170 7069 6e67  es frame_mapping
-0002a760: 2061 6e64 2072 6574 7572 6e20 6120 6e65   and return a ne
-0002a770: 7720 456c 6c69 7073 6532 442e 0a20 2020  w Ellipse2D..   
-0002a780: 2020 2020 2073 6964 6520 3d20 276f 6c64       side = 'old
-0002a790: 2720 6f72 2027 6e65 7727 0a20 2020 2020  ' or 'new'.     
-0002a7a0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-0002a7b0: 6620 7369 6465 203d 3d20 276f 6c64 273a  f side == 'old':
-0002a7c0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0002a7d0: 7572 6e20 456c 6c69 7073 6532 4428 7365  urn Ellipse2D(se
-0002a7e0: 6c66 2e6d 616a 6f72 5f61 7869 732c 2073  lf.major_axis, s
-0002a7f0: 656c 662e 6d69 6e6f 725f 6178 6973 2c20  elf.minor_axis, 
-0002a800: 6672 616d 652e 6c6f 6361 6c5f 746f 5f67  frame.local_to_g
-0002a810: 6c6f 6261 6c5f 636f 6f72 6469 6e61 7465  lobal_coordinate
-0002a820: 7328 7365 6c66 2e63 656e 7465 7229 2c0a  s(self.center),.
+0002a590: 6d61 6a6f 725f 6469 7229 0a0a 2020 2020  major_dir)..    
+0002a5a0: 6465 6620 7472 616e 736c 6174 696f 6e28  def translation(
+0002a5b0: 7365 6c66 2c20 6f66 6673 6574 3a20 766f  self, offset: vo
+0002a5c0: 6c6d 646c 722e 5665 6374 6f72 3244 293a  lmdlr.Vector2D):
+0002a5d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002a5e0: 2020 2020 2054 7261 6e73 6c61 7469 6f6e       Translation
+0002a5f0: 206f 6620 656c 6c69 7073 6520 6672 6f6d   of ellipse from
+0002a600: 2061 6e20 6f66 6673 6574 2076 6563 746f   an offset vecto
+0002a610: 722e 0a0a 2020 2020 2020 2020 3a70 6172  r...        :par
+0002a620: 616d 206f 6666 7365 743a 2063 6f72 7265  am offset: corre
+0002a630: 7370 6f6e 6469 6e67 2074 7261 6e73 6c61  sponding transla
+0002a640: 7469 6f6e 2076 6563 746f 722e 0a20 2020  tion vector..   
+0002a650: 2020 2020 203a 7265 7475 726e 3a20 7472       :return: tr
+0002a660: 616e 736c 6174 6564 206e 6577 2065 6c6c  anslated new ell
+0002a670: 6970 7365 3264 2e0a 2020 2020 2020 2020  ipse2d..        
+0002a680: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0002a690: 726e 2045 6c6c 6970 7365 3244 2873 656c  rn Ellipse2D(sel
+0002a6a0: 662e 6d61 6a6f 725f 6178 6973 2c20 7365  f.major_axis, se
+0002a6b0: 6c66 2e6d 696e 6f72 5f61 7869 732c 2073  lf.minor_axis, s
+0002a6c0: 656c 662e 6365 6e74 6572 2e74 7261 6e73  elf.center.trans
+0002a6d0: 6c61 7469 6f6e 286f 6666 7365 7429 2c20  lation(offset), 
+0002a6e0: 7365 6c66 2e6d 616a 6f72 5f64 6972 290a  self.major_dir).
+0002a6f0: 0a20 2020 2064 6566 2066 7261 6d65 5f6d  .    def frame_m
+0002a700: 6170 7069 6e67 2873 656c 662c 2066 7261  apping(self, fra
+0002a710: 6d65 3a20 766f 6c6d 646c 722e 4672 616d  me: volmdlr.Fram
+0002a720: 6532 442c 2073 6964 653a 2073 7472 293a  e2D, side: str):
+0002a730: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002a740: 2020 2020 2043 6861 6e67 6573 2066 7261       Changes fra
+0002a750: 6d65 5f6d 6170 7069 6e67 2061 6e64 2072  me_mapping and r
+0002a760: 6574 7572 6e20 6120 6e65 7720 456c 6c69  eturn a new Elli
+0002a770: 7073 6532 442e 0a20 2020 2020 2020 2073  pse2D..        s
+0002a780: 6964 6520 3d20 276f 6c64 2720 6f72 2027  ide = 'old' or '
+0002a790: 6e65 7727 0a20 2020 2020 2020 2022 2222  new'.        """
+0002a7a0: 0a20 2020 2020 2020 2069 6620 7369 6465  .        if side
+0002a7b0: 203d 3d20 276f 6c64 273a 0a20 2020 2020   == 'old':.     
+0002a7c0: 2020 2020 2020 2072 6574 7572 6e20 456c         return El
+0002a7d0: 6c69 7073 6532 4428 7365 6c66 2e6d 616a  lipse2D(self.maj
+0002a7e0: 6f72 5f61 7869 732c 2073 656c 662e 6d69  or_axis, self.mi
+0002a7f0: 6e6f 725f 6178 6973 2c20 6672 616d 652e  nor_axis, frame.
+0002a800: 6c6f 6361 6c5f 746f 5f67 6c6f 6261 6c5f  local_to_global_
+0002a810: 636f 6f72 6469 6e61 7465 7328 7365 6c66  coordinates(self
+0002a820: 2e63 656e 7465 7229 2c0a 2020 2020 2020  .center),.      
 0002a830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a840: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0002a850: 662e 6d61 6a6f 725f 6469 7229 0a20 2020  f.major_dir).   
-0002a860: 2020 2020 2069 6620 7369 6465 203d 3d20       if side == 
-0002a870: 276e 6577 273a 0a20 2020 2020 2020 2020  'new':.         
-0002a880: 2020 2070 6f69 6e74 5f6d 616a 6f72 5f64     point_major_d
-0002a890: 6972 203d 2073 656c 662e 6365 6e74 6572  ir = self.center
-0002a8a0: 202b 2073 656c 662e 6d61 6a6f 725f 6469   + self.major_di
-0002a8b0: 7220 2a20 7365 6c66 2e6d 616a 6f72 5f61  r * self.major_a
-0002a8c0: 7869 730a 2020 2020 2020 2020 2020 2020  xis.            
-0002a8d0: 6d61 6a6f 725f 6469 7220 3d20 6672 616d  major_dir = fram
-0002a8e0: 652e 676c 6f62 616c 5f74 6f5f 6c6f 6361  e.global_to_loca
-0002a8f0: 6c5f 636f 6f72 6469 6e61 7465 7328 706f  l_coordinates(po
-0002a900: 696e 745f 6d61 6a6f 725f 6469 7229 202d  int_major_dir) -
-0002a910: 2073 656c 662e 6365 6e74 6572 0a20 2020   self.center.   
-0002a920: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0002a930: 456c 6c69 7073 6532 4428 7365 6c66 2e6d  Ellipse2D(self.m
-0002a940: 616a 6f72 5f61 7869 732c 2073 656c 662e  ajor_axis, self.
-0002a950: 6d69 6e6f 725f 6178 6973 2c20 6672 616d  minor_axis, fram
-0002a960: 652e 676c 6f62 616c 5f74 6f5f 6c6f 6361  e.global_to_loca
-0002a970: 6c5f 636f 6f72 6469 6e61 7465 7328 7365  l_coordinates(se
-0002a980: 6c66 2e63 656e 7465 7229 2c0a 2020 2020  lf.center),.    
+0002a840: 2020 2020 2020 2073 656c 662e 6d61 6a6f         self.majo
+0002a850: 725f 6469 7229 0a20 2020 2020 2020 2069  r_dir).        i
+0002a860: 6620 7369 6465 203d 3d20 276e 6577 273a  f side == 'new':
+0002a870: 0a20 2020 2020 2020 2020 2020 2070 6f69  .            poi
+0002a880: 6e74 5f6d 616a 6f72 5f64 6972 203d 2073  nt_major_dir = s
+0002a890: 656c 662e 6365 6e74 6572 202b 2073 656c  elf.center + sel
+0002a8a0: 662e 6d61 6a6f 725f 6469 7220 2a20 7365  f.major_dir * se
+0002a8b0: 6c66 2e6d 616a 6f72 5f61 7869 730a 2020  lf.major_axis.  
+0002a8c0: 2020 2020 2020 2020 2020 6d61 6a6f 725f            major_
+0002a8d0: 6469 7220 3d20 6672 616d 652e 676c 6f62  dir = frame.glob
+0002a8e0: 616c 5f74 6f5f 6c6f 6361 6c5f 636f 6f72  al_to_local_coor
+0002a8f0: 6469 6e61 7465 7328 706f 696e 745f 6d61  dinates(point_ma
+0002a900: 6a6f 725f 6469 7229 202d 2073 656c 662e  jor_dir) - self.
+0002a910: 6365 6e74 6572 0a20 2020 2020 2020 2020  center.         
+0002a920: 2020 2072 6574 7572 6e20 456c 6c69 7073     return Ellips
+0002a930: 6532 4428 7365 6c66 2e6d 616a 6f72 5f61  e2D(self.major_a
+0002a940: 7869 732c 2073 656c 662e 6d69 6e6f 725f  xis, self.minor_
+0002a950: 6178 6973 2c20 6672 616d 652e 676c 6f62  axis, frame.glob
+0002a960: 616c 5f74 6f5f 6c6f 6361 6c5f 636f 6f72  al_to_local_coor
+0002a970: 6469 6e61 7465 7328 7365 6c66 2e63 656e  dinates(self.cen
+0002a980: 7465 7229 2c0a 2020 2020 2020 2020 2020  ter),.          
 0002a990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a9a0: 2020 2020 2020 2020 206d 616a 6f72 5f64           major_d
-0002a9b0: 6972 290a 2020 2020 2020 2020 7261 6973  ir).        rais
-0002a9c0: 6520 5661 6c75 6545 7272 6f72 2827 5369  e ValueError('Si
-0002a9d0: 6465 2073 686f 756c 6420 6265 205c 276e  de should be \'n
-0002a9e0: 6577 5c27 205c 276f 6c64 5c27 2729 0a0a  ew\' \'old\'')..
-0002a9f0: 0a63 6c61 7373 2043 6f6e 746f 7572 3344  .class Contour3D
-0002aa00: 2843 6f6e 746f 7572 4d69 7869 6e2c 2057  (ContourMixin, W
-0002aa10: 6972 6533 4429 3a0a 2020 2020 2222 220a  ire3D):.    """.
-0002aa20: 2020 2020 4120 636f 6c6c 6563 7469 6f6e      A collection
-0002aa30: 206f 6620 3344 2070 7269 6d69 7469 7665   of 3D primitive
-0002aa40: 7320 666f 726d 696e 6720 6120 636c 6f73  s forming a clos
-0002aa50: 6564 2077 6972 6533 442e 0a0a 2020 2020  ed wire3D...    
-0002aa60: 2222 220a 2020 2020 5f6e 6f6e 5f73 6572  """.    _non_ser
-0002aa70: 6961 6c69 7a61 626c 655f 6174 7472 6962  ializable_attrib
-0002aa80: 7574 6573 203d 205b 2770 6f69 6e74 7327  utes = ['points'
-0002aa90: 5d0a 2020 2020 5f6e 6f6e 5f65 715f 6174  ].    _non_eq_at
-0002aaa0: 7472 6962 7574 6573 203d 205b 276e 616d  tributes = ['nam
-0002aab0: 6527 5d0a 2020 2020 5f6e 6f6e 5f68 6173  e'].    _non_has
-0002aac0: 685f 6174 7472 6962 7574 6573 203d 205b  h_attributes = [
-0002aad0: 2770 6f69 6e74 7327 2c20 276e 616d 6527  'points', 'name'
-0002aae0: 5d0a 2020 2020 5f67 656e 6572 6963 5f65  ].    _generic_e
-0002aaf0: 7120 3d20 5472 7565 0a0a 2020 2020 6465  q = True..    de
-0002ab00: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-0002ab10: 2070 7269 6d69 7469 7665 733a 204c 6973   primitives: Lis
-0002ab20: 745b 766f 6c6d 646c 722e 636f 7265 2e50  t[volmdlr.core.P
-0002ab30: 7269 6d69 7469 7665 3344 5d2c 0a20 2020  rimitive3D],.   
-0002ab40: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-0002ab50: 6d65 3a20 7374 7220 3d20 2727 293a 0a20  me: str = ''):. 
-0002ab60: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002ab70: 2020 2044 6566 696e 6573 2061 2063 6f6e     Defines a con
-0002ab80: 746f 7572 3344 2066 726f 6d20 6120 636f  tour3D from a co
-0002ab90: 6c6c 6563 7469 6f6e 206f 6620 6564 6765  llection of edge
-0002aba0: 7320 666f 6c6c 6f77 696e 6720 6561 6368  s following each
-0002abb0: 206f 7468 6572 2073 746f 7265 6420 696e   other stored in
-0002abc0: 2070 7269 6d69 7469 7665 7320 6c69 7374   primitives list
-0002abd0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-0002abe0: 2020 2020 2020 2057 6972 6533 442e 5f5f         Wire3D.__
-0002abf0: 696e 6974 5f5f 2873 656c 662c 2070 7269  init__(self, pri
-0002ac00: 6d69 7469 7665 733d 7072 696d 6974 6976  mitives=primitiv
-0002ac10: 6573 2c20 6e61 6d65 3d6e 616d 6529 0a20  es, name=name). 
-0002ac20: 2020 2020 2020 2073 656c 662e 5f65 6467         self._edg
-0002ac30: 655f 706f 6c79 676f 6e20 3d20 4e6f 6e65  e_polygon = None
-0002ac40: 0a20 2020 2020 2020 2073 656c 662e 5f75  .        self._u
-0002ac50: 7464 5f62 6f75 6e64 696e 675f 626f 7820  td_bounding_box 
-0002ac60: 3d20 4661 6c73 650a 0a20 2020 2064 6566  = False..    def
-0002ac70: 205f 5f65 715f 5f28 7365 6c66 2c20 6f74   __eq__(self, ot
-0002ac80: 6865 725f 293a 0a20 2020 2020 2020 2069  her_):.        i
-0002ac90: 6620 6f74 6865 725f 2e5f 5f63 6c61 7373  f other_.__class
-0002aca0: 5f5f 2e5f 5f6e 616d 655f 5f20 213d 2073  __.__name__ != s
-0002acb0: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
-0002acc0: 6e61 6d65 5f5f 3a0a 2020 2020 2020 2020  name__:.        
-0002acd0: 2020 2020 7265 7475 726e 2046 616c 7365      return False
-0002ace0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-0002acf0: 7365 6c66 2e70 7269 6d69 7469 7665 7329  self.primitives)
-0002ad00: 2021 3d20 6c65 6e28 6f74 6865 725f 2e70   != len(other_.p
-0002ad10: 7269 6d69 7469 7665 7329 3a0a 2020 2020  rimitives):.    
-0002ad20: 2020 2020 2020 2020 7265 7475 726e 2046          return F
-0002ad30: 616c 7365 0a20 2020 2020 2020 2065 7175  alse.        equ
-0002ad40: 616c 203d 2030 0a20 2020 2020 2020 2066  al = 0.        f
-0002ad50: 6f72 2070 7269 6d31 2069 6e20 7365 6c66  or prim1 in self
-0002ad60: 2e70 7269 6d69 7469 7665 733a 0a20 2020  .primitives:.   
-0002ad70: 2020 2020 2020 2020 2072 6576 6572 7365           reverse
-0002ad80: 3120 3d20 7072 696d 312e 7265 7665 7273  1 = prim1.revers
-0002ad90: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-0002ada0: 666f 756e 6420 3d20 4661 6c73 650a 2020  found = False.  
-0002adb0: 2020 2020 2020 2020 2020 666f 7220 7072            for pr
-0002adc0: 696d 3220 696e 206f 7468 6572 5f2e 7072  im2 in other_.pr
-0002add0: 696d 6974 6976 6573 3a0a 2020 2020 2020  imitives:.      
-0002ade0: 2020 2020 2020 2020 2020 7265 7665 7273            revers
-0002adf0: 6532 203d 2070 7269 6d32 2e72 6576 6572  e2 = prim2.rever
-0002ae00: 7365 2829 0a20 2020 2020 2020 2020 2020  se().           
-0002ae10: 2020 2020 2069 6620 2870 7269 6d31 203d       if (prim1 =
-0002ae20: 3d20 7072 696d 3220 6f72 2072 6576 6572  = prim2 or rever
-0002ae30: 7365 3120 3d3d 2070 7269 6d32 0a20 2020  se1 == prim2.   
-0002ae40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ae50: 2020 2020 206f 7220 7265 7665 7273 6532       or reverse2
-0002ae60: 203d 3d20 7072 696d 3120 6f72 2072 6576   == prim1 or rev
-0002ae70: 6572 7365 3120 3d3d 2072 6576 6572 7365  erse1 == reverse
-0002ae80: 3229 3a0a 2020 2020 2020 2020 2020 2020  2):.            
-0002ae90: 2020 2020 2020 2020 6571 7561 6c20 2b3d          equal +=
-0002aea0: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
-0002aeb0: 2020 2020 2020 2066 6f75 6e64 203d 2054         found = T
-0002aec0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-0002aed0: 6966 206e 6f74 2066 6f75 6e64 3a0a 2020  if not found:.  
-0002aee0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0002aef0: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
-0002af00: 2020 2069 6620 6571 7561 6c20 3d3d 206c     if equal == l
-0002af10: 656e 2873 656c 662e 7072 696d 6974 6976  en(self.primitiv
-0002af20: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
-0002af30: 2072 6574 7572 6e20 5472 7565 0a20 2020   return True.   
-0002af40: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
-0002af50: 650a 0a20 2020 2040 7072 6f70 6572 7479  e..    @property
-0002af60: 0a20 2020 2064 6566 2065 6467 655f 706f  .    def edge_po
-0002af70: 6c79 676f 6e28 7365 6c66 293a 0a20 2020  lygon(self):.   
-0002af80: 2020 2020 2069 6620 7365 6c66 2e5f 6564       if self._ed
-0002af90: 6765 5f70 6f6c 7967 6f6e 2069 7320 4e6f  ge_polygon is No
-0002afa0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0002afb0: 7365 6c66 2e5f 6564 6765 5f70 6f6c 7967  self._edge_polyg
-0002afc0: 6f6e 203d 2073 656c 662e 5f67 6574 5f65  on = self._get_e
-0002afd0: 6467 655f 706f 6c79 676f 6e28 290a 2020  dge_polygon().  
-0002afe0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0002aff0: 662e 5f65 6467 655f 706f 6c79 676f 6e0a  f._edge_polygon.
-0002b000: 0a20 2020 2064 6566 205f 6765 745f 6564  .    def _get_ed
-0002b010: 6765 5f70 6f6c 7967 6f6e 2873 656c 6629  ge_polygon(self)
-0002b020: 3a0a 2020 2020 2020 2020 706f 696e 7473  :.        points
-0002b030: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-0002b040: 7220 6564 6765 2069 6e20 7365 6c66 2e70  r edge in self.p
-0002b050: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
-0002b060: 2020 2020 2020 2069 6620 706f 696e 7473         if points
-0002b070: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002b080: 2020 6966 2065 6467 652e 7374 6172 7420    if edge.start 
-0002b090: 213d 2070 6f69 6e74 735b 2d31 5d3a 0a20  != points[-1]:. 
-0002b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b0b0: 2020 2070 6f69 6e74 732e 6170 7065 6e64     points.append
-0002b0c0: 2865 6467 652e 7374 6172 7429 0a20 2020  (edge.start).   
-0002b0d0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0002b0e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002b0f0: 6f69 6e74 732e 6170 7065 6e64 2865 6467  oints.append(edg
-0002b100: 652e 7374 6172 7429 0a20 2020 2020 2020  e.start).       
-0002b110: 2072 6574 7572 6e20 436c 6f73 6564 506f   return ClosedPo
-0002b120: 6c79 676f 6e33 4428 706f 696e 7473 290a  lygon3D(points).
-0002b130: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-0002b140: 640a 2020 2020 6465 6620 6672 6f6d 5f73  d.    def from_s
-0002b150: 7465 7028 636c 732c 2061 7267 756d 656e  tep(cls, argumen
-0002b160: 7473 2c20 6f62 6a65 6374 5f64 6963 7429  ts, object_dict)
-0002b170: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0002b180: 2020 2020 2020 436f 6e76 6572 7473 2061        Converts a
-0002b190: 2073 7465 7020 7072 696d 6974 6976 6520   step primitive 
-0002b1a0: 746f 2061 2043 6f6e 746f 7572 3344 2e0a  to a Contour3D..
-0002b1b0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0002b1c0: 6172 6775 6d65 6e74 733a 2054 6865 2061  arguments: The a
-0002b1d0: 7267 756d 656e 7473 206f 6620 7468 6520  rguments of the 
-0002b1e0: 7374 6570 2070 7269 6d69 7469 7665 2e20  step primitive. 
-0002b1f0: 5468 6520 6c61 7374 2065 6c65 6d65 6e74  The last element
-0002b200: 2072 6570 7265 7365 6e74 7320 7468 6520   represents the 
-0002b210: 756e 6974 5f63 6f6e 7665 7273 696f 6e5f  unit_conversion_
-0002b220: 6661 6374 6f72 2e0a 2020 2020 2020 2020  factor..        
-0002b230: 3a74 7970 6520 6172 6775 6d65 6e74 733a  :type arguments:
-0002b240: 206c 6973 740a 2020 2020 2020 2020 3a70   list.        :p
-0002b250: 6172 616d 206f 626a 6563 745f 6469 6374  aram object_dict
-0002b260: 3a20 5468 6520 6469 6374 696f 6e61 7279  : The dictionary
-0002b270: 2063 6f6e 7461 696e 696e 6720 616c 6c20   containing all 
-0002b280: 7468 6520 7374 6570 2070 7269 6d69 7469  the step primiti
-0002b290: 7665 7320 7468 6174 2068 6176 6520 616c  ves that have al
-0002b2a0: 7265 6164 7920 6265 656e 2069 6e73 7461  ready been insta
-0002b2b0: 6e74 6961 7465 642e 0a20 2020 2020 2020  ntiated..       
-0002b2c0: 203a 7479 7065 206f 626a 6563 745f 6469   :type object_di
-0002b2d0: 6374 3a20 6469 6374 0a20 2020 2020 2020  ct: dict.       
-0002b2e0: 203a 7265 7475 726e 3a20 5468 6520 636f   :return: The co
-0002b2f0: 7272 6573 706f 6e64 696e 6720 436f 6e74  rresponding Cont
-0002b300: 6f75 7233 4420 6f62 6a65 6374 2e0a 2020  our3D object..  
-0002b310: 2020 2020 2020 3a72 7479 7065 3a20 3a63        :rtype: :c
-0002b320: 6c61 7373 3a60 766f 6c6d 646c 722e 7769  lass:`volmdlr.wi
-0002b330: 7265 732e 436f 6e74 6f75 7233 4460 0a20  res.Contour3D`. 
-0002b340: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002b350: 2020 206e 616d 6520 3d20 6172 6775 6d65     name = argume
-0002b360: 6e74 735b 305d 5b31 3a2d 315d 0a20 2020  nts[0][1:-1].   
-0002b370: 2020 2020 2072 6177 5f65 6467 6573 203d       raw_edges =
-0002b380: 205b 5d0a 2020 2020 2020 2020 2320 6564   [].        # ed
-0002b390: 6765 5f65 6e64 7320 3d20 7b7d 0a20 2020  ge_ends = {}.   
-0002b3a0: 2020 2020 2066 6f72 2065 6467 655f 6964       for edge_id
-0002b3b0: 2069 6e20 6172 6775 6d65 6e74 735b 315d   in arguments[1]
-0002b3c0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0002b3d0: 775f 6564 6765 732e 6170 7065 6e64 286f  w_edges.append(o
-0002b3e0: 626a 6563 745f 6469 6374 5b69 6e74 2865  bject_dict[int(e
-0002b3f0: 6467 655f 6964 5b31 3a5d 295d 290a 0a20  dge_id[1:])]).. 
-0002b400: 2020 2020 2020 2069 6620 286c 656e 2872         if (len(r
-0002b410: 6177 5f65 6467 6573 2929 203d 3d20 313a  aw_edges)) == 1:
-0002b420: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0002b430: 6973 696e 7374 616e 6365 2872 6177 5f65  isinstance(raw_e
-0002b440: 6467 6573 5b30 5d2c 2063 6c73 293a 0a20  dges[0], cls):. 
-0002b450: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0002b460: 2043 6173 6520 6f66 2061 2063 6972 636c   Case of a circl
-0002b470: 652c 2065 6c6c 6970 7365 2e2e 2e0a 2020  e, ellipse....  
-0002b480: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0002b490: 7475 726e 2072 6177 5f65 6467 6573 5b30  turn raw_edges[0
-0002b4a0: 5d0a 2020 2020 2020 2020 2020 2020 7265  ].            re
-0002b4b0: 7475 726e 2063 6c73 2872 6177 5f65 6467  turn cls(raw_edg
-0002b4c0: 6573 2c20 6e61 6d65 3d6e 616d 6529 0a0a  es, name=name)..
-0002b4d0: 2020 2020 2020 2020 2320 4d61 6b69 6e67          # Making
-0002b4e0: 2074 6869 6e67 7320 7269 6768 7420 666f   things right fo
-0002b4f0: 7220 6669 7273 7420 3220 7072 696d 6974  r first 2 primit
-0002b500: 6976 6573 0a20 2020 2020 2020 2069 6620  ives.        if 
-0002b510: 616e 7928 6564 6765 2069 7320 4e6f 6e65  any(edge is None
-0002b520: 2066 6f72 2065 6467 6520 696e 2072 6177   for edge in raw
-0002b530: 5f65 6467 6573 293a 0a20 2020 2020 2020  _edges):.       
-0002b540: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0002b550: 4572 726f 720a 2020 2020 2020 2020 6469  Error.        di
-0002b560: 7374 616e 6365 7320 3d20 5b72 6177 5f65  stances = [raw_e
-0002b570: 6467 6573 5b30 5d2e 656e 642e 706f 696e  dges[0].end.poin
-0002b580: 745f 6469 7374 616e 6365 2872 6177 5f65  t_distance(raw_e
-0002b590: 6467 6573 5b31 5d2e 7374 6172 7429 2c0a  dges[1].start),.
-0002b5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b5b0: 2020 2020 2072 6177 5f65 6467 6573 5b30       raw_edges[0
-0002b5c0: 5d2e 7374 6172 742e 706f 696e 745f 6469  ].start.point_di
-0002b5d0: 7374 616e 6365 2872 6177 5f65 6467 6573  stance(raw_edges
-0002b5e0: 5b31 5d2e 7374 6172 7429 2c0a 2020 2020  [1].start),.    
-0002b5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b600: 2072 6177 5f65 6467 6573 5b30 5d2e 656e   raw_edges[0].en
-0002b610: 642e 706f 696e 745f 6469 7374 616e 6365  d.point_distance
-0002b620: 2872 6177 5f65 6467 6573 5b31 5d2e 656e  (raw_edges[1].en
-0002b630: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
-0002b640: 2020 2020 2020 2020 2072 6177 5f65 6467           raw_edg
-0002b650: 6573 5b30 5d2e 7374 6172 742e 706f 696e  es[0].start.poin
-0002b660: 745f 6469 7374 616e 6365 2872 6177 5f65  t_distance(raw_e
-0002b670: 6467 6573 5b31 5d2e 656e 6429 5d0a 2020  dges[1].end)].  
-0002b680: 2020 2020 2020 696e 6465 7820 3d20 6469        index = di
-0002b690: 7374 616e 6365 732e 696e 6465 7828 6d69  stances.index(mi
-0002b6a0: 6e28 6469 7374 616e 6365 7329 290a 2020  n(distances)).  
-0002b6b0: 2020 2020 2020 6966 206d 696e 2864 6973        if min(dis
-0002b6c0: 7461 6e63 6573 2920 3e20 3665 2d34 3a0a  tances) > 6e-4:.
-0002b6d0: 2020 2020 2020 2020 2020 2020 2320 4772              # Gr
-0002b6e0: 6565 6e20 636f 6c6f 7220 3a20 7765 6c6c  een color : well
-0002b6f0: 2d70 6c61 6365 6420 616e 6420 7765 6c6c  -placed and well
-0002b700: 2d72 6561 640a 2020 2020 2020 2020 2020  -read.          
-0002b710: 2020 6178 203d 2072 6177 5f65 6467 6573    ax = raw_edges
-0002b720: 5b30 5d2e 706c 6f74 2863 6f6c 6f72 3d27  [0].plot(color='
-0002b730: 6727 290a 2020 2020 2020 2020 2020 2020  g').            
-0002b740: 2320 5265 6420 636f 6c6f 7220 3a20 6361  # Red color : ca
-0002b750: 6e27 7420 6265 2063 6f6e 6e65 6374 6564  n't be connected
-0002b760: 2074 6f20 6772 6565 6e20 6564 6765 0a20   to green edge. 
-0002b770: 2020 2020 2020 2020 2020 2072 6177 5f65             raw_e
-0002b780: 6467 6573 5b31 5d2e 706c 6f74 2861 783d  dges[1].plot(ax=
-0002b790: 6178 2c20 636f 6c6f 723d 2772 2729 0a20  ax, color='r'). 
-0002b7a0: 2020 2020 2020 2020 2020 2023 2042 6c61             # Bla
-0002b7b0: 636b 2063 6f6c 6f72 203a 2074 6f20 6265  ck color : to be
-0002b7c0: 2070 6c61 6365 640a 2020 2020 2020 2020   placed.        
-0002b7d0: 2020 2020 666f 7220 7265 2069 6e20 7261      for re in ra
-0002b7e0: 775f 6564 6765 735b 323a 5d3a 0a20 2020  w_edges[2:]:.   
-0002b7f0: 2020 2020 2020 2020 2020 2020 2072 652e               re.
-0002b800: 706c 6f74 2861 783d 6178 290a 2020 2020  plot(ax=ax).    
-0002b810: 2020 2020 2020 2020 2320 6465 6c74 6178          # deltax
-0002b820: 3120 3d20 6162 7328 7261 775f 6564 6765  1 = abs(raw_edge
-0002b830: 735b 305d 2e73 7461 7274 2e78 202d 2072  s[0].start.x - r
-0002b840: 6177 5f65 6467 6573 5b31 5d2e 656e 642e  aw_edges[1].end.
-0002b850: 7829 0a20 2020 2020 2020 2020 2020 2023  x).            #
-0002b860: 2064 656c 7461 7832 203d 2061 6273 2872   deltax2 = abs(r
-0002b870: 6177 5f65 6467 6573 5b30 5d2e 656e 642e  aw_edges[0].end.
-0002b880: 7820 2d20 7261 775f 6564 6765 735b 315d  x - raw_edges[1]
-0002b890: 2e65 6e64 2e78 290a 2020 2020 2020 2020  .end.x).        
-0002b8a0: 2020 2020 2320 6465 6c74 6179 3120 3d20      # deltay1 = 
-0002b8b0: 6162 7328 7261 775f 6564 6765 735b 305d  abs(raw_edges[0]
-0002b8c0: 2e73 7461 7274 2e79 202d 2072 6177 5f65  .start.y - raw_e
-0002b8d0: 6467 6573 5b31 5d2e 656e 642e 7929 0a20  dges[1].end.y). 
-0002b8e0: 2020 2020 2020 2020 2020 2023 2064 656c             # del
-0002b8f0: 7461 7932 203d 2061 6273 2872 6177 5f65  tay2 = abs(raw_e
-0002b900: 6467 6573 5b30 5d2e 656e 642e 7920 2d20  dges[0].end.y - 
-0002b910: 7261 775f 6564 6765 735b 315d 2e65 6e64  raw_edges[1].end
-0002b920: 2e79 290a 2020 2020 2020 2020 2020 2020  .y).            
-0002b930: 2320 6465 6c74 617a 3120 3d20 6162 7328  # deltaz1 = abs(
-0002b940: 7261 775f 6564 6765 735b 305d 2e73 7461  raw_edges[0].sta
-0002b950: 7274 2e7a 202d 2072 6177 5f65 6467 6573  rt.z - raw_edges
-0002b960: 5b31 5d2e 656e 642e 7a29 0a20 2020 2020  [1].end.z).     
-0002b970: 2020 2020 2020 2023 2064 656c 7461 7a32         # deltaz2
-0002b980: 203d 2061 6273 2872 6177 5f65 6467 6573   = abs(raw_edges
-0002b990: 5b30 5d2e 656e 642e 7a20 2d20 7261 775f  [0].end.z - raw_
-0002b9a0: 6564 6765 735b 315d 2e65 6e64 2e7a 290a  edges[1].end.z).
-0002b9b0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0002b9c0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-0002b9d0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0002b9e0: 2020 2020 2020 2066 274e 756d 6265 7220         f'Number 
-0002b9f0: 6f66 2065 6467 6573 3a20 7b6c 656e 2872  of edges: {len(r
-0002ba00: 6177 5f65 6467 6573 297d 272c 0a20 2020  aw_edges)}',.   
-0002ba10: 2020 2020 2020 2020 2020 2020 2027 4669               'Fi
-0002ba20: 7273 7420 3220 6564 6765 7320 6f66 2063  rst 2 edges of c
-0002ba30: 6f6e 746f 7572 206e 6f74 2066 6f6c 6c6f  ontour not follo
-0002ba40: 7769 6e67 2065 6163 6820 6f74 6865 7227  wing each other'
-0002ba50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002ba60: 2020 6627 6465 6c74 615f 7820 3d20 7b61    f'delta_x = {a
-0002ba70: 6273 2872 6177 5f65 6467 6573 5b30 5d2e  bs(raw_edges[0].
-0002ba80: 7374 6172 742e 7820 2d20 7261 775f 6564  start.x - raw_ed
-0002ba90: 6765 735b 315d 2e65 6e64 2e78 297d 2c27  ges[1].end.x)},'
-0002baa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002bab0: 2066 2720 7b61 6273 2872 6177 5f65 6467   f' {abs(raw_edg
-0002bac0: 6573 5b30 5d2e 656e 642e 7820 2d20 7261  es[0].end.x - ra
-0002bad0: 775f 6564 6765 735b 315d 2e65 6e64 2e78  w_edges[1].end.x
-0002bae0: 297d 272c 0a20 2020 2020 2020 2020 2020  )}',.           
-0002baf0: 2020 2020 2066 2764 656c 7461 5f79 203d       f'delta_y =
-0002bb00: 207b 6162 7328 7261 775f 6564 6765 735b   {abs(raw_edges[
-0002bb10: 305d 2e73 7461 7274 2e79 202d 2072 6177  0].start.y - raw
-0002bb20: 5f65 6467 6573 5b31 5d2e 656e 642e 7929  _edges[1].end.y)
-0002bb30: 7d2c 270a 2020 2020 2020 2020 2020 2020  },'.            
-0002bb40: 2020 2020 6627 207b 6162 7328 7261 775f      f' {abs(raw_
-0002bb50: 6564 6765 735b 305d 2e65 6e64 2e79 202d  edges[0].end.y -
-0002bb60: 2072 6177 5f65 6467 6573 5b31 5d2e 656e   raw_edges[1].en
-0002bb70: 642e 7929 7d27 2c0a 2020 2020 2020 2020  d.y)}',.        
-0002bb80: 2020 2020 2020 2020 6627 6465 6c74 615f          f'delta_
-0002bb90: 7a20 3d20 7b61 6273 2872 6177 5f65 6467  z = {abs(raw_edg
-0002bba0: 6573 5b30 5d2e 7374 6172 742e 7a20 2d20  es[0].start.z - 
-0002bbb0: 7261 775f 6564 6765 735b 315d 2e65 6e64  raw_edges[1].end
-0002bbc0: 2e7a 297d 2c27 0a20 2020 2020 2020 2020  .z)},'.         
-0002bbd0: 2020 2020 2020 2066 2720 7b61 6273 2872         f' {abs(r
-0002bbe0: 6177 5f65 6467 6573 5b30 5d2e 656e 642e  aw_edges[0].end.
-0002bbf0: 7a20 2d20 7261 775f 6564 6765 735b 315d  z - raw_edges[1]
-0002bc00: 2e65 6e64 2e7a 297d 272c 0a20 2020 2020  .end.z)}',.     
-0002bc10: 2020 2020 2020 2020 2020 2066 2764 6973             f'dis
-0002bc20: 7461 6e63 6520 3d20 7b6d 696e 2864 6973  tance = {min(dis
-0002bc30: 7461 6e63 6573 297d 2729 0a0a 2020 2020  tances)}')..    
-0002bc40: 2020 2020 6966 2069 6e64 6578 203d 3d20      if index == 
-0002bc50: 303a 0a20 2020 2020 2020 2020 2020 2065  0:.            e
-0002bc60: 6467 6573 203d 205b 7261 775f 6564 6765  dges = [raw_edge
-0002bc70: 735b 305d 2c20 7261 775f 6564 6765 735b  s[0], raw_edges[
-0002bc80: 315d 5d0a 2020 2020 2020 2020 656c 6966  1]].        elif
-0002bc90: 2069 6e64 6578 203d 3d20 313a 0a20 2020   index == 1:.   
-0002bca0: 2020 2020 2020 2020 2065 6467 6573 203d           edges =
-0002bcb0: 205b 7261 775f 6564 6765 735b 305d 2e72   [raw_edges[0].r
-0002bcc0: 6576 6572 7365 2829 2c20 7261 775f 6564  everse(), raw_ed
-0002bcd0: 6765 735b 315d 5d0a 2020 2020 2020 2020  ges[1]].        
-0002bce0: 656c 6966 2069 6e64 6578 203d 3d20 323a  elif index == 2:
-0002bcf0: 0a20 2020 2020 2020 2020 2020 2065 6467  .            edg
-0002bd00: 6573 203d 205b 7261 775f 6564 6765 735b  es = [raw_edges[
-0002bd10: 305d 2c20 7261 775f 6564 6765 735b 315d  0], raw_edges[1]
-0002bd20: 2e72 6576 6572 7365 2829 5d0a 2020 2020  .reverse()].    
-0002bd30: 2020 2020 656c 6966 2069 6e64 6578 203d      elif index =
-0002bd40: 3d20 333a 0a20 2020 2020 2020 2020 2020  = 3:.           
-0002bd50: 2065 6467 6573 203d 205b 7261 775f 6564   edges = [raw_ed
-0002bd60: 6765 735b 305d 2e72 6576 6572 7365 2829  ges[0].reverse()
-0002bd70: 2c20 7261 775f 6564 6765 735b 315d 2e72  , raw_edges[1].r
-0002bd80: 6576 6572 7365 2829 5d0a 2020 2020 2020  everse()].      
-0002bd90: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0002bda0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-0002bdb0: 6c65 6d65 6e74 6564 4572 726f 720a 0a20  lementedError.. 
-0002bdc0: 2020 2020 2020 2023 2043 6f6e 6e65 6374         # Connect
-0002bdd0: 696e 6720 7468 6520 6e65 7874 2065 6467  ing the next edg
-0002bde0: 6573 0a20 2020 2020 2020 206c 6173 745f  es.        last_
-0002bdf0: 6564 6765 203d 2065 6467 6573 5b2d 315d  edge = edges[-1]
-0002be00: 0a20 2020 2020 2020 2066 6f72 2069 2c20  .        for i, 
-0002be10: 7261 775f 6564 6765 2069 6e20 656e 756d  raw_edge in enum
-0002be20: 6572 6174 6528 7261 775f 6564 6765 735b  erate(raw_edges[
-0002be30: 323a 5d29 3a0a 2020 2020 2020 2020 2020  2:]):.          
-0002be40: 2020 6469 7374 616e 6365 7320 3d20 5b72    distances = [r
-0002be50: 6177 5f65 6467 652e 7374 6172 742e 706f  aw_edge.start.po
-0002be60: 696e 745f 6469 7374 616e 6365 286c 6173  int_distance(las
-0002be70: 745f 6564 6765 2e65 6e64 292c 0a20 2020  t_edge.end),.   
+0002a9a0: 2020 206d 616a 6f72 5f64 6972 290a 2020     major_dir).  
+0002a9b0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0002a9c0: 6545 7272 6f72 2827 5369 6465 2073 686f  eError('Side sho
+0002a9d0: 756c 6420 6265 205c 276e 6577 5c27 205c  uld be \'new\' \
+0002a9e0: 276f 6c64 5c27 2729 0a0a 0a63 6c61 7373  'old\'')...class
+0002a9f0: 2043 6f6e 746f 7572 3344 2843 6f6e 746f   Contour3D(Conto
+0002aa00: 7572 4d69 7869 6e2c 2057 6972 6533 4429  urMixin, Wire3D)
+0002aa10: 3a0a 2020 2020 2222 220a 2020 2020 4120  :.    """.    A 
+0002aa20: 636f 6c6c 6563 7469 6f6e 206f 6620 3344  collection of 3D
+0002aa30: 2070 7269 6d69 7469 7665 7320 666f 726d   primitives form
+0002aa40: 696e 6720 6120 636c 6f73 6564 2077 6972  ing a closed wir
+0002aa50: 6533 442e 0a0a 2020 2020 2222 220a 2020  e3D...    """.  
+0002aa60: 2020 5f6e 6f6e 5f73 6572 6961 6c69 7a61    _non_serializa
+0002aa70: 626c 655f 6174 7472 6962 7574 6573 203d  ble_attributes =
+0002aa80: 205b 2770 6f69 6e74 7327 5d0a 2020 2020   ['points'].    
+0002aa90: 5f6e 6f6e 5f65 715f 6174 7472 6962 7574  _non_eq_attribut
+0002aaa0: 6573 203d 205b 276e 616d 6527 5d0a 2020  es = ['name'].  
+0002aab0: 2020 5f6e 6f6e 5f68 6173 685f 6174 7472    _non_hash_attr
+0002aac0: 6962 7574 6573 203d 205b 2770 6f69 6e74  ibutes = ['point
+0002aad0: 7327 2c20 276e 616d 6527 5d0a 2020 2020  s', 'name'].    
+0002aae0: 5f67 656e 6572 6963 5f65 7120 3d20 5472  _generic_eq = Tr
+0002aaf0: 7565 0a0a 2020 2020 6465 6620 5f5f 696e  ue..    def __in
+0002ab00: 6974 5f5f 2873 656c 662c 2070 7269 6d69  it__(self, primi
+0002ab10: 7469 7665 733a 204c 6973 745b 766f 6c6d  tives: List[volm
+0002ab20: 646c 722e 636f 7265 2e50 7269 6d69 7469  dlr.core.Primiti
+0002ab30: 7665 3344 5d2c 0a20 2020 2020 2020 2020  ve3D],.         
+0002ab40: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+0002ab50: 7220 3d20 2727 293a 0a20 2020 2020 2020  r = ''):.       
+0002ab60: 2022 2222 0a20 2020 2020 2020 2044 6566   """.        Def
+0002ab70: 696e 6573 2061 2063 6f6e 746f 7572 3344  ines a contour3D
+0002ab80: 2066 726f 6d20 6120 636f 6c6c 6563 7469   from a collecti
+0002ab90: 6f6e 206f 6620 6564 6765 7320 666f 6c6c  on of edges foll
+0002aba0: 6f77 696e 6720 6561 6368 206f 7468 6572  owing each other
+0002abb0: 2073 746f 7265 6420 696e 2070 7269 6d69   stored in primi
+0002abc0: 7469 7665 7320 6c69 7374 2e0a 2020 2020  tives list..    
+0002abd0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0002abe0: 2057 6972 6533 442e 5f5f 696e 6974 5f5f   Wire3D.__init__
+0002abf0: 2873 656c 662c 2070 7269 6d69 7469 7665  (self, primitive
+0002ac00: 733d 7072 696d 6974 6976 6573 2c20 6e61  s=primitives, na
+0002ac10: 6d65 3d6e 616d 6529 0a20 2020 2020 2020  me=name).       
+0002ac20: 2073 656c 662e 5f65 6467 655f 706f 6c79   self._edge_poly
+0002ac30: 676f 6e20 3d20 4e6f 6e65 0a20 2020 2020  gon = None.     
+0002ac40: 2020 2073 656c 662e 5f75 7464 5f62 6f75     self._utd_bou
+0002ac50: 6e64 696e 675f 626f 7820 3d20 4661 6c73  nding_box = Fals
+0002ac60: 650a 0a20 2020 2064 6566 205f 5f65 715f  e..    def __eq_
+0002ac70: 5f28 7365 6c66 2c20 6f74 6865 725f 293a  _(self, other_):
+0002ac80: 0a20 2020 2020 2020 2069 6620 6f74 6865  .        if othe
+0002ac90: 725f 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  r_.__class__.__n
+0002aca0: 616d 655f 5f20 213d 2073 656c 662e 5f5f  ame__ != self.__
+0002acb0: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+0002acc0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0002acd0: 7475 726e 2046 616c 7365 0a20 2020 2020  turn False.     
+0002ace0: 2020 2069 6620 6c65 6e28 7365 6c66 2e70     if len(self.p
+0002acf0: 7269 6d69 7469 7665 7329 2021 3d20 6c65  rimitives) != le
+0002ad00: 6e28 6f74 6865 725f 2e70 7269 6d69 7469  n(other_.primiti
+0002ad10: 7665 7329 3a0a 2020 2020 2020 2020 2020  ves):.          
+0002ad20: 2020 7265 7475 726e 2046 616c 7365 0a20    return False. 
+0002ad30: 2020 2020 2020 2065 7175 616c 203d 2030         equal = 0
+0002ad40: 0a20 2020 2020 2020 2066 6f72 2070 7269  .        for pri
+0002ad50: 6d31 2069 6e20 7365 6c66 2e70 7269 6d69  m1 in self.primi
+0002ad60: 7469 7665 733a 0a20 2020 2020 2020 2020  tives:.         
+0002ad70: 2020 2072 6576 6572 7365 3120 3d20 7072     reverse1 = pr
+0002ad80: 696d 312e 7265 7665 7273 6528 290a 2020  im1.reverse().  
+0002ad90: 2020 2020 2020 2020 2020 666f 756e 6420            found 
+0002ada0: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+0002adb0: 2020 2020 666f 7220 7072 696d 3220 696e      for prim2 in
+0002adc0: 206f 7468 6572 5f2e 7072 696d 6974 6976   other_.primitiv
+0002add0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+0002ade0: 2020 2020 7265 7665 7273 6532 203d 2070      reverse2 = p
+0002adf0: 7269 6d32 2e72 6576 6572 7365 2829 0a20  rim2.reverse(). 
+0002ae00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002ae10: 6620 2870 7269 6d31 203d 3d20 7072 696d  f (prim1 == prim
+0002ae20: 3220 6f72 2072 6576 6572 7365 3120 3d3d  2 or reverse1 ==
+0002ae30: 2070 7269 6d32 0a20 2020 2020 2020 2020   prim2.         
+0002ae40: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0002ae50: 7220 7265 7665 7273 6532 203d 3d20 7072  r reverse2 == pr
+0002ae60: 696d 3120 6f72 2072 6576 6572 7365 3120  im1 or reverse1 
+0002ae70: 3d3d 2072 6576 6572 7365 3229 3a0a 2020  == reverse2):.  
+0002ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ae90: 2020 6571 7561 6c20 2b3d 2031 0a20 2020    equal += 1.   
+0002aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aeb0: 2066 6f75 6e64 203d 2054 7275 650a 2020   found = True.  
+0002aec0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0002aed0: 2066 6f75 6e64 3a0a 2020 2020 2020 2020   found:.        
+0002aee0: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+0002aef0: 616c 7365 0a20 2020 2020 2020 2069 6620  alse.        if 
+0002af00: 6571 7561 6c20 3d3d 206c 656e 2873 656c  equal == len(sel
+0002af10: 662e 7072 696d 6974 6976 6573 293a 0a20  f.primitives):. 
+0002af20: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0002af30: 6e20 5472 7565 0a20 2020 2020 2020 2072  n True.        r
+0002af40: 6574 7572 6e20 4661 6c73 650a 0a20 2020  eturn False..   
+0002af50: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0002af60: 6566 2065 6467 655f 706f 6c79 676f 6e28  ef edge_polygon(
+0002af70: 7365 6c66 293a 0a20 2020 2020 2020 2069  self):.        i
+0002af80: 6620 7365 6c66 2e5f 6564 6765 5f70 6f6c  f self._edge_pol
+0002af90: 7967 6f6e 2069 7320 4e6f 6e65 3a0a 2020  ygon is None:.  
+0002afa0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0002afb0: 6564 6765 5f70 6f6c 7967 6f6e 203d 2073  edge_polygon = s
+0002afc0: 656c 662e 5f67 6574 5f65 6467 655f 706f  elf._get_edge_po
+0002afd0: 6c79 676f 6e28 290a 2020 2020 2020 2020  lygon().        
+0002afe0: 7265 7475 726e 2073 656c 662e 5f65 6467  return self._edg
+0002aff0: 655f 706f 6c79 676f 6e0a 0a20 2020 2064  e_polygon..    d
+0002b000: 6566 205f 6765 745f 6564 6765 5f70 6f6c  ef _get_edge_pol
+0002b010: 7967 6f6e 2873 656c 6629 3a0a 2020 2020  ygon(self):.    
+0002b020: 2020 2020 706f 696e 7473 203d 205b 5d0a      points = [].
+0002b030: 2020 2020 2020 2020 666f 7220 6564 6765          for edge
+0002b040: 2069 6e20 7365 6c66 2e70 7269 6d69 7469   in self.primiti
+0002b050: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
+0002b060: 2069 6620 706f 696e 7473 3a0a 2020 2020   if points:.    
+0002b070: 2020 2020 2020 2020 2020 2020 6966 2065              if e
+0002b080: 6467 652e 7374 6172 7420 213d 2070 6f69  dge.start != poi
+0002b090: 6e74 735b 2d31 5d3a 0a20 2020 2020 2020  nts[-1]:.       
+0002b0a0: 2020 2020 2020 2020 2020 2020 2070 6f69               poi
+0002b0b0: 6e74 732e 6170 7065 6e64 2865 6467 652e  nts.append(edge.
+0002b0c0: 7374 6172 7429 0a20 2020 2020 2020 2020  start).         
+0002b0d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002b0e0: 2020 2020 2020 2020 2070 6f69 6e74 732e           points.
+0002b0f0: 6170 7065 6e64 2865 6467 652e 7374 6172  append(edge.star
+0002b100: 7429 0a20 2020 2020 2020 2072 6574 7572  t).        retur
+0002b110: 6e20 436c 6f73 6564 506f 6c79 676f 6e33  n ClosedPolygon3
+0002b120: 4428 706f 696e 7473 290a 0a20 2020 2040  D(points)..    @
+0002b130: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
+0002b140: 6465 6620 6672 6f6d 5f73 7465 7028 636c  def from_step(cl
+0002b150: 732c 2061 7267 756d 656e 7473 2c20 6f62  s, arguments, ob
+0002b160: 6a65 6374 5f64 6963 7429 3a0a 2020 2020  ject_dict):.    
+0002b170: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0002b180: 436f 6e76 6572 7473 2061 2073 7465 7020  Converts a step 
+0002b190: 7072 696d 6974 6976 6520 746f 2061 2043  primitive to a C
+0002b1a0: 6f6e 746f 7572 3344 2e0a 0a20 2020 2020  ontour3D...     
+0002b1b0: 2020 203a 7061 7261 6d20 6172 6775 6d65     :param argume
+0002b1c0: 6e74 733a 2054 6865 2061 7267 756d 656e  nts: The argumen
+0002b1d0: 7473 206f 6620 7468 6520 7374 6570 2070  ts of the step p
+0002b1e0: 7269 6d69 7469 7665 2e20 5468 6520 6c61  rimitive. The la
+0002b1f0: 7374 2065 6c65 6d65 6e74 2072 6570 7265  st element repre
+0002b200: 7365 6e74 7320 7468 6520 756e 6974 5f63  sents the unit_c
+0002b210: 6f6e 7665 7273 696f 6e5f 6661 6374 6f72  onversion_factor
+0002b220: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
+0002b230: 6172 6775 6d65 6e74 733a 206c 6973 740a  arguments: list.
+0002b240: 2020 2020 2020 2020 3a70 6172 616d 206f          :param o
+0002b250: 626a 6563 745f 6469 6374 3a20 5468 6520  bject_dict: The 
+0002b260: 6469 6374 696f 6e61 7279 2063 6f6e 7461  dictionary conta
+0002b270: 696e 696e 6720 616c 6c20 7468 6520 7374  ining all the st
+0002b280: 6570 2070 7269 6d69 7469 7665 7320 7468  ep primitives th
+0002b290: 6174 2068 6176 6520 616c 7265 6164 7920  at have already 
+0002b2a0: 6265 656e 2069 6e73 7461 6e74 6961 7465  been instantiate
+0002b2b0: 642e 0a20 2020 2020 2020 203a 7479 7065  d..        :type
+0002b2c0: 206f 626a 6563 745f 6469 6374 3a20 6469   object_dict: di
+0002b2d0: 6374 0a20 2020 2020 2020 203a 7265 7475  ct.        :retu
+0002b2e0: 726e 3a20 5468 6520 636f 7272 6573 706f  rn: The correspo
+0002b2f0: 6e64 696e 6720 436f 6e74 6f75 7233 4420  nding Contour3D 
+0002b300: 6f62 6a65 6374 2e0a 2020 2020 2020 2020  object..        
+0002b310: 3a72 7479 7065 3a20 3a63 6c61 7373 3a60  :rtype: :class:`
+0002b320: 766f 6c6d 646c 722e 7769 7265 732e 436f  volmdlr.wires.Co
+0002b330: 6e74 6f75 7233 4460 0a20 2020 2020 2020  ntour3D`.       
+0002b340: 2022 2222 0a20 2020 2020 2020 206e 616d   """.        nam
+0002b350: 6520 3d20 6172 6775 6d65 6e74 735b 305d  e = arguments[0]
+0002b360: 5b31 3a2d 315d 0a20 2020 2020 2020 2072  [1:-1].        r
+0002b370: 6177 5f65 6467 6573 203d 205b 5d0a 2020  aw_edges = [].  
+0002b380: 2020 2020 2020 2320 6564 6765 5f65 6e64        # edge_end
+0002b390: 7320 3d20 7b7d 0a20 2020 2020 2020 2066  s = {}.        f
+0002b3a0: 6f72 2065 6467 655f 6964 2069 6e20 6172  or edge_id in ar
+0002b3b0: 6775 6d65 6e74 735b 315d 3a0a 2020 2020  guments[1]:.    
+0002b3c0: 2020 2020 2020 2020 7261 775f 6564 6765          raw_edge
+0002b3d0: 732e 6170 7065 6e64 286f 626a 6563 745f  s.append(object_
+0002b3e0: 6469 6374 5b69 6e74 2865 6467 655f 6964  dict[int(edge_id
+0002b3f0: 5b31 3a5d 295d 290a 0a20 2020 2020 2020  [1:])])..       
+0002b400: 2069 6620 286c 656e 2872 6177 5f65 6467   if (len(raw_edg
+0002b410: 6573 2929 203d 3d20 313a 0a20 2020 2020  es)) == 1:.     
+0002b420: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0002b430: 616e 6365 2872 6177 5f65 6467 6573 5b30  ance(raw_edges[0
+0002b440: 5d2c 2063 6c73 293a 0a20 2020 2020 2020  ], cls):.       
+0002b450: 2020 2020 2020 2020 2023 2043 6173 6520           # Case 
+0002b460: 6f66 2061 2063 6972 636c 652c 2065 6c6c  of a circle, ell
+0002b470: 6970 7365 2e2e 2e0a 2020 2020 2020 2020  ipse....        
+0002b480: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0002b490: 6177 5f65 6467 6573 5b30 5d0a 2020 2020  aw_edges[0].    
+0002b4a0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+0002b4b0: 6c73 2872 6177 5f65 6467 6573 2c20 6e61  ls(raw_edges, na
+0002b4c0: 6d65 3d6e 616d 6529 0a0a 2020 2020 2020  me=name)..      
+0002b4d0: 2020 2320 4d61 6b69 6e67 2074 6869 6e67    # Making thing
+0002b4e0: 7320 7269 6768 7420 666f 7220 6669 7273  s right for firs
+0002b4f0: 7420 3220 7072 696d 6974 6976 6573 0a20  t 2 primitives. 
+0002b500: 2020 2020 2020 2069 6620 616e 7928 6564         if any(ed
+0002b510: 6765 2069 7320 4e6f 6e65 2066 6f72 2065  ge is None for e
+0002b520: 6467 6520 696e 2072 6177 5f65 6467 6573  dge in raw_edges
+0002b530: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0002b540: 6169 7365 2056 616c 7565 4572 726f 720a  aise ValueError.
+0002b550: 2020 2020 2020 2020 6469 7374 616e 6365          distance
+0002b560: 7320 3d20 5b72 6177 5f65 6467 6573 5b30  s = [raw_edges[0
+0002b570: 5d2e 656e 642e 706f 696e 745f 6469 7374  ].end.point_dist
+0002b580: 616e 6365 2872 6177 5f65 6467 6573 5b31  ance(raw_edges[1
+0002b590: 5d2e 7374 6172 7429 2c0a 2020 2020 2020  ].start),.      
+0002b5a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0002b5b0: 6177 5f65 6467 6573 5b30 5d2e 7374 6172  aw_edges[0].star
+0002b5c0: 742e 706f 696e 745f 6469 7374 616e 6365  t.point_distance
+0002b5d0: 2872 6177 5f65 6467 6573 5b31 5d2e 7374  (raw_edges[1].st
+0002b5e0: 6172 7429 2c0a 2020 2020 2020 2020 2020  art),.          
+0002b5f0: 2020 2020 2020 2020 2020 2072 6177 5f65             raw_e
+0002b600: 6467 6573 5b30 5d2e 656e 642e 706f 696e  dges[0].end.poin
+0002b610: 745f 6469 7374 616e 6365 2872 6177 5f65  t_distance(raw_e
+0002b620: 6467 6573 5b31 5d2e 656e 6429 2c0a 2020  dges[1].end),.  
+0002b630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b640: 2020 2072 6177 5f65 6467 6573 5b30 5d2e     raw_edges[0].
+0002b650: 7374 6172 742e 706f 696e 745f 6469 7374  start.point_dist
+0002b660: 616e 6365 2872 6177 5f65 6467 6573 5b31  ance(raw_edges[1
+0002b670: 5d2e 656e 6429 5d0a 2020 2020 2020 2020  ].end)].        
+0002b680: 696e 6465 7820 3d20 6469 7374 616e 6365  index = distance
+0002b690: 732e 696e 6465 7828 6d69 6e28 6469 7374  s.index(min(dist
+0002b6a0: 616e 6365 7329 290a 2020 2020 2020 2020  ances)).        
+0002b6b0: 6966 206d 696e 2864 6973 7461 6e63 6573  if min(distances
+0002b6c0: 2920 3e20 3665 2d34 3a0a 2020 2020 2020  ) > 6e-4:.      
+0002b6d0: 2020 2020 2020 2320 4772 6565 6e20 636f        # Green co
+0002b6e0: 6c6f 7220 3a20 7765 6c6c 2d70 6c61 6365  lor : well-place
+0002b6f0: 6420 616e 6420 7765 6c6c 2d72 6561 640a  d and well-read.
+0002b700: 2020 2020 2020 2020 2020 2020 6178 203d              ax =
+0002b710: 2072 6177 5f65 6467 6573 5b30 5d2e 706c   raw_edges[0].pl
+0002b720: 6f74 2863 6f6c 6f72 3d27 6727 290a 2020  ot(color='g').  
+0002b730: 2020 2020 2020 2020 2020 2320 5265 6420            # Red 
+0002b740: 636f 6c6f 7220 3a20 6361 6e27 7420 6265  color : can't be
+0002b750: 2063 6f6e 6e65 6374 6564 2074 6f20 6772   connected to gr
+0002b760: 6565 6e20 6564 6765 0a20 2020 2020 2020  een edge.       
+0002b770: 2020 2020 2072 6177 5f65 6467 6573 5b31       raw_edges[1
+0002b780: 5d2e 706c 6f74 2861 783d 6178 2c20 636f  ].plot(ax=ax, co
+0002b790: 6c6f 723d 2772 2729 0a20 2020 2020 2020  lor='r').       
+0002b7a0: 2020 2020 2023 2042 6c61 636b 2063 6f6c       # Black col
+0002b7b0: 6f72 203a 2074 6f20 6265 2070 6c61 6365  or : to be place
+0002b7c0: 640a 2020 2020 2020 2020 2020 2020 666f  d.            fo
+0002b7d0: 7220 7265 2069 6e20 7261 775f 6564 6765  r re in raw_edge
+0002b7e0: 735b 323a 5d3a 0a20 2020 2020 2020 2020  s[2:]:.         
+0002b7f0: 2020 2020 2020 2072 652e 706c 6f74 2861         re.plot(a
+0002b800: 783d 6178 290a 2020 2020 2020 2020 2020  x=ax).          
+0002b810: 2020 2320 6465 6c74 6178 3120 3d20 6162    # deltax1 = ab
+0002b820: 7328 7261 775f 6564 6765 735b 305d 2e73  s(raw_edges[0].s
+0002b830: 7461 7274 2e78 202d 2072 6177 5f65 6467  tart.x - raw_edg
+0002b840: 6573 5b31 5d2e 656e 642e 7829 0a20 2020  es[1].end.x).   
+0002b850: 2020 2020 2020 2020 2023 2064 656c 7461           # delta
+0002b860: 7832 203d 2061 6273 2872 6177 5f65 6467  x2 = abs(raw_edg
+0002b870: 6573 5b30 5d2e 656e 642e 7820 2d20 7261  es[0].end.x - ra
+0002b880: 775f 6564 6765 735b 315d 2e65 6e64 2e78  w_edges[1].end.x
+0002b890: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+0002b8a0: 6465 6c74 6179 3120 3d20 6162 7328 7261  deltay1 = abs(ra
+0002b8b0: 775f 6564 6765 735b 305d 2e73 7461 7274  w_edges[0].start
+0002b8c0: 2e79 202d 2072 6177 5f65 6467 6573 5b31  .y - raw_edges[1
+0002b8d0: 5d2e 656e 642e 7929 0a20 2020 2020 2020  ].end.y).       
+0002b8e0: 2020 2020 2023 2064 656c 7461 7932 203d       # deltay2 =
+0002b8f0: 2061 6273 2872 6177 5f65 6467 6573 5b30   abs(raw_edges[0
+0002b900: 5d2e 656e 642e 7920 2d20 7261 775f 6564  ].end.y - raw_ed
+0002b910: 6765 735b 315d 2e65 6e64 2e79 290a 2020  ges[1].end.y).  
+0002b920: 2020 2020 2020 2020 2020 2320 6465 6c74            # delt
+0002b930: 617a 3120 3d20 6162 7328 7261 775f 6564  az1 = abs(raw_ed
+0002b940: 6765 735b 305d 2e73 7461 7274 2e7a 202d  ges[0].start.z -
+0002b950: 2072 6177 5f65 6467 6573 5b31 5d2e 656e   raw_edges[1].en
+0002b960: 642e 7a29 0a20 2020 2020 2020 2020 2020  d.z).           
+0002b970: 2023 2064 656c 7461 7a32 203d 2061 6273   # deltaz2 = abs
+0002b980: 2872 6177 5f65 6467 6573 5b30 5d2e 656e  (raw_edges[0].en
+0002b990: 642e 7a20 2d20 7261 775f 6564 6765 735b  d.z - raw_edges[
+0002b9a0: 315d 2e65 6e64 2e7a 290a 2020 2020 2020  1].end.z).      
+0002b9b0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+0002b9c0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+0002b9d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b9e0: 2066 274e 756d 6265 7220 6f66 2065 6467   f'Number of edg
+0002b9f0: 6573 3a20 7b6c 656e 2872 6177 5f65 6467  es: {len(raw_edg
+0002ba00: 6573 297d 272c 0a20 2020 2020 2020 2020  es)}',.         
+0002ba10: 2020 2020 2020 2027 4669 7273 7420 3220         'First 2 
+0002ba20: 6564 6765 7320 6f66 2063 6f6e 746f 7572  edges of contour
+0002ba30: 206e 6f74 2066 6f6c 6c6f 7769 6e67 2065   not following e
+0002ba40: 6163 6820 6f74 6865 7227 2c0a 2020 2020  ach other',.    
+0002ba50: 2020 2020 2020 2020 2020 2020 6627 6465              f'de
+0002ba60: 6c74 615f 7820 3d20 7b61 6273 2872 6177  lta_x = {abs(raw
+0002ba70: 5f65 6467 6573 5b30 5d2e 7374 6172 742e  _edges[0].start.
+0002ba80: 7820 2d20 7261 775f 6564 6765 735b 315d  x - raw_edges[1]
+0002ba90: 2e65 6e64 2e78 297d 2c27 0a20 2020 2020  .end.x)},'.     
+0002baa0: 2020 2020 2020 2020 2020 2066 2720 7b61             f' {a
+0002bab0: 6273 2872 6177 5f65 6467 6573 5b30 5d2e  bs(raw_edges[0].
+0002bac0: 656e 642e 7820 2d20 7261 775f 6564 6765  end.x - raw_edge
+0002bad0: 735b 315d 2e65 6e64 2e78 297d 272c 0a20  s[1].end.x)}',. 
+0002bae0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002baf0: 2764 656c 7461 5f79 203d 207b 6162 7328  'delta_y = {abs(
+0002bb00: 7261 775f 6564 6765 735b 305d 2e73 7461  raw_edges[0].sta
+0002bb10: 7274 2e79 202d 2072 6177 5f65 6467 6573  rt.y - raw_edges
+0002bb20: 5b31 5d2e 656e 642e 7929 7d2c 270a 2020  [1].end.y)},'.  
+0002bb30: 2020 2020 2020 2020 2020 2020 2020 6627                f'
+0002bb40: 207b 6162 7328 7261 775f 6564 6765 735b   {abs(raw_edges[
+0002bb50: 305d 2e65 6e64 2e79 202d 2072 6177 5f65  0].end.y - raw_e
+0002bb60: 6467 6573 5b31 5d2e 656e 642e 7929 7d27  dges[1].end.y)}'
+0002bb70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002bb80: 2020 6627 6465 6c74 615f 7a20 3d20 7b61    f'delta_z = {a
+0002bb90: 6273 2872 6177 5f65 6467 6573 5b30 5d2e  bs(raw_edges[0].
+0002bba0: 7374 6172 742e 7a20 2d20 7261 775f 6564  start.z - raw_ed
+0002bbb0: 6765 735b 315d 2e65 6e64 2e7a 297d 2c27  ges[1].end.z)},'
+0002bbc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002bbd0: 2066 2720 7b61 6273 2872 6177 5f65 6467   f' {abs(raw_edg
+0002bbe0: 6573 5b30 5d2e 656e 642e 7a20 2d20 7261  es[0].end.z - ra
+0002bbf0: 775f 6564 6765 735b 315d 2e65 6e64 2e7a  w_edges[1].end.z
+0002bc00: 297d 272c 0a20 2020 2020 2020 2020 2020  )}',.           
+0002bc10: 2020 2020 2066 2764 6973 7461 6e63 6520       f'distance 
+0002bc20: 3d20 7b6d 696e 2864 6973 7461 6e63 6573  = {min(distances
+0002bc30: 297d 2729 0a0a 2020 2020 2020 2020 6966  )}')..        if
+0002bc40: 2069 6e64 6578 203d 3d20 303a 0a20 2020   index == 0:.   
+0002bc50: 2020 2020 2020 2020 2065 6467 6573 203d           edges =
+0002bc60: 205b 7261 775f 6564 6765 735b 305d 2c20   [raw_edges[0], 
+0002bc70: 7261 775f 6564 6765 735b 315d 5d0a 2020  raw_edges[1]].  
+0002bc80: 2020 2020 2020 656c 6966 2069 6e64 6578        elif index
+0002bc90: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+0002bca0: 2020 2065 6467 6573 203d 205b 7261 775f     edges = [raw_
+0002bcb0: 6564 6765 735b 305d 2e72 6576 6572 7365  edges[0].reverse
+0002bcc0: 2829 2c20 7261 775f 6564 6765 735b 315d  (), raw_edges[1]
+0002bcd0: 5d0a 2020 2020 2020 2020 656c 6966 2069  ].        elif i
+0002bce0: 6e64 6578 203d 3d20 323a 0a20 2020 2020  ndex == 2:.     
+0002bcf0: 2020 2020 2020 2065 6467 6573 203d 205b         edges = [
+0002bd00: 7261 775f 6564 6765 735b 305d 2c20 7261  raw_edges[0], ra
+0002bd10: 775f 6564 6765 735b 315d 2e72 6576 6572  w_edges[1].rever
+0002bd20: 7365 2829 5d0a 2020 2020 2020 2020 656c  se()].        el
+0002bd30: 6966 2069 6e64 6578 203d 3d20 333a 0a20  if index == 3:. 
+0002bd40: 2020 2020 2020 2020 2020 2065 6467 6573             edges
+0002bd50: 203d 205b 7261 775f 6564 6765 735b 305d   = [raw_edges[0]
+0002bd60: 2e72 6576 6572 7365 2829 2c20 7261 775f  .reverse(), raw_
+0002bd70: 6564 6765 735b 315d 2e72 6576 6572 7365  edges[1].reverse
+0002bd80: 2829 5d0a 2020 2020 2020 2020 656c 7365  ()].        else
+0002bd90: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0002bda0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+0002bdb0: 6564 4572 726f 720a 0a20 2020 2020 2020  edError..       
+0002bdc0: 2023 2043 6f6e 6e65 6374 696e 6720 7468   # Connecting th
+0002bdd0: 6520 6e65 7874 2065 6467 6573 0a20 2020  e next edges.   
+0002bde0: 2020 2020 206c 6173 745f 6564 6765 203d       last_edge =
+0002bdf0: 2065 6467 6573 5b2d 315d 0a20 2020 2020   edges[-1].     
+0002be00: 2020 2066 6f72 2069 2c20 7261 775f 6564     for i, raw_ed
+0002be10: 6765 2069 6e20 656e 756d 6572 6174 6528  ge in enumerate(
+0002be20: 7261 775f 6564 6765 735b 323a 5d29 3a0a  raw_edges[2:]):.
+0002be30: 2020 2020 2020 2020 2020 2020 6469 7374              dist
+0002be40: 616e 6365 7320 3d20 5b72 6177 5f65 6467  ances = [raw_edg
+0002be50: 652e 7374 6172 742e 706f 696e 745f 6469  e.start.point_di
+0002be60: 7374 616e 6365 286c 6173 745f 6564 6765  stance(last_edge
+0002be70: 2e65 6e64 292c 0a20 2020 2020 2020 2020  .end),.         
 0002be80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002be90: 2020 2020 2020 7261 775f 6564 6765 2e65        raw_edge.e
-0002bea0: 6e64 2e70 6f69 6e74 5f64 6973 7461 6e63  nd.point_distanc
-0002beb0: 6528 6c61 7374 5f65 6467 652e 656e 6429  e(last_edge.end)
-0002bec0: 5d0a 2020 2020 2020 2020 2020 2020 696e  ].            in
-0002bed0: 6465 7820 3d20 6469 7374 616e 6365 732e  dex = distances.
-0002bee0: 696e 6465 7828 6d69 6e28 6469 7374 616e  index(min(distan
-0002bef0: 6365 7329 290a 2020 2020 2020 2020 2020  ces)).          
-0002bf00: 2020 6966 206d 696e 2864 6973 7461 6e63    if min(distanc
-0002bf10: 6573 2920 3e20 3665 2d34 3a0a 2020 2020  es) > 6e-4:.    
-0002bf20: 2020 2020 2020 2020 2020 2020 2320 4772              # Gr
-0002bf30: 6565 6e20 636f 6c6f 7220 3a20 7765 6c6c  een color : well
-0002bf40: 2d70 6c61 6365 6420 616e 6420 7765 6c6c  -placed and well
-0002bf50: 2d72 6561 640a 2020 2020 2020 2020 2020  -read.          
-0002bf60: 2020 2020 2020 6178 203d 206c 6173 745f        ax = last_
-0002bf70: 6564 6765 2e70 6c6f 7428 636f 6c6f 723d  edge.plot(color=
-0002bf80: 2767 2729 0a20 2020 2020 2020 2020 2020  'g').           
-0002bf90: 2020 2020 2066 6f72 2072 6520 696e 2072       for re in r
-0002bfa0: 6177 5f65 6467 6573 5b3a 3220 2b20 695d  aw_edges[:2 + i]
-0002bfb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002bfc0: 2020 2020 2020 7265 2e70 6c6f 7428 6178        re.plot(ax
-0002bfd0: 3d61 782c 2063 6f6c 6f72 3d27 6727 290a  =ax, color='g').
-0002bfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bff0: 2020 2020 7265 2e73 7461 7274 2e70 6c6f      re.start.plo
-0002c000: 7428 6178 3d61 782c 2063 6f6c 6f72 3d27  t(ax=ax, color='
-0002c010: 6727 290a 2020 2020 2020 2020 2020 2020  g').            
-0002c020: 2020 2020 2020 2020 7265 2e65 6e64 2e70          re.end.p
-0002c030: 6c6f 7428 6178 3d61 782c 2063 6f6c 6f72  lot(ax=ax, color
-0002c040: 3d27 6727 290a 2020 2020 2020 2020 2020  ='g').          
-0002c050: 2020 2020 2020 6c61 7374 5f65 6467 652e        last_edge.
-0002c060: 656e 642e 706c 6f74 2861 783d 6178 2c20  end.plot(ax=ax, 
-0002c070: 636f 6c6f 723d 2772 2729 0a20 2020 2020  color='r').     
-0002c080: 2020 2020 2020 2020 2020 2023 2052 6564             # Red
-0002c090: 2063 6f6c 6f72 203a 2063 616e 2774 2062   color : can't b
-0002c0a0: 6520 636f 6e6e 6563 7465 6420 746f 2072  e connected to r
-0002c0b0: 6564 2064 6f74 0a20 2020 2020 2020 2020  ed dot.         
-0002c0c0: 2020 2020 2020 2072 6177 5f65 6467 652e         raw_edge.
-0002c0d0: 706c 6f74 2861 783d 6178 2c20 636f 6c6f  plot(ax=ax, colo
-0002c0e0: 723d 2772 2729 0a20 2020 2020 2020 2020  r='r').         
-0002c0f0: 2020 2020 2020 2023 2042 6c61 636b 2063         # Black c
-0002c100: 6f6c 6f72 203a 2074 6f20 6265 2070 6c61  olor : to be pla
-0002c110: 6365 640a 2020 2020 2020 2020 2020 2020  ced.            
-0002c120: 2020 2020 666f 7220 7265 2069 6e20 7261      for re in ra
-0002c130: 775f 6564 6765 735b 3220 2b20 6920 2b20  w_edges[2 + i + 
-0002c140: 313a 5d3a 0a20 2020 2020 2020 2020 2020  1:]:.           
-0002c150: 2020 2020 2020 2020 2072 652e 706c 6f74           re.plot
-0002c160: 2861 783d 6178 290a 2020 2020 2020 2020  (ax=ax).        
-0002c170: 2020 2020 2020 2020 2020 2020 7265 2e73              re.s
-0002c180: 7461 7274 2e70 6c6f 7428 6178 3d61 7829  tart.plot(ax=ax)
-0002c190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002c1a0: 2020 2020 2072 652e 656e 642e 706c 6f74       re.end.plot
-0002c1b0: 2861 783d 6178 290a 2020 2020 2020 2020  (ax=ax).        
-0002c1c0: 2020 2020 2020 2020 2320 6465 6c74 6178          # deltax
-0002c1d0: 3120 3d20 6162 7328 7261 775f 6564 6765  1 = abs(raw_edge
-0002c1e0: 2e73 7461 7274 2e78 202d 206c 6173 745f  .start.x - last_
-0002c1f0: 6564 6765 2e65 6e64 2e78 290a 2020 2020  edge.end.x).    
-0002c200: 2020 2020 2020 2020 2020 2020 2320 6465              # de
-0002c210: 6c74 6178 3220 3d20 6162 7328 7261 775f  ltax2 = abs(raw_
-0002c220: 6564 6765 2e65 6e64 2e78 202d 206c 6173  edge.end.x - las
-0002c230: 745f 6564 6765 2e65 6e64 2e78 290a 2020  t_edge.end.x).  
-0002c240: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0002c250: 6465 6c74 6179 3120 3d20 6162 7328 7261  deltay1 = abs(ra
-0002c260: 775f 6564 6765 2e73 7461 7274 2e79 202d  w_edge.start.y -
-0002c270: 206c 6173 745f 6564 6765 2e65 6e64 2e79   last_edge.end.y
-0002c280: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002c290: 2020 2320 6465 6c74 6179 3220 3d20 6162    # deltay2 = ab
-0002c2a0: 7328 7261 775f 6564 6765 2e65 6e64 2e79  s(raw_edge.end.y
-0002c2b0: 202d 206c 6173 745f 6564 6765 2e65 6e64   - last_edge.end
-0002c2c0: 2e79 290a 2020 2020 2020 2020 2020 2020  .y).            
-0002c2d0: 2020 2020 2320 6465 6c74 617a 3120 3d20      # deltaz1 = 
-0002c2e0: 6162 7328 7261 775f 6564 6765 2e73 7461  abs(raw_edge.sta
-0002c2f0: 7274 2e7a 202d 206c 6173 745f 6564 6765  rt.z - last_edge
-0002c300: 2e65 6e64 2e7a 290a 2020 2020 2020 2020  .end.z).        
-0002c310: 2020 2020 2020 2020 2320 6465 6c74 617a          # deltaz
-0002c320: 3220 3d20 6162 7328 7261 775f 6564 6765  2 = abs(raw_edge
-0002c330: 2e65 6e64 2e7a 202d 206c 6173 745f 6564  .end.z - last_ed
-0002c340: 6765 2e65 6e64 2e7a 290a 2020 2020 2020  ge.end.z).      
-0002c350: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0002c360: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-0002c370: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0002c380: 2020 2020 2020 2020 2066 274e 756d 6265           f'Numbe
-0002c390: 7220 6f66 2065 6467 6573 3a20 7b6c 656e  r of edges: {len
-0002c3a0: 2872 6177 5f65 6467 6573 297d 272c 0a20  (raw_edges)}',. 
-0002c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c3c0: 2020 2027 4564 6765 7320 6f66 2063 6f6e     'Edges of con
-0002c3d0: 746f 7572 206e 6f74 2066 6f6c 6c6f 7769  tour not followi
-0002c3e0: 6e67 2065 6163 6820 6f74 6865 7227 2c0a  ng each other',.
-0002c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c400: 2020 2020 6627 6465 6c74 615f 7820 3d20      f'delta_x = 
-0002c410: 7b61 6273 2872 6177 5f65 6467 652e 7374  {abs(raw_edge.st
-0002c420: 6172 742e 7820 2d20 6c61 7374 5f65 6467  art.x - last_edg
-0002c430: 652e 656e 642e 7829 7d2c 270a 2020 2020  e.end.x)},'.    
-0002c440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c450: 6627 207b 6162 7328 7261 775f 6564 6765  f' {abs(raw_edge
-0002c460: 2e65 6e64 2e78 202d 206c 6173 745f 6564  .end.x - last_ed
-0002c470: 6765 2e65 6e64 2e78 297d 272c 0a20 2020  ge.end.x)}',.   
-0002c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c490: 2066 2764 656c 7461 5f79 203d 207b 6162   f'delta_y = {ab
-0002c4a0: 7328 7261 775f 6564 6765 2e73 7461 7274  s(raw_edge.start
-0002c4b0: 2e79 202d 206c 6173 745f 6564 6765 2e65  .y - last_edge.e
-0002c4c0: 6e64 2e79 297d 2c27 0a20 2020 2020 2020  nd.y)},'.       
-0002c4d0: 2020 2020 2020 2020 2020 2020 2066 2720               f' 
-0002c4e0: 7b61 6273 2872 6177 5f65 6467 652e 656e  {abs(raw_edge.en
-0002c4f0: 642e 7920 2d20 6c61 7374 5f65 6467 652e  d.y - last_edge.
-0002c500: 656e 642e 7929 7d27 2c0a 2020 2020 2020  end.y)}',.      
-0002c510: 2020 2020 2020 2020 2020 2020 2020 6627                f'
-0002c520: 6465 6c74 615f 7a20 3d20 7b61 6273 2872  delta_z = {abs(r
-0002c530: 6177 5f65 6467 652e 7374 6172 742e 7a20  aw_edge.start.z 
-0002c540: 2d20 6c61 7374 5f65 6467 652e 656e 642e  - last_edge.end.
-0002c550: 7a29 7d2c 270a 2020 2020 2020 2020 2020  z)},'.          
-0002c560: 2020 2020 2020 2020 2020 6627 207b 6162            f' {ab
-0002c570: 7328 7261 775f 6564 6765 2e65 6e64 2e7a  s(raw_edge.end.z
-0002c580: 202d 206c 6173 745f 6564 6765 2e65 6e64   - last_edge.end
-0002c590: 2e7a 297d 272c 0a20 2020 2020 2020 2020  .z)}',.         
-0002c5a0: 2020 2020 2020 2020 2020 2066 2764 6973             f'dis
-0002c5b0: 7461 6e63 6520 3d20 7b6d 696e 2864 6973  tance = {min(dis
-0002c5c0: 7461 6e63 6573 297d 2729 0a20 2020 2020  tances)}').     
-0002c5d0: 2020 2020 2020 2069 6620 696e 6465 7820         if index 
-0002c5e0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-0002c5f0: 2020 2020 2020 6c61 7374 5f65 6467 6520        last_edge 
-0002c600: 3d20 7261 775f 6564 6765 0a20 2020 2020  = raw_edge.     
-0002c610: 2020 2020 2020 2065 6c69 6620 696e 6465         elif inde
-0002c620: 7820 3d3d 2031 3a0a 2020 2020 2020 2020  x == 1:.        
-0002c630: 2020 2020 2020 2020 6c61 7374 5f65 6467          last_edg
-0002c640: 6520 3d20 7261 775f 6564 6765 2e72 6576  e = raw_edge.rev
-0002c650: 6572 7365 2829 0a0a 2020 2020 2020 2020  erse()..        
-0002c660: 2020 2020 6564 6765 732e 6170 7065 6e64      edges.append
-0002c670: 286c 6173 745f 6564 6765 290a 2020 2020  (last_edge).    
-0002c680: 2020 2020 7265 7475 726e 2063 6c73 2865      return cls(e
-0002c690: 6467 6573 2c20 6e61 6d65 3d6e 616d 6529  dges, name=name)
-0002c6a0: 0a0a 2020 2020 6465 6620 746f 5f73 7465  ..    def to_ste
-0002c6b0: 7028 7365 6c66 2c20 6375 7272 656e 745f  p(self, current_
-0002c6c0: 6964 2c20 7375 7266 6163 655f 6964 3d4e  id, surface_id=N
-0002c6d0: 6f6e 652c 2073 7572 6661 6365 3364 3d4e  one, surface3d=N
-0002c6e0: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
-0002c6f0: 220a 2020 2020 2020 2020 4372 6561 7465  ".        Create
-0002c700: 2061 2043 6972 636c 6533 4420 7374 6570   a Circle3D step
-0002c710: 206f 626a 6563 742e 0a0a 2020 2020 2020   object...      
-0002c720: 2020 2222 220a 2020 2020 2020 2020 636f    """.        co
-0002c730: 6e74 656e 7420 3d20 2727 0a20 2020 2020  ntent = ''.     
-0002c740: 2020 2065 6467 655f 6964 7320 3d20 5b5d     edge_ids = []
-0002c750: 0a20 2020 2020 2020 2066 6f72 2070 7269  .        for pri
-0002c760: 6d69 7469 7665 2069 6e20 7365 6c66 2e70  mitive in self.p
-0002c770: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
-0002c780: 2020 2020 2020 2069 6620 7072 696d 6974         if primit
-0002c790: 6976 652e 5f5f 636c 6173 735f 5f2e 5f5f  ive.__class__.__
-0002c7a0: 6e61 6d65 5f5f 203d 3d20 2742 5370 6c69  name__ == 'BSpli
-0002c7b0: 6e65 4375 7276 6533 4427 3a0a 2020 2020  neCurve3D':.    
-0002c7c0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-0002c7d0: 6f64 5f6e 616d 6520 3d20 6627 7b70 7269  od_name = f'{pri
-0002c7e0: 6d69 7469 7665 2e5f 5f63 6c61 7373 5f5f  mitive.__class__
-0002c7f0: 2e5f 5f6e 616d 655f 5f2e 6c6f 7765 7228  .__name__.lower(
-0002c800: 297d 5f74 6f5f 3264 270a 2020 2020 2020  )}_to_2d'.      
-0002c810: 2020 2020 2020 2020 2020 6375 7276 6532            curve2
-0002c820: 6420 3d20 6765 7461 7474 7228 7375 7266  d = getattr(surf
-0002c830: 6163 6533 642c 206d 6574 686f 645f 6e61  ace3d, method_na
-0002c840: 6d65 2928 7072 696d 6974 6976 6529 5b30  me)(primitive)[0
-0002c850: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0002c860: 2020 6966 2063 7572 7665 3264 2e5f 5f63    if curve2d.__c
-0002c870: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f20  lass__.__name__ 
-0002c880: 3d3d 2027 4c69 6e65 5365 676d 656e 7433  == 'LineSegment3
-0002c890: 4427 3a0a 2020 2020 2020 2020 2020 2020  D':.            
-0002c8a0: 2020 2020 2020 2020 6375 7276 6532 6420          curve2d 
-0002c8b0: 3d20 6375 7276 6532 642e 746f 5f62 7370  = curve2d.to_bsp
-0002c8c0: 6c69 6e65 5f63 7572 7665 2829 0a20 2020  line_curve().   
-0002c8d0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0002c8e0: 6d69 7469 7665 5f63 6f6e 7465 6e74 2c20  mitive_content, 
-0002c8f0: 7072 696d 6974 6976 655f 6964 7320 3d20  primitive_ids = 
-0002c900: 7072 696d 6974 6976 652e 746f 5f73 7465  primitive.to_ste
-0002c910: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
-0002c920: 2020 2020 2020 2063 7572 7265 6e74 5f69         current_i
-0002c930: 642c 2073 7572 6661 6365 5f69 643d 7375  d, surface_id=su
-0002c940: 7266 6163 655f 6964 2c20 6375 7276 6532  rface_id, curve2
-0002c950: 643d 6375 7276 6532 6429 0a20 2020 2020  d=curve2d).     
-0002c960: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002c970: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0002c980: 6d69 7469 7665 5f63 6f6e 7465 6e74 2c20  mitive_content, 
-0002c990: 7072 696d 6974 6976 655f 6964 7320 3d20  primitive_ids = 
-0002c9a0: 7072 696d 6974 6976 652e 746f 5f73 7465  primitive.to_ste
-0002c9b0: 7028 6375 7272 656e 745f 6964 2c20 7375  p(current_id, su
-0002c9c0: 7266 6163 655f 6964 3d73 7572 6661 6365  rface_id=surface
-0002c9d0: 5f69 6429 0a20 2020 2020 2020 2020 2020  _id).           
-0002c9e0: 2063 6f6e 7465 6e74 202b 3d20 7072 696d   content += prim
-0002c9f0: 6974 6976 655f 636f 6e74 656e 740a 2020  itive_content.  
-0002ca00: 2020 2020 2020 2020 2020 6375 7272 656e            curren
-0002ca10: 745f 6964 203d 2070 7269 6d69 7469 7665  t_id = primitive
-0002ca20: 5f69 6473 5b2d 315d 202b 2031 0a20 2020  _ids[-1] + 1.   
-0002ca30: 2020 2020 2020 2020 2066 6f72 2070 7269           for pri
-0002ca40: 6d69 7469 7665 5f69 6420 696e 2070 7269  mitive_id in pri
-0002ca50: 6d69 7469 7665 5f69 6473 3a0a 2020 2020  mitive_ids:.    
-0002ca60: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-0002ca70: 656e 7420 2b3d 2022 237b 7d20 3d20 4f52  ent += "#{} = OR
-0002ca80: 4945 4e54 4544 5f45 4447 4528 277b 7d27  IENTED_EDGE('{}'
-0002ca90: 2c2a 2c2a 2c23 7b7d 2c2e 542e 293b 5c6e  ,*,*,#{},.T.);\n
-0002caa0: 222e 666f 726d 6174 280a 2020 2020 2020  ".format(.      
-0002cab0: 2020 2020 2020 2020 2020 2020 2020 6375                cu
-0002cac0: 7272 656e 745f 6964 2c0a 2020 2020 2020  rrent_id,.      
-0002cad0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0002cae0: 696d 6974 6976 652e 6e61 6d65 2c0a 2020  imitive.name,.  
-0002caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cb00: 2020 7072 696d 6974 6976 655f 6964 290a    primitive_id).
-0002cb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cb20: 6564 6765 5f69 6473 2e61 7070 656e 6428  edge_ids.append(
-0002cb30: 6375 7272 656e 745f 6964 290a 0a20 2020  current_id)..   
-0002cb40: 2020 2020 2020 2020 2020 2020 2063 7572               cur
-0002cb50: 7265 6e74 5f69 6420 2b3d 2031 0a0a 2020  rent_id += 1..  
-0002cb60: 2020 2020 2020 636f 6e74 656e 7420 2b3d        content +=
-0002cb70: 2022 237b 7d20 3d20 4544 4745 5f4c 4f4f   "#{} = EDGE_LOO
-0002cb80: 5028 277b 7d27 2c28 7b7d 2929 3b5c 6e22  P('{}',({}));\n"
-0002cb90: 2e66 6f72 6d61 7428 0a20 2020 2020 2020  .format(.       
-0002cba0: 2020 2020 2063 7572 7265 6e74 5f69 642c       current_id,
-0002cbb0: 2073 656c 662e 6e61 6d65 2c20 766f 6c6d   self.name, volm
-0002cbc0: 646c 722e 636f 7265 2e73 7465 705f 6964  dlr.core.step_id
-0002cbd0: 735f 746f 5f73 7472 2865 6467 655f 6964  s_to_str(edge_id
-0002cbe0: 7329 290a 2020 2020 2020 2020 7265 7475  s)).        retu
-0002cbf0: 726e 2063 6f6e 7465 6e74 2c20 6375 7272  rn content, curr
-0002cc00: 656e 745f 6964 0a0a 2020 2020 6465 6620  ent_id..    def 
-0002cc10: 6176 6572 6167 655f 6365 6e74 6572 5f70  average_center_p
-0002cc20: 6f69 6e74 2873 656c 6629 3a0a 2020 2020  oint(self):.    
-0002cc30: 2020 2020 6e62 203d 206c 656e 2873 656c      nb = len(sel
-0002cc40: 662e 6564 6765 5f70 6f6c 7967 6f6e 2e70  f.edge_polygon.p
-0002cc50: 6f69 6e74 7329 0a20 2020 2020 2020 2078  oints).        x
-0002cc60: 203d 2073 756d 2870 6f69 6e74 5b30 5d20   = sum(point[0] 
-0002cc70: 666f 7220 706f 696e 7420 696e 2073 656c  for point in sel
-0002cc80: 662e 6564 6765 5f70 6f6c 7967 6f6e 2e70  f.edge_polygon.p
-0002cc90: 6f69 6e74 7329 202f 206e 620a 2020 2020  oints) / nb.    
-0002cca0: 2020 2020 7920 3d20 7375 6d28 706f 696e      y = sum(poin
-0002ccb0: 745b 315d 2066 6f72 2070 6f69 6e74 2069  t[1] for point i
-0002ccc0: 6e20 7365 6c66 2e65 6467 655f 706f 6c79  n self.edge_poly
-0002ccd0: 676f 6e2e 706f 696e 7473 2920 2f20 6e62  gon.points) / nb
-0002cce0: 0a20 2020 2020 2020 207a 203d 2073 756d  .        z = sum
-0002ccf0: 2870 6f69 6e74 5b32 5d20 666f 7220 706f  (point[2] for po
-0002cd00: 696e 7420 696e 2073 656c 662e 6564 6765  int in self.edge
-0002cd10: 5f70 6f6c 7967 6f6e 2e70 6f69 6e74 7329  _polygon.points)
-0002cd20: 202f 206e 620a 0a20 2020 2020 2020 2072   / nb..        r
-0002cd30: 6574 7572 6e20 766f 6c6d 646c 722e 506f  eturn volmdlr.Po
-0002cd40: 696e 7433 4428 782c 2079 2c20 7a29 0a0a  int3D(x, y, z)..
-0002cd50: 2020 2020 6465 6620 746f 5f32 6428 7365      def to_2d(se
-0002cd60: 6c66 2c20 706c 616e 655f 6f72 6967 696e  lf, plane_origin
-0002cd70: 2c20 782c 2079 293a 0a20 2020 2020 2020  , x, y):.       
-0002cd80: 2070 7269 6d69 7469 7665 7332 6420 3d20   primitives2d = 
-0002cd90: 7365 6c66 2e67 6574 5f70 7269 6d69 7469  self.get_primiti
-0002cda0: 7665 735f 3264 2870 6c61 6e65 5f6f 7269  ves_2d(plane_ori
-0002cdb0: 6769 6e2c 2078 2c20 7929 0a20 2020 2020  gin, x, y).     
-0002cdc0: 2020 2072 6574 7572 6e20 436f 6e74 6f75     return Contou
-0002cdd0: 7232 4428 7072 696d 6974 6976 6573 3d70  r2D(primitives=p
-0002cde0: 7269 6d69 7469 7665 7332 6429 0a0a 2020  rimitives2d)..  
-0002cdf0: 2020 6465 6620 726f 7461 7469 6f6e 2873    def rotation(s
-0002ce00: 656c 662c 2063 656e 7465 723a 2076 6f6c  elf, center: vol
-0002ce10: 6d64 6c72 2e50 6f69 6e74 3344 2c20 6178  mdlr.Point3D, ax
-0002ce20: 6973 3a20 766f 6c6d 646c 722e 5665 6374  is: volmdlr.Vect
-0002ce30: 6f72 3344 2c0a 2020 2020 2020 2020 2020  or3D,.          
-0002ce40: 2020 2020 2020 2061 6e67 6c65 3a20 666c         angle: fl
-0002ce50: 6f61 7429 3a0a 2020 2020 2020 2020 2222  oat):.        ""
-0002ce60: 220a 2020 2020 2020 2020 436f 6e74 6f75  ".        Contou
-0002ce70: 7233 4420 726f 7461 7469 6f6e 2e0a 0a20  r3D rotation... 
-0002ce80: 2020 2020 2020 203a 7061 7261 6d20 6365         :param ce
-0002ce90: 6e74 6572 3a20 726f 7461 7469 6f6e 2063  nter: rotation c
-0002cea0: 656e 7465 722e 0a20 2020 2020 2020 203a  enter..        :
-0002ceb0: 7061 7261 6d20 6178 6973 3a20 726f 7461  param axis: rota
-0002cec0: 7469 6f6e 2061 7869 732e 0a20 2020 2020  tion axis..     
-0002ced0: 2020 203a 7061 7261 6d20 616e 676c 653a     :param angle:
-0002cee0: 2061 6e67 6c65 2072 6f74 6174 696f 6e2e   angle rotation.
-0002cef0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0002cf00: 3a20 6120 6e65 7720 726f 7461 7465 6420  : a new rotated 
-0002cf10: 436f 6e74 6f75 7233 442e 0a20 2020 2020  Contour3D..     
-0002cf20: 2020 2022 2222 0a20 2020 2020 2020 206e     """.        n
-0002cf30: 6577 5f65 6467 6573 203d 205b 6564 6765  ew_edges = [edge
-0002cf40: 2e72 6f74 6174 696f 6e28 6365 6e74 6572  .rotation(center
-0002cf50: 2c20 6178 6973 2c20 616e 676c 6529 2066  , axis, angle) f
-0002cf60: 6f72 2065 6467 650a 2020 2020 2020 2020  or edge.        
-0002cf70: 2020 2020 2020 2020 2020 2020 2069 6e20               in 
-0002cf80: 7365 6c66 2e70 7269 6d69 7469 7665 735d  self.primitives]
-0002cf90: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002cfa0: 436f 6e74 6f75 7233 4428 6e65 775f 6564  Contour3D(new_ed
-0002cfb0: 6765 732c 2073 656c 662e 6e61 6d65 290a  ges, self.name).
-0002cfc0: 0a20 2020 2064 6566 2072 6f74 6174 696f  .    def rotatio
-0002cfd0: 6e5f 696e 706c 6163 6528 7365 6c66 2c20  n_inplace(self, 
-0002cfe0: 6365 6e74 6572 3a20 766f 6c6d 646c 722e  center: volmdlr.
-0002cff0: 506f 696e 7433 442c 2061 7869 733a 2076  Point3D, axis: v
-0002d000: 6f6c 6d64 6c72 2e56 6563 746f 7233 442c  olmdlr.Vector3D,
-0002d010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d020: 2020 2020 2020 2020 2020 616e 676c 653a            angle:
-0002d030: 2066 6c6f 6174 293a 0a20 2020 2020 2020   float):.       
-0002d040: 2022 2222 0a20 2020 2020 2020 2043 6f6e   """.        Con
-0002d050: 746f 7572 3344 2072 6f74 6174 696f 6e2e  tour3D rotation.
-0002d060: 204f 626a 6563 7420 6973 2075 7064 6174   Object is updat
-0002d070: 6564 2069 6e70 6c61 6365 2e0a 0a20 2020  ed inplace...   
-0002d080: 2020 2020 203a 7061 7261 6d20 6365 6e74       :param cent
-0002d090: 6572 3a20 726f 7461 7469 6f6e 2063 656e  er: rotation cen
-0002d0a0: 7465 722e 0a20 2020 2020 2020 203a 7061  ter..        :pa
-0002d0b0: 7261 6d20 6178 6973 3a20 726f 7461 7469  ram axis: rotati
-0002d0c0: 6f6e 2061 7869 732e 0a20 2020 2020 2020  on axis..       
-0002d0d0: 203a 7061 7261 6d20 616e 676c 653a 2072   :param angle: r
-0002d0e0: 6f74 6174 696f 6e20 616e 676c 652e 0a20  otation angle.. 
-0002d0f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002d100: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-0002d110: 2822 2769 6e70 6c61 6365 2720 6d65 7468  ("'inplace' meth
-0002d120: 6f64 7320 6172 6520 6465 7072 6563 6174  ods are deprecat
-0002d130: 6564 2e20 5573 6520 6120 6e6f 7420 696e  ed. Use a not in
-0002d140: 706c 6163 6520 6d65 7468 6f64 2069 6e73  place method ins
-0002d150: 7465 6164 2e22 2c20 4465 7072 6563 6174  tead.", Deprecat
-0002d160: 696f 6e57 6172 6e69 6e67 290a 0a20 2020  ionWarning)..   
-0002d170: 2020 2020 2066 6f72 2065 6467 6520 696e       for edge in
-0002d180: 2073 656c 662e 7072 696d 6974 6976 6573   self.primitives
-0002d190: 3a0a 2020 2020 2020 2020 2020 2020 6564  :.            ed
-0002d1a0: 6765 2e72 6f74 6174 696f 6e5f 696e 706c  ge.rotation_inpl
-0002d1b0: 6163 6528 6365 6e74 6572 2c20 6178 6973  ace(center, axis
-0002d1c0: 2c20 616e 676c 6529 0a0a 2020 2020 6465  , angle)..    de
-0002d1d0: 6620 7472 616e 736c 6174 696f 6e28 7365  f translation(se
-0002d1e0: 6c66 2c20 6f66 6673 6574 3a20 766f 6c6d  lf, offset: volm
-0002d1f0: 646c 722e 5665 6374 6f72 3344 293a 0a20  dlr.Vector3D):. 
-0002d200: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002d210: 2020 2043 6f6e 746f 7572 3344 2074 7261     Contour3D tra
-0002d220: 6e73 6c61 7469 6f6e 2e0a 0a20 2020 2020  nslation...     
-0002d230: 2020 203a 7061 7261 6d20 6f66 6673 6574     :param offset
-0002d240: 3a20 7472 616e 736c 6174 696f 6e20 7665  : translation ve
-0002d250: 6374 6f72 2e0a 2020 2020 2020 2020 3a72  ctor..        :r
-0002d260: 6574 7572 6e3a 2041 206e 6577 2074 7261  eturn: A new tra
-0002d270: 6e73 6c61 7465 6420 436f 6e74 6f75 7233  nslated Contour3
-0002d280: 442e 0a20 2020 2020 2020 2022 2222 0a20  D..        """. 
-0002d290: 2020 2020 2020 206e 6577 5f65 6467 6573         new_edges
-0002d2a0: 203d 205b 6564 6765 2e74 7261 6e73 6c61   = [edge.transla
-0002d2b0: 7469 6f6e 286f 6666 7365 7429 2066 6f72  tion(offset) for
-0002d2c0: 2065 6467 6520 696e 0a20 2020 2020 2020   edge in.       
-0002d2d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0002d2e0: 6c66 2e70 7269 6d69 7469 7665 735d 0a20  lf.primitives]. 
-0002d2f0: 2020 2020 2020 2072 6574 7572 6e20 436f         return Co
-0002d300: 6e74 6f75 7233 4428 6e65 775f 6564 6765  ntour3D(new_edge
-0002d310: 732c 2073 656c 662e 6e61 6d65 290a 0a20  s, self.name).. 
-0002d320: 2020 2064 6566 2074 7261 6e73 6c61 7469     def translati
-0002d330: 6f6e 5f69 6e70 6c61 6365 2873 656c 662c  on_inplace(self,
-0002d340: 206f 6666 7365 743a 2076 6f6c 6d64 6c72   offset: volmdlr
-0002d350: 2e56 6563 746f 7233 4429 3a0a 2020 2020  .Vector3D):.    
-0002d360: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002d370: 436f 6e74 6f75 7233 4420 7472 616e 736c  Contour3D transl
-0002d380: 6174 696f 6e2e 204f 626a 6563 7420 6973  ation. Object is
-0002d390: 2075 7064 6174 6564 2069 6e70 6c61 6365   updated inplace
-0002d3a0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0002d3b0: 6d20 6f66 6673 6574 3a20 7472 616e 736c  m offset: transl
-0002d3c0: 6174 696f 6e20 7665 6374 6f72 2e0a 2020  ation vector..  
-0002d3d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002d3e0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-0002d3f0: 2227 696e 706c 6163 6527 206d 6574 686f  "'inplace' metho
-0002d400: 6473 2061 7265 2064 6570 7265 6361 7465  ds are deprecate
-0002d410: 642e 2055 7365 2061 206e 6f74 2069 6e70  d. Use a not inp
-0002d420: 6c61 6365 206d 6574 686f 6420 696e 7374  lace method inst
-0002d430: 6561 642e 222c 2044 6570 7265 6361 7469  ead.", Deprecati
-0002d440: 6f6e 5761 726e 696e 6729 0a0a 2020 2020  onWarning)..    
-0002d450: 2020 2020 666f 7220 6564 6765 2069 6e20      for edge in 
-0002d460: 7365 6c66 2e70 7269 6d69 7469 7665 733a  self.primitives:
-0002d470: 0a20 2020 2020 2020 2020 2020 2065 6467  .            edg
-0002d480: 652e 7472 616e 736c 6174 696f 6e5f 696e  e.translation_in
-0002d490: 706c 6163 6528 6f66 6673 6574 290a 0a20  place(offset).. 
-0002d4a0: 2020 2064 6566 206f 7264 6572 5f63 6f6e     def order_con
-0002d4b0: 746f 7572 2873 656c 6629 3a0a 2020 2020  tour(self):.    
-0002d4c0: 2020 2020 2320 6e65 775f 7072 696d 6974      # new_primit
-0002d4d0: 6976 6573 203d 205b 5d0a 2020 2020 2020  ives = [].      
-0002d4e0: 2020 2320 706f 696e 7473 203d 2073 656c    # points = sel
-0002d4f0: 662e 6f72 6465 7269 6e67 5f63 6f6e 746f  f.ordering_conto
-0002d500: 7572 2829 0a20 2020 2020 2020 2023 2066  ur().        # f
-0002d510: 6f72 2070 312c 2070 3220 696e 2070 6f69  or p1, p2 in poi
-0002d520: 6e74 733a 0a20 2020 2020 2020 2023 2020  nts:.        #  
-0002d530: 2020 206e 6577 5f70 7269 6d69 7469 7665     new_primitive
-0002d540: 732e 6170 7065 6e64 2876 6f6c 6d64 6c72  s.append(volmdlr
-0002d550: 2e65 6467 6573 2e4c 696e 6553 6567 6d65  .edges.LineSegme
-0002d560: 6e74 3344 2870 312c 2070 3229 290a 2020  nt3D(p1, p2)).  
-0002d570: 2020 2020 2020 2320 7365 6c66 2e70 7269        # self.pri
-0002d580: 6d69 7469 7665 7320 3d20 6e65 775f 7072  mitives = new_pr
-0002d590: 696d 6974 6976 6573 0a0a 2020 2020 2020  imitives..      
-0002d5a0: 2020 696e 6974 6961 6c5f 706f 696e 7473    initial_points
-0002d5b0: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-0002d5c0: 7220 7072 696d 6974 6976 6520 696e 2073  r primitive in s
-0002d5d0: 656c 662e 7072 696d 6974 6976 6573 3a0a  elf.primitives:.
-0002d5e0: 2020 2020 2020 2020 2020 2020 696e 6974              init
-0002d5f0: 6961 6c5f 706f 696e 7473 2e61 7070 656e  ial_points.appen
-0002d600: 6428 2870 7269 6d69 7469 7665 2e73 7461  d((primitive.sta
-0002d610: 7274 2c20 7072 696d 6974 6976 652e 656e  rt, primitive.en
-0002d620: 6429 290a 0a20 2020 2020 2020 206e 6577  d))..        new
-0002d630: 5f70 7269 6d69 7469 7665 7320 3d20 5b5d  _primitives = []
-0002d640: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0002d650: 2e69 735f 6f72 6465 7265 6428 293a 0a20  .is_ordered():. 
-0002d660: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0002d670: 6e20 7365 6c66 0a20 2020 2020 2020 2070  n self.        p
-0002d680: 6f69 6e74 7320 3d20 7365 6c66 2e6f 7264  oints = self.ord
-0002d690: 6572 696e 675f 636f 6e74 6f75 7228 290a  ering_contour().
-0002d6a0: 2020 2020 2020 2020 666f 7220 7031 2c20          for p1, 
-0002d6b0: 7032 2069 6e20 706f 696e 7473 3a0a 2020  p2 in points:.  
-0002d6c0: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
-0002d6d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002d6e0: 6e64 6578 203d 2069 6e69 7469 616c 5f70  ndex = initial_p
-0002d6f0: 6f69 6e74 732e 696e 6465 7828 2870 312c  oints.index((p1,
-0002d700: 2070 3229 290a 2020 2020 2020 2020 2020   p2)).          
-0002d710: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
-0002d720: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-0002d730: 2020 2020 2069 6e64 6578 203d 2069 6e69       index = ini
-0002d740: 7469 616c 5f70 6f69 6e74 732e 696e 6465  tial_points.inde
-0002d750: 7828 2870 322c 2070 3129 290a 0a20 2020  x((p2, p1))..   
-0002d760: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-0002d770: 7374 616e 6365 2873 656c 662e 7072 696d  stance(self.prim
-0002d780: 6974 6976 6573 5b69 6e64 6578 5d2c 2076  itives[index], v
-0002d790: 6f6c 6d64 6c72 2e65 6467 6573 2e4c 696e  olmdlr.edges.Lin
-0002d7a0: 6553 6567 6d65 6e74 3344 293a 0a20 2020  eSegment3D):.   
-0002d7b0: 2020 2020 2020 2020 2020 2020 206e 6577               new
-0002d7c0: 5f70 7269 6d69 7469 7665 732e 6170 7065  _primitives.appe
-0002d7d0: 6e64 2876 6f6c 6d64 6c72 2e65 6467 6573  nd(volmdlr.edges
-0002d7e0: 2e4c 696e 6553 6567 6d65 6e74 3344 2870  .LineSegment3D(p
-0002d7f0: 312c 2070 3229 290a 2020 2020 2020 2020  1, p2)).        
-0002d800: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0002d810: 6e63 6528 7365 6c66 2e70 7269 6d69 7469  nce(self.primiti
-0002d820: 7665 735b 696e 6465 785d 2c20 766f 6c6d  ves[index], volm
-0002d830: 646c 722e 6564 6765 732e 4172 6333 4429  dlr.edges.Arc3D)
-0002d840: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002d850: 2020 6e65 775f 7072 696d 6974 6976 6573    new_primitives
-0002d860: 2e61 7070 656e 6428 766f 6c6d 646c 722e  .append(volmdlr.
-0002d870: 6564 6765 732e 4172 6333 4428 7031 2c20  edges.Arc3D(p1, 
-0002d880: 7365 6c66 2e70 7269 6d69 7469 7665 735b  self.primitives[
-0002d890: 696e 6465 785d 2e69 6e74 6572 696f 722c  index].interior,
-0002d8a0: 2070 3229 290a 2020 2020 2020 2020 2020   p2)).          
-0002d8b0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-0002d8c0: 6528 7365 6c66 2e70 7269 6d69 7469 7665  e(self.primitive
-0002d8d0: 735b 696e 6465 785d 2c20 766f 6c6d 646c  s[index], volmdl
-0002d8e0: 722e 6564 6765 732e 4253 706c 696e 6543  r.edges.BSplineC
-0002d8f0: 7572 7665 3344 293a 0a20 2020 2020 2020  urve3D):.       
-0002d900: 2020 2020 2020 2020 2069 6620 2873 656c           if (sel
-0002d910: 662e 7072 696d 6974 6976 6573 5b69 6e64  f.primitives[ind
-0002d920: 6578 5d2e 7374 6172 7420 3d3d 2070 3120  ex].start == p1 
-0002d930: 616e 6420 7365 6c66 2e70 7269 6d69 7469  and self.primiti
-0002d940: 7665 735b 696e 6465 785d 2e65 6e64 203d  ves[index].end =
-0002d950: 3d20 7032 293a 0a20 2020 2020 2020 2020  = p2):.         
-0002d960: 2020 2020 2020 2020 2020 206e 6577 5f70             new_p
-0002d970: 7269 6d69 7469 7665 732e 6170 7065 6e64  rimitives.append
-0002d980: 2873 656c 662e 7072 696d 6974 6976 6573  (self.primitives
-0002d990: 5b69 6e64 6578 5d29 0a20 2020 2020 2020  [index]).       
-0002d9a0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0002d9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d9c0: 2020 206e 6577 5f70 7269 6d69 7469 7665     new_primitive
-0002d9d0: 732e 6170 7065 6e64 2873 656c 662e 7072  s.append(self.pr
-0002d9e0: 696d 6974 6976 6573 5b69 6e64 6578 5d2e  imitives[index].
-0002d9f0: 7265 7665 7273 6528 2929 0a0a 2020 2020  reverse())..    
-0002da00: 2020 2020 7365 6c66 2e70 7269 6d69 7469      self.primiti
-0002da10: 7665 7320 3d20 6e65 775f 7072 696d 6974  ves = new_primit
-0002da20: 6976 6573 0a0a 2020 2020 2020 2020 7265  ives..        re
-0002da30: 7475 726e 2073 656c 660a 0a20 2020 2064  turn self..    d
-0002da40: 6566 2066 7261 6d65 5f6d 6170 7069 6e67  ef frame_mapping
-0002da50: 2873 656c 662c 2066 7261 6d65 3a20 766f  (self, frame: vo
-0002da60: 6c6d 646c 722e 4672 616d 6533 442c 2073  lmdlr.Frame3D, s
-0002da70: 6964 653a 2073 7472 293a 0a20 2020 2020  ide: str):.     
-0002da80: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-0002da90: 6861 6e67 6573 2066 7261 6d65 5f6d 6170  hanges frame_map
-0002daa0: 7069 6e67 2061 6e64 2072 6574 7572 6e20  ping and return 
-0002dab0: 6120 6e65 7720 436f 6e74 6f75 7233 440a  a new Contour3D.
-0002dac0: 2020 2020 2020 2020 7369 6465 203d 2027          side = '
-0002dad0: 6f6c 6427 206f 7220 276e 6577 270a 2020  old' or 'new'.  
-0002dae0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002daf0: 2020 6e65 775f 6564 6765 7320 3d20 5b65    new_edges = [e
-0002db00: 6467 652e 6672 616d 655f 6d61 7070 696e  dge.frame_mappin
-0002db10: 6728 6672 616d 652c 2073 6964 6529 2066  g(frame, side) f
-0002db20: 6f72 2065 6467 6520 696e 0a20 2020 2020  or edge in.     
-0002db30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002db40: 7365 6c66 2e70 7269 6d69 7469 7665 735d  self.primitives]
-0002db50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002db60: 436f 6e74 6f75 7233 4428 6e65 775f 6564  Contour3D(new_ed
-0002db70: 6765 732c 2073 656c 662e 6e61 6d65 290a  ges, self.name).
-0002db80: 0a20 2020 2064 6566 2066 7261 6d65 5f6d  .    def frame_m
-0002db90: 6170 7069 6e67 5f69 6e70 6c61 6365 2873  apping_inplace(s
-0002dba0: 656c 662c 2066 7261 6d65 3a20 766f 6c6d  elf, frame: volm
-0002dbb0: 646c 722e 4672 616d 6533 442c 2073 6964  dlr.Frame3D, sid
-0002dbc0: 653a 2073 7472 293a 0a20 2020 2020 2020  e: str):.       
-0002dbd0: 2022 2222 0a20 2020 2020 2020 2043 6861   """.        Cha
-0002dbe0: 6e67 6573 2066 7261 6d65 5f6d 6170 7069  nges frame_mappi
-0002dbf0: 6e67 2061 6e64 2074 6865 206f 626a 6563  ng and the objec
-0002dc00: 7420 6973 2075 7064 6174 6564 2069 6e70  t is updated inp
-0002dc10: 6c61 6365 2e0a 0a20 2020 2020 2020 203a  lace...        :
-0002dc20: 7061 7261 6d20 7369 6465 3a20 276f 6c64  param side: 'old
-0002dc30: 2720 6f72 2027 6e65 7727 0a20 2020 2020  ' or 'new'.     
-0002dc40: 2020 2022 2222 0a20 2020 2020 2020 2077     """.        w
-0002dc50: 6172 6e69 6e67 732e 7761 726e 2822 2769  arnings.warn("'i
-0002dc60: 6e70 6c61 6365 2720 6d65 7468 6f64 7320  nplace' methods 
-0002dc70: 6172 6520 6465 7072 6563 6174 6564 2e20  are deprecated. 
-0002dc80: 5573 6520 6120 6e6f 7420 696e 706c 6163  Use a not inplac
-0002dc90: 6520 6d65 7468 6f64 2069 6e73 7465 6164  e method instead
-0002dca0: 2e22 2c20 4465 7072 6563 6174 696f 6e57  .", DeprecationW
-0002dcb0: 6172 6e69 6e67 290a 0a20 2020 2020 2020  arning)..       
-0002dcc0: 2066 6f72 2065 6467 6520 696e 2073 656c   for edge in sel
-0002dcd0: 662e 7072 696d 6974 6976 6573 3a0a 2020  f.primitives:.  
-0002dce0: 2020 2020 2020 2020 2020 6564 6765 2e66            edge.f
-0002dcf0: 7261 6d65 5f6d 6170 7069 6e67 5f69 6e70  rame_mapping_inp
-0002dd00: 6c61 6365 2866 7261 6d65 2c20 7369 6465  lace(frame, side
-0002dd10: 290a 0a20 2020 2064 6566 2063 6f70 7928  )..    def copy(
-0002dd20: 7365 6c66 2c20 6465 6570 3d54 7275 652c  self, deep=True,
-0002dd30: 206d 656d 6f3d 4e6f 6e65 293a 0a20 2020   memo=None):.   
-0002dd40: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002dd50: 2043 6f70 6965 7320 7468 6520 436f 6e74   Copies the Cont
-0002dd60: 6f75 7233 442e 0a20 2020 2020 2020 2022  our3D..        "
-0002dd70: 2222 0a20 2020 2020 2020 206e 6577 5f65  "".        new_e
-0002dd80: 6467 6573 203d 205b 6564 6765 2e63 6f70  dges = [edge.cop
-0002dd90: 7928 6465 6570 3d64 6565 702c 206d 656d  y(deep=deep, mem
-0002dda0: 6f3d 6d65 6d6f 2920 666f 7220 6564 6765  o=memo) for edge
-0002ddb0: 2069 6e20 7365 6c66 2e70 7269 6d69 7469   in self.primiti
-0002ddc0: 7665 735d 0a20 2020 2020 2020 2023 2069  ves].        # i
-0002ddd0: 6620 7365 6c66 2e70 6f69 6e74 5f69 6e73  f self.point_ins
-0002dde0: 6964 655f 636f 6e74 6f75 7220 6973 206e  ide_contour is n
-0002ddf0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0002de00: 2023 2020 2020 206e 6577 5f70 6f69 6e74   #     new_point
-0002de10: 5f69 6e73 6964 655f 636f 6e74 6f75 7220  _inside_contour 
-0002de20: 3d20 7365 6c66 2e70 6f69 6e74 5f69 6e73  = self.point_ins
-0002de30: 6964 655f 636f 6e74 6f75 722e 636f 7079  ide_contour.copy
-0002de40: 2829 0a20 2020 2020 2020 2023 2065 6c73  ().        # els
-0002de50: 653a 0a20 2020 2020 2020 2023 2020 2020  e:.        #    
-0002de60: 206e 6577 5f70 6f69 6e74 5f69 6e73 6964   new_point_insid
-0002de70: 655f 636f 6e74 6f75 7220 3d20 4e6f 6e65  e_contour = None
-0002de80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002de90: 436f 6e74 6f75 7233 4428 6e65 775f 6564  Contour3D(new_ed
-0002dea0: 6765 732c 2073 656c 662e 6e61 6d65 290a  ges, self.name).
-0002deb0: 0a20 2020 2064 6566 2070 6c6f 7428 7365  .    def plot(se
-0002dec0: 6c66 2c20 6178 3d4e 6f6e 652c 2063 6f6c  lf, ax=None, col
-0002ded0: 6f72 3d27 6b27 2c20 616c 7068 613d 312c  or='k', alpha=1,
-0002dee0: 2065 6467 655f 6465 7461 696c 733d 4661   edge_details=Fa
-0002def0: 6c73 6529 3a0a 2020 2020 2020 2020 6966  lse):.        if
-0002df00: 2061 7820 6973 204e 6f6e 653a 0a20 2020   ax is None:.   
-0002df10: 2020 2020 2020 2020 2023 2061 7820 3d20           # ax = 
-0002df20: 4178 6573 3344 2870 6c74 2e66 6967 7572  Axes3D(plt.figur
-0002df30: 6528 2929 0a20 2020 2020 2020 2020 2020  e()).           
-0002df40: 2066 6967 203d 2070 6c74 2e66 6967 7572   fig = plt.figur
-0002df50: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-0002df60: 6178 203d 2066 6967 2e61 6464 5f73 7562  ax = fig.add_sub
-0002df70: 706c 6f74 2831 3131 2c20 7072 6f6a 6563  plot(111, projec
-0002df80: 7469 6f6e 3d27 3364 2729 0a0a 2020 2020  tion='3d')..    
-0002df90: 2020 2020 666f 7220 6564 6765 2069 6e20      for edge in 
-0002dfa0: 7365 6c66 2e70 7269 6d69 7469 7665 733a  self.primitives:
-0002dfb0: 0a20 2020 2020 2020 2020 2020 2065 6467  .            edg
-0002dfc0: 652e 706c 6f74 2861 783d 6178 2c20 636f  e.plot(ax=ax, co
-0002dfd0: 6c6f 723d 636f 6c6f 722c 2061 6c70 6861  lor=color, alpha
-0002dfe0: 3d61 6c70 6861 2c0a 2020 2020 2020 2020  =alpha,.        
-0002dff0: 2020 2020 2020 2020 2020 2020 2020 6564                ed
-0002e000: 6765 5f65 6e64 733d 6564 6765 5f64 6574  ge_ends=edge_det
-0002e010: 6169 6c73 2c20 6564 6765 5f64 6972 6563  ails, edge_direc
-0002e020: 7469 6f6e 3d65 6467 655f 6465 7461 696c  tion=edge_detail
-0002e030: 7329 0a0a 2020 2020 2020 2020 7265 7475  s)..        retu
-0002e040: 726e 2061 780a 0a20 2020 2064 6566 205f  rn ax..    def _
-0002e050: 626f 756e 6469 6e67 5f62 6f78 2873 656c  bounding_box(sel
-0002e060: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-0002e070: 2020 2020 2020 2020 436f 6d70 7574 6573          Computes
-0002e080: 2074 6865 2062 6f75 6e64 696e 6720 626f   the bounding bo
-0002e090: 7820 6f66 2074 6865 2063 6f6e 746f 7572  x of the contour
-0002e0a0: 3344 2e0a 0a20 2020 2020 2020 2022 2222  3D...        """
-0002e0b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002e0c0: 766f 6c6d 646c 722e 636f 7265 2e42 6f75  volmdlr.core.Bou
-0002e0d0: 6e64 696e 6742 6f78 2e66 726f 6d5f 626f  ndingBox.from_bo
-0002e0e0: 756e 6469 6e67 5f62 6f78 6573 285b 702e  unding_boxes([p.
-0002e0f0: 626f 756e 6469 6e67 5f62 6f78 2066 6f72  bounding_box for
-0002e100: 2070 2069 6e20 7365 6c66 2e70 7269 6d69   p in self.primi
-0002e110: 7469 7665 735d 290a 0a20 2020 2040 7072  tives])..    @pr
-0002e120: 6f70 6572 7479 0a20 2020 2064 6566 2062  operty.    def b
-0002e130: 6f75 6e64 696e 675f 626f 7828 7365 6c66  ounding_box(self
-0002e140: 293a 0a20 2020 2020 2020 2069 6620 6e6f  ):.        if no
-0002e150: 7420 7365 6c66 2e5f 7574 645f 626f 756e  t self._utd_boun
-0002e160: 6469 6e67 5f62 6f78 3a0a 2020 2020 2020  ding_box:.      
-0002e170: 2020 2020 2020 7365 6c66 2e5f 6262 6f78        self._bbox
-0002e180: 203d 2073 656c 662e 5f62 6f75 6e64 696e   = self._boundin
-0002e190: 675f 626f 7828 290a 2020 2020 2020 2020  g_box().        
-0002e1a0: 2020 2020 7365 6c66 2e5f 7574 645f 626f      self._utd_bo
-0002e1b0: 756e 6469 6e67 5f62 6f78 203d 2054 7275  unding_box = Tru
-0002e1c0: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
-0002e1d0: 2073 656c 662e 5f62 626f 780a 0a20 2020   self._bbox..   
-0002e1e0: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
-0002e1f0: 2020 6465 6620 6578 7472 6163 745f 636f    def extract_co
-0002e200: 6e74 6f75 7273 2863 6c73 2c20 636f 6e74  ntours(cls, cont
-0002e210: 6f75 722c 2070 6f69 6e74 313a 2076 6f6c  our, point1: vol
-0002e220: 6d64 6c72 2e50 6f69 6e74 3344 2c0a 2020  mdlr.Point3D,.  
+0002be90: 7261 775f 6564 6765 2e65 6e64 2e70 6f69  raw_edge.end.poi
+0002bea0: 6e74 5f64 6973 7461 6e63 6528 6c61 7374  nt_distance(last
+0002beb0: 5f65 6467 652e 656e 6429 5d0a 2020 2020  _edge.end)].    
+0002bec0: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
+0002bed0: 6469 7374 616e 6365 732e 696e 6465 7828  distances.index(
+0002bee0: 6d69 6e28 6469 7374 616e 6365 7329 290a  min(distances)).
+0002bef0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+0002bf00: 696e 2864 6973 7461 6e63 6573 2920 3e20  in(distances) > 
+0002bf10: 3665 2d34 3a0a 2020 2020 2020 2020 2020  6e-4:.          
+0002bf20: 2020 2020 2020 2320 4772 6565 6e20 636f        # Green co
+0002bf30: 6c6f 7220 3a20 7765 6c6c 2d70 6c61 6365  lor : well-place
+0002bf40: 6420 616e 6420 7765 6c6c 2d72 6561 640a  d and well-read.
+0002bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bf60: 6178 203d 206c 6173 745f 6564 6765 2e70  ax = last_edge.p
+0002bf70: 6c6f 7428 636f 6c6f 723d 2767 2729 0a20  lot(color='g'). 
+0002bf80: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002bf90: 6f72 2072 6520 696e 2072 6177 5f65 6467  or re in raw_edg
+0002bfa0: 6573 5b3a 3220 2b20 695d 3a0a 2020 2020  es[:2 + i]:.    
+0002bfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bfc0: 7265 2e70 6c6f 7428 6178 3d61 782c 2063  re.plot(ax=ax, c
+0002bfd0: 6f6c 6f72 3d27 6727 290a 2020 2020 2020  olor='g').      
+0002bfe0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0002bff0: 2e73 7461 7274 2e70 6c6f 7428 6178 3d61  .start.plot(ax=a
+0002c000: 782c 2063 6f6c 6f72 3d27 6727 290a 2020  x, color='g').  
+0002c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c020: 2020 7265 2e65 6e64 2e70 6c6f 7428 6178    re.end.plot(ax
+0002c030: 3d61 782c 2063 6f6c 6f72 3d27 6727 290a  =ax, color='g').
+0002c040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c050: 6c61 7374 5f65 6467 652e 656e 642e 706c  last_edge.end.pl
+0002c060: 6f74 2861 783d 6178 2c20 636f 6c6f 723d  ot(ax=ax, color=
+0002c070: 2772 2729 0a20 2020 2020 2020 2020 2020  'r').           
+0002c080: 2020 2020 2023 2052 6564 2063 6f6c 6f72       # Red color
+0002c090: 203a 2063 616e 2774 2062 6520 636f 6e6e   : can't be conn
+0002c0a0: 6563 7465 6420 746f 2072 6564 2064 6f74  ected to red dot
+0002c0b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c0c0: 2072 6177 5f65 6467 652e 706c 6f74 2861   raw_edge.plot(a
+0002c0d0: 783d 6178 2c20 636f 6c6f 723d 2772 2729  x=ax, color='r')
+0002c0e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c0f0: 2023 2042 6c61 636b 2063 6f6c 6f72 203a   # Black color :
+0002c100: 2074 6f20 6265 2070 6c61 6365 640a 2020   to be placed.  
+0002c110: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0002c120: 7220 7265 2069 6e20 7261 775f 6564 6765  r re in raw_edge
+0002c130: 735b 3220 2b20 6920 2b20 313a 5d3a 0a20  s[2 + i + 1:]:. 
+0002c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c150: 2020 2072 652e 706c 6f74 2861 783d 6178     re.plot(ax=ax
+0002c160: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002c170: 2020 2020 2020 7265 2e73 7461 7274 2e70        re.start.p
+0002c180: 6c6f 7428 6178 3d61 7829 0a20 2020 2020  lot(ax=ax).     
+0002c190: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0002c1a0: 652e 656e 642e 706c 6f74 2861 783d 6178  e.end.plot(ax=ax
+0002c1b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002c1c0: 2020 2320 6465 6c74 6178 3120 3d20 6162    # deltax1 = ab
+0002c1d0: 7328 7261 775f 6564 6765 2e73 7461 7274  s(raw_edge.start
+0002c1e0: 2e78 202d 206c 6173 745f 6564 6765 2e65  .x - last_edge.e
+0002c1f0: 6e64 2e78 290a 2020 2020 2020 2020 2020  nd.x).          
+0002c200: 2020 2020 2020 2320 6465 6c74 6178 3220        # deltax2 
+0002c210: 3d20 6162 7328 7261 775f 6564 6765 2e65  = abs(raw_edge.e
+0002c220: 6e64 2e78 202d 206c 6173 745f 6564 6765  nd.x - last_edge
+0002c230: 2e65 6e64 2e78 290a 2020 2020 2020 2020  .end.x).        
+0002c240: 2020 2020 2020 2020 2320 6465 6c74 6179          # deltay
+0002c250: 3120 3d20 6162 7328 7261 775f 6564 6765  1 = abs(raw_edge
+0002c260: 2e73 7461 7274 2e79 202d 206c 6173 745f  .start.y - last_
+0002c270: 6564 6765 2e65 6e64 2e79 290a 2020 2020  edge.end.y).    
+0002c280: 2020 2020 2020 2020 2020 2020 2320 6465              # de
+0002c290: 6c74 6179 3220 3d20 6162 7328 7261 775f  ltay2 = abs(raw_
+0002c2a0: 6564 6765 2e65 6e64 2e79 202d 206c 6173  edge.end.y - las
+0002c2b0: 745f 6564 6765 2e65 6e64 2e79 290a 2020  t_edge.end.y).  
+0002c2c0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0002c2d0: 6465 6c74 617a 3120 3d20 6162 7328 7261  deltaz1 = abs(ra
+0002c2e0: 775f 6564 6765 2e73 7461 7274 2e7a 202d  w_edge.start.z -
+0002c2f0: 206c 6173 745f 6564 6765 2e65 6e64 2e7a   last_edge.end.z
+0002c300: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002c310: 2020 2320 6465 6c74 617a 3220 3d20 6162    # deltaz2 = ab
+0002c320: 7328 7261 775f 6564 6765 2e65 6e64 2e7a  s(raw_edge.end.z
+0002c330: 202d 206c 6173 745f 6564 6765 2e65 6e64   - last_edge.end
+0002c340: 2e7a 290a 2020 2020 2020 2020 2020 2020  .z).            
+0002c350: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+0002c360: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
+0002c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c380: 2020 2066 274e 756d 6265 7220 6f66 2065     f'Number of e
+0002c390: 6467 6573 3a20 7b6c 656e 2872 6177 5f65  dges: {len(raw_e
+0002c3a0: 6467 6573 297d 272c 0a20 2020 2020 2020  dges)}',.       
+0002c3b0: 2020 2020 2020 2020 2020 2020 2027 4564               'Ed
+0002c3c0: 6765 7320 6f66 2063 6f6e 746f 7572 206e  ges of contour n
+0002c3d0: 6f74 2066 6f6c 6c6f 7769 6e67 2065 6163  ot following eac
+0002c3e0: 6820 6f74 6865 7227 2c0a 2020 2020 2020  h other',.      
+0002c3f0: 2020 2020 2020 2020 2020 2020 2020 6627                f'
+0002c400: 6465 6c74 615f 7820 3d20 7b61 6273 2872  delta_x = {abs(r
+0002c410: 6177 5f65 6467 652e 7374 6172 742e 7820  aw_edge.start.x 
+0002c420: 2d20 6c61 7374 5f65 6467 652e 656e 642e  - last_edge.end.
+0002c430: 7829 7d2c 270a 2020 2020 2020 2020 2020  x)},'.          
+0002c440: 2020 2020 2020 2020 2020 6627 207b 6162            f' {ab
+0002c450: 7328 7261 775f 6564 6765 2e65 6e64 2e78  s(raw_edge.end.x
+0002c460: 202d 206c 6173 745f 6564 6765 2e65 6e64   - last_edge.end
+0002c470: 2e78 297d 272c 0a20 2020 2020 2020 2020  .x)}',.         
+0002c480: 2020 2020 2020 2020 2020 2066 2764 656c             f'del
+0002c490: 7461 5f79 203d 207b 6162 7328 7261 775f  ta_y = {abs(raw_
+0002c4a0: 6564 6765 2e73 7461 7274 2e79 202d 206c  edge.start.y - l
+0002c4b0: 6173 745f 6564 6765 2e65 6e64 2e79 297d  ast_edge.end.y)}
+0002c4c0: 2c27 0a20 2020 2020 2020 2020 2020 2020  ,'.             
+0002c4d0: 2020 2020 2020 2066 2720 7b61 6273 2872         f' {abs(r
+0002c4e0: 6177 5f65 6467 652e 656e 642e 7920 2d20  aw_edge.end.y - 
+0002c4f0: 6c61 7374 5f65 6467 652e 656e 642e 7929  last_edge.end.y)
+0002c500: 7d27 2c0a 2020 2020 2020 2020 2020 2020  }',.            
+0002c510: 2020 2020 2020 2020 6627 6465 6c74 615f          f'delta_
+0002c520: 7a20 3d20 7b61 6273 2872 6177 5f65 6467  z = {abs(raw_edg
+0002c530: 652e 7374 6172 742e 7a20 2d20 6c61 7374  e.start.z - last
+0002c540: 5f65 6467 652e 656e 642e 7a29 7d2c 270a  _edge.end.z)},'.
+0002c550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c560: 2020 2020 6627 207b 6162 7328 7261 775f      f' {abs(raw_
+0002c570: 6564 6765 2e65 6e64 2e7a 202d 206c 6173  edge.end.z - las
+0002c580: 745f 6564 6765 2e65 6e64 2e7a 297d 272c  t_edge.end.z)}',
+0002c590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c5a0: 2020 2020 2066 2764 6973 7461 6e63 6520       f'distance 
+0002c5b0: 3d20 7b6d 696e 2864 6973 7461 6e63 6573  = {min(distances
+0002c5c0: 297d 2729 0a20 2020 2020 2020 2020 2020  )}').           
+0002c5d0: 2069 6620 696e 6465 7820 3d3d 2030 3a0a   if index == 0:.
+0002c5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c5f0: 6c61 7374 5f65 6467 6520 3d20 7261 775f  last_edge = raw_
+0002c600: 6564 6765 0a20 2020 2020 2020 2020 2020  edge.           
+0002c610: 2065 6c69 6620 696e 6465 7820 3d3d 2031   elif index == 1
+0002c620: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002c630: 2020 6c61 7374 5f65 6467 6520 3d20 7261    last_edge = ra
+0002c640: 775f 6564 6765 2e72 6576 6572 7365 2829  w_edge.reverse()
+0002c650: 0a0a 2020 2020 2020 2020 2020 2020 6564  ..            ed
+0002c660: 6765 732e 6170 7065 6e64 286c 6173 745f  ges.append(last_
+0002c670: 6564 6765 290a 2020 2020 2020 2020 7265  edge).        re
+0002c680: 7475 726e 2063 6c73 2865 6467 6573 2c20  turn cls(edges, 
+0002c690: 6e61 6d65 3d6e 616d 6529 0a0a 2020 2020  name=name)..    
+0002c6a0: 6465 6620 746f 5f73 7465 7028 7365 6c66  def to_step(self
+0002c6b0: 2c20 6375 7272 656e 745f 6964 2c20 7375  , current_id, su
+0002c6c0: 7266 6163 655f 6964 3d4e 6f6e 652c 2073  rface_id=None, s
+0002c6d0: 7572 6661 6365 3364 3d4e 6f6e 6529 3a0a  urface3d=None):.
+0002c6e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002c6f0: 2020 2020 4372 6561 7465 2061 2043 6972      Create a Cir
+0002c700: 636c 6533 4420 7374 6570 206f 626a 6563  cle3D step objec
+0002c710: 742e 0a0a 2020 2020 2020 2020 2222 220a  t...        """.
+0002c720: 2020 2020 2020 2020 636f 6e74 656e 7420          content 
+0002c730: 3d20 2727 0a20 2020 2020 2020 2065 6467  = ''.        edg
+0002c740: 655f 6964 7320 3d20 5b5d 0a20 2020 2020  e_ids = [].     
+0002c750: 2020 2066 6f72 2070 7269 6d69 7469 7665     for primitive
+0002c760: 2069 6e20 7365 6c66 2e70 7269 6d69 7469   in self.primiti
+0002c770: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
+0002c780: 2069 6620 7072 696d 6974 6976 652e 5f5f   if primitive.__
+0002c790: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+0002c7a0: 203d 3d20 2742 5370 6c69 6e65 4375 7276   == 'BSplineCurv
+0002c7b0: 6533 4427 3a0a 2020 2020 2020 2020 2020  e3D':.          
+0002c7c0: 2020 2020 2020 6d65 7468 6f64 5f6e 616d        method_nam
+0002c7d0: 6520 3d20 6627 7b70 7269 6d69 7469 7665  e = f'{primitive
+0002c7e0: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
+0002c7f0: 655f 5f2e 6c6f 7765 7228 297d 5f74 6f5f  e__.lower()}_to_
+0002c800: 3264 270a 2020 2020 2020 2020 2020 2020  2d'.            
+0002c810: 2020 2020 6375 7276 6532 6420 3d20 6765      curve2d = ge
+0002c820: 7461 7474 7228 7375 7266 6163 6533 642c  tattr(surface3d,
+0002c830: 206d 6574 686f 645f 6e61 6d65 2928 7072   method_name)(pr
+0002c840: 696d 6974 6976 6529 5b30 5d0a 2020 2020  imitive)[0].    
+0002c850: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+0002c860: 7572 7665 3264 2e5f 5f63 6c61 7373 5f5f  urve2d.__class__
+0002c870: 2e5f 5f6e 616d 655f 5f20 3d3d 2027 4c69  .__name__ == 'Li
+0002c880: 6e65 5365 676d 656e 7433 4427 3a0a 2020  neSegment3D':.  
+0002c890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c8a0: 2020 6375 7276 6532 6420 3d20 6375 7276    curve2d = curv
+0002c8b0: 6532 642e 746f 5f62 7370 6c69 6e65 5f63  e2d.to_bspline_c
+0002c8c0: 7572 7665 2829 0a20 2020 2020 2020 2020  urve().         
+0002c8d0: 2020 2020 2020 2070 7269 6d69 7469 7665         primitive
+0002c8e0: 5f63 6f6e 7465 6e74 2c20 7072 696d 6974  _content, primit
+0002c8f0: 6976 655f 6964 7320 3d20 7072 696d 6974  ive_ids = primit
+0002c900: 6976 652e 746f 5f73 7465 7028 0a20 2020  ive.to_step(.   
+0002c910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c920: 2063 7572 7265 6e74 5f69 642c 2073 7572   current_id, sur
+0002c930: 6661 6365 5f69 643d 7375 7266 6163 655f  face_id=surface_
+0002c940: 6964 2c20 6375 7276 6532 643d 6375 7276  id, curve2d=curv
+0002c950: 6532 6429 0a20 2020 2020 2020 2020 2020  e2d).           
+0002c960: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002c970: 2020 2020 2020 2070 7269 6d69 7469 7665         primitive
+0002c980: 5f63 6f6e 7465 6e74 2c20 7072 696d 6974  _content, primit
+0002c990: 6976 655f 6964 7320 3d20 7072 696d 6974  ive_ids = primit
+0002c9a0: 6976 652e 746f 5f73 7465 7028 6375 7272  ive.to_step(curr
+0002c9b0: 656e 745f 6964 2c20 7375 7266 6163 655f  ent_id, surface_
+0002c9c0: 6964 3d73 7572 6661 6365 5f69 6429 0a20  id=surface_id). 
+0002c9d0: 2020 2020 2020 2020 2020 2063 6f6e 7465             conte
+0002c9e0: 6e74 202b 3d20 7072 696d 6974 6976 655f  nt += primitive_
+0002c9f0: 636f 6e74 656e 740a 2020 2020 2020 2020  content.        
+0002ca00: 2020 2020 6375 7272 656e 745f 6964 203d      current_id =
+0002ca10: 2070 7269 6d69 7469 7665 5f69 6473 5b2d   primitive_ids[-
+0002ca20: 315d 202b 2031 0a20 2020 2020 2020 2020  1] + 1.         
+0002ca30: 2020 2066 6f72 2070 7269 6d69 7469 7665     for primitive
+0002ca40: 5f69 6420 696e 2070 7269 6d69 7469 7665  _id in primitive
+0002ca50: 5f69 6473 3a0a 2020 2020 2020 2020 2020  _ids:.          
+0002ca60: 2020 2020 2020 636f 6e74 656e 7420 2b3d        content +=
+0002ca70: 2022 237b 7d20 3d20 4f52 4945 4e54 4544   "#{} = ORIENTED
+0002ca80: 5f45 4447 4528 277b 7d27 2c2a 2c2a 2c23  _EDGE('{}',*,*,#
+0002ca90: 7b7d 2c2e 542e 293b 5c6e 222e 666f 726d  {},.T.);\n".form
+0002caa0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+0002cab0: 2020 2020 2020 2020 6375 7272 656e 745f          current_
+0002cac0: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
+0002cad0: 2020 2020 2020 2020 7072 696d 6974 6976          primitiv
+0002cae0: 652e 6e61 6d65 2c0a 2020 2020 2020 2020  e.name,.        
+0002caf0: 2020 2020 2020 2020 2020 2020 7072 696d              prim
+0002cb00: 6974 6976 655f 6964 290a 2020 2020 2020  itive_id).      
+0002cb10: 2020 2020 2020 2020 2020 6564 6765 5f69            edge_i
+0002cb20: 6473 2e61 7070 656e 6428 6375 7272 656e  ds.append(curren
+0002cb30: 745f 6964 290a 0a20 2020 2020 2020 2020  t_id)..         
+0002cb40: 2020 2020 2020 2063 7572 7265 6e74 5f69         current_i
+0002cb50: 6420 2b3d 2031 0a0a 2020 2020 2020 2020  d += 1..        
+0002cb60: 636f 6e74 656e 7420 2b3d 2022 237b 7d20  content += "#{} 
+0002cb70: 3d20 4544 4745 5f4c 4f4f 5028 277b 7d27  = EDGE_LOOP('{}'
+0002cb80: 2c28 7b7d 2929 3b5c 6e22 2e66 6f72 6d61  ,({}));\n".forma
+0002cb90: 7428 0a20 2020 2020 2020 2020 2020 2063  t(.            c
+0002cba0: 7572 7265 6e74 5f69 642c 2073 656c 662e  urrent_id, self.
+0002cbb0: 6e61 6d65 2c20 766f 6c6d 646c 722e 636f  name, volmdlr.co
+0002cbc0: 7265 2e73 7465 705f 6964 735f 746f 5f73  re.step_ids_to_s
+0002cbd0: 7472 2865 6467 655f 6964 7329 290a 2020  tr(edge_ids)).  
+0002cbe0: 2020 2020 2020 7265 7475 726e 2063 6f6e        return con
+0002cbf0: 7465 6e74 2c20 6375 7272 656e 745f 6964  tent, current_id
+0002cc00: 0a0a 2020 2020 6465 6620 6176 6572 6167  ..    def averag
+0002cc10: 655f 6365 6e74 6572 5f70 6f69 6e74 2873  e_center_point(s
+0002cc20: 656c 6629 3a0a 2020 2020 2020 2020 6e62  elf):.        nb
+0002cc30: 203d 206c 656e 2873 656c 662e 6564 6765   = len(self.edge
+0002cc40: 5f70 6f6c 7967 6f6e 2e70 6f69 6e74 7329  _polygon.points)
+0002cc50: 0a20 2020 2020 2020 2078 203d 2073 756d  .        x = sum
+0002cc60: 2870 6f69 6e74 5b30 5d20 666f 7220 706f  (point[0] for po
+0002cc70: 696e 7420 696e 2073 656c 662e 6564 6765  int in self.edge
+0002cc80: 5f70 6f6c 7967 6f6e 2e70 6f69 6e74 7329  _polygon.points)
+0002cc90: 202f 206e 620a 2020 2020 2020 2020 7920   / nb.        y 
+0002cca0: 3d20 7375 6d28 706f 696e 745b 315d 2066  = sum(point[1] f
+0002ccb0: 6f72 2070 6f69 6e74 2069 6e20 7365 6c66  or point in self
+0002ccc0: 2e65 6467 655f 706f 6c79 676f 6e2e 706f  .edge_polygon.po
+0002ccd0: 696e 7473 2920 2f20 6e62 0a20 2020 2020  ints) / nb.     
+0002cce0: 2020 207a 203d 2073 756d 2870 6f69 6e74     z = sum(point
+0002ccf0: 5b32 5d20 666f 7220 706f 696e 7420 696e  [2] for point in
+0002cd00: 2073 656c 662e 6564 6765 5f70 6f6c 7967   self.edge_polyg
+0002cd10: 6f6e 2e70 6f69 6e74 7329 202f 206e 620a  on.points) / nb.
+0002cd20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002cd30: 766f 6c6d 646c 722e 506f 696e 7433 4428  volmdlr.Point3D(
+0002cd40: 782c 2079 2c20 7a29 0a0a 2020 2020 6465  x, y, z)..    de
+0002cd50: 6620 746f 5f32 6428 7365 6c66 2c20 706c  f to_2d(self, pl
+0002cd60: 616e 655f 6f72 6967 696e 2c20 782c 2079  ane_origin, x, y
+0002cd70: 293a 0a20 2020 2020 2020 2070 7269 6d69  ):.        primi
+0002cd80: 7469 7665 7332 6420 3d20 7365 6c66 2e67  tives2d = self.g
+0002cd90: 6574 5f70 7269 6d69 7469 7665 735f 3264  et_primitives_2d
+0002cda0: 2870 6c61 6e65 5f6f 7269 6769 6e2c 2078  (plane_origin, x
+0002cdb0: 2c20 7929 0a20 2020 2020 2020 2072 6574  , y).        ret
+0002cdc0: 7572 6e20 436f 6e74 6f75 7232 4428 7072  urn Contour2D(pr
+0002cdd0: 696d 6974 6976 6573 3d70 7269 6d69 7469  imitives=primiti
+0002cde0: 7665 7332 6429 0a0a 2020 2020 6465 6620  ves2d)..    def 
+0002cdf0: 726f 7461 7469 6f6e 2873 656c 662c 2063  rotation(self, c
+0002ce00: 656e 7465 723a 2076 6f6c 6d64 6c72 2e50  enter: volmdlr.P
+0002ce10: 6f69 6e74 3344 2c20 6178 6973 3a20 766f  oint3D, axis: vo
+0002ce20: 6c6d 646c 722e 5665 6374 6f72 3344 2c0a  lmdlr.Vector3D,.
+0002ce30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ce40: 2061 6e67 6c65 3a20 666c 6f61 7429 3a0a   angle: float):.
+0002ce50: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002ce60: 2020 2020 436f 6e74 6f75 7233 4420 726f      Contour3D ro
+0002ce70: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
+0002ce80: 203a 7061 7261 6d20 6365 6e74 6572 3a20   :param center: 
+0002ce90: 726f 7461 7469 6f6e 2063 656e 7465 722e  rotation center.
+0002cea0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0002ceb0: 6178 6973 3a20 726f 7461 7469 6f6e 2061  axis: rotation a
+0002cec0: 7869 732e 0a20 2020 2020 2020 203a 7061  xis..        :pa
+0002ced0: 7261 6d20 616e 676c 653a 2061 6e67 6c65  ram angle: angle
+0002cee0: 2072 6f74 6174 696f 6e2e 0a20 2020 2020   rotation..     
+0002cef0: 2020 203a 7265 7475 726e 3a20 6120 6e65     :return: a ne
+0002cf00: 7720 726f 7461 7465 6420 436f 6e74 6f75  w rotated Contou
+0002cf10: 7233 442e 0a20 2020 2020 2020 2022 2222  r3D..        """
+0002cf20: 0a20 2020 2020 2020 206e 6577 5f65 6467  .        new_edg
+0002cf30: 6573 203d 205b 6564 6765 2e72 6f74 6174  es = [edge.rotat
+0002cf40: 696f 6e28 6365 6e74 6572 2c20 6178 6973  ion(center, axis
+0002cf50: 2c20 616e 676c 6529 2066 6f72 2065 6467  , angle) for edg
+0002cf60: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0002cf70: 2020 2020 2020 2069 6e20 7365 6c66 2e70         in self.p
+0002cf80: 7269 6d69 7469 7665 735d 0a20 2020 2020  rimitives].     
+0002cf90: 2020 2072 6574 7572 6e20 436f 6e74 6f75     return Contou
+0002cfa0: 7233 4428 6e65 775f 6564 6765 732c 2073  r3D(new_edges, s
+0002cfb0: 656c 662e 6e61 6d65 290a 0a20 2020 2064  elf.name)..    d
+0002cfc0: 6566 2072 6f74 6174 696f 6e5f 696e 706c  ef rotation_inpl
+0002cfd0: 6163 6528 7365 6c66 2c20 6365 6e74 6572  ace(self, center
+0002cfe0: 3a20 766f 6c6d 646c 722e 506f 696e 7433  : volmdlr.Point3
+0002cff0: 442c 2061 7869 733a 2076 6f6c 6d64 6c72  D, axis: volmdlr
+0002d000: 2e56 6563 746f 7233 442c 0a20 2020 2020  .Vector3D,.     
+0002d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d020: 2020 2020 616e 676c 653a 2066 6c6f 6174      angle: float
+0002d030: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0002d040: 2020 2020 2020 2043 6f6e 746f 7572 3344         Contour3D
+0002d050: 2072 6f74 6174 696f 6e2e 204f 626a 6563   rotation. Objec
+0002d060: 7420 6973 2075 7064 6174 6564 2069 6e70  t is updated inp
+0002d070: 6c61 6365 2e0a 0a20 2020 2020 2020 203a  lace...        :
+0002d080: 7061 7261 6d20 6365 6e74 6572 3a20 726f  param center: ro
+0002d090: 7461 7469 6f6e 2063 656e 7465 722e 0a20  tation center.. 
+0002d0a0: 2020 2020 2020 203a 7061 7261 6d20 6178         :param ax
+0002d0b0: 6973 3a20 726f 7461 7469 6f6e 2061 7869  is: rotation axi
+0002d0c0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+0002d0d0: 6d20 616e 676c 653a 2072 6f74 6174 696f  m angle: rotatio
+0002d0e0: 6e20 616e 676c 652e 0a20 2020 2020 2020  n angle..       
+0002d0f0: 2022 2222 0a20 2020 2020 2020 2077 6172   """.        war
+0002d100: 6e69 6e67 732e 7761 726e 2822 2769 6e70  nings.warn("'inp
+0002d110: 6c61 6365 2720 6d65 7468 6f64 7320 6172  lace' methods ar
+0002d120: 6520 6465 7072 6563 6174 6564 2e20 5573  e deprecated. Us
+0002d130: 6520 6120 6e6f 7420 696e 706c 6163 6520  e a not inplace 
+0002d140: 6d65 7468 6f64 2069 6e73 7465 6164 2e22  method instead."
+0002d150: 2c20 4465 7072 6563 6174 696f 6e57 6172  , DeprecationWar
+0002d160: 6e69 6e67 290a 0a20 2020 2020 2020 2066  ning)..        f
+0002d170: 6f72 2065 6467 6520 696e 2073 656c 662e  or edge in self.
+0002d180: 7072 696d 6974 6976 6573 3a0a 2020 2020  primitives:.    
+0002d190: 2020 2020 2020 2020 6564 6765 2e72 6f74          edge.rot
+0002d1a0: 6174 696f 6e5f 696e 706c 6163 6528 6365  ation_inplace(ce
+0002d1b0: 6e74 6572 2c20 6178 6973 2c20 616e 676c  nter, axis, angl
+0002d1c0: 6529 0a0a 2020 2020 6465 6620 7472 616e  e)..    def tran
+0002d1d0: 736c 6174 696f 6e28 7365 6c66 2c20 6f66  slation(self, of
+0002d1e0: 6673 6574 3a20 766f 6c6d 646c 722e 5665  fset: volmdlr.Ve
+0002d1f0: 6374 6f72 3344 293a 0a20 2020 2020 2020  ctor3D):.       
+0002d200: 2022 2222 0a20 2020 2020 2020 2043 6f6e   """.        Con
+0002d210: 746f 7572 3344 2074 7261 6e73 6c61 7469  tour3D translati
+0002d220: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
+0002d230: 7261 6d20 6f66 6673 6574 3a20 7472 616e  ram offset: tran
+0002d240: 736c 6174 696f 6e20 7665 6374 6f72 2e0a  slation vector..
+0002d250: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+0002d260: 2041 206e 6577 2074 7261 6e73 6c61 7465   A new translate
+0002d270: 6420 436f 6e74 6f75 7233 442e 0a20 2020  d Contour3D..   
+0002d280: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0002d290: 206e 6577 5f65 6467 6573 203d 205b 6564   new_edges = [ed
+0002d2a0: 6765 2e74 7261 6e73 6c61 7469 6f6e 286f  ge.translation(o
+0002d2b0: 6666 7365 7429 2066 6f72 2065 6467 6520  ffset) for edge 
+0002d2c0: 696e 0a20 2020 2020 2020 2020 2020 2020  in.             
+0002d2d0: 2020 2020 2020 2020 7365 6c66 2e70 7269          self.pri
+0002d2e0: 6d69 7469 7665 735d 0a20 2020 2020 2020  mitives].       
+0002d2f0: 2072 6574 7572 6e20 436f 6e74 6f75 7233   return Contour3
+0002d300: 4428 6e65 775f 6564 6765 732c 2073 656c  D(new_edges, sel
+0002d310: 662e 6e61 6d65 290a 0a20 2020 2064 6566  f.name)..    def
+0002d320: 2074 7261 6e73 6c61 7469 6f6e 5f69 6e70   translation_inp
+0002d330: 6c61 6365 2873 656c 662c 206f 6666 7365  lace(self, offse
+0002d340: 743a 2076 6f6c 6d64 6c72 2e56 6563 746f  t: volmdlr.Vecto
+0002d350: 7233 4429 3a0a 2020 2020 2020 2020 2222  r3D):.        ""
+0002d360: 220a 2020 2020 2020 2020 436f 6e74 6f75  ".        Contou
+0002d370: 7233 4420 7472 616e 736c 6174 696f 6e2e  r3D translation.
+0002d380: 204f 626a 6563 7420 6973 2075 7064 6174   Object is updat
+0002d390: 6564 2069 6e70 6c61 6365 2e0a 0a20 2020  ed inplace...   
+0002d3a0: 2020 2020 203a 7061 7261 6d20 6f66 6673       :param offs
+0002d3b0: 6574 3a20 7472 616e 736c 6174 696f 6e20  et: translation 
+0002d3c0: 7665 6374 6f72 2e0a 2020 2020 2020 2020  vector..        
+0002d3d0: 2222 220a 2020 2020 2020 2020 7761 726e  """.        warn
+0002d3e0: 696e 6773 2e77 6172 6e28 2227 696e 706c  ings.warn("'inpl
+0002d3f0: 6163 6527 206d 6574 686f 6473 2061 7265  ace' methods are
+0002d400: 2064 6570 7265 6361 7465 642e 2055 7365   deprecated. Use
+0002d410: 2061 206e 6f74 2069 6e70 6c61 6365 206d   a not inplace m
+0002d420: 6574 686f 6420 696e 7374 6561 642e 222c  ethod instead.",
+0002d430: 2044 6570 7265 6361 7469 6f6e 5761 726e   DeprecationWarn
+0002d440: 696e 6729 0a0a 2020 2020 2020 2020 666f  ing)..        fo
+0002d450: 7220 6564 6765 2069 6e20 7365 6c66 2e70  r edge in self.p
+0002d460: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
+0002d470: 2020 2020 2020 2065 6467 652e 7472 616e         edge.tran
+0002d480: 736c 6174 696f 6e5f 696e 706c 6163 6528  slation_inplace(
+0002d490: 6f66 6673 6574 290a 0a20 2020 2064 6566  offset)..    def
+0002d4a0: 206f 7264 6572 5f63 6f6e 746f 7572 2873   order_contour(s
+0002d4b0: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
+0002d4c0: 6e65 775f 7072 696d 6974 6976 6573 203d  new_primitives =
+0002d4d0: 205b 5d0a 2020 2020 2020 2020 2320 706f   [].        # po
+0002d4e0: 696e 7473 203d 2073 656c 662e 6f72 6465  ints = self.orde
+0002d4f0: 7269 6e67 5f63 6f6e 746f 7572 2829 0a20  ring_contour(). 
+0002d500: 2020 2020 2020 2023 2066 6f72 2070 312c         # for p1,
+0002d510: 2070 3220 696e 2070 6f69 6e74 733a 0a20   p2 in points:. 
+0002d520: 2020 2020 2020 2023 2020 2020 206e 6577         #     new
+0002d530: 5f70 7269 6d69 7469 7665 732e 6170 7065  _primitives.appe
+0002d540: 6e64 2876 6f6c 6d64 6c72 2e65 6467 6573  nd(volmdlr.edges
+0002d550: 2e4c 696e 6553 6567 6d65 6e74 3344 2870  .LineSegment3D(p
+0002d560: 312c 2070 3229 290a 2020 2020 2020 2020  1, p2)).        
+0002d570: 2320 7365 6c66 2e70 7269 6d69 7469 7665  # self.primitive
+0002d580: 7320 3d20 6e65 775f 7072 696d 6974 6976  s = new_primitiv
+0002d590: 6573 0a0a 2020 2020 2020 2020 696e 6974  es..        init
+0002d5a0: 6961 6c5f 706f 696e 7473 203d 205b 5d0a  ial_points = [].
+0002d5b0: 2020 2020 2020 2020 666f 7220 7072 696d          for prim
+0002d5c0: 6974 6976 6520 696e 2073 656c 662e 7072  itive in self.pr
+0002d5d0: 696d 6974 6976 6573 3a0a 2020 2020 2020  imitives:.      
+0002d5e0: 2020 2020 2020 696e 6974 6961 6c5f 706f        initial_po
+0002d5f0: 696e 7473 2e61 7070 656e 6428 2870 7269  ints.append((pri
+0002d600: 6d69 7469 7665 2e73 7461 7274 2c20 7072  mitive.start, pr
+0002d610: 696d 6974 6976 652e 656e 6429 290a 0a20  imitive.end)).. 
+0002d620: 2020 2020 2020 206e 6577 5f70 7269 6d69         new_primi
+0002d630: 7469 7665 7320 3d20 5b5d 0a20 2020 2020  tives = [].     
+0002d640: 2020 2069 6620 7365 6c66 2e69 735f 6f72     if self.is_or
+0002d650: 6465 7265 6428 293a 0a20 2020 2020 2020  dered():.       
+0002d660: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0002d670: 0a20 2020 2020 2020 2070 6f69 6e74 7320  .        points 
+0002d680: 3d20 7365 6c66 2e6f 7264 6572 696e 675f  = self.ordering_
+0002d690: 636f 6e74 6f75 7228 290a 2020 2020 2020  contour().      
+0002d6a0: 2020 666f 7220 7031 2c20 7032 2069 6e20    for p1, p2 in 
+0002d6b0: 706f 696e 7473 3a0a 2020 2020 2020 2020  points:.        
+0002d6c0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0002d6d0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
+0002d6e0: 2069 6e69 7469 616c 5f70 6f69 6e74 732e   initial_points.
+0002d6f0: 696e 6465 7828 2870 312c 2070 3229 290a  index((p1, p2)).
+0002d700: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+0002d710: 7074 2056 616c 7565 4572 726f 723a 0a20  pt ValueError:. 
+0002d720: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002d730: 6e64 6578 203d 2069 6e69 7469 616c 5f70  ndex = initial_p
+0002d740: 6f69 6e74 732e 696e 6465 7828 2870 322c  oints.index((p2,
+0002d750: 2070 3129 290a 0a20 2020 2020 2020 2020   p1))..         
+0002d760: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0002d770: 2873 656c 662e 7072 696d 6974 6976 6573  (self.primitives
+0002d780: 5b69 6e64 6578 5d2c 2076 6f6c 6d64 6c72  [index], volmdlr
+0002d790: 2e65 6467 6573 2e4c 696e 6553 6567 6d65  .edges.LineSegme
+0002d7a0: 6e74 3344 293a 0a20 2020 2020 2020 2020  nt3D):.         
+0002d7b0: 2020 2020 2020 206e 6577 5f70 7269 6d69         new_primi
+0002d7c0: 7469 7665 732e 6170 7065 6e64 2876 6f6c  tives.append(vol
+0002d7d0: 6d64 6c72 2e65 6467 6573 2e4c 696e 6553  mdlr.edges.LineS
+0002d7e0: 6567 6d65 6e74 3344 2870 312c 2070 3229  egment3D(p1, p2)
+0002d7f0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+0002d800: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
+0002d810: 6c66 2e70 7269 6d69 7469 7665 735b 696e  lf.primitives[in
+0002d820: 6465 785d 2c20 766f 6c6d 646c 722e 6564  dex], volmdlr.ed
+0002d830: 6765 732e 4172 6333 4429 3a0a 2020 2020  ges.Arc3D):.    
+0002d840: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+0002d850: 7072 696d 6974 6976 6573 2e61 7070 656e  primitives.appen
+0002d860: 6428 766f 6c6d 646c 722e 6564 6765 732e  d(volmdlr.edges.
+0002d870: 4172 6333 4428 7031 2c20 7365 6c66 2e70  Arc3D(p1, self.p
+0002d880: 7269 6d69 7469 7665 735b 696e 6465 785d  rimitives[index]
+0002d890: 2e69 6e74 6572 696f 722c 2070 3229 290a  .interior, p2)).
+0002d8a0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0002d8b0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+0002d8c0: 2e70 7269 6d69 7469 7665 735b 696e 6465  .primitives[inde
+0002d8d0: 785d 2c20 766f 6c6d 646c 722e 6564 6765  x], volmdlr.edge
+0002d8e0: 732e 4253 706c 696e 6543 7572 7665 3344  s.BSplineCurve3D
+0002d8f0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0002d900: 2020 2069 6620 2873 656c 662e 7072 696d     if (self.prim
+0002d910: 6974 6976 6573 5b69 6e64 6578 5d2e 7374  itives[index].st
+0002d920: 6172 7420 3d3d 2070 3120 616e 6420 7365  art == p1 and se
+0002d930: 6c66 2e70 7269 6d69 7469 7665 735b 696e  lf.primitives[in
+0002d940: 6465 785d 2e65 6e64 203d 3d20 7032 293a  dex].end == p2):
+0002d950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d960: 2020 2020 206e 6577 5f70 7269 6d69 7469       new_primiti
+0002d970: 7665 732e 6170 7065 6e64 2873 656c 662e  ves.append(self.
+0002d980: 7072 696d 6974 6976 6573 5b69 6e64 6578  primitives[index
+0002d990: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+0002d9a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002d9b0: 2020 2020 2020 2020 2020 2020 206e 6577               new
+0002d9c0: 5f70 7269 6d69 7469 7665 732e 6170 7065  _primitives.appe
+0002d9d0: 6e64 2873 656c 662e 7072 696d 6974 6976  nd(self.primitiv
+0002d9e0: 6573 5b69 6e64 6578 5d2e 7265 7665 7273  es[index].revers
+0002d9f0: 6528 2929 0a0a 2020 2020 2020 2020 7365  e())..        se
+0002da00: 6c66 2e70 7269 6d69 7469 7665 7320 3d20  lf.primitives = 
+0002da10: 6e65 775f 7072 696d 6974 6976 6573 0a0a  new_primitives..
+0002da20: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0002da30: 656c 660a 0a20 2020 2064 6566 2066 7261  elf..    def fra
+0002da40: 6d65 5f6d 6170 7069 6e67 2873 656c 662c  me_mapping(self,
+0002da50: 2066 7261 6d65 3a20 766f 6c6d 646c 722e   frame: volmdlr.
+0002da60: 4672 616d 6533 442c 2073 6964 653a 2073  Frame3D, side: s
+0002da70: 7472 293a 0a20 2020 2020 2020 2022 2222  tr):.        """
+0002da80: 0a20 2020 2020 2020 2043 6861 6e67 6573  .        Changes
+0002da90: 2066 7261 6d65 5f6d 6170 7069 6e67 2061   frame_mapping a
+0002daa0: 6e64 2072 6574 7572 6e20 6120 6e65 7720  nd return a new 
+0002dab0: 436f 6e74 6f75 7233 440a 2020 2020 2020  Contour3D.      
+0002dac0: 2020 7369 6465 203d 2027 6f6c 6427 206f    side = 'old' o
+0002dad0: 7220 276e 6577 270a 2020 2020 2020 2020  r 'new'.        
+0002dae0: 2222 220a 2020 2020 2020 2020 6e65 775f  """.        new_
+0002daf0: 6564 6765 7320 3d20 5b65 6467 652e 6672  edges = [edge.fr
+0002db00: 616d 655f 6d61 7070 696e 6728 6672 616d  ame_mapping(fram
+0002db10: 652c 2073 6964 6529 2066 6f72 2065 6467  e, side) for edg
+0002db20: 6520 696e 0a20 2020 2020 2020 2020 2020  e in.           
+0002db30: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0002db40: 7269 6d69 7469 7665 735d 0a20 2020 2020  rimitives].     
+0002db50: 2020 2072 6574 7572 6e20 436f 6e74 6f75     return Contou
+0002db60: 7233 4428 6e65 775f 6564 6765 732c 2073  r3D(new_edges, s
+0002db70: 656c 662e 6e61 6d65 290a 0a20 2020 2064  elf.name)..    d
+0002db80: 6566 2066 7261 6d65 5f6d 6170 7069 6e67  ef frame_mapping
+0002db90: 5f69 6e70 6c61 6365 2873 656c 662c 2066  _inplace(self, f
+0002dba0: 7261 6d65 3a20 766f 6c6d 646c 722e 4672  rame: volmdlr.Fr
+0002dbb0: 616d 6533 442c 2073 6964 653a 2073 7472  ame3D, side: str
+0002dbc0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0002dbd0: 2020 2020 2020 2043 6861 6e67 6573 2066         Changes f
+0002dbe0: 7261 6d65 5f6d 6170 7069 6e67 2061 6e64  rame_mapping and
+0002dbf0: 2074 6865 206f 626a 6563 7420 6973 2075   the object is u
+0002dc00: 7064 6174 6564 2069 6e70 6c61 6365 2e0a  pdated inplace..
+0002dc10: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0002dc20: 7369 6465 3a20 276f 6c64 2720 6f72 2027  side: 'old' or '
+0002dc30: 6e65 7727 0a20 2020 2020 2020 2022 2222  new'.        """
+0002dc40: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
+0002dc50: 732e 7761 726e 2822 2769 6e70 6c61 6365  s.warn("'inplace
+0002dc60: 2720 6d65 7468 6f64 7320 6172 6520 6465  ' methods are de
+0002dc70: 7072 6563 6174 6564 2e20 5573 6520 6120  precated. Use a 
+0002dc80: 6e6f 7420 696e 706c 6163 6520 6d65 7468  not inplace meth
+0002dc90: 6f64 2069 6e73 7465 6164 2e22 2c20 4465  od instead.", De
+0002dca0: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
+0002dcb0: 290a 0a20 2020 2020 2020 2066 6f72 2065  )..        for e
+0002dcc0: 6467 6520 696e 2073 656c 662e 7072 696d  dge in self.prim
+0002dcd0: 6974 6976 6573 3a0a 2020 2020 2020 2020  itives:.        
+0002dce0: 2020 2020 6564 6765 2e66 7261 6d65 5f6d      edge.frame_m
+0002dcf0: 6170 7069 6e67 5f69 6e70 6c61 6365 2866  apping_inplace(f
+0002dd00: 7261 6d65 2c20 7369 6465 290a 0a20 2020  rame, side)..   
+0002dd10: 2064 6566 2063 6f70 7928 7365 6c66 2c20   def copy(self, 
+0002dd20: 6465 6570 3d54 7275 652c 206d 656d 6f3d  deep=True, memo=
+0002dd30: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
+0002dd40: 2222 0a20 2020 2020 2020 2043 6f70 6965  "".        Copie
+0002dd50: 7320 7468 6520 436f 6e74 6f75 7233 442e  s the Contour3D.
+0002dd60: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002dd70: 2020 2020 206e 6577 5f65 6467 6573 203d       new_edges =
+0002dd80: 205b 6564 6765 2e63 6f70 7928 6465 6570   [edge.copy(deep
+0002dd90: 3d64 6565 702c 206d 656d 6f3d 6d65 6d6f  =deep, memo=memo
+0002dda0: 2920 666f 7220 6564 6765 2069 6e20 7365  ) for edge in se
+0002ddb0: 6c66 2e70 7269 6d69 7469 7665 735d 0a20  lf.primitives]. 
+0002ddc0: 2020 2020 2020 2023 2069 6620 7365 6c66         # if self
+0002ddd0: 2e70 6f69 6e74 5f69 6e73 6964 655f 636f  .point_inside_co
+0002dde0: 6e74 6f75 7220 6973 206e 6f74 204e 6f6e  ntour is not Non
+0002ddf0: 653a 0a20 2020 2020 2020 2023 2020 2020  e:.        #    
+0002de00: 206e 6577 5f70 6f69 6e74 5f69 6e73 6964   new_point_insid
+0002de10: 655f 636f 6e74 6f75 7220 3d20 7365 6c66  e_contour = self
+0002de20: 2e70 6f69 6e74 5f69 6e73 6964 655f 636f  .point_inside_co
+0002de30: 6e74 6f75 722e 636f 7079 2829 0a20 2020  ntour.copy().   
+0002de40: 2020 2020 2023 2065 6c73 653a 0a20 2020       # else:.   
+0002de50: 2020 2020 2023 2020 2020 206e 6577 5f70       #     new_p
+0002de60: 6f69 6e74 5f69 6e73 6964 655f 636f 6e74  oint_inside_cont
+0002de70: 6f75 7220 3d20 4e6f 6e65 0a20 2020 2020  our = None.     
+0002de80: 2020 2072 6574 7572 6e20 436f 6e74 6f75     return Contou
+0002de90: 7233 4428 6e65 775f 6564 6765 732c 2073  r3D(new_edges, s
+0002dea0: 656c 662e 6e61 6d65 290a 0a20 2020 2064  elf.name)..    d
+0002deb0: 6566 2070 6c6f 7428 7365 6c66 2c20 6178  ef plot(self, ax
+0002dec0: 3d4e 6f6e 652c 2063 6f6c 6f72 3d27 6b27  =None, color='k'
+0002ded0: 2c20 616c 7068 613d 312c 2065 6467 655f  , alpha=1, edge_
+0002dee0: 6465 7461 696c 733d 4661 6c73 6529 3a0a  details=False):.
+0002def0: 2020 2020 2020 2020 6966 2061 7820 6973          if ax is
+0002df00: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0002df10: 2020 2023 2061 7820 3d20 4178 6573 3344     # ax = Axes3D
+0002df20: 2870 6c74 2e66 6967 7572 6528 2929 0a20  (plt.figure()). 
+0002df30: 2020 2020 2020 2020 2020 2066 6967 203d             fig =
+0002df40: 2070 6c74 2e66 6967 7572 6528 290a 2020   plt.figure().  
+0002df50: 2020 2020 2020 2020 2020 6178 203d 2066            ax = f
+0002df60: 6967 2e61 6464 5f73 7562 706c 6f74 2831  ig.add_subplot(1
+0002df70: 3131 2c20 7072 6f6a 6563 7469 6f6e 3d27  11, projection='
+0002df80: 3364 2729 0a0a 2020 2020 2020 2020 666f  3d')..        fo
+0002df90: 7220 6564 6765 2069 6e20 7365 6c66 2e70  r edge in self.p
+0002dfa0: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
+0002dfb0: 2020 2020 2020 2065 6467 652e 706c 6f74         edge.plot
+0002dfc0: 2861 783d 6178 2c20 636f 6c6f 723d 636f  (ax=ax, color=co
+0002dfd0: 6c6f 722c 2061 6c70 6861 3d61 6c70 6861  lor, alpha=alpha
+0002dfe0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002dff0: 2020 2020 2020 2020 6564 6765 5f65 6e64          edge_end
+0002e000: 733d 6564 6765 5f64 6574 6169 6c73 2c20  s=edge_details, 
+0002e010: 6564 6765 5f64 6972 6563 7469 6f6e 3d65  edge_direction=e
+0002e020: 6467 655f 6465 7461 696c 7329 0a0a 2020  dge_details)..  
+0002e030: 2020 2020 2020 7265 7475 726e 2061 780a        return ax.
+0002e040: 0a20 2020 2064 6566 205f 626f 756e 6469  .    def _boundi
+0002e050: 6e67 5f62 6f78 2873 656c 6629 3a0a 2020  ng_box(self):.  
+0002e060: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0002e070: 2020 436f 6d70 7574 6573 2074 6865 2062    Computes the b
+0002e080: 6f75 6e64 696e 6720 626f 7820 6f66 2074  ounding box of t
+0002e090: 6865 2063 6f6e 746f 7572 3344 2e0a 0a20  he contour3D... 
+0002e0a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0002e0b0: 2020 2072 6574 7572 6e20 766f 6c6d 646c     return volmdl
+0002e0c0: 722e 636f 7265 2e42 6f75 6e64 696e 6742  r.core.BoundingB
+0002e0d0: 6f78 2e66 726f 6d5f 626f 756e 6469 6e67  ox.from_bounding
+0002e0e0: 5f62 6f78 6573 285b 702e 626f 756e 6469  _boxes([p.boundi
+0002e0f0: 6e67 5f62 6f78 2066 6f72 2070 2069 6e20  ng_box for p in 
+0002e100: 7365 6c66 2e70 7269 6d69 7469 7665 735d  self.primitives]
+0002e110: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+0002e120: 0a20 2020 2064 6566 2062 6f75 6e64 696e  .    def boundin
+0002e130: 675f 626f 7828 7365 6c66 293a 0a20 2020  g_box(self):.   
+0002e140: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0002e150: 2e5f 7574 645f 626f 756e 6469 6e67 5f62  ._utd_bounding_b
+0002e160: 6f78 3a0a 2020 2020 2020 2020 2020 2020  ox:.            
+0002e170: 7365 6c66 2e5f 6262 6f78 203d 2073 656c  self._bbox = sel
+0002e180: 662e 5f62 6f75 6e64 696e 675f 626f 7828  f._bounding_box(
+0002e190: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0002e1a0: 6c66 2e5f 7574 645f 626f 756e 6469 6e67  lf._utd_bounding
+0002e1b0: 5f62 6f78 203d 2054 7275 650a 2020 2020  _box = True.    
+0002e1c0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0002e1d0: 5f62 626f 780a 0a20 2020 2040 636c 6173  _bbox..    @clas
+0002e1e0: 736d 6574 686f 640a 2020 2020 6465 6620  smethod.    def 
+0002e1f0: 6578 7472 6163 745f 636f 6e74 6f75 7273  extract_contours
+0002e200: 2863 6c73 2c20 636f 6e74 6f75 722c 2070  (cls, contour, p
+0002e210: 6f69 6e74 313a 2076 6f6c 6d64 6c72 2e50  oint1: volmdlr.P
+0002e220: 6f69 6e74 3344 2c0a 2020 2020 2020 2020  oint3D,.        
 0002e230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e240: 2020 2020 2020 2070 6f69 6e74 323a 2076         point2: v
-0002e250: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 2c20  olmdlr.Point3D, 
-0002e260: 696e 7369 6465 3d46 616c 7365 293a 0a0a  inside=False):..
-0002e270: 2020 2020 2020 2020 6e65 775f 7072 696d          new_prim
-0002e280: 6974 6976 6573 203d 2063 6f6e 746f 7572  itives = contour
-0002e290: 2e65 7874 7261 6374 5f77 6974 685f 706f  .extract_with_po
-0002e2a0: 696e 7473 2870 6f69 6e74 312c 2070 6f69  ints(point1, poi
-0002e2b0: 6e74 322c 2069 6e73 6964 6529 0a20 2020  nt2, inside).   
-0002e2c0: 2020 2020 2063 6f6e 746f 7572 7320 3d20       contours = 
-0002e2d0: 5b63 6c73 286e 6577 5f70 7269 6d69 7469  [cls(new_primiti
-0002e2e0: 7665 7329 5d0a 2020 2020 2020 2020 7265  ves)].        re
-0002e2f0: 7475 726e 2063 6f6e 746f 7572 730a 0a20  turn contours.. 
-0002e300: 2020 2064 6566 206c 696e 655f 696e 7465     def line_inte
-0002e310: 7273 6563 7469 6f6e 7328 7365 6c66 2c20  rsections(self, 
-0002e320: 6c69 6e65 3a20 766f 6c6d 646c 722e 6564  line: volmdlr.ed
-0002e330: 6765 732e 4c69 6e65 3344 293a 0a20 2020  ges.Line3D):.   
-0002e340: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002e350: 2043 616c 6375 6c61 7465 7320 696e 7465   Calculates inte
-0002e360: 7273 6563 7469 6f6e 7320 6265 7477 6565  rsections betwee
-0002e370: 6e20 6120 636f 6e74 6f75 7233 6420 616e  n a contour3d an
-0002e380: 6420 4c69 6e65 3364 2e0a 0a20 2020 2020  d Line3d...     
-0002e390: 2020 203a 7061 7261 6d20 6c69 6e65 3a20     :param line: 
-0002e3a0: 4c69 6e65 3344 2074 6f20 7665 7269 6679  Line3D to verify
-0002e3b0: 2069 6e74 6572 7365 6374 696f 6e73 2e0a   intersections..
-0002e3c0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-0002e3d0: 206c 6973 7420 7769 7468 2074 6865 2063   list with the c
-0002e3e0: 6f6e 746f 7572 2069 6e74 6572 7365 6374  ontour intersect
-0002e3f0: 696f 6e73 2077 6974 6820 6c69 6e65 0a20  ions with line. 
-0002e400: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002e410: 2020 2069 6e74 6572 7365 6374 696f 6e73     intersections
-0002e420: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
-0002e430: 7220 7072 696d 6974 6976 6520 696e 2073  r primitive in s
-0002e440: 656c 662e 7072 696d 6974 6976 6573 3a0a  elf.primitives:.
-0002e450: 2020 2020 2020 2020 2020 2020 7072 696d              prim
-0002e460: 5f6c 696e 655f 696e 7465 7273 6563 7469  _line_intersecti
-0002e470: 6f6e 7320 3d20 7072 696d 6974 6976 652e  ons = primitive.
-0002e480: 6c69 6e65 5f69 6e74 6572 7365 6374 696f  line_intersectio
-0002e490: 6e73 286c 696e 6529 0a20 2020 2020 2020  ns(line).       
-0002e4a0: 2020 2020 2069 6620 7072 696d 5f6c 696e       if prim_lin
-0002e4b0: 655f 696e 7465 7273 6563 7469 6f6e 733a  e_intersections:
-0002e4c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e4d0: 2066 6f72 2069 6e74 6572 7320 696e 2070   for inters in p
-0002e4e0: 7269 6d5f 6c69 6e65 5f69 6e74 6572 7365  rim_line_interse
-0002e4f0: 6374 696f 6e73 3a0a 2020 2020 2020 2020  ctions:.        
-0002e500: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0002e510: 6e74 6572 7320 6e6f 7420 696e 2069 6e74  nters not in int
-0002e520: 6572 7365 6374 696f 6e73 3a0a 2020 2020  ersections:.    
-0002e530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e540: 2020 2020 696e 7465 7273 6563 7469 6f6e      intersection
-0002e550: 732e 6170 7065 6e64 2869 6e74 6572 7329  s.append(inters)
-0002e560: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002e570: 696e 7465 7273 6563 7469 6f6e 730a 0a20  intersections.. 
-0002e580: 2020 2064 6566 206c 696e 6573 6567 6d65     def linesegme
-0002e590: 6e74 5f69 6e74 6572 7365 6374 696f 6e73  nt_intersections
-0002e5a0: 2873 656c 662c 206c 696e 6573 6567 6d65  (self, linesegme
-0002e5b0: 6e74 3a20 766f 6c6d 646c 722e 6564 6765  nt: volmdlr.edge
-0002e5c0: 732e 4c69 6e65 5365 676d 656e 7433 4429  s.LineSegment3D)
-0002e5d0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0002e5e0: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
-0002e5f0: 2069 6e74 6572 7365 6374 696f 6e73 2062   intersections b
-0002e600: 6574 7765 656e 2061 2063 6f6e 746f 7572  etween a contour
-0002e610: 2033 6420 616e 6420 4c69 6e65 5365 676d   3d and LineSegm
-0002e620: 656e 7433 442e 0a0a 2020 2020 2020 2020  ent3D...        
-0002e630: 3a70 6172 616d 206c 696e 6573 6567 6d65  :param linesegme
-0002e640: 6e74 3a20 4c69 6e65 5365 676d 656e 7433  nt: LineSegment3
-0002e650: 4420 746f 2076 6572 6966 7920 696e 7465  D to verify inte
-0002e660: 7273 6563 7469 6f6e 732e 0a20 2020 2020  rsections..     
-0002e670: 2020 203a 7265 7475 726e 3a20 6c69 7374     :return: list
-0002e680: 2077 6974 6820 7468 6520 636f 6e74 6f75   with the contou
-0002e690: 7220 696e 7465 7273 6563 7469 6f6e 7320  r intersections 
-0002e6a0: 7769 7468 206c 696e 650a 2020 2020 2020  with line.      
-0002e6b0: 2020 2222 220a 2020 2020 2020 2020 696e    """.        in
-0002e6c0: 7465 7273 6563 7469 6f6e 7320 3d20 5b5d  tersections = []
-0002e6d0: 0a20 2020 2020 2020 2066 6f72 2070 7269  .        for pri
-0002e6e0: 6d69 7469 7665 2069 6e20 7365 6c66 2e70  mitive in self.p
-0002e6f0: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
-0002e700: 2020 2020 2020 2070 7269 6d5f 6c69 6e65         prim_line
-0002e710: 5f69 6e74 6572 7365 6374 696f 6e73 203d  _intersections =
-0002e720: 2070 7269 6d69 7469 7665 2e6c 696e 6573   primitive.lines
-0002e730: 6567 6d65 6e74 5f69 6e74 6572 7365 6374  egment_intersect
-0002e740: 696f 6e73 286c 696e 6573 6567 6d65 6e74  ions(linesegment
-0002e750: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-0002e760: 2070 7269 6d5f 6c69 6e65 5f69 6e74 6572   prim_line_inter
-0002e770: 7365 6374 696f 6e73 3a0a 2020 2020 2020  sections:.      
-0002e780: 2020 2020 2020 2020 2020 666f 7220 696e            for in
-0002e790: 7465 7273 2069 6e20 7072 696d 5f6c 696e  ters in prim_lin
-0002e7a0: 655f 696e 7465 7273 6563 7469 6f6e 733a  e_intersections:
-0002e7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e7c0: 2020 2020 2069 6620 696e 7465 7273 206e       if inters n
-0002e7d0: 6f74 2069 6e20 696e 7465 7273 6563 7469  ot in intersecti
-0002e7e0: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
-0002e7f0: 2020 2020 2020 2020 2020 2020 2069 6e74               int
-0002e800: 6572 7365 6374 696f 6e73 2e61 7070 656e  ersections.appen
-0002e810: 6428 696e 7465 7273 290a 2020 2020 2020  d(inters).      
-0002e820: 2020 7265 7475 726e 2069 6e74 6572 7365    return interse
-0002e830: 6374 696f 6e73 0a0a 2020 2020 6465 6620  ctions..    def 
-0002e840: 636f 6e74 6f75 725f 696e 7465 7273 6563  contour_intersec
-0002e850: 7469 6f6e 2873 656c 662c 2063 6f6e 746f  tion(self, conto
-0002e860: 7572 3364 293a 0a20 2020 2020 2020 2022  ur3d):.        "
-0002e870: 2222 0a20 2020 2020 2020 2043 616c 6375  "".        Calcu
-0002e880: 6c61 7465 7320 696e 7465 7273 6563 7469  lates intersecti
-0002e890: 6f6e 7320 6265 7477 6565 6e20 7477 6f20  ons between two 
-0002e8a0: 436f 6e74 6f75 7233 442e 0a0a 2020 2020  Contour3D...    
-0002e8b0: 2020 2020 3a70 6172 616d 2063 6f6e 746f      :param conto
-0002e8c0: 7572 3364 3a20 7365 636f 6e64 2063 6f6e  ur3d: second con
-0002e8d0: 746f 7572 0a20 2020 2020 2020 203a 7265  tour.        :re
-0002e8e0: 7475 726e 3a20 6c69 7374 206f 6620 706f  turn: list of po
-0002e8f0: 696e 7473 0a20 2020 2020 2020 2022 2222  ints.        """
-0002e900: 0a20 2020 2020 2020 2064 6963 745f 696e  .        dict_in
-0002e910: 7465 7273 6563 7469 6e67 5f70 6f69 6e74  tersecting_point
-0002e920: 7320 3d20 7b7d 0a20 2020 2020 2020 2066  s = {}.        f
-0002e930: 6f72 2070 7269 6d69 7469 7665 2069 6e20  or primitive in 
-0002e940: 7365 6c66 2e70 7269 6d69 7469 7665 733a  self.primitives:
-0002e950: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0002e960: 2070 7269 6d69 7469 7665 3220 696e 2063   primitive2 in c
-0002e970: 6f6e 746f 7572 3364 2e70 7269 6d69 7469  ontour3d.primiti
-0002e980: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
-0002e990: 2020 2020 2069 6e74 6572 7365 6374 696e       intersectin
-0002e9a0: 675f 706f 696e 7420 3d20 7072 696d 6974  g_point = primit
-0002e9b0: 6976 652e 6c69 6e65 7365 676d 656e 745f  ive.linesegment_
-0002e9c0: 696e 7465 7273 6563 7469 6f6e 280a 2020  intersection(.  
-0002e9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e9e0: 2020 7072 696d 6974 6976 6532 290a 2020    primitive2).  
-0002e9f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002ea00: 2069 6e74 6572 7365 6374 696e 675f 706f   intersecting_po
-0002ea10: 696e 7420 6973 206e 6f74 204e 6f6e 653a  int is not None:
-0002ea20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ea30: 2020 2020 2064 6963 745f 696e 7465 7273       dict_inters
-0002ea40: 6563 7469 6e67 5f70 6f69 6e74 735b 7072  ecting_points[pr
-0002ea50: 696d 6974 6976 6532 5d20 3d20 696e 7465  imitive2] = inte
-0002ea60: 7273 6563 7469 6e67 5f70 6f69 6e74 0a20  rsecting_point. 
-0002ea70: 2020 2020 2020 2069 6620 6469 6374 5f69         if dict_i
-0002ea80: 6e74 6572 7365 6374 696e 675f 706f 696e  ntersecting_poin
-0002ea90: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-0002eaa0: 7265 7475 726e 2064 6963 745f 696e 7465  return dict_inte
-0002eab0: 7273 6563 7469 6e67 5f70 6f69 6e74 730a  rsecting_points.
-0002eac0: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-0002ead0: 6f6e 650a 0a20 2020 2040 636c 6173 736d  one..    @classm
-0002eae0: 6574 686f 640a 2020 2020 6465 6620 6672  ethod.    def fr
-0002eaf0: 6f6d 5f70 6f69 6e74 7328 636c 732c 2070  om_points(cls, p
-0002eb00: 6f69 6e74 733a 204c 6973 745b 766f 6c6d  oints: List[volm
-0002eb10: 646c 722e 506f 696e 7433 445d 293a 0a20  dlr.Point3D]):. 
-0002eb20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002eb30: 2020 2043 7265 6174 6520 6120 636f 6e74     Create a cont
-0002eb40: 6f75 7233 6420 6672 6f6d 2070 6f69 6e74  our3d from point
-0002eb50: 7320 7769 7468 206c 696e 655f 7365 676d  s with line_segm
-0002eb60: 656e 7473 3344 2e0a 0a20 2020 2020 2020  ents3D...       
-0002eb70: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
-0002eb80: 206c 656e 2870 6f69 6e74 7329 203c 2033   len(points) < 3
-0002eb90: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0002eba0: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
-0002ebb0: 636f 6e74 6f75 7220 6973 2064 6566 696e  contour is defin
-0002ebc0: 6564 2061 7420 6c65 6173 7420 7769 7468  ed at least with
-0002ebd0: 2074 6872 6565 2070 6f69 6e74 7327 290a   three points').
-0002ebe0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002ebf0: 2020 2020 2020 2020 2020 6564 6765 7320            edges 
-0002ec00: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
-0002ec10: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0002ec20: 302c 206c 656e 2870 6f69 6e74 7329 202d  0, len(points) -
-0002ec30: 2031 293a 0a20 2020 2020 2020 2020 2020   1):.           
-0002ec40: 2020 2020 2065 6467 6573 2e61 7070 656e       edges.appen
-0002ec50: 6428 766f 6c6d 646c 722e 6564 6765 732e  d(volmdlr.edges.
-0002ec60: 4c69 6e65 5365 676d 656e 7433 4428 706f  LineSegment3D(po
-0002ec70: 696e 7473 5b69 5d2c 2070 6f69 6e74 735b  ints[i], points[
-0002ec80: 6920 2b20 315d 2929 0a0a 2020 2020 2020  i + 1]))..      
-0002ec90: 2020 2020 2020 6564 6765 732e 6170 7065        edges.appe
-0002eca0: 6e64 2876 6f6c 6d64 6c72 2e65 6467 6573  nd(volmdlr.edges
-0002ecb0: 2e4c 696e 6553 6567 6d65 6e74 3344 2870  .LineSegment3D(p
-0002ecc0: 6f69 6e74 735b 2d31 5d2c 2070 6f69 6e74  oints[-1], point
-0002ecd0: 735b 305d 2929 0a0a 2020 2020 2020 2020  s[0]))..        
-0002ece0: 2020 2020 636f 6e74 6f75 7220 3d20 636c      contour = cl
-0002ecf0: 7328 6564 6765 7329 0a0a 2020 2020 2020  s(edges)..      
-0002ed00: 2020 2020 2020 7265 7475 726e 2063 6f6e        return con
-0002ed10: 746f 7572 0a0a 2020 2020 6465 6620 636c  tour..    def cl
-0002ed20: 6561 6e5f 7072 696d 6974 6976 6573 2873  ean_primitives(s
-0002ed30: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0002ed40: 220a 2020 2020 2020 2020 4465 6c65 7465  ".        Delete
-0002ed50: 2070 7269 6d69 7469 7665 7320 7769 7468   primitives with
-0002ed60: 2073 7461 7274 3d65 6e64 2c20 616e 6420   start=end, and 
-0002ed70: 7265 7475 726e 2061 206e 6577 2063 6f6e  return a new con
-0002ed80: 746f 7572 2e0a 0a20 2020 2020 2020 2022  tour...        "
-0002ed90: 2222 0a0a 2020 2020 2020 2020 6e65 775f  ""..        new_
-0002eda0: 7072 696d 6974 6976 6573 203d 205b 5d0a  primitives = [].
-0002edb0: 2020 2020 2020 2020 666f 7220 7072 696d          for prim
-0002edc0: 6974 6976 6520 696e 2073 656c 662e 7072  itive in self.pr
-0002edd0: 696d 6974 6976 6573 3a0a 2020 2020 2020  imitives:.      
-0002ede0: 2020 2020 2020 6966 2070 7269 6d69 7469        if primiti
-0002edf0: 7665 2e73 7461 7274 2021 3d20 7072 696d  ve.start != prim
-0002ee00: 6974 6976 652e 656e 643a 0a20 2020 2020  itive.end:.     
-0002ee10: 2020 2020 2020 2020 2020 206e 6577 5f70             new_p
-0002ee20: 7269 6d69 7469 7665 732e 6170 7065 6e64  rimitives.append
-0002ee30: 2870 7269 6d69 7469 7665 290a 0a20 2020  (primitive)..   
-0002ee40: 2020 2020 2072 6574 7572 6e20 436f 6e74       return Cont
-0002ee50: 6f75 7233 4428 6e65 775f 7072 696d 6974  our3D(new_primit
-0002ee60: 6976 6573 290a 0a20 2020 2064 6566 206d  ives)..    def m
-0002ee70: 6572 6765 5f77 6974 6828 7365 6c66 2c20  erge_with(self, 
-0002ee80: 636f 6e74 6f75 7233 6429 3a0a 2020 2020  contour3d):.    
-0002ee90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002eea0: 4d65 7267 6520 7477 6f20 6164 6a61 6365  Merge two adjace
-0002eeb0: 6e74 2063 6f6e 746f 7572 732c 2073 6861  nt contours, sha
-0002eec0: 7269 6e67 2070 7269 6d69 7469 7665 732c  ring primitives,
-0002eed0: 2061 6e64 2072 6574 7572 6e73 206f 6e65   and returns one
-0002eee0: 206f 7574 6572 2063 6f6e 746f 7572 2061   outer contour a
-0002eef0: 6e64 2069 6e6e 6572 0a20 2020 2020 2020  nd inner.       
-0002ef00: 2063 6f6e 746f 7572 7320 2869 6620 7468   contours (if th
-0002ef10: 6572 6520 6172 6520 616e 7929 2c0a 0a20  ere are any),.. 
-0002ef20: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0002ef30: 2020 2020 6d65 7267 6564 5f70 7269 6d69      merged_primi
-0002ef40: 7469 7665 7320 3d20 7365 6c66 2e6d 6572  tives = self.mer
-0002ef50: 6765 5f70 7269 6d69 7469 7665 735f 7769  ge_primitives_wi
-0002ef60: 7468 2863 6f6e 746f 7572 3364 290a 2020  th(contour3d).  
-0002ef70: 2020 2020 2020 636f 6e74 6f75 7273 203d        contours =
-0002ef80: 2043 6f6e 746f 7572 3344 2e63 6f6e 746f   Contour3D.conto
-0002ef90: 7572 735f 6672 6f6d 5f65 6467 6573 286d  urs_from_edges(m
-0002efa0: 6572 6765 645f 7072 696d 6974 6976 6573  erged_primitives
-0002efb0: 2c20 746f 6c3d 3365 2d34 290a 0a20 2020  , tol=3e-4)..   
-0002efc0: 2020 2020 2072 6574 7572 6e20 636f 6e74       return cont
-0002efd0: 6f75 7273 0a0a 0a63 6c61 7373 2043 6972  ours...class Cir
-0002efe0: 636c 6533 4428 436f 6e74 6f75 7233 4429  cle3D(Contour3D)
-0002eff0: 3a0a 2020 2020 2222 220a 2020 2020 4465  :.    """.    De
-0002f000: 6669 6e65 7320 6120 4369 7263 6c65 2069  fines a Circle i
-0002f010: 6e20 7468 7265 6520 6469 6d65 6e73 696f  n three dimensio
-0002f020: 6e73 2c20 7769 7468 2061 2063 656e 7465  ns, with a cente
-0002f030: 7220 616e 6420 6120 7261 6469 7573 2e0a  r and a radius..
-0002f040: 0a20 2020 2022 2222 0a20 2020 205f 6e6f  .    """.    _no
-0002f050: 6e5f 7365 7269 616c 697a 6162 6c65 5f61  n_serializable_a
-0002f060: 7474 7269 6275 7465 7320 3d20 5b27 706f  ttributes = ['po
-0002f070: 696e 7427 2c20 2765 6467 6573 272c 2027  int', 'edges', '
-0002f080: 706f 696e 745f 696e 7369 6465 5f63 6f6e  point_inside_con
-0002f090: 746f 7572 275d 0a20 2020 205f 6e6f 6e5f  tour'].    _non_
-0002f0a0: 6571 5f61 7474 7269 6275 7465 7320 3d20  eq_attributes = 
-0002f0b0: 5b27 6e61 6d65 275d 0a20 2020 205f 6e6f  ['name'].    _no
-0002f0c0: 6e5f 6861 7368 5f61 7474 7269 6275 7465  n_hash_attribute
-0002f0d0: 7320 3d20 5b27 6e61 6d65 275d 0a20 2020  s = ['name'].   
-0002f0e0: 205f 6765 6e65 7269 635f 6571 203d 2054   _generic_eq = T
-0002f0f0: 7275 650a 0a20 2020 2064 6566 205f 5f69  rue..    def __i
-0002f100: 6e69 745f 5f28 7365 6c66 2c20 6672 616d  nit__(self, fram
-0002f110: 653a 2076 6f6c 6d64 6c72 2e46 7261 6d65  e: volmdlr.Frame
-0002f120: 3344 2c20 7261 6469 7573 3a20 666c 6f61  3D, radius: floa
-0002f130: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-0002f140: 2020 2020 6e61 6d65 3a20 7374 7220 3d20      name: str = 
-0002f150: 2727 293a 0a20 2020 2020 2020 2022 2222  ''):.        """
-0002f160: 0a20 2020 2020 2020 2066 7261 6d65 2e75  .        frame.u
-0002f170: 2c20 6672 616d 652e 7620 6465 6669 6e65  , frame.v define
-0002f180: 2074 6865 2070 6c61 6e65 2c20 6672 616d   the plane, fram
-0002f190: 652e 7720 7468 6520 6e6f 726d 616c 0a20  e.w the normal. 
-0002f1a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002f1b0: 2020 2073 656c 662e 7261 6469 7573 203d     self.radius =
-0002f1c0: 2072 6164 6975 730a 2020 2020 2020 2020   radius.        
-0002f1d0: 7365 6c66 2e66 7261 6d65 203d 2066 7261  self.frame = fra
-0002f1e0: 6d65 0a20 2020 2020 2020 2073 656c 662e  me.        self.
-0002f1f0: 616e 676c 6520 3d20 766f 6c6d 646c 722e  angle = volmdlr.
-0002f200: 5457 4f5f 5049 0a20 2020 2020 2020 2073  TWO_PI.        s
-0002f210: 656c 662e 5f70 7269 6d69 7469 7665 7320  elf._primitives 
-0002f220: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
-0002f230: 656c 662e 7072 696d 6974 6976 6573 203d  elf.primitives =
-0002f240: 2073 656c 662e 6765 745f 7072 696d 6974   self.get_primit
-0002f250: 6976 6573 2829 0a20 2020 2020 2020 2043  ives().        C
-0002f260: 6f6e 746f 7572 3344 2e5f 5f69 6e69 745f  ontour3D.__init_
-0002f270: 5f28 7365 6c66 2c20 7365 6c66 2e70 7269  _(self, self.pri
-0002f280: 6d69 7469 7665 732c 206e 616d 653d 6e61  mitives, name=na
-0002f290: 6d65 290a 0a20 2020 2040 7072 6f70 6572  me)..    @proper
-0002f2a0: 7479 0a20 2020 2064 6566 2063 656e 7465  ty.    def cente
-0002f2b0: 7228 7365 6c66 293a 0a20 2020 2020 2020  r(self):.       
-0002f2c0: 2072 6574 7572 6e20 7365 6c66 2e66 7261   return self.fra
-0002f2d0: 6d65 2e6f 7269 6769 6e0a 0a20 2020 2040  me.origin..    @
-0002f2e0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0002f2f0: 206e 6f72 6d61 6c28 7365 6c66 293a 0a20   normal(self):. 
-0002f300: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0002f310: 6c66 2e66 7261 6d65 2e77 0a0a 2020 2020  lf.frame.w..    
-0002f320: 6465 6620 5f5f 6861 7368 5f5f 2873 656c  def __hash__(sel
-0002f330: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-0002f340: 726e 2068 6173 6828 7365 6c66 2e66 7261  rn hash(self.fra
-0002f350: 6d65 2e6f 7269 6769 6e29 0a0a 2020 2020  me.origin)..    
-0002f360: 6465 6620 5f5f 6571 5f5f 2873 656c 662c  def __eq__(self,
-0002f370: 206f 7468 6572 5f63 6972 636c 6529 3a0a   other_circle):.
-0002f380: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002f390: 656c 662e 6672 616d 652e 6f72 6967 696e  elf.frame.origin
-0002f3a0: 203d 3d20 6f74 6865 725f 6369 7263 6c65   == other_circle
-0002f3b0: 2e66 7261 6d65 2e6f 7269 6769 6e20 5c0a  .frame.origin \.
-0002f3c0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0002f3d0: 6e64 2073 656c 662e 6672 616d 652e 772e  nd self.frame.w.
-0002f3e0: 6973 5f63 6f6c 696e 6561 7228 6f74 6865  is_colinear(othe
-0002f3f0: 725f 6369 7263 6c65 2e66 7261 6d65 2e77  r_circle.frame.w
-0002f400: 2920 5c0a 2020 2020 2020 2020 2020 2020  ) \.            
-0002f410: 2020 2061 6e64 206d 6174 682e 6973 636c     and math.iscl
-0002f420: 6f73 6528 7365 6c66 2e72 6164 6975 732c  ose(self.radius,
-0002f430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f450: 206f 7468 6572 5f63 6972 636c 652e 7261   other_circle.ra
-0002f460: 6469 7573 2c20 6162 735f 746f 6c3d 3165  dius, abs_tol=1e
-0002f470: 2d30 3629 0a0a 2020 2020 6465 6620 6765  -06)..    def ge
-0002f480: 745f 7072 696d 6974 6976 6573 2873 656c  t_primitives(sel
-0002f490: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-0002f4a0: 2020 2020 2020 2020 4361 6c63 756c 6174          Calculat
-0002f4b0: 6573 2070 7269 6d69 7469 7665 7320 746f  es primitives to
-0002f4c0: 2063 6f6d 706f 7365 2043 6972 636c 653a   compose Circle:
-0002f4d0: 2032 2041 7263 3344 2e0a 0a20 2020 2020   2 Arc3D...     
-0002f4e0: 2020 203a 7265 7475 726e 3a20 6c69 7374     :return: list
-0002f4f0: 2063 6f6e 7461 696e 696e 6720 7477 6f20   containing two 
-0002f500: 4172 6333 440a 2020 2020 2020 2020 2222  Arc3D.        ""
-0002f510: 220a 2020 2020 2020 2020 6966 206e 6f74  ".        if not
-0002f520: 2073 656c 662e 5f70 7269 6d69 7469 7665   self._primitive
-0002f530: 733a 0a20 2020 2020 2020 2020 2020 2070  s:.            p
-0002f540: 6f69 6e74 7320 3d20 5b73 656c 662e 6365  oints = [self.ce
-0002f550: 6e74 6572 202b 2073 656c 662e 6672 616d  nter + self.fram
-0002f560: 652e 7520 2a20 7365 6c66 2e72 6164 6975  e.u * self.radiu
-0002f570: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0002f580: 2020 2020 2020 2020 2073 656c 662e 6365           self.ce
-0002f590: 6e74 6572 202d 2073 656c 662e 6672 616d  nter - self.fram
-0002f5a0: 652e 7620 2a20 7365 6c66 2e72 6164 6975  e.v * self.radiu
-0002f5b0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0002f5c0: 2020 2020 2020 2020 2073 656c 662e 6365           self.ce
-0002f5d0: 6e74 6572 202d 2073 656c 662e 6672 616d  nter - self.fram
-0002f5e0: 652e 7520 2a20 7365 6c66 2e72 6164 6975  e.u * self.radiu
-0002f5f0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0002f600: 2020 2020 2020 2020 2073 656c 662e 6365           self.ce
-0002f610: 6e74 6572 202b 2073 656c 662e 6672 616d  nter + self.fram
-0002f620: 652e 7620 2a20 7365 6c66 2e72 6164 6975  e.v * self.radiu
-0002f630: 735d 0a20 2020 2020 2020 2020 2020 2073  s].            s
-0002f640: 656c 662e 5f70 7269 6d69 7469 7665 7320  elf._primitives 
-0002f650: 3d20 5b76 6f6c 6d64 6c72 2e65 6467 6573  = [volmdlr.edges
-0002f660: 2e41 7263 3344 2870 6f69 6e74 735b 305d  .Arc3D(points[0]
-0002f670: 2c20 706f 696e 7473 5b31 5d2c 2070 6f69  , points[1], poi
-0002f680: 6e74 735b 325d 292c 0a20 2020 2020 2020  nts[2]),.       
-0002f690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f6a0: 2020 2020 2020 2020 2076 6f6c 6d64 6c72           volmdlr
-0002f6b0: 2e65 6467 6573 2e41 7263 3344 2870 6f69  .edges.Arc3D(poi
-0002f6c0: 6e74 735b 325d 2c20 706f 696e 7473 5b33  nts[2], points[3
-0002f6d0: 5d2c 2070 6f69 6e74 735b 305d 295d 0a0a  ], points[0])]..
-0002f6e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002f6f0: 656c 662e 5f70 7269 6d69 7469 7665 730a  elf._primitives.
-0002f700: 0a20 2020 2064 6566 2064 6973 6372 6574  .    def discret
-0002f710: 697a 6174 696f 6e5f 706f 696e 7473 2873  ization_points(s
-0002f720: 656c 662c 202a 2c20 6e75 6d62 6572 5f70  elf, *, number_p
-0002f730: 6f69 6e74 733a 2069 6e74 203d 204e 6f6e  oints: int = Non
-0002f740: 652c 2061 6e67 6c65 5f72 6573 6f6c 7574  e, angle_resolut
-0002f750: 696f 6e3a 2069 6e74 203d 2032 3029 3a0a  ion: int = 20):.
-0002f760: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002f770: 2020 2020 4469 7363 7265 7469 7a65 2061      Discretize a
-0002f780: 2043 6972 636c 6520 746f 2068 6176 6520   Circle to have 
-0002f790: 226e 2220 706f 696e 7473 2e0a 0a20 2020  "n" points...   
-0002f7a0: 2020 2020 203a 7061 7261 6d20 6e75 6d62       :param numb
-0002f7b0: 6572 5f70 6f69 6e74 733a 2074 6865 206e  er_points: the n
-0002f7c0: 756d 6265 7220 6f66 2070 6f69 6e74 7320  umber of points 
-0002f7d0: 2869 6e63 6c75 6469 6e67 2073 7461 7274  (including start
-0002f7e0: 2061 6e64 2065 6e64 2070 6f69 6e74 7329   and end points)
-0002f7f0: 0a20 2020 2020 2020 2020 2020 2020 6966  .             if
-0002f800: 2075 6e73 6574 2c20 6f6e 6c79 2073 7461   unset, only sta
-0002f810: 7274 2061 6e64 2065 6e64 2077 696c 6c20  rt and end will 
-0002f820: 6265 2072 6574 7572 6e65 640a 2020 2020  be returned.    
-0002f830: 2020 2020 3a70 6172 616d 2061 6e67 6c65      :param angle
-0002f840: 5f72 6573 6f6c 7574 696f 6e3a 2069 6620  _resolution: if 
-0002f850: 7365 742c 2074 6865 2073 616d 706c 696e  set, the samplin
-0002f860: 6720 7769 6c6c 2062 6520 6164 6170 7465  g will be adapte
-0002f870: 6420 746f 2068 6176 6520 6120 636f 6e74  d to have a cont
-0002f880: 726f 6c6c 6564 2061 6e67 756c 6172 2064  rolled angular d
-0002f890: 6973 7461 6e63 652e 2055 7365 6675 6c0a  istance. Useful.
-0002f8a0: 2020 2020 2020 2020 2020 2020 746f 206d              to m
-0002f8b0: 6573 6820 616e 2061 7263 0a20 2020 2020  esh an arc.     
-0002f8c0: 2020 203a 7265 7475 726e 3a20 6120 6c69     :return: a li
-0002f8d0: 7374 206f 6620 7361 6d70 6c65 6420 706f  st of sampled po
-0002f8e0: 696e 7473 0a20 2020 2020 2020 2022 2222  ints.        """
-0002f8f0: 0a20 2020 2020 2020 2069 6620 6e75 6d62  .        if numb
-0002f900: 6572 5f70 6f69 6e74 733a 0a20 2020 2020  er_points:.     
-0002f910: 2020 2020 2020 2061 6e67 6c65 5f72 6573         angle_res
-0002f920: 6f6c 7574 696f 6e20 3d20 6e75 6d62 6572  olution = number
-0002f930: 5f70 6f69 6e74 730a 2020 2020 2020 2020  _points.        
-0002f940: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
-0002f950: 6f69 6e74 735f 3364 203d 205b 7365 6c66  oints_3d = [self
-0002f960: 2e63 656e 7465 7220 2b20 7365 6c66 2e72  .center + self.r
-0002f970: 6164 6975 7320 2a20 6d61 7468 2e63 6f73  adius * math.cos
-0002f980: 2874 6574 6129 202a 2073 656c 662e 6672  (teta) * self.fr
-0002f990: 616d 652e 7520 2b0a 2020 2020 2020 2020  ame.u +.        
-0002f9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f9b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002f9c0: 2e72 6164 6975 7320 2a20 6d61 7468 2e73  .radius * math.s
-0002f9d0: 696e 2874 6574 6129 202a 2073 656c 662e  in(teta) * self.
-0002f9e0: 6672 616d 652e 7620 666f 7220 7465 7461  frame.v for teta
-0002f9f0: 2069 6e0a 2020 2020 2020 2020 2020 2020   in.            
-0002fa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa10: 2020 2020 2020 2020 6e70 792e 6c69 6e73          npy.lins
-0002fa20: 7061 6365 2830 2c20 766f 6c6d 646c 722e  pace(0, volmdlr.
-0002fa30: 5457 4f5f 5049 2c20 616e 676c 655f 7265  TWO_PI, angle_re
-0002fa40: 736f 6c75 7469 6f6e 202b 2031 295d 5b3a  solution + 1)][:
-0002fa50: 2d31 5d0a 2020 2020 2020 2020 7265 7475  -1].        retu
-0002fa60: 726e 2064 6973 6372 6574 697a 6174 696f  rn discretizatio
-0002fa70: 6e5f 706f 696e 7473 5f33 640a 0a20 2020  n_points_3d..   
-0002fa80: 2064 6566 2061 6273 6369 7373 6128 7365   def abscissa(se
-0002fa90: 6c66 2c20 706f 696e 743a 2076 6f6c 6d64  lf, point: volmd
-0002faa0: 6c72 2e50 6f69 6e74 3344 293a 0a20 2020  lr.Point3D):.   
-0002fab0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002fac0: 2043 616c 6375 6c61 7465 7320 7468 6520   Calculates the 
-0002fad0: 6162 7363 6973 7361 2061 2067 6976 656e  abscissa a given
-0002fae0: 2070 6f69 6e74 2e0a 0a20 2020 2020 2020   point...       
-0002faf0: 203a 7061 7261 6d20 706f 696e 743a 2070   :param point: p
-0002fb00: 6f69 6e74 2074 6f20 6361 6c63 756c 6174  oint to calculat
-0002fb10: 6520 6162 7363 6973 7361 2e0a 2020 2020  e abscissa..    
-0002fb20: 2020 2020 3a72 6574 7572 6e3a 2061 6273      :return: abs
-0002fb30: 6369 7373 610a 2020 2020 2020 2020 2222  cissa.        ""
-0002fb40: 220a 2020 2020 2020 2020 782c 2079 2c20  ".        x, y, 
-0002fb50: 5f20 3d20 7365 6c66 2e66 7261 6d65 2e67  _ = self.frame.g
-0002fb60: 6c6f 6261 6c5f 746f 5f6c 6f63 616c 5f63  lobal_to_local_c
-0002fb70: 6f6f 7264 696e 6174 6573 2870 6f69 6e74  oordinates(point
-0002fb80: 290a 2020 2020 2020 2020 7531 203d 2078  ).        u1 = x
-0002fb90: 202f 2073 656c 662e 7261 6469 7573 0a20   / self.radius. 
-0002fba0: 2020 2020 2020 2075 3220 3d20 7920 2f20         u2 = y / 
-0002fbb0: 7365 6c66 2e72 6164 6975 730a 2020 2020  self.radius.    
-0002fbc0: 2020 2020 7468 6574 6120 3d20 766f 6c6d      theta = volm
-0002fbd0: 646c 722e 6765 6f6d 6574 7279 2e73 696e  dlr.geometry.sin
-0002fbe0: 5f63 6f73 5f61 6e67 6c65 2875 312c 2075  _cos_angle(u1, u
-0002fbf0: 3229 0a0a 2020 2020 2020 2020 7265 7475  2)..        retu
-0002fc00: 726e 2073 656c 662e 7261 6469 7573 202a  rn self.radius *
-0002fc10: 2061 6273 2874 6865 7461 290a 0a20 2020   abs(theta)..   
-0002fc20: 2064 6566 206c 656e 6774 6828 7365 6c66   def length(self
-0002fc30: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0002fc40: 6e20 766f 6c6d 646c 722e 5457 4f5f 5049  n volmdlr.TWO_PI
-0002fc50: 202a 2073 656c 662e 7261 6469 7573 0a0a   * self.radius..
-0002fc60: 2020 2020 6465 6620 726f 7461 7469 6f6e      def rotation
-0002fc70: 2873 656c 662c 2063 656e 7465 723a 2076  (self, center: v
-0002fc80: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 2c20  olmdlr.Point3D, 
-0002fc90: 6178 6973 3a20 766f 6c6d 646c 722e 5665  axis: volmdlr.Ve
-0002fca0: 6374 6f72 3344 2c20 616e 676c 653a 2066  ctor3D, angle: f
-0002fcb0: 6c6f 6174 293a 0a20 2020 2020 2020 2022  loat):.        "
-0002fcc0: 2222 0a20 2020 2020 2020 2043 6972 636c  "".        Circl
-0002fcd0: 6533 4420 726f 7461 7469 6f6e 2e0a 0a20  e3D rotation... 
-0002fce0: 2020 2020 2020 203a 7061 7261 6d20 6365         :param ce
-0002fcf0: 6e74 6572 3a20 726f 7461 7469 6f6e 2063  nter: rotation c
-0002fd00: 656e 7465 720a 2020 2020 2020 2020 3a70  enter.        :p
-0002fd10: 6172 616d 2061 7869 733a 2072 6f74 6174  aram axis: rotat
-0002fd20: 696f 6e20 6178 6973 0a20 2020 2020 2020  ion axis.       
-0002fd30: 203a 7061 7261 6d20 616e 676c 653a 2061   :param angle: a
-0002fd40: 6e67 6c65 2072 6f74 6174 696f 6e0a 2020  ngle rotation.  
-0002fd50: 2020 2020 2020 3a72 6574 7572 6e3a 2061        :return: a
-0002fd60: 206e 6577 2072 6f74 6174 6564 2043 6972   new rotated Cir
-0002fd70: 636c 6533 440a 2020 2020 2020 2020 2222  cle3D.        ""
-0002fd80: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-0002fd90: 2043 6972 636c 6533 4428 7365 6c66 2e66   Circle3D(self.f
-0002fda0: 7261 6d65 2e72 6f74 6174 696f 6e28 6365  rame.rotation(ce
-0002fdb0: 6e74 6572 2c20 6178 6973 2c20 616e 676c  nter, axis, angl
-0002fdc0: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-0002fdd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002fde0: 2e72 6164 6975 732c 2073 656c 662e 6e61  .radius, self.na
-0002fdf0: 6d65 290a 0a20 2020 2064 6566 2072 6f74  me)..    def rot
-0002fe00: 6174 696f 6e5f 696e 706c 6163 6528 7365  ation_inplace(se
-0002fe10: 6c66 2c20 6365 6e74 6572 3a20 766f 6c6d  lf, center: volm
-0002fe20: 646c 722e 506f 696e 7433 442c 2061 7869  dlr.Point3D, axi
-0002fe30: 733a 2076 6f6c 6d64 6c72 2e56 6563 746f  s: volmdlr.Vecto
-0002fe40: 7233 442c 2061 6e67 6c65 3a20 666c 6f61  r3D, angle: floa
-0002fe50: 7429 3a0a 2020 2020 2020 2020 2222 220a  t):.        """.
-0002fe60: 2020 2020 2020 2020 4369 7263 6c65 3344          Circle3D
-0002fe70: 2072 6f74 6174 696f 6e2e 204f 626a 6563   rotation. Objec
-0002fe80: 7420 6973 2075 7064 6174 6564 2069 6e70  t is updated inp
-0002fe90: 6c61 6365 2e0a 0a20 2020 2020 2020 203a  lace...        :
-0002fea0: 7061 7261 6d20 6365 6e74 6572 3a20 726f  param center: ro
-0002feb0: 7461 7469 6f6e 2063 656e 7465 720a 2020  tation center.  
-0002fec0: 2020 2020 2020 3a70 6172 616d 2061 7869        :param axi
-0002fed0: 733a 2072 6f74 6174 696f 6e20 6178 6973  s: rotation axis
-0002fee0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0002fef0: 616e 676c 653a 2072 6f74 6174 696f 6e20  angle: rotation 
-0002ff00: 616e 676c 650a 2020 2020 2020 2020 2222  angle.        ""
-0002ff10: 220a 2020 2020 2020 2020 7761 726e 696e  ".        warnin
-0002ff20: 6773 2e77 6172 6e28 2227 696e 706c 6163  gs.warn("'inplac
-0002ff30: 6527 206d 6574 686f 6473 2061 7265 2064  e' methods are d
-0002ff40: 6570 7265 6361 7465 642e 2055 7365 2061  eprecated. Use a
-0002ff50: 206e 6f74 2069 6e70 6c61 6365 206d 6574   not inplace met
-0002ff60: 686f 6420 696e 7374 6561 642e 222c 2044  hod instead.", D
-0002ff70: 6570 7265 6361 7469 6f6e 5761 726e 696e  eprecationWarnin
-0002ff80: 6729 0a0a 2020 2020 2020 2020 7365 6c66  g)..        self
-0002ff90: 2e66 7261 6d65 2e72 6f74 6174 696f 6e5f  .frame.rotation_
-0002ffa0: 696e 706c 6163 6528 6365 6e74 6572 2c20  inplace(center, 
-0002ffb0: 6178 6973 2c20 616e 676c 6529 0a0a 2020  axis, angle)..  
-0002ffc0: 2020 6465 6620 7472 616e 736c 6174 696f    def translatio
-0002ffd0: 6e28 7365 6c66 2c20 6f66 6673 6574 3a20  n(self, offset: 
-0002ffe0: 766f 6c6d 646c 722e 5665 6374 6f72 3344  volmdlr.Vector3D
-0002fff0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00030000: 2020 2020 2020 2043 6972 636c 6533 4420         Circle3D 
-00030010: 7472 616e 736c 6174 696f 6e2e 0a0a 2020  translation...  
-00030020: 2020 2020 2020 3a70 6172 616d 206f 6666        :param off
-00030030: 7365 743a 2074 7261 6e73 6c61 7469 6f6e  set: translation
-00030040: 2076 6563 746f 720a 2020 2020 2020 2020   vector.        
-00030050: 3a72 6574 7572 6e3a 2041 206e 6577 2074  :return: A new t
-00030060: 7261 6e73 6c61 7465 6420 4369 7263 6c65  ranslated Circle
-00030070: 3344 0a20 2020 2020 2020 2022 2222 0a20  3D.        """. 
-00030080: 2020 2020 2020 2072 6574 7572 6e20 4369         return Ci
-00030090: 7263 6c65 3344 2873 656c 662e 6672 616d  rcle3D(self.fram
-000300a0: 652e 7472 616e 736c 6174 696f 6e28 6f66  e.translation(of
-000300b0: 6673 6574 292c 2073 656c 662e 7261 6469  fset), self.radi
-000300c0: 7573 2c20 7365 6c66 2e6e 616d 6529 0a0a  us, self.name)..
-000300d0: 2020 2020 6465 6620 7472 616e 736c 6174      def translat
-000300e0: 696f 6e5f 696e 706c 6163 6528 7365 6c66  ion_inplace(self
-000300f0: 2c20 6f66 6673 6574 3a20 766f 6c6d 646c  , offset: volmdl
-00030100: 722e 5665 6374 6f72 3344 293a 0a20 2020  r.Vector3D):.   
-00030110: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00030120: 2043 6972 636c 6533 4420 7472 616e 736c   Circle3D transl
-00030130: 6174 696f 6e2e 204f 626a 6563 7420 6973  ation. Object is
-00030140: 2075 7064 6174 6564 2069 6e70 6c61 6365   updated inplace
-00030150: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00030160: 6d20 6f66 6673 6574 3a20 7472 616e 736c  m offset: transl
-00030170: 6174 696f 6e20 7665 6374 6f72 0a20 2020  ation vector.   
-00030180: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00030190: 2077 6172 6e69 6e67 732e 7761 726e 2822   warnings.warn("
-000301a0: 2769 6e70 6c61 6365 2720 6d65 7468 6f64  'inplace' method
-000301b0: 7320 6172 6520 6465 7072 6563 6174 6564  s are deprecated
-000301c0: 2e20 5573 6520 6120 6e6f 7420 696e 706c  . Use a not inpl
-000301d0: 6163 6520 6d65 7468 6f64 2069 6e73 7465  ace method inste
-000301e0: 6164 2e22 2c20 4465 7072 6563 6174 696f  ad.", Deprecatio
-000301f0: 6e57 6172 6e69 6e67 290a 0a20 2020 2020  nWarning)..     
-00030200: 2020 2073 656c 662e 6672 616d 652e 7472     self.frame.tr
-00030210: 616e 736c 6174 696f 6e5f 696e 706c 6163  anslation_inplac
-00030220: 6528 6f66 6673 6574 290a 0a20 2020 2064  e(offset)..    d
-00030230: 6566 2070 6c6f 7428 7365 6c66 2c20 6178  ef plot(self, ax
-00030240: 3d4e 6f6e 652c 2063 6f6c 6f72 3d27 6b27  =None, color='k'
-00030250: 2c20 616c 7068 613d 312e 2c20 6564 6765  , alpha=1., edge
-00030260: 5f64 6574 6169 6c73 3d46 616c 7365 293a  _details=False):
-00030270: 0a20 2020 2020 2020 2069 6620 6178 2069  .        if ax i
-00030280: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00030290: 2020 2020 6669 6720 3d20 706c 742e 6669      fig = plt.fi
-000302a0: 6775 7265 2829 0a20 2020 2020 2020 2020  gure().         
-000302b0: 2020 2061 7820 3d20 6669 672e 6164 645f     ax = fig.add_
-000302c0: 7375 6270 6c6f 7428 3131 312c 2070 726f  subplot(111, pro
-000302d0: 6a65 6374 696f 6e3d 2733 6427 290a 2020  jection='3d').  
-000302e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000302f0: 2020 2020 2020 2020 6669 6720 3d20 4e6f          fig = No
-00030300: 6e65 0a0a 2020 2020 2020 2020 7820 3d20  ne..        x = 
-00030310: 5b5d 0a20 2020 2020 2020 2079 203d 205b  [].        y = [
-00030320: 5d0a 2020 2020 2020 2020 7a20 3d20 5b5d  ].        z = []
-00030330: 0a20 2020 2020 2020 2066 6f72 2070 6f69  .        for poi
-00030340: 6e74 5f78 2c20 706f 696e 745f 792c 2070  nt_x, point_y, p
-00030350: 6f69 6e74 5f7a 2069 6e20 7365 6c66 2e64  oint_z in self.d
-00030360: 6973 6372 6574 697a 6174 696f 6e5f 706f  iscretization_po
-00030370: 696e 7473 2829 3a0a 2020 2020 2020 2020  ints():.        
-00030380: 2020 2020 782e 6170 7065 6e64 2870 6f69      x.append(poi
-00030390: 6e74 5f78 290a 2020 2020 2020 2020 2020  nt_x).          
-000303a0: 2020 792e 6170 7065 6e64 2870 6f69 6e74    y.append(point
-000303b0: 5f79 290a 2020 2020 2020 2020 2020 2020  _y).            
-000303c0: 7a2e 6170 7065 6e64 2870 6f69 6e74 5f7a  z.append(point_z
-000303d0: 290a 2020 2020 2020 2020 782e 6170 7065  ).        x.appe
-000303e0: 6e64 2878 5b30 5d29 0a20 2020 2020 2020  nd(x[0]).       
-000303f0: 2079 2e61 7070 656e 6428 795b 305d 290a   y.append(y[0]).
-00030400: 2020 2020 2020 2020 7a2e 6170 7065 6e64          z.append
-00030410: 287a 5b30 5d29 0a20 2020 2020 2020 2061  (z[0]).        a
-00030420: 782e 706c 6f74 2878 2c20 792c 207a 2c20  x.plot(x, y, z, 
-00030430: 636f 6c6f 723d 636f 6c6f 722c 2061 6c70  color=color, alp
-00030440: 6861 3d61 6c70 6861 290a 2020 2020 2020  ha=alpha).      
-00030450: 2020 7265 7475 726e 2061 780a 0a20 2020    return ax..   
-00030460: 2064 6566 2070 6f69 6e74 5f61 745f 6162   def point_at_ab
-00030470: 7363 6973 7361 2873 656c 662c 2063 7572  scissa(self, cur
-00030480: 7669 6c69 6e65 6172 5f61 6273 6369 7373  vilinear_absciss
-00030490: 6129 3a0a 2020 2020 2020 2020 2222 2220  a):.        """ 
-000304a0: 5374 6172 7420 706f 696e 7420 6973 2061  Start point is a
-000304b0: 7420 696e 7465 7273 6563 7469 6f6e 206f  t intersection o
-000304c0: 6620 6672 616d 652e 7520 6178 6973 2e20  f frame.u axis. 
-000304d0: 2222 220a 2020 2020 2020 2020 7374 6172  """.        star
-000304e0: 7420 3d20 7365 6c66 2e66 7261 6d65 2e6f  t = self.frame.o
-000304f0: 7269 6769 6e20 2b20 7365 6c66 2e72 6164  rigin + self.rad
-00030500: 6975 7320 2a20 7365 6c66 2e66 7261 6d65  ius * self.frame
-00030510: 2e75 0a20 2020 2020 2020 2072 6574 7572  .u.        retur
-00030520: 6e20 7374 6172 742e 726f 7461 7469 6f6e  n start.rotation
-00030530: 2873 656c 662e 6672 616d 652e 6f72 6967  (self.frame.orig
-00030540: 696e 2c20 7365 6c66 2e66 7261 6d65 2e77  in, self.frame.w
-00030550: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00030560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030570: 6375 7276 696c 696e 6561 725f 6162 7363  curvilinear_absc
-00030580: 6973 7361 202f 2073 656c 662e 7261 6469  issa / self.radi
-00030590: 7573 290a 0a20 2020 2064 6566 206c 696e  us)..    def lin
-000305a0: 6573 6567 6d65 6e74 5f69 6e74 6572 7365  esegment_interse
-000305b0: 6374 696f 6e73 2873 656c 662c 206c 696e  ctions(self, lin
-000305c0: 6573 6567 6d65 6e74 3a20 766f 6c6d 646c  esegment: volmdl
-000305d0: 722e 6564 6765 732e 4c69 6e65 5365 676d  r.edges.LineSegm
-000305e0: 656e 7433 4429 3a0a 2020 2020 2020 2020  ent3D):.        
-000305f0: 2222 220a 2020 2020 2020 2020 4361 6c63  """.        Calc
-00030600: 756c 6174 6573 2074 6865 2069 6e74 6572  ulates the inter
-00030610: 7365 6374 696f 6e73 2062 6574 7765 656e  sections between
-00030620: 2074 6865 2043 6972 636c 6533 4420 616e   the Circle3D an
-00030630: 6420 6120 4c69 6e65 5365 676d 656e 7433  d a LineSegment3
-00030640: 442e 0a0a 2020 2020 2020 2020 3a70 6172  D...        :par
-00030650: 616d 206c 696e 6573 6567 6d65 6e74 3a20  am linesegment: 
-00030660: 4c69 6e65 5365 676d 656e 7433 4420 746f  LineSegment3D to
-00030670: 2076 6572 6966 7920 696e 7465 7273 6563   verify intersec
-00030680: 7469 6f6e 730a 2020 2020 2020 2020 3a72  tions.        :r
-00030690: 6574 7572 6e3a 206c 6973 7420 6f66 2070  eturn: list of p
-000306a0: 6f69 6e74 7320 696e 7465 7273 6563 7469  oints intersecti
-000306b0: 6e67 2043 6972 636c 650a 2020 2020 2020  ng Circle.      
-000306c0: 2020 2222 220a 2020 2020 2020 2020 696e    """.        in
-000306d0: 7465 7273 6563 7469 6f6e 7320 3d20 5b5d  tersections = []
-000306e0: 0a20 2020 2020 2020 2063 6972 636c 6533  .        circle3
-000306f0: 645f 6c69 6e65 5f69 6e74 6572 7365 6374  d_line_intersect
-00030700: 696f 6e73 203d 2076 6d5f 7574 696c 735f  ions = vm_utils_
-00030710: 696e 7465 7273 6563 7469 6f6e 732e 6369  intersections.ci
-00030720: 7263 6c65 5f33 645f 6c69 6e65 5f69 6e74  rcle_3d_line_int
-00030730: 6572 7365 6374 696f 6e73 2873 656c 662c  ersections(self,
-00030740: 206c 696e 6573 6567 6d65 6e74 2e74 6f5f   linesegment.to_
-00030750: 6c69 6e65 2829 290a 2020 2020 2020 2020  line()).        
-00030760: 666f 7220 696e 7465 7273 6563 7469 6f6e  for intersection
-00030770: 2069 6e20 6369 7263 6c65 3364 5f6c 696e   in circle3d_lin
-00030780: 655f 696e 7465 7273 6563 7469 6f6e 733a  e_intersections:
-00030790: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000307a0: 6c69 6e65 7365 676d 656e 742e 706f 696e  linesegment.poin
-000307b0: 745f 6265 6c6f 6e67 7328 696e 7465 7273  t_belongs(inters
-000307c0: 6563 7469 6f6e 293a 0a20 2020 2020 2020  ection):.       
-000307d0: 2020 2020 2020 2020 2069 6e74 6572 7365           interse
-000307e0: 6374 696f 6e73 2e61 7070 656e 6428 696e  ctions.append(in
-000307f0: 7465 7273 6563 7469 6f6e 290a 2020 2020  tersection).    
-00030800: 2020 2020 7265 7475 726e 2069 6e74 6572      return inter
-00030810: 7365 6374 696f 6e73 0a0a 2020 2020 4063  sections..    @c
-00030820: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
-00030830: 6566 2066 726f 6d5f 7374 6570 2863 6c73  ef from_step(cls
-00030840: 2c20 6172 6775 6d65 6e74 732c 206f 626a  , arguments, obj
-00030850: 6563 745f 6469 6374 293a 0a20 2020 2020  ect_dict):.     
-00030860: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-00030870: 6f6e 7665 7274 7320 6120 7374 6570 2070  onverts a step p
-00030880: 7269 6d69 7469 7665 2074 6f20 6120 4369  rimitive to a Ci
-00030890: 7263 6c65 3344 2e0a 0a20 2020 2020 2020  rcle3D...       
-000308a0: 203a 7061 7261 6d20 6172 6775 6d65 6e74   :param argument
-000308b0: 733a 2054 6865 2061 7267 756d 656e 7473  s: The arguments
-000308c0: 206f 6620 7468 6520 7374 6570 2070 7269   of the step pri
-000308d0: 6d69 7469 7665 2e20 5468 6520 6c61 7374  mitive. The last
-000308e0: 2065 6c65 6d65 6e74 2072 6570 7265 7365   element represe
-000308f0: 6e74 7320 7468 6520 756e 6974 5f63 6f6e  nts the unit_con
-00030900: 7665 7273 696f 6e5f 6661 6374 6f72 2e0a  version_factor..
-00030910: 2020 2020 2020 2020 3a74 7970 6520 6172          :type ar
-00030920: 6775 6d65 6e74 733a 206c 6973 740a 2020  guments: list.  
-00030930: 2020 2020 2020 3a70 6172 616d 206f 626a        :param obj
-00030940: 6563 745f 6469 6374 3a20 5468 6520 6469  ect_dict: The di
-00030950: 6374 696f 6e61 7279 2063 6f6e 7461 696e  ctionary contain
-00030960: 696e 6720 616c 6c20 7468 6520 7374 6570  ing all the step
-00030970: 2070 7269 6d69 7469 7665 7320 7468 6174   primitives that
-00030980: 2068 6176 6520 616c 7265 6164 7920 6265   have already be
-00030990: 656e 2069 6e73 7461 6e74 6961 7465 642e  en instantiated.
-000309a0: 0a20 2020 2020 2020 203a 7479 7065 206f  .        :type o
-000309b0: 626a 6563 745f 6469 6374 3a20 6469 6374  bject_dict: dict
-000309c0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-000309d0: 3a20 5468 6520 636f 7272 6573 706f 6e64  : The correspond
-000309e0: 696e 6720 4369 7263 6c65 3344 206f 626a  ing Circle3D obj
-000309f0: 6563 742e 0a20 2020 2020 2020 203a 7274  ect..        :rt
-00030a00: 7970 653a 203a 636c 6173 733a 6076 6f6c  ype: :class:`vol
-00030a10: 6d64 6c72 2e77 6972 6573 2e43 6972 636c  mdlr.wires.Circl
-00030a20: 6533 4460 0a20 2020 2020 2020 2022 2222  e3D`.        """
-00030a30: 0a20 2020 2020 2020 2075 6e69 745f 636f  .        unit_co
-00030a40: 6e76 6572 7369 6f6e 5f66 6163 746f 7220  nversion_factor 
-00030a50: 3d20 6172 6775 6d65 6e74 735b 2d31 5d0a  = arguments[-1].
-00030a60: 2020 2020 2020 2020 6365 6e74 6572 203d          center =
-00030a70: 206f 626a 6563 745f 6469 6374 5b61 7267   object_dict[arg
-00030a80: 756d 656e 7473 5b31 5d5d 2e6f 7269 6769  uments[1]].origi
-00030a90: 6e0a 2020 2020 2020 2020 7261 6469 7573  n.        radius
-00030aa0: 203d 2066 6c6f 6174 2861 7267 756d 656e   = float(argumen
-00030ab0: 7473 5b32 5d29 202a 2075 6e69 745f 636f  ts[2]) * unit_co
-00030ac0: 6e76 6572 7369 6f6e 5f66 6163 746f 720a  nversion_factor.
-00030ad0: 2020 2020 2020 2020 6966 206f 626a 6563          if objec
-00030ae0: 745f 6469 6374 5b61 7267 756d 656e 7473  t_dict[arguments
-00030af0: 5b31 5d5d 2e75 2069 7320 6e6f 7420 4e6f  [1]].u is not No
-00030b00: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00030b10: 6e6f 726d 616c 203d 206f 626a 6563 745f  normal = object_
-00030b20: 6469 6374 5b61 7267 756d 656e 7473 5b31  dict[arguments[1
-00030b30: 5d5d 2e75 0a20 2020 2020 2020 2020 2020  ]].u.           
-00030b40: 206f 7468 6572 5f76 6563 203d 206f 626a   other_vec = obj
-00030b50: 6563 745f 6469 6374 5b61 7267 756d 656e  ect_dict[argumen
-00030b60: 7473 5b31 5d5d 2e76 0a20 2020 2020 2020  ts[1]].v.       
-00030b70: 2020 2020 2069 6620 6f74 6865 725f 7665       if other_ve
-00030b80: 6320 6973 206e 6f74 204e 6f6e 653a 0a20  c is not None:. 
-00030b90: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00030ba0: 7468 6572 5f76 6563 2e6e 6f72 6d61 6c69  ther_vec.normali
-00030bb0: 7a65 2829 0a20 2020 2020 2020 2065 6c73  ze().        els
-00030bc0: 653a 0a20 2020 2020 2020 2020 2020 206e  e:.            n
-00030bd0: 6f72 6d61 6c20 3d20 6f62 6a65 6374 5f64  ormal = object_d
-00030be0: 6963 745b 6172 6775 6d65 6e74 735b 315d  ict[arguments[1]
-00030bf0: 5d2e 7620 2023 206f 7520 770a 2020 2020  ].v  # ou w.    
-00030c00: 2020 2020 2020 2020 6f74 6865 725f 7665          other_ve
-00030c10: 6320 3d20 4e6f 6e65 0a20 2020 2020 2020  c = None.       
-00030c20: 206e 6f72 6d61 6c2e 6e6f 726d 616c 697a   normal.normaliz
-00030c30: 6528 290a 2020 2020 2020 2020 7265 7475  e().        retu
-00030c40: 726e 2063 6c73 2e66 726f 6d5f 6365 6e74  rn cls.from_cent
-00030c50: 6572 5f6e 6f72 6d61 6c28 6365 6e74 6572  er_normal(center
-00030c60: 2c20 6e6f 726d 616c 2c20 7261 6469 7573  , normal, radius
-00030c70: 2c20 6172 6775 6d65 6e74 735b 305d 5b31  , arguments[0][1
-00030c80: 3a2d 315d 290a 0a20 2020 2064 6566 2074  :-1])..    def t
-00030c90: 6f5f 7374 6570 2873 656c 662c 2063 7572  o_step(self, cur
-00030ca0: 7265 6e74 5f69 642c 2073 7572 6661 6365  rent_id, surface
-00030cb0: 5f69 643d 4e6f 6e65 2c20 7375 7266 6163  _id=None, surfac
-00030cc0: 6533 643d 4e6f 6e65 293a 0a20 2020 2020  e3d=None):.     
-00030cd0: 2020 2063 6972 636c 655f 6672 616d 6520     circle_frame 
-00030ce0: 3d20 766f 6c6d 646c 722e 4672 616d 6533  = volmdlr.Frame3
-00030cf0: 4428 7365 6c66 2e63 656e 7465 722c 2073  D(self.center, s
-00030d00: 656c 662e 6672 616d 652e 772c 2073 656c  elf.frame.w, sel
-00030d10: 662e 6672 616d 652e 752c 0a20 2020 2020  f.frame.u,.     
-00030d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030d40: 2020 7365 6c66 2e66 7261 6d65 2e76 290a    self.frame.v).
-00030d50: 2020 2020 2020 2020 636f 6e74 656e 742c          content,
-00030d60: 2066 7261 6d65 5f69 6420 3d20 6369 7263   frame_id = circ
-00030d70: 6c65 5f66 7261 6d65 2e74 6f5f 7374 6570  le_frame.to_step
-00030d80: 2863 7572 7265 6e74 5f69 6429 0a20 2020  (current_id).   
-00030d90: 2020 2020 2063 7572 7665 5f69 6420 3d20       curve_id = 
-00030da0: 6672 616d 655f 6964 202b 2031 0a20 2020  frame_id + 1.   
-00030db0: 2020 2020 2063 6f6e 7465 6e74 202b 3d20       content += 
-00030dc0: 2223 7b7d 203d 2043 4952 434c 4528 277b  "#{} = CIRCLE('{
-00030dd0: 7d27 2c23 7b7d 2c7b 7d29 3b5c 6e22 2e66  }',#{},{});\n".f
-00030de0: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
-00030df0: 2020 2063 7572 7665 5f69 642c 2073 656c     curve_id, sel
-00030e00: 662e 6e61 6d65 2c20 6672 616d 655f 6964  f.name, frame_id
-00030e10: 2c20 726f 756e 6428 7365 6c66 2e72 6164  , round(self.rad
-00030e20: 6975 7320 2a20 3130 3030 2c20 3329 290a  ius * 1000, 3)).
-00030e30: 0a20 2020 2020 2020 2069 6620 7375 7266  .        if surf
-00030e40: 6163 655f 6964 3a0a 2020 2020 2020 2020  ace_id:.        
-00030e50: 2020 2020 636f 6e74 656e 7420 2b3d 2022      content += "
-00030e60: 237b 7d20 3d20 5355 5246 4143 455f 4355  #{} = SURFACE_CU
-00030e70: 5256 4528 2727 2c23 7b7d 2c28 237b 7d29  RVE('',#{},(#{})
-00030e80: 2c2e 5043 5552 5645 5f53 312e 293b 5c6e  ,.PCURVE_S1.);\n
-00030e90: 222e 666f 726d 6174 280a 2020 2020 2020  ".format(.      
-00030ea0: 2020 2020 2020 2020 2020 6375 7276 655f            curve_
-00030eb0: 6964 202b 2031 2c20 6375 7276 655f 6964  id + 1, curve_id
-00030ec0: 2c20 7375 7266 6163 655f 6964 290a 2020  , surface_id).  
-00030ed0: 2020 2020 2020 2020 2020 6375 7276 655f            curve_
-00030ee0: 6964 202b 3d20 310a 0a20 2020 2020 2020  id += 1..       
-00030ef0: 2070 3120 3d20 7365 6c66 2e66 7261 6d65   p1 = self.frame
-00030f00: 2e6f 7269 6769 6e20 2b20 7365 6c66 2e66  .origin + self.f
-00030f10: 7261 6d65 2e75 202a 2073 656c 662e 7261  rame.u * self.ra
-00030f20: 6469 7573 0a20 2020 2020 2020 2023 2070  dius.        # p
-00030f30: 3220 3d20 7365 6c66 2e66 7261 6d65 2e6f  2 = self.frame.o
-00030f40: 7269 6769 6e20 2b20 7365 6c66 2e66 7261  rigin + self.fra
-00030f50: 6d65 2e76 2a73 656c 662e 7261 6469 7573  me.v*self.radius
-00030f60: 0a20 2020 2020 2020 2070 3320 3d20 7365  .        p3 = se
-00030f70: 6c66 2e66 7261 6d65 2e6f 7269 6769 6e20  lf.frame.origin 
-00030f80: 2d20 7365 6c66 2e66 7261 6d65 2e75 202a  - self.frame.u *
-00030f90: 2073 656c 662e 7261 6469 7573 0a20 2020   self.radius.   
-00030fa0: 2020 2020 2023 2070 3420 3d20 7365 6c66       # p4 = self
-00030fb0: 2e66 7261 6d65 2e6f 7269 6769 6e20 2d20  .frame.origin - 
-00030fc0: 7365 6c66 2e66 7261 6d65 2e76 2a73 656c  self.frame.v*sel
-00030fd0: 662e 7261 6469 7573 0a0a 2020 2020 2020  f.radius..      
-00030fe0: 2020 7031 5f63 6f6e 7465 6e74 2c20 7031    p1_content, p1
-00030ff0: 5f69 6420 3d20 7031 2e74 6f5f 7374 6570  _id = p1.to_step
-00031000: 2863 7572 7665 5f69 6420 2b20 312c 2076  (curve_id + 1, v
-00031010: 6572 7465 783d 5472 7565 290a 2020 2020  ertex=True).    
-00031020: 2020 2020 2320 7032 5f63 6f6e 7465 6e74      # p2_content
-00031030: 2c20 7032 5f69 6420 3d20 7032 2e74 6f5f  , p2_id = p2.to_
-00031040: 7374 6570 2870 315f 6964 2b31 2c20 7665  step(p1_id+1, ve
-00031050: 7274 6578 3d54 7275 6529 0a20 2020 2020  rtex=True).     
-00031060: 2020 2070 335f 636f 6e74 656e 742c 2070     p3_content, p
-00031070: 335f 6964 203d 2070 332e 746f 5f73 7465  3_id = p3.to_ste
-00031080: 7028 7031 5f69 6420 2b20 312c 2076 6572  p(p1_id + 1, ver
-00031090: 7465 783d 5472 7565 290a 2020 2020 2020  tex=True).      
-000310a0: 2020 2320 7034 5f63 6f6e 7465 6e74 2c20    # p4_content, 
-000310b0: 7034 5f69 6420 3d20 7034 2e74 6f5f 7374  p4_id = p4.to_st
-000310c0: 6570 2870 335f 6964 2b31 2c20 7665 7274  ep(p3_id+1, vert
-000310d0: 6578 3d54 7275 6529 0a20 2020 2020 2020  ex=True).       
-000310e0: 2063 6f6e 7465 6e74 202b 3d20 7031 5f63   content += p1_c
-000310f0: 6f6e 7465 6e74 202b 2070 335f 636f 6e74  ontent + p3_cont
-00031100: 656e 740a 0a20 2020 2020 2020 2061 7263  ent..        arc
-00031110: 315f 6964 203d 2070 335f 6964 202b 2031  1_id = p3_id + 1
-00031120: 0a20 2020 2020 2020 2063 6f6e 7465 6e74  .        content
-00031130: 202b 3d20 2223 7b7d 203d 2045 4447 455f   += "#{} = EDGE_
-00031140: 4355 5256 4528 277b 7d27 2c23 7b7d 2c23  CURVE('{}',#{},#
-00031150: 7b7d 2c23 7b7d 2c2e 542e 293b 5c6e 222e  {},#{},.T.);\n".
-00031160: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
-00031170: 2020 2020 6172 6331 5f69 642c 2073 656c      arc1_id, sel
-00031180: 662e 6e61 6d65 2c20 7031 5f69 642c 2070  f.name, p1_id, p
-00031190: 335f 6964 2c20 6375 7276 655f 6964 290a  3_id, curve_id).
-000311a0: 2020 2020 2020 2020 6f72 6965 6e74 6564          oriented
-000311b0: 5f65 6467 6531 5f69 6420 3d20 6172 6331  _edge1_id = arc1
-000311c0: 5f69 6420 2b20 310a 2020 2020 2020 2020  _id + 1.        
-000311d0: 636f 6e74 656e 7420 2b3d 2022 237b 7d20  content += "#{} 
-000311e0: 3d20 4f52 4945 4e54 4544 5f45 4447 4528  = ORIENTED_EDGE(
-000311f0: 2727 2c2a 2c2a 2c23 7b7d 2c2e 542e 293b  '',*,*,#{},.T.);
-00031200: 5c6e 222e 666f 726d 6174 280a 2020 2020  \n".format(.    
-00031210: 2020 2020 2020 2020 6f72 6965 6e74 6564          oriented
-00031220: 5f65 6467 6531 5f69 642c 2061 7263 315f  _edge1_id, arc1_
-00031230: 6964 290a 0a20 2020 2020 2020 2061 7263  id)..        arc
-00031240: 325f 6964 203d 206f 7269 656e 7465 645f  2_id = oriented_
-00031250: 6564 6765 315f 6964 202b 2031 0a20 2020  edge1_id + 1.   
-00031260: 2020 2020 2063 6f6e 7465 6e74 202b 3d20       content += 
-00031270: 2223 7b7d 203d 2045 4447 455f 4355 5256  "#{} = EDGE_CURV
-00031280: 4528 277b 7d27 2c23 7b7d 2c23 7b7d 2c23  E('{}',#{},#{},#
-00031290: 7b7d 2c2e 542e 293b 5c6e 222e 666f 726d  {},.T.);\n".form
-000312a0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-000312b0: 6172 6332 5f69 642c 2073 656c 662e 6e61  arc2_id, self.na
-000312c0: 6d65 2c20 7033 5f69 642c 2070 315f 6964  me, p3_id, p1_id
-000312d0: 2c20 6375 7276 655f 6964 290a 2020 2020  , curve_id).    
-000312e0: 2020 2020 6f72 6965 6e74 6564 5f65 6467      oriented_edg
-000312f0: 6532 5f69 6420 3d20 6172 6332 5f69 6420  e2_id = arc2_id 
-00031300: 2b20 310a 2020 2020 2020 2020 636f 6e74  + 1.        cont
-00031310: 656e 7420 2b3d 2022 237b 7d20 3d20 4f52  ent += "#{} = OR
-00031320: 4945 4e54 4544 5f45 4447 4528 2727 2c2a  IENTED_EDGE('',*
-00031330: 2c2a 2c23 7b7d 2c2e 542e 293b 5c6e 222e  ,*,#{},.T.);\n".
-00031340: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
-00031350: 2020 2020 6f72 6965 6e74 6564 5f65 6467      oriented_edg
-00031360: 6532 5f69 642c 2061 7263 325f 6964 290a  e2_id, arc2_id).
-00031370: 0a20 2020 2020 2020 2063 7572 7265 6e74  .        current
-00031380: 5f69 6420 3d20 6f72 6965 6e74 6564 5f65  _id = oriented_e
-00031390: 6467 6532 5f69 6420 2b20 310a 2020 2020  dge2_id + 1.    
-000313a0: 2020 2020 636f 6e74 656e 7420 2b3d 2022      content += "
-000313b0: 237b 7d20 3d20 4544 4745 5f4c 4f4f 5028  #{} = EDGE_LOOP(
-000313c0: 277b 7d27 2c28 237b 7d2c 237b 7d29 293b  '{}',(#{},#{}));
-000313d0: 5c6e 222e 666f 726d 6174 280a 2020 2020  \n".format(.    
-000313e0: 2020 2020 2020 2020 6375 7272 656e 745f          current_
-000313f0: 6964 2c20 7365 6c66 2e6e 616d 652c 206f  id, self.name, o
-00031400: 7269 656e 7465 645f 6564 6765 315f 6964  riented_edge1_id
-00031410: 2c20 6f72 6965 6e74 6564 5f65 6467 6532  , oriented_edge2
-00031420: 5f69 6429 0a0a 2020 2020 2020 2020 7265  _id)..        re
-00031430: 7475 726e 2063 6f6e 7465 6e74 2c20 6375  turn content, cu
-00031440: 7272 656e 745f 6964 0a0a 2020 2020 6465  rrent_id..    de
-00031450: 6620 5f62 6f75 6e64 696e 675f 626f 7828  f _bounding_box(
-00031460: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00031470: 2222 0a20 2020 2020 2020 2043 6f6d 7075  "".        Compu
-00031480: 7465 7320 7468 6520 626f 756e 6469 6e67  tes the bounding
-00031490: 2062 6f78 2e0a 0a20 2020 2020 2020 2022   box...        "
-000314a0: 2222 0a20 2020 2020 2020 2070 6f69 6e74  "".        point
-000314b0: 7320 3d20 5b73 656c 662e 6672 616d 652e  s = [self.frame.
-000314c0: 6f72 6967 696e 202b 2073 656c 662e 7261  origin + self.ra
-000314d0: 6469 7573 202a 2076 0a20 2020 2020 2020  dius * v.       
-000314e0: 2020 2020 2020 2020 2020 2066 6f72 2076             for v
-000314f0: 2069 6e20 5b73 656c 662e 6672 616d 652e   in [self.frame.
-00031500: 752c 202d 7365 6c66 2e66 7261 6d65 2e75  u, -self.frame.u
-00031510: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00031520: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00031530: 6c66 2e66 7261 6d65 2e76 2c20 2d73 656c  lf.frame.v, -sel
-00031540: 662e 6672 616d 652e 765d 5d0a 2020 2020  f.frame.v]].    
-00031550: 2020 2020 7265 7475 726e 2076 6f6c 6d64      return volmd
-00031560: 6c72 2e63 6f72 652e 426f 756e 6469 6e67  lr.core.Bounding
-00031570: 426f 782e 6672 6f6d 5f70 6f69 6e74 7328  Box.from_points(
-00031580: 706f 696e 7473 290a 0a20 2020 2064 6566  points)..    def
-00031590: 2074 6f5f 3264 2873 656c 662c 2070 6c61   to_2d(self, pla
-000315a0: 6e65 5f6f 7269 6769 6e2c 2078 2c20 7929  ne_origin, x, y)
-000315b0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000315c0: 2020 2020 2020 5472 616e 7366 6f72 6d73        Transforms
-000315d0: 2061 2043 6972 636c 6533 4420 696e 746f   a Circle3D into
-000315e0: 2061 6e20 4369 7263 6c65 3244 2c20 6769   an Circle2D, gi
-000315f0: 7665 6e20 6120 706c 616e 6520 6f72 6967  ven a plane orig
-00031600: 696e 2061 6e64 2061 6e20 7520 616e 6420  in and an u and 
-00031610: 7620 706c 616e 6520 7665 6374 6f72 2e0a  v plane vector..
-00031620: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00031630: 706c 616e 655f 6f72 6967 696e 3a20 706c  plane_origin: pl
-00031640: 616e 6520 6f72 6967 696e 2e0a 2020 2020  ane origin..    
-00031650: 2020 2020 3a70 6172 616d 2078 3a20 706c      :param x: pl
-00031660: 616e 6520 7520 7665 6374 6f72 2e0a 2020  ane u vector..  
-00031670: 2020 2020 2020 3a70 6172 616d 2079 3a20        :param y: 
-00031680: 706c 616e 6520 7620 7665 6374 6f72 2e0a  plane v vector..
-00031690: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-000316a0: 2043 6972 636c 6532 442e 0a20 2020 2020   Circle2D..     
-000316b0: 2020 2022 2222 0a20 2020 2020 2020 207a     """.        z
-000316c0: 203d 2078 2e63 726f 7373 2879 290a 2020   = x.cross(y).  
-000316d0: 2020 2020 2020 706c 616e 6533 6420 3d20        plane3d = 
-000316e0: 766f 6c6d 646c 722e 6661 6365 732e 506c  volmdlr.faces.Pl
-000316f0: 616e 6533 4428 766f 6c6d 646c 722e 4672  ane3D(volmdlr.Fr
-00031700: 616d 6533 4428 706c 616e 655f 6f72 6967  ame3D(plane_orig
-00031710: 696e 2c20 782c 2079 2c20 7a29 290a 2020  in, x, y, z)).  
-00031720: 2020 2020 2020 7265 7475 726e 2043 6972        return Cir
-00031730: 636c 6532 4428 706c 616e 6533 642e 706f  cle2D(plane3d.po
-00031740: 696e 7433 645f 746f 5f32 6428 7365 6c66  int3d_to_2d(self
-00031750: 2e63 656e 7465 7229 2c20 7365 6c66 2e72  .center), self.r
-00031760: 6164 6975 7329 0a0a 2020 2020 4063 6c61  adius)..    @cla
-00031770: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
-00031780: 2066 726f 6d5f 6365 6e74 6572 5f6e 6f72   from_center_nor
-00031790: 6d61 6c28 636c 732c 2063 656e 7465 723a  mal(cls, center:
-000317a0: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3344   volmdlr.Point3D
-000317b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000317c0: 2020 2020 2020 2020 2020 2020 206e 6f72               nor
-000317d0: 6d61 6c3a 2076 6f6c 6d64 6c72 2e56 6563  mal: volmdlr.Vec
-000317e0: 746f 7233 442c 0a20 2020 2020 2020 2020  tor3D,.         
+0002e240: 2070 6f69 6e74 323a 2076 6f6c 6d64 6c72   point2: volmdlr
+0002e250: 2e50 6f69 6e74 3344 2c20 696e 7369 6465  .Point3D, inside
+0002e260: 3d46 616c 7365 293a 0a0a 2020 2020 2020  =False):..      
+0002e270: 2020 6e65 775f 7072 696d 6974 6976 6573    new_primitives
+0002e280: 203d 2063 6f6e 746f 7572 2e65 7874 7261   = contour.extra
+0002e290: 6374 5f77 6974 685f 706f 696e 7473 2870  ct_with_points(p
+0002e2a0: 6f69 6e74 312c 2070 6f69 6e74 322c 2069  oint1, point2, i
+0002e2b0: 6e73 6964 6529 0a20 2020 2020 2020 2063  nside).        c
+0002e2c0: 6f6e 746f 7572 7320 3d20 5b63 6c73 286e  ontours = [cls(n
+0002e2d0: 6577 5f70 7269 6d69 7469 7665 7329 5d0a  ew_primitives)].
+0002e2e0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+0002e2f0: 6f6e 746f 7572 730a 0a20 2020 2064 6566  ontours..    def
+0002e300: 206c 696e 655f 696e 7465 7273 6563 7469   line_intersecti
+0002e310: 6f6e 7328 7365 6c66 2c20 6c69 6e65 3a20  ons(self, line: 
+0002e320: 766f 6c6d 646c 722e 6564 6765 732e 4c69  volmdlr.edges.Li
+0002e330: 6e65 3344 293a 0a20 2020 2020 2020 2022  ne3D):.        "
+0002e340: 2222 0a20 2020 2020 2020 2043 616c 6375  "".        Calcu
+0002e350: 6c61 7465 7320 696e 7465 7273 6563 7469  lates intersecti
+0002e360: 6f6e 7320 6265 7477 6565 6e20 6120 636f  ons between a co
+0002e370: 6e74 6f75 7233 6420 616e 6420 4c69 6e65  ntour3d and Line
+0002e380: 3364 2e0a 0a20 2020 2020 2020 203a 7061  3d...        :pa
+0002e390: 7261 6d20 6c69 6e65 3a20 4c69 6e65 3344  ram line: Line3D
+0002e3a0: 2074 6f20 7665 7269 6679 2069 6e74 6572   to verify inter
+0002e3b0: 7365 6374 696f 6e73 2e0a 2020 2020 2020  sections..      
+0002e3c0: 2020 3a72 6574 7572 6e3a 206c 6973 7420    :return: list 
+0002e3d0: 7769 7468 2074 6865 2063 6f6e 746f 7572  with the contour
+0002e3e0: 2069 6e74 6572 7365 6374 696f 6e73 2077   intersections w
+0002e3f0: 6974 6820 6c69 6e65 0a20 2020 2020 2020  ith line.       
+0002e400: 2022 2222 0a20 2020 2020 2020 2069 6e74   """.        int
+0002e410: 6572 7365 6374 696f 6e73 203d 205b 5d0a  ersections = [].
+0002e420: 2020 2020 2020 2020 666f 7220 7072 696d          for prim
+0002e430: 6974 6976 6520 696e 2073 656c 662e 7072  itive in self.pr
+0002e440: 696d 6974 6976 6573 3a0a 2020 2020 2020  imitives:.      
+0002e450: 2020 2020 2020 7072 696d 5f6c 696e 655f        prim_line_
+0002e460: 696e 7465 7273 6563 7469 6f6e 7320 3d20  intersections = 
+0002e470: 7072 696d 6974 6976 652e 6c69 6e65 5f69  primitive.line_i
+0002e480: 6e74 6572 7365 6374 696f 6e73 286c 696e  ntersections(lin
+0002e490: 6529 0a20 2020 2020 2020 2020 2020 2069  e).            i
+0002e4a0: 6620 7072 696d 5f6c 696e 655f 696e 7465  f prim_line_inte
+0002e4b0: 7273 6563 7469 6f6e 733a 0a20 2020 2020  rsections:.     
+0002e4c0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0002e4d0: 6e74 6572 7320 696e 2070 7269 6d5f 6c69  nters in prim_li
+0002e4e0: 6e65 5f69 6e74 6572 7365 6374 696f 6e73  ne_intersections
+0002e4f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002e500: 2020 2020 2020 6966 2069 6e74 6572 7320        if inters 
+0002e510: 6e6f 7420 696e 2069 6e74 6572 7365 6374  not in intersect
+0002e520: 696f 6e73 3a0a 2020 2020 2020 2020 2020  ions:.          
+0002e530: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0002e540: 7465 7273 6563 7469 6f6e 732e 6170 7065  tersections.appe
+0002e550: 6e64 2869 6e74 6572 7329 0a20 2020 2020  nd(inters).     
+0002e560: 2020 2072 6574 7572 6e20 696e 7465 7273     return inters
+0002e570: 6563 7469 6f6e 730a 0a20 2020 2064 6566  ections..    def
+0002e580: 206c 696e 6573 6567 6d65 6e74 5f69 6e74   linesegment_int
+0002e590: 6572 7365 6374 696f 6e73 2873 656c 662c  ersections(self,
+0002e5a0: 206c 696e 6573 6567 6d65 6e74 3a20 766f   linesegment: vo
+0002e5b0: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
+0002e5c0: 5365 676d 656e 7433 4429 3a0a 2020 2020  Segment3D):.    
+0002e5d0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0002e5e0: 4361 6c63 756c 6174 6573 2069 6e74 6572  Calculates inter
+0002e5f0: 7365 6374 696f 6e73 2062 6574 7765 656e  sections between
+0002e600: 2061 2063 6f6e 746f 7572 2033 6420 616e   a contour 3d an
+0002e610: 6420 4c69 6e65 5365 676d 656e 7433 442e  d LineSegment3D.
+0002e620: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0002e630: 206c 696e 6573 6567 6d65 6e74 3a20 4c69   linesegment: Li
+0002e640: 6e65 5365 676d 656e 7433 4420 746f 2076  neSegment3D to v
+0002e650: 6572 6966 7920 696e 7465 7273 6563 7469  erify intersecti
+0002e660: 6f6e 732e 0a20 2020 2020 2020 203a 7265  ons..        :re
+0002e670: 7475 726e 3a20 6c69 7374 2077 6974 6820  turn: list with 
+0002e680: 7468 6520 636f 6e74 6f75 7220 696e 7465  the contour inte
+0002e690: 7273 6563 7469 6f6e 7320 7769 7468 206c  rsections with l
+0002e6a0: 696e 650a 2020 2020 2020 2020 2222 220a  ine.        """.
+0002e6b0: 2020 2020 2020 2020 696e 7465 7273 6563          intersec
+0002e6c0: 7469 6f6e 7320 3d20 5b5d 0a20 2020 2020  tions = [].     
+0002e6d0: 2020 2066 6f72 2070 7269 6d69 7469 7665     for primitive
+0002e6e0: 2069 6e20 7365 6c66 2e70 7269 6d69 7469   in self.primiti
+0002e6f0: 7665 733a 0a20 2020 2020 2020 2020 2020  ves:.           
+0002e700: 2070 7269 6d5f 6c69 6e65 5f69 6e74 6572   prim_line_inter
+0002e710: 7365 6374 696f 6e73 203d 2070 7269 6d69  sections = primi
+0002e720: 7469 7665 2e6c 696e 6573 6567 6d65 6e74  tive.linesegment
+0002e730: 5f69 6e74 6572 7365 6374 696f 6e73 286c  _intersections(l
+0002e740: 696e 6573 6567 6d65 6e74 290a 2020 2020  inesegment).    
+0002e750: 2020 2020 2020 2020 6966 2070 7269 6d5f          if prim_
+0002e760: 6c69 6e65 5f69 6e74 6572 7365 6374 696f  line_intersectio
+0002e770: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+0002e780: 2020 2020 666f 7220 696e 7465 7273 2069      for inters i
+0002e790: 6e20 7072 696d 5f6c 696e 655f 696e 7465  n prim_line_inte
+0002e7a0: 7273 6563 7469 6f6e 733a 0a20 2020 2020  rsections:.     
+0002e7b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002e7c0: 6620 696e 7465 7273 206e 6f74 2069 6e20  f inters not in 
+0002e7d0: 696e 7465 7273 6563 7469 6f6e 733a 0a20  intersections:. 
+0002e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e7f0: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
+0002e800: 696f 6e73 2e61 7070 656e 6428 696e 7465  ions.append(inte
+0002e810: 7273 290a 2020 2020 2020 2020 7265 7475  rs).        retu
+0002e820: 726e 2069 6e74 6572 7365 6374 696f 6e73  rn intersections
+0002e830: 0a0a 2020 2020 6465 6620 636f 6e74 6f75  ..    def contou
+0002e840: 725f 696e 7465 7273 6563 7469 6f6e 2873  r_intersection(s
+0002e850: 656c 662c 2063 6f6e 746f 7572 3364 293a  elf, contour3d):
+0002e860: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002e870: 2020 2020 2043 616c 6375 6c61 7465 7320       Calculates 
+0002e880: 696e 7465 7273 6563 7469 6f6e 7320 6265  intersections be
+0002e890: 7477 6565 6e20 7477 6f20 436f 6e74 6f75  tween two Contou
+0002e8a0: 7233 442e 0a0a 2020 2020 2020 2020 3a70  r3D...        :p
+0002e8b0: 6172 616d 2063 6f6e 746f 7572 3364 3a20  aram contour3d: 
+0002e8c0: 7365 636f 6e64 2063 6f6e 746f 7572 0a20  second contour. 
+0002e8d0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+0002e8e0: 6c69 7374 206f 6620 706f 696e 7473 0a20  list of points. 
+0002e8f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0002e900: 2020 2064 6963 745f 696e 7465 7273 6563     dict_intersec
+0002e910: 7469 6e67 5f70 6f69 6e74 7320 3d20 7b7d  ting_points = {}
+0002e920: 0a20 2020 2020 2020 2066 6f72 2070 7269  .        for pri
+0002e930: 6d69 7469 7665 2069 6e20 7365 6c66 2e70  mitive in self.p
+0002e940: 7269 6d69 7469 7665 733a 0a20 2020 2020  rimitives:.     
+0002e950: 2020 2020 2020 2066 6f72 2070 7269 6d69         for primi
+0002e960: 7469 7665 3220 696e 2063 6f6e 746f 7572  tive2 in contour
+0002e970: 3364 2e70 7269 6d69 7469 7665 733a 0a20  3d.primitives:. 
+0002e980: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002e990: 6e74 6572 7365 6374 696e 675f 706f 696e  ntersecting_poin
+0002e9a0: 7420 3d20 7072 696d 6974 6976 652e 6c69  t = primitive.li
+0002e9b0: 6e65 7365 676d 656e 745f 696e 7465 7273  nesegment_inters
+0002e9c0: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
+0002e9d0: 2020 2020 2020 2020 2020 2020 7072 696d              prim
+0002e9e0: 6974 6976 6532 290a 2020 2020 2020 2020  itive2).        
+0002e9f0: 2020 2020 2020 2020 6966 2069 6e74 6572          if inter
+0002ea00: 7365 6374 696e 675f 706f 696e 7420 6973  secting_point is
+0002ea10: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0002ea20: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0002ea30: 6963 745f 696e 7465 7273 6563 7469 6e67  ict_intersecting
+0002ea40: 5f70 6f69 6e74 735b 7072 696d 6974 6976  _points[primitiv
+0002ea50: 6532 5d20 3d20 696e 7465 7273 6563 7469  e2] = intersecti
+0002ea60: 6e67 5f70 6f69 6e74 0a20 2020 2020 2020  ng_point.       
+0002ea70: 2069 6620 6469 6374 5f69 6e74 6572 7365   if dict_interse
+0002ea80: 6374 696e 675f 706f 696e 7473 3a0a 2020  cting_points:.  
+0002ea90: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0002eaa0: 2064 6963 745f 696e 7465 7273 6563 7469   dict_intersecti
+0002eab0: 6e67 5f70 6f69 6e74 730a 2020 2020 2020  ng_points.      
+0002eac0: 2020 7265 7475 726e 204e 6f6e 650a 0a20    return None.. 
+0002ead0: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
+0002eae0: 2020 2020 6465 6620 6672 6f6d 5f70 6f69      def from_poi
+0002eaf0: 6e74 7328 636c 732c 2070 6f69 6e74 733a  nts(cls, points:
+0002eb00: 204c 6973 745b 766f 6c6d 646c 722e 506f   List[volmdlr.Po
+0002eb10: 696e 7433 445d 293a 0a20 2020 2020 2020  int3D]):.       
+0002eb20: 2022 2222 0a20 2020 2020 2020 2043 7265   """.        Cre
+0002eb30: 6174 6520 6120 636f 6e74 6f75 7233 6420  ate a contour3d 
+0002eb40: 6672 6f6d 2070 6f69 6e74 7320 7769 7468  from points with
+0002eb50: 206c 696e 655f 7365 676d 656e 7473 3344   line_segments3D
+0002eb60: 2e0a 0a20 2020 2020 2020 2022 2222 0a0a  ...        """..
+0002eb70: 2020 2020 2020 2020 6966 206c 656e 2870          if len(p
+0002eb80: 6f69 6e74 7329 203c 2033 3a0a 2020 2020  oints) < 3:.    
+0002eb90: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0002eba0: 6c75 6545 7272 6f72 2827 636f 6e74 6f75  lueError('contou
+0002ebb0: 7220 6973 2064 6566 696e 6564 2061 7420  r is defined at 
+0002ebc0: 6c65 6173 7420 7769 7468 2074 6872 6565  least with three
+0002ebd0: 2070 6f69 6e74 7327 290a 2020 2020 2020   points').      
+0002ebe0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0002ebf0: 2020 2020 6564 6765 7320 3d20 5b5d 0a20      edges = []. 
+0002ec00: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0002ec10: 2069 6e20 7261 6e67 6528 302c 206c 656e   in range(0, len
+0002ec20: 2870 6f69 6e74 7329 202d 2031 293a 0a20  (points) - 1):. 
+0002ec30: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002ec40: 6467 6573 2e61 7070 656e 6428 766f 6c6d  dges.append(volm
+0002ec50: 646c 722e 6564 6765 732e 4c69 6e65 5365  dlr.edges.LineSe
+0002ec60: 676d 656e 7433 4428 706f 696e 7473 5b69  gment3D(points[i
+0002ec70: 5d2c 2070 6f69 6e74 735b 6920 2b20 315d  ], points[i + 1]
+0002ec80: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
+0002ec90: 6564 6765 732e 6170 7065 6e64 2876 6f6c  edges.append(vol
+0002eca0: 6d64 6c72 2e65 6467 6573 2e4c 696e 6553  mdlr.edges.LineS
+0002ecb0: 6567 6d65 6e74 3344 2870 6f69 6e74 735b  egment3D(points[
+0002ecc0: 2d31 5d2c 2070 6f69 6e74 735b 305d 2929  -1], points[0]))
+0002ecd0: 0a0a 2020 2020 2020 2020 2020 2020 636f  ..            co
+0002ece0: 6e74 6f75 7220 3d20 636c 7328 6564 6765  ntour = cls(edge
+0002ecf0: 7329 0a0a 2020 2020 2020 2020 2020 2020  s)..            
+0002ed00: 7265 7475 726e 2063 6f6e 746f 7572 0a0a  return contour..
+0002ed10: 2020 2020 6465 6620 636c 6561 6e5f 7072      def clean_pr
+0002ed20: 696d 6974 6976 6573 2873 656c 6629 3a0a  imitives(self):.
+0002ed30: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002ed40: 2020 2020 4465 6c65 7465 2070 7269 6d69      Delete primi
+0002ed50: 7469 7665 7320 7769 7468 2073 7461 7274  tives with start
+0002ed60: 3d65 6e64 2c20 616e 6420 7265 7475 726e  =end, and return
+0002ed70: 2061 206e 6577 2063 6f6e 746f 7572 2e0a   a new contour..
+0002ed80: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+0002ed90: 2020 2020 2020 6e65 775f 7072 696d 6974        new_primit
+0002eda0: 6976 6573 203d 205b 5d0a 2020 2020 2020  ives = [].      
+0002edb0: 2020 666f 7220 7072 696d 6974 6976 6520    for primitive 
+0002edc0: 696e 2073 656c 662e 7072 696d 6974 6976  in self.primitiv
+0002edd0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+0002ede0: 6966 2070 7269 6d69 7469 7665 2e73 7461  if primitive.sta
+0002edf0: 7274 2021 3d20 7072 696d 6974 6976 652e  rt != primitive.
+0002ee00: 656e 643a 0a20 2020 2020 2020 2020 2020  end:.           
+0002ee10: 2020 2020 206e 6577 5f70 7269 6d69 7469       new_primiti
+0002ee20: 7665 732e 6170 7065 6e64 2870 7269 6d69  ves.append(primi
+0002ee30: 7469 7665 290a 0a20 2020 2020 2020 2072  tive)..        r
+0002ee40: 6574 7572 6e20 436f 6e74 6f75 7233 4428  eturn Contour3D(
+0002ee50: 6e65 775f 7072 696d 6974 6976 6573 290a  new_primitives).
+0002ee60: 0a20 2020 2064 6566 206d 6572 6765 5f77  .    def merge_w
+0002ee70: 6974 6828 7365 6c66 2c20 636f 6e74 6f75  ith(self, contou
+0002ee80: 7233 6429 3a0a 2020 2020 2020 2020 2222  r3d):.        ""
+0002ee90: 220a 2020 2020 2020 2020 4d65 7267 6520  ".        Merge 
+0002eea0: 7477 6f20 6164 6a61 6365 6e74 2063 6f6e  two adjacent con
+0002eeb0: 746f 7572 732c 2073 6861 7269 6e67 2070  tours, sharing p
+0002eec0: 7269 6d69 7469 7665 732c 2061 6e64 2072  rimitives, and r
+0002eed0: 6574 7572 6e73 206f 6e65 206f 7574 6572  eturns one outer
+0002eee0: 2063 6f6e 746f 7572 2061 6e64 2069 6e6e   contour and inn
+0002eef0: 6572 0a20 2020 2020 2020 2063 6f6e 746f  er.        conto
+0002ef00: 7572 7320 2869 6620 7468 6572 6520 6172  urs (if there ar
+0002ef10: 6520 616e 7929 2c0a 0a20 2020 2020 2020  e any),..       
+0002ef20: 2022 2222 0a0a 2020 2020 2020 2020 6d65   """..        me
+0002ef30: 7267 6564 5f70 7269 6d69 7469 7665 7320  rged_primitives 
+0002ef40: 3d20 7365 6c66 2e6d 6572 6765 5f70 7269  = self.merge_pri
+0002ef50: 6d69 7469 7665 735f 7769 7468 2863 6f6e  mitives_with(con
+0002ef60: 746f 7572 3364 290a 2020 2020 2020 2020  tour3d).        
+0002ef70: 636f 6e74 6f75 7273 203d 2043 6f6e 746f  contours = Conto
+0002ef80: 7572 3344 2e63 6f6e 746f 7572 735f 6672  ur3D.contours_fr
+0002ef90: 6f6d 5f65 6467 6573 286d 6572 6765 645f  om_edges(merged_
+0002efa0: 7072 696d 6974 6976 6573 2c20 746f 6c3d  primitives, tol=
+0002efb0: 3365 2d34 290a 0a20 2020 2020 2020 2072  3e-4)..        r
+0002efc0: 6574 7572 6e20 636f 6e74 6f75 7273 0a0a  eturn contours..
+0002efd0: 0a63 6c61 7373 2043 6972 636c 6533 4428  .class Circle3D(
+0002efe0: 436f 6e74 6f75 7233 4429 3a0a 2020 2020  Contour3D):.    
+0002eff0: 2222 220a 2020 2020 4465 6669 6e65 7320  """.    Defines 
+0002f000: 6120 4369 7263 6c65 2069 6e20 7468 7265  a Circle in thre
+0002f010: 6520 6469 6d65 6e73 696f 6e73 2c20 7769  e dimensions, wi
+0002f020: 7468 2061 2063 656e 7465 7220 616e 6420  th a center and 
+0002f030: 6120 7261 6469 7573 2e0a 0a20 2020 2066  a radius...    f
+0002f040: 7261 6d65 2e75 2c20 6672 616d 652e 7620  rame.u, frame.v 
+0002f050: 6465 6669 6e65 2074 6865 2070 6c61 6e65  define the plane
+0002f060: 2c20 6672 616d 652e 7720 7468 6520 6e6f  , frame.w the no
+0002f070: 726d 616c 0a20 2020 2022 2222 0a20 2020  rmal.    """.   
+0002f080: 205f 6e6f 6e5f 7365 7269 616c 697a 6162   _non_serializab
+0002f090: 6c65 5f61 7474 7269 6275 7465 7320 3d20  le_attributes = 
+0002f0a0: 5b27 706f 696e 7427 2c20 2765 6467 6573  ['point', 'edges
+0002f0b0: 272c 2027 706f 696e 745f 696e 7369 6465  ', 'point_inside
+0002f0c0: 5f63 6f6e 746f 7572 275d 0a20 2020 205f  _contour'].    _
+0002f0d0: 6e6f 6e5f 6571 5f61 7474 7269 6275 7465  non_eq_attribute
+0002f0e0: 7320 3d20 5b27 6e61 6d65 275d 0a20 2020  s = ['name'].   
+0002f0f0: 205f 6e6f 6e5f 6861 7368 5f61 7474 7269   _non_hash_attri
+0002f100: 6275 7465 7320 3d20 5b27 6e61 6d65 275d  butes = ['name']
+0002f110: 0a20 2020 205f 6765 6e65 7269 635f 6571  .    _generic_eq
+0002f120: 203d 2054 7275 650a 0a20 2020 2064 6566   = True..    def
+0002f130: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+0002f140: 6672 616d 653a 2076 6f6c 6d64 6c72 2e46  frame: volmdlr.F
+0002f150: 7261 6d65 3344 2c20 7261 6469 7573 3a20  rame3D, radius: 
+0002f160: 666c 6f61 742c 0a20 2020 2020 2020 2020  float,.         
+0002f170: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+0002f180: 7220 3d20 2727 293a 0a20 2020 2020 2020  r = ''):.       
+0002f190: 2073 656c 662e 7261 6469 7573 203d 2072   self.radius = r
+0002f1a0: 6164 6975 730a 2020 2020 2020 2020 7365  adius.        se
+0002f1b0: 6c66 2e66 7261 6d65 203d 2066 7261 6d65  lf.frame = frame
+0002f1c0: 0a20 2020 2020 2020 2073 656c 662e 616e  .        self.an
+0002f1d0: 676c 6520 3d20 766f 6c6d 646c 722e 5457  gle = volmdlr.TW
+0002f1e0: 4f5f 5049 0a20 2020 2020 2020 2073 656c  O_PI.        sel
+0002f1f0: 662e 5f70 7269 6d69 7469 7665 7320 3d20  f._primitives = 
+0002f200: 4e6f 6e65 0a20 2020 2020 2020 2073 656c  None.        sel
+0002f210: 662e 7072 696d 6974 6976 6573 203d 2073  f.primitives = s
+0002f220: 656c 662e 6765 745f 7072 696d 6974 6976  elf.get_primitiv
+0002f230: 6573 2829 0a20 2020 2020 2020 2043 6f6e  es().        Con
+0002f240: 746f 7572 3344 2e5f 5f69 6e69 745f 5f28  tour3D.__init__(
+0002f250: 7365 6c66 2c20 7365 6c66 2e70 7269 6d69  self, self.primi
+0002f260: 7469 7665 732c 206e 616d 653d 6e61 6d65  tives, name=name
+0002f270: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+0002f280: 0a20 2020 2064 6566 2063 656e 7465 7228  .    def center(
+0002f290: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+0002f2a0: 6574 7572 6e20 7365 6c66 2e66 7261 6d65  eturn self.frame
+0002f2b0: 2e6f 7269 6769 6e0a 0a20 2020 2040 7072  .origin..    @pr
+0002f2c0: 6f70 6572 7479 0a20 2020 2064 6566 206e  operty.    def n
+0002f2d0: 6f72 6d61 6c28 7365 6c66 293a 0a20 2020  ormal(self):.   
+0002f2e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0002f2f0: 2e66 7261 6d65 2e77 0a0a 2020 2020 6465  .frame.w..    de
+0002f300: 6620 5f5f 6861 7368 5f5f 2873 656c 6629  f __hash__(self)
+0002f310: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0002f320: 2068 6173 6828 7365 6c66 2e66 7261 6d65   hash(self.frame
+0002f330: 2e6f 7269 6769 6e29 0a0a 2020 2020 6465  .origin)..    de
+0002f340: 6620 5f5f 6571 5f5f 2873 656c 662c 206f  f __eq__(self, o
+0002f350: 7468 6572 5f63 6972 636c 6529 3a0a 2020  ther_circle):.  
+0002f360: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0002f370: 662e 6672 616d 652e 6f72 6967 696e 203d  f.frame.origin =
+0002f380: 3d20 6f74 6865 725f 6369 7263 6c65 2e66  = other_circle.f
+0002f390: 7261 6d65 2e6f 7269 6769 6e20 5c0a 2020  rame.origin \.  
+0002f3a0: 2020 2020 2020 2020 2020 2020 2061 6e64               and
+0002f3b0: 2073 656c 662e 6672 616d 652e 772e 6973   self.frame.w.is
+0002f3c0: 5f63 6f6c 696e 6561 7228 6f74 6865 725f  _colinear(other_
+0002f3d0: 6369 7263 6c65 2e66 7261 6d65 2e77 2920  circle.frame.w) 
+0002f3e0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+0002f3f0: 2061 6e64 206d 6174 682e 6973 636c 6f73   and math.isclos
+0002f400: 6528 7365 6c66 2e72 6164 6975 732c 0a20  e(self.radius,. 
+0002f410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f420: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0002f430: 7468 6572 5f63 6972 636c 652e 7261 6469  ther_circle.radi
+0002f440: 7573 2c20 6162 735f 746f 6c3d 3165 2d30  us, abs_tol=1e-0
+0002f450: 3629 0a0a 2020 2020 6465 6620 6765 745f  6)..    def get_
+0002f460: 7072 696d 6974 6976 6573 2873 656c 6629  primitives(self)
+0002f470: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0002f480: 2020 2020 2020 4361 6c63 756c 6174 6573        Calculates
+0002f490: 2070 7269 6d69 7469 7665 7320 746f 2063   primitives to c
+0002f4a0: 6f6d 706f 7365 2043 6972 636c 653a 2032  ompose Circle: 2
+0002f4b0: 2041 7263 3344 2e0a 0a20 2020 2020 2020   Arc3D...       
+0002f4c0: 203a 7265 7475 726e 3a20 6c69 7374 2063   :return: list c
+0002f4d0: 6f6e 7461 696e 696e 6720 7477 6f20 4172  ontaining two Ar
+0002f4e0: 6333 440a 2020 2020 2020 2020 2222 220a  c3D.        """.
+0002f4f0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+0002f500: 656c 662e 5f70 7269 6d69 7469 7665 733a  elf._primitives:
+0002f510: 0a20 2020 2020 2020 2020 2020 2070 6f69  .            poi
+0002f520: 6e74 7320 3d20 5b73 656c 662e 6365 6e74  nts = [self.cent
+0002f530: 6572 202b 2073 656c 662e 6672 616d 652e  er + self.frame.
+0002f540: 7520 2a20 7365 6c66 2e72 6164 6975 732c  u * self.radius,
+0002f550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f560: 2020 2020 2020 2073 656c 662e 6365 6e74         self.cent
+0002f570: 6572 202d 2073 656c 662e 6672 616d 652e  er - self.frame.
+0002f580: 7620 2a20 7365 6c66 2e72 6164 6975 732c  v * self.radius,
+0002f590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f5a0: 2020 2020 2020 2073 656c 662e 6365 6e74         self.cent
+0002f5b0: 6572 202d 2073 656c 662e 6672 616d 652e  er - self.frame.
+0002f5c0: 7520 2a20 7365 6c66 2e72 6164 6975 732c  u * self.radius,
+0002f5d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f5e0: 2020 2020 2020 2073 656c 662e 6365 6e74         self.cent
+0002f5f0: 6572 202b 2073 656c 662e 6672 616d 652e  er + self.frame.
+0002f600: 7620 2a20 7365 6c66 2e72 6164 6975 735d  v * self.radius]
+0002f610: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002f620: 662e 5f70 7269 6d69 7469 7665 7320 3d20  f._primitives = 
+0002f630: 5b76 6f6c 6d64 6c72 2e65 6467 6573 2e41  [volmdlr.edges.A
+0002f640: 7263 3344 2870 6f69 6e74 735b 305d 2c20  rc3D(points[0], 
+0002f650: 706f 696e 7473 5b31 5d2c 2070 6f69 6e74  points[1], point
+0002f660: 735b 325d 292c 0a20 2020 2020 2020 2020  s[2]),.         
+0002f670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f680: 2020 2020 2020 2076 6f6c 6d64 6c72 2e65         volmdlr.e
+0002f690: 6467 6573 2e41 7263 3344 2870 6f69 6e74  dges.Arc3D(point
+0002f6a0: 735b 325d 2c20 706f 696e 7473 5b33 5d2c  s[2], points[3],
+0002f6b0: 2070 6f69 6e74 735b 305d 295d 0a0a 2020   points[0])]..  
+0002f6c0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0002f6d0: 662e 5f70 7269 6d69 7469 7665 730a 0a20  f._primitives.. 
+0002f6e0: 2020 2064 6566 2064 6973 6372 6574 697a     def discretiz
+0002f6f0: 6174 696f 6e5f 706f 696e 7473 2873 656c  ation_points(sel
+0002f700: 662c 202a 2c20 6e75 6d62 6572 5f70 6f69  f, *, number_poi
+0002f710: 6e74 733a 2069 6e74 203d 204e 6f6e 652c  nts: int = None,
+0002f720: 2061 6e67 6c65 5f72 6573 6f6c 7574 696f   angle_resolutio
+0002f730: 6e3a 2069 6e74 203d 2032 3029 3a0a 2020  n: int = 20):.  
+0002f740: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0002f750: 2020 4469 7363 7265 7469 7a65 2061 2043    Discretize a C
+0002f760: 6972 636c 6520 746f 2068 6176 6520 226e  ircle to have "n
+0002f770: 2220 706f 696e 7473 2e0a 0a20 2020 2020  " points...     
+0002f780: 2020 203a 7061 7261 6d20 6e75 6d62 6572     :param number
+0002f790: 5f70 6f69 6e74 733a 2074 6865 206e 756d  _points: the num
+0002f7a0: 6265 7220 6f66 2070 6f69 6e74 7320 2869  ber of points (i
+0002f7b0: 6e63 6c75 6469 6e67 2073 7461 7274 2061  ncluding start a
+0002f7c0: 6e64 2065 6e64 2070 6f69 6e74 7329 0a20  nd end points). 
+0002f7d0: 2020 2020 2020 2020 2020 2020 6966 2075              if u
+0002f7e0: 6e73 6574 2c20 6f6e 6c79 2073 7461 7274  nset, only start
+0002f7f0: 2061 6e64 2065 6e64 2077 696c 6c20 6265   and end will be
+0002f800: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
+0002f810: 2020 3a70 6172 616d 2061 6e67 6c65 5f72    :param angle_r
+0002f820: 6573 6f6c 7574 696f 6e3a 2069 6620 7365  esolution: if se
+0002f830: 742c 2074 6865 2073 616d 706c 696e 6720  t, the sampling 
+0002f840: 7769 6c6c 2062 6520 6164 6170 7465 6420  will be adapted 
+0002f850: 746f 2068 6176 6520 6120 636f 6e74 726f  to have a contro
+0002f860: 6c6c 6564 2061 6e67 756c 6172 2064 6973  lled angular dis
+0002f870: 7461 6e63 652e 2055 7365 6675 6c0a 2020  tance. Useful.  
+0002f880: 2020 2020 2020 2020 2020 746f 206d 6573            to mes
+0002f890: 6820 616e 2061 7263 0a20 2020 2020 2020  h an arc.       
+0002f8a0: 203a 7265 7475 726e 3a20 6120 6c69 7374   :return: a list
+0002f8b0: 206f 6620 7361 6d70 6c65 6420 706f 696e   of sampled poin
+0002f8c0: 7473 0a20 2020 2020 2020 2022 2222 0a20  ts.        """. 
+0002f8d0: 2020 2020 2020 2069 6620 6e75 6d62 6572         if number
+0002f8e0: 5f70 6f69 6e74 733a 0a20 2020 2020 2020  _points:.       
+0002f8f0: 2020 2020 2061 6e67 6c65 5f72 6573 6f6c       angle_resol
+0002f900: 7574 696f 6e20 3d20 6e75 6d62 6572 5f70  ution = number_p
+0002f910: 6f69 6e74 730a 2020 2020 2020 2020 6469  oints.        di
+0002f920: 7363 7265 7469 7a61 7469 6f6e 5f70 6f69  scretization_poi
+0002f930: 6e74 735f 3364 203d 205b 7365 6c66 2e63  nts_3d = [self.c
+0002f940: 656e 7465 7220 2b20 7365 6c66 2e72 6164  enter + self.rad
+0002f950: 6975 7320 2a20 6d61 7468 2e63 6f73 2874  ius * math.cos(t
+0002f960: 6574 6129 202a 2073 656c 662e 6672 616d  eta) * self.fram
+0002f970: 652e 7520 2b0a 2020 2020 2020 2020 2020  e.u +.          
+0002f980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f990: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
+0002f9a0: 6164 6975 7320 2a20 6d61 7468 2e73 696e  adius * math.sin
+0002f9b0: 2874 6574 6129 202a 2073 656c 662e 6672  (teta) * self.fr
+0002f9c0: 616d 652e 7620 666f 7220 7465 7461 2069  ame.v for teta i
+0002f9d0: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+0002f9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f9f0: 2020 2020 2020 6e70 792e 6c69 6e73 7061        npy.linspa
+0002fa00: 6365 2830 2c20 766f 6c6d 646c 722e 5457  ce(0, volmdlr.TW
+0002fa10: 4f5f 5049 2c20 616e 676c 655f 7265 736f  O_PI, angle_reso
+0002fa20: 6c75 7469 6f6e 202b 2031 295d 5b3a 2d31  lution + 1)][:-1
+0002fa30: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
+0002fa40: 2064 6973 6372 6574 697a 6174 696f 6e5f   discretization_
+0002fa50: 706f 696e 7473 5f33 640a 0a20 2020 2064  points_3d..    d
+0002fa60: 6566 2061 6273 6369 7373 6128 7365 6c66  ef abscissa(self
+0002fa70: 2c20 706f 696e 743a 2076 6f6c 6d64 6c72  , point: volmdlr
+0002fa80: 2e50 6f69 6e74 3344 293a 0a20 2020 2020  .Point3D):.     
+0002fa90: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+0002faa0: 616c 6375 6c61 7465 7320 7468 6520 6162  alculates the ab
+0002fab0: 7363 6973 7361 2061 2067 6976 656e 2070  scissa a given p
+0002fac0: 6f69 6e74 2e0a 0a20 2020 2020 2020 203a  oint...        :
+0002fad0: 7061 7261 6d20 706f 696e 743a 2070 6f69  param point: poi
+0002fae0: 6e74 2074 6f20 6361 6c63 756c 6174 6520  nt to calculate 
+0002faf0: 6162 7363 6973 7361 2e0a 2020 2020 2020  abscissa..      
+0002fb00: 2020 3a72 6574 7572 6e3a 2061 6273 6369    :return: absci
+0002fb10: 7373 610a 2020 2020 2020 2020 2222 220a  ssa.        """.
+0002fb20: 2020 2020 2020 2020 782c 2079 2c20 5f20          x, y, _ 
+0002fb30: 3d20 7365 6c66 2e66 7261 6d65 2e67 6c6f  = self.frame.glo
+0002fb40: 6261 6c5f 746f 5f6c 6f63 616c 5f63 6f6f  bal_to_local_coo
+0002fb50: 7264 696e 6174 6573 2870 6f69 6e74 290a  rdinates(point).
+0002fb60: 2020 2020 2020 2020 7531 203d 2078 202f          u1 = x /
+0002fb70: 2073 656c 662e 7261 6469 7573 0a20 2020   self.radius.   
+0002fb80: 2020 2020 2075 3220 3d20 7920 2f20 7365       u2 = y / se
+0002fb90: 6c66 2e72 6164 6975 730a 2020 2020 2020  lf.radius.      
+0002fba0: 2020 7468 6574 6120 3d20 766f 6c6d 646c    theta = volmdl
+0002fbb0: 722e 6765 6f6d 6574 7279 2e73 696e 5f63  r.geometry.sin_c
+0002fbc0: 6f73 5f61 6e67 6c65 2875 312c 2075 3229  os_angle(u1, u2)
+0002fbd0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0002fbe0: 2073 656c 662e 7261 6469 7573 202a 2061   self.radius * a
+0002fbf0: 6273 2874 6865 7461 290a 0a20 2020 2064  bs(theta)..    d
+0002fc00: 6566 206c 656e 6774 6828 7365 6c66 293a  ef length(self):
+0002fc10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002fc20: 766f 6c6d 646c 722e 5457 4f5f 5049 202a  volmdlr.TWO_PI *
+0002fc30: 2073 656c 662e 7261 6469 7573 0a0a 2020   self.radius..  
+0002fc40: 2020 6465 6620 726f 7461 7469 6f6e 2873    def rotation(s
+0002fc50: 656c 662c 2063 656e 7465 723a 2076 6f6c  elf, center: vol
+0002fc60: 6d64 6c72 2e50 6f69 6e74 3344 2c20 6178  mdlr.Point3D, ax
+0002fc70: 6973 3a20 766f 6c6d 646c 722e 5665 6374  is: volmdlr.Vect
+0002fc80: 6f72 3344 2c20 616e 676c 653a 2066 6c6f  or3D, angle: flo
+0002fc90: 6174 293a 0a20 2020 2020 2020 2022 2222  at):.        """
+0002fca0: 0a20 2020 2020 2020 2043 6972 636c 6533  .        Circle3
+0002fcb0: 4420 726f 7461 7469 6f6e 2e0a 0a20 2020  D rotation...   
+0002fcc0: 2020 2020 203a 7061 7261 6d20 6365 6e74       :param cent
+0002fcd0: 6572 3a20 726f 7461 7469 6f6e 2063 656e  er: rotation cen
+0002fce0: 7465 720a 2020 2020 2020 2020 3a70 6172  ter.        :par
+0002fcf0: 616d 2061 7869 733a 2072 6f74 6174 696f  am axis: rotatio
+0002fd00: 6e20 6178 6973 0a20 2020 2020 2020 203a  n axis.        :
+0002fd10: 7061 7261 6d20 616e 676c 653a 2061 6e67  param angle: ang
+0002fd20: 6c65 2072 6f74 6174 696f 6e0a 2020 2020  le rotation.    
+0002fd30: 2020 2020 3a72 6574 7572 6e3a 2061 206e      :return: a n
+0002fd40: 6577 2072 6f74 6174 6564 2043 6972 636c  ew rotated Circl
+0002fd50: 6533 440a 2020 2020 2020 2020 2222 220a  e3D.        """.
+0002fd60: 2020 2020 2020 2020 7265 7475 726e 2043          return C
+0002fd70: 6972 636c 6533 4428 7365 6c66 2e66 7261  ircle3D(self.fra
+0002fd80: 6d65 2e72 6f74 6174 696f 6e28 6365 6e74  me.rotation(cent
+0002fd90: 6572 2c20 6178 6973 2c20 616e 676c 6529  er, axis, angle)
+0002fda0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002fdb0: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
+0002fdc0: 6164 6975 732c 2073 656c 662e 6e61 6d65  adius, self.name
+0002fdd0: 290a 0a20 2020 2064 6566 2072 6f74 6174  )..    def rotat
+0002fde0: 696f 6e5f 696e 706c 6163 6528 7365 6c66  ion_inplace(self
+0002fdf0: 2c20 6365 6e74 6572 3a20 766f 6c6d 646c  , center: volmdl
+0002fe00: 722e 506f 696e 7433 442c 2061 7869 733a  r.Point3D, axis:
+0002fe10: 2076 6f6c 6d64 6c72 2e56 6563 746f 7233   volmdlr.Vector3
+0002fe20: 442c 2061 6e67 6c65 3a20 666c 6f61 7429  D, angle: float)
+0002fe30: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0002fe40: 2020 2020 2020 4369 7263 6c65 3344 2072        Circle3D r
+0002fe50: 6f74 6174 696f 6e2e 204f 626a 6563 7420  otation. Object 
+0002fe60: 6973 2075 7064 6174 6564 2069 6e70 6c61  is updated inpla
+0002fe70: 6365 2e0a 0a20 2020 2020 2020 203a 7061  ce...        :pa
+0002fe80: 7261 6d20 6365 6e74 6572 3a20 726f 7461  ram center: rota
+0002fe90: 7469 6f6e 2063 656e 7465 720a 2020 2020  tion center.    
+0002fea0: 2020 2020 3a70 6172 616d 2061 7869 733a      :param axis:
+0002feb0: 2072 6f74 6174 696f 6e20 6178 6973 0a20   rotation axis. 
+0002fec0: 2020 2020 2020 203a 7061 7261 6d20 616e         :param an
+0002fed0: 676c 653a 2072 6f74 6174 696f 6e20 616e  gle: rotation an
+0002fee0: 676c 650a 2020 2020 2020 2020 2222 220a  gle.        """.
+0002fef0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+0002ff00: 2e77 6172 6e28 2227 696e 706c 6163 6527  .warn("'inplace'
+0002ff10: 206d 6574 686f 6473 2061 7265 2064 6570   methods are dep
+0002ff20: 7265 6361 7465 642e 2055 7365 2061 206e  recated. Use a n
+0002ff30: 6f74 2069 6e70 6c61 6365 206d 6574 686f  ot inplace metho
+0002ff40: 6420 696e 7374 6561 642e 222c 2044 6570  d instead.", Dep
+0002ff50: 7265 6361 7469 6f6e 5761 726e 696e 6729  recationWarning)
+0002ff60: 0a0a 2020 2020 2020 2020 7365 6c66 2e66  ..        self.f
+0002ff70: 7261 6d65 2e72 6f74 6174 696f 6e5f 696e  rame.rotation_in
+0002ff80: 706c 6163 6528 6365 6e74 6572 2c20 6178  place(center, ax
+0002ff90: 6973 2c20 616e 676c 6529 0a0a 2020 2020  is, angle)..    
+0002ffa0: 6465 6620 7472 616e 736c 6174 696f 6e28  def translation(
+0002ffb0: 7365 6c66 2c20 6f66 6673 6574 3a20 766f  self, offset: vo
+0002ffc0: 6c6d 646c 722e 5665 6374 6f72 3344 293a  lmdlr.Vector3D):
+0002ffd0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0002ffe0: 2020 2020 2043 6972 636c 6533 4420 7472       Circle3D tr
+0002fff0: 616e 736c 6174 696f 6e2e 0a0a 2020 2020  anslation...    
+00030000: 2020 2020 3a70 6172 616d 206f 6666 7365      :param offse
+00030010: 743a 2074 7261 6e73 6c61 7469 6f6e 2076  t: translation v
+00030020: 6563 746f 720a 2020 2020 2020 2020 3a72  ector.        :r
+00030030: 6574 7572 6e3a 2041 206e 6577 2074 7261  eturn: A new tra
+00030040: 6e73 6c61 7465 6420 4369 7263 6c65 3344  nslated Circle3D
+00030050: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00030060: 2020 2020 2072 6574 7572 6e20 4369 7263       return Circ
+00030070: 6c65 3344 2873 656c 662e 6672 616d 652e  le3D(self.frame.
+00030080: 7472 616e 736c 6174 696f 6e28 6f66 6673  translation(offs
+00030090: 6574 292c 2073 656c 662e 7261 6469 7573  et), self.radius
+000300a0: 2c20 7365 6c66 2e6e 616d 6529 0a0a 2020  , self.name)..  
+000300b0: 2020 6465 6620 7472 616e 736c 6174 696f    def translatio
+000300c0: 6e5f 696e 706c 6163 6528 7365 6c66 2c20  n_inplace(self, 
+000300d0: 6f66 6673 6574 3a20 766f 6c6d 646c 722e  offset: volmdlr.
+000300e0: 5665 6374 6f72 3344 293a 0a20 2020 2020  Vector3D):.     
+000300f0: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+00030100: 6972 636c 6533 4420 7472 616e 736c 6174  ircle3D translat
+00030110: 696f 6e2e 204f 626a 6563 7420 6973 2075  ion. Object is u
+00030120: 7064 6174 6564 2069 6e70 6c61 6365 2e0a  pdated inplace..
+00030130: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00030140: 6f66 6673 6574 3a20 7472 616e 736c 6174  offset: translat
+00030150: 696f 6e20 7665 6374 6f72 0a20 2020 2020  ion vector.     
+00030160: 2020 2022 2222 0a20 2020 2020 2020 2077     """.        w
+00030170: 6172 6e69 6e67 732e 7761 726e 2822 2769  arnings.warn("'i
+00030180: 6e70 6c61 6365 2720 6d65 7468 6f64 7320  nplace' methods 
+00030190: 6172 6520 6465 7072 6563 6174 6564 2e20  are deprecated. 
+000301a0: 5573 6520 6120 6e6f 7420 696e 706c 6163  Use a not inplac
+000301b0: 6520 6d65 7468 6f64 2069 6e73 7465 6164  e method instead
+000301c0: 2e22 2c20 4465 7072 6563 6174 696f 6e57  .", DeprecationW
+000301d0: 6172 6e69 6e67 290a 0a20 2020 2020 2020  arning)..       
+000301e0: 2073 656c 662e 6672 616d 652e 7472 616e   self.frame.tran
+000301f0: 736c 6174 696f 6e5f 696e 706c 6163 6528  slation_inplace(
+00030200: 6f66 6673 6574 290a 0a20 2020 2064 6566  offset)..    def
+00030210: 2070 6c6f 7428 7365 6c66 2c20 6178 3d4e   plot(self, ax=N
+00030220: 6f6e 652c 2063 6f6c 6f72 3d27 6b27 2c20  one, color='k', 
+00030230: 616c 7068 613d 312e 2c20 6564 6765 5f64  alpha=1., edge_d
+00030240: 6574 6169 6c73 3d46 616c 7365 293a 0a20  etails=False):. 
+00030250: 2020 2020 2020 2069 6620 6178 2069 7320         if ax is 
+00030260: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00030270: 2020 6669 6720 3d20 706c 742e 6669 6775    fig = plt.figu
+00030280: 7265 2829 0a20 2020 2020 2020 2020 2020  re().           
+00030290: 2061 7820 3d20 6669 672e 6164 645f 7375   ax = fig.add_su
+000302a0: 6270 6c6f 7428 3131 312c 2070 726f 6a65  bplot(111, proje
+000302b0: 6374 696f 6e3d 2733 6427 290a 2020 2020  ction='3d').    
+000302c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000302d0: 2020 2020 2020 6669 6720 3d20 4e6f 6e65        fig = None
+000302e0: 0a0a 2020 2020 2020 2020 7820 3d20 5b5d  ..        x = []
+000302f0: 0a20 2020 2020 2020 2079 203d 205b 5d0a  .        y = [].
+00030300: 2020 2020 2020 2020 7a20 3d20 5b5d 0a20          z = []. 
+00030310: 2020 2020 2020 2066 6f72 2070 6f69 6e74         for point
+00030320: 5f78 2c20 706f 696e 745f 792c 2070 6f69  _x, point_y, poi
+00030330: 6e74 5f7a 2069 6e20 7365 6c66 2e64 6973  nt_z in self.dis
+00030340: 6372 6574 697a 6174 696f 6e5f 706f 696e  cretization_poin
+00030350: 7473 2829 3a0a 2020 2020 2020 2020 2020  ts():.          
+00030360: 2020 782e 6170 7065 6e64 2870 6f69 6e74    x.append(point
+00030370: 5f78 290a 2020 2020 2020 2020 2020 2020  _x).            
+00030380: 792e 6170 7065 6e64 2870 6f69 6e74 5f79  y.append(point_y
+00030390: 290a 2020 2020 2020 2020 2020 2020 7a2e  ).            z.
+000303a0: 6170 7065 6e64 2870 6f69 6e74 5f7a 290a  append(point_z).
+000303b0: 2020 2020 2020 2020 782e 6170 7065 6e64          x.append
+000303c0: 2878 5b30 5d29 0a20 2020 2020 2020 2079  (x[0]).        y
+000303d0: 2e61 7070 656e 6428 795b 305d 290a 2020  .append(y[0]).  
+000303e0: 2020 2020 2020 7a2e 6170 7065 6e64 287a        z.append(z
+000303f0: 5b30 5d29 0a20 2020 2020 2020 2061 782e  [0]).        ax.
+00030400: 706c 6f74 2878 2c20 792c 207a 2c20 636f  plot(x, y, z, co
+00030410: 6c6f 723d 636f 6c6f 722c 2061 6c70 6861  lor=color, alpha
+00030420: 3d61 6c70 6861 290a 2020 2020 2020 2020  =alpha).        
+00030430: 7265 7475 726e 2061 780a 0a20 2020 2064  return ax..    d
+00030440: 6566 2070 6f69 6e74 5f61 745f 6162 7363  ef point_at_absc
+00030450: 6973 7361 2873 656c 662c 2063 7572 7669  issa(self, curvi
+00030460: 6c69 6e65 6172 5f61 6273 6369 7373 6129  linear_abscissa)
+00030470: 3a0a 2020 2020 2020 2020 2222 2220 5374  :.        """ St
+00030480: 6172 7420 706f 696e 7420 6973 2061 7420  art point is at 
+00030490: 696e 7465 7273 6563 7469 6f6e 206f 6620  intersection of 
+000304a0: 6672 616d 652e 7520 6178 6973 2e20 2222  frame.u axis. ""
+000304b0: 220a 2020 2020 2020 2020 7374 6172 7420  ".        start 
+000304c0: 3d20 7365 6c66 2e66 7261 6d65 2e6f 7269  = self.frame.ori
+000304d0: 6769 6e20 2b20 7365 6c66 2e72 6164 6975  gin + self.radiu
+000304e0: 7320 2a20 7365 6c66 2e66 7261 6d65 2e75  s * self.frame.u
+000304f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00030500: 7374 6172 742e 726f 7461 7469 6f6e 2873  start.rotation(s
+00030510: 656c 662e 6672 616d 652e 6f72 6967 696e  elf.frame.origin
+00030520: 2c20 7365 6c66 2e66 7261 6d65 2e77 2c0a  , self.frame.w,.
+00030530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030540: 2020 2020 2020 2020 2020 2020 2020 6375                cu
+00030550: 7276 696c 696e 6561 725f 6162 7363 6973  rvilinear_abscis
+00030560: 7361 202f 2073 656c 662e 7261 6469 7573  sa / self.radius
+00030570: 290a 0a20 2020 2064 6566 206c 696e 6573  )..    def lines
+00030580: 6567 6d65 6e74 5f69 6e74 6572 7365 6374  egment_intersect
+00030590: 696f 6e73 2873 656c 662c 206c 696e 6573  ions(self, lines
+000305a0: 6567 6d65 6e74 3a20 766f 6c6d 646c 722e  egment: volmdlr.
+000305b0: 6564 6765 732e 4c69 6e65 5365 676d 656e  edges.LineSegmen
+000305c0: 7433 4429 3a0a 2020 2020 2020 2020 2222  t3D):.        ""
+000305d0: 220a 2020 2020 2020 2020 4361 6c63 756c  ".        Calcul
+000305e0: 6174 6573 2074 6865 2069 6e74 6572 7365  ates the interse
+000305f0: 6374 696f 6e73 2062 6574 7765 656e 2074  ctions between t
+00030600: 6865 2043 6972 636c 6533 4420 616e 6420  he Circle3D and 
+00030610: 6120 4c69 6e65 5365 676d 656e 7433 442e  a LineSegment3D.
+00030620: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00030630: 206c 696e 6573 6567 6d65 6e74 3a20 4c69   linesegment: Li
+00030640: 6e65 5365 676d 656e 7433 4420 746f 2076  neSegment3D to v
+00030650: 6572 6966 7920 696e 7465 7273 6563 7469  erify intersecti
+00030660: 6f6e 730a 2020 2020 2020 2020 3a72 6574  ons.        :ret
+00030670: 7572 6e3a 206c 6973 7420 6f66 2070 6f69  urn: list of poi
+00030680: 6e74 7320 696e 7465 7273 6563 7469 6e67  nts intersecting
+00030690: 2043 6972 636c 650a 2020 2020 2020 2020   Circle.        
+000306a0: 2222 220a 2020 2020 2020 2020 696e 7465  """.        inte
+000306b0: 7273 6563 7469 6f6e 7320 3d20 5b5d 0a20  rsections = []. 
+000306c0: 2020 2020 2020 2063 6972 636c 6533 645f         circle3d_
+000306d0: 6c69 6e65 5f69 6e74 6572 7365 6374 696f  line_intersectio
+000306e0: 6e73 203d 2076 6d5f 7574 696c 735f 696e  ns = vm_utils_in
+000306f0: 7465 7273 6563 7469 6f6e 732e 6369 7263  tersections.circ
+00030700: 6c65 5f33 645f 6c69 6e65 5f69 6e74 6572  le_3d_line_inter
+00030710: 7365 6374 696f 6e73 2873 656c 662c 206c  sections(self, l
+00030720: 696e 6573 6567 6d65 6e74 2e74 6f5f 6c69  inesegment.to_li
+00030730: 6e65 2829 290a 2020 2020 2020 2020 666f  ne()).        fo
+00030740: 7220 696e 7465 7273 6563 7469 6f6e 2069  r intersection i
+00030750: 6e20 6369 7263 6c65 3364 5f6c 696e 655f  n circle3d_line_
+00030760: 696e 7465 7273 6563 7469 6f6e 733a 0a20  intersections:. 
+00030770: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
+00030780: 6e65 7365 676d 656e 742e 706f 696e 745f  nesegment.point_
+00030790: 6265 6c6f 6e67 7328 696e 7465 7273 6563  belongs(intersec
+000307a0: 7469 6f6e 293a 0a20 2020 2020 2020 2020  tion):.         
+000307b0: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
+000307c0: 696f 6e73 2e61 7070 656e 6428 696e 7465  ions.append(inte
+000307d0: 7273 6563 7469 6f6e 290a 2020 2020 2020  rsection).      
+000307e0: 2020 7265 7475 726e 2069 6e74 6572 7365    return interse
+000307f0: 6374 696f 6e73 0a0a 2020 2020 4063 6c61  ctions..    @cla
+00030800: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+00030810: 2066 726f 6d5f 7374 6570 2863 6c73 2c20   from_step(cls, 
+00030820: 6172 6775 6d65 6e74 732c 206f 626a 6563  arguments, objec
+00030830: 745f 6469 6374 293a 0a20 2020 2020 2020  t_dict):.       
+00030840: 2022 2222 0a20 2020 2020 2020 2043 6f6e   """.        Con
+00030850: 7665 7274 7320 6120 7374 6570 2070 7269  verts a step pri
+00030860: 6d69 7469 7665 2074 6f20 6120 4369 7263  mitive to a Circ
+00030870: 6c65 3344 2e0a 0a20 2020 2020 2020 203a  le3D...        :
+00030880: 7061 7261 6d20 6172 6775 6d65 6e74 733a  param arguments:
+00030890: 2054 6865 2061 7267 756d 656e 7473 206f   The arguments o
+000308a0: 6620 7468 6520 7374 6570 2070 7269 6d69  f the step primi
+000308b0: 7469 7665 2e20 5468 6520 6c61 7374 2065  tive. The last e
+000308c0: 6c65 6d65 6e74 2072 6570 7265 7365 6e74  lement represent
+000308d0: 7320 7468 6520 756e 6974 5f63 6f6e 7665  s the unit_conve
+000308e0: 7273 696f 6e5f 6661 6374 6f72 2e0a 2020  rsion_factor..  
+000308f0: 2020 2020 2020 3a74 7970 6520 6172 6775        :type argu
+00030900: 6d65 6e74 733a 206c 6973 740a 2020 2020  ments: list.    
+00030910: 2020 2020 3a70 6172 616d 206f 626a 6563      :param objec
+00030920: 745f 6469 6374 3a20 5468 6520 6469 6374  t_dict: The dict
+00030930: 696f 6e61 7279 2063 6f6e 7461 696e 696e  ionary containin
+00030940: 6720 616c 6c20 7468 6520 7374 6570 2070  g all the step p
+00030950: 7269 6d69 7469 7665 7320 7468 6174 2068  rimitives that h
+00030960: 6176 6520 616c 7265 6164 7920 6265 656e  ave already been
+00030970: 2069 6e73 7461 6e74 6961 7465 642e 0a20   instantiated.. 
+00030980: 2020 2020 2020 203a 7479 7065 206f 626a         :type obj
+00030990: 6563 745f 6469 6374 3a20 6469 6374 0a20  ect_dict: dict. 
+000309a0: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+000309b0: 5468 6520 636f 7272 6573 706f 6e64 696e  The correspondin
+000309c0: 6720 4369 7263 6c65 3344 206f 626a 6563  g Circle3D objec
+000309d0: 742e 0a20 2020 2020 2020 203a 7274 7970  t..        :rtyp
+000309e0: 653a 203a 636c 6173 733a 6076 6f6c 6d64  e: :class:`volmd
+000309f0: 6c72 2e77 6972 6573 2e43 6972 636c 6533  lr.wires.Circle3
+00030a00: 4460 0a20 2020 2020 2020 2022 2222 0a20  D`.        """. 
+00030a10: 2020 2020 2020 2075 6e69 745f 636f 6e76         unit_conv
+00030a20: 6572 7369 6f6e 5f66 6163 746f 7220 3d20  ersion_factor = 
+00030a30: 6172 6775 6d65 6e74 735b 2d31 5d0a 2020  arguments[-1].  
+00030a40: 2020 2020 2020 6365 6e74 6572 203d 206f        center = o
+00030a50: 626a 6563 745f 6469 6374 5b61 7267 756d  bject_dict[argum
+00030a60: 656e 7473 5b31 5d5d 2e6f 7269 6769 6e0a  ents[1]].origin.
+00030a70: 2020 2020 2020 2020 7261 6469 7573 203d          radius =
+00030a80: 2066 6c6f 6174 2861 7267 756d 656e 7473   float(arguments
+00030a90: 5b32 5d29 202a 2075 6e69 745f 636f 6e76  [2]) * unit_conv
+00030aa0: 6572 7369 6f6e 5f66 6163 746f 720a 2020  ersion_factor.  
+00030ab0: 2020 2020 2020 6966 206f 626a 6563 745f        if object_
+00030ac0: 6469 6374 5b61 7267 756d 656e 7473 5b31  dict[arguments[1
+00030ad0: 5d5d 2e75 2069 7320 6e6f 7420 4e6f 6e65  ]].u is not None
+00030ae0: 3a0a 2020 2020 2020 2020 2020 2020 6e6f  :.            no
+00030af0: 726d 616c 203d 206f 626a 6563 745f 6469  rmal = object_di
+00030b00: 6374 5b61 7267 756d 656e 7473 5b31 5d5d  ct[arguments[1]]
+00030b10: 2e75 0a20 2020 2020 2020 2020 2020 206f  .u.            o
+00030b20: 7468 6572 5f76 6563 203d 206f 626a 6563  ther_vec = objec
+00030b30: 745f 6469 6374 5b61 7267 756d 656e 7473  t_dict[arguments
+00030b40: 5b31 5d5d 2e76 0a20 2020 2020 2020 2020  [1]].v.         
+00030b50: 2020 2069 6620 6f74 6865 725f 7665 6320     if other_vec 
+00030b60: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00030b70: 2020 2020 2020 2020 2020 2020 206f 7468               oth
+00030b80: 6572 5f76 6563 2e6e 6f72 6d61 6c69 7a65  er_vec.normalize
+00030b90: 2829 0a20 2020 2020 2020 2065 6c73 653a  ().        else:
+00030ba0: 0a20 2020 2020 2020 2020 2020 206e 6f72  .            nor
+00030bb0: 6d61 6c20 3d20 6f62 6a65 6374 5f64 6963  mal = object_dic
+00030bc0: 745b 6172 6775 6d65 6e74 735b 315d 5d2e  t[arguments[1]].
+00030bd0: 7620 2023 206f 7520 770a 2020 2020 2020  v  # ou w.      
+00030be0: 2020 2020 2020 6f74 6865 725f 7665 6320        other_vec 
+00030bf0: 3d20 4e6f 6e65 0a20 2020 2020 2020 206e  = None.        n
+00030c00: 6f72 6d61 6c2e 6e6f 726d 616c 697a 6528  ormal.normalize(
+00030c10: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00030c20: 2063 6c73 2e66 726f 6d5f 6365 6e74 6572   cls.from_center
+00030c30: 5f6e 6f72 6d61 6c28 6365 6e74 6572 2c20  _normal(center, 
+00030c40: 6e6f 726d 616c 2c20 7261 6469 7573 2c20  normal, radius, 
+00030c50: 6172 6775 6d65 6e74 735b 305d 5b31 3a2d  arguments[0][1:-
+00030c60: 315d 290a 0a20 2020 2064 6566 2074 6f5f  1])..    def to_
+00030c70: 7374 6570 2873 656c 662c 2063 7572 7265  step(self, curre
+00030c80: 6e74 5f69 642c 2073 7572 6661 6365 5f69  nt_id, surface_i
+00030c90: 643d 4e6f 6e65 2c20 7375 7266 6163 6533  d=None, surface3
+00030ca0: 643d 4e6f 6e65 293a 0a20 2020 2020 2020  d=None):.       
+00030cb0: 2063 6972 636c 655f 6672 616d 6520 3d20   circle_frame = 
+00030cc0: 766f 6c6d 646c 722e 4672 616d 6533 4428  volmdlr.Frame3D(
+00030cd0: 7365 6c66 2e63 656e 7465 722c 2073 656c  self.center, sel
+00030ce0: 662e 6672 616d 652e 772c 2073 656c 662e  f.frame.w, self.
+00030cf0: 6672 616d 652e 752c 0a20 2020 2020 2020  frame.u,.       
+00030d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030d20: 7365 6c66 2e66 7261 6d65 2e76 290a 2020  self.frame.v).  
+00030d30: 2020 2020 2020 636f 6e74 656e 742c 2066        content, f
+00030d40: 7261 6d65 5f69 6420 3d20 6369 7263 6c65  rame_id = circle
+00030d50: 5f66 7261 6d65 2e74 6f5f 7374 6570 2863  _frame.to_step(c
+00030d60: 7572 7265 6e74 5f69 6429 0a20 2020 2020  urrent_id).     
+00030d70: 2020 2063 7572 7665 5f69 6420 3d20 6672     curve_id = fr
+00030d80: 616d 655f 6964 202b 2031 0a20 2020 2020  ame_id + 1.     
+00030d90: 2020 2063 6f6e 7465 6e74 202b 3d20 2223     content += "#
+00030da0: 7b7d 203d 2043 4952 434c 4528 277b 7d27  {} = CIRCLE('{}'
+00030db0: 2c23 7b7d 2c7b 7d29 3b5c 6e22 2e66 6f72  ,#{},{});\n".for
+00030dc0: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
+00030dd0: 2063 7572 7665 5f69 642c 2073 656c 662e   curve_id, self.
+00030de0: 6e61 6d65 2c20 6672 616d 655f 6964 2c20  name, frame_id, 
+00030df0: 726f 756e 6428 7365 6c66 2e72 6164 6975  round(self.radiu
+00030e00: 7320 2a20 3130 3030 2c20 3329 290a 0a20  s * 1000, 3)).. 
+00030e10: 2020 2020 2020 2069 6620 7375 7266 6163         if surfac
+00030e20: 655f 6964 3a0a 2020 2020 2020 2020 2020  e_id:.          
+00030e30: 2020 636f 6e74 656e 7420 2b3d 2022 237b    content += "#{
+00030e40: 7d20 3d20 5355 5246 4143 455f 4355 5256  } = SURFACE_CURV
+00030e50: 4528 2727 2c23 7b7d 2c28 237b 7d29 2c2e  E('',#{},(#{}),.
+00030e60: 5043 5552 5645 5f53 312e 293b 5c6e 222e  PCURVE_S1.);\n".
+00030e70: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
+00030e80: 2020 2020 2020 2020 6375 7276 655f 6964          curve_id
+00030e90: 202b 2031 2c20 6375 7276 655f 6964 2c20   + 1, curve_id, 
+00030ea0: 7375 7266 6163 655f 6964 290a 2020 2020  surface_id).    
+00030eb0: 2020 2020 2020 2020 6375 7276 655f 6964          curve_id
+00030ec0: 202b 3d20 310a 0a20 2020 2020 2020 2070   += 1..        p
+00030ed0: 3120 3d20 7365 6c66 2e66 7261 6d65 2e6f  1 = self.frame.o
+00030ee0: 7269 6769 6e20 2b20 7365 6c66 2e66 7261  rigin + self.fra
+00030ef0: 6d65 2e75 202a 2073 656c 662e 7261 6469  me.u * self.radi
+00030f00: 7573 0a20 2020 2020 2020 2023 2070 3220  us.        # p2 
+00030f10: 3d20 7365 6c66 2e66 7261 6d65 2e6f 7269  = self.frame.ori
+00030f20: 6769 6e20 2b20 7365 6c66 2e66 7261 6d65  gin + self.frame
+00030f30: 2e76 2a73 656c 662e 7261 6469 7573 0a20  .v*self.radius. 
+00030f40: 2020 2020 2020 2070 3320 3d20 7365 6c66         p3 = self
+00030f50: 2e66 7261 6d65 2e6f 7269 6769 6e20 2d20  .frame.origin - 
+00030f60: 7365 6c66 2e66 7261 6d65 2e75 202a 2073  self.frame.u * s
+00030f70: 656c 662e 7261 6469 7573 0a20 2020 2020  elf.radius.     
+00030f80: 2020 2023 2070 3420 3d20 7365 6c66 2e66     # p4 = self.f
+00030f90: 7261 6d65 2e6f 7269 6769 6e20 2d20 7365  rame.origin - se
+00030fa0: 6c66 2e66 7261 6d65 2e76 2a73 656c 662e  lf.frame.v*self.
+00030fb0: 7261 6469 7573 0a0a 2020 2020 2020 2020  radius..        
+00030fc0: 7031 5f63 6f6e 7465 6e74 2c20 7031 5f69  p1_content, p1_i
+00030fd0: 6420 3d20 7031 2e74 6f5f 7374 6570 2863  d = p1.to_step(c
+00030fe0: 7572 7665 5f69 6420 2b20 312c 2076 6572  urve_id + 1, ver
+00030ff0: 7465 783d 5472 7565 290a 2020 2020 2020  tex=True).      
+00031000: 2020 2320 7032 5f63 6f6e 7465 6e74 2c20    # p2_content, 
+00031010: 7032 5f69 6420 3d20 7032 2e74 6f5f 7374  p2_id = p2.to_st
+00031020: 6570 2870 315f 6964 2b31 2c20 7665 7274  ep(p1_id+1, vert
+00031030: 6578 3d54 7275 6529 0a20 2020 2020 2020  ex=True).       
+00031040: 2070 335f 636f 6e74 656e 742c 2070 335f   p3_content, p3_
+00031050: 6964 203d 2070 332e 746f 5f73 7465 7028  id = p3.to_step(
+00031060: 7031 5f69 6420 2b20 312c 2076 6572 7465  p1_id + 1, verte
+00031070: 783d 5472 7565 290a 2020 2020 2020 2020  x=True).        
+00031080: 2320 7034 5f63 6f6e 7465 6e74 2c20 7034  # p4_content, p4
+00031090: 5f69 6420 3d20 7034 2e74 6f5f 7374 6570  _id = p4.to_step
+000310a0: 2870 335f 6964 2b31 2c20 7665 7274 6578  (p3_id+1, vertex
+000310b0: 3d54 7275 6529 0a20 2020 2020 2020 2063  =True).        c
+000310c0: 6f6e 7465 6e74 202b 3d20 7031 5f63 6f6e  ontent += p1_con
+000310d0: 7465 6e74 202b 2070 335f 636f 6e74 656e  tent + p3_conten
+000310e0: 740a 0a20 2020 2020 2020 2061 7263 315f  t..        arc1_
+000310f0: 6964 203d 2070 335f 6964 202b 2031 0a20  id = p3_id + 1. 
+00031100: 2020 2020 2020 2063 6f6e 7465 6e74 202b         content +
+00031110: 3d20 2223 7b7d 203d 2045 4447 455f 4355  = "#{} = EDGE_CU
+00031120: 5256 4528 277b 7d27 2c23 7b7d 2c23 7b7d  RVE('{}',#{},#{}
+00031130: 2c23 7b7d 2c2e 542e 293b 5c6e 222e 666f  ,#{},.T.);\n".fo
+00031140: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
+00031150: 2020 6172 6331 5f69 642c 2073 656c 662e    arc1_id, self.
+00031160: 6e61 6d65 2c20 7031 5f69 642c 2070 335f  name, p1_id, p3_
+00031170: 6964 2c20 6375 7276 655f 6964 290a 2020  id, curve_id).  
+00031180: 2020 2020 2020 6f72 6965 6e74 6564 5f65        oriented_e
+00031190: 6467 6531 5f69 6420 3d20 6172 6331 5f69  dge1_id = arc1_i
+000311a0: 6420 2b20 310a 2020 2020 2020 2020 636f  d + 1.        co
+000311b0: 6e74 656e 7420 2b3d 2022 237b 7d20 3d20  ntent += "#{} = 
+000311c0: 4f52 4945 4e54 4544 5f45 4447 4528 2727  ORIENTED_EDGE(''
+000311d0: 2c2a 2c2a 2c23 7b7d 2c2e 542e 293b 5c6e  ,*,*,#{},.T.);\n
+000311e0: 222e 666f 726d 6174 280a 2020 2020 2020  ".format(.      
+000311f0: 2020 2020 2020 6f72 6965 6e74 6564 5f65        oriented_e
+00031200: 6467 6531 5f69 642c 2061 7263 315f 6964  dge1_id, arc1_id
+00031210: 290a 0a20 2020 2020 2020 2061 7263 325f  )..        arc2_
+00031220: 6964 203d 206f 7269 656e 7465 645f 6564  id = oriented_ed
+00031230: 6765 315f 6964 202b 2031 0a20 2020 2020  ge1_id + 1.     
+00031240: 2020 2063 6f6e 7465 6e74 202b 3d20 2223     content += "#
+00031250: 7b7d 203d 2045 4447 455f 4355 5256 4528  {} = EDGE_CURVE(
+00031260: 277b 7d27 2c23 7b7d 2c23 7b7d 2c23 7b7d  '{}',#{},#{},#{}
+00031270: 2c2e 542e 293b 5c6e 222e 666f 726d 6174  ,.T.);\n".format
+00031280: 280a 2020 2020 2020 2020 2020 2020 6172  (.            ar
+00031290: 6332 5f69 642c 2073 656c 662e 6e61 6d65  c2_id, self.name
+000312a0: 2c20 7033 5f69 642c 2070 315f 6964 2c20  , p3_id, p1_id, 
+000312b0: 6375 7276 655f 6964 290a 2020 2020 2020  curve_id).      
+000312c0: 2020 6f72 6965 6e74 6564 5f65 6467 6532    oriented_edge2
+000312d0: 5f69 6420 3d20 6172 6332 5f69 6420 2b20  _id = arc2_id + 
+000312e0: 310a 2020 2020 2020 2020 636f 6e74 656e  1.        conten
+000312f0: 7420 2b3d 2022 237b 7d20 3d20 4f52 4945  t += "#{} = ORIE
+00031300: 4e54 4544 5f45 4447 4528 2727 2c2a 2c2a  NTED_EDGE('',*,*
+00031310: 2c23 7b7d 2c2e 542e 293b 5c6e 222e 666f  ,#{},.T.);\n".fo
+00031320: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
+00031330: 2020 6f72 6965 6e74 6564 5f65 6467 6532    oriented_edge2
+00031340: 5f69 642c 2061 7263 325f 6964 290a 0a20  _id, arc2_id).. 
+00031350: 2020 2020 2020 2063 7572 7265 6e74 5f69         current_i
+00031360: 6420 3d20 6f72 6965 6e74 6564 5f65 6467  d = oriented_edg
+00031370: 6532 5f69 6420 2b20 310a 2020 2020 2020  e2_id + 1.      
+00031380: 2020 636f 6e74 656e 7420 2b3d 2022 237b    content += "#{
+00031390: 7d20 3d20 4544 4745 5f4c 4f4f 5028 277b  } = EDGE_LOOP('{
+000313a0: 7d27 2c28 237b 7d2c 237b 7d29 293b 5c6e  }',(#{},#{}));\n
+000313b0: 222e 666f 726d 6174 280a 2020 2020 2020  ".format(.      
+000313c0: 2020 2020 2020 6375 7272 656e 745f 6964        current_id
+000313d0: 2c20 7365 6c66 2e6e 616d 652c 206f 7269  , self.name, ori
+000313e0: 656e 7465 645f 6564 6765 315f 6964 2c20  ented_edge1_id, 
+000313f0: 6f72 6965 6e74 6564 5f65 6467 6532 5f69  oriented_edge2_i
+00031400: 6429 0a0a 2020 2020 2020 2020 7265 7475  d)..        retu
+00031410: 726e 2063 6f6e 7465 6e74 2c20 6375 7272  rn content, curr
+00031420: 656e 745f 6964 0a0a 2020 2020 6465 6620  ent_id..    def 
+00031430: 5f62 6f75 6e64 696e 675f 626f 7828 7365  _bounding_box(se
+00031440: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00031450: 0a20 2020 2020 2020 2043 6f6d 7075 7465  .        Compute
+00031460: 7320 7468 6520 626f 756e 6469 6e67 2062  s the bounding b
+00031470: 6f78 2e0a 0a20 2020 2020 2020 2022 2222  ox...        """
+00031480: 0a20 2020 2020 2020 2070 6f69 6e74 7320  .        points 
+00031490: 3d20 5b73 656c 662e 6672 616d 652e 6f72  = [self.frame.or
+000314a0: 6967 696e 202b 2073 656c 662e 7261 6469  igin + self.radi
+000314b0: 7573 202a 2076 0a20 2020 2020 2020 2020  us * v.         
+000314c0: 2020 2020 2020 2020 2066 6f72 2076 2069           for v i
+000314d0: 6e20 5b73 656c 662e 6672 616d 652e 752c  n [self.frame.u,
+000314e0: 202d 7365 6c66 2e66 7261 6d65 2e75 2c0a   -self.frame.u,.
+000314f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031500: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00031510: 2e66 7261 6d65 2e76 2c20 2d73 656c 662e  .frame.v, -self.
+00031520: 6672 616d 652e 765d 5d0a 2020 2020 2020  frame.v]].      
+00031530: 2020 7265 7475 726e 2076 6f6c 6d64 6c72    return volmdlr
+00031540: 2e63 6f72 652e 426f 756e 6469 6e67 426f  .core.BoundingBo
+00031550: 782e 6672 6f6d 5f70 6f69 6e74 7328 706f  x.from_points(po
+00031560: 696e 7473 290a 0a20 2020 2064 6566 2074  ints)..    def t
+00031570: 6f5f 3264 2873 656c 662c 2070 6c61 6e65  o_2d(self, plane
+00031580: 5f6f 7269 6769 6e2c 2078 2c20 7929 3a0a  _origin, x, y):.
+00031590: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000315a0: 2020 2020 5472 616e 7366 6f72 6d73 2061      Transforms a
+000315b0: 2043 6972 636c 6533 4420 696e 746f 2061   Circle3D into a
+000315c0: 6e20 4369 7263 6c65 3244 2c20 6769 7665  n Circle2D, give
+000315d0: 6e20 6120 706c 616e 6520 6f72 6967 696e  n a plane origin
+000315e0: 2061 6e64 2061 6e20 7520 616e 6420 7620   and an u and v 
+000315f0: 706c 616e 6520 7665 6374 6f72 2e0a 0a20  plane vector... 
+00031600: 2020 2020 2020 203a 7061 7261 6d20 706c         :param pl
+00031610: 616e 655f 6f72 6967 696e 3a20 706c 616e  ane_origin: plan
+00031620: 6520 6f72 6967 696e 2e0a 2020 2020 2020  e origin..      
+00031630: 2020 3a70 6172 616d 2078 3a20 706c 616e    :param x: plan
+00031640: 6520 7520 7665 6374 6f72 2e0a 2020 2020  e u vector..    
+00031650: 2020 2020 3a70 6172 616d 2079 3a20 706c      :param y: pl
+00031660: 616e 6520 7620 7665 6374 6f72 2e0a 2020  ane v vector..  
+00031670: 2020 2020 2020 3a72 6574 7572 6e3a 2043        :return: C
+00031680: 6972 636c 6532 442e 0a20 2020 2020 2020  ircle2D..       
+00031690: 2022 2222 0a20 2020 2020 2020 207a 203d   """.        z =
+000316a0: 2078 2e63 726f 7373 2879 290a 2020 2020   x.cross(y).    
+000316b0: 2020 2020 706c 616e 6533 6420 3d20 766f      plane3d = vo
+000316c0: 6c6d 646c 722e 6661 6365 732e 506c 616e  lmdlr.faces.Plan
+000316d0: 6533 4428 766f 6c6d 646c 722e 4672 616d  e3D(volmdlr.Fram
+000316e0: 6533 4428 706c 616e 655f 6f72 6967 696e  e3D(plane_origin
+000316f0: 2c20 782c 2079 2c20 7a29 290a 2020 2020  , x, y, z)).    
+00031700: 2020 2020 7265 7475 726e 2043 6972 636c      return Circl
+00031710: 6532 4428 706c 616e 6533 642e 706f 696e  e2D(plane3d.poin
+00031720: 7433 645f 746f 5f32 6428 7365 6c66 2e63  t3d_to_2d(self.c
+00031730: 656e 7465 7229 2c20 7365 6c66 2e72 6164  enter), self.rad
+00031740: 6975 7329 0a0a 2020 2020 4063 6c61 7373  ius)..    @class
+00031750: 6d65 7468 6f64 0a20 2020 2064 6566 2066  method.    def f
+00031760: 726f 6d5f 6365 6e74 6572 5f6e 6f72 6d61  rom_center_norma
+00031770: 6c28 636c 732c 2063 656e 7465 723a 2076  l(cls, center: v
+00031780: 6f6c 6d64 6c72 2e50 6f69 6e74 3344 2c0a  olmdlr.Point3D,.
+00031790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000317a0: 2020 2020 2020 2020 2020 206e 6f72 6d61             norma
+000317b0: 6c3a 2076 6f6c 6d64 6c72 2e56 6563 746f  l: volmdlr.Vecto
+000317c0: 7233 442c 0a20 2020 2020 2020 2020 2020  r3D,.           
+000317d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000317e0: 7261 6469 7573 3a20 666c 6f61 742c 0a20  radius: float,. 
 000317f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031800: 2020 7261 6469 7573 3a20 666c 6f61 742c    radius: float,
-00031810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00031820: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00031830: 3a20 7374 7220 3d20 2727 293a 0a20 2020  : str = ''):.   
-00031840: 2020 2020 2075 203d 206e 6f72 6d61 6c2e       u = normal.
-00031850: 6465 7465 726d 696e 6973 7469 635f 756e  deterministic_un
-00031860: 6974 5f6e 6f72 6d61 6c5f 7665 6374 6f72  it_normal_vector
-00031870: 2829 0a20 2020 2020 2020 2076 203d 206e  ().        v = n
-00031880: 6f72 6d61 6c2e 6372 6f73 7328 7529 0a20  ormal.cross(u). 
-00031890: 2020 2020 2020 2072 6574 7572 6e20 636c         return cl
-000318a0: 7328 766f 6c6d 646c 722e 4672 616d 6533  s(volmdlr.Frame3
-000318b0: 4428 6365 6e74 6572 2c20 752c 2076 2c20  D(center, u, v, 
-000318c0: 6e6f 726d 616c 292c 2072 6164 6975 732c  normal), radius,
-000318d0: 206e 616d 6529 0a0a 2020 2020 4063 6c61   name)..    @cla
-000318e0: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
-000318f0: 2066 726f 6d5f 335f 706f 696e 7473 2863   from_3_points(c
-00031900: 6c73 2c20 706f 696e 7431 2c20 706f 696e  ls, point1, poin
-00031910: 7432 2c20 706f 696e 7433 293a 0a20 2020  t2, point3):.   
-00031920: 2020 2020 2075 3120 3d20 706f 696e 7432       u1 = point2
-00031930: 202d 2070 6f69 6e74 310a 2020 2020 2020   - point1.      
-00031940: 2020 7532 203d 2070 6f69 6e74 3220 2d20    u2 = point2 - 
-00031950: 706f 696e 7433 0a20 2020 2020 2020 2074  point3.        t
-00031960: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00031970: 7531 2e6e 6f72 6d61 6c69 7a65 2829 0a20  u1.normalize(). 
-00031980: 2020 2020 2020 2020 2020 2075 322e 6e6f             u2.no
-00031990: 726d 616c 697a 6528 290a 2020 2020 2020  rmalize().      
-000319a0: 2020 6578 6365 7074 205a 6572 6f44 6976    except ZeroDiv
-000319b0: 6973 696f 6e45 7272 6f72 3a0a 2020 2020  isionError:.    
-000319c0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-000319d0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-000319e0: 2020 2020 2020 2020 2020 2774 6865 2033            'the 3
-000319f0: 2070 6f69 6e74 7320 6d75 7374 2062 6520   points must be 
-00031a00: 6469 7374 696e 6374 7327 290a 0a20 2020  distincts')..   
-00031a10: 2020 2020 206e 6f72 6d61 6c20 3d20 7532       normal = u2
-00031a20: 2e63 726f 7373 2875 3129 0a20 2020 2020  .cross(u1).     
-00031a30: 2020 206e 6f72 6d61 6c2e 6e6f 726d 616c     normal.normal
-00031a40: 697a 6528 290a 0a20 2020 2020 2020 2069  ize()..        i
-00031a50: 6620 7531 203d 3d20 7532 3a0a 2020 2020  f u1 == u2:.    
-00031a60: 2020 2020 2020 2020 7532 203d 206e 6f72          u2 = nor
-00031a70: 6d61 6c2e 6372 6f73 7328 7531 290a 2020  mal.cross(u1).  
-00031a80: 2020 2020 2020 2020 2020 7532 2e6e 6f72            u2.nor
-00031a90: 6d61 6c69 7a65 2829 0a0a 2020 2020 2020  malize()..      
-00031aa0: 2020 7631 203d 206e 6f72 6d61 6c2e 6372    v1 = normal.cr
-00031ab0: 6f73 7328 7531 2920 2023 2076 3120 6973  oss(u1)  # v1 is
-00031ac0: 206e 6f72 6d61 6c2c 2065 7175 616c 2075   normal, equal u
-00031ad0: 320a 2020 2020 2020 2020 7632 203d 206e  2.        v2 = n
-00031ae0: 6f72 6d61 6c2e 6372 6f73 7328 7532 2920  ormal.cross(u2) 
-00031af0: 2023 2065 7175 616c 202d 7531 0a0a 2020   # equal -u1..  
-00031b00: 2020 2020 2020 7031 3120 3d20 302e 3520        p11 = 0.5 
-00031b10: 2a20 2870 6f69 6e74 3120 2b20 706f 696e  * (point1 + poin
-00031b20: 7432 2920 2023 204d 6964 2070 6f69 6e74  t2)  # Mid point
-00031b30: 206f 6620 7365 676d 656e 7420 732c 6d0a   of segment s,m.
-00031b40: 2020 2020 2020 2020 7032 3120 3d20 302e          p21 = 0.
-00031b50: 3520 2a20 2870 6f69 6e74 3220 2b20 706f  5 * (point2 + po
-00031b60: 696e 7433 2920 2023 204d 6964 2070 6f69  int3)  # Mid poi
-00031b70: 6e74 206f 6620 7365 676d 656e 7420 732c  nt of segment s,
-00031b80: 6d0a 0a20 2020 2020 2020 206c 3120 3d20  m..        l1 = 
-00031b90: 766f 6c6d 646c 722e 6564 6765 732e 4c69  volmdlr.edges.Li
-00031ba0: 6e65 3344 2870 3131 2c20 7031 3120 2b20  ne3D(p11, p11 + 
-00031bb0: 7631 290a 2020 2020 2020 2020 6c32 203d  v1).        l2 =
-00031bc0: 2076 6f6c 6d64 6c72 2e65 6467 6573 2e4c   volmdlr.edges.L
-00031bd0: 696e 6533 4428 7032 312c 2070 3231 202b  ine3D(p21, p21 +
-00031be0: 2076 3229 0a0a 2020 2020 2020 2020 7472   v2)..        tr
-00031bf0: 793a 0a20 2020 2020 2020 2020 2020 2063  y:.            c
-00031c00: 656e 7465 722c 205f 203d 206c 312e 6d69  enter, _ = l1.mi
-00031c10: 6e69 6d75 6d5f 6469 7374 616e 6365 5f70  nimum_distance_p
-00031c20: 6f69 6e74 7328 6c32 290a 2020 2020 2020  oints(l2).      
-00031c30: 2020 6578 6365 7074 205a 6572 6f44 6976    except ZeroDiv
-00031c40: 6973 696f 6e45 7272 6f72 3a0a 2020 2020  isionError:.    
-00031c50: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00031c60: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00031c70: 2020 2020 2020 2020 2020 2753 7461 7274            'Start
-00031c80: 2c20 656e 6420 616e 6420 696e 7465 7269  , end and interi
-00031c90: 6f72 2070 6f69 6e74 7320 206f 6620 616e  or points  of an
-00031ca0: 2061 7263 206d 7573 7420 6265 2064 6973   arc must be dis
-00031cb0: 7469 6e63 7473 2729 0a0a 2020 2020 2020  tincts')..      
-00031cc0: 2020 7261 6469 7573 203d 2028 6365 6e74    radius = (cent
-00031cd0: 6572 202d 2070 6f69 6e74 3129 2e6e 6f72  er - point1).nor
-00031ce0: 6d28 290a 2020 2020 2020 2020 7265 7475  m().        retu
-00031cf0: 726e 2063 6c73 2866 7261 6d65 3d76 6f6c  rn cls(frame=vol
-00031d00: 6d64 6c72 2e46 7261 6d65 3344 2863 656e  mdlr.Frame3D(cen
-00031d10: 7465 722c 2075 312c 206e 6f72 6d61 6c2e  ter, u1, normal.
-00031d20: 6372 6f73 7328 7531 292c 206e 6f72 6d61  cross(u1), norma
-00031d30: 6c29 2c0a 2020 2020 2020 2020 2020 2020  l),.            
-00031d40: 2020 2020 2020 2072 6164 6975 733d 7261         radius=ra
-00031d50: 6469 7573 290a 0a20 2020 2064 6566 2065  dius)..    def e
-00031d60: 7874 7275 7369 6f6e 2873 656c 662c 2065  xtrusion(self, e
-00031d70: 7874 7275 7369 6f6e 5f76 6563 746f 7229  xtrusion_vector)
-00031d80: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00031d90: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
-00031da0: 6520 6379 6c69 6e64 7269 6361 6c20 6661  e cylindrical fa
-00031db0: 6365 2067 656e 6572 6174 6564 2062 7920  ce generated by 
-00031dc0: 6578 7472 7573 696f 6e20 6f66 2074 6865  extrusion of the
-00031dd0: 2063 6972 636c 652e 0a20 2020 2020 2020   circle..       
-00031de0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-00031df0: 7365 6c66 2e6e 6f72 6d61 6c2e 6973 5f63  self.normal.is_c
-00031e00: 6f6c 696e 6561 725f 746f 2865 7874 7275  olinear_to(extru
-00031e10: 7369 6f6e 5f76 6563 746f 7229 3a0a 2020  sion_vector):.  
-00031e20: 2020 2020 2020 2020 2020 7520 3d20 7365            u = se
-00031e30: 6c66 2e6e 6f72 6d61 6c2e 6465 7465 726d  lf.normal.determ
-00031e40: 696e 6973 7469 635f 756e 6974 5f6e 6f72  inistic_unit_nor
-00031e50: 6d61 6c5f 7665 6374 6f72 2829 0a20 2020  mal_vector().   
-00031e60: 2020 2020 2020 2020 2076 203d 2073 656c           v = sel
-00031e70: 662e 6e6f 726d 616c 2e63 726f 7373 2875  f.normal.cross(u
-00031e80: 290a 2020 2020 2020 2020 2020 2020 7720  ).            w 
-00031e90: 3d20 6578 7472 7573 696f 6e5f 7665 6374  = extrusion_vect
-00031ea0: 6f72 2e63 6f70 7928 290a 2020 2020 2020  or.copy().      
-00031eb0: 2020 2020 2020 772e 6e6f 726d 616c 697a        w.normaliz
-00031ec0: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-00031ed0: 6379 6c69 6e64 6572 203d 2076 6f6c 6d64  cylinder = volmd
-00031ee0: 6c72 2e66 6163 6573 2e43 796c 696e 6472  lr.faces.Cylindr
-00031ef0: 6963 616c 5375 7266 6163 6533 4428 0a20  icalSurface3D(. 
-00031f00: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00031f10: 6f6c 6d64 6c72 2e46 7261 6d65 3344 2873  olmdlr.Frame3D(s
-00031f20: 656c 662e 6365 6e74 6572 2c20 752c 2076  elf.center, u, v
-00031f30: 2c20 7729 2c20 7365 6c66 2e72 6164 6975  , w), self.radiu
-00031f40: 7329 0a20 2020 2020 2020 2020 2020 2072  s).            r
-00031f50: 6574 7572 6e20 5b63 796c 696e 6465 722e  eturn [cylinder.
-00031f60: 7265 6374 616e 6775 6c61 725f 6375 7428  rectangular_cut(
-00031f70: 302c 2076 6f6c 6d64 6c72 2e54 574f 5f50  0, volmdlr.TWO_P
-00031f80: 492c 0a20 2020 2020 2020 2020 2020 2020  I,.             
-00031f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031fb0: 302c 2065 7874 7275 7369 6f6e 5f76 6563  0, extrusion_vec
-00031fc0: 746f 722e 6e6f 726d 2829 295d 0a20 2020  tor.norm())].   
-00031fd0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00031fe0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-00031ff0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-00032000: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00032010: 2020 2745 7874 7275 7369 6f6e 2061 6c6f    'Extrusion alo
-00032020: 6e67 2076 6563 746f 7220 6e6f 7420 636f  ng vector not co
-00032030: 6c69 6e61 7220 746f 206e 6f72 6d61 6c20  linar to normal 
-00032040: 666f 7220 6369 7263 6c65 206e 6f74 2068  for circle not h
-00032050: 616e 646c 6564 2079 6574 3a20 646f 743d  andled yet: dot=
-00032060: 7b7d 272e 666f 726d 6174 280a 2020 2020  {}'.format(.    
-00032070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032080: 7365 6c66 2e6e 6f72 6d61 6c2e 646f 7428  self.normal.dot(
-00032090: 6578 7472 7573 696f 6e5f 7665 6374 6f72  extrusion_vector
-000320a0: 2929 290a 0a20 2020 2064 6566 2072 6576  )))..    def rev
-000320b0: 6f6c 7574 696f 6e28 7365 6c66 2c20 6178  olution(self, ax
-000320c0: 6973 5f70 6f69 6e74 3a20 766f 6c6d 646c  is_point: volmdl
-000320d0: 722e 506f 696e 7433 442c 2061 7869 733a  r.Point3D, axis:
-000320e0: 2076 6f6c 6d64 6c72 2e56 6563 746f 7233   volmdlr.Vector3
-000320f0: 442c 0a20 2020 2020 2020 2020 2020 2020  D,.             
-00032100: 2020 2020 2020 616e 676c 653a 2066 6c6f        angle: flo
-00032110: 6174 293a 0a20 2020 2020 2020 2022 2222  at):.        """
-00032120: 0a20 2020 2020 2020 2052 6574 7572 6e20  .        Return 
-00032130: 7468 6520 546f 726f 6964 616c 2066 6163  the Toroidal fac
-00032140: 6520 6765 6e65 7261 7465 6420 6279 2074  e generated by t
-00032150: 6865 2072 6576 6f6c 7574 696f 6e20 6f66  he revolution of
-00032160: 2074 6865 2063 6972 636c 652e 0a20 2020   the circle..   
-00032170: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00032180: 206c 696e 6533 6420 3d20 766f 6c6d 646c   line3d = volmdl
-00032190: 722e 6564 6765 732e 4c69 6e65 3344 2861  r.edges.Line3D(a
-000321a0: 7869 735f 706f 696e 742c 2061 7869 735f  xis_point, axis_
-000321b0: 706f 696e 7420 2b20 6178 6973 290a 2020  point + axis).  
-000321c0: 2020 2020 2020 746f 7265 5f63 656e 7465        tore_cente
-000321d0: 722c 205f 203d 206c 696e 6533 642e 706f  r, _ = line3d.po
-000321e0: 696e 745f 7072 6f6a 6563 7469 6f6e 2873  int_projection(s
-000321f0: 656c 662e 6365 6e74 6572 290a 2020 2020  elf.center).    
-00032200: 2020 2020 7520 3d20 7365 6c66 2e63 656e      u = self.cen
-00032210: 7465 7220 2d20 746f 7265 5f63 656e 7465  ter - tore_cente
-00032220: 720a 2020 2020 2020 2020 752e 6e6f 726d  r.        u.norm
-00032230: 616c 697a 6528 290a 2020 2020 2020 2020  alize().        
-00032240: 7620 3d20 6178 6973 2e63 726f 7373 2875  v = axis.cross(u
-00032250: 290a 2020 2020 2020 2020 6966 206e 6f74  ).        if not
-00032260: 206d 6174 682e 6973 636c 6f73 6528 7365   math.isclose(se
-00032270: 6c66 2e6e 6f72 6d61 6c2e 646f 7428 7529  lf.normal.dot(u)
-00032280: 2c20 302e 2c20 6162 735f 746f 6c3d 3165  , 0., abs_tol=1e
-00032290: 2d39 293a 0a20 2020 2020 2020 2020 2020  -9):.           
-000322a0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-000322b0: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
-000322c0: 2020 2020 2020 2020 2020 2020 274f 7574              'Out
-000322d0: 7369 6465 206f 6620 706c 616e 6520 7265  side of plane re
-000322e0: 766f 6c75 7469 6f6e 206e 6f74 2073 7570  volution not sup
-000322f0: 706f 7274 6564 2729 0a0a 2020 2020 2020  ported')..      
-00032300: 2020 5220 3d20 746f 7265 5f63 656e 7465    R = tore_cente
-00032310: 722e 706f 696e 745f 6469 7374 616e 6365  r.point_distance
-00032320: 2873 656c 662e 6365 6e74 6572 290a 2020  (self.center).  
-00032330: 2020 2020 2020 7375 7266 6163 6520 3d20        surface = 
-00032340: 766f 6c6d 646c 722e 6661 6365 732e 546f  volmdlr.faces.To
-00032350: 726f 6964 616c 5375 7266 6163 6533 4428  roidalSurface3D(
-00032360: 0a20 2020 2020 2020 2020 2020 2076 6f6c  .            vol
-00032370: 6d64 6c72 2e46 7261 6d65 3344 2874 6f72  mdlr.Frame3D(tor
-00032380: 655f 6365 6e74 6572 2c20 752c 2076 2c20  e_center, u, v, 
-00032390: 6178 6973 292c 0a20 2020 2020 2020 2020  axis),.         
-000323a0: 2020 2052 2c20 7365 6c66 2e72 6164 6975     R, self.radiu
-000323b0: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
-000323c0: 6e20 5b73 7572 6661 6365 2e72 6563 7461  n [surface.recta
-000323d0: 6e67 756c 6172 5f63 7574 2830 2c20 616e  ngular_cut(0, an
-000323e0: 676c 652c 2030 2c20 766f 6c6d 646c 722e  gle, 0, volmdlr.
-000323f0: 5457 4f5f 5049 295d 0a0a 2020 2020 6465  TWO_PI)]..    de
-00032400: 6620 706f 696e 745f 6265 6c6f 6e67 7328  f point_belongs(
-00032410: 7365 6c66 2c20 706f 696e 743a 2076 6f6c  self, point: vol
-00032420: 6d64 6c72 2e50 6f69 6e74 3344 2c20 6162  mdlr.Point3D, ab
-00032430: 735f 746f 6c3a 2066 6c6f 6174 203d 2031  s_tol: float = 1
-00032440: 652d 3629 3a0a 2020 2020 2020 2020 2222  e-6):.        ""
-00032450: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-00032460: 7320 6966 2067 6976 656e 2070 6f69 6e74  s if given point
-00032470: 2062 656c 6f6e 6773 2074 6f20 7468 6520   belongs to the 
-00032480: 4369 7263 6c65 3344 2e0a 2020 2020 2020  Circle3D..      
-00032490: 2020 2222 220a 2020 2020 2020 2020 6469    """.        di
-000324a0: 7374 616e 6365 203d 2070 6f69 6e74 2e70  stance = point.p
-000324b0: 6f69 6e74 5f64 6973 7461 6e63 6528 7365  oint_distance(se
-000324c0: 6c66 2e63 656e 7465 7229 0a20 2020 2020  lf.center).     
-000324d0: 2020 2076 6563 203d 2076 6f6c 6d64 6c72     vec = volmdlr
-000324e0: 2e56 6563 746f 7233 4428 2a70 6f69 6e74  .Vector3D(*point
-000324f0: 202d 2073 656c 662e 6365 6e74 6572 290a   - self.center).
-00032500: 2020 2020 2020 2020 646f 7420 3d20 7365          dot = se
-00032510: 6c66 2e6e 6f72 6d61 6c2e 646f 7428 7665  lf.normal.dot(ve
-00032520: 6329 0a20 2020 2020 2020 2069 6620 6d61  c).        if ma
-00032530: 7468 2e69 7363 6c6f 7365 2864 6973 7461  th.isclose(dista
-00032540: 6e63 652c 2073 656c 662e 7261 6469 7573  nce, self.radius
-00032550: 2c20 6162 735f 746f 6c3d 6162 735f 746f  , abs_tol=abs_to
-00032560: 6c29 205c 0a20 2020 2020 2020 2020 2020  l) \.           
-00032570: 2020 2020 2061 6e64 206d 6174 682e 6973       and math.is
-00032580: 636c 6f73 6528 646f 742c 2030 2c20 6162  close(dot, 0, ab
-00032590: 735f 746f 6c3d 6162 735f 746f 6c29 3a0a  s_tol=abs_tol):.
-000325a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000325b0: 726e 2054 7275 650a 2020 2020 2020 2020  rn True.        
-000325c0: 7265 7475 726e 2046 616c 7365 0a0a 2020  return False..  
-000325d0: 2020 6465 6620 7472 696d 2873 656c 662c    def trim(self,
-000325e0: 2070 6f69 6e74 313a 2076 6f6c 6d64 6c72   point1: volmdlr
-000325f0: 2e50 6f69 6e74 3344 2c20 706f 696e 7432  .Point3D, point2
-00032600: 3a20 766f 6c6d 646c 722e 506f 696e 7433  : volmdlr.Point3
-00032610: 4429 3a0a 2020 2020 2020 2020 6966 206e  D):.        if n
+00031800: 2020 2020 2020 2020 2020 6e61 6d65 3a20            name: 
+00031810: 7374 7220 3d20 2727 293a 0a20 2020 2020  str = ''):.     
+00031820: 2020 2075 203d 206e 6f72 6d61 6c2e 6465     u = normal.de
+00031830: 7465 726d 696e 6973 7469 635f 756e 6974  terministic_unit
+00031840: 5f6e 6f72 6d61 6c5f 7665 6374 6f72 2829  _normal_vector()
+00031850: 0a20 2020 2020 2020 2076 203d 206e 6f72  .        v = nor
+00031860: 6d61 6c2e 6372 6f73 7328 7529 0a20 2020  mal.cross(u).   
+00031870: 2020 2020 2072 6574 7572 6e20 636c 7328       return cls(
+00031880: 766f 6c6d 646c 722e 4672 616d 6533 4428  volmdlr.Frame3D(
+00031890: 6365 6e74 6572 2c20 752c 2076 2c20 6e6f  center, u, v, no
+000318a0: 726d 616c 292c 2072 6164 6975 732c 206e  rmal), radius, n
+000318b0: 616d 6529 0a0a 2020 2020 4063 6c61 7373  ame)..    @class
+000318c0: 6d65 7468 6f64 0a20 2020 2064 6566 2066  method.    def f
+000318d0: 726f 6d5f 335f 706f 696e 7473 2863 6c73  rom_3_points(cls
+000318e0: 2c20 706f 696e 7431 2c20 706f 696e 7432  , point1, point2
+000318f0: 2c20 706f 696e 7433 293a 0a20 2020 2020  , point3):.     
+00031900: 2020 2075 3120 3d20 706f 696e 7432 202d     u1 = point2 -
+00031910: 2070 6f69 6e74 310a 2020 2020 2020 2020   point1.        
+00031920: 7532 203d 2070 6f69 6e74 3220 2d20 706f  u2 = point2 - po
+00031930: 696e 7433 0a20 2020 2020 2020 2074 7279  int3.        try
+00031940: 3a0a 2020 2020 2020 2020 2020 2020 7531  :.            u1
+00031950: 2e6e 6f72 6d61 6c69 7a65 2829 0a20 2020  .normalize().   
+00031960: 2020 2020 2020 2020 2075 322e 6e6f 726d           u2.norm
+00031970: 616c 697a 6528 290a 2020 2020 2020 2020  alize().        
+00031980: 6578 6365 7074 205a 6572 6f44 6976 6973  except ZeroDivis
+00031990: 696f 6e45 7272 6f72 3a0a 2020 2020 2020  ionError:.      
+000319a0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+000319b0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+000319c0: 2020 2020 2020 2020 2774 6865 2033 2070          'the 3 p
+000319d0: 6f69 6e74 7320 6d75 7374 2062 6520 6469  oints must be di
+000319e0: 7374 696e 6374 7327 290a 0a20 2020 2020  stincts')..     
+000319f0: 2020 206e 6f72 6d61 6c20 3d20 7532 2e63     normal = u2.c
+00031a00: 726f 7373 2875 3129 0a20 2020 2020 2020  ross(u1).       
+00031a10: 206e 6f72 6d61 6c2e 6e6f 726d 616c 697a   normal.normaliz
+00031a20: 6528 290a 0a20 2020 2020 2020 2069 6620  e()..        if 
+00031a30: 7531 203d 3d20 7532 3a0a 2020 2020 2020  u1 == u2:.      
+00031a40: 2020 2020 2020 7532 203d 206e 6f72 6d61        u2 = norma
+00031a50: 6c2e 6372 6f73 7328 7531 290a 2020 2020  l.cross(u1).    
+00031a60: 2020 2020 2020 2020 7532 2e6e 6f72 6d61          u2.norma
+00031a70: 6c69 7a65 2829 0a0a 2020 2020 2020 2020  lize()..        
+00031a80: 7631 203d 206e 6f72 6d61 6c2e 6372 6f73  v1 = normal.cros
+00031a90: 7328 7531 2920 2023 2076 3120 6973 206e  s(u1)  # v1 is n
+00031aa0: 6f72 6d61 6c2c 2065 7175 616c 2075 320a  ormal, equal u2.
+00031ab0: 2020 2020 2020 2020 7632 203d 206e 6f72          v2 = nor
+00031ac0: 6d61 6c2e 6372 6f73 7328 7532 2920 2023  mal.cross(u2)  #
+00031ad0: 2065 7175 616c 202d 7531 0a0a 2020 2020   equal -u1..    
+00031ae0: 2020 2020 7031 3120 3d20 302e 3520 2a20      p11 = 0.5 * 
+00031af0: 2870 6f69 6e74 3120 2b20 706f 696e 7432  (point1 + point2
+00031b00: 2920 2023 204d 6964 2070 6f69 6e74 206f  )  # Mid point o
+00031b10: 6620 7365 676d 656e 7420 732c 6d0a 2020  f segment s,m.  
+00031b20: 2020 2020 2020 7032 3120 3d20 302e 3520        p21 = 0.5 
+00031b30: 2a20 2870 6f69 6e74 3220 2b20 706f 696e  * (point2 + poin
+00031b40: 7433 2920 2023 204d 6964 2070 6f69 6e74  t3)  # Mid point
+00031b50: 206f 6620 7365 676d 656e 7420 732c 6d0a   of segment s,m.
+00031b60: 0a20 2020 2020 2020 206c 3120 3d20 766f  .        l1 = vo
+00031b70: 6c6d 646c 722e 6564 6765 732e 4c69 6e65  lmdlr.edges.Line
+00031b80: 3344 2870 3131 2c20 7031 3120 2b20 7631  3D(p11, p11 + v1
+00031b90: 290a 2020 2020 2020 2020 6c32 203d 2076  ).        l2 = v
+00031ba0: 6f6c 6d64 6c72 2e65 6467 6573 2e4c 696e  olmdlr.edges.Lin
+00031bb0: 6533 4428 7032 312c 2070 3231 202b 2076  e3D(p21, p21 + v
+00031bc0: 3229 0a0a 2020 2020 2020 2020 7472 793a  2)..        try:
+00031bd0: 0a20 2020 2020 2020 2020 2020 2063 656e  .            cen
+00031be0: 7465 722c 205f 203d 206c 312e 6d69 6e69  ter, _ = l1.mini
+00031bf0: 6d75 6d5f 6469 7374 616e 6365 5f70 6f69  mum_distance_poi
+00031c00: 6e74 7328 6c32 290a 2020 2020 2020 2020  nts(l2).        
+00031c10: 6578 6365 7074 205a 6572 6f44 6976 6973  except ZeroDivis
+00031c20: 696f 6e45 7272 6f72 3a0a 2020 2020 2020  ionError:.      
+00031c30: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00031c40: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00031c50: 2020 2020 2020 2020 2753 7461 7274 2c20          'Start, 
+00031c60: 656e 6420 616e 6420 696e 7465 7269 6f72  end and interior
+00031c70: 2070 6f69 6e74 7320 206f 6620 616e 2061   points  of an a
+00031c80: 7263 206d 7573 7420 6265 2064 6973 7469  rc must be disti
+00031c90: 6e63 7473 2729 0a0a 2020 2020 2020 2020  ncts')..        
+00031ca0: 7261 6469 7573 203d 2028 6365 6e74 6572  radius = (center
+00031cb0: 202d 2070 6f69 6e74 3129 2e6e 6f72 6d28   - point1).norm(
+00031cc0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00031cd0: 2063 6c73 2866 7261 6d65 3d76 6f6c 6d64   cls(frame=volmd
+00031ce0: 6c72 2e46 7261 6d65 3344 2863 656e 7465  lr.Frame3D(cente
+00031cf0: 722c 2075 312c 206e 6f72 6d61 6c2e 6372  r, u1, normal.cr
+00031d00: 6f73 7328 7531 292c 206e 6f72 6d61 6c29  oss(u1), normal)
+00031d10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00031d20: 2020 2020 2072 6164 6975 733d 7261 6469       radius=radi
+00031d30: 7573 290a 0a20 2020 2064 6566 2065 7874  us)..    def ext
+00031d40: 7275 7369 6f6e 2873 656c 662c 2065 7874  rusion(self, ext
+00031d50: 7275 7369 6f6e 5f76 6563 746f 7229 3a0a  rusion_vector):.
+00031d60: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00031d70: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
+00031d80: 6379 6c69 6e64 7269 6361 6c20 6661 6365  cylindrical face
+00031d90: 2067 656e 6572 6174 6564 2062 7920 6578   generated by ex
+00031da0: 7472 7573 696f 6e20 6f66 2074 6865 2063  trusion of the c
+00031db0: 6972 636c 652e 0a20 2020 2020 2020 2022  ircle..        "
+00031dc0: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
+00031dd0: 6c66 2e6e 6f72 6d61 6c2e 6973 5f63 6f6c  lf.normal.is_col
+00031de0: 696e 6561 725f 746f 2865 7874 7275 7369  inear_to(extrusi
+00031df0: 6f6e 5f76 6563 746f 7229 3a0a 2020 2020  on_vector):.    
+00031e00: 2020 2020 2020 2020 7520 3d20 7365 6c66          u = self
+00031e10: 2e6e 6f72 6d61 6c2e 6465 7465 726d 696e  .normal.determin
+00031e20: 6973 7469 635f 756e 6974 5f6e 6f72 6d61  istic_unit_norma
+00031e30: 6c5f 7665 6374 6f72 2829 0a20 2020 2020  l_vector().     
+00031e40: 2020 2020 2020 2076 203d 2073 656c 662e         v = self.
+00031e50: 6e6f 726d 616c 2e63 726f 7373 2875 290a  normal.cross(u).
+00031e60: 2020 2020 2020 2020 2020 2020 7720 3d20              w = 
+00031e70: 6578 7472 7573 696f 6e5f 7665 6374 6f72  extrusion_vector
+00031e80: 2e63 6f70 7928 290a 2020 2020 2020 2020  .copy().        
+00031e90: 2020 2020 772e 6e6f 726d 616c 697a 6528      w.normalize(
+00031ea0: 290a 2020 2020 2020 2020 2020 2020 6379  ).            cy
+00031eb0: 6c69 6e64 6572 203d 2076 6f6c 6d64 6c72  linder = volmdlr
+00031ec0: 2e66 6163 6573 2e43 796c 696e 6472 6963  .faces.Cylindric
+00031ed0: 616c 5375 7266 6163 6533 4428 0a20 2020  alSurface3D(.   
+00031ee0: 2020 2020 2020 2020 2020 2020 2076 6f6c               vol
+00031ef0: 6d64 6c72 2e46 7261 6d65 3344 2873 656c  mdlr.Frame3D(sel
+00031f00: 662e 6365 6e74 6572 2c20 752c 2076 2c20  f.center, u, v, 
+00031f10: 7729 2c20 7365 6c66 2e72 6164 6975 7329  w), self.radius)
+00031f20: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00031f30: 7572 6e20 5b63 796c 696e 6465 722e 7265  urn [cylinder.re
+00031f40: 6374 616e 6775 6c61 725f 6375 7428 302c  ctangular_cut(0,
+00031f50: 2076 6f6c 6d64 6c72 2e54 574f 5f50 492c   volmdlr.TWO_PI,
+00031f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031f80: 2020 2020 2020 2020 2020 2020 2020 302c                0,
+00031f90: 2065 7874 7275 7369 6f6e 5f76 6563 746f   extrusion_vecto
+00031fa0: 722e 6e6f 726d 2829 295d 0a20 2020 2020  r.norm())].     
+00031fb0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00031fc0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00031fd0: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
+00031fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ff0: 2745 7874 7275 7369 6f6e 2061 6c6f 6e67  'Extrusion along
+00032000: 2076 6563 746f 7220 6e6f 7420 636f 6c69   vector not coli
+00032010: 6e61 7220 746f 206e 6f72 6d61 6c20 666f  nar to normal fo
+00032020: 7220 6369 7263 6c65 206e 6f74 2068 616e  r circle not han
+00032030: 646c 6564 2079 6574 3a20 646f 743d 7b7d  dled yet: dot={}
+00032040: 272e 666f 726d 6174 280a 2020 2020 2020  '.format(.      
+00032050: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00032060: 6c66 2e6e 6f72 6d61 6c2e 646f 7428 6578  lf.normal.dot(ex
+00032070: 7472 7573 696f 6e5f 7665 6374 6f72 2929  trusion_vector))
+00032080: 290a 0a20 2020 2064 6566 2072 6576 6f6c  )..    def revol
+00032090: 7574 696f 6e28 7365 6c66 2c20 6178 6973  ution(self, axis
+000320a0: 5f70 6f69 6e74 3a20 766f 6c6d 646c 722e  _point: volmdlr.
+000320b0: 506f 696e 7433 442c 2061 7869 733a 2076  Point3D, axis: v
+000320c0: 6f6c 6d64 6c72 2e56 6563 746f 7233 442c  olmdlr.Vector3D,
+000320d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000320e0: 2020 2020 616e 676c 653a 2066 6c6f 6174      angle: float
+000320f0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00032100: 2020 2020 2020 2052 6574 7572 6e20 7468         Return th
+00032110: 6520 546f 726f 6964 616c 2066 6163 6520  e Toroidal face 
+00032120: 6765 6e65 7261 7465 6420 6279 2074 6865  generated by the
+00032130: 2072 6576 6f6c 7574 696f 6e20 6f66 2074   revolution of t
+00032140: 6865 2063 6972 636c 652e 0a20 2020 2020  he circle..     
+00032150: 2020 2022 2222 0a20 2020 2020 2020 206c     """.        l
+00032160: 696e 6533 6420 3d20 766f 6c6d 646c 722e  ine3d = volmdlr.
+00032170: 6564 6765 732e 4c69 6e65 3344 2861 7869  edges.Line3D(axi
+00032180: 735f 706f 696e 742c 2061 7869 735f 706f  s_point, axis_po
+00032190: 696e 7420 2b20 6178 6973 290a 2020 2020  int + axis).    
+000321a0: 2020 2020 746f 7265 5f63 656e 7465 722c      tore_center,
+000321b0: 205f 203d 206c 696e 6533 642e 706f 696e   _ = line3d.poin
+000321c0: 745f 7072 6f6a 6563 7469 6f6e 2873 656c  t_projection(sel
+000321d0: 662e 6365 6e74 6572 290a 2020 2020 2020  f.center).      
+000321e0: 2020 7520 3d20 7365 6c66 2e63 656e 7465    u = self.cente
+000321f0: 7220 2d20 746f 7265 5f63 656e 7465 720a  r - tore_center.
+00032200: 2020 2020 2020 2020 752e 6e6f 726d 616c          u.normal
+00032210: 697a 6528 290a 2020 2020 2020 2020 7620  ize().        v 
+00032220: 3d20 6178 6973 2e63 726f 7373 2875 290a  = axis.cross(u).
+00032230: 2020 2020 2020 2020 6966 206e 6f74 206d          if not m
+00032240: 6174 682e 6973 636c 6f73 6528 7365 6c66  ath.isclose(self
+00032250: 2e6e 6f72 6d61 6c2e 646f 7428 7529 2c20  .normal.dot(u), 
+00032260: 302e 2c20 6162 735f 746f 6c3d 3165 2d39  0., abs_tol=1e-9
+00032270: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00032280: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+00032290: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+000322a0: 2020 2020 2020 2020 2020 274f 7574 7369            'Outsi
+000322b0: 6465 206f 6620 706c 616e 6520 7265 766f  de of plane revo
+000322c0: 6c75 7469 6f6e 206e 6f74 2073 7570 706f  lution not suppo
+000322d0: 7274 6564 2729 0a0a 2020 2020 2020 2020  rted')..        
+000322e0: 5220 3d20 746f 7265 5f63 656e 7465 722e  R = tore_center.
+000322f0: 706f 696e 745f 6469 7374 616e 6365 2873  point_distance(s
+00032300: 656c 662e 6365 6e74 6572 290a 2020 2020  elf.center).    
+00032310: 2020 2020 7375 7266 6163 6520 3d20 766f      surface = vo
+00032320: 6c6d 646c 722e 6661 6365 732e 546f 726f  lmdlr.faces.Toro
+00032330: 6964 616c 5375 7266 6163 6533 4428 0a20  idalSurface3D(. 
+00032340: 2020 2020 2020 2020 2020 2076 6f6c 6d64             volmd
+00032350: 6c72 2e46 7261 6d65 3344 2874 6f72 655f  lr.Frame3D(tore_
+00032360: 6365 6e74 6572 2c20 752c 2076 2c20 6178  center, u, v, ax
+00032370: 6973 292c 0a20 2020 2020 2020 2020 2020  is),.           
+00032380: 2052 2c20 7365 6c66 2e72 6164 6975 7329   R, self.radius)
+00032390: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000323a0: 5b73 7572 6661 6365 2e72 6563 7461 6e67  [surface.rectang
+000323b0: 756c 6172 5f63 7574 2830 2c20 616e 676c  ular_cut(0, angl
+000323c0: 652c 2030 2c20 766f 6c6d 646c 722e 5457  e, 0, volmdlr.TW
+000323d0: 4f5f 5049 295d 0a0a 2020 2020 6465 6620  O_PI)]..    def 
+000323e0: 706f 696e 745f 6265 6c6f 6e67 7328 7365  point_belongs(se
+000323f0: 6c66 2c20 706f 696e 743a 2076 6f6c 6d64  lf, point: volmd
+00032400: 6c72 2e50 6f69 6e74 3344 2c20 6162 735f  lr.Point3D, abs_
+00032410: 746f 6c3a 2066 6c6f 6174 203d 2031 652d  tol: float = 1e-
+00032420: 3629 3a0a 2020 2020 2020 2020 2222 220a  6):.        """.
+00032430: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+00032440: 6966 2067 6976 656e 2070 6f69 6e74 2062  if given point b
+00032450: 656c 6f6e 6773 2074 6f20 7468 6520 4369  elongs to the Ci
+00032460: 7263 6c65 3344 2e0a 2020 2020 2020 2020  rcle3D..        
+00032470: 2222 220a 2020 2020 2020 2020 6469 7374  """.        dist
+00032480: 616e 6365 203d 2070 6f69 6e74 2e70 6f69  ance = point.poi
+00032490: 6e74 5f64 6973 7461 6e63 6528 7365 6c66  nt_distance(self
+000324a0: 2e63 656e 7465 7229 0a20 2020 2020 2020  .center).       
+000324b0: 2076 6563 203d 2076 6f6c 6d64 6c72 2e56   vec = volmdlr.V
+000324c0: 6563 746f 7233 4428 2a70 6f69 6e74 202d  ector3D(*point -
+000324d0: 2073 656c 662e 6365 6e74 6572 290a 2020   self.center).  
+000324e0: 2020 2020 2020 646f 7420 3d20 7365 6c66        dot = self
+000324f0: 2e6e 6f72 6d61 6c2e 646f 7428 7665 6329  .normal.dot(vec)
+00032500: 0a20 2020 2020 2020 2069 6620 6d61 7468  .        if math
+00032510: 2e69 7363 6c6f 7365 2864 6973 7461 6e63  .isclose(distanc
+00032520: 652c 2073 656c 662e 7261 6469 7573 2c20  e, self.radius, 
+00032530: 6162 735f 746f 6c3d 6162 735f 746f 6c29  abs_tol=abs_tol)
+00032540: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+00032550: 2020 2061 6e64 206d 6174 682e 6973 636c     and math.iscl
+00032560: 6f73 6528 646f 742c 2030 2c20 6162 735f  ose(dot, 0, abs_
+00032570: 746f 6c3d 6162 735f 746f 6c29 3a0a 2020  tol=abs_tol):.  
+00032580: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00032590: 2054 7275 650a 2020 2020 2020 2020 7265   True.        re
+000325a0: 7475 726e 2046 616c 7365 0a0a 2020 2020  turn False..    
+000325b0: 6465 6620 7472 696d 2873 656c 662c 2070  def trim(self, p
+000325c0: 6f69 6e74 313a 2076 6f6c 6d64 6c72 2e50  oint1: volmdlr.P
+000325d0: 6f69 6e74 3344 2c20 706f 696e 7432 3a20  oint3D, point2: 
+000325e0: 766f 6c6d 646c 722e 506f 696e 7433 4429  volmdlr.Point3D)
+000325f0: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
+00032600: 2073 656c 662e 706f 696e 745f 6265 6c6f   self.point_belo
+00032610: 6e67 7328 706f 696e 7431 2920 6f72 206e  ngs(point1) or n
 00032620: 6f74 2073 656c 662e 706f 696e 745f 6265  ot self.point_be
-00032630: 6c6f 6e67 7328 706f 696e 7431 2920 6f72  longs(point1) or
-00032640: 206e 6f74 2073 656c 662e 706f 696e 745f   not self.point_
-00032650: 6265 6c6f 6e67 7328 706f 696e 7432 293a  belongs(point2):
-00032660: 0a20 2020 2020 2020 2020 2020 2061 7820  .            ax 
-00032670: 3d20 7365 6c66 2e70 6c6f 7428 290a 2020  = self.plot().  
-00032680: 2020 2020 2020 2020 2020 706f 696e 7431            point1
-00032690: 2e70 6c6f 7428 6178 3d61 782c 2063 6f6c  .plot(ax=ax, col
-000326a0: 6f72 3d27 7227 290a 2020 2020 2020 2020  or='r').        
-000326b0: 2020 2020 706f 696e 7432 2e70 6c6f 7428      point2.plot(
-000326c0: 6178 3d61 782c 2063 6f6c 6f72 3d27 6227  ax=ax, color='b'
-000326d0: 290a 2020 2020 2020 2020 2020 2020 7261  ).            ra
-000326e0: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
-000326f0: 506f 696e 7420 6e6f 7420 6f6e 2063 6972  Point not on cir
-00032700: 636c 6520 666f 7220 7472 696d 206d 6574  cle for trim met
-00032710: 686f 6427 290a 2020 2020 2020 2020 6966  hod').        if
-00032720: 2070 6f69 6e74 3120 3d3d 2070 6f69 6e74   point1 == point
-00032730: 323a 0a20 2020 2020 2020 2020 2020 2072  2:.            r
-00032740: 6574 7572 6e20 766f 6c6d 646c 722e 6564  eturn volmdlr.ed
-00032750: 6765 732e 4675 6c6c 4172 6333 4428 7365  ges.FullArc3D(se
-00032760: 6c66 2e66 7261 6d65 2e6f 7269 6769 6e2c  lf.frame.origin,
-00032770: 2070 6f69 6e74 312c 0a20 2020 2020 2020   point1,.       
-00032780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000327a0: 2020 2020 7365 6c66 2e66 7261 6d65 2e77      self.frame.w
-000327b0: 290a 2020 2020 2020 2020 696e 7465 7269  ).        interi
-000327c0: 6f72 203d 2076 6f6c 6d64 6c72 2e67 656f  or = volmdlr.geo
-000327d0: 6d65 7472 792e 636c 6f63 6b77 6973 655f  metry.clockwise_
-000327e0: 696e 7465 7269 6f72 5f66 726f 6d5f 6369  interior_from_ci
-000327f0: 7263 6c65 3364 280a 2020 2020 2020 2020  rcle3d(.        
-00032800: 2020 2020 706f 696e 7431 2c20 706f 696e      point1, poin
-00032810: 7432 2c20 7365 6c66 290a 2020 2020 2020  t2, self).      
-00032820: 2020 7265 7475 726e 2076 6f6c 6d64 6c72    return volmdlr
-00032830: 2e65 6467 6573 2e41 7263 3344 2870 6f69  .edges.Arc3D(poi
-00032840: 6e74 312c 2069 6e74 6572 696f 722c 2070  nt1, interior, p
-00032850: 6f69 6e74 3229 0a0a 0a63 6c61 7373 2045  oint2)...class E
-00032860: 6c6c 6970 7365 3344 2843 6f6e 746f 7572  llipse3D(Contour
-00032870: 3344 293a 0a20 2020 2022 2222 0a20 2020  3D):.    """.   
-00032880: 2044 6566 696e 6573 2061 2033 4420 656c   Defines a 3D el
-00032890: 6c69 7073 652e 0a0a 2020 2020 3a70 6172  lipse...    :par
-000328a0: 616d 206d 616a 6f72 5f61 7869 733a 204c  am major_axis: L
-000328b0: 6172 6765 7374 2072 6164 6975 7320 6f66  argest radius of
-000328c0: 2074 6865 2065 6c6c 6970 7365 0a20 2020   the ellipse.   
-000328d0: 203a 7479 7065 206d 616a 6f72 5f61 7869   :type major_axi
-000328e0: 733a 2066 6c6f 6174 0a20 2020 203a 7061  s: float.    :pa
-000328f0: 7261 6d20 6d69 6e6f 725f 6178 6973 3a20  ram minor_axis: 
-00032900: 536d 616c 6c65 7374 2072 6164 6975 7320  Smallest radius 
-00032910: 6f66 2074 6865 2065 6c6c 6970 7365 0a20  of the ellipse. 
-00032920: 2020 203a 7479 7065 206d 696e 6f72 5f61     :type minor_a
-00032930: 7869 733a 2066 6c6f 6174 0a20 2020 203a  xis: float.    :
-00032940: 7061 7261 6d20 6365 6e74 6572 3a20 456c  param center: El
-00032950: 6c69 7073 6527 7320 6365 6e74 6572 0a20  lipse's center. 
-00032960: 2020 203a 7479 7065 2063 656e 7465 723a     :type center:
-00032970: 2050 6f69 6e74 3344 0a20 2020 203a 7061   Point3D.    :pa
-00032980: 7261 6d20 6e6f 726d 616c 3a20 456c 6c69  ram normal: Elli
-00032990: 7073 6527 7320 6e6f 726d 616c 0a20 2020  pse's normal.   
-000329a0: 203a 7479 7065 206e 6f72 6d61 6c3a 2056   :type normal: V
-000329b0: 6563 746f 7233 440a 2020 2020 3a70 6172  ector3D.    :par
-000329c0: 616d 206d 616a 6f72 5f64 6972 3a20 4469  am major_dir: Di
-000329d0: 7265 6374 696f 6e20 6f66 2074 6865 206c  rection of the l
-000329e0: 6172 6765 7374 2072 6164 6975 732f 6d61  argest radius/ma
-000329f0: 6a6f 725f 6178 6973 0a20 2020 203a 7479  jor_axis.    :ty
-00032a00: 7065 206d 616a 6f72 5f64 6972 3a20 5665  pe major_dir: Ve
-00032a10: 6374 6f72 3344 0a20 2020 2022 2222 0a0a  ctor3D.    """..
-00032a20: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00032a30: 2873 656c 662c 206d 616a 6f72 5f61 7869  (self, major_axi
-00032a40: 733a 2066 6c6f 6174 2c20 6d69 6e6f 725f  s: float, minor_
-00032a50: 6178 6973 3a20 666c 6f61 742c 0a20 2020  axis: float,.   
-00032a60: 2020 2020 2020 2020 2020 2020 2020 6365                ce
-00032a70: 6e74 6572 3a20 766f 6c6d 646c 722e 506f  nter: volmdlr.Po
-00032a80: 696e 7433 442c 206e 6f72 6d61 6c3a 2076  int3D, normal: v
-00032a90: 6f6c 6d64 6c72 2e56 6563 746f 7233 442c  olmdlr.Vector3D,
-00032aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032ab0: 2020 6d61 6a6f 725f 6469 723a 2076 6f6c    major_dir: vol
-00032ac0: 6d64 6c72 2e56 6563 746f 7233 442c 206e  mdlr.Vector3D, n
-00032ad0: 616d 653a 2073 7472 203d 2027 2729 3a0a  ame: str = ''):.
-00032ae0: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
-00032af0: 6a6f 725f 6178 6973 203d 206d 616a 6f72  jor_axis = major
-00032b00: 5f61 7869 730a 2020 2020 2020 2020 7365  _axis.        se
-00032b10: 6c66 2e6d 696e 6f72 5f61 7869 7320 3d20  lf.minor_axis = 
-00032b20: 6d69 6e6f 725f 6178 6973 0a20 2020 2020  minor_axis.     
-00032b30: 2020 2073 656c 662e 6365 6e74 6572 203d     self.center =
-00032b40: 2063 656e 7465 720a 2020 2020 2020 2020   center.        
-00032b50: 6e6f 726d 616c 2e6e 6f72 6d61 6c69 7a65  normal.normalize
-00032b60: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
-00032b70: 6e6f 726d 616c 203d 206e 6f72 6d61 6c0a  normal = normal.
-00032b80: 2020 2020 2020 2020 6d61 6a6f 725f 6469          major_di
-00032b90: 722e 6e6f 726d 616c 697a 6528 290a 2020  r.normalize().  
-00032ba0: 2020 2020 2020 7365 6c66 2e6d 616a 6f72        self.major
-00032bb0: 5f64 6972 203d 206d 616a 6f72 5f64 6972  _dir = major_dir
-00032bc0: 0a20 2020 2020 2020 2073 656c 662e 5f66  .        self._f
-00032bd0: 7261 6d65 203d 204e 6f6e 650a 2020 2020  rame = None.    
-00032be0: 2020 2020 436f 6e74 6f75 7233 442e 5f5f      Contour3D.__
-00032bf0: 696e 6974 5f5f 2873 656c 662c 205b 7365  init__(self, [se
-00032c00: 6c66 5d2c 206e 616d 653d 6e61 6d65 290a  lf], name=name).
-00032c10: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00032c20: 2020 2064 6566 2066 7261 6d65 2873 656c     def frame(sel
-00032c30: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-00032c40: 2020 2020 2020 2020 4765 7473 2074 6865          Gets the
-00032c50: 2045 6c6c 6970 7365 2773 2046 7261 6d65   Ellipse's Frame
-00032c60: 3344 2e0a 0a20 2020 2020 2020 203a 7265  3D...        :re
-00032c70: 7475 726e 3a20 4672 616d 6533 442e 0a20  turn: Frame3D.. 
-00032c80: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00032c90: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
-00032ca0: 6672 616d 653a 0a20 2020 2020 2020 2020  frame:.         
-00032cb0: 2020 2073 656c 662e 5f66 7261 6d65 203d     self._frame =
-00032cc0: 2076 6f6c 6d64 6c72 2e46 7261 6d65 3344   volmdlr.Frame3D
-00032cd0: 2873 656c 662e 6365 6e74 6572 2c20 7365  (self.center, se
-00032ce0: 6c66 2e6d 616a 6f72 5f64 6972 2c20 7365  lf.major_dir, se
-00032cf0: 6c66 2e6e 6f72 6d61 6c2e 6372 6f73 7328  lf.normal.cross(
-00032d00: 7365 6c66 2e6d 616a 6f72 5f64 6972 292c  self.major_dir),
-00032d10: 2073 656c 662e 6e6f 726d 616c 290a 2020   self.normal).  
-00032d20: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00032d30: 662e 5f66 7261 6d65 0a0a 2020 2020 6465  f._frame..    de
-00032d40: 6620 706f 696e 745f 6265 6c6f 6e67 7328  f point_belongs(
-00032d50: 7365 6c66 2c20 706f 696e 7429 3a0a 2020  self, point):.  
-00032d60: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00032d70: 2020 5665 7269 6669 6573 2069 6620 6120    Verifies if a 
-00032d80: 6769 7665 6e20 706f 696e 7420 6c69 6573  given point lies
-00032d90: 206f 6e20 7468 6520 456c 6c69 7073 6533   on the Ellipse3
-00032da0: 442e 0a0a 2020 2020 2020 2020 3a70 6172  D...        :par
-00032db0: 616d 2070 6f69 6e74 3a20 706f 696e 7420  am point: point 
-00032dc0: 746f 2062 6520 7665 7269 6669 6564 2e0a  to be verified..
-00032dd0: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00032de0: 2054 7275 6520 6973 2070 6f69 6e74 206c   True is point l
-00032df0: 6965 7320 6f6e 2074 6865 2045 6c6c 6970  ies on the Ellip
-00032e00: 7365 2c20 4661 6c73 6520 6f74 6865 7277  se, False otherw
-00032e10: 6973 650a 2020 2020 2020 2020 2222 220a  ise.        """.
-00032e20: 2020 2020 2020 2020 6e65 775f 706f 696e          new_poin
-00032e30: 7420 3d20 7365 6c66 2e66 7261 6d65 2e67  t = self.frame.g
-00032e40: 6c6f 6261 6c5f 746f 5f6c 6f63 616c 5f63  lobal_to_local_c
-00032e50: 6f6f 7264 696e 6174 6573 2870 6f69 6e74  oordinates(point
-00032e60: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00032e70: 206d 6174 682e 6973 636c 6f73 6528 6e65   math.isclose(ne
-00032e80: 775f 706f 696e 742e 7820 2a2a 2032 202f  w_point.x ** 2 /
-00032e90: 2073 656c 662e 6d61 6a6f 725f 6178 6973   self.major_axis
-00032ea0: 202a 2a20 3220 2b0a 2020 2020 2020 2020   ** 2 +.        
-00032eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032ec0: 2020 2020 6e65 775f 706f 696e 742e 7920      new_point.y 
-00032ed0: 2a2a 2032 202f 2073 656c 662e 6d69 6e6f  ** 2 / self.mino
-00032ee0: 725f 6178 6973 202a 2a20 322c 2031 2c20  r_axis ** 2, 1, 
-00032ef0: 6162 735f 746f 6c3d 3165 2d36 290a 0a20  abs_tol=1e-6).. 
-00032f00: 2020 2064 6566 206c 656e 6774 6828 7365     def length(se
-00032f10: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00032f20: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
-00032f30: 7465 7320 7468 6520 6c65 6e67 7468 206f  tes the length o
-00032f40: 6620 7468 6520 656c 6c69 7073 652e 0a0a  f the ellipse...
-00032f50: 2020 2020 2020 2020 5261 6d61 6e75 6a61          Ramanuja
-00032f60: 6e27 7320 6170 7072 6f78 696d 6174 696f  n's approximatio
-00032f70: 6e20 666f 7220 7468 6520 7065 7269 6d65  n for the perime
-00032f80: 7465 7220 6f66 2074 6865 2065 6c6c 6970  ter of the ellip
-00032f90: 7365 2e0a 2020 2020 2020 2020 5020 3d20  se..        P = 
-00032fa0: cf80 2028 6120 2b20 6229 205b 2031 202b  .. (a + b) [ 1 +
-00032fb0: 2028 3368 2920 2f20 2831 3020 2b20 e288   (3h) / (10 + ..
-00032fc0: 9a28 3420 2d20 3368 2920 2920 5d2c 2077  .(4 - 3h) ) ], w
-00032fd0: 6865 7265 2068 203d 2028 6120 2d20 6229  here h = (a - b)
-00032fe0: 2a2a 322f 2861 202b 2062 292a 2a32 0a20  **2/(a + b)**2. 
-00032ff0: 2020 2020 2020 203a 7265 7475 726e 3a0a         :return:.
-00033000: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00033010: 2020 2020 7065 7269 6d65 7465 725f 666f      perimeter_fo
-00033020: 726d 756c 6172 5f68 203d 2028 7365 6c66  rmular_h = (self
-00033030: 2e6d 616a 6f72 5f61 7869 7320 2d20 7365  .major_axis - se
-00033040: 6c66 2e6d 696e 6f72 5f61 7869 7329 202a  lf.minor_axis) *
-00033050: 2a20 3220 2f20 2873 656c 662e 6d61 6a6f  * 2 / (self.majo
-00033060: 725f 6178 6973 202b 2073 656c 662e 6d69  r_axis + self.mi
-00033070: 6e6f 725f 6178 6973 2920 2a2a 2032 0a20  nor_axis) ** 2. 
-00033080: 2020 2020 2020 2072 6574 7572 6e20 6d61         return ma
-00033090: 7468 2e70 6920 2a20 2873 656c 662e 6d61  th.pi * (self.ma
-000330a0: 6a6f 725f 6178 6973 202b 2073 656c 662e  jor_axis + self.
-000330b0: 6d69 6e6f 725f 6178 6973 2920 2a5c 0a20  minor_axis) *\. 
-000330c0: 2020 2020 2020 2020 2020 2028 3120 2b20             (1 + 
-000330d0: 2833 202a 2070 6572 696d 6574 6572 5f66  (3 * perimeter_f
-000330e0: 6f72 6d75 6c61 725f 6820 2f20 2831 3020  ormular_h / (10 
-000330f0: 2b20 6d61 7468 2e73 7172 7428 3420 2d20  + math.sqrt(4 - 
-00033100: 3320 2a20 7065 7269 6d65 7465 725f 666f  3 * perimeter_fo
-00033110: 726d 756c 6172 5f68 2929 2929 0a0a 2020  rmular_h))))..  
-00033120: 2020 6465 6620 6469 7363 7265 7469 7a61    def discretiza
-00033130: 7469 6f6e 5f70 6f69 6e74 7328 7365 6c66  tion_points(self
-00033140: 2c20 2a2c 206e 756d 6265 725f 706f 696e  , *, number_poin
-00033150: 7473 3a20 696e 7420 3d20 4e6f 6e65 2c20  ts: int = None, 
-00033160: 616e 676c 655f 7265 736f 6c75 7469 6f6e  angle_resolution
-00033170: 3a20 696e 7420 3d20 3230 293a 0a20 2020  : int = 20):.   
-00033180: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00033190: 2044 6973 6372 6574 697a 6520 6120 436f   Discretize a Co
-000331a0: 6e74 6f75 7220 746f 2068 6176 6520 226e  ntour to have "n
-000331b0: 2220 706f 696e 7473 2e0a 0a20 2020 2020  " points...     
-000331c0: 2020 203a 7061 7261 6d20 6e75 6d62 6572     :param number
-000331d0: 5f70 6f69 6e74 733a 2074 6865 206e 756d  _points: the num
-000331e0: 6265 7220 6f66 2070 6f69 6e74 7320 2869  ber of points (i
-000331f0: 6e63 6c75 6469 6e67 2073 7461 7274 2061  ncluding start a
-00033200: 6e64 2065 6e64 2070 6f69 6e74 7329 0a20  nd end points). 
-00033210: 2020 2020 2020 2020 2020 2020 6966 2075              if u
-00033220: 6e73 6574 2c20 6f6e 6c79 2073 7461 7274  nset, only start
-00033230: 2061 6e64 2065 6e64 2077 696c 6c20 6265   and end will be
-00033240: 2072 6574 7572 6e65 642e 0a20 2020 2020   returned..     
-00033250: 2020 203a 7061 7261 6d20 616e 676c 655f     :param angle_
-00033260: 7265 736f 6c75 7469 6f6e 3a20 6966 2073  resolution: if s
-00033270: 6574 2c20 7468 6520 7361 6d70 6c69 6e67  et, the sampling
-00033280: 2077 696c 6c20 6265 2061 6461 7074 6564   will be adapted
-00033290: 2074 6f20 6861 7665 2061 2063 6f6e 7472   to have a contr
-000332a0: 6f6c 6c65 6420 616e 6775 6c61 7220 6469  olled angular di
-000332b0: 7374 616e 6365 2e20 5573 6566 756c 0a20  stance. Useful. 
-000332c0: 2020 2020 2020 2020 2020 2074 6f20 6d65             to me
-000332d0: 7368 2061 6e20 6172 632e 0a20 2020 2020  sh an arc..     
-000332e0: 2020 203a 7265 7475 726e 3a20 6120 6c69     :return: a li
-000332f0: 7374 206f 6620 7361 6d70 6c65 6420 706f  st of sampled po
-00033300: 696e 7473 2e0a 2020 2020 2020 2020 2222  ints..        ""
-00033310: 220a 2020 2020 2020 2020 6966 206e 756d  ".        if num
-00033320: 6265 725f 706f 696e 7473 3a0a 2020 2020  ber_points:.    
-00033330: 2020 2020 2020 2020 616e 676c 655f 7265          angle_re
-00033340: 736f 6c75 7469 6f6e 203d 206e 756d 6265  solution = numbe
-00033350: 725f 706f 696e 7473 0a20 2020 2020 2020  r_points.       
-00033360: 2064 6973 6372 6574 697a 6174 696f 6e5f   discretization_
-00033370: 706f 696e 7473 5f33 6420 3d20 5b0a 2020  points_3d = [.  
-00033380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000333a0: 2020 2020 7365 6c66 2e63 656e 7465 7220      self.center 
-000333b0: 2b20 7365 6c66 2e6d 616a 6f72 5f61 7869  + self.major_axi
-000333c0: 7320 2a20 6d61 7468 2e63 6f73 280a 2020  s * math.cos(.  
-000333d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000333e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000333f0: 2020 2020 2020 2020 7465 7461 2920 2a20          teta) * 
-00033400: 7365 6c66 2e6d 616a 6f72 5f64 6972 0a20  self.major_dir. 
-00033410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033430: 2020 2020 202b 2073 656c 662e 6d69 6e6f       + self.mino
-00033440: 725f 6178 6973 202a 206d 6174 682e 7369  r_axis * math.si
-00033450: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00033460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033470: 2020 2020 2020 2020 2020 2020 2074 6574               tet
-00033480: 6129 202a 2073 656c 662e 6d61 6a6f 725f  a) * self.major_
-00033490: 6469 722e 6372 6f73 7328 0a20 2020 2020  dir.cross(.     
-000334a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000334b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000334c0: 2020 2020 2073 656c 662e 6e6f 726d 616c       self.normal
-000334d0: 2920 666f 7220 7465 7461 2069 6e0a 2020  ) for teta in.  
-000334e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000334f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033500: 2020 2020 6e70 792e 6c69 6e73 7061 6365      npy.linspace
-00033510: 2830 2c20 766f 6c6d 646c 722e 5457 4f5f  (0, volmdlr.TWO_
-00033520: 5049 2c0a 2020 2020 2020 2020 2020 2020  PI,.            
-00033530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033550: 2020 2020 2020 2061 6e67 6c65 5f72 6573         angle_res
-00033560: 6f6c 7574 696f 6e20 2b20 3129 5d5b 3a2d  olution + 1)][:-
-00033570: 315d 0a20 2020 2020 2020 2072 6574 7572  1].        retur
-00033580: 6e20 6469 7363 7265 7469 7a61 7469 6f6e  n discretization
-00033590: 5f70 6f69 6e74 735f 3364 0a0a 2020 2020  _points_3d..    
-000335a0: 6465 6620 746f 5f32 6428 7365 6c66 2c20  def to_2d(self, 
-000335b0: 706c 616e 655f 6f72 6967 696e 2c20 782c  plane_origin, x,
-000335c0: 2079 293a 0a20 2020 2020 2020 2022 2222   y):.        """
-000335d0: 0a20 2020 2020 2020 2054 7261 6e73 666f  .        Transfo
-000335e0: 726d 7320 6120 456c 6c69 7073 6533 4420  rms a Ellipse3D 
-000335f0: 696e 746f 2061 6e20 456c 6c69 7073 6544  into an EllipseD
-00033600: 2c20 6769 7665 6e20 6120 706c 616e 6520  , given a plane 
-00033610: 6f72 6967 696e 2061 6e64 2061 6e20 7520  origin and an u 
-00033620: 616e 6420 7620 706c 616e 6520 7665 6374  and v plane vect
-00033630: 6f72 2e0a 0a20 2020 2020 2020 203a 7061  or...        :pa
-00033640: 7261 6d20 706c 616e 655f 6f72 6967 696e  ram plane_origin
-00033650: 3a20 706c 616e 6520 6f72 6967 696e 2e0a  : plane origin..
-00033660: 2020 2020 2020 2020 3a70 6172 616d 2078          :param x
-00033670: 3a20 706c 616e 6520 7520 7665 6374 6f72  : plane u vector
-00033680: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00033690: 2079 3a20 706c 616e 6520 7620 7665 6374   y: plane v vect
-000336a0: 6f72 2e0a 2020 2020 2020 2020 3a72 6574  or..        :ret
-000336b0: 7572 6e3a 2045 6c6c 6970 7365 3244 2e0a  urn: Ellipse2D..
-000336c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000336d0: 2020 2020 6365 6e74 6572 203d 2073 656c      center = sel
-000336e0: 662e 6365 6e74 6572 2e74 6f5f 3264 2870  f.center.to_2d(p
-000336f0: 6c61 6e65 5f6f 7269 6769 6e2c 2078 2c20  lane_origin, x, 
-00033700: 7929 0a20 2020 2020 2020 206d 616a 6f72  y).        major
-00033710: 5f64 6972 5f64 3220 3d20 7365 6c66 2e6d  _dir_d2 = self.m
-00033720: 616a 6f72 5f64 6972 2e74 6f5f 3264 2870  ajor_dir.to_2d(p
-00033730: 6c61 6e65 5f6f 7269 6769 6e2c 2078 2c20  lane_origin, x, 
-00033740: 7929 0a20 2020 2020 2020 2072 6574 7572  y).        retur
-00033750: 6e20 456c 6c69 7073 6532 4428 7365 6c66  n Ellipse2D(self
-00033760: 2e6d 616a 6f72 5f61 7869 732c 2073 656c  .major_axis, sel
-00033770: 662e 6d69 6e6f 725f 6178 6973 2c20 6365  f.minor_axis, ce
-00033780: 6e74 6572 2c20 6d61 6a6f 725f 6469 725f  nter, major_dir_
-00033790: 6432 290a 0a20 2020 2064 6566 2061 6273  d2)..    def abs
-000337a0: 6369 7373 6128 7365 6c66 2c20 706f 696e  cissa(self, poin
-000337b0: 743a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  t: volmdlr.Point
-000337c0: 3344 293a 0a20 2020 2020 2020 2022 2222  3D):.        """
-000337d0: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
-000337e0: 7465 7320 7468 6520 6162 7363 6973 7361  tes the abscissa
-000337f0: 2061 2067 6976 656e 2070 6f69 6e74 2e0a   a given point..
-00033800: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00033810: 706f 696e 743a 2070 6f69 6e74 2074 6f20  point: point to 
-00033820: 6361 6c63 756c 6174 6520 6162 7363 6973  calculate abscis
-00033830: 7361 2e0a 2020 2020 2020 2020 3a72 6574  sa..        :ret
-00033840: 7572 6e3a 2061 6273 6369 7373 610a 2020  urn: abscissa.  
-00033850: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00033860: 2020 7665 6374 6f72 5f32 203d 2073 656c    vector_2 = sel
-00033870: 662e 6e6f 726d 616c 2e63 726f 7373 2873  f.normal.cross(s
-00033880: 656c 662e 6d61 6a6f 725f 6469 7229 0a20  elf.major_dir). 
-00033890: 2020 2020 2020 2065 6c6c 6970 7365 5f32         ellipse_2
-000338a0: 6420 3d20 7365 6c66 2e74 6f5f 3264 2873  d = self.to_2d(s
-000338b0: 656c 662e 6365 6e74 6572 2c20 7365 6c66  elf.center, self
-000338c0: 2e6d 616a 6f72 5f64 6972 2c20 7665 6374  .major_dir, vect
-000338d0: 6f72 5f32 290a 2020 2020 2020 2020 706f  or_2).        po
-000338e0: 696e 7432 6420 3d20 706f 696e 742e 746f  int2d = point.to
-000338f0: 5f32 6428 7365 6c66 2e63 656e 7465 722c  _2d(self.center,
-00033900: 2073 656c 662e 6d61 6a6f 725f 6469 722c   self.major_dir,
-00033910: 2076 6563 746f 725f 3229 0a20 2020 2020   vector_2).     
-00033920: 2020 2072 6574 7572 6e20 656c 6c69 7073     return ellips
-00033930: 655f 3264 2e61 6273 6369 7373 6128 706f  e_2d.abscissa(po
-00033940: 696e 7432 6429 0a0a 2020 2020 6465 6620  int2d)..    def 
-00033950: 7472 696d 2873 656c 662c 2070 6f69 6e74  trim(self, point
-00033960: 313a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  1: volmdlr.Point
-00033970: 3344 2c20 706f 696e 7432 3a20 766f 6c6d  3D, point2: volm
-00033980: 646c 722e 506f 696e 7433 4429 3a0a 2020  dlr.Point3D):.  
-00033990: 2020 2020 2020 6672 616d 6520 3d20 766f        frame = vo
-000339a0: 6c6d 646c 722e 4672 616d 6533 4428 7365  lmdlr.Frame3D(se
-000339b0: 6c66 2e63 656e 7465 722c 2073 656c 662e  lf.center, self.
-000339c0: 6d61 6a6f 725f 6469 722c 0a20 2020 2020  major_dir,.     
-000339d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000339e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000339f0: 6e6f 726d 616c 2e63 726f 7373 2873 656c  normal.cross(sel
-00033a00: 662e 6d61 6a6f 725f 6469 7229 2c20 7365  f.major_dir), se
-00033a10: 6c66 2e6e 6f72 6d61 6c29 0a0a 2020 2020  lf.normal)..    
-00033a20: 2020 2020 7031 5f6e 6577 2c20 7032 5f6e      p1_new, p2_n
-00033a30: 6577 203d 2066 7261 6d65 2e67 6c6f 6261  ew = frame.globa
-00033a40: 6c5f 746f 5f6c 6f63 616c 5f63 6f6f 7264  l_to_local_coord
-00033a50: 696e 6174 6573 2870 6f69 6e74 3129 2c20  inates(point1), 
-00033a60: 6672 616d 652e 676c 6f62 616c 5f74 6f5f  frame.global_to_
-00033a70: 6c6f 6361 6c5f 636f 6f72 6469 6e61 7465  local_coordinate
-00033a80: 7328 706f 696e 7432 290a 0a20 2020 2020  s(point2)..     
-00033a90: 2020 2074 6865 7461 3120 3d20 766f 6c6d     theta1 = volm
-00033aa0: 646c 722e 6765 6f6d 6574 7279 2e73 696e  dlr.geometry.sin
-00033ab0: 5f63 6f73 5f61 6e67 6c65 2870 315f 6e65  _cos_angle(p1_ne
-00033ac0: 772e 7820 2f20 7365 6c66 2e6d 616a 6f72  w.x / self.major
-00033ad0: 5f61 7869 732c 2070 315f 6e65 772e 7920  _axis, p1_new.y 
-00033ae0: 2f20 7365 6c66 2e6d 696e 6f72 5f61 7869  / self.minor_axi
-00033af0: 7329 0a0a 2020 2020 2020 2020 7468 6574  s)..        thet
-00033b00: 6132 203d 2076 6f6c 6d64 6c72 2e67 656f  a2 = volmdlr.geo
-00033b10: 6d65 7472 792e 7369 6e5f 636f 735f 616e  metry.sin_cos_an
-00033b20: 676c 6528 7032 5f6e 6577 2e78 202f 2073  gle(p2_new.x / s
-00033b30: 656c 662e 6d61 6a6f 725f 6178 6973 2c20  elf.major_axis, 
-00033b40: 7032 5f6e 6577 2e79 202f 2073 656c 662e  p2_new.y / self.
-00033b50: 6d69 6e6f 725f 6178 6973 290a 0a20 2020  minor_axis)..   
-00033b60: 2020 2020 2069 6620 7468 6574 6131 203e       if theta1 >
-00033b70: 2074 6865 7461 323a 2020 2320 7365 6e73   theta2:  # sens
-00033b80: 2074 7269 676f 0a20 2020 2020 2020 2020   trigo.         
-00033b90: 2020 2061 6e67 6c65 203d 206d 6174 682e     angle = math.
-00033ba0: 7069 202b 2028 7468 6574 6131 202b 2074  pi + (theta1 + t
-00033bb0: 6865 7461 3229 202f 2032 0a20 2020 2020  heta2) / 2.     
-00033bc0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00033bd0: 2020 2020 2061 6e67 6c65 203d 2028 7468       angle = (th
-00033be0: 6574 6131 202b 2074 6865 7461 3229 202f  eta1 + theta2) /
-00033bf0: 2032 0a0a 2020 2020 2020 2020 7033 203d   2..        p3 =
-00033c00: 2066 7261 6d65 2e6c 6f63 616c 5f74 6f5f   frame.local_to_
-00033c10: 676c 6f62 616c 5f63 6f6f 7264 696e 6174  global_coordinat
-00033c20: 6573 2876 6f6c 6d64 6c72 2e50 6f69 6e74  es(volmdlr.Point
-00033c30: 3344 2873 656c 662e 6d61 6a6f 725f 6178  3D(self.major_ax
-00033c40: 6973 202a 206d 6174 682e 636f 7328 616e  is * math.cos(an
-00033c50: 676c 6529 2c0a 2020 2020 2020 2020 2020  gle),.          
+00032630: 6c6f 6e67 7328 706f 696e 7432 293a 0a20  longs(point2):. 
+00032640: 2020 2020 2020 2020 2020 2061 7820 3d20             ax = 
+00032650: 7365 6c66 2e70 6c6f 7428 290a 2020 2020  self.plot().    
+00032660: 2020 2020 2020 2020 706f 696e 7431 2e70          point1.p
+00032670: 6c6f 7428 6178 3d61 782c 2063 6f6c 6f72  lot(ax=ax, color
+00032680: 3d27 7227 290a 2020 2020 2020 2020 2020  ='r').          
+00032690: 2020 706f 696e 7432 2e70 6c6f 7428 6178    point2.plot(ax
+000326a0: 3d61 782c 2063 6f6c 6f72 3d27 6227 290a  =ax, color='b').
+000326b0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000326c0: 6520 5661 6c75 6545 7272 6f72 2827 506f  e ValueError('Po
+000326d0: 696e 7420 6e6f 7420 6f6e 2063 6972 636c  int not on circl
+000326e0: 6520 666f 7220 7472 696d 206d 6574 686f  e for trim metho
+000326f0: 6427 290a 2020 2020 2020 2020 6966 2070  d').        if p
+00032700: 6f69 6e74 3120 3d3d 2070 6f69 6e74 323a  oint1 == point2:
+00032710: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00032720: 7572 6e20 766f 6c6d 646c 722e 6564 6765  urn volmdlr.edge
+00032730: 732e 4675 6c6c 4172 6333 4428 7365 6c66  s.FullArc3D(self
+00032740: 2e66 7261 6d65 2e6f 7269 6769 6e2c 2070  .frame.origin, p
+00032750: 6f69 6e74 312c 0a20 2020 2020 2020 2020  oint1,.         
+00032760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032780: 2020 7365 6c66 2e66 7261 6d65 2e77 290a    self.frame.w).
+00032790: 2020 2020 2020 2020 696e 7465 7269 6f72          interior
+000327a0: 203d 2076 6f6c 6d64 6c72 2e67 656f 6d65   = volmdlr.geome
+000327b0: 7472 792e 636c 6f63 6b77 6973 655f 696e  try.clockwise_in
+000327c0: 7465 7269 6f72 5f66 726f 6d5f 6369 7263  terior_from_circ
+000327d0: 6c65 3364 280a 2020 2020 2020 2020 2020  le3d(.          
+000327e0: 2020 706f 696e 7431 2c20 706f 696e 7432    point1, point2
+000327f0: 2c20 7365 6c66 290a 2020 2020 2020 2020  , self).        
+00032800: 7265 7475 726e 2076 6f6c 6d64 6c72 2e65  return volmdlr.e
+00032810: 6467 6573 2e41 7263 3344 2870 6f69 6e74  dges.Arc3D(point
+00032820: 312c 2069 6e74 6572 696f 722c 2070 6f69  1, interior, poi
+00032830: 6e74 3229 0a0a 0a63 6c61 7373 2045 6c6c  nt2)...class Ell
+00032840: 6970 7365 3344 2843 6f6e 746f 7572 3344  ipse3D(Contour3D
+00032850: 293a 0a20 2020 2022 2222 0a20 2020 2044  ):.    """.    D
+00032860: 6566 696e 6573 2061 2033 4420 656c 6c69  efines a 3D elli
+00032870: 7073 652e 0a0a 2020 2020 3a70 6172 616d  pse...    :param
+00032880: 206d 616a 6f72 5f61 7869 733a 204c 6172   major_axis: Lar
+00032890: 6765 7374 2072 6164 6975 7320 6f66 2074  gest radius of t
+000328a0: 6865 2065 6c6c 6970 7365 0a20 2020 203a  he ellipse.    :
+000328b0: 7479 7065 206d 616a 6f72 5f61 7869 733a  type major_axis:
+000328c0: 2066 6c6f 6174 0a20 2020 203a 7061 7261   float.    :para
+000328d0: 6d20 6d69 6e6f 725f 6178 6973 3a20 536d  m minor_axis: Sm
+000328e0: 616c 6c65 7374 2072 6164 6975 7320 6f66  allest radius of
+000328f0: 2074 6865 2065 6c6c 6970 7365 0a20 2020   the ellipse.   
+00032900: 203a 7479 7065 206d 696e 6f72 5f61 7869   :type minor_axi
+00032910: 733a 2066 6c6f 6174 0a20 2020 203a 7061  s: float.    :pa
+00032920: 7261 6d20 6365 6e74 6572 3a20 456c 6c69  ram center: Elli
+00032930: 7073 6527 7320 6365 6e74 6572 0a20 2020  pse's center.   
+00032940: 203a 7479 7065 2063 656e 7465 723a 2050   :type center: P
+00032950: 6f69 6e74 3344 0a20 2020 203a 7061 7261  oint3D.    :para
+00032960: 6d20 6e6f 726d 616c 3a20 456c 6c69 7073  m normal: Ellips
+00032970: 6527 7320 6e6f 726d 616c 0a20 2020 203a  e's normal.    :
+00032980: 7479 7065 206e 6f72 6d61 6c3a 2056 6563  type normal: Vec
+00032990: 746f 7233 440a 2020 2020 3a70 6172 616d  tor3D.    :param
+000329a0: 206d 616a 6f72 5f64 6972 3a20 4469 7265   major_dir: Dire
+000329b0: 6374 696f 6e20 6f66 2074 6865 206c 6172  ction of the lar
+000329c0: 6765 7374 2072 6164 6975 732f 6d61 6a6f  gest radius/majo
+000329d0: 725f 6178 6973 0a20 2020 203a 7479 7065  r_axis.    :type
+000329e0: 206d 616a 6f72 5f64 6972 3a20 5665 6374   major_dir: Vect
+000329f0: 6f72 3344 0a20 2020 2022 2222 0a0a 2020  or3D.    """..  
+00032a00: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+00032a10: 656c 662c 206d 616a 6f72 5f61 7869 733a  elf, major_axis:
+00032a20: 2066 6c6f 6174 2c20 6d69 6e6f 725f 6178   float, minor_ax
+00032a30: 6973 3a20 666c 6f61 742c 0a20 2020 2020  is: float,.     
+00032a40: 2020 2020 2020 2020 2020 2020 6365 6e74              cent
+00032a50: 6572 3a20 766f 6c6d 646c 722e 506f 696e  er: volmdlr.Poin
+00032a60: 7433 442c 206e 6f72 6d61 6c3a 2076 6f6c  t3D, normal: vol
+00032a70: 6d64 6c72 2e56 6563 746f 7233 442c 0a20  mdlr.Vector3D,. 
+00032a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a90: 6d61 6a6f 725f 6469 723a 2076 6f6c 6d64  major_dir: volmd
+00032aa0: 6c72 2e56 6563 746f 7233 442c 206e 616d  lr.Vector3D, nam
+00032ab0: 653a 2073 7472 203d 2027 2729 3a0a 0a20  e: str = ''):.. 
+00032ac0: 2020 2020 2020 2073 656c 662e 6d61 6a6f         self.majo
+00032ad0: 725f 6178 6973 203d 206d 616a 6f72 5f61  r_axis = major_a
+00032ae0: 7869 730a 2020 2020 2020 2020 7365 6c66  xis.        self
+00032af0: 2e6d 696e 6f72 5f61 7869 7320 3d20 6d69  .minor_axis = mi
+00032b00: 6e6f 725f 6178 6973 0a20 2020 2020 2020  nor_axis.       
+00032b10: 2073 656c 662e 6365 6e74 6572 203d 2063   self.center = c
+00032b20: 656e 7465 720a 2020 2020 2020 2020 6e6f  enter.        no
+00032b30: 726d 616c 2e6e 6f72 6d61 6c69 7a65 2829  rmal.normalize()
+00032b40: 0a20 2020 2020 2020 2073 656c 662e 6e6f  .        self.no
+00032b50: 726d 616c 203d 206e 6f72 6d61 6c0a 2020  rmal = normal.  
+00032b60: 2020 2020 2020 6d61 6a6f 725f 6469 722e        major_dir.
+00032b70: 6e6f 726d 616c 697a 6528 290a 2020 2020  normalize().    
+00032b80: 2020 2020 7365 6c66 2e6d 616a 6f72 5f64      self.major_d
+00032b90: 6972 203d 206d 616a 6f72 5f64 6972 0a20  ir = major_dir. 
+00032ba0: 2020 2020 2020 2073 656c 662e 5f66 7261         self._fra
+00032bb0: 6d65 203d 204e 6f6e 650a 2020 2020 2020  me = None.      
+00032bc0: 2020 436f 6e74 6f75 7233 442e 5f5f 696e    Contour3D.__in
+00032bd0: 6974 5f5f 2873 656c 662c 205b 7365 6c66  it__(self, [self
+00032be0: 5d2c 206e 616d 653d 6e61 6d65 290a 0a20  ], name=name).. 
+00032bf0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00032c00: 2064 6566 2066 7261 6d65 2873 656c 6629   def frame(self)
+00032c10: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00032c20: 2020 2020 2020 4765 7473 2074 6865 2045        Gets the E
+00032c30: 6c6c 6970 7365 2773 2046 7261 6d65 3344  llipse's Frame3D
+00032c40: 2e0a 0a20 2020 2020 2020 203a 7265 7475  ...        :retu
+00032c50: 726e 3a20 4672 616d 6533 442e 0a20 2020  rn: Frame3D..   
+00032c60: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00032c70: 2069 6620 6e6f 7420 7365 6c66 2e5f 6672   if not self._fr
+00032c80: 616d 653a 0a20 2020 2020 2020 2020 2020  ame:.           
+00032c90: 2073 656c 662e 5f66 7261 6d65 203d 2076   self._frame = v
+00032ca0: 6f6c 6d64 6c72 2e46 7261 6d65 3344 2873  olmdlr.Frame3D(s
+00032cb0: 656c 662e 6365 6e74 6572 2c20 7365 6c66  elf.center, self
+00032cc0: 2e6d 616a 6f72 5f64 6972 2c20 7365 6c66  .major_dir, self
+00032cd0: 2e6e 6f72 6d61 6c2e 6372 6f73 7328 7365  .normal.cross(se
+00032ce0: 6c66 2e6d 616a 6f72 5f64 6972 292c 2073  lf.major_dir), s
+00032cf0: 656c 662e 6e6f 726d 616c 290a 2020 2020  elf.normal).    
+00032d00: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00032d10: 5f66 7261 6d65 0a0a 2020 2020 6465 6620  _frame..    def 
+00032d20: 706f 696e 745f 6265 6c6f 6e67 7328 7365  point_belongs(se
+00032d30: 6c66 2c20 706f 696e 7429 3a0a 2020 2020  lf, point):.    
+00032d40: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00032d50: 5665 7269 6669 6573 2069 6620 6120 6769  Verifies if a gi
+00032d60: 7665 6e20 706f 696e 7420 6c69 6573 206f  ven point lies o
+00032d70: 6e20 7468 6520 456c 6c69 7073 6533 442e  n the Ellipse3D.
+00032d80: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00032d90: 2070 6f69 6e74 3a20 706f 696e 7420 746f   point: point to
+00032da0: 2062 6520 7665 7269 6669 6564 2e0a 2020   be verified..  
+00032db0: 2020 2020 2020 3a72 6574 7572 6e3a 2054        :return: T
+00032dc0: 7275 6520 6973 2070 6f69 6e74 206c 6965  rue is point lie
+00032dd0: 7320 6f6e 2074 6865 2045 6c6c 6970 7365  s on the Ellipse
+00032de0: 2c20 4661 6c73 6520 6f74 6865 7277 6973  , False otherwis
+00032df0: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
+00032e00: 2020 2020 2020 6e65 775f 706f 696e 7420        new_point 
+00032e10: 3d20 7365 6c66 2e66 7261 6d65 2e67 6c6f  = self.frame.glo
+00032e20: 6261 6c5f 746f 5f6c 6f63 616c 5f63 6f6f  bal_to_local_coo
+00032e30: 7264 696e 6174 6573 2870 6f69 6e74 290a  rdinates(point).
+00032e40: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+00032e50: 6174 682e 6973 636c 6f73 6528 6e65 775f  ath.isclose(new_
+00032e60: 706f 696e 742e 7820 2a2a 2032 202f 2073  point.x ** 2 / s
+00032e70: 656c 662e 6d61 6a6f 725f 6178 6973 202a  elf.major_axis *
+00032e80: 2a20 3220 2b0a 2020 2020 2020 2020 2020  * 2 +.          
+00032e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ea0: 2020 6e65 775f 706f 696e 742e 7920 2a2a    new_point.y **
+00032eb0: 2032 202f 2073 656c 662e 6d69 6e6f 725f   2 / self.minor_
+00032ec0: 6178 6973 202a 2a20 322c 2031 2c20 6162  axis ** 2, 1, ab
+00032ed0: 735f 746f 6c3d 3165 2d36 290a 0a20 2020  s_tol=1e-6)..   
+00032ee0: 2064 6566 206c 656e 6774 6828 7365 6c66   def length(self
+00032ef0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00032f00: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
+00032f10: 7320 7468 6520 6c65 6e67 7468 206f 6620  s the length of 
+00032f20: 7468 6520 656c 6c69 7073 652e 0a0a 2020  the ellipse...  
+00032f30: 2020 2020 2020 5261 6d61 6e75 6a61 6e27        Ramanujan'
+00032f40: 7320 6170 7072 6f78 696d 6174 696f 6e20  s approximation 
+00032f50: 666f 7220 7468 6520 7065 7269 6d65 7465  for the perimete
+00032f60: 7220 6f66 2074 6865 2065 6c6c 6970 7365  r of the ellipse
+00032f70: 2e0a 2020 2020 2020 2020 5020 3d20 cf80  ..        P = ..
+00032f80: 2028 6120 2b20 6229 205b 2031 202b 2028   (a + b) [ 1 + (
+00032f90: 3368 2920 2f20 2831 3020 2b20 e288 9a28  3h) / (10 + ...(
+00032fa0: 3420 2d20 3368 2920 2920 5d2c 2077 6865  4 - 3h) ) ], whe
+00032fb0: 7265 2068 203d 2028 6120 2d20 6229 2a2a  re h = (a - b)**
+00032fc0: 322f 2861 202b 2062 292a 2a32 0a20 2020  2/(a + b)**2.   
+00032fd0: 2020 2020 203a 7265 7475 726e 3a0a 2020       :return:.  
+00032fe0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00032ff0: 2020 7065 7269 6d65 7465 725f 666f 726d    perimeter_form
+00033000: 756c 6172 5f68 203d 2028 7365 6c66 2e6d  ular_h = (self.m
+00033010: 616a 6f72 5f61 7869 7320 2d20 7365 6c66  ajor_axis - self
+00033020: 2e6d 696e 6f72 5f61 7869 7329 202a 2a20  .minor_axis) ** 
+00033030: 3220 2f20 2873 656c 662e 6d61 6a6f 725f  2 / (self.major_
+00033040: 6178 6973 202b 2073 656c 662e 6d69 6e6f  axis + self.mino
+00033050: 725f 6178 6973 2920 2a2a 2032 0a20 2020  r_axis) ** 2.   
+00033060: 2020 2020 2072 6574 7572 6e20 6d61 7468       return math
+00033070: 2e70 6920 2a20 2873 656c 662e 6d61 6a6f  .pi * (self.majo
+00033080: 725f 6178 6973 202b 2073 656c 662e 6d69  r_axis + self.mi
+00033090: 6e6f 725f 6178 6973 2920 2a5c 0a20 2020  nor_axis) *\.   
+000330a0: 2020 2020 2020 2020 2028 3120 2b20 2833           (1 + (3
+000330b0: 202a 2070 6572 696d 6574 6572 5f66 6f72   * perimeter_for
+000330c0: 6d75 6c61 725f 6820 2f20 2831 3020 2b20  mular_h / (10 + 
+000330d0: 6d61 7468 2e73 7172 7428 3420 2d20 3320  math.sqrt(4 - 3 
+000330e0: 2a20 7065 7269 6d65 7465 725f 666f 726d  * perimeter_form
+000330f0: 756c 6172 5f68 2929 2929 0a0a 2020 2020  ular_h))))..    
+00033100: 6465 6620 6469 7363 7265 7469 7a61 7469  def discretizati
+00033110: 6f6e 5f70 6f69 6e74 7328 7365 6c66 2c20  on_points(self, 
+00033120: 2a2c 206e 756d 6265 725f 706f 696e 7473  *, number_points
+00033130: 3a20 696e 7420 3d20 4e6f 6e65 2c20 616e  : int = None, an
+00033140: 676c 655f 7265 736f 6c75 7469 6f6e 3a20  gle_resolution: 
+00033150: 696e 7420 3d20 3230 293a 0a20 2020 2020  int = 20):.     
+00033160: 2020 2022 2222 0a20 2020 2020 2020 2044     """.        D
+00033170: 6973 6372 6574 697a 6520 6120 436f 6e74  iscretize a Cont
+00033180: 6f75 7220 746f 2068 6176 6520 226e 2220  our to have "n" 
+00033190: 706f 696e 7473 2e0a 0a20 2020 2020 2020  points...       
+000331a0: 203a 7061 7261 6d20 6e75 6d62 6572 5f70   :param number_p
+000331b0: 6f69 6e74 733a 2074 6865 206e 756d 6265  oints: the numbe
+000331c0: 7220 6f66 2070 6f69 6e74 7320 2869 6e63  r of points (inc
+000331d0: 6c75 6469 6e67 2073 7461 7274 2061 6e64  luding start and
+000331e0: 2065 6e64 2070 6f69 6e74 7329 0a20 2020   end points).   
+000331f0: 2020 2020 2020 2020 2020 6966 2075 6e73            if uns
+00033200: 6574 2c20 6f6e 6c79 2073 7461 7274 2061  et, only start a
+00033210: 6e64 2065 6e64 2077 696c 6c20 6265 2072  nd end will be r
+00033220: 6574 7572 6e65 642e 0a20 2020 2020 2020  eturned..       
+00033230: 203a 7061 7261 6d20 616e 676c 655f 7265   :param angle_re
+00033240: 736f 6c75 7469 6f6e 3a20 6966 2073 6574  solution: if set
+00033250: 2c20 7468 6520 7361 6d70 6c69 6e67 2077  , the sampling w
+00033260: 696c 6c20 6265 2061 6461 7074 6564 2074  ill be adapted t
+00033270: 6f20 6861 7665 2061 2063 6f6e 7472 6f6c  o have a control
+00033280: 6c65 6420 616e 6775 6c61 7220 6469 7374  led angular dist
+00033290: 616e 6365 2e20 5573 6566 756c 0a20 2020  ance. Useful.   
+000332a0: 2020 2020 2020 2020 2074 6f20 6d65 7368           to mesh
+000332b0: 2061 6e20 6172 632e 0a20 2020 2020 2020   an arc..       
+000332c0: 203a 7265 7475 726e 3a20 6120 6c69 7374   :return: a list
+000332d0: 206f 6620 7361 6d70 6c65 6420 706f 696e   of sampled poin
+000332e0: 7473 2e0a 2020 2020 2020 2020 2222 220a  ts..        """.
+000332f0: 2020 2020 2020 2020 6966 206e 756d 6265          if numbe
+00033300: 725f 706f 696e 7473 3a0a 2020 2020 2020  r_points:.      
+00033310: 2020 2020 2020 616e 676c 655f 7265 736f        angle_reso
+00033320: 6c75 7469 6f6e 203d 206e 756d 6265 725f  lution = number_
+00033330: 706f 696e 7473 0a20 2020 2020 2020 2064  points.        d
+00033340: 6973 6372 6574 697a 6174 696f 6e5f 706f  iscretization_po
+00033350: 696e 7473 5f33 6420 3d20 5b0a 2020 2020  ints_3d = [.    
+00033360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033380: 2020 7365 6c66 2e63 656e 7465 7220 2b20    self.center + 
+00033390: 7365 6c66 2e6d 616a 6f72 5f61 7869 7320  self.major_axis 
+000333a0: 2a20 6d61 7468 2e63 6f73 280a 2020 2020  * math.cos(.    
+000333b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000333c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000333d0: 2020 2020 2020 7465 7461 2920 2a20 7365        teta) * se
+000333e0: 6c66 2e6d 616a 6f72 5f64 6972 0a20 2020  lf.major_dir.   
+000333f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033410: 2020 202b 2073 656c 662e 6d69 6e6f 725f     + self.minor_
+00033420: 6178 6973 202a 206d 6174 682e 7369 6e28  axis * math.sin(
+00033430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033450: 2020 2020 2020 2020 2020 2074 6574 6129             teta)
+00033460: 202a 2073 656c 662e 6d61 6a6f 725f 6469   * self.major_di
+00033470: 722e 6372 6f73 7328 0a20 2020 2020 2020  r.cross(.       
+00033480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000334a0: 2020 2073 656c 662e 6e6f 726d 616c 2920     self.normal) 
+000334b0: 666f 7220 7465 7461 2069 6e0a 2020 2020  for teta in.    
+000334c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000334d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000334e0: 2020 6e70 792e 6c69 6e73 7061 6365 2830    npy.linspace(0
+000334f0: 2c20 766f 6c6d 646c 722e 5457 4f5f 5049  , volmdlr.TWO_PI
+00033500: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033530: 2020 2020 2061 6e67 6c65 5f72 6573 6f6c       angle_resol
+00033540: 7574 696f 6e20 2b20 3129 5d5b 3a2d 315d  ution + 1)][:-1]
+00033550: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00033560: 6469 7363 7265 7469 7a61 7469 6f6e 5f70  discretization_p
+00033570: 6f69 6e74 735f 3364 0a0a 2020 2020 6465  oints_3d..    de
+00033580: 6620 746f 5f32 6428 7365 6c66 2c20 706c  f to_2d(self, pl
+00033590: 616e 655f 6f72 6967 696e 2c20 782c 2079  ane_origin, x, y
+000335a0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+000335b0: 2020 2020 2020 2054 7261 6e73 666f 726d         Transform
+000335c0: 7320 6120 456c 6c69 7073 6533 4420 696e  s a Ellipse3D in
+000335d0: 746f 2061 6e20 456c 6c69 7073 6544 2c20  to an EllipseD, 
+000335e0: 6769 7665 6e20 6120 706c 616e 6520 6f72  given a plane or
+000335f0: 6967 696e 2061 6e64 2061 6e20 7520 616e  igin and an u an
+00033600: 6420 7620 706c 616e 6520 7665 6374 6f72  d v plane vector
+00033610: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00033620: 6d20 706c 616e 655f 6f72 6967 696e 3a20  m plane_origin: 
+00033630: 706c 616e 6520 6f72 6967 696e 2e0a 2020  plane origin..  
+00033640: 2020 2020 2020 3a70 6172 616d 2078 3a20        :param x: 
+00033650: 706c 616e 6520 7520 7665 6374 6f72 2e0a  plane u vector..
+00033660: 2020 2020 2020 2020 3a70 6172 616d 2079          :param y
+00033670: 3a20 706c 616e 6520 7620 7665 6374 6f72  : plane v vector
+00033680: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00033690: 6e3a 2045 6c6c 6970 7365 3244 2e0a 2020  n: Ellipse2D..  
+000336a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000336b0: 2020 6365 6e74 6572 203d 2073 656c 662e    center = self.
+000336c0: 6365 6e74 6572 2e74 6f5f 3264 2870 6c61  center.to_2d(pla
+000336d0: 6e65 5f6f 7269 6769 6e2c 2078 2c20 7929  ne_origin, x, y)
+000336e0: 0a20 2020 2020 2020 206d 616a 6f72 5f64  .        major_d
+000336f0: 6972 5f64 3220 3d20 7365 6c66 2e6d 616a  ir_d2 = self.maj
+00033700: 6f72 5f64 6972 2e74 6f5f 3264 2870 6c61  or_dir.to_2d(pla
+00033710: 6e65 5f6f 7269 6769 6e2c 2078 2c20 7929  ne_origin, x, y)
+00033720: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00033730: 456c 6c69 7073 6532 4428 7365 6c66 2e6d  Ellipse2D(self.m
+00033740: 616a 6f72 5f61 7869 732c 2073 656c 662e  ajor_axis, self.
+00033750: 6d69 6e6f 725f 6178 6973 2c20 6365 6e74  minor_axis, cent
+00033760: 6572 2c20 6d61 6a6f 725f 6469 725f 6432  er, major_dir_d2
+00033770: 290a 0a20 2020 2064 6566 2061 6273 6369  )..    def absci
+00033780: 7373 6128 7365 6c66 2c20 706f 696e 743a  ssa(self, point:
+00033790: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3344   volmdlr.Point3D
+000337a0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+000337b0: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
+000337c0: 7320 7468 6520 6162 7363 6973 7361 2061  s the abscissa a
+000337d0: 2067 6976 656e 2070 6f69 6e74 2e0a 0a20   given point... 
+000337e0: 2020 2020 2020 203a 7061 7261 6d20 706f         :param po
+000337f0: 696e 743a 2070 6f69 6e74 2074 6f20 6361  int: point to ca
+00033800: 6c63 756c 6174 6520 6162 7363 6973 7361  lculate abscissa
+00033810: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00033820: 6e3a 2061 6273 6369 7373 610a 2020 2020  n: abscissa.    
+00033830: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00033840: 7665 6374 6f72 5f32 203d 2073 656c 662e  vector_2 = self.
+00033850: 6e6f 726d 616c 2e63 726f 7373 2873 656c  normal.cross(sel
+00033860: 662e 6d61 6a6f 725f 6469 7229 0a20 2020  f.major_dir).   
+00033870: 2020 2020 2065 6c6c 6970 7365 5f32 6420       ellipse_2d 
+00033880: 3d20 7365 6c66 2e74 6f5f 3264 2873 656c  = self.to_2d(sel
+00033890: 662e 6365 6e74 6572 2c20 7365 6c66 2e6d  f.center, self.m
+000338a0: 616a 6f72 5f64 6972 2c20 7665 6374 6f72  ajor_dir, vector
+000338b0: 5f32 290a 2020 2020 2020 2020 706f 696e  _2).        poin
+000338c0: 7432 6420 3d20 706f 696e 742e 746f 5f32  t2d = point.to_2
+000338d0: 6428 7365 6c66 2e63 656e 7465 722c 2073  d(self.center, s
+000338e0: 656c 662e 6d61 6a6f 725f 6469 722c 2076  elf.major_dir, v
+000338f0: 6563 746f 725f 3229 0a20 2020 2020 2020  ector_2).       
+00033900: 2072 6574 7572 6e20 656c 6c69 7073 655f   return ellipse_
+00033910: 3264 2e61 6273 6369 7373 6128 706f 696e  2d.abscissa(poin
+00033920: 7432 6429 0a0a 2020 2020 6465 6620 7472  t2d)..    def tr
+00033930: 696d 2873 656c 662c 2070 6f69 6e74 313a  im(self, point1:
+00033940: 2076 6f6c 6d64 6c72 2e50 6f69 6e74 3344   volmdlr.Point3D
+00033950: 2c20 706f 696e 7432 3a20 766f 6c6d 646c  , point2: volmdl
+00033960: 722e 506f 696e 7433 4429 3a0a 2020 2020  r.Point3D):.    
+00033970: 2020 2020 6672 616d 6520 3d20 766f 6c6d      frame = volm
+00033980: 646c 722e 4672 616d 6533 4428 7365 6c66  dlr.Frame3D(self
+00033990: 2e63 656e 7465 722c 2073 656c 662e 6d61  .center, self.ma
+000339a0: 6a6f 725f 6469 722c 0a20 2020 2020 2020  jor_dir,.       
+000339b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000339c0: 2020 2020 2020 2020 2073 656c 662e 6e6f           self.no
+000339d0: 726d 616c 2e63 726f 7373 2873 656c 662e  rmal.cross(self.
+000339e0: 6d61 6a6f 725f 6469 7229 2c20 7365 6c66  major_dir), self
+000339f0: 2e6e 6f72 6d61 6c29 0a0a 2020 2020 2020  .normal)..      
+00033a00: 2020 7031 5f6e 6577 2c20 7032 5f6e 6577    p1_new, p2_new
+00033a10: 203d 2066 7261 6d65 2e67 6c6f 6261 6c5f   = frame.global_
+00033a20: 746f 5f6c 6f63 616c 5f63 6f6f 7264 696e  to_local_coordin
+00033a30: 6174 6573 2870 6f69 6e74 3129 2c20 6672  ates(point1), fr
+00033a40: 616d 652e 676c 6f62 616c 5f74 6f5f 6c6f  ame.global_to_lo
+00033a50: 6361 6c5f 636f 6f72 6469 6e61 7465 7328  cal_coordinates(
+00033a60: 706f 696e 7432 290a 0a20 2020 2020 2020  point2)..       
+00033a70: 2074 6865 7461 3120 3d20 766f 6c6d 646c   theta1 = volmdl
+00033a80: 722e 6765 6f6d 6574 7279 2e73 696e 5f63  r.geometry.sin_c
+00033a90: 6f73 5f61 6e67 6c65 2870 315f 6e65 772e  os_angle(p1_new.
+00033aa0: 7820 2f20 7365 6c66 2e6d 616a 6f72 5f61  x / self.major_a
+00033ab0: 7869 732c 2070 315f 6e65 772e 7920 2f20  xis, p1_new.y / 
+00033ac0: 7365 6c66 2e6d 696e 6f72 5f61 7869 7329  self.minor_axis)
+00033ad0: 0a0a 2020 2020 2020 2020 7468 6574 6132  ..        theta2
+00033ae0: 203d 2076 6f6c 6d64 6c72 2e67 656f 6d65   = volmdlr.geome
+00033af0: 7472 792e 7369 6e5f 636f 735f 616e 676c  try.sin_cos_angl
+00033b00: 6528 7032 5f6e 6577 2e78 202f 2073 656c  e(p2_new.x / sel
+00033b10: 662e 6d61 6a6f 725f 6178 6973 2c20 7032  f.major_axis, p2
+00033b20: 5f6e 6577 2e79 202f 2073 656c 662e 6d69  _new.y / self.mi
+00033b30: 6e6f 725f 6178 6973 290a 0a20 2020 2020  nor_axis)..     
+00033b40: 2020 2069 6620 7468 6574 6131 203e 2074     if theta1 > t
+00033b50: 6865 7461 323a 2020 2320 7365 6e73 2074  heta2:  # sens t
+00033b60: 7269 676f 0a20 2020 2020 2020 2020 2020  rigo.           
+00033b70: 2061 6e67 6c65 203d 206d 6174 682e 7069   angle = math.pi
+00033b80: 202b 2028 7468 6574 6131 202b 2074 6865   + (theta1 + the
+00033b90: 7461 3229 202f 2032 0a20 2020 2020 2020  ta2) / 2.       
+00033ba0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00033bb0: 2020 2061 6e67 6c65 203d 2028 7468 6574     angle = (thet
+00033bc0: 6131 202b 2074 6865 7461 3229 202f 2032  a1 + theta2) / 2
+00033bd0: 0a0a 2020 2020 2020 2020 7033 203d 2066  ..        p3 = f
+00033be0: 7261 6d65 2e6c 6f63 616c 5f74 6f5f 676c  rame.local_to_gl
+00033bf0: 6f62 616c 5f63 6f6f 7264 696e 6174 6573  obal_coordinates
+00033c00: 2876 6f6c 6d64 6c72 2e50 6f69 6e74 3344  (volmdlr.Point3D
+00033c10: 2873 656c 662e 6d61 6a6f 725f 6178 6973  (self.major_axis
+00033c20: 202a 206d 6174 682e 636f 7328 616e 676c   * math.cos(angl
+00033c30: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+00033c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00033c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c90: 2020 2020 2073 656c 662e 6d69 6e6f 725f       self.minor_
-00033ca0: 6178 6973 202a 206d 6174 682e 7369 6e28  axis * math.sin(
-00033cb0: 616e 676c 6529 2c20 3029 290a 0a20 2020  angle), 0))..   
-00033cc0: 2020 2020 2072 6574 7572 6e20 766f 6c6d       return volm
-00033cd0: 646c 722e 6564 6765 732e 4172 6345 6c6c  dlr.edges.ArcEll
-00033ce0: 6970 7365 3344 2870 6f69 6e74 312c 2070  ipse3D(point1, p
-00033cf0: 332c 2070 6f69 6e74 322c 2073 656c 662e  3, point2, self.
-00033d00: 6365 6e74 6572 2c0a 2020 2020 2020 2020  center,.        
-00033d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d30: 2020 7365 6c66 2e6d 616a 6f72 5f64 6972    self.major_dir
-00033d40: 290a 0a20 2020 2064 6566 2072 6f74 6174  )..    def rotat
-00033d50: 696f 6e28 7365 6c66 2c20 6365 6e74 6572  ion(self, center
-00033d60: 3a20 766f 6c6d 646c 722e 506f 696e 7433  : volmdlr.Point3
-00033d70: 442c 2061 7869 733a 2076 6f6c 6d64 6c72  D, axis: volmdlr
-00033d80: 2e56 6563 746f 7233 442c 2061 6e67 6c65  .Vector3D, angle
-00033d90: 3a20 666c 6f61 7429 3a0a 2020 2020 2020  : float):.      
-00033da0: 2020 2222 220a 2020 2020 2020 2020 456c    """.        El
-00033db0: 6c69 7073 6533 4420 726f 7461 7469 6f6e  lipse3D rotation
-00033dc0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00033dd0: 6d20 6365 6e74 6572 3a20 726f 7461 7469  m center: rotati
-00033de0: 6f6e 2063 656e 7465 722e 0a20 2020 2020  on center..     
-00033df0: 2020 203a 7061 7261 6d20 6178 6973 3a20     :param axis: 
-00033e00: 726f 7461 7469 6f6e 2061 7869 732e 0a20  rotation axis.. 
-00033e10: 2020 2020 2020 203a 7061 7261 6d20 616e         :param an
-00033e20: 676c 653a 2061 6e67 6c65 2072 6f74 6174  gle: angle rotat
-00033e30: 696f 6e2e 0a20 2020 2020 2020 203a 7265  ion..        :re
-00033e40: 7475 726e 3a20 6120 6e65 7720 726f 7461  turn: a new rota
-00033e50: 7465 6420 456c 6c69 7073 6533 442e 0a20  ted Ellipse3D.. 
-00033e60: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00033e70: 2020 206e 6577 5f63 656e 7465 7220 3d20     new_center = 
-00033e80: 7365 6c66 2e63 656e 7465 722e 726f 7461  self.center.rota
-00033e90: 7469 6f6e 2863 656e 7465 722c 2061 7869  tion(center, axi
-00033ea0: 732c 2061 6e67 6c65 290a 2020 2020 2020  s, angle).      
-00033eb0: 2020 6e65 775f 6e6f 726d 616c 203d 2073    new_normal = s
-00033ec0: 656c 662e 6e6f 726d 616c 2e72 6f74 6174  elf.normal.rotat
-00033ed0: 696f 6e28 6365 6e74 6572 2c20 6178 6973  ion(center, axis
-00033ee0: 2c20 616e 676c 6529 0a20 2020 2020 2020  , angle).       
-00033ef0: 206e 6577 5f6d 616a 6f72 5f64 6972 203d   new_major_dir =
-00033f00: 2073 656c 662e 6d61 6a6f 725f 6469 722e   self.major_dir.
-00033f10: 726f 7461 7469 6f6e 2863 656e 7465 722c  rotation(center,
-00033f20: 2061 7869 732c 2061 6e67 6c65 290a 2020   axis, angle).  
-00033f30: 2020 2020 2020 7265 7475 726e 2045 6c6c        return Ell
-00033f40: 6970 7365 3344 2873 656c 662e 6d61 6a6f  ipse3D(self.majo
-00033f50: 725f 6178 6973 2c20 7365 6c66 2e6d 696e  r_axis, self.min
-00033f60: 6f72 5f61 7869 732c 206e 6577 5f63 656e  or_axis, new_cen
-00033f70: 7465 722c 0a20 2020 2020 2020 2020 2020  ter,.           
-00033f80: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
-00033f90: 775f 6e6f 726d 616c 2c20 6e65 775f 6d61  w_normal, new_ma
-00033fa0: 6a6f 725f 6469 722c 2073 656c 662e 6e61  jor_dir, self.na
-00033fb0: 6d65 290a 0a20 2020 2064 6566 2072 6f74  me)..    def rot
-00033fc0: 6174 696f 6e5f 696e 706c 6163 6528 7365  ation_inplace(se
-00033fd0: 6c66 2c20 6365 6e74 6572 3a20 766f 6c6d  lf, center: volm
-00033fe0: 646c 722e 506f 696e 7433 442c 2061 7869  dlr.Point3D, axi
-00033ff0: 733a 2076 6f6c 6d64 6c72 2e56 6563 746f  s: volmdlr.Vecto
-00034000: 7233 442c 2061 6e67 6c65 3a20 666c 6f61  r3D, angle: floa
-00034010: 7429 3a0a 2020 2020 2020 2020 2222 220a  t):.        """.
-00034020: 2020 2020 2020 2020 456c 6c69 7073 6533          Ellipse3
-00034030: 4420 726f 7461 7469 6f6e 2e20 4f62 6a65  D rotation. Obje
-00034040: 6374 2069 7320 7570 6461 7465 6420 696e  ct is updated in
-00034050: 706c 6163 652e 0a0a 2020 2020 2020 2020  place...        
-00034060: 3a70 6172 616d 2063 656e 7465 723a 2072  :param center: r
-00034070: 6f74 6174 696f 6e20 6365 6e74 6572 0a20  otation center. 
-00034080: 2020 2020 2020 203a 7061 7261 6d20 6178         :param ax
-00034090: 6973 3a20 726f 7461 7469 6f6e 2061 7869  is: rotation axi
-000340a0: 730a 2020 2020 2020 2020 3a70 6172 616d  s.        :param
-000340b0: 2061 6e67 6c65 3a20 726f 7461 7469 6f6e   angle: rotation
-000340c0: 2061 6e67 6c65 0a20 2020 2020 2020 2022   angle.        "
-000340d0: 2222 0a20 2020 2020 2020 2077 6172 6e69  "".        warni
-000340e0: 6e67 732e 7761 726e 2822 2769 6e70 6c61  ngs.warn("'inpla
-000340f0: 6365 2720 6d65 7468 6f64 7320 6172 6520  ce' methods are 
-00034100: 6465 7072 6563 6174 6564 2e20 5573 6520  deprecated. Use 
-00034110: 6120 6e6f 7420 696e 706c 6163 6520 6d65  a not inplace me
-00034120: 7468 6f64 2069 6e73 7465 6164 2e22 2c20  thod instead.", 
-00034130: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
-00034140: 6e67 290a 0a20 2020 2020 2020 2073 656c  ng)..        sel
-00034150: 662e 6365 6e74 6572 2e72 6f74 6174 696f  f.center.rotatio
-00034160: 6e5f 696e 706c 6163 6528 6365 6e74 6572  n_inplace(center
-00034170: 2c20 6178 6973 2c20 616e 676c 6529 0a20  , axis, angle). 
-00034180: 2020 2020 2020 2073 656c 662e 6e6f 726d         self.norm
-00034190: 616c 2e72 6f74 6174 696f 6e5f 696e 706c  al.rotation_inpl
-000341a0: 6163 6528 6365 6e74 6572 2c20 6178 6973  ace(center, axis
-000341b0: 2c20 616e 676c 6529 0a20 2020 2020 2020  , angle).       
-000341c0: 2073 656c 662e 6d61 6a6f 725f 6469 722e   self.major_dir.
-000341d0: 726f 7461 7469 6f6e 5f69 6e70 6c61 6365  rotation_inplace
-000341e0: 2863 656e 7465 722c 2061 7869 732c 2061  (center, axis, a
-000341f0: 6e67 6c65 290a 0a20 2020 2064 6566 2074  ngle)..    def t
-00034200: 7261 6e73 6c61 7469 6f6e 2873 656c 662c  ranslation(self,
-00034210: 206f 6666 7365 743a 2076 6f6c 6d64 6c72   offset: volmdlr
-00034220: 2e56 6563 746f 7233 4429 3a0a 2020 2020  .Vector3D):.    
-00034230: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00034240: 456c 6c69 7073 6533 4420 7472 616e 736c  Ellipse3D transl
-00034250: 6174 696f 6e0a 2020 2020 2020 2020 3a70  ation.        :p
-00034260: 6172 616d 206f 6666 7365 743a 2074 7261  aram offset: tra
-00034270: 6e73 6c61 7469 6f6e 2076 6563 746f 720a  nslation vector.
-00034280: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00034290: 2041 206e 6577 2074 7261 6e73 6c61 7465   A new translate
-000342a0: 6420 456c 6c69 7073 6533 440a 2020 2020  d Ellipse3D.    
-000342b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000342c0: 6e65 775f 6365 6e74 6572 203d 2073 656c  new_center = sel
-000342d0: 662e 6365 6e74 6572 2e74 7261 6e73 6c61  f.center.transla
-000342e0: 7469 6f6e 286f 6666 7365 7429 0a20 2020  tion(offset).   
-000342f0: 2020 2020 206e 6577 5f6e 6f72 6d61 6c20       new_normal 
-00034300: 3d20 7365 6c66 2e6e 6f72 6d61 6c2e 7472  = self.normal.tr
-00034310: 616e 736c 6174 696f 6e28 6f66 6673 6574  anslation(offset
-00034320: 290a 2020 2020 2020 2020 6e65 775f 6d61  ).        new_ma
-00034330: 6a6f 725f 6469 7220 3d20 7365 6c66 2e6d  jor_dir = self.m
-00034340: 616a 6f72 5f64 6972 2e74 7261 6e73 6c61  ajor_dir.transla
-00034350: 7469 6f6e 286f 6666 7365 7429 0a20 2020  tion(offset).   
-00034360: 2020 2020 2072 6574 7572 6e20 456c 6c69       return Elli
-00034370: 7073 6533 4428 7365 6c66 2e6d 616a 6f72  pse3D(self.major
-00034380: 5f61 7869 732c 2073 656c 662e 6d69 6e6f  _axis, self.mino
-00034390: 725f 6178 6973 2c20 6e65 775f 6365 6e74  r_axis, new_cent
-000343a0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-000343b0: 2020 2020 2020 2020 2020 2020 206e 6577               new
-000343c0: 5f6e 6f72 6d61 6c2c 206e 6577 5f6d 616a  _normal, new_maj
-000343d0: 6f72 5f64 6972 2c20 7365 6c66 2e6e 616d  or_dir, self.nam
-000343e0: 6529 0a0a 2020 2020 6465 6620 7472 616e  e)..    def tran
-000343f0: 736c 6174 696f 6e5f 696e 706c 6163 6528  slation_inplace(
-00034400: 7365 6c66 2c20 6f66 6673 6574 3a20 766f  self, offset: vo
-00034410: 6c6d 646c 722e 5665 6374 6f72 3344 293a  lmdlr.Vector3D):
-00034420: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00034430: 2020 2020 2045 6c6c 6970 7365 3344 2074       Ellipse3D t
-00034440: 7261 6e73 6c61 7469 6f6e 2e20 4f62 6a65  ranslation. Obje
-00034450: 6374 2069 7320 7570 6461 7465 6420 696e  ct is updated in
-00034460: 706c 6163 652e 0a0a 2020 2020 2020 2020  place...        
-00034470: 3a70 6172 616d 206f 6666 7365 743a 2074  :param offset: t
-00034480: 7261 6e73 6c61 7469 6f6e 2076 6563 746f  ranslation vecto
-00034490: 720a 2020 2020 2020 2020 2222 220a 2020  r.        """.  
-000344a0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-000344b0: 6172 6e28 2227 696e 706c 6163 6527 206d  arn("'inplace' m
-000344c0: 6574 686f 6473 2061 7265 2064 6570 7265  ethods are depre
-000344d0: 6361 7465 642e 2055 7365 2061 206e 6f74  cated. Use a not
-000344e0: 2069 6e70 6c61 6365 206d 6574 686f 6420   inplace method 
-000344f0: 696e 7374 6561 642e 222c 2044 6570 7265  instead.", Depre
-00034500: 6361 7469 6f6e 5761 726e 696e 6729 0a0a  cationWarning)..
-00034510: 2020 2020 2020 2020 7365 6c66 2e63 656e          self.cen
-00034520: 7465 722e 7472 616e 736c 6174 696f 6e5f  ter.translation_
-00034530: 696e 706c 6163 6528 6f66 6673 6574 290a  inplace(offset).
-00034540: 2020 2020 2020 2020 7365 6c66 2e6e 6f72          self.nor
-00034550: 6d61 6c2e 7472 616e 736c 6174 696f 6e5f  mal.translation_
-00034560: 696e 706c 6163 6528 6f66 6673 6574 290a  inplace(offset).
-00034570: 2020 2020 2020 2020 7365 6c66 2e6d 616a          self.maj
-00034580: 6f72 5f64 6972 2e74 7261 6e73 6c61 7469  or_dir.translati
-00034590: 6f6e 5f69 6e70 6c61 6365 286f 6666 7365  on_inplace(offse
-000345a0: 7429 0a0a 2020 2020 6465 6620 706c 6f74  t)..    def plot
-000345b0: 2873 656c 662c 2061 783d 4e6f 6e65 2c20  (self, ax=None, 
-000345c0: 636f 6c6f 723d 276b 272c 2061 6c70 6861  color='k', alpha
-000345d0: 3d31 2c20 6564 6765 5f64 6574 6169 6c73  =1, edge_details
-000345e0: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
-000345f0: 2069 6620 6178 2069 7320 4e6f 6e65 3a0a   if ax is None:.
-00034600: 2020 2020 2020 2020 2020 2020 6669 6720              fig 
-00034610: 3d20 706c 742e 6669 6775 7265 2829 0a20  = plt.figure(). 
-00034620: 2020 2020 2020 2020 2020 2061 7820 3d20             ax = 
-00034630: 4178 6573 3344 2866 6967 290a 2020 2020  Axes3D(fig).    
-00034640: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00034650: 2020 2020 2020 6669 6720 3d20 4e6f 6e65        fig = None
-00034660: 0a0a 2020 2020 2020 2020 7820 3d20 5b5d  ..        x = []
-00034670: 0a20 2020 2020 2020 2079 203d 205b 5d0a  .        y = [].
-00034680: 2020 2020 2020 2020 7a20 3d20 5b5d 0a20          z = []. 
-00034690: 2020 2020 2020 2066 6f72 2070 782c 2070         for px, p
-000346a0: 792c 2070 7a20 696e 2073 656c 662e 6469  y, pz in self.di
-000346b0: 7363 7265 7469 7a61 7469 6f6e 5f70 6f69  scretization_poi
-000346c0: 6e74 7328 293a 0a20 2020 2020 2020 2020  nts():.         
-000346d0: 2020 2078 2e61 7070 656e 6428 7078 290a     x.append(px).
-000346e0: 2020 2020 2020 2020 2020 2020 792e 6170              y.ap
-000346f0: 7065 6e64 2870 7929 0a20 2020 2020 2020  pend(py).       
-00034700: 2020 2020 207a 2e61 7070 656e 6428 707a       z.append(pz
-00034710: 290a 2020 2020 2020 2020 782e 6170 7065  ).        x.appe
-00034720: 6e64 2878 5b30 5d29 0a20 2020 2020 2020  nd(x[0]).       
-00034730: 2079 2e61 7070 656e 6428 795b 305d 290a   y.append(y[0]).
-00034740: 2020 2020 2020 2020 7a2e 6170 7065 6e64          z.append
-00034750: 287a 5b30 5d29 0a20 2020 2020 2020 2061  (z[0]).        a
-00034760: 782e 706c 6f74 2878 2c20 792c 207a 2c20  x.plot(x, y, z, 
-00034770: 636f 6c6f 7229 0a20 2020 2020 2020 2072  color).        r
-00034780: 6574 7572 6e20 6178 0a0a 2020 2020 4063  eturn ax..    @c
-00034790: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
-000347a0: 6566 2066 726f 6d5f 7374 6570 2863 6c73  ef from_step(cls
-000347b0: 2c20 6172 6775 6d65 6e74 732c 206f 626a  , arguments, obj
-000347c0: 6563 745f 6469 6374 293a 0a20 2020 2020  ect_dict):.     
-000347d0: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-000347e0: 6f6e 7665 7274 7320 6120 7374 6570 2070  onverts a step p
-000347f0: 7269 6d69 7469 7665 2074 6f20 6120 456c  rimitive to a El
-00034800: 6c69 7073 6533 442e 0a0a 2020 2020 2020  lipse3D...      
-00034810: 2020 3a70 6172 616d 2061 7267 756d 656e    :param argumen
-00034820: 7473 3a20 5468 6520 6172 6775 6d65 6e74  ts: The argument
-00034830: 7320 6f66 2074 6865 2073 7465 7020 7072  s of the step pr
-00034840: 696d 6974 6976 652e 2054 6865 206c 6173  imitive. The las
-00034850: 7420 656c 656d 656e 7420 7265 7072 6573  t element repres
-00034860: 656e 7473 2074 6865 2075 6e69 745f 636f  ents the unit_co
-00034870: 6e76 6572 7369 6f6e 5f66 6163 746f 722e  nversion_factor.
-00034880: 0a20 2020 2020 2020 203a 7479 7065 2061  .        :type a
-00034890: 7267 756d 656e 7473 3a20 6c69 7374 0a20  rguments: list. 
-000348a0: 2020 2020 2020 203a 7061 7261 6d20 6f62         :param ob
-000348b0: 6a65 6374 5f64 6963 743a 2054 6865 2064  ject_dict: The d
-000348c0: 6963 7469 6f6e 6172 7920 636f 6e74 6169  ictionary contai
-000348d0: 6e69 6e67 2061 6c6c 2074 6865 2073 7465  ning all the ste
-000348e0: 7020 7072 696d 6974 6976 6573 2074 6861  p primitives tha
-000348f0: 7420 6861 7665 2061 6c72 6561 6479 2062  t have already b
-00034900: 6565 6e20 696e 7374 616e 7469 6174 6564  een instantiated
-00034910: 2e0a 2020 2020 2020 2020 3a74 7970 6520  ..        :type 
-00034920: 6f62 6a65 6374 5f64 6963 743a 2064 6963  object_dict: dic
-00034930: 740a 2020 2020 2020 2020 3a72 6574 7572  t.        :retur
-00034940: 6e3a 2054 6865 2063 6f72 7265 7370 6f6e  n: The correspon
-00034950: 6469 6e67 2045 6c6c 6970 7365 3344 206f  ding Ellipse3D o
-00034960: 626a 6563 742e 0a20 2020 2020 2020 203a  bject..        :
-00034970: 7274 7970 653a 203a 636c 6173 733a 6076  rtype: :class:`v
-00034980: 6f6c 6d64 6c72 2e77 6972 6573 2e45 6c6c  olmdlr.wires.Ell
-00034990: 6970 7365 3344 600a 2020 2020 2020 2020  ipse3D`.        
-000349a0: 2222 220a 2020 2020 2020 2020 756e 6974  """.        unit
-000349b0: 5f63 6f6e 7665 7273 696f 6e5f 6661 6374  _conversion_fact
-000349c0: 6f72 203d 2061 7267 756d 656e 7473 5b2d  or = arguments[-
-000349d0: 315d 0a20 2020 2020 2020 2063 656e 7465  1].        cente
-000349e0: 7220 3d20 6f62 6a65 6374 5f64 6963 745b  r = object_dict[
-000349f0: 6172 6775 6d65 6e74 735b 315d 5d2e 6f72  arguments[1]].or
-00034a00: 6967 696e 0a20 2020 2020 2020 206e 6f72  igin.        nor
-00034a10: 6d61 6c20 3d20 6f62 6a65 6374 5f64 6963  mal = object_dic
-00034a20: 745b 6172 6775 6d65 6e74 735b 315d 5d2e  t[arguments[1]].
-00034a30: 7520 2023 2061 6e63 6965 6e20 770a 2020  u  # ancien w.  
-00034a40: 2020 2020 2020 6d61 6a6f 725f 6469 7220        major_dir 
-00034a50: 3d20 6f62 6a65 6374 5f64 6963 745b 6172  = object_dict[ar
-00034a60: 6775 6d65 6e74 735b 315d 5d2e 7620 2023  guments[1]].v  #
-00034a70: 2061 6e63 6965 6e20 750a 2020 2020 2020   ancien u.      
-00034a80: 2020 6d61 6a6f 725f 6178 6973 203d 2066    major_axis = f
-00034a90: 6c6f 6174 2861 7267 756d 656e 7473 5b32  loat(arguments[2
-00034aa0: 5d29 202a 2075 6e69 745f 636f 6e76 6572  ]) * unit_conver
-00034ab0: 7369 6f6e 5f66 6163 746f 720a 2020 2020  sion_factor.    
-00034ac0: 2020 2020 6d69 6e6f 725f 6178 6973 203d      minor_axis =
-00034ad0: 2066 6c6f 6174 2861 7267 756d 656e 7473   float(arguments
-00034ae0: 5b33 5d29 202a 2075 6e69 745f 636f 6e76  [3]) * unit_conv
-00034af0: 6572 7369 6f6e 5f66 6163 746f 720a 2020  ersion_factor.  
-00034b00: 2020 2020 2020 7265 7475 726e 2063 6c73        return cls
-00034b10: 286d 616a 6f72 5f61 7869 732c 206d 696e  (major_axis, min
-00034b20: 6f72 5f61 7869 732c 2063 656e 7465 722c  or_axis, center,
-00034b30: 206e 6f72 6d61 6c2c 206d 616a 6f72 5f64   normal, major_d
-00034b40: 6972 2c0a 2020 2020 2020 2020 2020 2020  ir,.            
-00034b50: 2020 2020 2020 2061 7267 756d 656e 7473         arguments
-00034b60: 5b30 5d5b 313a 2d31 5d29 0a0a 0a63 6c61  [0][1:-1])...cla
-00034b70: 7373 2043 6c6f 7365 6450 6f6c 7967 6f6e  ss ClosedPolygon
-00034b80: 3344 2843 6f6e 746f 7572 3344 2c20 436c  3D(Contour3D, Cl
-00034b90: 6f73 6564 506f 6c79 676f 6e4d 6978 696e  osedPolygonMixin
-00034ba0: 293a 0a20 2020 2022 2222 0a20 2020 2041  ):.    """.    A
-00034bb0: 2063 6f6c 6c65 6374 696f 6e20 6f66 2070   collection of p
-00034bc0: 6f69 6e74 732c 2063 6f6e 6e65 6374 6564  oints, connected
-00034bd0: 2062 7920 6c69 6e65 7365 676d 656e 7473   by linesegments
-00034be0: 2c20 666f 6c6c 6f77 696e 6720 6561 6368  , following each
-00034bf0: 206f 7468 6572 2e0a 0a20 2020 2022 2222   other...    """
-00034c00: 0a20 2020 205f 6e6f 6e5f 7365 7269 616c  .    _non_serial
-00034c10: 697a 6162 6c65 5f61 7474 7269 6275 7465  izable_attribute
-00034c20: 7320 3d20 5b27 6c69 6e65 5f73 6567 6d65  s = ['line_segme
-00034c30: 6e74 7327 2c20 2770 7269 6d69 7469 7665  nts', 'primitive
-00034c40: 7327 5d0a 2020 2020 5f6e 6f6e 5f65 715f  s'].    _non_eq_
-00034c50: 6174 7472 6962 7574 6573 203d 205b 276c  attributes = ['l
-00034c60: 696e 655f 7365 676d 656e 7473 272c 2027  ine_segments', '
-00034c70: 7072 696d 6974 6976 6573 275d 0a0a 2020  primitives']..  
-00034c80: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-00034c90: 656c 662c 2070 6f69 6e74 733a 204c 6973  elf, points: Lis
-00034ca0: 745b 766f 6c6d 646c 722e 506f 696e 7433  t[volmdlr.Point3
-00034cb0: 445d 2c20 6e61 6d65 3a20 7374 7220 3d20  D], name: str = 
-00034cc0: 2727 293a 0a20 2020 2020 2020 2073 656c  ''):.        sel
-00034cd0: 662e 706f 696e 7473 203d 2070 6f69 6e74  f.points = point
-00034ce0: 730a 2020 2020 2020 2020 7365 6c66 2e5f  s.        self._
-00034cf0: 6c69 6e65 5f73 6567 6d65 6e74 7320 3d20  line_segments = 
-00034d00: 4e6f 6e65 0a0a 2020 2020 2020 2020 436f  None..        Co
-00034d10: 6e74 6f75 7233 442e 5f5f 696e 6974 5f5f  ntour3D.__init__
-00034d20: 2873 656c 662c 2073 656c 662e 6c69 6e65  (self, self.line
-00034d30: 5f73 6567 6d65 6e74 732c 206e 616d 6529  _segments, name)
-00034d40: 0a0a 2020 2020 6465 6620 6765 745f 6c69  ..    def get_li
-00034d50: 6e65 5f73 6567 6d65 6e74 7328 7365 6c66  ne_segments(self
-00034d60: 293a 0a20 2020 2020 2020 206c 696e 6573  ):.        lines
-00034d70: 203d 205b 5d0a 2020 2020 2020 2020 6966   = [].        if
-00034d80: 206c 656e 2873 656c 662e 706f 696e 7473   len(self.points
-00034d90: 2920 3e20 313a 0a20 2020 2020 2020 2020  ) > 1:.         
-00034da0: 2020 2066 6f72 2070 312c 2070 3220 696e     for p1, p2 in
-00034db0: 207a 6970 2873 656c 662e 706f 696e 7473   zip(self.points
-00034dc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00034dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034de0: 6c69 7374 2873 656c 662e 706f 696e 7473  list(self.points
-00034df0: 5b31 3a5d 2920 2b20 5b73 656c 662e 706f  [1:]) + [self.po
-00034e00: 696e 7473 5b30 5d5d 293a 0a20 2020 2020  ints[0]]):.     
-00034e10: 2020 2020 2020 2020 2020 206c 696e 6573             lines
-00034e20: 2e61 7070 656e 6428 766f 6c6d 646c 722e  .append(volmdlr.
-00034e30: 6564 6765 732e 4c69 6e65 5365 676d 656e  edges.LineSegmen
-00034e40: 7433 4428 7031 2c20 7032 2929 0a20 2020  t3D(p1, p2)).   
-00034e50: 2020 2020 2072 6574 7572 6e20 6c69 6e65       return line
-00034e60: 730a 0a20 2020 2064 6566 2063 6f70 7928  s..    def copy(
-00034e70: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00034e80: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00034e90: 706f 696e 7473 203d 205b 706f 696e 742e  points = [point.
-00034ea0: 636f 7079 2829 2066 6f72 2070 6f69 6e74  copy() for point
-00034eb0: 2069 6e20 7365 6c66 2e70 6f69 6e74 735d   in self.points]
-00034ec0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00034ed0: 436c 6f73 6564 506f 6c79 676f 6e33 4428  ClosedPolygon3D(
-00034ee0: 706f 696e 7473 2c20 7365 6c66 2e6e 616d  points, self.nam
-00034ef0: 6529 0a0a 2020 2020 6465 6620 5f5f 6861  e)..    def __ha
-00034f00: 7368 5f5f 2873 656c 6629 3a0a 2020 2020  sh__(self):.    
-00034f10: 2020 2020 7265 7475 726e 2073 756d 2868      return sum(h
-00034f20: 6173 6828 706f 696e 7429 2066 6f72 2070  ash(point) for p
-00034f30: 6f69 6e74 2069 6e20 7365 6c66 2e70 6f69  oint in self.poi
-00034f40: 6e74 7329 0a0a 2020 2020 6465 6620 5f5f  nts)..    def __
-00034f50: 6571 5f5f 2873 656c 662c 206f 7468 6572  eq__(self, other
-00034f60: 5f29 3a0a 2020 2020 2020 2020 6966 206e  _):.        if n
-00034f70: 6f74 2069 7369 6e73 7461 6e63 6528 6f74  ot isinstance(ot
-00034f80: 6865 725f 2c20 7365 6c66 2e5f 5f63 6c61  her_, self.__cla
-00034f90: 7373 5f5f 293a 0a20 2020 2020 2020 2020  ss__):.         
-00034fa0: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
-00034fb0: 2020 2020 2020 2020 6571 7561 6c20 3d20          equal = 
-00034fc0: 5472 7565 0a20 2020 2020 2020 2066 6f72  True.        for
-00034fd0: 2070 6f69 6e74 2c20 6f74 6865 725f 706f   point, other_po
-00034fe0: 696e 7420 696e 207a 6970 2873 656c 662e  int in zip(self.
-00034ff0: 706f 696e 7473 2c20 6f74 6865 725f 2e70  points, other_.p
-00035000: 6f69 6e74 7329 3a0a 2020 2020 2020 2020  oints):.        
-00035010: 2020 2020 6571 7561 6c20 3d20 2865 7175      equal = (equ
-00035020: 616c 2061 6e64 2070 6f69 6e74 203d 3d20  al and point == 
-00035030: 6f74 6865 725f 706f 696e 7429 0a20 2020  other_point).   
-00035040: 2020 2020 2072 6574 7572 6e20 6571 7561       return equa
-00035050: 6c0a 0a20 2020 2064 6566 2070 6c6f 7428  l..    def plot(
-00035060: 7365 6c66 2c20 6178 3d4e 6f6e 652c 2063  self, ax=None, c
-00035070: 6f6c 6f72 3d27 6b27 2c20 616c 7068 613d  olor='k', alpha=
-00035080: 312c 2065 6467 655f 6465 7461 696c 733d  1, edge_details=
-00035090: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
-000350a0: 666f 7220 6c69 6e65 5f73 6567 6d65 6e74  for line_segment
-000350b0: 2069 6e20 7365 6c66 2e6c 696e 655f 7365   in self.line_se
-000350c0: 676d 656e 7473 3a0a 2020 2020 2020 2020  gments:.        
-000350d0: 2020 2020 6178 203d 206c 696e 655f 7365      ax = line_se
-000350e0: 676d 656e 742e 706c 6f74 2861 783d 6178  gment.plot(ax=ax
-000350f0: 2c20 636f 6c6f 723d 636f 6c6f 722c 2061  , color=color, a
-00035100: 6c70 6861 3d61 6c70 6861 2c0a 2020 2020  lpha=alpha,.    
-00035110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035120: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00035130: 6467 655f 656e 6473 3d54 7275 652c 2065  dge_ends=True, e
-00035140: 6467 655f 6469 7265 6374 696f 6e3d 6564  dge_direction=ed
-00035150: 6765 5f64 6574 6169 6c73 290a 2020 2020  ge_details).    
-00035160: 2020 2020 7265 7475 726e 2061 780a 0a20      return ax.. 
-00035170: 2020 2064 6566 2072 6f74 6174 696f 6e28     def rotation(
-00035180: 7365 6c66 2c20 6365 6e74 6572 3a20 766f  self, center: vo
-00035190: 6c6d 646c 722e 506f 696e 7433 442c 2061  lmdlr.Point3D, a
-000351a0: 7869 733a 2076 6f6c 6d64 6c72 2e56 6563  xis: volmdlr.Vec
-000351b0: 746f 7233 442c 0a20 2020 2020 2020 2020  tor3D,.         
-000351c0: 2020 2020 2020 2020 616e 676c 653a 2066          angle: f
-000351d0: 6c6f 6174 293a 0a20 2020 2020 2020 2022  loat):.        "
-000351e0: 2222 0a20 2020 2020 2020 2043 6c6f 7365  "".        Close
-000351f0: 6450 6f6c 7967 6f6e 3344 2072 6f74 6174  dPolygon3D rotat
-00035200: 696f 6e2e 0a0a 2020 2020 2020 2020 3a70  ion...        :p
-00035210: 6172 616d 2063 656e 7465 723a 2072 6f74  aram center: rot
-00035220: 6174 696f 6e20 6365 6e74 6572 2e0a 2020  ation center..  
-00035230: 2020 2020 2020 3a70 6172 616d 2061 7869        :param axi
-00035240: 733a 2072 6f74 6174 696f 6e20 6178 6973  s: rotation axis
-00035250: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00035260: 2061 6e67 6c65 3a20 616e 676c 6520 726f   angle: angle ro
-00035270: 7461 7469 6f6e 2e0a 2020 2020 2020 2020  tation..        
-00035280: 3a72 6574 7572 6e3a 2061 206e 6577 2072  :return: a new r
-00035290: 6f74 6174 6564 2043 6c6f 7365 6450 6f6c  otated ClosedPol
-000352a0: 7967 6f6e 3344 2e0a 2020 2020 2020 2020  ygon3D..        
-000352b0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-000352c0: 726e 2043 6c6f 7365 6450 6f6c 7967 6f6e  rn ClosedPolygon
-000352d0: 3344 280a 2020 2020 2020 2020 2020 2020  3D(.            
-000352e0: 5b70 6f69 6e74 2e72 6f74 6174 696f 6e28  [point.rotation(
-000352f0: 6365 6e74 6572 2c20 6178 6973 2c20 616e  center, axis, an
-00035300: 676c 6529 2066 6f72 2070 6f69 6e74 2069  gle) for point i
-00035310: 6e0a 2020 2020 2020 2020 2020 2020 2073  n.             s
-00035320: 656c 662e 706f 696e 7473 5d29 0a0a 2020  elf.points])..  
-00035330: 2020 6465 6620 726f 7461 7469 6f6e 5f69    def rotation_i
-00035340: 6e70 6c61 6365 2873 656c 662c 2063 656e  nplace(self, cen
-00035350: 7465 723a 2076 6f6c 6d64 6c72 2e50 6f69  ter: volmdlr.Poi
-00035360: 6e74 3344 2c20 6178 6973 3a20 766f 6c6d  nt3D, axis: volm
-00035370: 646c 722e 5665 6374 6f72 3344 2c0a 2020  dlr.Vector3D,.  
-00035380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035390: 2020 2020 2020 2061 6e67 6c65 3a20 666c         angle: fl
-000353a0: 6f61 7429 3a0a 2020 2020 2020 2020 2222  oat):.        ""
-000353b0: 220a 2020 2020 2020 2020 436c 6f73 6564  ".        Closed
-000353c0: 506f 6c79 676f 6e33 4420 726f 7461 7469  Polygon3D rotati
-000353d0: 6f6e 2e20 4f62 6a65 6374 2069 7320 7570  on. Object is up
-000353e0: 6461 7465 6420 696e 706c 6163 652e 0a0a  dated inplace...
-000353f0: 2020 2020 2020 2020 3a70 6172 616d 2063          :param c
-00035400: 656e 7465 723a 2072 6f74 6174 696f 6e20  enter: rotation 
-00035410: 6365 6e74 6572 2e0a 2020 2020 2020 2020  center..        
-00035420: 3a70 6172 616d 2061 7869 733a 2072 6f74  :param axis: rot
-00035430: 6174 696f 6e20 6178 6973 2e0a 2020 2020  ation axis..    
-00035440: 2020 2020 3a70 6172 616d 2061 6e67 6c65      :param angle
-00035450: 3a20 726f 7461 7469 6f6e 2061 6e67 6c65  : rotation angle
-00035460: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00035470: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00035480: 6172 6e28 2227 696e 706c 6163 6527 206d  arn("'inplace' m
-00035490: 6574 686f 6473 2061 7265 2064 6570 7265  ethods are depre
-000354a0: 6361 7465 642e 2055 7365 2061 206e 6f74  cated. Use a not
-000354b0: 2069 6e70 6c61 6365 206d 6574 686f 6420   inplace method 
-000354c0: 696e 7374 6561 642e 222c 2044 6570 7265  instead.", Depre
-000354d0: 6361 7469 6f6e 5761 726e 696e 6729 0a0a  cationWarning)..
-000354e0: 2020 2020 2020 2020 666f 7220 706f 696e          for poin
-000354f0: 7420 696e 2073 656c 662e 706f 696e 7473  t in self.points
-00035500: 3a0a 2020 2020 2020 2020 2020 2020 706f  :.            po
-00035510: 696e 742e 726f 7461 7469 6f6e 5f69 6e70  int.rotation_inp
-00035520: 6c61 6365 2863 656e 7465 722c 2061 7869  lace(center, axi
-00035530: 732c 2061 6e67 6c65 290a 0a20 2020 2064  s, angle)..    d
-00035540: 6566 2074 7261 6e73 6c61 7469 6f6e 2873  ef translation(s
-00035550: 656c 662c 206f 6666 7365 743a 2076 6f6c  elf, offset: vol
-00035560: 6d64 6c72 2e56 6563 746f 7233 4429 3a0a  mdlr.Vector3D):.
-00035570: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00035580: 2020 2020 436c 6f73 6564 506f 6c79 676f      ClosedPolygo
-00035590: 6e33 4420 7472 616e 736c 6174 696f 6e2e  n3D translation.
-000355a0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000355b0: 206f 6666 7365 743a 2074 7261 6e73 6c61   offset: transla
-000355c0: 7469 6f6e 2076 6563 746f 722e 0a20 2020  tion vector..   
-000355d0: 2020 2020 203a 7265 7475 726e 3a20 4120       :return: A 
-000355e0: 6e65 7720 7472 616e 736c 6174 6564 2043  new translated C
-000355f0: 6c6f 7365 6450 6f6c 7967 6f6e 3344 2e0a  losedPolygon3D..
-00035600: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00035610: 2020 2020 6e65 775f 706f 696e 7473 203d      new_points =
-00035620: 205b 706f 696e 742e 7472 616e 736c 6174   [point.translat
-00035630: 696f 6e28 6f66 6673 6574 2920 666f 7220  ion(offset) for 
-00035640: 706f 696e 7420 696e 0a20 2020 2020 2020  point in.       
-00035650: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00035660: 656c 662e 706f 696e 7473 5d0a 2020 2020  elf.points].    
-00035670: 2020 2020 7265 7475 726e 2043 6c6f 7365      return Close
-00035680: 6450 6f6c 7967 6f6e 3344 286e 6577 5f70  dPolygon3D(new_p
-00035690: 6f69 6e74 732c 2073 656c 662e 6e61 6d65  oints, self.name
-000356a0: 290a 0a20 2020 2064 6566 2074 7261 6e73  )..    def trans
-000356b0: 6c61 7469 6f6e 5f69 6e70 6c61 6365 2873  lation_inplace(s
-000356c0: 656c 662c 206f 6666 7365 743a 2076 6f6c  elf, offset: vol
-000356d0: 6d64 6c72 2e56 6563 746f 7233 4429 3a0a  mdlr.Vector3D):.
-000356e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000356f0: 2020 2020 436c 6f73 6564 506f 6c79 676f      ClosedPolygo
-00035700: 6e33 4420 7472 616e 736c 6174 696f 6e2e  n3D translation.
-00035710: 204f 626a 6563 7420 6973 2075 7064 6174   Object is updat
-00035720: 6564 2069 6e70 6c61 6365 2e0a 0a20 2020  ed inplace...   
-00035730: 2020 2020 203a 7061 7261 6d20 6f66 6673       :param offs
-00035740: 6574 3a20 7472 616e 736c 6174 696f 6e20  et: translation 
-00035750: 7665 6374 6f72 2e0a 2020 2020 2020 2020  vector..        
-00035760: 2222 220a 2020 2020 2020 2020 7761 726e  """.        warn
-00035770: 696e 6773 2e77 6172 6e28 2227 696e 706c  ings.warn("'inpl
-00035780: 6163 6527 206d 6574 686f 6473 2061 7265  ace' methods are
-00035790: 2064 6570 7265 6361 7465 642e 2055 7365   deprecated. Use
-000357a0: 2061 206e 6f74 2069 6e70 6c61 6365 206d   a not inplace m
-000357b0: 6574 686f 6420 696e 7374 6561 642e 222c  ethod instead.",
-000357c0: 2044 6570 7265 6361 7469 6f6e 5761 726e   DeprecationWarn
-000357d0: 696e 6729 0a0a 2020 2020 2020 2020 666f  ing)..        fo
-000357e0: 7220 706f 696e 7420 696e 2073 656c 662e  r point in self.
-000357f0: 706f 696e 7473 3a0a 2020 2020 2020 2020  points:.        
-00035800: 2020 2020 706f 696e 742e 7472 616e 736c      point.transl
-00035810: 6174 696f 6e5f 696e 706c 6163 6528 6f66  ation_inplace(of
-00035820: 6673 6574 290a 0a20 2020 2064 6566 2074  fset)..    def t
-00035830: 6f5f 3264 2873 656c 662c 2070 6c61 6e65  o_2d(self, plane
-00035840: 5f6f 7269 6769 6e2c 2078 2c20 7929 3a0a  _origin, x, y):.
-00035850: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00035860: 2020 2020 5472 616e 7366 6f72 6d73 2061      Transforms a
-00035870: 2043 6c6f 7365 6450 6f6c 7967 6f6e 3344   ClosedPolygon3D
-00035880: 2069 6e74 6f20 616e 2043 6c6f 7365 6450   into an ClosedP
-00035890: 6f6c 7967 6f6e 3244 2c20 6769 7665 6e20  olygon2D, given 
-000358a0: 6120 706c 616e 6520 6f72 6967 696e 2061  a plane origin a
-000358b0: 6e64 2061 6e20 7520 616e 6420 7620 706c  nd an u and v pl
-000358c0: 616e 6520 7665 6374 6f72 2e0a 0a20 2020  ane vector...   
-000358d0: 2020 2020 203a 7061 7261 6d20 706c 616e       :param plan
-000358e0: 655f 6f72 6967 696e 3a20 706c 616e 6520  e_origin: plane 
-000358f0: 6f72 6967 696e 2e0a 2020 2020 2020 2020  origin..        
-00035900: 3a70 6172 616d 2078 3a20 706c 616e 6520  :param x: plane 
-00035910: 7520 7665 6374 6f72 2e0a 2020 2020 2020  u vector..      
-00035920: 2020 3a70 6172 616d 2079 3a20 706c 616e    :param y: plan
-00035930: 6520 7620 7665 6374 6f72 2e0a 2020 2020  e v vector..    
-00035940: 2020 2020 3a72 6574 7572 6e3a 2043 6c6f      :return: Clo
-00035950: 7365 6450 6f6c 7967 6f6e 3244 2e0a 2020  sedPolygon2D..  
-00035960: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00035970: 2020 706f 696e 7473 3264 203d 205b 706f    points2d = [po
-00035980: 696e 742e 746f 5f32 6428 706c 616e 655f  int.to_2d(plane_
-00035990: 6f72 6967 696e 2c20 782c 2079 2920 666f  origin, x, y) fo
-000359a0: 7220 706f 696e 7420 696e 2073 656c 662e  r point in self.
-000359b0: 706f 696e 7473 5d0a 2020 2020 2020 2020  points].        
-000359c0: 7265 7475 726e 2043 6c6f 7365 6450 6f6c  return ClosedPol
-000359d0: 7967 6f6e 3244 2870 6f69 6e74 7332 6429  ygon2D(points2d)
-000359e0: 0a0a 2020 2020 6465 6620 7365 7769 6e67  ..    def sewing
-000359f0: 5f77 6974 6828 7365 6c66 2c20 6f74 6865  _with(self, othe
-00035a00: 725f 706f 6c79 3364 2c20 782c 2079 2c20  r_poly3d, x, y, 
-00035a10: 7265 736f 6c75 7469 6f6e 3d32 3029 3a0a  resolution=20):.
-00035a20: 2020 2020 2020 2020 7365 6c66 5f63 656e          self_cen
-00035a30: 7465 722c 206f 7468 6572 5f63 656e 7465  ter, other_cente
-00035a40: 7220 3d20 7365 6c66 2e61 7665 7261 6765  r = self.average
-00035a50: 5f63 656e 7465 725f 706f 696e 7428 292c  _center_point(),
-00035a60: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
-00035a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035a80: 2020 2020 2020 206f 7468 6572 5f70 6f6c         other_pol
-00035a90: 7933 642e 6176 6572 6167 655f 6365 6e74  y3d.average_cent
-00035aa0: 6572 5f70 6f69 6e74 2829 0a0a 2020 2020  er_point()..    
-00035ab0: 2020 2020 7365 6c66 5f70 6f6c 7932 642c      self_poly2d,
-00035ac0: 206f 7468 6572 5f70 6f6c 7932 6420 3d20   other_poly2d = 
-00035ad0: 7365 6c66 2e74 6f5f 3264 2873 656c 665f  self.to_2d(self_
-00035ae0: 6365 6e74 6572 2c20 782c 2079 292c 205c  center, x, y), \
-00035af0: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
-00035b00: 6572 5f70 6f6c 7933 642e 746f 5f32 6428  er_poly3d.to_2d(
-00035b10: 6f74 6865 725f 6365 6e74 6572 2c20 782c  other_center, x,
-00035b20: 2079 290a 2020 2020 2020 2020 7365 6c66   y).        self
-00035b30: 5f63 656e 7465 7232 642c 206f 7468 6572  _center2d, other
-00035b40: 5f63 656e 7465 7232 6420 3d20 7365 6c66  _center2d = self
-00035b50: 5f70 6f6c 7932 642e 6365 6e74 6572 5f6f  _poly2d.center_o
-00035b60: 665f 6d61 7373 2829 2c20 5c0a 2020 2020  f_mass(), \.    
-00035b70: 2020 2020 2020 2020 6f74 6865 725f 706f          other_po
-00035b80: 6c79 3264 2e63 656e 7465 725f 6f66 5f6d  ly2d.center_of_m
-00035b90: 6173 7328 290a 2020 2020 2020 2020 7365  ass().        se
-00035ba0: 6c66 5f70 6f6c 7932 642e 7472 616e 736c  lf_poly2d.transl
-00035bb0: 6174 696f 6e5f 696e 706c 6163 6528 2d73  ation_inplace(-s
-00035bc0: 656c 665f 6365 6e74 6572 3264 290a 2020  elf_center2d).  
-00035bd0: 2020 2020 2020 6f74 6865 725f 706f 6c79        other_poly
-00035be0: 3264 2e74 7261 6e73 6c61 7469 6f6e 5f69  2d.translation_i
-00035bf0: 6e70 6c61 6365 282d 6f74 6865 725f 6365  nplace(-other_ce
-00035c00: 6e74 6572 3264 290a 0a20 2020 2020 2020  nter2d)..       
-00035c10: 2062 626f 785f 7365 6c66 3264 2c20 6262   bbox_self2d, bb
-00035c20: 6f78 5f6f 7468 6572 3264 203d 2073 656c  ox_other2d = sel
-00035c30: 665f 706f 6c79 3264 2e62 6f75 6e64 696e  f_poly2d.boundin
-00035c40: 675f 7265 6374 616e 676c 652e 626f 756e  g_rectangle.boun
-00035c50: 6473 2829 2c20 5c0a 2020 2020 2020 2020  ds(), \.        
-00035c60: 2020 2020 6f74 6865 725f 706f 6c79 3264      other_poly2d
-00035c70: 2e62 6f75 6e64 696e 675f 7265 6374 616e  .bounding_rectan
-00035c80: 676c 652e 626f 756e 6473 2829 0a20 2020  gle.bounds().   
-00035c90: 2020 2020 2070 6f73 6974 696f 6e20 3d20       position = 
-00035ca0: 5b61 6273 2876 616c 7565 2920 666f 7220  [abs(value) for 
-00035cb0: 7661 6c75 6520 696e 2062 626f 785f 7365  value in bbox_se
-00035cc0: 6c66 3264 5d20 5c0a 2020 2020 2020 2020  lf2d] \.        
-00035cd0: 2020 2020 2b20 5b61 6273 2876 616c 7565      + [abs(value
-00035ce0: 2920 666f 7220 7661 6c75 6520 696e 2062  ) for value in b
-00035cf0: 626f 785f 6f74 6865 7232 645d 0a20 2020  box_other2d].   
-00035d00: 2020 2020 206d 6178 5f73 6361 6c65 203d       max_scale =
-00035d10: 2032 202a 206d 6178 2870 6f73 6974 696f   2 * max(positio
-00035d20: 6e29 0a0a 2020 2020 2020 2020 6c69 6e65  n)..        line
-00035d30: 7320 3d20 5b76 6f6c 6d64 6c72 2e65 6467  s = [volmdlr.edg
-00035d40: 6573 2e4c 696e 6553 6567 6d65 6e74 3244  es.LineSegment2D
-00035d50: 2876 6f6c 6d64 6c72 2e4f 3244 2c20 6d61  (volmdlr.O2D, ma
-00035d60: 785f 7363 616c 6520 2a20 280a 2020 2020  x_scale * (.    
-00035d70: 2020 2020 2020 2020 2020 2020 766f 6c6d              volm
-00035d80: 646c 722e 5832 4420 2a20 6d61 7468 2e73  dlr.X2D * math.s
-00035d90: 696e 286e 202a 2032 202a 206d 6174 682e  in(n * 2 * math.
-00035da0: 7069 202f 2072 6573 6f6c 7574 696f 6e29  pi / resolution)
-00035db0: 202b 0a20 2020 2020 2020 2020 2020 2020   +.             
-00035dc0: 2020 2076 6f6c 6d64 6c72 2e59 3244 202a     volmdlr.Y2D *
-00035dd0: 206d 6174 682e 636f 7328 6e20 2a20 3220   math.cos(n * 2 
-00035de0: 2a20 6d61 7468 2e70 6920 2f20 7265 736f  * math.pi / reso
-00035df0: 6c75 7469 6f6e 2929 0a20 2020 2020 2020  lution)).       
-00035e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035e20: 2020 2020 2020 2920 666f 7220 6e20 696e        ) for n in
-00035e30: 2072 616e 6765 2872 6573 6f6c 7574 696f   range(resolutio
-00035e40: 6e29 5d0a 0a20 2020 2020 2020 2073 656c  n)]..        sel
-00035e50: 665f 6e65 775f 706f 696e 7473 2c20 6f74  f_new_points, ot
-00035e60: 6865 725f 6e65 775f 706f 696e 7473 203d  her_new_points =
-00035e70: 205b 5d2c 205b 5d0a 2020 2020 2020 2020   [], [].        
-00035e80: 666f 7220 6c69 6e65 2069 6e20 6c69 6e65  for line in line
-00035e90: 733a 0a20 2020 2020 2020 2020 2020 2066  s:.            f
-00035ea0: 6f72 2073 656c 665f 6c69 6e65 2069 6e20  or self_line in 
-00035eb0: 7365 6c66 5f70 6f6c 7932 642e 6c69 6e65  self_poly2d.line
-00035ec0: 5f73 6567 6d65 6e74 733a 0a20 2020 2020  _segments:.     
-00035ed0: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
-00035ee0: 7365 6374 203d 206c 696e 652e 6c69 6e65  sect = line.line
-00035ef0: 7365 676d 656e 745f 696e 7465 7273 6563  segment_intersec
-00035f00: 7469 6f6e 7328 7365 6c66 5f6c 696e 6529  tions(self_line)
-00035f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035f20: 2069 6620 696e 7465 7273 6563 743a 0a20   if intersect:. 
-00035f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035f40: 2020 2073 656c 665f 6e65 775f 706f 696e     self_new_poin
-00035f50: 7473 2e65 7874 656e 6428 696e 7465 7273  ts.extend(inters
-00035f60: 6563 7429 0a20 2020 2020 2020 2020 2020  ect).           
-00035f70: 2020 2020 2020 2020 2062 7265 616b 0a0a           break..
-00035f80: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00035f90: 6f74 6865 725f 6c69 6e65 2069 6e20 6f74  other_line in ot
-00035fa0: 6865 725f 706f 6c79 3264 2e6c 696e 655f  her_poly2d.line_
-00035fb0: 7365 676d 656e 7473 3a0a 2020 2020 2020  segments:.      
-00035fc0: 2020 2020 2020 2020 2020 696e 7465 7273            inters
-00035fd0: 6563 7420 3d20 6c69 6e65 2e6c 696e 6573  ect = line.lines
-00035fe0: 6567 6d65 6e74 5f69 6e74 6572 7365 6374  egment_intersect
-00035ff0: 696f 6e73 286f 7468 6572 5f6c 696e 6529  ions(other_line)
-00036000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036010: 2069 6620 696e 7465 7273 6563 743a 0a20   if intersect:. 
-00036020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036030: 2020 206f 7468 6572 5f6e 6577 5f70 6f69     other_new_poi
-00036040: 6e74 732e 6578 7465 6e64 2869 6e74 6572  nts.extend(inter
-00036050: 7365 6374 290a 2020 2020 2020 2020 2020  sect).          
-00036060: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-00036070: 0a20 2020 2020 2020 206e 6577 5f73 656c  .        new_sel
-00036080: 665f 706f 6c79 3264 2c20 6e65 775f 6f74  f_poly2d, new_ot
-00036090: 6865 725f 706f 6c79 3264 203d 2043 6c6f  her_poly2d = Clo
-000360a0: 7365 6450 6f6c 7967 6f6e 3244 280a 2020  sedPolygon2D(.  
-000360b0: 2020 2020 2020 2020 2020 7365 6c66 5f6e            self_n
-000360c0: 6577 5f70 6f69 6e74 7329 2c20 436c 6f73  ew_points), Clos
-000360d0: 6564 506f 6c79 676f 6e32 4428 6f74 6865  edPolygon2D(othe
-000360e0: 725f 6e65 775f 706f 696e 7473 290a 2020  r_new_points).  
-000360f0: 2020 2020 2020 6e65 775f 7365 6c66 5f70        new_self_p
-00036100: 6f6c 7932 642e 7472 616e 736c 6174 696f  oly2d.translatio
-00036110: 6e5f 696e 706c 6163 6528 7365 6c66 5f63  n_inplace(self_c
-00036120: 656e 7465 7232 6429 0a20 2020 2020 2020  enter2d).       
-00036130: 206e 6577 5f6f 7468 6572 5f70 6f6c 7932   new_other_poly2
-00036140: 642e 7472 616e 736c 6174 696f 6e5f 696e  d.translation_in
-00036150: 706c 6163 6528 6f74 6865 725f 6365 6e74  place(other_cent
-00036160: 6572 3264 290a 0a20 2020 2020 2020 206e  er2d)..        n
-00036170: 6577 5f70 6f6c 7931 2c20 6e65 775f 706f  ew_poly1, new_po
-00036180: 6c79 3220 3d20 6e65 775f 7365 6c66 5f70  ly2 = new_self_p
-00036190: 6f6c 7932 642e 746f 5f33 6428 7365 6c66  oly2d.to_3d(self
-000361a0: 5f63 656e 7465 722c 2078 2c20 7929 2c20  _center, x, y), 
-000361b0: 5c0a 2020 2020 2020 2020 2020 2020 6e65  \.            ne
-000361c0: 775f 6f74 6865 725f 706f 6c79 3264 2e74  w_other_poly2d.t
-000361d0: 6f5f 3364 286f 7468 6572 5f63 656e 7465  o_3d(other_cente
-000361e0: 722c 2078 2c20 7929 0a0a 2020 2020 2020  r, x, y)..      
-000361f0: 2020 7472 6961 6e67 6c65 7320 3d20 5b5d    triangles = []
-00036200: 0a20 2020 2020 2020 2066 6f72 2070 6f69  .        for poi
-00036210: 6e74 312c 2070 6f69 6e74 322c 206f 7468  nt1, point2, oth
-00036220: 6572 5f70 6f69 6e74 2069 6e20 7a69 7028  er_point in zip(
-00036230: 6e65 775f 706f 6c79 312e 706f 696e 7473  new_poly1.points
-00036240: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00036250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036270: 206e 6577 5f70 6f6c 7931 2e70 6f69 6e74   new_poly1.point
-00036280: 735b 0a20 2020 2020 2020 2020 2020 2020  s[.             
-00036290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000362a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000362b0: 2020 2020 2020 313a 5d20 2b20 6e65 775f        1:] + new_
-000362c0: 706f 6c79 312e 706f 696e 7473 5b3a 315d  poly1.points[:1]
-000362d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000362e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000362f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036300: 206e 6577 5f70 6f6c 7932 2e70 6f69 6e74   new_poly2.point
-00036310: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00036320: 7472 6961 6e67 6c65 732e 6170 7065 6e64  triangles.append
-00036330: 285b 706f 696e 7431 2c20 706f 696e 7432  ([point1, point2
-00036340: 2c20 6f74 6865 725f 706f 696e 745d 290a  , other_point]).
-00036350: 0a20 2020 2020 2020 2066 6f72 2070 6f69  .        for poi
-00036360: 6e74 312c 2070 6f69 6e74 322c 206f 7468  nt1, point2, oth
-00036370: 6572 5f70 6f69 6e74 2069 6e20 7a69 7028  er_point in zip(
-00036380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036390: 206e 6577 5f70 6f6c 7932 2e70 6f69 6e74   new_poly2.point
-000363a0: 732c 206e 6577 5f70 6f6c 7932 2e70 6f69  s, new_poly2.poi
-000363b0: 6e74 735b 313a 5d20 2b20 6e65 775f 706f  nts[1:] + new_po
-000363c0: 6c79 322e 706f 696e 7473 5b3a 315d 2c0a  ly2.points[:1],.
-000363d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000363e0: 6e65 775f 706f 6c79 312e 706f 696e 7473  new_poly1.points
-000363f0: 5b31 3a5d 202b 206e 6577 5f70 6f6c 7931  [1:] + new_poly1
-00036400: 2e70 6f69 6e74 735b 3a31 5d29 3a0a 2020  .points[:1]):.  
-00036410: 2020 2020 2020 2020 2020 7472 6961 6e67            triang
-00036420: 6c65 732e 6170 7065 6e64 285b 6f74 6865  les.append([othe
-00036430: 725f 706f 696e 742c 2070 6f69 6e74 322c  r_point, point2,
-00036440: 2070 6f69 6e74 315d 290a 0a20 2020 2020   point1])..     
-00036450: 2020 2072 6574 7572 6e20 7472 6961 6e67     return triang
-00036460: 6c65 730a 0a20 2020 2064 6566 2073 696d  les..    def sim
-00036470: 706c 6966 7928 7365 6c66 2c20 6d69 6e5f  plify(self, min_
-00036480: 6469 7374 616e 6365 3a20 666c 6f61 7420  distance: float 
-00036490: 3d20 302e 3031 2c20 6d61 785f 6469 7374  = 0.01, max_dist
-000364a0: 616e 6365 3a20 666c 6f61 7420 3d20 302e  ance: float = 0.
-000364b0: 3035 293a 0a20 2020 2020 2020 2022 2222  05):.        """
-000364c0: 0a20 2020 2020 2020 2053 696d 706c 6966  .        Simplif
-000364d0: 6965 7320 706f 6c79 676f 6e33 642e 0a0a  ies polygon3d...
-000364e0: 2020 2020 2020 2020 3a70 6172 616d 206d          :param m
-000364f0: 696e 5f64 6973 7461 6e63 653a 206d 696e  in_distance: min
-00036500: 696d 616c 2061 6c6c 6f77 6564 2064 6973  imal allowed dis
-00036510: 7461 6e63 652e 0a20 2020 2020 2020 203a  tance..        :
-00036520: 7061 7261 6d20 6d61 785f 6469 7374 616e  param max_distan
-00036530: 6365 3a20 6d61 7869 6d61 6c20 616c 6c6f  ce: maximal allo
-00036540: 7765 6420 6469 7374 616e 6365 2e0a 2020  wed distance..  
-00036550: 2020 2020 2020 3a72 6574 7572 6e3a 2053        :return: S
-00036560: 696d 706c 6966 6965 6420 636c 6f73 6564  implified closed
-00036570: 2070 6f6c 7967 6f6e 2033 642e 0a20 2020   polygon 3d..   
-00036580: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00036590: 2072 6574 7572 6e20 436c 6f73 6564 506f   return ClosedPo
-000365a0: 6c79 676f 6e33 4428 7365 6c66 2e73 696d  lygon3D(self.sim
-000365b0: 706c 6966 795f 706f 6c79 676f 6e28 0a20  plify_polygon(. 
-000365c0: 2020 2020 2020 2020 2020 206d 696e 5f64             min_d
-000365d0: 6973 7461 6e63 653d 6d69 6e5f 6469 7374  istance=min_dist
-000365e0: 616e 6365 2c20 6d61 785f 6469 7374 616e  ance, max_distan
-000365f0: 6365 3d6d 6178 5f64 6973 7461 6e63 6529  ce=max_distance)
-00036600: 2e70 6f69 6e74 7329 0a0a 2020 2020 6465  .points)..    de
-00036610: 6620 636f 6e76 6578 5f73 6577 696e 6728  f convex_sewing(
-00036620: 7365 6c66 2c20 706f 6c79 676f 6e32 2c20  self, polygon2, 
-00036630: 782c 2079 293a 0a20 2020 2020 2020 2022  x, y):.        "
-00036640: 2222 0a20 2020 2020 2020 2053 6577 2074  "".        Sew t
-00036650: 6f20 436f 6e76 6578 2050 6f6c 7967 6f6e  o Convex Polygon
-00036660: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00036670: 6d20 706f 6c79 676f 6e32 3a20 6f74 6865  m polygon2: othe
-00036680: 7220 706f 6c79 676f 6e20 746f 2073 6577  r polygon to sew
-00036690: 2077 6974 682e 0a20 2020 2020 2020 203a   with..        :
-000366a0: 7061 7261 6d20 783a 2075 2076 6563 746f  param x: u vecto
-000366b0: 7220 666f 7220 706c 616e 6520 7072 6f6a  r for plane proj
-000366c0: 6563 7469 6f6e 2e0a 2020 2020 2020 2020  ection..        
-000366d0: 3a70 6172 616d 2079 3a20 7620 7665 6374  :param y: v vect
-000366e0: 6f72 2066 6f72 2070 6c61 6e65 2070 726f  or for plane pro
-000366f0: 6a65 6374 696f 6e2e 0a20 2020 2020 2020  jection..       
-00036700: 2022 2222 0a20 2020 2020 2020 2063 656e   """.        cen
-00036710: 7465 7231 2c20 6365 6e74 6572 3220 3d20  ter1, center2 = 
-00036720: 7365 6c66 2e61 7665 7261 6765 5f63 656e  self.average_cen
-00036730: 7465 725f 706f 696e 7428 292c 2070 6f6c  ter_point(), pol
-00036740: 7967 6f6e 322e 6176 6572 6167 655f 6365  ygon2.average_ce
-00036750: 6e74 6572 5f70 6f69 6e74 2829 0a20 2020  nter_point().   
-00036760: 2020 2020 2063 656e 7465 7231 5f2c 2063       center1_, c
-00036770: 656e 7465 7232 5f20 3d20 766f 6c6d 646c  enter2_ = volmdl
-00036780: 722e 506f 696e 7433 4428 6365 6e74 6572  r.Point3D(center
-00036790: 312e 782c 2063 656e 7465 7231 2e79 2c20  1.x, center1.y, 
-000367a0: 3029 2c20 766f 6c6d 646c 722e 506f 696e  0), volmdlr.Poin
-000367b0: 7433 4428 6365 6e74 6572 322e 782c 2063  t3D(center2.x, c
-000367c0: 656e 7465 7232 2e79 2c20 3029 0a20 2020  enter2.y, 0).   
-000367d0: 2020 2020 206e 6577 5f70 6f6c 7967 6f6e       new_polygon
-000367e0: 312c 206e 6577 5f70 6f6c 7967 6f6e 3220  1, new_polygon2 
-000367f0: 3d20 7365 6c66 2e74 7261 6e73 6c61 7469  = self.translati
-00036800: 6f6e 282d 6365 6e74 6572 315f 292c 2070  on(-center1_), p
-00036810: 6f6c 7967 6f6e 322e 7472 616e 736c 6174  olygon2.translat
-00036820: 696f 6e28 2d63 656e 7465 7232 5f29 0a20  ion(-center2_). 
-00036830: 2020 2020 2020 206e 6577 5f63 656e 7465         new_cente
-00036840: 7231 2c20 6e65 775f 6365 6e74 6572 3220  r1, new_center2 
-00036850: 3d20 6e65 775f 706f 6c79 676f 6e31 2e61  = new_polygon1.a
-00036860: 7665 7261 6765 5f63 656e 7465 725f 706f  verage_center_po
-00036870: 696e 7428 292c 206e 6577 5f70 6f6c 7967  int(), new_polyg
-00036880: 6f6e 322e 6176 6572 6167 655f 6365 6e74  on2.average_cent
-00036890: 6572 5f70 6f69 6e74 2829 0a0a 2020 2020  er_point()..    
-000368a0: 2020 2020 6e65 775f 706f 6c79 676f 6e31      new_polygon1
-000368b0: 5f32 642c 206e 6577 5f70 6f6c 7967 6f6e  _2d, new_polygon
-000368c0: 325f 3264 203d 5c0a 2020 2020 2020 2020  2_2d =\.        
-000368d0: 2020 2020 6e65 775f 706f 6c79 676f 6e31      new_polygon1
-000368e0: 2e74 6f5f 3264 286e 6577 5f63 656e 7465  .to_2d(new_cente
-000368f0: 7231 2c20 782c 2079 292c 206e 6577 5f70  r1, x, y), new_p
-00036900: 6f6c 7967 6f6e 322e 746f 5f32 6428 6e65  olygon2.to_2d(ne
-00036910: 775f 6365 6e74 6572 322c 2078 2c20 7929  w_center2, x, y)
-00036920: 0a0a 2020 2020 2020 2020 6469 6374 5f63  ..        dict_c
-00036930: 6c6f 7369 6e67 5f70 6169 7273 203d 207b  losing_pairs = {
-00036940: 7d0a 2020 2020 2020 2020 7472 6961 6e67  }.        triang
-00036950: 6c65 7320 3d20 5b5d 0a20 2020 2020 2020  les = [].       
-00036960: 206c 6973 745f 636c 6f73 696e 675f 706f   list_closing_po
-00036970: 696e 745f 696e 6465 7865 7320 3d20 5b5d  int_indexes = []
-00036980: 0a20 2020 2020 2020 206e 6577 5f70 6f6c  .        new_pol
-00036990: 7967 6f6e 315f 3264 5f70 6f69 6e74 7320  ygon1_2d_points 
-000369a0: 3d20 6e65 775f 706f 6c79 676f 6e31 5f32  = new_polygon1_2
-000369b0: 642e 706f 696e 7473 202b 205b 0a20 2020  d.points + [.   
-000369c0: 2020 2020 2020 2020 206e 6577 5f70 6f6c           new_pol
-000369d0: 7967 6f6e 315f 3264 2e70 6f69 6e74 735b  ygon1_2d.points[
-000369e0: 305d 5d0a 2020 2020 2020 2020 666f 7220  0]].        for 
-000369f0: 692c 2070 6f69 6e74 5f70 6f6c 7967 6f6e  i, point_polygon
-00036a00: 3120 696e 2065 6e75 6d65 7261 7465 280a  1 in enumerate(.
-00036a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036a20: 6e65 775f 706f 6c79 676f 6e31 2e70 6f69  new_polygon1.poi
-00036a30: 6e74 7320 2b20 5b6e 6577 5f70 6f6c 7967  nts + [new_polyg
-00036a40: 6f6e 312e 706f 696e 7473 5b30 5d5d 293a  on1.points[0]]):
-00036a50: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00036a60: 6920 213d 2030 3a0a 2020 2020 2020 2020  i != 0:.        
-00036a70: 2020 2020 2020 2020 6d65 616e 5f70 6f69          mean_poi
-00036a80: 6e74 3264 203d 2030 2e35 202a 2028 0a20  nt2d = 0.5 * (. 
-00036a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036aa0: 2020 2020 2020 206e 6577 5f70 6f6c 7967         new_polyg
-00036ab0: 6f6e 315f 3264 5f70 6f69 6e74 735b 695d  on1_2d_points[i]
-00036ac0: 202b 206e 6577 5f70 6f6c 7967 6f6e 315f   + new_polygon1_
-00036ad0: 3264 5f70 6f69 6e74 735b 0a20 2020 2020  2d_points[.     
-00036ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036af0: 2020 2020 2020 2069 202d 2031 5d29 0a20         i - 1]). 
-00036b00: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00036b10: 6c6f 7369 6e67 5f70 6f69 6e74 203d 206e  losing_point = n
-00036b20: 6577 5f70 6f6c 7967 6f6e 325f 3264 2e6c  ew_polygon2_2d.l
-00036b30: 696e 655f 696e 7465 7273 6563 7469 6e67  ine_intersecting
-00036b40: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 280a  _closing_point(.
+00033c70: 2020 2073 656c 662e 6d69 6e6f 725f 6178     self.minor_ax
+00033c80: 6973 202a 206d 6174 682e 7369 6e28 616e  is * math.sin(an
+00033c90: 676c 6529 2c20 3029 290a 0a20 2020 2020  gle), 0))..     
+00033ca0: 2020 2072 6574 7572 6e20 766f 6c6d 646c     return volmdl
+00033cb0: 722e 6564 6765 732e 4172 6345 6c6c 6970  r.edges.ArcEllip
+00033cc0: 7365 3344 2870 6f69 6e74 312c 2070 332c  se3D(point1, p3,
+00033cd0: 2070 6f69 6e74 322c 2073 656c 662e 6365   point2, self.ce
+00033ce0: 6e74 6572 2c0a 2020 2020 2020 2020 2020  nter,.          
+00033cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033d10: 7365 6c66 2e6d 616a 6f72 5f64 6972 290a  self.major_dir).
+00033d20: 0a20 2020 2064 6566 2072 6f74 6174 696f  .    def rotatio
+00033d30: 6e28 7365 6c66 2c20 6365 6e74 6572 3a20  n(self, center: 
+00033d40: 766f 6c6d 646c 722e 506f 696e 7433 442c  volmdlr.Point3D,
+00033d50: 2061 7869 733a 2076 6f6c 6d64 6c72 2e56   axis: volmdlr.V
+00033d60: 6563 746f 7233 442c 2061 6e67 6c65 3a20  ector3D, angle: 
+00033d70: 666c 6f61 7429 3a0a 2020 2020 2020 2020  float):.        
+00033d80: 2222 220a 2020 2020 2020 2020 456c 6c69  """.        Elli
+00033d90: 7073 6533 4420 726f 7461 7469 6f6e 2e0a  pse3D rotation..
+00033da0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00033db0: 6365 6e74 6572 3a20 726f 7461 7469 6f6e  center: rotation
+00033dc0: 2063 656e 7465 722e 0a20 2020 2020 2020   center..       
+00033dd0: 203a 7061 7261 6d20 6178 6973 3a20 726f   :param axis: ro
+00033de0: 7461 7469 6f6e 2061 7869 732e 0a20 2020  tation axis..   
+00033df0: 2020 2020 203a 7061 7261 6d20 616e 676c       :param angl
+00033e00: 653a 2061 6e67 6c65 2072 6f74 6174 696f  e: angle rotatio
+00033e10: 6e2e 0a20 2020 2020 2020 203a 7265 7475  n..        :retu
+00033e20: 726e 3a20 6120 6e65 7720 726f 7461 7465  rn: a new rotate
+00033e30: 6420 456c 6c69 7073 6533 442e 0a20 2020  d Ellipse3D..   
+00033e40: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00033e50: 206e 6577 5f63 656e 7465 7220 3d20 7365   new_center = se
+00033e60: 6c66 2e63 656e 7465 722e 726f 7461 7469  lf.center.rotati
+00033e70: 6f6e 2863 656e 7465 722c 2061 7869 732c  on(center, axis,
+00033e80: 2061 6e67 6c65 290a 2020 2020 2020 2020   angle).        
+00033e90: 6e65 775f 6e6f 726d 616c 203d 2073 656c  new_normal = sel
+00033ea0: 662e 6e6f 726d 616c 2e72 6f74 6174 696f  f.normal.rotatio
+00033eb0: 6e28 6365 6e74 6572 2c20 6178 6973 2c20  n(center, axis, 
+00033ec0: 616e 676c 6529 0a20 2020 2020 2020 206e  angle).        n
+00033ed0: 6577 5f6d 616a 6f72 5f64 6972 203d 2073  ew_major_dir = s
+00033ee0: 656c 662e 6d61 6a6f 725f 6469 722e 726f  elf.major_dir.ro
+00033ef0: 7461 7469 6f6e 2863 656e 7465 722c 2061  tation(center, a
+00033f00: 7869 732c 2061 6e67 6c65 290a 2020 2020  xis, angle).    
+00033f10: 2020 2020 7265 7475 726e 2045 6c6c 6970      return Ellip
+00033f20: 7365 3344 2873 656c 662e 6d61 6a6f 725f  se3D(self.major_
+00033f30: 6178 6973 2c20 7365 6c66 2e6d 696e 6f72  axis, self.minor
+00033f40: 5f61 7869 732c 206e 6577 5f63 656e 7465  _axis, new_cente
+00033f50: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
+00033f60: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+00033f70: 6e6f 726d 616c 2c20 6e65 775f 6d61 6a6f  normal, new_majo
+00033f80: 725f 6469 722c 2073 656c 662e 6e61 6d65  r_dir, self.name
+00033f90: 290a 0a20 2020 2064 6566 2072 6f74 6174  )..    def rotat
+00033fa0: 696f 6e5f 696e 706c 6163 6528 7365 6c66  ion_inplace(self
+00033fb0: 2c20 6365 6e74 6572 3a20 766f 6c6d 646c  , center: volmdl
+00033fc0: 722e 506f 696e 7433 442c 2061 7869 733a  r.Point3D, axis:
+00033fd0: 2076 6f6c 6d64 6c72 2e56 6563 746f 7233   volmdlr.Vector3
+00033fe0: 442c 2061 6e67 6c65 3a20 666c 6f61 7429  D, angle: float)
+00033ff0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00034000: 2020 2020 2020 456c 6c69 7073 6533 4420        Ellipse3D 
+00034010: 726f 7461 7469 6f6e 2e20 4f62 6a65 6374  rotation. Object
+00034020: 2069 7320 7570 6461 7465 6420 696e 706c   is updated inpl
+00034030: 6163 652e 0a0a 2020 2020 2020 2020 3a70  ace...        :p
+00034040: 6172 616d 2063 656e 7465 723a 2072 6f74  aram center: rot
+00034050: 6174 696f 6e20 6365 6e74 6572 0a20 2020  ation center.   
+00034060: 2020 2020 203a 7061 7261 6d20 6178 6973       :param axis
+00034070: 3a20 726f 7461 7469 6f6e 2061 7869 730a  : rotation axis.
+00034080: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
+00034090: 6e67 6c65 3a20 726f 7461 7469 6f6e 2061  ngle: rotation a
+000340a0: 6e67 6c65 0a20 2020 2020 2020 2022 2222  ngle.        """
+000340b0: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
+000340c0: 732e 7761 726e 2822 2769 6e70 6c61 6365  s.warn("'inplace
+000340d0: 2720 6d65 7468 6f64 7320 6172 6520 6465  ' methods are de
+000340e0: 7072 6563 6174 6564 2e20 5573 6520 6120  precated. Use a 
+000340f0: 6e6f 7420 696e 706c 6163 6520 6d65 7468  not inplace meth
+00034100: 6f64 2069 6e73 7465 6164 2e22 2c20 4465  od instead.", De
+00034110: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
+00034120: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00034130: 6365 6e74 6572 2e72 6f74 6174 696f 6e5f  center.rotation_
+00034140: 696e 706c 6163 6528 6365 6e74 6572 2c20  inplace(center, 
+00034150: 6178 6973 2c20 616e 676c 6529 0a20 2020  axis, angle).   
+00034160: 2020 2020 2073 656c 662e 6e6f 726d 616c       self.normal
+00034170: 2e72 6f74 6174 696f 6e5f 696e 706c 6163  .rotation_inplac
+00034180: 6528 6365 6e74 6572 2c20 6178 6973 2c20  e(center, axis, 
+00034190: 616e 676c 6529 0a20 2020 2020 2020 2073  angle).        s
+000341a0: 656c 662e 6d61 6a6f 725f 6469 722e 726f  elf.major_dir.ro
+000341b0: 7461 7469 6f6e 5f69 6e70 6c61 6365 2863  tation_inplace(c
+000341c0: 656e 7465 722c 2061 7869 732c 2061 6e67  enter, axis, ang
+000341d0: 6c65 290a 0a20 2020 2064 6566 2074 7261  le)..    def tra
+000341e0: 6e73 6c61 7469 6f6e 2873 656c 662c 206f  nslation(self, o
+000341f0: 6666 7365 743a 2076 6f6c 6d64 6c72 2e56  ffset: volmdlr.V
+00034200: 6563 746f 7233 4429 3a0a 2020 2020 2020  ector3D):.      
+00034210: 2020 2222 220a 2020 2020 2020 2020 456c    """.        El
+00034220: 6c69 7073 6533 4420 7472 616e 736c 6174  lipse3D translat
+00034230: 696f 6e0a 2020 2020 2020 2020 3a70 6172  ion.        :par
+00034240: 616d 206f 6666 7365 743a 2074 7261 6e73  am offset: trans
+00034250: 6c61 7469 6f6e 2076 6563 746f 720a 2020  lation vector.  
+00034260: 2020 2020 2020 3a72 6574 7572 6e3a 2041        :return: A
+00034270: 206e 6577 2074 7261 6e73 6c61 7465 6420   new translated 
+00034280: 456c 6c69 7073 6533 440a 2020 2020 2020  Ellipse3D.      
+00034290: 2020 2222 220a 2020 2020 2020 2020 6e65    """.        ne
+000342a0: 775f 6365 6e74 6572 203d 2073 656c 662e  w_center = self.
+000342b0: 6365 6e74 6572 2e74 7261 6e73 6c61 7469  center.translati
+000342c0: 6f6e 286f 6666 7365 7429 0a20 2020 2020  on(offset).     
+000342d0: 2020 206e 6577 5f6e 6f72 6d61 6c20 3d20     new_normal = 
+000342e0: 7365 6c66 2e6e 6f72 6d61 6c2e 7472 616e  self.normal.tran
+000342f0: 736c 6174 696f 6e28 6f66 6673 6574 290a  slation(offset).
+00034300: 2020 2020 2020 2020 6e65 775f 6d61 6a6f          new_majo
+00034310: 725f 6469 7220 3d20 7365 6c66 2e6d 616a  r_dir = self.maj
+00034320: 6f72 5f64 6972 2e74 7261 6e73 6c61 7469  or_dir.translati
+00034330: 6f6e 286f 6666 7365 7429 0a20 2020 2020  on(offset).     
+00034340: 2020 2072 6574 7572 6e20 456c 6c69 7073     return Ellips
+00034350: 6533 4428 7365 6c66 2e6d 616a 6f72 5f61  e3D(self.major_a
+00034360: 7869 732c 2073 656c 662e 6d69 6e6f 725f  xis, self.minor_
+00034370: 6178 6973 2c20 6e65 775f 6365 6e74 6572  axis, new_center
+00034380: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00034390: 2020 2020 2020 2020 2020 206e 6577 5f6e             new_n
+000343a0: 6f72 6d61 6c2c 206e 6577 5f6d 616a 6f72  ormal, new_major
+000343b0: 5f64 6972 2c20 7365 6c66 2e6e 616d 6529  _dir, self.name)
+000343c0: 0a0a 2020 2020 6465 6620 7472 616e 736c  ..    def transl
+000343d0: 6174 696f 6e5f 696e 706c 6163 6528 7365  ation_inplace(se
+000343e0: 6c66 2c20 6f66 6673 6574 3a20 766f 6c6d  lf, offset: volm
+000343f0: 646c 722e 5665 6374 6f72 3344 293a 0a20  dlr.Vector3D):. 
+00034400: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00034410: 2020 2045 6c6c 6970 7365 3344 2074 7261     Ellipse3D tra
+00034420: 6e73 6c61 7469 6f6e 2e20 4f62 6a65 6374  nslation. Object
+00034430: 2069 7320 7570 6461 7465 6420 696e 706c   is updated inpl
+00034440: 6163 652e 0a0a 2020 2020 2020 2020 3a70  ace...        :p
+00034450: 6172 616d 206f 6666 7365 743a 2074 7261  aram offset: tra
+00034460: 6e73 6c61 7469 6f6e 2076 6563 746f 720a  nslation vector.
+00034470: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00034480: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00034490: 6e28 2227 696e 706c 6163 6527 206d 6574  n("'inplace' met
+000344a0: 686f 6473 2061 7265 2064 6570 7265 6361  hods are depreca
+000344b0: 7465 642e 2055 7365 2061 206e 6f74 2069  ted. Use a not i
+000344c0: 6e70 6c61 6365 206d 6574 686f 6420 696e  nplace method in
+000344d0: 7374 6561 642e 222c 2044 6570 7265 6361  stead.", Depreca
+000344e0: 7469 6f6e 5761 726e 696e 6729 0a0a 2020  tionWarning)..  
+000344f0: 2020 2020 2020 7365 6c66 2e63 656e 7465        self.cente
+00034500: 722e 7472 616e 736c 6174 696f 6e5f 696e  r.translation_in
+00034510: 706c 6163 6528 6f66 6673 6574 290a 2020  place(offset).  
+00034520: 2020 2020 2020 7365 6c66 2e6e 6f72 6d61        self.norma
+00034530: 6c2e 7472 616e 736c 6174 696f 6e5f 696e  l.translation_in
+00034540: 706c 6163 6528 6f66 6673 6574 290a 2020  place(offset).  
+00034550: 2020 2020 2020 7365 6c66 2e6d 616a 6f72        self.major
+00034560: 5f64 6972 2e74 7261 6e73 6c61 7469 6f6e  _dir.translation
+00034570: 5f69 6e70 6c61 6365 286f 6666 7365 7429  _inplace(offset)
+00034580: 0a0a 2020 2020 6465 6620 706c 6f74 2873  ..    def plot(s
+00034590: 656c 662c 2061 783d 4e6f 6e65 2c20 636f  elf, ax=None, co
+000345a0: 6c6f 723d 276b 272c 2061 6c70 6861 3d31  lor='k', alpha=1
+000345b0: 2c20 6564 6765 5f64 6574 6169 6c73 3d46  , edge_details=F
+000345c0: 616c 7365 293a 0a20 2020 2020 2020 2069  alse):.        i
+000345d0: 6620 6178 2069 7320 4e6f 6e65 3a0a 2020  f ax is None:.  
+000345e0: 2020 2020 2020 2020 2020 6669 6720 3d20            fig = 
+000345f0: 706c 742e 6669 6775 7265 2829 0a20 2020  plt.figure().   
+00034600: 2020 2020 2020 2020 2061 7820 3d20 4178           ax = Ax
+00034610: 6573 3344 2866 6967 290a 2020 2020 2020  es3D(fig).      
+00034620: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00034630: 2020 2020 6669 6720 3d20 4e6f 6e65 0a0a      fig = None..
+00034640: 2020 2020 2020 2020 7820 3d20 5b5d 0a20          x = []. 
+00034650: 2020 2020 2020 2079 203d 205b 5d0a 2020         y = [].  
+00034660: 2020 2020 2020 7a20 3d20 5b5d 0a20 2020        z = [].   
+00034670: 2020 2020 2066 6f72 2070 782c 2070 792c       for px, py,
+00034680: 2070 7a20 696e 2073 656c 662e 6469 7363   pz in self.disc
+00034690: 7265 7469 7a61 7469 6f6e 5f70 6f69 6e74  retization_point
+000346a0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+000346b0: 2078 2e61 7070 656e 6428 7078 290a 2020   x.append(px).  
+000346c0: 2020 2020 2020 2020 2020 792e 6170 7065            y.appe
+000346d0: 6e64 2870 7929 0a20 2020 2020 2020 2020  nd(py).         
+000346e0: 2020 207a 2e61 7070 656e 6428 707a 290a     z.append(pz).
+000346f0: 2020 2020 2020 2020 782e 6170 7065 6e64          x.append
+00034700: 2878 5b30 5d29 0a20 2020 2020 2020 2079  (x[0]).        y
+00034710: 2e61 7070 656e 6428 795b 305d 290a 2020  .append(y[0]).  
+00034720: 2020 2020 2020 7a2e 6170 7065 6e64 287a        z.append(z
+00034730: 5b30 5d29 0a20 2020 2020 2020 2061 782e  [0]).        ax.
+00034740: 706c 6f74 2878 2c20 792c 207a 2c20 636f  plot(x, y, z, co
+00034750: 6c6f 7229 0a20 2020 2020 2020 2072 6574  lor).        ret
+00034760: 7572 6e20 6178 0a0a 2020 2020 4063 6c61  urn ax..    @cla
+00034770: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+00034780: 2066 726f 6d5f 7374 6570 2863 6c73 2c20   from_step(cls, 
+00034790: 6172 6775 6d65 6e74 732c 206f 626a 6563  arguments, objec
+000347a0: 745f 6469 6374 293a 0a20 2020 2020 2020  t_dict):.       
+000347b0: 2022 2222 0a20 2020 2020 2020 2043 6f6e   """.        Con
+000347c0: 7665 7274 7320 6120 7374 6570 2070 7269  verts a step pri
+000347d0: 6d69 7469 7665 2074 6f20 6120 456c 6c69  mitive to a Elli
+000347e0: 7073 6533 442e 0a0a 2020 2020 2020 2020  pse3D...        
+000347f0: 3a70 6172 616d 2061 7267 756d 656e 7473  :param arguments
+00034800: 3a20 5468 6520 6172 6775 6d65 6e74 7320  : The arguments 
+00034810: 6f66 2074 6865 2073 7465 7020 7072 696d  of the step prim
+00034820: 6974 6976 652e 2054 6865 206c 6173 7420  itive. The last 
+00034830: 656c 656d 656e 7420 7265 7072 6573 656e  element represen
+00034840: 7473 2074 6865 2075 6e69 745f 636f 6e76  ts the unit_conv
+00034850: 6572 7369 6f6e 5f66 6163 746f 722e 0a20  ersion_factor.. 
+00034860: 2020 2020 2020 203a 7479 7065 2061 7267         :type arg
+00034870: 756d 656e 7473 3a20 6c69 7374 0a20 2020  uments: list.   
+00034880: 2020 2020 203a 7061 7261 6d20 6f62 6a65       :param obje
+00034890: 6374 5f64 6963 743a 2054 6865 2064 6963  ct_dict: The dic
+000348a0: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
+000348b0: 6e67 2061 6c6c 2074 6865 2073 7465 7020  ng all the step 
+000348c0: 7072 696d 6974 6976 6573 2074 6861 7420  primitives that 
+000348d0: 6861 7665 2061 6c72 6561 6479 2062 6565  have already bee
+000348e0: 6e20 696e 7374 616e 7469 6174 6564 2e0a  n instantiated..
+000348f0: 2020 2020 2020 2020 3a74 7970 6520 6f62          :type ob
+00034900: 6a65 6374 5f64 6963 743a 2064 6963 740a  ject_dict: dict.
+00034910: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+00034920: 2054 6865 2063 6f72 7265 7370 6f6e 6469   The correspondi
+00034930: 6e67 2045 6c6c 6970 7365 3344 206f 626a  ng Ellipse3D obj
+00034940: 6563 742e 0a20 2020 2020 2020 203a 7274  ect..        :rt
+00034950: 7970 653a 203a 636c 6173 733a 6076 6f6c  ype: :class:`vol
+00034960: 6d64 6c72 2e77 6972 6573 2e45 6c6c 6970  mdlr.wires.Ellip
+00034970: 7365 3344 600a 2020 2020 2020 2020 2222  se3D`.        ""
+00034980: 220a 2020 2020 2020 2020 756e 6974 5f63  ".        unit_c
+00034990: 6f6e 7665 7273 696f 6e5f 6661 6374 6f72  onversion_factor
+000349a0: 203d 2061 7267 756d 656e 7473 5b2d 315d   = arguments[-1]
+000349b0: 0a20 2020 2020 2020 2063 656e 7465 7220  .        center 
+000349c0: 3d20 6f62 6a65 6374 5f64 6963 745b 6172  = object_dict[ar
+000349d0: 6775 6d65 6e74 735b 315d 5d2e 6f72 6967  guments[1]].orig
+000349e0: 696e 0a20 2020 2020 2020 206e 6f72 6d61  in.        norma
+000349f0: 6c20 3d20 6f62 6a65 6374 5f64 6963 745b  l = object_dict[
+00034a00: 6172 6775 6d65 6e74 735b 315d 5d2e 7520  arguments[1]].u 
+00034a10: 2023 2061 6e63 6965 6e20 770a 2020 2020   # ancien w.    
+00034a20: 2020 2020 6d61 6a6f 725f 6469 7220 3d20      major_dir = 
+00034a30: 6f62 6a65 6374 5f64 6963 745b 6172 6775  object_dict[argu
+00034a40: 6d65 6e74 735b 315d 5d2e 7620 2023 2061  ments[1]].v  # a
+00034a50: 6e63 6965 6e20 750a 2020 2020 2020 2020  ncien u.        
+00034a60: 6d61 6a6f 725f 6178 6973 203d 2066 6c6f  major_axis = flo
+00034a70: 6174 2861 7267 756d 656e 7473 5b32 5d29  at(arguments[2])
+00034a80: 202a 2075 6e69 745f 636f 6e76 6572 7369   * unit_conversi
+00034a90: 6f6e 5f66 6163 746f 720a 2020 2020 2020  on_factor.      
+00034aa0: 2020 6d69 6e6f 725f 6178 6973 203d 2066    minor_axis = f
+00034ab0: 6c6f 6174 2861 7267 756d 656e 7473 5b33  loat(arguments[3
+00034ac0: 5d29 202a 2075 6e69 745f 636f 6e76 6572  ]) * unit_conver
+00034ad0: 7369 6f6e 5f66 6163 746f 720a 2020 2020  sion_factor.    
+00034ae0: 2020 2020 7265 7475 726e 2063 6c73 286d      return cls(m
+00034af0: 616a 6f72 5f61 7869 732c 206d 696e 6f72  ajor_axis, minor
+00034b00: 5f61 7869 732c 2063 656e 7465 722c 206e  _axis, center, n
+00034b10: 6f72 6d61 6c2c 206d 616a 6f72 5f64 6972  ormal, major_dir
+00034b20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00034b30: 2020 2020 2061 7267 756d 656e 7473 5b30       arguments[0
+00034b40: 5d5b 313a 2d31 5d29 0a0a 0a63 6c61 7373  ][1:-1])...class
+00034b50: 2043 6c6f 7365 6450 6f6c 7967 6f6e 3344   ClosedPolygon3D
+00034b60: 2843 6f6e 746f 7572 3344 2c20 436c 6f73  (Contour3D, Clos
+00034b70: 6564 506f 6c79 676f 6e4d 6978 696e 293a  edPolygonMixin):
+00034b80: 0a20 2020 2022 2222 0a20 2020 2041 2063  .    """.    A c
+00034b90: 6f6c 6c65 6374 696f 6e20 6f66 2070 6f69  ollection of poi
+00034ba0: 6e74 732c 2063 6f6e 6e65 6374 6564 2062  nts, connected b
+00034bb0: 7920 6c69 6e65 7365 676d 656e 7473 2c20  y linesegments, 
+00034bc0: 666f 6c6c 6f77 696e 6720 6561 6368 206f  following each o
+00034bd0: 7468 6572 2e0a 0a20 2020 2022 2222 0a20  ther...    """. 
+00034be0: 2020 205f 6e6f 6e5f 7365 7269 616c 697a     _non_serializ
+00034bf0: 6162 6c65 5f61 7474 7269 6275 7465 7320  able_attributes 
+00034c00: 3d20 5b27 6c69 6e65 5f73 6567 6d65 6e74  = ['line_segment
+00034c10: 7327 2c20 2770 7269 6d69 7469 7665 7327  s', 'primitives'
+00034c20: 5d0a 2020 2020 5f6e 6f6e 5f65 715f 6174  ].    _non_eq_at
+00034c30: 7472 6962 7574 6573 203d 205b 276c 696e  tributes = ['lin
+00034c40: 655f 7365 676d 656e 7473 272c 2027 7072  e_segments', 'pr
+00034c50: 696d 6974 6976 6573 275d 0a0a 2020 2020  imitives']..    
+00034c60: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00034c70: 662c 2070 6f69 6e74 733a 204c 6973 745b  f, points: List[
+00034c80: 766f 6c6d 646c 722e 506f 696e 7433 445d  volmdlr.Point3D]
+00034c90: 2c20 6e61 6d65 3a20 7374 7220 3d20 2727  , name: str = ''
+00034ca0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+00034cb0: 706f 696e 7473 203d 2070 6f69 6e74 730a  points = points.
+00034cc0: 2020 2020 2020 2020 7365 6c66 2e5f 6c69          self._li
+00034cd0: 6e65 5f73 6567 6d65 6e74 7320 3d20 4e6f  ne_segments = No
+00034ce0: 6e65 0a0a 2020 2020 2020 2020 436f 6e74  ne..        Cont
+00034cf0: 6f75 7233 442e 5f5f 696e 6974 5f5f 2873  our3D.__init__(s
+00034d00: 656c 662c 2073 656c 662e 6c69 6e65 5f73  elf, self.line_s
+00034d10: 6567 6d65 6e74 732c 206e 616d 6529 0a0a  egments, name)..
+00034d20: 2020 2020 6465 6620 6765 745f 6c69 6e65      def get_line
+00034d30: 5f73 6567 6d65 6e74 7328 7365 6c66 293a  _segments(self):
+00034d40: 0a20 2020 2020 2020 206c 696e 6573 203d  .        lines =
+00034d50: 205b 5d0a 2020 2020 2020 2020 6966 206c   [].        if l
+00034d60: 656e 2873 656c 662e 706f 696e 7473 2920  en(self.points) 
+00034d70: 3e20 313a 0a20 2020 2020 2020 2020 2020  > 1:.           
+00034d80: 2066 6f72 2070 312c 2070 3220 696e 207a   for p1, p2 in z
+00034d90: 6970 2873 656c 662e 706f 696e 7473 2c0a  ip(self.points,.
+00034da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034db0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00034dc0: 7374 2873 656c 662e 706f 696e 7473 5b31  st(self.points[1
+00034dd0: 3a5d 2920 2b20 5b73 656c 662e 706f 696e  :]) + [self.poin
+00034de0: 7473 5b30 5d5d 293a 0a20 2020 2020 2020  ts[0]]):.       
+00034df0: 2020 2020 2020 2020 206c 696e 6573 2e61           lines.a
+00034e00: 7070 656e 6428 766f 6c6d 646c 722e 6564  ppend(volmdlr.ed
+00034e10: 6765 732e 4c69 6e65 5365 676d 656e 7433  ges.LineSegment3
+00034e20: 4428 7031 2c20 7032 2929 0a20 2020 2020  D(p1, p2)).     
+00034e30: 2020 2072 6574 7572 6e20 6c69 6e65 730a     return lines.
+00034e40: 0a20 2020 2064 6566 2063 6f70 7928 7365  .    def copy(se
+00034e50: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
+00034e60: 7267 7329 3a0a 2020 2020 2020 2020 706f  rgs):.        po
+00034e70: 696e 7473 203d 205b 706f 696e 742e 636f  ints = [point.co
+00034e80: 7079 2829 2066 6f72 2070 6f69 6e74 2069  py() for point i
+00034e90: 6e20 7365 6c66 2e70 6f69 6e74 735d 0a20  n self.points]. 
+00034ea0: 2020 2020 2020 2072 6574 7572 6e20 436c         return Cl
+00034eb0: 6f73 6564 506f 6c79 676f 6e33 4428 706f  osedPolygon3D(po
+00034ec0: 696e 7473 2c20 7365 6c66 2e6e 616d 6529  ints, self.name)
+00034ed0: 0a0a 2020 2020 6465 6620 5f5f 6861 7368  ..    def __hash
+00034ee0: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+00034ef0: 2020 7265 7475 726e 2073 756d 2868 6173    return sum(has
+00034f00: 6828 706f 696e 7429 2066 6f72 2070 6f69  h(point) for poi
+00034f10: 6e74 2069 6e20 7365 6c66 2e70 6f69 6e74  nt in self.point
+00034f20: 7329 0a0a 2020 2020 6465 6620 5f5f 6571  s)..    def __eq
+00034f30: 5f5f 2873 656c 662c 206f 7468 6572 5f29  __(self, other_)
+00034f40: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
+00034f50: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
+00034f60: 725f 2c20 7365 6c66 2e5f 5f63 6c61 7373  r_, self.__class
+00034f70: 5f5f 293a 0a20 2020 2020 2020 2020 2020  __):.           
+00034f80: 2072 6574 7572 6e20 4661 6c73 650a 2020   return False.  
+00034f90: 2020 2020 2020 6571 7561 6c20 3d20 5472        equal = Tr
+00034fa0: 7565 0a20 2020 2020 2020 2066 6f72 2070  ue.        for p
+00034fb0: 6f69 6e74 2c20 6f74 6865 725f 706f 696e  oint, other_poin
+00034fc0: 7420 696e 207a 6970 2873 656c 662e 706f  t in zip(self.po
+00034fd0: 696e 7473 2c20 6f74 6865 725f 2e70 6f69  ints, other_.poi
+00034fe0: 6e74 7329 3a0a 2020 2020 2020 2020 2020  nts):.          
+00034ff0: 2020 6571 7561 6c20 3d20 2865 7175 616c    equal = (equal
+00035000: 2061 6e64 2070 6f69 6e74 203d 3d20 6f74   and point == ot
+00035010: 6865 725f 706f 696e 7429 0a20 2020 2020  her_point).     
+00035020: 2020 2072 6574 7572 6e20 6571 7561 6c0a     return equal.
+00035030: 0a20 2020 2064 6566 2070 6c6f 7428 7365  .    def plot(se
+00035040: 6c66 2c20 6178 3d4e 6f6e 652c 2063 6f6c  lf, ax=None, col
+00035050: 6f72 3d27 6b27 2c20 616c 7068 613d 312c  or='k', alpha=1,
+00035060: 2065 6467 655f 6465 7461 696c 733d 4661   edge_details=Fa
+00035070: 6c73 6529 3a0a 2020 2020 2020 2020 666f  lse):.        fo
+00035080: 7220 6c69 6e65 5f73 6567 6d65 6e74 2069  r line_segment i
+00035090: 6e20 7365 6c66 2e6c 696e 655f 7365 676d  n self.line_segm
+000350a0: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
+000350b0: 2020 6178 203d 206c 696e 655f 7365 676d    ax = line_segm
+000350c0: 656e 742e 706c 6f74 2861 783d 6178 2c20  ent.plot(ax=ax, 
+000350d0: 636f 6c6f 723d 636f 6c6f 722c 2061 6c70  color=color, alp
+000350e0: 6861 3d61 6c70 6861 2c0a 2020 2020 2020  ha=alpha,.      
+000350f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035100: 2020 2020 2020 2020 2020 2020 2065 6467               edg
+00035110: 655f 656e 6473 3d54 7275 652c 2065 6467  e_ends=True, edg
+00035120: 655f 6469 7265 6374 696f 6e3d 6564 6765  e_direction=edge
+00035130: 5f64 6574 6169 6c73 290a 2020 2020 2020  _details).      
+00035140: 2020 7265 7475 726e 2061 780a 0a20 2020    return ax..   
+00035150: 2064 6566 2072 6f74 6174 696f 6e28 7365   def rotation(se
+00035160: 6c66 2c20 6365 6e74 6572 3a20 766f 6c6d  lf, center: volm
+00035170: 646c 722e 506f 696e 7433 442c 2061 7869  dlr.Point3D, axi
+00035180: 733a 2076 6f6c 6d64 6c72 2e56 6563 746f  s: volmdlr.Vecto
+00035190: 7233 442c 0a20 2020 2020 2020 2020 2020  r3D,.           
+000351a0: 2020 2020 2020 616e 676c 653a 2066 6c6f        angle: flo
+000351b0: 6174 293a 0a20 2020 2020 2020 2022 2222  at):.        """
+000351c0: 0a20 2020 2020 2020 2043 6c6f 7365 6450  .        ClosedP
+000351d0: 6f6c 7967 6f6e 3344 2072 6f74 6174 696f  olygon3D rotatio
+000351e0: 6e2e 0a0a 2020 2020 2020 2020 3a70 6172  n...        :par
+000351f0: 616d 2063 656e 7465 723a 2072 6f74 6174  am center: rotat
+00035200: 696f 6e20 6365 6e74 6572 2e0a 2020 2020  ion center..    
+00035210: 2020 2020 3a70 6172 616d 2061 7869 733a      :param axis:
+00035220: 2072 6f74 6174 696f 6e20 6178 6973 2e0a   rotation axis..
+00035230: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
+00035240: 6e67 6c65 3a20 616e 676c 6520 726f 7461  ngle: angle rota
+00035250: 7469 6f6e 2e0a 2020 2020 2020 2020 3a72  tion..        :r
+00035260: 6574 7572 6e3a 2061 206e 6577 2072 6f74  eturn: a new rot
+00035270: 6174 6564 2043 6c6f 7365 6450 6f6c 7967  ated ClosedPolyg
+00035280: 6f6e 3344 2e0a 2020 2020 2020 2020 2222  on3D..        ""
+00035290: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+000352a0: 2043 6c6f 7365 6450 6f6c 7967 6f6e 3344   ClosedPolygon3D
+000352b0: 280a 2020 2020 2020 2020 2020 2020 5b70  (.            [p
+000352c0: 6f69 6e74 2e72 6f74 6174 696f 6e28 6365  oint.rotation(ce
+000352d0: 6e74 6572 2c20 6178 6973 2c20 616e 676c  nter, axis, angl
+000352e0: 6529 2066 6f72 2070 6f69 6e74 2069 6e0a  e) for point in.
+000352f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00035300: 662e 706f 696e 7473 5d29 0a0a 2020 2020  f.points])..    
+00035310: 6465 6620 726f 7461 7469 6f6e 5f69 6e70  def rotation_inp
+00035320: 6c61 6365 2873 656c 662c 2063 656e 7465  lace(self, cente
+00035330: 723a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  r: volmdlr.Point
+00035340: 3344 2c20 6178 6973 3a20 766f 6c6d 646c  3D, axis: volmdl
+00035350: 722e 5665 6374 6f72 3344 2c0a 2020 2020  r.Vector3D,.    
+00035360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035370: 2020 2020 2061 6e67 6c65 3a20 666c 6f61       angle: floa
+00035380: 7429 3a0a 2020 2020 2020 2020 2222 220a  t):.        """.
+00035390: 2020 2020 2020 2020 436c 6f73 6564 506f          ClosedPo
+000353a0: 6c79 676f 6e33 4420 726f 7461 7469 6f6e  lygon3D rotation
+000353b0: 2e20 4f62 6a65 6374 2069 7320 7570 6461  . Object is upda
+000353c0: 7465 6420 696e 706c 6163 652e 0a0a 2020  ted inplace...  
+000353d0: 2020 2020 2020 3a70 6172 616d 2063 656e        :param cen
+000353e0: 7465 723a 2072 6f74 6174 696f 6e20 6365  ter: rotation ce
+000353f0: 6e74 6572 2e0a 2020 2020 2020 2020 3a70  nter..        :p
+00035400: 6172 616d 2061 7869 733a 2072 6f74 6174  aram axis: rotat
+00035410: 696f 6e20 6178 6973 2e0a 2020 2020 2020  ion axis..      
+00035420: 2020 3a70 6172 616d 2061 6e67 6c65 3a20    :param angle: 
+00035430: 726f 7461 7469 6f6e 2061 6e67 6c65 2e0a  rotation angle..
+00035440: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00035450: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00035460: 6e28 2227 696e 706c 6163 6527 206d 6574  n("'inplace' met
+00035470: 686f 6473 2061 7265 2064 6570 7265 6361  hods are depreca
+00035480: 7465 642e 2055 7365 2061 206e 6f74 2069  ted. Use a not i
+00035490: 6e70 6c61 6365 206d 6574 686f 6420 696e  nplace method in
+000354a0: 7374 6561 642e 222c 2044 6570 7265 6361  stead.", Depreca
+000354b0: 7469 6f6e 5761 726e 696e 6729 0a0a 2020  tionWarning)..  
+000354c0: 2020 2020 2020 666f 7220 706f 696e 7420        for point 
+000354d0: 696e 2073 656c 662e 706f 696e 7473 3a0a  in self.points:.
+000354e0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+000354f0: 742e 726f 7461 7469 6f6e 5f69 6e70 6c61  t.rotation_inpla
+00035500: 6365 2863 656e 7465 722c 2061 7869 732c  ce(center, axis,
+00035510: 2061 6e67 6c65 290a 0a20 2020 2064 6566   angle)..    def
+00035520: 2074 7261 6e73 6c61 7469 6f6e 2873 656c   translation(sel
+00035530: 662c 206f 6666 7365 743a 2076 6f6c 6d64  f, offset: volmd
+00035540: 6c72 2e56 6563 746f 7233 4429 3a0a 2020  lr.Vector3D):.  
+00035550: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00035560: 2020 436c 6f73 6564 506f 6c79 676f 6e33    ClosedPolygon3
+00035570: 4420 7472 616e 736c 6174 696f 6e2e 0a0a  D translation...
+00035580: 2020 2020 2020 2020 3a70 6172 616d 206f          :param o
+00035590: 6666 7365 743a 2074 7261 6e73 6c61 7469  ffset: translati
+000355a0: 6f6e 2076 6563 746f 722e 0a20 2020 2020  on vector..     
+000355b0: 2020 203a 7265 7475 726e 3a20 4120 6e65     :return: A ne
+000355c0: 7720 7472 616e 736c 6174 6564 2043 6c6f  w translated Clo
+000355d0: 7365 6450 6f6c 7967 6f6e 3344 2e0a 2020  sedPolygon3D..  
+000355e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000355f0: 2020 6e65 775f 706f 696e 7473 203d 205b    new_points = [
+00035600: 706f 696e 742e 7472 616e 736c 6174 696f  point.translatio
+00035610: 6e28 6f66 6673 6574 2920 666f 7220 706f  n(offset) for po
+00035620: 696e 7420 696e 0a20 2020 2020 2020 2020  int in.         
+00035630: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00035640: 662e 706f 696e 7473 5d0a 2020 2020 2020  f.points].      
+00035650: 2020 7265 7475 726e 2043 6c6f 7365 6450    return ClosedP
+00035660: 6f6c 7967 6f6e 3344 286e 6577 5f70 6f69  olygon3D(new_poi
+00035670: 6e74 732c 2073 656c 662e 6e61 6d65 290a  nts, self.name).
+00035680: 0a20 2020 2064 6566 2074 7261 6e73 6c61  .    def transla
+00035690: 7469 6f6e 5f69 6e70 6c61 6365 2873 656c  tion_inplace(sel
+000356a0: 662c 206f 6666 7365 743a 2076 6f6c 6d64  f, offset: volmd
+000356b0: 6c72 2e56 6563 746f 7233 4429 3a0a 2020  lr.Vector3D):.  
+000356c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000356d0: 2020 436c 6f73 6564 506f 6c79 676f 6e33    ClosedPolygon3
+000356e0: 4420 7472 616e 736c 6174 696f 6e2e 204f  D translation. O
+000356f0: 626a 6563 7420 6973 2075 7064 6174 6564  bject is updated
+00035700: 2069 6e70 6c61 6365 2e0a 0a20 2020 2020   inplace...     
+00035710: 2020 203a 7061 7261 6d20 6f66 6673 6574     :param offset
+00035720: 3a20 7472 616e 736c 6174 696f 6e20 7665  : translation ve
+00035730: 6374 6f72 2e0a 2020 2020 2020 2020 2222  ctor..        ""
+00035740: 220a 2020 2020 2020 2020 7761 726e 696e  ".        warnin
+00035750: 6773 2e77 6172 6e28 2227 696e 706c 6163  gs.warn("'inplac
+00035760: 6527 206d 6574 686f 6473 2061 7265 2064  e' methods are d
+00035770: 6570 7265 6361 7465 642e 2055 7365 2061  eprecated. Use a
+00035780: 206e 6f74 2069 6e70 6c61 6365 206d 6574   not inplace met
+00035790: 686f 6420 696e 7374 6561 642e 222c 2044  hod instead.", D
+000357a0: 6570 7265 6361 7469 6f6e 5761 726e 696e  eprecationWarnin
+000357b0: 6729 0a0a 2020 2020 2020 2020 666f 7220  g)..        for 
+000357c0: 706f 696e 7420 696e 2073 656c 662e 706f  point in self.po
+000357d0: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
+000357e0: 2020 706f 696e 742e 7472 616e 736c 6174    point.translat
+000357f0: 696f 6e5f 696e 706c 6163 6528 6f66 6673  ion_inplace(offs
+00035800: 6574 290a 0a20 2020 2064 6566 2074 6f5f  et)..    def to_
+00035810: 3264 2873 656c 662c 2070 6c61 6e65 5f6f  2d(self, plane_o
+00035820: 7269 6769 6e2c 2078 2c20 7929 3a0a 2020  rigin, x, y):.  
+00035830: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00035840: 2020 5472 616e 7366 6f72 6d73 2061 2043    Transforms a C
+00035850: 6c6f 7365 6450 6f6c 7967 6f6e 3344 2069  losedPolygon3D i
+00035860: 6e74 6f20 616e 2043 6c6f 7365 6450 6f6c  nto an ClosedPol
+00035870: 7967 6f6e 3244 2c20 6769 7665 6e20 6120  ygon2D, given a 
+00035880: 706c 616e 6520 6f72 6967 696e 2061 6e64  plane origin and
+00035890: 2061 6e20 7520 616e 6420 7620 706c 616e   an u and v plan
+000358a0: 6520 7665 6374 6f72 2e0a 0a20 2020 2020  e vector...     
+000358b0: 2020 203a 7061 7261 6d20 706c 616e 655f     :param plane_
+000358c0: 6f72 6967 696e 3a20 706c 616e 6520 6f72  origin: plane or
+000358d0: 6967 696e 2e0a 2020 2020 2020 2020 3a70  igin..        :p
+000358e0: 6172 616d 2078 3a20 706c 616e 6520 7520  aram x: plane u 
+000358f0: 7665 6374 6f72 2e0a 2020 2020 2020 2020  vector..        
+00035900: 3a70 6172 616d 2079 3a20 706c 616e 6520  :param y: plane 
+00035910: 7620 7665 6374 6f72 2e0a 2020 2020 2020  v vector..      
+00035920: 2020 3a72 6574 7572 6e3a 2043 6c6f 7365    :return: Close
+00035930: 6450 6f6c 7967 6f6e 3244 2e0a 2020 2020  dPolygon2D..    
+00035940: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00035950: 706f 696e 7473 3264 203d 205b 706f 696e  points2d = [poin
+00035960: 742e 746f 5f32 6428 706c 616e 655f 6f72  t.to_2d(plane_or
+00035970: 6967 696e 2c20 782c 2079 2920 666f 7220  igin, x, y) for 
+00035980: 706f 696e 7420 696e 2073 656c 662e 706f  point in self.po
+00035990: 696e 7473 5d0a 2020 2020 2020 2020 7265  ints].        re
+000359a0: 7475 726e 2043 6c6f 7365 6450 6f6c 7967  turn ClosedPolyg
+000359b0: 6f6e 3244 2870 6f69 6e74 7332 6429 0a0a  on2D(points2d)..
+000359c0: 2020 2020 6465 6620 7365 7769 6e67 5f77      def sewing_w
+000359d0: 6974 6828 7365 6c66 2c20 6f74 6865 725f  ith(self, other_
+000359e0: 706f 6c79 3364 2c20 782c 2079 2c20 7265  poly3d, x, y, re
+000359f0: 736f 6c75 7469 6f6e 3d32 3029 3a0a 2020  solution=20):.  
+00035a00: 2020 2020 2020 7365 6c66 5f63 656e 7465        self_cente
+00035a10: 722c 206f 7468 6572 5f63 656e 7465 7220  r, other_center 
+00035a20: 3d20 7365 6c66 2e61 7665 7261 6765 5f63  = self.average_c
+00035a30: 656e 7465 725f 706f 696e 7428 292c 205c  enter_point(), \
+00035a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035a60: 2020 2020 206f 7468 6572 5f70 6f6c 7933       other_poly3
+00035a70: 642e 6176 6572 6167 655f 6365 6e74 6572  d.average_center
+00035a80: 5f70 6f69 6e74 2829 0a0a 2020 2020 2020  _point()..      
+00035a90: 2020 7365 6c66 5f70 6f6c 7932 642c 206f    self_poly2d, o
+00035aa0: 7468 6572 5f70 6f6c 7932 6420 3d20 7365  ther_poly2d = se
+00035ab0: 6c66 2e74 6f5f 3264 2873 656c 665f 6365  lf.to_2d(self_ce
+00035ac0: 6e74 6572 2c20 782c 2079 292c 205c 0a20  nter, x, y), \. 
+00035ad0: 2020 2020 2020 2020 2020 206f 7468 6572             other
+00035ae0: 5f70 6f6c 7933 642e 746f 5f32 6428 6f74  _poly3d.to_2d(ot
+00035af0: 6865 725f 6365 6e74 6572 2c20 782c 2079  her_center, x, y
+00035b00: 290a 2020 2020 2020 2020 7365 6c66 5f63  ).        self_c
+00035b10: 656e 7465 7232 642c 206f 7468 6572 5f63  enter2d, other_c
+00035b20: 656e 7465 7232 6420 3d20 7365 6c66 5f70  enter2d = self_p
+00035b30: 6f6c 7932 642e 6365 6e74 6572 5f6f 665f  oly2d.center_of_
+00035b40: 6d61 7373 2829 2c20 5c0a 2020 2020 2020  mass(), \.      
+00035b50: 2020 2020 2020 6f74 6865 725f 706f 6c79        other_poly
+00035b60: 3264 2e63 656e 7465 725f 6f66 5f6d 6173  2d.center_of_mas
+00035b70: 7328 290a 2020 2020 2020 2020 7365 6c66  s().        self
+00035b80: 5f70 6f6c 7932 642e 7472 616e 736c 6174  _poly2d.translat
+00035b90: 696f 6e5f 696e 706c 6163 6528 2d73 656c  ion_inplace(-sel
+00035ba0: 665f 6365 6e74 6572 3264 290a 2020 2020  f_center2d).    
+00035bb0: 2020 2020 6f74 6865 725f 706f 6c79 3264      other_poly2d
+00035bc0: 2e74 7261 6e73 6c61 7469 6f6e 5f69 6e70  .translation_inp
+00035bd0: 6c61 6365 282d 6f74 6865 725f 6365 6e74  lace(-other_cent
+00035be0: 6572 3264 290a 0a20 2020 2020 2020 2062  er2d)..        b
+00035bf0: 626f 785f 7365 6c66 3264 2c20 6262 6f78  box_self2d, bbox
+00035c00: 5f6f 7468 6572 3264 203d 2073 656c 665f  _other2d = self_
+00035c10: 706f 6c79 3264 2e62 6f75 6e64 696e 675f  poly2d.bounding_
+00035c20: 7265 6374 616e 676c 652e 626f 756e 6473  rectangle.bounds
+00035c30: 2829 2c20 5c0a 2020 2020 2020 2020 2020  (), \.          
+00035c40: 2020 6f74 6865 725f 706f 6c79 3264 2e62    other_poly2d.b
+00035c50: 6f75 6e64 696e 675f 7265 6374 616e 676c  ounding_rectangl
+00035c60: 652e 626f 756e 6473 2829 0a20 2020 2020  e.bounds().     
+00035c70: 2020 2070 6f73 6974 696f 6e20 3d20 5b61     position = [a
+00035c80: 6273 2876 616c 7565 2920 666f 7220 7661  bs(value) for va
+00035c90: 6c75 6520 696e 2062 626f 785f 7365 6c66  lue in bbox_self
+00035ca0: 3264 5d20 5c0a 2020 2020 2020 2020 2020  2d] \.          
+00035cb0: 2020 2b20 5b61 6273 2876 616c 7565 2920    + [abs(value) 
+00035cc0: 666f 7220 7661 6c75 6520 696e 2062 626f  for value in bbo
+00035cd0: 785f 6f74 6865 7232 645d 0a20 2020 2020  x_other2d].     
+00035ce0: 2020 206d 6178 5f73 6361 6c65 203d 2032     max_scale = 2
+00035cf0: 202a 206d 6178 2870 6f73 6974 696f 6e29   * max(position)
+00035d00: 0a0a 2020 2020 2020 2020 6c69 6e65 7320  ..        lines 
+00035d10: 3d20 5b76 6f6c 6d64 6c72 2e65 6467 6573  = [volmdlr.edges
+00035d20: 2e4c 696e 6553 6567 6d65 6e74 3244 2876  .LineSegment2D(v
+00035d30: 6f6c 6d64 6c72 2e4f 3244 2c20 6d61 785f  olmdlr.O2D, max_
+00035d40: 7363 616c 6520 2a20 280a 2020 2020 2020  scale * (.      
+00035d50: 2020 2020 2020 2020 2020 766f 6c6d 646c            volmdl
+00035d60: 722e 5832 4420 2a20 6d61 7468 2e73 696e  r.X2D * math.sin
+00035d70: 286e 202a 2032 202a 206d 6174 682e 7069  (n * 2 * math.pi
+00035d80: 202f 2072 6573 6f6c 7574 696f 6e29 202b   / resolution) +
+00035d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035da0: 2076 6f6c 6d64 6c72 2e59 3244 202a 206d   volmdlr.Y2D * m
+00035db0: 6174 682e 636f 7328 6e20 2a20 3220 2a20  ath.cos(n * 2 * 
+00035dc0: 6d61 7468 2e70 6920 2f20 7265 736f 6c75  math.pi / resolu
+00035dd0: 7469 6f6e 2929 0a20 2020 2020 2020 2020  tion)).         
+00035de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035e00: 2020 2020 2920 666f 7220 6e20 696e 2072      ) for n in r
+00035e10: 616e 6765 2872 6573 6f6c 7574 696f 6e29  ange(resolution)
+00035e20: 5d0a 0a20 2020 2020 2020 2073 656c 665f  ]..        self_
+00035e30: 6e65 775f 706f 696e 7473 2c20 6f74 6865  new_points, othe
+00035e40: 725f 6e65 775f 706f 696e 7473 203d 205b  r_new_points = [
+00035e50: 5d2c 205b 5d0a 2020 2020 2020 2020 666f  ], [].        fo
+00035e60: 7220 6c69 6e65 2069 6e20 6c69 6e65 733a  r line in lines:
+00035e70: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00035e80: 2073 656c 665f 6c69 6e65 2069 6e20 7365   self_line in se
+00035e90: 6c66 5f70 6f6c 7932 642e 6c69 6e65 5f73  lf_poly2d.line_s
+00035ea0: 6567 6d65 6e74 733a 0a20 2020 2020 2020  egments:.       
+00035eb0: 2020 2020 2020 2020 2069 6e74 6572 7365           interse
+00035ec0: 6374 203d 206c 696e 652e 6c69 6e65 7365  ct = line.linese
+00035ed0: 676d 656e 745f 696e 7465 7273 6563 7469  gment_intersecti
+00035ee0: 6f6e 7328 7365 6c66 5f6c 696e 6529 0a20  ons(self_line). 
+00035ef0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00035f00: 6620 696e 7465 7273 6563 743a 0a20 2020  f intersect:.   
+00035f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035f20: 2073 656c 665f 6e65 775f 706f 696e 7473   self_new_points
+00035f30: 2e65 7874 656e 6428 696e 7465 7273 6563  .extend(intersec
+00035f40: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
+00035f50: 2020 2020 2020 2062 7265 616b 0a0a 2020         break..  
+00035f60: 2020 2020 2020 2020 2020 666f 7220 6f74            for ot
+00035f70: 6865 725f 6c69 6e65 2069 6e20 6f74 6865  her_line in othe
+00035f80: 725f 706f 6c79 3264 2e6c 696e 655f 7365  r_poly2d.line_se
+00035f90: 676d 656e 7473 3a0a 2020 2020 2020 2020  gments:.        
+00035fa0: 2020 2020 2020 2020 696e 7465 7273 6563          intersec
+00035fb0: 7420 3d20 6c69 6e65 2e6c 696e 6573 6567  t = line.lineseg
+00035fc0: 6d65 6e74 5f69 6e74 6572 7365 6374 696f  ment_intersectio
+00035fd0: 6e73 286f 7468 6572 5f6c 696e 6529 0a20  ns(other_line). 
+00035fe0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00035ff0: 6620 696e 7465 7273 6563 743a 0a20 2020  f intersect:.   
+00036000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036010: 206f 7468 6572 5f6e 6577 5f70 6f69 6e74   other_new_point
+00036020: 732e 6578 7465 6e64 2869 6e74 6572 7365  s.extend(interse
+00036030: 6374 290a 2020 2020 2020 2020 2020 2020  ct).            
+00036040: 2020 2020 2020 2020 6272 6561 6b0a 0a20          break.. 
+00036050: 2020 2020 2020 206e 6577 5f73 656c 665f         new_self_
+00036060: 706f 6c79 3264 2c20 6e65 775f 6f74 6865  poly2d, new_othe
+00036070: 725f 706f 6c79 3264 203d 2043 6c6f 7365  r_poly2d = Close
+00036080: 6450 6f6c 7967 6f6e 3244 280a 2020 2020  dPolygon2D(.    
+00036090: 2020 2020 2020 2020 7365 6c66 5f6e 6577          self_new
+000360a0: 5f70 6f69 6e74 7329 2c20 436c 6f73 6564  _points), Closed
+000360b0: 506f 6c79 676f 6e32 4428 6f74 6865 725f  Polygon2D(other_
+000360c0: 6e65 775f 706f 696e 7473 290a 2020 2020  new_points).    
+000360d0: 2020 2020 6e65 775f 7365 6c66 5f70 6f6c      new_self_pol
+000360e0: 7932 642e 7472 616e 736c 6174 696f 6e5f  y2d.translation_
+000360f0: 696e 706c 6163 6528 7365 6c66 5f63 656e  inplace(self_cen
+00036100: 7465 7232 6429 0a20 2020 2020 2020 206e  ter2d).        n
+00036110: 6577 5f6f 7468 6572 5f70 6f6c 7932 642e  ew_other_poly2d.
+00036120: 7472 616e 736c 6174 696f 6e5f 696e 706c  translation_inpl
+00036130: 6163 6528 6f74 6865 725f 6365 6e74 6572  ace(other_center
+00036140: 3264 290a 0a20 2020 2020 2020 206e 6577  2d)..        new
+00036150: 5f70 6f6c 7931 2c20 6e65 775f 706f 6c79  _poly1, new_poly
+00036160: 3220 3d20 6e65 775f 7365 6c66 5f70 6f6c  2 = new_self_pol
+00036170: 7932 642e 746f 5f33 6428 7365 6c66 5f63  y2d.to_3d(self_c
+00036180: 656e 7465 722c 2078 2c20 7929 2c20 5c0a  enter, x, y), \.
+00036190: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+000361a0: 6f74 6865 725f 706f 6c79 3264 2e74 6f5f  other_poly2d.to_
+000361b0: 3364 286f 7468 6572 5f63 656e 7465 722c  3d(other_center,
+000361c0: 2078 2c20 7929 0a0a 2020 2020 2020 2020   x, y)..        
+000361d0: 7472 6961 6e67 6c65 7320 3d20 5b5d 0a20  triangles = []. 
+000361e0: 2020 2020 2020 2066 6f72 2070 6f69 6e74         for point
+000361f0: 312c 2070 6f69 6e74 322c 206f 7468 6572  1, point2, other
+00036200: 5f70 6f69 6e74 2069 6e20 7a69 7028 6e65  _point in zip(ne
+00036210: 775f 706f 6c79 312e 706f 696e 7473 2c0a  w_poly1.points,.
+00036220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036240: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00036250: 6577 5f70 6f6c 7931 2e70 6f69 6e74 735b  ew_poly1.points[
+00036260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036290: 2020 2020 313a 5d20 2b20 6e65 775f 706f      1:] + new_po
+000362a0: 6c79 312e 706f 696e 7473 5b3a 315d 2c0a  ly1.points[:1],.
+000362b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000362c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000362d0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+000362e0: 6577 5f70 6f6c 7932 2e70 6f69 6e74 7329  ew_poly2.points)
+000362f0: 3a0a 2020 2020 2020 2020 2020 2020 7472  :.            tr
+00036300: 6961 6e67 6c65 732e 6170 7065 6e64 285b  iangles.append([
+00036310: 706f 696e 7431 2c20 706f 696e 7432 2c20  point1, point2, 
+00036320: 6f74 6865 725f 706f 696e 745d 290a 0a20  other_point]).. 
+00036330: 2020 2020 2020 2066 6f72 2070 6f69 6e74         for point
+00036340: 312c 2070 6f69 6e74 322c 206f 7468 6572  1, point2, other
+00036350: 5f70 6f69 6e74 2069 6e20 7a69 7028 0a20  _point in zip(. 
+00036360: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00036370: 6577 5f70 6f6c 7932 2e70 6f69 6e74 732c  ew_poly2.points,
+00036380: 206e 6577 5f70 6f6c 7932 2e70 6f69 6e74   new_poly2.point
+00036390: 735b 313a 5d20 2b20 6e65 775f 706f 6c79  s[1:] + new_poly
+000363a0: 322e 706f 696e 7473 5b3a 315d 2c0a 2020  2.points[:1],.  
+000363b0: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+000363c0: 775f 706f 6c79 312e 706f 696e 7473 5b31  w_poly1.points[1
+000363d0: 3a5d 202b 206e 6577 5f70 6f6c 7931 2e70  :] + new_poly1.p
+000363e0: 6f69 6e74 735b 3a31 5d29 3a0a 2020 2020  oints[:1]):.    
+000363f0: 2020 2020 2020 2020 7472 6961 6e67 6c65          triangle
+00036400: 732e 6170 7065 6e64 285b 6f74 6865 725f  s.append([other_
+00036410: 706f 696e 742c 2070 6f69 6e74 322c 2070  point, point2, p
+00036420: 6f69 6e74 315d 290a 0a20 2020 2020 2020  oint1])..       
+00036430: 2072 6574 7572 6e20 7472 6961 6e67 6c65   return triangle
+00036440: 730a 0a20 2020 2064 6566 2073 696d 706c  s..    def simpl
+00036450: 6966 7928 7365 6c66 2c20 6d69 6e5f 6469  ify(self, min_di
+00036460: 7374 616e 6365 3a20 666c 6f61 7420 3d20  stance: float = 
+00036470: 302e 3031 2c20 6d61 785f 6469 7374 616e  0.01, max_distan
+00036480: 6365 3a20 666c 6f61 7420 3d20 302e 3035  ce: float = 0.05
+00036490: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+000364a0: 2020 2020 2020 2053 696d 706c 6966 6965         Simplifie
+000364b0: 7320 706f 6c79 676f 6e33 642e 0a0a 2020  s polygon3d...  
+000364c0: 2020 2020 2020 3a70 6172 616d 206d 696e        :param min
+000364d0: 5f64 6973 7461 6e63 653a 206d 696e 696d  _distance: minim
+000364e0: 616c 2061 6c6c 6f77 6564 2064 6973 7461  al allowed dista
+000364f0: 6e63 652e 0a20 2020 2020 2020 203a 7061  nce..        :pa
+00036500: 7261 6d20 6d61 785f 6469 7374 616e 6365  ram max_distance
+00036510: 3a20 6d61 7869 6d61 6c20 616c 6c6f 7765  : maximal allowe
+00036520: 6420 6469 7374 616e 6365 2e0a 2020 2020  d distance..    
+00036530: 2020 2020 3a72 6574 7572 6e3a 2053 696d      :return: Sim
+00036540: 706c 6966 6965 6420 636c 6f73 6564 2070  plified closed p
+00036550: 6f6c 7967 6f6e 2033 642e 0a20 2020 2020  olygon 3d..     
+00036560: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00036570: 6574 7572 6e20 436c 6f73 6564 506f 6c79  eturn ClosedPoly
+00036580: 676f 6e33 4428 7365 6c66 2e73 696d 706c  gon3D(self.simpl
+00036590: 6966 795f 706f 6c79 676f 6e28 0a20 2020  ify_polygon(.   
+000365a0: 2020 2020 2020 2020 206d 696e 5f64 6973           min_dis
+000365b0: 7461 6e63 653d 6d69 6e5f 6469 7374 616e  tance=min_distan
+000365c0: 6365 2c20 6d61 785f 6469 7374 616e 6365  ce, max_distance
+000365d0: 3d6d 6178 5f64 6973 7461 6e63 6529 2e70  =max_distance).p
+000365e0: 6f69 6e74 7329 0a0a 2020 2020 6465 6620  oints)..    def 
+000365f0: 636f 6e76 6578 5f73 6577 696e 6728 7365  convex_sewing(se
+00036600: 6c66 2c20 706f 6c79 676f 6e32 2c20 782c  lf, polygon2, x,
+00036610: 2079 293a 0a20 2020 2020 2020 2022 2222   y):.        """
+00036620: 0a20 2020 2020 2020 2053 6577 2074 6f20  .        Sew to 
+00036630: 436f 6e76 6578 2050 6f6c 7967 6f6e 2e0a  Convex Polygon..
+00036640: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00036650: 706f 6c79 676f 6e32 3a20 6f74 6865 7220  polygon2: other 
+00036660: 706f 6c79 676f 6e20 746f 2073 6577 2077  polygon to sew w
+00036670: 6974 682e 0a20 2020 2020 2020 203a 7061  ith..        :pa
+00036680: 7261 6d20 783a 2075 2076 6563 746f 7220  ram x: u vector 
+00036690: 666f 7220 706c 616e 6520 7072 6f6a 6563  for plane projec
+000366a0: 7469 6f6e 2e0a 2020 2020 2020 2020 3a70  tion..        :p
+000366b0: 6172 616d 2079 3a20 7620 7665 6374 6f72  aram y: v vector
+000366c0: 2066 6f72 2070 6c61 6e65 2070 726f 6a65   for plane proje
+000366d0: 6374 696f 6e2e 0a20 2020 2020 2020 2022  ction..        "
+000366e0: 2222 0a20 2020 2020 2020 2063 656e 7465  "".        cente
+000366f0: 7231 2c20 6365 6e74 6572 3220 3d20 7365  r1, center2 = se
+00036700: 6c66 2e61 7665 7261 6765 5f63 656e 7465  lf.average_cente
+00036710: 725f 706f 696e 7428 292c 2070 6f6c 7967  r_point(), polyg
+00036720: 6f6e 322e 6176 6572 6167 655f 6365 6e74  on2.average_cent
+00036730: 6572 5f70 6f69 6e74 2829 0a20 2020 2020  er_point().     
+00036740: 2020 2063 656e 7465 7231 5f2c 2063 656e     center1_, cen
+00036750: 7465 7232 5f20 3d20 766f 6c6d 646c 722e  ter2_ = volmdlr.
+00036760: 506f 696e 7433 4428 6365 6e74 6572 312e  Point3D(center1.
+00036770: 782c 2063 656e 7465 7231 2e79 2c20 3029  x, center1.y, 0)
+00036780: 2c20 766f 6c6d 646c 722e 506f 696e 7433  , volmdlr.Point3
+00036790: 4428 6365 6e74 6572 322e 782c 2063 656e  D(center2.x, cen
+000367a0: 7465 7232 2e79 2c20 3029 0a20 2020 2020  ter2.y, 0).     
+000367b0: 2020 206e 6577 5f70 6f6c 7967 6f6e 312c     new_polygon1,
+000367c0: 206e 6577 5f70 6f6c 7967 6f6e 3220 3d20   new_polygon2 = 
+000367d0: 7365 6c66 2e74 7261 6e73 6c61 7469 6f6e  self.translation
+000367e0: 282d 6365 6e74 6572 315f 292c 2070 6f6c  (-center1_), pol
+000367f0: 7967 6f6e 322e 7472 616e 736c 6174 696f  ygon2.translatio
+00036800: 6e28 2d63 656e 7465 7232 5f29 0a20 2020  n(-center2_).   
+00036810: 2020 2020 206e 6577 5f63 656e 7465 7231       new_center1
+00036820: 2c20 6e65 775f 6365 6e74 6572 3220 3d20  , new_center2 = 
+00036830: 6e65 775f 706f 6c79 676f 6e31 2e61 7665  new_polygon1.ave
+00036840: 7261 6765 5f63 656e 7465 725f 706f 696e  rage_center_poin
+00036850: 7428 292c 206e 6577 5f70 6f6c 7967 6f6e  t(), new_polygon
+00036860: 322e 6176 6572 6167 655f 6365 6e74 6572  2.average_center
+00036870: 5f70 6f69 6e74 2829 0a0a 2020 2020 2020  _point()..      
+00036880: 2020 6e65 775f 706f 6c79 676f 6e31 5f32    new_polygon1_2
+00036890: 642c 206e 6577 5f70 6f6c 7967 6f6e 325f  d, new_polygon2_
+000368a0: 3264 203d 5c0a 2020 2020 2020 2020 2020  2d =\.          
+000368b0: 2020 6e65 775f 706f 6c79 676f 6e31 2e74    new_polygon1.t
+000368c0: 6f5f 3264 286e 6577 5f63 656e 7465 7231  o_2d(new_center1
+000368d0: 2c20 782c 2079 292c 206e 6577 5f70 6f6c  , x, y), new_pol
+000368e0: 7967 6f6e 322e 746f 5f32 6428 6e65 775f  ygon2.to_2d(new_
+000368f0: 6365 6e74 6572 322c 2078 2c20 7929 0a0a  center2, x, y)..
+00036900: 2020 2020 2020 2020 6469 6374 5f63 6c6f          dict_clo
+00036910: 7369 6e67 5f70 6169 7273 203d 207b 7d0a  sing_pairs = {}.
+00036920: 2020 2020 2020 2020 7472 6961 6e67 6c65          triangle
+00036930: 7320 3d20 5b5d 0a20 2020 2020 2020 206c  s = [].        l
+00036940: 6973 745f 636c 6f73 696e 675f 706f 696e  ist_closing_poin
+00036950: 745f 696e 6465 7865 7320 3d20 5b5d 0a20  t_indexes = []. 
+00036960: 2020 2020 2020 206e 6577 5f70 6f6c 7967         new_polyg
+00036970: 6f6e 315f 3264 5f70 6f69 6e74 7320 3d20  on1_2d_points = 
+00036980: 6e65 775f 706f 6c79 676f 6e31 5f32 642e  new_polygon1_2d.
+00036990: 706f 696e 7473 202b 205b 0a20 2020 2020  points + [.     
+000369a0: 2020 2020 2020 206e 6577 5f70 6f6c 7967         new_polyg
+000369b0: 6f6e 315f 3264 2e70 6f69 6e74 735b 305d  on1_2d.points[0]
+000369c0: 5d0a 2020 2020 2020 2020 666f 7220 692c  ].        for i,
+000369d0: 2070 6f69 6e74 5f70 6f6c 7967 6f6e 3120   point_polygon1 
+000369e0: 696e 2065 6e75 6d65 7261 7465 280a 2020  in enumerate(.  
+000369f0: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+00036a00: 775f 706f 6c79 676f 6e31 2e70 6f69 6e74  w_polygon1.point
+00036a10: 7320 2b20 5b6e 6577 5f70 6f6c 7967 6f6e  s + [new_polygon
+00036a20: 312e 706f 696e 7473 5b30 5d5d 293a 0a20  1.points[0]]):. 
+00036a30: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
+00036a40: 213d 2030 3a0a 2020 2020 2020 2020 2020  != 0:.          
+00036a50: 2020 2020 2020 6d65 616e 5f70 6f69 6e74        mean_point
+00036a60: 3264 203d 2030 2e35 202a 2028 0a20 2020  2d = 0.5 * (.   
+00036a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036a80: 2020 2020 206e 6577 5f70 6f6c 7967 6f6e       new_polygon
+00036a90: 315f 3264 5f70 6f69 6e74 735b 695d 202b  1_2d_points[i] +
+00036aa0: 206e 6577 5f70 6f6c 7967 6f6e 315f 3264   new_polygon1_2d
+00036ab0: 5f70 6f69 6e74 735b 0a20 2020 2020 2020  _points[.       
+00036ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ad0: 2020 2020 2069 202d 2031 5d29 0a20 2020       i - 1]).   
+00036ae0: 2020 2020 2020 2020 2020 2020 2063 6c6f               clo
+00036af0: 7369 6e67 5f70 6f69 6e74 203d 206e 6577  sing_point = new
+00036b00: 5f70 6f6c 7967 6f6e 325f 3264 2e6c 696e  _polygon2_2d.lin
+00036b10: 655f 696e 7465 7273 6563 7469 6e67 5f63  e_intersecting_c
+00036b20: 6c6f 7369 6e67 5f70 6f69 6e74 280a 2020  losing_point(.  
+00036b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036b40: 2020 6d65 616e 5f70 6f69 6e74 3264 290a    mean_point2d).
 00036b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b60: 2020 2020 6d65 616e 5f70 6f69 6e74 3264      mean_point2d
-00036b70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00036b80: 2020 636c 6f73 696e 675f 706f 696e 745f    closing_point_
-00036b90: 696e 6465 7820 3d20 6e65 775f 706f 6c79  index = new_poly
-00036ba0: 676f 6e32 5f32 642e 706f 696e 7473 2e69  gon2_2d.points.i
-00036bb0: 6e64 6578 280a 2020 2020 2020 2020 2020  ndex(.          
-00036bc0: 2020 2020 2020 2020 2020 636c 6f73 696e            closin
-00036bd0: 675f 706f 696e 7429 0a0a 2020 2020 2020  g_point)..      
-00036be0: 2020 2020 2020 2020 2020 6966 2069 203d            if i =
-00036bf0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00036c00: 2020 2020 2020 2020 2070 7265 7669 6f75           previou
-00036c10: 735f 636c 6f73 696e 675f 706f 696e 745f  s_closing_point_
-00036c20: 696e 6465 7820 3d20 636c 6f73 696e 675f  index = closing_
-00036c30: 706f 696e 745f 696e 6465 780a 2020 2020  point_index.    
-00036c40: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00036c50: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
-00036c60: 6578 2021 3d20 7072 6576 696f 7573 5f63  ex != previous_c
-00036c70: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
-00036c80: 6578 3a0a 2020 2020 2020 2020 2020 2020  ex:.            
-00036c90: 2020 2020 2020 2020 6966 2063 6c6f 7369          if closi
-00036ca0: 6e67 5f70 6f69 6e74 5f69 6e64 6578 2069  ng_point_index i
-00036cb0: 6e20 6c69 7374 5f63 6c6f 7369 6e67 5f70  n list_closing_p
-00036cc0: 6f69 6e74 5f69 6e64 6578 6573 3a0a 2020  oint_indexes:.  
-00036cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ce0: 2020 2020 2020 636c 6f73 696e 675f 706f        closing_po
-00036cf0: 696e 745f 696e 6465 7820 3d20 7072 6576  int_index = prev
-00036d00: 696f 7573 5f63 6c6f 7369 6e67 5f70 6f69  ious_closing_poi
-00036d10: 6e74 5f69 6e64 6578 0a20 2020 2020 2020  nt_index.       
-00036d20: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00036d30: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00036d40: 2020 2020 2020 2020 2020 2064 6963 745f             dict_
-00036d50: 636c 6f73 696e 675f 7061 6972 735b 7365  closing_pairs[se
-00036d60: 6c66 2e70 6f69 6e74 735b 6920 2d20 315d  lf.points[i - 1]
-00036d70: 5d20 3d20 280a 2020 2020 2020 2020 2020  ] = (.          
-00036d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d90: 2020 7072 6576 696f 7573 5f63 6c6f 7369    previous_closi
-00036da0: 6e67 5f70 6f69 6e74 5f69 6e64 6578 2c0a  ng_point_index,.
-00036db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036dc0: 2020 2020 2020 2020 2020 2020 636c 6f73              clos
-00036dd0: 696e 675f 706f 696e 745f 696e 6465 7829  ing_point_index)
-00036de0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00036df0: 2020 6966 2070 6f69 6e74 5f70 6f6c 7967    if point_polyg
-00036e00: 6f6e 3120 3d3d 206e 6577 5f70 6f6c 7967  on1 == new_polyg
-00036e10: 6f6e 312e 706f 696e 7473 5b30 5d3a 0a20  on1.points[0]:. 
-00036e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036e30: 2020 2069 6620 6c69 7374 2864 6963 745f     if list(dict_
-00036e40: 636c 6f73 696e 675f 7061 6972 732e 7661  closing_pairs.va
-00036e50: 6c75 6573 2829 295b 2d31 5d5b 2d31 5d20  lues())[-1][-1] 
-00036e60: 213d 205c 0a20 2020 2020 2020 2020 2020  != \.           
-00036e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036e80: 206c 6973 7428 6469 6374 5f63 6c6f 7369   list(dict_closi
-00036e90: 6e67 5f70 6169 7273 2e76 616c 7565 7328  ng_pairs.values(
-00036ea0: 2929 5b30 5d5b 305d 3a0a 2020 2020 2020  ))[0][0]:.      
-00036eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ec0: 2020 6469 6374 5f63 6c6f 7369 6e67 5f70    dict_closing_p
-00036ed0: 6169 7273 5b73 656c 662e 706f 696e 7473  airs[self.points
-00036ee0: 5b30 5d5d 203d 2028 0a20 2020 2020 2020  [0]] = (.       
-00036ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f00: 2020 2020 206c 6973 7428 6469 6374 5f63       list(dict_c
-00036f10: 6c6f 7369 6e67 5f70 6169 7273 2e76 616c  losing_pairs.val
-00036f20: 7565 7328 2929 5b2d 315d 5b2d 315d 2c0a  ues())[-1][-1],.
-00036f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f40: 2020 2020 2020 2020 2020 2020 6c69 7374              list
-00036f50: 2864 6963 745f 636c 6f73 696e 675f 7061  (dict_closing_pa
-00036f60: 6972 732e 7661 6c75 6573 2829 295b 305d  irs.values())[0]
-00036f70: 5b30 5d29 0a0a 2020 2020 2020 2020 2020  [0])..          
-00036f80: 2020 2020 2020 7265 616c 5f63 6c6f 7369        real_closi
-00036f90: 6e67 5f70 6f69 6e74 203d 2070 6f6c 7967  ng_point = polyg
-00036fa0: 6f6e 322e 706f 696e 7473 5b63 6c6f 7369  on2.points[closi
-00036fb0: 6e67 5f70 6f69 6e74 5f69 6e64 6578 5d0a  ng_point_index].
-00036fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036fd0: 2066 6163 655f 706f 696e 7473 203d 205b   face_points = [
-00036fe0: 7365 6c66 2e70 6f69 6e74 735b 6e65 775f  self.points[new_
-00036ff0: 706f 6c79 676f 6e31 2e70 6f69 6e74 732e  polygon1.points.
-00037000: 696e 6465 7828 0a20 2020 2020 2020 2020  index(.         
-00037010: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-00037020: 5f70 6f6c 7967 6f6e 3129 5d2c 2073 656c  _polygon1)], sel
-00037030: 662e 706f 696e 7473 5b69 202d 2031 5d2c  f.points[i - 1],
-00037040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037060: 2020 2072 6561 6c5f 636c 6f73 696e 675f     real_closing_
-00037070: 706f 696e 745d 0a20 2020 2020 2020 2020  point].         
-00037080: 2020 2020 2020 2074 7269 616e 676c 6573         triangles
-00037090: 2e61 7070 656e 6428 6661 6365 5f70 6f69  .append(face_poi
-000370a0: 6e74 7329 0a0a 2020 2020 2020 2020 2020  nts)..          
-000370b0: 2020 2020 2020 6c69 7374 5f63 6c6f 7369        list_closi
-000370c0: 6e67 5f70 6f69 6e74 5f69 6e64 6578 6573  ng_point_indexes
-000370d0: 2e61 7070 656e 6428 636c 6f73 696e 675f  .append(closing_
-000370e0: 706f 696e 745f 696e 6465 7829 0a20 2020  point_index).   
-000370f0: 2020 2020 2020 2020 2020 2020 2070 7265               pre
-00037100: 7669 6f75 735f 636c 6f73 696e 675f 706f  vious_closing_po
-00037110: 696e 745f 696e 6465 7820 3d20 636c 6f73  int_index = clos
-00037120: 696e 675f 706f 696e 745f 696e 6465 780a  ing_point_index.
-00037130: 2020 2020 2020 2020 7472 6961 6e67 6c65          triangle
-00037140: 7320 2b3d 2070 6f6c 7967 6f6e 322e 636c  s += polygon2.cl
-00037150: 6f73 655f 7365 7769 6e67 2864 6963 745f  ose_sewing(dict_
-00037160: 636c 6f73 696e 675f 7061 6972 7329 0a0a  closing_pairs)..
-00037170: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-00037180: 7269 616e 676c 6573 0a0a 2020 2020 6465  riangles..    de
-00037190: 6620 6765 745f 7661 6c69 645f 636f 6e63  f get_valid_conc
-000371a0: 6176 655f 7365 7769 6e67 5f70 6f6c 7967  ave_sewing_polyg
-000371b0: 6f6e 2873 656c 662c 2070 6f6c 7967 6f6e  on(self, polygon
-000371c0: 315f 3264 2c20 706f 6c79 676f 6e32 5f32  1_2d, polygon2_2
-000371d0: 6429 3a0a 2020 2020 2020 2020 706f 6c79  d):.        poly
-000371e0: 676f 6e31 5f32 645f 7661 6c69 645f 5f70  gon1_2d_valid__p
-000371f0: 7269 6d69 7469 7665 203d 5c0a 2020 2020  rimitive =\.    
-00037200: 2020 2020 2020 2020 706f 6c79 676f 6e31          polygon1
-00037210: 5f32 642e 6765 745f 7661 6c69 645f 7365  _2d.get_valid_se
-00037220: 7769 6e67 5f70 6f6c 7967 6f6e 5f70 7269  wing_polygon_pri
-00037230: 6d69 7469 7665 2870 6f6c 7967 6f6e 325f  mitive(polygon2_
-00037240: 3264 290a 2020 2020 2020 2020 6966 2070  2d).        if p
-00037250: 6f6c 7967 6f6e 315f 3264 5f76 616c 6964  olygon1_2d_valid
-00037260: 5f5f 7072 696d 6974 6976 6520 3d3d 2070  __primitive == p
-00037270: 6f6c 7967 6f6e 315f 3264 2e6c 696e 655f  olygon1_2d.line_
-00037280: 7365 676d 656e 7473 5b30 5d3a 0a20 2020  segments[0]:.   
-00037290: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000372a0: 7365 6c66 0a20 2020 2020 2020 206e 6577  self.        new
-000372b0: 5f70 6f6c 7967 6f6e 5f70 7269 6d69 7469  _polygon_primiti
-000372c0: 7665 7320 3d20 5c0a 2020 2020 2020 2020  ves = \.        
-000372d0: 2020 2020 7365 6c66 2e6c 696e 655f 7365      self.line_se
-000372e0: 676d 656e 7473 5b70 6f6c 7967 6f6e 315f  gments[polygon1_
-000372f0: 3264 2e6c 696e 655f 7365 676d 656e 7473  2d.line_segments
-00037300: 2e69 6e64 6578 2870 6f6c 7967 6f6e 315f  .index(polygon1_
-00037310: 3264 5f76 616c 6964 5f5f 7072 696d 6974  2d_valid__primit
-00037320: 6976 6529 3a5d 202b 205c 0a20 2020 2020  ive):] + \.     
-00037330: 2020 2020 2020 2073 656c 662e 6c69 6e65         self.line
-00037340: 5f73 6567 6d65 6e74 735b 3a70 6f6c 7967  _segments[:polyg
-00037350: 6f6e 315f 3264 2e6c 696e 655f 7365 676d  on1_2d.line_segm
-00037360: 656e 7473 2e69 6e64 6578 2870 6f6c 7967  ents.index(polyg
-00037370: 6f6e 315f 3264 5f76 616c 6964 5f5f 7072  on1_2d_valid__pr
-00037380: 696d 6974 6976 6529 5d0a 2020 2020 2020  imitive)].      
-00037390: 2020 706f 6c79 676f 6e31 5f33 645f 706f    polygon1_3d_po
-000373a0: 696e 7473 203d 205b 5d0a 2020 2020 2020  ints = [].      
-000373b0: 2020 666f 7220 7072 696d 2069 6e20 6e65    for prim in ne
-000373c0: 775f 706f 6c79 676f 6e5f 7072 696d 6974  w_polygon_primit
-000373d0: 6976 6573 3a0a 2020 2020 2020 2020 2020  ives:.          
-000373e0: 2020 6966 2070 7269 6d2e 7374 6172 7420    if prim.start 
-000373f0: 6e6f 7420 696e 2070 6f6c 7967 6f6e 315f  not in polygon1_
-00037400: 3364 5f70 6f69 6e74 733a 0a20 2020 2020  3d_points:.     
-00037410: 2020 2020 2020 2020 2020 2070 6f6c 7967             polyg
-00037420: 6f6e 315f 3364 5f70 6f69 6e74 732e 6170  on1_3d_points.ap
-00037430: 7065 6e64 2870 7269 6d2e 7374 6172 7429  pend(prim.start)
-00037440: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00037450: 7072 696d 2e65 6e64 206e 6f74 2069 6e20  prim.end not in 
-00037460: 706f 6c79 676f 6e31 5f33 645f 706f 696e  polygon1_3d_poin
-00037470: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
-00037480: 2020 2020 706f 6c79 676f 6e31 5f33 645f      polygon1_3d_
-00037490: 706f 696e 7473 2e61 7070 656e 6428 7072  points.append(pr
-000374a0: 696d 2e65 6e64 290a 2020 2020 2020 2020  im.end).        
-000374b0: 7265 7475 726e 2043 6c6f 7365 6450 6f6c  return ClosedPol
-000374c0: 7967 6f6e 3344 2870 6f6c 7967 6f6e 315f  ygon3D(polygon1_
-000374d0: 3364 5f70 6f69 6e74 7329 0a0a 2020 2020  3d_points)..    
-000374e0: 6465 6620 636c 6f73 655f 7365 7769 6e67  def close_sewing
-000374f0: 2873 656c 662c 2064 6963 745f 636c 6f73  (self, dict_clos
-00037500: 696e 675f 7061 6972 7329 3a0a 2020 2020  ing_pairs):.    
-00037510: 2020 2020 7472 6961 6e67 6c65 735f 706f      triangles_po
-00037520: 696e 7473 203d 205b 5d0a 2020 2020 2020  ints = [].      
-00037530: 2020 666f 7220 692c 2070 6f69 6e74 5f70    for i, point_p
-00037540: 6f6c 7967 6f6e 3220 696e 2065 6e75 6d65  olygon2 in enume
-00037550: 7261 7465 280a 2020 2020 2020 2020 2020  rate(.          
-00037560: 2020 2020 2020 7365 6c66 2e70 6f69 6e74        self.point
-00037570: 7320 2b20 5b73 656c 662e 706f 696e 7473  s + [self.points
-00037580: 5b30 5d5d 293a 0a20 2020 2020 2020 2020  [0]]):.         
-00037590: 2020 2066 6f72 206a 2c20 696e 6465 7820     for j, index 
-000375a0: 696e 2065 6e75 6d65 7261 7465 286c 6973  in enumerate(lis
-000375b0: 7428 6469 6374 5f63 6c6f 7369 6e67 5f70  t(dict_closing_p
-000375c0: 6169 7273 2e76 616c 7565 7328 2929 293a  airs.values())):
-000375d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000375e0: 2069 6620 6920 213d 2030 3a0a 2020 2020   if i != 0:.    
-000375f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037600: 6966 2069 202d 2031 203e 3d20 696e 6465  if i - 1 >= inde
-00037610: 785b 305d 2061 6e64 2069 203c 3d20 696e  x[0] and i <= in
-00037620: 6465 785b 315d 3a0a 2020 2020 2020 2020  dex[1]:.        
-00037630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037640: 6661 6365 5f70 6f69 6e74 7320 3d20 5b73  face_points = [s
-00037650: 656c 662e 706f 696e 7473 5b69 202d 2031  elf.points[i - 1
-00037660: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00037670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037680: 2020 2020 2020 2020 2020 706f 696e 745f            point_
-00037690: 706f 6c79 676f 6e32 2c0a 2020 2020 2020  polygon2,.      
-000376a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000376b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000376c0: 206c 6973 7428 6469 6374 5f63 6c6f 7369   list(dict_closi
-000376d0: 6e67 5f70 6169 7273 2e6b 6579 7328 2929  ng_pairs.keys())
-000376e0: 5b6a 5d5d 0a20 2020 2020 2020 2020 2020  [j]].           
-000376f0: 2020 2020 2020 2020 2020 2020 2074 7269               tri
-00037700: 616e 676c 6573 5f70 6f69 6e74 732e 6170  angles_points.ap
-00037710: 7065 6e64 2866 6163 655f 706f 696e 7473  pend(face_points
-00037720: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00037730: 2020 2020 2020 656c 6966 2069 6e64 6578        elif index
-00037740: 5b30 5d20 3e20 696e 6465 785b 315d 3a0a  [0] > index[1]:.
-00037750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037760: 2020 2020 2020 2020 6966 2028 6920 2d20          if (i - 
-00037770: 3120 3c3d 2069 6e64 6578 5b30 5d20 616e  1 <= index[0] an
-00037780: 6420 6920 3c3d 2069 6e64 6578 5b31 5d29  d i <= index[1])
-00037790: 206f 7220 280a 2020 2020 2020 2020 2020   or (.          
-000377a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000377b0: 2020 2020 2020 2869 202d 2031 203e 3d20        (i - 1 >= 
-000377c0: 696e 6465 785b 305d 2920 616e 6420 6920  index[0]) and i 
-000377d0: 3e3d 2069 6e64 6578 5b31 5d29 3a0a 2020  >= index[1]):.  
-000377e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000377f0: 2020 2020 2020 2020 2020 6661 6365 5f70            face_p
-00037800: 6f69 6e74 7320 3d20 5b73 656c 662e 706f  oints = [self.po
-00037810: 696e 7473 5b69 202d 2031 5d2c 0a20 2020  ints[i - 1],.   
-00037820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037840: 2020 2020 2020 2020 706f 696e 745f 706f          point_po
-00037850: 6c79 676f 6e32 2c0a 2020 2020 2020 2020  lygon2,.        
-00037860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037880: 2020 206c 6973 7428 6469 6374 5f63 6c6f     list(dict_clo
-00037890: 7369 6e67 5f70 6169 7273 2e6b 6579 7328  sing_pairs.keys(
-000378a0: 2929 5b6a 5d5d 0a20 2020 2020 2020 2020  ))[j]].         
-000378b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000378c0: 2020 2074 7269 616e 676c 6573 5f70 6f69     triangles_poi
-000378d0: 6e74 732e 6170 7065 6e64 2866 6163 655f  nts.append(face_
-000378e0: 706f 696e 7473 290a 2020 2020 2020 2020  points).        
-000378f0: 7265 7475 726e 2074 7269 616e 676c 6573  return triangles
-00037900: 5f70 6f69 6e74 730a 0a20 2020 2064 6566  _points..    def
-00037910: 2063 6865 636b 5f73 6577 696e 6728 7365   check_sewing(se
-00037920: 6c66 2c20 706f 6c79 676f 6e32 2c20 7365  lf, polygon2, se
-00037930: 7769 6e67 5f66 6163 6573 293a 0a20 2020  wing_faces):.   
-00037940: 2020 2020 2069 6620 6e6f 7420 6c65 6e28       if not len(
-00037950: 7365 6c66 2e6c 696e 655f 7365 676d 656e  self.line_segmen
-00037960: 7473 2920 2b20 6c65 6e28 706f 6c79 676f  ts) + len(polygo
-00037970: 6e32 2e6c 696e 655f 7365 676d 656e 7473  n2.line_segments
-00037980: 2920 3d3d 206c 656e 2873 6577 696e 675f  ) == len(sewing_
-00037990: 6661 6365 7329 3a0a 2020 2020 2020 2020  faces):.        
-000379a0: 2020 2020 7265 7475 726e 2046 616c 7365      return False
-000379b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000379c0: 5472 7565 0a0a 2020 2020 6465 6620 7265  True..    def re
-000379d0: 6465 6669 6e65 5f73 6577 696e 675f 7472  define_sewing_tr
-000379e0: 6961 6e67 6c65 735f 706f 696e 7473 2873  iangles_points(s
-000379f0: 656c 662c 2074 7269 616e 676c 6573 5f70  elf, triangles_p
-00037a00: 6f69 6e74 732c 0a20 2020 2020 2020 2020  oints,.         
-00037a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037a30: 7061 7373 6564 5f62 795f 7a65 726f 5f69  passed_by_zero_i
-00037a40: 6e64 6578 2c0a 2020 2020 2020 2020 2020  ndex,.          
-00037a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037a60: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00037a70: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
-00037a80: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
-00037a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037aa0: 2020 2020 2020 2020 2020 2020 2070 7265               pre
-00037ab0: 7669 6f75 735f 636c 6f73 696e 675f 706f  vious_closing_po
-00037ac0: 696e 745f 696e 6465 7829 3a0a 2020 2020  int_index):.    
-00037ad0: 2020 2020 666f 7220 6e2c 2074 7269 616e      for n, trian
-00037ae0: 676c 655f 706f 696e 7473 2069 6e20 656e  gle_points in en
-00037af0: 756d 6572 6174 6528 7472 6961 6e67 6c65  umerate(triangle
-00037b00: 735f 706f 696e 7473 5b3a 3a2d 315d 293a  s_points[::-1]):
-00037b10: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00037b20: 286e 6f74 2070 6173 7365 645f 6279 5f7a  (not passed_by_z
-00037b30: 6572 6f5f 696e 6465 7820 616e 640a 2020  ero_index and.  
-00037b40: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00037b50: 6c66 2e70 6f69 6e74 732e 696e 6465 7828  lf.points.index(
-00037b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037b70: 2020 2020 2074 7269 616e 676c 655f 706f       triangle_po
-00037b80: 696e 7473 5b32 5d29 203e 2063 6c6f 7369  ints[2]) > closi
-00037b90: 6e67 5f70 6f69 6e74 5f69 6e64 6578 2920  ng_point_index) 
-00037ba0: 6f72 205c 0a20 2020 2020 2020 2020 2020  or \.           
-00037bb0: 2020 2020 2020 2020 2028 7061 7373 6564           (passed
-00037bc0: 5f62 795f 7a65 726f 5f69 6e64 6578 2061  _by_zero_index a
-00037bd0: 6e64 0a20 2020 2020 2020 2020 2020 2020  nd.             
-00037be0: 2020 2020 2020 2020 3020 3c3d 2073 656c          0 <= sel
-00037bf0: 662e 706f 696e 7473 2e69 6e64 6578 2874  f.points.index(t
-00037c00: 7269 616e 676c 655f 706f 696e 7473 5b0a  riangle_points[.
+00036b60: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
+00036b70: 6465 7820 3d20 6e65 775f 706f 6c79 676f  dex = new_polygo
+00036b80: 6e32 5f32 642e 706f 696e 7473 2e69 6e64  n2_2d.points.ind
+00036b90: 6578 280a 2020 2020 2020 2020 2020 2020  ex(.            
+00036ba0: 2020 2020 2020 2020 636c 6f73 696e 675f          closing_
+00036bb0: 706f 696e 7429 0a0a 2020 2020 2020 2020  point)..        
+00036bc0: 2020 2020 2020 2020 6966 2069 203d 3d20          if i == 
+00036bd0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+00036be0: 2020 2020 2020 2070 7265 7669 6f75 735f         previous_
+00036bf0: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
+00036c00: 6465 7820 3d20 636c 6f73 696e 675f 706f  dex = closing_po
+00036c10: 696e 745f 696e 6465 780a 2020 2020 2020  int_index.      
+00036c20: 2020 2020 2020 2020 2020 6966 2063 6c6f            if clo
+00036c30: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
+00036c40: 2021 3d20 7072 6576 696f 7573 5f63 6c6f   != previous_clo
+00036c50: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
+00036c60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00036c70: 2020 2020 2020 6966 2063 6c6f 7369 6e67        if closing
+00036c80: 5f70 6f69 6e74 5f69 6e64 6578 2069 6e20  _point_index in 
+00036c90: 6c69 7374 5f63 6c6f 7369 6e67 5f70 6f69  list_closing_poi
+00036ca0: 6e74 5f69 6e64 6578 6573 3a0a 2020 2020  nt_indexes:.    
+00036cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036cc0: 2020 2020 636c 6f73 696e 675f 706f 696e      closing_poin
+00036cd0: 745f 696e 6465 7820 3d20 7072 6576 696f  t_index = previo
+00036ce0: 7573 5f63 6c6f 7369 6e67 5f70 6f69 6e74  us_closing_point
+00036cf0: 5f69 6e64 6578 0a20 2020 2020 2020 2020  _index.         
+00036d00: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00036d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036d20: 2020 2020 2020 2020 2064 6963 745f 636c           dict_cl
+00036d30: 6f73 696e 675f 7061 6972 735b 7365 6c66  osing_pairs[self
+00036d40: 2e70 6f69 6e74 735b 6920 2d20 315d 5d20  .points[i - 1]] 
+00036d50: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00036d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036d70: 7072 6576 696f 7573 5f63 6c6f 7369 6e67  previous_closing
+00036d80: 5f70 6f69 6e74 5f69 6e64 6578 2c0a 2020  _point_index,.  
+00036d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036da0: 2020 2020 2020 2020 2020 636c 6f73 696e            closin
+00036db0: 675f 706f 696e 745f 696e 6465 7829 0a0a  g_point_index)..
+00036dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036dd0: 6966 2070 6f69 6e74 5f70 6f6c 7967 6f6e  if point_polygon
+00036de0: 3120 3d3d 206e 6577 5f70 6f6c 7967 6f6e  1 == new_polygon
+00036df0: 312e 706f 696e 7473 5b30 5d3a 0a20 2020  1.points[0]:.   
+00036e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036e10: 2069 6620 6c69 7374 2864 6963 745f 636c   if list(dict_cl
+00036e20: 6f73 696e 675f 7061 6972 732e 7661 6c75  osing_pairs.valu
+00036e30: 6573 2829 295b 2d31 5d5b 2d31 5d20 213d  es())[-1][-1] !=
+00036e40: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+00036e50: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00036e60: 6973 7428 6469 6374 5f63 6c6f 7369 6e67  ist(dict_closing
+00036e70: 5f70 6169 7273 2e76 616c 7565 7328 2929  _pairs.values())
+00036e80: 5b30 5d5b 305d 3a0a 2020 2020 2020 2020  [0][0]:.        
+00036e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ea0: 6469 6374 5f63 6c6f 7369 6e67 5f70 6169  dict_closing_pai
+00036eb0: 7273 5b73 656c 662e 706f 696e 7473 5b30  rs[self.points[0
+00036ec0: 5d5d 203d 2028 0a20 2020 2020 2020 2020  ]] = (.         
+00036ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ee0: 2020 206c 6973 7428 6469 6374 5f63 6c6f     list(dict_clo
+00036ef0: 7369 6e67 5f70 6169 7273 2e76 616c 7565  sing_pairs.value
+00036f00: 7328 2929 5b2d 315d 5b2d 315d 2c0a 2020  s())[-1][-1],.  
+00036f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036f20: 2020 2020 2020 2020 2020 6c69 7374 2864            list(d
+00036f30: 6963 745f 636c 6f73 696e 675f 7061 6972  ict_closing_pair
+00036f40: 732e 7661 6c75 6573 2829 295b 305d 5b30  s.values())[0][0
+00036f50: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
+00036f60: 2020 2020 7265 616c 5f63 6c6f 7369 6e67      real_closing
+00036f70: 5f70 6f69 6e74 203d 2070 6f6c 7967 6f6e  _point = polygon
+00036f80: 322e 706f 696e 7473 5b63 6c6f 7369 6e67  2.points[closing
+00036f90: 5f70 6f69 6e74 5f69 6e64 6578 5d0a 0a20  _point_index].. 
+00036fa0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00036fb0: 6163 655f 706f 696e 7473 203d 205b 7365  ace_points = [se
+00036fc0: 6c66 2e70 6f69 6e74 735b 6e65 775f 706f  lf.points[new_po
+00036fd0: 6c79 676f 6e31 2e70 6f69 6e74 732e 696e  lygon1.points.in
+00036fe0: 6465 7828 0a20 2020 2020 2020 2020 2020  dex(.           
+00036ff0: 2020 2020 2020 2020 2070 6f69 6e74 5f70           point_p
+00037000: 6f6c 7967 6f6e 3129 5d2c 2073 656c 662e  olygon1)], self.
+00037010: 706f 696e 7473 5b69 202d 2031 5d2c 0a20  points[i - 1],. 
+00037020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037040: 2072 6561 6c5f 636c 6f73 696e 675f 706f   real_closing_po
+00037050: 696e 745d 0a20 2020 2020 2020 2020 2020  int].           
+00037060: 2020 2020 2074 7269 616e 676c 6573 2e61       triangles.a
+00037070: 7070 656e 6428 6661 6365 5f70 6f69 6e74  ppend(face_point
+00037080: 7329 0a0a 2020 2020 2020 2020 2020 2020  s)..            
+00037090: 2020 2020 6c69 7374 5f63 6c6f 7369 6e67      list_closing
+000370a0: 5f70 6f69 6e74 5f69 6e64 6578 6573 2e61  _point_indexes.a
+000370b0: 7070 656e 6428 636c 6f73 696e 675f 706f  ppend(closing_po
+000370c0: 696e 745f 696e 6465 7829 0a20 2020 2020  int_index).     
+000370d0: 2020 2020 2020 2020 2020 2070 7265 7669             previ
+000370e0: 6f75 735f 636c 6f73 696e 675f 706f 696e  ous_closing_poin
+000370f0: 745f 696e 6465 7820 3d20 636c 6f73 696e  t_index = closin
+00037100: 675f 706f 696e 745f 696e 6465 780a 2020  g_point_index.  
+00037110: 2020 2020 2020 7472 6961 6e67 6c65 7320        triangles 
+00037120: 2b3d 2070 6f6c 7967 6f6e 322e 636c 6f73  += polygon2.clos
+00037130: 655f 7365 7769 6e67 2864 6963 745f 636c  e_sewing(dict_cl
+00037140: 6f73 696e 675f 7061 6972 7329 0a0a 2020  osing_pairs)..  
+00037150: 2020 2020 2020 7265 7475 726e 2074 7269        return tri
+00037160: 616e 676c 6573 0a0a 2020 2020 6465 6620  angles..    def 
+00037170: 6765 745f 7661 6c69 645f 636f 6e63 6176  get_valid_concav
+00037180: 655f 7365 7769 6e67 5f70 6f6c 7967 6f6e  e_sewing_polygon
+00037190: 2873 656c 662c 2070 6f6c 7967 6f6e 315f  (self, polygon1_
+000371a0: 3264 2c20 706f 6c79 676f 6e32 5f32 6429  2d, polygon2_2d)
+000371b0: 3a0a 2020 2020 2020 2020 706f 6c79 676f  :.        polygo
+000371c0: 6e31 5f32 645f 7661 6c69 645f 5f70 7269  n1_2d_valid__pri
+000371d0: 6d69 7469 7665 203d 5c0a 2020 2020 2020  mitive =\.      
+000371e0: 2020 2020 2020 706f 6c79 676f 6e31 5f32        polygon1_2
+000371f0: 642e 6765 745f 7661 6c69 645f 7365 7769  d.get_valid_sewi
+00037200: 6e67 5f70 6f6c 7967 6f6e 5f70 7269 6d69  ng_polygon_primi
+00037210: 7469 7665 2870 6f6c 7967 6f6e 325f 3264  tive(polygon2_2d
+00037220: 290a 2020 2020 2020 2020 6966 2070 6f6c  ).        if pol
+00037230: 7967 6f6e 315f 3264 5f76 616c 6964 5f5f  ygon1_2d_valid__
+00037240: 7072 696d 6974 6976 6520 3d3d 2070 6f6c  primitive == pol
+00037250: 7967 6f6e 315f 3264 2e6c 696e 655f 7365  ygon1_2d.line_se
+00037260: 676d 656e 7473 5b30 5d3a 0a20 2020 2020  gments[0]:.     
+00037270: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00037280: 6c66 0a20 2020 2020 2020 206e 6577 5f70  lf.        new_p
+00037290: 6f6c 7967 6f6e 5f70 7269 6d69 7469 7665  olygon_primitive
+000372a0: 7320 3d20 5c0a 2020 2020 2020 2020 2020  s = \.          
+000372b0: 2020 7365 6c66 2e6c 696e 655f 7365 676d    self.line_segm
+000372c0: 656e 7473 5b70 6f6c 7967 6f6e 315f 3264  ents[polygon1_2d
+000372d0: 2e6c 696e 655f 7365 676d 656e 7473 2e69  .line_segments.i
+000372e0: 6e64 6578 2870 6f6c 7967 6f6e 315f 3264  ndex(polygon1_2d
+000372f0: 5f76 616c 6964 5f5f 7072 696d 6974 6976  _valid__primitiv
+00037300: 6529 3a5d 202b 205c 0a20 2020 2020 2020  e):] + \.       
+00037310: 2020 2020 2073 656c 662e 6c69 6e65 5f73       self.line_s
+00037320: 6567 6d65 6e74 735b 3a70 6f6c 7967 6f6e  egments[:polygon
+00037330: 315f 3264 2e6c 696e 655f 7365 676d 656e  1_2d.line_segmen
+00037340: 7473 2e69 6e64 6578 2870 6f6c 7967 6f6e  ts.index(polygon
+00037350: 315f 3264 5f76 616c 6964 5f5f 7072 696d  1_2d_valid__prim
+00037360: 6974 6976 6529 5d0a 2020 2020 2020 2020  itive)].        
+00037370: 706f 6c79 676f 6e31 5f33 645f 706f 696e  polygon1_3d_poin
+00037380: 7473 203d 205b 5d0a 2020 2020 2020 2020  ts = [].        
+00037390: 666f 7220 7072 696d 2069 6e20 6e65 775f  for prim in new_
+000373a0: 706f 6c79 676f 6e5f 7072 696d 6974 6976  polygon_primitiv
+000373b0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+000373c0: 6966 2070 7269 6d2e 7374 6172 7420 6e6f  if prim.start no
+000373d0: 7420 696e 2070 6f6c 7967 6f6e 315f 3364  t in polygon1_3d
+000373e0: 5f70 6f69 6e74 733a 0a20 2020 2020 2020  _points:.       
+000373f0: 2020 2020 2020 2020 2070 6f6c 7967 6f6e           polygon
+00037400: 315f 3364 5f70 6f69 6e74 732e 6170 7065  1_3d_points.appe
+00037410: 6e64 2870 7269 6d2e 7374 6172 7429 0a20  nd(prim.start). 
+00037420: 2020 2020 2020 2020 2020 2069 6620 7072             if pr
+00037430: 696d 2e65 6e64 206e 6f74 2069 6e20 706f  im.end not in po
+00037440: 6c79 676f 6e31 5f33 645f 706f 696e 7473  lygon1_3d_points
+00037450: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00037460: 2020 706f 6c79 676f 6e31 5f33 645f 706f    polygon1_3d_po
+00037470: 696e 7473 2e61 7070 656e 6428 7072 696d  ints.append(prim
+00037480: 2e65 6e64 290a 2020 2020 2020 2020 7265  .end).        re
+00037490: 7475 726e 2043 6c6f 7365 6450 6f6c 7967  turn ClosedPolyg
+000374a0: 6f6e 3344 2870 6f6c 7967 6f6e 315f 3364  on3D(polygon1_3d
+000374b0: 5f70 6f69 6e74 7329 0a0a 2020 2020 6465  _points)..    de
+000374c0: 6620 636c 6f73 655f 7365 7769 6e67 2873  f close_sewing(s
+000374d0: 656c 662c 2064 6963 745f 636c 6f73 696e  elf, dict_closin
+000374e0: 675f 7061 6972 7329 3a0a 2020 2020 2020  g_pairs):.      
+000374f0: 2020 7472 6961 6e67 6c65 735f 706f 696e    triangles_poin
+00037500: 7473 203d 205b 5d0a 2020 2020 2020 2020  ts = [].        
+00037510: 666f 7220 692c 2070 6f69 6e74 5f70 6f6c  for i, point_pol
+00037520: 7967 6f6e 3220 696e 2065 6e75 6d65 7261  ygon2 in enumera
+00037530: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
+00037540: 2020 2020 7365 6c66 2e70 6f69 6e74 7320      self.points 
+00037550: 2b20 5b73 656c 662e 706f 696e 7473 5b30  + [self.points[0
+00037560: 5d5d 293a 0a20 2020 2020 2020 2020 2020  ]]):.           
+00037570: 2066 6f72 206a 2c20 696e 6465 7820 696e   for j, index in
+00037580: 2065 6e75 6d65 7261 7465 286c 6973 7428   enumerate(list(
+00037590: 6469 6374 5f63 6c6f 7369 6e67 5f70 6169  dict_closing_pai
+000375a0: 7273 2e76 616c 7565 7328 2929 293a 0a20  rs.values())):. 
+000375b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000375c0: 6620 6920 213d 2030 3a0a 2020 2020 2020  f i != 0:.      
+000375d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000375e0: 2069 202d 2031 203e 3d20 696e 6465 785b   i - 1 >= index[
+000375f0: 305d 2061 6e64 2069 203c 3d20 696e 6465  0] and i <= inde
+00037600: 785b 315d 3a0a 2020 2020 2020 2020 2020  x[1]:.          
+00037610: 2020 2020 2020 2020 2020 2020 2020 6661                fa
+00037620: 6365 5f70 6f69 6e74 7320 3d20 5b73 656c  ce_points = [sel
+00037630: 662e 706f 696e 7473 5b69 202d 2031 5d2c  f.points[i - 1],
+00037640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037660: 2020 2020 2020 2020 706f 696e 745f 706f          point_po
+00037670: 6c79 676f 6e32 2c0a 2020 2020 2020 2020  lygon2,.        
+00037680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037690: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000376a0: 6973 7428 6469 6374 5f63 6c6f 7369 6e67  ist(dict_closing
+000376b0: 5f70 6169 7273 2e6b 6579 7328 2929 5b6a  _pairs.keys())[j
+000376c0: 5d5d 0a20 2020 2020 2020 2020 2020 2020  ]].             
+000376d0: 2020 2020 2020 2020 2020 2074 7269 616e             trian
+000376e0: 676c 6573 5f70 6f69 6e74 732e 6170 7065  gles_points.appe
+000376f0: 6e64 2866 6163 655f 706f 696e 7473 290a  nd(face_points).
+00037700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037710: 2020 2020 656c 6966 2069 6e64 6578 5b30      elif index[0
+00037720: 5d20 3e20 696e 6465 785b 315d 3a0a 2020  ] > index[1]:.  
+00037730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037740: 2020 2020 2020 6966 2028 6920 2d20 3120        if (i - 1 
+00037750: 3c3d 2069 6e64 6578 5b30 5d20 616e 6420  <= index[0] and 
+00037760: 6920 3c3d 2069 6e64 6578 5b31 5d29 206f  i <= index[1]) o
+00037770: 7220 280a 2020 2020 2020 2020 2020 2020  r (.            
+00037780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037790: 2020 2020 2869 202d 2031 203e 3d20 696e      (i - 1 >= in
+000377a0: 6465 785b 305d 2920 616e 6420 6920 3e3d  dex[0]) and i >=
+000377b0: 2069 6e64 6578 5b31 5d29 3a0a 2020 2020   index[1]):.    
+000377c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000377d0: 2020 2020 2020 2020 6661 6365 5f70 6f69          face_poi
+000377e0: 6e74 7320 3d20 5b73 656c 662e 706f 696e  nts = [self.poin
+000377f0: 7473 5b69 202d 2031 5d2c 0a20 2020 2020  ts[i - 1],.     
+00037800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037820: 2020 2020 2020 706f 696e 745f 706f 6c79        point_poly
+00037830: 676f 6e32 2c0a 2020 2020 2020 2020 2020  gon2,.          
+00037840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037860: 206c 6973 7428 6469 6374 5f63 6c6f 7369   list(dict_closi
+00037870: 6e67 5f70 6169 7273 2e6b 6579 7328 2929  ng_pairs.keys())
+00037880: 5b6a 5d5d 0a20 2020 2020 2020 2020 2020  [j]].           
+00037890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000378a0: 2074 7269 616e 676c 6573 5f70 6f69 6e74   triangles_point
+000378b0: 732e 6170 7065 6e64 2866 6163 655f 706f  s.append(face_po
+000378c0: 696e 7473 290a 2020 2020 2020 2020 7265  ints).        re
+000378d0: 7475 726e 2074 7269 616e 676c 6573 5f70  turn triangles_p
+000378e0: 6f69 6e74 730a 0a20 2020 2064 6566 2063  oints..    def c
+000378f0: 6865 636b 5f73 6577 696e 6728 7365 6c66  heck_sewing(self
+00037900: 2c20 706f 6c79 676f 6e32 2c20 7365 7769  , polygon2, sewi
+00037910: 6e67 5f66 6163 6573 293a 0a20 2020 2020  ng_faces):.     
+00037920: 2020 2069 6620 6e6f 7420 6c65 6e28 7365     if not len(se
+00037930: 6c66 2e6c 696e 655f 7365 676d 656e 7473  lf.line_segments
+00037940: 2920 2b20 6c65 6e28 706f 6c79 676f 6e32  ) + len(polygon2
+00037950: 2e6c 696e 655f 7365 676d 656e 7473 2920  .line_segments) 
+00037960: 3d3d 206c 656e 2873 6577 696e 675f 6661  == len(sewing_fa
+00037970: 6365 7329 3a0a 2020 2020 2020 2020 2020  ces):.          
+00037980: 2020 7265 7475 726e 2046 616c 7365 0a20    return False. 
+00037990: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+000379a0: 7565 0a0a 2020 2020 6465 6620 7265 6465  ue..    def rede
+000379b0: 6669 6e65 5f73 6577 696e 675f 7472 6961  fine_sewing_tria
+000379c0: 6e67 6c65 735f 706f 696e 7473 2873 656c  ngles_points(sel
+000379d0: 662c 2074 7269 616e 676c 6573 5f70 6f69  f, triangles_poi
+000379e0: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
+000379f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037a00: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00037a10: 7373 6564 5f62 795f 7a65 726f 5f69 6e64  ssed_by_zero_ind
+00037a20: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
+00037a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037a40: 2020 2020 2020 2020 2020 2020 2063 6c6f               clo
+00037a50: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
+00037a60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00037a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037a80: 2020 2020 2020 2020 2020 2070 7265 7669             previ
+00037a90: 6f75 735f 636c 6f73 696e 675f 706f 696e  ous_closing_poin
+00037aa0: 745f 696e 6465 7829 3a0a 2020 2020 2020  t_index):.      
+00037ab0: 2020 666f 7220 6e2c 2074 7269 616e 676c    for n, triangl
+00037ac0: 655f 706f 696e 7473 2069 6e20 656e 756d  e_points in enum
+00037ad0: 6572 6174 6528 7472 6961 6e67 6c65 735f  erate(triangles_
+00037ae0: 706f 696e 7473 5b3a 3a2d 315d 293a 0a20  points[::-1]):. 
+00037af0: 2020 2020 2020 2020 2020 2069 6620 286e             if (n
+00037b00: 6f74 2070 6173 7365 645f 6279 5f7a 6572  ot passed_by_zer
+00037b10: 6f5f 696e 6465 7820 616e 640a 2020 2020  o_index and.    
+00037b20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00037b30: 2e70 6f69 6e74 732e 696e 6465 7828 0a20  .points.index(. 
+00037b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037b50: 2020 2074 7269 616e 676c 655f 706f 696e     triangle_poin
+00037b60: 7473 5b32 5d29 203e 2063 6c6f 7369 6e67  ts[2]) > closing
+00037b70: 5f70 6f69 6e74 5f69 6e64 6578 2920 6f72  _point_index) or
+00037b80: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+00037b90: 2020 2020 2020 2028 7061 7373 6564 5f62         (passed_b
+00037ba0: 795f 7a65 726f 5f69 6e64 6578 2061 6e64  y_zero_index and
+00037bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037bc0: 2020 2020 2020 3020 3c3d 2073 656c 662e        0 <= self.
+00037bd0: 706f 696e 7473 2e69 6e64 6578 2874 7269  points.index(tri
+00037be0: 616e 676c 655f 706f 696e 7473 5b0a 2020  angle_points[.  
+00037bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00037c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037c40: 2020 2020 2020 2032 5d29 203c 3d20 7072         2]) <= pr
-00037c50: 6576 696f 7573 5f63 6c6f 7369 6e67 5f70  evious_closing_p
-00037c60: 6f69 6e74 5f69 6e64 6578 2061 6e64 0a20  oint_index and. 
-00037c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037c80: 2020 2020 7365 6c66 2e70 6f69 6e74 732e      self.points.
-00037c90: 696e 6465 7828 0a20 2020 2020 2020 2020  index(.         
-00037ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037cb0: 7472 6961 6e67 6c65 5f70 6f69 6e74 735b  triangle_points[
-00037cc0: 325d 2920 3e20 636c 6f73 696e 675f 706f  2]) > closing_po
-00037cd0: 696e 745f 696e 6465 7829 3a0a 2020 2020  int_index):.    
-00037ce0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00037cf0: 6661 6365 5f70 6f69 6e74 7320 3d20 5b74  face_points = [t
-00037d00: 7269 616e 676c 6573 5f70 6f69 6e74 735b  riangles_points[
-00037d10: 2d28 6e20 2b20 3129 5d5b 305d 2c0a 2020  -(n + 1)][0],.  
-00037d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037d40: 2074 7269 616e 676c 6573 5f70 6f69 6e74   triangles_point
-00037d50: 735b 2d28 6e20 2b20 3129 5d5b 315d 2c0a  s[-(n + 1)][1],.
-00037d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037c20: 2020 2020 2032 5d29 203c 3d20 7072 6576       2]) <= prev
+00037c30: 696f 7573 5f63 6c6f 7369 6e67 5f70 6f69  ious_closing_poi
+00037c40: 6e74 5f69 6e64 6578 2061 6e64 0a20 2020  nt_index and.   
+00037c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037c60: 2020 7365 6c66 2e70 6f69 6e74 732e 696e    self.points.in
+00037c70: 6465 7828 0a20 2020 2020 2020 2020 2020  dex(.           
+00037c80: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00037c90: 6961 6e67 6c65 5f70 6f69 6e74 735b 325d  iangle_points[2]
+00037ca0: 2920 3e20 636c 6f73 696e 675f 706f 696e  ) > closing_poin
+00037cb0: 745f 696e 6465 7829 3a0a 2020 2020 2020  t_index):.      
+00037cc0: 2020 2020 2020 2020 2020 6e65 775f 6661            new_fa
+00037cd0: 6365 5f70 6f69 6e74 7320 3d20 5b74 7269  ce_points = [tri
+00037ce0: 616e 676c 6573 5f70 6f69 6e74 735b 2d28  angles_points[-(
+00037cf0: 6e20 2b20 3129 5d5b 305d 2c0a 2020 2020  n + 1)][0],.    
+00037d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037d10: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00037d20: 7269 616e 676c 6573 5f70 6f69 6e74 735b  riangles_points[
+00037d30: 2d28 6e20 2b20 3129 5d5b 315d 2c0a 2020  -(n + 1)][1],.  
+00037d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037d60: 2073 656c 662e 706f 696e 7473 5b0a 2020   self.points[.  
 00037d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037d80: 2020 2073 656c 662e 706f 696e 7473 5b0a     self.points[.
-00037d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037db0: 2020 2020 2020 2063 6c6f 7369 6e67 5f70         closing_p
-00037dc0: 6f69 6e74 5f69 6e64 6578 5d5d 0a20 2020  oint_index]].   
-00037dd0: 2020 2020 2020 2020 2020 2020 2074 7269               tri
-00037de0: 616e 676c 6573 5f70 6f69 6e74 735b 2d28  angles_points[-(
-00037df0: 6e20 2b20 3129 5d20 3d20 6e65 775f 6661  n + 1)] = new_fa
-00037e00: 6365 5f70 6f69 6e74 730a 0a20 2020 2020  ce_points..     
-00037e10: 2020 2072 6574 7572 6e20 7472 6961 6e67     return triang
-00037e20: 6c65 735f 706f 696e 7473 0a0a 2020 2020  les_points..    
-00037e30: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-00037e40: 2020 6465 6620 636c 6561 6e5f 7365 7769    def clean_sewi
-00037e50: 6e67 5f63 6c6f 7369 6e67 5f70 6169 7273  ng_closing_pairs
-00037e60: 5f64 6963 7469 6f6e 6172 7928 6469 6374  _dictionary(dict
-00037e70: 5f63 6c6f 7369 6e67 5f70 6169 7273 2c0a  _closing_pairs,.
-00037e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037ea0: 2020 2020 2020 2020 2020 2020 2020 636c                cl
-00037eb0: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
-00037ec0: 782c 0a20 2020 2020 2020 2020 2020 2020  x,.             
-00037ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037ef0: 2070 6173 7365 645f 6279 5f7a 6572 6f5f   passed_by_zero_
-00037f00: 696e 6465 7829 3a0a 2020 2020 2020 2020  index):.        
-00037f10: 2222 220a 2020 2020 2020 2020 436c 6561  """.        Clea
-00037f20: 6e73 2074 6865 2064 6963 7469 6f6e 6172  ns the dictionar
-00037f30: 7920 636f 6e74 6169 6e69 6e67 2074 6865  y containing the
-00037f40: 2073 6577 696e 6720 636c 6f73 696e 6720   sewing closing 
-00037f50: 7061 6972 7320 696e 666f 726d 6174 696f  pairs informatio
-00037f60: 6e0a 2020 2020 2020 2020 696e 2063 6173  n.        in cas
-00037f70: 6520 6974 206e 6565 6473 2074 6f20 6265  e it needs to be
-00037f80: 2072 6563 616c 6375 6c61 7465 6420 6475   recalculated du
-00037f90: 6520 746f 2063 6861 6e67 696e 6720 636c  e to changing cl
-00037fa0: 6f73 696e 6720 706f 696e 7473 2e0a 0a20  osing points... 
-00037fb0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00037fc0: 2020 2064 6963 745f 636c 6f73 696e 675f     dict_closing_
-00037fd0: 7061 6972 735f 7661 6c75 6573 203d 206c  pairs_values = l
-00037fe0: 6973 7428 6469 6374 5f63 6c6f 7369 6e67  ist(dict_closing
-00037ff0: 5f70 6169 7273 2e76 616c 7565 7328 2929  _pairs.values())
-00038000: 0a20 2020 2020 2020 2064 6963 745f 636c  .        dict_cl
-00038010: 6f73 696e 675f 7061 6972 735f 6b65 7973  osing_pairs_keys
-00038020: 203d 206c 6973 7428 6469 6374 5f63 6c6f   = list(dict_clo
-00038030: 7369 6e67 5f70 6169 7273 2e6b 6579 7328  sing_pairs.keys(
-00038040: 2929 0a20 2020 2020 2020 2070 7265 7669  )).        previ
-00038050: 6f75 735f 636c 6f73 696e 675f 706f 696e  ous_closing_poin
-00038060: 745f 696e 6465 7820 3d20 6469 6374 5f63  t_index = dict_c
-00038070: 6c6f 7369 6e67 5f70 6169 7273 5f76 616c  losing_pairs_val
-00038080: 7565 735b 2d31 5d5b 315d 0a20 2020 2020  ues[-1][1].     
-00038090: 2020 206c 6173 745f 6469 6374 5f76 616c     last_dict_val
-000380a0: 7565 203d 2070 7265 7669 6f75 735f 636c  ue = previous_cl
-000380b0: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
-000380c0: 780a 2020 2020 2020 2020 666f 7220 692c  x.        for i,
-000380d0: 206b 6579 2069 6e20 656e 756d 6572 6174   key in enumerat
-000380e0: 6528 6469 6374 5f63 6c6f 7369 6e67 5f70  e(dict_closing_p
-000380f0: 6169 7273 5f6b 6579 735b 3a3a 2d31 5d29  airs_keys[::-1])
-00038100: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00038110: 2028 6e6f 7420 7061 7373 6564 5f62 795f   (not passed_by_
-00038120: 7a65 726f 5f69 6e64 6578 2061 6e64 0a20  zero_index and. 
-00038130: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00038140: 6173 745f 6469 6374 5f76 616c 7565 203e  ast_dict_value >
-00038150: 2063 6c6f 7369 6e67 5f70 6f69 6e74 5f69   closing_point_i
-00038160: 6e64 6578 2920 6f72 205c 0a20 2020 2020  ndex) or \.     
-00038170: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-00038180: 7061 7373 6564 5f62 795f 7a65 726f 5f69  passed_by_zero_i
-00038190: 6e64 6578 2061 6e64 0a20 2020 2020 2020  ndex and.       
-000381a0: 2020 2020 2020 2020 2020 2020 2020 3020                0 
-000381b0: 3c3d 206c 6173 745f 6469 6374 5f76 616c  <= last_dict_val
-000381c0: 7565 203c 3d20 7072 6576 696f 7573 5f63  ue <= previous_c
-000381d0: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
-000381e0: 6578 2061 6e64 0a20 2020 2020 2020 2020  ex and.         
-000381f0: 2020 2020 2020 2020 2020 2020 6c61 7374              last
-00038200: 5f64 6963 745f 7661 6c75 6520 3e20 636c  _dict_value > cl
-00038210: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
-00038220: 7829 3a0a 2020 2020 2020 2020 2020 2020  x):.            
-00038230: 2020 2020 6c6f 7765 725f 626f 756e 6464      lower_boundd
-00038240: 6172 795f 636c 6f73 696e 675f 706f 696e  ary_closing_poin
-00038250: 7420 3d20 6b65 790a 2020 2020 2020 2020  t = key.        
-00038260: 2020 2020 2020 2020 6465 6c20 6469 6374          del dict
-00038270: 5f63 6c6f 7369 6e67 5f70 6169 7273 5b6b  _closing_pairs[k
-00038280: 6579 5d0a 2020 2020 2020 2020 2020 2020  ey].            
-00038290: 2020 2020 6966 206e 6f74 2064 6963 745f      if not dict_
-000382a0: 636c 6f73 696e 675f 7061 6972 733a 0a20  closing_pairs:. 
-000382b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000382c0: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
-000382d0: 2020 2020 2020 2020 206c 6173 745f 6469           last_di
-000382e0: 6374 5f76 616c 7565 203d 2064 6963 745f  ct_value = dict_
-000382f0: 636c 6f73 696e 675f 7061 6972 735f 7661  closing_pairs_va
-00038300: 6c75 6573 5b2d 6920 2d20 325d 5b31 5d0a  lues[-i - 2][1].
-00038310: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00038320: 6469 6374 5f63 6c6f 7369 6e67 5f70 6169  dict_closing_pai
-00038330: 7273 2c20 6c6f 7765 725f 626f 756e 6464  rs, lower_boundd
-00038340: 6172 795f 636c 6f73 696e 675f 706f 696e  ary_closing_poin
-00038350: 740a 0a20 2020 2040 7374 6174 6963 6d65  t..    @staticme
-00038360: 7468 6f64 0a20 2020 2064 6566 2069 735f  thod.    def is_
-00038370: 7365 7769 6e67 5f66 6f72 7761 7264 2863  sewing_forward(c
-00038380: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
-00038390: 6578 2c20 6c69 7374 5f63 6c6f 7369 6e67  ex, list_closing
-000383a0: 5f70 6f69 6e74 5f69 6e64 6578 6573 2920  _point_indexes) 
-000383b0: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
-000383c0: 2069 6620 636c 6f73 696e 675f 706f 696e   if closing_poin
-000383d0: 745f 696e 6465 7820 3c20 6c69 7374 5f63  t_index < list_c
-000383e0: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
-000383f0: 6578 6573 5b2d 315d 3a0a 2020 2020 2020  exes[-1]:.      
-00038400: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
-00038410: 7365 0a20 2020 2020 2020 2072 6574 7572  se.        retur
-00038420: 6e20 5472 7565 0a0a 2020 2020 4073 7461  n True..    @sta
-00038430: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
-00038440: 6620 7365 7769 6e67 5f63 6c6f 7369 6e67  f sewing_closing
-00038450: 5f70 6f69 6e74 735f 746f 5f72 656d 6f76  _points_to_remov
-00038460: 6528 636c 6f73 696e 675f 706f 696e 745f  e(closing_point_
-00038470: 696e 6465 782c 206c 6973 745f 636c 6f73  index, list_clos
-00038480: 696e 675f 706f 696e 745f 696e 6465 7865  ing_point_indexe
-00038490: 732c 2070 6173 7365 645f 6279 5f7a 6572  s, passed_by_zer
-000384a0: 6f5f 696e 6465 7829 3a0a 2020 2020 2020  o_index):.      
-000384b0: 2020 6c69 7374 5f72 656d 6f76 655f 636c    list_remove_cl
-000384c0: 6f73 696e 675f 706f 696e 7473 203d 205b  osing_points = [
-000384d0: 5d0a 2020 2020 2020 2020 666f 7220 6964  ].        for id
-000384e0: 7820 696e 206c 6973 745f 636c 6f73 696e  x in list_closin
-000384f0: 675f 706f 696e 745f 696e 6465 7865 735b  g_point_indexes[
-00038500: 3a3a 2d31 5d3a 0a20 2020 2020 2020 2020  ::-1]:.         
-00038510: 2020 2069 6620 6e6f 7420 7061 7373 6564     if not passed
-00038520: 5f62 795f 7a65 726f 5f69 6e64 6578 3a0a  _by_zero_index:.
-00038530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038540: 6966 2069 6478 203e 2063 6c6f 7369 6e67  if idx > closing
-00038550: 5f70 6f69 6e74 5f69 6e64 6578 3a0a 2020  _point_index:.  
-00038560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038570: 2020 6c69 7374 5f72 656d 6f76 655f 636c    list_remove_cl
-00038580: 6f73 696e 675f 706f 696e 7473 2e61 7070  osing_points.app
-00038590: 656e 6428 6964 7829 0a20 2020 2020 2020  end(idx).       
-000385a0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-000385b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000385c0: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
-000385d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000385e0: 2020 2020 2020 2020 2020 2069 6620 3020             if 0 
-000385f0: 3c20 6964 7820 3c3d 206c 6973 745f 636c  < idx <= list_cl
-00038600: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
-00038610: 7865 735b 2d31 5d20 616e 6420 5c0a 2020  xes[-1] and \.  
-00038620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038630: 2020 2020 2020 6964 7820 3e20 636c 6f73        idx > clos
-00038640: 696e 675f 706f 696e 745f 696e 6465 783a  ing_point_index:
-00038650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038660: 2020 2020 206c 6973 745f 7265 6d6f 7665       list_remove
-00038670: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 732e  _closing_points.
-00038680: 6170 7065 6e64 2869 6478 290a 2020 2020  append(idx).    
-00038690: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000386a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000386b0: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-000386c0: 2020 2020 7265 7475 726e 206c 6973 745f      return list_
-000386d0: 7265 6d6f 7665 5f63 6c6f 7369 6e67 5f70  remove_closing_p
-000386e0: 6f69 6e74 730a 0a20 2020 2040 7374 6174  oints..    @stat
-000386f0: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
-00038700: 2073 6577 696e 675f 636c 6f73 696e 675f   sewing_closing_
-00038710: 706f 696e 745f 7061 7374 5f70 6f69 6e74  point_past_point
-00038720: 3028 636c 6f73 696e 675f 706f 696e 745f  0(closing_point_
-00038730: 696e 6465 782c 206c 6973 745f 636c 6f73  index, list_clos
-00038740: 696e 675f 706f 696e 745f 696e 6465 7865  ing_point_indexe
-00038750: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00038760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038770: 2020 2020 2020 2020 2020 2020 7061 7373              pass
-00038780: 6564 5f62 795f 7a65 726f 5f69 6e64 6578  ed_by_zero_index
-00038790: 2c20 7261 7469 6f5f 6465 6e6f 6d69 6e61  , ratio_denomina
-000387a0: 746f 7229 3a0a 2020 2020 2020 2020 6c61  tor):.        la
-000387b0: 7374 5f74 6f5f 6e65 775f 706f 696e 745f  st_to_new_point_
-000387c0: 696e 6465 785f 7261 7469 6f20 3d20 286c  index_ratio = (l
-000387d0: 6973 745f 636c 6f73 696e 675f 706f 696e  ist_closing_poin
-000387e0: 745f 696e 6465 7865 735b 2d31 5d20 2d0a  t_indexes[-1] -.
-000387f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038810: 2020 2020 2020 2020 2063 6c6f 7369 6e67           closing
-00038820: 5f70 6f69 6e74 5f69 6e64 6578 2920 2f20  _point_index) / 
-00038830: 7261 7469 6f5f 6465 6e6f 6d69 6e61 746f  ratio_denominato
-00038840: 720a 2020 2020 2020 2020 6966 2070 6173  r.        if pas
-00038850: 7365 645f 6279 5f7a 6572 6f5f 696e 6465  sed_by_zero_inde
-00038860: 783a 0a20 2020 2020 2020 2020 2020 2072  x:.            r
-00038870: 6174 696f 203d 2028 6c69 7374 5f63 6c6f  atio = (list_clo
-00038880: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
-00038890: 6573 5b30 5d20 2d20 636c 6f73 696e 675f  es[0] - closing_
-000388a0: 706f 696e 745f 696e 6465 7829 202f 2072  point_index) / r
-000388b0: 6174 696f 5f64 656e 6f6d 696e 6174 6f72  atio_denominator
-000388c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000388d0: 6d61 7468 2e69 7363 6c6f 7365 2872 6174  math.isclose(rat
-000388e0: 696f 2c20 312c 2061 6273 5f74 6f6c 3d30  io, 1, abs_tol=0
-000388f0: 2e33 293a 0a20 2020 2020 2020 2020 2020  .3):.           
-00038900: 2020 2020 2063 6c6f 7369 6e67 5f70 6f69       closing_poi
-00038910: 6e74 5f69 6e64 6578 203d 206c 6973 745f  nt_index = list_
-00038920: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
-00038930: 6465 7865 735b 305d 0a20 2020 2020 2020  dexes[0].       
-00038940: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00038950: 2020 2020 2020 2020 2020 2063 6c6f 7369             closi
-00038960: 6e67 5f70 6f69 6e74 5f69 6e64 6578 203d  ng_point_index =
-00038970: 206c 6973 745f 636c 6f73 696e 675f 706f   list_closing_po
-00038980: 696e 745f 696e 6465 7865 735b 2d31 5d0a  int_indexes[-1].
-00038990: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000389a0: 2020 2020 2020 2020 2020 6966 2063 6c6f            if clo
-000389b0: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
-000389c0: 203e 206c 6973 745f 636c 6f73 696e 675f   > list_closing_
-000389d0: 706f 696e 745f 696e 6465 7865 735b 305d  point_indexes[0]
-000389e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000389f0: 2020 7261 7469 6f31 203d 2028 636c 6f73    ratio1 = (clos
-00038a00: 696e 675f 706f 696e 745f 696e 6465 7820  ing_point_index 
-00038a10: 2d0a 2020 2020 2020 2020 2020 2020 2020  -.              
-00038a20: 2020 2020 2020 2020 2020 2020 6c69 7374              list
-00038a30: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f69  _closing_point_i
-00038a40: 6e64 6578 6573 5b30 5d29 202f 2072 6174  ndexes[0]) / rat
-00038a50: 696f 5f64 656e 6f6d 696e 6174 6f72 0a20  io_denominator. 
-00038a60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00038a70: 6620 6d61 7468 2e69 7363 6c6f 7365 2872  f math.isclose(r
-00038a80: 6174 696f 312c 2030 2c20 6162 735f 746f  atio1, 0, abs_to
-00038a90: 6c3d 302e 3329 2061 6e64 205c 0a20 2020  l=0.3) and \.   
-00038aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038ab0: 2020 2020 206d 6174 682e 6973 636c 6f73       math.isclos
-00038ac0: 6528 6c61 7374 5f74 6f5f 6e65 775f 706f  e(last_to_new_po
-00038ad0: 696e 745f 696e 6465 785f 7261 7469 6f2c  int_index_ratio,
-00038ae0: 2031 2c20 6162 735f 746f 6c3d 302e 3329   1, abs_tol=0.3)
-00038af0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00038b00: 2020 2020 2020 7061 7373 6564 5f62 795f        passed_by_
-00038b10: 7a65 726f 5f69 6e64 6578 203d 2054 7275  zero_index = Tru
-00038b20: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00038b30: 2020 2020 2020 636c 6f73 696e 675f 706f        closing_po
-00038b40: 696e 745f 696e 6465 7820 3d20 6c69 7374  int_index = list
-00038b50: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f69  _closing_point_i
-00038b60: 6e64 6578 6573 5b30 5d0a 2020 2020 2020  ndexes[0].      
-00038b70: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00038b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038b90: 2020 2020 636c 6f73 696e 675f 706f 696e      closing_poin
-00038ba0: 745f 696e 6465 7820 3d20 6c69 7374 5f63  t_index = list_c
-00038bb0: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
-00038bc0: 6578 6573 5b2d 315d 0a20 2020 2020 2020  exes[-1].       
-00038bd0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00038be0: 2020 2020 2020 2020 2020 2069 6620 636c             if cl
-00038bf0: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
-00038c00: 7820 3c20 7261 7469 6f5f 6465 6e6f 6d69  x < ratio_denomi
-00038c10: 6e61 746f 7220 2f20 343a 0a20 2020 2020  nator / 4:.     
-00038c20: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00038c30: 6173 7365 645f 6279 5f7a 6572 6f5f 696e  assed_by_zero_in
-00038c40: 6465 7820 3d20 5472 7565 0a20 2020 2020  dex = True.     
-00038c50: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00038c60: 7261 7469 6f5f 6465 6e6f 6d69 6e61 746f  ratio_denominato
-00038c70: 7220 2d20 6c69 7374 5f63 6c6f 7369 6e67  r - list_closing
-00038c80: 5f70 6f69 6e74 5f69 6e64 6578 6573 5b2d  _point_indexes[-
-00038c90: 315d 203e 3d20 363a 0a20 2020 2020 2020  1] >= 6:.       
-00038ca0: 2020 2020 2020 2020 2020 2020 2063 6c6f               clo
-00038cb0: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
-00038cc0: 203d 206c 6973 745f 636c 6f73 696e 675f   = list_closing_
-00038cd0: 706f 696e 745f 696e 6465 7865 735b 2d31  point_indexes[-1
-00038ce0: 5d20 2b20 350a 2020 2020 2020 2020 2020  ] + 5.          
-00038cf0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00038d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038d10: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
-00038d20: 6465 7820 3d20 6c69 7374 5f63 6c6f 7369  dex = list_closi
-00038d30: 6e67 5f70 6f69 6e74 5f69 6e64 6578 6573  ng_point_indexes
-00038d40: 5b2d 315d 0a20 2020 2020 2020 2072 6574  [-1].        ret
-00038d50: 7572 6e20 636c 6f73 696e 675f 706f 696e  urn closing_poin
-00038d60: 745f 696e 6465 782c 2070 6173 7365 645f  t_index, passed_
-00038d70: 6279 5f7a 6572 6f5f 696e 6465 780a 0a20  by_zero_index.. 
-00038d80: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
-00038d90: 0a20 2020 2064 6566 2076 616c 6964 6174  .    def validat
-00038da0: 655f 636f 6e63 6176 655f 636c 6f73 696e  e_concave_closin
-00038db0: 675f 706f 696e 7428 636c 6f73 696e 675f  g_point(closing_
-00038dc0: 706f 696e 745f 696e 6465 782c 0a20 2020  point_index,.   
-00038dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038df0: 2020 2020 6c69 7374 5f63 6c6f 7369 6e67      list_closing
-00038e00: 5f70 6f69 6e74 5f69 6e64 6578 6573 2c0a  _point_indexes,.
-00038e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038e30: 2020 2020 2020 2070 6173 7365 645f 6279         passed_by
-00038e40: 5f7a 6572 6f5f 696e 6465 782c 0a20 2020  _zero_index,.   
-00038e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038e70: 2020 2020 7261 7469 6f5f 6465 6e6f 6d69      ratio_denomi
-00038e80: 6e61 746f 722c 2070 6f6c 7967 6f6e 735f  nator, polygons_
-00038e90: 706f 696e 7473 5f72 6174 696f 293a 0a20  points_ratio):. 
-00038ea0: 2020 2020 2020 2069 6620 636c 6f73 696e         if closin
-00038eb0: 675f 706f 696e 745f 696e 6465 7820 3d3d  g_point_index ==
-00038ec0: 206c 6973 745f 636c 6f73 696e 675f 706f   list_closing_po
-00038ed0: 696e 745f 696e 6465 7865 735b 2d31 5d3a  int_indexes[-1]:
-00038ee0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00038ef0: 7572 6e20 636c 6f73 696e 675f 706f 696e  urn closing_poin
-00038f00: 745f 696e 6465 782c 205b 5d2c 2070 6173  t_index, [], pas
-00038f10: 7365 645f 6279 5f7a 6572 6f5f 696e 6465  sed_by_zero_inde
-00038f20: 780a 0a20 2020 2020 2020 206c 6973 745f  x..        list_
-00038f30: 7265 6d6f 7665 5f63 6c6f 7369 6e67 5f70  remove_closing_p
-00038f40: 6f69 6e74 7320 3d20 5b5d 0a20 2020 2020  oints = [].     
-00038f50: 2020 2072 6174 696f 203d 2028 6c69 7374     ratio = (list
-00038f60: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f69  _closing_point_i
-00038f70: 6e64 6578 6573 5b2d 315d 202d 2063 6c6f  ndexes[-1] - clo
-00038f80: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
-00038f90: 2920 2f20 7261 7469 6f5f 6465 6e6f 6d69  ) / ratio_denomi
-00038fa0: 6e61 746f 720a 2020 2020 2020 2020 6966  nator.        if
-00038fb0: 206e 6f74 2043 6c6f 7365 6450 6f6c 7967   not ClosedPolyg
-00038fc0: 6f6e 3344 2e69 735f 7365 7769 6e67 5f66  on3D.is_sewing_f
-00038fd0: 6f72 7761 7264 2863 6c6f 7369 6e67 5f70  orward(closing_p
-00038fe0: 6f69 6e74 5f69 6e64 6578 2c20 6c69 7374  oint_index, list
-00038ff0: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f69  _closing_point_i
-00039000: 6e64 6578 6573 293a 0a20 2020 2020 2020  ndexes):.       
-00039010: 2020 2020 2069 6620 636c 6f73 696e 675f       if closing_
-00039020: 706f 696e 745f 696e 6465 7820 3e20 6c69  point_index > li
-00039030: 7374 5f63 6c6f 7369 6e67 5f70 6f69 6e74  st_closing_point
-00039040: 5f69 6e64 6578 6573 5b2d 315d 202d 2031  _indexes[-1] - 1
-00039050: 3020 616e 645c 0a20 2020 2020 2020 2020  0 and\.         
-00039060: 2020 2020 2020 2020 2020 2063 6c6f 7369             closi
-00039070: 6e67 5f70 6f69 6e74 5f69 6e64 6578 2021  ng_point_index !
-00039080: 3d20 6c69 7374 5f63 6c6f 7369 6e67 5f70  = list_closing_p
-00039090: 6f69 6e74 5f69 6e64 6578 6573 5b2d 315d  oint_indexes[-1]
-000390a0: 202d 2031 3a0a 2020 2020 2020 2020 2020   - 1:.          
-000390b0: 2020 2020 2020 6966 2063 6c6f 7369 6e67        if closing
-000390c0: 5f70 6f69 6e74 5f69 6e64 6578 202d 2031  _point_index - 1
-000390d0: 2069 6e20 6c69 7374 5f63 6c6f 7369 6e67   in list_closing
-000390e0: 5f70 6f69 6e74 5f69 6e64 6578 6573 2061  _point_indexes a
-000390f0: 6e64 5c0a 2020 2020 2020 2020 2020 2020  nd\.            
-00039100: 2020 2020 2020 2020 2020 2020 636c 6f73              clos
-00039110: 696e 675f 706f 696e 745f 696e 6465 7820  ing_point_index 
-00039120: 2b20 3120 696e 206c 6973 745f 636c 6f73  + 1 in list_clos
-00039130: 696e 675f 706f 696e 745f 696e 6465 7865  ing_point_indexe
-00039140: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00039150: 2020 2020 2020 2063 6c6f 7369 6e67 5f70         closing_p
-00039160: 6f69 6e74 5f69 6e64 6578 203d 206c 6973  oint_index = lis
-00039170: 745f 636c 6f73 696e 675f 706f 696e 745f  t_closing_point_
-00039180: 696e 6465 7865 735b 2d31 5d0a 2020 2020  indexes[-1].    
-00039190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000391a0: 7265 7475 726e 2063 6c6f 7369 6e67 5f70  return closing_p
-000391b0: 6f69 6e74 5f69 6e64 6578 2c20 6c69 7374  oint_index, list
-000391c0: 5f72 656d 6f76 655f 636c 6f73 696e 675f  _remove_closing_
-000391d0: 706f 696e 7473 2c20 7061 7373 6564 5f62  points, passed_b
-000391e0: 795f 7a65 726f 5f69 6e64 6578 0a0a 2020  y_zero_index..  
-000391f0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-00039200: 7374 5f72 656d 6f76 655f 636c 6f73 696e  st_remove_closin
-00039210: 675f 706f 696e 7473 203d 2043 6c6f 7365  g_points = Close
-00039220: 6450 6f6c 7967 6f6e 3344 2e73 6577 696e  dPolygon3D.sewin
-00039230: 675f 636c 6f73 696e 675f 706f 696e 7473  g_closing_points
-00039240: 5f74 6f5f 7265 6d6f 7665 280a 2020 2020  _to_remove(.    
-00039250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039260: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
-00039270: 6465 782c 206c 6973 745f 636c 6f73 696e  dex, list_closin
-00039280: 675f 706f 696e 745f 696e 6465 7865 732c  g_point_indexes,
-00039290: 2070 6173 7365 645f 6279 5f7a 6572 6f5f   passed_by_zero_
-000392a0: 696e 6465 7829 0a0a 2020 2020 2020 2020  index)..        
-000392b0: 2020 2020 656c 6966 2063 6c6f 7369 6e67      elif closing
-000392c0: 5f70 6f69 6e74 5f69 6e64 6578 2069 6e20  _point_index in 
-000392d0: 6c69 7374 5f63 6c6f 7369 6e67 5f70 6f69  list_closing_poi
-000392e0: 6e74 5f69 6e64 6578 6573 3a0a 2020 2020  nt_indexes:.    
-000392f0: 2020 2020 2020 2020 2020 2020 636c 6f73              clos
-00039300: 696e 675f 706f 696e 745f 696e 6465 7820  ing_point_index 
-00039310: 3d20 6c69 7374 5f63 6c6f 7369 6e67 5f70  = list_closing_p
-00039320: 6f69 6e74 5f69 6e64 6578 6573 5b2d 315d  oint_indexes[-1]
-00039330: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00039340: 6620 6d61 7468 2e69 7363 6c6f 7365 2872  f math.isclose(r
-00039350: 6174 696f 2c20 302c 2061 6273 5f74 6f6c  atio, 0, abs_tol
-00039360: 3d30 2e33 293a 0a20 2020 2020 2020 2020  =0.3):.         
-00039370: 2020 2020 2020 2063 6c6f 7369 6e67 5f70         closing_p
-00039380: 6f69 6e74 5f69 6e64 6578 203d 206c 6973  oint_index = lis
-00039390: 745f 636c 6f73 696e 675f 706f 696e 745f  t_closing_point_
-000393a0: 696e 6465 7865 735b 2d31 5d0a 2020 2020  indexes[-1].    
-000393b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000393c0: 2020 2020 2020 2020 2020 2020 2020 636c                cl
-000393d0: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
-000393e0: 782c 2070 6173 7365 645f 6279 5f7a 6572  x, passed_by_zer
-000393f0: 6f5f 696e 6465 7820 3d20 436c 6f73 6564  o_index = Closed
-00039400: 506f 6c79 676f 6e33 442e 7365 7769 6e67  Polygon3D.sewing
-00039410: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f70  _closing_point_p
-00039420: 6173 745f 706f 696e 7430 280a 2020 2020  ast_point0(.    
-00039430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039440: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
-00039450: 6465 782c 206c 6973 745f 636c 6f73 696e  dex, list_closin
-00039460: 675f 706f 696e 745f 696e 6465 7865 732c  g_point_indexes,
-00039470: 2070 6173 7365 645f 6279 5f7a 6572 6f5f   passed_by_zero_
-00039480: 696e 6465 782c 2072 6174 696f 5f64 656e  index, ratio_den
-00039490: 6f6d 696e 6174 6f72 290a 0a20 2020 2020  ominator)..     
-000394a0: 2020 2065 6c69 6620 636c 6f73 696e 675f     elif closing_
-000394b0: 706f 696e 745f 696e 6465 7820 696e 206c  point_index in l
-000394c0: 6973 745f 636c 6f73 696e 675f 706f 696e  ist_closing_poin
-000394d0: 745f 696e 6465 7865 733a 0a20 2020 2020  t_indexes:.     
-000394e0: 2020 2020 2020 2063 6c6f 7369 6e67 5f70         closing_p
-000394f0: 6f69 6e74 5f69 6e64 6578 203d 206c 6973  oint_index = lis
-00039500: 745f 636c 6f73 696e 675f 706f 696e 745f  t_closing_point_
-00039510: 696e 6465 7865 735b 2d31 5d0a 2020 2020  indexes[-1].    
-00039520: 2020 2020 656c 6966 206c 656e 286c 6973      elif len(lis
-00039530: 745f 636c 6f73 696e 675f 706f 696e 745f  t_closing_point_
-00039540: 696e 6465 7865 7329 203e 2032 2061 6e64  indexes) > 2 and
-00039550: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
-00039560: 2020 206c 6973 745f 636c 6f73 696e 675f     list_closing_
-00039570: 706f 696e 745f 696e 6465 7865 735b 305d  point_indexes[0]
-00039580: 203c 2063 6c6f 7369 6e67 5f70 6f69 6e74   < closing_point
-00039590: 5f69 6e64 6578 203c 205c 0a20 2020 2020  _index < \.     
-000395a0: 2020 2020 2020 2020 2020 206c 6973 745f             list_
-000395b0: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
-000395c0: 6465 7865 735b 2d31 5d3a 0a20 2020 2020  dexes[-1]:.     
-000395d0: 2020 2020 2020 2063 6c6f 7369 6e67 5f70         closing_p
-000395e0: 6f69 6e74 5f69 6e64 6578 203d 206c 6973  oint_index = lis
-000395f0: 745f 636c 6f73 696e 675f 706f 696e 745f  t_closing_point_
-00039600: 696e 6465 7865 735b 2d31 5d0a 2020 2020  indexes[-1].    
-00039610: 2020 2020 656c 6966 2070 6173 7365 645f      elif passed_
-00039620: 6279 5f7a 6572 6f5f 696e 6465 7820 616e  by_zero_index an
-00039630: 6420 636c 6f73 696e 675f 706f 696e 745f  d closing_point_
-00039640: 696e 6465 7820 3e20 5c0a 2020 2020 2020  index > \.      
-00039650: 2020 2020 2020 2020 2020 6c69 7374 5f63            list_c
-00039660: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
-00039670: 6578 6573 5b30 5d3a 0a20 2020 2020 2020  exes[0]:.       
-00039680: 2020 2020 2063 6c6f 7369 6e67 5f70 6f69       closing_poi
-00039690: 6e74 5f69 6e64 6578 203d 206c 6973 745f  nt_index = list_
-000396a0: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
-000396b0: 6465 7865 735b 2d31 5d0a 2020 2020 2020  dexes[-1].      
-000396c0: 2020 656c 6966 206c 6973 745f 636c 6f73    elif list_clos
-000396d0: 696e 675f 706f 696e 745f 696e 6465 7865  ing_point_indexe
-000396e0: 735b 305d 203d 3d20 3020 616e 6420 6d61  s[0] == 0 and ma
-000396f0: 7468 2e69 7363 6c6f 7365 2872 6174 696f  th.isclose(ratio
-00039700: 2c20 2d31 2c0a 2020 2020 2020 2020 2020  , -1,.          
+00037d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037d90: 2020 2020 2063 6c6f 7369 6e67 5f70 6f69       closing_poi
+00037da0: 6e74 5f69 6e64 6578 5d5d 0a20 2020 2020  nt_index]].     
+00037db0: 2020 2020 2020 2020 2020 2074 7269 616e             trian
+00037dc0: 676c 6573 5f70 6f69 6e74 735b 2d28 6e20  gles_points[-(n 
+00037dd0: 2b20 3129 5d20 3d20 6e65 775f 6661 6365  + 1)] = new_face
+00037de0: 5f70 6f69 6e74 730a 0a20 2020 2020 2020  _points..       
+00037df0: 2072 6574 7572 6e20 7472 6961 6e67 6c65   return triangle
+00037e00: 735f 706f 696e 7473 0a0a 2020 2020 4073  s_points..    @s
+00037e10: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+00037e20: 6465 6620 636c 6561 6e5f 7365 7769 6e67  def clean_sewing
+00037e30: 5f63 6c6f 7369 6e67 5f70 6169 7273 5f64  _closing_pairs_d
+00037e40: 6963 7469 6f6e 6172 7928 6469 6374 5f63  ictionary(dict_c
+00037e50: 6c6f 7369 6e67 5f70 6169 7273 2c0a 2020  losing_pairs,.  
+00037e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037e80: 2020 2020 2020 2020 2020 2020 636c 6f73              clos
+00037e90: 696e 675f 706f 696e 745f 696e 6465 782c  ing_point_index,
+00037ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037ec0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00037ed0: 6173 7365 645f 6279 5f7a 6572 6f5f 696e  assed_by_zero_in
+00037ee0: 6465 7829 3a0a 2020 2020 2020 2020 2222  dex):.        ""
+00037ef0: 220a 2020 2020 2020 2020 436c 6561 6e73  ".        Cleans
+00037f00: 2074 6865 2064 6963 7469 6f6e 6172 7920   the dictionary 
+00037f10: 636f 6e74 6169 6e69 6e67 2074 6865 2073  containing the s
+00037f20: 6577 696e 6720 636c 6f73 696e 6720 7061  ewing closing pa
+00037f30: 6972 7320 696e 666f 726d 6174 696f 6e2e  irs information.
+00037f40: 0a0a 2020 2020 2020 2020 496e 2063 6173  ..        In cas
+00037f50: 6520 6974 206e 6565 6473 2074 6f20 6265  e it needs to be
+00037f60: 2072 6563 616c 6375 6c61 7465 6420 6475   recalculated du
+00037f70: 6520 746f 2063 6861 6e67 696e 6720 636c  e to changing cl
+00037f80: 6f73 696e 6720 706f 696e 7473 2e0a 2020  osing points..  
+00037f90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00037fa0: 2020 6469 6374 5f63 6c6f 7369 6e67 5f70    dict_closing_p
+00037fb0: 6169 7273 5f76 616c 7565 7320 3d20 6c69  airs_values = li
+00037fc0: 7374 2864 6963 745f 636c 6f73 696e 675f  st(dict_closing_
+00037fd0: 7061 6972 732e 7661 6c75 6573 2829 290a  pairs.values()).
+00037fe0: 2020 2020 2020 2020 6469 6374 5f63 6c6f          dict_clo
+00037ff0: 7369 6e67 5f70 6169 7273 5f6b 6579 7320  sing_pairs_keys 
+00038000: 3d20 6c69 7374 2864 6963 745f 636c 6f73  = list(dict_clos
+00038010: 696e 675f 7061 6972 732e 6b65 7973 2829  ing_pairs.keys()
+00038020: 290a 2020 2020 2020 2020 7072 6576 696f  ).        previo
+00038030: 7573 5f63 6c6f 7369 6e67 5f70 6f69 6e74  us_closing_point
+00038040: 5f69 6e64 6578 203d 2064 6963 745f 636c  _index = dict_cl
+00038050: 6f73 696e 675f 7061 6972 735f 7661 6c75  osing_pairs_valu
+00038060: 6573 5b2d 315d 5b31 5d0a 2020 2020 2020  es[-1][1].      
+00038070: 2020 6c61 7374 5f64 6963 745f 7661 6c75    last_dict_valu
+00038080: 6520 3d20 7072 6576 696f 7573 5f63 6c6f  e = previous_clo
+00038090: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
+000380a0: 0a20 2020 2020 2020 2066 6f72 2069 2c20  .        for i, 
+000380b0: 6b65 7920 696e 2065 6e75 6d65 7261 7465  key in enumerate
+000380c0: 2864 6963 745f 636c 6f73 696e 675f 7061  (dict_closing_pa
+000380d0: 6972 735f 6b65 7973 5b3a 3a2d 315d 293a  irs_keys[::-1]):
+000380e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000380f0: 286e 6f74 2070 6173 7365 645f 6279 5f7a  (not passed_by_z
+00038100: 6572 6f5f 696e 6465 7820 616e 640a 2020  ero_index and.  
+00038110: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+00038120: 7374 5f64 6963 745f 7661 6c75 6520 3e20  st_dict_value > 
+00038130: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
+00038140: 6465 7829 206f 7220 5c0a 2020 2020 2020  dex) or \.      
+00038150: 2020 2020 2020 2020 2020 2020 2020 2870                (p
+00038160: 6173 7365 645f 6279 5f7a 6572 6f5f 696e  assed_by_zero_in
+00038170: 6465 7820 616e 640a 2020 2020 2020 2020  dex and.        
+00038180: 2020 2020 2020 2020 2020 2020 2030 203c               0 <
+00038190: 3d20 6c61 7374 5f64 6963 745f 7661 6c75  = last_dict_valu
+000381a0: 6520 3c3d 2070 7265 7669 6f75 735f 636c  e <= previous_cl
+000381b0: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
+000381c0: 7820 616e 640a 2020 2020 2020 2020 2020  x and.          
+000381d0: 2020 2020 2020 2020 2020 206c 6173 745f             last_
+000381e0: 6469 6374 5f76 616c 7565 203e 2063 6c6f  dict_value > clo
+000381f0: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
+00038200: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00038210: 2020 206c 6f77 6572 5f62 6f75 6e64 6461     lower_boundda
+00038220: 7279 5f63 6c6f 7369 6e67 5f70 6f69 6e74  ry_closing_point
+00038230: 203d 206b 6579 0a20 2020 2020 2020 2020   = key.         
+00038240: 2020 2020 2020 2064 656c 2064 6963 745f         del dict_
+00038250: 636c 6f73 696e 675f 7061 6972 735b 6b65  closing_pairs[ke
+00038260: 795d 0a20 2020 2020 2020 2020 2020 2020  y].             
+00038270: 2020 2069 6620 6e6f 7420 6469 6374 5f63     if not dict_c
+00038280: 6c6f 7369 6e67 5f70 6169 7273 3a0a 2020  losing_pairs:.  
+00038290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000382a0: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+000382b0: 2020 2020 2020 2020 6c61 7374 5f64 6963          last_dic
+000382c0: 745f 7661 6c75 6520 3d20 6469 6374 5f63  t_value = dict_c
+000382d0: 6c6f 7369 6e67 5f70 6169 7273 5f76 616c  losing_pairs_val
+000382e0: 7565 735b 2d69 202d 2032 5d5b 315d 0a0a  ues[-i - 2][1]..
+000382f0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+00038300: 6963 745f 636c 6f73 696e 675f 7061 6972  ict_closing_pair
+00038310: 732c 206c 6f77 6572 5f62 6f75 6e64 6461  s, lower_boundda
+00038320: 7279 5f63 6c6f 7369 6e67 5f70 6f69 6e74  ry_closing_point
+00038330: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+00038340: 686f 640a 2020 2020 6465 6620 6973 5f73  hod.    def is_s
+00038350: 6577 696e 675f 666f 7277 6172 6428 636c  ewing_forward(cl
+00038360: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
+00038370: 782c 206c 6973 745f 636c 6f73 696e 675f  x, list_closing_
+00038380: 706f 696e 745f 696e 6465 7865 7329 202d  point_indexes) -
+00038390: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
+000383a0: 6966 2063 6c6f 7369 6e67 5f70 6f69 6e74  if closing_point
+000383b0: 5f69 6e64 6578 203c 206c 6973 745f 636c  _index < list_cl
+000383c0: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
+000383d0: 7865 735b 2d31 5d3a 0a20 2020 2020 2020  xes[-1]:.       
+000383e0: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
+000383f0: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
+00038400: 2054 7275 650a 0a20 2020 2040 7374 6174   True..    @stat
+00038410: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
+00038420: 2073 6577 696e 675f 636c 6f73 696e 675f   sewing_closing_
+00038430: 706f 696e 7473 5f74 6f5f 7265 6d6f 7665  points_to_remove
+00038440: 2863 6c6f 7369 6e67 5f70 6f69 6e74 5f69  (closing_point_i
+00038450: 6e64 6578 2c20 6c69 7374 5f63 6c6f 7369  ndex, list_closi
+00038460: 6e67 5f70 6f69 6e74 5f69 6e64 6578 6573  ng_point_indexes
+00038470: 2c20 7061 7373 6564 5f62 795f 7a65 726f  , passed_by_zero
+00038480: 5f69 6e64 6578 293a 0a20 2020 2020 2020  _index):.       
+00038490: 206c 6973 745f 7265 6d6f 7665 5f63 6c6f   list_remove_clo
+000384a0: 7369 6e67 5f70 6f69 6e74 7320 3d20 5b5d  sing_points = []
+000384b0: 0a20 2020 2020 2020 2066 6f72 2069 6478  .        for idx
+000384c0: 2069 6e20 6c69 7374 5f63 6c6f 7369 6e67   in list_closing
+000384d0: 5f70 6f69 6e74 5f69 6e64 6578 6573 5b3a  _point_indexes[:
+000384e0: 3a2d 315d 3a0a 2020 2020 2020 2020 2020  :-1]:.          
+000384f0: 2020 6966 206e 6f74 2070 6173 7365 645f    if not passed_
+00038500: 6279 5f7a 6572 6f5f 696e 6465 783a 0a20  by_zero_index:. 
+00038510: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00038520: 6620 6964 7820 3e20 636c 6f73 696e 675f  f idx > closing_
+00038530: 706f 696e 745f 696e 6465 783a 0a20 2020  point_index:.   
+00038540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038550: 206c 6973 745f 7265 6d6f 7665 5f63 6c6f   list_remove_clo
+00038560: 7369 6e67 5f70 6f69 6e74 732e 6170 7065  sing_points.appe
+00038570: 6e64 2869 6478 290a 2020 2020 2020 2020  nd(idx).        
+00038580: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00038590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000385a0: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+000385b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000385c0: 2020 2020 2020 2020 2020 6966 2030 203c            if 0 <
+000385d0: 2069 6478 203c 3d20 6c69 7374 5f63 6c6f   idx <= list_clo
+000385e0: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
+000385f0: 6573 5b2d 315d 2061 6e64 205c 0a20 2020  es[-1] and \.   
+00038600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038610: 2020 2020 2069 6478 203e 2063 6c6f 7369       idx > closi
+00038620: 6e67 5f70 6f69 6e74 5f69 6e64 6578 3a0a  ng_point_index:.
+00038630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038640: 2020 2020 6c69 7374 5f72 656d 6f76 655f      list_remove_
+00038650: 636c 6f73 696e 675f 706f 696e 7473 2e61  closing_points.a
+00038660: 7070 656e 6428 6964 7829 0a20 2020 2020  ppend(idx).     
+00038670: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00038680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038690: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
+000386a0: 2020 2072 6574 7572 6e20 6c69 7374 5f72     return list_r
+000386b0: 656d 6f76 655f 636c 6f73 696e 675f 706f  emove_closing_po
+000386c0: 696e 7473 0a0a 2020 2020 4073 7461 7469  ints..    @stati
+000386d0: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
+000386e0: 7365 7769 6e67 5f63 6c6f 7369 6e67 5f70  sewing_closing_p
+000386f0: 6f69 6e74 5f70 6173 745f 706f 696e 7430  oint_past_point0
+00038700: 2863 6c6f 7369 6e67 5f70 6f69 6e74 5f69  (closing_point_i
+00038710: 6e64 6578 2c20 6c69 7374 5f63 6c6f 7369  ndex, list_closi
+00038720: 6e67 5f70 6f69 6e74 5f69 6e64 6578 6573  ng_point_indexes
+00038730: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00038740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038750: 2020 2020 2020 2020 2020 2070 6173 7365             passe
+00038760: 645f 6279 5f7a 6572 6f5f 696e 6465 782c  d_by_zero_index,
+00038770: 2072 6174 696f 5f64 656e 6f6d 696e 6174   ratio_denominat
+00038780: 6f72 293a 0a20 2020 2020 2020 206c 6173  or):.        las
+00038790: 745f 746f 5f6e 6577 5f70 6f69 6e74 5f69  t_to_new_point_i
+000387a0: 6e64 6578 5f72 6174 696f 203d 2028 6c69  ndex_ratio = (li
+000387b0: 7374 5f63 6c6f 7369 6e67 5f70 6f69 6e74  st_closing_point
+000387c0: 5f69 6e64 6578 6573 5b2d 315d 202d 0a20  _indexes[-1] -. 
+000387d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000387e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000387f0: 2020 2020 2020 2020 636c 6f73 696e 675f          closing_
+00038800: 706f 696e 745f 696e 6465 7829 202f 2072  point_index) / r
+00038810: 6174 696f 5f64 656e 6f6d 696e 6174 6f72  atio_denominator
+00038820: 0a20 2020 2020 2020 2069 6620 7061 7373  .        if pass
+00038830: 6564 5f62 795f 7a65 726f 5f69 6e64 6578  ed_by_zero_index
+00038840: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00038850: 7469 6f20 3d20 286c 6973 745f 636c 6f73  tio = (list_clos
+00038860: 696e 675f 706f 696e 745f 696e 6465 7865  ing_point_indexe
+00038870: 735b 305d 202d 2063 6c6f 7369 6e67 5f70  s[0] - closing_p
+00038880: 6f69 6e74 5f69 6e64 6578 2920 2f20 7261  oint_index) / ra
+00038890: 7469 6f5f 6465 6e6f 6d69 6e61 746f 720a  tio_denominator.
+000388a0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+000388b0: 6174 682e 6973 636c 6f73 6528 7261 7469  ath.isclose(rati
+000388c0: 6f2c 2031 2c20 6162 735f 746f 6c3d 302e  o, 1, abs_tol=0.
+000388d0: 3329 3a0a 2020 2020 2020 2020 2020 2020  3):.            
+000388e0: 2020 2020 636c 6f73 696e 675f 706f 696e      closing_poin
+000388f0: 745f 696e 6465 7820 3d20 6c69 7374 5f63  t_index = list_c
+00038900: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
+00038910: 6578 6573 5b30 5d0a 2020 2020 2020 2020  exes[0].        
+00038920: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00038930: 2020 2020 2020 2020 2020 636c 6f73 696e            closin
+00038940: 675f 706f 696e 745f 696e 6465 7820 3d20  g_point_index = 
+00038950: 6c69 7374 5f63 6c6f 7369 6e67 5f70 6f69  list_closing_poi
+00038960: 6e74 5f69 6e64 6578 6573 5b2d 315d 0a20  nt_indexes[-1]. 
+00038970: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00038980: 2020 2020 2020 2020 2069 6620 636c 6f73           if clos
+00038990: 696e 675f 706f 696e 745f 696e 6465 7820  ing_point_index 
+000389a0: 3e20 6c69 7374 5f63 6c6f 7369 6e67 5f70  > list_closing_p
+000389b0: 6f69 6e74 5f69 6e64 6578 6573 5b30 5d3a  oint_indexes[0]:
+000389c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000389d0: 2072 6174 696f 3120 3d20 2863 6c6f 7369   ratio1 = (closi
+000389e0: 6e67 5f70 6f69 6e74 5f69 6e64 6578 202d  ng_point_index -
+000389f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038a00: 2020 2020 2020 2020 2020 206c 6973 745f             list_
+00038a10: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
+00038a20: 6465 7865 735b 305d 2920 2f20 7261 7469  dexes[0]) / rati
+00038a30: 6f5f 6465 6e6f 6d69 6e61 746f 720a 2020  o_denominator.  
+00038a40: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00038a50: 206d 6174 682e 6973 636c 6f73 6528 7261   math.isclose(ra
+00038a60: 7469 6f31 2c20 302c 2061 6273 5f74 6f6c  tio1, 0, abs_tol
+00038a70: 3d30 2e33 2920 616e 6420 5c0a 2020 2020  =0.3) and \.    
+00038a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038a90: 2020 2020 6d61 7468 2e69 7363 6c6f 7365      math.isclose
+00038aa0: 286c 6173 745f 746f 5f6e 6577 5f70 6f69  (last_to_new_poi
+00038ab0: 6e74 5f69 6e64 6578 5f72 6174 696f 2c20  nt_index_ratio, 
+00038ac0: 312c 2061 6273 5f74 6f6c 3d30 2e33 293a  1, abs_tol=0.3):
+00038ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038ae0: 2020 2020 2070 6173 7365 645f 6279 5f7a       passed_by_z
+00038af0: 6572 6f5f 696e 6465 7820 3d20 5472 7565  ero_index = True
+00038b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038b10: 2020 2020 2063 6c6f 7369 6e67 5f70 6f69       closing_poi
+00038b20: 6e74 5f69 6e64 6578 203d 206c 6973 745f  nt_index = list_
+00038b30: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
+00038b40: 6465 7865 735b 305d 0a20 2020 2020 2020  dexes[0].       
+00038b50: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00038b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038b70: 2020 2063 6c6f 7369 6e67 5f70 6f69 6e74     closing_point
+00038b80: 5f69 6e64 6578 203d 206c 6973 745f 636c  _index = list_cl
+00038b90: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
+00038ba0: 7865 735b 2d31 5d0a 2020 2020 2020 2020  xes[-1].        
+00038bb0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00038bc0: 2020 2020 2020 2020 2020 6966 2063 6c6f            if clo
+00038bd0: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
+00038be0: 203c 2072 6174 696f 5f64 656e 6f6d 696e   < ratio_denomin
+00038bf0: 6174 6f72 202f 2034 3a0a 2020 2020 2020  ator / 4:.      
+00038c00: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00038c10: 7373 6564 5f62 795f 7a65 726f 5f69 6e64  ssed_by_zero_ind
+00038c20: 6578 203d 2054 7275 650a 2020 2020 2020  ex = True.      
+00038c30: 2020 2020 2020 2020 2020 656c 6966 2072            elif r
+00038c40: 6174 696f 5f64 656e 6f6d 696e 6174 6f72  atio_denominator
+00038c50: 202d 206c 6973 745f 636c 6f73 696e 675f   - list_closing_
+00038c60: 706f 696e 745f 696e 6465 7865 735b 2d31  point_indexes[-1
+00038c70: 5d20 3e3d 2036 3a0a 2020 2020 2020 2020  ] >= 6:.        
+00038c80: 2020 2020 2020 2020 2020 2020 636c 6f73              clos
+00038c90: 696e 675f 706f 696e 745f 696e 6465 7820  ing_point_index 
+00038ca0: 3d20 6c69 7374 5f63 6c6f 7369 6e67 5f70  = list_closing_p
+00038cb0: 6f69 6e74 5f69 6e64 6578 6573 5b2d 315d  oint_indexes[-1]
+00038cc0: 202b 2035 0a20 2020 2020 2020 2020 2020   + 5.           
+00038cd0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00038ce0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00038cf0: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
+00038d00: 6578 203d 206c 6973 745f 636c 6f73 696e  ex = list_closin
+00038d10: 675f 706f 696e 745f 696e 6465 7865 735b  g_point_indexes[
+00038d20: 2d31 5d0a 2020 2020 2020 2020 7265 7475  -1].        retu
+00038d30: 726e 2063 6c6f 7369 6e67 5f70 6f69 6e74  rn closing_point
+00038d40: 5f69 6e64 6578 2c20 7061 7373 6564 5f62  _index, passed_b
+00038d50: 795f 7a65 726f 5f69 6e64 6578 0a0a 2020  y_zero_index..  
+00038d60: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
+00038d70: 2020 2020 6465 6620 7661 6c69 6461 7465      def validate
+00038d80: 5f63 6f6e 6361 7665 5f63 6c6f 7369 6e67  _concave_closing
+00038d90: 5f70 6f69 6e74 2863 6c6f 7369 6e67 5f70  _point(closing_p
+00038da0: 6f69 6e74 5f69 6e64 6578 2c0a 2020 2020  oint_index,.    
+00038db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038dd0: 2020 206c 6973 745f 636c 6f73 696e 675f     list_closing_
+00038de0: 706f 696e 745f 696e 6465 7865 732c 0a20  point_indexes,. 
+00038df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038e10: 2020 2020 2020 7061 7373 6564 5f62 795f        passed_by_
+00038e20: 7a65 726f 5f69 6e64 6578 2c0a 2020 2020  zero_index,.    
+00038e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038e50: 2020 2072 6174 696f 5f64 656e 6f6d 696e     ratio_denomin
+00038e60: 6174 6f72 2c20 706f 6c79 676f 6e73 5f70  ator, polygons_p
+00038e70: 6f69 6e74 735f 7261 7469 6f29 3a0a 2020  oints_ratio):.  
+00038e80: 2020 2020 2020 6966 2063 6c6f 7369 6e67        if closing
+00038e90: 5f70 6f69 6e74 5f69 6e64 6578 203d 3d20  _point_index == 
+00038ea0: 6c69 7374 5f63 6c6f 7369 6e67 5f70 6f69  list_closing_poi
+00038eb0: 6e74 5f69 6e64 6578 6573 5b2d 315d 3a0a  nt_indexes[-1]:.
+00038ec0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00038ed0: 726e 2063 6c6f 7369 6e67 5f70 6f69 6e74  rn closing_point
+00038ee0: 5f69 6e64 6578 2c20 5b5d 2c20 7061 7373  _index, [], pass
+00038ef0: 6564 5f62 795f 7a65 726f 5f69 6e64 6578  ed_by_zero_index
+00038f00: 0a0a 2020 2020 2020 2020 6c69 7374 5f72  ..        list_r
+00038f10: 656d 6f76 655f 636c 6f73 696e 675f 706f  emove_closing_po
+00038f20: 696e 7473 203d 205b 5d0a 2020 2020 2020  ints = [].      
+00038f30: 2020 7261 7469 6f20 3d20 286c 6973 745f    ratio = (list_
+00038f40: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
+00038f50: 6465 7865 735b 2d31 5d20 2d20 636c 6f73  dexes[-1] - clos
+00038f60: 696e 675f 706f 696e 745f 696e 6465 7829  ing_point_index)
+00038f70: 202f 2072 6174 696f 5f64 656e 6f6d 696e   / ratio_denomin
+00038f80: 6174 6f72 0a20 2020 2020 2020 2069 6620  ator.        if 
+00038f90: 6e6f 7420 436c 6f73 6564 506f 6c79 676f  not ClosedPolygo
+00038fa0: 6e33 442e 6973 5f73 6577 696e 675f 666f  n3D.is_sewing_fo
+00038fb0: 7277 6172 6428 636c 6f73 696e 675f 706f  rward(closing_po
+00038fc0: 696e 745f 696e 6465 782c 206c 6973 745f  int_index, list_
+00038fd0: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
+00038fe0: 6465 7865 7329 3a0a 2020 2020 2020 2020  dexes):.        
+00038ff0: 2020 2020 6966 2063 6c6f 7369 6e67 5f70      if closing_p
+00039000: 6f69 6e74 5f69 6e64 6578 203e 206c 6973  oint_index > lis
+00039010: 745f 636c 6f73 696e 675f 706f 696e 745f  t_closing_point_
+00039020: 696e 6465 7865 735b 2d31 5d20 2d20 3130  indexes[-1] - 10
+00039030: 2061 6e64 5c0a 2020 2020 2020 2020 2020   and\.          
+00039040: 2020 2020 2020 2020 2020 636c 6f73 696e            closin
+00039050: 675f 706f 696e 745f 696e 6465 7820 213d  g_point_index !=
+00039060: 206c 6973 745f 636c 6f73 696e 675f 706f   list_closing_po
+00039070: 696e 745f 696e 6465 7865 735b 2d31 5d20  int_indexes[-1] 
+00039080: 2d20 313a 0a20 2020 2020 2020 2020 2020  - 1:.           
+00039090: 2020 2020 2069 6620 636c 6f73 696e 675f       if closing_
+000390a0: 706f 696e 745f 696e 6465 7820 2d20 3120  point_index - 1 
+000390b0: 696e 206c 6973 745f 636c 6f73 696e 675f  in list_closing_
+000390c0: 706f 696e 745f 696e 6465 7865 7320 616e  point_indexes an
+000390d0: 645c 0a20 2020 2020 2020 2020 2020 2020  d\.             
+000390e0: 2020 2020 2020 2020 2020 2063 6c6f 7369             closi
+000390f0: 6e67 5f70 6f69 6e74 5f69 6e64 6578 202b  ng_point_index +
+00039100: 2031 2069 6e20 6c69 7374 5f63 6c6f 7369   1 in list_closi
+00039110: 6e67 5f70 6f69 6e74 5f69 6e64 6578 6573  ng_point_indexes
+00039120: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00039130: 2020 2020 2020 636c 6f73 696e 675f 706f        closing_po
+00039140: 696e 745f 696e 6465 7820 3d20 6c69 7374  int_index = list
+00039150: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f69  _closing_point_i
+00039160: 6e64 6578 6573 5b2d 315d 0a20 2020 2020  ndexes[-1].     
+00039170: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00039180: 6574 7572 6e20 636c 6f73 696e 675f 706f  eturn closing_po
+00039190: 696e 745f 696e 6465 782c 206c 6973 745f  int_index, list_
+000391a0: 7265 6d6f 7665 5f63 6c6f 7369 6e67 5f70  remove_closing_p
+000391b0: 6f69 6e74 732c 2070 6173 7365 645f 6279  oints, passed_by
+000391c0: 5f7a 6572 6f5f 696e 6465 780a 0a20 2020  _zero_index..   
+000391d0: 2020 2020 2020 2020 2020 2020 206c 6973               lis
+000391e0: 745f 7265 6d6f 7665 5f63 6c6f 7369 6e67  t_remove_closing
+000391f0: 5f70 6f69 6e74 7320 3d20 436c 6f73 6564  _points = Closed
+00039200: 506f 6c79 676f 6e33 442e 7365 7769 6e67  Polygon3D.sewing
+00039210: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 735f  _closing_points_
+00039220: 746f 5f72 656d 6f76 6528 0a20 2020 2020  to_remove(.     
+00039230: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00039240: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
+00039250: 6578 2c20 6c69 7374 5f63 6c6f 7369 6e67  ex, list_closing
+00039260: 5f70 6f69 6e74 5f69 6e64 6578 6573 2c20  _point_indexes, 
+00039270: 7061 7373 6564 5f62 795f 7a65 726f 5f69  passed_by_zero_i
+00039280: 6e64 6578 290a 0a20 2020 2020 2020 2020  ndex)..         
+00039290: 2020 2065 6c69 6620 636c 6f73 696e 675f     elif closing_
+000392a0: 706f 696e 745f 696e 6465 7820 696e 206c  point_index in l
+000392b0: 6973 745f 636c 6f73 696e 675f 706f 696e  ist_closing_poin
+000392c0: 745f 696e 6465 7865 733a 0a20 2020 2020  t_indexes:.     
+000392d0: 2020 2020 2020 2020 2020 2063 6c6f 7369             closi
+000392e0: 6e67 5f70 6f69 6e74 5f69 6e64 6578 203d  ng_point_index =
+000392f0: 206c 6973 745f 636c 6f73 696e 675f 706f   list_closing_po
+00039300: 696e 745f 696e 6465 7865 735b 2d31 5d0a  int_indexes[-1].
+00039310: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00039320: 206d 6174 682e 6973 636c 6f73 6528 7261   math.isclose(ra
+00039330: 7469 6f2c 2030 2c20 6162 735f 746f 6c3d  tio, 0, abs_tol=
+00039340: 302e 3329 3a0a 2020 2020 2020 2020 2020  0.3):.          
+00039350: 2020 2020 2020 636c 6f73 696e 675f 706f        closing_po
+00039360: 696e 745f 696e 6465 7820 3d20 6c69 7374  int_index = list
+00039370: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f69  _closing_point_i
+00039380: 6e64 6578 6573 5b2d 315d 0a20 2020 2020  ndexes[-1].     
+00039390: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000393a0: 2020 2020 2020 2020 2020 2020 2063 6c6f               clo
+000393b0: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
+000393c0: 2c20 7061 7373 6564 5f62 795f 7a65 726f  , passed_by_zero
+000393d0: 5f69 6e64 6578 203d 2043 6c6f 7365 6450  _index = ClosedP
+000393e0: 6f6c 7967 6f6e 3344 2e73 6577 696e 675f  olygon3D.sewing_
+000393f0: 636c 6f73 696e 675f 706f 696e 745f 7061  closing_point_pa
+00039400: 7374 5f70 6f69 6e74 3028 0a20 2020 2020  st_point0(.     
+00039410: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00039420: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
+00039430: 6578 2c20 6c69 7374 5f63 6c6f 7369 6e67  ex, list_closing
+00039440: 5f70 6f69 6e74 5f69 6e64 6578 6573 2c20  _point_indexes, 
+00039450: 7061 7373 6564 5f62 795f 7a65 726f 5f69  passed_by_zero_i
+00039460: 6e64 6578 2c20 7261 7469 6f5f 6465 6e6f  ndex, ratio_deno
+00039470: 6d69 6e61 746f 7229 0a0a 2020 2020 2020  minator)..      
+00039480: 2020 656c 6966 2063 6c6f 7369 6e67 5f70    elif closing_p
+00039490: 6f69 6e74 5f69 6e64 6578 2069 6e20 6c69  oint_index in li
+000394a0: 7374 5f63 6c6f 7369 6e67 5f70 6f69 6e74  st_closing_point
+000394b0: 5f69 6e64 6578 6573 3a0a 2020 2020 2020  _indexes:.      
+000394c0: 2020 2020 2020 636c 6f73 696e 675f 706f        closing_po
+000394d0: 696e 745f 696e 6465 7820 3d20 6c69 7374  int_index = list
+000394e0: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f69  _closing_point_i
+000394f0: 6e64 6578 6573 5b2d 315d 0a20 2020 2020  ndexes[-1].     
+00039500: 2020 2065 6c69 6620 6c65 6e28 6c69 7374     elif len(list
+00039510: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f69  _closing_point_i
+00039520: 6e64 6578 6573 2920 3e20 3220 616e 6420  ndexes) > 2 and 
+00039530: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+00039540: 2020 6c69 7374 5f63 6c6f 7369 6e67 5f70    list_closing_p
+00039550: 6f69 6e74 5f69 6e64 6578 6573 5b30 5d20  oint_indexes[0] 
+00039560: 3c20 636c 6f73 696e 675f 706f 696e 745f  < closing_point_
+00039570: 696e 6465 7820 3c20 5c0a 2020 2020 2020  index < \.      
+00039580: 2020 2020 2020 2020 2020 6c69 7374 5f63            list_c
+00039590: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
+000395a0: 6578 6573 5b2d 315d 3a0a 2020 2020 2020  exes[-1]:.      
+000395b0: 2020 2020 2020 636c 6f73 696e 675f 706f        closing_po
+000395c0: 696e 745f 696e 6465 7820 3d20 6c69 7374  int_index = list
+000395d0: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f69  _closing_point_i
+000395e0: 6e64 6578 6573 5b2d 315d 0a20 2020 2020  ndexes[-1].     
+000395f0: 2020 2065 6c69 6620 7061 7373 6564 5f62     elif passed_b
+00039600: 795f 7a65 726f 5f69 6e64 6578 2061 6e64  y_zero_index and
+00039610: 2063 6c6f 7369 6e67 5f70 6f69 6e74 5f69   closing_point_i
+00039620: 6e64 6578 203e 205c 0a20 2020 2020 2020  ndex > \.       
+00039630: 2020 2020 2020 2020 206c 6973 745f 636c           list_cl
+00039640: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
+00039650: 7865 735b 305d 3a0a 2020 2020 2020 2020  xes[0]:.        
+00039660: 2020 2020 636c 6f73 696e 675f 706f 696e      closing_poin
+00039670: 745f 696e 6465 7820 3d20 6c69 7374 5f63  t_index = list_c
+00039680: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
+00039690: 6578 6573 5b2d 315d 0a20 2020 2020 2020  exes[-1].       
+000396a0: 2065 6c69 6620 6c69 7374 5f63 6c6f 7369   elif list_closi
+000396b0: 6e67 5f70 6f69 6e74 5f69 6e64 6578 6573  ng_point_indexes
+000396c0: 5b30 5d20 3d3d 2030 2061 6e64 206d 6174  [0] == 0 and mat
+000396d0: 682e 6973 636c 6f73 6528 7261 7469 6f2c  h.isclose(ratio,
+000396e0: 202d 312c 0a20 2020 2020 2020 2020 2020   -1,.           
+000396f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039700: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00039710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039740: 2020 2020 2020 2061 6273 5f74 6f6c 3d30         abs_tol=0
-00039750: 2e33 293a 0a20 2020 2020 2020 2020 2020  .3):.           
-00039760: 2063 6c6f 7369 6e67 5f70 6f69 6e74 5f69   closing_point_i
-00039770: 6e64 6578 203d 206c 6973 745f 636c 6f73  ndex = list_clos
-00039780: 696e 675f 706f 696e 745f 696e 6465 7865  ing_point_indexe
-00039790: 735b 2d31 5d0a 2020 2020 2020 2020 656c  s[-1].        el
-000397a0: 6966 206d 6174 682e 6973 636c 6f73 6528  if math.isclose(
-000397b0: 7261 7469 6f2c 202d 312c 2061 6273 5f74  ratio, -1, abs_t
-000397c0: 6f6c 3d30 2e33 293a 0a20 2020 2020 2020  ol=0.3):.       
-000397d0: 2020 2020 2063 6c6f 7369 6e67 5f70 6f69       closing_poi
-000397e0: 6e74 5f69 6e64 6578 203d 206c 6973 745f  nt_index = list_
-000397f0: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
-00039800: 6465 7865 735b 2d31 5d0a 2020 2020 2020  dexes[-1].      
-00039810: 2020 656c 6966 2063 6c6f 7369 6e67 5f70    elif closing_p
-00039820: 6f69 6e74 5f69 6e64 6578 202d 206c 6973  oint_index - lis
-00039830: 745f 636c 6f73 696e 675f 706f 696e 745f  t_closing_point_
-00039840: 696e 6465 7865 735b 2d31 5d20 3e20 3520  indexes[-1] > 5 
-00039850: 616e 6420 5c0a 2020 2020 2020 2020 2020  and \.          
-00039860: 2020 6c69 7374 5f63 6c6f 7369 6e67 5f70    list_closing_p
-00039870: 6f69 6e74 5f69 6e64 6578 6573 5b2d 315d  oint_indexes[-1]
-00039880: 202b 2034 203c 3d20 7261 7469 6f5f 6465   + 4 <= ratio_de
-00039890: 6e6f 6d69 6e61 746f 7220 2d20 3120 616e  nominator - 1 an
-000398a0: 645c 0a20 2020 2020 2020 2020 2020 2020  d\.             
-000398b0: 2020 2070 6f6c 7967 6f6e 735f 706f 696e     polygons_poin
-000398c0: 7473 5f72 6174 696f 203e 2030 2e39 353a  ts_ratio > 0.95:
-000398d0: 0a20 2020 2020 2020 2020 2020 2063 6c6f  .            clo
-000398e0: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
-000398f0: 203d 206c 6973 745f 636c 6f73 696e 675f   = list_closing_
-00039900: 706f 696e 745f 696e 6465 7865 735b 2d31  point_indexes[-1
-00039910: 5d20 2b20 340a 0a20 2020 2020 2020 2072  ] + 4..        r
-00039920: 6574 7572 6e20 636c 6f73 696e 675f 706f  eturn closing_po
-00039930: 696e 745f 696e 6465 782c 206c 6973 745f  int_index, list_
-00039940: 7265 6d6f 7665 5f63 6c6f 7369 6e67 5f70  remove_closing_p
-00039950: 6f69 6e74 732c 2070 6173 7365 645f 6279  oints, passed_by
-00039960: 5f7a 6572 6f5f 696e 6465 780a 0a20 2020  _zero_index..   
-00039970: 2064 6566 2063 6f6e 6361 7665 5f73 6577   def concave_sew
-00039980: 696e 6728 7365 6c66 2c20 706f 6c79 676f  ing(self, polygo
-00039990: 6e32 2c20 782c 2079 293a 0a20 2020 2020  n2, x, y):.     
-000399a0: 2020 2070 6f6c 7967 6f6e 315f 3264 203d     polygon1_2d =
-000399b0: 2073 656c 662e 746f 5f32 6428 766f 6c6d   self.to_2d(volm
-000399c0: 646c 722e 4f32 442c 2078 2c20 7929 0a20  dlr.O2D, x, y). 
-000399d0: 2020 2020 2020 2070 6f6c 7967 6f6e 325f         polygon2_
-000399e0: 3264 203d 2070 6f6c 7967 6f6e 322e 746f  2d = polygon2.to
-000399f0: 5f32 6428 766f 6c6d 646c 722e 4f32 442c  _2d(volmdlr.O2D,
-00039a00: 2078 2c20 7929 0a20 2020 2020 2020 2070   x, y).        p
-00039a10: 6f6c 7967 6f6e 315f 3364 203d 2073 656c  olygon1_3d = sel
-00039a20: 660a 2020 2020 2020 2020 706f 6c79 676f  f.        polygo
-00039a30: 6e32 5f33 6420 3d20 706f 6c79 676f 6e32  n2_3d = polygon2
-00039a40: 0a20 2020 2020 2020 2069 6620 706f 6c79  .        if poly
-00039a50: 676f 6e32 5f32 642e 6172 6561 2829 203c  gon2_2d.area() <
-00039a60: 2070 6f6c 7967 6f6e 315f 3264 2e61 7265   polygon1_2d.are
-00039a70: 6128 293a 0a20 2020 2020 2020 2020 2020  a():.           
-00039a80: 2070 6f6c 7967 6f6e 315f 3264 2c20 706f   polygon1_2d, po
-00039a90: 6c79 676f 6e32 5f32 6420 3d20 706f 6c79  lygon2_2d = poly
-00039aa0: 676f 6e32 5f32 642c 2070 6f6c 7967 6f6e  gon2_2d, polygon
-00039ab0: 315f 3264 0a20 2020 2020 2020 2020 2020  1_2d.           
-00039ac0: 2070 6f6c 7967 6f6e 315f 3364 203d 2070   polygon1_3d = p
-00039ad0: 6f6c 7967 6f6e 320a 2020 2020 2020 2020  olygon2.        
-00039ae0: 2020 2020 706f 6c79 676f 6e32 5f33 6420      polygon2_3d 
-00039af0: 3d20 7365 6c66 0a20 2020 2020 2020 2070  = self.        p
-00039b00: 6f6c 7967 6f6e 315f 3364 203d 2070 6f6c  olygon1_3d = pol
-00039b10: 7967 6f6e 315f 3364 2e67 6574 5f76 616c  ygon1_3d.get_val
-00039b20: 6964 5f63 6f6e 6361 7665 5f73 6577 696e  id_concave_sewin
-00039b30: 675f 706f 6c79 676f 6e28 0a20 2020 2020  g_polygon(.     
-00039b40: 2020 2020 2020 2070 6f6c 7967 6f6e 315f         polygon1_
-00039b50: 3264 2c20 706f 6c79 676f 6e32 5f32 6429  2d, polygon2_2d)
-00039b60: 0a20 2020 2020 2020 2070 6f6c 7967 6f6e  .        polygon
-00039b70: 315f 3264 203d 2070 6f6c 7967 6f6e 315f  1_2d = polygon1_
-00039b80: 3364 2e74 6f5f 3264 2876 6f6c 6d64 6c72  3d.to_2d(volmdlr
-00039b90: 2e4f 3244 2c20 782c 2079 290a 0a20 2020  .O2D, x, y)..   
-00039ba0: 2020 2020 2023 2061 783d 706f 6c79 676f       # ax=polygo
-00039bb0: 6e31 5f32 642e 706c 6f74 2829 0a20 2020  n1_2d.plot().   
-00039bc0: 2020 2020 2023 2070 6f6c 7967 6f6e 325f       # polygon2_
-00039bd0: 3264 2e70 6c6f 7428 6178 3d61 782c 2063  2d.plot(ax=ax, c
-00039be0: 6f6c 6f72 3d27 7227 290a 0a20 2020 2020  olor='r')..     
-00039bf0: 2020 2064 6963 745f 636c 6f73 696e 675f     dict_closing_
-00039c00: 7061 6972 7320 3d20 7b7d 0a20 2020 2020  pairs = {}.     
-00039c10: 2020 2074 7269 616e 676c 6573 5f70 6f69     triangles_poi
-00039c20: 6e74 7320 3d20 5b5d 0a20 2020 2020 2020  nts = [].       
-00039c30: 206c 6973 745f 636c 6f73 696e 675f 706f   list_closing_po
-00039c40: 696e 745f 696e 6465 7865 7320 3d20 5b5d  int_indexes = []
-00039c50: 0a20 2020 2020 2020 2070 6173 7365 645f  .        passed_
-00039c60: 6279 5f7a 6572 6f5f 696e 6465 7820 3d20  by_zero_index = 
-00039c70: 4661 6c73 650a 2020 2020 2020 2020 7261  False.        ra
-00039c80: 7469 6f5f 6465 6e6f 6d20 3d20 6c65 6e28  tio_denom = len(
-00039c90: 706f 6c79 676f 6e32 5f32 642e 706f 696e  polygon2_2d.poin
-00039ca0: 7473 290a 2020 2020 2020 2020 706f 6c79  ts).        poly
-00039cb0: 676f 6e73 5f70 6f69 6e74 735f 7261 7469  gons_points_rati
-00039cc0: 6f20 3d20 6c65 6e28 706f 6c79 676f 6e31  o = len(polygon1
-00039cd0: 5f32 642e 706f 696e 7473 2920 2f20 7261  _2d.points) / ra
-00039ce0: 7469 6f5f 6465 6e6f 6d0a 2020 2020 2020  tio_denom.      
-00039cf0: 2020 7072 6576 696f 7573 5f63 6c6f 7369    previous_closi
-00039d00: 6e67 5f70 6f69 6e74 5f69 6e64 6578 203d  ng_point_index =
-00039d10: 204e 6f6e 650a 2020 2020 2020 2020 666f   None.        fo
-00039d20: 7220 692c 2070 7269 6d69 7469 7665 3120  r i, primitive1 
-00039d30: 696e 2065 6e75 6d65 7261 7465 2870 6f6c  in enumerate(pol
-00039d40: 7967 6f6e 315f 3264 2e6c 696e 655f 7365  ygon1_2d.line_se
-00039d50: 676d 656e 7473 293a 0a20 2020 2020 2020  gments):.       
-00039d60: 2020 2020 206c 6973 745f 7265 6d6f 7665       list_remove
-00039d70: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 7320  _closing_points 
-00039d80: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
-00039d90: 2063 6c6f 7369 6e67 5f70 6f69 6e74 203d   closing_point =
-00039da0: 2070 6f6c 7967 6f6e 315f 3264 2e67 6574   polygon1_2d.get
-00039db0: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 2870  _closing_point(p
-00039dc0: 6f6c 7967 6f6e 325f 3264 2c0a 2020 2020  olygon2_2d,.    
+00039720: 2020 2020 2020 6162 735f 746f 6c3d 302e        abs_tol=0.
+00039730: 3329 3a0a 2020 2020 2020 2020 2020 2020  3):.            
+00039740: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
+00039750: 6465 7820 3d20 6c69 7374 5f63 6c6f 7369  dex = list_closi
+00039760: 6e67 5f70 6f69 6e74 5f69 6e64 6578 6573  ng_point_indexes
+00039770: 5b2d 315d 0a20 2020 2020 2020 2065 6c69  [-1].        eli
+00039780: 6620 6d61 7468 2e69 7363 6c6f 7365 2872  f math.isclose(r
+00039790: 6174 696f 2c20 2d31 2c20 6162 735f 746f  atio, -1, abs_to
+000397a0: 6c3d 302e 3329 3a0a 2020 2020 2020 2020  l=0.3):.        
+000397b0: 2020 2020 636c 6f73 696e 675f 706f 696e      closing_poin
+000397c0: 745f 696e 6465 7820 3d20 6c69 7374 5f63  t_index = list_c
+000397d0: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
+000397e0: 6578 6573 5b2d 315d 0a20 2020 2020 2020  exes[-1].       
+000397f0: 2065 6c69 6620 636c 6f73 696e 675f 706f   elif closing_po
+00039800: 696e 745f 696e 6465 7820 2d20 6c69 7374  int_index - list
+00039810: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f69  _closing_point_i
+00039820: 6e64 6578 6573 5b2d 315d 203e 2035 2061  ndexes[-1] > 5 a
+00039830: 6e64 205c 0a20 2020 2020 2020 2020 2020  nd \.           
+00039840: 206c 6973 745f 636c 6f73 696e 675f 706f   list_closing_po
+00039850: 696e 745f 696e 6465 7865 735b 2d31 5d20  int_indexes[-1] 
+00039860: 2b20 3420 3c3d 2072 6174 696f 5f64 656e  + 4 <= ratio_den
+00039870: 6f6d 696e 6174 6f72 202d 2031 2061 6e64  ominator - 1 and
+00039880: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+00039890: 2020 706f 6c79 676f 6e73 5f70 6f69 6e74    polygons_point
+000398a0: 735f 7261 7469 6f20 3e20 302e 3935 3a0a  s_ratio > 0.95:.
+000398b0: 2020 2020 2020 2020 2020 2020 636c 6f73              clos
+000398c0: 696e 675f 706f 696e 745f 696e 6465 7820  ing_point_index 
+000398d0: 3d20 6c69 7374 5f63 6c6f 7369 6e67 5f70  = list_closing_p
+000398e0: 6f69 6e74 5f69 6e64 6578 6573 5b2d 315d  oint_indexes[-1]
+000398f0: 202b 2034 0a0a 2020 2020 2020 2020 7265   + 4..        re
+00039900: 7475 726e 2063 6c6f 7369 6e67 5f70 6f69  turn closing_poi
+00039910: 6e74 5f69 6e64 6578 2c20 6c69 7374 5f72  nt_index, list_r
+00039920: 656d 6f76 655f 636c 6f73 696e 675f 706f  emove_closing_po
+00039930: 696e 7473 2c20 7061 7373 6564 5f62 795f  ints, passed_by_
+00039940: 7a65 726f 5f69 6e64 6578 0a0a 2020 2020  zero_index..    
+00039950: 6465 6620 636f 6e63 6176 655f 7365 7769  def concave_sewi
+00039960: 6e67 2873 656c 662c 2070 6f6c 7967 6f6e  ng(self, polygon
+00039970: 322c 2078 2c20 7929 3a0a 2020 2020 2020  2, x, y):.      
+00039980: 2020 706f 6c79 676f 6e31 5f32 6420 3d20    polygon1_2d = 
+00039990: 7365 6c66 2e74 6f5f 3264 2876 6f6c 6d64  self.to_2d(volmd
+000399a0: 6c72 2e4f 3244 2c20 782c 2079 290a 2020  lr.O2D, x, y).  
+000399b0: 2020 2020 2020 706f 6c79 676f 6e32 5f32        polygon2_2
+000399c0: 6420 3d20 706f 6c79 676f 6e32 2e74 6f5f  d = polygon2.to_
+000399d0: 3264 2876 6f6c 6d64 6c72 2e4f 3244 2c20  2d(volmdlr.O2D, 
+000399e0: 782c 2079 290a 2020 2020 2020 2020 706f  x, y).        po
+000399f0: 6c79 676f 6e31 5f33 6420 3d20 7365 6c66  lygon1_3d = self
+00039a00: 0a20 2020 2020 2020 2070 6f6c 7967 6f6e  .        polygon
+00039a10: 325f 3364 203d 2070 6f6c 7967 6f6e 320a  2_3d = polygon2.
+00039a20: 2020 2020 2020 2020 6966 2070 6f6c 7967          if polyg
+00039a30: 6f6e 325f 3264 2e61 7265 6128 2920 3c20  on2_2d.area() < 
+00039a40: 706f 6c79 676f 6e31 5f32 642e 6172 6561  polygon1_2d.area
+00039a50: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00039a60: 706f 6c79 676f 6e31 5f32 642c 2070 6f6c  polygon1_2d, pol
+00039a70: 7967 6f6e 325f 3264 203d 2070 6f6c 7967  ygon2_2d = polyg
+00039a80: 6f6e 325f 3264 2c20 706f 6c79 676f 6e31  on2_2d, polygon1
+00039a90: 5f32 640a 2020 2020 2020 2020 2020 2020  _2d.            
+00039aa0: 706f 6c79 676f 6e31 5f33 6420 3d20 706f  polygon1_3d = po
+00039ab0: 6c79 676f 6e32 0a20 2020 2020 2020 2020  lygon2.         
+00039ac0: 2020 2070 6f6c 7967 6f6e 325f 3364 203d     polygon2_3d =
+00039ad0: 2073 656c 660a 2020 2020 2020 2020 706f   self.        po
+00039ae0: 6c79 676f 6e31 5f33 6420 3d20 706f 6c79  lygon1_3d = poly
+00039af0: 676f 6e31 5f33 642e 6765 745f 7661 6c69  gon1_3d.get_vali
+00039b00: 645f 636f 6e63 6176 655f 7365 7769 6e67  d_concave_sewing
+00039b10: 5f70 6f6c 7967 6f6e 280a 2020 2020 2020  _polygon(.      
+00039b20: 2020 2020 2020 706f 6c79 676f 6e31 5f32        polygon1_2
+00039b30: 642c 2070 6f6c 7967 6f6e 325f 3264 290a  d, polygon2_2d).
+00039b40: 2020 2020 2020 2020 706f 6c79 676f 6e31          polygon1
+00039b50: 5f32 6420 3d20 706f 6c79 676f 6e31 5f33  _2d = polygon1_3
+00039b60: 642e 746f 5f32 6428 766f 6c6d 646c 722e  d.to_2d(volmdlr.
+00039b70: 4f32 442c 2078 2c20 7929 0a0a 2020 2020  O2D, x, y)..    
+00039b80: 2020 2020 2320 6178 3d70 6f6c 7967 6f6e      # ax=polygon
+00039b90: 315f 3264 2e70 6c6f 7428 290a 2020 2020  1_2d.plot().    
+00039ba0: 2020 2020 2320 706f 6c79 676f 6e32 5f32      # polygon2_2
+00039bb0: 642e 706c 6f74 2861 783d 6178 2c20 636f  d.plot(ax=ax, co
+00039bc0: 6c6f 723d 2772 2729 0a0a 2020 2020 2020  lor='r')..      
+00039bd0: 2020 6469 6374 5f63 6c6f 7369 6e67 5f70    dict_closing_p
+00039be0: 6169 7273 203d 207b 7d0a 2020 2020 2020  airs = {}.      
+00039bf0: 2020 7472 6961 6e67 6c65 735f 706f 696e    triangles_poin
+00039c00: 7473 203d 205b 5d0a 2020 2020 2020 2020  ts = [].        
+00039c10: 6c69 7374 5f63 6c6f 7369 6e67 5f70 6f69  list_closing_poi
+00039c20: 6e74 5f69 6e64 6578 6573 203d 205b 5d0a  nt_indexes = [].
+00039c30: 2020 2020 2020 2020 7061 7373 6564 5f62          passed_b
+00039c40: 795f 7a65 726f 5f69 6e64 6578 203d 2046  y_zero_index = F
+00039c50: 616c 7365 0a20 2020 2020 2020 2072 6174  alse.        rat
+00039c60: 696f 5f64 656e 6f6d 203d 206c 656e 2870  io_denom = len(p
+00039c70: 6f6c 7967 6f6e 325f 3264 2e70 6f69 6e74  olygon2_2d.point
+00039c80: 7329 0a20 2020 2020 2020 2070 6f6c 7967  s).        polyg
+00039c90: 6f6e 735f 706f 696e 7473 5f72 6174 696f  ons_points_ratio
+00039ca0: 203d 206c 656e 2870 6f6c 7967 6f6e 315f   = len(polygon1_
+00039cb0: 3264 2e70 6f69 6e74 7329 202f 2072 6174  2d.points) / rat
+00039cc0: 696f 5f64 656e 6f6d 0a20 2020 2020 2020  io_denom.       
+00039cd0: 2070 7265 7669 6f75 735f 636c 6f73 696e   previous_closin
+00039ce0: 675f 706f 696e 745f 696e 6465 7820 3d20  g_point_index = 
+00039cf0: 4e6f 6e65 0a20 2020 2020 2020 2066 6f72  None.        for
+00039d00: 2069 2c20 7072 696d 6974 6976 6531 2069   i, primitive1 i
+00039d10: 6e20 656e 756d 6572 6174 6528 706f 6c79  n enumerate(poly
+00039d20: 676f 6e31 5f32 642e 6c69 6e65 5f73 6567  gon1_2d.line_seg
+00039d30: 6d65 6e74 7329 3a0a 2020 2020 2020 2020  ments):.        
+00039d40: 2020 2020 6c69 7374 5f72 656d 6f76 655f      list_remove_
+00039d50: 636c 6f73 696e 675f 706f 696e 7473 203d  closing_points =
+00039d60: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+00039d70: 636c 6f73 696e 675f 706f 696e 7420 3d20  closing_point = 
+00039d80: 706f 6c79 676f 6e31 5f32 642e 6765 745f  polygon1_2d.get_
+00039d90: 636c 6f73 696e 675f 706f 696e 7428 706f  closing_point(po
+00039da0: 6c79 676f 6e32 5f32 642c 0a20 2020 2020  lygon2_2d,.     
+00039db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00039dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039e00: 2020 2020 2020 7072 696d 6974 6976 6531        primitive1
-00039e10: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00039e20: 2063 6c6f 7369 6e67 5f70 6f69 6e74 203d   closing_point =
-00039e30: 3d20 766f 6c6d 646c 722e 4f32 443a 0a20  = volmdlr.O2D:. 
-00039e40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00039e50: 6620 7072 6576 696f 7573 5f63 6c6f 7369  f previous_closi
-00039e60: 6e67 5f70 6f69 6e74 5f69 6e64 6578 2069  ng_point_index i
-00039e70: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00039e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039e90: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
-00039ea0: 6465 7820 3d20 7072 6576 696f 7573 5f63  dex = previous_c
-00039eb0: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
-00039ec0: 6578 0a20 2020 2020 2020 2020 2020 2020  ex.             
-00039ed0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00039ee0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00039ef0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-00039f00: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
-00039f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039f20: 274e 6f6e 6520 6f66 2074 6865 206e 6f72  'None of the nor
-00039f30: 6d61 6c20 6c69 6e65 7320 696e 7465 7273  mal lines inters
-00039f40: 6563 7420 706f 6c79 676f 6e32 2c20 270a  ect polygon2, '.
-00039f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039f60: 2020 2020 2020 2020 2763 6572 7469 6679          'certify
-00039f70: 2070 726f 6a65 6374 696f 6e20 706c 616e   projection plan
-00039f80: 6520 6769 7665 6e20 6973 2063 6f72 7265  e given is corre
-00039f90: 6374 2729 0a20 2020 2020 2020 2020 2020  ct').           
-00039fa0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00039fb0: 2020 2020 2020 2063 6c6f 7369 6e67 5f70         closing_p
-00039fc0: 6f69 6e74 5f69 6e64 6578 203d 2070 6f6c  oint_index = pol
-00039fd0: 7967 6f6e 325f 3264 2e70 6f69 6e74 732e  ygon2_2d.points.
-00039fe0: 696e 6465 7828 636c 6f73 696e 675f 706f  index(closing_po
-00039ff0: 696e 7429 0a0a 2020 2020 2020 2020 2020  int)..          
-0003a000: 2020 6966 2069 203d 3d20 303a 0a20 2020    if i == 0:.   
-0003a010: 2020 2020 2020 2020 2020 2020 2070 7265               pre
-0003a020: 7669 6f75 735f 636c 6f73 696e 675f 706f  vious_closing_po
-0003a030: 696e 745f 696e 6465 7820 3d20 636c 6f73  int_index = clos
-0003a040: 696e 675f 706f 696e 745f 696e 6465 780a  ing_point_index.
-0003a050: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0003a060: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003a070: 2020 636c 6f73 696e 675f 706f 696e 745f    closing_point_
-0003a080: 696e 6465 782c 206c 6973 745f 7265 6d6f  index, list_remo
-0003a090: 7665 5f63 6c6f 7369 6e67 5f70 6f69 6e74  ve_closing_point
-0003a0a0: 732c 5c0a 2020 2020 2020 2020 2020 2020  s,\.            
-0003a0b0: 2020 2020 2020 2020 7061 7373 6564 5f62          passed_b
-0003a0c0: 795f 7a65 726f 5f69 6e64 6578 203d 2073  y_zero_index = s
-0003a0d0: 656c 662e 7661 6c69 6461 7465 5f63 6f6e  elf.validate_con
-0003a0e0: 6361 7665 5f63 6c6f 7369 6e67 5f70 6f69  cave_closing_poi
-0003a0f0: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
-0003a100: 2020 2020 2020 2020 2020 2020 636c 6f73              clos
-0003a110: 696e 675f 706f 696e 745f 696e 6465 782c  ing_point_index,
-0003a120: 206c 6973 745f 636c 6f73 696e 675f 706f   list_closing_po
-0003a130: 696e 745f 696e 6465 7865 732c 0a20 2020  int_indexes,.   
-0003a140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a150: 2020 2020 2070 6173 7365 645f 6279 5f7a       passed_by_z
-0003a160: 6572 6f5f 696e 6465 782c 2072 6174 696f  ero_index, ratio
-0003a170: 5f64 656e 6f6d 2c20 706f 6c79 676f 6e73  _denom, polygons
-0003a180: 5f70 6f69 6e74 735f 7261 7469 6f29 0a0a  _points_ratio)..
-0003a190: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0003a1a0: 6973 745f 7265 6d6f 7665 5f63 6c6f 7369  ist_remove_closi
-0003a1b0: 6e67 5f70 6f69 6e74 733a 0a20 2020 2020  ng_points:.     
-0003a1c0: 2020 2020 2020 2020 2020 206e 6577 5f6c             new_l
-0003a1d0: 6973 745f 636c 6f73 696e 675f 706f 696e  ist_closing_poin
-0003a1e0: 745f 696e 6465 7865 7320 3d20 6c69 7374  t_indexes = list
-0003a1f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0003a200: 2020 2020 2020 6469 6374 2e66 726f 6d6b        dict.fromk
-0003a210: 6579 7328 6c69 7374 5f63 6c6f 7369 6e67  eys(list_closing
-0003a220: 5f70 6f69 6e74 5f69 6e64 6578 6573 2929  _point_indexes))
-0003a230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a240: 206e 6577 5f6c 6973 745f 7265 6d6f 7665   new_list_remove
-0003a250: 5f63 6c6f 7369 6e67 5f69 6e64 6578 6573  _closing_indexes
-0003a260: 203d 206c 6973 7428 0a20 2020 2020 2020   = list(.       
-0003a270: 2020 2020 2020 2020 2020 2020 2064 6963               dic
-0003a280: 742e 6672 6f6d 6b65 7973 286c 6973 745f  t.fromkeys(list_
-0003a290: 7265 6d6f 7665 5f63 6c6f 7369 6e67 5f70  remove_closing_p
-0003a2a0: 6f69 6e74 7329 290a 0a20 2020 2020 2020  oints))..       
-0003a2b0: 2020 2020 2020 2020 2023 2070 7269 6e74           # print
-0003a2c0: 2827 636c 6f73 696e 675f 706f 696e 745f  ('closing_point_
-0003a2d0: 696e 6465 783a 272c 2063 6c6f 7369 6e67  index:', closing
-0003a2e0: 5f70 6f69 6e74 5f69 6e64 6578 290a 2020  _point_index).  
-0003a2f0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0003a300: 7072 696e 7428 276c 6973 745f 7265 6d6f  print('list_remo
-0003a310: 7665 5f63 6c6f 7369 6e67 5f70 6f69 6e74  ve_closing_point
-0003a320: 733a 272c 0a20 2020 2020 2020 2020 2020  s:',.           
-0003a330: 2020 2020 2023 2020 2020 2020 206c 6973       #       lis
-0003a340: 745f 7265 6d6f 7665 5f63 6c6f 7369 6e67  t_remove_closing
-0003a350: 5f70 6f69 6e74 7329 0a20 2020 2020 2020  _points).       
-0003a360: 2020 2020 2020 2020 2023 2070 7269 6e74           # print
-0003a370: 2827 6c69 7374 5f63 6c6f 7369 6e67 5f70  ('list_closing_p
-0003a380: 6f69 6e74 5f69 6e64 6578 6573 3a27 2c0a  oint_indexes:',.
-0003a390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a3a0: 2320 2020 2020 2020 6c69 7374 5f63 6c6f  #       list_clo
-0003a3b0: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
-0003a3c0: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
-0003a3d0: 2020 2020 2320 7072 696e 7428 276e 6577      # print('new
-0003a3e0: 5f6c 6973 745f 636c 6f73 696e 675f 706f  _list_closing_po
-0003a3f0: 696e 745f 696e 6465 7865 733a 272c 0a20  int_indexes:',. 
-0003a400: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0003a410: 2020 2020 2020 206e 6577 5f6c 6973 745f         new_list_
-0003a420: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
-0003a430: 6465 7865 7329 0a20 2020 2020 2020 2020  dexes).         
-0003a440: 2020 2020 2020 2023 2070 7269 6e74 2827         # print('
-0003a450: 6e65 775f 6c69 7374 5f72 656d 6f76 655f  new_list_remove_
-0003a460: 636c 6f73 696e 675f 696e 6465 7865 733a  closing_indexes:
-0003a470: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0003a480: 2020 2023 2020 2020 2020 206e 6577 5f6c     #       new_l
-0003a490: 6973 745f 7265 6d6f 7665 5f63 6c6f 7369  ist_remove_closi
-0003a4a0: 6e67 5f69 6e64 6578 6573 290a 2020 2020  ng_indexes).    
-0003a4b0: 2020 2020 2020 2020 2020 2020 2320 7072              # pr
-0003a4c0: 696e 7428 2764 6963 745f 636c 6f73 696e  int('dict_closin
-0003a4d0: 675f 7061 6972 7320 6265 666f 7265 3a27  g_pairs before:'
-0003a4e0: 2c20 6469 6374 5f63 6c6f 7369 6e67 5f70  , dict_closing_p
-0003a4f0: 6169 7273 290a 2020 2020 2020 2020 2020  airs).          
-0003a500: 2020 2020 2020 6966 206c 656e 286c 6973        if len(lis
-0003a510: 745f 7265 6d6f 7665 5f63 6c6f 7369 6e67  t_remove_closing
-0003a520: 5f70 6f69 6e74 7329 203d 3d20 6c65 6e28  _points) == len(
-0003a530: 7472 6961 6e67 6c65 735f 706f 696e 7473  triangles_points
-0003a540: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0003a550: 2020 2020 2020 2074 7269 616e 676c 6573         triangles
-0003a560: 5f70 6f69 6e74 7320 3d20 5c0a 2020 2020  _points = \.    
-0003a570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a580: 2020 2020 706f 6c79 676f 6e32 5f33 642e      polygon2_3d.
-0003a590: 7265 6465 6669 6e65 5f73 6577 696e 675f  redefine_sewing_
-0003a5a0: 7472 6961 6e67 6c65 735f 706f 696e 7473  triangles_points
-0003a5b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0003a5c0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-0003a5d0: 6961 6e67 6c65 735f 706f 696e 7473 2c20  iangles_points, 
-0003a5e0: 7061 7373 6564 5f62 795f 7a65 726f 5f69  passed_by_zero_i
-0003a5f0: 6e64 6578 2c0a 2020 2020 2020 2020 2020  ndex,.          
-0003a600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a610: 2020 636c 6f73 696e 675f 706f 696e 745f    closing_point_
-0003a620: 696e 6465 782c 2070 7265 7669 6f75 735f  index, previous_
-0003a630: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
-0003a640: 6465 7829 0a20 2020 2020 2020 2020 2020  dex).           
-0003a650: 2020 2020 2020 2020 2069 6620 6469 6374           if dict
-0003a660: 5f63 6c6f 7369 6e67 5f70 6169 7273 3a0a  _closing_pairs:.
-0003a670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a680: 2020 2020 2020 2020 6469 6374 5f63 6c6f          dict_clo
-0003a690: 7369 6e67 5f70 6169 7273 2c20 6c6f 7765  sing_pairs, lowe
-0003a6a0: 725f 626f 756e 6464 6172 795f 636c 6f73  r_bounddary_clos
-0003a6b0: 696e 675f 706f 696e 7420 3d20 5c0a 2020  ing_point = \.  
-0003a6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a6d0: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-0003a6e0: 6c65 616e 5f73 6577 696e 675f 636c 6f73  lean_sewing_clos
-0003a6f0: 696e 675f 7061 6972 735f 6469 6374 696f  ing_pairs_dictio
-0003a700: 6e61 7279 280a 2020 2020 2020 2020 2020  nary(.          
-0003a710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a720: 2020 2020 2020 6469 6374 5f63 6c6f 7369        dict_closi
-0003a730: 6e67 5f70 6169 7273 2c0a 2020 2020 2020  ng_pairs,.      
-0003a740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a750: 2020 2020 2020 2020 2020 636c 6f73 696e            closin
-0003a760: 675f 706f 696e 745f 696e 6465 782c 0a20  g_point_index,. 
-0003a770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a780: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0003a790: 6173 7365 645f 6279 5f7a 6572 6f5f 696e  assed_by_zero_in
-0003a7a0: 6465 7829 0a0a 2020 2020 2020 2020 2020  dex)..          
-0003a7b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0003a7c0: 206c 656e 286e 6577 5f6c 6973 745f 7265   len(new_list_re
-0003a7d0: 6d6f 7665 5f63 6c6f 7369 6e67 5f69 6e64  move_closing_ind
-0003a7e0: 6578 6573 2920 3c5c 0a20 2020 2020 2020  exes) <\.       
-0003a7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a800: 2020 2020 2020 2020 206c 656e 286e 6577           len(new
-0003a810: 5f6c 6973 745f 636c 6f73 696e 675f 706f  _list_closing_po
-0003a820: 696e 745f 696e 6465 7865 7329 3a0a 2020  int_indexes):.  
-0003a830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a840: 2020 2020 2020 2020 2020 6469 6374 5f63            dict_c
-0003a850: 6c6f 7369 6e67 5f70 6169 7273 5b0a 2020  losing_pairs[.  
-0003a860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a870: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
-0003a880: 7765 725f 626f 756e 6464 6172 795f 636c  wer_bounddary_cl
-0003a890: 6f73 696e 675f 706f 696e 745d 203d 2028  osing_point] = (
-0003a8a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a8c0: 206e 6577 5f6c 6973 745f 636c 6f73 696e   new_list_closin
-0003a8d0: 675f 706f 696e 745f 696e 6465 7865 735b  g_point_indexes[
-0003a8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a900: 2020 2020 202d 286c 656e 286e 6577 5f6c       -(len(new_l
-0003a910: 6973 745f 7265 6d6f 7665 5f63 6c6f 7369  ist_remove_closi
-0003a920: 6e67 5f69 6e64 6578 6573 2920 2b20 3129  ng_indexes) + 1)
-0003a930: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0003a940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a950: 2020 2063 6c6f 7369 6e67 5f70 6f69 6e74     closing_point
-0003a960: 5f69 6e64 6578 290a 2020 2020 2020 2020  _index).        
-0003a970: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0003a980: 7074 5f69 6e64 6578 2069 6e20 6c69 7374  pt_index in list
-0003a990: 5f72 656d 6f76 655f 636c 6f73 696e 675f  _remove_closing_
-0003a9a0: 706f 696e 7473 3a0a 2020 2020 2020 2020  points:.        
-0003a9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a9c0: 6c69 7374 5f63 6c6f 7369 6e67 5f70 6f69  list_closing_poi
-0003a9d0: 6e74 5f69 6e64 6578 6573 2e72 656d 6f76  nt_indexes.remov
-0003a9e0: 6528 7074 5f69 6e64 6578 290a 2020 2020  e(pt_index).    
-0003a9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aa00: 6c69 7374 5f63 6c6f 7369 6e67 5f70 6f69  list_closing_poi
-0003aa10: 6e74 5f69 6e64 6578 6573 2e61 7070 656e  nt_indexes.appen
-0003aa20: 6428 636c 6f73 696e 675f 706f 696e 745f  d(closing_point_
-0003aa30: 696e 6465 7829 0a0a 2020 2020 2020 2020  index)..        
-0003aa40: 2020 2020 2020 2020 656c 6966 2028 6e6f          elif (no
-0003aa50: 7420 7061 7373 6564 5f62 795f 7a65 726f  t passed_by_zero
-0003aa60: 5f69 6e64 6578 2061 6e64 0a20 2020 2020  _index and.     
-0003aa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aa80: 2063 6c6f 7369 6e67 5f70 6f69 6e74 5f69   closing_point_i
-0003aa90: 6e64 6578 203e 2070 6f6c 7967 6f6e 325f  ndex > polygon2_
-0003aaa0: 3364 2e70 6f69 6e74 732e 696e 6465 7828  3d.points.index(
-0003aab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003aac0: 2020 2020 2020 2020 2074 7269 616e 676c           triangl
-0003aad0: 6573 5f70 6f69 6e74 735b 2d6c 656e 286c  es_points[-len(l
-0003aae0: 6973 745f 7265 6d6f 7665 5f63 6c6f 7369  ist_remove_closi
-0003aaf0: 6e67 5f70 6f69 6e74 7329 202d 2031 5d5b  ng_points) - 1][
-0003ab00: 325d 2929 206f 725c 0a20 2020 2020 2020  2])) or\.       
-0003ab10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ab20: 2028 7061 7373 6564 5f62 795f 7a65 726f   (passed_by_zero
-0003ab30: 5f69 6e64 6578 2061 6e64 2063 6c6f 7369  _index and closi
-0003ab40: 6e67 5f70 6f69 6e74 5f69 6e64 6578 203e  ng_point_index >
-0003ab50: 3d20 3029 3a0a 2020 2020 2020 2020 2020  = 0):.          
-0003ab60: 2020 2020 2020 2020 2020 7472 6961 6e67            triang
-0003ab70: 6c65 735f 706f 696e 7473 203d 5c0a 2020  les_points =\.  
-0003ab80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ab90: 2020 2020 2020 706f 6c79 676f 6e32 5f33        polygon2_3
-0003aba0: 642e 7265 6465 6669 6e65 5f73 6577 696e  d.redefine_sewin
-0003abb0: 675f 7472 6961 6e67 6c65 735f 706f 696e  g_triangles_poin
-0003abc0: 7473 280a 2020 2020 2020 2020 2020 2020  ts(.            
-0003abd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003abe0: 7472 6961 6e67 6c65 735f 706f 696e 7473  triangles_points
-0003abf0: 2c20 7061 7373 6564 5f62 795f 7a65 726f  , passed_by_zero
-0003ac00: 5f69 6e64 6578 2c0a 2020 2020 2020 2020  _index,.        
-0003ac10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ac20: 2020 2020 636c 6f73 696e 675f 706f 696e      closing_poin
-0003ac30: 745f 696e 6465 782c 2070 7265 7669 6f75  t_index, previou
-0003ac40: 735f 636c 6f73 696e 675f 706f 696e 745f  s_closing_point_
-0003ac50: 696e 6465 7829 0a20 2020 2020 2020 2020  index).         
-0003ac60: 2020 2020 2020 2020 2020 2064 6963 745f             dict_
-0003ac70: 636c 6f73 696e 675f 7061 6972 732c 206c  closing_pairs, l
-0003ac80: 6f77 6572 5f62 6f75 6e64 6461 7279 5f63  ower_bounddary_c
-0003ac90: 6c6f 7369 6e67 5f70 6f69 6e74 203d 5c0a  losing_point =\.
-0003aca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003acb0: 2020 2020 2020 2020 7365 6c66 2e63 6c65          self.cle
-0003acc0: 616e 5f73 6577 696e 675f 636c 6f73 696e  an_sewing_closin
-0003acd0: 675f 7061 6972 735f 6469 6374 696f 6e61  g_pairs_dictiona
-0003ace0: 7279 280a 2020 2020 2020 2020 2020 2020  ry(.            
-0003acf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ad00: 6469 6374 5f63 6c6f 7369 6e67 5f70 6169  dict_closing_pai
-0003ad10: 7273 2c20 636c 6f73 696e 675f 706f 696e  rs, closing_poin
-0003ad20: 745f 696e 6465 782c 2070 6173 7365 645f  t_index, passed_
-0003ad30: 6279 5f7a 6572 6f5f 696e 6465 7829 0a0a  by_zero_index)..
-0003ad40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ad50: 2020 2020 6966 206e 6f74 206c 6973 7428      if not list(
-0003ad60: 6469 6374 5f63 6c6f 7369 6e67 5f70 6169  dict_closing_pai
-0003ad70: 7273 2e6b 6579 7328 2929 206f 7220 6469  rs.keys()) or di
-0003ad80: 6374 5f63 6c6f 7369 6e67 5f70 6169 7273  ct_closing_pairs
-0003ad90: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0003ada0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-0003adb0: 7374 2864 6963 745f 636c 6f73 696e 675f  st(dict_closing_
-0003adc0: 7061 6972 732e 6b65 7973 2829 295b 2d31  pairs.keys())[-1
-0003add0: 5d5d 5b31 5d20 213d 5c0a 2020 2020 2020  ]][1] !=\.      
-0003ade0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003adf0: 2020 2020 2020 636c 6f73 696e 675f 706f        closing_po
-0003ae00: 696e 745f 696e 6465 783a 0a20 2020 2020  int_index:.     
-0003ae10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ae20: 2020 2064 6963 745f 636c 6f73 696e 675f     dict_closing_
-0003ae30: 7061 6972 735b 6c6f 7765 725f 626f 756e  pairs[lower_boun
-0003ae40: 6464 6172 795f 636c 6f73 696e 675f 706f  ddary_closing_po
-0003ae50: 696e 745d 203d 5c0a 2020 2020 2020 2020  int] =\.        
-0003ae60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ae70: 2020 2020 286e 6577 5f6c 6973 745f 636c      (new_list_cl
-0003ae80: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
-0003ae90: 7865 735b 0a20 2020 2020 2020 2020 2020  xes[.           
-0003aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aeb0: 2020 2020 2020 2d28 6c65 6e28 6e65 775f        -(len(new_
-0003aec0: 6c69 7374 5f72 656d 6f76 655f 636c 6f73  list_remove_clos
-0003aed0: 696e 675f 696e 6465 7865 7329 202b 2031  ing_indexes) + 1
-0003aee0: 295d 2c0a 2020 2020 2020 2020 2020 2020  )],.            
-0003aef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003af00: 2063 6c6f 7369 6e67 5f70 6f69 6e74 5f69   closing_point_i
-0003af10: 6e64 6578 290a 0a20 2020 2020 2020 2020  ndex)..         
-0003af20: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-0003af30: 745f 696e 6465 7820 696e 206c 6973 745f  t_index in list_
-0003af40: 7265 6d6f 7665 5f63 6c6f 7369 6e67 5f70  remove_closing_p
-0003af50: 6f69 6e74 733a 0a20 2020 2020 2020 2020  oints:.         
-0003af60: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0003af70: 6973 745f 636c 6f73 696e 675f 706f 696e  ist_closing_poin
-0003af80: 745f 696e 6465 7865 732e 7265 6d6f 7665  t_indexes.remove
-0003af90: 2870 745f 696e 6465 7829 0a20 2020 2020  (pt_index).     
-0003afa0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0003afb0: 6973 745f 636c 6f73 696e 675f 706f 696e  ist_closing_poin
-0003afc0: 745f 696e 6465 7865 732e 6170 7065 6e64  t_indexes.append
-0003afd0: 2863 6c6f 7369 6e67 5f70 6f69 6e74 5f69  (closing_point_i
-0003afe0: 6e64 6578 290a 2020 2020 2020 2020 2020  ndex).          
-0003aff0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0003b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b010: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
-0003b020: 6465 7820 3d20 7072 6576 696f 7573 5f63  dex = previous_c
-0003b030: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
-0003b040: 6578 0a0a 2020 2020 2020 2020 2020 2020  ex..            
-0003b050: 656c 6966 2063 6c6f 7369 6e67 5f70 6f69  elif closing_poi
-0003b060: 6e74 5f69 6e64 6578 2021 3d20 7072 6576  nt_index != prev
-0003b070: 696f 7573 5f63 6c6f 7369 6e67 5f70 6f69  ious_closing_poi
-0003b080: 6e74 5f69 6e64 6578 3a0a 2020 2020 2020  nt_index:.      
-0003b090: 2020 2020 2020 2020 2020 6469 6374 5f63            dict_c
-0003b0a0: 6c6f 7369 6e67 5f70 6169 7273 5b70 6f6c  losing_pairs[pol
-0003b0b0: 7967 6f6e 315f 3364 2e6c 696e 655f 7365  ygon1_3d.line_se
-0003b0c0: 676d 656e 7473 5b69 5d2e 7374 6172 745d  gments[i].start]
-0003b0d0: 203d 5c0a 2020 2020 2020 2020 2020 2020   =\.            
-0003b0e0: 2020 2020 2020 2020 2870 7265 7669 6f75          (previou
-0003b0f0: 735f 636c 6f73 696e 675f 706f 696e 745f  s_closing_point_
-0003b100: 696e 6465 782c 2063 6c6f 7369 6e67 5f70  index, closing_p
-0003b110: 6f69 6e74 5f69 6e64 6578 290a 2020 2020  oint_index).    
-0003b120: 2020 2020 2020 2020 6661 6365 5f70 6f69          face_poi
-0003b130: 6e74 7320 3d20 5b70 6f6c 7967 6f6e 315f  nts = [polygon1_
-0003b140: 3364 2e6c 696e 655f 7365 676d 656e 7473  3d.line_segments
-0003b150: 5b69 5d2e 7374 6172 742c 0a20 2020 2020  [i].start,.     
-0003b160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b170: 2020 2020 2020 706f 6c79 676f 6e31 5f33        polygon1_3
-0003b180: 642e 6c69 6e65 5f73 6567 6d65 6e74 735b  d.line_segments[
-0003b190: 695d 2e65 6e64 2c0a 2020 2020 2020 2020  i].end,.        
-0003b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b1b0: 2020 2070 6f6c 7967 6f6e 325f 3364 2e70     polygon2_3d.p
-0003b1c0: 6f69 6e74 735b 636c 6f73 696e 675f 706f  oints[closing_po
-0003b1d0: 696e 745f 696e 6465 785d 5d0a 2020 2020  int_index]].    
-0003b1e0: 2020 2020 2020 2020 7472 6961 6e67 6c65          triangle
-0003b1f0: 735f 706f 696e 7473 2e61 7070 656e 6428  s_points.append(
-0003b200: 6661 6365 5f70 6f69 6e74 7329 0a20 2020  face_points).   
-0003b210: 2020 2020 2020 2020 206c 6973 745f 636c           list_cl
-0003b220: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
-0003b230: 7865 732e 6170 7065 6e64 2863 6c6f 7369  xes.append(closi
-0003b240: 6e67 5f70 6f69 6e74 5f69 6e64 6578 290a  ng_point_index).
-0003b250: 2020 2020 2020 2020 2020 2020 7072 6576              prev
-0003b260: 696f 7573 5f63 6c6f 7369 6e67 5f70 6f69  ious_closing_poi
-0003b270: 6e74 5f69 6e64 6578 203d 2063 6c6f 7369  nt_index = closi
-0003b280: 6e67 5f70 6f69 6e74 5f69 6e64 6578 0a20  ng_point_index. 
-0003b290: 2020 2020 2020 2020 2020 2069 6620 7072             if pr
-0003b2a0: 696d 6974 6976 6531 203d 3d20 706f 6c79  imitive1 == poly
-0003b2b0: 676f 6e31 5f32 642e 6c69 6e65 5f73 6567  gon1_2d.line_seg
-0003b2c0: 6d65 6e74 735b 2d31 5d3a 0a20 2020 2020  ments[-1]:.     
-0003b2d0: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
-0003b2e0: 7374 5f63 6c6f 7369 6e67 5f70 6f69 6e74  st_closing_point
-0003b2f0: 5f69 6e64 6578 6573 5b2d 315d 2021 3d20  _indexes[-1] != 
-0003b300: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0003b310: 2020 2020 2020 2020 2020 6c69 7374 5f63            list_c
-0003b320: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
-0003b330: 6578 6573 5b30 5d3a 0a20 2020 2020 2020  exes[0]:.       
-0003b340: 2020 2020 2020 2020 2020 2020 2072 6174               rat
-0003b350: 696f 203d 2028 6c69 7374 5f63 6c6f 7369  io = (list_closi
-0003b360: 6e67 5f70 6f69 6e74 5f69 6e64 6578 6573  ng_point_indexes
-0003b370: 5b2d 315d 202d 0a20 2020 2020 2020 2020  [-1] -.         
-0003b380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b390: 2020 2020 6c69 7374 5f63 6c6f 7369 6e67      list_closing
-0003b3a0: 5f70 6f69 6e74 5f69 6e64 6578 6573 5b30  _point_indexes[0
-0003b3b0: 5d29 202f 206c 656e 280a 2020 2020 2020  ]) / len(.      
-0003b3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b3d0: 2020 706f 6c79 676f 6e32 5f32 642e 706f    polygon2_2d.po
-0003b3e0: 696e 7473 290a 2020 2020 2020 2020 2020  ints).          
-0003b3f0: 2020 2020 2020 2020 2020 6966 206d 6174            if mat
-0003b400: 682e 6973 636c 6f73 6528 7261 7469 6f2c  h.isclose(ratio,
-0003b410: 202d 312c 0a20 2020 2020 2020 2020 2020   -1,.           
-0003b420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b430: 2020 2020 2020 2020 2061 6273 5f74 6f6c           abs_tol
-0003b440: 3d30 2e32 2920 616e 6420 7061 7373 6564  =0.2) and passed
-0003b450: 5f62 795f 7a65 726f 5f69 6e64 6578 3a0a  _by_zero_index:.
-0003b460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b470: 2020 2020 2020 2020 6469 6374 5f63 6c6f          dict_clo
-0003b480: 7369 6e67 5f70 6169 7273 5b0a 2020 2020  sing_pairs[.    
-0003b490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b4a0: 2020 2020 2020 2020 706f 6c79 676f 6e31          polygon1
-0003b4b0: 5f33 642e 706f 696e 7473 5b30 5d5d 203d  _3d.points[0]] =
-0003b4c0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0003b4d0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0003b4e0: 6973 745f 636c 6f73 696e 675f 706f 696e  ist_closing_poin
-0003b4f0: 745f 696e 6465 7865 735b 2d32 5d2c 0a20  t_indexes[-2],. 
-0003b500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b510: 2020 2020 2020 2020 2020 206c 6973 745f             list_
-0003b520: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
-0003b530: 6465 7865 735b 305d 290a 2020 2020 2020  dexes[0]).      
-0003b540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b550: 2020 6e65 775f 6661 6365 5f70 6f69 6e74    new_face_point
-0003b560: 7320 3d20 5b74 7269 616e 676c 6573 5f70  s = [triangles_p
-0003b570: 6f69 6e74 735b 2d31 5d5b 305d 2c0a 2020  oints[-1][0],.  
-0003b580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b5a0: 2020 2020 2020 2020 2074 7269 616e 676c           triangl
-0003b5b0: 6573 5f70 6f69 6e74 735b 2d31 5d5b 315d  es_points[-1][1]
-0003b5c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003b5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b5e0: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
-0003b5f0: 7967 6f6e 325f 3364 2e70 6f69 6e74 735b  ygon2_3d.points[
-0003b600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b630: 6c69 7374 5f63 6c6f 7369 6e67 5f70 6f69  list_closing_poi
-0003b640: 6e74 5f69 6e64 6578 6573 5b2d 325d 5d5d  nt_indexes[-2]]]
-0003b650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b660: 2020 2020 2020 2020 2074 7269 616e 676c           triangl
-0003b670: 6573 5f70 6f69 6e74 732e 7265 6d6f 7665  es_points.remove
-0003b680: 2874 7269 616e 676c 6573 5f70 6f69 6e74  (triangles_point
-0003b690: 735b 2d31 5d29 0a20 2020 2020 2020 2020  s[-1]).         
-0003b6a0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0003b6b0: 7269 616e 676c 6573 5f70 6f69 6e74 732e  riangles_points.
-0003b6c0: 6170 7065 6e64 286e 6577 5f66 6163 655f  append(new_face_
-0003b6d0: 706f 696e 7473 290a 2020 2020 2020 2020  points).        
-0003b6e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0003b6f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003b700: 2020 2020 2020 2020 2020 6469 6374 5f63            dict_c
-0003b710: 6c6f 7369 6e67 5f70 6169 7273 5b70 6f6c  losing_pairs[pol
-0003b720: 7967 6f6e 315f 3364 2e70 6f69 6e74 735b  ygon1_3d.points[
-0003b730: 305d 5d20 3d20 280a 2020 2020 2020 2020  0]] = (.        
-0003b740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b750: 2020 2020 6c69 7374 2864 6963 745f 636c      list(dict_cl
-0003b760: 6f73 696e 675f 7061 6972 732e 7661 6c75  osing_pairs.valu
-0003b770: 6573 2829 295b 2d31 5d5b 2d31 5d2c 0a20  es())[-1][-1],. 
-0003b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b790: 2020 2020 2020 2020 2020 206c 6973 7428             list(
-0003b7a0: 6469 6374 5f63 6c6f 7369 6e67 5f70 6169  dict_closing_pai
-0003b7b0: 7273 2e76 616c 7565 7328 2929 5b30 5d5b  rs.values())[0][
-0003b7c0: 305d 290a 0a20 2020 2020 2020 2074 7269  0])..        tri
-0003b7d0: 616e 676c 6573 5f70 6f69 6e74 7320 2b3d  angles_points +=
-0003b7e0: 2070 6f6c 7967 6f6e 325f 3364 2e63 6c6f   polygon2_3d.clo
-0003b7f0: 7365 5f73 6577 696e 6728 6469 6374 5f63  se_sewing(dict_c
-0003b800: 6c6f 7369 6e67 5f70 6169 7273 290a 0a20  losing_pairs).. 
-0003b810: 2020 2020 2020 2072 6574 7572 6e20 7472         return tr
-0003b820: 6961 6e67 6c65 735f 706f 696e 7473 0a0a  iangles_points..
-0003b830: 2020 2020 6465 6620 7365 7769 6e67 2873      def sewing(s
-0003b840: 656c 662c 2070 6f6c 7967 6f6e 322c 2078  elf, polygon2, x
-0003b850: 2c20 7929 3a0a 2020 2020 2020 2020 706f  , y):.        po
-0003b860: 6c79 676f 6e31 5f32 6420 3d20 7365 6c66  lygon1_2d = self
-0003b870: 2e74 6f5f 3264 2876 6f6c 6d64 6c72 2e4f  .to_2d(volmdlr.O
-0003b880: 3244 2c20 782c 2079 290a 2020 2020 2020  2D, x, y).      
-0003b890: 2020 706f 6c79 676f 6e32 5f32 6420 3d20    polygon2_2d = 
-0003b8a0: 706f 6c79 676f 6e32 2e74 6f5f 3264 2876  polygon2.to_2d(v
-0003b8b0: 6f6c 6d64 6c72 2e4f 3244 2c20 782c 2079  olmdlr.O2D, x, y
-0003b8c0: 290a 2020 2020 2020 2020 6966 2070 6f6c  ).        if pol
-0003b8d0: 7967 6f6e 315f 3264 2e69 735f 636f 6e76  ygon1_2d.is_conv
-0003b8e0: 6578 2829 2061 6e64 2070 6f6c 7967 6f6e  ex() and polygon
-0003b8f0: 325f 3264 2e69 735f 636f 6e76 6578 2829  2_2d.is_convex()
-0003b900: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0003b910: 7475 726e 2073 656c 662e 636f 6e76 6578  turn self.convex
-0003b920: 5f73 6577 696e 6728 706f 6c79 676f 6e32  _sewing(polygon2
-0003b930: 2c20 782c 2079 290a 2020 2020 2020 2020  , x, y).        
-0003b940: 7265 7475 726e 2073 656c 662e 636f 6e63  return self.conc
-0003b950: 6176 655f 7365 7769 6e67 2870 6f6c 7967  ave_sewing(polyg
-0003b960: 6f6e 322c 2078 2c20 7929 0a0a 0a63 6c61  on2, x, y)...cla
-0003b970: 7373 2054 7269 616e 676c 6533 4428 5472  ss Triangle3D(Tr
-0003b980: 6961 6e67 6c65 293a 0a20 2020 2022 2222  iangle):.    """
-0003b990: 0a20 2020 2044 6566 696e 6573 2061 2074  .    Defines a t
-0003b9a0: 7269 616e 676c 6520 3244 2e0a 0a20 2020  riangle 2D...   
-0003b9b0: 203a 7061 7261 6d20 706f 696e 7431 3a20   :param point1: 
-0003b9c0: 7472 6961 6e67 6c65 2070 6f69 6e74 2031  triangle point 1
-0003b9d0: 2e0a 2020 2020 3a70 6172 616d 2070 6f69  ..    :param poi
-0003b9e0: 6e74 323a 2074 7269 616e 676c 6520 706f  nt2: triangle po
-0003b9f0: 696e 7420 322e 0a20 2020 203a 7061 7261  int 2..    :para
-0003ba00: 6d20 706f 696e 7433 3a20 7472 6961 6e67  m point3: triang
-0003ba10: 6c65 2070 6f69 6e74 332e 0a20 2020 2022  le point3..    "
-0003ba20: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
-0003ba30: 6974 5f5f 2873 656c 662c 2070 6f69 6e74  it__(self, point
-0003ba40: 313a 2076 6f6c 6d64 6c72 2e50 6f69 6e74  1: volmdlr.Point
-0003ba50: 3344 2c20 706f 696e 7432 3a20 766f 6c6d  3D, point2: volm
-0003ba60: 646c 722e 506f 696e 7433 442c 0a20 2020  dlr.Point3D,.   
-0003ba70: 2020 2020 2020 2020 2020 2020 2020 706f                po
-0003ba80: 696e 7433 3a20 766f 6c6d 646c 722e 506f  int3: volmdlr.Po
-0003ba90: 696e 7433 442c 206e 616d 653a 2073 7472  int3D, name: str
-0003baa0: 203d 2027 2729 3a0a 0a20 2020 2020 2020   = ''):..       
-0003bab0: 2054 7269 616e 676c 652e 5f5f 696e 6974   Triangle.__init
-0003bac0: 5f5f 2873 656c 662c 2070 6f69 6e74 312c  __(self, point1,
-0003bad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003bae0: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
-0003baf0: 322c 0a20 2020 2020 2020 2020 2020 2020  2,.             
-0003bb00: 2020 2020 2020 2020 2020 2020 2070 6f69               poi
-0003bb10: 6e74 332c 0a20 2020 2020 2020 2020 2020  nt3,.           
-0003bb20: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0003bb30: 616d 6529 0a                             ame).
+00039de0: 2020 2020 2070 7269 6d69 7469 7665 3129       primitive1)
+00039df0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00039e00: 636c 6f73 696e 675f 706f 696e 7420 3d3d  closing_point ==
+00039e10: 2076 6f6c 6d64 6c72 2e4f 3244 3a0a 2020   volmdlr.O2D:.  
+00039e20: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00039e30: 2070 7265 7669 6f75 735f 636c 6f73 696e   previous_closin
+00039e40: 675f 706f 696e 745f 696e 6465 7820 6973  g_point_index is
+00039e50: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00039e60: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00039e70: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
+00039e80: 6578 203d 2070 7265 7669 6f75 735f 636c  ex = previous_cl
+00039e90: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
+00039ea0: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
+00039eb0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00039ec0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00039ed0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+00039ee0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00039ef0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00039f00: 4e6f 6e65 206f 6620 7468 6520 6e6f 726d  None of the norm
+00039f10: 616c 206c 696e 6573 2069 6e74 6572 7365  al lines interse
+00039f20: 6374 2070 6f6c 7967 6f6e 322c 2027 0a20  ct polygon2, '. 
+00039f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039f40: 2020 2020 2020 2027 6365 7274 6966 7920         'certify 
+00039f50: 7072 6f6a 6563 7469 6f6e 2070 6c61 6e65  projection plane
+00039f60: 2067 6976 656e 2069 7320 636f 7272 6563   given is correc
+00039f70: 7427 290a 2020 2020 2020 2020 2020 2020  t').            
+00039f80: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00039f90: 2020 2020 2020 636c 6f73 696e 675f 706f        closing_po
+00039fa0: 696e 745f 696e 6465 7820 3d20 706f 6c79  int_index = poly
+00039fb0: 676f 6e32 5f32 642e 706f 696e 7473 2e69  gon2_2d.points.i
+00039fc0: 6e64 6578 2863 6c6f 7369 6e67 5f70 6f69  ndex(closing_poi
+00039fd0: 6e74 290a 0a20 2020 2020 2020 2020 2020  nt)..           
+00039fe0: 2069 6620 6920 3d3d 2030 3a0a 2020 2020   if i == 0:.    
+00039ff0: 2020 2020 2020 2020 2020 2020 7072 6576              prev
+0003a000: 696f 7573 5f63 6c6f 7369 6e67 5f70 6f69  ious_closing_poi
+0003a010: 6e74 5f69 6e64 6578 203d 2063 6c6f 7369  nt_index = closi
+0003a020: 6e67 5f70 6f69 6e74 5f69 6e64 6578 0a20  ng_point_index. 
+0003a030: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0003a040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a050: 2063 6c6f 7369 6e67 5f70 6f69 6e74 5f69   closing_point_i
+0003a060: 6e64 6578 2c20 6c69 7374 5f72 656d 6f76  ndex, list_remov
+0003a070: 655f 636c 6f73 696e 675f 706f 696e 7473  e_closing_points
+0003a080: 2c5c 0a20 2020 2020 2020 2020 2020 2020  ,\.             
+0003a090: 2020 2020 2020 2070 6173 7365 645f 6279         passed_by
+0003a0a0: 5f7a 6572 6f5f 696e 6465 7820 3d20 7365  _zero_index = se
+0003a0b0: 6c66 2e76 616c 6964 6174 655f 636f 6e63  lf.validate_conc
+0003a0c0: 6176 655f 636c 6f73 696e 675f 706f 696e  ave_closing_poin
+0003a0d0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+0003a0e0: 2020 2020 2020 2020 2020 2063 6c6f 7369             closi
+0003a0f0: 6e67 5f70 6f69 6e74 5f69 6e64 6578 2c20  ng_point_index, 
+0003a100: 6c69 7374 5f63 6c6f 7369 6e67 5f70 6f69  list_closing_poi
+0003a110: 6e74 5f69 6e64 6578 6573 2c0a 2020 2020  nt_indexes,.    
+0003a120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a130: 2020 2020 7061 7373 6564 5f62 795f 7a65      passed_by_ze
+0003a140: 726f 5f69 6e64 6578 2c20 7261 7469 6f5f  ro_index, ratio_
+0003a150: 6465 6e6f 6d2c 2070 6f6c 7967 6f6e 735f  denom, polygons_
+0003a160: 706f 696e 7473 5f72 6174 696f 290a 0a20  points_ratio).. 
+0003a170: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
+0003a180: 7374 5f72 656d 6f76 655f 636c 6f73 696e  st_remove_closin
+0003a190: 675f 706f 696e 7473 3a0a 2020 2020 2020  g_points:.      
+0003a1a0: 2020 2020 2020 2020 2020 6e65 775f 6c69            new_li
+0003a1b0: 7374 5f63 6c6f 7369 6e67 5f70 6f69 6e74  st_closing_point
+0003a1c0: 5f69 6e64 6578 6573 203d 206c 6973 7428  _indexes = list(
+0003a1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a1e0: 2020 2020 2064 6963 742e 6672 6f6d 6b65       dict.fromke
+0003a1f0: 7973 286c 6973 745f 636c 6f73 696e 675f  ys(list_closing_
+0003a200: 706f 696e 745f 696e 6465 7865 7329 290a  point_indexes)).
+0003a210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a220: 6e65 775f 6c69 7374 5f72 656d 6f76 655f  new_list_remove_
+0003a230: 636c 6f73 696e 675f 696e 6465 7865 7320  closing_indexes 
+0003a240: 3d20 6c69 7374 280a 2020 2020 2020 2020  = list(.        
+0003a250: 2020 2020 2020 2020 2020 2020 6469 6374              dict
+0003a260: 2e66 726f 6d6b 6579 7328 6c69 7374 5f72  .fromkeys(list_r
+0003a270: 656d 6f76 655f 636c 6f73 696e 675f 706f  emove_closing_po
+0003a280: 696e 7473 2929 0a0a 2020 2020 2020 2020  ints))..        
+0003a290: 2020 2020 2020 2020 2320 7072 696e 7428          # print(
+0003a2a0: 2763 6c6f 7369 6e67 5f70 6f69 6e74 5f69  'closing_point_i
+0003a2b0: 6e64 6578 3a27 2c20 636c 6f73 696e 675f  ndex:', closing_
+0003a2c0: 706f 696e 745f 696e 6465 7829 0a20 2020  point_index).   
+0003a2d0: 2020 2020 2020 2020 2020 2020 2023 2070               # p
+0003a2e0: 7269 6e74 2827 6c69 7374 5f72 656d 6f76  rint('list_remov
+0003a2f0: 655f 636c 6f73 696e 675f 706f 696e 7473  e_closing_points
+0003a300: 3a27 2c0a 2020 2020 2020 2020 2020 2020  :',.            
+0003a310: 2020 2020 2320 2020 2020 2020 6c69 7374      #       list
+0003a320: 5f72 656d 6f76 655f 636c 6f73 696e 675f  _remove_closing_
+0003a330: 706f 696e 7473 290a 2020 2020 2020 2020  points).        
+0003a340: 2020 2020 2020 2020 2320 7072 696e 7428          # print(
+0003a350: 276c 6973 745f 636c 6f73 696e 675f 706f  'list_closing_po
+0003a360: 696e 745f 696e 6465 7865 733a 272c 0a20  int_indexes:',. 
+0003a370: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0003a380: 2020 2020 2020 206c 6973 745f 636c 6f73         list_clos
+0003a390: 696e 675f 706f 696e 745f 696e 6465 7865  ing_point_indexe
+0003a3a0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+0003a3b0: 2020 2023 2070 7269 6e74 2827 6e65 775f     # print('new_
+0003a3c0: 6c69 7374 5f63 6c6f 7369 6e67 5f70 6f69  list_closing_poi
+0003a3d0: 6e74 5f69 6e64 6578 6573 3a27 2c0a 2020  nt_indexes:',.  
+0003a3e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0003a3f0: 2020 2020 2020 6e65 775f 6c69 7374 5f63        new_list_c
+0003a400: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
+0003a410: 6578 6573 290a 2020 2020 2020 2020 2020  exes).          
+0003a420: 2020 2020 2020 2320 7072 696e 7428 276e        # print('n
+0003a430: 6577 5f6c 6973 745f 7265 6d6f 7665 5f63  ew_list_remove_c
+0003a440: 6c6f 7369 6e67 5f69 6e64 6578 6573 3a27  losing_indexes:'
+0003a450: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003a460: 2020 2320 2020 2020 2020 6e65 775f 6c69    #       new_li
+0003a470: 7374 5f72 656d 6f76 655f 636c 6f73 696e  st_remove_closin
+0003a480: 675f 696e 6465 7865 7329 0a20 2020 2020  g_indexes).     
+0003a490: 2020 2020 2020 2020 2020 2023 2070 7269             # pri
+0003a4a0: 6e74 2827 6469 6374 5f63 6c6f 7369 6e67  nt('dict_closing
+0003a4b0: 5f70 6169 7273 2062 6566 6f72 653a 272c  _pairs before:',
+0003a4c0: 2064 6963 745f 636c 6f73 696e 675f 7061   dict_closing_pa
+0003a4d0: 6972 7329 0a20 2020 2020 2020 2020 2020  irs).           
+0003a4e0: 2020 2020 2069 6620 6c65 6e28 6c69 7374       if len(list
+0003a4f0: 5f72 656d 6f76 655f 636c 6f73 696e 675f  _remove_closing_
+0003a500: 706f 696e 7473 2920 3d3d 206c 656e 2874  points) == len(t
+0003a510: 7269 616e 676c 6573 5f70 6f69 6e74 7329  riangles_points)
+0003a520: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003a530: 2020 2020 2020 7472 6961 6e67 6c65 735f        triangles_
+0003a540: 706f 696e 7473 203d 205c 0a20 2020 2020  points = \.     
+0003a550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a560: 2020 2070 6f6c 7967 6f6e 325f 3364 2e72     polygon2_3d.r
+0003a570: 6564 6566 696e 655f 7365 7769 6e67 5f74  edefine_sewing_t
+0003a580: 7269 616e 676c 6573 5f70 6f69 6e74 7328  riangles_points(
+0003a590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a5a0: 2020 2020 2020 2020 2020 2020 2074 7269               tri
+0003a5b0: 616e 676c 6573 5f70 6f69 6e74 732c 2070  angles_points, p
+0003a5c0: 6173 7365 645f 6279 5f7a 6572 6f5f 696e  assed_by_zero_in
+0003a5d0: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
+0003a5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a5f0: 2063 6c6f 7369 6e67 5f70 6f69 6e74 5f69   closing_point_i
+0003a600: 6e64 6578 2c20 7072 6576 696f 7573 5f63  ndex, previous_c
+0003a610: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
+0003a620: 6578 290a 2020 2020 2020 2020 2020 2020  ex).            
+0003a630: 2020 2020 2020 2020 6966 2064 6963 745f          if dict_
+0003a640: 636c 6f73 696e 675f 7061 6972 733a 0a20  closing_pairs:. 
+0003a650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a660: 2020 2020 2020 2064 6963 745f 636c 6f73         dict_clos
+0003a670: 696e 675f 7061 6972 732c 206c 6f77 6572  ing_pairs, lower
+0003a680: 5f62 6f75 6e64 6461 7279 5f63 6c6f 7369  _bounddary_closi
+0003a690: 6e67 5f70 6f69 6e74 203d 205c 0a20 2020  ng_point = \.   
+0003a6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a6b0: 2020 2020 2020 2020 2073 656c 662e 636c           self.cl
+0003a6c0: 6561 6e5f 7365 7769 6e67 5f63 6c6f 7369  ean_sewing_closi
+0003a6d0: 6e67 5f70 6169 7273 5f64 6963 7469 6f6e  ng_pairs_diction
+0003a6e0: 6172 7928 0a20 2020 2020 2020 2020 2020  ary(.           
+0003a6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a700: 2020 2020 2064 6963 745f 636c 6f73 696e       dict_closin
+0003a710: 675f 7061 6972 732c 0a20 2020 2020 2020  g_pairs,.       
+0003a720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a730: 2020 2020 2020 2020 2063 6c6f 7369 6e67           closing
+0003a740: 5f70 6f69 6e74 5f69 6e64 6578 2c0a 2020  _point_index,.  
+0003a750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a760: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0003a770: 7373 6564 5f62 795f 7a65 726f 5f69 6e64  ssed_by_zero_ind
+0003a780: 6578 290a 0a20 2020 2020 2020 2020 2020  ex)..           
+0003a790: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0003a7a0: 6c65 6e28 6e65 775f 6c69 7374 5f72 656d  len(new_list_rem
+0003a7b0: 6f76 655f 636c 6f73 696e 675f 696e 6465  ove_closing_inde
+0003a7c0: 7865 7329 203c 5c0a 2020 2020 2020 2020  xes) <\.        
+0003a7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a7e0: 2020 2020 2020 2020 6c65 6e28 6e65 775f          len(new_
+0003a7f0: 6c69 7374 5f63 6c6f 7369 6e67 5f70 6f69  list_closing_poi
+0003a800: 6e74 5f69 6e64 6578 6573 293a 0a20 2020  nt_indexes):.   
+0003a810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a820: 2020 2020 2020 2020 2064 6963 745f 636c           dict_cl
+0003a830: 6f73 696e 675f 7061 6972 735b 0a20 2020  osing_pairs[.   
+0003a840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a850: 2020 2020 2020 2020 2020 2020 206c 6f77               low
+0003a860: 6572 5f62 6f75 6e64 6461 7279 5f63 6c6f  er_bounddary_clo
+0003a870: 7369 6e67 5f70 6f69 6e74 5d20 3d20 280a  sing_point] = (.
+0003a880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a8a0: 6e65 775f 6c69 7374 5f63 6c6f 7369 6e67  new_list_closing
+0003a8b0: 5f70 6f69 6e74 5f69 6e64 6578 6573 5b0a  _point_indexes[.
+0003a8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a8e0: 2020 2020 2d28 6c65 6e28 6e65 775f 6c69      -(len(new_li
+0003a8f0: 7374 5f72 656d 6f76 655f 636c 6f73 696e  st_remove_closin
+0003a900: 675f 696e 6465 7865 7329 202b 2031 295d  g_indexes) + 1)]
+0003a910: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003a920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a930: 2020 636c 6f73 696e 675f 706f 696e 745f    closing_point_
+0003a940: 696e 6465 7829 0a20 2020 2020 2020 2020  index).         
+0003a950: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
+0003a960: 745f 696e 6465 7820 696e 206c 6973 745f  t_index in list_
+0003a970: 7265 6d6f 7665 5f63 6c6f 7369 6e67 5f70  remove_closing_p
+0003a980: 6f69 6e74 733a 0a20 2020 2020 2020 2020  oints:.         
+0003a990: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0003a9a0: 6973 745f 636c 6f73 696e 675f 706f 696e  ist_closing_poin
+0003a9b0: 745f 696e 6465 7865 732e 7265 6d6f 7665  t_indexes.remove
+0003a9c0: 2870 745f 696e 6465 7829 0a20 2020 2020  (pt_index).     
+0003a9d0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0003a9e0: 6973 745f 636c 6f73 696e 675f 706f 696e  ist_closing_poin
+0003a9f0: 745f 696e 6465 7865 732e 6170 7065 6e64  t_indexes.append
+0003aa00: 2863 6c6f 7369 6e67 5f70 6f69 6e74 5f69  (closing_point_i
+0003aa10: 6e64 6578 290a 0a20 2020 2020 2020 2020  ndex)..         
+0003aa20: 2020 2020 2020 2065 6c69 6620 286e 6f74         elif (not
+0003aa30: 2070 6173 7365 645f 6279 5f7a 6572 6f5f   passed_by_zero_
+0003aa40: 696e 6465 7820 616e 640a 2020 2020 2020  index and.      
+0003aa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003aa60: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
+0003aa70: 6465 7820 3e20 706f 6c79 676f 6e32 5f33  dex > polygon2_3
+0003aa80: 642e 706f 696e 7473 2e69 6e64 6578 280a  d.points.index(.
+0003aa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003aaa0: 2020 2020 2020 2020 7472 6961 6e67 6c65          triangle
+0003aab0: 735f 706f 696e 7473 5b2d 6c65 6e28 6c69  s_points[-len(li
+0003aac0: 7374 5f72 656d 6f76 655f 636c 6f73 696e  st_remove_closin
+0003aad0: 675f 706f 696e 7473 2920 2d20 315d 5b32  g_points) - 1][2
+0003aae0: 5d29 2920 6f72 5c0a 2020 2020 2020 2020  ])) or\.        
+0003aaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ab00: 2870 6173 7365 645f 6279 5f7a 6572 6f5f  (passed_by_zero_
+0003ab10: 696e 6465 7820 616e 6420 636c 6f73 696e  index and closin
+0003ab20: 675f 706f 696e 745f 696e 6465 7820 3e3d  g_point_index >=
+0003ab30: 2030 293a 0a20 2020 2020 2020 2020 2020   0):.           
+0003ab40: 2020 2020 2020 2020 2074 7269 616e 676c           triangl
+0003ab50: 6573 5f70 6f69 6e74 7320 3d5c 0a20 2020  es_points =\.   
+0003ab60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ab70: 2020 2020 2070 6f6c 7967 6f6e 325f 3364       polygon2_3d
+0003ab80: 2e72 6564 6566 696e 655f 7365 7769 6e67  .redefine_sewing
+0003ab90: 5f74 7269 616e 676c 6573 5f70 6f69 6e74  _triangles_point
+0003aba0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+0003abb0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0003abc0: 7269 616e 676c 6573 5f70 6f69 6e74 732c  riangles_points,
+0003abd0: 2070 6173 7365 645f 6279 5f7a 6572 6f5f   passed_by_zero_
+0003abe0: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
+0003abf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ac00: 2020 2063 6c6f 7369 6e67 5f70 6f69 6e74     closing_point
+0003ac10: 5f69 6e64 6578 2c20 7072 6576 696f 7573  _index, previous
+0003ac20: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f69  _closing_point_i
+0003ac30: 6e64 6578 290a 2020 2020 2020 2020 2020  ndex).          
+0003ac40: 2020 2020 2020 2020 2020 6469 6374 5f63            dict_c
+0003ac50: 6c6f 7369 6e67 5f70 6169 7273 2c20 6c6f  losing_pairs, lo
+0003ac60: 7765 725f 626f 756e 6464 6172 795f 636c  wer_bounddary_cl
+0003ac70: 6f73 696e 675f 706f 696e 7420 3d5c 0a20  osing_point =\. 
+0003ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ac90: 2020 2020 2020 2073 656c 662e 636c 6561         self.clea
+0003aca0: 6e5f 7365 7769 6e67 5f63 6c6f 7369 6e67  n_sewing_closing
+0003acb0: 5f70 6169 7273 5f64 6963 7469 6f6e 6172  _pairs_dictionar
+0003acc0: 7928 0a20 2020 2020 2020 2020 2020 2020  y(.             
+0003acd0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0003ace0: 6963 745f 636c 6f73 696e 675f 7061 6972  ict_closing_pair
+0003acf0: 732c 2063 6c6f 7369 6e67 5f70 6f69 6e74  s, closing_point
+0003ad00: 5f69 6e64 6578 2c20 7061 7373 6564 5f62  _index, passed_b
+0003ad10: 795f 7a65 726f 5f69 6e64 6578 290a 0a20  y_zero_index).. 
+0003ad20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ad30: 2020 2069 6620 6e6f 7420 6c69 7374 2864     if not list(d
+0003ad40: 6963 745f 636c 6f73 696e 675f 7061 6972  ict_closing_pair
+0003ad50: 732e 6b65 7973 2829 2920 6f72 2064 6963  s.keys()) or dic
+0003ad60: 745f 636c 6f73 696e 675f 7061 6972 735b  t_closing_pairs[
+0003ad70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003ad80: 2020 2020 2020 2020 2020 2020 206c 6973               lis
+0003ad90: 7428 6469 6374 5f63 6c6f 7369 6e67 5f70  t(dict_closing_p
+0003ada0: 6169 7273 2e6b 6579 7328 2929 5b2d 315d  airs.keys())[-1]
+0003adb0: 5d5b 315d 2021 3d5c 0a20 2020 2020 2020  ][1] !=\.       
+0003adc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003add0: 2020 2020 2063 6c6f 7369 6e67 5f70 6f69       closing_poi
+0003ade0: 6e74 5f69 6e64 6578 3a0a 2020 2020 2020  nt_index:.      
+0003adf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ae00: 2020 6469 6374 5f63 6c6f 7369 6e67 5f70    dict_closing_p
+0003ae10: 6169 7273 5b6c 6f77 6572 5f62 6f75 6e64  airs[lower_bound
+0003ae20: 6461 7279 5f63 6c6f 7369 6e67 5f70 6f69  dary_closing_poi
+0003ae30: 6e74 5d20 3d5c 0a20 2020 2020 2020 2020  nt] =\.         
+0003ae40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ae50: 2020 2028 6e65 775f 6c69 7374 5f63 6c6f     (new_list_clo
+0003ae60: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
+0003ae70: 6573 5b0a 2020 2020 2020 2020 2020 2020  es[.            
+0003ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ae90: 2020 2020 202d 286c 656e 286e 6577 5f6c       -(len(new_l
+0003aea0: 6973 745f 7265 6d6f 7665 5f63 6c6f 7369  ist_remove_closi
+0003aeb0: 6e67 5f69 6e64 6578 6573 2920 2b20 3129  ng_indexes) + 1)
+0003aec0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0003aed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003aee0: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
+0003aef0: 6465 7829 0a0a 2020 2020 2020 2020 2020  dex)..          
+0003af00: 2020 2020 2020 2020 2020 666f 7220 7074            for pt
+0003af10: 5f69 6e64 6578 2069 6e20 6c69 7374 5f72  _index in list_r
+0003af20: 656d 6f76 655f 636c 6f73 696e 675f 706f  emove_closing_po
+0003af30: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
+0003af40: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+0003af50: 7374 5f63 6c6f 7369 6e67 5f70 6f69 6e74  st_closing_point
+0003af60: 5f69 6e64 6578 6573 2e72 656d 6f76 6528  _indexes.remove(
+0003af70: 7074 5f69 6e64 6578 290a 2020 2020 2020  pt_index).      
+0003af80: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+0003af90: 7374 5f63 6c6f 7369 6e67 5f70 6f69 6e74  st_closing_point
+0003afa0: 5f69 6e64 6578 6573 2e61 7070 656e 6428  _indexes.append(
+0003afb0: 636c 6f73 696e 675f 706f 696e 745f 696e  closing_point_in
+0003afc0: 6465 7829 0a20 2020 2020 2020 2020 2020  dex).           
+0003afd0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0003afe0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0003aff0: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
+0003b000: 6578 203d 2070 7265 7669 6f75 735f 636c  ex = previous_cl
+0003b010: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
+0003b020: 780a 0a20 2020 2020 2020 2020 2020 2065  x..            e
+0003b030: 6c69 6620 636c 6f73 696e 675f 706f 696e  lif closing_poin
+0003b040: 745f 696e 6465 7820 213d 2070 7265 7669  t_index != previ
+0003b050: 6f75 735f 636c 6f73 696e 675f 706f 696e  ous_closing_poin
+0003b060: 745f 696e 6465 783a 0a20 2020 2020 2020  t_index:.       
+0003b070: 2020 2020 2020 2020 2064 6963 745f 636c           dict_cl
+0003b080: 6f73 696e 675f 7061 6972 735b 706f 6c79  osing_pairs[poly
+0003b090: 676f 6e31 5f33 642e 6c69 6e65 5f73 6567  gon1_3d.line_seg
+0003b0a0: 6d65 6e74 735b 695d 2e73 7461 7274 5d20  ments[i].start] 
+0003b0b0: 3d5c 0a20 2020 2020 2020 2020 2020 2020  =\.             
+0003b0c0: 2020 2020 2020 2028 7072 6576 696f 7573         (previous
+0003b0d0: 5f63 6c6f 7369 6e67 5f70 6f69 6e74 5f69  _closing_point_i
+0003b0e0: 6e64 6578 2c20 636c 6f73 696e 675f 706f  ndex, closing_po
+0003b0f0: 696e 745f 696e 6465 7829 0a20 2020 2020  int_index).     
+0003b100: 2020 2020 2020 2066 6163 655f 706f 696e         face_poin
+0003b110: 7473 203d 205b 706f 6c79 676f 6e31 5f33  ts = [polygon1_3
+0003b120: 642e 6c69 6e65 5f73 6567 6d65 6e74 735b  d.line_segments[
+0003b130: 695d 2e73 7461 7274 2c0a 2020 2020 2020  i].start,.      
+0003b140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b150: 2020 2020 2070 6f6c 7967 6f6e 315f 3364       polygon1_3d
+0003b160: 2e6c 696e 655f 7365 676d 656e 7473 5b69  .line_segments[i
+0003b170: 5d2e 656e 642c 0a20 2020 2020 2020 2020  ].end,.         
+0003b180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b190: 2020 706f 6c79 676f 6e32 5f33 642e 706f    polygon2_3d.po
+0003b1a0: 696e 7473 5b63 6c6f 7369 6e67 5f70 6f69  ints[closing_poi
+0003b1b0: 6e74 5f69 6e64 6578 5d5d 0a20 2020 2020  nt_index]].     
+0003b1c0: 2020 2020 2020 2074 7269 616e 676c 6573         triangles
+0003b1d0: 5f70 6f69 6e74 732e 6170 7065 6e64 2866  _points.append(f
+0003b1e0: 6163 655f 706f 696e 7473 290a 2020 2020  ace_points).    
+0003b1f0: 2020 2020 2020 2020 6c69 7374 5f63 6c6f          list_clo
+0003b200: 7369 6e67 5f70 6f69 6e74 5f69 6e64 6578  sing_point_index
+0003b210: 6573 2e61 7070 656e 6428 636c 6f73 696e  es.append(closin
+0003b220: 675f 706f 696e 745f 696e 6465 7829 0a20  g_point_index). 
+0003b230: 2020 2020 2020 2020 2020 2070 7265 7669             previ
+0003b240: 6f75 735f 636c 6f73 696e 675f 706f 696e  ous_closing_poin
+0003b250: 745f 696e 6465 7820 3d20 636c 6f73 696e  t_index = closin
+0003b260: 675f 706f 696e 745f 696e 6465 780a 2020  g_point_index.  
+0003b270: 2020 2020 2020 2020 2020 6966 2070 7269            if pri
+0003b280: 6d69 7469 7665 3120 3d3d 2070 6f6c 7967  mitive1 == polyg
+0003b290: 6f6e 315f 3264 2e6c 696e 655f 7365 676d  on1_2d.line_segm
+0003b2a0: 656e 7473 5b2d 315d 3a0a 2020 2020 2020  ents[-1]:.      
+0003b2b0: 2020 2020 2020 2020 2020 6966 206c 6973            if lis
+0003b2c0: 745f 636c 6f73 696e 675f 706f 696e 745f  t_closing_point_
+0003b2d0: 696e 6465 7865 735b 2d31 5d20 213d 205c  indexes[-1] != \
+0003b2e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003b2f0: 2020 2020 2020 2020 206c 6973 745f 636c           list_cl
+0003b300: 6f73 696e 675f 706f 696e 745f 696e 6465  osing_point_inde
+0003b310: 7865 735b 305d 3a0a 2020 2020 2020 2020  xes[0]:.        
+0003b320: 2020 2020 2020 2020 2020 2020 7261 7469              rati
+0003b330: 6f20 3d20 286c 6973 745f 636c 6f73 696e  o = (list_closin
+0003b340: 675f 706f 696e 745f 696e 6465 7865 735b  g_point_indexes[
+0003b350: 2d31 5d20 2d0a 2020 2020 2020 2020 2020  -1] -.          
+0003b360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b370: 2020 206c 6973 745f 636c 6f73 696e 675f     list_closing_
+0003b380: 706f 696e 745f 696e 6465 7865 735b 305d  point_indexes[0]
+0003b390: 2920 2f20 6c65 6e28 0a20 2020 2020 2020  ) / len(.       
+0003b3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b3b0: 2070 6f6c 7967 6f6e 325f 3264 2e70 6f69   polygon2_2d.poi
+0003b3c0: 6e74 7329 0a20 2020 2020 2020 2020 2020  nts).           
+0003b3d0: 2020 2020 2020 2020 2069 6620 6d61 7468           if math
+0003b3e0: 2e69 7363 6c6f 7365 2872 6174 696f 2c20  .isclose(ratio, 
+0003b3f0: 2d31 2c0a 2020 2020 2020 2020 2020 2020  -1,.            
+0003b400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b410: 2020 2020 2020 2020 6162 735f 746f 6c3d          abs_tol=
+0003b420: 302e 3229 2061 6e64 2070 6173 7365 645f  0.2) and passed_
+0003b430: 6279 5f7a 6572 6f5f 696e 6465 783a 0a20  by_zero_index:. 
+0003b440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b450: 2020 2020 2020 2064 6963 745f 636c 6f73         dict_clos
+0003b460: 696e 675f 7061 6972 735b 0a20 2020 2020  ing_pairs[.     
+0003b470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b480: 2020 2020 2020 2070 6f6c 7967 6f6e 315f         polygon1_
+0003b490: 3364 2e70 6f69 6e74 735b 305d 5d20 3d20  3d.points[0]] = 
+0003b4a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003b4b0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+0003b4c0: 7374 5f63 6c6f 7369 6e67 5f70 6f69 6e74  st_closing_point
+0003b4d0: 5f69 6e64 6578 6573 5b2d 325d 2c0a 2020  _indexes[-2],.  
+0003b4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b4f0: 2020 2020 2020 2020 2020 6c69 7374 5f63            list_c
+0003b500: 6c6f 7369 6e67 5f70 6f69 6e74 5f69 6e64  losing_point_ind
+0003b510: 6578 6573 5b30 5d29 0a20 2020 2020 2020  exes[0]).       
+0003b520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b530: 206e 6577 5f66 6163 655f 706f 696e 7473   new_face_points
+0003b540: 203d 205b 7472 6961 6e67 6c65 735f 706f   = [triangles_po
+0003b550: 696e 7473 5b2d 315d 5b30 5d2c 0a20 2020  ints[-1][0],.   
+0003b560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b580: 2020 2020 2020 2020 7472 6961 6e67 6c65          triangle
+0003b590: 735f 706f 696e 7473 5b2d 315d 5b31 5d2c  s_points[-1][1],
+0003b5a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003b5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b5c0: 2020 2020 2020 2020 2020 2020 706f 6c79              poly
+0003b5d0: 676f 6e32 5f33 642e 706f 696e 7473 5b0a  gon2_3d.points[.
+0003b5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b600: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0003b610: 6973 745f 636c 6f73 696e 675f 706f 696e  ist_closing_poin
+0003b620: 745f 696e 6465 7865 735b 2d32 5d5d 5d0a  t_indexes[-2]]].
+0003b630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b640: 2020 2020 2020 2020 7472 6961 6e67 6c65          triangle
+0003b650: 735f 706f 696e 7473 2e72 656d 6f76 6528  s_points.remove(
+0003b660: 7472 6961 6e67 6c65 735f 706f 696e 7473  triangles_points
+0003b670: 5b2d 315d 290a 2020 2020 2020 2020 2020  [-1]).          
+0003b680: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+0003b690: 6961 6e67 6c65 735f 706f 696e 7473 2e61  iangles_points.a
+0003b6a0: 7070 656e 6428 6e65 775f 6661 6365 5f70  ppend(new_face_p
+0003b6b0: 6f69 6e74 7329 0a20 2020 2020 2020 2020  oints).         
+0003b6c0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0003b6d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003b6e0: 2020 2020 2020 2020 2064 6963 745f 636c           dict_cl
+0003b6f0: 6f73 696e 675f 7061 6972 735b 706f 6c79  osing_pairs[poly
+0003b700: 676f 6e31 5f33 642e 706f 696e 7473 5b30  gon1_3d.points[0
+0003b710: 5d5d 203d 2028 0a20 2020 2020 2020 2020  ]] = (.         
+0003b720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b730: 2020 206c 6973 7428 6469 6374 5f63 6c6f     list(dict_clo
+0003b740: 7369 6e67 5f70 6169 7273 2e76 616c 7565  sing_pairs.value
+0003b750: 7328 2929 5b2d 315d 5b2d 315d 2c0a 2020  s())[-1][-1],.  
+0003b760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b770: 2020 2020 2020 2020 2020 6c69 7374 2864            list(d
+0003b780: 6963 745f 636c 6f73 696e 675f 7061 6972  ict_closing_pair
+0003b790: 732e 7661 6c75 6573 2829 295b 305d 5b30  s.values())[0][0
+0003b7a0: 5d29 0a0a 2020 2020 2020 2020 7472 6961  ])..        tria
+0003b7b0: 6e67 6c65 735f 706f 696e 7473 202b 3d20  ngles_points += 
+0003b7c0: 706f 6c79 676f 6e32 5f33 642e 636c 6f73  polygon2_3d.clos
+0003b7d0: 655f 7365 7769 6e67 2864 6963 745f 636c  e_sewing(dict_cl
+0003b7e0: 6f73 696e 675f 7061 6972 7329 0a0a 2020  osing_pairs)..  
+0003b7f0: 2020 2020 2020 7265 7475 726e 2074 7269        return tri
+0003b800: 616e 676c 6573 5f70 6f69 6e74 730a 0a20  angles_points.. 
+0003b810: 2020 2064 6566 2073 6577 696e 6728 7365     def sewing(se
+0003b820: 6c66 2c20 706f 6c79 676f 6e32 2c20 782c  lf, polygon2, x,
+0003b830: 2079 293a 0a20 2020 2020 2020 2070 6f6c   y):.        pol
+0003b840: 7967 6f6e 315f 3264 203d 2073 656c 662e  ygon1_2d = self.
+0003b850: 746f 5f32 6428 766f 6c6d 646c 722e 4f32  to_2d(volmdlr.O2
+0003b860: 442c 2078 2c20 7929 0a20 2020 2020 2020  D, x, y).       
+0003b870: 2070 6f6c 7967 6f6e 325f 3264 203d 2070   polygon2_2d = p
+0003b880: 6f6c 7967 6f6e 322e 746f 5f32 6428 766f  olygon2.to_2d(vo
+0003b890: 6c6d 646c 722e 4f32 442c 2078 2c20 7929  lmdlr.O2D, x, y)
+0003b8a0: 0a20 2020 2020 2020 2069 6620 706f 6c79  .        if poly
+0003b8b0: 676f 6e31 5f32 642e 6973 5f63 6f6e 7665  gon1_2d.is_conve
+0003b8c0: 7828 2920 616e 6420 706f 6c79 676f 6e32  x() and polygon2
+0003b8d0: 5f32 642e 6973 5f63 6f6e 7665 7828 293a  _2d.is_convex():
+0003b8e0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0003b8f0: 7572 6e20 7365 6c66 2e63 6f6e 7665 785f  urn self.convex_
+0003b900: 7365 7769 6e67 2870 6f6c 7967 6f6e 322c  sewing(polygon2,
+0003b910: 2078 2c20 7929 0a20 2020 2020 2020 2072   x, y).        r
+0003b920: 6574 7572 6e20 7365 6c66 2e63 6f6e 6361  eturn self.conca
+0003b930: 7665 5f73 6577 696e 6728 706f 6c79 676f  ve_sewing(polygo
+0003b940: 6e32 2c20 782c 2079 290a 0a0a 636c 6173  n2, x, y)...clas
+0003b950: 7320 5472 6961 6e67 6c65 3344 2854 7269  s Triangle3D(Tri
+0003b960: 616e 676c 6529 3a0a 2020 2020 2222 220a  angle):.    """.
+0003b970: 2020 2020 4465 6669 6e65 7320 6120 7472      Defines a tr
+0003b980: 6961 6e67 6c65 2032 442e 0a0a 2020 2020  iangle 2D...    
+0003b990: 3a70 6172 616d 2070 6f69 6e74 313a 2074  :param point1: t
+0003b9a0: 7269 616e 676c 6520 706f 696e 7420 312e  riangle point 1.
+0003b9b0: 0a20 2020 203a 7061 7261 6d20 706f 696e  .    :param poin
+0003b9c0: 7432 3a20 7472 6961 6e67 6c65 2070 6f69  t2: triangle poi
+0003b9d0: 6e74 2032 2e0a 2020 2020 3a70 6172 616d  nt 2..    :param
+0003b9e0: 2070 6f69 6e74 333a 2074 7269 616e 676c   point3: triangl
+0003b9f0: 6520 706f 696e 7433 2e0a 2020 2020 2222  e point3..    ""
+0003ba00: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+0003ba10: 745f 5f28 7365 6c66 2c20 706f 696e 7431  t__(self, point1
+0003ba20: 3a20 766f 6c6d 646c 722e 506f 696e 7433  : volmdlr.Point3
+0003ba30: 442c 2070 6f69 6e74 323a 2076 6f6c 6d64  D, point2: volmd
+0003ba40: 6c72 2e50 6f69 6e74 3344 2c0a 2020 2020  lr.Point3D,.    
+0003ba50: 2020 2020 2020 2020 2020 2020 2070 6f69               poi
+0003ba60: 6e74 333a 2076 6f6c 6d64 6c72 2e50 6f69  nt3: volmdlr.Poi
+0003ba70: 6e74 3344 2c20 6e61 6d65 3a20 7374 7220  nt3D, name: str 
+0003ba80: 3d20 2727 293a 0a0a 2020 2020 2020 2020  = ''):..        
+0003ba90: 5472 6961 6e67 6c65 2e5f 5f69 6e69 745f  Triangle.__init_
+0003baa0: 5f28 7365 6c66 2c20 706f 696e 7431 2c0a  _(self, point1,.
+0003bab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bac0: 2020 2020 2020 2020 2020 706f 696e 7432            point2
+0003bad0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003bae0: 2020 2020 2020 2020 2020 2020 706f 696e              poin
+0003baf0: 7433 2c0a 2020 2020 2020 2020 2020 2020  t3,.            
+0003bb00: 2020 2020 2020 2020 2020 2020 2020 6e61                na
+0003bb10: 6d65 290a                                me).
```

### Comparing `volmdlr-0.9.0/volmdlr.egg-info/PKG-INFO` & `volmdlr-0.9.1/volmdlr.egg-info/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: volmdlr
-Version: 0.9.0
+Version: 0.9.1
 Summary:  A volume modeler computation-oriented. Include rendering bindings.
 Home-page: https://github.com/Dessia-tech/volmdlr
 Author: DessiA Technologies
 Author-email: root@dessia.tech
 License: Creative Commons Attribution-Share Alike license
 Keywords: volume,modeler,CAD
 Platform: UNKNOWN
```

#### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: volmdlr Version: 0.9.0 Summary: A volume modeler
+Metadata-Version: 2.1 Name: volmdlr Version: 0.9.1 Summary: A volume modeler
 computation-oriented. Include rendering bindings. Home-page: https://
 github.com/Dessia-tech/volmdlr Author: DessiA Technologies Author-email:
 root@dessia.tech License: Creative Commons Attribution-Share Alike license
 Keywords: volume,modeler,CAD Platform: UNKNOWN Classifier: Topic :: Scientific/
 Engineering Classifier: Topic :: Multimedia :: Graphics :: 3D Modeling
 Classifier: Development Status :: 5 - Production/Stable Requires-Python: >=3.7
 Description-Content-Type: text/markdown License-File: LICENSE
```

### Comparing `volmdlr-0.9.0/volmdlr.egg-info/SOURCES.txt` & `volmdlr-0.9.1/volmdlr.egg-info/SOURCES.txt`

 * *Files 0% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 LICENSE
 MANIFEST.in
 README.md
 pyproject.toml
 setup.py
 volmdlr/__init__.py
-volmdlr/bspline_compiled.c
+volmdlr/bspline_compiled.pyx
 volmdlr/cloud.py
 volmdlr/core.py
 volmdlr/core_compiled.pyx
 volmdlr/display.py
 volmdlr/edges.py
 volmdlr/faces.py
 volmdlr/geometry.py
```

